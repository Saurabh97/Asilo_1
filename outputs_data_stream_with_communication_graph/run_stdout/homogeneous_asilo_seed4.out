[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:49103
[S3] → join 127.0.0.1:49102
[S4] → join 127.0.0.1:49102
[S5] → join 127.0.0.1:49102
[S6] → join 127.0.0.1:49102
[S7] → join 127.0.0.1:49102
[S8] → join 127.0.0.1:49102
[S9] → join 127.0.0.1:49102
[S10] → join 127.0.0.1:49102
[S11] → join 127.0.0.1:49102
[S13] → join 127.0.0.1:49102
[S14] → join 127.0.0.1:49102
[S15] → join 127.0.0.1:49102
[S16] → join 127.0.0.1:49102
[S17] → join 127.0.0.1:49102
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.156346 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.168882 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.125264 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.119357 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.196405 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.223757 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.158324 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.108882 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.130810 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.182633 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.185826 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.166725 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.184176 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.191510 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.179993 (no previous merge yet)
[S9]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3] + discovered S4
[S3] + discovered S13
[S3] + discovered S11
[S3] + discovered S5
[S3] + discovered S17
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S8
[S3] + discovered S9
[S4] + discovered S3
[S3] + discovered S14
[S3] + discovered S10
[S4] + discovered S2
[S3] + discovered S6
[S3] + discovered S7
[S4] + discovered S11
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S9
[S4] + discovered S14
[S5] + discovered S4
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S15
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S10
[S4] + discovered S7
[S4] + discovered S17
[S4] + discovered S16
[S5] + discovered S13
[S5] + discovered S7
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S14
[S6] + discovered S5
[S5] + discovered S10
[S6] + discovered S2
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S17
[S5] + discovered S16
[S5] + discovered S6
[S5] + discovered S15
[S6] + discovered S8
[S6] + discovered S13
[S6] + discovered S11
[S6] + discovered S17
[S7] + discovered S2
[S6] + discovered S14
[S6] + discovered S7
[S6] + discovered S16
[S7] + discovered S5
[S7] + discovered S4
[S6] + discovered S9
[S6] + discovered S10
[S7] + discovered S6
[S6] + discovered S15
[S7] + discovered S3
[S8] + discovered S4
[S8] + discovered S2
[S7] + discovered S16
[S7] + discovered S9
[S8] + discovered S5
[S8] + discovered S3
[S7] + discovered S14
[S8] + discovered S7
[S7] + discovered S11
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S10
[S8] + discovered S6
[S7] + discovered S8
[S7] + discovered S15
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S15
[S9] + discovered S6
[S8] + discovered S11
[S9] + discovered S5
[S9] + discovered S8
[S9] + discovered S4
[S8] + discovered S17
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S2
[S8] + discovered S13
[S10] + discovered S6
[S9] + discovered S10
[S9] + discovered S11
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S13
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S3
[S9] + discovered S16
[S10] + discovered S8
[S10] + discovered S17
[S11] + discovered S9
[S10] + discovered S11
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S2
[S10] + discovered S16
[S10] + discovered S15
[S11] + discovered S10
[S11] + discovered S5
[S10] + discovered S14
[S10] + discovered S13
[S11] + discovered S4
[S11] + discovered S7
[S11] + discovered S3
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S3
[S11] + discovered S16
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S9
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S14
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S9
[S14] + discovered S7
[S14] + discovered S13
[S14] + discovered S4
[S14] + discovered S11
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S17
[S15] + discovered S11
[S14] + discovered S15
[S15] + discovered S13
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S8
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S6
[S15] + discovered S3
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S5
[S15] + discovered S9
[S15] + discovered S7
[S16] + discovered S15
[S16] + discovered S3
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S9
[S16] + discovered S4
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S2
[S16] + discovered S13
[S16] + discovered S6
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S7
[S16] + discovered S8
[S17] + discovered S13
[S17] + discovered S2
[S17] + discovered S10
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S16
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S9
[S17] + discovered S8
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S3
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:49116
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:49103
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:49107
[S7] ⇄ pheromone p=1.000 → S16@127.0.0.1:49116
[S4] ⇄ pheromone p=1.000 → S7@127.0.0.1:49108
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:49110
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:49104
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:49116
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:49112
[S8] ⇄ pheromone p=1.000 → S13@127.0.0.1:49113
[S13] ⇄ pheromone p=1.000 → S11@127.0.0.1:49112
[S15] ⇄ pheromone p=1.000 → S2@127.0.0.1:49102
[S17] ⇄ pheromone p=1.000 → S4@127.0.0.1:49104
[S14] ⇄ pheromone p=1.000 → S10@127.0.0.1:49111
[S16] ⇄ pheromone p=1.000 → S10@127.0.0.1:49111
[S2] START round=1 head_norm_before_train=1.166332 (no previous merge yet)
[S2] round=1 local utility u=0.024390 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7734365246172322, 'loss_val': 1.2922489729493336, 'psi': 0.39444088988003295}-{'f1_val': 0.1417771333885667, 'auprc': 0.7715775648596106, 'loss_val': 1.3354526876623474, 'psi': 0.3936973059769843}
[S3] START round=1 head_norm_before_train=1.169470 (no previous merge yet)
[S3] round=1 local utility u=1.000000 metrics={'f1_val': 0.4009956334809073, 'auprc': 0.9155131453110352, 'loss_val': 1.330537815085006, 'psi': 0.6068026382129585}-{'f1_val': 0.195830602499883, 'auprc': 0.6282207743590399, 'loss_val': 1.3538950120162876, 'psi': 0.3687866712435458}
[S4] START round=1 head_norm_before_train=1.126842 (no previous merge yet)
[S4] round=1 local utility u=0.488390 metrics={'f1_val': 0.16959901166774455, 'auprc': 0.7933897859884278, 'loss_val': 1.3431269255674256, 'psi': 0.41911532139601787}-{'f1_val': 0.08833063209076175, 'auprc': 0.6414687089713129, 'loss_val': 1.3765335633141529, 'psi': 0.30958586284298223}
[S5] START round=1 head_norm_before_train=1.126688 (no previous merge yet)
[S5] round=1 local utility u=0.021387 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5154090237941295, 'loss_val': 1.3202782519751866, 'psi': 0.29152075237479463}-{'f1_val': 0.14226190476190476, 'auprc': 0.5148597760630879, 'loss_val': 1.3614050883771582, 'psi': 0.291301053282378}
[S6] START round=1 head_norm_before_train=1.201314 (no previous merge yet)
[S6] round=1 local utility u=0.083587 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6844485184517894, 'loss_val': 1.311888415886074, 'psi': 0.358635176611485}-{'f1_val': 0.14142628205128205, 'auprc': 0.6418556871870115, 'loss_val': 1.3512840073706232, 'psi': 0.3415980441055738}
[S7] START round=1 head_norm_before_train=1.227308 (no previous merge yet)
[S7] round=1 local utility u=0.016244 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7944984472383378, 'loss_val': 1.3141442144413789, 'psi': 0.40303347253279015}-{'f1_val': 0.14205682272909165, 'auprc': 0.7935700697055192, 'loss_val': 1.34384728184306, 'psi': 0.4026621215196627}
[S8] START round=1 head_norm_before_train=1.169138 (no previous merge yet)
[S8] round=1 local utility u=0.899208 metrics={'f1_val': 0.39925515069135475, 'auprc': 0.772201940971492, 'loss_val': 1.3282860648047097, 'psi': 0.5484338668034097}-{'f1_val': 0.10450549450549451, 'auprc': 0.7730810970755024, 'loss_val': 1.3608409461914186, 'psi': 0.37193573553349774}
[S9] START round=1 head_norm_before_train=1.116980 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.14274161959996462, 'auprc': 0.9751050275590629, 'loss_val': 1.314990042578988, 'psi': 0.47568698278360394}-{'f1_val': 0.37603555384258336, 'auprc': 0.7678460945450992, 'loss_val': 1.3603975874171916, 'psi': 0.5327597701235898}
[S10] START round=1 head_norm_before_train=1.133241 (no previous merge yet)
[S10] round=1 local utility u=0.293281 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5826255923030578, 'loss_val': 1.342919016813249, 'psi': 0.3162232194462575}-{'f1_val': 0.13862163754172394, 'auprc': 0.39589334296090556, 'loss_val': 1.3692844821615795, 'psi': 0.2415303197093966}
[S11] START round=1 head_norm_before_train=1.183744 (no previous merge yet)
[S11] round=1 local utility u=0.340584 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6905101818239215, 'loss_val': 1.3282380977990156, 'psi': 0.360452282753435}-{'f1_val': 0.14041368337311058, 'auprc': 0.47227681393154664, 'loss_val': 1.3547058758273365, 'psi': 0.273158935596485}
[S13] START round=1 head_norm_before_train=1.191697 (no previous merge yet)
[S13] round=1 local utility u=0.167276 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6556553313544017, 'loss_val': 1.3063721493161295, 'psi': 0.3464935900879925}-{'f1_val': 0.1403857625770531, 'auprc': 0.5549401609953452, 'loss_val': 1.33877804295305, 'psi': 0.30620752194436995}
[S14] START round=1 head_norm_before_train=1.169219 (no previous merge yet)
[S14] round=1 local utility u=0.082167 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5735879186722912, 'loss_val': 1.3314935276127224, 'psi': 0.31364987919853876}-{'f1_val': 0.14035785288270378, 'auprc': 0.5256899743238481, 'loss_val': 1.352132961091324, 'psi': 0.2944907014591615}
[S15] START round=1 head_norm_before_train=1.194285 (no previous merge yet)
[S15] round=1 local utility u=0.020093 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7774748425414378, 'loss_val': 1.302322881653691, 'psi': 0.3948301278335102}-{'f1_val': 0.13973365136155833, 'auprc': 0.7735312875416777, 'loss_val': 1.3306788535582168, 'psi': 0.3932527058336061}
[S16] START round=1 head_norm_before_train=1.190845 (no previous merge yet)
[S16] round=1 local utility u=0.356057 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.530960339154545, 'loss_val': 1.330226984973436, 'psi': 0.29676660578133995}-{'f1_val': 0.14063745019920318, 'auprc': 0.3019603756540138, 'loss_val': 1.3553401889248708, 'psi': 0.20516662038112743}
[S17] START round=1 head_norm_before_train=1.181151 (no previous merge yet)
[S17] round=1 local utility u=0.433502 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6865892832061986, 'loss_val': 1.3505900286904862, 'psi': 0.35920509127291006}-{'f1_val': 0.09923554698818886, 'auprc': 0.4904409644176815, 'loss_val': 1.37886810236594, 'psi': 0.25571771395998594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:49109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S11] → sending delta(kind=head bytes=1786) to S4@127.0.0.1:49104
[S11] sending update (kind=head size=1786 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S5
[S8] cosine check vs S5: cos=0.0341
[S4] RECEIVED delta(kind=head bytes=1786) from S11
[S4] cosine check vs S11: cos=0.0420
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:49105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:49102
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:49117
[S6] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1787 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1788) from S4
[S9] cosine check vs S4: cos=-0.0574
[S9] DROPPED delta from S4 (cos=-0.0574 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S6
[S13] cosine check vs S6: cos=0.0024
[S5] RECEIVED delta(kind=head bytes=1787) from S7
[S5] cosine check vs S7: cos=0.0408
[S10] sending update (kind=head size=1791 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1791) from S10
[S17] cosine check vs S10: cos=-0.0299
[S17] DROPPED delta from S10 (cos=-0.0299 < 0.0)
[S8] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1791) from S8
[S2] cosine check vs S8: cos=0.0554
[S17] RECEIVED delta(kind=head bytes=1789) from S3
[S17] cosine check vs S3: cos=-0.0221
[S17] DROPPED delta from S3 (cos=-0.0221 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1790) from S2
[S17] cosine check vs S2: cos=0.0780
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:49102
[S13] sending update (kind=head size=1789 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1789) from S13
[S2] cosine check vs S13: cos=0.0415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S14] → sending delta(kind=head bytes=1785) to S10@127.0.0.1:49111
[S14] sending update (kind=head size=1785 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1785) from S14
[S10] cosine check vs S14: cos=-0.0610
[S10] DROPPED delta from S14 (cos=-0.0610 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:49105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:49107
[S15] sending update (kind=head size=1787 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1787) from S15
[S5] cosine check vs S15: cos=0.0298
[S16] sending update (kind=head size=1789 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1789) from S16
[S6] cosine check vs S16: cos=-0.1133
[S6] DROPPED delta from S16 (cos=-0.1133 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:49110
[S17] sending update (kind=head size=1791 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1791) from S17
[S9] cosine check vs S17: cos=-0.0287
[S9] DROPPED delta from S17 (cos=-0.0287 < 0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.143489
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.961836e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.730896 delta_norm=0.696184
[S5] aggregate: ACCEPT kept=['S7', 'S15'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1696 head_norm=1.137745
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.066273e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.841247 delta_norm=0.806627
[S4] aggregate: ROLLBACK (f1_val pre=0.170 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.185004
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.018802e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.749249 delta_norm=0.701880
[S2] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.3993 head_norm=1.187905
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.102455e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1045 head_norm=0.838359 delta_norm=0.810245
[S8] aggregate: ROLLBACK (f1_val pre=0.399 post=0.105 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.209658
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.569642e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.859048 delta_norm=0.856964
[S13] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.191234
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.066815e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.3890 head_norm=0.872297 delta_norm=0.806682
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.749249 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.013186 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7818343833015207, 'loss_val': 1.2910711666486825, 'psi': 0.3978000333537483}-{'f1_val': 0.1417771333885667, 'auprc': 0.7734365246172322, 'loss_val': 1.2922489729493336, 'psi': 0.39444088988003295}
[S3] START round=2 head_norm_before_train=1.180428 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9965105790995622, 'loss_val': 1.3069294770783642, 'psi': 0.4825082710082891}-{'f1_val': 0.4009956334809073, 'auprc': 0.9155131453110352, 'loss_val': 1.330537815085006, 'psi': 0.6068026382129585}
[S4] START round=2 head_norm_before_train=0.841247 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7808108294325456, 'loss_val': 1.3237589643282246, 'psi': 0.39646030911012875}-{'f1_val': 0.16959901166774455, 'auprc': 0.7933897859884278, 'loss_val': 1.3431269255674256, 'psi': 0.41911532139601787}
[S5] START round=2 head_norm_before_train=0.730896 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.002091 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5158754646793599, 'loss_val': 1.3174958783720563, 'psi': 0.2917073287288868}-{'f1_val': 0.14226190476190476, 'auprc': 0.5154090237941295, 'loss_val': 1.3202782519751866, 'psi': 0.29152075237479463}
[S6] START round=2 head_norm_before_train=1.217140 (no previous merge yet)
[S6] round=2 local utility u=0.237650 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8289565666616137, 'loss_val': 1.2701118613054585, 'psi': 0.4164383958954147}-{'f1_val': 0.14142628205128205, 'auprc': 0.6844485184517894, 'loss_val': 1.311888415886074, 'psi': 0.358635176611485}
[S7] START round=2 head_norm_before_train=1.238354 (no previous merge yet)
[S7] round=2 local utility u=0.014808 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7946458601833597, 'loss_val': 1.2849710488610113, 'psi': 0.4030924377107989}-{'f1_val': 0.14205682272909165, 'auprc': 0.7944984472383378, 'loss_val': 1.3141442144413789, 'psi': 0.40303347253279015}
[S8] START round=2 head_norm_before_train=0.838359 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.070634 metrics={'f1_val': 0.42257860386146096, 'auprc': 0.7728096192270506, 'loss_val': 1.3287808320311625, 'psi': 0.5626710100076968}-{'f1_val': 0.39925515069135475, 'auprc': 0.772201940971492, 'loss_val': 1.3282860648047097, 'psi': 0.5484338668034097}
[S9] START round=2 head_norm_before_train=1.132596 (no previous merge yet)
[S9] round=2 local utility u=0.062981 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9987243236404533, 'loss_val': 1.2518245602475644, 'psi': 0.48432850374017894}-{'f1_val': 0.14274161959996462, 'auprc': 0.9751050275590629, 'loss_val': 1.314990042578988, 'psi': 0.47568698278360394}
[S10] START round=2 head_norm_before_train=1.143208 (no previous merge yet)
[S10] round=2 local utility u=0.035564 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.596596203570974, 'loss_val': 1.3137023754814612, 'psi': 0.32181146395342397}-{'f1_val': 0.13862163754172394, 'auprc': 0.5826255923030578, 'loss_val': 1.342919016813249, 'psi': 0.3162232194462575}
[S11] START round=2 head_norm_before_train=1.192570 (no previous merge yet)
[S11] round=2 local utility u=0.168042 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7920868792963909, 'loss_val': 1.296883572899301, 'psi': 0.4010829617424227}-{'f1_val': 0.14041368337311058, 'auprc': 0.6905101818239215, 'loss_val': 1.3282380977990156, 'psi': 0.360452282753435}
[S13] START round=2 head_norm_before_train=0.859048 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6033179305759198, 'loss_val': 1.3134282802424413, 'psi': 0.3255586297765998}-{'f1_val': 0.1403857625770531, 'auprc': 0.6556553313544017, 'loss_val': 1.3063721493161295, 'psi': 0.3464935900879925}
[S14] START round=2 head_norm_before_train=1.180620 (no previous merge yet)
[S14] round=2 local utility u=0.189274 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6918897254147074, 'loss_val': 1.307851007608634, 'psi': 0.3609706018955052}-{'f1_val': 0.14035785288270378, 'auprc': 0.5735879186722912, 'loss_val': 1.3314935276127224, 'psi': 0.31364987919853876}
[S15] START round=2 head_norm_before_train=1.213641 (no previous merge yet)
[S15] round=2 local utility u=0.016267 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7777977513940325, 'loss_val': 1.270757719159387, 'psi': 0.39495929137454805}-{'f1_val': 0.13973365136155833, 'auprc': 0.7774748425414378, 'loss_val': 1.302322881653691, 'psi': 0.3948301278335102}
[S16] START round=2 head_norm_before_train=1.198816 (no previous merge yet)
[S16] round=2 local utility u=0.165759 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6338763312964611, 'loss_val': 1.3074565038995833, 'psi': 0.33793300263810633}-{'f1_val': 0.14063745019920318, 'auprc': 0.530960339154545, 'loss_val': 1.330226984973436, 'psi': 0.29676660578133995}
[S17] START round=2 head_norm_before_train=0.872297 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6235705979533839, 'loss_val': 1.3411768054710727, 'psi': 0.3339976171717842}-{'f1_val': 0.14094896331738438, 'auprc': 0.6865892832061986, 'loss_val': 1.3505900286904862, 'psi': 0.35920509127291006}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S14] → sending delta(kind=head bytes=1785) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49103
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:49113
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49115
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:49115
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49116
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1785 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S5
[S15] cosine check vs S5: cos=0.4108
[S16] RECEIVED delta(kind=head bytes=1785) from S14
[S16] cosine check vs S14: cos=0.0332
[S17] RECEIVED delta(kind=head bytes=1795) from S2
[S17] cosine check vs S2: cos=0.5985
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.0131
[S17] RECEIVED delta(kind=head bytes=1791) from S15
[S17] cosine check vs S15: cos=-0.0080
[S17] DROPPED delta from S15 (cos=-0.0080 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S6
[S13] cosine check vs S6: cos=0.6936
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] cosine check vs S7: cos=-0.0464
[S17] DROPPED delta from S7 (cos=-0.0464 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=-0.0689
[S5] DROPPED delta from S10 (cos=-0.0689 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=-0.1075
[S16] DROPPED delta from S8 (cos=-0.1075 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S16
[S3] cosine check vs S16: cos=-0.0538
[S3] DROPPED delta from S16 (cos=-0.0538 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=-0.0405
[S2] DROPPED delta from S11 (cos=-0.0405 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=0.879924
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.475653e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.979104 delta_norm=0.447565
[S13] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.212784
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.390801e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.867407 delta_norm=0.839080
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.238013
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.364177e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.777757 delta_norm=0.636418
[S15] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=0.886048
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.756827e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.3491 head_norm=0.743654 delta_norm=0.375683
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.776684 cos_to_last_merge=0.9962 (last merge round=1)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.70799045353697, 'loss_val': 1.2314597329328598, 'psi': 0.36826246144792807}-{'f1_val': 0.1417771333885667, 'auprc': 0.7818343833015207, 'loss_val': 1.2910711666486825, 'psi': 0.3978000333537483}
[S3] START round=3 head_norm_before_train=1.196096 (no previous merge yet)
[S3] round=3 local utility u=0.018903 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9982985617301986, 'loss_val': 1.274488317613026, 'psi': 0.48322346406054373}-{'f1_val': 0.13984006561410703, 'auprc': 0.9965105790995622, 'loss_val': 1.3069294770783642, 'psi': 0.4825082710082891}
[S4] START round=3 head_norm_before_train=0.863509 cos_to_last_merge=0.9967 (last merge round=1)
[S4] round=3 local utility u=0.026771 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7822425685601954, 'loss_val': 1.274513115764574, 'psi': 0.39703300476118863}-{'f1_val': 0.14022662889518414, 'auprc': 0.7808108294325456, 'loss_val': 1.3237589643282246, 'psi': 0.39646030911012875}
[S5] START round=3 head_norm_before_train=0.749258 cos_to_last_merge=0.9961 (last merge round=1)
[S5] round=3 local utility u=0.096804 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5657462473224544, 'loss_val': 1.2735000776585146, 'psi': 0.3116556417861246}-{'f1_val': 0.14226190476190476, 'auprc': 0.5158754646793599, 'loss_val': 1.3174958783720563, 'psi': 0.2917073287288868}
[S6] START round=3 head_norm_before_train=1.242437 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.784348882019806, 'loss_val': 1.2318892870809648, 'psi': 0.39859532203869164}-{'f1_val': 0.14142628205128205, 'auprc': 0.8289565666616137, 'loss_val': 1.2701118613054585, 'psi': 0.4164383958954147}
[S7] START round=3 head_norm_before_train=1.253699 (no previous merge yet)
[S7] round=3 local utility u=0.013475 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7947913437417732, 'loss_val': 1.2584567821928851, 'psi': 0.4031506311341643}-{'f1_val': 0.14205682272909165, 'auprc': 0.7946458601833597, 'loss_val': 1.2849710488610113, 'psi': 0.4030924377107989}
[S8] START round=3 head_norm_before_train=0.865272 cos_to_last_merge=0.9969 (last merge round=1)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.3839025009257294, 'auprc': 0.7528778814936132, 'loss_val': 1.291104624119237, 'psi': 0.531492653152883}-{'f1_val': 0.42257860386146096, 'auprc': 0.7728096192270506, 'loss_val': 1.3287808320311625, 'psi': 0.5626710100076968}
[S9] START round=3 head_norm_before_train=1.159261 (no previous merge yet)
[S9] round=3 local utility u=0.006308 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9750653645572727, 'loss_val': 1.1682323329387791, 'psi': 0.4748649201069067}-{'f1_val': 0.141397957139996, 'auprc': 0.9987243236404533, 'loss_val': 1.2518245602475644, 'psi': 0.48432850374017894}
[S10] START round=3 head_norm_before_train=1.161191 (no previous merge yet)
[S10] round=3 local utility u=0.261786 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7577337357347194, 'loss_val': 1.273542160897908, 'psi': 0.3862664768189221}-{'f1_val': 0.13862163754172394, 'auprc': 0.596596203570974, 'loss_val': 1.3137023754814612, 'psi': 0.32181146395342397}
[S11] START round=3 head_norm_before_train=1.209505 (no previous merge yet)
[S11] round=3 local utility u=0.045373 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.808120038302292, 'loss_val': 1.2542363006272899, 'psi': 0.40749622534478314}-{'f1_val': 0.14041368337311058, 'auprc': 0.7920868792963909, 'loss_val': 1.296883572899301, 'psi': 0.4010829617424227}
[S13] START round=3 head_norm_before_train=0.979104 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.541675421080719, 'loss_val': 1.3025037734688976, 'psi': 0.30090162597851944}-{'f1_val': 0.1403857625770531, 'auprc': 0.6033179305759198, 'loss_val': 1.3134282802424413, 'psi': 0.3255586297765998}
[S14] START round=3 head_norm_before_train=1.200856 (no previous merge yet)
[S14] round=3 local utility u=0.336685 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.906381693108591, 'loss_val': 1.2779563665571918, 'psi': 0.4467673889730587}-{'f1_val': 0.14035785288270378, 'auprc': 0.6918897254147074, 'loss_val': 1.307851007608634, 'psi': 0.3609706018955052}
[S15] START round=3 head_norm_before_train=0.777757 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7759380754563118, 'loss_val': 1.2735471787647494, 'psi': 0.3942154209994597}-{'f1_val': 0.13973365136155833, 'auprc': 0.7777977513940325, 'loss_val': 1.270757719159387, 'psi': 0.39495929137454805}
[S16] START round=3 head_norm_before_train=0.867407 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6320975962640092, 'loss_val': 1.3096550406210976, 'psi': 0.33722150862512557}-{'f1_val': 0.14063745019920318, 'auprc': 0.6338763312964611, 'loss_val': 1.3074565038995833, 'psi': 0.33793300263810633}
[S17] START round=3 head_norm_before_train=0.743654 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5826585043317908, 'loss_val': 1.3333596762906244, 'psi': 0.31763277972314696}-{'f1_val': 0.14094896331738438, 'auprc': 0.6235705979533839, 'loss_val': 1.3411768054710727, 'psi': 0.3339976171717842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49103
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49116
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49116
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:49111
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=-0.0048
[S16] DROPPED delta from S11 (cos=-0.0048 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.0686
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] cosine check vs S3: cos=-0.0447
[S4] DROPPED delta from S3 (cos=-0.0447 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S9
[S6] cosine check vs S9: cos=-0.0224
[S6] DROPPED delta from S9 (cos=-0.0224 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S14
[S10] cosine check vs S14: cos=-0.0480
[S10] DROPPED delta from S14 (cos=-0.0480 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S7
[S16] cosine check vs S7: cos=-0.0177
[S16] DROPPED delta from S7 (cos=-0.0177 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.0610
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.0420
[S16] DROPPED delta from S5 (cos=-0.0420 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.272138
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.525886e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.802890 delta_norm=0.752589
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.221555
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.254383e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.877416 delta_norm=0.825438
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.816701 cos_to_last_merge=0.9853 (last merge round=1)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6132938320400333, 'loss_val': 1.19043252582189, 'psi': 0.33038381284915336}-{'f1_val': 0.1417771333885667, 'auprc': 0.70799045353697, 'loss_val': 1.2314597329328598, 'psi': 0.36826246144792807}
[S3] START round=4 head_norm_before_train=0.877416 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9642585604597333, 'loss_val': 1.2742179859718439, 'psi': 0.4696074635523576}-{'f1_val': 0.13984006561410703, 'auprc': 0.9982985617301986, 'loss_val': 1.274488317613026, 'psi': 0.48322346406054373}
[S4] START round=4 head_norm_before_train=0.896498 cos_to_last_merge=0.9877 (last merge round=1)
[S4] round=4 local utility u=0.046286 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7836393742151935, 'loss_val': 1.186131830130824, 'psi': 0.3975917270231879}-{'f1_val': 0.14022662889518414, 'auprc': 0.7822425685601954, 'loss_val': 1.274513115764574, 'psi': 0.39703300476118863}
[S5] START round=4 head_norm_before_train=0.776503 cos_to_last_merge=0.9860 (last merge round=1)
[S5] round=4 local utility u=0.080904 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6105348072884287, 'loss_val': 1.246057236871469, 'psi': 0.3295710657725143}-{'f1_val': 0.14226190476190476, 'auprc': 0.5657462473224544, 'loss_val': 1.2735000776585146, 'psi': 0.3116556417861246}
[S6] START round=4 head_norm_before_train=1.272539 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.641405308852359, 'loss_val': 1.1868164032655266, 'psi': 0.3414178927717128}-{'f1_val': 0.14142628205128205, 'auprc': 0.784348882019806, 'loss_val': 1.2318892870809648, 'psi': 0.39859532203869164}
[S7] START round=4 head_norm_before_train=0.802890 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7949120757878687, 'loss_val': 1.2712163883666765, 'psi': 0.4031989239526025}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947913437417732, 'loss_val': 1.2584567821928851, 'psi': 0.4031506311341643}
[S8] START round=4 head_norm_before_train=0.900640 cos_to_last_merge=0.9892 (last merge round=1)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7462834185961691, 'loss_val': 1.2405196781048589, 'psi': 0.38248695687424195}-{'f1_val': 0.3839025009257294, 'auprc': 0.7528778814936132, 'loss_val': 1.291104624119237, 'psi': 0.531492653152883}
[S9] START round=4 head_norm_before_train=1.195716 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8981083619972053, 'loss_val': 1.1012014829024996, 'psi': 0.44408211908287976}-{'f1_val': 0.141397957139996, 'auprc': 0.9750653645572727, 'loss_val': 1.1682323329387791, 'psi': 0.4748649201069067}
[S10] START round=4 head_norm_before_train=1.187527 (no previous merge yet)
[S10] round=4 local utility u=0.053980 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7774458480162587, 'loss_val': 1.224718464200247, 'psi': 0.3941513217315379}-{'f1_val': 0.13862163754172394, 'auprc': 0.7577337357347194, 'loss_val': 1.273542160897908, 'psi': 0.3862664768189221}
[S11] START round=4 head_norm_before_train=1.233888 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7612621463300787, 'loss_val': 1.2037009718152611, 'psi': 0.38875306855589786}-{'f1_val': 0.14041368337311058, 'auprc': 0.808120038302292, 'loss_val': 1.2542363006272899, 'psi': 0.40749622534478314}
[S13] START round=4 head_norm_before_train=0.995633 cos_to_last_merge=0.9976 (last merge round=2)
[S13] round=4 local utility u=0.052926 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5586916906581983, 'loss_val': 1.2476999305324177, 'psi': 0.30770813380951123}-{'f1_val': 0.1403857625770531, 'auprc': 0.541675421080719, 'loss_val': 1.3025037734688976, 'psi': 0.30090162597851944}
[S14] START round=4 head_norm_before_train=1.229419 (no previous merge yet)
[S14] round=4 local utility u=0.084891 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.948431876141916, 'loss_val': 1.2343242291865593, 'psi': 0.4635874621863887}-{'f1_val': 0.14035785288270378, 'auprc': 0.906381693108591, 'loss_val': 1.2779563665571918, 'psi': 0.4467673889730587}
[S15] START round=4 head_norm_before_train=0.810021 cos_to_last_merge=0.9970 (last merge round=2)
[S15] round=4 local utility u=0.022470 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7767249295079901, 'loss_val': 1.2309672572449064, 'psi': 0.3945301626201311}-{'f1_val': 0.13973365136155833, 'auprc': 0.7759380754563118, 'loss_val': 1.2735471787647494, 'psi': 0.3942154209994597}
[S16] START round=4 head_norm_before_train=0.884851 cos_to_last_merge=0.9971 (last merge round=2)
[S16] round=4 local utility u=0.016217 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6296882774455576, 'loss_val': 1.2699932051327147, 'psi': 0.33625778109774496}-{'f1_val': 0.14063745019920318, 'auprc': 0.6320975962640092, 'loss_val': 1.3096550406210976, 'psi': 0.33722150862512557}
[S17] START round=4 head_norm_before_train=0.758657 cos_to_last_merge=0.9959 (last merge round=2)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5646561535167289, 'loss_val': 1.2826352388392241, 'psi': 0.3104318393971222}-{'f1_val': 0.14094896331738438, 'auprc': 0.5826585043317908, 'loss_val': 1.3333596762906244, 'psi': 0.31763277972314696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:49102
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49103
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:49108
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:49111
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S4
[S7] cosine check vs S4: cos=0.5871
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0344
[S16] DROPPED delta from S5 (cos=-0.0344 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1790) from S14
[S10] cosine check vs S14: cos=-0.0409
[S10] DROPPED delta from S14 (cos=-0.0409 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S15
[S2] cosine check vs S15: cos=-0.0428
[S2] DROPPED delta from S15 (cos=-0.0428 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.6982
[S10] RECEIVED delta(kind=head bytes=1789) from S16
[S10] cosine check vs S16: cos=-0.0672
[S10] DROPPED delta from S16 (cos=-0.0672 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1788) from S13
[S11] cosine check vs S13: cos=0.0481
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=0.909798
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.378560e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1398 head_norm=0.983354 delta_norm=0.437856
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=1.261962
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.916442e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.829781 delta_norm=0.791644
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.824890
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.040327e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.786243 delta_norm=0.404033
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.851750 cos_to_last_merge=0.9741 (last merge round=1)
[S2] round=5 local utility u=0.277278 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7743172825000294, 'loss_val': 1.118947162027468, 'psi': 0.3947931930331518}-{'f1_val': 0.1417771333885667, 'auprc': 0.6132938320400333, 'loss_val': 1.19043252582189, 'psi': 0.33038381284915336}
[S3] START round=5 head_norm_before_train=0.983354 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6260314662905411, 'loss_val': 1.2602433824947858, 'psi': 0.3343166258846807}-{'f1_val': 0.13984006561410703, 'auprc': 0.9642585604597333, 'loss_val': 1.2742179859718439, 'psi': 0.4696074635523576}
[S4] START round=5 head_norm_before_train=0.939360 cos_to_last_merge=0.9748 (last merge round=1)
[S4] round=5 local utility u=0.051769 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.782987753418422, 'loss_val': 1.08063834921166, 'psi': 0.3973310787044793}-{'f1_val': 0.14022662889518414, 'auprc': 0.7836393742151935, 'loss_val': 1.186131830130824, 'psi': 0.3975917270231879}
[S5] START round=5 head_norm_before_train=0.794823 cos_to_last_merge=0.9764 (last merge round=1)
[S5] round=5 local utility u=0.231065 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7527353505620515, 'loss_val': 1.210528720235048, 'psi': 0.38645128308196347}-{'f1_val': 0.14226190476190476, 'auprc': 0.6105348072884287, 'loss_val': 1.246057236871469, 'psi': 0.3295710657725143}
[S6] START round=5 head_norm_before_train=1.307262 (no previous merge yet)
[S6] round=5 local utility u=0.956012 metrics={'f1_val': 0.40403956181490597, 'auprc': 0.7196197287256463, 'loss_val': 1.0851150358013604, 'psi': 0.5302716285792021}-{'f1_val': 0.14142628205128205, 'auprc': 0.641405308852359, 'loss_val': 1.1868164032655266, 'psi': 0.3414178927717128}
[S7] START round=5 head_norm_before_train=0.786243 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7946172414100179, 'loss_val': 1.2731660332671404, 'psi': 0.40308099020146215}-{'f1_val': 0.14205682272909165, 'auprc': 0.7949120757878687, 'loss_val': 1.2712163883666765, 'psi': 0.4031989239526025}
[S8] START round=5 head_norm_before_train=0.940197 cos_to_last_merge=0.9788 (last merge round=1)
[S8] round=5 local utility u=0.063927 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660802734320992, 'loss_val': 1.1720563779890063, 'psi': 0.39040569880861403}-{'f1_val': 0.13995598239295717, 'auprc': 0.7462834185961691, 'loss_val': 1.2405196781048589, 'psi': 0.38248695687424195}
[S9] START round=5 head_norm_before_train=1.232320 (no previous merge yet)
[S9] round=5 local utility u=0.228268 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9982496710540916, 'loss_val': 0.9450902108833585, 'psi': 0.4841386427056343}-{'f1_val': 0.141397957139996, 'auprc': 0.8981083619972053, 'loss_val': 1.1012014829024996, 'psi': 0.44408211908287976}
[S10] START round=5 head_norm_before_train=1.220522 (no previous merge yet)
[S10] round=5 local utility u=0.037568 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7780080546043195, 'loss_val': 1.1512683141591131, 'psi': 0.3943762043667622}-{'f1_val': 0.13862163754172394, 'auprc': 0.7774458480162587, 'loss_val': 1.224718464200247, 'psi': 0.3941513217315379}
[S11] START round=5 head_norm_before_train=0.829781 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.082665 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8152127823897679, 'loss_val': 1.200221918086278, 'psi': 0.41033332297977354}-{'f1_val': 0.14041368337311058, 'auprc': 0.7612621463300787, 'loss_val': 1.2037009718152611, 'psi': 0.38875306855589786}
[S13] START round=5 head_norm_before_train=1.018787 cos_to_last_merge=0.9912 (last merge round=2)
[S13] round=5 local utility u=0.828387 metrics={'f1_val': 0.4127061774851051, 'auprc': 0.5482345905937678, 'loss_val': 1.1934763573146587, 'psi': 0.4669175427285701}-{'f1_val': 0.1403857625770531, 'auprc': 0.5586916906581983, 'loss_val': 1.2476999305324177, 'psi': 0.30770813380951123}
[S14] START round=5 head_norm_before_train=1.262013 (no previous merge yet)
[S14] round=5 local utility u=0.104490 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9933750698481385, 'loss_val': 1.1601740963451277, 'psi': 0.4815647396688777}-{'f1_val': 0.14035785288270378, 'auprc': 0.948431876141916, 'loss_val': 1.2343242291865593, 'psi': 0.4635874621863887}
[S15] START round=5 head_norm_before_train=0.843540 cos_to_last_merge=0.9900 (last merge round=2)
[S15] round=5 local utility u=0.025555 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.776786605235596, 'loss_val': 1.1800428636542462, 'psi': 0.3945548329111734}-{'f1_val': 0.13973365136155833, 'auprc': 0.7767249295079901, 'loss_val': 1.2309672572449064, 'psi': 0.3945301626201311}
[S16] START round=5 head_norm_before_train=0.912350 cos_to_last_merge=0.9888 (last merge round=2)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.43505352507993184, 'loss_val': 1.2330827026916207, 'psi': 0.2584038801514946}-{'f1_val': 0.14063745019920318, 'auprc': 0.6296882774455576, 'loss_val': 1.2699932051327147, 'psi': 0.33625778109774496}
[S17] START round=5 head_norm_before_train=0.787016 cos_to_last_merge=0.9832 (last merge round=2)
[S17] round=5 local utility u=0.009197 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5468593282022468, 'loss_val': 1.2108511240073838, 'psi': 0.3033131092713294}-{'f1_val': 0.14094896331738438, 'auprc': 0.5646561535167289, 'loss_val': 1.2826352388392241, 'psi': 0.3104318393971222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49103
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49112
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S13] → sending delta(kind=head bytes=1785) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:49113
[S15] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1785 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.5988
[S13] RECEIVED delta(kind=head bytes=1797) from S8
[S13] cosine check vs S8: cos=-0.0054
[S13] DROPPED delta from S8 (cos=-0.0054 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.9240
[S9] RECEIVED delta(kind=head bytes=1797) from S2
[S9] cosine check vs S2: cos=-0.0347
[S9] DROPPED delta from S2 (cos=-0.0347 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1790) from S5
[S16] cosine check vs S5: cos=-0.0213
[S16] DROPPED delta from S5 (cos=-0.0213 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S15
[S2] cosine check vs S15: cos=-0.0471
[S2] DROPPED delta from S15 (cos=-0.0471 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S4
[S7] cosine check vs S4: cos=0.8807
[S10] RECEIVED delta(kind=head bytes=1793) from S14
[S10] cosine check vs S14: cos=-0.0369
[S10] DROPPED delta from S14 (cos=-0.0369 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S9
[S6] cosine check vs S9: cos=-0.0191
[S6] DROPPED delta from S9 (cos=-0.0191 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1785) from S13
[S11] cosine check vs S13: cos=0.6230
[S16] RECEIVED delta(kind=head bytes=1792) from S11
[S16] cosine check vs S11: cos=-0.0652
[S16] DROPPED delta from S11 (cos=-0.0652 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:49104
[S17] sending update (kind=head size=1792 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1792) from S17
[S4] cosine check vs S17: cos=-0.0434
[S4] DROPPED delta from S17 (cos=-0.0434 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.800315
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.356173e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.865745 delta_norm=0.235617
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.332 → S16@127.0.0.1:49116
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=1.009789
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.507871e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=1.110099 delta_norm=0.250787
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.412 → S4@127.0.0.1:49104
[S16] ⇄ pheromone p=0.376 → S10@127.0.0.1:49111
[S9] ⇄ pheromone p=0.381 → S6@127.0.0.1:49107
[S4] ⇄ pheromone p=0.389 → S7@127.0.0.1:49108
[S10] ⇄ pheromone p=0.405 → S3@127.0.0.1:49103
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.856366
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.577596e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.911900 delta_norm=0.457760
[S11] aggregate: ACCEPT kept=['S6', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.395 → S16@127.0.0.1:49116
[S13] ⇄ pheromone p=0.516 → S11@127.0.0.1:49112
[S14] ⇄ pheromone p=0.431 → S10@127.0.0.1:49111
[S6] ⇄ pheromone p=0.550 → S11@127.0.0.1:49112
[S8] ⇄ pheromone p=0.421 → S13@127.0.0.1:49113
[S15] ⇄ pheromone p=0.340 → S2@127.0.0.1:49102
[S2] ⇄ pheromone p=0.386 → S9@127.0.0.1:49110
[S5] ⇄ pheromone p=0.401 → S16@127.0.0.1:49116
[S17] ⇄ pheromone p=0.365 → S4@127.0.0.1:49104
[S2] START round=6 head_norm_before_train=0.877606 cos_to_last_merge=0.9648 (last merge round=1)
[S2] round=6 local utility u=0.867629 metrics={'f1_val': 0.4156703010573377, 'auprc': 0.7722637165940255, 'loss_val': 1.020888104134318, 'psi': 0.5583076672720129}-{'f1_val': 0.1417771333885667, 'auprc': 0.7743172825000294, 'loss_val': 1.118947162027468, 'psi': 0.3947931930331518}
[S3] START round=6 head_norm_before_train=1.110099 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6027646562399547, 'loss_val': 1.2006242718075162, 'psi': 0.3250099018644461}-{'f1_val': 0.13984006561410703, 'auprc': 0.6260314662905411, 'loss_val': 1.2602433824947858, 'psi': 0.3343166258846807}
[S4] START round=6 head_norm_before_train=0.984661 cos_to_last_merge=0.9611 (last merge round=1)
[S4] round=6 local utility u=1.000000 metrics={'f1_val': 0.6845865723171755, 'auprc': 0.7861492352713053, 'loss_val': 0.9663300137070852, 'psi': 0.7252116374988273}-{'f1_val': 0.14022662889518414, 'auprc': 0.782987753418422, 'loss_val': 1.08063834921166, 'psi': 0.3973310787044793}
[S5] START round=6 head_norm_before_train=0.807449 cos_to_last_merge=0.9682 (last merge round=1)
[S5] round=6 local utility u=0.675410 metrics={'f1_val': 0.34378383713061134, 'auprc': 0.7775766185532511, 'loss_val': 1.1433632743276876, 'psi': 0.5173009496996672}-{'f1_val': 0.14226190476190476, 'auprc': 0.7527353505620515, 'loss_val': 1.210528720235048, 'psi': 0.38645128308196347}
[S6] START round=6 head_norm_before_train=1.342395 (no previous merge yet)
[S6] round=6 local utility u=0.221614 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.7811822805138249, 'loss_val': 0.9046712595215587, 'psi': 0.5627063349300503}-{'f1_val': 0.40403956181490597, 'auprc': 0.7196197287256463, 'loss_val': 1.0851150358013604, 'psi': 0.5302716285792021}
[S7] START round=6 head_norm_before_train=0.865745 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.005397 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7943473134163943, 'loss_val': 1.2615618165443778, 'psi': 0.4029730190040127}-{'f1_val': 0.14205682272909165, 'auprc': 0.7946172414100179, 'loss_val': 1.2731660332671404, 'psi': 0.40308099020146215}
[S8] START round=6 head_norm_before_train=0.982133 cos_to_last_merge=0.9678 (last merge round=1)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7147181481511302, 'auprc': 0.766471127150433, 'loss_val': 1.0754890744819725, 'psi': 0.7354193397508513}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660802734320992, 'loss_val': 1.1720563779890063, 'psi': 0.39040569880861403}
[S9] START round=6 head_norm_before_train=1.262022 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7007592215828227, 'auprc': 0.9999915285505216, 'loss_val': 0.7458201755581968, 'psi': 0.8204521443699022}-{'f1_val': 0.141397957139996, 'auprc': 0.9982496710540916, 'loss_val': 0.9450902108833585, 'psi': 0.4841386427056343}
[S10] START round=6 head_norm_before_train=1.253298 (no previous merge yet)
[S10] round=6 local utility u=0.987135 metrics={'f1_val': 0.41725894337834635, 'auprc': 0.8295568666376233, 'loss_val': 1.0034693097270866, 'psi': 0.5821781126820571}-{'f1_val': 0.13862163754172394, 'auprc': 0.7780080546043195, 'loss_val': 1.1512683141591131, 'psi': 0.3943762043667622}
[S11] START round=6 head_norm_before_train=0.911900 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7617863210254712, 'loss_val': 1.1791073074858918, 'psi': 0.3889627384340548}-{'f1_val': 0.14041368337311058, 'auprc': 0.8152127823897679, 'loss_val': 1.200221918086278, 'psi': 0.41033332297977354}
[S13] START round=6 head_norm_before_train=1.041509 cos_to_last_merge=0.9843 (last merge round=2)
[S13] round=6 local utility u=0.053836 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.5487001834782244, 'loss_val': 1.1102667048207135, 'psi': 0.4694102788387301}-{'f1_val': 0.4127061774851051, 'auprc': 0.5482345905937678, 'loss_val': 1.1934763573146587, 'psi': 0.4669175427285701}
[S14] START round=6 head_norm_before_train=1.301656 (no previous merge yet)
[S14] round=6 local utility u=0.437404 metrics={'f1_val': 0.263548197492163, 'auprc': 0.9939341069218735, 'loss_val': 1.0261861216762, 'psi': 0.5557025612640472}-{'f1_val': 0.14035785288270378, 'auprc': 0.9933750698481385, 'loss_val': 1.1601740963451277, 'psi': 0.4815647396688777}
[S15] START round=6 head_norm_before_train=0.877003 cos_to_last_merge=0.9817 (last merge round=2)
[S15] round=6 local utility u=0.491401 metrics={'f1_val': 0.2872249006740771, 'auprc': 0.7774700822423184, 'loss_val': 1.084237847868922, 'psi': 0.48332297330137364}-{'f1_val': 0.13973365136155833, 'auprc': 0.776786605235596, 'loss_val': 1.1800428636542462, 'psi': 0.3945548329111734}
[S16] START round=6 head_norm_before_train=0.947500 cos_to_last_merge=0.9763 (last merge round=2)
[S16] round=6 local utility u=0.857871 metrics={'f1_val': 0.41546633441109837, 'auprc': 0.43484849312011387, 'loss_val': 1.165698175776327, 'psi': 0.4232191978947045}-{'f1_val': 0.14063745019920318, 'auprc': 0.43505352507993184, 'loss_val': 1.2330827026916207, 'psi': 0.2584038801514946}
[S17] START round=6 head_norm_before_train=0.824855 cos_to_last_merge=0.9658 (last merge round=2)
[S17] round=6 local utility u=0.069275 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5492651613308368, 'loss_val': 1.0795195773927366, 'psi': 0.3042754425227654}-{'f1_val': 0.14094896331738438, 'auprc': 0.5468593282022468, 'loss_val': 1.2108511240073838, 'psi': 0.3033131092713294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:49112
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49103
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49110
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1789) from S13
[S11] cosine check vs S13: cos=0.8789
[S6] RECEIVED delta(kind=head bytes=1801) from S9
[S6] cosine check vs S9: cos=-0.0159
[S6] DROPPED delta from S9 (cos=-0.0159 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S7
[S16] cosine check vs S7: cos=-0.0204
[S16] DROPPED delta from S7 (cos=-0.0204 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.8866
[S9] RECEIVED delta(kind=head bytes=1794) from S2
[S9] cosine check vs S2: cos=-0.0318
[S9] DROPPED delta from S2 (cos=-0.0318 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.9718
[S13] RECEIVED delta(kind=head bytes=1793) from S8
[S13] cosine check vs S8: cos=0.0022
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] cosine check vs S14: cos=-0.0346
[S10] DROPPED delta from S14 (cos=-0.0346 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:49111
[S16] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:49116
[S10] RECEIVED delta(kind=head bytes=1796) from S16
[S10] cosine check vs S16: cos=-0.0696
[S10] DROPPED delta from S16 (cos=-0.0696 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49104
[S4] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1794) from S4
[S7] cosine check vs S4: cos=0.9578
[S15] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S17] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S17
[S4] cosine check vs S17: cos=-0.0421
[S4] DROPPED delta from S17 (cos=-0.0421 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1789) from S15
[S2] cosine check vs S15: cos=-0.0522
[S2] DROPPED delta from S15 (cos=-0.0522 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] cosine check vs S5: cos=-0.0047
[S16] DROPPED delta from S5 (cos=-0.0047 < 0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=0.931752
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.564020e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=1.036316 delta_norm=0.256402
[S11] aggregate: ACCEPT kept=['S13', 'S6'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.1398 head_norm=1.127825
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.627659e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.1398 head_norm=1.197120 delta_norm=0.162766
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.878063
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.567254e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.942488 delta_norm=0.156725
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.4166 head_norm=1.071416
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.391835e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.4165 head_norm=0.740839 delta_norm=0.739183
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.914516 cos_to_last_merge=0.9535 (last merge round=1)
[S2] round=7 local utility u=0.063344 metrics={'f1_val': 0.41723085085657674, 'auprc': 0.7725432401792401, 'loss_val': 0.9044011507350339, 'psi': 0.5593558065856421}-{'f1_val': 0.4156703010573377, 'auprc': 0.7722637165940255, 'loss_val': 1.020888104134318, 'psi': 0.5583076672720129}
[S3] START round=7 head_norm_before_train=1.197120 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.056015 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6009049866326918, 'loss_val': 1.0830157376710707, 'psi': 0.32426603402154097}-{'f1_val': 0.13984006561410703, 'auprc': 0.6027646562399547, 'loss_val': 1.2006242718075162, 'psi': 0.3250099018644461}
[S4] START round=7 head_norm_before_train=1.026986 cos_to_last_merge=0.9488 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=7 local utility u=0.001208 metrics={'f1_val': 0.671020414449679, 'auprc': 0.7641491866484704, 'loss_val': 0.8165166211206015, 'psi': 0.7082719233291956}-{'f1_val': 0.6845865723171755, 'auprc': 0.7861492352713053, 'loss_val': 0.9663300137070852, 'psi': 0.7252116374988273}
[S5] START round=7 head_norm_before_train=0.831188 cos_to_last_merge=0.9564 (last merge round=1)
[S5] round=7 local utility u=0.266216 metrics={'f1_val': 0.41778996331732404, 'auprc': 0.7778193676297545, 'loss_val': 1.0556956258086703, 'psi': 0.5618017250422962}-{'f1_val': 0.34378383713061134, 'auprc': 0.7775766185532511, 'loss_val': 1.1433632743276876, 'psi': 0.5173009496996672}
[S6] START round=7 head_norm_before_train=1.378798 (no previous merge yet)
[S6] round=7 local utility u=0.721100 metrics={'f1_val': 0.6203403218268294, 'auprc': 0.79535816735616, 'loss_val': 0.7247066463562877, 'psi': 0.6903474600385617}-{'f1_val': 0.41705570454086727, 'auprc': 0.7811822805138249, 'loss_val': 0.9046712595215587, 'psi': 0.5627063349300503}
[S7] START round=7 head_norm_before_train=0.942488 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.006590 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7947222280602627, 'loss_val': 1.2495061222236605, 'psi': 0.4031229848615601}-{'f1_val': 0.14205682272909165, 'auprc': 0.7943473134163943, 'loss_val': 1.2615618165443778, 'psi': 0.4029730190040127}
[S8] START round=7 head_norm_before_train=1.021047 cos_to_last_merge=0.9578 (last merge round=1)
[S8] round=7 local utility u=0.093246 metrics={'f1_val': 0.7150623737829376, 'auprc': 0.776789942658742, 'loss_val': 0.9220191505536672, 'psi': 0.7397534013332594}-{'f1_val': 0.7147181481511302, 'auprc': 0.766471127150433, 'loss_val': 1.0754890744819725, 'psi': 0.7354193397508513}
[S9] START round=7 head_norm_before_train=1.302306 (no previous merge yet)
[S9] round=7 local utility u=0.114481 metrics={'f1_val': 0.7019393511300449, 'auprc': 1.0, 'loss_val': 0.5239643083220311, 'psi': 0.8211636106780269}-{'f1_val': 0.7007592215828227, 'auprc': 0.9999915285505216, 'loss_val': 0.7458201755581968, 'psi': 0.8204521443699022}
[S10] START round=7 head_norm_before_train=1.283429 (no previous merge yet)
[S10] round=7 local utility u=0.323813 metrics={'f1_val': 0.41753709103537934, 'auprc': 0.9827813062702044, 'loss_val': 0.8171850970279797, 'psi': 0.6436347771293094}-{'f1_val': 0.41725894337834635, 'auprc': 0.8295568666376233, 'loss_val': 1.0034693097270866, 'psi': 0.5821781126820571}
[S11] START round=7 head_norm_before_train=1.036316 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.033802 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7656051145607828, 'loss_val': 1.1229587910525938, 'psi': 0.3904902558481795}-{'f1_val': 0.14041368337311058, 'auprc': 0.7617863210254712, 'loss_val': 1.1791073074858918, 'psi': 0.3889627384340548}
[S13] START round=7 head_norm_before_train=0.740839 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.305301 metrics={'f1_val': 0.4161574336314925, 'auprc': 0.7323914645119085, 'loss_val': 1.0483810204136303, 'psi': 0.5426510459836589}-{'f1_val': 0.41655034241240063, 'auprc': 0.5487001834782244, 'loss_val': 1.1102667048207135, 'psi': 0.4694102788387301}
[S14] START round=7 head_norm_before_train=1.346378 (no previous merge yet)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.6816970913324021, 'auprc': 0.9960603223554849, 'loss_val': 0.8174152069079994, 'psi': 0.8074423837416352}-{'f1_val': 0.263548197492163, 'auprc': 0.9939341069218735, 'loss_val': 1.0261861216762, 'psi': 0.5557025612640472}
[S15] START round=7 head_norm_before_train=0.920671 cos_to_last_merge=0.9704 (last merge round=2)
[S15] round=7 local utility u=0.498913 metrics={'f1_val': 0.4181554011308932, 'auprc': 0.7999368949205198, 'loss_val': 0.9393956652280248, 'psi': 0.5708679986467439}-{'f1_val': 0.2872249006740771, 'auprc': 0.7774700822423184, 'loss_val': 1.084237847868922, 'psi': 0.48332297330137364}
[S16] START round=7 head_norm_before_train=0.980705 cos_to_last_merge=0.9642 (last merge round=2)
[S16] round=7 local utility u=0.047369 metrics={'f1_val': 0.4170395601558466, 'auprc': 0.4422563910272932, 'loss_val': 1.1026226174602627, 'psi': 0.42712629250442524}-{'f1_val': 0.41546633441109837, 'auprc': 0.43484849312011387, 'loss_val': 1.165698175776327, 'psi': 0.4232191978947045}
[S17] START round=7 head_norm_before_train=0.873078 cos_to_last_merge=0.9445 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=7 local utility u=0.882903 metrics={'f1_val': 0.3887230700335264, 'auprc': 0.6201222938848576, 'loss_val': 1.012929167165136, 'psi': 0.48128275957405886}-{'f1_val': 0.14094896331738438, 'auprc': 0.5492651613308368, 'loss_val': 1.0795195773927366, 'psi': 0.3042754425227654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S5] → sending delta(kind=head bytes=1786) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:49104
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S9
[S6] cosine check vs S9: cos=-0.0134
[S6] DROPPED delta from S9 (cos=-0.0134 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=-0.0138
[S16] DROPPED delta from S7 (cos=-0.0138 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.9420
[S10] RECEIVED delta(kind=head bytes=1795) from S16
[S10] cosine check vs S16: cos=-0.0682
[S10] DROPPED delta from S16 (cos=-0.0682 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S15
[S2] cosine check vs S15: cos=-0.0596
[S2] DROPPED delta from S15 (cos=-0.0596 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S8
[S13] cosine check vs S8: cos=0.6728
[S7] RECEIVED delta(kind=head bytes=1792) from S4
[S7] cosine check vs S4: cos=0.9788
[S16] RECEIVED delta(kind=head bytes=1789) from S11
[S16] cosine check vs S11: cos=-0.0967
[S16] DROPPED delta from S11 (cos=-0.0967 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S3
[S4] cosine check vs S3: cos=0.0555
[S9] RECEIVED delta(kind=head bytes=1794) from S2
[S9] cosine check vs S2: cos=-0.0295
[S9] DROPPED delta from S2 (cos=-0.0295 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=-0.0354
[S10] DROPPED delta from S14 (cos=-0.0354 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.9816
[S17] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S17
[S4] cosine check vs S17: cos=-0.0436
[S4] DROPPED delta from S17 (cos=-0.0436 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49112
[S5] sending update (kind=head size=1786 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1786) from S5
[S16] cosine check vs S5: cos=0.0119
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S13
[S11] cosine check vs S13: cos=0.6652
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.1398 head_norm=1.218304
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.315541e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.1398 head_norm=1.262736 delta_norm=0.131554
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4162 head_norm=0.773584
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.897895e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4163 head_norm=0.835701 delta_norm=0.389790
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6710 head_norm=1.077556
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.905117e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6846 head_norm=0.835337 delta_norm=0.790512
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4170 head_norm=1.022925
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.643369e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3980 head_norm=0.672145 delta_norm=0.664337
[S16] aggregate: ROLLBACK (f1_val pre=0.417 post=0.398 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.1404 head_norm=1.055593
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.999347e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3386 head_norm=1.007776 delta_norm=0.199935
[S11] aggregate: ACCEPT kept=['S6', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.955069
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.210771e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=1.010931 delta_norm=0.121077
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.956811 cos_to_last_merge=0.9414 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=8 local utility u=0.793241 metrics={'f1_val': 0.7011314218236641, 'auprc': 0.7029344819851044, 'loss_val': 0.8124954514572589, 'psi': 0.7018526458882403}-{'f1_val': 0.41723085085657674, 'auprc': 0.7725432401792401, 'loss_val': 0.9044011507350339, 'psi': 0.5593558065856421}
[S3] START round=8 head_norm_before_train=1.262736 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=1.000000 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.7961477240248462, 'loss_val': 0.9100136510190249, 'psi': 0.556330445499211}-{'f1_val': 0.13984006561410703, 'auprc': 0.6009049866326918, 'loss_val': 1.0830157376710707, 'psi': 0.32426603402154097}
[S4] START round=8 head_norm_before_train=0.835337 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000450 metrics={'f1_val': 0.6847975829174954, 'auprc': 0.7599499767652047, 'loss_val': 0.8856816192182907, 'psi': 0.714858540456579}-{'f1_val': 0.671020414449679, 'auprc': 0.7641491866484704, 'loss_val': 0.8165166211206015, 'psi': 0.7082719233291956}
[S5] START round=8 head_norm_before_train=0.860157 cos_to_last_merge=0.9426 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=8 local utility u=0.055965 metrics={'f1_val': 0.4183544144322735, 'auprc': 0.7776204669351043, 'loss_val': 0.9465563056465618, 'psi': 0.5620608354334058}-{'f1_val': 0.41778996331732404, 'auprc': 0.7778193676297545, 'loss_val': 1.0556956258086703, 'psi': 0.5618017250422962}
[S6] START round=8 head_norm_before_train=1.415990 (no previous merge yet)
[S6] round=8 local utility u=0.348040 metrics={'f1_val': 0.7109143487535409, 'auprc': 0.7946308757486695, 'loss_val': 0.5698894511178466, 'psi': 0.7444009595515924}-{'f1_val': 0.6203403218268294, 'auprc': 0.79535816735616, 'loss_val': 0.7247066463562877, 'psi': 0.6903474600385617}
[S7] START round=8 head_norm_before_train=1.010931 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.020995 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7947563124880794, 'loss_val': 1.2076179865775238, 'psi': 0.4031366186326868}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947222280602627, 'loss_val': 1.2495061222236605, 'psi': 0.4031229848615601}
[S8] START round=8 head_norm_before_train=1.049873 cos_to_last_merge=0.9475 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=8 local utility u=0.151855 metrics={'f1_val': 0.7148118385281752, 'auprc': 0.7942883215663467, 'loss_val': 0.6693002816656619, 'psi': 0.7466024317434438}-{'f1_val': 0.7150623737829376, 'auprc': 0.776789942658742, 'loss_val': 0.9220191505536672, 'psi': 0.7397534013332594}
[S9] START round=8 head_norm_before_train=1.351347 (no previous merge yet)
[S9] round=8 local utility u=0.068731 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9999891039685185, 'loss_val': 0.38452267477474916, 'psi': 0.8209645510183444}-{'f1_val': 0.7019393511300449, 'auprc': 1.0, 'loss_val': 0.5239643083220311, 'psi': 0.8211636106780269}
[S10] START round=8 head_norm_before_train=1.318845 (no previous merge yet)
[S10] round=8 local utility u=0.950292 metrics={'f1_val': 0.7010383579272179, 'auprc': 0.9972398164328, 'loss_val': 0.6609837327741306, 'psi': 0.8195189413294508}-{'f1_val': 0.41753709103537934, 'auprc': 0.9827813062702044, 'loss_val': 0.8171850970279797, 'psi': 0.6436347771293094}
[S11] START round=8 head_norm_before_train=1.007776 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.882851 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.8141038385715809, 'loss_val': 1.039583550900138, 'psi': 0.5635728769843561}-{'f1_val': 0.14041368337311058, 'auprc': 0.7656051145607828, 'loss_val': 1.1229587910525938, 'psi': 0.3904902558481795}
[S13] START round=8 head_norm_before_train=0.835701 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.056736 metrics={'f1_val': 0.41055100908422737, 'auprc': 0.767270852974978, 'loss_val': 1.005908929543088, 'psi': 0.5532389466405276}-{'f1_val': 0.4161574336314925, 'auprc': 0.7323914645119085, 'loss_val': 1.0483810204136303, 'psi': 0.5426510459836589}
[S14] START round=8 head_norm_before_train=1.397911 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.6206813190358449, 'auprc': 0.993405239315203, 'loss_val': 0.627316080970524, 'psi': 0.7697708871475881}-{'f1_val': 0.6816970913324021, 'auprc': 0.9960603223554849, 'loss_val': 0.8174152069079994, 'psi': 0.8074423837416352}
[S15] START round=8 head_norm_before_train=0.969884 cos_to_last_merge=0.9563 (last merge round=2)
[S15] round=8 local utility u=0.919170 metrics={'f1_val': 0.6950074928337716, 'auprc': 0.7993108624079239, 'loss_val': 0.7602899427111526, 'psi': 0.7367288406634325}-{'f1_val': 0.4181554011308932, 'auprc': 0.7999368949205198, 'loss_val': 0.9393956652280248, 'psi': 0.5708679986467439}
[S16] START round=8 head_norm_before_train=0.672145 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.117516 metrics={'f1_val': 0.4171177572574632, 'auprc': 0.4871702139594094, 'loss_val': 1.0028014990871157, 'psi': 0.4451387399382417}-{'f1_val': 0.4170395601558466, 'auprc': 0.4422563910272932, 'loss_val': 1.1026226174602627, 'psi': 0.42712629250442524}
[S17] START round=8 head_norm_before_train=0.927112 cos_to_last_merge=0.9220 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.922
[S17] round=8 local utility u=0.052821 metrics={'f1_val': 0.37071457217305703, 'auprc': 0.6623938814022229, 'loss_val': 0.9260503192533605, 'psi': 0.4873862958647234}-{'f1_val': 0.3887230700335264, 'auprc': 0.6201222938848576, 'loss_val': 1.012929167165136, 'psi': 0.48128275957405886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:49104
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49104
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1805) from S6
[S11] cosine check vs S6: cos=0.9508
[S2] RECEIVED delta(kind=head bytes=1791) from S15
[S2] cosine check vs S15: cos=-0.0708
[S2] DROPPED delta from S15 (cos=-0.0708 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1789) from S2
[S9] cosine check vs S2: cos=-0.0285
[S9] DROPPED delta from S2 (cos=-0.0285 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S16
[S10] cosine check vs S16: cos=-0.0802
[S10] DROPPED delta from S16 (cos=-0.0802 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1789) from S8
[S13] cosine check vs S8: cos=0.9197
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] cosine check vs S10: cos=0.9839
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.0116
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.7281
[S16] RECEIVED delta(kind=head bytes=1789) from S11
[S16] cosine check vs S11: cos=-0.0421
[S16] DROPPED delta from S11 (cos=-0.0421 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S13
[S11] cosine check vs S13: cos=0.4480
[S4] RECEIVED delta(kind=head bytes=1796) from S3
[S4] cosine check vs S3: cos=0.7238
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.6194
[S6] RECEIVED delta(kind=head bytes=1794) from S9
[S6] cosine check vs S9: cos=-0.0104
[S6] DROPPED delta from S9 (cos=-0.0104 < 0.0)
[S17] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S17
[S4] cosine check vs S17: cos=-0.0397
[S4] DROPPED delta from S17 (cos=-0.0397 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4106 head_norm=0.858159
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.262119e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.5668 head_norm=0.955161 delta_norm=0.226212
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=1.031035
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.978507e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3965 head_norm=0.975613 delta_norm=0.197851
[S11] aggregate: ACCEPT kept=['S6', 'S13'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3965 head_norm=1.291371
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.233689e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.3965 head_norm=1.319052 delta_norm=0.123369
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6848 head_norm=0.878260
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.464535e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.1394 head_norm=1.010034 delta_norm=0.446454
[S4] aggregate: ROLLBACK (f1_val pre=0.685 post=0.139 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=1.023793
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.570916e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.884439 delta_norm=0.357092
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4171 head_norm=0.722131
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.817065e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4171 head_norm=0.592015 delta_norm=0.381707
[S16] aggregate: ACCEPT kept=['S7', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.001181 cos_to_last_merge=0.9290 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=9 local utility u=0.019754 metrics={'f1_val': 0.7016512288906386, 'auprc': 0.6804739523723525, 'loss_val': 0.7087256881511185, 'psi': 0.6931803182833242}-{'f1_val': 0.7011314218236641, 'auprc': 0.7029344819851044, 'loss_val': 0.8124954514572589, 'psi': 0.7018526458882403}
[S3] START round=9 head_norm_before_train=1.319052 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.4010090932274478, 'auprc': 0.49852728983018674, 'loss_val': 0.9543353743693216, 'psi': 0.44001637186854337}-{'f1_val': 0.39645225981545407, 'auprc': 0.7961477240248462, 'loss_val': 0.9100136510190249, 'psi': 0.556330445499211}
[S4] START round=9 head_norm_before_train=1.010034 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6690757213523549, 'auprc': 0.6596788891010863, 'loss_val': 0.9116811164738706, 'psi': 0.6653169884518475}-{'f1_val': 0.6847975829174954, 'auprc': 0.7599499767652047, 'loss_val': 0.8856816192182907, 'psi': 0.714858540456579}
[S5] START round=9 head_norm_before_train=0.896437 cos_to_last_merge=0.9265 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.4209705357893008, 'auprc': 0.7030785780626073, 'loss_val': 0.8238695038551515, 'psi': 0.5338137526986235}-{'f1_val': 0.4183544144322735, 'auprc': 0.7776204669351043, 'loss_val': 0.9465563056465618, 'psi': 0.5620608354334058}
[S6] START round=9 head_norm_before_train=1.457634 (no previous merge yet)
[S6] round=9 local utility u=0.066961 metrics={'f1_val': 0.7090799650827257, 'auprc': 0.8185710560399366, 'loss_val': 0.4967819509123871, 'psi': 0.7528764014656102}-{'f1_val': 0.7109143487535409, 'auprc': 0.7946308757486695, 'loss_val': 0.5698894511178466, 'psi': 0.7444009595515924}
[S7] START round=9 head_norm_before_train=0.884439 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.035031 metrics={'f1_val': 0.14542905287040098, 'auprc': 0.794255113403583, 'loss_val': 1.1562855645764374, 'psi': 0.4049594770836738}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947563124880794, 'loss_val': 1.2076179865775238, 'psi': 0.4031366186326868}
[S8] START round=9 head_norm_before_train=1.091133 cos_to_last_merge=0.9327 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=9 local utility u=0.359214 metrics={'f1_val': 0.7014213376597901, 'auprc': 0.998240661118106, 'loss_val': 0.48238716079701127, 'psi': 0.8201490670431164}-{'f1_val': 0.7148118385281752, 'auprc': 0.7942883215663467, 'loss_val': 0.6693002816656619, 'psi': 0.7466024317434438}
[S9] START round=9 head_norm_before_train=1.404367 (no previous merge yet)
[S9] round=9 local utility u=0.034313 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.999212969775017, 'loss_val': 0.31312302848299345, 'psi': 0.82060958643117}-{'f1_val': 0.7016148490515617, 'auprc': 0.9999891039685185, 'loss_val': 0.38452267477474916, 'psi': 0.8209645510183444}
[S10] START round=9 head_norm_before_train=1.357423 (no previous merge yet)
[S10] round=9 local utility u=0.056227 metrics={'f1_val': 0.7015841095497508, 'auprc': 0.9961257051664854, 'loss_val': 0.5484615897422243, 'psi': 0.8194007477964447}-{'f1_val': 0.7010383579272179, 'auprc': 0.9972398164328, 'loss_val': 0.6609837327741306, 'psi': 0.8195189413294508}
[S11] START round=9 head_norm_before_train=0.975613 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.128869 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.8636822689733572, 'loss_val': 0.9307834620665373, 'psi': 0.5834245203595566}-{'f1_val': 0.39655223592620625, 'auprc': 0.8141038385715809, 'loss_val': 1.039583550900138, 'psi': 0.5635728769843561}
[S13] START round=9 head_norm_before_train=0.955161 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.940713 metrics={'f1_val': 0.7127233202473238, 'auprc': 0.7698026446219951, 'loss_val': 0.945111408151369, 'psi': 0.7355550499971923}-{'f1_val': 0.41055100908422737, 'auprc': 0.767270852974978, 'loss_val': 1.005908929543088, 'psi': 0.5532389466405276}
[S14] START round=9 head_norm_before_train=1.455977 (no previous merge yet)
[S14] round=9 local utility u=0.068579 metrics={'f1_val': 0.6207698773071875, 'auprc': 0.9919350112401459, 'loss_val': 0.48627959789518427, 'psi': 0.7692359308803709}-{'f1_val': 0.6206813190358449, 'auprc': 0.993405239315203, 'loss_val': 0.627316080970524, 'psi': 0.7697708871475881}
[S15] START round=9 head_norm_before_train=1.026676 cos_to_last_merge=0.9386 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=9 local utility u=0.058462 metrics={'f1_val': 0.6883823471435104, 'auprc': 0.7987935670334554, 'loss_val': 0.6020622663223978, 'psi': 0.7325468350994884}-{'f1_val': 0.6950074928337716, 'auprc': 0.7993108624079239, 'loss_val': 0.7602899427111526, 'psi': 0.7367288406634325}
[S16] START round=9 head_norm_before_train=0.592015 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3129693796360463, 'auprc': 0.5429893087870907, 'loss_val': 1.104880654551875, 'psi': 0.40497735129646406}-{'f1_val': 0.4171177572574632, 'auprc': 0.4871702139594094, 'loss_val': 1.0028014990871157, 'psi': 0.4451387399382417}
[S17] START round=9 head_norm_before_train=0.983804 cos_to_last_merge=0.8985 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.899
[S17] round=9 local utility u=0.347755 metrics={'f1_val': 0.3666574925578997, 'auprc': 0.8824951339253031, 'loss_val': 0.8665018440465286, 'psi': 0.5729925491048611}-{'f1_val': 0.37071457217305703, 'auprc': 0.6623938814022229, 'loss_val': 0.9260503192533605, 'psi': 0.4873862958647234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:49102
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:49113
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:49116
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49112
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:49104
[S10] sending update (kind=head size=1807 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1792) from S15
[S2] cosine check vs S15: cos=-0.0805
[S2] DROPPED delta from S15 (cos=-0.0805 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1788) from S2
[S9] cosine check vs S2: cos=-0.0271
[S9] DROPPED delta from S2 (cos=-0.0271 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] cosine check vs S14: cos=-0.0362
[S10] DROPPED delta from S14 (cos=-0.0362 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1789) from S8
[S13] cosine check vs S8: cos=0.9690
[S16] RECEIVED delta(kind=head bytes=1790) from S11
[S16] cosine check vs S11: cos=0.0745
[S16] RECEIVED delta(kind=head bytes=1794) from S7
[S16] cosine check vs S7: cos=0.3717
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.9334
[S11] RECEIVED delta(kind=head bytes=1799) from S13
[S11] cosine check vs S13: cos=0.4337
[S3] RECEIVED delta(kind=head bytes=1807) from S10
[S3] cosine check vs S10: cos=0.9861
[S6] RECEIVED delta(kind=head bytes=1802) from S9
[S6] cosine check vs S9: cos=-0.0079
[S6] DROPPED delta from S9 (cos=-0.0079 < 0.0)
[S17] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S17
[S4] cosine check vs S17: cos=-0.0320
[S4] DROPPED delta from S17 (cos=-0.0320 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4010 head_norm=1.348203
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.169294e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.4010 head_norm=1.367265 delta_norm=0.116929
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3966 head_norm=1.005910
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.718129e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.3966 head_norm=0.971072 delta_norm=0.171813
[S11] aggregate: ACCEPT kept=['S6', 'S13'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.7127 head_norm=0.975011
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.545718e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.7116 head_norm=1.048661 delta_norm=0.154572
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3130 head_norm=0.644880
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.034003e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4434 head_norm=0.542765 delta_norm=0.403400
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.053583 cos_to_last_merge=0.9153 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.915
[S2] round=10 local utility u=0.024664 metrics={'f1_val': 0.7013698608266565, 'auprc': 0.6654579057360162, 'loss_val': 0.612660550849765, 'psi': 0.6870050787904004}-{'f1_val': 0.7016512288906386, 'auprc': 0.6804739523723525, 'loss_val': 0.7087256881511185, 'psi': 0.6931803182833242}
[S3] START round=10 head_norm_before_train=1.367265 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.721486 metrics={'f1_val': 0.4562488656896544, 'auprc': 0.827080532489813, 'loss_val': 0.8284623650096103, 'psi': 0.6045815324097178}-{'f1_val': 0.4010090932274478, 'auprc': 0.49852728983018674, 'loss_val': 0.9543353743693216, 'psi': 0.44001637186854337}
[S4] START round=10 head_norm_before_train=1.039179 cos_to_last_merge=0.9944 (last merge round=8)
[S4] round=10 local utility u=0.137707 metrics={'f1_val': 0.6888975161202306, 'auprc': 0.6623384846956097, 'loss_val': 0.763176754706985, 'psi': 0.6782739035503822}-{'f1_val': 0.6690757213523549, 'auprc': 0.6596788891010863, 'loss_val': 0.9116811164738706, 'psi': 0.6653169884518475}
[S5] START round=10 head_norm_before_train=0.938091 cos_to_last_merge=0.9082 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.908
[S5] round=10 local utility u=0.349239 metrics={'f1_val': 0.5096470052761962, 'auprc': 0.7313249048355281, 'loss_val': 0.7421884042637931, 'psi': 0.598318165099929}-{'f1_val': 0.4209705357893008, 'auprc': 0.7030785780626073, 'loss_val': 0.8238695038551515, 'psi': 0.5338137526986235}
[S6] START round=10 head_norm_before_train=1.492771 (no previous merge yet)
[S6] round=10 local utility u=0.006090 metrics={'f1_val': 0.7086184894012433, 'auprc': 0.8045491709871173, 'loss_val': 0.43976815322560486, 'psi': 0.7469907620355929}-{'f1_val': 0.7090799650827257, 'auprc': 0.8185710560399366, 'loss_val': 0.4967819509123871, 'psi': 0.7528764014656102}
[S7] START round=10 head_norm_before_train=0.898494 cos_to_last_merge=0.9987 (last merge round=8)
[S7] round=10 local utility u=0.813754 metrics={'f1_val': 0.41736073619820624, 'auprc': 0.7597626996370822, 'loss_val': 1.0568905382091665, 'psi': 0.5543215215737567}-{'f1_val': 0.14542905287040098, 'auprc': 0.794255113403583, 'loss_val': 1.1562855645764374, 'psi': 0.4049594770836738}
[S8] START round=10 head_norm_before_train=1.138648 cos_to_last_merge=0.9153 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.915
[S8] round=10 local utility u=0.063903 metrics={'f1_val': 0.7011788703025013, 'auprc': 0.9981701954416973, 'loss_val': 0.35291397208674147, 'psi': 0.8199754003581796}-{'f1_val': 0.7014213376597901, 'auprc': 0.998240661118106, 'loss_val': 0.48238716079701127, 'psi': 0.8201490670431164}
[S9] START round=10 head_norm_before_train=1.454489 (no previous merge yet)
[S9] round=10 local utility u=0.018809 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9987043395828982, 'loss_val': 0.2739782646769682, 'psi': 0.8204061343543225}-{'f1_val': 0.7015406642019387, 'auprc': 0.999212969775017, 'loss_val': 0.31312302848299345, 'psi': 0.82060958643117}
[S10] START round=10 head_norm_before_train=1.395895 (no previous merge yet)
[S10] round=10 local utility u=0.038912 metrics={'f1_val': 0.7004153280614968, 'auprc': 0.9943463413787903, 'loss_val': 0.4582859013376371, 'psi': 0.8179877333884142}-{'f1_val': 0.7015841095497508, 'auprc': 0.9961257051664854, 'loss_val': 0.5484615897422243, 'psi': 0.8194007477964447}
[S11] START round=10 head_norm_before_train=0.971072 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.956144 metrics={'f1_val': 0.6544446866214392, 'auprc': 0.9409738202618029, 'loss_val': 0.7975216017938954, 'psi': 0.7690563400775847}-{'f1_val': 0.39658602128368947, 'auprc': 0.8636822689733572, 'loss_val': 0.9307834620665373, 'psi': 0.5834245203595566}
[S13] START round=10 head_norm_before_train=1.048661 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.001419 metrics={'f1_val': 0.7023120888141094, 'auprc': 0.7727737437257005, 'loss_val': 0.8887198832576145, 'psi': 0.7304967507787459}-{'f1_val': 0.7127233202473238, 'auprc': 0.7698026446219951, 'loss_val': 0.945111408151369, 'psi': 0.7355550499971923}
[S14] START round=10 head_norm_before_train=1.518525 (no previous merge yet)
[S14] round=10 local utility u=0.030494 metrics={'f1_val': 0.6203210244220432, 'auprc': 0.9955906676168181, 'loss_val': 0.4335647637001888, 'psi': 0.7704288816999532}-{'f1_val': 0.6207698773071875, 'auprc': 0.9919350112401459, 'loss_val': 0.48627959789518427, 'psi': 0.7692359308803709}
[S15] START round=10 head_norm_before_train=1.088789 cos_to_last_merge=0.9188 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.919
[S15] round=10 local utility u=0.023369 metrics={'f1_val': 0.6986491512773245, 'auprc': 0.7985783739955483, 'loss_val': 0.6162804086547846, 'psi': 0.7386208403646141}-{'f1_val': 0.6883823471435104, 'auprc': 0.7987935670334554, 'loss_val': 0.6020622663223978, 'psi': 0.7325468350994884}
[S16] START round=10 head_norm_before_train=0.542765 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.439080 metrics={'f1_val': 0.37306682176001427, 'auprc': 0.7022379905097345, 'loss_val': 1.0650514767169044, 'psi': 0.5047352892599024}-{'f1_val': 0.3129693796360463, 'auprc': 0.5429893087870907, 'loss_val': 1.104880654551875, 'psi': 0.40497735129646406}
[S17] START round=10 head_norm_before_train=1.034820 cos_to_last_merge=0.8781 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.878
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3558080841894575, 'auprc': 0.8198777853218577, 'loss_val': 0.9141772205602161, 'psi': 0.5414359646424176}-{'f1_val': 0.3666574925578997, 'auprc': 0.8824951339253031, 'loss_val': 0.8665018440465286, 'psi': 0.5729925491048611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:49113
[S3] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S15
[S2] cosine check vs S15: cos=-0.0841
[S2] DROPPED delta from S15 (cos=-0.0841 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.5065
[S6] RECEIVED delta(kind=head bytes=1804) from S9
[S6] cosine check vs S9: cos=-0.0070
[S6] DROPPED delta from S9 (cos=-0.0070 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S8
[S13] cosine check vs S8: cos=0.9797
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] cosine check vs S4: cos=0.7371
[S10] RECEIVED delta(kind=head bytes=1802) from S16
[S10] cosine check vs S16: cos=0.1444
[S4] RECEIVED delta(kind=head bytes=1804) from S3
[S4] cosine check vs S3: cos=0.8840
[S9] RECEIVED delta(kind=head bytes=1795) from S2
[S9] cosine check vs S2: cos=-0.0240
[S9] DROPPED delta from S2 (cos=-0.0240 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] cosine check vs S14: cos=-0.0346
[S10] DROPPED delta from S14 (cos=-0.0346 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.9050
[S11] RECEIVED delta(kind=head bytes=1801) from S13
[S11] cosine check vs S13: cos=0.4838
[S3] RECEIVED delta(kind=head bytes=1805) from S10
[S3] cosine check vs S10: cos=0.9889
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.6325
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.4708
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6889 head_norm=1.085409
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.347667e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6464 head_norm=1.204947 delta_norm=0.334767
[S4] aggregate: ROLLBACK (f1_val pre=0.689 post=0.646 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.237 → S7@127.0.0.1:49108
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.6544 head_norm=1.007199
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.433496e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7009 head_norm=0.990419 delta_norm=0.143350
[S11] aggregate: ACCEPT kept=['S6', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.458 → S16@127.0.0.1:49116
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.7023 head_norm=1.069076
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.276548e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.7132 head_norm=1.122001 delta_norm=0.127655
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.363 → S11@127.0.0.1:49112
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.4562 head_norm=1.396359
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.080383e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.4620 head_norm=1.415462 delta_norm=0.108038
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.413 → S4@127.0.0.1:49104
[S9] ⇄ pheromone p=0.236 → S6@127.0.0.1:49107
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4174 head_norm=0.914622
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.711888e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4176 head_norm=0.932492 delta_norm=0.371189
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.281 → S16@127.0.0.1:49116
[S14] ⇄ pheromone p=0.297 → S10@127.0.0.1:49111
[S5] ⇄ pheromone p=0.291 → S16@127.0.0.1:49116
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3731 head_norm=0.591011
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.714109e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.6091 head_norm=0.577462 delta_norm=0.171411
[S16] aggregate: ACCEPT kept=['S11', 'S7', 'S5'] (k=3/3) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.301 → S10@127.0.0.1:49111
[S8] ⇄ pheromone p=0.319 → S13@127.0.0.1:49113
[S6] ⇄ pheromone p=0.329 → S11@127.0.0.1:49112
[S15] ⇄ pheromone p=0.334 → S2@127.0.0.1:49102
[S2] ⇄ pheromone p=0.314 → S9@127.0.0.1:49110
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.7004 head_norm=1.442426
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.388698e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.7003 head_norm=0.817933 delta_norm=0.738870
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.385 → S3@127.0.0.1:49103
[S17] ⇄ pheromone p=0.278 → S4@127.0.0.1:49104
[S2] START round=11 head_norm_before_train=1.110046 cos_to_last_merge=0.9017 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=11 local utility u=0.023916 metrics={'f1_val': 0.7007506352015501, 'auprc': 0.655248185094608, 'loss_val': 0.5304842997947721, 'psi': 0.6825496551587733}-{'f1_val': 0.7013698608266565, 'auprc': 0.6654579057360162, 'loss_val': 0.612660550849765, 'psi': 0.6870050787904004}
[S3] START round=11 head_norm_before_train=1.415462 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.4045316402820668, 'auprc': 0.7229852417655104, 'loss_val': 0.8440481009078831, 'psi': 0.5319130808754442}-{'f1_val': 0.4562488656896544, 'auprc': 0.827080532489813, 'loss_val': 0.8284623650096103, 'psi': 0.6045815324097178}
[S4] START round=11 head_norm_before_train=1.204947 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.288238 metrics={'f1_val': 0.6851436893092098, 'auprc': 0.8552830315971974, 'loss_val': 0.7430119208268552, 'psi': 0.7531994262244048}-{'f1_val': 0.6888975161202306, 'auprc': 0.6623384846956097, 'loss_val': 0.763176754706985, 'psi': 0.6782739035503822}
[S5] START round=11 head_norm_before_train=0.977301 cos_to_last_merge=0.8899 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.890
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.49638074345117283, 'auprc': 0.6626322330978309, 'loss_val': 0.6716006925395873, 'psi': 0.5628813393098361}-{'f1_val': 0.5096470052761962, 'auprc': 0.7313249048355281, 'loss_val': 0.7421884042637931, 'psi': 0.598318165099929}
[S6] START round=11 head_norm_before_train=1.535627 (no previous merge yet)
[S6] round=11 local utility u=0.268599 metrics={'f1_val': 0.7082494834376265, 'auprc': 0.9563005945981313, 'loss_val': 0.35560980669236486, 'psi': 0.8074699279018285}-{'f1_val': 0.7086184894012433, 'auprc': 0.8045491709871173, 'loss_val': 0.43976815322560486, 'psi': 0.7469907620355929}
[S7] START round=11 head_norm_before_train=0.932492 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.68165480523358, 'loss_val': 0.9864563797230819, 'psi': 0.5228831783862009}-{'f1_val': 0.41736073619820624, 'auprc': 0.7597626996370822, 'loss_val': 1.0568905382091665, 'psi': 0.5543215215737567}
[S8] START round=11 head_norm_before_train=1.186356 cos_to_last_merge=0.8960 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.896
[S8] round=11 local utility u=0.065493 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9967305325375224, 'loss_val': 0.29557944975654954, 'psi': 0.8271964963961004}-{'f1_val': 0.7011788703025013, 'auprc': 0.9981701954416973, 'loss_val': 0.35291397208674147, 'psi': 0.8199754003581796}
[S9] START round=11 head_norm_before_train=1.502076 (no previous merge yet)
[S9] round=11 local utility u=0.027502 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9982108566203212, 'loss_val': 0.2170502351878591, 'psi': 0.8201643990263315}-{'f1_val': 0.7015406642019387, 'auprc': 0.9987043395828982, 'loss_val': 0.2739782646769682, 'psi': 0.8204061343543225}
[S10] START round=11 head_norm_before_train=0.817933 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6994096875300115, 'auprc': 0.9714780620420471, 'loss_val': 0.551331385112675, 'psi': 0.8082370373348258}-{'f1_val': 0.7004153280614968, 'auprc': 0.9943463413787903, 'loss_val': 0.4582859013376371, 'psi': 0.8179877333884142}
[S11] START round=11 head_norm_before_train=0.990419 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.5402593573382857, 'auprc': 0.8706850045464509, 'loss_val': 0.7609571586082375, 'psi': 0.6724296162215517}-{'f1_val': 0.6544446866214392, 'auprc': 0.9409738202618029, 'loss_val': 0.7975216017938954, 'psi': 0.7690563400775847}
[S13] START round=11 head_norm_before_train=1.122001 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.009296 metrics={'f1_val': 0.6940171140030335, 'auprc': 0.7676507210765956, 'loss_val': 0.8049891415429332, 'psi': 0.7234705568324583}-{'f1_val': 0.7023120888141094, 'auprc': 0.7727737437257005, 'loss_val': 0.8887198832576145, 'psi': 0.7304967507787459}
[S14] START round=11 head_norm_before_train=1.579499 (no previous merge yet)
[S14] round=11 local utility u=1.000000 metrics={'f1_val': 0.9930918669538628, 'auprc': 0.9905630945523506, 'loss_val': 0.26643077878231775, 'psi': 0.992080357993258}-{'f1_val': 0.6203210244220432, 'auprc': 0.9955906676168181, 'loss_val': 0.4335647637001888, 'psi': 0.7704288816999532}
[S15] START round=11 head_norm_before_train=1.148374 cos_to_last_merge=0.9018 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.902
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.650994531019276, 'auprc': 0.7648638906004241, 'loss_val': 0.547115836504469, 'psi': 0.6965422748517353}-{'f1_val': 0.6986491512773245, 'auprc': 0.7985783739955483, 'loss_val': 0.6162804086547846, 'psi': 0.7386208403646141}
[S16] START round=11 head_norm_before_train=0.577462 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.074966 metrics={'f1_val': 0.39171561978608693, 'auprc': 0.6908175835464633, 'loss_val': 0.9927508151161661, 'psi': 0.5113564052902375}-{'f1_val': 0.37306682176001427, 'auprc': 0.7022379905097345, 'loss_val': 1.0650514767169044, 'psi': 0.5047352892599024}
[S17] START round=11 head_norm_before_train=1.075630 cos_to_last_merge=0.8627 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.863
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.34392049867172314, 'auprc': 0.6770359177750562, 'loss_val': 1.0551431646327567, 'psi': 0.4771666663130564}-{'f1_val': 0.3558080841894575, 'auprc': 0.8198777853218577, 'loss_val': 0.9141772205602161, 'psi': 0.5414359646424176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:49111
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49110
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49112
[S13] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S2
[S9] cosine check vs S2: cos=-0.0182
[S9] DROPPED delta from S2 (cos=-0.0182 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S9
[S6] cosine check vs S9: cos=-0.0068
[S6] DROPPED delta from S9 (cos=-0.0068 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S8
[S13] cosine check vs S8: cos=0.9834
[S11] RECEIVED delta(kind=head bytes=1796) from S13
[S11] cosine check vs S13: cos=0.5367
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:49111
[S16] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:49108
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49112
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1796) from S16
[S10] cosine check vs S16: cos=0.4567
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.8781
[S7] RECEIVED delta(kind=head bytes=1804) from S4
[S7] cosine check vs S4: cos=0.8561
[S14] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] cosine check vs S14: cos=0.0027
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.5403 head_norm=1.028283
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.208637e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.5626 head_norm=1.021513 delta_norm=0.120864
[S11] aggregate: ACCEPT kept=['S13', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6940 head_norm=1.145985
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.173894e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.7128 head_norm=1.185733 delta_norm=0.117389
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4170 head_norm=0.955045
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.245198e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4172 head_norm=1.057524 delta_norm=0.324520
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6994 head_norm=0.876172
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.682184e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6896 head_norm=0.670509 delta_norm=0.568218
[S10] aggregate: ROLLBACK (f1_val pre=0.699 post=0.690 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.167420 cos_to_last_merge=0.8884 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.888
[S2] round=12 local utility u=0.005234 metrics={'f1_val': 0.6902904712377866, 'auprc': 0.6631131282377529, 'loss_val': 0.4808502981166304, 'psi': 0.6794195340377731}-{'f1_val': 0.7007506352015501, 'auprc': 0.655248185094608, 'loss_val': 0.5304842997947721, 'psi': 0.6825496551587733}
[S3] START round=12 head_norm_before_train=1.447487 cos_to_last_merge=0.9986 (last merge round=10)
[S3] round=12 local utility u=1.000000 metrics={'f1_val': 0.5758726154573205, 'auprc': 0.9793216558676274, 'loss_val': 0.6397024396201599, 'psi': 0.7372522316214433}-{'f1_val': 0.4045316402820668, 'auprc': 0.7229852417655104, 'loss_val': 0.8440481009078831, 'psi': 0.5319130808754442}
[S4] START round=12 head_norm_before_train=1.239044 cos_to_last_merge=0.9963 (last merge round=10)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6658669659078432, 'auprc': 0.6571921197654425, 'loss_val': 0.6214557061350131, 'psi': 0.6623970274508829}-{'f1_val': 0.6851436893092098, 'auprc': 0.8552830315971974, 'loss_val': 0.7430119208268552, 'psi': 0.7531994262244048}
[S5] START round=12 head_norm_before_train=1.011327 cos_to_last_merge=0.8737 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.874
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.777191823751661, 'loss_val': 0.7411116772876782, 'psi': 0.5615007520604818}-{'f1_val': 0.49638074345117283, 'auprc': 0.6626322330978309, 'loss_val': 0.6716006925395873, 'psi': 0.5628813393098361}
[S6] START round=12 head_norm_before_train=1.578631 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6897577689102741, 'auprc': 0.9542432409845387, 'loss_val': 0.3229193846295656, 'psi': 0.7955519577399799}-{'f1_val': 0.7082494834376265, 'auprc': 0.9563005945981313, 'loss_val': 0.35560980669236486, 'psi': 0.8074699279018285}
[S7] START round=12 head_norm_before_train=1.057524 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.6329707971070964, 'loss_val': 0.9312121844797363, 'psi': 0.5034095751356074}-{'f1_val': 0.41703542715461484, 'auprc': 0.68165480523358, 'loss_val': 0.9864563797230819, 'psi': 0.5228831783862009}
[S8] START round=12 head_norm_before_train=1.235396 cos_to_last_merge=0.8778 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.878
[S8] round=12 local utility u=0.005772 metrics={'f1_val': 0.7048132020486533, 'auprc': 0.9983507317447113, 'loss_val': 0.2327323052288331, 'psi': 0.8222282139270765}-{'f1_val': 0.7141738056351523, 'auprc': 0.9967305325375224, 'loss_val': 0.29557944975654954, 'psi': 0.8271964963961004}
[S9] START round=12 head_norm_before_train=1.542880 (no previous merge yet)
[S9] round=12 local utility u=0.012463 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982126296655343, 'loss_val': 0.19062769392976692, 'psi': 0.8200150003302249}-{'f1_val': 0.7014667606303384, 'auprc': 0.9982108566203212, 'loss_val': 0.2170502351878591, 'psi': 0.8201643990263315}
[S10] START round=12 head_norm_before_train=0.670509 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.6881539807460799, 'auprc': 0.9887170664074094, 'loss_val': 0.6184383045583616, 'psi': 0.8083792150106117}-{'f1_val': 0.6994096875300115, 'auprc': 0.9714780620420471, 'loss_val': 0.551331385112675, 'psi': 0.8082370373348258}
[S11] START round=12 head_norm_before_train=1.021513 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.540955 metrics={'f1_val': 0.6514951443014879, 'auprc': 0.9677427880075435, 'loss_val': 0.6376344283185087, 'psi': 0.7779942017839101}-{'f1_val': 0.5402593573382857, 'auprc': 0.8706850045464509, 'loss_val': 0.7609571586082375, 'psi': 0.6724296162215517}
[S13] START round=12 head_norm_before_train=1.185733 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6791057863001682, 'auprc': 0.7381585927602907, 'loss_val': 0.7173189084859367, 'psi': 0.7027269088842172}-{'f1_val': 0.6940171140030335, 'auprc': 0.7676507210765956, 'loss_val': 0.8049891415429332, 'psi': 0.7234705568324583}
[S14] START round=12 head_norm_before_train=1.630673 (no previous merge yet)
[S14] round=12 local utility u=0.062267 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969797600084055, 'loss_val': 0.18603710563831907, 'psi': 0.9971361180268381}-{'f1_val': 0.9930918669538628, 'auprc': 0.9905630945523506, 'loss_val': 0.26643077878231775, 'psi': 0.992080357993258}
[S15] START round=12 head_norm_before_train=1.197305 cos_to_last_merge=0.8870 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.887
[S15] round=12 local utility u=0.204480 metrics={'f1_val': 0.6990309511619698, 'auprc': 0.799412698472603, 'loss_val': 0.5300203488638875, 'psi': 0.739183650086223}-{'f1_val': 0.650994531019276, 'auprc': 0.7648638906004241, 'loss_val': 0.547115836504469, 'psi': 0.6965422748517353}
[S16] START round=12 head_norm_before_train=0.623798 cos_to_last_merge=0.9849 (last merge round=10)
[S16] round=12 local utility u=0.030245 metrics={'f1_val': 0.3845758012001112, 'auprc': 0.7155485900263621, 'loss_val': 0.9636151718812946, 'psi': 0.5169649167306115}-{'f1_val': 0.39171561978608693, 'auprc': 0.6908175835464633, 'loss_val': 0.9927508151161661, 'psi': 0.5113564052902375}
[S17] START round=12 head_norm_before_train=1.113348 cos_to_last_merge=0.8493 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.849
[S17] round=12 local utility u=0.005671 metrics={'f1_val': 0.34307418104233345, 'auprc': 0.6642961867167814, 'loss_val': 1.0005037090070577, 'psi': 0.47156298331211266}-{'f1_val': 0.34392049867172314, 'auprc': 0.6770359177750562, 'loss_val': 1.0551431646327567, 'psi': 0.4771666663130564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49115
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:49111
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:49112
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:49113
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1806) from S3
[S10] cosine check vs S3: cos=0.6872
[S11] RECEIVED delta(kind=head bytes=1805) from S16
[S11] cosine check vs S16: cos=0.5406
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.5741
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] cosine check vs S9: cos=-0.0111
[S2] DROPPED delta from S9 (cos=-0.0111 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=-0.0828
[S15] DROPPED delta from S2 (cos=-0.0828 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.6882 head_norm=0.733546
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.567565e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.6885 head_norm=1.028090 delta_norm=0.556756
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6791 head_norm=1.210561
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.284492e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6877 head_norm=1.008501 delta_norm=0.528449
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.6515 head_norm=1.061701
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.500616e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6693 head_norm=0.771942 delta_norm=0.450062
[S11] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.217514 cos_to_last_merge=0.8746 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.875
[S2] round=13 local utility u=0.243645 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.7675363918063121, 'loss_val': 0.37452509216105273, 'psi': 0.7279584042304235}-{'f1_val': 0.6902904712377866, 'auprc': 0.6631131282377529, 'loss_val': 0.4808502981166304, 'psi': 0.6794195340377731}
[S3] START round=13 head_norm_before_train=1.481825 cos_to_last_merge=0.9956 (last merge round=10)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.4569043377048253, 'auprc': 0.9552525665135138, 'loss_val': 0.7066489983793505, 'psi': 0.6562436292283007}-{'f1_val': 0.5758726154573205, 'auprc': 0.9793216558676274, 'loss_val': 0.6397024396201599, 'psi': 0.7372522316214433}
[S4] START round=13 head_norm_before_train=1.287154 cos_to_last_merge=0.9866 (last merge round=10)
[S4] round=13 local utility u=0.342191 metrics={'f1_val': 0.667008631514919, 'auprc': 0.8467382150068719, 'loss_val': 0.5125613333730863, 'psi': 0.7389004649117001}-{'f1_val': 0.6658669659078432, 'auprc': 0.6571921197654425, 'loss_val': 0.6214557061350131, 'psi': 0.6623970274508829}
[S5] START round=13 head_norm_before_train=1.039137 cos_to_last_merge=0.8615 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.861
[S5] round=13 local utility u=0.594694 metrics={'f1_val': 0.6296060678251932, 'auprc': 0.7060278815866682, 'loss_val': 0.6096288455182932, 'psi': 0.6601747933297832}-{'f1_val': 0.41770670426636225, 'auprc': 0.777191823751661, 'loss_val': 0.7411116772876782, 'psi': 0.5615007520604818}
[S6] START round=13 head_norm_before_train=1.612829 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.7055450659350792, 'auprc': 0.8333417741880116, 'loss_val': 0.3646617091810702, 'psi': 0.7566637492362522}-{'f1_val': 0.6897577689102741, 'auprc': 0.9542432409845387, 'loss_val': 0.3229193846295656, 'psi': 0.7955519577399799}
[S7] START round=13 head_norm_before_train=1.083245 cos_to_last_merge=0.9978 (last merge round=11)
[S7] round=13 local utility u=0.218527 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.753163773760808, 'loss_val': 0.8527857102066586, 'psi': 0.5512915803709373}-{'f1_val': 0.41703542715461484, 'auprc': 0.6329707971070964, 'loss_val': 0.9312121844797363, 'psi': 0.5034095751356074}
[S8] START round=13 head_norm_before_train=1.273293 cos_to_last_merge=0.8636 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.864
[S8] round=13 local utility u=0.667106 metrics={'f1_val': 0.923823594616108, 'auprc': 0.9956176267923676, 'loss_val': 0.20438281275511336, 'psi': 0.9525412074866119}-{'f1_val': 0.7048132020486533, 'auprc': 0.9983507317447113, 'loss_val': 0.2327323052288331, 'psi': 0.8222282139270765}
[S9] START round=13 head_norm_before_train=1.578121 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.6934235868153307, 'auprc': 0.9905570865202794, 'loss_val': 0.25442176574466413, 'psi': 0.8122769866973102}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982126296655343, 'loss_val': 0.19062769392976692, 'psi': 0.8200150003302249}
[S10] START round=13 head_norm_before_train=1.028090 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.137175 metrics={'f1_val': 0.6887202593753289, 'auprc': 0.9893059501290588, 'loss_val': 0.3492534679046348, 'psi': 0.8089545356768209}-{'f1_val': 0.6881539807460799, 'auprc': 0.9887170664074094, 'loss_val': 0.6184383045583616, 'psi': 0.8083792150106117}
[S11] START round=13 head_norm_before_train=0.771942 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.6323039485309332, 'auprc': 0.997110943190933, 'loss_val': 0.6372419794220168, 'psi': 0.778226746394933}-{'f1_val': 0.6514951443014879, 'auprc': 0.9677427880075435, 'loss_val': 0.6376344283185087, 'psi': 0.7779942017839101}
[S13] START round=13 head_norm_before_train=1.008501 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.029320 metrics={'f1_val': 0.682575571942702, 'auprc': 0.7423538625092079, 'loss_val': 0.6920833507414264, 'psi': 0.7064868881693043}-{'f1_val': 0.6791057863001682, 'auprc': 0.7381585927602907, 'loss_val': 0.7173189084859367, 'psi': 0.7027269088842172}
[S14] START round=13 head_norm_before_train=1.670416 (no previous merge yet)
[S14] round=13 local utility u=0.026462 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969687615834429, 'loss_val': 0.13162269944115942, 'psi': 0.9969860095279762}-{'f1_val': 0.997240356705793, 'auprc': 0.9969797600084055, 'loss_val': 0.18603710563831907, 'psi': 0.9971361180268381}
[S15] START round=13 head_norm_before_train=1.239066 cos_to_last_merge=0.8743 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.874
[S15] round=13 local utility u=0.045742 metrics={'f1_val': 0.6987421019794562, 'auprc': 0.7995213533370122, 'loss_val': 0.4371288321354671, 'psi': 0.7390538025224787}-{'f1_val': 0.6990309511619698, 'auprc': 0.799412698472603, 'loss_val': 0.5300203488638875, 'psi': 0.739183650086223}
[S16] START round=13 head_norm_before_train=0.685341 cos_to_last_merge=0.9522 (last merge round=10)
[S16] round=13 local utility u=0.147208 metrics={'f1_val': 0.4117094387522102, 'auprc': 0.7349454806812215, 'loss_val': 0.890191942370893, 'psi': 0.5410038555238148}-{'f1_val': 0.3845758012001112, 'auprc': 0.7155485900263621, 'loss_val': 0.9636151718812946, 'psi': 0.5169649167306115}
[S17] START round=13 head_norm_before_train=1.139199 cos_to_last_merge=0.8394 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.839
[S17] round=13 local utility u=0.294324 metrics={'f1_val': 0.35592209825215404, 'auprc': 0.8091636002954586, 'loss_val': 0.9235450068208476, 'psi': 0.537218699069476}-{'f1_val': 0.34307418104233345, 'auprc': 0.6642961867167814, 'loss_val': 1.0005037090070577, 'psi': 0.47156298331211266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49104
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49115
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49116
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S4
[S3] cosine check vs S4: cos=0.9130
[S4] RECEIVED delta(kind=head bytes=1795) from S7
[S4] cosine check vs S7: cos=0.9655
[S11] RECEIVED delta(kind=head bytes=1799) from S16
[S11] cosine check vs S16: cos=0.7725
[S16] RECEIVED delta(kind=head bytes=1796) from S10
[S16] cosine check vs S10: cos=0.2557
[S8] RECEIVED delta(kind=head bytes=1795) from S13
[S8] cosine check vs S13: cos=0.8658
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=-0.0800
[S15] DROPPED delta from S2 (cos=-0.0800 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.6323 head_norm=0.819048
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.665393e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.6288 head_norm=0.738408 delta_norm=0.266539
[S11] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.4569 head_norm=1.518312
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.106831e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.4481 head_norm=1.397018 delta_norm=0.310683
[S3] aggregate: ROLLBACK (f1_val pre=0.457 post=0.448 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9238 head_norm=1.307643
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.304394e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7141 head_norm=1.133952 delta_norm=0.330439
[S8] aggregate: ROLLBACK (f1_val pre=0.924 post=0.714 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6670 head_norm=1.338318
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.953185e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6671 head_norm=1.216449 delta_norm=0.195319
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4117 head_norm=0.749492
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.819858e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.3712 head_norm=0.741624 delta_norm=0.581986
[S16] aggregate: ROLLBACK (f1_val pre=0.412 post=0.371 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.265589 cos_to_last_merge=0.8614 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.701132579636681, 'auprc': 0.6641923221014836, 'loss_val': 0.3278153785092936, 'psi': 0.686356476622602}-{'f1_val': 0.7015730791798309, 'auprc': 0.7675363918063121, 'loss_val': 0.37452509216105273, 'psi': 0.7279584042304235}
[S3] START round=14 head_norm_before_train=1.397018 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.524445 metrics={'f1_val': 0.5849998738958945, 'auprc': 0.9986747679339292, 'loss_val': 0.5565983683945024, 'psi': 0.7504698315111084}-{'f1_val': 0.4569043377048253, 'auprc': 0.9552525665135138, 'loss_val': 0.7066489983793505, 'psi': 0.6562436292283007}
[S4] START round=14 head_norm_before_train=1.216449 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.008508 metrics={'f1_val': 0.6633616561592246, 'auprc': 0.8551494365598912, 'loss_val': 0.4988972866408694, 'psi': 0.7400767683194912}-{'f1_val': 0.667008631514919, 'auprc': 0.8467382150068719, 'loss_val': 0.5125613333730863, 'psi': 0.7389004649117001}
[S5] START round=14 head_norm_before_train=1.068118 cos_to_last_merge=0.8509 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.851
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6151861495679208, 'auprc': 0.7167953077441405, 'loss_val': 0.5880069307229997, 'psi': 0.6558298128384087}-{'f1_val': 0.6296060678251932, 'auprc': 0.7060278815866682, 'loss_val': 0.6096288455182932, 'psi': 0.6601747933297832}
[S6] START round=14 head_norm_before_train=1.638559 (no previous merge yet)
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.9598787278644529, 'auprc': 0.9583785931734121, 'loss_val': 0.23498343513476935, 'psi': 0.9592786739880366}-{'f1_val': 0.7055450659350792, 'auprc': 0.8333417741880116, 'loss_val': 0.3646617091810702, 'psi': 0.7566637492362522}
[S7] START round=14 head_norm_before_train=1.115661 cos_to_last_merge=0.9923 (last merge round=11)
[S7] round=14 local utility u=0.022041 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7496656862962419, 'loss_val': 0.7994274604503865, 'psi': 0.5500141327799714}-{'f1_val': 0.41671011811102343, 'auprc': 0.753163773760808, 'loss_val': 0.8527857102066586, 'psi': 0.5512915803709373}
[S8] START round=14 head_norm_before_train=1.133952 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9980713141914137, 'loss_val': 0.24444832146704265, 'psi': 0.827771988915263}-{'f1_val': 0.923823594616108, 'auprc': 0.9956176267923676, 'loss_val': 0.20438281275511336, 'psi': 0.9525412074866119}
[S9] START round=14 head_norm_before_train=1.609919 (no previous merge yet)
[S9] round=14 local utility u=0.949147 metrics={'f1_val': 0.9852543644376418, 'auprc': 0.9984696683033357, 'loss_val': 0.13084992739828114, 'psi': 0.9905404859839193}-{'f1_val': 0.6934235868153307, 'auprc': 0.9905570865202794, 'loss_val': 0.25442176574466413, 'psi': 0.8122769866973102}
[S10] START round=14 head_norm_before_train=1.102583 cos_to_last_merge=0.9972 (last merge round=12)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.6480886398737562, 'auprc': 0.95341157136567, 'loss_val': 0.3537959724874441, 'psi': 0.7702178124705217}-{'f1_val': 0.6887202593753289, 'auprc': 0.9893059501290588, 'loss_val': 0.3492534679046348, 'psi': 0.8089545356768209}
[S11] START round=14 head_norm_before_train=0.738408 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.234043 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9958066515895703, 'loss_val': 0.5830304483130072, 'psi': 0.8194838506148201}-{'f1_val': 0.6323039485309332, 'auprc': 0.997110943190933, 'loss_val': 0.6372419794220168, 'psi': 0.778226746394933}
[S13] START round=14 head_norm_before_train=1.039300 cos_to_last_merge=0.9982 (last merge round=12)
[S13] round=14 local utility u=0.123911 metrics={'f1_val': 0.7119061509349174, 'auprc': 0.749239349319181, 'loss_val': 0.6409004602256612, 'psi': 0.7268394302886229}-{'f1_val': 0.682575571942702, 'auprc': 0.7423538625092079, 'loss_val': 0.6920833507414264, 'psi': 0.7064868881693043}
[S14] START round=14 head_norm_before_train=1.698789 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.9348489753361287, 'auprc': 0.9969719538554207, 'loss_val': 0.10977401563066036, 'psi': 0.9596981667438456}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969687615834429, 'loss_val': 0.13162269944115942, 'psi': 0.9969860095279762}
[S15] START round=14 head_norm_before_train=1.279644 cos_to_last_merge=0.8625 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.863
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6988556649822915, 'auprc': 0.7995251516812181, 'loss_val': 0.5138199524607886, 'psi': 0.7391234596618621}-{'f1_val': 0.6987421019794562, 'auprc': 0.7995213533370122, 'loss_val': 0.4371288321354671, 'psi': 0.7390538025224787}
[S16] START round=14 head_norm_before_train=0.741624 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.36773595787473623, 'auprc': 0.5438067853182759, 'loss_val': 0.9223954548960237, 'psi': 0.4381642888521521}-{'f1_val': 0.4117094387522102, 'auprc': 0.7349454806812215, 'loss_val': 0.890191942370893, 'psi': 0.5410038555238148}
[S17] START round=14 head_norm_before_train=1.151059 cos_to_last_merge=0.8321 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=14 local utility u=0.054434 metrics={'f1_val': 0.36675076137885, 'auprc': 0.8197342376271641, 'loss_val': 0.9113618197725541, 'psi': 0.5479441518781757}-{'f1_val': 0.35592209825215404, 'auprc': 0.8091636002954586, 'loss_val': 0.9235450068208476, 'psi': 0.537218699069476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:49109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:49113
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9837
[S13] RECEIVED delta(kind=head bytes=1791) from S11
[S13] cosine check vs S11: cos=0.6603
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] cosine check vs S9: cos=0.0019
[S8] RECEIVED delta(kind=head bytes=1804) from S13
[S8] cosine check vs S13: cos=0.9477
[S3] RECEIVED delta(kind=head bytes=1797) from S4
[S3] cosine check vs S4: cos=0.9449
[S9] RECEIVED delta(kind=head bytes=1803) from S6
[S9] cosine check vs S6: cos=-0.0119
[S9] DROPPED delta from S6 (cos=-0.0119 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1807) from S3
[S10] cosine check vs S3: cos=0.9440
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7142 head_norm=1.173107
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.882816e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7142 head_norm=1.106896 delta_norm=0.188282
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7011 head_norm=1.310361
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.048630e+00
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.050583 delta_norm=1.048630
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.6481 head_norm=1.158618
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.551529e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.6527 head_norm=1.277038 delta_norm=0.255153
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.7119 head_norm=1.070120
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.037861e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.7115 head_norm=0.847782 delta_norm=0.403786
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.5850 head_norm=1.431595
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.380993e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.5729 head_norm=1.331363 delta_norm=0.238099
[S3] aggregate: ROLLBACK (f1_val pre=0.585 post=0.573 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6634 head_norm=1.268454
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.244888e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6633 head_norm=1.203012 delta_norm=0.124489
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.050583 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.093047 metrics={'f1_val': 0.7001486925320617, 'auprc': 0.7671450909422478, 'loss_val': 0.44467725833455407, 'psi': 0.7269472518961362}-{'f1_val': 0.701132579636681, 'auprc': 0.6641923221014836, 'loss_val': 0.3278153785092936, 'psi': 0.686356476622602}
[S3] START round=15 head_norm_before_train=1.331363 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.075297 metrics={'f1_val': 0.6074036434524808, 'auprc': 0.9983092769231227, 'loss_val': 0.5393305084558584, 'psi': 0.7637658968407375}-{'f1_val': 0.5849998738958945, 'auprc': 0.9986747679339292, 'loss_val': 0.5565983683945024, 'psi': 0.7504698315111084}
[S4] START round=15 head_norm_before_train=1.203012 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.174385 metrics={'f1_val': 0.6737772659334934, 'auprc': 0.9465538077254998, 'loss_val': 0.4868340903008629, 'psi': 0.782887882650296}-{'f1_val': 0.6633616561592246, 'auprc': 0.8551494365598912, 'loss_val': 0.4988972866408694, 'psi': 0.7400767683194912}
[S5] START round=15 head_norm_before_train=1.099811 cos_to_last_merge=0.8413 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=15 local utility u=0.295094 metrics={'f1_val': 0.6751387302293215, 'auprc': 0.7807104966114315, 'loss_val': 0.5492809339310102, 'psi': 0.7173674367821655}-{'f1_val': 0.6151861495679208, 'auprc': 0.7167953077441405, 'loss_val': 0.5880069307229997, 'psi': 0.6558298128384087}
[S6] START round=15 head_norm_before_train=1.662870 (no previous merge yet)
[S6] round=15 local utility u=0.016102 metrics={'f1_val': 0.9594702525451724, 'auprc': 0.963984600182021, 'loss_val': 0.21714590787185697, 'psi': 0.9612759915999118}-{'f1_val': 0.9598787278644529, 'auprc': 0.9583785931734121, 'loss_val': 0.23498343513476935, 'psi': 0.9592786739880366}
[S7] START round=15 head_norm_before_train=1.147387 cos_to_last_merge=0.9865 (last merge round=11)
[S7] round=15 local utility u=0.781179 metrics={'f1_val': 0.6574710839683212, 'auprc': 0.7837470159234659, 'loss_val': 0.7826604648743912, 'psi': 0.707981456750379}-{'f1_val': 0.4169130971024577, 'auprc': 0.7496656862962419, 'loss_val': 0.7994274604503865, 'psi': 0.5500141327799714}
[S8] START round=15 head_norm_before_train=1.106896 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.998069922930515, 'loss_val': 0.24403633190863278, 'psi': 0.8276381979564746}-{'f1_val': 0.7142391053978291, 'auprc': 0.9980713141914137, 'loss_val': 0.24444832146704265, 'psi': 0.827771988915263}
[S9] START round=15 head_norm_before_train=1.640016 (no previous merge yet)
[S9] round=15 local utility u=0.010602 metrics={'f1_val': 0.9865404245545528, 'auprc': 0.9984558147998176, 'loss_val': 0.11732044970195363, 'psi': 0.9913065806526588}-{'f1_val': 0.9852543644376418, 'auprc': 0.9984696683033357, 'loss_val': 0.13084992739828114, 'psi': 0.9905404859839193}
[S10] START round=15 head_norm_before_train=1.277038 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.245935 metrics={'f1_val': 0.7000254813184565, 'auprc': 0.9885622687586229, 'loss_val': 0.27899812616585196, 'psi': 0.815440196294523}-{'f1_val': 0.6480886398737562, 'auprc': 0.95341157136567, 'loss_val': 0.3537959724874441, 'psi': 0.7702178124705217}
[S11] START round=15 head_norm_before_train=0.786383 cos_to_last_merge=0.9956 (last merge round=13)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.6831681717818395, 'auprc': 0.9972625091101499, 'loss_val': 0.49060299852655304, 'psi': 0.8088059067131637}-{'f1_val': 0.7019353166316534, 'auprc': 0.9958066515895703, 'loss_val': 0.5830304483130072, 'psi': 0.8194838506148201}
[S13] START round=15 head_norm_before_train=0.847782 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.7124345433715253, 'auprc': 0.7562204649446572, 'loss_val': 0.6974336876238543, 'psi': 0.729948912000778}-{'f1_val': 0.7119061509349174, 'auprc': 0.749239349319181, 'loss_val': 0.6409004602256612, 'psi': 0.7268394302886229}
[S14] START round=15 head_norm_before_train=1.721906 (no previous merge yet)
[S14] round=15 local utility u=0.206180 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9969756414567086, 'loss_val': 0.06931240712109528, 'psi': 0.9968883046780104}-{'f1_val': 0.9348489753361287, 'auprc': 0.9969719538554207, 'loss_val': 0.10977401563066036, 'psi': 0.9596981667438456}
[S15] START round=15 head_norm_before_train=1.317377 cos_to_last_merge=0.8518 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=15 local utility u=0.063878 metrics={'f1_val': 0.6931049272353491, 'auprc': 0.8224542006988116, 'loss_val': 0.42034643464290167, 'psi': 0.7448446366207342}-{'f1_val': 0.6988556649822915, 'auprc': 0.7995251516812181, 'loss_val': 0.5138199524607886, 'psi': 0.7391234596618621}
[S16] START round=15 head_norm_before_train=0.785431 cos_to_last_merge=0.9949 (last merge round=13)
[S16] round=15 local utility u=0.420969 metrics={'f1_val': 0.4005341515935036, 'auprc': 0.7397784394191628, 'loss_val': 0.8651607559356643, 'psi': 0.5362318667237673}-{'f1_val': 0.36773595787473623, 'auprc': 0.5438067853182759, 'loss_val': 0.9223954548960237, 'psi': 0.4381642888521521}
[S17] START round=15 head_norm_before_train=1.163449 cos_to_last_merge=0.8250 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.825
[S17] round=15 local utility u=0.371423 metrics={'f1_val': 0.4798473890269864, 'auprc': 0.8386404707930197, 'loss_val': 0.9038133747306668, 'psi': 0.6233646217333997}-{'f1_val': 0.36675076137885, 'auprc': 0.8197342376271641, 'loss_val': 0.9113618197725541, 'psi': 0.5479441518781757}
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:49115
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49111
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49104
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S13] ⇄ pheromone p=0.143 → S8@127.0.0.1:49109
[S9] RECEIVED delta(kind=head bytes=1802) from S6
[S9] cosine check vs S6: cos=-0.0142
[S9] DROPPED delta from S6 (cos=-0.0142 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S2
[S15] cosine check vs S2: cos=0.1277
[S10] RECEIVED delta(kind=head bytes=1799) from S3
[S10] cosine check vs S3: cos=0.9652
[S2] RECEIVED delta(kind=head bytes=1803) from S9
[S2] cosine check vs S9: cos=0.7518
[S16] RECEIVED delta(kind=head bytes=1797) from S10
[S16] cosine check vs S10: cos=0.7634
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=0.9906
[S3] ⇄ pheromone p=0.337 → S10@127.0.0.1:49111
[S7] ⇄ pheromone p=0.280 → S4@127.0.0.1:49104
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7001 head_norm=1.100148
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.572171e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.6991 head_norm=1.301699 delta_norm=0.557217
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.155 → S15@127.0.0.1:49115
[S6] ⇄ pheromone p=0.293 → S9@127.0.0.1:49110
[S9] ⇄ pheromone p=0.235 → S2@127.0.0.1:49102
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.7000 head_norm=1.317588
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.780902e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.7000 head_norm=1.327934 delta_norm=0.178090
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.193 → S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6931 head_norm=1.355532
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.165390e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6969 head_norm=0.925830 delta_norm=0.816539
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S16
[S11] cosine check vs S16: cos=0.6506
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.6832 head_norm=0.843203
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.518951e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.6709 head_norm=0.764871 delta_norm=0.351895
[S11] aggregate: ROLLBACK (f1_val pre=0.683 post=0.671 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.243 → S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49103
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S4
[S3] cosine check vs S4: cos=0.9675
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6738 head_norm=1.251584
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.156374e-02
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6649 head_norm=1.210524 delta_norm=0.091564
[S4] aggregate: ROLLBACK (f1_val pre=0.674 post=0.665 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.181 → S3@127.0.0.1:49103
[S16] CommDone barrier timeout: have=1 need=2 — continuing
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.4005 head_norm=0.840669
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.335037e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.4512 head_norm=1.016590 delta_norm=0.433504
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.211 → S11@127.0.0.1:49112
[S2] START round=16 head_norm_before_train=1.301699 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.259346 metrics={'f1_val': 0.699291575902639, 'auprc': 0.9773947067937707, 'loss_val': 0.5515922351099763, 'psi': 0.8105328282590918}-{'f1_val': 0.7001486925320617, 'auprc': 0.7671450909422478, 'loss_val': 0.44467725833455407, 'psi': 0.7269472518961362}
[S3] START round=16 head_norm_before_train=1.361694 cos_to_last_merge=0.9994 (last merge round=14)
[S3] round=16 local utility u=0.112969 metrics={'f1_val': 0.6339607733259319, 'auprc': 0.9999994424215977, 'loss_val': 0.47780572068573585, 'psi': 0.7803762409641982}-{'f1_val': 0.6074036434524808, 'auprc': 0.9983092769231227, 'loss_val': 0.5393305084558584, 'psi': 0.7637658968407375}
[S4] START round=16 head_norm_before_train=1.210524 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.831439 metrics={'f1_val': 0.9492690380628782, 'auprc': 0.9434860053704135, 'loss_val': 0.46770273459734635, 'psi': 0.9469558249858924}-{'f1_val': 0.6737772659334934, 'auprc': 0.9465538077254998, 'loss_val': 0.4868340903008629, 'psi': 0.782887882650296}
[S5] START round=16 head_norm_before_train=1.128707 cos_to_last_merge=0.8335 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.834
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.6801942572377255, 'auprc': 0.7626648740376997, 'loss_val': 0.5311240481972601, 'psi': 0.7131825039577152}-{'f1_val': 0.6751387302293215, 'auprc': 0.7807104966114315, 'loss_val': 0.5492809339310102, 'psi': 0.7173674367821655}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=16 head_norm_before_train=1.684899 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.9585340324407221, 'auprc': 0.9607798629448157, 'loss_val': 0.22783195838282216, 'psi': 0.9594323646423595}-{'f1_val': 0.9594702525451724, 'auprc': 0.963984600182021, 'loss_val': 0.21714590787185697, 'psi': 0.9612759915999118}
[S7] START round=16 head_norm_before_train=1.175177 cos_to_last_merge=0.9811 (last merge round=11)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.4566600311148088, 'auprc': 0.7823804353387367, 'loss_val': 0.797954245537735, 'psi': 0.58694819280438}-{'f1_val': 0.6574710839683212, 'auprc': 0.7837470159234659, 'loss_val': 0.7826604648743912, 'psi': 0.707981456750379}
[S8] START round=16 head_norm_before_train=1.148306 cos_to_last_merge=0.9991 (last merge round=14)
[S8] round=16 local utility u=0.876086 metrics={'f1_val': 0.9957501124898855, 'auprc': 0.9984218823595984, 'loss_val': 0.1833182159378499, 'psi': 0.9968188204377706}-{'f1_val': 0.7140170479737811, 'auprc': 0.998069922930515, 'loss_val': 0.24403633190863278, 'psi': 0.8276381979564746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=16 head_norm_before_train=1.673170 (no previous merge yet)
[S9] round=16 local utility u=0.034912 metrics={'f1_val': 0.9916350289240425, 'auprc': 0.9983238886335606, 'loss_val': 0.07766871755998166, 'psi': 0.9943105728078498}-{'f1_val': 0.9865404245545528, 'auprc': 0.9984558147998176, 'loss_val': 0.11732044970195363, 'psi': 0.9913065806526588}
[S10] START round=16 head_norm_before_train=1.327934 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.6118730762921515, 'auprc': 0.9574392484466488, 'loss_val': 0.3477882157322296, 'psi': 0.7500995451539505}-{'f1_val': 0.7000254813184565, 'auprc': 0.9885622687586229, 'loss_val': 0.27899812616585196, 'psi': 0.815440196294523}
[S11] START round=16 head_norm_before_train=0.764871 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.6276765512491368, 'auprc': 0.9972498886796055, 'loss_val': 0.6109912469387829, 'psi': 0.7755058862213242}-{'f1_val': 0.6831681717818395, 'auprc': 0.9972625091101499, 'loss_val': 0.49060299852655304, 'psi': 0.8088059067131637}
[S13] START round=16 head_norm_before_train=0.878760 cos_to_last_merge=0.9983 (last merge round=14)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.7115091406168195, 'auprc': 0.7468550970781916, 'loss_val': 0.6807646752670026, 'psi': 0.7256475232013684}-{'f1_val': 0.7124345433715253, 'auprc': 0.7562204649446572, 'loss_val': 0.6974336876238543, 'psi': 0.729948912000778}
[S14] START round=16 head_norm_before_train=1.744941 (no previous merge yet)
[S14] round=16 local utility u=0.011535 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9969722109933589, 'loss_val': 0.05261544191175093, 'psi': 0.9975251878336724}-{'f1_val': 0.9968300801588782, 'auprc': 0.9969756414567086, 'loss_val': 0.06931240712109528, 'psi': 0.9968883046780104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=16 head_norm_before_train=0.925830 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7009589796767405, 'auprc': 0.7994143105822742, 'loss_val': 0.5204150231847392, 'psi': 0.740341112038954}-{'f1_val': 0.6931049272353491, 'auprc': 0.8224542006988116, 'loss_val': 0.42034643464290167, 'psi': 0.7448446366207342}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=16 head_norm_before_train=1.016590 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.898623 metrics={'f1_val': 0.6973872953416763, 'auprc': 0.7657194048082279, 'loss_val': 0.926856367216953, 'psi': 0.7247201391282969}-{'f1_val': 0.4005341515935036, 'auprc': 0.7397784394191628, 'loss_val': 0.8651607559356643, 'psi': 0.5362318667237673}
[S17] START round=16 head_norm_before_train=1.174085 cos_to_last_merge=0.8196 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.39974215137877445, 'auprc': 0.8385699922205067, 'loss_val': 0.9413964391904481, 'psi': 0.5752732877154674}-{'f1_val': 0.4798473890269864, 'auprc': 0.8386404707930197, 'loss_val': 0.9038133747306668, 'psi': 0.6233646217333997}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.6340 head_norm=1.396565
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.934437e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.6241 head_norm=1.311872 delta_norm=0.193444
[S3] aggregate: ROLLBACK (f1_val pre=0.634 post=0.624 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3]  timeout peer S10
[S11]  timeout peer S6
[S11]  timeout peer S13
[S4]  timeout peer S3
[S4]  timeout peer S17
[S9]  timeout peer S2
[S2]  timeout peer S15
[S6]  timeout peer S9
[S13]  timeout peer S8
[S16]  timeout peer S5
[S16]  timeout peer S7
[S16]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S16
[S7]  timeout peer S4
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S2] START round=17 head_norm_before_train=1.336333 cos_to_last_merge=0.9966 (last merge round=15)
[S2] round=17 local utility u=0.082827 metrics={'f1_val': 0.7004314050523787, 'auprc': 0.9799449751450684, 'loss_val': 0.40042856789289455, 'psi': 0.8122368330894545}-{'f1_val': 0.699291575902639, 'auprc': 0.9773947067937707, 'loss_val': 0.5515922351099763, 'psi': 0.8105328282590918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=17 head_norm_before_train=1.311872 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.263689 metrics={'f1_val': 0.7005014381049806, 'auprc': 0.9992478654986869, 'loss_val': 0.3474176776421595, 'psi': 0.8200000090624631}-{'f1_val': 0.6339607733259319, 'auprc': 0.9999994424215977, 'loss_val': 0.47780572068573585, 'psi': 0.7803762409641982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=17 head_norm_before_train=1.251510 cos_to_last_merge=0.9994 (last merge round=15)
[S4] round=17 local utility u=0.021277 metrics={'f1_val': 0.9515296140773266, 'auprc': 0.9427451752236715, 'loss_val': 0.436489567816329, 'psi': 0.9480158385358646}-{'f1_val': 0.9492690380628782, 'auprc': 0.9434860053704135, 'loss_val': 0.46770273459734635, 'psi': 0.9469558249858924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=17 head_norm_before_train=1.154814 cos_to_last_merge=0.8274 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=17 local utility u=0.150692 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.8024308063597092, 'loss_val': 0.47277442149742593, 'psi': 0.7414624378503979}-{'f1_val': 0.6801942572377255, 'auprc': 0.7626648740376997, 'loss_val': 0.5311240481972601, 'psi': 0.7131825039577152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=17 head_norm_before_train=1.701075 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7944788090438799, 'auprc': 0.827570446611128, 'loss_val': 0.33889694511323504, 'psi': 0.8077154640707791}-{'f1_val': 0.9585340324407221, 'auprc': 0.9607798629448157, 'loss_val': 0.22783195838282216, 'psi': 0.9594323646423595}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=1.200410 cos_to_last_merge=0.9765 (last merge round=11)
[S7] round=17 local utility u=0.892474 metrics={'f1_val': 0.7136512924005864, 'auprc': 0.792037980699013, 'loss_val': 0.5839257943078514, 'psi': 0.745005967719957}-{'f1_val': 0.4566600311148088, 'auprc': 0.7823804353387367, 'loss_val': 0.797954245537735, 'psi': 0.58694819280438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=17 head_norm_before_train=1.192630 cos_to_last_merge=0.9966 (last merge round=14)
[S8] round=17 local utility u=0.011610 metrics={'f1_val': 0.9946453664677153, 'auprc': 0.9984592517020056, 'loss_val': 0.15358219479897542, 'psi': 0.9961709205614313}-{'f1_val': 0.9957501124898855, 'auprc': 0.9984218823595984, 'loss_val': 0.1833182159378499, 'psi': 0.9968188204377706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=17 head_norm_before_train=1.705174 (no previous merge yet)
[S9] round=17 local utility u=0.021920 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9982493423507405, 'loss_val': 0.058756044944655014, 'psi': 0.9967957679588074}-{'f1_val': 0.9916350289240425, 'auprc': 0.9983238886335606, 'loss_val': 0.07766871755998166, 'psi': 0.9943105728078498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=17 head_norm_before_train=1.358158 cos_to_last_merge=0.9994 (last merge round=15)
[S10] round=17 local utility u=0.859622 metrics={'f1_val': 0.8876588693801202, 'auprc': 0.9755676395041422, 'loss_val': 0.33764386434088206, 'psi': 0.9228223774297291}-{'f1_val': 0.6118730762921515, 'auprc': 0.9574392484466488, 'loss_val': 0.3477882157322296, 'psi': 0.7500995451539505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=17 head_norm_before_train=0.811096 cos_to_last_merge=0.9962 (last merge round=15)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.6070731982891182, 'auprc': 0.9966780580385118, 'loss_val': 0.5272949027757079, 'psi': 0.7629151421888757}-{'f1_val': 0.6276765512491368, 'auprc': 0.9972498886796055, 'loss_val': 0.6109912469387829, 'psi': 0.7755058862213242}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=17 head_norm_before_train=0.912075 cos_to_last_merge=0.9941 (last merge round=14)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6775758262910594, 'auprc': 0.7352254524852757, 'loss_val': 0.7175996202960744, 'psi': 0.7006356767687458}-{'f1_val': 0.7115091406168195, 'auprc': 0.7468550970781916, 'loss_val': 0.6807646752670026, 'psi': 0.7256475232013684}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.770599 (no previous merge yet)
[S14] round=17 local utility u=0.000011 metrics={'f1_val': 0.9966461383503629, 'auprc': 0.9986638139712829, 'loss_val': 0.0501816002702912, 'psi': 0.9974532085987309}-{'f1_val': 0.9978938390605482, 'auprc': 0.9969722109933589, 'loss_val': 0.05261544191175093, 'psi': 0.9975251878336724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=17 head_norm_before_train=0.965133 cos_to_last_merge=0.9982 (last merge round=15)
[S15] round=17 local utility u=0.016685 metrics={'f1_val': 0.7011730619562222, 'auprc': 0.7994340072729333, 'loss_val': 0.488387718238154, 'psi': 0.7404774400829066}-{'f1_val': 0.7009589796767405, 'auprc': 0.7994143105822742, 'loss_val': 0.5204150231847392, 'psi': 0.740341112038954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=17 head_norm_before_train=1.055061 cos_to_last_merge=0.9962 (last merge round=15)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.6278757985346071, 'auprc': 0.7553369652840232, 'loss_val': 0.8696753692021202, 'psi': 0.6788602652343735}-{'f1_val': 0.6973872953416763, 'auprc': 0.7657194048082279, 'loss_val': 0.926856367216953, 'psi': 0.7247201391282969}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=17 head_norm_before_train=1.185589 cos_to_last_merge=0.8154 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3555077552495598, 'auprc': 0.7113669388788197, 'loss_val': 0.9813145436347912, 'psi': 0.49785142870126375}-{'f1_val': 0.39974215137877445, 'auprc': 0.8385699922205067, 'loss_val': 0.9413964391904481, 'psi': 0.5752732877154674}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=18 head_norm_before_train=1.384240 cos_to_last_merge=0.9854 (last merge round=15)
[S2] round=18 local utility u=0.035182 metrics={'f1_val': 0.701132579636681, 'auprc': 0.9805822775506556, 'loss_val': 0.3361835001504383, 'psi': 0.8129124588022708}-{'f1_val': 0.7004314050523787, 'auprc': 0.9799449751450684, 'loss_val': 0.40042856789289455, 'psi': 0.8122368330894545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=18 head_norm_before_train=1.351250 cos_to_last_merge=0.9991 (last merge round=16)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.5721636728621555, 'auprc': 0.8835333892651218, 'loss_val': 0.5676926788410076, 'psi': 0.6967115594233421}-{'f1_val': 0.7005014381049806, 'auprc': 0.9992478654986869, 'loss_val': 0.3474176776421595, 'psi': 0.8200000090624631}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=18 head_norm_before_train=1.287596 cos_to_last_merge=0.9980 (last merge round=15)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9413479214631446, 'auprc': 0.9435997140025542, 'loss_val': 0.4215898955416344, 'psi': 0.9422486384789085}-{'f1_val': 0.9515296140773266, 'auprc': 0.9427451752236715, 'loss_val': 0.436489567816329, 'psi': 0.9480158385358646}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=18 head_norm_before_train=1.176192 cos_to_last_merge=0.8218 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.822
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.7798474531094503, 'loss_val': 0.4557288570395108, 'psi': 0.7322804743499384}-{'f1_val': 0.7008168588441903, 'auprc': 0.8024308063597092, 'loss_val': 0.47277442149742593, 'psi': 0.7414624378503979}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=18 head_norm_before_train=1.714355 (no previous merge yet)
[S6] round=18 local utility u=0.292398 metrics={'f1_val': 0.8224609125125883, 'auprc': 0.9555052896370548, 'loss_val': 0.30579712064260106, 'psi': 0.875678663362375}-{'f1_val': 0.7944788090438799, 'auprc': 0.827570446611128, 'loss_val': 0.33889694511323504, 'psi': 0.8077154640707791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=18 head_norm_before_train=1.219774 cos_to_last_merge=0.9732 (last merge round=11)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6903314281654832, 'auprc': 0.7880291236248782, 'loss_val': 0.5606524005116431, 'psi': 0.7294105063492412}-{'f1_val': 0.7136512924005864, 'auprc': 0.792037980699013, 'loss_val': 0.5839257943078514, 'psi': 0.745005967719957}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.235050 cos_to_last_merge=0.9930 (last merge round=14)
[S8] round=18 local utility u=0.007370 metrics={'f1_val': 0.9924605795656339, 'auprc': 0.9991239500221243, 'loss_val': 0.12772732756049665, 'psi': 0.99512592774823}-{'f1_val': 0.9946453664677153, 'auprc': 0.9984592517020056, 'loss_val': 0.15358219479897542, 'psi': 0.9961709205614313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=18 head_norm_before_train=1.735225 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9978587550971033, 'loss_val': 0.05556769303462478, 'psi': 0.9923471265405022}-{'f1_val': 0.9958267183641853, 'auprc': 0.9982493423507405, 'loss_val': 0.058756044944655014, 'psi': 0.9967957679588074}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=18 head_norm_before_train=1.382251 cos_to_last_merge=0.9978 (last merge round=15)
[S10] round=18 local utility u=0.420043 metrics={'f1_val': 0.9949810833780215, 'auprc': 0.9964582334128353, 'loss_val': 0.20416382574968683, 'psi': 0.995571943391947}-{'f1_val': 0.8876588693801202, 'auprc': 0.9755676395041422, 'loss_val': 0.33764386434088206, 'psi': 0.9228223774297291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=18 head_norm_before_train=0.865150 cos_to_last_merge=0.9867 (last merge round=15)
[S11] round=18 local utility u=0.368868 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9976732861325283, 'loss_val': 0.3617167427625076, 'psi': 0.8202305044320033}-{'f1_val': 0.6070731982891182, 'auprc': 0.9966780580385118, 'loss_val': 0.5272949027757079, 'psi': 0.7629151421888757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=18 head_norm_before_train=0.948788 cos_to_last_merge=0.9876 (last merge round=14)
[S13] round=18 local utility u=0.064503 metrics={'f1_val': 0.7099629099805949, 'auprc': 0.6902519989351761, 'loss_val': 0.6479961503079205, 'psi': 0.7020785455624274}-{'f1_val': 0.6775758262910594, 'auprc': 0.7352254524852757, 'loss_val': 0.7175996202960744, 'psi': 0.7006356767687458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=18 head_norm_before_train=1.792034 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9425917093272638, 'auprc': 0.9969175083862086, 'loss_val': 0.07358687209228058, 'psi': 0.9643220289508417}-{'f1_val': 0.9966461383503629, 'auprc': 0.9986638139712829, 'loss_val': 0.0501816002702912, 'psi': 0.9974532085987309}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=18 head_norm_before_train=1.027213 cos_to_last_merge=0.9908 (last merge round=15)
[S15] round=18 local utility u=0.077229 metrics={'f1_val': 0.7002293986786473, 'auprc': 0.8299215946653363, 'loss_val': 0.4197300545987323, 'psi': 0.7521062770733229}-{'f1_val': 0.7011730619562222, 'auprc': 0.7994340072729333, 'loss_val': 0.488387718238154, 'psi': 0.7404774400829066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=18 head_norm_before_train=1.101688 cos_to_last_merge=0.9869 (last merge round=15)
[S16] round=18 local utility u=0.684960 metrics={'f1_val': 0.8232228323275308, 'auprc': 0.7890208179829867, 'loss_val': 0.7728887578809532, 'psi': 0.8095420265897131}-{'f1_val': 0.6278757985346071, 'auprc': 0.7553369652840232, 'loss_val': 0.8696753692021202, 'psi': 0.6788602652343735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=18 head_norm_before_train=1.192649 cos_to_last_merge=0.8125 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3407766074069002, 'auprc': 0.682216424408464, 'loss_val': 1.0793311730793853, 'psi': 0.4773525342075257}-{'f1_val': 0.3555077552495598, 'auprc': 0.7113669388788197, 'loss_val': 0.9813145436347912, 'psi': 0.49785142870126375}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=1.437088 cos_to_last_merge=0.9713 (last merge round=15)
[S2] round=19 local utility u=0.027689 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.9881763561254739, 'loss_val': 0.3046765843287505, 'psi': 0.8160590526936762}-{'f1_val': 0.701132579636681, 'auprc': 0.9805822775506556, 'loss_val': 0.3361835001504383, 'psi': 0.8129124588022708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] r=20 psi=0.816 u=0.0277 p_local=0.1119 f1=0.701 auprc=0.988 bytes=28733
[S3] START round=19 head_norm_before_train=1.385995 cos_to_last_merge=0.9972 (last merge round=16)
[S3] round=19 local utility u=0.638342 metrics={'f1_val': 0.6917218904864768, 'auprc': 0.998202820357236, 'loss_val': 0.35236643075161433, 'psi': 0.8143142624347806}-{'f1_val': 0.5721636728621555, 'auprc': 0.8835333892651218, 'loss_val': 0.5676926788410076, 'psi': 0.6967115594233421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] r=20 psi=0.814 u=0.6383 p_local=0.3109 f1=0.692 auprc=0.998 bytes=19794
[S4] START round=19 head_norm_before_train=1.322013 cos_to_last_merge=0.9961 (last merge round=15)
[S4] round=19 local utility u=0.096691 metrics={'f1_val': 0.9466321024406685, 'auprc': 0.9653893492188532, 'loss_val': 0.3252822414566166, 'psi': 0.9541350011519425}-{'f1_val': 0.9413479214631446, 'auprc': 0.9435997140025542, 'loss_val': 0.4215898955416344, 'psi': 0.9422486384789085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S4] r=20 psi=0.954 u=0.0967 p_local=0.1815 f1=0.947 auprc=0.965 bytes=26976
[S5] START round=19 head_norm_before_train=1.196307 cos_to_last_merge=0.8162 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.816
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6880428922597056, 'auprc': 0.7265783479231523, 'loss_val': 0.46790018707187364, 'psi': 0.7034570745250843}-{'f1_val': 0.7005691551769304, 'auprc': 0.7798474531094503, 'loss_val': 0.4557288570395108, 'psi': 0.7322804743499384}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.703 u=0.0000 p_local=0.1137 f1=0.688 auprc=0.727 bytes=21540
[S6] START round=19 head_norm_before_train=1.725048 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7432846281337191, 'auprc': 0.7837519217149767, 'loss_val': 0.48549192695964366, 'psi': 0.7594715455662222}-{'f1_val': 0.8224609125125883, 'auprc': 0.9555052896370548, 'loss_val': 0.30579712064260106, 'psi': 0.875678663362375}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.759 u=0.0000 p_local=0.1668 f1=0.743 auprc=0.784 bytes=21592
[S7] START round=19 head_norm_before_train=1.231756 cos_to_last_merge=0.9710 (last merge round=11)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.3742899620202559, 'auprc': 0.5842691082940094, 'loss_val': 1.0149693793394303, 'psi': 0.4582816205297573}-{'f1_val': 0.6903314281654832, 'auprc': 0.7880291236248782, 'loss_val': 0.5606524005116431, 'psi': 0.7294105063492412}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=20 psi=0.458 u=0.0000 p_local=0.2289 f1=0.374 auprc=0.584 bytes=21542
[S8] START round=19 head_norm_before_train=1.276827 cos_to_last_merge=0.9885 (last merge round=14)
[S8] round=19 local utility u=0.002962 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9913551058248148, 'loss_val': 0.10573989344882079, 'psi': 0.9927426301410656}-{'f1_val': 0.9924605795656339, 'auprc': 0.9991239500221243, 'loss_val': 0.12772732756049665, 'psi': 0.99512592774823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] r=20 psi=0.993 u=0.0030 p_local=0.1732 f1=0.994 auprc=0.991 bytes=26944
[S9] START round=19 head_norm_before_train=1.762147 (no previous merge yet)
[S9] round=19 local utility u=0.030403 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9983609031808428, 'loss_val': 0.03919236732246009, 'psi': 0.9968403922908484}-{'f1_val': 0.9886727075027679, 'auprc': 0.9978587550971033, 'loss_val': 0.05556769303462478, 'psi': 0.9923471265405022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S9] r=20 psi=0.997 u=0.0304 p_local=0.1087 f1=0.996 auprc=0.998 bytes=26997
[S10] START round=19 head_norm_before_train=1.404597 cos_to_last_merge=0.9958 (last merge round=15)
[S10] round=19 local utility u=0.016259 metrics={'f1_val': 0.9945588208961169, 'auprc': 0.9960007533794168, 'loss_val': 0.16773933698106752, 'psi': 0.9951355938894368}-{'f1_val': 0.9949810833780215, 'auprc': 0.9964582334128353, 'loss_val': 0.20416382574968683, 'psi': 0.995571943391947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S10] r=20 psi=0.995 u=0.0163 p_local=0.2595 f1=0.995 auprc=0.996 bytes=26995
[S11] START round=19 head_norm_before_train=0.917008 cos_to_last_merge=0.9757 (last merge round=15)
[S11] round=19 local utility u=0.633001 metrics={'f1_val': 0.9132016678602907, 'auprc': 0.9979115560978399, 'loss_val': 0.36402672283114884, 'psi': 0.9470856231553103}-{'f1_val': 0.7019353166316534, 'auprc': 0.9976732861325283, 'loss_val': 0.3617167427625076, 'psi': 0.8202305044320033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=20 psi=0.947 u=0.6330 p_local=0.2851 f1=0.913 auprc=0.998 bytes=21525
[S13] START round=19 head_norm_before_train=0.980705 cos_to_last_merge=0.9811 (last merge round=14)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6033934141239347, 'auprc': 0.6917030380832325, 'loss_val': 0.6688304439258742, 'psi': 0.6387172637076538}-{'f1_val': 0.7099629099805949, 'auprc': 0.6902519989351761, 'loss_val': 0.6479961503079205, 'psi': 0.7020785455624274}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.639 u=0.0000 p_local=0.0690 f1=0.603 auprc=0.692 bytes=21540
[S14] START round=19 head_norm_before_train=1.814697 (no previous merge yet)
[S14] round=19 local utility u=0.177582 metrics={'f1_val': 0.9966461383503629, 'auprc': 0.9969638465685288, 'loss_val': 0.042888617497457746, 'psi': 0.9967732216376292}-{'f1_val': 0.9425917093272638, 'auprc': 0.9969175083862086, 'loss_val': 0.07358687209228058, 'psi': 0.9643220289508417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S14] r=20 psi=0.997 u=0.1776 p_local=0.1310 f1=0.997 auprc=0.997 bytes=28767
[S15] START round=19 head_norm_before_train=1.090338 cos_to_last_merge=0.9810 (last merge round=15)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6952415711498261, 'auprc': 0.799530676541014, 'loss_val': 0.508180743300838, 'psi': 0.7369572133063013}-{'f1_val': 0.7002293986786473, 'auprc': 0.8299215946653363, 'loss_val': 0.4197300545987323, 'psi': 0.7521062770733229}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=20 psi=0.737 u=0.0000 p_local=0.0756 f1=0.695 auprc=0.800 bytes=25105
[S16] START round=19 head_norm_before_train=1.149733 cos_to_last_merge=0.9760 (last merge round=15)
[S16] round=19 local utility u=0.025081 metrics={'f1_val': 0.8213328546969838, 'auprc': 0.8112969204153877, 'loss_val': 0.7782155439353302, 'psi': 0.8173184809843453}-{'f1_val': 0.8232228323275308, 'auprc': 0.7890208179829867, 'loss_val': 0.7728887578809532, 'psi': 0.8095420265897131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S16] r=20 psi=0.817 u=0.0251 p_local=0.2931 f1=0.821 auprc=0.811 bytes=25173
[S17] START round=19 head_norm_before_train=1.200925 cos_to_last_merge=0.8097 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.22298162643022695, 'auprc': 0.6520862330542345, 'loss_val': 1.620560675729283, 'psi': 0.39462346907983004}-{'f1_val': 0.3407766074069002, 'auprc': 0.682216424408464, 'loss_val': 1.0793311730793853, 'psi': 0.4773525342075257}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.395 u=0.0000 p_local=0.0870 f1=0.223 auprc=0.652 bytes=17961
[S2] START round=20 head_norm_before_train=1.481057 cos_to_last_merge=0.9598 (last merge round=15)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.9595035051740938, 'loss_val': 0.29091668694823347, 'psi': 0.804589912313124}-{'f1_val': 0.7013141837391442, 'auprc': 0.9881763561254739, 'loss_val': 0.3046765843287505, 'psi': 0.8160590526936762}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.413193 cos_to_last_merge=0.9952 (last merge round=16)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.6805877389328217, 'auprc': 0.9936921301695717, 'loss_val': 0.3670180308383003, 'psi': 0.8058294954275216}-{'f1_val': 0.6917218904864768, 'auprc': 0.998202820357236, 'loss_val': 0.35236643075161433, 'psi': 0.8143142624347806}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=1.355717 cos_to_last_merge=0.9937 (last merge round=15)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.938950593932003, 'auprc': 0.9279917460366631, 'loss_val': 0.33960101213171684, 'psi': 0.934567054773867}-{'f1_val': 0.9466321024406685, 'auprc': 0.9653893492188532, 'loss_val': 0.3252822414566166, 'psi': 0.9541350011519425}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=20 head_norm_before_train=1.225373 cos_to_last_merge=0.8090 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=20 local utility u=0.112563 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7499741297562196, 'loss_val': 0.3881158651536131, 'psi': 0.7203307579052789}-{'f1_val': 0.6880428922597056, 'auprc': 0.7265783479231523, 'loss_val': 0.46790018707187364, 'psi': 0.7034570745250843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=20 head_norm_before_train=1.732605 (no previous merge yet)
[S6] round=20 local utility u=0.549711 metrics={'f1_val': 0.8217050719214715, 'auprc': 0.9487004184712287, 'loss_val': 0.3514380777552671, 'psi': 0.8725032105413744}-{'f1_val': 0.7432846281337191, 'auprc': 0.7837519217149767, 'loss_val': 0.48549192695964366, 'psi': 0.7594715455662222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=20 head_norm_before_train=1.240738 cos_to_last_merge=0.9693 (last merge round=11)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.7030675372882645, 'auprc': 0.7893561483253949, 'loss_val': 0.5114643572068364, 'psi': 0.7375829817031168}-{'f1_val': 0.3742899620202559, 'auprc': 0.5842691082940094, 'loss_val': 1.0149693793394303, 'psi': 0.4582816205297573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=20 head_norm_before_train=1.317725 cos_to_last_merge=0.9834 (last merge round=14)
[S8] round=20 local utility u=0.001113 metrics={'f1_val': 0.993841890298642, 'auprc': 0.988529793757652, 'loss_val': 0.09608288702456307, 'psi': 0.991717051682246}-{'f1_val': 0.9936676463518993, 'auprc': 0.9913551058248148, 'loss_val': 0.10573989344882079, 'psi': 0.9927426301410656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=20 head_norm_before_train=1.788753 (no previous merge yet)
[S9] round=20 local utility u=0.000349 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9988146555209391, 'loss_val': 0.03486087607212408, 'psi': 0.9965225146662087}-{'f1_val': 0.9958267183641853, 'auprc': 0.9983609031808428, 'loss_val': 0.03919236732246009, 'psi': 0.9968403922908484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=20 head_norm_before_train=1.428117 cos_to_last_merge=0.9929 (last merge round=15)
[S10] round=20 local utility u=0.018725 metrics={'f1_val': 0.9945588208961169, 'auprc': 0.9961454581692245, 'loss_val': 0.1307242344241864, 'psi': 0.99519347580536}-{'f1_val': 0.9945588208961169, 'auprc': 0.9960007533794168, 'loss_val': 0.16773933698106752, 'psi': 0.9951355938894368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=20 head_norm_before_train=0.972333 cos_to_last_merge=0.9638 (last merge round=15)
[S11] round=20 local utility u=0.307458 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.997382158076812, 'loss_val': 0.2485047296095035, 'psi': 0.9969721755854537}-{'f1_val': 0.9132016678602907, 'auprc': 0.9979115560978399, 'loss_val': 0.36402672283114884, 'psi': 0.9470856231553103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=20 head_norm_before_train=1.006306 cos_to_last_merge=0.9753 (last merge round=14)
[S13] round=20 local utility u=0.066583 metrics={'f1_val': 0.6372475615020021, 'auprc': 0.6585058998582319, 'loss_val': 0.6391982171253745, 'psi': 0.645750896844494}-{'f1_val': 0.6033934141239347, 'auprc': 0.6917030380832325, 'loss_val': 0.6688304439258742, 'psi': 0.6387172637076538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=20 head_norm_before_train=1.833912 (no previous merge yet)
[S14] round=20 local utility u=0.006298 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969732116299961, 'loss_val': 0.03388625475458287, 'psi': 0.9971334986754743}-{'f1_val': 0.9966461383503629, 'auprc': 0.9969638465685288, 'loss_val': 0.042888617497457746, 'psi': 0.9967732216376292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=20 head_norm_before_train=1.147727 cos_to_last_merge=0.9716 (last merge round=15)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6978446489259277, 'auprc': 0.7995368417557321, 'loss_val': 0.5455295735842159, 'psi': 0.7385215260578495}-{'f1_val': 0.6952415711498261, 'auprc': 0.799530676541014, 'loss_val': 0.508180743300838, 'psi': 0.7369572133063013}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.193040 cos_to_last_merge=0.9667 (last merge round=15)
[S16] round=20 local utility u=0.092511 metrics={'f1_val': 0.78482600890921, 'auprc': 0.8799791605321656, 'loss_val': 0.5801999017868227, 'psi': 0.8228872695583922}-{'f1_val': 0.8213328546969838, 'auprc': 0.8112969204153877, 'loss_val': 0.7782155439353302, 'psi': 0.8173184809843453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=20 head_norm_before_train=1.208383 cos_to_last_merge=0.8071 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=20 local utility u=0.029995 metrics={'f1_val': 0.2348272377019704, 'auprc': 0.6447296623542311, 'loss_val': 1.609575518785065, 'psi': 0.3987882075628747}-{'f1_val': 0.22298162643022695, 'auprc': 0.6520862330542345, 'loss_val': 1.620560675729283, 'psi': 0.39462346907983004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=21 head_norm_before_train=1.515020 cos_to_last_merge=0.9514 (last merge round=15)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7010529594768992, 'auprc': 0.9129765867536866, 'loss_val': 0.2836476614046266, 'psi': 0.7858224103876141}-{'f1_val': 0.7013141837391442, 'auprc': 0.9595035051740938, 'loss_val': 0.29091668694823347, 'psi': 0.804589912313124}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=1.438332 cos_to_last_merge=0.9933 (last merge round=16)
[S3] round=21 local utility u=0.090994 metrics={'f1_val': 0.6995786553134029, 'auprc': 0.997173461862002, 'loss_val': 0.3094193501040085, 'psi': 0.8186165779328425}-{'f1_val': 0.6805877389328217, 'auprc': 0.9936921301695717, 'loss_val': 0.3670180308383003, 'psi': 0.8058294954275216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=21 head_norm_before_train=1.382359 cos_to_last_merge=0.9915 (last merge round=15)
[S4] round=21 local utility u=0.101395 metrics={'f1_val': 0.9481642591106239, 'auprc': 0.9586607214232642, 'loss_val': 0.28410014403489414, 'psi': 0.95236284403568}-{'f1_val': 0.938950593932003, 'auprc': 0.9279917460366631, 'loss_val': 0.33960101213171684, 'psi': 0.934567054773867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=21 head_norm_before_train=1.256134 cos_to_last_merge=0.7999 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=21 local utility u=0.030260 metrics={'f1_val': 0.7003191063273064, 'auprc': 0.7718428163415677, 'loss_val': 0.3917048255190978, 'psi': 0.7289285903330109}-{'f1_val': 0.7005685100046517, 'auprc': 0.7499741297562196, 'loss_val': 0.3881158651536131, 'psi': 0.7203307579052789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=21 head_norm_before_train=1.741628 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8205764351131255, 'auprc': 0.921719083021832, 'loss_val': 0.4119009877823934, 'psi': 0.861033494276608}-{'f1_val': 0.8217050719214715, 'auprc': 0.9487004184712287, 'loss_val': 0.3514380777552671, 'psi': 0.8725032105413744}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=1.249061 cos_to_last_merge=0.9679 (last merge round=11)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.3866136740219696, 'auprc': 0.6375701349314611, 'loss_val': 0.9244131636422528, 'psi': 0.4869962583857662}-{'f1_val': 0.7030675372882645, 'auprc': 0.7893561483253949, 'loss_val': 0.5114643572068364, 'psi': 0.7375829817031168}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=1.356472 cos_to_last_merge=0.9790 (last merge round=14)
[S8] round=21 local utility u=0.017134 metrics={'f1_val': 0.991372388611257, 'auprc': 0.9989548033465834, 'loss_val': 0.07827225084169596, 'psi': 0.9944053545053875}-{'f1_val': 0.993841890298642, 'auprc': 0.988529793757652, 'loss_val': 0.09608288702456307, 'psi': 0.991717051682246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=21 head_norm_before_train=1.811387 (no previous merge yet)
[S9] round=21 local utility u=0.001967 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9960562988945463, 'loss_val': 0.03264774329809872, 'psi': 0.9964188266461533}-{'f1_val': 0.994994420763055, 'auprc': 0.9988146555209391, 'loss_val': 0.03486087607212408, 'psi': 0.9965225146662087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=21 head_norm_before_train=1.452478 cos_to_last_merge=0.9899 (last merge round=15)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9337551500739607, 'auprc': 0.9913510229678509, 'loss_val': 0.21137927004917606, 'psi': 0.9567934992315168}-{'f1_val': 0.9945588208961169, 'auprc': 0.9961454581692245, 'loss_val': 0.1307242344241864, 'psi': 0.99519347580536}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=21 head_norm_before_train=1.022612 cos_to_last_merge=0.9533 (last merge round=15)
[S11] round=21 local utility u=0.025555 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978737118810797, 'loss_val': 0.19795791115609754, 'psi': 0.9970776874605856}-{'f1_val': 0.9966988539245482, 'auprc': 0.997382158076812, 'loss_val': 0.2485047296095035, 'psi': 0.9969721755854537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=21 head_norm_before_train=1.029863 cos_to_last_merge=0.9695 (last merge round=14)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.621387509281468, 'auprc': 0.6688505880201334, 'loss_val': 0.6098263204104802, 'psi': 0.6403727407769342}-{'f1_val': 0.6372475615020021, 'auprc': 0.6585058998582319, 'loss_val': 0.6391982171253745, 'psi': 0.645750896844494}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.852367 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9966095684287936, 'auprc': 0.9967909743818655, 'loss_val': 0.03475685829447952, 'psi': 0.9966821308100222}-{'f1_val': 0.997240356705793, 'auprc': 0.9969732116299961, 'loss_val': 0.03388625475458287, 'psi': 0.9971334986754743}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=21 head_norm_before_train=1.195568 cos_to_last_merge=0.9642 (last merge round=15)
[S15] round=21 local utility u=0.780291 metrics={'f1_val': 0.8110489503342919, 'auprc': 0.9880097970298048, 'loss_val': 0.22959256497602773, 'psi': 0.8818332890124971}-{'f1_val': 0.6978446489259277, 'auprc': 0.7995368417557321, 'loss_val': 0.5455295735842159, 'psi': 0.7385215260578495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=21 head_norm_before_train=1.235407 cos_to_last_merge=0.9587 (last merge round=15)
[S16] round=21 local utility u=0.392423 metrics={'f1_val': 0.8808768923745655, 'auprc': 0.927150577059727, 'loss_val': 0.513173233163101, 'psi': 0.8993863662486301}-{'f1_val': 0.78482600890921, 'auprc': 0.8799791605321656, 'loss_val': 0.5801999017868227, 'psi': 0.8228872695583922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=21 head_norm_before_train=1.218144 cos_to_last_merge=0.8047 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=21 local utility u=1.000000 metrics={'f1_val': 0.6212435063620299, 'auprc': 0.7396245795360474, 'loss_val': 1.0432556905139423, 'psi': 0.6685959356316369}-{'f1_val': 0.2348272377019704, 'auprc': 0.6447296623542311, 'loss_val': 1.609575518785065, 'psi': 0.3987882075628747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=22 head_norm_before_train=1.542323 cos_to_last_merge=0.9456 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.946
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.701055136928628, 'auprc': 0.7796985602877313, 'loss_val': 0.27740170370836875, 'psi': 0.7325125062722693}-{'f1_val': 0.7010529594768992, 'auprc': 0.9129765867536866, 'loss_val': 0.2836476614046266, 'psi': 0.7858224103876141}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=1.463467 cos_to_last_merge=0.9914 (last merge round=16)
[S3] round=22 local utility u=0.026139 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9995509523194188, 'loss_val': 0.2702910228365283, 'psi': 0.8201692185230205}-{'f1_val': 0.6995786553134029, 'auprc': 0.997173461862002, 'loss_val': 0.3094193501040085, 'psi': 0.8186165779328425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=22 head_norm_before_train=1.410321 cos_to_last_merge=0.9889 (last merge round=15)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9415210797528828, 'auprc': 0.9677148023501831, 'loss_val': 0.27629986045418947, 'psi': 0.9519985687918029}-{'f1_val': 0.9481642591106239, 'auprc': 0.9586607214232642, 'loss_val': 0.28410014403489414, 'psi': 0.95236284403568}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=1.292485 cos_to_last_merge=0.7896 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=22 local utility u=0.158794 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8551547473206456, 'loss_val': 0.3240623269518743, 'psi': 0.7622542580230736}-{'f1_val': 0.7003191063273064, 'auprc': 0.7718428163415677, 'loss_val': 0.3917048255190978, 'psi': 0.7289285903330109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=22 head_norm_before_train=1.752700 (no previous merge yet)
[S6] round=22 local utility u=0.541420 metrics={'f1_val': 0.9366144602290075, 'auprc': 0.9783485203620161, 'loss_val': 0.19517775808771853, 'psi': 0.953308084282211}-{'f1_val': 0.8205764351131255, 'auprc': 0.921719083021832, 'loss_val': 0.4119009877823934, 'psi': 0.861033494276608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=22 head_norm_before_train=1.256743 cos_to_last_merge=0.9665 (last merge round=11)
[S7] round=22 local utility u=1.000000 metrics={'f1_val': 0.676303426143184, 'auprc': 0.7861356999528387, 'loss_val': 0.5633972800823487, 'psi': 0.7202363356670458}-{'f1_val': 0.3866136740219696, 'auprc': 0.6375701349314611, 'loss_val': 0.9244131636422528, 'psi': 0.4869962583857662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=22 head_norm_before_train=1.393841 cos_to_last_merge=0.9751 (last merge round=14)
[S8] round=22 local utility u=0.008312 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.9979629554590633, 'loss_val': 0.0673851930710649, 'psi': 0.9948798204542397}-{'f1_val': 0.991372388611257, 'auprc': 0.9989548033465834, 'loss_val': 0.07827225084169596, 'psi': 0.9944053545053875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=22 head_norm_before_train=1.831257 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9988412251446852, 'loss_val': 0.046527472568571336, 'psi': 0.9924849023617426}-{'f1_val': 0.9966605118138915, 'auprc': 0.9960562988945463, 'loss_val': 0.03264774329809872, 'psi': 0.9964188266461533}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.479522 cos_to_last_merge=0.9867 (last merge round=15)
[S10] round=22 local utility u=0.250387 metrics={'f1_val': 0.9959993230775146, 'auprc': 0.9940138225217587, 'loss_val': 0.0920583233439737, 'psi': 0.9952051228552122}-{'f1_val': 0.9337551500739607, 'auprc': 0.9913510229678509, 'loss_val': 0.21137927004917606, 'psi': 0.9567934992315168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=22 head_norm_before_train=1.067988 cos_to_last_merge=0.9442 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=22 local utility u=0.018471 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976290867673611, 'loss_val': 0.1588319817239162, 'psi': 0.9968347351882609}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978737118810797, 'loss_val': 0.19795791115609754, 'psi': 0.9970776874605856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=22 head_norm_before_train=1.052990 cos_to_last_merge=0.9639 (last merge round=14)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5899555448578775, 'auprc': 0.6335053505621546, 'loss_val': 0.6579406243438014, 'psi': 0.6073754671395883}-{'f1_val': 0.621387509281468, 'auprc': 0.6688505880201334, 'loss_val': 0.6098263204104802, 'psi': 0.6403727407769342}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.869663 (no previous merge yet)
[S14] round=22 local utility u=0.004847 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.9970559071082734, 'loss_val': 0.029777296631627842, 'psi': 0.9971799789484399}-{'f1_val': 0.9966095684287936, 'auprc': 0.9967909743818655, 'loss_val': 0.03475685829447952, 'psi': 0.9966821308100222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=22 head_norm_before_train=1.237252 cos_to_last_merge=0.9589 (last merge round=15)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7012821651753085, 'auprc': 0.8308942240840693, 'loss_val': 0.34045060828244617, 'psi': 0.7531269887388128}-{'f1_val': 0.8110489503342919, 'auprc': 0.9880097970298048, 'loss_val': 0.22959256497602773, 'psi': 0.8818332890124971}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=22 head_norm_before_train=1.275311 cos_to_last_merge=0.9516 (last merge round=15)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8319332921857417, 'auprc': 0.8963387558617414, 'loss_val': 0.772234769836377, 'psi': 0.8576954776561416}-{'f1_val': 0.8808768923745655, 'auprc': 0.927150577059727, 'loss_val': 0.513173233163101, 'psi': 0.8993863662486301}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.226669 cos_to_last_merge=0.8028 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.39560483780194056, 'auprc': 0.724573498705313, 'loss_val': 0.9393074038380864, 'psi': 0.5271923021632896}-{'f1_val': 0.6212435063620299, 'auprc': 0.7396245795360474, 'loss_val': 1.0432556905139423, 'psi': 0.6685959356316369}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.565715 cos_to_last_merge=0.9409 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7437892213947357, 'loss_val': 0.2733070338672404, 'psi': 0.7183041988013807}-{'f1_val': 0.701055136928628, 'auprc': 0.7796985602877313, 'loss_val': 0.27740170370836875, 'psi': 0.7325125062722693}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.489938 cos_to_last_merge=0.9895 (last merge round=16)
[S3] round=23 local utility u=0.023952 metrics={'f1_val': 0.7018768808926283, 'auprc': 0.9989399719723034, 'loss_val': 0.22832712892098664, 'psi': 0.8207021173244984}-{'f1_val': 0.7005813959920884, 'auprc': 0.9995509523194188, 'loss_val': 0.2702910228365283, 'psi': 0.8201692185230205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=23 head_norm_before_train=1.437201 cos_to_last_merge=0.9861 (last merge round=15)
[S4] round=23 local utility u=0.004007 metrics={'f1_val': 0.9420446062422495, 'auprc': 0.9694882102303829, 'loss_val': 0.2767464696119198, 'psi': 0.9530220478375029}-{'f1_val': 0.9415210797528828, 'auprc': 0.9677148023501831, 'loss_val': 0.27629986045418947, 'psi': 0.9519985687918029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=23 head_norm_before_train=1.325123 cos_to_last_merge=0.7809 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.781
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7686194500762724, 'loss_val': 0.3645080059122793, 'psi': 0.7278128156281136}-{'f1_val': 0.700320598491359, 'auprc': 0.8551547473206456, 'loss_val': 0.3240623269518743, 'psi': 0.7622542580230736}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=1.767244 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8255633017221797, 'auprc': 0.9529334828964227, 'loss_val': 0.46503304887571245, 'psi': 0.8765113741918769}-{'f1_val': 0.9366144602290075, 'auprc': 0.9783485203620161, 'loss_val': 0.19517775808771853, 'psi': 0.953308084282211}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.264068 cos_to_last_merge=0.9652 (last merge round=11)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.3889777101071985, 'auprc': 0.6512537882869139, 'loss_val': 0.9275224659226985, 'psi': 0.49388814137908466}-{'f1_val': 0.676303426143184, 'auprc': 0.7861356999528387, 'loss_val': 0.5633972800823487, 'psi': 0.7202363356670458}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=1.430384 cos_to_last_merge=0.9716 (last merge round=14)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.9891069972857096, 'loss_val': 0.06125437690024516, 'psi': 0.9913374371848983}-{'f1_val': 0.9928243971176908, 'auprc': 0.9979629554590633, 'loss_val': 0.0673851930710649, 'psi': 0.9948798204542397}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=23 head_norm_before_train=1.850197 (no previous merge yet)
[S9] round=23 local utility u=0.030643 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9960521361281456, 'loss_val': 0.027353336805873835, 'psi': 0.9964171615395931}-{'f1_val': 0.9882473538397808, 'auprc': 0.9988412251446852, 'loss_val': 0.046527472568571336, 'psi': 0.9924849023617426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=23 head_norm_before_train=1.502821 cos_to_last_merge=0.9838 (last merge round=15)
[S10] round=23 local utility u=0.002906 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9946789432892538, 'loss_val': 0.08454439363377675, 'psi': 0.9951013876407209}-{'f1_val': 0.9959993230775146, 'auprc': 0.9940138225217587, 'loss_val': 0.0920583233439737, 'psi': 0.9952051228552122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=23 head_norm_before_train=1.112826 cos_to_last_merge=0.9359 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9963061018870393, 'auprc': 0.9973300956296275, 'loss_val': 0.16067338429823289, 'psi': 0.9967156993840747}-{'f1_val': 0.996305167468861, 'auprc': 0.9976290867673611, 'loss_val': 0.1588319817239162, 'psi': 0.9968347351882609}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=1.078335 cos_to_last_merge=0.9584 (last merge round=14)
[S13] round=23 local utility u=0.058731 metrics={'f1_val': 0.5867105733835315, 'auprc': 0.6726253884103452, 'loss_val': 0.6383683593704841, 'psi': 0.621076499394257}-{'f1_val': 0.5899555448578775, 'auprc': 0.6335053505621546, 'loss_val': 0.6579406243438014, 'psi': 0.6073754671395883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=23 head_norm_before_train=1.888700 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.99697254585925, 'loss_val': 0.028456376274627316, 'psi': 0.9970326990454437}-{'f1_val': 0.9972626935085508, 'auprc': 0.9970559071082734, 'loss_val': 0.029777296631627842, 'psi': 0.9971799789484399}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=1.281795 cos_to_last_merge=0.9544 (last merge round=15)
[S15] round=23 local utility u=0.595633 metrics={'f1_val': 0.8045340784225522, 'auprc': 0.9813516858446552, 'loss_val': 0.22006939251395097, 'psi': 0.8752611213913934}-{'f1_val': 0.7012821651753085, 'auprc': 0.8308942240840693, 'loss_val': 0.34045060828244617, 'psi': 0.7531269887388128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=23 head_norm_before_train=1.310835 cos_to_last_merge=0.9455 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=23 local utility u=0.232881 metrics={'f1_val': 0.853650104777323, 'auprc': 0.9651713685705061, 'loss_val': 0.643271593451529, 'psi': 0.8982586102945962}-{'f1_val': 0.8319332921857417, 'auprc': 0.8963387558617414, 'loss_val': 0.772234769836377, 'psi': 0.8576954776561416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=23 head_norm_before_train=1.236762 cos_to_last_merge=0.8007 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.37407552046007597, 'auprc': 0.6944711968505883, 'loss_val': 0.9103551243501457, 'psi': 0.5022337910162809}-{'f1_val': 0.39560483780194056, 'auprc': 0.724573498705313, 'loss_val': 0.9393074038380864, 'psi': 0.5271923021632896}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=24 head_norm_before_train=1.585232 cos_to_last_merge=0.9373 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.937
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.6870802730041141, 'loss_val': 0.2708161192920473, 'psi': 0.6956206194451322}-{'f1_val': 0.7013141837391442, 'auprc': 0.7437892213947357, 'loss_val': 0.2733070338672404, 'psi': 0.7183041988013807}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=1.515676 cos_to_last_merge=0.9876 (last merge round=16)
[S3] round=24 local utility u=0.009228 metrics={'f1_val': 0.7044045881461305, 'auprc': 0.9994980842623676, 'loss_val': 0.22671125193632416, 'psi': 0.8224419865926254}-{'f1_val': 0.7018768808926283, 'auprc': 0.9989399719723034, 'loss_val': 0.22832712892098664, 'psi': 0.8207021173244984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=24 head_norm_before_train=1.463065 cos_to_last_merge=0.9834 (last merge round=15)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.935390291761556, 'auprc': 0.9212149822554796, 'loss_val': 0.35089233275250836, 'psi': 0.9297201679591254}-{'f1_val': 0.9420446062422495, 'auprc': 0.9694882102303829, 'loss_val': 0.2767464696119198, 'psi': 0.9530220478375029}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.354879 cos_to_last_merge=0.7733 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.773
[S5] round=24 local utility u=0.117638 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8383886665842559, 'loss_val': 0.3385399973376526, 'psi': 0.7557205022313069}-{'f1_val': 0.7006083926626743, 'auprc': 0.7686194500762724, 'loss_val': 0.3645080059122793, 'psi': 0.7278128156281136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=24 head_norm_before_train=1.782745 (no previous merge yet)
[S6] round=24 local utility u=0.050877 metrics={'f1_val': 0.8273703037715543, 'auprc': 0.9561335209128365, 'loss_val': 0.38372189343876856, 'psi': 0.8788755906280672}-{'f1_val': 0.8255633017221797, 'auprc': 0.9529334828964227, 'loss_val': 0.46503304887571245, 'psi': 0.8765113741918769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=24 head_norm_before_train=1.276651 cos_to_last_merge=0.9632 (last merge round=11)
[S7] round=24 local utility u=1.000000 metrics={'f1_val': 0.681804890150531, 'auprc': 0.786252571260104, 'loss_val': 0.4736741462975788, 'psi': 0.7235839625943602}-{'f1_val': 0.3889777101071985, 'auprc': 0.6512537882869139, 'loss_val': 0.9275224659226985, 'psi': 0.49388814137908466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=24 head_norm_before_train=1.461946 cos_to_last_merge=0.9684 (last merge round=14)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9856694732614234, 'loss_val': 0.06203387518509978, 'psi': 0.9901272184267893}-{'f1_val': 0.9928243971176908, 'auprc': 0.9891069972857096, 'loss_val': 0.06125437690024516, 'psi': 0.9913374371848983}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=1.866259 (no previous merge yet)
[S9] round=24 local utility u=0.001975 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988455792469579, 'loss_val': 0.026781629403377225, 'psi': 0.9970342627172945}-{'f1_val': 0.9966605118138915, 'auprc': 0.9960521361281456, 'loss_val': 0.027353336805873835, 'psi': 0.9964171615395931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=24 head_norm_before_train=1.523718 cos_to_last_merge=0.9812 (last merge round=15)
[S10] round=24 local utility u=0.004908 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9949248364044525, 'loss_val': 0.07546592792669318, 'psi': 0.9951997448868004}-{'f1_val': 0.9953830172083656, 'auprc': 0.9946789432892538, 'loss_val': 0.08454439363377675, 'psi': 0.9951013876407209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=24 head_norm_before_train=1.154765 cos_to_last_merge=0.9283 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=24 local utility u=0.022816 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9968633982842079, 'loss_val': 0.11363597493304939, 'psi': 0.9965284597949997}-{'f1_val': 0.9963061018870393, 'auprc': 0.9973300956296275, 'loss_val': 0.16067338429823289, 'psi': 0.9967156993840747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=24 head_norm_before_train=1.104468 cos_to_last_merge=0.9524 (last merge round=14)
[S13] round=24 local utility u=0.056247 metrics={'f1_val': 0.6170978821420332, 'auprc': 0.6451737493633471, 'loss_val': 0.6258435857772882, 'psi': 0.6283282290305587}-{'f1_val': 0.5867105733835315, 'auprc': 0.6726253884103452, 'loss_val': 0.6383683593704841, 'psi': 0.621076499394257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=24 head_norm_before_train=1.907358 (no previous merge yet)
[S14] round=24 local utility u=0.001006 metrics={'f1_val': 0.9974095353784286, 'auprc': 0.9969722720768814, 'loss_val': 0.028463479801528163, 'psi': 0.9972346300578097}-{'f1_val': 0.9970728011695729, 'auprc': 0.99697254585925, 'loss_val': 0.028456376274627316, 'psi': 0.9970326990454437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=24 head_norm_before_train=1.323088 cos_to_last_merge=0.9503 (last merge round=15)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7379660286803504, 'auprc': 0.8534406458229539, 'loss_val': 0.34791656290032963, 'psi': 0.7841558755373919}-{'f1_val': 0.8045340784225522, 'auprc': 0.9813516858446552, 'loss_val': 0.22006939251395097, 'psi': 0.8752611213913934}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=1.348134 cos_to_last_merge=0.9392 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.939
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8503083798979627, 'auprc': 0.9696044972873297, 'loss_val': 0.6882324601947332, 'psi': 0.8980268268537095}-{'f1_val': 0.853650104777323, 'auprc': 0.9651713685705061, 'loss_val': 0.643271593451529, 'psi': 0.8982586102945962}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.249259 cos_to_last_merge=0.7983 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=24 local utility u=0.009788 metrics={'f1_val': 0.37128939559101526, 'auprc': 0.7152876089230168, 'loss_val': 0.9365122216038267, 'psi': 0.5088886809238159}-{'f1_val': 0.37407552046007597, 'auprc': 0.6944711968505883, 'loss_val': 0.9103551243501457, 'psi': 0.5022337910162809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=25 head_norm_before_train=1.600356 cos_to_last_merge=0.9350 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=25 local utility u=0.032315 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7078625597908406, 'loss_val': 0.2685323098759546, 'psi': 0.7039335341598227}-{'f1_val': 0.7013141837391442, 'auprc': 0.6870802730041141, 'loss_val': 0.2708161192920473, 'psi': 0.6956206194451322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=25 head_norm_before_train=1.538279 cos_to_last_merge=0.9857 (last merge round=16)
[S3] round=25 local utility u=0.870955 metrics={'f1_val': 0.9973750180472613, 'auprc': 0.9987392647210649, 'loss_val': 0.2403466286118153, 'psi': 0.9979207167167827}-{'f1_val': 0.7044045881461305, 'auprc': 0.9994980842623676, 'loss_val': 0.22671125193632416, 'psi': 0.8224419865926254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=25 head_norm_before_train=1.481080 cos_to_last_merge=0.9813 (last merge round=15)
[S4] round=25 local utility u=0.117294 metrics={'f1_val': 0.9414048451587912, 'auprc': 0.9595557467107283, 'loss_val': 0.2674149433868151, 'psi': 0.9486652057795661}-{'f1_val': 0.935390291761556, 'auprc': 0.9212149822554796, 'loss_val': 0.35089233275250836, 'psi': 0.9297201679591254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=25 head_norm_before_train=1.382904 cos_to_last_merge=0.7667 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=25 local utility u=0.252993 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9834084639840839, 'loss_val': 0.2676143203871911, 'psi': 0.8137284211912381}-{'f1_val': 0.7006083926626743, 'auprc': 0.8383886665842559, 'loss_val': 0.3385399973376526, 'psi': 0.7557205022313069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=25 head_norm_before_train=1.798243 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.41588308903900795, 'auprc': 0.8116084350596129, 'loss_val': 1.1287549267501022, 'psi': 0.57417322744725}-{'f1_val': 0.8273703037715543, 'auprc': 0.9561335209128365, 'loss_val': 0.38372189343876856, 'psi': 0.8788755906280672}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.288410 cos_to_last_merge=0.9614 (last merge round=11)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.4422551075615527, 'auprc': 0.63047489992825, 'loss_val': 0.8802666124590516, 'psi': 0.5175430245082315}-{'f1_val': 0.681804890150531, 'auprc': 0.786252571260104, 'loss_val': 0.4736741462975788, 'psi': 0.7235839625943602}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=1.491080 cos_to_last_merge=0.9656 (last merge round=14)
[S8] round=25 local utility u=0.010958 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9889459134969665, 'loss_val': 0.05335780492772879, 'psi': 0.9917789532099262}-{'f1_val': 0.9930990485370332, 'auprc': 0.9856694732614234, 'loss_val': 0.06203387518509978, 'psi': 0.9901272184267893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=25 head_norm_before_train=1.880991 (no previous merge yet)
[S9] round=25 local utility u=0.001880 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9986011737953893, 'loss_val': 0.024803887854134583, 'psi': 0.9971881384976872}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988455792469579, 'loss_val': 0.026781629403377225, 'psi': 0.9970342627172945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=25 head_norm_before_train=1.547131 cos_to_last_merge=0.9785 (last merge round=15)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.993254087376817, 'auprc': 0.9942216629264541, 'loss_val': 0.10398610577095392, 'psi': 0.9936411175966718}-{'f1_val': 0.9953830172083656, 'auprc': 0.9949248364044525, 'loss_val': 0.07546592792669318, 'psi': 0.9951997448868004}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=25 head_norm_before_train=1.191955 cos_to_last_merge=0.9218 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.922
[S11] round=25 local utility u=0.000778 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9971181190188456, 'loss_val': 0.11429488497114583, 'psi': 0.996775450315692}-{'f1_val': 0.996305167468861, 'auprc': 0.9968633982842079, 'loss_val': 0.11363597493304939, 'psi': 0.9965284597949997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=25 head_norm_before_train=1.129941 cos_to_last_merge=0.9467 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=25 local utility u=0.016233 metrics={'f1_val': 0.6129200676099757, 'auprc': 0.6643655214666655, 'loss_val': 0.6258855613170239, 'psi': 0.6334982491526516}-{'f1_val': 0.6170978821420332, 'auprc': 0.6451737493633471, 'loss_val': 0.6258435857772882, 'psi': 0.6283282290305587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=25 head_norm_before_train=1.919485 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.977301258475265, 'auprc': 0.9968868732232545, 'loss_val': 0.055615643452853365, 'psi': 0.9851355043744607}-{'f1_val': 0.9974095353784286, 'auprc': 0.9969722720768814, 'loss_val': 0.028463479801528163, 'psi': 0.9972346300578097}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=1.361923 cos_to_last_merge=0.9462 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=25 local utility u=0.102406 metrics={'f1_val': 0.7661485508789556, 'auprc': 0.8615381628628923, 'loss_val': 0.3364922120107111, 'psi': 0.8043043956725303}-{'f1_val': 0.7379660286803504, 'auprc': 0.8534406458229539, 'loss_val': 0.34791656290032963, 'psi': 0.7841558755373919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=25 head_norm_before_train=1.385390 cos_to_last_merge=0.9332 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=25 local utility u=0.044618 metrics={'f1_val': 0.8553645077383922, 'auprc': 0.9792644682590006, 'loss_val': 0.6583139574483869, 'psi': 0.9049244919466356}-{'f1_val': 0.8503083798979627, 'auprc': 0.9696044972873297, 'loss_val': 0.6882324601947332, 'psi': 0.8980268268537095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=25 head_norm_before_train=1.256370 cos_to_last_merge=0.7973 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.797
[S17] round=25 local utility u=0.231308 metrics={'f1_val': 0.3976680262422095, 'auprc': 0.8064088549110566, 'loss_val': 0.9055314013670728, 'psi': 0.5611643577097484}-{'f1_val': 0.37128939559101526, 'auprc': 0.7152876089230168, 'loss_val': 0.9365122216038267, 'psi': 0.5088886809238159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=26 head_norm_before_train=1.612970 cos_to_last_merge=0.9332 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.933
[S2] round=26 local utility u=0.022570 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7223282766745107, 'loss_val': 0.2667897072770826, 'psi': 0.7097198209132909}-{'f1_val': 0.7013141837391442, 'auprc': 0.7078625597908406, 'loss_val': 0.2685323098759546, 'psi': 0.7039335341598227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=26 head_norm_before_train=1.560695 cos_to_last_merge=0.9837 (last merge round=16)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.6937634814320142, 'auprc': 0.8182669478439875, 'loss_val': 0.4765793382472786, 'psi': 0.7435648679968034}-{'f1_val': 0.9973750180472613, 'auprc': 0.9987392647210649, 'loss_val': 0.2403466286118153, 'psi': 0.9979207167167827}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.503806 cos_to_last_merge=0.9789 (last merge round=15)
[S4] round=26 local utility u=0.019922 metrics={'f1_val': 0.9452275122501398, 'auprc': 0.9614510217739032, 'loss_val': 0.2561918675594134, 'psi': 0.951716916059645}-{'f1_val': 0.9414048451587912, 'auprc': 0.9595557467107283, 'loss_val': 0.2674149433868151, 'psi': 0.9486652057795661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=26 head_norm_before_train=1.407138 cos_to_last_merge=0.7609 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.761
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9761177235723806, 'loss_val': 0.2609629943863709, 'psi': 0.8108121250265568}-{'f1_val': 0.7006083926626743, 'auprc': 0.9834084639840839, 'loss_val': 0.2676143203871911, 'psi': 0.8137284211912381}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.808955 (no previous merge yet)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.9855304396430284, 'auprc': 0.9792754253919133, 'loss_val': 0.12489199216301708, 'psi': 0.9830284339425824}-{'f1_val': 0.41588308903900795, 'auprc': 0.8116084350596129, 'loss_val': 1.1287549267501022, 'psi': 0.57417322744725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=26 head_norm_before_train=1.299478 cos_to_last_merge=0.9595 (last merge round=11)
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.6943394567416057, 'auprc': 0.9501258931084067, 'loss_val': 0.41545179988068476, 'psi': 0.7966540312883261}-{'f1_val': 0.4422551075615527, 'auprc': 0.63047489992825, 'loss_val': 0.8802666124590516, 'psi': 0.5175430245082315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=26 head_norm_before_train=1.513536 cos_to_last_merge=0.9636 (last merge round=14)
[S8] round=26 local utility u=0.005236 metrics={'f1_val': 0.9906496251316108, 'auprc': 0.9989765117492241, 'loss_val': 0.05486974283569446, 'psi': 0.9939803797786562}-{'f1_val': 0.9936676463518993, 'auprc': 0.9889459134969665, 'loss_val': 0.05335780492772879, 'psi': 0.9917789532099262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=26 head_norm_before_train=1.894299 (no previous merge yet)
[S9] round=26 local utility u=0.004057 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995864668589047, 'loss_val': 0.024785598752705213, 'psi': 0.9980963342508475}-{'f1_val': 0.9962461149658858, 'auprc': 0.9986011737953893, 'loss_val': 0.024803887854134583, 'psi': 0.9971881384976872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=26 head_norm_before_train=1.564431 cos_to_last_merge=0.9766 (last merge round=15)
[S10] round=26 local utility u=0.024230 metrics={'f1_val': 0.9945528553774142, 'auprc': 0.9947917288587815, 'loss_val': 0.06502867399145679, 'psi': 0.9946484047699611}-{'f1_val': 0.993254087376817, 'auprc': 0.9942216629264541, 'loss_val': 0.10398610577095392, 'psi': 0.9936411175966718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=26 head_norm_before_train=1.220799 cos_to_last_merge=0.9166 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.917
[S11] round=26 local utility u=0.012266 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9970062618594693, 'loss_val': 0.08797703699606244, 'psi': 0.9965856052251043}-{'f1_val': 0.9965470045135896, 'auprc': 0.9971181190188456, 'loss_val': 0.11429488497114583, 'psi': 0.996775450315692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=26 head_norm_before_train=1.150094 cos_to_last_merge=0.9417 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5889739649951774, 'auprc': 0.6829251368067198, 'loss_val': 0.7013382741699392, 'psi': 0.6265544337197944}-{'f1_val': 0.6129200676099757, 'auprc': 0.6643655214666655, 'loss_val': 0.6258855613170239, 'psi': 0.6334982491526516}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.930752 (no previous merge yet)
[S14] round=26 local utility u=0.065753 metrics={'f1_val': 0.9947368952937303, 'auprc': 0.998661936936609, 'loss_val': 0.03404936231847159, 'psi': 0.9963069119508817}-{'f1_val': 0.977301258475265, 'auprc': 0.9968868732232545, 'loss_val': 0.055615643452853365, 'psi': 0.9851355043744607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=26 head_norm_before_train=1.396865 cos_to_last_merge=0.9420 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=26 local utility u=0.899864 metrics={'f1_val': 0.9647719949837945, 'auprc': 0.9912612879593918, 'loss_val': 0.1176748815752746, 'psi': 0.9753677121740334}-{'f1_val': 0.7661485508789556, 'auprc': 0.8615381628628923, 'loss_val': 0.3364922120107111, 'psi': 0.8043043956725303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] sending update (kind=head size=1808 to 1 peers)
[S16] START round=26 head_norm_before_train=1.420458 cos_to_last_merge=0.9277 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=26 local utility u=0.376587 metrics={'f1_val': 0.9273304730388927, 'auprc': 0.9842401700127907, 'loss_val': 0.35186253274260304, 'psi': 0.9500943518284519}-{'f1_val': 0.8553645077383922, 'auprc': 0.9792644682590006, 'loss_val': 0.6583139574483869, 'psi': 0.9049244919466356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=26 head_norm_before_train=1.268422 cos_to_last_merge=0.7956 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.796
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.39387902566950306, 'auprc': 0.7868218190003324, 'loss_val': 0.9528574076589595, 'psi': 0.5510561430018348}-{'f1_val': 0.3976680262422095, 'auprc': 0.8064088549110566, 'loss_val': 0.9055314013670728, 'psi': 0.5611643577097484}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.624840 cos_to_last_merge=0.9313 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=27 local utility u=0.035127 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7452214981046745, 'loss_val': 0.26521441902720244, 'psi': 0.7188771094853563}-{'f1_val': 0.7013141837391442, 'auprc': 0.7223282766745107, 'loss_val': 0.2667897072770826, 'psi': 0.7097198209132909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=27 head_norm_before_train=1.584547 cos_to_last_merge=0.9815 (last merge round=16)
[S3] round=27 local utility u=1.000000 metrics={'f1_val': 0.9881552793648927, 'auprc': 0.9994936604042575, 'loss_val': 0.14419084782244798, 'psi': 0.9926906317806387}-{'f1_val': 0.6937634814320142, 'auprc': 0.8182669478439875, 'loss_val': 0.4765793382472786, 'psi': 0.7435648679968034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=27 head_norm_before_train=1.524371 cos_to_last_merge=0.9765 (last merge round=15)
[S4] round=27 local utility u=0.036833 metrics={'f1_val': 0.9549216081358766, 'auprc': 0.9629977954361574, 'loss_val': 0.2453316409359659, 'psi': 0.9581520830559889}-{'f1_val': 0.9452275122501398, 'auprc': 0.9614510217739032, 'loss_val': 0.2561918675594134, 'psi': 0.951716916059645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=27 head_norm_before_train=1.428239 cos_to_last_merge=0.7559 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.756
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.4258101889986133, 'auprc': 0.8522551796578909, 'loss_val': 1.2496419308519278, 'psi': 0.5963881852623243}-{'f1_val': 0.7006083926626743, 'auprc': 0.9761177235723806, 'loss_val': 0.2609629943863709, 'psi': 0.8108121250265568}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.815629 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.7741561840460935, 'auprc': 0.9210406572369814, 'loss_val': 0.5185682697742245, 'psi': 0.8329099733224486}-{'f1_val': 0.9855304396430284, 'auprc': 0.9792754253919133, 'loss_val': 0.12489199216301708, 'psi': 0.9830284339425824}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.311774 cos_to_last_merge=0.9573 (last merge round=11)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.588228504272885, 'auprc': 0.6942137129014454, 'loss_val': 0.7180117644624695, 'psi': 0.6306225877243091}-{'f1_val': 0.6943394567416057, 'auprc': 0.9501258931084067, 'loss_val': 0.41545179988068476, 'psi': 0.7966540312883261}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=1.533343 cos_to_last_merge=0.9618 (last merge round=14)
[S8] round=27 local utility u=0.004291 metrics={'f1_val': 0.991372388611257, 'auprc': 0.9989542759818496, 'loss_val': 0.050558247108111506, 'psi': 0.994405143559494}-{'f1_val': 0.9906496251316108, 'auprc': 0.9989765117492241, 'loss_val': 0.05486974283569446, 'psi': 0.9939803797786562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=27 head_norm_before_train=1.908639 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9996094200419312, 'loss_val': 0.029367718837524023, 'psi': 0.9963575918671121}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995864668589047, 'loss_val': 0.024785598752705213, 'psi': 0.9980963342508475}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.582826 cos_to_last_merge=0.9741 (last merge round=15)
[S10] round=27 local utility u=0.003368 metrics={'f1_val': 0.9945528553774142, 'auprc': 0.9947846620530909, 'loss_val': 0.05827075301357133, 'psi': 0.9946455780476848}-{'f1_val': 0.9945528553774142, 'auprc': 0.9947917288587815, 'loss_val': 0.06502867399145679, 'psi': 0.9946484047699611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=27 head_norm_before_train=1.249496 cos_to_last_merge=0.9116 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9577511463029809, 'auprc': 0.9977557750309983, 'loss_val': 0.16942128304840923, 'psi': 0.9737529977941879}-{'f1_val': 0.996305167468861, 'auprc': 0.9970062618594693, 'loss_val': 0.08797703699606244, 'psi': 0.9965856052251043}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.168199 cos_to_last_merge=0.9362 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5927115515041576, 'auprc': 0.6599131054792566, 'loss_val': 0.66909641737834, 'psi': 0.6195921730941971}-{'f1_val': 0.5889739649951774, 'auprc': 0.6829251368067198, 'loss_val': 0.7013382741699392, 'psi': 0.6265544337197944}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.943042 (no previous merge yet)
[S14] round=27 local utility u=0.009738 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9986617882887615, 'loss_val': 0.02706574346340791, 'psi': 0.997556058948197}-{'f1_val': 0.9947368952937303, 'auprc': 0.998661936936609, 'loss_val': 0.03404936231847159, 'psi': 0.9963069119508817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=27 head_norm_before_train=1.430132 cos_to_last_merge=0.9380 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.8213733057427007, 'auprc': 0.9653182996945502, 'loss_val': 0.22872118168974523, 'psi': 0.8789513033234405}-{'f1_val': 0.9647719949837945, 'auprc': 0.9912612879593918, 'loss_val': 0.1176748815752746, 'psi': 0.9753677121740334}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.448756 cos_to_last_merge=0.9234 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=27 local utility u=0.164097 metrics={'f1_val': 0.9507222001154835, 'auprc': 0.9842762441733299, 'loss_val': 0.16412723920169464, 'psi': 0.964143817738622}-{'f1_val': 0.9273304730388927, 'auprc': 0.9842401700127907, 'loss_val': 0.35186253274260304, 'psi': 0.9500943518284519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=27 head_norm_before_train=1.285263 cos_to_last_merge=0.7935 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=27 local utility u=0.014098 metrics={'f1_val': 0.3946566724070981, 'auprc': 0.7975003464133595, 'loss_val': 0.9613619399385298, 'psi': 0.5557941420096026}-{'f1_val': 0.39387902566950306, 'auprc': 0.7868218190003324, 'loss_val': 0.9528574076589595, 'psi': 0.5510561430018348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=28 head_norm_before_train=1.635183 cos_to_last_merge=0.9298 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.930
[S2] round=28 local utility u=0.000873 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7454850317727068, 'loss_val': 0.26425832773114444, 'psi': 0.7189825229525693}-{'f1_val': 0.7013141837391442, 'auprc': 0.7452214981046745, 'loss_val': 0.26521441902720244, 'psi': 0.7188771094853563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=28 head_norm_before_train=1.608768 cos_to_last_merge=0.9794 (last merge round=16)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.968980246354657, 'auprc': 0.9991704361896545, 'loss_val': 0.13202996017042382, 'psi': 0.9810563222886559}-{'f1_val': 0.9881552793648927, 'auprc': 0.9994936604042575, 'loss_val': 0.14419084782244798, 'psi': 0.9926906317806387}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.541867 cos_to_last_merge=0.9746 (last merge round=15)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9457544885808814, 'auprc': 0.9399858593293192, 'loss_val': 0.2583770061075906, 'psi': 0.9434470368802566}-{'f1_val': 0.9549216081358766, 'auprc': 0.9629977954361574, 'loss_val': 0.2453316409359659, 'psi': 0.9581520830559889}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.447601 cos_to_last_merge=0.7518 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.752
[S5] round=28 local utility u=0.319794 metrics={'f1_val': 0.4449339324028573, 'auprc': 0.8535321756046664, 'loss_val': 0.7286276228548755, 'psi': 0.608373229683581}-{'f1_val': 0.4258101889986133, 'auprc': 0.8522551796578909, 'loss_val': 1.2496419308519278, 'psi': 0.5963881852623243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=28 head_norm_before_train=1.821738 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.49960327958627526, 'auprc': 0.8039394579678043, 'loss_val': 0.9149598530022761, 'psi': 0.6213377509388869}-{'f1_val': 0.7741561840460935, 'auprc': 0.9210406572369814, 'loss_val': 0.5185682697742245, 'psi': 0.8329099733224486}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.326243 cos_to_last_merge=0.9549 (last merge round=11)
[S7] round=28 local utility u=0.004412 metrics={'f1_val': 0.5641630335989096, 'auprc': 0.7532811598822681, 'loss_val': 0.7419978360949572, 'psi': 0.639810284112253}-{'f1_val': 0.588228504272885, 'auprc': 0.6942137129014454, 'loss_val': 0.7180117644624695, 'psi': 0.6306225877243091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=28 head_norm_before_train=1.552681 cos_to_last_merge=0.9607 (last merge round=14)
[S8] round=28 local utility u=0.004869 metrics={'f1_val': 0.9925028268365944, 'auprc': 0.9989313603893355, 'loss_val': 0.04753465533708804, 'psi': 0.9950742402576909}-{'f1_val': 0.991372388611257, 'auprc': 0.9989542759818496, 'loss_val': 0.050558247108111506, 'psi': 0.994405143559494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=28 head_norm_before_train=1.921579 (no previous merge yet)
[S9] round=28 local utility u=0.011069 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9995984088915756, 'loss_val': 0.022193285038922983, 'psi': 0.9978528525353334}-{'f1_val': 0.9941897064172326, 'auprc': 0.9996094200419312, 'loss_val': 0.029367718837524023, 'psi': 0.9963575918671121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=28 head_norm_before_train=1.604949 cos_to_last_merge=0.9712 (last merge round=15)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9941346799048074, 'loss_val': 0.07565934899233841, 'psi': 0.9942677109889757}-{'f1_val': 0.9945528553774142, 'auprc': 0.9947846620530909, 'loss_val': 0.05827075301357133, 'psi': 0.9946455780476848}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=1.276858 cos_to_last_merge=0.9073 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=28 local utility u=0.166375 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997950408160236, 'loss_val': 0.07002964704524861, 'psi': 0.9971083659722482}-{'f1_val': 0.9577511463029809, 'auprc': 0.9977557750309983, 'loss_val': 0.16942128304840923, 'psi': 0.9737529977941879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=28 head_norm_before_train=1.187469 cos_to_last_merge=0.9303 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=28 local utility u=0.056708 metrics={'f1_val': 0.6058627142930999, 'auprc': 0.6712135207057612, 'loss_val': 0.6684890539553395, 'psi': 0.6320030368581644}-{'f1_val': 0.5927115515041576, 'auprc': 0.6599131054792566, 'loss_val': 0.66909641737834, 'psi': 0.6195921730941971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=28 head_norm_before_train=1.951498 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9963594395247332, 'auprc': 0.9959488253372033, 'loss_val': 0.02831764383027047, 'psi': 0.9961951938497212}-{'f1_val': 0.9968189060544872, 'auprc': 0.9986617882887615, 'loss_val': 0.02706574346340791, 'psi': 0.997556058948197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.463329 cos_to_last_merge=0.9337 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=28 local utility u=0.411323 metrics={'f1_val': 0.9285917696732484, 'auprc': 0.9888469590968749, 'loss_val': 0.11997247191072698, 'psi': 0.952693845442699}-{'f1_val': 0.8213733057427007, 'auprc': 0.9653182996945502, 'loss_val': 0.22872118168974523, 'psi': 0.8789513033234405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=28 head_norm_before_train=1.476256 cos_to_last_merge=0.9193 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8334452801426989, 'auprc': 0.8681462477741883, 'loss_val': 0.8931978764536089, 'psi': 0.8473256671952947}-{'f1_val': 0.9507222001154835, 'auprc': 0.9842762441733299, 'loss_val': 0.16412723920169464, 'psi': 0.964143817738622}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.305052 cos_to_last_merge=0.7913 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.791
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.29829706666738953, 'auprc': 0.7771299506662112, 'loss_val': 1.3160520746390014, 'psi': 0.4898302202669182}-{'f1_val': 0.3946566724070981, 'auprc': 0.7975003464133595, 'loss_val': 0.9613619399385298, 'psi': 0.5557941420096026}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.643067 cos_to_last_merge=0.9290 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=29 local utility u=0.075362 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.795058702455522, 'loss_val': 0.2622552495638474, 'psi': 0.7388119912256954}-{'f1_val': 0.7013141837391442, 'auprc': 0.7454850317727068, 'loss_val': 0.26425832773114444, 'psi': 0.7189825229525693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=29 head_norm_before_train=1.629827 cos_to_last_merge=0.9776 (last merge round=16)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9274366385191306, 'auprc': 0.9958198714508854, 'loss_val': 0.18597102579634683, 'psi': 0.9547899316918325}-{'f1_val': 0.968980246354657, 'auprc': 0.9991704361896545, 'loss_val': 0.13202996017042382, 'psi': 0.9810563222886559}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.557633 cos_to_last_merge=0.9729 (last merge round=15)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9498166308410818, 'auprc': 0.910593904000341, 'loss_val': 0.2508761016006208, 'psi': 0.9341275401047855}-{'f1_val': 0.9457544885808814, 'auprc': 0.9399858593293192, 'loss_val': 0.2583770061075906, 'psi': 0.9434470368802566}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.462245 cos_to_last_merge=0.7490 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.749
[S5] round=29 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9894230647018101, 'loss_val': 0.2579789239363652, 'psi': 0.8159620163410723}-{'f1_val': 0.4449339324028573, 'auprc': 0.8535321756046664, 'loss_val': 0.7286276228548755, 'psi': 0.608373229683581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=29 head_norm_before_train=1.832957 (no previous merge yet)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.8049685390661548, 'auprc': 0.9518943160379442, 'loss_val': 0.46161178981956663, 'psi': 0.8637388498548706}-{'f1_val': 0.49960327958627526, 'auprc': 0.8039394579678043, 'loss_val': 0.9149598530022761, 'psi': 0.6213377509388869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=29 head_norm_before_train=1.340528 cos_to_last_merge=0.9524 (last merge round=11)
[S7] round=29 local utility u=0.239683 metrics={'f1_val': 0.6088281760974391, 'auprc': 0.796204936714528, 'loss_val': 0.6593940437047444, 'psi': 0.6837788803442746}-{'f1_val': 0.5641630335989096, 'auprc': 0.7532811598822681, 'loss_val': 0.7419978360949572, 'psi': 0.639810284112253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=29 head_norm_before_train=1.569408 cos_to_last_merge=0.9599 (last merge round=14)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.7511306031577349, 'auprc': 0.9849484793166595, 'loss_val': 0.20925124584390115, 'psi': 0.8446577536213048}-{'f1_val': 0.9925028268365944, 'auprc': 0.9989313603893355, 'loss_val': 0.04753465533708804, 'psi': 0.9950742402576909}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.932191 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988856116760779, 'loss_val': 0.023371237771131075, 'psi': 0.9970502756889424}-{'f1_val': 0.9966891482978385, 'auprc': 0.9995984088915756, 'loss_val': 0.022193285038922983, 'psi': 0.9978528525353334}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.625995 cos_to_last_merge=0.9685 (last merge round=15)
[S10] round=29 local utility u=0.018534 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9953369772531391, 'loss_val': 0.048357438650427784, 'psi': 0.9953646012262749}-{'f1_val': 0.9943563983784213, 'auprc': 0.9941346799048074, 'loss_val': 0.07565934899233841, 'psi': 0.9942677109889757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=29 head_norm_before_train=1.302575 cos_to_last_merge=0.9033 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.903
[S11] round=29 local utility u=0.002859 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979961490934639, 'loss_val': 0.06444945915549603, 'psi': 0.9971266623455393}-{'f1_val': 0.9965470045135896, 'auprc': 0.997950408160236, 'loss_val': 0.07002964704524861, 'psi': 0.9971083659722482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=29 head_norm_before_train=1.208639 cos_to_last_merge=0.9248 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=29 local utility u=0.048007 metrics={'f1_val': 0.6128219271145476, 'auprc': 0.6642267472992198, 'loss_val': 0.5932691576911442, 'psi': 0.6333838551884166}-{'f1_val': 0.6058627142930999, 'auprc': 0.6712135207057612, 'loss_val': 0.6684890539553395, 'psi': 0.6320030368581644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=29 head_norm_before_train=1.962297 (no previous merge yet)
[S14] round=29 local utility u=0.000369 metrics={'f1_val': 0.9959680589515988, 'auprc': 0.9968464318742918, 'loss_val': 0.027924005112326688, 'psi': 0.9963194081206761}-{'f1_val': 0.9963594395247332, 'auprc': 0.9959488253372033, 'loss_val': 0.02831764383027047, 'psi': 0.9961951938497212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=29 head_norm_before_train=1.493135 cos_to_last_merge=0.9298 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.9235470493575738, 'auprc': 0.9899986116762943, 'loss_val': 0.12352561951518859, 'psi': 0.950127674285062}-{'f1_val': 0.9285917696732484, 'auprc': 0.9888469590968749, 'loss_val': 0.11997247191072698, 'psi': 0.952693845442699}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.499645 cos_to_last_merge=0.9158 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=29 local utility u=0.782912 metrics={'f1_val': 0.9366248084219307, 'auprc': 0.9802537019202728, 'loss_val': 0.2827733533704282, 'psi': 0.9540763658212675}-{'f1_val': 0.8334452801426989, 'auprc': 0.8681462477741883, 'loss_val': 0.8931978764536089, 'psi': 0.8473256671952947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S16] sending update (kind=head size=1809 to 1 peers)
[S17] START round=29 head_norm_before_train=1.324838 cos_to_last_merge=0.7889 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.789
[S17] round=29 local utility u=0.494775 metrics={'f1_val': 0.392193518402851, 'auprc': 0.8082837387706053, 'loss_val': 0.983342412981856, 'psi': 0.5586296065499528}-{'f1_val': 0.29829706666738953, 'auprc': 0.7771299506662112, 'loss_val': 1.3160520746390014, 'psi': 0.4898302202669182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=30 head_norm_before_train=1.651609 cos_to_last_merge=0.9279 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=30 local utility u=0.059766 metrics={'f1_val': 0.7014937575602418, 'auprc': 0.8338113478118571, 'loss_val': 0.260058120391885, 'psi': 0.7544207936608879}-{'f1_val': 0.7013141837391442, 'auprc': 0.795058702455522, 'loss_val': 0.2622552495638474, 'psi': 0.7388119912256954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=30 head_norm_before_train=1.649837 cos_to_last_merge=0.9757 (last merge round=16)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.6605889342486122, 'auprc': 0.8150995171877788, 'loss_val': 0.5311564572139628, 'psi': 0.722393167424279}-{'f1_val': 0.9274366385191306, 'auprc': 0.9958198714508854, 'loss_val': 0.18597102579634683, 'psi': 0.9547899316918325}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.569175 cos_to_last_merge=0.9717 (last merge round=15)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9524420099606699, 'auprc': 0.9017666634406312, 'loss_val': 0.2528726078157241, 'psi': 0.9321718713526544}-{'f1_val': 0.9498166308410818, 'auprc': 0.910593904000341, 'loss_val': 0.2508761016006208, 'psi': 0.9341275401047855}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.472339 cos_to_last_merge=0.7465 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.746
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.44482332132699876, 'auprc': 0.8523588215174283, 'loss_val': 0.7628325200635775, 'psi': 0.6078375214031706}-{'f1_val': 0.7003213174339138, 'auprc': 0.9894230647018101, 'loss_val': 0.2579789239363652, 'psi': 0.8159620163410723}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.842882 (no previous merge yet)
[S6] round=30 local utility u=0.066553 metrics={'f1_val': 0.823762009307367, 'auprc': 0.9534906647185868, 'loss_val': 0.4460554611118254, 'psi': 0.8756534714718549}-{'f1_val': 0.8049685390661548, 'auprc': 0.9518943160379442, 'loss_val': 0.46161178981956663, 'psi': 0.8637388498548706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=30 head_norm_before_train=1.358387 cos_to_last_merge=0.9495 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.950
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5216659222808242, 'auprc': 0.7826501438889437, 'loss_val': 0.7929072747227434, 'psi': 0.626059610924072}-{'f1_val': 0.6088281760974391, 'auprc': 0.796204936714528, 'loss_val': 0.6593940437047444, 'psi': 0.6837788803442746}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.586010 cos_to_last_merge=0.9587 (last merge round=14)
[S8] round=30 local utility u=0.780298 metrics={'f1_val': 0.9804278770174959, 'auprc': 0.9989907846096256, 'loss_val': 0.06656677570634242, 'psi': 0.9878530400543478}-{'f1_val': 0.7511306031577349, 'auprc': 0.9849484793166595, 'loss_val': 0.20925124584390115, 'psi': 0.8446577536213048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=30 head_norm_before_train=1.942945 (no previous merge yet)
[S9] round=30 local utility u=0.003519 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988576374742271, 'loss_val': 0.021251593004211436, 'psi': 0.9975393620780257}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988856116760779, 'loss_val': 0.023371237771131075, 'psi': 0.9970502756889424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=30 head_norm_before_train=1.644967 cos_to_last_merge=0.9660 (last merge round=15)
[S10] round=30 local utility u=0.002078 metrics={'f1_val': 0.9957973497718928, 'auprc': 0.9950087471447375, 'loss_val': 0.045701991892999776, 'psi': 0.9954819087210307}-{'f1_val': 0.9953830172083656, 'auprc': 0.9953369772531391, 'loss_val': 0.048357438650427784, 'psi': 0.9953646012262749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=30 head_norm_before_train=1.326306 cos_to_last_merge=0.8997 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.900
[S11] round=30 local utility u=0.002843 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980355005099699, 'loss_val': 0.05888187102878468, 'psi': 0.9971424029121417}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979961490934639, 'loss_val': 0.06444945915549603, 'psi': 0.9971266623455393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=30 head_norm_before_train=1.225031 cos_to_last_merge=0.9201 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5872725074050151, 'auprc': 0.6864325087448961, 'loss_val': 0.7383381749774767, 'psi': 0.6269365079409676}-{'f1_val': 0.6128219271145476, 'auprc': 0.6642267472992198, 'loss_val': 0.5932691576911442, 'psi': 0.6333838551884166}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.972932 (no previous merge yet)
[S14] round=30 local utility u=0.007335 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.996972779946367, 'loss_val': 0.02373143536277635, 'psi': 0.997379782808459}-{'f1_val': 0.9959680589515988, 'auprc': 0.9968464318742918, 'loss_val': 0.027924005112326688, 'psi': 0.9963194081206761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=30 head_norm_before_train=1.519751 cos_to_last_merge=0.9264 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7012373119130055, 'auprc': 0.8315835463934149, 'loss_val': 0.46054867103738734, 'psi': 0.7533758057051694}-{'f1_val': 0.9235470493575738, 'auprc': 0.9899986116762943, 'loss_val': 0.12352561951518859, 'psi': 0.950127674285062}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.520593 cos_to_last_merge=0.9129 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8373834811712999, 'auprc': 0.9584466843751998, 'loss_val': 0.8742507981266422, 'psi': 0.8858087624528599}-{'f1_val': 0.9366248084219307, 'auprc': 0.9802537019202728, 'loss_val': 0.2827733533704282, 'psi': 0.9540763658212675}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.346240 cos_to_last_merge=0.7865 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=30 local utility u=0.051924 metrics={'f1_val': 0.3958800362175079, 'auprc': 0.8156123316331871, 'loss_val': 0.9235987130803258, 'psi': 0.5637729543837796}-{'f1_val': 0.392193518402851, 'auprc': 0.8082837387706053, 'loss_val': 0.983342412981856, 'psi': 0.5586296065499528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=31 head_norm_before_train=1.660043 cos_to_last_merge=0.9268 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.927
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7014937575602418, 'auprc': 0.8014347382053267, 'loss_val': 0.2628465666094345, 'psi': 0.7414701498182757}-{'f1_val': 0.7014937575602418, 'auprc': 0.8338113478118571, 'loss_val': 0.260058120391885, 'psi': 0.7544207936608879}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.668901 cos_to_last_merge=0.9737 (last merge round=16)
[S3] round=31 local utility u=1.000000 metrics={'f1_val': 0.9049267589444405, 'auprc': 0.9848813177878081, 'loss_val': 0.1841673753421211, 'psi': 0.9369085824817875}-{'f1_val': 0.6605889342486122, 'auprc': 0.8150995171877788, 'loss_val': 0.5311564572139628, 'psi': 0.722393167424279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=31 head_norm_before_train=1.578697 cos_to_last_merge=0.9707 (last merge round=15)
[S4] round=31 local utility u=0.030181 metrics={'f1_val': 0.9562149551349727, 'auprc': 0.911014670907918, 'loss_val': 0.2428925440027595, 'psi': 0.9381348414441508}-{'f1_val': 0.9524420099606699, 'auprc': 0.9017666634406312, 'loss_val': 0.2528726078157241, 'psi': 0.9321718713526544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=31 head_norm_before_train=1.478829 cos_to_last_merge=0.7446 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.745
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9905786314918179, 'loss_val': 0.21340775578175272, 'psi': 0.8164242430570754}-{'f1_val': 0.44482332132699876, 'auprc': 0.8523588215174283, 'loss_val': 0.7628325200635775, 'psi': 0.6078375214031706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=31 head_norm_before_train=1.854715 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.5962346894531312, 'auprc': 0.9432994670485864, 'loss_val': 0.8751138605821674, 'psi': 0.7350606004913133}-{'f1_val': 0.823762009307367, 'auprc': 0.9534906647185868, 'loss_val': 0.4460554611118254, 'psi': 0.8756534714718549}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.372697 cos_to_last_merge=0.9472 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=31 local utility u=0.581299 metrics={'f1_val': 0.6411625999451829, 'auprc': 0.8326815493235579, 'loss_val': 0.4973833541957111, 'psi': 0.7177701796965328}-{'f1_val': 0.5216659222808242, 'auprc': 0.7826501438889437, 'loss_val': 0.7929072747227434, 'psi': 0.626059610924072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=31 head_norm_before_train=1.598912 cos_to_last_merge=0.9577 (last merge round=14)
[S8] round=31 local utility u=0.033099 metrics={'f1_val': 0.9924932660920454, 'auprc': 0.9887548598895634, 'loss_val': 0.04205414794659997, 'psi': 0.9909979036110526}-{'f1_val': 0.9804278770174959, 'auprc': 0.9989907846096256, 'loss_val': 0.06656677570634242, 'psi': 0.9878530400543478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=31 head_norm_before_train=1.953819 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.998879243688856, 'loss_val': 0.021735693768425927, 'psi': 0.9970477284940537}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988576374742271, 'loss_val': 0.021251593004211436, 'psi': 0.9975393620780257}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.661473 cos_to_last_merge=0.9639 (last merge round=15)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9957973497718928, 'auprc': 0.9948854877013797, 'loss_val': 0.06267522566301524, 'psi': 0.9954326049436877}-{'f1_val': 0.9957973497718928, 'auprc': 0.9950087471447375, 'loss_val': 0.045701991892999776, 'psi': 0.9954819087210307}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=1.351421 cos_to_last_merge=0.8955 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.896
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9973403795850042, 'loss_val': 0.06823582785526495, 'psi': 0.9966163567819872}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980355005099699, 'loss_val': 0.05888187102878468, 'psi': 0.9971424029121417}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.239732 cos_to_last_merge=0.9164 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.916
[S13] round=31 local utility u=0.082483 metrics={'f1_val': 0.6110786715980051, 'auprc': 0.6673492100259092, 'loss_val': 0.6589601235677105, 'psi': 0.6335868869691668}-{'f1_val': 0.5872725074050151, 'auprc': 0.6864325087448961, 'loss_val': 0.7383381749774767, 'psi': 0.6269365079409676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=31 head_norm_before_train=1.978909 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9915256382264359, 'auprc': 0.998647695052145, 'loss_val': 0.0371555829282689, 'psi': 0.9943744609567196}-{'f1_val': 0.9976511180498535, 'auprc': 0.996972779946367, 'loss_val': 0.02373143536277635, 'psi': 0.997379782808459}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=1.546154 cos_to_last_merge=0.9232 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.923
[S15] round=31 local utility u=0.663278 metrics={'f1_val': 0.8132466117977613, 'auprc': 0.9820342382147507, 'loss_val': 0.2573999003995201, 'psi': 0.880761662364557}-{'f1_val': 0.7012373119130055, 'auprc': 0.8315835463934149, 'loss_val': 0.46054867103738734, 'psi': 0.7533758057051694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=31 head_norm_before_train=1.539927 cos_to_last_merge=0.9103 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=31 local utility u=0.620717 metrics={'f1_val': 0.93649822128084, 'auprc': 0.9845419897627182, 'loss_val': 0.3057910771563477, 'psi': 0.9557157286735913}-{'f1_val': 0.8373834811712999, 'auprc': 0.9584466843751998, 'loss_val': 0.8742507981266422, 'psi': 0.8858087624528599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=31 head_norm_before_train=1.375240 cos_to_last_merge=0.7842 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.39670571640347907, 'auprc': 0.8106314240898324, 'loss_val': 1.0061982228475765, 'psi': 0.5622759994780204}-{'f1_val': 0.3958800362175079, 'auprc': 0.8156123316331871, 'loss_val': 0.9235987130803258, 'psi': 0.5637729543837796}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.668177 cos_to_last_merge=0.9256 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=32 local utility u=0.153818 metrics={'f1_val': 0.7017525803949645, 'auprc': 0.9021811015164499, 'loss_val': 0.25900342164075096, 'psi': 0.7819239888435586}-{'f1_val': 0.7014937575602418, 'auprc': 0.8014347382053267, 'loss_val': 0.2628465666094345, 'psi': 0.7414701498182757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=32 head_norm_before_train=1.685149 cos_to_last_merge=0.9720 (last merge round=16)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.6851820947549063, 'auprc': 0.8536097753144865, 'loss_val': 0.5048719177724047, 'psi': 0.7525531669787384}-{'f1_val': 0.9049267589444405, 'auprc': 0.9848813177878081, 'loss_val': 0.1841673753421211, 'psi': 0.9369085824817875}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.588021 cos_to_last_merge=0.9697 (last merge round=15)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9469450294610008, 'auprc': 0.9091873317647561, 'loss_val': 0.25945464869453205, 'psi': 0.931841950382503}-{'f1_val': 0.9562149551349727, 'auprc': 0.911014670907918, 'loss_val': 0.2428925440027595, 'psi': 0.9381348414441508}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.482306 cos_to_last_merge=0.7437 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.744
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.42231291652375613, 'auprc': 0.828083048017636, 'loss_val': 1.2024378859813958, 'psi': 0.584620969121308}-{'f1_val': 0.7003213174339138, 'auprc': 0.9905786314918179, 'loss_val': 0.21340775578175272, 'psi': 0.8164242430570754}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.866292 (no previous merge yet)
[S6] round=32 local utility u=1.000000 metrics={'f1_val': 0.9646416371833362, 'auprc': 0.9772444696100139, 'loss_val': 0.17014512658452968, 'psi': 0.9696827701540072}-{'f1_val': 0.5962346894531312, 'auprc': 0.9432994670485864, 'loss_val': 0.8751138605821674, 'psi': 0.7350606004913133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=32 head_norm_before_train=1.386693 cos_to_last_merge=0.9446 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5018210773817103, 'auprc': 0.7806413493633362, 'loss_val': 0.8190787855214785, 'psi': 0.6133491861743607}-{'f1_val': 0.6411625999451829, 'auprc': 0.8326815493235579, 'loss_val': 0.4973833541957111, 'psi': 0.7177701796965328}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.612447 cos_to_last_merge=0.9565 (last merge round=14)
[S8] round=32 local utility u=0.010908 metrics={'f1_val': 0.991372388611257, 'auprc': 0.9989457360961349, 'loss_val': 0.04408519543201713, 'psi': 0.9944017276052082}-{'f1_val': 0.9924932660920454, 'auprc': 0.9887548598895634, 'loss_val': 0.04205414794659997, 'psi': 0.9909979036110526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=32 head_norm_before_train=1.964159 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9988612470372588, 'loss_val': 0.021196301086216108, 'psi': 0.9968903341454123}-{'f1_val': 0.9958267183641853, 'auprc': 0.998879243688856, 'loss_val': 0.021735693768425927, 'psi': 0.9970477284940537}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.678103 cos_to_last_merge=0.9620 (last merge round=15)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.8803360968979201, 'auprc': 0.9931566432909316, 'loss_val': 0.22519337785124233, 'psi': 0.9254643154551248}-{'f1_val': 0.9957973497718928, 'auprc': 0.9948854877013797, 'loss_val': 0.06267522566301524, 'psi': 0.9954326049436877}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.375161 cos_to_last_merge=0.8916 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.892
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9840030720296297, 'auprc': 0.9981515089359885, 'loss_val': 0.08759620111549515, 'psi': 0.9896624467921732}-{'f1_val': 0.9961336749133093, 'auprc': 0.9973403795850042, 'loss_val': 0.06823582785526495, 'psi': 0.9966163567819872}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.254497 cos_to_last_merge=0.9133 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.913
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5756510233768298, 'auprc': 0.6646581842865219, 'loss_val': 0.7628157794294961, 'psi': 0.6112538877407067}-{'f1_val': 0.6110786715980051, 'auprc': 0.6673492100259092, 'loss_val': 0.6589601235677105, 'psi': 0.6335868869691668}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.985647 (no previous merge yet)
[S14] round=32 local utility u=0.022465 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.996972282575602, 'loss_val': 0.022943076780928027, 'psi': 0.9972787596601334}-{'f1_val': 0.9915256382264359, 'auprc': 0.998647695052145, 'loss_val': 0.0371555829282689, 'psi': 0.9943744609567196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=32 head_norm_before_train=1.569197 cos_to_last_merge=0.9204 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.920
[S15] round=32 local utility u=0.017847 metrics={'f1_val': 0.8265595725388911, 'auprc': 0.9715978548391951, 'loss_val': 0.2702736291290234, 'psi': 0.8845748854590127}-{'f1_val': 0.8132466117977613, 'auprc': 0.9820342382147507, 'loss_val': 0.2573999003995201, 'psi': 0.880761662364557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=32 head_norm_before_train=1.557407 cos_to_last_merge=0.9080 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.908
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.897162801740793, 'auprc': 0.9834974087596637, 'loss_val': 0.22409180750974833, 'psi': 0.9316966445483412}-{'f1_val': 0.93649822128084, 'auprc': 0.9845419897627182, 'loss_val': 0.3057910771563477, 'psi': 0.9557157286735913}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.408571 cos_to_last_merge=0.7819 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=32 local utility u=0.913750 metrics={'f1_val': 0.6567395171394541, 'auprc': 0.8406822884526979, 'loss_val': 0.8290534438774863, 'psi': 0.7303166256647516}-{'f1_val': 0.39670571640347907, 'auprc': 0.8106314240898324, 'loss_val': 1.0061982228475765, 'psi': 0.5622759994780204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=33 head_norm_before_train=1.676996 cos_to_last_merge=0.9245 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.7848747252963204, 'loss_val': 0.2694236733484411, 'psi': 0.7348937376264267}-{'f1_val': 0.7017525803949645, 'auprc': 0.9021811015164499, 'loss_val': 0.25900342164075096, 'psi': 0.7819239888435586}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.704124 cos_to_last_merge=0.9700 (last merge round=16)
[S3] round=33 local utility u=1.000000 metrics={'f1_val': 0.9666272890645982, 'auprc': 0.9942530662104143, 'loss_val': 0.10088158042870421, 'psi': 0.9776775999229246}-{'f1_val': 0.6851820947549063, 'auprc': 0.8536097753144865, 'loss_val': 0.5048719177724047, 'psi': 0.7525531669787384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=33 head_norm_before_train=1.592810 cos_to_last_merge=0.9691 (last merge round=15)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9428656551477579, 'auprc': 0.8983735847014288, 'loss_val': 0.2704460605571805, 'psi': 0.9250688269692262}-{'f1_val': 0.9469450294610008, 'auprc': 0.9091873317647561, 'loss_val': 0.25945464869453205, 'psi': 0.931841950382503}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.486637 cos_to_last_merge=0.7436 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.744
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8949933488551826, 'loss_val': 0.3188269894549238, 'psi': 0.7781896986368884}-{'f1_val': 0.42231291652375613, 'auprc': 0.828083048017636, 'loss_val': 1.2024378859813958, 'psi': 0.584620969121308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=33 head_norm_before_train=1.874096 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6662753798997568, 'auprc': 0.898110504899287, 'loss_val': 0.8150085312176298, 'psi': 0.7590094298995689}-{'f1_val': 0.9646416371833362, 'auprc': 0.9772444696100139, 'loss_val': 0.17014512658452968, 'psi': 0.9696827701540072}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.397460 cos_to_last_merge=0.9426 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=33 local utility u=0.535609 metrics={'f1_val': 0.6243697725135112, 'auprc': 0.8160061394340745, 'loss_val': 0.5892471703998186, 'psi': 0.7010243192817365}-{'f1_val': 0.5018210773817103, 'auprc': 0.7806413493633362, 'loss_val': 0.8190787855214785, 'psi': 0.6133491861743607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=33 head_norm_before_train=1.623079 cos_to_last_merge=0.9551 (last merge round=14)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9906496251316108, 'auprc': 0.9989503810115846, 'loss_val': 0.0440469131308363, 'psi': 0.9939699274836004}-{'f1_val': 0.991372388611257, 'auprc': 0.9989457360961349, 'loss_val': 0.04408519543201713, 'psi': 0.9944017276052082}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.974838 (no previous merge yet)
[S9] round=33 local utility u=0.003961 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987574833707477, 'loss_val': 0.019467856686965258, 'psi': 0.9974993004366339}-{'f1_val': 0.9955763922175147, 'auprc': 0.9988612470372588, 'loss_val': 0.021196301086216108, 'psi': 0.9968903341454123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=33 head_norm_before_train=1.693726 cos_to_last_merge=0.9602 (last merge round=15)
[S10] round=33 local utility u=0.431523 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9947051116219139, 'loss_val': 0.05458625556230214, 'psi': 0.9948629565678113}-{'f1_val': 0.8803360968979201, 'auprc': 0.9931566432909316, 'loss_val': 0.22519337785124233, 'psi': 0.9254643154551248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=33 head_norm_before_train=1.399197 cos_to_last_merge=0.8880 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.888
[S11] round=33 local utility u=0.057651 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978992095997425, 'loss_val': 0.04431992387899027, 'psi': 0.9968398887878827}-{'f1_val': 0.9840030720296297, 'auprc': 0.9981515089359885, 'loss_val': 0.08759620111549515, 'psi': 0.9896624467921732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=33 head_norm_before_train=1.268312 cos_to_last_merge=0.9103 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5617845984440015, 'auprc': 0.6909487343596366, 'loss_val': 0.8689054618776489, 'psi': 0.6134502528102554}-{'f1_val': 0.5756510233768298, 'auprc': 0.6646581842865219, 'loss_val': 0.7628157794294961, 'psi': 0.6112538877407067}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.994418 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9968533365134387, 'loss_val': 0.024145837637957593, 'psi': 0.9968393827007023}-{'f1_val': 0.9974830777164877, 'auprc': 0.996972282575602, 'loss_val': 0.022943076780928027, 'psi': 0.9972787596601334}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.591506 cos_to_last_merge=0.9180 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.918
[S15] round=33 local utility u=0.329531 metrics={'f1_val': 0.9053674371456515, 'auprc': 0.9896449328195123, 'loss_val': 0.13819919764472993, 'psi': 0.9390784354151958}-{'f1_val': 0.8265595725388911, 'auprc': 0.9715978548391951, 'loss_val': 0.2702736291290234, 'psi': 0.8845748854590127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=33 head_norm_before_train=1.574956 cos_to_last_merge=0.9059 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.906
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.732384585635238, 'auprc': 0.9040439660621716, 'loss_val': 0.9286233499814486, 'psi': 0.8010483378060115}-{'f1_val': 0.897162801740793, 'auprc': 0.9834974087596637, 'loss_val': 0.22409180750974833, 'psi': 0.9316966445483412}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.435992 cos_to_last_merge=0.7801 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.640391111941821, 'auprc': 0.816259844802167, 'loss_val': 1.0333685760993978, 'psi': 0.7107386050859594}-{'f1_val': 0.6567395171394541, 'auprc': 0.8406822884526979, 'loss_val': 0.8290534438774863, 'psi': 0.7303166256647516}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.685803 cos_to_last_merge=0.9235 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.923
[S2] round=34 local utility u=0.042630 metrics={'f1_val': 0.7014928908785604, 'auprc': 0.8108388633386321, 'loss_val': 0.26157593620768055, 'psi': 0.7452312798625891}-{'f1_val': 0.7015730791798309, 'auprc': 0.7848747252963204, 'loss_val': 0.2694236733484411, 'psi': 0.7348937376264267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=34 head_norm_before_train=1.720596 cos_to_last_merge=0.9682 (last merge round=16)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.8493491937738147, 'auprc': 0.9637197449119583, 'loss_val': 0.2507367045015229, 'psi': 0.8950974142290721}-{'f1_val': 0.9666272890645982, 'auprc': 0.9942530662104143, 'loss_val': 0.10088158042870421, 'psi': 0.9776775999229246}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.594337 cos_to_last_merge=0.9687 (last merge round=15)
[S4] round=34 local utility u=0.023877 metrics={'f1_val': 0.9481852090992231, 'auprc': 0.9009353020828611, 'loss_val': 0.2622949290139713, 'psi': 0.9292852462926783}-{'f1_val': 0.9428656551477579, 'auprc': 0.8983735847014288, 'loss_val': 0.2704460605571805, 'psi': 0.9250688269692262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=34 head_norm_before_train=1.490078 cos_to_last_merge=0.7437 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.744
[S5] round=34 local utility u=0.151752 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989524490791769, 'loss_val': 0.29891990202877716, 'psi': 0.8160025867770558}-{'f1_val': 0.700320598491359, 'auprc': 0.8949933488551826, 'loss_val': 0.3188269894549238, 'psi': 0.7781896986368884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=34 head_norm_before_train=1.879175 (no previous merge yet)
[S6] round=34 local utility u=0.858342 metrics={'f1_val': 0.8501782320629767, 'auprc': 0.9597518394375957, 'loss_val': 0.3866650637212118, 'psi': 0.8940076750128243}-{'f1_val': 0.6662753798997568, 'auprc': 0.898110504899287, 'loss_val': 0.8150085312176298, 'psi': 0.7590094298995689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=34 head_norm_before_train=1.405165 cos_to_last_merge=0.9413 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.623925086485071, 'auprc': 0.8164520307844808, 'loss_val': 0.589290903609481, 'psi': 0.7009358642048349}-{'f1_val': 0.6243697725135112, 'auprc': 0.8160061394340745, 'loss_val': 0.5892471703998186, 'psi': 0.7010243192817365}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.632487 cos_to_last_merge=0.9548 (last merge round=14)
[S8] round=34 local utility u=0.002976 metrics={'f1_val': 0.991372388611257, 'auprc': 0.9989330289846605, 'loss_val': 0.04237850901282266, 'psi': 0.9943966447606183}-{'f1_val': 0.9906496251316108, 'auprc': 0.9989503810115846, 'loss_val': 0.0440469131308363, 'psi': 0.9939699274836004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=34 head_norm_before_train=1.984496 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988595135749044, 'loss_val': 0.01947068626320485, 'psi': 0.997039836448473}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987574833707477, 'loss_val': 0.019467856686965258, 'psi': 0.9974993004366339}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.706716 cos_to_last_merge=0.9590 (last merge round=15)
[S10] round=34 local utility u=0.009154 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9946949333210726, 'loss_val': 0.03873681206977356, 'psi': 0.9951077836534483}-{'f1_val': 0.9949681865317428, 'auprc': 0.9947051116219139, 'loss_val': 0.05458625556230214, 'psi': 0.9948629565678113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=34 head_norm_before_train=1.420190 cos_to_last_merge=0.8849 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.885
[S11] round=34 local utility u=0.001431 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978843431564582, 'loss_val': 0.04141245616125906, 'psi': 0.9968339422105689}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978992095997425, 'loss_val': 0.04431992387899027, 'psi': 0.9968398887878827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=34 head_norm_before_train=1.283144 cos_to_last_merge=0.9076 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.908
[S13] round=34 local utility u=0.094340 metrics={'f1_val': 0.58673062626356, 'auprc': 0.66350025859991, 'loss_val': 0.7475560763447235, 'psi': 0.6174384791981}-{'f1_val': 0.5617845984440015, 'auprc': 0.6909487343596366, 'loss_val': 0.8689054618776489, 'psi': 0.6134502528102554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=34 head_norm_before_train=2.003039 (no previous merge yet)
[S14] round=34 local utility u=0.003233 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9969718301928769, 'loss_val': 0.021952969844847896, 'psi': 0.9972785787070434}-{'f1_val': 0.9968300801588782, 'auprc': 0.9968533365134387, 'loss_val': 0.024145837637957593, 'psi': 0.9968393827007023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=34 head_norm_before_train=1.610507 cos_to_last_merge=0.9158 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=34 local utility u=0.122226 metrics={'f1_val': 0.9392576160821727, 'auprc': 0.9898406475858649, 'loss_val': 0.09767578098141107, 'psi': 0.9594908286836497}-{'f1_val': 0.9053674371456515, 'auprc': 0.9896449328195123, 'loss_val': 0.13819919764472993, 'psi': 0.9390784354151958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=34 head_norm_before_train=1.592274 cos_to_last_merge=0.9037 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.904
[S16] round=34 local utility u=1.000000 metrics={'f1_val': 0.9843552770906036, 'auprc': 0.9853469180604422, 'loss_val': 0.08262546523951696, 'psi': 0.9847519334785391}-{'f1_val': 0.732384585635238, 'auprc': 0.9040439660621716, 'loss_val': 0.9286233499814486, 'psi': 0.8010483378060115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=34 head_norm_before_train=1.458118 cos_to_last_merge=0.7791 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.779
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6165026557664985, 'auprc': 0.7902911656321516, 'loss_val': 1.2602769761092942, 'psi': 0.6860180597127598}-{'f1_val': 0.640391111941821, 'auprc': 0.816259844802167, 'loss_val': 1.0333685760993978, 'psi': 0.7107386050859594}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.693837 cos_to_last_merge=0.9230 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.923
[S2] round=35 local utility u=0.043762 metrics={'f1_val': 0.7136265322144326, 'auprc': 0.8153814141867237, 'loss_val': 0.26048057106424777, 'psi': 0.7543284850033491}-{'f1_val': 0.7014928908785604, 'auprc': 0.8108388633386321, 'loss_val': 0.26157593620768055, 'psi': 0.7452312798625891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=35 head_norm_before_train=1.733561 cos_to_last_merge=0.9668 (last merge round=16)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.8458049320419752, 'auprc': 0.9640343644965347, 'loss_val': 0.25891845389604895, 'psi': 0.893096705023799}-{'f1_val': 0.8493491937738147, 'auprc': 0.9637197449119583, 'loss_val': 0.2507367045015229, 'psi': 0.8950974142290721}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.600904 cos_to_last_merge=0.9678 (last merge round=15)
[S4] round=35 local utility u=0.022310 metrics={'f1_val': 0.9518738177356209, 'auprc': 0.9062457001928935, 'loss_val': 0.25573787032582135, 'psi': 0.9336225707185299}-{'f1_val': 0.9481852090992231, 'auprc': 0.9009353020828611, 'loss_val': 0.2622949290139713, 'psi': 0.9292852462926783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=35 head_norm_before_train=1.495954 cos_to_last_merge=0.7436 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.744
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.6668220043468851, 'auprc': 0.8167632411415783, 'loss_val': 0.42369269276983584, 'psi': 0.7267984990647623}-{'f1_val': 0.7003213174339138, 'auprc': 0.989524490791769, 'loss_val': 0.29891990202877716, 'psi': 0.8160025867770558}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.884800 (no previous merge yet)
[S6] round=35 local utility u=0.365105 metrics={'f1_val': 0.9407479873290472, 'auprc': 0.9704240178754421, 'loss_val': 0.23188991890023816, 'psi': 0.9526183995476052}-{'f1_val': 0.8501782320629767, 'auprc': 0.9597518394375957, 'loss_val': 0.3866650637212118, 'psi': 0.8940076750128243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=35 head_norm_before_train=1.411125 cos_to_last_merge=0.9403 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.6067440011096766, 'auprc': 0.7999158908477992, 'loss_val': 0.6527117216543109, 'psi': 0.6840127570049257}-{'f1_val': 0.623925086485071, 'auprc': 0.8164520307844808, 'loss_val': 0.589290903609481, 'psi': 0.7009358642048349}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.644009 cos_to_last_merge=0.9542 (last merge round=14)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9863756004935829, 'auprc': 0.9989824460707892, 'loss_val': 0.05056592724011151, 'psi': 0.9914183387244655}-{'f1_val': 0.991372388611257, 'auprc': 0.9989330289846605, 'loss_val': 0.04237850901282266, 'psi': 0.9943966447606183}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.992199 (no previous merge yet)
[S9] round=35 local utility u=0.002796 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988563869862077, 'loss_val': 0.01887136463920179, 'psi': 0.9975388618828179}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988595135749044, 'loss_val': 0.01947068626320485, 'psi': 0.997039836448473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=35 head_norm_before_train=1.719745 cos_to_last_merge=0.9578 (last merge round=15)
[S10] round=35 local utility u=0.003690 metrics={'f1_val': 0.9957973497718928, 'auprc': 0.9953484472299863, 'loss_val': 0.03580268203976754, 'psi': 0.9956177887551303}-{'f1_val': 0.9953830172083656, 'auprc': 0.9946949333210726, 'loss_val': 0.03873681206977356, 'psi': 0.9951077836534483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=35 head_norm_before_train=1.440295 cos_to_last_merge=0.8821 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.882
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9851797174246673, 'auprc': 0.9979811355459465, 'loss_val': 0.07596809228540427, 'psi': 0.990300284673179}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978843431564582, 'loss_val': 0.04141245616125906, 'psi': 0.9968339422105689}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.294055 cos_to_last_merge=0.9051 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.905
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5620918749644952, 'auprc': 0.6783620380071597, 'loss_val': 0.9047245432870404, 'psi': 0.6085999401815609}-{'f1_val': 0.58673062626356, 'auprc': 0.66350025859991, 'loss_val': 0.7475560763447235, 'psi': 0.6174384791981}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=2.013142 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9677425861939483, 'auprc': 0.9966270087640703, 'loss_val': 0.05062613887085486, 'psi': 0.9792963552219971}-{'f1_val': 0.9974830777164877, 'auprc': 0.9969718301928769, 'loss_val': 0.021952969844847896, 'psi': 0.9972785787070434}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.629203 cos_to_last_merge=0.9136 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.914
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7627002969753616, 'auprc': 0.8887379581412378, 'loss_val': 0.43468483416571946, 'psi': 0.8131153614417121}-{'f1_val': 0.9392576160821727, 'auprc': 0.9898406475858649, 'loss_val': 0.09767578098141107, 'psi': 0.9594908286836497}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.608076 cos_to_last_merge=0.9016 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.902
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8318343493143179, 'auprc': 0.8529176817013694, 'loss_val': 1.0491504344520317, 'psi': 0.8402676822691385}-{'f1_val': 0.9843552770906036, 'auprc': 0.9853469180604422, 'loss_val': 0.08262546523951696, 'psi': 0.9847519334785391}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.482064 cos_to_last_merge=0.7784 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=35 local utility u=0.489033 metrics={'f1_val': 0.6833841509458698, 'auprc': 0.8442963587056069, 'loss_val': 0.8455147320892443, 'psi': 0.7477490340497647}-{'f1_val': 0.6165026557664985, 'auprc': 0.7902911656321516, 'loss_val': 1.2602769761092942, 'psi': 0.6860180597127598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=36 head_norm_before_train=1.702518 cos_to_last_merge=0.9224 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.922
[S2] round=36 local utility u=0.335606 metrics={'f1_val': 0.7709883955640591, 'auprc': 0.9216335983655993, 'loss_val': 0.2521961803270642, 'psi': 0.8312464766846752}-{'f1_val': 0.7136265322144326, 'auprc': 0.8153814141867237, 'loss_val': 0.26048057106424777, 'psi': 0.7543284850033491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=36 head_norm_before_train=1.745044 cos_to_last_merge=0.9655 (last merge round=16)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.7337373731270744, 'auprc': 0.935607662936851, 'loss_val': 0.4754544320262304, 'psi': 0.8144854890509851}-{'f1_val': 0.8458049320419752, 'auprc': 0.9640343644965347, 'loss_val': 0.25891845389604895, 'psi': 0.893096705023799}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.607481 cos_to_last_merge=0.9669 (last merge round=15)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9422530642734676, 'auprc': 0.8878167658088436, 'loss_val': 0.2733710026246541, 'psi': 0.920478544887618}-{'f1_val': 0.9518738177356209, 'auprc': 0.9062457001928935, 'loss_val': 0.25573787032582135, 'psi': 0.9336225707185299}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.501763 cos_to_last_merge=0.7434 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.743
[S5] round=36 local utility u=0.481730 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9933324491458145, 'loss_val': 0.19093629610564106, 'psi': 0.817525770118674}-{'f1_val': 0.6668220043468851, 'auprc': 0.8167632411415783, 'loss_val': 0.42369269276983584, 'psi': 0.7267984990647623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=36 head_norm_before_train=1.891681 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8220371710295437, 'auprc': 0.9595498805918112, 'loss_val': 0.4238027383854003, 'psi': 0.8770422548544506}-{'f1_val': 0.9407479873290472, 'auprc': 0.9704240178754421, 'loss_val': 0.23188991890023816, 'psi': 0.9526183995476052}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.418283 cos_to_last_merge=0.9391 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=36 local utility u=0.305938 metrics={'f1_val': 0.6565991675628091, 'auprc': 0.8379471026580562, 'loss_val': 0.4540602696830735, 'psi': 0.729138341600908}-{'f1_val': 0.6067440011096766, 'auprc': 0.7999158908477992, 'loss_val': 0.6527117216543109, 'psi': 0.6840127570049257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=36 head_norm_before_train=1.657340 cos_to_last_merge=0.9528 (last merge round=14)
[S8] round=36 local utility u=0.019660 metrics={'f1_val': 0.991372388611257, 'auprc': 0.9989490822592699, 'loss_val': 0.041127150265508984, 'psi': 0.9944030660704621}-{'f1_val': 0.9863756004935829, 'auprc': 0.9989824460707892, 'loss_val': 0.05056592724011151, 'psi': 0.9914183387244655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=36 head_norm_before_train=2.000854 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9965113466541068, 'loss_val': 0.019121823237785864, 'psi': 0.9966008457499775}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988563869862077, 'loss_val': 0.01887136463920179, 'psi': 0.9975388618828179}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.734453 cos_to_last_merge=0.9563 (last merge round=15)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9945528553774142, 'auprc': 0.9952187743685139, 'loss_val': 0.045334886485983196, 'psi': 0.9948192229738541}-{'f1_val': 0.9957973497718928, 'auprc': 0.9953484472299863, 'loss_val': 0.03580268203976754, 'psi': 0.9956177887551303}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.458450 cos_to_last_merge=0.8798 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.880
[S11] round=36 local utility u=0.042302 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978509575622068, 'loss_val': 0.056697944629227184, 'psi': 0.9968205879728683}-{'f1_val': 0.9851797174246673, 'auprc': 0.9979811355459465, 'loss_val': 0.07596809228540427, 'psi': 0.990300284673179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=36 head_norm_before_train=1.305875 cos_to_last_merge=0.9026 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.903
[S13] round=36 local utility u=0.155981 metrics={'f1_val': 0.6012408636120148, 'auprc': 0.646417439974476, 'loss_val': 0.7318222215859782, 'psi': 0.6193114941569993}-{'f1_val': 0.5620918749644952, 'auprc': 0.6783620380071597, 'loss_val': 0.9047245432870404, 'psi': 0.6085999401815609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=36 head_norm_before_train=2.022506 (no previous merge yet)
[S14] round=36 local utility u=0.108235 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9986690286044686, 'loss_val': 0.019992766933621276, 'psi': 0.9980842113140853}-{'f1_val': 0.9677425861939483, 'auprc': 0.9966270087640703, 'loss_val': 0.05062613887085486, 'psi': 0.9792963552219971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=36 head_norm_before_train=1.646089 cos_to_last_merge=0.9117 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.912
[S15] round=36 local utility u=0.217084 metrics={'f1_val': 0.8003542332480466, 'auprc': 0.932462559151001, 'loss_val': 0.35761391596905373, 'psi': 0.8531975636092284}-{'f1_val': 0.7627002969753616, 'auprc': 0.8887379581412378, 'loss_val': 0.43468483416571946, 'psi': 0.8131153614417121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=36 head_norm_before_train=1.621724 cos_to_last_merge=0.8999 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.900
[S16] round=36 local utility u=1.000000 metrics={'f1_val': 0.9907021517556219, 'auprc': 0.9889067270385475, 'loss_val': 0.05870019492882691, 'psi': 0.9899839818687922}-{'f1_val': 0.8318343493143179, 'auprc': 0.8529176817013694, 'loss_val': 1.0491504344520317, 'psi': 0.8402676822691385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=36 head_norm_before_train=1.507365 cos_to_last_merge=0.7778 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6509520566830251, 'auprc': 0.8109973018945549, 'loss_val': 1.1003179956668414, 'psi': 0.714970154767637}-{'f1_val': 0.6833841509458698, 'auprc': 0.8442963587056069, 'loss_val': 0.8455147320892443, 'psi': 0.7477490340497647}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.712747 cos_to_last_merge=0.9217 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.922
[S2] round=37 local utility u=0.085130 metrics={'f1_val': 0.818176657653607, 'auprc': 0.8921961420210857, 'loss_val': 0.27675265118160136, 'psi': 0.8477844514005985}-{'f1_val': 0.7709883955640591, 'auprc': 0.9216335983655993, 'loss_val': 0.2521961803270642, 'psi': 0.8312464766846752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=37 head_norm_before_train=1.755403 cos_to_last_merge=0.9644 (last merge round=16)
[S3] round=37 local utility u=0.717408 metrics={'f1_val': 0.8972227648784235, 'auprc': 0.987071184803744, 'loss_val': 0.1759421040741054, 'psi': 0.9331621328485518}-{'f1_val': 0.7337373731270744, 'auprc': 0.935607662936851, 'loss_val': 0.4754544320262304, 'psi': 0.8144854890509851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=37 head_norm_before_train=1.614285 cos_to_last_merge=0.9659 (last merge round=15)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9396959364512405, 'auprc': 0.8639451718312945, 'loss_val': 0.2966335047221169, 'psi': 0.9093956306032621}-{'f1_val': 0.9422530642734676, 'auprc': 0.8878167658088436, 'loss_val': 0.2733710026246541, 'psi': 0.920478544887618}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.505067 cos_to_last_merge=0.7428 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.743
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.4440261457961161, 'auprc': 0.8569585779850031, 'loss_val': 0.800462804533689, 'psi': 0.6091991186716709}-{'f1_val': 0.7003213174339138, 'auprc': 0.9933324491458145, 'loss_val': 0.19093629610564106, 'psi': 0.817525770118674}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.898532 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7444048471395361, 'auprc': 0.9565498547875315, 'loss_val': 0.5422938424014353, 'psi': 0.8292628501987342}-{'f1_val': 0.8220371710295437, 'auprc': 0.9595498805918112, 'loss_val': 0.4238027383854003, 'psi': 0.8770422548544506}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.431312 cos_to_last_merge=0.9368 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.937
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.43025967762955586, 'auprc': 0.777740384225309, 'loss_val': 0.9858290868301949, 'psi': 0.5692519602678572}-{'f1_val': 0.6565991675628091, 'auprc': 0.8379471026580562, 'loss_val': 0.4540602696830735, 'psi': 0.729138341600908}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.669528 cos_to_last_merge=0.9515 (last merge round=14)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9928666440433099, 'auprc': 0.991295162615356, 'loss_val': 0.03800235834400912, 'psi': 0.9922380514721283}-{'f1_val': 0.991372388611257, 'auprc': 0.9989490822592699, 'loss_val': 0.041127150265508984, 'psi': 0.9944030660704621}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=2.010105 (no previous merge yet)
[S9] round=37 local utility u=0.000346 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988760837944992, 'loss_val': 0.020520335767944868, 'psi': 0.997046464536311}-{'f1_val': 0.9966605118138915, 'auprc': 0.9965113466541068, 'loss_val': 0.019121823237785864, 'psi': 0.9966008457499775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=37 head_norm_before_train=1.747900 cos_to_last_merge=0.9548 (last merge round=15)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9762380528697909, 'auprc': 0.993133751795309, 'loss_val': 0.08620976366659085, 'psi': 0.9829963324399982}-{'f1_val': 0.9945528553774142, 'auprc': 0.9952187743685139, 'loss_val': 0.045334886485983196, 'psi': 0.9948192229738541}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.475106 cos_to_last_merge=0.8776 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.878
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9858869648418478, 'auprc': 0.998065738151672, 'loss_val': 0.06853875727487078, 'psi': 0.9907584741657776}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978509575622068, 'loss_val': 0.056697944629227184, 'psi': 0.9968205879728683}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.317681 cos_to_last_merge=0.9004 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.900
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.556136481254431, 'auprc': 0.6910083494394974, 'loss_val': 0.9719390777696614, 'psi': 0.6100852285284576}-{'f1_val': 0.6012408636120148, 'auprc': 0.646417439974476, 'loss_val': 0.7318222215859782, 'psi': 0.6193114941569993}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.032416 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.997065373110025, 'auprc': 0.9986708397723103, 'loss_val': 0.019357843605812733, 'psi': 0.9977075597749391}-{'f1_val': 0.9976943331204965, 'auprc': 0.9986690286044686, 'loss_val': 0.019992766933621276, 'psi': 0.9980842113140853}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.661636 cos_to_last_merge=0.9100 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.910
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.8281484775591506, 'loss_val': 0.5467939349785849, 'psi': 0.7518095773254343}-{'f1_val': 0.8003542332480466, 'auprc': 0.932462559151001, 'loss_val': 0.35761391596905373, 'psi': 0.8531975636092284}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.633866 cos_to_last_merge=0.8983 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.898
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9900242785059054, 'auprc': 0.9824981560190061, 'loss_val': 0.060460844226140446, 'psi': 0.9870138295111457}-{'f1_val': 0.9907021517556219, 'auprc': 0.9889067270385475, 'loss_val': 0.05870019492882691, 'psi': 0.9899839818687922}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.526754 cos_to_last_merge=0.7773 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6457869892012744, 'auprc': 0.8037480619371755, 'loss_val': 1.1740748498632056, 'psi': 0.7089714182956348}-{'f1_val': 0.6509520566830251, 'auprc': 0.8109973018945549, 'loss_val': 1.1003179956668414, 'psi': 0.714970154767637}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.721540 cos_to_last_merge=0.9214 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.5444295405929084, 'auprc': 0.7684922351431369, 'loss_val': 0.636692761692671, 'psi': 0.6340546184129998}-{'f1_val': 0.818176657653607, 'auprc': 0.8921961420210857, 'loss_val': 0.27675265118160136, 'psi': 0.8477844514005985}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.765813 cos_to_last_merge=0.9632 (last merge round=16)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.770023713465332, 'auprc': 0.9557881576771025, 'loss_val': 0.41585702025380145, 'psi': 0.8443294911500403}-{'f1_val': 0.8972227648784235, 'auprc': 0.987071184803744, 'loss_val': 0.1759421040741054, 'psi': 0.9331621328485518}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.621616 cos_to_last_merge=0.9649 (last merge round=15)
[S4] round=38 local utility u=0.029760 metrics={'f1_val': 0.939811890822918, 'auprc': 0.8831922536685499, 'loss_val': 0.29555122532540357, 'psi': 0.9171640359611708}-{'f1_val': 0.9396959364512405, 'auprc': 0.8639451718312945, 'loss_val': 0.2966335047221169, 'psi': 0.9093956306032621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=38 head_norm_before_train=1.510063 cos_to_last_merge=0.7427 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.743
[S5] round=38 local utility u=0.609621 metrics={'f1_val': 0.6003824970212324, 'auprc': 0.8589037319587502, 'loss_val': 0.5251941280044086, 'psi': 0.7037909909962395}-{'f1_val': 0.4440261457961161, 'auprc': 0.8569585779850031, 'loss_val': 0.800462804533689, 'psi': 0.6091991186716709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=38 head_norm_before_train=1.903887 (no previous merge yet)
[S6] round=38 local utility u=0.112435 metrics={'f1_val': 0.7698626492560915, 'auprc': 0.9578978396488083, 'loss_val': 0.47421379884252984, 'psi': 0.8450767254131781}-{'f1_val': 0.7444048471395361, 'auprc': 0.9565498547875315, 'loss_val': 0.5422938424014353, 'psi': 0.8292628501987342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=38 head_norm_before_train=1.441092 cos_to_last_merge=0.9351 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=38 local utility u=0.927588 metrics={'f1_val': 0.6434439126802896, 'auprc': 0.8188995610343526, 'loss_val': 0.5332355688625132, 'psi': 0.7136261720219148}-{'f1_val': 0.43025967762955586, 'auprc': 0.777740384225309, 'loss_val': 0.9858290868301949, 'psi': 0.5692519602678572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=38 head_norm_before_train=1.679340 cos_to_last_merge=0.9504 (last merge round=14)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9937604981237848, 'auprc': 0.9856228031178222, 'loss_val': 0.04155112862293022, 'psi': 0.9905054201213996}-{'f1_val': 0.9928666440433099, 'auprc': 0.991295162615356, 'loss_val': 0.03800235834400912, 'psi': 0.9922380514721283}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=2.019098 (no previous merge yet)
[S9] round=38 local utility u=0.003539 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988524536533328, 'loss_val': 0.018374108796706267, 'psi': 0.9975372885496679}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988760837944992, 'loss_val': 0.020520335767944868, 'psi': 0.997046464536311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=38 head_norm_before_train=1.758235 cos_to_last_merge=0.9536 (last merge round=15)
[S10] round=38 local utility u=0.083597 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9948008077998631, 'loss_val': 0.036398561631638106, 'psi': 0.994901235038991}-{'f1_val': 0.9762380528697909, 'auprc': 0.993133751795309, 'loss_val': 0.08620976366659085, 'psi': 0.9829963324399982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=38 head_norm_before_train=1.491267 cos_to_last_merge=0.8755 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.875
[S11] round=38 local utility u=0.024197 metrics={'f1_val': 0.9900887037960966, 'auprc': 0.9979761714459885, 'loss_val': 0.045086730516370764, 'psi': 0.9932436908560534}-{'f1_val': 0.9858869648418478, 'auprc': 0.998065738151672, 'loss_val': 0.06853875727487078, 'psi': 0.9907584741657776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=38 head_norm_before_train=1.325795 cos_to_last_merge=0.8986 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=38 local utility u=0.056138 metrics={'f1_val': 0.5697015395462377, 'auprc': 0.6693885111965905, 'loss_val': 0.8761946109880259, 'psi': 0.6095763282063789}-{'f1_val': 0.556136481254431, 'auprc': 0.6910083494394974, 'loss_val': 0.9719390777696614, 'psi': 0.6100852285284576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=38 head_norm_before_train=2.043509 (no previous merge yet)
[S14] round=38 local utility u=0.001849 metrics={'f1_val': 0.9975262299374879, 'auprc': 0.9986684544729408, 'loss_val': 0.018418392462294243, 'psi': 0.9979831197516691}-{'f1_val': 0.997065373110025, 'auprc': 0.9986708397723103, 'loss_val': 0.019357843605812733, 'psi': 0.9977075597749391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=38 head_norm_before_train=1.677225 cos_to_last_merge=0.9081 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.908
[S15] round=38 local utility u=1.000000 metrics={'f1_val': 0.996248502210966, 'auprc': 0.9893317927025295, 'loss_val': 0.03818407692022431, 'psi': 0.9934818184075913}-{'f1_val': 0.7009169771696235, 'auprc': 0.8281484775591506, 'loss_val': 0.5467939349785849, 'psi': 0.7518095773254343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=38 head_norm_before_train=1.645930 cos_to_last_merge=0.8967 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.897
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8360904709280121, 'auprc': 0.8927557855661601, 'loss_val': 1.013703142092241, 'psi': 0.8587565967832713}-{'f1_val': 0.9900242785059054, 'auprc': 0.9824981560190061, 'loss_val': 0.060460844226140446, 'psi': 0.9870138295111457}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.549698 cos_to_last_merge=0.7768 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=38 local utility u=0.028961 metrics={'f1_val': 0.6519851490877965, 'auprc': 0.8132378660816039, 'loss_val': 1.1818108187300507, 'psi': 0.7164862358853195}-{'f1_val': 0.6457869892012744, 'auprc': 0.8037480619371755, 'loss_val': 1.1740748498632056, 'psi': 0.7089714182956348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=39 head_norm_before_train=1.729574 cos_to_last_merge=0.9208 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=39 local utility u=1.000000 metrics={'f1_val': 0.8205849868780155, 'auprc': 0.8670939622448455, 'loss_val': 0.3059930122144668, 'psi': 0.8391885770247475}-{'f1_val': 0.5444295405929084, 'auprc': 0.7684922351431369, 'loss_val': 0.636692761692671, 'psi': 0.6340546184129998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S2] sending update (kind=head size=1811 to 1 peers)
[S2] r=40 psi=0.839 u=1.0000 p_local=0.2636 f1=0.821 auprc=0.867 bytes=50388
[S3] START round=39 head_norm_before_train=1.777219 cos_to_last_merge=0.9619 (last merge round=16)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.7401880193909947, 'auprc': 0.9525302107683405, 'loss_val': 0.4892314252144617, 'psi': 0.8251248959419331}-{'f1_val': 0.770023713465332, 'auprc': 0.9557881576771025, 'loss_val': 0.41585702025380145, 'psi': 0.8443294911500403}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.825 u=0.0000 p_local=0.2034 f1=0.740 auprc=0.953 bytes=35978
[S4] START round=39 head_norm_before_train=1.628965 cos_to_last_merge=0.9642 (last merge round=15)
[S4] round=39 local utility u=0.076048 metrics={'f1_val': 0.9417908880957861, 'auprc': 0.9253598058053099, 'loss_val': 0.28183184701608177, 'psi': 0.9352184551795957}-{'f1_val': 0.939811890822918, 'auprc': 0.8831922536685499, 'loss_val': 0.29555122532540357, 'psi': 0.9171640359611708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S4] r=40 psi=0.935 u=0.0760 p_local=0.0286 f1=0.942 auprc=0.925 bytes=44961
[S5] START round=39 head_norm_before_train=1.516850 cos_to_last_merge=0.7421 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.742
[S5] round=39 local utility u=0.652066 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9913766712055526, 'loss_val': 0.21811454208365674, 'psi': 0.8167434589425693}-{'f1_val': 0.6003824970212324, 'auprc': 0.8589037319587502, 'loss_val': 0.5251941280044086, 'psi': 0.7037909909962395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S5] r=40 psi=0.817 u=0.6521 p_local=0.4057 f1=0.700 auprc=0.991 bytes=44933
[S6] START round=39 head_norm_before_train=1.906731 (no previous merge yet)
[S6] round=39 local utility u=0.530494 metrics={'f1_val': 0.9000658653983505, 'auprc': 0.9622059310942714, 'loss_val': 0.20736859970234842, 'psi': 0.9249218916767189}-{'f1_val': 0.7698626492560915, 'auprc': 0.9578978396488083, 'loss_val': 0.47421379884252984, 'psi': 0.8450767254131781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] r=40 psi=0.925 u=0.5305 p_local=0.2928 f1=0.900 auprc=0.962 bytes=41385
[S7] START round=39 head_norm_before_train=1.450480 cos_to_last_merge=0.9337 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=39 local utility u=0.020485 metrics={'f1_val': 0.6439628267691349, 'auprc': 0.822648300326315, 'loss_val': 0.5066248651436677, 'psi': 0.715437016192007}-{'f1_val': 0.6434439126802896, 'auprc': 0.8188995610343526, 'loss_val': 0.5332355688625132, 'psi': 0.7136261720219148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S7] r=40 psi=0.715 u=0.0205 p_local=0.2647 f1=0.644 auprc=0.823 bytes=41355
[S8] START round=39 head_norm_before_train=1.688411 cos_to_last_merge=0.9500 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.950
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9821625243499919, 'auprc': 0.9989894417834169, 'loss_val': 0.06019306695390844, 'psi': 0.9888932913233619}-{'f1_val': 0.9937604981237848, 'auprc': 0.9856228031178222, 'loss_val': 0.04155112862293022, 'psi': 0.9905054201213996}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.989 u=0.0000 p_local=0.0271 f1=0.982 auprc=0.999 bytes=48568
[S9] START round=39 head_norm_before_train=2.026637 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9937352737179022, 'loss_val': 0.018891756671592732, 'psi': 0.9957558569944466}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988524536533328, 'loss_val': 0.018374108796706267, 'psi': 0.9975372885496679}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.996 u=0.0000 p_local=0.0028 f1=0.997 auprc=0.994 bytes=48614
[S10] START round=39 head_norm_before_train=1.769191 cos_to_last_merge=0.9524 (last merge round=15)
[S10] round=39 local utility u=0.006011 metrics={'f1_val': 0.9957973497718928, 'auprc': 0.9959380077018055, 'loss_val': 0.032762748812201384, 'psi': 0.995853612943858}-{'f1_val': 0.9949681865317428, 'auprc': 0.9948008077998631, 'loss_val': 0.036398561631638106, 'psi': 0.994901235038991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S10] r=40 psi=0.996 u=0.0060 p_local=0.0431 f1=0.996 auprc=0.996 bytes=50389
[S11] START round=39 head_norm_before_train=1.508046 cos_to_last_merge=0.8733 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.873
[S11] round=39 local utility u=0.025617 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998002688410503, 'loss_val': 0.03268108961207985, 'psi': 0.997129278072355}-{'f1_val': 0.9900887037960966, 'auprc': 0.9979761714459885, 'loss_val': 0.045086730516370764, 'psi': 0.9932436908560534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.997 u=0.0256 p_local=0.0241 f1=0.997 auprc=0.998 bytes=46701
[S13] START round=39 head_norm_before_train=1.332781 cos_to_last_merge=0.8968 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.897
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5608702408674274, 'auprc': 0.6760548443592233, 'loss_val': 0.9272384742346695, 'psi': 0.6069440822641458}-{'f1_val': 0.5697015395462377, 'auprc': 0.6693885111965905, 'loss_val': 0.8761946109880259, 'psi': 0.6095763282063789}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.607 u=0.0000 p_local=0.0378 f1=0.561 auprc=0.676 bytes=39552
[S14] START round=39 head_norm_before_train=2.053967 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969767279789098, 'loss_val': 0.019059493053713218, 'psi': 0.9971349052150398}-{'f1_val': 0.9975262299374879, 'auprc': 0.9986684544729408, 'loss_val': 0.018418392462294243, 'psi': 0.9979831197516691}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0152 f1=0.997 auprc=0.997 bytes=48560
[S15] START round=39 head_norm_before_train=1.691246 cos_to_last_merge=0.9064 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.906
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.808024009135153, 'loss_val': 0.5618115073017403, 'psi': 0.7437597899558354}-{'f1_val': 0.996248502210966, 'auprc': 0.9893317927025295, 'loss_val': 0.03818407692022431, 'psi': 0.9934818184075913}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.744 u=0.0000 p_local=0.2554 f1=0.701 auprc=0.808 bytes=44928
[S16] START round=39 head_norm_before_train=1.656378 cos_to_last_merge=0.8953 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.895
[S16] round=39 local utility u=0.782314 metrics={'f1_val': 0.9371054785814847, 'auprc': 0.988566635972618, 'loss_val': 0.34259751006893424, 'psi': 0.9576899415379381}-{'f1_val': 0.8360904709280121, 'auprc': 0.8927557855661601, 'loss_val': 1.013703142092241, 'psi': 0.8587565967832713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] sending update (kind=head size=1808 to 1 peers)
[S16] r=40 psi=0.958 u=0.7823 p_local=0.3752 f1=0.937 auprc=0.989 bytes=45005
[S17] START round=39 head_norm_before_train=1.577682 cos_to_last_merge=0.7763 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6498893764441172, 'auprc': 0.8143685068838046, 'loss_val': 1.2352522875693186, 'psi': 0.7156810286199922}-{'f1_val': 0.6519851490877965, 'auprc': 0.8132378660816039, 'loss_val': 1.1818108187300507, 'psi': 0.7164862358853195}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.716 u=0.0000 p_local=0.1020 f1=0.650 auprc=0.814 bytes=35928
[S2] START round=40 head_norm_before_train=1.735555 cos_to_last_merge=0.9202 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.920
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8078467088476948, 'auprc': 0.8794885789595649, 'loss_val': 0.28578491967097147, 'psi': 0.8365034568924429}-{'f1_val': 0.8205849868780155, 'auprc': 0.8670939622448455, 'loss_val': 0.3059930122144668, 'psi': 0.8391885770247475}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.786526 cos_to_last_merge=0.9608 (last merge round=16)
[S3] round=40 local utility u=0.760357 metrics={'f1_val': 0.9187687270407043, 'auprc': 0.9872973199927186, 'loss_val': 0.1443039704401784, 'psi': 0.9461801642215101}-{'f1_val': 0.7401880193909947, 'auprc': 0.9525302107683405, 'loss_val': 0.4892314252144617, 'psi': 0.8251248959419331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] START round=40 head_norm_before_train=1.638160 cos_to_last_merge=0.9634 (last merge round=15)
[S4] round=40 local utility u=0.059372 metrics={'f1_val': 0.9471367904759384, 'auprc': 0.949803873871643, 'loss_val': 0.26849469139653004, 'psi': 0.9482036238342202}-{'f1_val': 0.9417908880957861, 'auprc': 0.9253598058053099, 'loss_val': 0.28183184701608177, 'psi': 0.9352184551795957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=40 head_norm_before_train=1.522920 cos_to_last_merge=0.7400 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.740
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8666251283644262, 'loss_val': 0.3545429987099477, 'psi': 0.7668424104405859}-{'f1_val': 0.7003213174339138, 'auprc': 0.9913766712055526, 'loss_val': 0.21811454208365674, 'psi': 0.8167434589425693}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.914837 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7394424946082288, 'auprc': 0.9596122115399304, 'loss_val': 0.6160207915994734, 'psi': 0.8275103813809094}-{'f1_val': 0.9000658653983505, 'auprc': 0.9622059310942714, 'loss_val': 0.20736859970234842, 'psi': 0.9249218916767189}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.459276 cos_to_last_merge=0.9324 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6365510225452149, 'auprc': 0.8134809806558726, 'loss_val': 0.5377808126422707, 'psi': 0.7073230057894779}-{'f1_val': 0.6439628267691349, 'auprc': 0.822648300326315, 'loss_val': 0.5066248651436677, 'psi': 0.715437016192007}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.696069 cos_to_last_merge=0.9491 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=40 local utility u=0.030597 metrics={'f1_val': 0.9895832245655481, 'auprc': 0.9989859351834687, 'loss_val': 0.04351242310153544, 'psi': 0.9933443088127164}-{'f1_val': 0.9821625243499919, 'auprc': 0.9989894417834169, 'loss_val': 0.06019306695390844, 'psi': 0.9888932913233619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=40 head_norm_before_train=2.032041 (no previous merge yet)
[S9] round=40 local utility u=0.004380 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9964425544711482, 'loss_val': 0.01825404007223734, 'psi': 0.996838769295745}-{'f1_val': 0.9971029125121428, 'auprc': 0.9937352737179022, 'loss_val': 0.018891756671592732, 'psi': 0.9957558569944466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=40 head_norm_before_train=1.781103 cos_to_last_merge=0.9512 (last merge round=15)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9452103397006117, 'auprc': 0.9916280354326736, 'loss_val': 0.12731849359496297, 'psi': 0.9637774179934365}-{'f1_val': 0.9957973497718928, 'auprc': 0.9959380077018055, 'loss_val': 0.032762748812201384, 'psi': 0.995853612943858}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.521827 cos_to_last_merge=0.8717 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.872
[S11] round=40 local utility u=0.000585 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998015539270909, 'loss_val': 0.03155040457353678, 'psi': 0.9971344184165174}-{'f1_val': 0.9965470045135896, 'auprc': 0.998002688410503, 'loss_val': 0.03268108961207985, 'psi': 0.997129278072355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=40 head_norm_before_train=1.340769 cos_to_last_merge=0.8946 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.895
[S13] round=40 local utility u=0.085913 metrics={'f1_val': 0.5785819980624822, 'auprc': 0.6693417983054128, 'loss_val': 0.8415440832041023, 'psi': 0.6148859181596544}-{'f1_val': 0.5608702408674274, 'auprc': 0.6760548443592233, 'loss_val': 0.9272384742346695, 'psi': 0.6069440822641458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=40 head_norm_before_train=2.062671 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9967790016857778, 'loss_val': 0.021643018720350637, 'psi': 0.9968029443070034}-{'f1_val': 0.997240356705793, 'auprc': 0.9969767279789098, 'loss_val': 0.019059493053713218, 'psi': 0.9971349052150398}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.703624 cos_to_last_merge=0.9051 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.905
[S15] round=40 local utility u=1.000000 metrics={'f1_val': 0.992811988091136, 'auprc': 0.9963656344614258, 'loss_val': 0.04302633010647549, 'psi': 0.994233446639252}-{'f1_val': 0.7009169771696235, 'auprc': 0.808024009135153, 'loss_val': 0.5618115073017403, 'psi': 0.7437597899558354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=40 head_norm_before_train=1.666993 cos_to_last_merge=0.8940 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.894
[S16] round=40 local utility u=0.313801 metrics={'f1_val': 0.9911134280590718, 'auprc': 0.9929570523637778, 'loss_val': 0.052214338419234216, 'psi': 0.9918508777809542}-{'f1_val': 0.9371054785814847, 'auprc': 0.988566635972618, 'loss_val': 0.34259751006893424, 'psi': 0.9576899415379381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] sending update (kind=head size=1808 to 1 peers)
[S17] START round=40 head_norm_before_train=1.603880 cos_to_last_merge=0.7755 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=40 local utility u=0.111327 metrics={'f1_val': 0.6658350677196004, 'auprc': 0.8244890245793957, 'loss_val': 1.1386349653865295, 'psi': 0.7292966504635185}-{'f1_val': 0.6498893764441172, 'auprc': 0.8143685068838046, 'loss_val': 1.2352522875693186, 'psi': 0.7156810286199922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=41 head_norm_before_train=1.741403 cos_to_last_merge=0.9196 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.920
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7207490012418672, 'auprc': 0.793113811671594, 'loss_val': 0.3769224675634702, 'psi': 0.7496949254137579}-{'f1_val': 0.8078467088476948, 'auprc': 0.8794885789595649, 'loss_val': 0.28578491967097147, 'psi': 0.8365034568924429}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.794420 cos_to_last_merge=0.9599 (last merge round=16)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.8766539217375415, 'auprc': 0.9783607985222531, 'loss_val': 0.19492544617260782, 'psi': 0.9173366724514261}-{'f1_val': 0.9187687270407043, 'auprc': 0.9872973199927186, 'loss_val': 0.1443039704401784, 'psi': 0.9461801642215101}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.646881 cos_to_last_merge=0.9630 (last merge round=15)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9533252055373107, 'auprc': 0.9182335520813913, 'loss_val': 0.2583958388371906, 'psi': 0.939288544154943}-{'f1_val': 0.9471367904759384, 'auprc': 0.949803873871643, 'loss_val': 0.26849469139653004, 'psi': 0.9482036238342202}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.532764 cos_to_last_merge=0.7378 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.738
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.65336903888773, 'auprc': 0.8981693415602637, 'loss_val': 0.37296268581239633, 'psi': 0.7512891599567435}-{'f1_val': 0.700320598491359, 'auprc': 0.8666251283644262, 'loss_val': 0.3545429987099477, 'psi': 0.7668424104405859}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.927252 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.5975584344754096, 'auprc': 0.9296959674159679, 'loss_val': 1.0084856993436848, 'psi': 0.7304134476516329}-{'f1_val': 0.7394424946082288, 'auprc': 0.9596122115399304, 'loss_val': 0.6160207915994734, 'psi': 0.8275103813809094}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.467070 cos_to_last_merge=0.9312 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=41 local utility u=0.113916 metrics={'f1_val': 0.6481244195516149, 'auprc': 0.8338197114417333, 'loss_val': 0.44040521853225995, 'psi': 0.7224025363076623}-{'f1_val': 0.6365510225452149, 'auprc': 0.8134809806558726, 'loss_val': 0.5377808126422707, 'psi': 0.7073230057894779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=41 head_norm_before_train=1.705814 cos_to_last_merge=0.9482 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=41 local utility u=0.013211 metrics={'f1_val': 0.9928666440433099, 'auprc': 0.9986733383796149, 'loss_val': 0.03585333557013118, 'psi': 0.9951893217778318}-{'f1_val': 0.9895832245655481, 'auprc': 0.9989859351834687, 'loss_val': 0.04351242310153544, 'psi': 0.9933443088127164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=41 head_norm_before_train=2.038985 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9994678830160612, 'loss_val': 0.03184211540591726, 'psi': 0.9945336413433148}-{'f1_val': 0.9971029125121428, 'auprc': 0.9964425544711482, 'loss_val': 0.01825404007223734, 'psi': 0.996838769295745}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.792988 cos_to_last_merge=0.9501 (last merge round=15)
[S10] round=41 local utility u=0.204229 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9956043287607238, 'loss_val': 0.031825165220099226, 'psi': 0.9954715418293089}-{'f1_val': 0.9452103397006117, 'auprc': 0.9916280354326736, 'loss_val': 0.12731849359496297, 'psi': 0.9637774179934365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=41 head_norm_before_train=1.535522 cos_to_last_merge=0.8700 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.870
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9823049224050256, 'auprc': 0.9980354825775976, 'loss_val': 0.07327755715007322, 'psi': 0.9885971464740544}-{'f1_val': 0.9965470045135896, 'auprc': 0.998015539270909, 'loss_val': 0.03155040457353678, 'psi': 0.9971344184165174}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.350904 cos_to_last_merge=0.8922 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.892
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.576148409873074, 'auprc': 0.6872661585806139, 'loss_val': 0.9173686401607434, 'psi': 0.62059550935609}-{'f1_val': 0.5785819980624822, 'auprc': 0.6693417983054128, 'loss_val': 0.8415440832041023, 'psi': 0.6148859181596544}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.069362 (no previous merge yet)
[S14] round=41 local utility u=0.005001 metrics={'f1_val': 0.997065373110025, 'auprc': 0.9986675523335411, 'loss_val': 0.018785287308985037, 'psi': 0.9977062447994314}-{'f1_val': 0.9968189060544872, 'auprc': 0.9967790016857778, 'loss_val': 0.021643018720350637, 'psi': 0.9968029443070034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=41 head_norm_before_train=1.713562 cos_to_last_merge=0.9040 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.904
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7009149069723875, 'auprc': 0.9034579987162068, 'loss_val': 0.5459638950804578, 'psi': 0.7819321436699151}-{'f1_val': 0.992811988091136, 'auprc': 0.9963656344614258, 'loss_val': 0.04302633010647549, 'psi': 0.994233446639252}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.678572 cos_to_last_merge=0.8926 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.893
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9913522554794518, 'auprc': 0.9895242210171824, 'loss_val': 0.047896390946732925, 'psi': 0.990621041694544}-{'f1_val': 0.9911134280590718, 'auprc': 0.9929570523637778, 'loss_val': 0.052214338419234216, 'psi': 0.9918508777809542}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.625789 cos_to_last_merge=0.7747 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6534751897775465, 'auprc': 0.8205400062662351, 'loss_val': 1.2741028079914583, 'psi': 0.720301116373022}-{'f1_val': 0.6658350677196004, 'auprc': 0.8244890245793957, 'loss_val': 1.1386349653865295, 'psi': 0.7292966504635185}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.749990 cos_to_last_merge=0.9186 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.919
[S2] round=42 local utility u=0.493781 metrics={'f1_val': 0.8273690090604606, 'auprc': 0.8802885734584321, 'loss_val': 0.2906047215862003, 'psi': 0.8485368348196491}-{'f1_val': 0.7207490012418672, 'auprc': 0.793113811671594, 'loss_val': 0.3769224675634702, 'psi': 0.7496949254137579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=42 head_norm_before_train=1.803943 cos_to_last_merge=0.9588 (last merge round=16)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8236877509444427, 'auprc': 0.9762696947946284, 'loss_val': 0.2813441162280215, 'psi': 0.884720528484517}-{'f1_val': 0.8766539217375415, 'auprc': 0.9783607985222531, 'loss_val': 0.19492544617260782, 'psi': 0.9173366724514261}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.654264 cos_to_last_merge=0.9627 (last merge round=15)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9421128551740481, 'auprc': 0.9073734005558055, 'loss_val': 0.27981438712698037, 'psi': 0.928217073326751}-{'f1_val': 0.9533252055373107, 'auprc': 0.9182335520813913, 'loss_val': 0.2583958388371906, 'psi': 0.939288544154943}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.541849 cos_to_last_merge=0.7352 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.735
[S5] round=42 local utility u=0.751733 metrics={'f1_val': 0.8655493456477443, 'auprc': 0.9623294483340898, 'loss_val': 0.3350580213920251, 'psi': 0.9042613867222825}-{'f1_val': 0.65336903888773, 'auprc': 0.8981693415602637, 'loss_val': 0.37296268581239633, 'psi': 0.7512891599567435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=42 head_norm_before_train=1.937593 (no previous merge yet)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8584537695125994, 'auprc': 0.9562651588560036, 'loss_val': 0.36309926180655044, 'psi': 0.8975783252499611}-{'f1_val': 0.5975584344754096, 'auprc': 0.9296959674159679, 'loss_val': 1.0084856993436848, 'psi': 0.7304134476516329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=42 head_norm_before_train=1.478982 cos_to_last_merge=0.9296 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.930
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.4832394877049274, 'auprc': 0.7793301271950427, 'loss_val': 0.8918249833554861, 'psi': 0.6016757435009735}-{'f1_val': 0.6481244195516149, 'auprc': 0.8338197114417333, 'loss_val': 0.44040521853225995, 'psi': 0.7224025363076623}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.713668 cos_to_last_merge=0.9473 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.991372388611257, 'auprc': 0.9990080723221949, 'loss_val': 0.03959676046858611, 'psi': 0.9944266620956321}-{'f1_val': 0.9928666440433099, 'auprc': 0.9986733383796149, 'loss_val': 0.03585333557013118, 'psi': 0.9951893217778318}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=2.045779 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.999531065203773, 'loss_val': 0.032130248069512715, 'psi': 0.9945589142183996}-{'f1_val': 0.9912441468948172, 'auprc': 0.9994678830160612, 'loss_val': 0.03184211540591726, 'psi': 0.9945336413433148}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.802102 cos_to_last_merge=0.9494 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9952532707947455, 'loss_val': 0.03174763181492555, 'psi': 0.9950822202369438}-{'f1_val': 0.9953830172083656, 'auprc': 0.9956043287607238, 'loss_val': 0.031825165220099226, 'psi': 0.9954715418293089}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.549397 cos_to_last_merge=0.8684 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.868
[S11] round=42 local utility u=0.062354 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980464085517525, 'loss_val': 0.03157584828285468, 'psi': 0.9968987683686866}-{'f1_val': 0.9823049224050256, 'auprc': 0.9980354825775976, 'loss_val': 0.07327755715007322, 'psi': 0.9885971464740544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=42 head_norm_before_train=1.361674 cos_to_last_merge=0.8899 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.890
[S13] round=42 local utility u=0.134375 metrics={'f1_val': 0.6009054389803603, 'auprc': 0.6794978983935354, 'loss_val': 0.7738569015941457, 'psi': 0.6323424227456304}-{'f1_val': 0.576148409873074, 'auprc': 0.6872661585806139, 'loss_val': 0.9173686401607434, 'psi': 0.62059550935609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=42 head_norm_before_train=2.075526 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9968732947155414, 'auprc': 0.996985684413833, 'loss_val': 0.018972384432932886, 'psi': 0.9969182505948581}-{'f1_val': 0.997065373110025, 'auprc': 0.9986675523335411, 'loss_val': 0.018785287308985037, 'psi': 0.9977062447994314}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.722372 cos_to_last_merge=0.9030 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.903
[S15] round=42 local utility u=0.899838 metrics={'f1_val': 0.8942163894634682, 'auprc': 0.9922978875008099, 'loss_val': 0.17261593732413077, 'psi': 0.9334489886784048}-{'f1_val': 0.7009149069723875, 'auprc': 0.9034579987162068, 'loss_val': 0.5459638950804578, 'psi': 0.7819321436699151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=42 head_norm_before_train=1.690834 cos_to_last_merge=0.8911 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.891
[S16] round=42 local utility u=0.000458 metrics={'f1_val': 0.9915714808080252, 'auprc': 0.9890836792036938, 'loss_val': 0.04697499845521171, 'psi': 0.9905763601662926}-{'f1_val': 0.9913522554794518, 'auprc': 0.9895242210171824, 'loss_val': 0.047896390946732925, 'psi': 0.990621041694544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=42 head_norm_before_train=1.644112 cos_to_last_merge=0.7741 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=42 local utility u=0.029800 metrics={'f1_val': 0.6586675009199466, 'auprc': 0.828811830598629, 'loss_val': 1.2704712601099064, 'psi': 0.7267252327914195}-{'f1_val': 0.6534751897775465, 'auprc': 0.8205400062662351, 'loss_val': 1.2741028079914583, 'psi': 0.720301116373022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=43 head_norm_before_train=1.756876 cos_to_last_merge=0.9179 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.918
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8257960201059612, 'auprc': 0.8863240002555787, 'loss_val': 0.2997590417100306, 'psi': 0.8500072121658082}-{'f1_val': 0.8273690090604606, 'auprc': 0.8802885734584321, 'loss_val': 0.2906047215862003, 'psi': 0.8485368348196491}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.816038 cos_to_last_merge=0.9573 (last merge round=16)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.7816544004809438, 'auprc': 0.976998166457264, 'loss_val': 0.41164857968171353, 'psi': 0.8597919068714719}-{'f1_val': 0.8236877509444427, 'auprc': 0.9762696947946284, 'loss_val': 0.2813441162280215, 'psi': 0.884720528484517}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.658510 cos_to_last_merge=0.9621 (last merge round=15)
[S4] round=43 local utility u=0.006190 metrics={'f1_val': 0.9418102850571121, 'auprc': 0.9127640811244361, 'loss_val': 0.28179091236455245, 'psi': 0.9301918034840416}-{'f1_val': 0.9421128551740481, 'auprc': 0.9073734005558055, 'loss_val': 0.27981438712698037, 'psi': 0.928217073326751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=43 head_norm_before_train=1.545066 cos_to_last_merge=0.7336 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.734
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.4293867439105289, 'auprc': 0.8555661540896397, 'loss_val': 1.2457681445680708, 'psi': 0.5998585079821732}-{'f1_val': 0.8655493456477443, 'auprc': 0.9623294483340898, 'loss_val': 0.3350580213920251, 'psi': 0.9042613867222825}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.945611 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6044380578316599, 'auprc': 0.932222420869549, 'loss_val': 0.9193497784092723, 'psi': 0.7355518030468156}-{'f1_val': 0.8584537695125994, 'auprc': 0.9562651588560036, 'loss_val': 0.36309926180655044, 'psi': 0.8975783252499611}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.490604 cos_to_last_merge=0.9280 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.928
[S7] round=43 local utility u=0.894258 metrics={'f1_val': 0.6645319071270825, 'auprc': 0.8432619370345558, 'loss_val': 0.3828593932318186, 'psi': 0.7360239190900718}-{'f1_val': 0.4832394877049274, 'auprc': 0.7793301271950427, 'loss_val': 0.8918249833554861, 'psi': 0.6016757435009735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=43 head_norm_before_train=1.722072 cos_to_last_merge=0.9462 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9901509125913737, 'auprc': 0.9990147971747373, 'loss_val': 0.04160522709205497, 'psi': 0.9936964664247191}-{'f1_val': 0.991372388611257, 'auprc': 0.9990080723221949, 'loss_val': 0.03959676046858611, 'psi': 0.9944266620956321}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.052333 (no previous merge yet)
[S9] round=43 local utility u=0.024449 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992619613656792, 'loss_val': 0.017578320512758178, 'psi': 0.9979665320535573}-{'f1_val': 0.9912441468948172, 'auprc': 0.999531065203773, 'loss_val': 0.032130248069512715, 'psi': 0.9945589142183996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=43 head_norm_before_train=1.812642 cos_to_last_merge=0.9483 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=43 local utility u=0.002255 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.995297984638735, 'loss_val': 0.029861064754354596, 'psi': 0.9953490041805133}-{'f1_val': 0.9949681865317428, 'auprc': 0.9952532707947455, 'loss_val': 0.03174763181492555, 'psi': 0.9950822202369438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=43 head_norm_before_train=1.562262 cos_to_last_merge=0.8670 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.867
[S11] round=43 local utility u=0.001434 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979837932273671, 'loss_val': 0.028519103337016908, 'psi': 0.9968737222389324}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980464085517525, 'loss_val': 0.03157584828285468, 'psi': 0.9968987683686866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=43 head_norm_before_train=1.369801 cos_to_last_merge=0.8887 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.889
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5706799412113107, 'auprc': 0.6861035123274299, 'loss_val': 0.9137596032081986, 'psi': 0.6168493696577584}-{'f1_val': 0.6009054389803603, 'auprc': 0.6794978983935354, 'loss_val': 0.7738569015941457, 'psi': 0.6323424227456304}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.083478 (no previous merge yet)
[S14] round=43 local utility u=0.000698 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9969684569998609, 'loss_val': 0.01974534677747246, 'psi': 0.9971335198573678}-{'f1_val': 0.9968732947155414, 'auprc': 0.996985684413833, 'loss_val': 0.018972384432932886, 'psi': 0.9969182505948581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=43 head_norm_before_train=1.731281 cos_to_last_merge=0.9020 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.902
[S15] round=43 local utility u=0.344821 metrics={'f1_val': 0.989190031517727, 'auprc': 0.9958409392195546, 'loss_val': 0.06344413873864983, 'psi': 0.991850394598458}-{'f1_val': 0.8942163894634682, 'auprc': 0.9922978875008099, 'loss_val': 0.17261593732413077, 'psi': 0.9334489886784048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=43 head_norm_before_train=1.702770 cos_to_last_merge=0.8897 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.890
[S16] round=43 local utility u=0.004201 metrics={'f1_val': 0.9915714808080252, 'auprc': 0.9916155308999031, 'loss_val': 0.04616805087662694, 'psi': 0.9915891008447763}-{'f1_val': 0.9915714808080252, 'auprc': 0.9890836792036938, 'loss_val': 0.04697499845521171, 'psi': 0.9905763601662926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=43 head_norm_before_train=1.662556 cos_to_last_merge=0.7735 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=43 local utility u=0.057014 metrics={'f1_val': 0.6711998415528084, 'auprc': 0.8340777256598642, 'loss_val': 1.2474352720400501, 'psi': 0.7363509951956306}-{'f1_val': 0.6586675009199466, 'auprc': 0.828811830598629, 'loss_val': 1.2704712601099064, 'psi': 0.7267252327914195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=44 head_norm_before_train=1.764969 cos_to_last_merge=0.9169 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.917
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.812612434089467, 'auprc': 0.7908186040745069, 'loss_val': 0.4152606079147962, 'psi': 0.8038949020834829}-{'f1_val': 0.8257960201059612, 'auprc': 0.8863240002555787, 'loss_val': 0.2997590417100306, 'psi': 0.8500072121658082}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.828621 cos_to_last_merge=0.9557 (last merge round=16)
[S3] round=44 local utility u=0.287438 metrics={'f1_val': 0.8587322928712289, 'auprc': 0.9644578874316166, 'loss_val': 0.26161971722746813, 'psi': 0.901022530695384}-{'f1_val': 0.7816544004809438, 'auprc': 0.976998166457264, 'loss_val': 0.41164857968171353, 'psi': 0.8597919068714719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=44 head_norm_before_train=1.664442 cos_to_last_merge=0.9612 (last merge round=15)
[S4] round=44 local utility u=0.001510 metrics={'f1_val': 0.9424732909673315, 'auprc': 0.9120618708067953, 'loss_val': 0.2806422625585626, 'psi': 0.9303087229031171}-{'f1_val': 0.9418102850571121, 'auprc': 0.9127640811244361, 'loss_val': 0.28179091236455245, 'psi': 0.9301918034840416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=44 head_norm_before_train=1.546542 cos_to_last_merge=0.7335 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.733
[S5] round=44 local utility u=1.000000 metrics={'f1_val': 0.7813306054317828, 'auprc': 0.9908063146119845, 'loss_val': 0.2053442068767139, 'psi': 0.8651208891038635}-{'f1_val': 0.4293867439105289, 'auprc': 0.8555661540896397, 'loss_val': 1.2457681445680708, 'psi': 0.5998585079821732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=44 head_norm_before_train=1.952174 (no previous merge yet)
[S6] round=44 local utility u=0.871762 metrics={'f1_val': 0.7983157008290254, 'auprc': 0.9728615810186422, 'loss_val': 0.4610081458118694, 'psi': 0.8681340529048721}-{'f1_val': 0.6044380578316599, 'auprc': 0.932222420869549, 'loss_val': 0.9193497784092723, 'psi': 0.7355518030468156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=44 head_norm_before_train=1.500899 cos_to_last_merge=0.9264 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.49641930715965166, 'auprc': 0.7815480266192498, 'loss_val': 0.825588017716269, 'psi': 0.6104707949434909}-{'f1_val': 0.6645319071270825, 'auprc': 0.8432619370345558, 'loss_val': 0.3828593932318186, 'psi': 0.7360239190900718}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.728178 cos_to_last_merge=0.9460 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=44 local utility u=0.010594 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9988109781542138, 'loss_val': 0.03604533114885792, 'psi': 0.9952389626315132}-{'f1_val': 0.9901509125913737, 'auprc': 0.9990147971747373, 'loss_val': 0.04160522709205497, 'psi': 0.9936964664247191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=44 head_norm_before_train=2.058276 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9992539800009501, 'loss_val': 0.02245749852631489, 'psi': 0.9961976520240541}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992619613656792, 'loss_val': 0.017578320512758178, 'psi': 0.9979665320535573}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.824423 cos_to_last_merge=0.9469 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9950844653707556, 'loss_val': 0.03024806264011745, 'psi': 0.995014698067348}-{'f1_val': 0.9953830172083656, 'auprc': 0.995297984638735, 'loss_val': 0.029861064754354596, 'psi': 0.9953490041805133}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.575673 cos_to_last_merge=0.8654 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.865
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9607268157145251, 'auprc': 0.9983616200546986, 'loss_val': 0.10622551814199019, 'psi': 0.9757807374505945}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979837932273671, 'loss_val': 0.028519103337016908, 'psi': 0.9968737222389324}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.375112 cos_to_last_merge=0.8880 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.888
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.48793216815599005, 'auprc': 0.7136277507973318, 'loss_val': 1.1782368759418196, 'psi': 0.5782104012125268}-{'f1_val': 0.5706799412113107, 'auprc': 0.6861035123274299, 'loss_val': 0.9137596032081986, 'psi': 0.6168493696577584}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.089850 (no previous merge yet)
[S14] round=44 local utility u=0.003474 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9986705938752414, 'loss_val': 0.017886967605372655, 'psi': 0.9978127552042999}-{'f1_val': 0.9972435617623723, 'auprc': 0.9969684569998609, 'loss_val': 0.01974534677747246, 'psi': 0.9971335198573678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=44 head_norm_before_train=1.740781 cos_to_last_merge=0.9010 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.901
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9827134896686056, 'auprc': 0.9905837198843119, 'loss_val': 0.05388908439307085, 'psi': 0.9858615817548881}-{'f1_val': 0.989190031517727, 'auprc': 0.9958409392195546, 'loss_val': 0.06344413873864983, 'psi': 0.991850394598458}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.713800 cos_to_last_merge=0.8884 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.888
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9744781673359142, 'auprc': 0.9858778031453141, 'loss_val': 0.09755637834412136, 'psi': 0.9790380216596741}-{'f1_val': 0.9915714808080252, 'auprc': 0.9916155308999031, 'loss_val': 0.04616805087662694, 'psi': 0.9915891008447763}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.678280 cos_to_last_merge=0.7729 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6492270156604483, 'auprc': 0.8069055047040843, 'loss_val': 1.3819459883807446, 'psi': 0.7122984112779027}-{'f1_val': 0.6711998415528084, 'auprc': 0.8340777256598642, 'loss_val': 1.2474352720400501, 'psi': 0.7363509951956306}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.772454 cos_to_last_merge=0.9159 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.916
[S2] round=45 local utility u=0.109496 metrics={'f1_val': 0.7948762013962953, 'auprc': 0.8703763824301382, 'loss_val': 0.32852358693265116, 'psi': 0.8250762738098325}-{'f1_val': 0.812612434089467, 'auprc': 0.7908186040745069, 'loss_val': 0.4152606079147962, 'psi': 0.8038949020834829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=45 head_norm_before_train=1.840606 cos_to_last_merge=0.9543 (last merge round=16)
[S3] round=45 local utility u=0.402534 metrics={'f1_val': 0.9521504193795505, 'auprc': 0.992467806942915, 'loss_val': 0.10109085554975787, 'psi': 0.9682773744048963}-{'f1_val': 0.8587322928712289, 'auprc': 0.9644578874316166, 'loss_val': 0.26161971722746813, 'psi': 0.901022530695384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=45 head_norm_before_train=1.670870 cos_to_last_merge=0.9604 (last merge round=15)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9421146870816391, 'auprc': 0.9057514128456289, 'loss_val': 0.28360582572550624, 'psi': 0.9275693773872351}-{'f1_val': 0.9424732909673315, 'auprc': 0.9120618708067953, 'loss_val': 0.2806422625585626, 'psi': 0.9303087229031171}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.546547 cos_to_last_merge=0.7338 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.734
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.8764457240984327, 'loss_val': 0.3575956332729211, 'psi': 0.770822435467934}-{'f1_val': 0.7813306054317828, 'auprc': 0.9908063146119845, 'loss_val': 0.2053442068767139, 'psi': 0.8651208891038635}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.957997 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7515848368180373, 'auprc': 0.9670421487210592, 'loss_val': 0.5406363029280491, 'psi': 0.837767761579246}-{'f1_val': 0.7983157008290254, 'auprc': 0.9728615810186422, 'loss_val': 0.4610081458118694, 'psi': 0.8681340529048721}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.509212 cos_to_last_merge=0.9251 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.925
[S7] round=45 local utility u=1.000000 metrics={'f1_val': 0.6983532211463389, 'auprc': 0.9870537669075561, 'loss_val': 0.2391989159403681, 'psi': 0.8138334394508258}-{'f1_val': 0.49641930715965166, 'auprc': 0.7815480266192498, 'loss_val': 0.825588017716269, 'psi': 0.6104707949434909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=45 head_norm_before_train=1.733651 cos_to_last_merge=0.9467 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.97185681635182, 'auprc': 0.9931631499117048, 'loss_val': 0.09608594385204285, 'psi': 0.9803793497757739}-{'f1_val': 0.9928576189497129, 'auprc': 0.9988109781542138, 'loss_val': 0.03604533114885792, 'psi': 0.9952389626315132}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.062742 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9991892266790422, 'loss_val': 0.02511833444287545, 'psi': 0.9959209956654419}-{'f1_val': 0.9941601000394567, 'auprc': 0.9992539800009501, 'loss_val': 0.02245749852631489, 'psi': 0.9961976520240541}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.835946 cos_to_last_merge=0.9456 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=45 local utility u=0.001948 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9951735156766521, 'loss_val': 0.029107714206105632, 'psi': 0.9952992165956802}-{'f1_val': 0.9949681865317428, 'auprc': 0.9950844653707556, 'loss_val': 0.03024806264011745, 'psi': 0.995014698067348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=45 head_norm_before_train=1.587020 cos_to_last_merge=0.8641 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.864
[S11] round=45 local utility u=0.145298 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983280257495581, 'loss_val': 0.02797079414043218, 'psi': 0.9970114152478089}-{'f1_val': 0.9607268157145251, 'auprc': 0.9983616200546986, 'loss_val': 0.10622551814199019, 'psi': 0.9757807374505945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=45 head_norm_before_train=1.378463 cos_to_last_merge=0.8874 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=45 local utility u=0.594524 metrics={'f1_val': 0.6187136778637643, 'auprc': 0.6526425565878173, 'loss_val': 0.5909230836204958, 'psi': 0.6322852293533855}-{'f1_val': 0.48793216815599005, 'auprc': 0.7136277507973318, 'loss_val': 1.1782368759418196, 'psi': 0.5782104012125268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=45 head_norm_before_train=2.092263 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9742073853943496, 'auprc': 0.9983840963498567, 'loss_val': 0.05004478826291867, 'psi': 0.9838780697765523}-{'f1_val': 0.9972408627570057, 'auprc': 0.9986705938752414, 'loss_val': 0.017886967605372655, 'psi': 0.9978127552042999}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.749639 cos_to_last_merge=0.9001 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.900
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9090419640568022, 'loss_val': 0.5649764272284917, 'psi': 0.784166971924495}-{'f1_val': 0.9827134896686056, 'auprc': 0.9905837198843119, 'loss_val': 0.05388908439307085, 'psi': 0.9858615817548881}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.721303 cos_to_last_merge=0.8874 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.887
[S16] round=45 local utility u=0.031923 metrics={'f1_val': 0.9815849029265643, 'auprc': 0.9858071642390611, 'loss_val': 0.07613867736760109, 'psi': 0.983273807451563}-{'f1_val': 0.9744781673359142, 'auprc': 0.9858778031453141, 'loss_val': 0.09755637834412136, 'psi': 0.9790380216596741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=45 head_norm_before_train=1.691053 cos_to_last_merge=0.7724 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=45 local utility u=0.297924 metrics={'f1_val': 0.6701045796434378, 'auprc': 0.8469463545248977, 'loss_val': 1.0314867262413718, 'psi': 0.7408412895960219}-{'f1_val': 0.6492270156604483, 'auprc': 0.8069055047040843, 'loss_val': 1.3819459883807446, 'psi': 0.7122984112779027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=46 head_norm_before_train=1.779406 cos_to_last_merge=0.9149 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.915
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.8435257816848983, 'auprc': 0.7862314497214677, 'loss_val': 0.4084299100725447, 'psi': 0.8206080488995261}-{'f1_val': 0.7948762013962953, 'auprc': 0.8703763824301382, 'loss_val': 0.32852358693265116, 'psi': 0.8250762738098325}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.850708 cos_to_last_merge=0.9531 (last merge round=16)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9453608042583068, 'auprc': 0.9927142029616955, 'loss_val': 0.08866097633995597, 'psi': 0.9643021637396623}-{'f1_val': 0.9521504193795505, 'auprc': 0.992467806942915, 'loss_val': 0.10109085554975787, 'psi': 0.9682773744048963}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.680627 cos_to_last_merge=0.9594 (last merge round=15)
[S4] round=46 local utility u=0.059780 metrics={'f1_val': 0.9516068258973194, 'auprc': 0.9193672638344147, 'loss_val': 0.2618454193141428, 'psi': 0.9387110010721574}-{'f1_val': 0.9421146870816391, 'auprc': 0.9057514128456289, 'loss_val': 0.28360582572550624, 'psi': 0.9275693773872351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=46 head_norm_before_train=1.550607 cos_to_last_merge=0.7337 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.734
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.6792624465402939, 'auprc': 0.8690448671470976, 'loss_val': 0.38187935988360483, 'psi': 0.7551754147830154}-{'f1_val': 0.7004069097142683, 'auprc': 0.8764457240984327, 'loss_val': 0.3575956332729211, 'psi': 0.770822435467934}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.963624 (no previous merge yet)
[S6] round=46 local utility u=0.068854 metrics={'f1_val': 0.771677618626919, 'auprc': 0.9665938194864181, 'loss_val': 0.5221408634038298, 'psi': 0.8496440989707186}-{'f1_val': 0.7515848368180373, 'auprc': 0.9670421487210592, 'loss_val': 0.5406363029280491, 'psi': 0.837767761579246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=46 head_norm_before_train=1.517890 cos_to_last_merge=0.9237 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.924
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.45058351960849774, 'auprc': 0.7798419389937213, 'loss_val': 0.940927970959663, 'psi': 0.5822868873625873}-{'f1_val': 0.6983532211463389, 'auprc': 0.9870537669075561, 'loss_val': 0.2391989159403681, 'psi': 0.8138334394508258}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.739243 cos_to_last_merge=0.9466 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=46 local utility u=0.085566 metrics={'f1_val': 0.9939430167409706, 'auprc': 0.9893089311723086, 'loss_val': 0.045909457126799315, 'psi': 0.9920893825135058}-{'f1_val': 0.97185681635182, 'auprc': 0.9931631499117048, 'loss_val': 0.09608594385204285, 'psi': 0.9803793497757739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=46 head_norm_before_train=2.068978 (no previous merge yet)
[S9] round=46 local utility u=0.007821 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9962106629064347, 'loss_val': 0.018050772706151845, 'psi': 0.9964805722509087}-{'f1_val': 0.9937421749897083, 'auprc': 0.9991892266790422, 'loss_val': 0.02511833444287545, 'psi': 0.9959209956654419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=46 head_norm_before_train=1.846860 cos_to_last_merge=0.9445 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.994833126225598, 'loss_val': 0.03017505261363056, 'psi': 0.994914162409285}-{'f1_val': 0.9953830172083656, 'auprc': 0.9951735156766521, 'loss_val': 0.029107714206105632, 'psi': 0.9952992165956802}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.597553 cos_to_last_merge=0.8628 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.863
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9847087461000107, 'auprc': 0.9981108373480108, 'loss_val': 0.06332887056904833, 'psi': 0.9900695825992107}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983280257495581, 'loss_val': 0.02797079414043218, 'psi': 0.9970114152478089}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.380492 cos_to_last_merge=0.8868 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5214887065661234, 'auprc': 0.6931860302599431, 'loss_val': 0.9374206766777183, 'psi': 0.5901676360436513}-{'f1_val': 0.6187136778637643, 'auprc': 0.6526425565878173, 'loss_val': 0.5909230836204958, 'psi': 0.6322852293533855}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.097315 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9309449162082212, 'auprc': 0.9982965910314509, 'loss_val': 0.11869806821403246, 'psi': 0.9578855861375131}-{'f1_val': 0.9742073853943496, 'auprc': 0.9983840963498567, 'loss_val': 0.05004478826291867, 'psi': 0.9838780697765523}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.759514 cos_to_last_merge=0.8991 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.899
[S15] round=46 local utility u=0.352115 metrics={'f1_val': 0.7782313208563422, 'auprc': 0.9356622491083084, 'loss_val': 0.4044936556307252, 'psi': 0.8412036921571286}-{'f1_val': 0.7009169771696235, 'auprc': 0.9090419640568022, 'loss_val': 0.5649764272284917, 'psi': 0.784166971924495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=46 head_norm_before_train=1.730485 cos_to_last_merge=0.8863 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.886
[S16] round=46 local utility u=0.052610 metrics={'f1_val': 0.9915375600034773, 'auprc': 0.9911300552865463, 'loss_val': 0.04660246569650934, 'psi': 0.9913745581167048}-{'f1_val': 0.9815849029265643, 'auprc': 0.9858071642390611, 'loss_val': 0.07613867736760109, 'psi': 0.983273807451563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S16] sending update (kind=head size=1810 to 1 peers)
[S17] START round=46 head_norm_before_train=1.704975 cos_to_last_merge=0.7719 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6515424978327201, 'auprc': 0.8125210777641768, 'loss_val': 1.376930542995763, 'psi': 0.7159339298053028}-{'f1_val': 0.6701045796434378, 'auprc': 0.8469463545248977, 'loss_val': 1.0314867262413718, 'psi': 0.7408412895960219}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.786906 cos_to_last_merge=0.9138 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.914
[S2] round=47 local utility u=0.113132 metrics={'f1_val': 0.8263287868016128, 'auprc': 0.8688068747062277, 'loss_val': 0.32671069731770475, 'psi': 0.8433200219634588}-{'f1_val': 0.8435257816848983, 'auprc': 0.7862314497214677, 'loss_val': 0.4084299100725447, 'psi': 0.8206080488995261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=47 head_norm_before_train=1.862008 cos_to_last_merge=0.9516 (last merge round=16)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.8824668409920375, 'auprc': 0.9784079587247662, 'loss_val': 0.2082137405890899, 'psi': 0.920843288085129}-{'f1_val': 0.9453608042583068, 'auprc': 0.9927142029616955, 'loss_val': 0.08866097633995597, 'psi': 0.9643021637396623}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.689577 cos_to_last_merge=0.9585 (last merge round=15)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9455690647192915, 'auprc': 0.9054622473211373, 'loss_val': 0.27786551730529513, 'psi': 0.9295263377600298}-{'f1_val': 0.9516068258973194, 'auprc': 0.9193672638344147, 'loss_val': 0.2618454193141428, 'psi': 0.9387110010721574}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.555439 cos_to_last_merge=0.7336 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.734
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.6317476504444002, 'auprc': 0.8889914442755507, 'loss_val': 0.47384845812641285, 'psi': 0.7346451679768604}-{'f1_val': 0.6792624465402939, 'auprc': 0.8690448671470976, 'loss_val': 0.38187935988360483, 'psi': 0.7551754147830154}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.967511 (no previous merge yet)
[S6] round=47 local utility u=0.439876 metrics={'f1_val': 0.8826904056078106, 'auprc': 0.9641510405312699, 'loss_val': 0.30113824313576376, 'psi': 0.9152746595771943}-{'f1_val': 0.771677618626919, 'auprc': 0.9665938194864181, 'loss_val': 0.5221408634038298, 'psi': 0.8496440989707186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=47 head_norm_before_train=1.522937 cos_to_last_merge=0.9228 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=47 local utility u=1.000000 metrics={'f1_val': 0.6830238859258473, 'auprc': 0.8841699302977204, 'loss_val': 0.3208895120171579, 'psi': 0.7634823036745966}-{'f1_val': 0.45058351960849774, 'auprc': 0.7798419389937213, 'loss_val': 0.940927970959663, 'psi': 0.5822868873625873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=47 head_norm_before_train=1.746769 cos_to_last_merge=0.9462 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9355097601432653, 'auprc': 0.9990179856465891, 'loss_val': 0.16160432549640852, 'psi': 0.9609130503445948}-{'f1_val': 0.9939430167409706, 'auprc': 0.9893089311723086, 'loss_val': 0.045909457126799315, 'psi': 0.9920893825135058}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.075672 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9991819583162255, 'loss_val': 0.02982624718619798, 'psi': 0.9940039065350861}-{'f1_val': 0.9966605118138915, 'auprc': 0.9962106629064347, 'loss_val': 0.018050772706151845, 'psi': 0.9964805722509087}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.854379 cos_to_last_merge=0.9437 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=47 local utility u=0.002381 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9948524413366333, 'loss_val': 0.02795972288269407, 'psi': 0.9951707868596726}-{'f1_val': 0.9949681865317428, 'auprc': 0.994833126225598, 'loss_val': 0.03017505261363056, 'psi': 0.994914162409285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=47 head_norm_before_train=1.606228 cos_to_last_merge=0.8617 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.862
[S11] round=47 local utility u=0.051477 metrics={'f1_val': 0.9963070332985724, 'auprc': 0.9979881833755396, 'loss_val': 0.029595704031879444, 'psi': 0.9969794933293593}-{'f1_val': 0.9847087461000107, 'auprc': 0.9981108373480108, 'loss_val': 0.06332887056904833, 'psi': 0.9900695825992107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=47 head_norm_before_train=1.381832 cos_to_last_merge=0.8866 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=47 local utility u=0.043143 metrics={'f1_val': 0.5273898465176959, 'auprc': 0.6932009125058765, 'loss_val': 0.8865857660812889, 'psi': 0.5937142729129681}-{'f1_val': 0.5214887065661234, 'auprc': 0.6931860302599431, 'loss_val': 0.9374206766777183, 'psi': 0.5901676360436513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=47 head_norm_before_train=2.105623 (no previous merge yet)
[S14] round=47 local utility u=0.252179 metrics={'f1_val': 0.9979369915016262, 'auprc': 0.9986704261385183, 'loss_val': 0.01741398937462494, 'psi': 0.9982303653563831}-{'f1_val': 0.9309449162082212, 'auprc': 0.9982965910314509, 'loss_val': 0.11869806821403246, 'psi': 0.9578855861375131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=47 head_norm_before_train=1.767939 cos_to_last_merge=0.8982 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.898
[S15] round=47 local utility u=0.641611 metrics={'f1_val': 0.9174975636216534, 'auprc': 0.9906013889848946, 'loss_val': 0.12168615549420346, 'psi': 0.9467390937669499}-{'f1_val': 0.7782313208563422, 'auprc': 0.9356622491083084, 'loss_val': 0.4044936556307252, 'psi': 0.8412036921571286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=47 head_norm_before_train=1.738949 cos_to_last_merge=0.8853 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.885
[S16] round=47 local utility u=0.004625 metrics={'f1_val': 0.9915517817591216, 'auprc': 0.9934240091977309, 'loss_val': 0.044318955768927124, 'psi': 0.9923006727345653}-{'f1_val': 0.9915375600034773, 'auprc': 0.9911300552865463, 'loss_val': 0.04660246569650934, 'psi': 0.9913745581167048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=47 head_norm_before_train=1.717766 cos_to_last_merge=0.7715 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=47 local utility u=0.229360 metrics={'f1_val': 0.672587450470001, 'auprc': 0.8606754061819044, 'loss_val': 1.1889440271832086, 'psi': 0.7478226327547624}-{'f1_val': 0.6515424978327201, 'auprc': 0.8125210777641768, 'loss_val': 1.376930542995763, 'psi': 0.7159339298053028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=48 head_norm_before_train=1.793724 cos_to_last_merge=0.9129 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.913
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.831192505431521, 'auprc': 0.782858238722011, 'loss_val': 0.31607354871683363, 'psi': 0.811858798747717}-{'f1_val': 0.8263287868016128, 'auprc': 0.8688068747062277, 'loss_val': 0.32671069731770475, 'psi': 0.8433200219634588}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.873894 cos_to_last_merge=0.9502 (last merge round=16)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.830986310714936, 'auprc': 0.9760216322344807, 'loss_val': 0.30357724554835985, 'psi': 0.8890004393227539}-{'f1_val': 0.8824668409920375, 'auprc': 0.9784079587247662, 'loss_val': 0.2082137405890899, 'psi': 0.920843288085129}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.692734 cos_to_last_merge=0.9581 (last merge round=15)
[S4] round=48 local utility u=0.031548 metrics={'f1_val': 0.9494107688467548, 'auprc': 0.9151885846149447, 'loss_val': 0.26699928496399605, 'psi': 0.9357218951540307}-{'f1_val': 0.9455690647192915, 'auprc': 0.9054622473211373, 'loss_val': 0.27786551730529513, 'psi': 0.9295263377600298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=48 head_norm_before_train=1.562315 cos_to_last_merge=0.7326 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.733
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.5333229092435823, 'auprc': 0.8583922368220286, 'loss_val': 0.7119074671493049, 'psi': 0.6633506402749608}-{'f1_val': 0.6317476504444002, 'auprc': 0.8889914442755507, 'loss_val': 0.47384845812641285, 'psi': 0.7346451679768604}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.973583 (no previous merge yet)
[S6] round=48 local utility u=0.016957 metrics={'f1_val': 0.8760896705006662, 'auprc': 0.9660842598102564, 'loss_val': 0.23341916420609618, 'psi': 0.9120875062245023}-{'f1_val': 0.8826904056078106, 'auprc': 0.9641510405312699, 'loss_val': 0.30113824313576376, 'psi': 0.9152746595771943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=48 head_norm_before_train=1.529500 cos_to_last_merge=0.9217 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.4862928734308579, 'auprc': 0.7805909044945256, 'loss_val': 0.878022393984316, 'psi': 0.604012085856325}-{'f1_val': 0.6830238859258473, 'auprc': 0.8841699302977204, 'loss_val': 0.3208895120171579, 'psi': 0.7634823036745966}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.754444 cos_to_last_merge=0.9458 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=48 local utility u=0.237413 metrics={'f1_val': 0.9939539858461368, 'auprc': 0.9980791054851988, 'loss_val': 0.034626835778881586, 'psi': 0.9956040337017616}-{'f1_val': 0.9355097601432653, 'auprc': 0.9990179856465891, 'loss_val': 0.16160432549640852, 'psi': 0.9609130503445948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=48 head_norm_before_train=2.079996 (no previous merge yet)
[S9] round=48 local utility u=0.024720 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995238888465547, 'loss_val': 0.018064462338199954, 'psi': 0.9978058626269568}-{'f1_val': 0.9905518720143266, 'auprc': 0.9991819583162255, 'loss_val': 0.02982624718619798, 'psi': 0.9940039065350861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=48 head_norm_before_train=1.863207 cos_to_last_merge=0.9428 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9948127041345141, 'loss_val': 0.028328197460509127, 'psi': 0.9951548919788249}-{'f1_val': 0.9953830172083656, 'auprc': 0.9948524413366333, 'loss_val': 0.02795972288269407, 'psi': 0.9951707868596726}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.616210 cos_to_last_merge=0.8606 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.861
[S11] round=48 local utility u=0.000870 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979826435238922, 'loss_val': 0.029278550291089122, 'psi': 0.9971212601177106}-{'f1_val': 0.9963070332985724, 'auprc': 0.9979881833755396, 'loss_val': 0.029595704031879444, 'psi': 0.9969794933293593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=48 head_norm_before_train=1.385221 cos_to_last_merge=0.8866 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=48 local utility u=0.229967 metrics={'f1_val': 0.5925209537099336, 'auprc': 0.6887150751275495, 'loss_val': 0.8039799846254962, 'psi': 0.63099860227698}-{'f1_val': 0.5273898465176959, 'auprc': 0.6932009125058765, 'loss_val': 0.8865857660812889, 'psi': 0.5937142729129681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=48 head_norm_before_train=2.110925 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.997284015000207, 'auprc': 0.9986602352944239, 'loss_val': 0.018203878822384213, 'psi': 0.9978345031178938}-{'f1_val': 0.9979369915016262, 'auprc': 0.9986704261385183, 'loss_val': 0.01741398937462494, 'psi': 0.9982303653563831}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.775958 cos_to_last_merge=0.8973 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.897
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7692443267672796, 'auprc': 0.9160612917135622, 'loss_val': 0.4413809271643424, 'psi': 0.8279711127457927}-{'f1_val': 0.9174975636216534, 'auprc': 0.9906013889848946, 'loss_val': 0.12168615549420346, 'psi': 0.9467390937669499}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.748416 cos_to_last_merge=0.8843 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.884
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9924322689120962, 'auprc': 0.9898603194058332, 'loss_val': 0.04347455829302542, 'psi': 0.9914034891095911}-{'f1_val': 0.9915517817591216, 'auprc': 0.9934240091977309, 'loss_val': 0.044318955768927124, 'psi': 0.9923006727345653}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.725326 cos_to_last_merge=0.7713 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6642232053858748, 'auprc': 0.8479599956630197, 'loss_val': 1.2639036180998757, 'psi': 0.7377179214967328}-{'f1_val': 0.672587450470001, 'auprc': 0.8606754061819044, 'loss_val': 1.1889440271832086, 'psi': 0.7478226327547624}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.799782 cos_to_last_merge=0.9120 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.912
[S2] round=49 local utility u=0.119552 metrics={'f1_val': 0.8289326750798718, 'auprc': 0.8709345546487692, 'loss_val': 0.32763998763366187, 'psi': 0.8457334269074308}-{'f1_val': 0.831192505431521, 'auprc': 0.782858238722011, 'loss_val': 0.31607354871683363, 'psi': 0.811858798747717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=49 head_norm_before_train=1.886069 cos_to_last_merge=0.9487 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.6857483994570548, 'auprc': 0.9628479242456208, 'loss_val': 0.6703929782326945, 'psi': 0.7965882093724812}-{'f1_val': 0.830986310714936, 'auprc': 0.9760216322344807, 'loss_val': 0.30357724554835985, 'psi': 0.8890004393227539}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.695282 cos_to_last_merge=0.9577 (last merge round=15)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.7188046236385791, 'auprc': 0.8777807199143668, 'loss_val': 0.502558633842711, 'psi': 0.7823950621488942}-{'f1_val': 0.9494107688467548, 'auprc': 0.9151885846149447, 'loss_val': 0.26699928496399605, 'psi': 0.9357218951540307}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.570642 cos_to_last_merge=0.7316 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.732
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.4337622668464802, 'auprc': 0.85541901330237, 'loss_val': 1.087722932824205, 'psi': 0.6024249654288362}-{'f1_val': 0.5333229092435823, 'auprc': 0.8583922368220286, 'loss_val': 0.7119074671493049, 'psi': 0.6633506402749608}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.982472 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6851245290323525, 'auprc': 0.9392349987968428, 'loss_val': 0.7256105909457643, 'psi': 0.7867687169381488}-{'f1_val': 0.8760896705006662, 'auprc': 0.9660842598102564, 'loss_val': 0.23341916420609618, 'psi': 0.9120875062245023}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.536062 cos_to_last_merge=0.9206 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=49 local utility u=0.572361 metrics={'f1_val': 0.6247406625422242, 'auprc': 0.7962583543111252, 'loss_val': 0.6109885679904261, 'psi': 0.6933477392497847}-{'f1_val': 0.4862928734308579, 'auprc': 0.7805909044945256, 'loss_val': 0.878022393984316, 'psi': 0.604012085856325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=49 head_norm_before_train=1.757765 cos_to_last_merge=0.9461 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9925028268365944, 'auprc': 0.9988352371547325, 'loss_val': 0.035800179613468396, 'psi': 0.9950357909638496}-{'f1_val': 0.9939539858461368, 'auprc': 0.9980791054851988, 'loss_val': 0.034626835778881586, 'psi': 0.9956040337017616}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.082790 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9916350289240425, 'auprc': 0.9991721926854253, 'loss_val': 0.027921391684644657, 'psi': 0.9946498944285957}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995238888465547, 'loss_val': 0.018064462338199954, 'psi': 0.9978058626269568}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.872730 cos_to_last_merge=0.9417 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9948704767609831, 'loss_val': 0.028349390264521813, 'psi': 0.9949291026234389}-{'f1_val': 0.9953830172083656, 'auprc': 0.9948127041345141, 'loss_val': 0.028328197460509127, 'psi': 0.9951548919788249}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.627201 cos_to_last_merge=0.8594 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.859
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9958258415514141, 'auprc': 0.9979878390561561, 'loss_val': 0.029264388280237204, 'psi': 0.9966906405533109}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979826435238922, 'loss_val': 0.029278550291089122, 'psi': 0.9971212601177106}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.391130 cos_to_last_merge=0.8861 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5313115167308816, 'auprc': 0.6930340594175967, 'loss_val': 0.8476398756535394, 'psi': 0.5960005338055676}-{'f1_val': 0.5925209537099336, 'auprc': 0.6887150751275495, 'loss_val': 0.8039799846254962, 'psi': 0.63099860227698}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.115673 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9872488504074722, 'auprc': 0.9984749586663412, 'loss_val': 0.0482006878961283, 'psi': 0.9917392937110199}-{'f1_val': 0.997284015000207, 'auprc': 0.9986602352944239, 'loss_val': 0.018203878822384213, 'psi': 0.9978345031178938}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.786225 cos_to_last_merge=0.8961 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.896
[S15] round=49 local utility u=0.791210 metrics={'f1_val': 0.9377316593775871, 'auprc': 0.9894736593693865, 'loss_val': 0.09012164473129525, 'psi': 0.9584284593743068}-{'f1_val': 0.7692443267672796, 'auprc': 0.9160612917135622, 'loss_val': 0.4413809271643424, 'psi': 0.8279711127457927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=49 head_norm_before_train=1.758085 cos_to_last_merge=0.8831 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.883
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.991990432657946, 'auprc': 0.9904835659761263, 'loss_val': 0.042926678148684796, 'psi': 0.9913876859852181}-{'f1_val': 0.9924322689120962, 'auprc': 0.9898603194058332, 'loss_val': 0.04347455829302542, 'psi': 0.9914034891095911}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.733100 cos_to_last_merge=0.7710 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6587126253877095, 'auprc': 0.8320741773648752, 'loss_val': 1.3030991193215415, 'psi': 0.7280572461785758}-{'f1_val': 0.6642232053858748, 'auprc': 0.8479599956630197, 'loss_val': 1.2639036180998757, 'psi': 0.7377179214967328}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=1.806048 cos_to_last_merge=0.9110 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.911
[S2] round=50 local utility u=0.019217 metrics={'f1_val': 0.831250044092421, 'auprc': 0.8772645853717471, 'loss_val': 0.3221002905185314, 'psi': 0.8496558606041514}-{'f1_val': 0.8289326750798718, 'auprc': 0.8709345546487692, 'loss_val': 0.32763998763366187, 'psi': 0.8457334269074308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=50 head_norm_before_train=1.898927 cos_to_last_merge=0.9472 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.947
[S3] round=50 local utility u=0.138155 metrics={'f1_val': 0.7150723396261858, 'auprc': 0.9730922546202259, 'loss_val': 0.6007603313382076, 'psi': 0.8182803056238017}-{'f1_val': 0.6857483994570548, 'auprc': 0.9628479242456208, 'loss_val': 0.6703929782326945, 'psi': 0.7965882093724812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=50 head_norm_before_train=1.701097 cos_to_last_merge=0.9570 (last merge round=15)
[S4] round=50 local utility u=0.865129 metrics={'f1_val': 0.9456853745345891, 'auprc': 0.9252599860772776, 'loss_val': 0.276023303567972, 'psi': 0.9375152191516645}-{'f1_val': 0.7188046236385791, 'auprc': 0.8777807199143668, 'loss_val': 0.502558633842711, 'psi': 0.7823950621488942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=50 head_norm_before_train=1.577255 cos_to_last_merge=0.7311 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.731
[S5] round=50 local utility u=1.000000 metrics={'f1_val': 0.9516252656566997, 'auprc': 0.9970522005613455, 'loss_val': 0.13318647349756982, 'psi': 0.969796039618558}-{'f1_val': 0.4337622668464802, 'auprc': 0.85541901330237, 'loss_val': 1.087722932824205, 'psi': 0.6024249654288362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=50 head_norm_before_train=1.992381 (no previous merge yet)
[S6] round=50 local utility u=0.549077 metrics={'f1_val': 0.8257649816327737, 'auprc': 0.9565693019556138, 'loss_val': 0.5233014952823257, 'psi': 0.8780867097619097}-{'f1_val': 0.6851245290323525, 'auprc': 0.9392349987968428, 'loss_val': 0.7256105909457643, 'psi': 0.7867687169381488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=50 head_norm_before_train=1.546523 cos_to_last_merge=0.9188 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.919
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.5002088912372855, 'auprc': 0.7817879697090726, 'loss_val': 0.9456069436910822, 'psi': 0.6128405226260003}-{'f1_val': 0.6247406625422242, 'auprc': 0.7962583543111252, 'loss_val': 0.6109885679904261, 'psi': 0.6933477392497847}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=1.762256 cos_to_last_merge=0.9458 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.9895694841884839, 'auprc': 0.9989382968898651, 'loss_val': 0.038866704461223145, 'psi': 0.9933170092690364}-{'f1_val': 0.9925028268365944, 'auprc': 0.9988352371547325, 'loss_val': 0.035800179613468396, 'psi': 0.9950357909638496}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=50 head_norm_before_train=2.086394 (no previous merge yet)
[S9] round=50 local utility u=0.017608 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9991949076956613, 'loss_val': 0.017924436621890583, 'psi': 0.9971739940967758}-{'f1_val': 0.9916350289240425, 'auprc': 0.9991721926854253, 'loss_val': 0.027921391684644657, 'psi': 0.9946498944285957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=50 head_norm_before_train=1.881975 cos_to_last_merge=0.9408 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=50 local utility u=0.001761 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9947882854699877, 'loss_val': 0.027069481767733224, 'psi': 0.9951451245130144}-{'f1_val': 0.9949681865317428, 'auprc': 0.9948704767609831, 'loss_val': 0.028349390264521813, 'psi': 0.9949291026234389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=50 head_norm_before_train=1.637981 cos_to_last_merge=0.8583 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.858
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9765317867335863, 'auprc': 0.9981036978897118, 'loss_val': 0.08349396771850885, 'psi': 0.9851605511960365}-{'f1_val': 0.9958258415514141, 'auprc': 0.9979878390561561, 'loss_val': 0.029264388280237204, 'psi': 0.9966906405533109}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.397283 cos_to_last_merge=0.8847 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=50 local utility u=0.313826 metrics={'f1_val': 0.6058100486027609, 'auprc': 0.6816919661709812, 'loss_val': 0.6329528818860847, 'psi': 0.636162815630049}-{'f1_val': 0.5313115167308816, 'auprc': 0.6930340594175967, 'loss_val': 0.8476398756535394, 'psi': 0.5960005338055676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=50 head_norm_before_train=2.120801 (no previous merge yet)
[S14] round=50 local utility u=0.039259 metrics={'f1_val': 0.9968737381593904, 'auprc': 0.9968529484587759, 'loss_val': 0.022565457573956397, 'psi': 0.9968654222791447}-{'f1_val': 0.9872488504074722, 'auprc': 0.9984749586663412, 'loss_val': 0.0482006878961283, 'psi': 0.9917392937110199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=50 head_norm_before_train=1.794607 cos_to_last_merge=0.8950 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.895
[S15] round=50 local utility u=0.211252 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9932341191977856, 'loss_val': 0.027922374299694352, 'psi': 0.994834958887305}-{'f1_val': 0.9377316593775871, 'auprc': 0.9894736593693865, 'loss_val': 0.09012164473129525, 'psi': 0.9584284593743068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=50 head_norm_before_train=1.765984 cos_to_last_merge=0.8822 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.882
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.9783211371583, 'auprc': 0.9860197179285447, 'loss_val': 0.0826944092241014, 'psi': 0.9814005694663979}-{'f1_val': 0.991990432657946, 'auprc': 0.9904835659761263, 'loss_val': 0.042926678148684796, 'psi': 0.9913876859852181}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.741648 cos_to_last_merge=0.7704 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=50 local utility u=0.764118 metrics={'f1_val': 0.7908128523128203, 'auprc': 0.8911527768612884, 'loss_val': 0.7446996224890728, 'psi': 0.8309488221322074}-{'f1_val': 0.6587126253877095, 'auprc': 0.8320741773648752, 'loss_val': 1.3030991193215415, 'psi': 0.7280572461785758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=51 head_norm_before_train=1.811584 cos_to_last_merge=0.9102 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.910
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.7786985821043906, 'auprc': 0.8895258543701763, 'loss_val': 0.35967960263641113, 'psi': 0.8230294910107048}-{'f1_val': 0.831250044092421, 'auprc': 0.8772645853717471, 'loss_val': 0.3221002905185314, 'psi': 0.8496558606041514}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=1.912203 cos_to_last_merge=0.9457 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=51 local utility u=0.128228 metrics={'f1_val': 0.7511804284461213, 'auprc': 0.9580068652776709, 'loss_val': 0.5156966164196375, 'psi': 0.8339110031787411}-{'f1_val': 0.7150723396261858, 'auprc': 0.9730922546202259, 'loss_val': 0.6007603313382076, 'psi': 0.8182803056238017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=51 head_norm_before_train=1.705398 cos_to_last_merge=0.9563 (last merge round=15)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9531510092759642, 'auprc': 0.9052020343710006, 'loss_val': 0.2674832207639027, 'psi': 0.9339714193139788}-{'f1_val': 0.9456853745345891, 'auprc': 0.9252599860772776, 'loss_val': 0.276023303567972, 'psi': 0.9375152191516645}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.582733 cos_to_last_merge=0.7307 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.731
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.42560472379982545, 'auprc': 0.8276733993151296, 'loss_val': 1.246737422429394, 'psi': 0.5864321940059471}-{'f1_val': 0.9516252656566997, 'auprc': 0.9970522005613455, 'loss_val': 0.13318647349756982, 'psi': 0.969796039618558}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=2.000413 (no previous merge yet)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.6625588374059254, 'auprc': 0.8805423104152938, 'loss_val': 0.8572916852212307, 'psi': 0.7497522266096728}-{'f1_val': 0.8257649816327737, 'auprc': 0.9565693019556138, 'loss_val': 0.5233014952823257, 'psi': 0.8780867097619097}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.554571 cos_to_last_merge=0.9175 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.918
[S7] round=51 local utility u=0.961571 metrics={'f1_val': 0.6813707192191916, 'auprc': 0.8550074593472058, 'loss_val': 0.3290949162805239, 'psi': 0.7508254152703973}-{'f1_val': 0.5002088912372855, 'auprc': 0.7817879697090726, 'loss_val': 0.9456069436910822, 'psi': 0.6128405226260003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=51 head_norm_before_train=1.769582 cos_to_last_merge=0.9451 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9933434229799246, 'auprc': 0.9856435281437979, 'loss_val': 0.04012447710926222, 'psi': 0.990263465045474}-{'f1_val': 0.9895694841884839, 'auprc': 0.9989382968898651, 'loss_val': 0.038866704461223145, 'psi': 0.9933170092690364}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=2.090880 (no previous merge yet)
[S9] round=51 local utility u=0.000168 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9964115767227366, 'loss_val': 0.016895929902997996, 'psi': 0.9968263781963803}-{'f1_val': 0.9958267183641853, 'auprc': 0.9991949076956613, 'loss_val': 0.017924436621890583, 'psi': 0.9971739940967758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=51 head_norm_before_train=1.889230 cos_to_last_merge=0.9401 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9948676019460827, 'loss_val': 0.027669721894964264, 'psi': 0.9951768511034524}-{'f1_val': 0.9953830172083656, 'auprc': 0.9947882854699877, 'loss_val': 0.027069481767733224, 'psi': 0.9951451245130144}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=1.648610 cos_to_last_merge=0.8571 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.857
[S11] round=51 local utility u=0.076904 metrics={'f1_val': 0.9935108478447253, 'auprc': 0.9980688267872375, 'loss_val': 0.03145545817189693, 'psi': 0.9953340394217302}-{'f1_val': 0.9765317867335863, 'auprc': 0.9981036978897118, 'loss_val': 0.08349396771850885, 'psi': 0.9851605511960365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=51 head_norm_before_train=1.404739 cos_to_last_merge=0.8833 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.5324105022138284, 'auprc': 0.6908630222887647, 'loss_val': 0.8856196305354642, 'psi': 0.595791510243803}-{'f1_val': 0.6058100486027609, 'auprc': 0.6816919661709812, 'loss_val': 0.6329528818860847, 'psi': 0.636162815630049}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=2.124586 (no previous merge yet)
[S14] round=51 local utility u=0.004607 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9969709418733139, 'loss_val': 0.018372081387885777, 'psi': 0.9973793512099653}-{'f1_val': 0.9968737381593904, 'auprc': 0.9968529484587759, 'loss_val': 0.022565457573956397, 'psi': 0.9968654222791447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=51 head_norm_before_train=1.801881 cos_to_last_merge=0.8944 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.894
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.7002178920523103, 'auprc': 0.852681303450366, 'loss_val': 0.5893009386762348, 'psi': 0.7612032566115325}-{'f1_val': 0.9959021853469847, 'auprc': 0.9932341191977856, 'loss_val': 0.027922374299694352, 'psi': 0.994834958887305}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.772465 cos_to_last_merge=0.8813 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.881
[S16] round=51 local utility u=0.048803 metrics={'f1_val': 0.9895661497349806, 'auprc': 0.9870607366953392, 'loss_val': 0.05568194320854433, 'psi': 0.9885639845191241}-{'f1_val': 0.9783211371583, 'auprc': 0.9860197179285447, 'loss_val': 0.0826944092241014, 'psi': 0.9814005694663979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=51 head_norm_before_train=1.752020 cos_to_last_merge=0.7697 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.6595905825001405, 'auprc': 0.8333609593759128, 'loss_val': 1.336610260985425, 'psi': 0.7290987332504494}-{'f1_val': 0.7908128523128203, 'auprc': 0.8911527768612884, 'loss_val': 0.7446996224890728, 'psi': 0.8309488221322074}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=52 head_norm_before_train=1.817429 cos_to_last_merge=0.9094 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.909
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.804930422564858, 'auprc': 0.7651245342309031, 'loss_val': 0.3977234649293886, 'psi': 0.789008067231276}-{'f1_val': 0.7786985821043906, 'auprc': 0.8895258543701763, 'loss_val': 0.35967960263641113, 'psi': 0.8230294910107048}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=1.921667 cos_to_last_merge=0.9446 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=52 local utility u=0.221476 metrics={'f1_val': 0.794795189041876, 'auprc': 0.9737363442139443, 'loss_val': 0.38162107675123436, 'psi': 0.8663716511107034}-{'f1_val': 0.7511804284461213, 'auprc': 0.9580068652776709, 'loss_val': 0.5156966164196375, 'psi': 0.8339110031787411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=52 head_norm_before_train=1.709256 cos_to_last_merge=0.9558 (last merge round=15)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9551815804910354, 'auprc': 0.8972864966050973, 'loss_val': 0.27026081842687705, 'psi': 0.9320235469366602}-{'f1_val': 0.9531510092759642, 'auprc': 0.9052020343710006, 'loss_val': 0.2674832207639027, 'psi': 0.9339714193139788}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.587342 cos_to_last_merge=0.7304 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.730
[S5] round=52 local utility u=1.000000 metrics={'f1_val': 0.7804707303943926, 'auprc': 0.993352393576116, 'loss_val': 0.17321142072530246, 'psi': 0.865623395667082}-{'f1_val': 0.42560472379982545, 'auprc': 0.8276733993151296, 'loss_val': 1.246737422429394, 'psi': 0.5864321940059471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=52 head_norm_before_train=2.012231 (no previous merge yet)
[S6] round=52 local utility u=1.000000 metrics={'f1_val': 0.8991414192135871, 'auprc': 0.9843018757988915, 'loss_val': 0.18454636927561022, 'psi': 0.9332056018477088}-{'f1_val': 0.6625588374059254, 'auprc': 0.8805423104152938, 'loss_val': 0.8572916852212307, 'psi': 0.7497522266096728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=52 head_norm_before_train=1.562637 cos_to_last_merge=0.9161 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.5812366230811016, 'auprc': 0.7850703718873058, 'loss_val': 0.786443367271316, 'psi': 0.6627701226035834}-{'f1_val': 0.6813707192191916, 'auprc': 0.8550074593472058, 'loss_val': 0.3290949162805239, 'psi': 0.7508254152703973}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=52 head_norm_before_train=1.775488 cos_to_last_merge=0.9440 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=52 local utility u=0.018902 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9991415945399171, 'loss_val': 0.03533815912307853, 'psi': 0.994915022034986}-{'f1_val': 0.9933434229799246, 'auprc': 0.9856435281437979, 'loss_val': 0.04012447710926222, 'psi': 0.990263465045474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] sending update (kind=head size=1809 to 1 peers)
[S9] START round=52 head_norm_before_train=2.096138 (no previous merge yet)
[S9] round=52 local utility u=0.003134 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9992683180273536, 'loss_val': 0.016714733785166504, 'psi': 0.9977208161896446}-{'f1_val': 0.9971029125121428, 'auprc': 0.9964115767227366, 'loss_val': 0.016895929902997996, 'psi': 0.9968263781963803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=52 head_norm_before_train=1.895927 cos_to_last_merge=0.9394 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=52 local utility u=0.000338 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9948718922229941, 'loss_val': 0.02700633331724769, 'psi': 0.995178567214217}-{'f1_val': 0.9953830172083656, 'auprc': 0.9948676019460827, 'loss_val': 0.027669721894964264, 'psi': 0.9951768511034524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=52 head_norm_before_train=1.659227 cos_to_last_merge=0.8560 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.856
[S11] round=52 local utility u=0.012148 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9980157027318345, 'loss_val': 0.025363118850428298, 'psi': 0.9971490299600085}-{'f1_val': 0.9935108478447253, 'auprc': 0.9980688267872375, 'loss_val': 0.03145545817189693, 'psi': 0.9953340394217302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=52 head_norm_before_train=1.411397 cos_to_last_merge=0.8823 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.882
[S13] round=52 local utility u=0.190168 metrics={'f1_val': 0.5892478550315086, 'auprc': 0.6896829009516897, 'loss_val': 0.8427675633882934, 'psi': 0.629421873399581}-{'f1_val': 0.5324105022138284, 'auprc': 0.6908630222887647, 'loss_val': 0.8856196305354642, 'psi': 0.595791510243803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=52 head_norm_before_train=2.127045 (no previous merge yet)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9380925589464411, 'auprc': 0.9986669087343953, 'loss_val': 0.09853519288470147, 'psi': 0.9623222988616227}-{'f1_val': 0.9976516241010662, 'auprc': 0.9969709418733139, 'loss_val': 0.018372081387885777, 'psi': 0.9973793512099653}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=1.807804 cos_to_last_merge=0.8939 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.894
[S15] round=52 local utility u=0.613038 metrics={'f1_val': 0.8142001993556339, 'auprc': 0.9692565399651457, 'loss_val': 0.39684459351878054, 'psi': 0.8762227355994386}-{'f1_val': 0.7002178920523103, 'auprc': 0.852681303450366, 'loss_val': 0.5893009386762348, 'psi': 0.7612032566115325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=52 head_norm_before_train=1.778968 cos_to_last_merge=0.8806 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.881
[S16] round=52 local utility u=0.015391 metrics={'f1_val': 0.991726697920398, 'auprc': 0.9889218453195632, 'loss_val': 0.043446071157078325, 'psi': 0.990604756880064}-{'f1_val': 0.9895661497349806, 'auprc': 0.9870607366953392, 'loss_val': 0.05568194320854433, 'psi': 0.9885639845191241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=52 head_norm_before_train=1.759546 cos_to_last_merge=0.7693 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=52 local utility u=0.043514 metrics={'f1_val': 0.6617108482257493, 'auprc': 0.8466274157257855, 'loss_val': 1.302103689568856, 'psi': 0.7356774752257638}-{'f1_val': 0.6595905825001405, 'auprc': 0.8333609593759128, 'loss_val': 1.336610260985425, 'psi': 0.7290987332504494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=53 head_norm_before_train=1.823743 cos_to_last_merge=0.9085 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.908
[S2] round=53 local utility u=0.203759 metrics={'f1_val': 0.8268374367771796, 'auprc': 0.8442918798356756, 'loss_val': 0.3591495785413636, 'psi': 0.833819214000578}-{'f1_val': 0.804930422564858, 'auprc': 0.7651245342309031, 'loss_val': 0.3977234649293886, 'psi': 0.789008067231276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=53 head_norm_before_train=1.927509 cos_to_last_merge=0.9440 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.7529739997210321, 'auprc': 0.9715677604588149, 'loss_val': 0.47401395261876356, 'psi': 0.8404115040161452}-{'f1_val': 0.794795189041876, 'auprc': 0.9737363442139443, 'loss_val': 0.38162107675123436, 'psi': 0.8663716511107034}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.714515 cos_to_last_merge=0.9551 (last merge round=15)
[S4] round=53 local utility u=0.014686 metrics={'f1_val': 0.9557554814581223, 'auprc': 0.9043494908765095, 'loss_val': 0.26552045425108695, 'psi': 0.9351930852254772}-{'f1_val': 0.9551815804910354, 'auprc': 0.8972864966050973, 'loss_val': 0.27026081842687705, 'psi': 0.9320235469366602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=53 head_norm_before_train=1.590095 cos_to_last_merge=0.7301 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.730
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.5663380159111362, 'auprc': 0.8556535960464045, 'loss_val': 0.7778363710415035, 'psi': 0.6820642479652435}-{'f1_val': 0.7804707303943926, 'auprc': 0.993352393576116, 'loss_val': 0.17321142072530246, 'psi': 0.865623395667082}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=2.022205 (no previous merge yet)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.8805471137209793, 'auprc': 0.9696923041457512, 'loss_val': 0.33639181880293995, 'psi': 0.9162051898908881}-{'f1_val': 0.8991414192135871, 'auprc': 0.9843018757988915, 'loss_val': 0.18454636927561022, 'psi': 0.9332056018477088}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.569133 cos_to_last_merge=0.9150 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.915
[S7] round=53 local utility u=0.688060 metrics={'f1_val': 0.694301583156318, 'auprc': 0.8642843385010738, 'loss_val': 0.3263553194531913, 'psi': 0.7622946852942203}-{'f1_val': 0.5812366230811016, 'auprc': 0.7850703718873058, 'loss_val': 0.786443367271316, 'psi': 0.6627701226035834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=53 head_norm_before_train=1.781393 cos_to_last_merge=0.9431 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9477726685003167, 'auprc': 0.9959913061907812, 'loss_val': 0.14008268087842798, 'psi': 0.9670601235765025}-{'f1_val': 0.9920973070316986, 'auprc': 0.9991415945399171, 'loss_val': 0.03533815912307853, 'psi': 0.994915022034986}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=2.099816 (no previous merge yet)
[S9] round=53 local utility u=0.000908 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999086834504814, 'loss_val': 0.016837269781373215, 'psi': 0.9978964813092113}-{'f1_val': 0.9966891482978385, 'auprc': 0.9992683180273536, 'loss_val': 0.016714733785166504, 'psi': 0.9977208161896446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=53 head_norm_before_train=1.903556 cos_to_last_merge=0.9386 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9948407633505288, 'loss_val': 0.027041351931324762, 'psi': 0.9951661156652309}-{'f1_val': 0.9953830172083656, 'auprc': 0.9948718922229941, 'loss_val': 0.02700633331724769, 'psi': 0.995178567214217}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=1.669685 cos_to_last_merge=0.8549 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.855
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.760070565410374, 'auprc': 0.9954082745600237, 'loss_val': 0.45307774921110944, 'psi': 0.8542056490702339}-{'f1_val': 0.9965712481121245, 'auprc': 0.9980157027318345, 'loss_val': 0.025363118850428298, 'psi': 0.9971490299600085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=1.417793 cos_to_last_merge=0.8817 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.882
[S13] round=53 local utility u=0.069366 metrics={'f1_val': 0.6025890612300394, 'auprc': 0.6889602183586184, 'loss_val': 0.7819145115117959, 'psi': 0.637137524081471}-{'f1_val': 0.5892478550315086, 'auprc': 0.6896829009516897, 'loss_val': 0.8427675633882934, 'psi': 0.629421873399581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=53 head_norm_before_train=2.131626 (no previous merge yet)
[S14] round=53 local utility u=0.202781 metrics={'f1_val': 0.994360327056743, 'auprc': 0.996977609919713, 'loss_val': 0.025511555978590488, 'psi': 0.995407240201931}-{'f1_val': 0.9380925589464411, 'auprc': 0.9986669087343953, 'loss_val': 0.09853519288470147, 'psi': 0.9623222988616227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=53 head_norm_before_train=1.814593 cos_to_last_merge=0.8931 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.893
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9090013925653831, 'loss_val': 0.5985567139241443, 'psi': 0.7841507433279273}-{'f1_val': 0.8142001993556339, 'auprc': 0.9692565399651457, 'loss_val': 0.39684459351878054, 'psi': 0.8762227355994386}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.785399 cos_to_last_merge=0.8798 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.880
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.989971338569044, 'auprc': 0.9844677283518468, 'loss_val': 0.05371734186377444, 'psi': 0.9877698944821651}-{'f1_val': 0.991726697920398, 'auprc': 0.9889218453195632, 'loss_val': 0.043446071157078325, 'psi': 0.990604756880064}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.770110 cos_to_last_merge=0.7690 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=53 local utility u=0.436021 metrics={'f1_val': 0.7273784441584529, 'auprc': 0.864136979022508, 'loss_val': 0.8765959129528167, 'psi': 0.7820818581040749}-{'f1_val': 0.6617108482257493, 'auprc': 0.8466274157257855, 'loss_val': 1.302103689568856, 'psi': 0.7356774752257638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=54 head_norm_before_train=1.832291 cos_to_last_merge=0.9071 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.907
[S2] round=54 local utility u=0.050523 metrics={'f1_val': 0.8296298247095296, 'auprc': 0.8680306160506417, 'loss_val': 0.34607459800319096, 'psi': 0.8449901412459745}-{'f1_val': 0.8268374367771796, 'auprc': 0.8442918798356756, 'loss_val': 0.3591495785413636, 'psi': 0.833819214000578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=54 head_norm_before_train=1.935068 cos_to_last_merge=0.9432 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=54 local utility u=0.126697 metrics={'f1_val': 0.7858999033012688, 'auprc': 0.972234082823177, 'loss_val': 0.420173351186708, 'psi': 0.860433575110032}-{'f1_val': 0.7529739997210321, 'auprc': 0.9715677604588149, 'loss_val': 0.47401395261876356, 'psi': 0.8404115040161452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=54 head_norm_before_train=1.718690 cos_to_last_merge=0.9543 (last merge round=15)
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9392461741467326, 'auprc': 0.8650140689580357, 'loss_val': 0.3191081351456705, 'psi': 0.9095533320712539}-{'f1_val': 0.9557554814581223, 'auprc': 0.9043494908765095, 'loss_val': 0.26552045425108695, 'psi': 0.9351930852254772}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.592356 cos_to_last_merge=0.7298 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.730
[S5] round=54 local utility u=0.913712 metrics={'f1_val': 0.7328736507623281, 'auprc': 0.9646644798643891, 'loss_val': 0.276659375148236, 'psi': 0.8255899824031525}-{'f1_val': 0.5663380159111362, 'auprc': 0.8556535960464045, 'loss_val': 0.7778363710415035, 'psi': 0.6820642479652435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=54 head_norm_before_train=2.026239 (no previous merge yet)
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.6407280445171925, 'auprc': 0.9453104623055912, 'loss_val': 0.7472070764576272, 'psi': 0.7625610116325521}-{'f1_val': 0.8805471137209793, 'auprc': 0.9696923041457512, 'loss_val': 0.33639181880293995, 'psi': 0.9162051898908881}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.575072 cos_to_last_merge=0.9141 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.552031767005858, 'auprc': 0.7803597476927375, 'loss_val': 0.8876260612093942, 'psi': 0.6433629592806098}-{'f1_val': 0.694301583156318, 'auprc': 0.8642843385010738, 'loss_val': 0.3263553194531913, 'psi': 0.7622946852942203}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.787701 cos_to_last_merge=0.9426 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=54 local utility u=0.182909 metrics={'f1_val': 0.9903312961433964, 'auprc': 0.9988716154991624, 'loss_val': 0.03825715054046829, 'psi': 0.9937474238857027}-{'f1_val': 0.9477726685003167, 'auprc': 0.9959913061907812, 'loss_val': 0.14008268087842798, 'psi': 0.9670601235765025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=54 head_norm_before_train=2.105310 (no previous merge yet)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9968210870560296, 'auprc': 0.9991940707443273, 'loss_val': 0.0170631081805843, 'psi': 0.9977702805313486}-{'f1_val': 0.9971029125121428, 'auprc': 0.999086834504814, 'loss_val': 0.016837269781373215, 'psi': 0.9978964813092113}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=1.911777 cos_to_last_merge=0.9377 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=54 local utility u=0.000279 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9948534517901086, 'loss_val': 0.026521690697664184, 'psi': 0.9951711910410628}-{'f1_val': 0.9953830172083656, 'auprc': 0.9948407633505288, 'loss_val': 0.027041351931324762, 'psi': 0.9951661156652309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=54 head_norm_before_train=1.679228 cos_to_last_merge=0.8540 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.854
[S11] round=54 local utility u=0.926606 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979630109155186, 'loss_val': 0.02390926304765448, 'psi': 0.9968654093141931}-{'f1_val': 0.760070565410374, 'auprc': 0.9954082745600237, 'loss_val': 0.45307774921110944, 'psi': 0.8542056490702339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=54 head_norm_before_train=1.422339 cos_to_last_merge=0.8810 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.5318298377256896, 'auprc': 0.7018676640702084, 'loss_val': 0.9512120347639955, 'psi': 0.5998449682634972}-{'f1_val': 0.6025890612300394, 'auprc': 0.6889602183586184, 'loss_val': 0.7819145115117959, 'psi': 0.637137524081471}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=2.138456 (no previous merge yet)
[S14] round=54 local utility u=0.016981 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9986732762231844, 'loss_val': 0.01664005769142672, 'psi': 0.9980859103615716}-{'f1_val': 0.994360327056743, 'auprc': 0.996977609919713, 'loss_val': 0.025511555978590488, 'psi': 0.995407240201931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=54 head_norm_before_train=1.816348 cos_to_last_merge=0.8917 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.892
[S15] round=54 local utility u=1.000000 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9958303456248337, 'loss_val': 0.0266779709543683, 'psi': 0.9958734494581243}-{'f1_val': 0.7009169771696235, 'auprc': 0.9090013925653831, 'loss_val': 0.5985567139241443, 'psi': 0.7841507433279273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=54 head_norm_before_train=1.793207 cos_to_last_merge=0.8790 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.879
[S16] round=54 local utility u=0.010331 metrics={'f1_val': 0.9919458604863408, 'auprc': 0.9855889053166978, 'loss_val': 0.048265237295975594, 'psi': 0.9894030784184835}-{'f1_val': 0.989971338569044, 'auprc': 0.9844677283518468, 'loss_val': 0.05371734186377444, 'psi': 0.9877698944821651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=54 head_norm_before_train=1.777308 cos_to_last_merge=0.7689 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.6595881203327467, 'auprc': 0.8448046101531952, 'loss_val': 1.335629126943203, 'psi': 0.7336747162609261}-{'f1_val': 0.7273784441584529, 'auprc': 0.864136979022508, 'loss_val': 0.8765959129528167, 'psi': 0.7820818581040749}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=55 head_norm_before_train=1.839909 cos_to_last_merge=0.9060 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.906
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.8289356407511972, 'auprc': 0.8199295942723235, 'loss_val': 0.3515588257095663, 'psi': 0.8253332221596477}-{'f1_val': 0.8296298247095296, 'auprc': 0.8680306160506417, 'loss_val': 0.34607459800319096, 'psi': 0.8449901412459745}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=55 head_norm_before_train=1.944281 cos_to_last_merge=0.9423 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=55 local utility u=0.024228 metrics={'f1_val': 0.7919505668561877, 'auprc': 0.971228368813934, 'loss_val': 0.40500454502492367, 'psi': 0.8636616876392862}-{'f1_val': 0.7858999033012688, 'auprc': 0.972234082823177, 'loss_val': 0.420173351186708, 'psi': 0.860433575110032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=55 head_norm_before_train=1.723206 cos_to_last_merge=0.9535 (last merge round=15)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.8642996509451798, 'auprc': 0.8591736545374264, 'loss_val': 0.41240207515260463, 'psi': 0.8622492523820785}-{'f1_val': 0.9392461741467326, 'auprc': 0.8650140689580357, 'loss_val': 0.3191081351456705, 'psi': 0.9095533320712539}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.594047 cos_to_last_merge=0.7286 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.729
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9496847987367248, 'loss_val': 0.3364025131187516, 'psi': 0.8001698963759813}-{'f1_val': 0.7328736507623281, 'auprc': 0.9646644798643891, 'loss_val': 0.276659375148236, 'psi': 0.8255899824031525}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=2.031376 (no previous merge yet)
[S6] round=55 local utility u=0.262879 metrics={'f1_val': 0.7013892939993286, 'auprc': 0.9569501517764049, 'loss_val': 0.6203353748843754, 'psi': 0.8036136371101591}-{'f1_val': 0.6407280445171925, 'auprc': 0.9453104623055912, 'loss_val': 0.7472070764576272, 'psi': 0.7625610116325521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=55 head_norm_before_train=1.581282 cos_to_last_merge=0.9131 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=55 local utility u=1.000000 metrics={'f1_val': 0.7360673072874838, 'auprc': 0.9474955938095562, 'loss_val': 0.22649385443800799, 'psi': 0.8206386218963128}-{'f1_val': 0.552031767005858, 'auprc': 0.7803597476927375, 'loss_val': 0.8876260612093942, 'psi': 0.6433629592806098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=55 head_norm_before_train=1.793396 cos_to_last_merge=0.9428 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=55 local utility u=0.008524 metrics={'f1_val': 0.9925028268365944, 'auprc': 0.9988660342944136, 'loss_val': 0.034221686785362374, 'psi': 0.995048109819722}-{'f1_val': 0.9903312961433964, 'auprc': 0.9988716154991624, 'loss_val': 0.03825715054046829, 'psi': 0.9937474238857027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=55 head_norm_before_train=2.110568 (no previous merge yet)
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9991979291677049, 'loss_val': 0.018305698028001638, 'psi': 0.9970250069975908}-{'f1_val': 0.9968210870560296, 'auprc': 0.9991940707443273, 'loss_val': 0.0170631081805843, 'psi': 0.9977702805313486}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=1.920153 cos_to_last_merge=0.9368 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=55 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.994831036673532, 'loss_val': 0.026536652477226443, 'psi': 0.9951622249944321}-{'f1_val': 0.9953830172083656, 'auprc': 0.9948534517901086, 'loss_val': 0.026521690697664184, 'psi': 0.9951711910410628}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=55 head_norm_before_train=1.686915 cos_to_last_merge=0.8533 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.853
[S11] round=55 local utility u=0.000412 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978901847907622, 'loss_val': 0.02286769535736288, 'psi': 0.9968362788642905}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979630109155186, 'loss_val': 0.02390926304765448, 'psi': 0.9968654093141931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=55 head_norm_before_train=1.427313 cos_to_last_merge=0.8801 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.880
[S13] round=55 local utility u=0.163779 metrics={'f1_val': 0.5617498493287107, 'auprc': 0.6898124711695951, 'loss_val': 0.7670078767256736, 'psi': 0.6129748980650644}-{'f1_val': 0.5318298377256896, 'auprc': 0.7018676640702084, 'loss_val': 0.9512120347639955, 'psi': 0.5998449682634972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=55 head_norm_before_train=2.146950 (no previous merge yet)
[S14] round=55 local utility u=0.000297 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9986730204386394, 'loss_val': 0.016044354702973874, 'psi': 0.9980858080477537}-{'f1_val': 0.9976943331204965, 'auprc': 0.9986732762231844, 'loss_val': 0.01664005769142672, 'psi': 0.9980859103615716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=55 head_norm_before_train=1.817955 cos_to_last_merge=0.8907 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.891
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.9217536660769579, 'auprc': 0.9942896637033799, 'loss_val': 0.12770922688949737, 'psi': 0.9507680651275267}-{'f1_val': 0.9959021853469847, 'auprc': 0.9958303456248337, 'loss_val': 0.0266779709543683, 'psi': 0.9958734494581243}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.800295 cos_to_last_merge=0.8781 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.878
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.8314346764086201, 'auprc': 0.8359019286034738, 'loss_val': 1.2078190425316904, 'psi': 0.8332215772865617}-{'f1_val': 0.9919458604863408, 'auprc': 0.9855889053166978, 'loss_val': 0.048265237295975594, 'psi': 0.9894030784184835}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=1.784065 cos_to_last_merge=0.7687 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=55 local utility u=0.126354 metrics={'f1_val': 0.6824194942869161, 'auprc': 0.8619840533954961, 'loss_val': 1.2714470378269715, 'psi': 0.7542453179303481}-{'f1_val': 0.6595881203327467, 'auprc': 0.8448046101531952, 'loss_val': 1.335629126943203, 'psi': 0.7336747162609261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=56 head_norm_before_train=1.845000 cos_to_last_merge=0.9058 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.906
[S2] round=56 local utility u=0.037893 metrics={'f1_val': 0.8280945467347222, 'auprc': 0.8485647935887932, 'loss_val': 0.35663228243056116, 'psi': 0.8362826454763506}-{'f1_val': 0.8289356407511972, 'auprc': 0.8199295942723235, 'loss_val': 0.3515588257095663, 'psi': 0.8253332221596477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=56 head_norm_before_train=1.952516 cos_to_last_merge=0.9416 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=56 local utility u=0.460864 metrics={'f1_val': 0.9002168931315182, 'auprc': 0.9803482054506923, 'loss_val': 0.16023442357871168, 'psi': 0.9322694180591878}-{'f1_val': 0.7919505668561877, 'auprc': 0.971228368813934, 'loss_val': 0.40500454502492367, 'psi': 0.8636616876392862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=56 head_norm_before_train=1.728130 cos_to_last_merge=0.9528 (last merge round=15)
[S4] round=56 local utility u=0.300229 metrics={'f1_val': 0.9383993868687559, 'auprc': 0.8802442152080093, 'loss_val': 0.31975323659082666, 'psi': 0.9151373182044573}-{'f1_val': 0.8642996509451798, 'auprc': 0.8591736545374264, 'loss_val': 0.41240207515260463, 'psi': 0.8622492523820785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=56 head_norm_before_train=1.600401 cos_to_last_merge=0.7269 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.727
[S5] round=56 local utility u=0.063640 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.979640186114231, 'loss_val': 0.29899277713237327, 'psi': 0.8121523941113662}-{'f1_val': 0.7004932948021524, 'auprc': 0.9496847987367248, 'loss_val': 0.3364025131187516, 'psi': 0.8001698963759813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=56 head_norm_before_train=2.038891 (no previous merge yet)
[S6] round=56 local utility u=0.561399 metrics={'f1_val': 0.8434198235821406, 'auprc': 0.9714178612388624, 'loss_val': 0.3931242071803821, 'psi': 0.8946190386448293}-{'f1_val': 0.7013892939993286, 'auprc': 0.9569501517764049, 'loss_val': 0.6203353748843754, 'psi': 0.8036136371101591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=56 head_norm_before_train=1.586835 cos_to_last_merge=0.9122 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.5684783925051607, 'auprc': 0.7824771755387486, 'loss_val': 0.8030664694205965, 'psi': 0.6540779057185959}-{'f1_val': 0.7360673072874838, 'auprc': 0.9474955938095562, 'loss_val': 0.22649385443800799, 'psi': 0.8206386218963128}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=1.801829 cos_to_last_merge=0.9422 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.9935879766866298, 'auprc': 0.9890767467871093, 'loss_val': 0.03306031955099949, 'psi': 0.9917834847268217}-{'f1_val': 0.9925028268365944, 'auprc': 0.9988660342944136, 'loss_val': 0.034221686785362374, 'psi': 0.995048109819722}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=56 head_norm_before_train=2.114947 (no previous merge yet)
[S9] round=56 local utility u=0.000225 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959793847995431, 'loss_val': 0.017359150117642247, 'psi': 0.996653501427103}-{'f1_val': 0.9955763922175147, 'auprc': 0.9991979291677049, 'loss_val': 0.018305698028001638, 'psi': 0.9970250069975908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=56 head_norm_before_train=1.925490 cos_to_last_merge=0.9361 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=56 local utility u=0.000004 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9948435935647002, 'loss_val': 0.02656573772688087, 'psi': 0.9951672477508995}-{'f1_val': 0.9953830172083656, 'auprc': 0.994831036673532, 'loss_val': 0.026536652477226443, 'psi': 0.9951622249944321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=56 head_norm_before_train=1.693994 cos_to_last_merge=0.8526 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.853
[S11] round=56 local utility u=0.000045 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9979125571730431, 'loss_val': 0.02429516704283933, 'psi': 0.9969902550146676}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978901847907622, 'loss_val': 0.02286769535736288, 'psi': 0.9968362788642905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=56 head_norm_before_train=1.432153 cos_to_last_merge=0.8788 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.5293809608185014, 'auprc': 0.6927202061893489, 'loss_val': 0.9600382704960829, 'psi': 0.5947166589668405}-{'f1_val': 0.5617498493287107, 'auprc': 0.6898124711695951, 'loss_val': 0.7670078767256736, 'psi': 0.6129748980650644}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=2.156229 (no previous merge yet)
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9968732947155414, 'auprc': 0.9990136439646794, 'loss_val': 0.01718779730389058, 'psi': 0.9977294344151966}-{'f1_val': 0.9976943331204965, 'auprc': 0.9986730204386394, 'loss_val': 0.016044354702973874, 'psi': 0.9980858080477537}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=56 head_norm_before_train=1.821461 cos_to_last_merge=0.8901 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.890
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.904161441929954, 'auprc': 0.9938836624071941, 'loss_val': 0.16998546642446669, 'psi': 0.94005033012085}-{'f1_val': 0.9217536660769579, 'auprc': 0.9942896637033799, 'loss_val': 0.12770922688949737, 'psi': 0.9507680651275267}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=1.806878 cos_to_last_merge=0.8774 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.877
[S16] round=56 local utility u=1.000000 metrics={'f1_val': 0.9915011048905453, 'auprc': 0.9894009756549216, 'loss_val': 0.04333484368495784, 'psi': 0.9906610531962958}-{'f1_val': 0.8314346764086201, 'auprc': 0.8359019286034738, 'loss_val': 1.2078190425316904, 'psi': 0.8332215772865617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=56 head_norm_before_train=1.792442 cos_to_last_merge=0.7682 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=56 local utility u=0.952938 metrics={'f1_val': 0.877357329376062, 'auprc': 0.8888154665684157, 'loss_val': 0.6156914469555717, 'psi': 0.8819405842530035}-{'f1_val': 0.6824194942869161, 'auprc': 0.8619840533954961, 'loss_val': 1.2714470378269715, 'psi': 0.7542453179303481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=57 head_norm_before_train=1.850860 cos_to_last_merge=0.9051 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.905
[S2] round=57 local utility u=0.041675 metrics={'f1_val': 0.8301328524650174, 'auprc': 0.8721109172113203, 'loss_val': 0.3561497739560857, 'psi': 0.8469240783635386}-{'f1_val': 0.8280945467347222, 'auprc': 0.8485647935887932, 'loss_val': 0.35663228243056116, 'psi': 0.8362826454763506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=57 head_norm_before_train=1.962100 cos_to_last_merge=0.9407 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.8481891192740114, 'auprc': 0.9761077787409024, 'loss_val': 0.2433287556297989, 'psi': 0.8993565830607677}-{'f1_val': 0.9002168931315182, 'auprc': 0.9803482054506923, 'loss_val': 0.16023442357871168, 'psi': 0.9322694180591878}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.736056 cos_to_last_merge=0.9519 (last merge round=15)
[S4] round=57 local utility u=0.147666 metrics={'f1_val': 0.9451091848821377, 'auprc': 0.9541158029290051, 'loss_val': 0.286295001053211, 'psi': 0.9487118321008847}-{'f1_val': 0.9383993868687559, 'auprc': 0.8802442152080093, 'loss_val': 0.31975323659082666, 'psi': 0.9151373182044573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=57 head_norm_before_train=1.605649 cos_to_last_merge=0.7263 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.726
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.5803998026734671, 'auprc': 0.8557100303130366, 'loss_val': 0.7072650568934639, 'psi': 0.6905238937292949}-{'f1_val': 0.7004938661094564, 'auprc': 0.979640186114231, 'loss_val': 0.29899277713237327, 'psi': 0.8121523941113662}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=2.046807 (no previous merge yet)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.6185500637197822, 'auprc': 0.8798529450190251, 'loss_val': 0.9874639635034603, 'psi': 0.7230712162394793}-{'f1_val': 0.8434198235821406, 'auprc': 0.9714178612388624, 'loss_val': 0.3931242071803821, 'psi': 0.8946190386448293}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.589937 cos_to_last_merge=0.9117 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=57 local utility u=0.410296 metrics={'f1_val': 0.6522637537964898, 'auprc': 0.7994258390631214, 'loss_val': 0.5360322223324605, 'psi': 0.7111285879031425}-{'f1_val': 0.5684783925051607, 'auprc': 0.7824771755387486, 'loss_val': 0.8030664694205965, 'psi': 0.6540779057185959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=57 head_norm_before_train=1.810521 cos_to_last_merge=0.9415 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9943205514018633, 'auprc': 0.9873826014711338, 'loss_val': 0.034006874288070955, 'psi': 0.9915453714295714}-{'f1_val': 0.9935879766866298, 'auprc': 0.9890767467871093, 'loss_val': 0.03306031955099949, 'psi': 0.9917834847268217}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=2.121002 (no previous merge yet)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9960062173854078, 'loss_val': 0.01741466904553763, 'psi': 0.9965140382095174}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959793847995431, 'loss_val': 0.017359150117642247, 'psi': 0.996653501427103}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=1.931551 cos_to_last_merge=0.9355 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=57 local utility u=0.000237 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.994840864062627, 'loss_val': 0.02608320357850716, 'psi': 0.9951661559500702}-{'f1_val': 0.9953830172083656, 'auprc': 0.9948435935647002, 'loss_val': 0.02656573772688087, 'psi': 0.9951672477508995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=57 head_norm_before_train=1.701782 cos_to_last_merge=0.8518 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.852
[S11] round=57 local utility u=0.000486 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9979256950401784, 'loss_val': 0.02336188497002895, 'psi': 0.9969955101615218}-{'f1_val': 0.9963753869090841, 'auprc': 0.9979125571730431, 'loss_val': 0.02429516704283933, 'psi': 0.9969902550146676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=57 head_norm_before_train=1.438675 cos_to_last_merge=0.8773 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.877
[S13] round=57 local utility u=0.132664 metrics={'f1_val': 0.564787399354062, 'auprc': 0.695410381281848, 'loss_val': 0.9152192391390246, 'psi': 0.6170365921251764}-{'f1_val': 0.5293809608185014, 'auprc': 0.6927202061893489, 'loss_val': 0.9600382704960829, 'psi': 0.5947166589668405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=57 head_norm_before_train=2.163411 (no previous merge yet)
[S14] round=57 local utility u=0.003178 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9986706346636918, 'loss_val': 0.015942644346645406, 'psi': 0.9982061921614671}-{'f1_val': 0.9968732947155414, 'auprc': 0.9990136439646794, 'loss_val': 0.01718779730389058, 'psi': 0.9977294344151966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=57 head_norm_before_train=1.827708 cos_to_last_merge=0.8893 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.889
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.7889539647118357, 'auprc': 0.9911162053131229, 'loss_val': 0.3929470741163744, 'psi': 0.8698188609523505}-{'f1_val': 0.904161441929954, 'auprc': 0.9938836624071941, 'loss_val': 0.16998546642446669, 'psi': 0.94005033012085}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.812845 cos_to_last_merge=0.8768 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.877
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.9831101864178873, 'auprc': 0.9784837323678479, 'loss_val': 0.08211571361481915, 'psi': 0.9812596047978716}-{'f1_val': 0.9915011048905453, 'auprc': 0.9894009756549216, 'loss_val': 0.04333484368495784, 'psi': 0.9906610531962958}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=1.797873 cos_to_last_merge=0.7680 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.6640528090067681, 'auprc': 0.8336854453296082, 'loss_val': 1.3670401356023036, 'psi': 0.7319058635359041}-{'f1_val': 0.877357329376062, 'auprc': 0.8888154665684157, 'loss_val': 0.6156914469555717, 'psi': 0.8819405842530035}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=58 head_norm_before_train=1.858094 cos_to_last_merge=0.9041 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.904
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.7402708180536078, 'auprc': 0.8076229460776014, 'loss_val': 0.47108657208055177, 'psi': 0.7672116692632053}-{'f1_val': 0.8301328524650174, 'auprc': 0.8721109172113203, 'loss_val': 0.3561497739560857, 'psi': 0.8469240783635386}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=1.972500 cos_to_last_merge=0.9397 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.6597855215325782, 'auprc': 0.9638681589322234, 'loss_val': 0.7404057186495693, 'psi': 0.7814185764924363}-{'f1_val': 0.8481891192740114, 'auprc': 0.9761077787409024, 'loss_val': 0.2433287556297989, 'psi': 0.8993565830607677}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.742509 cos_to_last_merge=0.9509 (last merge round=15)
[S4] round=58 local utility u=0.056424 metrics={'f1_val': 0.9558128731911812, 'auprc': 0.964111428680033, 'loss_val': 0.26765693809871044, 'psi': 0.9591322953867218}-{'f1_val': 0.9451091848821377, 'auprc': 0.9541158029290051, 'loss_val': 0.286295001053211, 'psi': 0.9487118321008847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=58 head_norm_before_train=1.609635 cos_to_last_merge=0.7267 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.727
[S5] round=58 local utility u=0.231265 metrics={'f1_val': 0.6235694738455491, 'auprc': 0.8645849575271634, 'loss_val': 0.5303785949076125, 'psi': 0.7199756673181947}-{'f1_val': 0.5803998026734671, 'auprc': 0.8557100303130366, 'loss_val': 0.7072650568934639, 'psi': 0.6905238937292949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=58 head_norm_before_train=2.052519 (no previous merge yet)
[S6] round=58 local utility u=1.000000 metrics={'f1_val': 0.8586685288721241, 'auprc': 0.9645637329031266, 'loss_val': 0.33894575120240994, 'psi': 0.901026610484525}-{'f1_val': 0.6185500637197822, 'auprc': 0.8798529450190251, 'loss_val': 0.9874639635034603, 'psi': 0.7230712162394793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=58 head_norm_before_train=1.592463 cos_to_last_merge=0.9113 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=58 local utility u=0.190279 metrics={'f1_val': 0.6701683344325511, 'auprc': 0.8335998110812387, 'loss_val': 0.36542337371330774, 'psi': 0.7355409250920262}-{'f1_val': 0.6522637537964898, 'auprc': 0.7994258390631214, 'loss_val': 0.5360322223324605, 'psi': 0.7111285879031425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=58 head_norm_before_train=1.811937 cos_to_last_merge=0.9417 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.989224745596522, 'auprc': 0.999129522617084, 'loss_val': 0.03981192559472752, 'psi': 0.9931866564047468}-{'f1_val': 0.9943205514018633, 'auprc': 0.9873826014711338, 'loss_val': 0.034006874288070955, 'psi': 0.9915453714295714}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=2.127804 (no previous merge yet)
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9991948172977918, 'loss_val': 0.02156121995113738, 'psi': 0.9962919204368069}-{'f1_val': 0.9968525854255906, 'auprc': 0.9960062173854078, 'loss_val': 0.01741466904553763, 'psi': 0.9965140382095174}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=1.938463 cos_to_last_merge=0.9348 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=58 local utility u=0.001515 metrics={'f1_val': 0.9957973497718928, 'auprc': 0.9947924265665297, 'loss_val': 0.025394056045042714, 'psi': 0.9953953804897476}-{'f1_val': 0.9953830172083656, 'auprc': 0.994840864062627, 'loss_val': 0.02608320357850716, 'psi': 0.9951661559500702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=58 head_norm_before_train=1.708891 cos_to_last_merge=0.8511 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.851
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9975749789208164, 'loss_val': 0.024351372192820263, 'psi': 0.996565094289475}-{'f1_val': 0.9963753869090841, 'auprc': 0.9979256950401784, 'loss_val': 0.02336188497002895, 'psi': 0.9969955101615218}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.444722 cos_to_last_merge=0.8758 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.876
[S13] round=58 local utility u=0.004238 metrics={'f1_val': 0.5652286785947103, 'auprc': 0.6960247849936865, 'loss_val': 0.9112333516384408, 'psi': 0.6175471211543008}-{'f1_val': 0.564787399354062, 'auprc': 0.695410381281848, 'loss_val': 0.9152192391390246, 'psi': 0.6170365921251764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=58 head_norm_before_train=2.167076 (no previous merge yet)
[S14] round=58 local utility u=0.000000 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9986695183549867, 'loss_val': 0.016883788344713282, 'psi': 0.9980587818026344}-{'f1_val': 0.9978965638266506, 'auprc': 0.9986706346636918, 'loss_val': 0.015942644346645406, 'psi': 0.9982061921614671}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=58 head_norm_before_train=1.835226 cos_to_last_merge=0.8886 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.889
[S15] round=58 local utility u=0.556164 metrics={'f1_val': 0.9280618405583284, 'auprc': 0.9923360112622117, 'loss_val': 0.11892592294786755, 'psi': 0.9537715088398817}-{'f1_val': 0.7889539647118357, 'auprc': 0.9911162053131229, 'loss_val': 0.3929470741163744, 'psi': 0.8698188609523505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=58 head_norm_before_train=1.817226 cos_to_last_merge=0.8763 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.876
[S16] round=58 local utility u=0.061425 metrics={'f1_val': 0.9913325679008234, 'auprc': 0.9902230815120874, 'loss_val': 0.04381866020033667, 'psi': 0.990888773345329}-{'f1_val': 0.9831101864178873, 'auprc': 0.9784837323678479, 'loss_val': 0.08211571361481915, 'psi': 0.9812596047978716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=58 head_norm_before_train=1.802375 cos_to_last_merge=0.7677 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=58 local utility u=0.077821 metrics={'f1_val': 0.6703642989843379, 'auprc': 0.8519160081242725, 'loss_val': 1.303958265271745, 'psi': 0.7429849826403118}-{'f1_val': 0.6640528090067681, 'auprc': 0.8336854453296082, 'loss_val': 1.3670401356023036, 'psi': 0.7319058635359041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] sending update (kind=head size=1788 to 1 peers)
[S2] START round=59 head_norm_before_train=1.864216 cos_to_last_merge=0.9031 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.903
[S2] round=59 local utility u=0.066642 metrics={'f1_val': 0.723013869145315, 'auprc': 0.8708257603071933, 'loss_val': 0.4238686213910829, 'psi': 0.7821386256100663}-{'f1_val': 0.7402708180536078, 'auprc': 0.8076229460776014, 'loss_val': 0.47108657208055177, 'psi': 0.7672116692632053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S2] r=60 psi=0.782 u=0.0666 p_local=0.0474 f1=0.723 auprc=0.871 bytes=68392
[S3] START round=59 head_norm_before_train=1.981607 cos_to_last_merge=0.9389 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=59 local utility u=1.000000 metrics={'f1_val': 0.9233148617659251, 'auprc': 0.9844071154424734, 'loss_val': 0.12481786458042084, 'psi': 0.9477517632365444}-{'f1_val': 0.6597855215325782, 'auprc': 0.9638681589322234, 'loss_val': 0.7404057186495693, 'psi': 0.7814185764924363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S3] r=60 psi=0.948 u=1.0000 p_local=0.2849 f1=0.923 auprc=0.984 bytes=53958
[S4] START round=59 head_norm_before_train=1.750130 cos_to_last_merge=0.9499 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9511715065269789, 'auprc': 0.9512517042597153, 'loss_val': 0.2817626595778648, 'psi': 0.9512035856200733}-{'f1_val': 0.9558128731911812, 'auprc': 0.964111428680033, 'loss_val': 0.26765693809871044, 'psi': 0.9591322953867218}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.951 u=0.0000 p_local=0.0844 f1=0.951 auprc=0.951 bytes=62974
[S5] START round=59 head_norm_before_train=1.612551 cos_to_last_merge=0.7269 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.727
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.5356327079568155, 'auprc': 0.8556524801367719, 'loss_val': 0.8301432028698353, 'psi': 0.663640616828798}-{'f1_val': 0.6235694738455491, 'auprc': 0.8645849575271634, 'loss_val': 0.5303785949076125, 'psi': 0.7199756673181947}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.664 u=0.0000 p_local=0.1873 f1=0.536 auprc=0.856 bytes=57531
[S6] START round=59 head_norm_before_train=2.056129 (no previous merge yet)
[S6] round=59 local utility u=0.076263 metrics={'f1_val': 0.8705420436237474, 'auprc': 0.9690776180772112, 'loss_val': 0.27120165433955495, 'psi': 0.909956273405133}-{'f1_val': 0.8586685288721241, 'auprc': 0.9645637329031266, 'loss_val': 0.33894575120240994, 'psi': 0.901026610484525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=60 psi=0.910 u=0.0763 p_local=0.3321 f1=0.871 auprc=0.969 bytes=61167
[S7] START round=59 head_norm_before_train=1.596388 cos_to_last_merge=0.9109 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.44699151361346473, 'auprc': 0.7803362928947721, 'loss_val': 1.0598235765349877, 'psi': 0.5803294253259876}-{'f1_val': 0.6701683344325511, 'auprc': 0.8335998110812387, 'loss_val': 0.36542337371330774, 'psi': 0.7355409250920262}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.580 u=0.0000 p_local=0.2765 f1=0.447 auprc=0.780 bytes=59368
[S8] START round=59 head_norm_before_train=1.817562 cos_to_last_merge=0.9411 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.9887315963316906, 'auprc': 0.9958448406011667, 'loss_val': 0.04177770468569127, 'psi': 0.9915768940394811}-{'f1_val': 0.989224745596522, 'auprc': 0.999129522617084, 'loss_val': 0.03981192559472752, 'psi': 0.9931866564047468}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=60 psi=0.992 u=0.0000 p_local=0.0190 f1=0.989 auprc=0.996 bytes=62998
[S9] START round=59 head_norm_before_train=2.134727 (no previous merge yet)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9914152665170077, 'auprc': 0.9991932184219703, 'loss_val': 0.028429307548743656, 'psi': 0.9945264472789928}-{'f1_val': 0.994356655862817, 'auprc': 0.9991948172977918, 'loss_val': 0.02156121995113738, 'psi': 0.9962919204368069}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.995 u=0.0000 p_local=0.0014 f1=0.991 auprc=0.999 bytes=64797
[S10] START round=59 head_norm_before_train=1.945868 cos_to_last_merge=0.9340 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9948396946503771, 'loss_val': 0.026356691935876465, 'psi': 0.9949167897791966}-{'f1_val': 0.9957973497718928, 'auprc': 0.9947924265665297, 'loss_val': 0.025394056045042714, 'psi': 0.9953953804897476}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=60 psi=0.995 u=0.0000 p_local=0.0016 f1=0.995 auprc=0.995 bytes=68376
[S11] START round=59 head_norm_before_train=1.715714 cos_to_last_merge=0.8504 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.850
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9837680546201077, 'auprc': 0.9980991790253053, 'loss_val': 0.0660537173600284, 'psi': 0.9895005043821867}-{'f1_val': 0.9958918378685807, 'auprc': 0.9975749789208164, 'loss_val': 0.024351372192820263, 'psi': 0.996565094289475}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.990 u=0.0000 p_local=0.0665 f1=0.984 auprc=0.998 bytes=68279
[S13] START round=59 head_norm_before_train=1.450253 cos_to_last_merge=0.8756 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.876
[S13] round=59 local utility u=0.095895 metrics={'f1_val': 0.5825174738152243, 'auprc': 0.6996580702278563, 'loss_val': 0.8340755326556611, 'psi': 0.6293737123802772}-{'f1_val': 0.5652286785947103, 'auprc': 0.6960247849936865, 'loss_val': 0.9112333516384408, 'psi': 0.6175471211543008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] r=60 psi=0.629 u=0.0959 p_local=0.0814 f1=0.583 auprc=0.700 bytes=61179
[S14] START round=59 head_norm_before_train=2.167765 (no previous merge yet)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9972835715563582, 'auprc': 0.9986731567058608, 'loss_val': 0.016744246312505394, 'psi': 0.9978394056161592}-{'f1_val': 0.9976516241010662, 'auprc': 0.9986695183549867, 'loss_val': 0.016883788344713282, 'psi': 0.9980587818026344}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.998 u=0.0000 p_local=0.0171 f1=0.997 auprc=0.999 bytes=66525
[S15] START round=59 head_norm_before_train=1.844179 cos_to_last_merge=0.8879 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.888
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.9275413653901451, 'auprc': 0.9920110223222656, 'loss_val': 0.12071312111243905, 'psi': 0.9533292281629933}-{'f1_val': 0.9280618405583284, 'auprc': 0.9923360112622117, 'loss_val': 0.11892592294786755, 'psi': 0.9537715088398817}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.953 u=0.0000 p_local=0.2274 f1=0.928 auprc=0.992 bytes=62936
[S16] START round=59 head_norm_before_train=1.822767 cos_to_last_merge=0.8756 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.876
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.8848385828482178, 'auprc': 0.9773748104297473, 'loss_val': 0.6160050645542472, 'psi': 0.9218530738808297}-{'f1_val': 0.9913325679008234, 'auprc': 0.9902230815120874, 'loss_val': 0.04381866020033667, 'psi': 0.990888773345329}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.922 u=0.0000 p_local=0.1214 f1=0.885 auprc=0.977 bytes=64869
[S17] START round=59 head_norm_before_train=1.808442 cos_to_last_merge=0.7675 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=59 local utility u=0.255745 metrics={'f1_val': 0.6933312135172212, 'auprc': 0.8741303542932389, 'loss_val': 0.9969130231936597, 'psi': 0.7656508698276283}-{'f1_val': 0.6703642989843379, 'auprc': 0.8519160081242725, 'loss_val': 1.303958265271745, 'psi': 0.7429849826403118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S17] r=60 psi=0.766 u=0.2557 p_local=0.2245 f1=0.693 auprc=0.874 bytes=57503
[S2] START round=60 head_norm_before_train=1.868146 cos_to_last_merge=0.9027 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.903
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.5530271788377094, 'auprc': 0.793164023357938, 'loss_val': 0.7772361483309332, 'psi': 0.6490819166458008}-{'f1_val': 0.723013869145315, 'auprc': 0.8708257603071933, 'loss_val': 0.4238686213910829, 'psi': 0.7821386256100663}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=60 head_norm_before_train=1.987798 cos_to_last_merge=0.9384 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.6686881641394553, 'auprc': 0.9686039031851371, 'loss_val': 0.6830867803894591, 'psi': 0.7886544597577281}-{'f1_val': 0.9233148617659251, 'auprc': 0.9844071154424734, 'loss_val': 0.12481786458042084, 'psi': 0.9477517632365444}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=1.757500 cos_to_last_merge=0.9489 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=60 local utility u=0.025782 metrics={'f1_val': 0.9556158017390537, 'auprc': 0.9582645341398867, 'loss_val': 0.2779020136181482, 'psi': 0.9566752946993868}-{'f1_val': 0.9511715065269789, 'auprc': 0.9512517042597153, 'loss_val': 0.2817626595778648, 'psi': 0.9512035856200733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=60 head_norm_before_train=1.618619 cos_to_last_merge=0.7266 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.727
[S5] round=60 local utility u=0.123960 metrics={'f1_val': 0.564143999753892, 'auprc': 0.8560864959031822, 'loss_val': 0.75459389051312, 'psi': 0.680920998213608}-{'f1_val': 0.5356327079568155, 'auprc': 0.8556524801367719, 'loss_val': 0.8301432028698353, 'psi': 0.663640616828798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=60 head_norm_before_train=2.061358 (no previous merge yet)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.6129812473316817, 'auprc': 0.8800759565449228, 'loss_val': 1.0243312532984215, 'psi': 0.7198191310169781}-{'f1_val': 0.8705420436237474, 'auprc': 0.9690776180772112, 'loss_val': 0.27120165433955495, 'psi': 0.909956273405133}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.598726 cos_to_last_merge=0.9106 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=60 local utility u=1.000000 metrics={'f1_val': 0.7011554548197095, 'auprc': 0.8860172279963798, 'loss_val': 0.27778283880571225, 'psi': 0.7751001640903776}-{'f1_val': 0.44699151361346473, 'auprc': 0.7803362928947721, 'loss_val': 1.0598235765349877, 'psi': 0.5803294253259876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=60 head_norm_before_train=1.824601 cos_to_last_merge=0.9406 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=60 local utility u=0.025723 metrics={'f1_val': 0.9945089764462749, 'auprc': 0.9984902637004356, 'loss_val': 0.03293207334896669, 'psi': 0.9961014913479391}-{'f1_val': 0.9887315963316906, 'auprc': 0.9958448406011667, 'loss_val': 0.04177770468569127, 'psi': 0.9915768940394811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=60 head_norm_before_train=2.141381 (no previous merge yet)
[S9] round=60 local utility u=0.013385 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9938781250978803, 'loss_val': 0.017376989014661018, 'psi': 0.9955667447980094}-{'f1_val': 0.9914152665170077, 'auprc': 0.9991932184219703, 'loss_val': 0.028429307548743656, 'psi': 0.9945264472789928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=60 head_norm_before_train=1.953370 cos_to_last_merge=0.9332 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=60 local utility u=0.001639 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9948442746797505, 'loss_val': 0.025582395107197748, 'psi': 0.9951675201969195}-{'f1_val': 0.9949681865317428, 'auprc': 0.9948396946503771, 'loss_val': 0.026356691935876465, 'psi': 0.9949167897791966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=60 head_norm_before_train=1.722203 cos_to_last_merge=0.8497 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.850
[S11] round=60 local utility u=0.027837 metrics={'f1_val': 0.9880144935330106, 'auprc': 0.9982279198570496, 'loss_val': 0.03624371913471525, 'psi': 0.9920998640626262}-{'f1_val': 0.9837680546201077, 'auprc': 0.9980991790253053, 'loss_val': 0.0660537173600284, 'psi': 0.9895005043821867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=60 head_norm_before_train=1.455598 cos_to_last_merge=0.8744 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.874
[S13] round=60 local utility u=0.000000 metrics={'f1_val': 0.5678784592947042, 'auprc': 0.7069053335602061, 'loss_val': 0.9222021862150066, 'psi': 0.623489209000905}-{'f1_val': 0.5825174738152243, 'auprc': 0.6996580702278563, 'loss_val': 0.8340755326556611, 'psi': 0.6293737123802772}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=60 head_norm_before_train=2.170301 (no previous merge yet)
[S14] round=60 local utility u=0.001440 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9986115152575332, 'loss_val': 0.017340652039763864, 'psi': 0.9981809095393421}-{'f1_val': 0.9972835715563582, 'auprc': 0.9986731567058608, 'loss_val': 0.016744246312505394, 'psi': 0.9978394056161592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=60 head_norm_before_train=1.854236 cos_to_last_merge=0.8870 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.887
[S15] round=60 local utility u=0.144062 metrics={'f1_val': 0.9673557677152944, 'auprc': 0.9907866832212846, 'loss_val': 0.06780278088374155, 'psi': 0.9767281339176905}-{'f1_val': 0.9275413653901451, 'auprc': 0.9920110223222656, 'loss_val': 0.12071312111243905, 'psi': 0.9533292281629933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=60 head_norm_before_train=1.829220 cos_to_last_merge=0.8749 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.875
[S16] round=60 local utility u=0.421988 metrics={'f1_val': 0.9466926788127648, 'auprc': 0.9859238611843982, 'loss_val': 0.1688005848156438, 'psi': 0.9623851517614181}-{'f1_val': 0.8848385828482178, 'auprc': 0.9773748104297473, 'loss_val': 0.6160050645542472, 'psi': 0.9218530738808297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S16] sending update (kind=head size=1809 to 1 peers)
[S17] START round=60 head_norm_before_train=1.815209 cos_to_last_merge=0.7673 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.6888915612104345, 'auprc': 0.8706090533044901, 'loss_val': 1.1587079207937545, 'psi': 0.7615785580480567}-{'f1_val': 0.6933312135172212, 'auprc': 0.8741303542932389, 'loss_val': 0.9969130231936597, 'psi': 0.7656508698276283}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=61 head_norm_before_train=1.870603 cos_to_last_merge=0.9027 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.903
[S2] round=61 local utility u=1.000000 metrics={'f1_val': 0.7983589471401115, 'auprc': 0.8697519002251062, 'loss_val': 0.3923552962567284, 'psi': 0.8269161283741093}-{'f1_val': 0.5530271788377094, 'auprc': 0.793164023357938, 'loss_val': 0.7772361483309332, 'psi': 0.6490819166458008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=61 head_norm_before_train=1.993714 cos_to_last_merge=0.9378 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=61 local utility u=1.000000 metrics={'f1_val': 0.9636884806875357, 'auprc': 0.9967903086818078, 'loss_val': 0.07153500278429115, 'psi': 0.9769292118852446}-{'f1_val': 0.6686881641394553, 'auprc': 0.9686039031851371, 'loss_val': 0.6830867803894591, 'psi': 0.7886544597577281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=61 head_norm_before_train=1.760494 cos_to_last_merge=0.9488 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=61 local utility u=0.008505 metrics={'f1_val': 0.9560503101905264, 'auprc': 0.9627873693835518, 'loss_val': 0.2770676019314805, 'psi': 0.9587451338677366}-{'f1_val': 0.9556158017390537, 'auprc': 0.9582645341398867, 'loss_val': 0.2779020136181482, 'psi': 0.9566752946993868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=61 head_norm_before_train=1.624501 cos_to_last_merge=0.7262 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.726
[S5] round=61 local utility u=0.249954 metrics={'f1_val': 0.6164365857212105, 'auprc': 0.8629587427874278, 'loss_val': 0.589057548666695, 'psi': 0.7150454485476975}-{'f1_val': 0.564143999753892, 'auprc': 0.8560864959031822, 'loss_val': 0.75459389051312, 'psi': 0.680920998213608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=61 head_norm_before_train=2.067584 (no previous merge yet)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.6050824638923293, 'auprc': 0.852295022233356, 'loss_val': 1.1515413412731637, 'psi': 0.70396748722874}-{'f1_val': 0.6129812473316817, 'auprc': 0.8800759565449228, 'loss_val': 1.0243312532984215, 'psi': 0.7198191310169781}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.601406 cos_to_last_merge=0.9102 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.910
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.41800905448021397, 'auprc': 0.7757967357747082, 'loss_val': 1.194252917341251, 'psi': 0.5611241269980116}-{'f1_val': 0.7011554548197095, 'auprc': 0.8860172279963798, 'loss_val': 0.27778283880571225, 'psi': 0.7751001640903776}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.831345 cos_to_last_merge=0.9402 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.940
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9917345774119155, 'auprc': 0.9986526439802057, 'loss_val': 0.03457314835515525, 'psi': 0.9945018040392316}-{'f1_val': 0.9945089764462749, 'auprc': 0.9984902637004356, 'loss_val': 0.03293207334896669, 'psi': 0.9961014913479391}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=61 head_norm_before_train=2.147014 (no previous merge yet)
[S9] round=61 local utility u=0.006014 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996581191529381, 'loss_val': 0.01592042986551791, 'psi': 0.996894224119038}-{'f1_val': 0.9966924912647621, 'auprc': 0.9938781250978803, 'loss_val': 0.017376989014661018, 'psi': 0.9955667447980094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=61 head_norm_before_train=1.959336 cos_to_last_merge=0.9326 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9760105763646623, 'auprc': 0.9916442853381843, 'loss_val': 0.0730068566473247, 'psi': 0.9822640599540711}-{'f1_val': 0.9953830172083656, 'auprc': 0.9948442746797505, 'loss_val': 0.025582395107197748, 'psi': 0.9951675201969195}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=1.729377 cos_to_last_merge=0.8490 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.849
[S11] round=61 local utility u=0.030719 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998006481710372, 'loss_val': 0.02285667167701044, 'psi': 0.9968827976321344}-{'f1_val': 0.9880144935330106, 'auprc': 0.9982279198570496, 'loss_val': 0.03624371913471525, 'psi': 0.9920998640626262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=61 head_norm_before_train=1.463462 cos_to_last_merge=0.8730 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.873
[S13] round=61 local utility u=0.121607 metrics={'f1_val': 0.5939268148597252, 'auprc': 0.711608038408292, 'loss_val': 0.8493871847538563, 'psi': 0.640999304279152}-{'f1_val': 0.5678784592947042, 'auprc': 0.7069053335602061, 'loss_val': 0.9222021862150066, 'psi': 0.623489209000905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=61 head_norm_before_train=2.173960 (no previous merge yet)
[S14] round=61 local utility u=0.000000 metrics={'f1_val': 0.9304272073308006, 'auprc': 0.9985500198309247, 'loss_val': 0.13742743554151846, 'psi': 0.9576763323308504}-{'f1_val': 0.9978938390605482, 'auprc': 0.9986115152575332, 'loss_val': 0.017340652039763864, 'psi': 0.9981809095393421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=61 head_norm_before_train=1.863732 cos_to_last_merge=0.8862 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.886
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.7708379602966549, 'auprc': 0.9878395162555653, 'loss_val': 0.4428103429135231, 'psi': 0.8576385826802191}-{'f1_val': 0.9673557677152944, 'auprc': 0.9907866832212846, 'loss_val': 0.06780278088374155, 'psi': 0.9767281339176905}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.834669 cos_to_last_merge=0.8744 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.874
[S16] round=61 local utility u=0.194293 metrics={'f1_val': 0.9902642646981134, 'auprc': 0.9881081302391784, 'loss_val': 0.04819755435911317, 'psi': 0.9894018109145395}-{'f1_val': 0.9466926788127648, 'auprc': 0.9859238611843982, 'loss_val': 0.1688005848156438, 'psi': 0.9623851517614181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=61 head_norm_before_train=1.825549 cos_to_last_merge=0.7670 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.6770711397962766, 'auprc': 0.853755912133022, 'loss_val': 1.331486422379214, 'psi': 0.7477450487309748}-{'f1_val': 0.6888915612104345, 'auprc': 0.8706090533044901, 'loss_val': 1.1587079207937545, 'psi': 0.7615785580480567}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=1.873613 cos_to_last_merge=0.9025 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=62 local utility u=0.064206 metrics={'f1_val': 0.8318860429777974, 'auprc': 0.821567541265364, 'loss_val': 0.32055258205388976, 'psi': 0.827758642292824}-{'f1_val': 0.7983589471401115, 'auprc': 0.8697519002251062, 'loss_val': 0.3923552962567284, 'psi': 0.8269161283741093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=62 head_norm_before_train=1.999098 cos_to_last_merge=0.9372 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.8406776495044719, 'auprc': 0.9720236800449211, 'loss_val': 0.27907356125405997, 'psi': 0.8932160617206516}-{'f1_val': 0.9636884806875357, 'auprc': 0.9967903086818078, 'loss_val': 0.07153500278429115, 'psi': 0.9769292118852446}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.762192 cos_to_last_merge=0.9486 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9537515314805092, 'auprc': 0.9608830593159177, 'loss_val': 0.28117418916014997, 'psi': 0.9566041426146725}-{'f1_val': 0.9560503101905264, 'auprc': 0.9627873693835518, 'loss_val': 0.2770676019314805, 'psi': 0.9587451338677366}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=62 head_norm_before_train=1.628719 cos_to_last_merge=0.7260 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.726
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.5154028471648672, 'auprc': 0.855562081233831, 'loss_val': 0.9092887204258142, 'psi': 0.6514665407924527}-{'f1_val': 0.6164365857212105, 'auprc': 0.8629587427874278, 'loss_val': 0.589057548666695, 'psi': 0.7150454485476975}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=2.073868 (no previous merge yet)
[S6] round=62 local utility u=0.906458 metrics={'f1_val': 0.7078471678841252, 'auprc': 0.9810827293750715, 'loss_val': 0.3415762232374846, 'psi': 0.8171413924805038}-{'f1_val': 0.6050824638923293, 'auprc': 0.852295022233356, 'loss_val': 1.1515413412731637, 'psi': 0.70396748722874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=62 head_norm_before_train=1.604773 cos_to_last_merge=0.9097 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.910
[S7] round=62 local utility u=1.000000 metrics={'f1_val': 0.6901901922084941, 'auprc': 0.8513084703214802, 'loss_val': 0.3164058767039914, 'psi': 0.7546375034536885}-{'f1_val': 0.41800905448021397, 'auprc': 0.7757967357747082, 'loss_val': 1.194252917341251, 'psi': 0.5611241269980116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=62 head_norm_before_train=1.836527 cos_to_last_merge=0.9395 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=62 local utility u=0.002375 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9990878514822026, 'loss_val': 0.033304618879832645, 'psi': 0.9948935248119002}-{'f1_val': 0.9917345774119155, 'auprc': 0.9986526439802057, 'loss_val': 0.03457314835515525, 'psi': 0.9945018040392316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=62 head_norm_before_train=2.152002 (no previous merge yet)
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9999486569932973, 'loss_val': 0.033541074605296914, 'psi': 0.9944727641089852}-{'f1_val': 0.9971029125121428, 'auprc': 0.996581191529381, 'loss_val': 0.01592042986551791, 'psi': 0.996894224119038}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=1.964012 cos_to_last_merge=0.9320 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=62 local utility u=0.087891 metrics={'f1_val': 0.9957973497718928, 'auprc': 0.9946594809774494, 'loss_val': 0.02499133047408424, 'psi': 0.9953422022541155}-{'f1_val': 0.9760105763646623, 'auprc': 0.9916442853381843, 'loss_val': 0.0730068566473247, 'psi': 0.9822640599540711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=62 head_norm_before_train=1.736693 cos_to_last_merge=0.8483 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.848
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.7205210711868324, 'auprc': 0.9952039560892028, 'loss_val': 0.7751700014621952, 'psi': 0.8303942251477805}-{'f1_val': 0.9961336749133093, 'auprc': 0.998006481710372, 'loss_val': 0.02285667167701044, 'psi': 0.9968827976321344}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.471716 cos_to_last_merge=0.8714 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.871
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.5888377746213455, 'auprc': 0.7162388152918566, 'loss_val': 0.9502055846332317, 'psi': 0.6397981908895499}-{'f1_val': 0.5939268148597252, 'auprc': 0.711608038408292, 'loss_val': 0.8493871847538563, 'psi': 0.640999304279152}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=2.179407 (no previous merge yet)
[S14] round=62 local utility u=0.258025 metrics={'f1_val': 0.9972768303733199, 'auprc': 0.996926113682276, 'loss_val': 0.01760303133828558, 'psi': 0.9971365436969023}-{'f1_val': 0.9304272073308006, 'auprc': 0.9985500198309247, 'loss_val': 0.13742743554151846, 'psi': 0.9576763323308504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=62 head_norm_before_train=1.872409 cos_to_last_merge=0.8851 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=62 local utility u=0.901863 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976400951626185, 'loss_val': 0.023937975759112898, 'psi': 0.9971040390975597}-{'f1_val': 0.7708379602966549, 'auprc': 0.9878395162555653, 'loss_val': 0.4428103429135231, 'psi': 0.8576385826802191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=62 head_norm_before_train=1.841421 cos_to_last_merge=0.8737 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.874
[S16] round=62 local utility u=0.008030 metrics={'f1_val': 0.9912684031712505, 'auprc': 0.9908811305532832, 'loss_val': 0.046481150749268764, 'psi': 0.9911134941240636}-{'f1_val': 0.9902642646981134, 'auprc': 0.9881081302391784, 'loss_val': 0.04819755435911317, 'psi': 0.9894018109145395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=62 head_norm_before_train=1.837353 cos_to_last_merge=0.7665 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=62 local utility u=0.029610 metrics={'f1_val': 0.6852372363009827, 'auprc': 0.8602982600368378, 'loss_val': 1.3408898395956057, 'psi': 0.7552616457953247}-{'f1_val': 0.6770711397962766, 'auprc': 0.853755912133022, 'loss_val': 1.331486422379214, 'psi': 0.7477450487309748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=63 head_norm_before_train=1.877907 cos_to_last_merge=0.9018 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=63 local utility u=0.013204 metrics={'f1_val': 0.8249812895462431, 'auprc': 0.8647724305360194, 'loss_val': 0.3823310313219675, 'psi': 0.8408977459421536}-{'f1_val': 0.8318860429777974, 'auprc': 0.821567541265364, 'loss_val': 0.32055258205388976, 'psi': 0.827758642292824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=63 head_norm_before_train=2.005309 cos_to_last_merge=0.9366 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.6924673222757474, 'auprc': 0.9691659877654419, 'loss_val': 0.5436676926452845, 'psi': 0.8031467884716252}-{'f1_val': 0.8406776495044719, 'auprc': 0.9720236800449211, 'loss_val': 0.27907356125405997, 'psi': 0.8932160617206516}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.767086 cos_to_last_merge=0.9481 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.9509865070615198, 'auprc': 0.9619276624056723, 'loss_val': 0.28349295691911724, 'psi': 0.9553629691991807}-{'f1_val': 0.9537515314805092, 'auprc': 0.9608830593159177, 'loss_val': 0.28117418916014997, 'psi': 0.9566041426146725}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.633327 cos_to_last_merge=0.7260 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.726
[S5] round=63 local utility u=0.622815 metrics={'f1_val': 0.6383791324065312, 'auprc': 0.8871864263772697, 'loss_val': 0.4963901620433156, 'psi': 0.7379020499948267}-{'f1_val': 0.5154028471648672, 'auprc': 0.855562081233831, 'loss_val': 0.9092887204258142, 'psi': 0.6514665407924527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=63 head_norm_before_train=2.080455 (no previous merge yet)
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.7819358008163333, 'auprc': 0.9288776073278424, 'loss_val': 0.7010842202481843, 'psi': 0.8407125234209369}-{'f1_val': 0.7078471678841252, 'auprc': 0.9810827293750715, 'loss_val': 0.3415762232374846, 'psi': 0.8171413924805038}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=1.607786 cos_to_last_merge=0.9092 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.5198336427843611, 'auprc': 0.7800679409894893, 'loss_val': 0.8988043673459558, 'psi': 0.6239273620664123}-{'f1_val': 0.6901901922084941, 'auprc': 0.8513084703214802, 'loss_val': 0.3164058767039914, 'psi': 0.7546375034536885}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.838024 cos_to_last_merge=0.9395 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.940
[S8] round=63 local utility u=0.006228 metrics={'f1_val': 0.9939539858461368, 'auprc': 0.9989282011359719, 'loss_val': 0.031509448070845734, 'psi': 0.9959436719620709}-{'f1_val': 0.9920973070316986, 'auprc': 0.9990878514822026, 'loss_val': 0.033304618879832645, 'psi': 0.9948935248119002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=63 head_norm_before_train=2.154388 (no previous merge yet)
[S9] round=63 local utility u=0.024009 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999482906749568, 'loss_val': 0.018215894525087158, 'psi': 0.9977419337082264}-{'f1_val': 0.9908221688527771, 'auprc': 0.9999486569932973, 'loss_val': 0.033541074605296914, 'psi': 0.9944727641089852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=63 head_norm_before_train=1.969384 cos_to_last_merge=0.9314 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.992982622006873, 'auprc': 0.994445697277217, 'loss_val': 0.04637725416719007, 'psi': 0.9935678521150106}-{'f1_val': 0.9957973497718928, 'auprc': 0.9946594809774494, 'loss_val': 0.02499133047408424, 'psi': 0.9953422022541155}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=1.742121 cos_to_last_merge=0.8478 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.848
[S11] round=63 local utility u=1.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978386973733836, 'loss_val': 0.022130152984447652, 'psi': 0.996815683897339}-{'f1_val': 0.7205210711868324, 'auprc': 0.9952039560892028, 'loss_val': 0.7751700014621952, 'psi': 0.8303942251477805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=63 head_norm_before_train=1.477642 cos_to_last_merge=0.8704 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.870
[S13] round=63 local utility u=0.000000 metrics={'f1_val': 0.5712186039178004, 'auprc': 0.7222869534775644, 'loss_val': 0.9463015651433999, 'psi': 0.631645943741706}-{'f1_val': 0.5888377746213455, 'auprc': 0.7162388152918566, 'loss_val': 0.9502055846332317, 'psi': 0.6397981908895499}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=63 head_norm_before_train=2.183932 (no previous merge yet)
[S14] round=63 local utility u=0.002463 metrics={'f1_val': 0.9972835715563582, 'auprc': 0.9986720376393965, 'loss_val': 0.017954316837529478, 'psi': 0.9978389579895734}-{'f1_val': 0.9972768303733199, 'auprc': 0.996926113682276, 'loss_val': 0.01760303133828558, 'psi': 0.9971365436969023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=63 head_norm_before_train=1.879774 cos_to_last_merge=0.8844 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.884
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.7033095065017607, 'auprc': 0.8640827407464082, 'loss_val': 0.5873212792017318, 'psi': 0.7676188001996198}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976400951626185, 'loss_val': 0.023937975759112898, 'psi': 0.9971040390975597}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.847224 cos_to_last_merge=0.8731 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.873
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9464831046122866, 'auprc': 0.9862852265138511, 'loss_val': 0.18853063982559834, 'psi': 0.9624039533729124}-{'f1_val': 0.9912684031712505, 'auprc': 0.9908811305532832, 'loss_val': 0.046481150749268764, 'psi': 0.9911134941240636}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=1.843429 cos_to_last_merge=0.7663 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=63 local utility u=0.480422 metrics={'f1_val': 0.7569178733581202, 'auprc': 0.8887912313944607, 'loss_val': 0.8956087008830126, 'psi': 0.8096672165726564}-{'f1_val': 0.6852372363009827, 'auprc': 0.8602982600368378, 'loss_val': 1.3408898395956057, 'psi': 0.7552616457953247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=64 head_norm_before_train=1.881300 cos_to_last_merge=0.9017 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.8296833881247786, 'auprc': 0.7690781255177674, 'loss_val': 0.37759126446742847, 'psi': 0.8054412830819742}-{'f1_val': 0.8249812895462431, 'auprc': 0.8647724305360194, 'loss_val': 0.3823310313219675, 'psi': 0.8408977459421536}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=2.011956 cos_to_last_merge=0.9359 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=64 local utility u=0.400036 metrics={'f1_val': 0.7894050838291605, 'auprc': 0.9786544645882247, 'loss_val': 0.3536883868621847, 'psi': 0.8651048361327862}-{'f1_val': 0.6924673222757474, 'auprc': 0.9691659877654419, 'loss_val': 0.5436676926452845, 'psi': 0.8031467884716252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=64 head_norm_before_train=1.772907 cos_to_last_merge=0.9474 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9413802572680887, 'auprc': 0.9611885274355503, 'loss_val': 0.30496365441776085, 'psi': 0.9493035653350733}-{'f1_val': 0.9509865070615198, 'auprc': 0.9619276624056723, 'loss_val': 0.28349295691911724, 'psi': 0.9553629691991807}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.640598 cos_to_last_merge=0.7252 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.725
[S5] round=64 local utility u=0.110977 metrics={'f1_val': 0.655661499945591, 'auprc': 0.9140771707453532, 'loss_val': 0.4588027654269612, 'psi': 0.7590277682654958}-{'f1_val': 0.6383791324065312, 'auprc': 0.8871864263772697, 'loss_val': 0.4963901620433156, 'psi': 0.7379020499948267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=64 head_norm_before_train=2.085153 (no previous merge yet)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.6846187476502282, 'auprc': 0.846327077368616, 'loss_val': 0.9703618491767882, 'psi': 0.7493020795375833}-{'f1_val': 0.7819358008163333, 'auprc': 0.9288776073278424, 'loss_val': 0.7010842202481843, 'psi': 0.8407125234209369}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.609734 cos_to_last_merge=0.9089 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=64 local utility u=0.469936 metrics={'f1_val': 0.6314351259279026, 'auprc': 0.7831751435128118, 'loss_val': 0.6378620390351848, 'psi': 0.6921311329618663}-{'f1_val': 0.5198336427843611, 'auprc': 0.7800679409894893, 'loss_val': 0.8988043673459558, 'psi': 0.6239273620664123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=64 head_norm_before_train=1.840182 cos_to_last_merge=0.9397 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.940
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9842601283770251, 'auprc': 0.9985553470483348, 'loss_val': 0.0504833195381779, 'psi': 0.989978215845549}-{'f1_val': 0.9939539858461368, 'auprc': 0.9989282011359719, 'loss_val': 0.031509448070845734, 'psi': 0.9959436719620709}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=2.154182 (no previous merge yet)
[S9] round=64 local utility u=0.002831 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995468145774434, 'loss_val': 0.01634051158586002, 'psi': 0.9980804733382631}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999482906749568, 'loss_val': 0.018215894525087158, 'psi': 0.9977419337082264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=64 head_norm_before_train=1.974541 cos_to_last_merge=0.9308 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.957871374097177, 'auprc': 0.9939356254996273, 'loss_val': 0.09359613781046497, 'psi': 0.9722970746581572}-{'f1_val': 0.992982622006873, 'auprc': 0.994445697277217, 'loss_val': 0.04637725416719007, 'psi': 0.9935678521150106}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=1.745631 cos_to_last_merge=0.8474 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.847
[S11] round=64 local utility u=0.000249 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978961776715538, 'loss_val': 0.02283417507022589, 'psi': 0.9969415715499381}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978386973733836, 'loss_val': 0.022130152984447652, 'psi': 0.996815683897339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=64 head_norm_before_train=1.482487 cos_to_last_merge=0.8695 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.870
[S13] round=64 local utility u=0.222068 metrics={'f1_val': 0.6185478146487932, 'auprc': 0.7266085525765935, 'loss_val': 0.799106491012437, 'psi': 0.6617721098199133}-{'f1_val': 0.5712186039178004, 'auprc': 0.7222869534775644, 'loss_val': 0.9463015651433999, 'psi': 0.631645943741706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=64 head_norm_before_train=2.188865 (no previous merge yet)
[S14] round=64 local utility u=0.000753 metrics={'f1_val': 0.9975262299374879, 'auprc': 0.9985516070434401, 'loss_val': 0.017543296179072344, 'psi': 0.9979363807798688}-{'f1_val': 0.9972835715563582, 'auprc': 0.9986720376393965, 'loss_val': 0.017954316837529478, 'psi': 0.9978389579895734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=64 head_norm_before_train=1.885974 cos_to_last_merge=0.8838 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.884
[S15] round=64 local utility u=0.700646 metrics={'f1_val': 0.8306960493116102, 'auprc': 0.9900377324717476, 'loss_val': 0.32821443831393354, 'psi': 0.8944327225756652}-{'f1_val': 0.7033095065017607, 'auprc': 0.8640827407464082, 'loss_val': 0.5873212792017318, 'psi': 0.7676188001996198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=64 head_norm_before_train=1.852398 cos_to_last_merge=0.8724 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.872
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.8732114832633704, 'auprc': 0.9755869370641624, 'loss_val': 0.7820431132064087, 'psi': 0.9141616647836872}-{'f1_val': 0.9464831046122866, 'auprc': 0.9862852265138511, 'loss_val': 0.18853063982559834, 'psi': 0.9624039533729124}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=1.851400 cos_to_last_merge=0.7661 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.6948364646182501, 'auprc': 0.8749745661041857, 'loss_val': 1.2147831516447043, 'psi': 0.7668917052126243}-{'f1_val': 0.7569178733581202, 'auprc': 0.8887912313944607, 'loss_val': 0.8956087008830126, 'psi': 0.8096672165726564}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=1.886553 cos_to_last_merge=0.9011 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.901
[S2] round=65 local utility u=0.141209 metrics={'f1_val': 0.8293058796293661, 'auprc': 0.861775286524844, 'loss_val': 0.3710005081346513, 'psi': 0.8422936423875572}-{'f1_val': 0.8296833881247786, 'auprc': 0.7690781255177674, 'loss_val': 0.37759126446742847, 'psi': 0.8054412830819742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=65 head_norm_before_train=2.020242 cos_to_last_merge=0.9351 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.7165362675258186, 'auprc': 0.9695329198419612, 'loss_val': 0.5407090944742882, 'psi': 0.8177349284522757}-{'f1_val': 0.7894050838291605, 'auprc': 0.9786544645882247, 'loss_val': 0.3536883868621847, 'psi': 0.8651048361327862}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.776065 cos_to_last_merge=0.9469 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9415727981037855, 'auprc': 0.9580227507866805, 'loss_val': 0.3024736836287206, 'psi': 0.9481527791769435}-{'f1_val': 0.9413802572680887, 'auprc': 0.9611885274355503, 'loss_val': 0.30496365441776085, 'psi': 0.9493035653350733}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.647181 cos_to_last_merge=0.7244 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.724
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.6903908847772744, 'auprc': 0.8870821097485977, 'loss_val': 0.593672821954825, 'psi': 0.7690673747658037}-{'f1_val': 0.655661499945591, 'auprc': 0.9140771707453532, 'loss_val': 0.4588027654269612, 'psi': 0.7590277682654958}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=2.085314 (no previous merge yet)
[S6] round=65 local utility u=0.981461 metrics={'f1_val': 0.8655466156550612, 'auprc': 0.9313777366205823, 'loss_val': 0.3481584152147624, 'psi': 0.8918790640412697}-{'f1_val': 0.6846187476502282, 'auprc': 0.846327077368616, 'loss_val': 0.9703618491767882, 'psi': 0.7493020795375833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=65 head_norm_before_train=1.612949 cos_to_last_merge=0.9083 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.908
[S7] round=65 local utility u=0.326447 metrics={'f1_val': 0.6785057172985962, 'auprc': 0.8230773129909041, 'loss_val': 0.38709838407581443, 'psi': 0.7363343555755193}-{'f1_val': 0.6314351259279026, 'auprc': 0.7831751435128118, 'loss_val': 0.6378620390351848, 'psi': 0.6921311329618663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=65 head_norm_before_train=1.845972 cos_to_last_merge=0.9392 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.9810231653608481, 'auprc': 0.9932139176082384, 'loss_val': 0.05928879437240662, 'psi': 0.9858994662598042}-{'f1_val': 0.9842601283770251, 'auprc': 0.9985553470483348, 'loss_val': 0.0504833195381779, 'psi': 0.989978215845549}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=65 head_norm_before_train=2.157271 (no previous merge yet)
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9980105907686015, 'loss_val': 0.016555953482049936, 'psi': 0.9974659838147263}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995468145774434, 'loss_val': 0.01634051158586002, 'psi': 0.9980804733382631}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=1.975991 cos_to_last_merge=0.9305 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=65 local utility u=0.149007 metrics={'f1_val': 0.9957973497718928, 'auprc': 0.9946183771264026, 'loss_val': 0.02518615513873855, 'psi': 0.9953257607136967}-{'f1_val': 0.957871374097177, 'auprc': 0.9939356254996273, 'loss_val': 0.09359613781046497, 'psi': 0.9722970746581572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=65 head_norm_before_train=1.750526 cos_to_last_merge=0.8470 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.847
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9879056424021162, 'auprc': 0.9979924355984571, 'loss_val': 0.035833693390159564, 'psi': 0.9919403596806525}-{'f1_val': 0.996305167468861, 'auprc': 0.9978961776715538, 'loss_val': 0.02283417507022589, 'psi': 0.9969415715499381}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.488292 cos_to_last_merge=0.8683 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.868
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.5695531622050423, 'auprc': 0.7240127985555558, 'loss_val': 1.1795567229727937, 'psi': 0.6313370167452477}-{'f1_val': 0.6185478146487932, 'auprc': 0.7266085525765935, 'loss_val': 0.799106491012437, 'psi': 0.6617721098199133}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=2.191308 (no previous merge yet)
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9975262299374879, 'auprc': 0.9969117019994866, 'loss_val': 0.016476406211513722, 'psi': 0.9972804187622873}-{'f1_val': 0.9975262299374879, 'auprc': 0.9985516070434401, 'loss_val': 0.017543296179072344, 'psi': 0.9979363807798688}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=1.891938 cos_to_last_merge=0.8831 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.883
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.8021247552445238, 'auprc': 0.9589808463450964, 'loss_val': 0.41528416348100944, 'psi': 0.8648671916847528}-{'f1_val': 0.8306960493116102, 'auprc': 0.9900377324717476, 'loss_val': 0.32821443831393354, 'psi': 0.8944327225756652}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=1.856385 cos_to_last_merge=0.8720 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.872
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.8712903020038137, 'auprc': 0.9698048855465038, 'loss_val': 0.8253597888311853, 'psi': 0.9106961354208898}-{'f1_val': 0.8732114832633704, 'auprc': 0.9755869370641624, 'loss_val': 0.7820431132064087, 'psi': 0.9141616647836872}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.859327 cos_to_last_merge=0.7659 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.6515003898743679, 'auprc': 0.8335817772872237, 'loss_val': 1.4839152059732967, 'psi': 0.7243329448395102}-{'f1_val': 0.6948364646182501, 'auprc': 0.8749745661041857, 'loss_val': 1.2147831516447043, 'psi': 0.7668917052126243}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=66 head_norm_before_train=1.891922 cos_to_last_merge=0.9005 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.900
[S2] round=66 local utility u=0.009437 metrics={'f1_val': 0.8305333893234529, 'auprc': 0.8639440144789545, 'loss_val': 0.3659985091142993, 'psi': 0.8438976393856535}-{'f1_val': 0.8293058796293661, 'auprc': 0.861775286524844, 'loss_val': 0.3710005081346513, 'psi': 0.8422936423875572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=66 head_norm_before_train=2.028160 cos_to_last_merge=0.9343 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=66 local utility u=0.200336 metrics={'f1_val': 0.767264468613905, 'auprc': 0.9704680465746615, 'loss_val': 0.4472123722877223, 'psi': 0.8485458997982076}-{'f1_val': 0.7165362675258186, 'auprc': 0.9695329198419612, 'loss_val': 0.5407090944742882, 'psi': 0.8177349284522757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=66 head_norm_before_train=1.774851 cos_to_last_merge=0.9465 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9388397587891048, 'auprc': 0.9313444313203538, 'loss_val': 0.3435064445243463, 'psi': 0.9358416278016044}-{'f1_val': 0.9415727981037855, 'auprc': 0.9580227507866805, 'loss_val': 0.3024736836287206, 'psi': 0.9481527791769435}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.651980 cos_to_last_merge=0.7234 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.723
[S5] round=66 local utility u=0.882814 metrics={'f1_val': 0.8853969698562802, 'auprc': 0.9736225411257735, 'loss_val': 0.2577019797025332, 'psi': 0.9206871983640776}-{'f1_val': 0.6903908847772744, 'auprc': 0.8870821097485977, 'loss_val': 0.593672821954825, 'psi': 0.7690673747658037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=66 head_norm_before_train=2.086798 (no previous merge yet)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.8281854403160333, 'auprc': 0.9374726111154912, 'loss_val': 0.48628965228101734, 'psi': 0.8719003086358165}-{'f1_val': 0.8655466156550612, 'auprc': 0.9313777366205823, 'loss_val': 0.3481584152147624, 'psi': 0.8918790640412697}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.615157 cos_to_last_merge=0.9079 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.908
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.595504559336275, 'auprc': 0.7828692500394809, 'loss_val': 0.6370575911899725, 'psi': 0.6704504356175573}-{'f1_val': 0.6785057172985962, 'auprc': 0.8230773129909041, 'loss_val': 0.38709838407581443, 'psi': 0.7363343555755193}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=1.852572 cos_to_last_merge=0.9387 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=66 local utility u=0.028379 metrics={'f1_val': 0.9867721378718218, 'auprc': 0.997674062474015, 'loss_val': 0.050405361324828646, 'psi': 0.9911329077126991}-{'f1_val': 0.9810231653608481, 'auprc': 0.9932139176082384, 'loss_val': 0.05928879437240662, 'psi': 0.9858994662598042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=66 head_norm_before_train=2.162355 (no previous merge yet)
[S9] round=66 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999432530094199, 'loss_val': 0.018631482570494563, 'psi': 0.9974733322222792}-{'f1_val': 0.9971029125121428, 'auprc': 0.9980105907686015, 'loss_val': 0.016555953482049936, 'psi': 0.9974659838147263}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=66 head_norm_before_train=1.979445 cos_to_last_merge=0.9300 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.8866326320149724, 'auprc': 0.9900263893651822, 'loss_val': 0.2505596210096987, 'psi': 0.9279901349550563}-{'f1_val': 0.9957973497718928, 'auprc': 0.9946183771264026, 'loss_val': 0.02518615513873855, 'psi': 0.9953257607136967}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=1.756034 cos_to_last_merge=0.8464 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.846
[S11] round=66 local utility u=0.032760 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979903417800147, 'loss_val': 0.02215608956739917, 'psi': 0.9971243394201597}-{'f1_val': 0.9879056424021162, 'auprc': 0.9979924355984571, 'loss_val': 0.035833693390159564, 'psi': 0.9919403596806525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=66 head_norm_before_train=1.495109 cos_to_last_merge=0.8675 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.867
[S13] round=66 local utility u=0.190413 metrics={'f1_val': 0.5834715568834843, 'auprc': 0.764349975342565, 'loss_val': 1.0032533232765068, 'psi': 0.6558229242671165}-{'f1_val': 0.5695531622050423, 'auprc': 0.7240127985555558, 'loss_val': 1.1795567229727937, 'psi': 0.6313370167452477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=66 head_norm_before_train=2.197528 (no previous merge yet)
[S14] round=66 local utility u=0.000454 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9969309777244686, 'loss_val': 0.016392589288942494, 'psi': 0.997364696779361}-{'f1_val': 0.9975262299374879, 'auprc': 0.9969117019994866, 'loss_val': 0.016476406211513722, 'psi': 0.9972804187622873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=66 head_norm_before_train=1.897890 cos_to_last_merge=0.8824 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.7727166260762702, 'auprc': 0.9297924116498135, 'loss_val': 0.48269984410837025, 'psi': 0.8355469403056875}-{'f1_val': 0.8021247552445238, 'auprc': 0.9589808463450964, 'loss_val': 0.41528416348100944, 'psi': 0.8648671916847528}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=1.859963 cos_to_last_merge=0.8716 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.872
[S16] round=66 local utility u=0.501659 metrics={'f1_val': 0.9445978319049189, 'auprc': 0.9851062111517667, 'loss_val': 0.30779187779569195, 'psi': 0.960801183603658}-{'f1_val': 0.8712903020038137, 'auprc': 0.9698048855465038, 'loss_val': 0.8253597888311853, 'psi': 0.9106961354208898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=66 head_norm_before_train=1.864267 cos_to_last_merge=0.7654 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=66 local utility u=0.119976 metrics={'f1_val': 0.6657762221142239, 'auprc': 0.8562852104075386, 'loss_val': 1.3977286198637071, 'psi': 0.7419798174315497}-{'f1_val': 0.6515003898743679, 'auprc': 0.8335817772872237, 'loss_val': 1.4839152059732967, 'psi': 0.7243329448395102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=67 head_norm_before_train=1.899670 cos_to_last_merge=0.8993 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.899
[S2] round=67 local utility u=0.011114 metrics={'f1_val': 0.830725337285506, 'auprc': 0.873623826854308, 'loss_val': 0.3739614264497857, 'psi': 0.8478847331130268}-{'f1_val': 0.8305333893234529, 'auprc': 0.8639440144789545, 'loss_val': 0.3659985091142993, 'psi': 0.8438976393856535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=67 head_norm_before_train=2.035056 cos_to_last_merge=0.9335 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=67 local utility u=0.605802 metrics={'f1_val': 0.9169867516268553, 'auprc': 0.9787171901814573, 'loss_val': 0.15868945898936862, 'psi': 0.941678927048696}-{'f1_val': 0.767264468613905, 'auprc': 0.9704680465746615, 'loss_val': 0.4472123722877223, 'psi': 0.8485458997982076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=67 head_norm_before_train=1.773803 cos_to_last_merge=0.9466 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=67 local utility u=0.042034 metrics={'f1_val': 0.9389037863496512, 'auprc': 0.9513292255410499, 'loss_val': 0.3197760455810623, 'psi': 0.9438739620262107}-{'f1_val': 0.9388397587891048, 'auprc': 0.9313444313203538, 'loss_val': 0.3435064445243463, 'psi': 0.9358416278016044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=67 head_norm_before_train=1.658594 cos_to_last_merge=0.7216 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.722
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.7836500557436484, 'auprc': 0.9629620206610655, 'loss_val': 0.31694256852968095, 'psi': 0.8553748417106153}-{'f1_val': 0.8853969698562802, 'auprc': 0.9736225411257735, 'loss_val': 0.2577019797025332, 'psi': 0.9206871983640776}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=2.091757 (no previous merge yet)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.6372473252910182, 'auprc': 0.8710613620046272, 'loss_val': 0.976818211979338, 'psi': 0.7307729399764619}-{'f1_val': 0.8281854403160333, 'auprc': 0.9374726111154912, 'loss_val': 0.48628965228101734, 'psi': 0.8719003086358165}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.621177 cos_to_last_merge=0.9072 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.907
[S7] round=67 local utility u=1.000000 metrics={'f1_val': 0.9899295539324452, 'auprc': 0.9884647686731103, 'loss_val': 0.18852788125453102, 'psi': 0.9893436398287112}-{'f1_val': 0.595504559336275, 'auprc': 0.7828692500394809, 'loss_val': 0.6370575911899725, 'psi': 0.6704504356175573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=67 head_norm_before_train=1.856389 cos_to_last_merge=0.9391 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9101421306403554, 'auprc': 0.999359285943983, 'loss_val': 0.1592603138294505, 'psi': 0.9458289927618065}-{'f1_val': 0.9867721378718218, 'auprc': 0.997674062474015, 'loss_val': 0.050405361324828646, 'psi': 0.9911329077126991}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=2.167647 (no previous merge yet)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9997376212738445, 'loss_val': 0.020944259953291203, 'psi': 0.9964088723598774}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999432530094199, 'loss_val': 0.018631482570494563, 'psi': 0.9974733322222792}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=1.983810 cos_to_last_merge=0.9295 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=67 local utility u=0.438516 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9939941170787342, 'loss_val': 0.03426850109717032, 'psi': 0.994461068841097}-{'f1_val': 0.8866326320149724, 'auprc': 0.9900263893651822, 'loss_val': 0.2505596210096987, 'psi': 0.9279901349550563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=67 head_norm_before_train=1.761127 cos_to_last_merge=0.8459 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.846
[S11] round=67 local utility u=0.000610 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980158125604829, 'loss_val': 0.021012409892234934, 'psi': 0.9971345277323469}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979903417800147, 'loss_val': 0.02215608956739917, 'psi': 0.9971243394201597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=67 head_norm_before_train=1.497849 cos_to_last_merge=0.8670 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.867
[S13] round=67 local utility u=0.119540 metrics={'f1_val': 0.6228932317284539, 'auprc': 0.7413449666758268, 'loss_val': 0.9316880652795374, 'psi': 0.6702739257074031}-{'f1_val': 0.5834715568834843, 'auprc': 0.764349975342565, 'loss_val': 1.0032533232765068, 'psi': 0.6558229242671165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=67 head_norm_before_train=2.205747 (no previous merge yet)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9968617059779579, 'auprc': 0.996981425692118, 'loss_val': 0.019291282718710244, 'psi': 0.9969095938636219}-{'f1_val': 0.9976538428159559, 'auprc': 0.9969309777244686, 'loss_val': 0.016392589288942494, 'psi': 0.997364696779361}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=1.904577 cos_to_last_merge=0.8816 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=67 local utility u=1.000000 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9982972490059181, 'loss_val': 0.02272027208094334, 'psi': 0.9972344669681181}-{'f1_val': 0.7727166260762702, 'auprc': 0.9297924116498135, 'loss_val': 0.48269984410837025, 'psi': 0.8355469403056875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=67 head_norm_before_train=1.865874 cos_to_last_merge=0.8709 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.871
[S16] round=67 local utility u=0.250199 metrics={'f1_val': 0.9865167468621817, 'auprc': 0.9875341475349553, 'loss_val': 0.06619028390418609, 'psi': 0.9869237071312911}-{'f1_val': 0.9445978319049189, 'auprc': 0.9851062111517667, 'loss_val': 0.30779187779569195, 'psi': 0.960801183603658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S16] sending update (kind=head size=1811 to 1 peers)
[S17] START round=67 head_norm_before_train=1.866783 cos_to_last_merge=0.7652 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=67 local utility u=1.000000 metrics={'f1_val': 0.904725619379768, 'auprc': 0.9555937884282749, 'loss_val': 0.38966498622148377, 'psi': 0.9250728869991708}-{'f1_val': 0.6657762221142239, 'auprc': 0.8562852104075386, 'loss_val': 1.3977286198637071, 'psi': 0.7419798174315497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=68 head_norm_before_train=1.907698 cos_to_last_merge=0.8985 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.898
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.827607977432548, 'auprc': 0.8754322474154201, 'loss_val': 0.3944402092513678, 'psi': 0.8467376854256969}-{'f1_val': 0.830725337285506, 'auprc': 0.873623826854308, 'loss_val': 0.3739614264497857, 'psi': 0.8478847331130268}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.040716 cos_to_last_merge=0.9332 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=68 local utility u=0.184636 metrics={'f1_val': 0.9592181083661728, 'auprc': 0.9956136172988574, 'loss_val': 0.09349489817625639, 'psi': 0.9737763119392466}-{'f1_val': 0.9169867516268553, 'auprc': 0.9787171901814573, 'loss_val': 0.15868945898936862, 'psi': 0.941678927048696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=68 head_norm_before_train=1.778158 cos_to_last_merge=0.9462 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9420634662696883, 'auprc': 0.9072203971307624, 'loss_val': 0.29862421128041716, 'psi': 0.9281262386141179}-{'f1_val': 0.9389037863496512, 'auprc': 0.9513292255410499, 'loss_val': 0.3197760455810623, 'psi': 0.9438739620262107}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.662854 cos_to_last_merge=0.7211 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.721
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.5409927372231964, 'auprc': 0.8555882145133461, 'loss_val': 0.9102457717595595, 'psi': 0.6668309281392564}-{'f1_val': 0.7836500557436484, 'auprc': 0.9629620206610655, 'loss_val': 0.31694256852968095, 'psi': 0.8553748417106153}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=2.098285 (no previous merge yet)
[S6] round=68 local utility u=1.000000 metrics={'f1_val': 0.8821750089562949, 'auprc': 0.9685875505064846, 'loss_val': 0.2540744345519778, 'psi': 0.9167400255763707}-{'f1_val': 0.6372473252910182, 'auprc': 0.8710613620046272, 'loss_val': 0.976818211979338, 'psi': 0.7307729399764619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=68 head_norm_before_train=1.628010 cos_to_last_merge=0.9063 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.906
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.461440533499627, 'auprc': 0.7790443441012554, 'loss_val': 0.9848043633863796, 'psi': 0.5884820577402784}-{'f1_val': 0.9899295539324452, 'auprc': 0.9884647686731103, 'loss_val': 0.18852788125453102, 'psi': 0.9893436398287112}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=1.861218 cos_to_last_merge=0.9390 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=68 local utility u=0.308183 metrics={'f1_val': 0.9921395546714198, 'auprc': 0.9992419026242053, 'loss_val': 0.034526682667984344, 'psi': 0.994980493852534}-{'f1_val': 0.9101421306403554, 'auprc': 0.999359285943983, 'loss_val': 0.1592603138294505, 'psi': 0.9458289927618065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=68 head_norm_before_train=2.173570 (no previous merge yet)
[S9] round=68 local utility u=0.006533 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967371708179923, 'loss_val': 0.0163553435524016, 'psi': 0.9969566158344826}-{'f1_val': 0.9941897064172326, 'auprc': 0.9997376212738445, 'loss_val': 0.020944259953291203, 'psi': 0.9964088723598774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=68 head_norm_before_train=1.988035 cos_to_last_merge=0.9291 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=68 local utility u=0.011006 metrics={'f1_val': 0.9955774965436698, 'auprc': 0.9964040886143992, 'loss_val': 0.02431734064641073, 'psi': 0.9959081333719616}-{'f1_val': 0.9947723700160056, 'auprc': 0.9939941170787342, 'loss_val': 0.03426850109717032, 'psi': 0.994461068841097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=68 head_norm_before_train=1.763533 cos_to_last_merge=0.8455 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.845
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9982725939294652, 'loss_val': 0.021020106865984774, 'psi': 0.9969892425197717}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980158125604829, 'loss_val': 0.021012409892234934, 'psi': 0.9971345277323469}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.502471 cos_to_last_merge=0.8662 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.866
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.602911615590554, 'auprc': 0.7463176868962339, 'loss_val': 1.0224827458067927, 'psi': 0.6602740441128259}-{'f1_val': 0.6228932317284539, 'auprc': 0.7413449666758268, 'loss_val': 0.9316880652795374, 'psi': 0.6702739257074031}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=2.211397 (no previous merge yet)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9494805159864204, 'auprc': 0.9986762485940464, 'loss_val': 0.06522383011426312, 'psi': 0.9691588090294708}-{'f1_val': 0.9968617059779579, 'auprc': 0.996981425692118, 'loss_val': 0.019291282718710244, 'psi': 0.9969095938636219}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.912152 cos_to_last_merge=0.8810 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.7746753183379038, 'auprc': 0.9134281179642678, 'loss_val': 0.5111447110359263, 'psi': 0.8301764381884493}-{'f1_val': 0.9965259456095847, 'auprc': 0.9982972490059181, 'loss_val': 0.02272027208094334, 'psi': 0.9972344669681181}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=1.872707 cos_to_last_merge=0.8702 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.870
[S16] round=68 local utility u=0.020091 metrics={'f1_val': 0.9902007219715574, 'auprc': 0.9884864833585096, 'loss_val': 0.05097002863748128, 'psi': 0.9895150265263383}-{'f1_val': 0.9865167468621817, 'auprc': 0.9875341475349553, 'loss_val': 0.06619028390418609, 'psi': 0.9869237071312911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=68 head_norm_before_train=1.871690 cos_to_last_merge=0.7654 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.6849831139577548, 'auprc': 0.8944270892524437, 'loss_val': 1.2397126717681022, 'psi': 0.7687607040756304}-{'f1_val': 0.904725619379768, 'auprc': 0.9555937884282749, 'loss_val': 0.38966498622148377, 'psi': 0.9250728869991708}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=1.917176 cos_to_last_merge=0.8971 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.8341753012578308, 'auprc': 0.8119513922572362, 'loss_val': 0.35335108563665424, 'psi': 0.8252857376575929}-{'f1_val': 0.827607977432548, 'auprc': 0.8754322474154201, 'loss_val': 0.3944402092513678, 'psi': 0.8467376854256969}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.046562 cos_to_last_merge=0.9329 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.9134560084441964, 'auprc': 0.975399821495744, 'loss_val': 0.19220360664206115, 'psi': 0.9382335336648154}-{'f1_val': 0.9592181083661728, 'auprc': 0.9956136172988574, 'loss_val': 0.09349489817625639, 'psi': 0.9737763119392466}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=1.779205 cos_to_last_merge=0.9463 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=69 local utility u=0.001300 metrics={'f1_val': 0.9457754765927895, 'auprc': 0.89794300185066, 'loss_val': 0.29046324109436483, 'psi': 0.9266424866959377}-{'f1_val': 0.9420634662696883, 'auprc': 0.9072203971307624, 'loss_val': 0.29862421128041716, 'psi': 0.9281262386141179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=69 head_norm_before_train=1.666961 cos_to_last_merge=0.7211 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.721
[S5] round=69 local utility u=1.000000 metrics={'f1_val': 0.7598484353376863, 'auprc': 0.9968875465192197, 'loss_val': 0.1744998202932078, 'psi': 0.8546640798102997}-{'f1_val': 0.5409927372231964, 'auprc': 0.8555882145133461, 'loss_val': 0.9102457717595595, 'psi': 0.6668309281392564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=69 head_norm_before_train=2.104945 (no previous merge yet)
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.6240656016005626, 'auprc': 0.9151762060334844, 'loss_val': 0.9006280822405519, 'psi': 0.7405098433737314}-{'f1_val': 0.8821750089562949, 'auprc': 0.9685875505064846, 'loss_val': 0.2540744345519778, 'psi': 0.9167400255763707}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=69 head_norm_before_train=1.632465 cos_to_last_merge=0.9058 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.906
[S7] round=69 local utility u=1.000000 metrics={'f1_val': 0.6840386578447941, 'auprc': 0.8374488970705565, 'loss_val': 0.33482104412492736, 'psi': 0.7454027535350991}-{'f1_val': 0.461440533499627, 'auprc': 0.7790443441012554, 'loss_val': 0.9848043633863796, 'psi': 0.5884820577402784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=69 head_norm_before_train=1.865015 cos_to_last_merge=0.9384 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=69 local utility u=0.001043 metrics={'f1_val': 0.9925028268365944, 'auprc': 0.9992422234591752, 'loss_val': 0.03462073340404925, 'psi': 0.9951985854856267}-{'f1_val': 0.9921395546714198, 'auprc': 0.9992419026242053, 'loss_val': 0.034526682667984344, 'psi': 0.994980493852534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=69 head_norm_before_train=2.177973 (no previous merge yet)
[S9] round=69 local utility u=0.001515 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9976757654230731, 'loss_val': 0.016140329079315667, 'psi': 0.9973320536765149}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967371708179923, 'loss_val': 0.0163553435524016, 'psi': 0.9969566158344826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=69 head_norm_before_train=1.991409 cos_to_last_merge=0.9286 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9949697453895103, 'loss_val': 0.026896844641492015, 'psi': 0.9948513201654074}-{'f1_val': 0.9955774965436698, 'auprc': 0.9964040886143992, 'loss_val': 0.02431734064641073, 'psi': 0.9959081333719616}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=1.767786 cos_to_last_merge=0.8450 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.845
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998311524924043, 'loss_val': 0.021909271616087758, 'psi': 0.9970048149176027}-{'f1_val': 0.9961336749133093, 'auprc': 0.9982725939294652, 'loss_val': 0.021020106865984774, 'psi': 0.9969892425197717}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=69 head_norm_before_train=1.508109 cos_to_last_merge=0.8652 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.865
[S13] round=69 local utility u=0.441759 metrics={'f1_val': 0.6900596357560761, 'auprc': 0.7610939354326658, 'loss_val': 0.7061809161821865, 'psi': 0.718473355626712}-{'f1_val': 0.602911615590554, 'auprc': 0.7463176868962339, 'loss_val': 1.0224827458067927, 'psi': 0.6602740441128259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=69 head_norm_before_train=2.217952 (no previous merge yet)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.9304272073308006, 'auprc': 0.9986678399585389, 'loss_val': 0.19382417862784185, 'psi': 0.957723460381896}-{'f1_val': 0.9494805159864204, 'auprc': 0.9986762485940464, 'loss_val': 0.06522383011426312, 'psi': 0.9691588090294708}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=1.918447 cos_to_last_merge=0.8805 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.7470264071328151, 'auprc': 0.888021908056617, 'loss_val': 0.5720903239195899, 'psi': 0.8034246075023359}-{'f1_val': 0.7746753183379038, 'auprc': 0.9134281179642678, 'loss_val': 0.5111447110359263, 'psi': 0.8301764381884493}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=1.877670 cos_to_last_merge=0.8697 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.870
[S16] round=69 local utility u=0.007475 metrics={'f1_val': 0.9908306172892938, 'auprc': 0.991530902121176, 'loss_val': 0.04893250479618996, 'psi': 0.9911107312220466}-{'f1_val': 0.9902007219715574, 'auprc': 0.9884864833585096, 'loss_val': 0.05097002863748128, 'psi': 0.9895150265263383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S16] sending update (kind=head size=1809 to 1 peers)
[S17] START round=69 head_norm_before_train=1.876852 cos_to_last_merge=0.7653 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.6446859893059593, 'auprc': 0.8908215366682048, 'loss_val': 1.3158225333945994, 'psi': 0.7431402082508576}-{'f1_val': 0.6849831139577548, 'auprc': 0.8944270892524437, 'loss_val': 1.2397126717681022, 'psi': 0.7687607040756304}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=1.926425 cos_to_last_merge=0.8957 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.896
[S2] round=70 local utility u=0.008996 metrics={'f1_val': 0.8289987694619385, 'auprc': 0.848781476805069, 'loss_val': 0.41478925190121835, 'psi': 0.8369118523991907}-{'f1_val': 0.8341753012578308, 'auprc': 0.8119513922572362, 'loss_val': 0.35335108563665424, 'psi': 0.8252857376575929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=70 head_norm_before_train=2.052401 cos_to_last_merge=0.9324 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=70 local utility u=0.075341 metrics={'f1_val': 0.9223945780980686, 'auprc': 0.9880276283643565, 'loss_val': 0.13303679281291636, 'psi': 0.9486477982045838}-{'f1_val': 0.9134560084441964, 'auprc': 0.975399821495744, 'loss_val': 0.19220360664206115, 'psi': 0.9382335336648154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=70 head_norm_before_train=1.781367 cos_to_last_merge=0.9460 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=70 local utility u=0.061763 metrics={'f1_val': 0.9553864778960549, 'auprc': 0.9142749709861144, 'loss_val': 0.27359861169798566, 'psi': 0.9389418751320787}-{'f1_val': 0.9457754765927895, 'auprc': 0.89794300185066, 'loss_val': 0.29046324109436483, 'psi': 0.9266424866959377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=70 head_norm_before_train=1.668836 cos_to_last_merge=0.7211 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.721
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.6520267319972788, 'auprc': 0.9055599139829014, 'loss_val': 0.43513504622286897, 'psi': 0.7534400047915278}-{'f1_val': 0.7598484353376863, 'auprc': 0.9968875465192197, 'loss_val': 0.1744998202932078, 'psi': 0.8546640798102997}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=2.109003 (no previous merge yet)
[S6] round=70 local utility u=0.996087 metrics={'f1_val': 0.8657597688011683, 'auprc': 0.9277416946833299, 'loss_val': 0.396315586219196, 'psi': 0.890552539154033}-{'f1_val': 0.6240656016005626, 'auprc': 0.9151762060334844, 'loss_val': 0.9006280822405519, 'psi': 0.7405098433737314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=70 head_norm_before_train=1.637492 cos_to_last_merge=0.9052 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.5637339417777376, 'auprc': 0.780548229446659, 'loss_val': 0.8270216190795169, 'psi': 0.6504596568453063}-{'f1_val': 0.6840386578447941, 'auprc': 0.8374488970705565, 'loss_val': 0.33482104412492736, 'psi': 0.7454027535350991}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=1.869046 cos_to_last_merge=0.9383 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9696762611867975, 'auprc': 0.9960724687515424, 'loss_val': 0.08645390833831405, 'psi': 0.9802347442126955}-{'f1_val': 0.9925028268365944, 'auprc': 0.9992422234591752, 'loss_val': 0.03462073340404925, 'psi': 0.9951985854856267}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.182575 (no previous merge yet)
[S9] round=70 local utility u=0.003356 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9996561919678263, 'loss_val': 0.015370471190014544, 'psi': 0.9981242242944162}-{'f1_val': 0.9971029125121428, 'auprc': 0.9976757654230731, 'loss_val': 0.016140329079315667, 'psi': 0.9973320536765149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=70 head_norm_before_train=1.995248 cos_to_last_merge=0.9281 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=70 local utility u=0.003459 metrics={'f1_val': 0.9955774965436698, 'auprc': 0.9949558869404312, 'loss_val': 0.024768928858197304, 'psi': 0.9953288527023744}-{'f1_val': 0.9947723700160056, 'auprc': 0.9949697453895103, 'loss_val': 0.026896844641492015, 'psi': 0.9948513201654074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=70 head_norm_before_train=1.772554 cos_to_last_merge=0.8445 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.844
[S11] round=70 local utility u=0.001165 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9984019022080908, 'loss_val': 0.021301038619667225, 'psi': 0.9971859930286868}-{'f1_val': 0.9961336749133093, 'auprc': 0.998311524924043, 'loss_val': 0.021909271616087758, 'psi': 0.9970048149176027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=70 head_norm_before_train=1.512353 cos_to_last_merge=0.8641 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.864
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6097186096844922, 'auprc': 0.7720439494641308, 'loss_val': 0.9531308588663552, 'psi': 0.6746487455963477}-{'f1_val': 0.6900596357560761, 'auprc': 0.7610939354326658, 'loss_val': 0.7061809161821865, 'psi': 0.718473355626712}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=2.220721 (no previous merge yet)
[S14] round=70 local utility u=0.282880 metrics={'f1_val': 0.9964242878929871, 'auprc': 0.9985750028532094, 'loss_val': 0.02376760310067473, 'psi': 0.997284573877076}-{'f1_val': 0.9304272073308006, 'auprc': 0.9986678399585389, 'loss_val': 0.19382417862784185, 'psi': 0.957723460381896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=70 head_norm_before_train=1.925286 cos_to_last_merge=0.8797 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=70 local utility u=1.000000 metrics={'f1_val': 0.9753780493476981, 'auprc': 0.9968611081926437, 'loss_val': 0.05106335495933716, 'psi': 0.9839712728856763}-{'f1_val': 0.7470264071328151, 'auprc': 0.888021908056617, 'loss_val': 0.5720903239195899, 'psi': 0.8034246075023359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=70 head_norm_before_train=1.882143 cos_to_last_merge=0.8692 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.869
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.927643469245052, 'auprc': 0.9825299375331465, 'loss_val': 0.4417209367656701, 'psi': 0.9495980565602897}-{'f1_val': 0.9908306172892938, 'auprc': 0.991530902121176, 'loss_val': 0.04893250479618996, 'psi': 0.9911107312220466}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=70 head_norm_before_train=1.883967 cos_to_last_merge=0.7651 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=70 local utility u=0.657124 metrics={'f1_val': 0.7272612839077189, 'auprc': 0.9458456376731783, 'loss_val': 0.6620985139867991, 'psi': 0.8146950254139027}-{'f1_val': 0.6446859893059593, 'auprc': 0.8908215366682048, 'loss_val': 1.3158225333945994, 'psi': 0.7431402082508576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=71 head_norm_before_train=1.933680 cos_to_last_merge=0.8949 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.895
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.8271439194170285, 'auprc': 0.8338951274809727, 'loss_val': 0.41643692076521965, 'psi': 0.8298444026426062}-{'f1_val': 0.8289987694619385, 'auprc': 0.848781476805069, 'loss_val': 0.41478925190121835, 'psi': 0.8369118523991907}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.058354 cos_to_last_merge=0.9318 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9096377984254365, 'auprc': 0.9743499789084227, 'loss_val': 0.2144747942775336, 'psi': 0.935522670618631}-{'f1_val': 0.9223945780980686, 'auprc': 0.9880276283643565, 'loss_val': 0.13303679281291636, 'psi': 0.9486477982045838}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.787700 cos_to_last_merge=0.9454 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9524227288095045, 'auprc': 0.8991802730885976, 'loss_val': 0.28452377017476105, 'psi': 0.9311257465211418}-{'f1_val': 0.9553864778960549, 'auprc': 0.9142749709861144, 'loss_val': 0.27359861169798566, 'psi': 0.9389418751320787}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.670009 cos_to_last_merge=0.7205 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.720
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.6720436317074145, 'auprc': 0.8661384359080317, 'loss_val': 0.4983997227965562, 'psi': 0.7496815533876615}-{'f1_val': 0.6520267319972788, 'auprc': 0.9055599139829014, 'loss_val': 0.43513504622286897, 'psi': 0.7534400047915278}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=2.115200 (no previous merge yet)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.5148731802241799, 'auprc': 0.8703020874531513, 'loss_val': 0.9129845021512657, 'psi': 0.6570447431157684}-{'f1_val': 0.8657597688011683, 'auprc': 0.9277416946833299, 'loss_val': 0.396315586219196, 'psi': 0.890552539154033}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=1.641561 cos_to_last_merge=0.9047 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=71 local utility u=0.573739 metrics={'f1_val': 0.6641030355009758, 'auprc': 0.8212196112766803, 'loss_val': 0.4037727393674925, 'psi': 0.7269496658112576}-{'f1_val': 0.5637339417777376, 'auprc': 0.780548229446659, 'loss_val': 0.8270216190795169, 'psi': 0.6504596568453063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=71 head_norm_before_train=1.874781 cos_to_last_merge=0.9380 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=71 local utility u=0.050451 metrics={'f1_val': 0.9794201257789011, 'auprc': 0.9991845392714818, 'loss_val': 0.053350807026599834, 'psi': 0.9873258911759334}-{'f1_val': 0.9696762611867975, 'auprc': 0.9960724687515424, 'loss_val': 0.08645390833831405, 'psi': 0.9802347442126955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=71 head_norm_before_train=2.187847 (no previous merge yet)
[S9] round=71 local utility u=0.001184 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9995794189474257, 'loss_val': 0.015237988320054243, 'psi': 0.9983400580330168}-{'f1_val': 0.9971029125121428, 'auprc': 0.9996561919678263, 'loss_val': 0.015370471190014544, 'psi': 0.9981242242944162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=71 head_norm_before_train=2.000480 cos_to_last_merge=0.9274 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9926749258789659, 'loss_val': 0.03087036673963519, 'psi': 0.9936838093786391}-{'f1_val': 0.9955774965436698, 'auprc': 0.9949558869404312, 'loss_val': 0.024768928858197304, 'psi': 0.9953288527023744}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=1.777422 cos_to_last_merge=0.8439 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.844
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9951720993607791, 'auprc': 0.9988037736200723, 'loss_val': 0.024420242798101285, 'psi': 0.9966247690644965}-{'f1_val': 0.9963753869090841, 'auprc': 0.9984019022080908, 'loss_val': 0.021301038619667225, 'psi': 0.9971859930286868}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.516381 cos_to_last_merge=0.8633 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.863
[S13] round=71 local utility u=0.272725 metrics={'f1_val': 0.6676304936839534, 'auprc': 0.7697570918856156, 'loss_val': 0.748292303822187, 'psi': 0.7084811329646183}-{'f1_val': 0.6097186096844922, 'auprc': 0.7720439494641308, 'loss_val': 0.9531308588663552, 'psi': 0.6746487455963477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=71 head_norm_before_train=2.223742 (no previous merge yet)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.994318857898095, 'auprc': 0.9986258271484871, 'loss_val': 0.02675526468860455, 'psi': 0.9960416455982518}-{'f1_val': 0.9964242878929871, 'auprc': 0.9985750028532094, 'loss_val': 0.02376760310067473, 'psi': 0.997284573877076}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=1.932066 cos_to_last_merge=0.8789 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.879
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.7574142695767728, 'auprc': 0.9884411538647379, 'loss_val': 0.4647131386034865, 'psi': 0.8498250232919589}-{'f1_val': 0.9753780493476981, 'auprc': 0.9968611081926437, 'loss_val': 0.05106335495933716, 'psi': 0.9839712728856763}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=1.887525 cos_to_last_merge=0.8687 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.869
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.8890925541766368, 'auprc': 0.9819054386975284, 'loss_val': 0.6260216915668145, 'psi': 0.9262177079849935}-{'f1_val': 0.927643469245052, 'auprc': 0.9825299375331465, 'loss_val': 0.4417209367656701, 'psi': 0.9495980565602897}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=1.888982 cos_to_last_merge=0.7649 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.6877064605521396, 'auprc': 0.8992071855173278, 'loss_val': 1.1985469892759464, 'psi': 0.7723067505382148}-{'f1_val': 0.7272612839077189, 'auprc': 0.9458456376731783, 'loss_val': 0.6620985139867991, 'psi': 0.8146950254139027}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=1.938026 cos_to_last_merge=0.8946 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.895
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.8295797321511562, 'auprc': 0.8053365163259174, 'loss_val': 0.4137675153742818, 'psi': 0.8198824458210607}-{'f1_val': 0.8271439194170285, 'auprc': 0.8338951274809727, 'loss_val': 0.41643692076521965, 'psi': 0.8298444026426062}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.065237 cos_to_last_merge=0.9311 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=72 local utility u=0.296714 metrics={'f1_val': 0.9714371643715293, 'auprc': 0.9961678447948499, 'loss_val': 0.05729649285233803, 'psi': 0.9813294365408575}-{'f1_val': 0.9096377984254365, 'auprc': 0.9743499789084227, 'loss_val': 0.2144747942775336, 'psi': 0.935522670618631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=72 head_norm_before_train=1.792004 cos_to_last_merge=0.9450 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=72 local utility u=0.006848 metrics={'f1_val': 0.9525136659458132, 'auprc': 0.9023317984201124, 'loss_val': 0.28082835800193656, 'psi': 0.9324409189355328}-{'f1_val': 0.9524227288095045, 'auprc': 0.8991802730885976, 'loss_val': 0.28452377017476105, 'psi': 0.9311257465211418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=72 head_norm_before_train=1.673833 cos_to_last_merge=0.7197 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.720
[S5] round=72 local utility u=0.282849 metrics={'f1_val': 0.7001595088957335, 'auprc': 0.9789290461706345, 'loss_val': 0.43976928242422464, 'psi': 0.811667323805694}-{'f1_val': 0.6720436317074145, 'auprc': 0.8661384359080317, 'loss_val': 0.4983997227965562, 'psi': 0.7496815533876615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=72 head_norm_before_train=2.119453 (no previous merge yet)
[S6] round=72 local utility u=1.000000 metrics={'f1_val': 0.7792195702708296, 'auprc': 0.9406433186138733, 'loss_val': 0.5305108134212217, 'psi': 0.843789069608047}-{'f1_val': 0.5148731802241799, 'auprc': 0.8703020874531513, 'loss_val': 0.9129845021512657, 'psi': 0.6570447431157684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=72 head_norm_before_train=1.646496 cos_to_last_merge=0.9042 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.904
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.5410826644272535, 'auprc': 0.7788257950045363, 'loss_val': 0.9129284812780617, 'psi': 0.6361799166581665}-{'f1_val': 0.6641030355009758, 'auprc': 0.8212196112766803, 'loss_val': 0.4037727393674925, 'psi': 0.7269496658112576}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=1.881935 cos_to_last_merge=0.9374 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=72 local utility u=0.038584 metrics={'f1_val': 0.9941417884415487, 'auprc': 0.9891089877851957, 'loss_val': 0.03428525727341147, 'psi': 0.9921286681790075}-{'f1_val': 0.9794201257789011, 'auprc': 0.9991845392714818, 'loss_val': 0.053350807026599834, 'psi': 0.9873258911759334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=72 head_norm_before_train=2.193380 (no previous merge yet)
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9995721642731508, 'loss_val': 0.015559065726781451, 'psi': 0.9980888954327983}-{'f1_val': 0.9975138174234109, 'auprc': 0.9995794189474257, 'loss_val': 0.015237988320054243, 'psi': 0.9983400580330168}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.006441 cos_to_last_merge=0.9268 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=72 local utility u=0.011434 metrics={'f1_val': 0.9959993230775146, 'auprc': 0.9949303187995656, 'loss_val': 0.024627024936404972, 'psi': 0.995571721366335}-{'f1_val': 0.9943563983784213, 'auprc': 0.9926749258789659, 'loss_val': 0.03087036673963519, 'psi': 0.9936838093786391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=72 head_norm_before_train=1.782288 cos_to_last_merge=0.8434 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.843
[S11] round=72 local utility u=0.004856 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9987928906597698, 'loss_val': 0.022018201160847857, 'psi': 0.9973546685823744}-{'f1_val': 0.9951720993607791, 'auprc': 0.9988037736200723, 'loss_val': 0.024420242798101285, 'psi': 0.9966247690644965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=72 head_norm_before_train=1.520232 cos_to_last_merge=0.8625 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.863
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6308151021349412, 'auprc': 0.7583290668944864, 'loss_val': 1.0695493725153407, 'psi': 0.6818206880387593}-{'f1_val': 0.6676304936839534, 'auprc': 0.7697570918856156, 'loss_val': 0.748292303822187, 'psi': 0.7084811329646183}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.230126 (no previous merge yet)
[S14] round=72 local utility u=0.002502 metrics={'f1_val': 0.9958136437598912, 'auprc': 0.996937104783563, 'loss_val': 0.025654153230999923, 'psi': 0.9962630281693599}-{'f1_val': 0.994318857898095, 'auprc': 0.9986258271484871, 'loss_val': 0.02675526468860455, 'psi': 0.9960416455982518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=72 head_norm_before_train=1.938369 cos_to_last_merge=0.8781 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.878
[S15] round=72 local utility u=0.944678 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9958297763890508, 'loss_val': 0.02844991397031169, 'psi': 0.9958732217638111}-{'f1_val': 0.7574142695767728, 'auprc': 0.9884411538647379, 'loss_val': 0.4647131386034865, 'psi': 0.8498250232919589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=72 head_norm_before_train=1.893575 cos_to_last_merge=0.8681 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.868
[S16] round=72 local utility u=0.607989 metrics={'f1_val': 0.9915433264489799, 'auprc': 0.9883623358389783, 'loss_val': 0.04411976950975005, 'psi': 0.9902709302049792}-{'f1_val': 0.8890925541766368, 'auprc': 0.9819054386975284, 'loss_val': 0.6260216915668145, 'psi': 0.9262177079849935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] sending update (kind=head size=1808 to 1 peers)
[S17] START round=72 head_norm_before_train=1.893800 cos_to_last_merge=0.7647 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.6516182705982789, 'auprc': 0.836199643474975, 'loss_val': 1.4915794201305432, 'psi': 0.7254508197489573}-{'f1_val': 0.6877064605521396, 'auprc': 0.8992071855173278, 'loss_val': 1.1985469892759464, 'psi': 0.7723067505382148}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=1.945030 cos_to_last_merge=0.8936 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.894
[S2] round=73 local utility u=0.065282 metrics={'f1_val': 0.8304096912543816, 'auprc': 0.8466448398681192, 'loss_val': 0.41210838654990906, 'psi': 0.8369037506998767}-{'f1_val': 0.8295797321511562, 'auprc': 0.8053365163259174, 'loss_val': 0.4137675153742818, 'psi': 0.8198824458210607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=73 head_norm_before_train=2.072102 cos_to_last_merge=0.9304 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.6982344347081144, 'auprc': 0.9653103017981111, 'loss_val': 0.6622866076718928, 'psi': 0.8050647815441131}-{'f1_val': 0.9714371643715293, 'auprc': 0.9961678447948499, 'loss_val': 0.05729649285233803, 'psi': 0.9813294365408575}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.789741 cos_to_last_merge=0.9449 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9497398761737273, 'auprc': 0.906441913342515, 'loss_val': 0.2846014068948971, 'psi': 0.9324206910412424}-{'f1_val': 0.9525136659458132, 'auprc': 0.9023317984201124, 'loss_val': 0.28082835800193656, 'psi': 0.9324409189355328}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=1.677992 cos_to_last_merge=0.7192 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=73 local utility u=0.037177 metrics={'f1_val': 0.7002451011760882, 'auprc': 0.9704795967403305, 'loss_val': 0.3405809542592216, 'psi': 0.808338899401785}-{'f1_val': 0.7001595088957335, 'auprc': 0.9789290461706345, 'loss_val': 0.43976928242422464, 'psi': 0.811667323805694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=73 head_norm_before_train=2.122967 (no previous merge yet)
[S6] round=73 local utility u=0.018744 metrics={'f1_val': 0.7802128479505361, 'auprc': 0.944035603240557, 'loss_val': 0.5091599817694016, 'psi': 0.8457419500665445}-{'f1_val': 0.7792195702708296, 'auprc': 0.9406433186138733, 'loss_val': 0.5305108134212217, 'psi': 0.843789069608047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=73 head_norm_before_train=1.652930 cos_to_last_merge=0.9034 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.903
[S7] round=73 local utility u=0.997265 metrics={'f1_val': 0.6954646053898724, 'auprc': 0.911740812369124, 'loss_val': 0.24343545381191786, 'psi': 0.781975088181573}-{'f1_val': 0.5410826644272535, 'auprc': 0.7788257950045363, 'loss_val': 0.9129284812780617, 'psi': 0.6361799166581665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=73 head_norm_before_train=1.887510 cos_to_last_merge=0.9373 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.8043672403689327, 'auprc': 0.9989509963574329, 'loss_val': 0.41674583229433426, 'psi': 0.8822007427643328}-{'f1_val': 0.9941417884415487, 'auprc': 0.9891089877851957, 'loss_val': 0.03428525727341147, 'psi': 0.9921286681790075}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=2.195720 (no previous merge yet)
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963318702201827, 'loss_val': 0.016681043811334215, 'psi': 0.9967944955953587}-{'f1_val': 0.9971000495392299, 'auprc': 0.9995721642731508, 'loss_val': 0.015559065726781451, 'psi': 0.9980888954327983}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=2.012638 cos_to_last_merge=0.9262 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9958513299987508, 'loss_val': 0.024690290772629565, 'psi': 0.995321443918546}-{'f1_val': 0.9959993230775146, 'auprc': 0.9949303187995656, 'loss_val': 0.024627024936404972, 'psi': 0.995571721366335}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=1.786643 cos_to_last_merge=0.8429 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.843
[S11] round=73 local utility u=0.000002 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9987348899156142, 'loss_val': 0.020267328368191142, 'psi': 0.9971741609142313}-{'f1_val': 0.9963958538641108, 'auprc': 0.9987928906597698, 'loss_val': 0.022018201160847857, 'psi': 0.9973546685823744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=73 head_norm_before_train=1.525870 cos_to_last_merge=0.8614 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.861
[S13] round=73 local utility u=0.003347 metrics={'f1_val': 0.6245821251803437, 'auprc': 0.7655077067590854, 'loss_val': 1.0469942922760194, 'psi': 0.6809523578118404}-{'f1_val': 0.6308151021349412, 'auprc': 0.7583290668944864, 'loss_val': 1.0695493725153407, 'psi': 0.6818206880387593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=73 head_norm_before_train=2.237216 (no previous merge yet)
[S14] round=73 local utility u=0.010811 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.996934155231838, 'loss_val': 0.015307659009548752, 'psi': 0.9973902619650331}-{'f1_val': 0.9958136437598912, 'auprc': 0.996937104783563, 'loss_val': 0.025654153230999923, 'psi': 0.9962630281693599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=73 head_norm_before_train=1.944306 cos_to_last_merge=0.8776 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.878
[S15] round=73 local utility u=0.004842 metrics={'f1_val': 0.9958217461321837, 'auprc': 0.9979767887201906, 'loss_val': 0.024724179620047883, 'psi': 0.9966837631673865}-{'f1_val': 0.9959021853469847, 'auprc': 0.9958297763890508, 'loss_val': 0.02844991397031169, 'psi': 0.9958732217638111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=73 head_norm_before_train=1.900307 cos_to_last_merge=0.8674 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.867
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9897402421431578, 'auprc': 0.9859831366812257, 'loss_val': 0.054756104947125434, 'psi': 0.988237399958385}-{'f1_val': 0.9915433264489799, 'auprc': 0.9883623358389783, 'loss_val': 0.04411976950975005, 'psi': 0.9902709302049792}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=1.900991 cos_to_last_merge=0.7643 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=73 local utility u=0.121265 metrics={'f1_val': 0.6749845448275426, 'auprc': 0.8392250466051441, 'loss_val': 1.3983228282328142, 'psi': 0.7406807455385832}-{'f1_val': 0.6516182705982789, 'auprc': 0.836199643474975, 'loss_val': 1.4915794201305432, 'psi': 0.7254508197489573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=74 head_norm_before_train=1.953555 cos_to_last_merge=0.8922 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.892
[S2] round=74 local utility u=0.033785 metrics={'f1_val': 0.8306015180017311, 'auprc': 0.8707088923642776, 'loss_val': 0.4178824437310585, 'psi': 0.8466444677467497}-{'f1_val': 0.8304096912543816, 'auprc': 0.8466448398681192, 'loss_val': 0.41210838654990906, 'psi': 0.8369037506998767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=74 head_norm_before_train=2.078254 cos_to_last_merge=0.9298 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=74 local utility u=0.560956 metrics={'f1_val': 0.818304562130114, 'auprc': 0.9970714890858776, 'loss_val': 0.35607827743155046, 'psi': 0.8898113329124195}-{'f1_val': 0.6982344347081144, 'auprc': 0.9653103017981111, 'loss_val': 0.6622866076718928, 'psi': 0.8050647815441131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=74 head_norm_before_train=1.788289 cos_to_last_merge=0.9445 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=74 local utility u=0.057687 metrics={'f1_val': 0.9494953733639961, 'auprc': 0.9446850391514547, 'loss_val': 0.2824903635544953, 'psi': 0.9475712396789795}-{'f1_val': 0.9497398761737273, 'auprc': 0.906441913342515, 'loss_val': 0.2846014068948971, 'psi': 0.9324206910412424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=74 head_norm_before_train=1.681051 cos_to_last_merge=0.7194 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.4438643372579359, 'auprc': 0.8533994183932512, 'loss_val': 1.1013426842334586, 'psi': 0.607678369712062}-{'f1_val': 0.7002451011760882, 'auprc': 0.9704795967403305, 'loss_val': 0.3405809542592216, 'psi': 0.808338899401785}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=2.129147 (no previous merge yet)
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.5872656656042289, 'auprc': 0.8324302465343736, 'loss_val': 1.0191883828435626, 'psi': 0.6853314979762868}-{'f1_val': 0.7802128479505361, 'auprc': 0.944035603240557, 'loss_val': 0.5091599817694016, 'psi': 0.8457419500665445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=74 head_norm_before_train=1.657334 cos_to_last_merge=0.9028 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.903
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5784673250127389, 'auprc': 0.7789250066061953, 'loss_val': 0.844537139152026, 'psi': 0.6586503976501215}-{'f1_val': 0.6954646053898724, 'auprc': 0.911740812369124, 'loss_val': 0.24343545381191786, 'psi': 0.781975088181573}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=1.893171 cos_to_last_merge=0.9369 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=74 local utility u=0.754212 metrics={'f1_val': 0.9917768254438665, 'auprc': 0.9989686971943189, 'loss_val': 0.032832160899297816, 'psi': 0.9946535741440474}-{'f1_val': 0.8043672403689327, 'auprc': 0.9989509963574329, 'loss_val': 0.41674583229433426, 'psi': 0.8822007427643328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=74 head_norm_before_train=2.198503 (no previous merge yet)
[S9] round=74 local utility u=0.002446 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9995227771466952, 'loss_val': 0.01637137335245731, 'psi': 0.9975717282969218}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963318702201827, 'loss_val': 0.016681043811334215, 'psi': 0.9967944955953587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=74 head_norm_before_train=2.016951 cos_to_last_merge=0.9257 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9943878853620715, 'loss_val': 0.02835133522991946, 'psi': 0.9943689931718813}-{'f1_val': 0.9949681865317428, 'auprc': 0.9958513299987508, 'loss_val': 0.024690290772629565, 'psi': 0.995321443918546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=1.792254 cos_to_last_merge=0.8424 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.842
[S11] round=74 local utility u=0.000002 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986202111093716, 'loss_val': 0.02004128013550022, 'psi': 0.9971405692901959}-{'f1_val': 0.9961336749133093, 'auprc': 0.9987348899156142, 'loss_val': 0.020267328368191142, 'psi': 0.9971741609142313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=74 head_norm_before_train=1.529817 cos_to_last_merge=0.8606 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.861
[S13] round=74 local utility u=0.181147 metrics={'f1_val': 0.6425414328861049, 'auprc': 0.7749579344371212, 'loss_val': 0.8208072910991951, 'psi': 0.6955080335065114}-{'f1_val': 0.6245821251803437, 'auprc': 0.7655077067590854, 'loss_val': 1.0469942922760194, 'psi': 0.6809523578118404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=74 head_norm_before_train=2.242503 (no previous merge yet)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9972835715563582, 'auprc': 0.9969311356373416, 'loss_val': 0.016336792908366315, 'psi': 0.9971425971887515}-{'f1_val': 0.9976943331204965, 'auprc': 0.996934155231838, 'loss_val': 0.015307659009548752, 'psi': 0.9973902619650331}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=1.950373 cos_to_last_merge=0.8771 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.877
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.7033204863594102, 'auprc': 0.8896946530435023, 'loss_val': 0.6457329196003377, 'psi': 0.7778701530330471}-{'f1_val': 0.9958217461321837, 'auprc': 0.9979767887201906, 'loss_val': 0.024724179620047883, 'psi': 0.9966837631673865}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=1.905233 cos_to_last_merge=0.8669 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.867
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9430553118412857, 'auprc': 0.9791490399169729, 'loss_val': 0.35446691057984414, 'psi': 0.9574928030715606}-{'f1_val': 0.9897402421431578, 'auprc': 0.9859831366812257, 'loss_val': 0.054756104947125434, 'psi': 0.988237399958385}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=1.907192 cos_to_last_merge=0.7641 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=74 local utility u=0.897397 metrics={'f1_val': 0.8582869454492299, 'auprc': 0.8535372880020209, 'loss_val': 0.7462809243574379, 'psi': 0.8563870824703462}-{'f1_val': 0.6749845448275426, 'auprc': 0.8392250466051441, 'loss_val': 1.3983228282328142, 'psi': 0.7406807455385832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=75 head_norm_before_train=1.962668 cos_to_last_merge=0.8908 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.891
[S2] round=75 local utility u=0.005814 metrics={'f1_val': 0.8312963963729642, 'auprc': 0.8736586902177987, 'loss_val': 0.419272743449415, 'psi': 0.848241313910898}-{'f1_val': 0.8306015180017311, 'auprc': 0.8707088923642776, 'loss_val': 0.4178824437310585, 'psi': 0.8466444677467497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=75 head_norm_before_train=2.084182 cos_to_last_merge=0.9292 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=75 local utility u=0.152309 metrics={'f1_val': 0.8599658451924502, 'auprc': 0.9756328270971667, 'loss_val': 0.23711193811839695, 'psi': 0.9062326379543368}-{'f1_val': 0.818304562130114, 'auprc': 0.9970714890858776, 'loss_val': 0.35607827743155046, 'psi': 0.8898113329124195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=75 head_norm_before_train=1.786336 cos_to_last_merge=0.9443 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9452298462558633, 'auprc': 0.9543340388266135, 'loss_val': 0.2922537249190966, 'psi': 0.9488715232841634}-{'f1_val': 0.9494953733639961, 'auprc': 0.9446850391514547, 'loss_val': 0.2824903635544953, 'psi': 0.9475712396789795}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=1.683406 cos_to_last_merge=0.7189 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=75 local utility u=1.000000 metrics={'f1_val': 0.9961420887187077, 'auprc': 0.9978681870335366, 'loss_val': 0.08307876363308922, 'psi': 0.9968325280446393}-{'f1_val': 0.4438643372579359, 'auprc': 0.8533994183932512, 'loss_val': 1.1013426842334586, 'psi': 0.607678369712062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=75 head_norm_before_train=2.136246 (no previous merge yet)
[S6] round=75 local utility u=0.941911 metrics={'f1_val': 0.7713006822295855, 'auprc': 0.9523010781517602, 'loss_val': 0.5991897554367881, 'psi': 0.8437008405984554}-{'f1_val': 0.5872656656042289, 'auprc': 0.8324302465343736, 'loss_val': 1.0191883828435626, 'psi': 0.6853314979762868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=75 head_norm_before_train=1.659695 cos_to_last_merge=0.9023 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.902
[S7] round=75 local utility u=0.281148 metrics={'f1_val': 0.6290648016687839, 'auprc': 0.7900558284183137, 'loss_val': 0.6192188020579045, 'psi': 0.6934612123685958}-{'f1_val': 0.5784673250127389, 'auprc': 0.7789250066061953, 'loss_val': 0.844537139152026, 'psi': 0.6586503976501215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=75 head_norm_before_train=1.896567 cos_to_last_merge=0.9372 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=75 local utility u=0.002250 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9992787594483942, 'loss_val': 0.03118532338775228, 'psi': 0.9949698879983768}-{'f1_val': 0.9917768254438665, 'auprc': 0.9989686971943189, 'loss_val': 0.032832160899297816, 'psi': 0.9946535741440474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=75 head_norm_before_train=2.203040 (no previous merge yet)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9991884913580515, 'loss_val': 0.03161673781719085, 'psi': 0.9941686978548869}-{'f1_val': 0.9962710290637395, 'auprc': 0.9995227771466952, 'loss_val': 0.01637137335245731, 'psi': 0.9975717282969218}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.020012 cos_to_last_merge=0.9251 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=75 local utility u=0.011444 metrics={'f1_val': 0.9959993230775146, 'auprc': 0.9972027458949825, 'loss_val': 0.023765263929585466, 'psi': 0.9964806922045018}-{'f1_val': 0.9943563983784213, 'auprc': 0.9943878853620715, 'loss_val': 0.02835133522991946, 'psi': 0.9943689931718813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=75 head_norm_before_train=1.798409 cos_to_last_merge=0.8418 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.842
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.8557487309768232, 'auprc': 0.9969268346827779, 'loss_val': 0.18070237557199476, 'psi': 0.912219972459205}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986202111093716, 'loss_val': 0.02004128013550022, 'psi': 0.9971405692901959}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=1.533397 cos_to_last_merge=0.8599 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.860
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.6351136282271517, 'auprc': 0.8181380477024384, 'loss_val': 1.1676262355696716, 'psi': 0.7083233960172663}-{'f1_val': 0.6425414328861049, 'auprc': 0.7749579344371212, 'loss_val': 0.8208072910991951, 'psi': 0.6955080335065114}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=2.247354 (no previous merge yet)
[S14] round=75 local utility u=0.003697 metrics={'f1_val': 0.9976730958346192, 'auprc': 0.9985850964549271, 'loss_val': 0.016241347541338647, 'psi': 0.9980378960827423}-{'f1_val': 0.9972835715563582, 'auprc': 0.9969311356373416, 'loss_val': 0.016336792908366315, 'psi': 0.9971425971887515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=75 head_norm_before_train=1.956641 cos_to_last_merge=0.8765 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.876
[S15] round=75 local utility u=0.688789 metrics={'f1_val': 0.8322004316822029, 'auprc': 0.9923543995007474, 'loss_val': 0.34941332045925855, 'psi': 0.8962620188096208}-{'f1_val': 0.7033204863594102, 'auprc': 0.8896946530435023, 'loss_val': 0.6457329196003377, 'psi': 0.7778701530330471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=75 head_norm_before_train=1.910888 cos_to_last_merge=0.8664 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.866
[S16] round=75 local utility u=0.264918 metrics={'f1_val': 0.9818849296143674, 'auprc': 0.9857158202134684, 'loss_val': 0.07730957287520039, 'psi': 0.9834172858540078}-{'f1_val': 0.9430553118412857, 'auprc': 0.9791490399169729, 'loss_val': 0.35446691057984414, 'psi': 0.9574928030715606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=75 head_norm_before_train=1.911016 cos_to_last_merge=0.7641 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.679543475843239, 'auprc': 0.8606309845788302, 'loss_val': 1.3834020151750739, 'psi': 0.7519784793374755}-{'f1_val': 0.8582869454492299, 'auprc': 0.8535372880020209, 'loss_val': 0.7462809243574379, 'psi': 0.8563870824703462}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=76 head_norm_before_train=1.971118 cos_to_last_merge=0.8894 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.8307933718689708, 'auprc': 0.873955569523089, 'loss_val': 0.4308045087131619, 'psi': 0.848058250930618}-{'f1_val': 0.8312963963729642, 'auprc': 0.8736586902177987, 'loss_val': 0.419272743449415, 'psi': 0.848241313910898}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=2.089747 cos_to_last_merge=0.9286 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.8504960914630315, 'auprc': 0.9663024503063382, 'loss_val': 0.3243025421713782, 'psi': 0.8968186350003542}-{'f1_val': 0.8599658451924502, 'auprc': 0.9756328270971667, 'loss_val': 0.23711193811839695, 'psi': 0.9062326379543368}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.786735 cos_to_last_merge=0.9438 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=76 local utility u=0.012578 metrics={'f1_val': 0.9460590864896437, 'auprc': 0.960837041546631, 'loss_val': 0.2915821293553833, 'psi': 0.9519702685124386}-{'f1_val': 0.9452298462558633, 'auprc': 0.9543340388266135, 'loss_val': 0.2922537249190966, 'psi': 0.9488715232841634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=76 head_norm_before_train=1.685861 cos_to_last_merge=0.7187 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.6893367341140562, 'auprc': 0.944592106698885, 'loss_val': 0.4731164201932421, 'psi': 0.7914388831479877}-{'f1_val': 0.9961420887187077, 'auprc': 0.9978681870335366, 'loss_val': 0.08307876363308922, 'psi': 0.9968325280446393}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=2.141049 (no previous merge yet)
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.645637715052336, 'auprc': 0.9056368159478179, 'loss_val': 0.8947490752803928, 'psi': 0.7496373554105287}-{'f1_val': 0.7713006822295855, 'auprc': 0.9523010781517602, 'loss_val': 0.5991897554367881, 'psi': 0.8437008405984554}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.664361 cos_to_last_merge=0.9016 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.902
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.6149374607901874, 'auprc': 0.785485463472909, 'loss_val': 0.6716131430516372, 'psi': 0.6831566618632761}-{'f1_val': 0.6290648016687839, 'auprc': 0.7900558284183137, 'loss_val': 0.6192188020579045, 'psi': 0.6934612123685958}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=1.899021 cos_to_last_merge=0.9367 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9853156051557337, 'auprc': 0.9991388065792774, 'loss_val': 0.04545384717076108, 'psi': 0.9908448857251512}-{'f1_val': 0.9920973070316986, 'auprc': 0.9992787594483942, 'loss_val': 0.03118532338775228, 'psi': 0.9949698879983768}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=76 head_norm_before_train=2.208410 (no previous merge yet)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.999278138727926, 'loss_val': 0.03427307990415438, 'psi': 0.9939510496739277}-{'f1_val': 0.9908221688527771, 'auprc': 0.9991884913580515, 'loss_val': 0.03161673781719085, 'psi': 0.9941686978548869}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.023614 cos_to_last_merge=0.9247 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962818221466847, 'loss_val': 0.024148862880032054, 'psi': 0.9956254322702986}-{'f1_val': 0.9959993230775146, 'auprc': 0.9972027458949825, 'loss_val': 0.023765263929585466, 'psi': 0.9964806922045018}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=1.803568 cos_to_last_merge=0.8413 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.841
[S11] round=76 local utility u=0.505297 metrics={'f1_val': 0.9968129605654896, 'auprc': 0.9983669153430565, 'loss_val': 0.020813422551634767, 'psi': 0.9974345424765164}-{'f1_val': 0.8557487309768232, 'auprc': 0.9969268346827779, 'loss_val': 0.18070237557199476, 'psi': 0.912219972459205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=76 head_norm_before_train=1.538842 cos_to_last_merge=0.8589 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=76 local utility u=0.033047 metrics={'f1_val': 0.6388851396693739, 'auprc': 0.8089552921211831, 'loss_val': 1.0966123962568552, 'psi': 0.7069132006500976}-{'f1_val': 0.6351136282271517, 'auprc': 0.8181380477024384, 'loss_val': 1.1676262355696716, 'psi': 0.7083233960172663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=76 head_norm_before_train=2.251664 (no previous merge yet)
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9969275763244393, 'loss_val': 0.014278856136679154, 'psi': 0.9973876304020737}-{'f1_val': 0.9976730958346192, 'auprc': 0.9985850964549271, 'loss_val': 0.016241347541338647, 'psi': 0.9980378960827423}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=1.961480 cos_to_last_merge=0.8758 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.876
[S15] round=76 local utility u=0.664246 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970199858926403, 'loss_val': 0.022194538404021073, 'psi': 0.9968559953895685}-{'f1_val': 0.8322004316822029, 'auprc': 0.9923543995007474, 'loss_val': 0.34941332045925855, 'psi': 0.8962620188096208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=76 head_norm_before_train=1.917279 cos_to_last_merge=0.8658 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.866
[S16] round=76 local utility u=0.049288 metrics={'f1_val': 0.9923708438319017, 'auprc': 0.98676850985367, 'loss_val': 0.04480797000003375, 'psi': 0.9901299102406089}-{'f1_val': 0.9818849296143674, 'auprc': 0.9857158202134684, 'loss_val': 0.07730957287520039, 'psi': 0.9834172858540078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=76 head_norm_before_train=1.913518 cos_to_last_merge=0.7638 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.6623226741022529, 'auprc': 0.8708310149012854, 'loss_val': 1.4140429902673346, 'psi': 0.7457260104218659}-{'f1_val': 0.679543475843239, 'auprc': 0.8606309845788302, 'loss_val': 1.3834020151750739, 'psi': 0.7519784793374755}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=77 head_norm_before_train=1.980120 cos_to_last_merge=0.8879 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.888
[S2] round=77 local utility u=0.102366 metrics={'f1_val': 0.827484908798222, 'auprc': 0.950245102016011, 'loss_val': 0.4350903356411434, 'psi': 0.8765889860853375}-{'f1_val': 0.8307933718689708, 'auprc': 0.873955569523089, 'loss_val': 0.4308045087131619, 'psi': 0.848058250930618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=77 head_norm_before_train=2.095101 cos_to_last_merge=0.9281 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=77 local utility u=0.454390 metrics={'f1_val': 0.9477271735182152, 'auprc': 0.9992721133149662, 'loss_val': 0.09781822715779472, 'psi': 0.9683451494369156}-{'f1_val': 0.8504960914630315, 'auprc': 0.9663024503063382, 'loss_val': 0.3243025421713782, 'psi': 0.8968186350003542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=77 head_norm_before_train=1.792321 cos_to_last_merge=0.9432 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.943
[S4] round=77 local utility u=0.015415 metrics={'f1_val': 0.9498999322739274, 'auprc': 0.9625558477739362, 'loss_val': 0.28895364241687876, 'psi': 0.954962298473931}-{'f1_val': 0.9460590864896437, 'auprc': 0.960837041546631, 'loss_val': 0.2915821293553833, 'psi': 0.9519702685124386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=77 head_norm_before_train=1.686652 cos_to_last_merge=0.7190 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=77 local utility u=0.088482 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9801417071209022, 'loss_val': 0.46870526421816927, 'psi': 0.8122490419431763}-{'f1_val': 0.6893367341140562, 'auprc': 0.944592106698885, 'loss_val': 0.4731164201932421, 'psi': 0.7914388831479877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=77 head_norm_before_train=2.145860 (no previous merge yet)
[S6] round=77 local utility u=1.000000 metrics={'f1_val': 0.9572029551583323, 'auprc': 0.9790906839714679, 'loss_val': 0.16296153443011047, 'psi': 0.9659580466835865}-{'f1_val': 0.645637715052336, 'auprc': 0.9056368159478179, 'loss_val': 0.8947490752803928, 'psi': 0.7496373554105287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=77 head_norm_before_train=1.672002 cos_to_last_merge=0.9005 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.901
[S7] round=77 local utility u=0.151405 metrics={'f1_val': 0.6471629713866786, 'auprc': 0.7945723934557574, 'loss_val': 0.5894160156188377, 'psi': 0.7061267402143101}-{'f1_val': 0.6149374607901874, 'auprc': 0.785485463472909, 'loss_val': 0.6716131430516372, 'psi': 0.6831566618632761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=77 head_norm_before_train=1.902994 cos_to_last_merge=0.9360 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.936
[S8] round=77 local utility u=0.031194 metrics={'f1_val': 0.9939539858461368, 'auprc': 0.9992005638022947, 'loss_val': 0.03508109265102257, 'psi': 0.9960526170285999}-{'f1_val': 0.9853156051557337, 'auprc': 0.9991388065792774, 'loss_val': 0.04545384717076108, 'psi': 0.9908448857251512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=77 head_norm_before_train=2.214073 (no previous merge yet)
[S9] round=77 local utility u=0.024891 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963911110737255, 'loss_val': 0.016050353189179415, 'psi': 0.9968181919367759}-{'f1_val': 0.990399656971262, 'auprc': 0.999278138727926, 'loss_val': 0.03427307990415438, 'psi': 0.9939510496739277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=77 head_norm_before_train=2.028144 cos_to_last_merge=0.9242 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9953362090539409, 'loss_val': 0.026242303430341746, 'psi': 0.9949979056311797}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962818221466847, 'loss_val': 0.024148862880032054, 'psi': 0.9956254322702986}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=1.808761 cos_to_last_merge=0.8407 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.841
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9959137982851655, 'auprc': 0.9986958987231784, 'loss_val': 0.021819341997954243, 'psi': 0.9970266384603708}-{'f1_val': 0.9968129605654896, 'auprc': 0.9983669153430565, 'loss_val': 0.020813422551634767, 'psi': 0.9974345424765164}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.543800 cos_to_last_merge=0.8578 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=77 local utility u=0.064069 metrics={'f1_val': 0.6447448742862195, 'auprc': 0.7669765173034295, 'loss_val': 0.8776968092172245, 'psi': 0.6936375314931036}-{'f1_val': 0.6388851396693739, 'auprc': 0.8089552921211831, 'loss_val': 1.0966123962568552, 'psi': 0.7069132006500976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=77 head_norm_before_train=2.254830 (no previous merge yet)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969310714123586, 'loss_val': 0.015507853672301232, 'psi': 0.9973630993948556}-{'f1_val': 0.9976943331204965, 'auprc': 0.9969275763244393, 'loss_val': 0.014278856136679154, 'psi': 0.9973876304020737}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=1.966967 cos_to_last_merge=0.8752 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.875
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.7055392590619884, 'auprc': 0.9083179941582136, 'loss_val': 0.6222414912276554, 'psi': 0.7866507531004785}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970199858926403, 'loss_val': 0.022194538404021073, 'psi': 0.9968559953895685}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=1.921830 cos_to_last_merge=0.8653 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.865
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9913239876876926, 'auprc': 0.9861147604102779, 'loss_val': 0.0444652604178773, 'psi': 0.9892402967767268}-{'f1_val': 0.9923708438319017, 'auprc': 0.98676850985367, 'loss_val': 0.04480797000003375, 'psi': 0.9901299102406089}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=1.916053 cos_to_last_merge=0.7635 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=77 local utility u=0.541092 metrics={'f1_val': 0.717986458932264, 'auprc': 0.9180326870212651, 'loss_val': 0.8074465893002258, 'psi': 0.7980049501678644}-{'f1_val': 0.6623226741022529, 'auprc': 0.8708310149012854, 'loss_val': 1.4140429902673346, 'psi': 0.7457260104218659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=78 head_norm_before_train=1.984241 cos_to_last_merge=0.8877 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.888
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.8321460923662067, 'auprc': 0.7863233828453561, 'loss_val': 0.41314992052247257, 'psi': 0.8138170085578664}-{'f1_val': 0.827484908798222, 'auprc': 0.950245102016011, 'loss_val': 0.4350903356411434, 'psi': 0.8765889860853375}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.099759 cos_to_last_merge=0.9277 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.9291180181667349, 'auprc': 0.9992776173508838, 'loss_val': 0.12227572044682189, 'psi': 0.9571818578403944}-{'f1_val': 0.9477271735182152, 'auprc': 0.9992721133149662, 'loss_val': 0.09781822715779472, 'psi': 0.9683451494369156}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=1.797782 cos_to_last_merge=0.9425 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=78 local utility u=0.017774 metrics={'f1_val': 0.956498132750968, 'auprc': 0.9617676405494543, 'loss_val': 0.2906299539802012, 'psi': 0.9586059358703625}-{'f1_val': 0.9498999322739274, 'auprc': 0.9625558477739362, 'loss_val': 0.28895364241687876, 'psi': 0.954962298473931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=78 head_norm_before_train=1.688324 cos_to_last_merge=0.7190 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=78 local utility u=0.061414 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9897867850731554, 'loss_val': 0.3753308234734127, 'psi': 0.8161588598578232}-{'f1_val': 0.700320598491359, 'auprc': 0.9801417071209022, 'loss_val': 0.46870526421816927, 'psi': 0.8122490419431763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=78 head_norm_before_train=2.154016 (no previous merge yet)
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.8886732776665422, 'auprc': 0.9652574957672605, 'loss_val': 0.2172625008723272, 'psi': 0.9193069649068295}-{'f1_val': 0.9572029551583323, 'auprc': 0.9790906839714679, 'loss_val': 0.16296153443011047, 'psi': 0.9659580466835865}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=78 head_norm_before_train=1.680169 cos_to_last_merge=0.8996 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.900
[S7] round=78 local utility u=0.303981 metrics={'f1_val': 0.6902586868311154, 'auprc': 0.8326503684635225, 'loss_val': 0.3542629488352364, 'psi': 0.7472153594840782}-{'f1_val': 0.6471629713866786, 'auprc': 0.7945723934557574, 'loss_val': 0.5894160156188377, 'psi': 0.7061267402143101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=78 head_norm_before_train=1.905636 cos_to_last_merge=0.9357 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.936
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9894468542915018, 'auprc': 0.995926181200685, 'loss_val': 0.04494141694487556, 'psi': 0.9920385850551751}-{'f1_val': 0.9939539858461368, 'auprc': 0.9992005638022947, 'loss_val': 0.03508109265102257, 'psi': 0.9960526170285999}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=2.218510 (no previous merge yet)
[S9] round=78 local utility u=0.003700 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986534476920661, 'loss_val': 0.01543741864126514, 'psi': 0.9977231265841121}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963911110737255, 'loss_val': 0.016050353189179415, 'psi': 0.9968181919367759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=78 head_norm_before_train=2.033486 cos_to_last_merge=0.9238 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=78 local utility u=0.005050 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9965920307064451, 'loss_val': 0.02357384207795482, 'psi': 0.9958666226075974}-{'f1_val': 0.9947723700160056, 'auprc': 0.9953362090539409, 'loss_val': 0.026242303430341746, 'psi': 0.9949979056311797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=78 head_norm_before_train=1.814841 cos_to_last_merge=0.8402 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.840
[S11] round=78 local utility u=0.002279 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9987196871264714, 'loss_val': 0.02022445099814836, 'psi': 0.997325387169055}-{'f1_val': 0.9959137982851655, 'auprc': 0.9986958987231784, 'loss_val': 0.021819341997954243, 'psi': 0.9970266384603708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=78 head_norm_before_train=1.548505 cos_to_last_merge=0.8569 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.857
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6298046302837662, 'auprc': 0.799270265337749, 'loss_val': 1.0477339657045353, 'psi': 0.6975908843053593}-{'f1_val': 0.6447448742862195, 'auprc': 0.7669765173034295, 'loss_val': 0.8776968092172245, 'psi': 0.6936375314931036}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=2.256672 (no previous merge yet)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.996927212049221, 'loss_val': 0.016273313301829084, 'psi': 0.9973615556496005}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969310714123586, 'loss_val': 0.015507853672301232, 'psi': 0.9973630993948556}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=1.972977 cos_to_last_merge=0.8745 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.874
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.7033204863594102, 'auprc': 0.8590282538546803, 'loss_val': 0.6669223931759256, 'psi': 0.7656035933575183}-{'f1_val': 0.7055392590619884, 'auprc': 0.9083179941582136, 'loss_val': 0.6222414912276554, 'psi': 0.7866507531004785}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=1.927177 cos_to_last_merge=0.8647 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.865
[S16] round=78 local utility u=0.000211 metrics={'f1_val': 0.9913239876876926, 'auprc': 0.9866661475394638, 'loss_val': 0.04569695429257515, 'psi': 0.9894608516284011}-{'f1_val': 0.9913239876876926, 'auprc': 0.9861147604102779, 'loss_val': 0.0444652604178773, 'psi': 0.9892402967767268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=78 head_norm_before_train=1.920301 cos_to_last_merge=0.7633 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.6899709342396537, 'auprc': 0.8893643110583253, 'loss_val': 1.1276778343336349, 'psi': 0.7697282849671223}-{'f1_val': 0.717986458932264, 'auprc': 0.9180326870212651, 'loss_val': 0.8074465893002258, 'psi': 0.7980049501678644}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=1.984204 cos_to_last_merge=0.8890 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=79 local utility u=0.070453 metrics={'f1_val': 0.8311830180835866, 'auprc': 0.8427555062482268, 'loss_val': 0.43576278024371157, 'psi': 0.8358120133494427}-{'f1_val': 0.8321460923662067, 'auprc': 0.7863233828453561, 'loss_val': 0.41314992052247257, 'psi': 0.8138170085578664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S2] r=80 psi=0.836 u=0.0705 p_local=0.0396 f1=0.831 auprc=0.843 bytes=90039
[S3] START round=79 head_norm_before_train=2.102587 cos_to_last_merge=0.9275 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.7556318919155123, 'auprc': 0.9653505365032041, 'loss_val': 0.5251856541107087, 'psi': 0.8395193497505891}-{'f1_val': 0.9291180181667349, 'auprc': 0.9992776173508838, 'loss_val': 0.12227572044682189, 'psi': 0.9571818578403944}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=80 psi=0.840 u=0.0000 p_local=0.1453 f1=0.756 auprc=0.965 bytes=71951
[S4] START round=79 head_norm_before_train=1.801665 cos_to_last_merge=0.9421 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9389212235814774, 'auprc': 0.9611167199811514, 'loss_val': 0.31224979200440395, 'psi': 0.947799422141347}-{'f1_val': 0.956498132750968, 'auprc': 0.9617676405494543, 'loss_val': 0.2906299539802012, 'psi': 0.9586059358703625}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.948 u=0.0000 p_local=0.0135 f1=0.939 auprc=0.961 bytes=80975
[S5] START round=79 head_norm_before_train=1.687889 cos_to_last_merge=0.7192 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.6456456582494882, 'auprc': 0.9430305606247558, 'loss_val': 0.560243420747218, 'psi': 0.7645996191995952}-{'f1_val': 0.7004069097142683, 'auprc': 0.9897867850731554, 'loss_val': 0.3753308234734127, 'psi': 0.8161588598578232}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.765 u=0.0000 p_local=0.1558 f1=0.646 auprc=0.943 bytes=77301
[S6] START round=79 head_norm_before_train=2.159633 (no previous merge yet)
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.5967947108940709, 'auprc': 0.7175204415194231, 'loss_val': 1.3015688112514971, 'psi': 0.6450850031442117}-{'f1_val': 0.8886732776665422, 'auprc': 0.9652574957672605, 'loss_val': 0.2172625008723272, 'psi': 0.9193069649068295}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.645 u=0.0000 p_local=0.3085 f1=0.597 auprc=0.718 bytes=75562
[S7] START round=79 head_norm_before_train=1.688775 cos_to_last_merge=0.8988 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.899
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.6187014604172921, 'auprc': 0.8005510280992406, 'loss_val': 0.5232715741513344, 'psi': 0.6914412874900715}-{'f1_val': 0.6902586868311154, 'auprc': 0.8326503684635225, 'loss_val': 0.3542629488352364, 'psi': 0.7472153594840782}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.691 u=0.0000 p_local=0.2146 f1=0.619 auprc=0.801 bytes=79186
[S8] START round=79 head_norm_before_train=1.908304 cos_to_last_merge=0.9349 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.935
[S8] round=79 local utility u=0.027297 metrics={'f1_val': 0.994753542178155, 'auprc': 0.9991738612693134, 'loss_val': 0.0319305166485653, 'psi': 0.9965216698146184}-{'f1_val': 0.9894468542915018, 'auprc': 0.995926181200685, 'loss_val': 0.04494141694487556, 'psi': 0.9920385850551751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] r=80 psi=0.997 u=0.0273 p_local=0.0683 f1=0.995 auprc=0.999 bytes=84610
[S9] START round=79 head_norm_before_train=2.223124 (no previous merge yet)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9991745480579433, 'loss_val': 0.028111363117438764, 'psi': 0.9944163073600677}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986534476920661, 'loss_val': 0.01543741864126514, 'psi': 0.9977231265841121}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.994 u=0.0000 p_local=0.0044 f1=0.991 auprc=0.999 bytes=84594
[S10] START round=79 head_norm_before_train=2.037884 cos_to_last_merge=0.9233 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=79 local utility u=0.001669 metrics={'f1_val': 0.9957973497718928, 'auprc': 0.9968647685396017, 'loss_val': 0.023539094329416234, 'psi': 0.9962243172789764}-{'f1_val': 0.9953830172083656, 'auprc': 0.9965920307064451, 'loss_val': 0.02357384207795482, 'psi': 0.9958666226075974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S10] r=80 psi=0.996 u=0.0017 p_local=0.0106 f1=0.996 auprc=0.997 bytes=86371
[S11] START round=79 head_norm_before_train=1.821172 cos_to_last_merge=0.8396 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.840
[S11] round=79 local utility u=0.000000 metrics={'f1_val': 0.8973245435462784, 'auprc': 0.9975808418019297, 'loss_val': 0.12091783737896421, 'psi': 0.937427062848539}-{'f1_val': 0.9963958538641108, 'auprc': 0.9987196871264714, 'loss_val': 0.02022445099814836, 'psi': 0.997325387169055}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=80 psi=0.937 u=0.0000 p_local=0.0593 f1=0.897 auprc=0.998 bytes=89869
[S13] START round=79 head_norm_before_train=1.554188 cos_to_last_merge=0.8559 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=79 local utility u=0.218513 metrics={'f1_val': 0.6699797254577853, 'auprc': 0.7759380219010314, 'loss_val': 0.7817614159286816, 'psi': 0.7123630440350837}-{'f1_val': 0.6298046302837662, 'auprc': 0.799270265337749, 'loss_val': 1.0477339657045353, 'psi': 0.6975908843053593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] r=80 psi=0.712 u=0.2185 p_local=0.0926 f1=0.670 auprc=0.776 bytes=81018
[S14] START round=79 head_norm_before_train=2.260177 (no previous merge yet)
[S14] round=79 local utility u=0.000852 metrics={'f1_val': 0.9972835715563582, 'auprc': 0.9983831819420759, 'loss_val': 0.01673196632274221, 'psi': 0.9977234157106452}-{'f1_val': 0.9976511180498535, 'auprc': 0.996927212049221, 'loss_val': 0.016273313301829084, 'psi': 0.9973615556496005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S14] r=80 psi=0.998 u=0.0009 p_local=0.0101 f1=0.997 auprc=0.998 bytes=84497
[S15] START round=79 head_norm_before_train=1.979282 cos_to_last_merge=0.8740 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.874
[S15] round=79 local utility u=0.891044 metrics={'f1_val': 0.8815899573858603, 'auprc': 0.9801536211798367, 'loss_val': 0.31782791890522494, 'psi': 0.9210154229034508}-{'f1_val': 0.7033204863594102, 'auprc': 0.8590282538546803, 'loss_val': 0.6669223931759256, 'psi': 0.7656035933575183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S15] r=80 psi=0.921 u=0.8910 p_local=0.3951 f1=0.882 auprc=0.980 bytes=80910
[S16] START round=79 head_norm_before_train=1.933156 cos_to_last_merge=0.8641 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.864
[S16] round=79 local utility u=0.000339 metrics={'f1_val': 0.9913239876876926, 'auprc': 0.9870414583310324, 'loss_val': 0.046144091360779425, 'psi': 0.9896109759450286}-{'f1_val': 0.9913239876876926, 'auprc': 0.9866661475394638, 'loss_val': 0.04569695429257515, 'psi': 0.9894608516284011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] sending update (kind=head size=1808 to 1 peers)
[S16] r=80 psi=0.990 u=0.0003 p_local=0.0652 f1=0.991 auprc=0.987 bytes=86544
[S17] START round=79 head_norm_before_train=1.926440 cos_to_last_merge=0.7627 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.6854114491454069, 'auprc': 0.8775537808859029, 'loss_val': 1.308549456860946, 'psi': 0.7622683818416053}-{'f1_val': 0.6899709342396537, 'auprc': 0.8893643110583253, 'loss_val': 1.1276778343336349, 'psi': 0.7697282849671223}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.762 u=0.0000 p_local=0.1726 f1=0.685 auprc=0.878 bytes=71914
[S2] START round=80 head_norm_before_train=1.987709 cos_to_last_merge=0.8891 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=80 local utility u=0.016880 metrics={'f1_val': 0.8303414686133218, 'auprc': 0.8568046481544688, 'loss_val': 0.4391003631686938, 'psi': 0.8409267404297807}-{'f1_val': 0.8311830180835866, 'auprc': 0.8427555062482268, 'loss_val': 0.43576278024371157, 'psi': 0.8358120133494427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=80 head_norm_before_train=2.106133 cos_to_last_merge=0.9273 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=80 local utility u=0.881694 metrics={'f1_val': 0.9607151619808509, 'auprc': 0.9977511715431715, 'loss_val': 0.08949982487456318, 'psi': 0.9755295658057792}-{'f1_val': 0.7556318919155123, 'auprc': 0.9653505365032041, 'loss_val': 0.5251856541107087, 'psi': 0.8395193497505891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=80 head_norm_before_train=1.805149 cos_to_last_merge=0.9416 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.8224948051403251, 'auprc': 0.9643267165986966, 'loss_val': 0.45463164081594304, 'psi': 0.8792275697236738}-{'f1_val': 0.9389212235814774, 'auprc': 0.9611167199811514, 'loss_val': 0.31224979200440395, 'psi': 0.947799422141347}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=1.690799 cos_to_last_merge=0.7186 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.719
[S5] round=80 local utility u=0.408682 metrics={'f1_val': 0.7248995933422008, 'auprc': 0.9733295229250101, 'loss_val': 0.30930019131426706, 'psi': 0.8242715651753245}-{'f1_val': 0.6456456582494882, 'auprc': 0.9430305606247558, 'loss_val': 0.560243420747218, 'psi': 0.7645996191995952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=80 head_norm_before_train=2.162873 (no previous merge yet)
[S6] round=80 local utility u=1.000000 metrics={'f1_val': 0.8245008324012164, 'auprc': 0.938791540467056, 'loss_val': 0.4816153474712496, 'psi': 0.8702171156275522}-{'f1_val': 0.5967947108940709, 'auprc': 0.7175204415194231, 'loss_val': 1.3015688112514971, 'psi': 0.6450850031442117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=80 head_norm_before_train=1.695909 cos_to_last_merge=0.8981 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.898
[S7] round=80 local utility u=0.349307 metrics={'f1_val': 0.6864365421800116, 'auprc': 0.8407142111191088, 'loss_val': 0.3515567749803321, 'psi': 0.7481476097556505}-{'f1_val': 0.6187014604172921, 'auprc': 0.8005510280992406, 'loss_val': 0.5232715741513344, 'psi': 0.6914412874900715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=80 head_norm_before_train=1.912731 cos_to_last_merge=0.9343 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.934
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.8284223623841633, 'auprc': 0.9995439438013347, 'loss_val': 0.3440432432310117, 'psi': 0.8968709949510318}-{'f1_val': 0.994753542178155, 'auprc': 0.9991738612693134, 'loss_val': 0.0319305166485653, 'psi': 0.9965216698146184}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.223624 (no previous merge yet)
[S9] round=80 local utility u=0.018665 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996011746598192, 'loss_val': 0.016445360720947804, 'psi': 0.9966664461465625}-{'f1_val': 0.9912441468948172, 'auprc': 0.9991745480579433, 'loss_val': 0.028111363117438764, 'psi': 0.9944163073600677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=80 head_norm_before_train=2.041228 cos_to_last_merge=0.9228 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9966073330075629, 'loss_val': 0.024004852484314797, 'psi': 0.9958727435280446}-{'f1_val': 0.9957973497718928, 'auprc': 0.9968647685396017, 'loss_val': 0.023539094329416234, 'psi': 0.9962243172789764}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=1.827183 cos_to_last_merge=0.8391 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.839
[S11] round=80 local utility u=0.123486 metrics={'f1_val': 0.9423114475918835, 'auprc': 0.9976307307409773, 'loss_val': 0.14401649349137413, 'psi': 0.964439160851521}-{'f1_val': 0.8973245435462784, 'auprc': 0.9975808418019297, 'loss_val': 0.12091783737896421, 'psi': 0.937427062848539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=80 head_norm_before_train=1.559610 cos_to_last_merge=0.8549 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.855
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.6248916114060168, 'auprc': 0.7854378350038016, 'loss_val': 0.9651510346199171, 'psi': 0.6891101008451307}-{'f1_val': 0.6699797254577853, 'auprc': 0.7759380219010314, 'loss_val': 0.7817614159286816, 'psi': 0.7123630440350837}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=2.262877 (no previous merge yet)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9964460792685341, 'auprc': 0.9969261458206301, 'loss_val': 0.020941286075003597, 'psi': 0.9966381058893725}-{'f1_val': 0.9972835715563582, 'auprc': 0.9983831819420759, 'loss_val': 0.01673196632274221, 'psi': 0.9977234157106452}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=1.985035 cos_to_last_merge=0.8734 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.873
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.7745764362728297, 'auprc': 0.9371022362948989, 'loss_val': 0.5033356155588901, 'psi': 0.8395867562816574}-{'f1_val': 0.8815899573858603, 'auprc': 0.9801536211798367, 'loss_val': 0.31782791890522494, 'psi': 0.9210154229034508}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=1.938905 cos_to_last_merge=0.8635 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.864
[S16] round=80 local utility u=0.002782 metrics={'f1_val': 0.9915433264489799, 'auprc': 0.9879102685210128, 'loss_val': 0.04450232027799484, 'psi': 0.990090103277793}-{'f1_val': 0.9913239876876926, 'auprc': 0.9870414583310324, 'loss_val': 0.046144091360779425, 'psi': 0.9896109759450286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=80 head_norm_before_train=1.935348 cos_to_last_merge=0.7622 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=80 local utility u=1.000000 metrics={'f1_val': 0.8803278780467859, 'auprc': 0.9877502816752686, 'loss_val': 0.29007645388527514, 'psi': 0.923296839498179}-{'f1_val': 0.6854114491454069, 'auprc': 0.8775537808859029, 'loss_val': 1.308549456860946, 'psi': 0.7622683818416053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=81 head_norm_before_train=1.990875 cos_to_last_merge=0.8892 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=81 local utility u=0.135077 metrics={'f1_val': 0.826445675353778, 'auprc': 0.9570377653606726, 'loss_val': 0.44627069880753106, 'psi': 0.8786825113565359}-{'f1_val': 0.8303414686133218, 'auprc': 0.8568046481544688, 'loss_val': 0.4391003631686938, 'psi': 0.8409267404297807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=81 head_norm_before_train=2.111822 cos_to_last_merge=0.9268 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=81 local utility u=0.065339 metrics={'f1_val': 0.9751792663766262, 'auprc': 0.9981963589207095, 'loss_val': 0.04694197289264185, 'psi': 0.9843861033942596}-{'f1_val': 0.9607151619808509, 'auprc': 0.9977511715431715, 'loss_val': 0.08949982487456318, 'psi': 0.9755295658057792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=81 head_norm_before_train=1.808377 cos_to_last_merge=0.9410 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=81 local utility u=0.364190 metrics={'f1_val': 0.9277095205880379, 'auprc': 0.9666884983013944, 'loss_val': 0.3646243631442627, 'psi': 0.9433011116733805}-{'f1_val': 0.8224948051403251, 'auprc': 0.9643267165986966, 'loss_val': 0.45463164081594304, 'psi': 0.8792275697236738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=81 head_norm_before_train=1.694789 cos_to_last_merge=0.7179 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.718
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.7002451011760882, 'auprc': 0.9635265274230275, 'loss_val': 0.43273831266889395, 'psi': 0.8055576716748639}-{'f1_val': 0.7248995933422008, 'auprc': 0.9733295229250101, 'loss_val': 0.30930019131426706, 'psi': 0.8242715651753245}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=2.166825 (no previous merge yet)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.783711149519145, 'auprc': 0.9327908122527026, 'loss_val': 0.585838276307295, 'psi': 0.843343014612568}-{'f1_val': 0.8245008324012164, 'auprc': 0.938791540467056, 'loss_val': 0.4816153474712496, 'psi': 0.8702171156275522}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.706149 cos_to_last_merge=0.8966 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.897
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6122698378030913, 'auprc': 0.7808359343823935, 'loss_val': 0.7868179353463461, 'psi': 0.6796962764348122}-{'f1_val': 0.6864365421800116, 'auprc': 0.8407142111191088, 'loss_val': 0.3515567749803321, 'psi': 0.7481476097556505}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=1.919100 cos_to_last_merge=0.9337 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.934
[S8] round=81 local utility u=0.473284 metrics={'f1_val': 0.9474674906211483, 'auprc': 0.9992317715013074, 'loss_val': 0.11081002830486113, 'psi': 0.968173202973212}-{'f1_val': 0.8284223623841633, 'auprc': 0.9995439438013347, 'loss_val': 0.3440432432310117, 'psi': 0.8968709949510318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=81 head_norm_before_train=2.226538 (no previous merge yet)
[S9] round=81 local utility u=0.003245 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9979823401448773, 'loss_val': 0.015866143363487854, 'psi': 0.9974546835652366}-{'f1_val': 0.9971029125121428, 'auprc': 0.996011746598192, 'loss_val': 0.016445360720947804, 'psi': 0.9966664461465625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=81 head_norm_before_train=2.046023 cos_to_last_merge=0.9222 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962095568011291, 'loss_val': 0.024826931294808532, 'psi': 0.9955965261320765}-{'f1_val': 0.9953830172083656, 'auprc': 0.9966073330075629, 'loss_val': 0.024004852484314797, 'psi': 0.9958727435280446}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=1.832503 cos_to_last_merge=0.8386 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.839
[S11] round=81 local utility u=0.226281 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9985101500704434, 'loss_val': 0.019529900056615906, 'psi': 0.9973346130252357}-{'f1_val': 0.9423114475918835, 'auprc': 0.9976307307409773, 'loss_val': 0.14401649349137413, 'psi': 0.964439160851521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=81 head_norm_before_train=1.563816 cos_to_last_merge=0.8541 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.854
[S13] round=81 local utility u=0.019628 metrics={'f1_val': 0.6425170315690175, 'auprc': 0.75928564174067, 'loss_val': 0.9531911840052184, 'psi': 0.6892244756376786}-{'f1_val': 0.6248916114060168, 'auprc': 0.7854378350038016, 'loss_val': 0.9651510346199171, 'psi': 0.6891101008451307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=81 head_norm_before_train=2.266995 (no previous merge yet)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9413425745310523, 'auprc': 0.996925506684643, 'loss_val': 0.07725664025234968, 'psi': 0.9635757473924885}-{'f1_val': 0.9964460792685341, 'auprc': 0.9969261458206301, 'loss_val': 0.020941286075003597, 'psi': 0.9966381058893725}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=1.990324 cos_to_last_merge=0.8729 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.873
[S15] round=81 local utility u=0.777101 metrics={'f1_val': 0.9382707148271852, 'auprc': 0.9966475084755508, 'loss_val': 0.10993452489762374, 'psi': 0.9616214322865315}-{'f1_val': 0.7745764362728297, 'auprc': 0.9371022362948989, 'loss_val': 0.5033356155588901, 'psi': 0.8395867562816574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=81 head_norm_before_train=1.940902 cos_to_last_merge=0.8633 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.863
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.9911047228797284, 'auprc': 0.9867814304217808, 'loss_val': 0.04646662662687317, 'psi': 0.9893754058965494}-{'f1_val': 0.9915433264489799, 'auprc': 0.9879102685210128, 'loss_val': 0.04450232027799484, 'psi': 0.990090103277793}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=81 head_norm_before_train=1.944468 cos_to_last_merge=0.7620 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.6523104450217518, 'auprc': 0.9108777787985103, 'loss_val': 1.1657154848781344, 'psi': 0.7557373785324553}-{'f1_val': 0.8803278780467859, 'auprc': 0.9877502816752686, 'loss_val': 0.29007645388527514, 'psi': 0.923296839498179}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=1.994049 cos_to_last_merge=0.8892 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.8311830180835866, 'auprc': 0.807822917429163, 'loss_val': 0.44042014670478014, 'psi': 0.8218389778218171}-{'f1_val': 0.826445675353778, 'auprc': 0.9570377653606726, 'loss_val': 0.44627069880753106, 'psi': 0.8786825113565359}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=2.112979 cos_to_last_merge=0.9265 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.8489250204476781, 'auprc': 0.9676501164300357, 'loss_val': 0.33274233078746646, 'psi': 0.8964150588406212}-{'f1_val': 0.9751792663766262, 'auprc': 0.9981963589207095, 'loss_val': 0.04694197289264185, 'psi': 0.9843861033942596}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=1.813603 cos_to_last_merge=0.9406 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=82 local utility u=0.017057 metrics={'f1_val': 0.9349101999059518, 'auprc': 0.9613913066981146, 'loss_val': 0.3578219686623947, 'psi': 0.9455026426228168}-{'f1_val': 0.9277095205880379, 'auprc': 0.9666884983013944, 'loss_val': 0.3646243631442627, 'psi': 0.9433011116733805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=82 head_norm_before_train=1.697520 cos_to_last_merge=0.7177 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.718
[S5] round=82 local utility u=0.068676 metrics={'f1_val': 0.7005335395834296, 'auprc': 0.9857239554665256, 'loss_val': 0.3637092788892756, 'psi': 0.8146097059366679}-{'f1_val': 0.7002451011760882, 'auprc': 0.9635265274230275, 'loss_val': 0.43273831266889395, 'psi': 0.8055576716748639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=82 head_norm_before_train=2.173271 (no previous merge yet)
[S6] round=82 local utility u=0.129375 metrics={'f1_val': 0.8298399804026867, 'auprc': 0.9187377987085937, 'loss_val': 0.5617026942729079, 'psi': 0.8653991077250495}-{'f1_val': 0.783711149519145, 'auprc': 0.9327908122527026, 'loss_val': 0.585838276307295, 'psi': 0.843343014612568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=82 head_norm_before_train=1.712479 cos_to_last_merge=0.8955 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.896
[S7] round=82 local utility u=0.427605 metrics={'f1_val': 0.6828660599357435, 'auprc': 0.8125334359487125, 'loss_val': 0.450278215563474, 'psi': 0.7347330103409311}-{'f1_val': 0.6122698378030913, 'auprc': 0.7808359343823935, 'loss_val': 0.7868179353463461, 'psi': 0.6796962764348122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=82 head_norm_before_train=1.926060 cos_to_last_merge=0.9333 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=82 local utility u=0.174732 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9973854179667925, 'loss_val': 0.031935487147811886, 'psi': 0.9950474588605174}-{'f1_val': 0.9474674906211483, 'auprc': 0.9992317715013074, 'loss_val': 0.11081002830486113, 'psi': 0.968173202973212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=82 head_norm_before_train=2.229596 (no previous merge yet)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9991737359880382, 'loss_val': 0.03675141194171766, 'psi': 0.993251111112087}-{'f1_val': 0.9971029125121428, 'auprc': 0.9979823401448773, 'loss_val': 0.015866143363487854, 'psi': 0.9974546835652366}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.051550 cos_to_last_merge=0.9216 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=82 local utility u=0.000026 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965213894010958, 'loss_val': 0.024393059836560062, 'psi': 0.9955894676794841}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962095568011291, 'loss_val': 0.024826931294808532, 'psi': 0.9955965261320765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=82 head_norm_before_train=1.837366 cos_to_last_merge=0.8381 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.838
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9982266678067704, 'loss_val': 0.020517103378574774, 'psi': 0.9969708720706938}-{'f1_val': 0.9965509216617638, 'auprc': 0.9985101500704434, 'loss_val': 0.019529900056615906, 'psi': 0.9973346130252357}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=1.567077 cos_to_last_merge=0.8529 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.853
[S13] round=82 local utility u=0.171449 metrics={'f1_val': 0.6558110030331988, 'auprc': 0.7837044014987767, 'loss_val': 0.763313012126964, 'psi': 0.7069683624194301}-{'f1_val': 0.6425170315690175, 'auprc': 0.75928564174067, 'loss_val': 0.9531911840052184, 'psi': 0.6892244756376786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=82 head_norm_before_train=2.270973 (no previous merge yet)
[S14] round=82 local utility u=0.201703 metrics={'f1_val': 0.9983073289132482, 'auprc': 0.9969169682412578, 'loss_val': 0.015613384725153365, 'psi': 0.997751184644452}-{'f1_val': 0.9413425745310523, 'auprc': 0.996925506684643, 'loss_val': 0.07725664025234968, 'psi': 0.9635757473924885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=82 head_norm_before_train=1.996075 cos_to_last_merge=0.8723 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.872
[S15] round=82 local utility u=0.152747 metrics={'f1_val': 0.9784556569123816, 'auprc': 0.9968981649496294, 'loss_val': 0.04630258770078936, 'psi': 0.9858326601272807}-{'f1_val': 0.9382707148271852, 'auprc': 0.9966475084755508, 'loss_val': 0.10993452489762374, 'psi': 0.9616214322865315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=82 head_norm_before_train=1.944909 cos_to_last_merge=0.8629 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.863
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.990009498243305, 'auprc': 0.9869000003280219, 'loss_val': 0.05227989302311894, 'psi': 0.9887656990771918}-{'f1_val': 0.9911047228797284, 'auprc': 0.9867814304217808, 'loss_val': 0.04646662662687317, 'psi': 0.9893754058965494}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=1.950792 cos_to_last_merge=0.7616 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=82 local utility u=0.085071 metrics={'f1_val': 0.6899443538137245, 'auprc': 0.9068506349034432, 'loss_val': 1.2092953268028512, 'psi': 0.776706866249612}-{'f1_val': 0.6523104450217518, 'auprc': 0.9108777787985103, 'loss_val': 1.1657154848781344, 'psi': 0.7557373785324553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=83 head_norm_before_train=1.998990 cos_to_last_merge=0.8887 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=83 local utility u=0.095222 metrics={'f1_val': 0.8305333893234529, 'auprc': 0.873254627937633, 'loss_val': 0.44237426371134614, 'psi': 0.8476218847691249}-{'f1_val': 0.8311830180835866, 'auprc': 0.807822917429163, 'loss_val': 0.44042014670478014, 'psi': 0.8218389778218171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=83 head_norm_before_train=2.113787 cos_to_last_merge=0.9262 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=83 local utility u=0.195242 metrics={'f1_val': 0.8837394512563147, 'auprc': 0.9858437146613445, 'loss_val': 0.20572649483019906, 'psi': 0.9245811566183266}-{'f1_val': 0.8489250204476781, 'auprc': 0.9676501164300357, 'loss_val': 0.33274233078746646, 'psi': 0.8964150588406212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=83 head_norm_before_train=1.811927 cos_to_last_merge=0.9407 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=83 local utility u=0.052626 metrics={'f1_val': 0.942885187893324, 'auprc': 0.9597494728128033, 'loss_val': 0.2954952339962039, 'psi': 0.9496309018611158}-{'f1_val': 0.9349101999059518, 'auprc': 0.9613913066981146, 'loss_val': 0.3578219686623947, 'psi': 0.9455026426228168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=83 head_norm_before_train=1.698250 cos_to_last_merge=0.7177 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.718
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.635779283880384, 'auprc': 0.8631246499054318, 'loss_val': 0.7142869226138249, 'psi': 0.7267174302904031}-{'f1_val': 0.7005335395834296, 'auprc': 0.9857239554665256, 'loss_val': 0.3637092788892756, 'psi': 0.8146097059366679}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=2.177240 (no previous merge yet)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.7579040118141827, 'auprc': 0.960000852050625, 'loss_val': 0.5774369623580059, 'psi': 0.8387427479087596}-{'f1_val': 0.8298399804026867, 'auprc': 0.9187377987085937, 'loss_val': 0.5617026942729079, 'psi': 0.8653991077250495}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.717673 cos_to_last_merge=0.8946 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.895
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.5901706398418314, 'auprc': 0.7826864058915974, 'loss_val': 0.7649810816485515, 'psi': 0.6671769462617378}-{'f1_val': 0.6828660599357435, 'auprc': 0.8125334359487125, 'loss_val': 0.450278215563474, 'psi': 0.7347330103409311}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=1.931415 cos_to_last_merge=0.9333 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9898701632363025, 'auprc': 0.9991407369199539, 'loss_val': 0.035505408328536735, 'psi': 0.9935783927097631}-{'f1_val': 0.9934888194563342, 'auprc': 0.9973854179667925, 'loss_val': 0.031935487147811886, 'psi': 0.9950474588605174}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.230377 (no previous merge yet)
[S9] round=83 local utility u=0.028986 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9960128733798361, 'loss_val': 0.016098959831107446, 'psi': 0.9966668968592202}-{'f1_val': 0.9893026945281196, 'auprc': 0.9991737359880382, 'loss_val': 0.03675141194171766, 'psi': 0.993251111112087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=83 head_norm_before_train=2.054538 cos_to_last_merge=0.9211 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=83 local utility u=0.001436 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9965451658346602, 'loss_val': 0.024081852079607228, 'psi': 0.9958478766588834}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965213894010958, 'loss_val': 0.024393059836560062, 'psi': 0.9955894676794841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=83 head_norm_before_train=1.842822 cos_to_last_merge=0.8377 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.838
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9333136570215391, 'auprc': 0.9985224661178861, 'loss_val': 0.19678451763163413, 'psi': 0.9593971806600778}-{'f1_val': 0.9961336749133093, 'auprc': 0.9982266678067704, 'loss_val': 0.020517103378574774, 'psi': 0.9969708720706938}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.569642 cos_to_last_merge=0.8521 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.852
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.5810664842606293, 'auprc': 0.8040957512376966, 'loss_val': 1.3713371388105244, 'psi': 0.6702781910514564}-{'f1_val': 0.6558110030331988, 'auprc': 0.7837044014987767, 'loss_val': 0.763313012126964, 'psi': 0.7069683624194301}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=2.273467 (no previous merge yet)
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9969181702314114, 'loss_val': 0.01689225042240293, 'psi': 0.9975052063885549}-{'f1_val': 0.9983073289132482, 'auprc': 0.9969169682412578, 'loss_val': 0.015613384725153365, 'psi': 0.997751184644452}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=2.001851 cos_to_last_merge=0.8718 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.872
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9363420537256022, 'auprc': 0.9960440535236895, 'loss_val': 0.11179136420909284, 'psi': 0.9602228536448372}-{'f1_val': 0.9784556569123816, 'auprc': 0.9968981649496294, 'loss_val': 0.04630258770078936, 'psi': 0.9858326601272807}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=1.949649 cos_to_last_merge=0.8624 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.862
[S16] round=83 local utility u=0.003021 metrics={'f1_val': 0.9906664139916758, 'auprc': 0.9872336304266323, 'loss_val': 0.05118123372221746, 'psi': 0.9892933005656583}-{'f1_val': 0.990009498243305, 'auprc': 0.9869000003280219, 'loss_val': 0.05227989302311894, 'psi': 0.9887656990771918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=83 head_norm_before_train=1.956127 cos_to_last_merge=0.7614 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=83 local utility u=0.586226 metrics={'f1_val': 0.8241204804642763, 'auprc': 0.8871188073980667, 'loss_val': 0.782704566251742, 'psi': 0.8493198112377924}-{'f1_val': 0.6899443538137245, 'auprc': 0.9068506349034432, 'loss_val': 1.2092953268028512, 'psi': 0.776706866249612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=84 head_norm_before_train=2.005814 cos_to_last_merge=0.8876 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.888
[S2] round=84 local utility u=0.176051 metrics={'f1_val': 0.8278678932084138, 'auprc': 0.9937351949525234, 'loss_val': 0.4357216485940725, 'psi': 0.8942148139060577}-{'f1_val': 0.8305333893234529, 'auprc': 0.873254627937633, 'loss_val': 0.44237426371134614, 'psi': 0.8476218847691249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=84 head_norm_before_train=2.115615 cos_to_last_merge=0.9259 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=84 local utility u=0.240638 metrics={'f1_val': 0.9459198070950788, 'auprc': 0.9898066256891226, 'loss_val': 0.10942226153818937, 'psi': 0.9634745345326963}-{'f1_val': 0.8837394512563147, 'auprc': 0.9858437146613445, 'loss_val': 0.20572649483019906, 'psi': 0.9245811566183266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=84 head_norm_before_train=1.811883 cos_to_last_merge=0.9408 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9431780418808957, 'auprc': 0.9297714979359211, 'loss_val': 0.296788197774064, 'psi': 0.9378154243029059}-{'f1_val': 0.942885187893324, 'auprc': 0.9597494728128033, 'loss_val': 0.2954952339962039, 'psi': 0.9496309018611158}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.698184 cos_to_last_merge=0.7175 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.717
[S5] round=84 local utility u=0.900518 metrics={'f1_val': 0.8205657108256498, 'auprc': 0.9624192112177594, 'loss_val': 0.31985373952694507, 'psi': 0.8773071109824937}-{'f1_val': 0.635779283880384, 'auprc': 0.8631246499054318, 'loss_val': 0.7142869226138249, 'psi': 0.7267174302904031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=84 head_norm_before_train=2.182717 (no previous merge yet)
[S6] round=84 local utility u=0.436820 metrics={'f1_val': 0.8636236464256976, 'auprc': 0.96395937272996, 'loss_val': 0.3499905654128746, 'psi': 0.9037579369474025}-{'f1_val': 0.7579040118141827, 'auprc': 0.960000852050625, 'loss_val': 0.5774369623580059, 'psi': 0.8387427479087596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=84 head_norm_before_train=1.720735 cos_to_last_merge=0.8939 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.894
[S7] round=84 local utility u=1.000000 metrics={'f1_val': 0.971427986423524, 'auprc': 0.9677277202623114, 'loss_val': 0.18703056751943814, 'psi': 0.969947879959039}-{'f1_val': 0.5901706398418314, 'auprc': 0.7826864058915974, 'loss_val': 0.7649810816485515, 'psi': 0.6671769462617378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=84 head_norm_before_train=1.938363 cos_to_last_merge=0.9326 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.8316053088895372, 'auprc': 0.9991724214882397, 'loss_val': 0.3712563143947218, 'psi': 0.8986321539290182}-{'f1_val': 0.9898701632363025, 'auprc': 0.9991407369199539, 'loss_val': 0.035505408328536735, 'psi': 0.9935783927097631}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=2.233531 (no previous merge yet)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9937017131703826, 'loss_val': 0.016354177744582234, 'psi': 0.9957424327754387}-{'f1_val': 0.9971029125121428, 'auprc': 0.9960128733798361, 'loss_val': 0.016098959831107446, 'psi': 0.9966668968592202}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.058515 cos_to_last_merge=0.9206 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=84 local utility u=0.000029 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9965502408822948, 'loss_val': 0.0240383053444985, 'psi': 0.9958499066779373}-{'f1_val': 0.9953830172083656, 'auprc': 0.9965451658346602, 'loss_val': 0.024081852079607228, 'psi': 0.9958478766588834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=84 head_norm_before_train=1.848440 cos_to_last_merge=0.8373 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.837
[S11] round=84 local utility u=0.086464 metrics={'f1_val': 0.9535293241441428, 'auprc': 0.9982520471342704, 'loss_val': 0.1443391588031702, 'psi': 0.9714184133401939}-{'f1_val': 0.9333136570215391, 'auprc': 0.9985224661178861, 'loss_val': 0.19678451763163413, 'psi': 0.9593971806600778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=84 head_norm_before_train=1.570765 cos_to_last_merge=0.8518 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.852
[S13] round=84 local utility u=0.480127 metrics={'f1_val': 0.6756277443893942, 'auprc': 0.7871622746018717, 'loss_val': 0.927651234226941, 'psi': 0.7202415564743853}-{'f1_val': 0.5810664842606293, 'auprc': 0.8040957512376966, 'loss_val': 1.3713371388105244, 'psi': 0.6702781910514564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=84 head_norm_before_train=2.277081 (no previous merge yet)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9940969409779112, 'auprc': 0.9986146242869388, 'loss_val': 0.030393280952375673, 'psi': 0.9959040143015223}-{'f1_val': 0.9978965638266506, 'auprc': 0.9969181702314114, 'loss_val': 0.01689225042240293, 'psi': 0.9975052063885549}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.008143 cos_to_last_merge=0.8712 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.871
[S15] round=84 local utility u=0.063850 metrics={'f1_val': 0.9534461902646267, 'auprc': 0.9960056093414391, 'loss_val': 0.0866017773457013, 'psi': 0.9704699578953517}-{'f1_val': 0.9363420537256022, 'auprc': 0.9960440535236895, 'loss_val': 0.11179136420909284, 'psi': 0.9602228536448372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=84 head_norm_before_train=1.953722 cos_to_last_merge=0.8621 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.862
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.9889160801241716, 'auprc': 0.9872432479682822, 'loss_val': 0.056241584908971604, 'psi': 0.9882469472618158}-{'f1_val': 0.9906664139916758, 'auprc': 0.9872336304266323, 'loss_val': 0.05118123372221746, 'psi': 0.9892933005656583}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=1.960798 cos_to_last_merge=0.7613 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=84 local utility u=0.125792 metrics={'f1_val': 0.8646665003948375, 'auprc': 0.8857860550876637, 'loss_val': 0.7703981208599282, 'psi': 0.873114322271968}-{'f1_val': 0.8241204804642763, 'auprc': 0.8871188073980667, 'loss_val': 0.782704566251742, 'psi': 0.8493198112377924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=85 head_norm_before_train=2.011370 cos_to_last_merge=0.8868 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.887
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.8325302043344676, 'auprc': 0.8837882389610827, 'loss_val': 0.4142093076538845, 'psi': 0.8530334181851136}-{'f1_val': 0.8278678932084138, 'auprc': 0.9937351949525234, 'loss_val': 0.4357216485940725, 'psi': 0.8942148139060577}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.118962 cos_to_last_merge=0.9255 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.7675603777773032, 'auprc': 0.9657979664906182, 'loss_val': 0.5453014771326659, 'psi': 0.8468554132626293}-{'f1_val': 0.9459198070950788, 'auprc': 0.9898066256891226, 'loss_val': 0.10942226153818937, 'psi': 0.9634745345326963}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=1.812470 cos_to_last_merge=0.9404 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=85 local utility u=0.059570 metrics={'f1_val': 0.9506983004795103, 'auprc': 0.952369104973376, 'loss_val': 0.29056295597044723, 'psi': 0.9513666222770567}-{'f1_val': 0.9431780418808957, 'auprc': 0.9297714979359211, 'loss_val': 0.296788197774064, 'psi': 0.9378154243029059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=85 head_norm_before_train=1.699645 cos_to_last_merge=0.7174 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.717
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.7002451011760882, 'auprc': 0.9887296934242868, 'loss_val': 0.28078561220485543, 'psi': 0.8156389380753677}-{'f1_val': 0.8205657108256498, 'auprc': 0.9624192112177594, 'loss_val': 0.31985373952694507, 'psi': 0.8773071109824937}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=2.190423 (no previous merge yet)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.5986319657660929, 'auprc': 0.8779645231793183, 'loss_val': 1.2615431837150215, 'psi': 0.710364988731383}-{'f1_val': 0.8636236464256976, 'auprc': 0.96395937272996, 'loss_val': 0.3499905654128746, 'psi': 0.9037579369474025}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=85 head_norm_before_train=1.723103 cos_to_last_merge=0.8934 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.893
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.6107998714593934, 'auprc': 0.7885704554470276, 'loss_val': 0.5607590058710425, 'psi': 0.6819081050544471}-{'f1_val': 0.971427986423524, 'auprc': 0.9677277202623114, 'loss_val': 0.18703056751943814, 'psi': 0.969947879959039}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=85 head_norm_before_train=1.944955 cos_to_last_merge=0.9320 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.932
[S8] round=85 local utility u=0.609612 metrics={'f1_val': 0.9818146322004495, 'auprc': 0.9995148471194719, 'loss_val': 0.05431455732706841, 'psi': 0.9888947181680585}-{'f1_val': 0.8316053088895372, 'auprc': 0.9991724214882397, 'loss_val': 0.3712563143947218, 'psi': 0.8986321539290182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=85 head_norm_before_train=2.237964 (no previous merge yet)
[S9] round=85 local utility u=0.003983 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963756802939924, 'loss_val': 0.01640914555800438, 'psi': 0.9968120196248826}-{'f1_val': 0.9971029125121428, 'auprc': 0.9937017131703826, 'loss_val': 0.016354177744582234, 'psi': 0.9957424327754387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=85 head_norm_before_train=2.063461 cos_to_last_merge=0.9201 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9965349363676466, 'loss_val': 0.024207911746100035, 'psi': 0.995843784872078}-{'f1_val': 0.9953830172083656, 'auprc': 0.9965502408822948, 'loss_val': 0.0240383053444985, 'psi': 0.9958499066779373}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=1.854066 cos_to_last_merge=0.8368 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.837
[S11] round=85 local utility u=0.189612 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983367344378542, 'loss_val': 0.020995217239828026, 'psi': 0.9970148987231273}-{'f1_val': 0.9535293241441428, 'auprc': 0.9982520471342704, 'loss_val': 0.1443391588031702, 'psi': 0.9714184133401939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=85 head_norm_before_train=1.570892 cos_to_last_merge=0.8514 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.851
[S13] round=85 local utility u=0.099982 metrics={'f1_val': 0.6677457244074904, 'auprc': 0.7816710810206584, 'loss_val': 0.6639217888289363, 'psi': 0.7133158670527575}-{'f1_val': 0.6756277443893942, 'auprc': 0.7871622746018717, 'loss_val': 0.927651234226941, 'psi': 0.7202415564743853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=85 head_norm_before_train=2.283201 (no previous merge yet)
[S14] round=85 local utility u=0.013416 metrics={'f1_val': 0.9972343982884562, 'auprc': 0.9978514074901028, 'loss_val': 0.020097150270290683, 'psi': 0.9974812019691148}-{'f1_val': 0.9940969409779112, 'auprc': 0.9986146242869388, 'loss_val': 0.030393280952375673, 'psi': 0.9959040143015223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=85 head_norm_before_train=2.014834 cos_to_last_merge=0.8703 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.870
[S15] round=85 local utility u=0.153362 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9915409882264795, 'loss_val': 0.02380194157073108, 'psi': 0.9944158417998763}-{'f1_val': 0.9534461902646267, 'auprc': 0.9960056093414391, 'loss_val': 0.0866017773457013, 'psi': 0.9704699578953517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=85 head_norm_before_train=1.958843 cos_to_last_merge=0.8616 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.862
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.973778664813662, 'auprc': 0.9867331968371907, 'loss_val': 0.10070043834952884, 'psi': 0.9789604776230736}-{'f1_val': 0.9889160801241716, 'auprc': 0.9872432479682822, 'loss_val': 0.056241584908971604, 'psi': 0.9882469472618158}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=1.967421 cos_to_last_merge=0.7611 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.6859492392325732, 'auprc': 0.9188354090676327, 'loss_val': 1.1143642686865387, 'psi': 0.779103707166597}-{'f1_val': 0.8646665003948375, 'auprc': 0.8857860550876637, 'loss_val': 0.7703981208599282, 'psi': 0.873114322271968}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=86 head_norm_before_train=2.016514 cos_to_last_merge=0.8863 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=86 local utility u=0.139331 metrics={'f1_val': 0.827607977432548, 'auprc': 0.993214285709114, 'loss_val': 0.43429222192478595, 'psi': 0.8938505007431744}-{'f1_val': 0.8325302043344676, 'auprc': 0.8837882389610827, 'loss_val': 0.4142093076538845, 'psi': 0.8530334181851136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=86 head_norm_before_train=2.123339 cos_to_last_merge=0.9251 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.7146248112114562, 'auprc': 0.995674467705423, 'loss_val': 0.6177078517279235, 'psi': 0.8270446738090429}-{'f1_val': 0.7675603777773032, 'auprc': 0.9657979664906182, 'loss_val': 0.5453014771326659, 'psi': 0.8468554132626293}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=1.815741 cos_to_last_merge=0.9397 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=86 local utility u=0.041612 metrics={'f1_val': 0.9567002646305708, 'auprc': 0.9699270089069906, 'loss_val': 0.2960244869418974, 'psi': 0.9619909623411387}-{'f1_val': 0.9506983004795103, 'auprc': 0.952369104973376, 'loss_val': 0.29056295597044723, 'psi': 0.9513666222770567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=86 head_norm_before_train=1.700869 cos_to_last_merge=0.7177 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.718
[S5] round=86 local utility u=0.040909 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9918004745792909, 'loss_val': 0.20967335374661514, 'psi': 0.8170165094973902}-{'f1_val': 0.7002451011760882, 'auprc': 0.9887296934242868, 'loss_val': 0.28078561220485543, 'psi': 0.8156389380753677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=86 head_norm_before_train=2.194321 (no previous merge yet)
[S6] round=86 local utility u=0.385832 metrics={'f1_val': 0.628182182669071, 'auprc': 0.9422610365703046, 'loss_val': 0.8600696502649403, 'psi': 0.7538137242295644}-{'f1_val': 0.5986319657660929, 'auprc': 0.8779645231793183, 'loss_val': 1.2615431837150215, 'psi': 0.710364988731383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=86 head_norm_before_train=1.724079 cos_to_last_merge=0.8933 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.893
[S7] round=86 local utility u=0.178230 metrics={'f1_val': 0.6617382158457898, 'auprc': 0.7914649545763478, 'loss_val': 0.5186121695329978, 'psi': 0.713628911338013}-{'f1_val': 0.6107998714593934, 'auprc': 0.7885704554470276, 'loss_val': 0.5607590058710425, 'psi': 0.6819081050544471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=86 head_norm_before_train=1.946036 cos_to_last_merge=0.9313 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.931
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.9934258922346048, 'loss_val': 0.7409832388233931, 'psi': 0.8260856242579953}-{'f1_val': 0.9818146322004495, 'auprc': 0.9995148471194719, 'loss_val': 0.05431455732706841, 'psi': 0.9888947181680585}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=2.239819 (no previous merge yet)
[S9] round=86 local utility u=0.005122 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9995392039635121, 'loss_val': 0.015638944543811442, 'psi': 0.9980757113089429}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963756802939924, 'loss_val': 0.01640914555800438, 'psi': 0.9968120196248826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=86 head_norm_before_train=2.068847 cos_to_last_merge=0.9196 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965154098674072, 'loss_val': 0.02434447151851027, 'psi': 0.9955870758660086}-{'f1_val': 0.9953830172083656, 'auprc': 0.9965349363676466, 'loss_val': 0.024207911746100035, 'psi': 0.995843784872078}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=1.859612 cos_to_last_merge=0.8363 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.836
[S11] round=86 local utility u=0.000388 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998377075404354, 'loss_val': 0.020340676421095633, 'psi': 0.9970310351097272}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983367344378542, 'loss_val': 0.020995217239828026, 'psi': 0.9970148987231273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=86 head_norm_before_train=1.573901 cos_to_last_merge=0.8508 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.851
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.5777029039978697, 'auprc': 0.8073994656783964, 'loss_val': 1.3283792167455428, 'psi': 0.6695815286700804}-{'f1_val': 0.6677457244074904, 'auprc': 0.7816710810206584, 'loss_val': 0.6639217888289363, 'psi': 0.7133158670527575}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=2.288282 (no previous merge yet)
[S14] round=86 local utility u=0.005571 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9983328689632442, 'loss_val': 0.014371733726920933, 'psi': 0.998071085881288}-{'f1_val': 0.9972343982884562, 'auprc': 0.9978514074901028, 'loss_val': 0.020097150270290683, 'psi': 0.9974812019691148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=86 head_norm_before_train=2.020646 cos_to_last_merge=0.8698 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.870
[S15] round=86 local utility u=0.005884 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9942496924968409, 'loss_val': 0.022644624369148342, 'psi': 0.9957478780312488}-{'f1_val': 0.9963324108488076, 'auprc': 0.9915409882264795, 'loss_val': 0.02380194157073108, 'psi': 0.9944158417998763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=86 head_norm_before_train=1.962284 cos_to_last_merge=0.8612 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.861
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9735644794253924, 'auprc': 0.9866047718906039, 'loss_val': 0.1024898039188697, 'psi': 0.978780596411477}-{'f1_val': 0.973778664813662, 'auprc': 0.9867331968371907, 'loss_val': 0.10070043834952884, 'psi': 0.9789604776230736}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=1.974454 cos_to_last_merge=0.7607 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.6396096333665386, 'auprc': 0.9152146223468459, 'loss_val': 1.3787539121044592, 'psi': 0.7498516289586616}-{'f1_val': 0.6859492392325732, 'auprc': 0.9188354090676327, 'loss_val': 1.1143642686865387, 'psi': 0.779103707166597}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.019435 cos_to_last_merge=0.8862 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=87 local utility u=0.000000 metrics={'f1_val': 0.8312391918118144, 'auprc': 0.8651185602884893, 'loss_val': 0.4257214482211751, 'psi': 0.8447909392024844}-{'f1_val': 0.827607977432548, 'auprc': 0.993214285709114, 'loss_val': 0.43429222192478595, 'psi': 0.8938505007431744}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=87 head_norm_before_train=2.128560 cos_to_last_merge=0.9247 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=87 local utility u=0.244353 metrics={'f1_val': 0.7741439883907444, 'auprc': 0.986735899851111, 'loss_val': 0.45930084704032303, 'psi': 0.859180752974891}-{'f1_val': 0.7146248112114562, 'auprc': 0.995674467705423, 'loss_val': 0.6177078517279235, 'psi': 0.8270446738090429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=87 head_norm_before_train=1.823514 cos_to_last_merge=0.9391 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.95241580337483, 'auprc': 0.9566815835340214, 'loss_val': 0.2957686029958803, 'psi': 0.9541221154385066}-{'f1_val': 0.9567002646305708, 'auprc': 0.9699270089069906, 'loss_val': 0.2960244869418974, 'psi': 0.9619909623411387}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.705097 cos_to_last_merge=0.7178 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.718
[S5] round=87 local utility u=0.211907 metrics={'f1_val': 0.7740373274199893, 'auprc': 0.987317353646328, 'loss_val': 0.21367073824096558, 'psi': 0.8593493379105248}-{'f1_val': 0.7004938661094564, 'auprc': 0.9918004745792909, 'loss_val': 0.20967335374661514, 'psi': 0.8170165094973902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=87 head_norm_before_train=2.195220 (no previous merge yet)
[S6] round=87 local utility u=1.000000 metrics={'f1_val': 0.9790951556034595, 'auprc': 0.983436302822211, 'loss_val': 0.09109106105150307, 'psi': 0.98083161449096}-{'f1_val': 0.628182182669071, 'auprc': 0.9422610365703046, 'loss_val': 0.8600696502649403, 'psi': 0.7538137242295644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=87 head_norm_before_train=1.726111 cos_to_last_merge=0.8934 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.893
[S7] round=87 local utility u=0.103397 metrics={'f1_val': 0.6719923379332478, 'auprc': 0.808842621820362, 'loss_val': 0.42547553672967087, 'psi': 0.7267324514880935}-{'f1_val': 0.6617382158457898, 'auprc': 0.7914649545763478, 'loss_val': 0.5186121695329978, 'psi': 0.713628911338013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=87 head_norm_before_train=1.948030 cos_to_last_merge=0.9305 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=87 local utility u=1.000000 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.996126765224161, 'loss_val': 0.04717015721706017, 'psi': 0.9937090903086836}-{'f1_val': 0.7145254456069222, 'auprc': 0.9934258922346048, 'loss_val': 0.7409832388233931, 'psi': 0.8260856242579953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=87 head_norm_before_train=2.243237 (no previous merge yet)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9954400132154921, 'auprc': 0.9995518559482266, 'loss_val': 0.019221788788989565, 'psi': 0.9970847503085859}-{'f1_val': 0.9971000495392299, 'auprc': 0.9995392039635121, 'loss_val': 0.015638944543811442, 'psi': 0.9980757113089429}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.074509 cos_to_last_merge=0.9191 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=87 local utility u=0.001257 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9965109478864553, 'loss_val': 0.02430701469205081, 'psi': 0.9958341894796015}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965154098674072, 'loss_val': 0.02434447151851027, 'psi': 0.9955870758660086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=87 head_norm_before_train=1.865353 cos_to_last_merge=0.8358 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.836
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9256188379442786, 'auprc': 0.998325820476102, 'loss_val': 0.2943064847298331, 'psi': 0.9547016309570079}-{'f1_val': 0.9961336749133093, 'auprc': 0.998377075404354, 'loss_val': 0.020340676421095633, 'psi': 0.9970310351097272}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=1.577909 cos_to_last_merge=0.8503 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.850
[S13] round=87 local utility u=0.308399 metrics={'f1_val': 0.6333454135984254, 'auprc': 0.846190413392965, 'loss_val': 1.1618098041971594, 'psi': 0.7184834135162412}-{'f1_val': 0.5777029039978697, 'auprc': 0.8073994656783964, 'loss_val': 1.3283792167455428, 'psi': 0.6695815286700804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=87 head_norm_before_train=2.292695 (no previous merge yet)
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.99626679667039, 'auprc': 0.9986671159675992, 'loss_val': 0.022513515729838476, 'psi': 0.9972269243892736}-{'f1_val': 0.9978965638266506, 'auprc': 0.9983328689632442, 'loss_val': 0.014371733726920933, 'psi': 0.998071085881288}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=2.026736 cos_to_last_merge=0.8692 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.869
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.8969963998270292, 'auprc': 0.9937888729239484, 'loss_val': 0.23616656923589674, 'psi': 0.9357133890657969}-{'f1_val': 0.9967466683875206, 'auprc': 0.9942496924968409, 'loss_val': 0.022644624369148342, 'psi': 0.9957478780312488}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=1.964710 cos_to_last_merge=0.8609 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.861
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9709982225224889, 'auprc': 0.9865162824552238, 'loss_val': 0.10669799788609041, 'psi': 0.9772054464955828}-{'f1_val': 0.9735644794253924, 'auprc': 0.9866047718906039, 'loss_val': 0.1024898039188697, 'psi': 0.978780596411477}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=1.981722 cos_to_last_merge=0.7603 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=87 local utility u=0.074011 metrics={'f1_val': 0.6464401753682608, 'auprc': 0.9189602060325126, 'loss_val': 1.2829518067595729, 'psi': 0.7554481876339616}-{'f1_val': 0.6396096333665386, 'auprc': 0.9152146223468459, 'loss_val': 1.3787539121044592, 'psi': 0.7498516289586616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=88 head_norm_before_train=2.021104 cos_to_last_merge=0.8863 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=88 local utility u=0.038100 metrics={'f1_val': 0.8313069042102528, 'auprc': 0.8903917602994642, 'loss_val': 0.42574692689377897, 'psi': 0.8549408466459374}-{'f1_val': 0.8312391918118144, 'auprc': 0.8651185602884893, 'loss_val': 0.4257214482211751, 'psi': 0.8447909392024844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=88 head_norm_before_train=2.133647 cos_to_last_merge=0.9244 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=88 local utility u=0.898910 metrics={'f1_val': 0.9937859548618788, 'auprc': 0.9993076998957959, 'loss_val': 0.017047190018839135, 'psi': 0.9959946528754458}-{'f1_val': 0.7741439883907444, 'auprc': 0.986735899851111, 'loss_val': 0.45930084704032303, 'psi': 0.859180752974891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=88 head_norm_before_train=1.831112 cos_to_last_merge=0.9383 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=88 local utility u=0.010148 metrics={'f1_val': 0.955537916930797, 'auprc': 0.9580386195333452, 'loss_val': 0.29827640297614594, 'psi': 0.9565381979718164}-{'f1_val': 0.95241580337483, 'auprc': 0.9566815835340214, 'loss_val': 0.2957686029958803, 'psi': 0.9541221154385066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=88 head_norm_before_train=1.713082 cos_to_last_merge=0.7172 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.717
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.7591142863672109, 'auprc': 0.9533574604658247, 'loss_val': 0.3977778625598378, 'psi': 0.8368115560066565}-{'f1_val': 0.7740373274199893, 'auprc': 0.987317353646328, 'loss_val': 0.21367073824096558, 'psi': 0.8593493379105248}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=2.198740 (no previous merge yet)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.8215601887177931, 'auprc': 0.9334792915568112, 'loss_val': 0.6431424289379667, 'psi': 0.8663278298534004}-{'f1_val': 0.9790951556034595, 'auprc': 0.983436302822211, 'loss_val': 0.09109106105150307, 'psi': 0.98083161449096}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.732696 cos_to_last_merge=0.8926 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.893
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.6571329567504032, 'auprc': 0.8051831211924206, 'loss_val': 0.4720270632667589, 'psi': 0.7163530225272101}-{'f1_val': 0.6719923379332478, 'auprc': 0.808842621820362, 'loss_val': 0.42547553672967087, 'psi': 0.7267324514880935}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=1.947572 cos_to_last_merge=0.9303 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=88 local utility u=0.001177 metrics={'f1_val': 0.9919561654725609, 'auprc': 0.9934494809280661, 'loss_val': 0.0359369342739013, 'psi': 0.992553491654763}-{'f1_val': 0.9920973070316986, 'auprc': 0.996126765224161, 'loss_val': 0.04717015721706017, 'psi': 0.9937090903086836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=88 head_norm_before_train=2.247820 (no previous merge yet)
[S9] round=88 local utility u=0.004536 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9999138161114054, 'loss_val': 0.016221737966863624, 'psi': 0.9977281438828058}-{'f1_val': 0.9954400132154921, 'auprc': 0.9995518559482266, 'loss_val': 0.019221788788989565, 'psi': 0.9970847503085859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=88 head_norm_before_train=2.080190 cos_to_last_merge=0.9186 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9964960288091779, 'loss_val': 0.024267960762694208, 'psi': 0.9958282218486905}-{'f1_val': 0.9953830172083656, 'auprc': 0.9965109478864553, 'loss_val': 0.02430701469205081, 'psi': 0.9958341894796015}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=1.870532 cos_to_last_merge=0.8354 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=88 local utility u=0.348924 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998234377678602, 'loss_val': 0.021776969819441074, 'psi': 0.9972243040684992}-{'f1_val': 0.9256188379442786, 'auprc': 0.998325820476102, 'loss_val': 0.2943064847298331, 'psi': 0.9547016309570079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=88 head_norm_before_train=1.582448 cos_to_last_merge=0.8496 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.850
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6330968543216235, 'auprc': 0.7307317805326615, 'loss_val': 1.0361152286263484, 'psi': 0.6721508248060388}-{'f1_val': 0.6333454135984254, 'auprc': 0.846190413392965, 'loss_val': 1.1618098041971594, 'psi': 0.7184834135162412}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=2.296379 (no previous merge yet)
[S14] round=88 local utility u=0.000000 metrics={'f1_val': 0.9944935406943898, 'auprc': 0.9969249700645457, 'loss_val': 0.024222337541877314, 'psi': 0.9954661124424522}-{'f1_val': 0.99626679667039, 'auprc': 0.9986671159675992, 'loss_val': 0.022513515729838476, 'psi': 0.9972269243892736}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=88 head_norm_before_train=2.033086 cos_to_last_merge=0.8684 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.70196819164474, 'auprc': 0.9119714093286515, 'loss_val': 0.6746577956735933, 'psi': 0.7859694787183047}-{'f1_val': 0.8969963998270292, 'auprc': 0.9937888729239484, 'loss_val': 0.23616656923589674, 'psi': 0.9357133890657969}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.966710 cos_to_last_merge=0.8607 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.861
[S16] round=88 local utility u=0.089391 metrics={'f1_val': 0.9908855317419744, 'auprc': 0.986948418150555, 'loss_val': 0.04853583920147166, 'psi': 0.9893106863054066}-{'f1_val': 0.9709982225224889, 'auprc': 0.9865162824552238, 'loss_val': 0.10669799788609041, 'psi': 0.9772054464955828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S16] sending update (kind=head size=1811 to 1 peers)
[S17] START round=88 head_norm_before_train=1.986745 cos_to_last_merge=0.7601 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=88 local utility u=0.231482 metrics={'f1_val': 0.6702817922961845, 'auprc': 0.9342962330502265, 'loss_val': 1.0090465706213598, 'psi': 0.7758875685978013}-{'f1_val': 0.6464401753682608, 'auprc': 0.9189602060325126, 'loss_val': 1.2829518067595729, 'psi': 0.7554481876339616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=89 head_norm_before_train=2.024479 cos_to_last_merge=0.8861 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=89 local utility u=0.033239 metrics={'f1_val': 0.8243652689135795, 'auprc': 0.9308380154114397, 'loss_val': 0.4389569979790028, 'psi': 0.8669543675127236}-{'f1_val': 0.8313069042102528, 'auprc': 0.8903917602994642, 'loss_val': 0.42574692689377897, 'psi': 0.8549408466459374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=89 head_norm_before_train=2.139486 cos_to_last_merge=0.9239 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.9577541105720339, 'auprc': 0.9801248108383418, 'loss_val': 0.14547196785161037, 'psi': 0.966702390678557}-{'f1_val': 0.9937859548618788, 'auprc': 0.9993076998957959, 'loss_val': 0.017047190018839135, 'psi': 0.9959946528754458}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=1.837587 cos_to_last_merge=0.9378 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9415832599110421, 'auprc': 0.954220435212788, 'loss_val': 0.3131485863646111, 'psi': 0.9466381300317405}-{'f1_val': 0.955537916930797, 'auprc': 0.9580386195333452, 'loss_val': 0.29827640297614594, 'psi': 0.9565381979718164}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.719958 cos_to_last_merge=0.7159 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.716
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.6842580671541019, 'auprc': 0.9612083565575757, 'loss_val': 0.39847328985574504, 'psi': 0.7950381829154913}-{'f1_val': 0.7591142863672109, 'auprc': 0.9533574604658247, 'loss_val': 0.3977778625598378, 'psi': 0.8368115560066565}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=2.201989 (no previous merge yet)
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.5974875837647279, 'auprc': 0.680201220645517, 'loss_val': 1.5424230248242743, 'psi': 0.6305730385170435}-{'f1_val': 0.8215601887177931, 'auprc': 0.9334792915568112, 'loss_val': 0.6431424289379667, 'psi': 0.8663278298534004}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.740162 cos_to_last_merge=0.8916 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.892
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.5764941857552051, 'auprc': 0.7837269622325269, 'loss_val': 0.7855050378410855, 'psi': 0.6593872963461338}-{'f1_val': 0.6571329567504032, 'auprc': 0.8051831211924206, 'loss_val': 0.4720270632667589, 'psi': 0.7163530225272101}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=1.952950 cos_to_last_merge=0.9302 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=89 local utility u=0.018196 metrics={'f1_val': 0.9936192847096137, 'auprc': 0.9995287316031481, 'loss_val': 0.027761682665100026, 'psi': 0.9959830634670275}-{'f1_val': 0.9919561654725609, 'auprc': 0.9934494809280661, 'loss_val': 0.0359369342739013, 'psi': 0.992553491654763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=89 head_norm_before_train=2.252677 (no previous merge yet)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9998996028788418, 'loss_val': 0.03659635584571114, 'psi': 0.9941996353342939}-{'f1_val': 0.9962710290637395, 'auprc': 0.9999138161114054, 'loss_val': 0.016221737966863624, 'psi': 0.9977281438828058}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.085726 cos_to_last_merge=0.9182 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=89 local utility u=0.000053 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9965021736088274, 'loss_val': 0.024181386243369168, 'psi': 0.9958306797685503}-{'f1_val': 0.9953830172083656, 'auprc': 0.9964960288091779, 'loss_val': 0.024267960762694208, 'psi': 0.9958282218486905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=89 head_norm_before_train=1.874486 cos_to_last_merge=0.8350 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.8753925568486531, 'auprc': 0.9980062168826738, 'loss_val': 0.14585495533663226, 'psi': 0.9244380208622613}-{'f1_val': 0.9965509216617638, 'auprc': 0.998234377678602, 'loss_val': 0.021776969819441074, 'psi': 0.9972243040684992}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=1.586962 cos_to_last_merge=0.8488 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.849
[S13] round=89 local utility u=0.301343 metrics={'f1_val': 0.7044533716459324, 'auprc': 0.801684351015466, 'loss_val': 1.0744258540570055, 'psi': 0.7433457633937458}-{'f1_val': 0.6330968543216235, 'auprc': 0.7307317805326615, 'loss_val': 1.0361152286263484, 'psi': 0.6721508248060388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=89 head_norm_before_train=2.298942 (no previous merge yet)
[S14] round=89 local utility u=0.015314 metrics={'f1_val': 0.9975787828504585, 'auprc': 0.998550545206449, 'loss_val': 0.016981944582660346, 'psi': 0.9979674877928547}-{'f1_val': 0.9944935406943898, 'auprc': 0.9969249700645457, 'loss_val': 0.024222337541877314, 'psi': 0.9954661124424522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=89 head_norm_before_train=2.039195 cos_to_last_merge=0.8677 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=89 local utility u=1.000000 metrics={'f1_val': 0.973605765680045, 'auprc': 0.9972062204630969, 'loss_val': 0.052230540395067804, 'psi': 0.9830459475932658}-{'f1_val': 0.70196819164474, 'auprc': 0.9119714093286515, 'loss_val': 0.6746577956735933, 'psi': 0.7859694787183047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=89 head_norm_before_train=1.970733 cos_to_last_merge=0.8603 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.860
[S16] round=89 local utility u=0.007057 metrics={'f1_val': 0.9915433264489799, 'auprc': 0.9890369574537135, 'loss_val': 0.04463485723477088, 'psi': 0.9905407788508733}-{'f1_val': 0.9908855317419744, 'auprc': 0.986948418150555, 'loss_val': 0.04853583920147166, 'psi': 0.9893106863054066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=89 head_norm_before_train=1.991731 cos_to_last_merge=0.7598 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=89 local utility u=0.503017 metrics={'f1_val': 0.8020622978887759, 'auprc': 0.9194572831416725, 'loss_val': 0.7491778013194613, 'psi': 0.8490202919899346}-{'f1_val': 0.6702817922961845, 'auprc': 0.9342962330502265, 'loss_val': 1.0090465706213598, 'psi': 0.7758875685978013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=90 head_norm_before_train=2.027908 cos_to_last_merge=0.8859 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.7857376517385912, 'auprc': 0.8019932007529349, 'loss_val': 0.5437371731773095, 'psi': 0.7922398713443287}-{'f1_val': 0.8243652689135795, 'auprc': 0.9308380154114397, 'loss_val': 0.4389569979790028, 'psi': 0.8669543675127236}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.144724 cos_to_last_merge=0.9235 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=90 local utility u=0.124977 metrics={'f1_val': 0.9737565819597069, 'auprc': 0.9993427955175919, 'loss_val': 0.049186970144372254, 'psi': 0.9839910673828609}-{'f1_val': 0.9577541105720339, 'auprc': 0.9801248108383418, 'loss_val': 0.14547196785161037, 'psi': 0.966702390678557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=90 head_norm_before_train=1.843455 cos_to_last_merge=0.9376 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.93637925247216, 'auprc': 0.8996014503330605, 'loss_val': 0.33366191631836645, 'psi': 0.9216681316165203}-{'f1_val': 0.9415832599110421, 'auprc': 0.954220435212788, 'loss_val': 0.3131485863646111, 'psi': 0.9466381300317405}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=1.725030 cos_to_last_merge=0.7154 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.715
[S5] round=90 local utility u=0.926451 metrics={'f1_val': 0.9350884292270233, 'auprc': 0.9906242440232743, 'loss_val': 0.138800628344842, 'psi': 0.9573027551455237}-{'f1_val': 0.6842580671541019, 'auprc': 0.9612083565575757, 'loss_val': 0.39847328985574504, 'psi': 0.7950381829154913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=90 head_norm_before_train=2.205202 (no previous merge yet)
[S6] round=90 local utility u=1.000000 metrics={'f1_val': 0.861621273248147, 'auprc': 0.9424720220033991, 'loss_val': 0.385467755672401, 'psi': 0.8939615727502478}-{'f1_val': 0.5974875837647279, 'auprc': 0.680201220645517, 'loss_val': 1.5424230248242743, 'psi': 0.6305730385170435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=90 head_norm_before_train=1.749771 cos_to_last_merge=0.8901 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.890
[S7] round=90 local utility u=0.453632 metrics={'f1_val': 0.6623409527989585, 'auprc': 0.809611003796778, 'loss_val': 0.4709734759655803, 'psi': 0.7212489731980862}-{'f1_val': 0.5764941857552051, 'auprc': 0.7837269622325269, 'loss_val': 0.7855050378410855, 'psi': 0.6593872963461338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=90 head_norm_before_train=1.957927 cos_to_last_merge=0.9303 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.9935879766866298, 'auprc': 0.9993083157929701, 'loss_val': 0.02760695184076395, 'psi': 0.995876112329166}-{'f1_val': 0.9936192847096137, 'auprc': 0.9995287316031481, 'loss_val': 0.027761682665100026, 'psi': 0.9959830634670275}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=90 head_norm_before_train=2.256595 (no previous merge yet)
[S9] round=90 local utility u=0.025581 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967394633682636, 'loss_val': 0.016174068037703073, 'psi': 0.9969575328545911}-{'f1_val': 0.990399656971262, 'auprc': 0.9998996028788418, 'loss_val': 0.03659635584571114, 'psi': 0.9941996353342939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=90 head_norm_before_train=2.088751 cos_to_last_merge=0.9177 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9963985722478126, 'loss_val': 0.02441670890731648, 'psi': 0.9957892392241443}-{'f1_val': 0.9953830172083656, 'auprc': 0.9965021736088274, 'loss_val': 0.024181386243369168, 'psi': 0.9958306797685503}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=1.879139 cos_to_last_merge=0.8346 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.835
[S11] round=90 local utility u=0.409469 metrics={'f1_val': 0.9920170517804294, 'auprc': 0.9988511752440266, 'loss_val': 0.029199740874161145, 'psi': 0.9947507011658683}-{'f1_val': 0.8753925568486531, 'auprc': 0.9980062168826738, 'loss_val': 0.14585495533663226, 'psi': 0.9244380208622613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=90 head_norm_before_train=1.589380 cos_to_last_merge=0.8483 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.848
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.6912353936819282, 'auprc': 0.802489084985941, 'loss_val': 1.1391144077404907, 'psi': 0.7357368702035334}-{'f1_val': 0.7044533716459324, 'auprc': 0.801684351015466, 'loss_val': 1.0744258540570055, 'psi': 0.7433457633937458}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=2.302899 (no previous merge yet)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9975787828504585, 'auprc': 0.9984466645805962, 'loss_val': 0.01716729943937872, 'psi': 0.9979259355425135}-{'f1_val': 0.9975787828504585, 'auprc': 0.998550545206449, 'loss_val': 0.016981944582660346, 'psi': 0.9979674877928547}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.044719 cos_to_last_merge=0.8672 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.867
[S15] round=90 local utility u=0.083246 metrics={'f1_val': 0.9960421039080725, 'auprc': 0.9980388784861262, 'loss_val': 0.022854649060310896, 'psi': 0.9968408137392939}-{'f1_val': 0.973605765680045, 'auprc': 0.9972062204630969, 'loss_val': 0.052230540395067804, 'psi': 0.9830459475932658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=90 head_norm_before_train=1.975886 cos_to_last_merge=0.8597 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.860
[S16] round=90 local utility u=0.002163 metrics={'f1_val': 0.9915433264489799, 'auprc': 0.9902272606402098, 'loss_val': 0.043879626901134165, 'psi': 0.9910169001254718}-{'f1_val': 0.9915433264489799, 'auprc': 0.9890369574537135, 'loss_val': 0.04463485723477088, 'psi': 0.9905407788508733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=90 head_norm_before_train=1.998283 cos_to_last_merge=0.7595 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=90 local utility u=0.299010 metrics={'f1_val': 0.850759324569426, 'auprc': 0.9511030343355797, 'loss_val': 0.5382762947523372, 'psi': 0.8908968084758875}-{'f1_val': 0.8020622978887759, 'auprc': 0.9194572831416725, 'loss_val': 0.7491778013194613, 'psi': 0.8490202919899346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=91 head_norm_before_train=2.032841 cos_to_last_merge=0.8852 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.885
[S2] round=91 local utility u=0.468871 metrics={'f1_val': 0.8300175772689471, 'auprc': 0.9914267083827351, 'loss_val': 0.4399746039052079, 'psi': 0.8945812297144622}-{'f1_val': 0.7857376517385912, 'auprc': 0.8019932007529349, 'loss_val': 0.5437371731773095, 'psi': 0.7922398713443287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=91 head_norm_before_train=2.150272 cos_to_last_merge=0.9230 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.9730563500401199, 'auprc': 0.9993678619174878, 'loss_val': 0.05391957520333457, 'psi': 0.9835809547910671}-{'f1_val': 0.9737565819597069, 'auprc': 0.9993427955175919, 'loss_val': 0.049186970144372254, 'psi': 0.9839910673828609}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=1.846593 cos_to_last_merge=0.9375 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=91 local utility u=0.096773 metrics={'f1_val': 0.9394190247759636, 'auprc': 0.9528325656848532, 'loss_val': 0.3180476012021929, 'psi': 0.9447844411395194}-{'f1_val': 0.93637925247216, 'auprc': 0.8996014503330605, 'loss_val': 0.33366191631836645, 'psi': 0.9216681316165203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=91 head_norm_before_train=1.731096 cos_to_last_merge=0.7148 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.715
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.5300826559853038, 'auprc': 0.8569737647047212, 'loss_val': 0.8283434358333734, 'psi': 0.6608390994730708}-{'f1_val': 0.9350884292270233, 'auprc': 0.9906242440232743, 'loss_val': 0.138800628344842, 'psi': 0.9573027551455237}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=2.207517 (no previous merge yet)
[S6] round=91 local utility u=0.433431 metrics={'f1_val': 0.9530841928538764, 'auprc': 0.9718824960582273, 'loss_val': 0.15561418527878149, 'psi': 0.9606035141356167}-{'f1_val': 0.861621273248147, 'auprc': 0.9424720220033991, 'loss_val': 0.385467755672401, 'psi': 0.8939615727502478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=91 head_norm_before_train=1.762019 cos_to_last_merge=0.8883 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.6285155757454202, 'auprc': 0.7950307811088783, 'loss_val': 0.660942867359075, 'psi': 0.6951216578908035}-{'f1_val': 0.6623409527989585, 'auprc': 0.809611003796778, 'loss_val': 0.4709734759655803, 'psi': 0.7212489731980862}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=1.960901 cos_to_last_merge=0.9300 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=91 local utility u=0.000575 metrics={'f1_val': 0.9939539858461368, 'auprc': 0.9994232024795947, 'loss_val': 0.028998510098465238, 'psi': 0.99614167249952}-{'f1_val': 0.9935879766866298, 'auprc': 0.9993083157929701, 'loss_val': 0.02760695184076395, 'psi': 0.995876112329166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=91 head_norm_before_train=2.261184 (no previous merge yet)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967279847085546, 'loss_val': 0.016148385510527424, 'psi': 0.9969529413907076}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967394633682636, 'loss_val': 0.016174068037703073, 'psi': 0.9969575328545911}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.091324 cos_to_last_merge=0.9173 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9961933707629067, 'loss_val': 0.024438429743527678, 'psi': 0.995707158630182}-{'f1_val': 0.9953830172083656, 'auprc': 0.9963985722478126, 'loss_val': 0.02441670890731648, 'psi': 0.9957892392241443}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=1.884194 cos_to_last_merge=0.8342 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=91 local utility u=0.017712 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9988986576973363, 'loss_val': 0.018618300455633414, 'psi': 0.9972396680269201}-{'f1_val': 0.9920170517804294, 'auprc': 0.9988511752440266, 'loss_val': 0.029199740874161145, 'psi': 0.9947507011658683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=91 head_norm_before_train=1.594451 cos_to_last_merge=0.8473 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.847
[S13] round=91 local utility u=0.116225 metrics={'f1_val': 0.6810318271211249, 'auprc': 0.7953337289439195, 'loss_val': 0.8239775541520356, 'psi': 0.7267525878502428}-{'f1_val': 0.6912353936819282, 'auprc': 0.802489084985941, 'loss_val': 1.1391144077404907, 'psi': 0.7357368702035334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=91 head_norm_before_train=2.305324 (no previous merge yet)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9986148583367542, 'loss_val': 0.016417650632227093, 'psi': 0.9977862786770478}-{'f1_val': 0.9975787828504585, 'auprc': 0.9984466645805962, 'loss_val': 0.01716729943937872, 'psi': 0.9979259355425135}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=2.050346 cos_to_last_merge=0.8665 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.867
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.9951712326766344, 'auprc': 0.9979401701636581, 'loss_val': 0.02416929582321945, 'psi': 0.9962788076714438}-{'f1_val': 0.9960421039080725, 'auprc': 0.9980388784861262, 'loss_val': 0.022854649060310896, 'psi': 0.9968408137392939}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=1.980814 cos_to_last_merge=0.8593 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.859
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9915433264489799, 'auprc': 0.989389189408971, 'loss_val': 0.044410603648355675, 'psi': 0.9906816716329763}-{'f1_val': 0.9915433264489799, 'auprc': 0.9902272606402098, 'loss_val': 0.043879626901134165, 'psi': 0.9910169001254718}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.004802 cos_to_last_merge=0.7593 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.648425306425292, 'auprc': 0.907342095902966, 'loss_val': 1.212068361286694, 'psi': 0.7519920222163616}-{'f1_val': 0.850759324569426, 'auprc': 0.9511030343355797, 'loss_val': 0.5382762947523372, 'psi': 0.8908968084758875}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.039263 cos_to_last_merge=0.8842 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.884
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.8307147626785653, 'auprc': 0.9826146686709873, 'loss_val': 0.4387484067826938, 'psi': 0.8914747250755342}-{'f1_val': 0.8300175772689471, 'auprc': 0.9914267083827351, 'loss_val': 0.4399746039052079, 'psi': 0.8945812297144622}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.155141 cos_to_last_merge=0.9225 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.9454190730031069, 'auprc': 0.9741560776761321, 'loss_val': 0.18828985381332097, 'psi': 0.9569138748723169}-{'f1_val': 0.9730563500401199, 'auprc': 0.9993678619174878, 'loss_val': 0.05391957520333457, 'psi': 0.9835809547910671}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=1.843127 cos_to_last_merge=0.9379 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=92 local utility u=0.090176 metrics={'f1_val': 0.9533169961231901, 'auprc': 0.9776867975565071, 'loss_val': 0.2956457251251614, 'psi': 0.9630649166965168}-{'f1_val': 0.9394190247759636, 'auprc': 0.9528325656848532, 'loss_val': 0.3180476012021929, 'psi': 0.9447844411395194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=92 head_norm_before_train=1.739474 cos_to_last_merge=0.7135 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.713
[S5] round=92 local utility u=1.000000 metrics={'f1_val': 0.9965549401573681, 'auprc': 0.9980938464259763, 'loss_val': 0.055887098628600494, 'psi': 0.9971705026648114}-{'f1_val': 0.5300826559853038, 'auprc': 0.8569737647047212, 'loss_val': 0.8283434358333734, 'psi': 0.6608390994730708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=92 head_norm_before_train=2.208779 (no previous merge yet)
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.5980355461339428, 'auprc': 0.6709247962981588, 'loss_val': 1.5439406777148557, 'psi': 0.6271912461996292}-{'f1_val': 0.9530841928538764, 'auprc': 0.9718824960582273, 'loss_val': 0.15561418527878149, 'psi': 0.9606035141356167}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.771119 cos_to_last_merge=0.8871 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.887
[S7] round=92 local utility u=0.954165 metrics={'f1_val': 0.844879093565357, 'auprc': 0.8663255408753657, 'loss_val': 0.26467759220066256, 'psi': 0.8534576724893606}-{'f1_val': 0.6285155757454202, 'auprc': 0.7950307811088783, 'loss_val': 0.660942867359075, 'psi': 0.6951216578908035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=92 head_norm_before_train=1.964234 cos_to_last_merge=0.9296 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9670442321886826, 'auprc': 0.9993265092051723, 'loss_val': 0.09320239879940859, 'psi': 0.9799571429952785}-{'f1_val': 0.9939539858461368, 'auprc': 0.9994232024795947, 'loss_val': 0.028998510098465238, 'psi': 0.99614167249952}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=2.264910 (no previous merge yet)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9828824722028254, 'auprc': 0.988399851790604, 'loss_val': 0.06971239353401207, 'psi': 0.9850894240379369}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967279847085546, 'loss_val': 0.016148385510527424, 'psi': 0.9969529413907076}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.092790 cos_to_last_merge=0.9168 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=92 local utility u=0.000105 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9962075281380819, 'loss_val': 0.024269921252930402, 'psi': 0.9957128215802521}-{'f1_val': 0.9953830172083656, 'auprc': 0.9961933707629067, 'loss_val': 0.024438429743527678, 'psi': 0.995707158630182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=92 head_norm_before_train=1.889208 cos_to_last_merge=0.8338 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998331518292226, 'loss_val': 0.020752938767632526, 'psi': 0.997012812264876}-{'f1_val': 0.9961336749133093, 'auprc': 0.9988986576973363, 'loss_val': 0.018618300455633414, 'psi': 0.9972396680269201}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=1.597849 cos_to_last_merge=0.8467 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.847
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.5813806572994502, 'auprc': 0.7538462819340856, 'loss_val': 1.2546812935048717, 'psi': 0.6503669071533045}-{'f1_val': 0.6810318271211249, 'auprc': 0.7953337289439195, 'loss_val': 0.8239775541520356, 'psi': 0.7267525878502428}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=2.304705 (no previous merge yet)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.980627595530023, 'auprc': 0.9985874821446574, 'loss_val': 0.04029593929948407, 'psi': 0.9878115501758767}-{'f1_val': 0.9972338922372435, 'auprc': 0.9986148583367542, 'loss_val': 0.016417650632227093, 'psi': 0.9977862786770478}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=2.055886 cos_to_last_merge=0.8659 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.866
[S15] round=92 local utility u=0.002764 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9967148143072211, 'loss_val': 0.021836515414820512, 'psi': 0.9964757884954412}-{'f1_val': 0.9951712326766344, 'auprc': 0.9979401701636581, 'loss_val': 0.02416929582321945, 'psi': 0.9962788076714438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=92 head_norm_before_train=1.985241 cos_to_last_merge=0.8590 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.859
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9913239876876926, 'auprc': 0.9869975952633433, 'loss_val': 0.046559983823435264, 'psi': 0.9895934307179529}-{'f1_val': 0.9915433264489799, 'auprc': 0.989389189408971, 'loss_val': 0.044410603648355675, 'psi': 0.9906816716329763}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.011676 cos_to_last_merge=0.7589 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=92 local utility u=0.082580 metrics={'f1_val': 0.6522107785296213, 'auprc': 0.9536731790609562, 'loss_val': 1.2086143352956364, 'psi': 0.7727957387421552}-{'f1_val': 0.648425306425292, 'auprc': 0.907342095902966, 'loss_val': 1.212068361286694, 'psi': 0.7519920222163616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=93 head_norm_before_train=2.044854 cos_to_last_merge=0.8833 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=93 local utility u=0.020876 metrics={'f1_val': 0.8309852530613718, 'auprc': 0.9925317025999909, 'loss_val': 0.4283710641387036, 'psi': 0.8956038328768194}-{'f1_val': 0.8307147626785653, 'auprc': 0.9826146686709873, 'loss_val': 0.4387484067826938, 'psi': 0.8914747250755342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=93 head_norm_before_train=2.159900 cos_to_last_merge=0.9220 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=93 local utility u=0.285560 metrics={'f1_val': 0.9982270248289424, 'auprc': 0.999583484000327, 'loss_val': 0.010299129576916498, 'psi': 0.9987696084974963}-{'f1_val': 0.9454190730031069, 'auprc': 0.9741560776761321, 'loss_val': 0.18828985381332097, 'psi': 0.9569138748723169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=93 head_norm_before_train=1.838522 cos_to_last_merge=0.9381 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.944995131219649, 'auprc': 0.9658371141581176, 'loss_val': 0.3142067100227914, 'psi': 0.9533319243950364}-{'f1_val': 0.9533169961231901, 'auprc': 0.9776867975565071, 'loss_val': 0.2956457251251614, 'psi': 0.9630649166965168}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=93 head_norm_before_train=1.743782 cos_to_last_merge=0.7119 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.712
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9613075486329109, 'auprc': 0.9965725490129476, 'loss_val': 0.09796491153613342, 'psi': 0.9754135487849256}-{'f1_val': 0.9965549401573681, 'auprc': 0.9980938464259763, 'loss_val': 0.055887098628600494, 'psi': 0.9971705026648114}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=2.212413 (no previous merge yet)
[S6] round=93 local utility u=1.000000 metrics={'f1_val': 0.7323571877256468, 'auprc': 0.9171683980006684, 'loss_val': 0.7673594534673505, 'psi': 0.8062816718356555}-{'f1_val': 0.5980355461339428, 'auprc': 0.6709247962981588, 'loss_val': 1.5439406777148557, 'psi': 0.6271912461996292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=93 head_norm_before_train=1.775894 cos_to_last_merge=0.8867 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.887
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.6375197728994503, 'auprc': 0.8036650123114388, 'loss_val': 0.4842487176635658, 'psi': 0.7039778686642457}-{'f1_val': 0.844879093565357, 'auprc': 0.8663255408753657, 'loss_val': 0.26467759220066256, 'psi': 0.8534576724893606}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=1.970288 cos_to_last_merge=0.9289 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.929
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.6697216717378913, 'auprc': 0.9991954203675385, 'loss_val': 1.047031301521793, 'psi': 0.8015111711897502}-{'f1_val': 0.9670442321886826, 'auprc': 0.9993265092051723, 'loss_val': 0.09320239879940859, 'psi': 0.9799571429952785}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=2.268616 (no previous merge yet)
[S9] round=93 local utility u=0.082074 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967231594987799, 'loss_val': 0.015856904821950447, 'psi': 0.9969510113067976}-{'f1_val': 0.9828824722028254, 'auprc': 0.988399851790604, 'loss_val': 0.06971239353401207, 'psi': 0.9850894240379369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=93 head_norm_before_train=2.096152 cos_to_last_merge=0.9163 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=93 local utility u=0.000180 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9962855558426116, 'loss_val': 0.02414316231023701, 'psi': 0.9957440326620639}-{'f1_val': 0.9953830172083656, 'auprc': 0.9962075281380819, 'loss_val': 0.024269921252930402, 'psi': 0.9957128215802521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=93 head_norm_before_train=1.894406 cos_to_last_merge=0.8334 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.833
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9927923047639055, 'auprc': 0.9989048180637297, 'loss_val': 0.024203876080337507, 'psi': 0.9952373100838351}-{'f1_val': 0.9961336749133093, 'auprc': 0.998331518292226, 'loss_val': 0.020752938767632526, 'psi': 0.997012812264876}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.600520 cos_to_last_merge=0.8462 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=93 local utility u=0.456570 metrics={'f1_val': 0.6860842666802078, 'auprc': 0.8056342729946804, 'loss_val': 1.1251267335084747, 'psi': 0.7339042692059968}-{'f1_val': 0.5813806572994502, 'auprc': 0.7538462819340856, 'loss_val': 1.2546812935048717, 'psi': 0.6503669071533045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=93 head_norm_before_train=2.308021 (no previous merge yet)
[S14] round=93 local utility u=0.060260 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9988711314375033, 'loss_val': 0.01910634478177195, 'psi': 0.997772923917801}-{'f1_val': 0.980627595530023, 'auprc': 0.9985874821446574, 'loss_val': 0.04029593929948407, 'psi': 0.9878115501758767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=93 head_norm_before_train=2.061353 cos_to_last_merge=0.8654 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.865
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9956792221423862, 'loss_val': 0.022147894536379407, 'psi': 0.9963196898894668}-{'f1_val': 0.9963164379542544, 'auprc': 0.9967148143072211, 'loss_val': 0.021836515414820512, 'psi': 0.9964757884954412}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=1.988579 cos_to_last_merge=0.8586 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.859
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9906631594356943, 'auprc': 0.9867610704124804, 'loss_val': 0.05280318676232901, 'psi': 0.9891023238264087}-{'f1_val': 0.9913239876876926, 'auprc': 0.9869975952633433, 'loss_val': 0.046559983823435264, 'psi': 0.9895934307179529}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=2.018301 cos_to_last_merge=0.7586 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=93 local utility u=0.516756 metrics={'f1_val': 0.7513737262983631, 'auprc': 0.9801766485463601, 'loss_val': 0.8495912820992316, 'psi': 0.8428948951975619}-{'f1_val': 0.6522107785296213, 'auprc': 0.9536731790609562, 'loss_val': 1.2086143352956364, 'psi': 0.7727957387421552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=94 head_norm_before_train=2.045230 cos_to_last_merge=0.8838 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.884
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.8300175772689471, 'auprc': 0.9611766464804771, 'loss_val': 0.4343033897811706, 'psi': 0.8824812049535591}-{'f1_val': 0.8309852530613718, 'auprc': 0.9925317025999909, 'loss_val': 0.4283710641387036, 'psi': 0.8956038328768194}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.164982 cos_to_last_merge=0.9215 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.7368720009529859, 'auprc': 0.9669128318489147, 'loss_val': 0.5932044877511763, 'psi': 0.8288883333113575}-{'f1_val': 0.9982270248289424, 'auprc': 0.999583484000327, 'loss_val': 0.010299129576916498, 'psi': 0.9987696084974963}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=1.838059 cos_to_last_merge=0.9378 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=94 local utility u=0.051456 metrics={'f1_val': 0.9563672756996452, 'auprc': 0.9749986719455883, 'loss_val': 0.3070125072239638, 'psi': 0.9638198341980224}-{'f1_val': 0.944995131219649, 'auprc': 0.9658371141581176, 'loss_val': 0.3142067100227914, 'psi': 0.9533319243950364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=94 head_norm_before_train=1.747894 cos_to_last_merge=0.7108 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.711
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.8815533637789427, 'auprc': 0.9674373431826273, 'loss_val': 0.34913289189562563, 'psi': 0.9159069555404165}-{'f1_val': 0.9613075486329109, 'auprc': 0.9965725490129476, 'loss_val': 0.09796491153613342, 'psi': 0.9754135487849256}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=2.215220 (no previous merge yet)
[S6] round=94 local utility u=0.212899 metrics={'f1_val': 0.7779477779075957, 'auprc': 0.9290529137394885, 'loss_val': 0.6507577733223855, 'psi': 0.8383898322403529}-{'f1_val': 0.7323571877256468, 'auprc': 0.9171683980006684, 'loss_val': 0.7673594534673505, 'psi': 0.8062816718356555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=94 head_norm_before_train=1.778316 cos_to_last_merge=0.8867 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.887
[S7] round=94 local utility u=0.241774 metrics={'f1_val': 0.6765946622693868, 'auprc': 0.8363201936430471, 'loss_val': 0.33311616638121755, 'psi': 0.740484874818851}-{'f1_val': 0.6375197728994503, 'auprc': 0.8036650123114388, 'loss_val': 0.4842487176635658, 'psi': 0.7039778686642457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=94 head_norm_before_train=1.976200 cos_to_last_merge=0.9284 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.928
[S8] round=94 local utility u=1.000000 metrics={'f1_val': 0.9929047892228047, 'auprc': 0.9917359938275503, 'loss_val': 0.034603455528005526, 'psi': 0.9924372710647029}-{'f1_val': 0.6697216717378913, 'auprc': 0.9991954203675385, 'loss_val': 1.047031301521793, 'psi': 0.8015111711897502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=94 head_norm_before_train=2.272515 (no previous merge yet)
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9940869172891387, 'loss_val': 0.015292593011882242, 'psi': 0.9958965144229411}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967231594987799, 'loss_val': 0.015856904821950447, 'psi': 0.9969510113067976}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.100570 cos_to_last_merge=0.9159 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=94 local utility u=0.000104 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9963483763911005, 'loss_val': 0.02412368333556801, 'psi': 0.9957691608814596}-{'f1_val': 0.9953830172083656, 'auprc': 0.9962855558426116, 'loss_val': 0.02414316231023701, 'psi': 0.9957440326620639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=94 head_norm_before_train=1.898464 cos_to_last_merge=0.8330 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.833
[S11] round=94 local utility u=0.013411 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.998934712528412, 'loss_val': 0.01896991560517605, 'psi': 0.9973991171568153}-{'f1_val': 0.9927923047639055, 'auprc': 0.9989048180637297, 'loss_val': 0.024203876080337507, 'psi': 0.9952373100838351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=94 head_norm_before_train=1.595035 cos_to_last_merge=0.8462 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6257176678796881, 'auprc': 0.8115713152950428, 'loss_val': 1.1941622111433867, 'psi': 0.7000591268458299}-{'f1_val': 0.6860842666802078, 'auprc': 0.8056342729946804, 'loss_val': 1.1251267335084747, 'psi': 0.7339042692059968}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=2.312705 (no previous merge yet)
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9949110635196168, 'auprc': 0.9969176798183403, 'loss_val': 0.022725829023963376, 'psi': 0.9957137100391062}-{'f1_val': 0.9970407855713329, 'auprc': 0.9988711314375033, 'loss_val': 0.01910634478177195, 'psi': 0.997772923917801}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=2.065831 cos_to_last_merge=0.8650 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.865
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9957580034108253, 'loss_val': 0.2392864664544829, 'psi': 0.9402053070822025}-{'f1_val': 0.9967466683875206, 'auprc': 0.9956792221423862, 'loss_val': 0.022147894536379407, 'psi': 0.9963196898894668}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=1.992510 cos_to_last_merge=0.8582 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.858
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.9854289553993194, 'auprc': 0.98664049226529, 'loss_val': 0.06626316959019192, 'psi': 0.9859135701457076}-{'f1_val': 0.9906631594356943, 'auprc': 0.9867610704124804, 'loss_val': 0.05280318676232901, 'psi': 0.9891023238264087}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=2.025537 cos_to_last_merge=0.7583 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.7213882399358004, 'auprc': 0.9227913342360408, 'loss_val': 0.93557273878871, 'psi': 0.8019494776558965}-{'f1_val': 0.7513737262983631, 'auprc': 0.9801766485463601, 'loss_val': 0.8495912820992316, 'psi': 0.8428948951975619}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.047522 cos_to_last_merge=0.8838 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.884
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.8295657679760795, 'auprc': 0.9403391846255577, 'loss_val': 0.4419717457457131, 'psi': 0.8738751346358707}-{'f1_val': 0.8300175772689471, 'auprc': 0.9611766464804771, 'loss_val': 0.4343033897811706, 'psi': 0.8824812049535591}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.168257 cos_to_last_merge=0.9212 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=95 local utility u=0.445413 metrics={'f1_val': 0.8361408166936375, 'auprc': 0.9709842795842292, 'loss_val': 0.3102054564875592, 'psi': 0.8900782018498741}-{'f1_val': 0.7368720009529859, 'auprc': 0.9669128318489147, 'loss_val': 0.5932044877511763, 'psi': 0.8288883333113575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=95 head_norm_before_train=1.836588 cos_to_last_merge=0.9377 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9491366727431776, 'auprc': 0.9739646011132423, 'loss_val': 0.308081821899705, 'psi': 0.9590678440912035}-{'f1_val': 0.9563672756996452, 'auprc': 0.9749986719455883, 'loss_val': 0.3070125072239638, 'psi': 0.9638198341980224}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.755700 cos_to_last_merge=0.7096 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.710
[S5] round=95 local utility u=0.540565 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9979855718646238, 'loss_val': 0.047447803588770744, 'psi': 0.9969062964205772}-{'f1_val': 0.8815533637789427, 'auprc': 0.9674373431826273, 'loss_val': 0.34913289189562563, 'psi': 0.9159069555404165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=95 head_norm_before_train=2.221261 (no previous merge yet)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.6835659725827786, 'auprc': 0.8847159994510191, 'loss_val': 0.9099876918672071, 'psi': 0.7640259833300749}-{'f1_val': 0.7779477779075957, 'auprc': 0.9290529137394885, 'loss_val': 0.6507577733223855, 'psi': 0.8383898322403529}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.780884 cos_to_last_merge=0.8867 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.887
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.6182902852349226, 'auprc': 0.7958684397029914, 'loss_val': 0.6430584759936532, 'psi': 0.6893215470221501}-{'f1_val': 0.6765946622693868, 'auprc': 0.8363201936430471, 'loss_val': 0.33311616638121755, 'psi': 0.740484874818851}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=1.981160 cos_to_last_merge=0.9281 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.928
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9801088196843715, 'auprc': 0.9992540563222018, 'loss_val': 0.05708467645157076, 'psi': 0.9877669143395036}-{'f1_val': 0.9929047892228047, 'auprc': 0.9917359938275503, 'loss_val': 0.034603455528005526, 'psi': 0.9924372710647029}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=2.272624 (no previous merge yet)
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9999132403013364, 'loss_val': 0.021399720012679594, 'psi': 0.9964791199708742}-{'f1_val': 0.9971029125121428, 'auprc': 0.9940869172891387, 'loss_val': 0.015292593011882242, 'psi': 0.9958965144229411}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.105438 cos_to_last_merge=0.9155 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=95 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.995750122952437, 'loss_val': 0.024250914779680555, 'psi': 0.9955298595059942}-{'f1_val': 0.9953830172083656, 'auprc': 0.9963483763911005, 'loss_val': 0.02412368333556801, 'psi': 0.9957691608814596}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=95 head_norm_before_train=1.901770 cos_to_last_merge=0.8327 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.833
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9989337191116394, 'loss_val': 0.01916141121145347, 'psi': 0.9972536925926414}-{'f1_val': 0.9963753869090841, 'auprc': 0.998934712528412, 'loss_val': 0.01896991560517605, 'psi': 0.9973991171568153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.593618 cos_to_last_merge=0.8459 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.549160952669838, 'auprc': 0.7604822211411338, 'loss_val': 1.4483180762805254, 'psi': 0.6336894600583562}-{'f1_val': 0.6257176678796881, 'auprc': 0.8115713152950428, 'loss_val': 1.1941622111433867, 'psi': 0.7000591268458299}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.317751 (no previous merge yet)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9326007938202232, 'auprc': 0.9969209210247022, 'loss_val': 0.11210372723933214, 'psi': 0.9583288447020148}-{'f1_val': 0.9949110635196168, 'auprc': 0.9969176798183403, 'loss_val': 0.022725829023963376, 'psi': 0.9957137100391062}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.070278 cos_to_last_merge=0.8647 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.865
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.8005155304951903, 'auprc': 0.9227792583573322, 'loss_val': 0.5158658956951184, 'psi': 0.8494210216400471}-{'f1_val': 0.903170176196454, 'auprc': 0.9957580034108253, 'loss_val': 0.2392864664544829, 'psi': 0.9402053070822025}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=1.997405 cos_to_last_merge=0.8577 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.858
[S16] round=95 local utility u=0.030252 metrics={'f1_val': 0.9913239876876926, 'auprc': 0.988117498740707, 'loss_val': 0.04556091202519158, 'psi': 0.9900413921088984}-{'f1_val': 0.9854289553993194, 'auprc': 0.98664049226529, 'loss_val': 0.06626316959019192, 'psi': 0.9859135701457076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=95 head_norm_before_train=2.031249 cos_to_last_merge=0.7579 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=95 local utility u=0.688623 metrics={'f1_val': 0.85679488997967, 'auprc': 0.9931739332790397, 'loss_val': 0.5819142606061477, 'psi': 0.9113465072994178}-{'f1_val': 0.7213882399358004, 'auprc': 0.9227913342360408, 'loss_val': 0.93557273878871, 'psi': 0.8019494776558965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=96 head_norm_before_train=2.052113 cos_to_last_merge=0.8832 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.8291905051514447, 'auprc': 0.8486802027808106, 'loss_val': 0.4512025571852853, 'psi': 0.836986384203191}-{'f1_val': 0.8295657679760795, 'auprc': 0.9403391846255577, 'loss_val': 0.4419717457457131, 'psi': 0.8738751346358707}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.171822 cos_to_last_merge=0.9208 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.7647747621190178, 'auprc': 0.9844356534928003, 'loss_val': 0.46554556248435963, 'psi': 0.8526391186685308}-{'f1_val': 0.8361408166936375, 'auprc': 0.9709842795842292, 'loss_val': 0.3102054564875592, 'psi': 0.8900782018498741}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=1.833388 cos_to_last_merge=0.9376 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.938620904017485, 'auprc': 0.9612287757286566, 'loss_val': 0.3619002083707056, 'psi': 0.9476640527019536}-{'f1_val': 0.9491366727431776, 'auprc': 0.9739646011132423, 'loss_val': 0.308081821899705, 'psi': 0.9590678440912035}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=1.766759 cos_to_last_merge=0.7075 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.708
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.93718596280094, 'auprc': 0.9921271744873296, 'loss_val': 0.09677038244095496, 'psi': 0.9591624474754958}-{'f1_val': 0.9961867794578795, 'auprc': 0.9979855718646238, 'loss_val': 0.047447803588770744, 'psi': 0.9969062964205772}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=2.228011 (no previous merge yet)
[S6] round=96 local utility u=0.587024 metrics={'f1_val': 0.8191084421792802, 'auprc': 0.9103074794030966, 'loss_val': 0.6259683075542009, 'psi': 0.8555880570688068}-{'f1_val': 0.6835659725827786, 'auprc': 0.8847159994510191, 'loss_val': 0.9099876918672071, 'psi': 0.7640259833300749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=96 head_norm_before_train=1.783276 cos_to_last_merge=0.8865 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.886
[S7] round=96 local utility u=0.180737 metrics={'f1_val': 0.6430912123821656, 'auprc': 0.8067219894151858, 'loss_val': 0.4629499799730284, 'psi': 0.7085435231953736}-{'f1_val': 0.6182902852349226, 'auprc': 0.7958684397029914, 'loss_val': 0.6430584759936532, 'psi': 0.6893215470221501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=96 head_norm_before_train=1.986460 cos_to_last_merge=0.9275 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.928
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9346314646369251, 'auprc': 0.9994070474709257, 'loss_val': 0.14793229971577104, 'psi': 0.9605416977705253}-{'f1_val': 0.9801088196843715, 'auprc': 0.9992540563222018, 'loss_val': 0.05708467645157076, 'psi': 0.9877669143395036}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.268652 (no previous merge yet)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.9998567040078904, 'loss_val': 0.023379485816018335, 'psi': 0.9959548526957333}-{'f1_val': 0.9941897064172326, 'auprc': 0.9999132403013364, 'loss_val': 0.021399720012679594, 'psi': 0.9964791199708742}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.107442 cos_to_last_merge=0.9150 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9957159829730757, 'loss_val': 0.024422233660600954, 'psi': 0.9955162035142496}-{'f1_val': 0.9953830172083656, 'auprc': 0.995750122952437, 'loss_val': 0.024250914779680555, 'psi': 0.9955298595059942}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=1.905231 cos_to_last_merge=0.8323 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9631945283766061, 'auprc': 0.9980529011343692, 'loss_val': 0.13458007693823815, 'psi': 0.9771378774797114}-{'f1_val': 0.9961336749133093, 'auprc': 0.9989337191116394, 'loss_val': 0.01916141121145347, 'psi': 0.9972536925926414}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=1.593166 cos_to_last_merge=0.8457 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=96 local utility u=0.785492 metrics={'f1_val': 0.6952829126480279, 'auprc': 0.7990043924173468, 'loss_val': 0.8696324246896081, 'psi': 0.7367715045557555}-{'f1_val': 0.549160952669838, 'auprc': 0.7604822211411338, 'loss_val': 1.4483180762805254, 'psi': 0.6336894600583562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=96 head_norm_before_train=2.323766 (no previous merge yet)
[S14] round=96 local utility u=0.243947 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9968917722430533, 'loss_val': 0.015448065820065951, 'psi': 0.9974497645098768}-{'f1_val': 0.9326007938202232, 'auprc': 0.9969209210247022, 'loss_val': 0.11210372723933214, 'psi': 0.9583288447020148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=96 head_norm_before_train=2.075141 cos_to_last_merge=0.8642 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.864
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.7644526498477454, 'auprc': 0.9140824757972488, 'loss_val': 0.6245879736597089, 'psi': 0.8243045802275467}-{'f1_val': 0.8005155304951903, 'auprc': 0.9227792583573322, 'loss_val': 0.5158658956951184, 'psi': 0.8494210216400471}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=2.001386 cos_to_last_merge=0.8574 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.857
[S16] round=96 local utility u=0.003062 metrics={'f1_val': 0.9915433264489799, 'auprc': 0.9889989041714523, 'loss_val': 0.04339760238110457, 'psi': 0.9905255575379688}-{'f1_val': 0.9913239876876926, 'auprc': 0.988117498740707, 'loss_val': 0.04556091202519158, 'psi': 0.9900413921088984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S16] sending update (kind=head size=1809 to 1 peers)
[S17] START round=96 head_norm_before_train=2.037730 cos_to_last_merge=0.7576 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.8480955561435084, 'auprc': 0.9980745129288228, 'loss_val': 0.6316480380088318, 'psi': 0.9080871388576341}-{'f1_val': 0.85679488997967, 'auprc': 0.9931739332790397, 'loss_val': 0.5819142606061477, 'psi': 0.9113465072994178}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=2.056374 cos_to_last_merge=0.8828 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=97 local utility u=0.115499 metrics={'f1_val': 0.8267219219335871, 'auprc': 0.9298325742331189, 'loss_val': 0.44885026580350834, 'psi': 0.8679661828533998}-{'f1_val': 0.8291905051514447, 'auprc': 0.8486802027808106, 'loss_val': 0.4512025571852853, 'psi': 0.836986384203191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S2] sending update (kind=head size=1810 to 1 peers)
[S3] START round=97 head_norm_before_train=2.176519 cos_to_last_merge=0.9203 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=97 local utility u=0.248669 metrics={'f1_val': 0.8222956173341092, 'auprc': 0.9957704597453679, 'loss_val': 0.34733694759232914, 'psi': 0.8916855542986126}-{'f1_val': 0.7647747621190178, 'auprc': 0.9844356534928003, 'loss_val': 0.46554556248435963, 'psi': 0.8526391186685308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=97 head_norm_before_train=1.833053 cos_to_last_merge=0.9371 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.937
[S4] round=97 local utility u=0.011536 metrics={'f1_val': 0.9394916785075977, 'auprc': 0.9662313241140924, 'loss_val': 0.3590611165280764, 'psi': 0.9501875367501956}-{'f1_val': 0.938620904017485, 'auprc': 0.9612287757286566, 'loss_val': 0.3619002083707056, 'psi': 0.9476640527019536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=97 head_norm_before_train=1.782472 cos_to_last_merge=0.7051 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.705
[S5] round=97 local utility u=0.216548 metrics={'f1_val': 0.9965549401573681, 'auprc': 0.9987669221759968, 'loss_val': 0.039806872666437836, 'psi': 0.9974397329648197}-{'f1_val': 0.93718596280094, 'auprc': 0.9921271744873296, 'loss_val': 0.09677038244095496, 'psi': 0.9591624474754958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=97 head_norm_before_train=2.235174 (no previous merge yet)
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.7662500539126317, 'auprc': 0.8971317282600921, 'loss_val': 0.8135941432624731, 'psi': 0.8186027236516158}-{'f1_val': 0.8191084421792802, 'auprc': 0.9103074794030966, 'loss_val': 0.6259683075542009, 'psi': 0.8555880570688068}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=1.787801 cos_to_last_merge=0.8856 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.886
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.6397351075116349, 'auprc': 0.8035960990483761, 'loss_val': 0.5468867978428239, 'psi': 0.7052795041263313}-{'f1_val': 0.6430912123821656, 'auprc': 0.8067219894151858, 'loss_val': 0.4629499799730284, 'psi': 0.7085435231953736}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=97 head_norm_before_train=1.991353 cos_to_last_merge=0.9268 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.927
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.8624248896498095, 'auprc': 0.9993517698643564, 'loss_val': 0.3074240025717875, 'psi': 0.9171956417356282}-{'f1_val': 0.9346314646369251, 'auprc': 0.9994070474709257, 'loss_val': 0.14793229971577104, 'psi': 0.9605416977705253}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=2.267971 (no previous merge yet)
[S9] round=97 local utility u=0.009910 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967101811191942, 'loss_val': 0.016615658618438393, 'psi': 0.9969458199549633}-{'f1_val': 0.9933536184876286, 'auprc': 0.9998567040078904, 'loss_val': 0.023379485816018335, 'psi': 0.9959548526957333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=97 head_norm_before_train=2.111146 cos_to_last_merge=0.9146 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=97 local utility u=0.000093 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9957306107526105, 'loss_val': 0.02428096400974819, 'psi': 0.9955220546260635}-{'f1_val': 0.9953830172083656, 'auprc': 0.9957159829730757, 'loss_val': 0.024422233660600954, 'psi': 0.9955162035142496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=97 head_norm_before_train=1.907364 cos_to_last_merge=0.8321 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.8320809460671639, 'auprc': 0.9977111956072128, 'loss_val': 0.28692410575093436, 'psi': 0.8983330458831834}-{'f1_val': 0.9631945283766061, 'auprc': 0.9980529011343692, 'loss_val': 0.13458007693823815, 'psi': 0.9771378774797114}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=1.591493 cos_to_last_merge=0.8456 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=97 local utility u=0.040904 metrics={'f1_val': 0.7089257073892341, 'auprc': 0.8001156594815723, 'loss_val': 0.8730145945083562, 'psi': 0.7454016882261694}-{'f1_val': 0.6952829126480279, 'auprc': 0.7990043924173468, 'loss_val': 0.8696324246896081, 'psi': 0.7367715045557555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=97 head_norm_before_train=2.329335 (no previous merge yet)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9985956954009014, 'loss_val': 0.019892755754133563, 'psi': 0.9976627495031604}-{'f1_val': 0.9978217593544257, 'auprc': 0.9968917722430533, 'loss_val': 0.015448065820065951, 'psi': 0.9974497645098768}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.080295 cos_to_last_merge=0.8637 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.864
[S15] round=97 local utility u=0.362587 metrics={'f1_val': 0.8261391353073375, 'auprc': 0.9674815114176056, 'loss_val': 0.42973055019143147, 'psi': 0.8826760857514447}-{'f1_val': 0.7644526498477454, 'auprc': 0.9140824757972488, 'loss_val': 0.6245879736597089, 'psi': 0.8243045802275467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=97 head_norm_before_train=2.005708 cos_to_last_merge=0.8570 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.857
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9915433264489799, 'auprc': 0.988870408418996, 'loss_val': 0.043133637257572785, 'psi': 0.9904741592369863}-{'f1_val': 0.9915433264489799, 'auprc': 0.9889989041714523, 'loss_val': 0.04339760238110457, 'psi': 0.9905255575379688}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.043221 cos_to_last_merge=0.7573 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.7176842950884619, 'auprc': 0.9982101826620553, 'loss_val': 0.9591449718915414, 'psi': 0.8298946501178992}-{'f1_val': 0.8480955561435084, 'auprc': 0.9980745129288228, 'loss_val': 0.6316480380088318, 'psi': 0.9080871388576341}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=98 head_norm_before_train=2.058496 cos_to_last_merge=0.8829 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.8287384106388248, 'auprc': 0.8445373133508514, 'loss_val': 0.44651184833570257, 'psi': 0.8350579717236355}-{'f1_val': 0.8267219219335871, 'auprc': 0.9298325742331189, 'loss_val': 0.44885026580350834, 'psi': 0.8679661828533998}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.182021 cos_to_last_merge=0.9199 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=98 local utility u=0.498599 metrics={'f1_val': 0.951962295622857, 'auprc': 0.9889241282687297, 'loss_val': 0.10760007021604116, 'psi': 0.966747028681206}-{'f1_val': 0.8222956173341092, 'auprc': 0.9957704597453679, 'loss_val': 0.34733694759232914, 'psi': 0.8916855542986126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=98 head_norm_before_train=1.835735 cos_to_last_merge=0.9365 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=98 local utility u=0.014388 metrics={'f1_val': 0.9395474941019565, 'auprc': 0.966817831730613, 'loss_val': 0.33237997414313386, 'psi': 0.9504556291534191}-{'f1_val': 0.9394916785075977, 'auprc': 0.9662313241140924, 'loss_val': 0.3590611165280764, 'psi': 0.9501875367501956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=98 head_norm_before_train=1.792831 cos_to_last_merge=0.7034 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.703
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.982130022870737, 'auprc': 0.9947490269556909, 'loss_val': 0.0633597864545887, 'psi': 0.9871776245047186}-{'f1_val': 0.9965549401573681, 'auprc': 0.9987669221759968, 'loss_val': 0.039806872666437836, 'psi': 0.9974397329648197}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.241983 (no previous merge yet)
[S6] round=98 local utility u=0.090540 metrics={'f1_val': 0.7677261547226834, 'auprc': 0.9055778009259488, 'loss_val': 0.666708063718146, 'psi': 0.8228668132039896}-{'f1_val': 0.7662500539126317, 'auprc': 0.8971317282600921, 'loss_val': 0.8135941432624731, 'psi': 0.8186027236516158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=98 head_norm_before_train=1.792626 cos_to_last_merge=0.8850 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.885
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.616295408807936, 'auprc': 0.7959981131718183, 'loss_val': 0.7411147752969649, 'psi': 0.688176490553489}-{'f1_val': 0.6397351075116349, 'auprc': 0.8035960990483761, 'loss_val': 0.5468867978428239, 'psi': 0.7052795041263313}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=1.994687 cos_to_last_merge=0.9260 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=98 local utility u=0.526252 metrics={'f1_val': 0.9925028268365944, 'auprc': 0.9979865457415453, 'loss_val': 0.031291744803598184, 'psi': 0.9946963143985748}-{'f1_val': 0.8624248896498095, 'auprc': 0.9993517698643564, 'loss_val': 0.3074240025717875, 'psi': 0.9171956417356282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=98 head_norm_before_train=2.270535 (no previous merge yet)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9951785375266808, 'loss_val': 0.01764425971206661, 'psi': 0.9960677220990072}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967101811191942, 'loss_val': 0.016615658618438393, 'psi': 0.9969458199549633}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.115648 cos_to_last_merge=0.9142 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=98 local utility u=0.000858 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.99618721047162, 'loss_val': 0.023934443293467996, 'psi': 0.9957046945136674}-{'f1_val': 0.9953830172083656, 'auprc': 0.9957306107526105, 'loss_val': 0.02428096400974819, 'psi': 0.9955220546260635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=98 head_norm_before_train=1.909742 cos_to_last_merge=0.8318 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=98 local utility u=0.153137 metrics={'f1_val': 0.8640357807114828, 'auprc': 0.9981545723086468, 'loss_val': 0.17370882755890635, 'psi': 0.9176832973503484}-{'f1_val': 0.8320809460671639, 'auprc': 0.9977111956072128, 'loss_val': 0.28692410575093436, 'psi': 0.8983330458831834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=98 head_norm_before_train=1.596724 cos_to_last_merge=0.8448 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.845
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.6416163806058289, 'auprc': 0.8120107689722661, 'loss_val': 1.1317359243327045, 'psi': 0.7097741359524038}-{'f1_val': 0.7089257073892341, 'auprc': 0.8001156594815723, 'loss_val': 0.8730145945083562, 'psi': 0.7454016882261694}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=2.334665 (no previous merge yet)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9969231069320645, 'loss_val': 0.017742706790557665, 'psi': 0.9972125606044164}-{'f1_val': 0.9970407855713329, 'auprc': 0.9985956954009014, 'loss_val': 0.019892755754133563, 'psi': 0.9976627495031604}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.085344 cos_to_last_merge=0.8633 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.863
[S15] round=98 local utility u=0.310314 metrics={'f1_val': 0.8891240530303031, 'auprc': 0.9956475758834927, 'loss_val': 0.27151028857915965, 'psi': 0.9317334621715789}-{'f1_val': 0.8261391353073375, 'auprc': 0.9674815114176056, 'loss_val': 0.42973055019143147, 'psi': 0.8826760857514447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=98 head_norm_before_train=2.008121 cos_to_last_merge=0.8567 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.857
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9913239876876926, 'auprc': 0.9884418711819287, 'loss_val': 0.04489896900855436, 'psi': 0.9901711410853871}-{'f1_val': 0.9915433264489799, 'auprc': 0.988870408418996, 'loss_val': 0.043133637257572785, 'psi': 0.9904741592369863}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.049890 cos_to_last_merge=0.7570 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.7261237666436112, 'auprc': 0.9632951326230635, 'loss_val': 0.9856185526140194, 'psi': 0.8209923130353922}-{'f1_val': 0.7176842950884619, 'auprc': 0.9982101826620553, 'loss_val': 0.9591449718915414, 'psi': 0.8298946501178992}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.061083 cos_to_last_merge=0.8827 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=99 local utility u=0.020757 metrics={'f1_val': 0.8295057784047982, 'auprc': 0.8548185592305702, 'loss_val': 0.4404461232491597, 'psi': 0.839630890735107}-{'f1_val': 0.8287384106388248, 'auprc': 0.8445373133508514, 'loss_val': 0.44651184833570257, 'psi': 0.8350579717236355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S2] r=100 psi=0.840 u=0.0208 p_local=0.0414 f1=0.830 auprc=0.855 bytes=109865
[S3] START round=99 head_norm_before_train=2.187146 cos_to_last_merge=0.9195 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.6453124581984266, 'auprc': 0.9625297625882914, 'loss_val': 0.8845789651120666, 'psi': 0.7721993799543725}-{'f1_val': 0.951962295622857, 'auprc': 0.9889241282687297, 'loss_val': 0.10760007021604116, 'psi': 0.966747028681206}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.772 u=0.0000 p_local=0.1925 f1=0.645 auprc=0.963 bytes=91721
[S4] START round=99 head_norm_before_train=1.837947 cos_to_last_merge=0.9366 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.937
[S4] round=99 local utility u=0.027442 metrics={'f1_val': 0.9472778152733138, 'auprc': 0.9636146889014638, 'loss_val': 0.31426818451768784, 'psi': 0.9538125647245739}-{'f1_val': 0.9395474941019565, 'auprc': 0.966817831730613, 'loss_val': 0.33237997414313386, 'psi': 0.9504556291534191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S4] r=100 psi=0.954 u=0.0274 p_local=0.0227 f1=0.947 auprc=0.964 bytes=102565
[S5] START round=99 head_norm_before_train=1.801160 cos_to_last_merge=0.7023 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.702
[S5] round=99 local utility u=0.059603 metrics={'f1_val': 0.9961867794578795, 'auprc': 0.9993667282122283, 'loss_val': 0.04234821912427467, 'psi': 0.9974587589596189}-{'f1_val': 0.982130022870737, 'auprc': 0.9947490269556909, 'loss_val': 0.0633597864545887, 'psi': 0.9871776245047186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S5] r=100 psi=0.997 u=0.0596 p_local=0.1637 f1=0.996 auprc=0.999 bytes=95281
[S6] START round=99 head_norm_before_train=2.245337 (no previous merge yet)
[S6] round=99 local utility u=0.520997 metrics={'f1_val': 0.8557177671725819, 'auprc': 0.9678847488147057, 'loss_val': 0.3395850158364596, 'psi': 0.9005845598294314}-{'f1_val': 0.7677261547226834, 'auprc': 0.9055778009259488, 'loss_val': 0.666708063718146, 'psi': 0.8228668132039896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S6] r=100 psi=0.901 u=0.5210 p_local=0.3146 f1=0.856 auprc=0.968 bytes=97152
[S7] START round=99 head_norm_before_train=1.800395 cos_to_last_merge=0.8843 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.884
[S7] round=99 local utility u=0.114145 metrics={'f1_val': 0.637794487391121, 'auprc': 0.8017367910469382, 'loss_val': 0.65903536965155, 'psi': 0.7033714088534478}-{'f1_val': 0.616295408807936, 'auprc': 0.7959981131718183, 'loss_val': 0.7411147752969649, 'psi': 0.688176490553489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=100 psi=0.703 u=0.1141 p_local=0.1252 f1=0.638 auprc=0.802 bytes=97208
[S8] START round=99 head_norm_before_train=1.996730 cos_to_last_merge=0.9262 (last merge round=14)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.99005760857834, 'auprc': 0.9964040930115614, 'loss_val': 0.03938789565276214, 'psi': 0.9925962023516286}-{'f1_val': 0.9925028268365944, 'auprc': 0.9979865457415453, 'loss_val': 0.031291744803598184, 'psi': 0.9946963143985748}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.993 u=0.0000 p_local=0.1726 f1=0.990 auprc=0.996 bytes=100824
[S9] START round=99 head_norm_before_train=2.273130 (no previous merge yet)
[S9] round=99 local utility u=0.000863 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9958682666322429, 'loss_val': 0.017986569896055984, 'psi': 0.996343613741232}-{'f1_val': 0.9966605118138915, 'auprc': 0.9951785375266808, 'loss_val': 0.01764425971206661, 'psi': 0.9960677220990072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S9] r=100 psi=0.996 u=0.0009 p_local=0.0069 f1=0.997 auprc=0.996 bytes=102566
[S10] START round=99 head_norm_before_train=2.120648 cos_to_last_merge=0.9138 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=99 local utility u=0.000533 metrics={'f1_val': 0.9953830172083656, 'auprc': 0.9964289926571097, 'loss_val': 0.02359419052465527, 'psi': 0.9958014073878632}-{'f1_val': 0.9953830172083656, 'auprc': 0.99618721047162, 'loss_val': 0.023934443293467996, 'psi': 0.9957046945136674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S10] r=100 psi=0.996 u=0.0005 p_local=0.0004 f1=0.995 auprc=0.996 bytes=106156
[S11] START round=99 head_norm_before_train=1.912715 cos_to_last_merge=0.8315 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.832
[S11] round=99 local utility u=0.468186 metrics={'f1_val': 0.9956087446483022, 'auprc': 0.9985088955226211, 'loss_val': 0.027836583128520442, 'psi': 0.9967688049980298}-{'f1_val': 0.8640357807114828, 'auprc': 0.9981545723086468, 'loss_val': 0.17370882755890635, 'psi': 0.9176832973503484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] r=100 psi=0.997 u=0.4682 p_local=0.1407 f1=0.996 auprc=0.999 bytes=109654
[S13] START round=99 head_norm_before_train=1.602393 cos_to_last_merge=0.8439 (last merge round=14)
[S13] ⚠️ Model drifted since last merge! cos=0.844
[S13] round=99 local utility u=0.421599 metrics={'f1_val': 0.7359070631930337, 'auprc': 0.8156648272465329, 'loss_val': 0.8652444664229306, 'psi': 0.7678101688144334}-{'f1_val': 0.6416163806058289, 'auprc': 0.8120107689722661, 'loss_val': 1.1317359243327045, 'psi': 0.7097741359524038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] r=100 psi=0.768 u=0.4216 p_local=0.2147 f1=0.736 auprc=0.816 bytes=100864
[S14] START round=99 head_norm_before_train=2.339196 (no previous merge yet)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9335586373133045, 'auprc': 0.9986687652638576, 'loss_val': 0.12512064166462644, 'psi': 0.9596026884935257}-{'f1_val': 0.9974055297193176, 'auprc': 0.9969231069320645, 'loss_val': 0.017742706790557665, 'psi': 0.9972125606044164}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.960 u=0.0000 p_local=0.0297 f1=0.934 auprc=0.999 bytes=95279
[S15] START round=99 head_norm_before_train=2.090225 cos_to_last_merge=0.8628 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.863
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.7893134005015043, 'auprc': 0.9342609766885992, 'loss_val': 0.5208985163319368, 'psi': 0.8472924309763423}-{'f1_val': 0.8891240530303031, 'auprc': 0.9956475758834927, 'loss_val': 0.27151028857915965, 'psi': 0.9317334621715789}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.847 u=0.0000 p_local=0.1298 f1=0.789 auprc=0.934 bytes=98869
[S16] START round=99 head_norm_before_train=2.012205 cos_to_last_merge=0.8563 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9913239876876926, 'auprc': 0.9881977441870557, 'loss_val': 0.046947872126437196, 'psi': 0.990073490287438}-{'f1_val': 0.9913239876876926, 'auprc': 0.9884418711819287, 'loss_val': 0.04489896900855436, 'psi': 0.9901711410853871}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.990 u=0.0000 p_local=0.0053 f1=0.991 auprc=0.988 bytes=99183
[S17] START round=99 head_norm_before_train=2.057511 cos_to_last_merge=0.7566 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=99 local utility u=0.703292 metrics={'f1_val': 0.8915251650759815, 'auprc': 0.9422784769494499, 'loss_val': 0.5083937264158181, 'psi': 0.9118264898253688}-{'f1_val': 0.7261237666436112, 'auprc': 0.9632951326230635, 'loss_val': 0.9856185526140194, 'psi': 0.8209923130353922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=100 psi=0.912 u=0.7033 p_local=0.2609 f1=0.892 auprc=0.942 bytes=93494
[runner] rounds complete.
[runner] all agents stopped.
