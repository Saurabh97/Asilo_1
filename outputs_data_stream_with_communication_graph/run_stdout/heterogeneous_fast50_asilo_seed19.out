[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:52803
[S3] → join 127.0.0.1:52802
[S4] → join 127.0.0.1:52802
[S5] → join 127.0.0.1:52802
[S6] → join 127.0.0.1:52802
[S7] → join 127.0.0.1:52802
[S8] → join 127.0.0.1:52802
[S9] → join 127.0.0.1:52802
[S10] → join 127.0.0.1:52802
[S11] → join 127.0.0.1:52802
[S13] → join 127.0.0.1:52802
[S14] → join 127.0.0.1:52802
[S15] → join 127.0.0.1:52802
[S16] → join 127.0.0.1:52802
[S17] → join 127.0.0.1:52802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.203398 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.214896 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.154165 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.231562 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.242231 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.183094 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.080739 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.150924 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.188136 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.116697 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.123596 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.169294 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.246910 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.177822 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.117635 (no previous merge yet)
[S15]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S4
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S7
[S3] + discovered S16
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S5
[S4] + discovered S9
[S4] + discovered S7
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S15
[S4] + discovered S5
[S4] + discovered S14
[S4] + discovered S11
[S5] + discovered S3
[S4] + discovered S13
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S16
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S5] + discovered S8
[S5] + discovered S14
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S10
[S5] + discovered S9
[S5] + discovered S6
[S5] + discovered S17
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S13
[S6] + discovered S13
[S6] + discovered S9
[S6] + discovered S16
[S6] + discovered S17
[S6] + discovered S14
[S6] + discovered S7
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S8
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S3
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S7
[S7] + discovered S9
[S7] + discovered S17
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S13
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S4
[S9] + discovered S6
[S8] + discovered S17
[S8] + discovered S14
[S8] + discovered S10
[S8] + discovered S15
[S8] + discovered S13
[S8] + discovered S16
[S8] + discovered S9
[S8] + discovered S11
[S10] + discovered S2
[S10] + discovered S7
[S10] + discovered S3
[S10] + discovered S9
[S9] + discovered S17
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S13
[S10] + discovered S5
[S9] + discovered S16
[S10] + discovered S6
[S9] + discovered S14
[S10] + discovered S4
[S9] + discovered S11
[S10] + discovered S8
[S11] + discovered S8
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S13
[S11] + discovered S4
[S11] + discovered S6
[S11] + discovered S9
[S10] + discovered S17
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S2
[S10] + discovered S11
[S11] + discovered S5
[S11] + discovered S10
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S15
[S13] + discovered S3
[S11] + discovered S17
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S8
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S7
[S14] + discovered S9
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S13
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S15
[S14] + discovered S10
[S14] + discovered S3
[S14] + discovered S15
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S11
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S9
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S3
[S15] + discovered S10
[S15] + discovered S14
[S15] + discovered S2
[S15] + discovered S4
[S16] + discovered S4
[S16] + discovered S3
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S14
[S16] + discovered S5
[S16] + discovered S7
[S16] + discovered S9
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S6
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S2
[S17] + discovered S8
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S16
[S17] + discovered S5
[S17] + discovered S10
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S11
[S17] + discovered S7
[S17] + discovered S15
[S17] + discovered S4
[S17] + discovered S3
[S16] + discovered S17
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:52814
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:52810
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:52808
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:52815
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S11] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:52812
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:52812
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:52808
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:52813
[S2] START round=1 head_norm_before_train=1.221048 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6212543882288941, 'loss_val': 1.2295508854484873, 'psi': 0.3335680353246977}-{'f1_val': 0.6659219523089863, 'auprc': 0.9026561775900969, 'loss_val': 1.3339522615329782, 'psi': 0.7606156424214305}
[S3] START round=1 head_norm_before_train=1.212849 (no previous merge yet)
[S3] round=1 local utility u=0.390270 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7075265830335818, 'loss_val': 1.3243087895289694, 'psi': 0.3669146725818969}-{'f1_val': 0.13984006561410703, 'auprc': 0.45662091462116683, 'loss_val': 1.3521314938353324, 'psi': 0.26655240521693097}
[S4] START round=1 head_norm_before_train=1.161392 (no previous merge yet)
[S4] round=1 local utility u=0.271050 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7644589230694012, 'loss_val': 1.2740870316307158, 'psi': 0.389919546564871}-{'f1_val': 0.14022662889518414, 'auprc': 0.6069556242795813, 'loss_val': 1.3436768754113402, 'psi': 0.326918227048943}
[S5] START round=1 head_norm_before_train=1.234063 (no previous merge yet)
[S5] round=1 local utility u=0.184086 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7690557861490963, 'loss_val': 1.3235165069718018, 'psi': 0.3929794573167814}-{'f1_val': 0.14226190476190476, 'auprc': 0.6559158184717281, 'loss_val': 1.352268038381837, 'psi': 0.3477234702458341}
[S6] START round=1 head_norm_before_train=1.251089 (no previous merge yet)
[S6] round=1 local utility u=0.294320 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8328114338223863, 'loss_val': 1.2754010335783796, 'psi': 0.41798034275972373}-{'f1_val': 0.08954368264159597, 'auprc': 0.7617205941262567, 'loss_val': 1.3394731604832248, 'psi': 0.35841444723546023}
[S7] START round=1 head_norm_before_train=1.196350 (no previous merge yet)
[S7] round=1 local utility u=0.269532 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7584018565098644, 'loss_val': 1.3110163470509382, 'psi': 0.38859483624140073}-{'f1_val': 0.14205682272909165, 'auprc': 0.5899392374658434, 'loss_val': 1.3446916988350053, 'psi': 0.32120978862379235}
[S8] START round=1 head_norm_before_train=1.093164 (no previous merge yet)
[S8] round=1 local utility u=0.095543 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7268198667017454, 'loss_val': 1.2734078829319941, 'psi': 0.3747015361164725}-{'f1_val': 0.13995598239295717, 'auprc': 0.6826316917420906, 'loss_val': 1.331930138341038, 'psi': 0.35702626613261057}
[S9] START round=1 head_norm_before_train=1.162717 (no previous merge yet)
[S9] round=1 local utility u=0.047369 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8653185249190605, 'loss_val': 1.2861102135691385, 'psi': 0.4309661842516218}-{'f1_val': 0.141397957139996, 'auprc': 0.8469216507114304, 'loss_val': 1.3256569739898398, 'psi': 0.4236074345685698}
[S10] START round=1 head_norm_before_train=1.201234 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.739033620019073, 'loss_val': 1.2834697028018769, 'psi': 0.3787864305326636}-{'f1_val': 0.13862163754172394, 'auprc': 0.8111140309013528, 'loss_val': 1.3361880601090046, 'psi': 0.4076185948855755}
[S11] START round=1 head_norm_before_train=1.123267 (no previous merge yet)
[S11] round=1 local utility u=0.012148 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7801453057339562, 'loss_val': 1.2948289326059623, 'psi': 0.3963063323174489}-{'f1_val': 0.14041368337311058, 'auprc': 0.785985686179066, 'loss_val': 1.3366469422779914, 'psi': 0.3986424844954927}
[S13] START round=1 head_norm_before_train=1.136905 (no previous merge yet)
[S13] round=1 local utility u=0.227493 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.590633871167136, 'loss_val': 1.286378717996422, 'psi': 0.32048500601308627}-{'f1_val': 0.1403857625770531, 'auprc': 0.45544236050207454, 'loss_val': 1.3357903983658481, 'psi': 0.2664084017470617}
[S14] START round=1 head_norm_before_train=1.163765 (no previous merge yet)
[S14] round=1 local utility u=0.318497 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5236086473295574, 'loss_val': 1.3544331809922758, 'psi': 0.29365817066144523}-{'f1_val': 0.07959393704692952, 'auprc': 0.4403780941402725, 'loss_val': 1.3771510379336398, 'psi': 0.22390759988426673}
[S15] START round=1 head_norm_before_train=1.257723 (no previous merge yet)
[S15] round=1 local utility u=0.292098 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7697142090282972, 'loss_val': 1.2931536371753614, 'psi': 0.3917258744282539}-{'f1_val': 0.13973365136155833, 'auprc': 0.5877927438654216, 'loss_val': 1.331584750102137, 'psi': 0.3189572883631036}
[S16] START round=1 head_norm_before_train=1.179919 (no previous merge yet)
[S16] round=1 local utility u=0.043150 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.82808288533718, 'loss_val': 1.3127291245924444, 'psi': 0.4156156242543939}-{'f1_val': 0.14063745019920318, 'auprc': 0.8081495022710403, 'loss_val': 1.3392292268639945, 'psi': 0.40764227102793804}
[S17] START round=1 head_norm_before_train=1.125882 (no previous merge yet)
[S17] round=1 local utility u=0.036864 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8110309461825747, 'loss_val': 1.3279899438700802, 'psi': 0.4089817564634605}-{'f1_val': 0.14209563702628134, 'auprc': 0.7994631986971904, 'loss_val': 1.3738938252392454, 'psi': 0.405042661694645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:52805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:52807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:52805
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S5] → sending delta(kind=head bytes=1786) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:52811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:52803
[S8] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1786 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] cosine check vs S14: cos=0.0167
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=0.0789
[S8] RECEIVED delta(kind=head bytes=1790) from S3
[S8] cosine check vs S3: cos=-0.0805
[S8] DROPPED delta from S3 (cos=-0.0805 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1786) from S5
[S9] cosine check vs S5: cos=-0.1373
[S9] DROPPED delta from S5 (cos=-0.1373 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S8
[S10] cosine check vs S8: cos=0.0458
[S9] RECEIVED delta(kind=head bytes=1788) from S7
[S9] cosine check vs S7: cos=0.0555
[S6] RECEIVED delta(kind=head bytes=1793) from S13
[S6] cosine check vs S13: cos=-0.1540
[S6] DROPPED delta from S13 (cos=-0.1540 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1791) from S6
[S3] cosine check vs S6: cos=-0.0335
[S3] DROPPED delta from S6 (cos=-0.0335 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S11
[S7] cosine check vs S11: cos=-0.0312
[S7] DROPPED delta from S11 (cos=-0.0312 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1790) from S15
[S16] cosine check vs S15: cos=-0.0115
[S16] DROPPED delta from S15 (cos=-0.0115 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1787) from S16
[S5] cosine check vs S16: cos=-0.0659
[S5] DROPPED delta from S16 (cos=-0.0659 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] cosine check vs S9: cos=-0.1373
[S5] DROPPED delta from S9 (cos=-0.1373 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:52815
[S17] sending update (kind=head size=1791 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1791) from S17
[S15] cosine check vs S17: cos=0.0435
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.241803
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.208700e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.859208 delta_norm=0.820870
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.132280
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.925341e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.857627 delta_norm=0.792534
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.184709
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.254208e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.872577 delta_norm=0.825421
[S9] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.286427
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.474866e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.884964 delta_norm=0.847487
[S15] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.160989
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.168281e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.830606 delta_norm=0.816828
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.263619 (no previous merge yet)
[S2] round=2 local utility u=0.648439 metrics={'f1_val': 0.33940817350987107, 'auprc': 0.6214428698619888, 'loss_val': 1.119023863198916, 'psi': 0.4522220520507182}-{'f1_val': 0.1417771333885667, 'auprc': 0.6212543882288941, 'loss_val': 1.2295508854484873, 'psi': 0.3335680353246977}
[S3] START round=2 head_norm_before_train=1.222093 (no previous merge yet)
[S3] round=2 local utility u=0.152237 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7988675574932799, 'loss_val': 1.293856865913006, 'psi': 0.4034510623657762}-{'f1_val': 0.13984006561410703, 'auprc': 0.7075265830335818, 'loss_val': 1.3243087895289694, 'psi': 0.3669146725818969}
[S4] START round=2 head_norm_before_train=1.202169 (no previous merge yet)
[S4] round=2 local utility u=0.060603 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7634011003913037, 'loss_val': 1.1497070106772627, 'psi': 0.389496417493632}-{'f1_val': 0.14022662889518414, 'auprc': 0.7644589230694012, 'loss_val': 1.2740870316307158, 'psi': 0.389919546564871}
[S5] START round=2 head_norm_before_train=1.242465 (no previous merge yet)
[S5] round=2 local utility u=0.019919 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7696028136107688, 'loss_val': 1.2853205436854718, 'psi': 0.3931982683014504}-{'f1_val': 0.14226190476190476, 'auprc': 0.7690557861490963, 'loss_val': 1.3235165069718018, 'psi': 0.3929794573167814}
[S6] START round=2 head_norm_before_train=1.279678 (no previous merge yet)
[S6] round=2 local utility u=0.004187 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8121368288262323, 'loss_val': 1.205003629653904, 'psi': 0.40971050076126214}-{'f1_val': 0.14142628205128205, 'auprc': 0.8328114338223863, 'loss_val': 1.2754010335783796, 'psi': 0.41798034275972373}
[S7] START round=2 head_norm_before_train=1.217327 (no previous merge yet)
[S7] round=2 local utility u=0.034141 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7691680785968916, 'loss_val': 1.2750333499390152, 'psi': 0.39290132507621167}-{'f1_val': 0.14205682272909165, 'auprc': 0.7584018565098644, 'loss_val': 1.3110163470509382, 'psi': 0.38859483624140073}
[S8] START round=2 head_norm_before_train=0.857627 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.048883 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7510827825402934, 'loss_val': 1.2484302052776797, 'psi': 0.3844067024518917}-{'f1_val': 0.13995598239295717, 'auprc': 0.7268198667017454, 'loss_val': 1.2734078829319941, 'psi': 0.3747015361164725}
[S9] START round=2 head_norm_before_train=0.872577 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.198193 metrics={'f1_val': 0.141397957139996, 'auprc': 0.998942827235274, 'loss_val': 1.290597517122789, 'psi': 0.48441590517810723}-{'f1_val': 0.141397957139996, 'auprc': 0.8653185249190605, 'loss_val': 1.2861102135691385, 'psi': 0.4309661842516218}
[S10] START round=2 head_norm_before_train=0.859208 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6527034505769114, 'loss_val': 1.2576445772553149, 'psi': 0.3442543627557989}-{'f1_val': 0.13862163754172394, 'auprc': 0.739033620019073, 'loss_val': 1.2834697028018769, 'psi': 0.3787864305326636}
[S11] START round=2 head_norm_before_train=1.140654 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6150106150028345, 'loss_val': 1.2472824773167208, 'psi': 0.33025245602500014}-{'f1_val': 0.14041368337311058, 'auprc': 0.7801453057339562, 'loss_val': 1.2948289326059623, 'psi': 0.3963063323174489}
[S13] START round=2 head_norm_before_train=1.175928 (no previous merge yet)
[S13] round=2 local utility u=0.066233 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6135175543877229, 'loss_val': 1.2225643653646598, 'psi': 0.32963847930132106}-{'f1_val': 0.1403857625770531, 'auprc': 0.590633871167136, 'loss_val': 1.286378717996422, 'psi': 0.32048500601308627}
[S14] START round=2 head_norm_before_train=1.168903 (no previous merge yet)
[S14] round=2 local utility u=0.142898 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.61104588789101, 'loss_val': 1.3309481712371285, 'psi': 0.3286330668860263}-{'f1_val': 0.14035785288270378, 'auprc': 0.5236086473295574, 'loss_val': 1.3544331809922758, 'psi': 0.29365817066144523}
[S15] START round=2 head_norm_before_train=0.884964 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.027909 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7869860012151234, 'loss_val': 1.2891516131829681, 'psi': 0.3986345913029844}-{'f1_val': 0.13973365136155833, 'auprc': 0.7697142090282972, 'loss_val': 1.2931536371753614, 'psi': 0.3917258744282539}
[S16] START round=2 head_norm_before_train=1.193159 (no previous merge yet)
[S16] round=2 local utility u=0.008277 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8244732149547218, 'loss_val': 1.2853463223976715, 'psi': 0.41417175610141066}-{'f1_val': 0.14063745019920318, 'auprc': 0.82808288533718, 'loss_val': 1.3127291245924444, 'psi': 0.4156156242543939}
[S17] START round=2 head_norm_before_train=0.830606 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6717573484363795, 'loss_val': 1.2691831846930774, 'psi': 0.35327231736498244}-{'f1_val': 0.14094896331738438, 'auprc': 0.8110309461825747, 'loss_val': 1.3279899438700802, 'psi': 0.4089817564634605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S5] → sending delta(kind=head bytes=1784) to S4@127.0.0.1:52804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:52813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:52805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:52805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:52811
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:52805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:52813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:52805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:52808
[S2] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1784 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S4
[S13] cosine check vs S4: cos=0.0864
[S8] RECEIVED delta(kind=head bytes=1789) from S9
[S8] cosine check vs S9: cos=-0.0482
[S8] DROPPED delta from S9 (cos=-0.0482 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S15
[S10] cosine check vs S15: cos=0.0218
[S4] RECEIVED delta(kind=head bytes=1784) from S5
[S4] cosine check vs S5: cos=-0.0033
[S4] DROPPED delta from S5 (cos=-0.0033 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1791) from S3
[S9] cosine check vs S3: cos=-0.0660
[S9] DROPPED delta from S3 (cos=-0.0660 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S8
[S9] cosine check vs S8: cos=-0.0482
[S9] DROPPED delta from S8 (cos=-0.0482 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S16
[S7] cosine check vs S16: cos=-0.0183
[S7] DROPPED delta from S16 (cos=-0.0183 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S2
[S5] cosine check vs S2: cos=0.0527
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] cosine check vs S14: cos=0.0252
[S5] RECEIVED delta(kind=head bytes=1789) from S13
[S5] cosine check vs S13: cos=-0.0162
[S5] DROPPED delta from S13 (cos=-0.0162 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S6
[S5] cosine check vs S6: cos=-0.1200
[S5] DROPPED delta from S6 (cos=-0.1200 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1791) from S7
[S13] cosine check vs S7: cos=0.0468
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=0.911651
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.411921e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.655312 delta_norm=0.641192
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.218182
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.327601e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.798999 delta_norm=0.732760
[S13] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=1.259877
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.563715e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.796455 delta_norm=0.756371
[S5] aggregate: ACCEPT kept=['S2', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.310300 (no previous merge yet)
[S2] round=3 local utility u=0.540505 metrics={'f1_val': 0.4171497203698723, 'auprc': 0.7713433176617018, 'loss_val': 0.9541645864802379, 'psi': 0.5588271592866041}-{'f1_val': 0.33940817350987107, 'auprc': 0.6214428698619888, 'loss_val': 1.119023863198916, 'psi': 0.4522220520507182}
[S3] START round=3 head_norm_before_train=1.241937 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7071918569221043, 'loss_val': 1.2510718130508047, 'psi': 0.3667807821373059}-{'f1_val': 0.13984006561410703, 'auprc': 0.7988675574932799, 'loss_val': 1.293856865913006, 'psi': 0.4034510623657762}
[S4] START round=3 head_norm_before_train=1.255560 (no previous merge yet)
[S4] round=3 local utility u=0.948084 metrics={'f1_val': 0.4158291457286432, 'auprc': 0.7632669407383166, 'loss_val': 0.9067525208966658, 'psi': 0.5548042637325126}-{'f1_val': 0.14022662889518414, 'auprc': 0.7634011003913037, 'loss_val': 1.1497070106772627, 'psi': 0.389496417493632}
[S5] START round=3 head_norm_before_train=0.796455 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7699083934536206, 'loss_val': 1.292162930334398, 'psi': 0.3933205002385911}-{'f1_val': 0.14226190476190476, 'auprc': 0.7696028136107688, 'loss_val': 1.2853205436854718, 'psi': 0.3931982683014504}
[S6] START round=3 head_norm_before_train=1.325081 (no previous merge yet)
[S6] round=3 local utility u=0.793968 metrics={'f1_val': 0.3897117875199448, 'auprc': 0.8014672130853417, 'loss_val': 1.0747713865636837, 'psi': 0.5544139577461036}-{'f1_val': 0.14142628205128205, 'auprc': 0.8121368288262323, 'loss_val': 1.205003629653904, 'psi': 0.40971050076126214}
[S7] START round=3 head_norm_before_train=1.243071 (no previous merge yet)
[S7] round=3 local utility u=0.018914 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.769359075452079, 'loss_val': 1.2377785018147889, 'psi': 0.3929777238182866}-{'f1_val': 0.14205682272909165, 'auprc': 0.7691680785968916, 'loss_val': 1.2750333499390152, 'psi': 0.39290132507621167}
[S8] START round=3 head_norm_before_train=0.905701 cos_to_last_merge=0.9923 (last merge round=1)
[S8] round=3 local utility u=0.936705 metrics={'f1_val': 0.4228440820360761, 'auprc': 0.7769323514614885, 'loss_val': 1.1498965716930205, 'psi': 0.564479389806241}-{'f1_val': 0.13995598239295717, 'auprc': 0.7510827825402934, 'loss_val': 1.2484302052776797, 'psi': 0.3844067024518917}
[S9] START round=3 head_norm_before_train=0.897226 cos_to_last_merge=0.9969 (last merge round=1)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9729846380002876, 'loss_val': 1.2352528356682198, 'psi': 0.4740326294841127}-{'f1_val': 0.141397957139996, 'auprc': 0.998942827235274, 'loss_val': 1.290597517122789, 'psi': 0.48441590517810723}
[S10] START round=3 head_norm_before_train=0.655312 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6100697822679539, 'loss_val': 1.2061831605050906, 'psi': 0.327200895432216}-{'f1_val': 0.13862163754172394, 'auprc': 0.6527034505769114, 'loss_val': 1.2576445772553149, 'psi': 0.3442543627557989}
[S11] START round=3 head_norm_before_train=1.164175 (no previous merge yet)
[S11] round=3 local utility u=0.009009 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6016508835644951, 'loss_val': 1.1891848140148233, 'psi': 0.3249085634496644}-{'f1_val': 0.14041368337311058, 'auprc': 0.6150106150028345, 'loss_val': 1.2472824773167208, 'psi': 0.33025245602500014}
[S13] START round=3 head_norm_before_train=0.798999 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.982243 metrics={'f1_val': 0.41350427992638794, 'auprc': 0.689995983498229, 'loss_val': 1.1262238102974538, 'psi': 0.5241009613551244}-{'f1_val': 0.1403857625770531, 'auprc': 0.6135175543877229, 'loss_val': 1.2225643653646598, 'psi': 0.32963847930132106}
[S14] START round=3 head_norm_before_train=1.184752 (no previous merge yet)
[S14] round=3 local utility u=0.069544 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6477624466962468, 'loss_val': 1.302009175911016, 'psi': 0.343319690408121}-{'f1_val': 0.14035785288270378, 'auprc': 0.61104588789101, 'loss_val': 1.3309481712371285, 'psi': 0.3286330668860263}
[S15] START round=3 head_norm_before_train=0.921962 cos_to_last_merge=0.9938 (last merge round=1)
[S15] round=3 local utility u=0.023678 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7801426553011059, 'loss_val': 1.221264645106326, 'psi': 0.3958972529373774}-{'f1_val': 0.13973365136155833, 'auprc': 0.7869860012151234, 'loss_val': 1.2891516131829681, 'psi': 0.3986345913029844}
[S16] START round=3 head_norm_before_train=1.212710 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6333574599346745, 'loss_val': 1.2495814990126233, 'psi': 0.3377254540933917}-{'f1_val': 0.14063745019920318, 'auprc': 0.8244732149547218, 'loss_val': 1.2853463223976715, 'psi': 0.41417175610141066}
[S17] START round=3 head_norm_before_train=0.877419 cos_to_last_merge=0.9895 (last merge round=1)
[S17] round=3 local utility u=0.152969 metrics={'f1_val': 0.17334660414099723, 'auprc': 0.6419178957548322, 'loss_val': 1.068112721134433, 'psi': 0.3607751207865312}-{'f1_val': 0.14094896331738438, 'auprc': 0.6717573484363795, 'loss_val': 1.2691831846930774, 'psi': 0.35327231736498244}
[S2] not sending this round → trigger blocked (psi=0.559)
[S14] not sending this round → trigger blocked (psi=0.343)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.393)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.396)
[S13] not sending this round → trigger blocked (psi=0.524)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.555)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.554)
[S8] not sending this round → trigger blocked (psi=0.564)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S11
[S8] cosine check vs S11: cos=-0.0485
[S8] DROPPED delta from S11 (cos=-0.0485 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S17
[S13] cosine check vs S17: cos=-0.0096
[S13] DROPPED delta from S17 (cos=-0.0096 < 0.0)
[S2] START round=4 head_norm_before_train=1.362247 (no previous merge yet)
[S2] round=4 local utility u=0.595455 metrics={'f1_val': 0.5939276433222792, 'auprc': 0.7487513622110863, 'loss_val': 0.7561463031698255, 'psi': 0.6558571308778021}-{'f1_val': 0.4171497203698723, 'auprc': 0.7713433176617018, 'loss_val': 0.9541645864802379, 'psi': 0.5588271592866041}
[S3] START round=4 head_norm_before_train=1.272458 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6774786459016455, 'loss_val': 1.1892713391128644, 'psi': 0.35489549772912243}-{'f1_val': 0.13984006561410703, 'auprc': 0.7071918569221043, 'loss_val': 1.2510718130508047, 'psi': 0.3667807821373059}
[S4] START round=4 head_norm_before_train=1.321134 (no previous merge yet)
[S4] round=4 local utility u=0.818706 metrics={'f1_val': 0.6647078373003293, 'auprc': 0.7425265671057747, 'loss_val': 0.7003912400844794, 'psi': 0.6958353292225075}-{'f1_val': 0.4158291457286432, 'auprc': 0.7632669407383166, 'loss_val': 0.9067525208966658, 'psi': 0.5548042637325126}
[S5] START round=4 head_norm_before_train=0.817528 cos_to_last_merge=0.9967 (last merge round=2)
[S5] round=4 local utility u=0.026181 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7698693286435416, 'loss_val': 1.2396829197351427, 'psi': 0.3933048743145595}-{'f1_val': 0.14226190476190476, 'auprc': 0.7699083934536206, 'loss_val': 1.292162930334398, 'psi': 0.3933205002385911}
[S6] START round=4 head_norm_before_train=1.370181 (no previous merge yet)
[S6] round=4 local utility u=0.271436 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.8278036645941648, 'loss_val': 0.7725657336366396, 'psi': 0.581114153570973}-{'f1_val': 0.3897117875199448, 'auprc': 0.8014672130853417, 'loss_val': 1.0747713865636837, 'psi': 0.5544139577461036}
[S7] START round=4 head_norm_before_train=1.272328 (no previous merge yet)
[S7] round=4 local utility u=0.018893 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7702071702055995, 'loss_val': 1.2025359798926052, 'psi': 0.3933169617196948}-{'f1_val': 0.14205682272909165, 'auprc': 0.769359075452079, 'loss_val': 1.2377785018147889, 'psi': 0.3929777238182866}
[S8] START round=4 head_norm_before_train=0.957534 cos_to_last_merge=0.9793 (last merge round=1)
[S8] round=4 local utility u=0.970424 metrics={'f1_val': 0.7153199448606985, 'auprc': 0.777110456569115, 'loss_val': 0.9644378029692255, 'psi': 0.740036149544065}-{'f1_val': 0.4228440820360761, 'auprc': 0.7769323514614885, 'loss_val': 1.1498965716930205, 'psi': 0.564479389806241}
[S9] START round=4 head_norm_before_train=0.931368 cos_to_last_merge=0.9887 (last merge round=1)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6690599266992882, 'loss_val': 1.164174407888177, 'psi': 0.3524627449637129}-{'f1_val': 0.141397957139996, 'auprc': 0.9729846380002876, 'loss_val': 1.2352528356682198, 'psi': 0.4740326294841127}
[S10] START round=4 head_norm_before_train=0.713429 cos_to_last_merge=0.9841 (last merge round=2)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.7947552555524061, 'loss_val': 0.9669677238739144, 'psi': 0.5681332200002118}-{'f1_val': 0.13862163754172394, 'auprc': 0.6100697822679539, 'loss_val': 1.2061831605050906, 'psi': 0.327200895432216}
[S11] START round=4 head_norm_before_train=1.192285 (no previous merge yet)
[S11] round=4 local utility u=0.043137 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6019080339804304, 'loss_val': 1.1036823456003166, 'psi': 0.3250114236160385}-{'f1_val': 0.14041368337311058, 'auprc': 0.6016508835644951, 'loss_val': 1.1891848140148233, 'psi': 0.3249085634496644}
[S13] START round=4 head_norm_before_train=0.858914 cos_to_last_merge=0.9936 (last merge round=2)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.3716649514240906, 'auprc': 0.5233176024530836, 'loss_val': 0.961384551231213, 'psi': 0.4323260118356878}-{'f1_val': 0.41350427992638794, 'auprc': 0.689995983498229, 'loss_val': 1.1262238102974538, 'psi': 0.5241009613551244}
[S14] START round=4 head_norm_before_train=1.211069 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6148284113524949, 'loss_val': 1.266145501098632, 'psi': 0.3301460762706202}-{'f1_val': 0.14035785288270378, 'auprc': 0.6477624466962468, 'loss_val': 1.302009175911016, 'psi': 0.343319690408121}
[S15] START round=4 head_norm_before_train=0.974599 cos_to_last_merge=0.9777 (last merge round=1)
[S15] round=4 local utility u=0.934437 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7960864262656375, 'loss_val': 1.062375213865832, 'psi': 0.5684901742568549}-{'f1_val': 0.13973365136155833, 'auprc': 0.7801426553011059, 'loss_val': 1.221264645106326, 'psi': 0.3958972529373774}
[S16] START round=4 head_norm_before_train=1.238909 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5623285280568281, 'loss_val': 1.2040381800060647, 'psi': 0.3093138813422531}-{'f1_val': 0.14063745019920318, 'auprc': 0.6333574599346745, 'loss_val': 1.2495814990126233, 'psi': 0.3377254540933917}
[S17] START round=4 head_norm_before_train=0.947157 cos_to_last_merge=0.9619 (last merge round=1)
[S17] round=4 local utility u=0.414475 metrics={'f1_val': 0.3523878946191771, 'auprc': 0.5090676403656103, 'loss_val': 0.9148598700576859, 'psi': 0.4150597929177503}-{'f1_val': 0.17334660414099723, 'auprc': 0.6419178957548322, 'loss_val': 1.068112721134433, 'psi': 0.3607751207865312}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:52817
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:52809
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:52809
[S11] not sending this round → trigger blocked (psi=0.325)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:52815
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=0.0949
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.0407
[S17] RECEIVED delta(kind=head bytes=1791) from S7
[S17] cosine check vs S7: cos=-0.0548
[S17] DROPPED delta from S7 (cos=-0.0548 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] cosine check vs S2: cos=-0.0547
[S8] DROPPED delta from S2 (cos=-0.0547 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S4
[S8] cosine check vs S4: cos=0.6303
[S11] RECEIVED delta(kind=head bytes=1795) from S5
[S11] cosine check vs S5: cos=0.0583
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.0947
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=-0.0164
[S9] DROPPED delta from S15 (cos=-0.0164 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.415)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=1.216900
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.206404e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.761164 delta_norm=0.720640
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=1.244679
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.232647e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.750391 delta_norm=0.723265
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.7153 head_norm=0.997061
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.449821e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.7152 head_norm=1.083648 delta_norm=0.544982
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.4168 head_norm=1.034526
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.835544e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.4168 head_norm=0.751626 delta_norm=0.683554
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.3524 head_norm=1.031893
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.394708e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.3525 head_norm=0.918873 delta_norm=0.839471
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.419521 (no previous merge yet)
[S2] round=5 local utility u=0.065565 metrics={'f1_val': 0.5760951350835937, 'auprc': 0.7909321880528508, 'loss_val': 0.6445630494394157, 'psi': 0.6620299562712966}-{'f1_val': 0.5939276433222792, 'auprc': 0.7487513622110863, 'loss_val': 0.7561463031698255, 'psi': 0.6558571308778021}
[S3] START round=5 head_norm_before_train=1.302465 (no previous merge yet)
[S3] round=5 local utility u=1.000000 metrics={'f1_val': 0.42283324885960466, 'auprc': 0.7948853633726993, 'loss_val': 1.0612038108590354, 'psi': 0.5716540946648425}-{'f1_val': 0.13984006561410703, 'auprc': 0.6774786459016455, 'loss_val': 1.1892713391128644, 'psi': 0.35489549772912243}
[S4] START round=5 head_norm_before_train=1.395875 (no previous merge yet)
[S4] round=5 local utility u=0.192273 metrics={'f1_val': 0.6489782378103208, 'auprc': 0.86201289113802, 'loss_val': 0.5799269637374656, 'psi': 0.7341920991414006}-{'f1_val': 0.6647078373003293, 'auprc': 0.7425265671057747, 'loss_val': 0.7003912400844794, 'psi': 0.6958353292225075}
[S5] START round=5 head_norm_before_train=0.846488 cos_to_last_merge=0.9880 (last merge round=2)
[S5] round=5 local utility u=0.029291 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700677359561168, 'loss_val': 1.1816961944045294, 'psi': 0.3933842372395896}-{'f1_val': 0.14226190476190476, 'auprc': 0.7698693286435416, 'loss_val': 1.2396829197351427, 'psi': 0.3933048743145595}
[S6] START round=5 head_norm_before_train=1.425929 (no previous merge yet)
[S6] round=5 local utility u=0.859180 metrics={'f1_val': 0.6747579390672975, 'auprc': 0.8106984299548059, 'loss_val': 0.5515117004880418, 'psi': 0.7291341354223009}-{'f1_val': 0.4166544795555117, 'auprc': 0.8278036645941648, 'loss_val': 0.7725657336366396, 'psi': 0.581114153570973}
[S7] START round=5 head_norm_before_train=1.296723 (no previous merge yet)
[S7] round=5 local utility u=0.031774 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7700828810818178, 'loss_val': 1.138615848796276, 'psi': 0.3932672460701821}-{'f1_val': 0.14205682272909165, 'auprc': 0.7702071702055995, 'loss_val': 1.2025359798926052, 'psi': 0.3933169617196948}
[S8] START round=5 head_norm_before_train=1.083648 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.7022800412547878, 'auprc': 0.6439836367943155, 'loss_val': 0.8058021779261015, 'psi': 0.6789614794705989}-{'f1_val': 0.7153199448606985, 'auprc': 0.777110456569115, 'loss_val': 0.9644378029692255, 'psi': 0.740036149544065}
[S9] START round=5 head_norm_before_train=0.970676 cos_to_last_merge=0.9776 (last merge round=1)
[S9] round=5 local utility u=0.726478 metrics={'f1_val': 0.3641275257594005, 'auprc': 0.6689895312187977, 'loss_val': 1.0473852765393756, 'psi': 0.48607232794315935}-{'f1_val': 0.141397957139996, 'auprc': 0.6690599266992882, 'loss_val': 1.164174407888177, 'psi': 0.3524627449637129}
[S10] START round=5 head_norm_before_train=0.789412 cos_to_last_merge=0.9522 (last merge round=2)
[S10] round=5 local utility u=0.333471 metrics={'f1_val': 0.39516831643172395, 'auprc': 0.9678354500685711, 'loss_val': 0.6879659548280661, 'psi': 0.6242351698864628}-{'f1_val': 0.4170518629654155, 'auprc': 0.7947552555524061, 'loss_val': 0.9669677238739144, 'psi': 0.5681332200002118}
[S11] START round=5 head_norm_before_train=0.761164 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.474258 metrics={'f1_val': 0.2067877580216636, 'auprc': 0.7750516379954737, 'loss_val': 1.0728409533907368, 'psi': 0.43409331001118767}-{'f1_val': 0.14041368337311058, 'auprc': 0.6019080339804304, 'loss_val': 1.1036823456003166, 'psi': 0.3250114236160385}
[S13] START round=5 head_norm_before_train=0.919453 cos_to_last_merge=0.9729 (last merge round=2)
[S13] round=5 local utility u=1.000000 metrics={'f1_val': 0.705301904850378, 'auprc': 0.7236682680370575, 'loss_val': 0.7512887403036047, 'psi': 0.7126484501250498}-{'f1_val': 0.3716649514240906, 'auprc': 0.5233176024530836, 'loss_val': 0.961384551231213, 'psi': 0.4323260118356878}
[S14] START round=5 head_norm_before_train=0.750391 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6129575158350056, 'loss_val': 1.269066089025797, 'psi': 0.3293977180636245}-{'f1_val': 0.14035785288270378, 'auprc': 0.6148284113524949, 'loss_val': 1.266145501098632, 'psi': 0.3301460762706202}
[S15] START round=5 head_norm_before_train=0.751626 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.034159 metrics={'f1_val': 0.4169508412658852, 'auprc': 0.7699409237478538, 'loss_val': 0.9167705165358406, 'psi': 0.5581468742586726}-{'f1_val': 0.4167593395843331, 'auprc': 0.7960864262656375, 'loss_val': 1.062375213865832, 'psi': 0.5684901742568549}
[S16] START round=5 head_norm_before_train=1.268092 (no previous merge yet)
[S16] round=5 local utility u=0.832036 metrics={'f1_val': 0.41546633441109837, 'auprc': 0.5442667920461048, 'loss_val': 1.1347540089871062, 'psi': 0.46698651746510095}-{'f1_val': 0.14063745019920318, 'auprc': 0.5623285280568281, 'loss_val': 1.2040381800060647, 'psi': 0.3093138813422531}
[S17] START round=5 head_norm_before_train=0.918873 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.295779 metrics={'f1_val': 0.3522088719258143, 'auprc': 0.7019409944393376, 'loss_val': 0.900848648202043, 'psi': 0.4921017209312236}-{'f1_val': 0.3523878946191771, 'auprc': 0.5090676403656103, 'loss_val': 0.9148598700576859, 'psi': 0.4150597929177503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:52812
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[S16] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.0166
[S17] RECEIVED delta(kind=head bytes=1795) from S7
[S17] cosine check vs S7: cos=-0.0488
[S17] DROPPED delta from S7 (cos=-0.0488 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.8973
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=-0.1141
[S8] DROPPED delta from S11 (cos=-0.1141 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=-0.0976
[S8] DROPPED delta from S2 (cos=-0.0976 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S3
[S11] cosine check vs S3: cos=0.0075
[S11] RECEIVED delta(kind=head bytes=1794) from S5
[S11] cosine check vs S5: cos=0.5718
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] cosine check vs S15: cos=-0.0552
[S9] DROPPED delta from S15 (cos=-0.0552 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.0010
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=0.3788
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.5356
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.7748
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1791 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1791) from S17
[S13] cosine check vs S17: cos=-0.0923
[S13] DROPPED delta from S17 (cos=-0.0923 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.7023 head_norm=1.137651
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.411729e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.7011 head_norm=1.276705 delta_norm=0.341173
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.616 → S15@127.0.0.1:52815
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.783175
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.071327e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.735526 delta_norm=0.407133
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.377 → S8@127.0.0.1:52809
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.2068 head_norm=0.795996
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.725217e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.652608 delta_norm=0.472522
[S11] aggregate: ROLLBACK (f1_val pre=0.207 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.432 → S8@127.0.0.1:52809
[S10] ⇄ pheromone p=0.554 → S14@127.0.0.1:52814
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=1.316239
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.864870e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.847057 delta_norm=0.686487
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.365 → S17@127.0.0.1:52817
[S4] ⇄ pheromone p=0.647 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.575 → S11@127.0.0.1:52812
[S2] ⇄ pheromone p=0.572 → S8@127.0.0.1:52809
[S6] ⇄ pheromone p=0.669 → S17@127.0.0.1:52817
[S13] ⇄ pheromone p=0.679 → S7@127.0.0.1:52808
[S15] ⇄ pheromone p=0.514 → S9@127.0.0.1:52810
[S16] ⇄ pheromone p=0.498 → S7@127.0.0.1:52808
[S5] ⇄ pheromone p=0.355 → S11@127.0.0.1:52812
[S9] ⇄ pheromone p=0.497 → S17@127.0.0.1:52817
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3522 head_norm=0.996272
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.022241e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3530 head_norm=0.862911 delta_norm=0.402224
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.476 → S13@127.0.0.1:52813
[S2] START round=6 head_norm_before_train=1.483133 (no previous merge yet)
[S2] round=6 local utility u=0.467572 metrics={'f1_val': 0.7060036001803516, 'auprc': 0.7938556897526785, 'loss_val': 0.4976406959163807, 'psi': 0.7411444360092824}-{'f1_val': 0.5760951350835937, 'auprc': 0.7909321880528508, 'loss_val': 0.6445630494394157, 'psi': 0.6620299562712966}
[S3] START round=6 head_norm_before_train=1.342736 (no previous merge yet)
[S3] round=6 local utility u=0.017972 metrics={'f1_val': 0.3963275517403211, 'auprc': 0.795474009322527, 'loss_val': 0.8679913189800933, 'psi': 0.5559861347732035}-{'f1_val': 0.42283324885960466, 'auprc': 0.7948853633726993, 'loss_val': 1.0612038108590354, 'psi': 0.5716540946648425}
[S4] START round=6 head_norm_before_train=1.482733 (no previous merge yet)
[S4] round=6 local utility u=0.207231 metrics={'f1_val': 0.6632793568559767, 'auprc': 0.9330035183417018, 'loss_val': 0.46424310023995097, 'psi': 0.7711690214502667}-{'f1_val': 0.6489782378103208, 'auprc': 0.86201289113802, 'loss_val': 0.5799269637374656, 'psi': 0.7341920991414006}
[S5] START round=6 head_norm_before_train=0.872688 cos_to_last_merge=0.9792 (last merge round=2)
[S5] round=6 local utility u=0.867526 metrics={'f1_val': 0.4163396018254457, 'auprc': 0.7704230350507879, 'loss_val': 1.0921767270340503, 'psi': 0.5579729751155826}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700677359561168, 'loss_val': 1.1816961944045294, 'psi': 0.3933842372395896}
[S6] START round=6 head_norm_before_train=1.488360 (no previous merge yet)
[S6] round=6 local utility u=0.368369 metrics={'f1_val': 0.6995630179268384, 'auprc': 0.9562293341163437, 'loss_val': 0.40019625749011173, 'psi': 0.8022295444026405}-{'f1_val': 0.6747579390672975, 'auprc': 0.8106984299548059, 'loss_val': 0.5515117004880418, 'psi': 0.7291341354223009}
[S7] START round=6 head_norm_before_train=0.847057 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.656903 metrics={'f1_val': 0.416467909967687, 'auprc': 0.6516513804899696, 'loss_val': 1.1159816147115247, 'psi': 0.5105412981766001}-{'f1_val': 0.14205682272909165, 'auprc': 0.7700828810818178, 'loss_val': 1.138615848796276, 'psi': 0.3932672460701821}
[S8] START round=6 head_norm_before_train=1.276705 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.296698 metrics={'f1_val': 0.7147473519913303, 'auprc': 0.7769326799694962, 'loss_val': 0.6860574957993317, 'psi': 0.7396214831825967}-{'f1_val': 0.7022800412547878, 'auprc': 0.6439836367943155, 'loss_val': 0.8058021779261015, 'psi': 0.6789614794705989}
[S9] START round=6 head_norm_before_train=1.012367 cos_to_last_merge=0.9661 (last merge round=1)
[S9] round=6 local utility u=0.456992 metrics={'f1_val': 0.4171351405543927, 'auprc': 0.8034527476818308, 'loss_val': 0.8548362083172406, 'psi': 0.571662183405368}-{'f1_val': 0.3641275257594005, 'auprc': 0.6689895312187977, 'loss_val': 1.0473852765393756, 'psi': 0.48607232794315935}
[S10] START round=6 head_norm_before_train=0.894510 cos_to_last_merge=0.9108 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.911
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.6997727587645434, 'auprc': 0.9982925153185399, 'loss_val': 0.451881927029309, 'psi': 0.819180661386142}-{'f1_val': 0.39516831643172395, 'auprc': 0.9678354500685711, 'loss_val': 0.6879659548280661, 'psi': 0.6242351698864628}
[S11] START round=6 head_norm_before_train=0.652608 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.682669 metrics={'f1_val': 0.42282222891848775, 'auprc': 0.7943986020315048, 'loss_val': 1.0617516034667307, 'psi': 0.5714527781636946}-{'f1_val': 0.2067877580216636, 'auprc': 0.7750516379954737, 'loss_val': 1.0728409533907368, 'psi': 0.43409331001118767}
[S13] START round=6 head_norm_before_train=0.984237 cos_to_last_merge=0.9443 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=6 local utility u=0.058616 metrics={'f1_val': 0.7114425853893016, 'auprc': 0.7237276993881973, 'loss_val': 0.6710791609539962, 'psi': 0.7163566309888598}-{'f1_val': 0.705301904850378, 'auprc': 0.7236682680370575, 'loss_val': 0.7512887403036047, 'psi': 0.7126484501250498}
[S14] START round=6 head_norm_before_train=0.735526 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5833761308704833, 'loss_val': 1.2503683893404933, 'psi': 0.3175651640778156}-{'f1_val': 0.14035785288270378, 'auprc': 0.6129575158350056, 'loss_val': 1.269066089025797, 'psi': 0.3293977180636245}
[S15] START round=6 head_norm_before_train=0.825250 cos_to_last_merge=0.9873 (last merge round=4)
[S15] round=6 local utility u=0.540974 metrics={'f1_val': 0.614313043466873, 'auprc': 0.6619422533197372, 'loss_val': 0.6950005296572813, 'psi': 0.6333647274080187}-{'f1_val': 0.4169508412658852, 'auprc': 0.7699409237478538, 'loss_val': 0.9167705165358406, 'psi': 0.5581468742586726}
[S16] START round=6 head_norm_before_train=1.295903 (no previous merge yet)
[S16] round=6 local utility u=0.055404 metrics={'f1_val': 0.41754116323363955, 'auprc': 0.5382795636315472, 'loss_val': 1.0184337154495111, 'psi': 0.46583652339280257}-{'f1_val': 0.41546633441109837, 'auprc': 0.5442667920461048, 'loss_val': 1.1347540089871062, 'psi': 0.46698651746510095}
[S17] START round=6 head_norm_before_train=0.862911 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35228783858720547, 'auprc': 0.5662128431196946, 'loss_val': 0.9206869710278395, 'psi': 0.43785784040020115}-{'f1_val': 0.3522088719258143, 'auprc': 0.7019409944393376, 'loss_val': 0.900848648202043, 'psi': 0.4921017209312236}
[S7] not sending this round → trigger blocked (psi=0.511)
[S10] not sending this round → trigger blocked (psi=0.819)
[S5] not sending this round → trigger blocked (psi=0.558)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.571)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:52815
[S3] not sending this round → trigger blocked (psi=0.556)
[S9] not sending this round → trigger blocked (psi=0.572)
[S13] not sending this round → trigger blocked (psi=0.716)
[S16] not sending this round → trigger blocked (psi=0.466)
[S2] not sending this round → trigger blocked (psi=0.741)
[S6] not sending this round → trigger blocked (psi=0.802)
[S4] not sending this round → trigger blocked (psi=0.771)
[S15] not sending this round → trigger blocked (psi=0.633)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.4661
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.6143 head_norm=0.921732
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.054572e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.4168 head_norm=0.967330 delta_norm=0.605457
[S15] aggregate: ROLLBACK (f1_val pre=0.614 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.553436 (no previous merge yet)
[S2] round=7 local utility u=0.043711 metrics={'f1_val': 0.699329985880033, 'auprc': 0.7976450534310119, 'loss_val': 0.38154603858925507, 'psi': 0.7386560129004246}-{'f1_val': 0.7060036001803516, 'auprc': 0.7938556897526785, 'loss_val': 0.4976406959163807, 'psi': 0.7411444360092824}
[S3] START round=7 head_norm_before_train=1.389626 (no previous merge yet)
[S3] round=7 local utility u=0.026366 metrics={'f1_val': 0.4003453263796316, 'auprc': 0.8016885146229326, 'loss_val': 0.8580099846879515, 'psi': 0.5608826016769519}-{'f1_val': 0.3963275517403211, 'auprc': 0.795474009322527, 'loss_val': 0.8679913189800933, 'psi': 0.5559861347732035}
[S4] START round=7 head_norm_before_train=1.562240 (no previous merge yet)
[S4] round=7 local utility u=0.900988 metrics={'f1_val': 0.9551898623355328, 'auprc': 0.9413921772541091, 'loss_val': 0.4388970423318682, 'psi': 0.9496707883029634}-{'f1_val': 0.6632793568559767, 'auprc': 0.9330035183417018, 'loss_val': 0.46424310023995097, 'psi': 0.7711690214502667}
[S5] START round=7 head_norm_before_train=0.901683 cos_to_last_merge=0.9692 (last merge round=2)
[S5] round=7 local utility u=0.063772 metrics={'f1_val': 0.4179091272005397, 'auprc': 0.7776207305352676, 'loss_val': 0.9956431698192422, 'psi': 0.5617937685344309}-{'f1_val': 0.4163396018254457, 'auprc': 0.7704230350507879, 'loss_val': 1.0921767270340503, 'psi': 0.5579729751155826}
[S6] START round=7 head_norm_before_train=1.544016 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.6820973326725472, 'auprc': 0.8163253372729197, 'loss_val': 0.44905307870808947, 'psi': 0.7357885345126962}-{'f1_val': 0.6995630179268384, 'auprc': 0.9562293341163437, 'loss_val': 0.40019625749011173, 'psi': 0.8022295444026405}
[S7] START round=7 head_norm_before_train=0.876424 cos_to_last_merge=0.9983 (last merge round=5)
[S7] round=7 local utility u=0.128920 metrics={'f1_val': 0.4172807768329403, 'auprc': 0.6980217956678232, 'loss_val': 1.002130337392015, 'psi': 0.5295771843668935}-{'f1_val': 0.416467909967687, 'auprc': 0.6516513804899696, 'loss_val': 1.1159816147115247, 'psi': 0.5105412981766001}
[S8] START round=7 head_norm_before_train=1.324773 cos_to_last_merge=0.9951 (last merge round=5)
[S8] round=7 local utility u=0.457782 metrics={'f1_val': 0.7014252940836996, 'auprc': 0.9979879278934822, 'loss_val': 0.35372779006715166, 'psi': 0.8200503476076126}-{'f1_val': 0.7147473519913303, 'auprc': 0.7769326799694962, 'loss_val': 0.6860574957993317, 'psi': 0.7396214831825967}
[S9] START round=7 head_norm_before_train=1.057247 cos_to_last_merge=0.9549 (last merge round=1)
[S9] round=7 local utility u=0.222868 metrics={'f1_val': 0.4362634907065445, 'auprc': 0.8547241039708979, 'loss_val': 0.6776838240153265, 'psi': 0.6036477360122859}-{'f1_val': 0.4171351405543927, 'auprc': 0.8034527476818308, 'loss_val': 0.8548362083172406, 'psi': 0.571662183405368}
[S10] START round=7 head_norm_before_train=0.999854 cos_to_last_merge=0.8766 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.877
[S10] round=7 local utility u=0.016751 metrics={'f1_val': 0.6882041218179925, 'auprc': 0.9968116244722912, 'loss_val': 0.34452523805878504, 'psi': 0.811647122879712}-{'f1_val': 0.6997727587645434, 'auprc': 0.9982925153185399, 'loss_val': 0.451881927029309, 'psi': 0.819180661386142}
[S11] START round=7 head_norm_before_train=0.684812 cos_to_last_merge=0.9910 (last merge round=5)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.7974830329502782, 'loss_val': 0.9269419621780868, 'psi': 0.5569043458256109}-{'f1_val': 0.42282222891848775, 'auprc': 0.7943986020315048, 'loss_val': 1.0617516034667307, 'psi': 0.5714527781636946}
[S13] START round=7 head_norm_before_train=1.044529 cos_to_last_merge=0.9243 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=7 local utility u=0.017128 metrics={'f1_val': 0.71091285812191, 'auprc': 0.7196585279874065, 'loss_val': 0.6214364362038968, 'psi': 0.7144111260681085}-{'f1_val': 0.7114425853893016, 'auprc': 0.7237276993881973, 'loss_val': 0.6710791609539962, 'psi': 0.7163566309888598}
[S14] START round=7 head_norm_before_train=0.757644 cos_to_last_merge=0.9956 (last merge round=5)
[S14] round=7 local utility u=0.104284 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6151902500850868, 'loss_val': 1.1372426637761666, 'psi': 0.330290811763657}-{'f1_val': 0.14035785288270378, 'auprc': 0.5833761308704833, 'loss_val': 1.2503683893404933, 'psi': 0.3175651640778156}
[S15] START round=7 head_norm_before_train=0.967330 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.816449 metrics={'f1_val': 0.6930082201299996, 'auprc': 0.9878404977844278, 'loss_val': 0.5119677883212226, 'psi': 0.8109411311917709}-{'f1_val': 0.614313043466873, 'auprc': 0.6619422533197372, 'loss_val': 0.6950005296572813, 'psi': 0.6333647274080187}
[S16] START round=7 head_norm_before_train=1.328912 (no previous merge yet)
[S16] round=7 local utility u=0.200823 metrics={'f1_val': 0.4089051556351134, 'auprc': 0.6739642613030391, 'loss_val': 0.9720261371464858, 'psi': 0.5149287979022837}-{'f1_val': 0.41754116323363955, 'auprc': 0.5382795636315472, 'loss_val': 1.0184337154495111, 'psi': 0.46583652339280257}
[S17] START round=7 head_norm_before_train=0.944427 cos_to_last_merge=0.9833 (last merge round=5)
[S17] round=7 local utility u=0.324382 metrics={'f1_val': 0.4592686025998104, 'auprc': 0.5803783669522149, 'loss_val': 0.9563046130375747, 'psi': 0.5077125083407722}-{'f1_val': 0.35228783858720547, 'auprc': 0.5662128431196946, 'loss_val': 0.9206869710278395, 'psi': 0.43785784040020115}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:52810
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:52812
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.2548
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.0693
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] cosine check vs S2: cos=-0.1167
[S8] DROPPED delta from S2 (cos=-0.1167 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=0.9304
[S11] RECEIVED delta(kind=head bytes=1792) from S5
[S11] cosine check vs S5: cos=0.6115
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.4552
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=-0.0066
[S9] DROPPED delta from S15 (cos=-0.0066 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1791) from S7
[S17] cosine check vs S7: cos=0.1162
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.8098
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.3672
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=0.5266
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=-0.0200
[S13] DROPPED delta from S17 (cos=-0.0200 < 0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7014 head_norm=1.390874
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.780940e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7014 head_norm=1.107006 delta_norm=0.378094
[S8] aggregate: ACCEPT kept=['S14', 'S4'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3965 head_norm=0.732347
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.150724e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3145 head_norm=0.738833 delta_norm=0.315072
[S11] aggregate: ROLLBACK (f1_val pre=0.397 post=0.315 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4173 head_norm=0.915007
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.870915e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4173 head_norm=0.801969 delta_norm=0.387091
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.794380
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.222756e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.896763 delta_norm=0.322276
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.4593 head_norm=1.019472
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.025293e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3462 head_norm=0.749596 delta_norm=0.602529
[S17] aggregate: ROLLBACK (f1_val pre=0.459 post=0.346 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.633043 (no previous merge yet)
[S2] round=8 local utility u=0.125768 metrics={'f1_val': 0.679405331979659, 'auprc': 0.9157628428402951, 'loss_val': 0.3648150233916593, 'psi': 0.7739483363239135}-{'f1_val': 0.699329985880033, 'auprc': 0.7976450534310119, 'loss_val': 0.38154603858925507, 'psi': 0.7386560129004246}
[S3] START round=8 head_norm_before_train=1.428282 (no previous merge yet)
[S3] round=8 local utility u=0.156630 metrics={'f1_val': 0.39417063440998584, 'auprc': 0.8850820671899519, 'loss_val': 0.7578828173572614, 'psi': 0.5905352075219723}-{'f1_val': 0.4003453263796316, 'auprc': 0.8016885146229326, 'loss_val': 0.8580099846879515, 'psi': 0.5608826016769519}
[S4] START round=8 head_norm_before_train=1.613871 (no previous merge yet)
[S4] round=8 local utility u=0.049565 metrics={'f1_val': 0.9585965864871328, 'auprc': 0.9482934985006944, 'loss_val': 0.38091054140595787, 'psi': 0.9544753512925575}-{'f1_val': 0.9551898623355328, 'auprc': 0.9413921772541091, 'loss_val': 0.4388970423318682, 'psi': 0.9496707883029634}
[S5] START round=8 head_norm_before_train=0.931214 cos_to_last_merge=0.9592 (last merge round=2)
[S5] round=8 local utility u=0.059279 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.777724109826661, 'loss_val': 0.8754650874780122, 'psi': 0.5616420700579381}-{'f1_val': 0.4179091272005397, 'auprc': 0.7776207305352676, 'loss_val': 0.9956431698192422, 'psi': 0.5617937685344309}
[S6] START round=8 head_norm_before_train=1.592863 (no previous merge yet)
[S6] round=8 local utility u=0.319647 metrics={'f1_val': 0.7148875152182561, 'auprc': 0.9382790464716859, 'loss_val': 0.37236141290869407, 'psi': 0.804244127719628}-{'f1_val': 0.6820973326725472, 'auprc': 0.8163253372729197, 'loss_val': 0.44905307870808947, 'psi': 0.7357885345126962}
[S7] START round=8 head_norm_before_train=0.801969 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.6315404942964462, 'loss_val': 0.9720810052729517, 'psi': 0.5028374540113474}-{'f1_val': 0.4172807768329403, 'auprc': 0.6980217956678232, 'loss_val': 1.002130337392015, 'psi': 0.5295771843668935}
[S8] START round=8 head_norm_before_train=1.107006 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.025974 metrics={'f1_val': 0.7064155804368681, 'auprc': 0.997586157755227, 'loss_val': 0.33051652033863854, 'psi': 0.8228838113642116}-{'f1_val': 0.7014252940836996, 'auprc': 0.9979879278934822, 'loss_val': 0.35372779006715166, 'psi': 0.8200503476076126}
[S9] START round=8 head_norm_before_train=1.113740 cos_to_last_merge=0.9409 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.941
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7017167946673312, 'auprc': 0.9989115773709266, 'loss_val': 0.444981784598088, 'psi': 0.8205947077487694}-{'f1_val': 0.4362634907065445, 'auprc': 0.8547241039708979, 'loss_val': 0.6776838240153265, 'psi': 0.6036477360122859}
[S10] START round=8 head_norm_before_train=1.088600 cos_to_last_merge=0.8524 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.852
[S10] round=8 local utility u=0.083968 metrics={'f1_val': 0.6995437528618637, 'auprc': 0.9979182367935016, 'loss_val': 0.2479478045583356, 'psi': 0.8188935464345188}-{'f1_val': 0.6882041218179925, 'auprc': 0.9968116244722912, 'loss_val': 0.34452523805878504, 'psi': 0.811647122879712}
[S11] START round=8 head_norm_before_train=0.738833 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.053760 metrics={'f1_val': 0.35097595359254846, 'auprc': 0.9377929364493565, 'loss_val': 0.9670964530539465, 'psi': 0.5857027467352717}-{'f1_val': 0.39651855440916606, 'auprc': 0.7974830329502782, 'loss_val': 0.9269419621780868, 'psi': 0.5569043458256109}
[S13] START round=8 head_norm_before_train=1.096529 cos_to_last_merge=0.9104 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6795258082189493, 'auprc': 0.6739334123851686, 'loss_val': 0.621645213489194, 'psi': 0.677288849885437}-{'f1_val': 0.71091285812191, 'auprc': 0.7196585279874065, 'loss_val': 0.6214364362038968, 'psi': 0.7144111260681085}
[S14] START round=8 head_norm_before_train=0.896763 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.948531 metrics={'f1_val': 0.3960768613109522, 'auprc': 0.7163927862210229, 'loss_val': 1.0781021284495118, 'psi': 0.5242032312749805}-{'f1_val': 0.14035785288270378, 'auprc': 0.6151902500850868, 'loss_val': 1.1372426637761666, 'psi': 0.330290811763657}
[S15] START round=8 head_norm_before_train=1.049384 cos_to_last_merge=0.9885 (last merge round=6)
[S15] round=8 local utility u=0.071325 metrics={'f1_val': 0.6909799509464927, 'auprc': 0.9868509242534054, 'loss_val': 0.354179333139342, 'psi': 0.8093283402692577}-{'f1_val': 0.6930082201299996, 'auprc': 0.9878404977844278, 'loss_val': 0.5119677883212226, 'psi': 0.8109411311917709}
[S16] START round=8 head_norm_before_train=1.363784 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.37400029267622215, 'auprc': 0.7386573490768248, 'loss_val': 0.9983344372338234, 'psi': 0.5198631152364632}-{'f1_val': 0.4089051556351134, 'auprc': 0.6739642613030391, 'loss_val': 0.9720261371464858, 'psi': 0.5149287979022837}
[S17] START round=8 head_norm_before_train=0.749596 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35160795922548094, 'auprc': 0.5406209367185035, 'loss_val': 0.9441954878055598, 'psi': 0.42721315022269}-{'f1_val': 0.4592686025998104, 'auprc': 0.5803783669522149, 'loss_val': 0.9563046130375747, 'psi': 0.5077125083407722}
[S2] not sending this round → trigger blocked (psi=0.774)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:52815
[S4] not sending this round → trigger blocked (psi=0.954)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S15] not sending this round → trigger blocked (psi=0.809)
[S14] not sending this round → trigger blocked (psi=0.524)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.591)
[S10] not sending this round → trigger blocked (psi=0.819)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.821)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.5042
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.8258
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=-0.0839
[S8] DROPPED delta from S11 (cos=-0.0839 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.6910 head_norm=1.141810
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.441074e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.9803 head_norm=1.112109 delta_norm=0.344107
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3516 head_norm=0.817836
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.054114e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3629 head_norm=1.082269 delta_norm=0.705411
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.692288 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.6996906525731519, 'auprc': 0.7812253630734319, 'loss_val': 0.30078812694605606, 'psi': 0.7323045367732639}-{'f1_val': 0.679405331979659, 'auprc': 0.9157628428402951, 'loss_val': 0.3648150233916593, 'psi': 0.7739483363239135}
[S3] START round=9 head_norm_before_train=1.456868 (no previous merge yet)
[S3] round=9 local utility u=0.291415 metrics={'f1_val': 0.5185344079987149, 'auprc': 0.8416408657446343, 'loss_val': 0.790911874335591, 'psi': 0.6477769910970826}-{'f1_val': 0.39417063440998584, 'auprc': 0.8850820671899519, 'loss_val': 0.7578828173572614, 'psi': 0.5905352075219723}
[S4] START round=9 head_norm_before_train=1.660604 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.9525893289270368, 'auprc': 0.9392910564554379, 'loss_val': 0.35754228131778765, 'psi': 0.9472700199383973}-{'f1_val': 0.9585965864871328, 'auprc': 0.9482934985006944, 'loss_val': 0.38091054140595787, 'psi': 0.9544753512925575}
[S5] START round=9 head_norm_before_train=0.966401 cos_to_last_merge=0.9456 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=9 local utility u=0.953662 metrics={'f1_val': 0.7049275416058078, 'auprc': 0.7947813637205209, 'loss_val': 0.7433544215162982, 'psi': 0.740869070451693}-{'f1_val': 0.4175873768787894, 'auprc': 0.777724109826661, 'loss_val': 0.8754650874780122, 'psi': 0.5616420700579381}
[S6] START round=9 head_norm_before_train=1.633698 (no previous merge yet)
[S6] round=9 local utility u=0.272619 metrics={'f1_val': 0.8067545527211801, 'auprc': 0.9306158026215259, 'loss_val': 0.35533582079732945, 'psi': 0.8562990526813185}-{'f1_val': 0.7148875152182561, 'auprc': 0.9382790464716859, 'loss_val': 0.37236141290869407, 'psi': 0.804244127719628}
[S7] START round=9 head_norm_before_train=0.836842 cos_to_last_merge=0.9957 (last merge round=7)
[S7] round=9 local utility u=0.248577 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7705180822843091, 'loss_val': 0.89112568682483, 'psi': 0.5583550911751982}-{'f1_val': 0.41703542715461484, 'auprc': 0.6315404942964462, 'loss_val': 0.9720810052729517, 'psi': 0.5028374540113474}
[S8] START round=9 head_norm_before_train=1.186028 cos_to_last_merge=0.9958 (last merge round=7)
[S8] round=9 local utility u=0.450995 metrics={'f1_val': 0.8394652429042063, 'auprc': 0.9982602116679041, 'loss_val': 0.2288476379443967, 'psi': 0.9029832304096854}-{'f1_val': 0.7064155804368681, 'auprc': 0.997586157755227, 'loss_val': 0.33051652033863854, 'psi': 0.8228838113642116}
[S9] START round=9 head_norm_before_train=1.167011 cos_to_last_merge=0.9275 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.927
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9522967716383868, 'loss_val': 0.39163575595982303, 'psi': 0.801843107176518}-{'f1_val': 0.7017167946673312, 'auprc': 0.9989115773709266, 'loss_val': 0.444981784598088, 'psi': 0.8205947077487694}
[S10] START round=9 head_norm_before_train=1.161165 cos_to_last_merge=0.8357 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.836
[S10] round=9 local utility u=0.909233 metrics={'f1_val': 0.9954673585071979, 'auprc': 0.9972876294872319, 'loss_val': 0.20313241917956265, 'psi': 0.9961954668992115}-{'f1_val': 0.6995437528618637, 'auprc': 0.9979182367935016, 'loss_val': 0.2479478045583356, 'psi': 0.8188935464345188}
[S11] START round=9 head_norm_before_train=0.770524 cos_to_last_merge=0.9910 (last merge round=7)
[S11] round=9 local utility u=0.910272 metrics={'f1_val': 0.6220841675427433, 'auprc': 0.9517584166987263, 'loss_val': 0.8150988598010298, 'psi': 0.7539538672051365}-{'f1_val': 0.35097595359254846, 'auprc': 0.9377929364493565, 'loss_val': 0.9670964530539465, 'psi': 0.5857027467352717}
[S13] START round=9 head_norm_before_train=1.151760 cos_to_last_merge=0.8969 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.897
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.5946637140878355, 'auprc': 0.6578334030876835, 'loss_val': 0.6525079399541904, 'psi': 0.6199315896877746}-{'f1_val': 0.6795258082189493, 'auprc': 0.6739334123851686, 'loss_val': 0.621645213489194, 'psi': 0.677288849885437}
[S14] START round=9 head_norm_before_train=0.924618 cos_to_last_merge=0.9953 (last merge round=7)
[S14] round=9 local utility u=0.248982 metrics={'f1_val': 0.39155223937832634, 'auprc': 0.8325700072352276, 'loss_val': 0.9015221206322871, 'psi': 0.5679593465210868}-{'f1_val': 0.3960768613109522, 'auprc': 0.7163927862210229, 'loss_val': 1.0781021284495118, 'psi': 0.5242032312749805}
[S15] START round=9 head_norm_before_train=1.112109 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.691373181575959, 'auprc': 0.9664514821475135, 'loss_val': 0.4312158982716833, 'psi': 0.8014045018045808}-{'f1_val': 0.6909799509464927, 'auprc': 0.9868509242534054, 'loss_val': 0.354179333139342, 'psi': 0.8093283402692577}
[S16] START round=9 head_norm_before_train=1.396577 (no previous merge yet)
[S16] round=9 local utility u=0.021146 metrics={'f1_val': 0.3656681638824305, 'auprc': 0.7402826652255535, 'loss_val': 0.9109262859827427, 'psi': 0.5155139644196798}-{'f1_val': 0.37400029267622215, 'auprc': 0.7386573490768248, 'loss_val': 0.9983344372338234, 'psi': 0.5198631152364632}
[S17] START round=9 head_norm_before_train=1.082269 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.041901 metrics={'f1_val': 0.3641354373132222, 'auprc': 0.5329631965359215, 'loss_val': 0.9125849918482827, 'psi': 0.43166654100230195}-{'f1_val': 0.35160795922548094, 'auprc': 0.5406209367185035, 'loss_val': 0.9441954878055598, 'psi': 0.42721315022269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:52809
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[S6] not sending this round → trigger blocked (psi=0.856)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:52812
[S11] not sending this round → trigger blocked (psi=0.754)
[S8] not sending this round → trigger blocked (psi=0.903)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S7
[S17] cosine check vs S7: cos=0.1348
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] cosine check vs S14: cos=0.2376
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.5749
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] cosine check vs S3: cos=0.6398
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.5952
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9022
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=-0.0158
[S13] DROPPED delta from S17 (cos=-0.0158 < 0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.6221 head_norm=0.817597
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.527157e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.6199 head_norm=0.828619 delta_norm=0.252716
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.8395 head_norm=1.262439
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.973780e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.7012 head_norm=0.880680 delta_norm=0.697378
[S8] aggregate: ROLLBACK (f1_val pre=0.839 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3916 head_norm=0.964424
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.726913e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.5526 head_norm=1.066877 delta_norm=0.272691
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4169 head_norm=0.882841
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.726315e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4169 head_norm=1.037515 delta_norm=0.572631
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3641 head_norm=1.143732
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.736683e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3604 head_norm=0.768074 delta_norm=0.673668
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.740358 (no previous merge yet)
[S2] round=10 local utility u=0.021789 metrics={'f1_val': 0.6998710013059208, 'auprc': 0.7904631014373992, 'loss_val': 0.28600448093399927, 'psi': 0.7361078413585121}-{'f1_val': 0.6996906525731519, 'auprc': 0.7812253630734319, 'loss_val': 0.30078812694605606, 'psi': 0.7323045367732639}
[S3] START round=10 head_norm_before_train=1.482679 (no previous merge yet)
[S3] round=10 local utility u=0.412781 metrics={'f1_val': 0.5979474516229408, 'auprc': 0.9206357080834485, 'loss_val': 0.6788134150472128, 'psi': 0.7270227542071439}-{'f1_val': 0.5185344079987149, 'auprc': 0.8416408657446343, 'loss_val': 0.790911874335591, 'psi': 0.6477769910970826}
[S4] START round=10 head_norm_before_train=1.700473 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.9415142404565684, 'auprc': 0.9080870261549119, 'loss_val': 0.34790323966913295, 'psi': 0.9281433547359057}-{'f1_val': 0.9525893289270368, 'auprc': 0.9392910564554379, 'loss_val': 0.35754228131778765, 'psi': 0.9472700199383973}
[S5] START round=10 head_norm_before_train=0.999663 cos_to_last_merge=0.9318 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=10 local utility u=0.061925 metrics={'f1_val': 0.7102780785648412, 'auprc': 0.7950765723673158, 'loss_val': 0.6524929245073329, 'psi': 0.744197476085831}-{'f1_val': 0.7049275416058078, 'auprc': 0.7947813637205209, 'loss_val': 0.7433544215162982, 'psi': 0.740869070451693}
[S6] START round=10 head_norm_before_train=1.671611 (no previous merge yet)
[S6] round=10 local utility u=0.445606 metrics={'f1_val': 0.9329520185665214, 'auprc': 0.9546503328719167, 'loss_val': 0.29341181190376364, 'psi': 0.9416313442886795}-{'f1_val': 0.8067545527211801, 'auprc': 0.9306158026215259, 'loss_val': 0.35533582079732945, 'psi': 0.8562990526813185}
[S7] START round=10 head_norm_before_train=1.037515 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.019259 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7780060399464341, 'loss_val': 0.8745884202411964, 'psi': 0.5613018956376377}-{'f1_val': 0.4169130971024577, 'auprc': 0.7705180822843091, 'loss_val': 0.89112568682483, 'psi': 0.5583550911751982}
[S8] START round=10 head_norm_before_train=0.880680 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.354356 metrics={'f1_val': 0.9720176627156001, 'auprc': 0.9985212592923527, 'loss_val': 0.31623354653328756, 'psi': 0.982619101346301}-{'f1_val': 0.8394652429042063, 'auprc': 0.9982602116679041, 'loss_val': 0.2288476379443967, 'psi': 0.9029832304096854}
[S9] START round=10 head_norm_before_train=1.218930 cos_to_last_merge=0.9142 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.914
[S9] round=10 local utility u=0.126663 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9984377838023425, 'loss_val': 0.2762890536536019, 'psi': 0.82025516989914}-{'f1_val': 0.7015406642019387, 'auprc': 0.9522967716383868, 'loss_val': 0.39163575595982303, 'psi': 0.801843107176518}
[S10] START round=10 head_norm_before_train=1.222726 cos_to_last_merge=0.8230 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=10 local utility u=0.022984 metrics={'f1_val': 0.9955424740236036, 'auprc': 0.9966420253272295, 'loss_val': 0.15567761757328719, 'psi': 0.9959822945450539}-{'f1_val': 0.9954673585071979, 'auprc': 0.9972876294872319, 'loss_val': 0.20313241917956265, 'psi': 0.9961954668992115}
[S11] START round=10 head_norm_before_train=0.828619 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.239221 metrics={'f1_val': 0.7042509793971966, 'auprc': 0.9415085115801649, 'loss_val': 0.7989089467142612, 'psi': 0.7991539922703839}-{'f1_val': 0.6220841675427433, 'auprc': 0.9517584166987263, 'loss_val': 0.8150988598010298, 'psi': 0.7539538672051365}
[S13] START round=10 head_norm_before_train=1.197705 cos_to_last_merge=0.8871 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5801835366735651, 'auprc': 0.6551017692431237, 'loss_val': 0.6892662152337216, 'psi': 0.6101508297013886}-{'f1_val': 0.5946637140878355, 'auprc': 0.6578334030876835, 'loss_val': 0.6525079399541904, 'psi': 0.6199315896877746}
[S14] START round=10 head_norm_before_train=1.066877 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.978625 metrics={'f1_val': 0.644209628791274, 'auprc': 0.9587909878452121, 'loss_val': 0.8388798750871841, 'psi': 0.7700421724128492}-{'f1_val': 0.39155223937832634, 'auprc': 0.8325700072352276, 'loss_val': 0.9015221206322871, 'psi': 0.5679593465210868}
[S15] START round=10 head_norm_before_train=1.180628 cos_to_last_merge=0.9950 (last merge round=8)
[S15] round=10 local utility u=0.071756 metrics={'f1_val': 0.6920469885159382, 'auprc': 0.9798511311206111, 'loss_val': 0.33194590146457476, 'psi': 0.8071686455578073}-{'f1_val': 0.691373181575959, 'auprc': 0.9664514821475135, 'loss_val': 0.4312158982716833, 'psi': 0.8014045018045808}
[S16] START round=10 head_norm_before_train=1.424528 (no previous merge yet)
[S16] round=10 local utility u=0.240903 metrics={'f1_val': 0.42724608205897974, 'auprc': 0.7439297740919053, 'loss_val': 0.8095296767968452, 'psi': 0.5539195588721499}-{'f1_val': 0.3656681638824305, 'auprc': 0.7402826652255535, 'loss_val': 0.9109262859827427, 'psi': 0.5155139644196798}
[S17] START round=10 head_norm_before_train=0.768074 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.115808 metrics={'f1_val': 0.3784336981076769, 'auprc': 0.5471278888429452, 'loss_val': 0.8092525598147191, 'psi': 0.4459113744017842}-{'f1_val': 0.3641354373132222, 'auprc': 0.5329631965359215, 'loss_val': 0.9125849918482827, 'psi': 0.43166654100230195}
[S14] not sending this round → trigger blocked (psi=0.770)
[S16] not sending this round → trigger blocked (psi=0.554)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:52810
[S3] not sending this round → trigger blocked (psi=0.727)
[S5] not sending this round → trigger blocked (psi=0.744)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:52809
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.561)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:52815
[S6] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.3788
[S9] RECEIVED delta(kind=head bytes=1806) from S15
[S9] cosine check vs S15: cos=-0.0044
[S9] DROPPED delta from S15 (cos=-0.0044 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.8263
[S8] RECEIVED delta(kind=head bytes=1788) from S11
[S8] cosine check vs S11: cos=-0.0714
[S8] DROPPED delta from S11 (cos=-0.0714 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=0.6158
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=-0.0907
[S8] DROPPED delta from S2 (cos=-0.0907 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.446)
[S13] ⇄ pheromone p=0.229 → S7@127.0.0.1:52808
[S7] ⇄ pheromone p=0.230 → S17@127.0.0.1:52817
[S10] ⇄ pheromone p=0.426 → S14@127.0.0.1:52814
[S4] ⇄ pheromone p=0.328 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=0.366 → S11@127.0.0.1:52812
[S3] ⇄ pheromone p=0.342 → S11@127.0.0.1:52812
[S14] ⇄ pheromone p=0.491 → S8@127.0.0.1:52809
[S6] ⇄ pheromone p=0.423 → S17@127.0.0.1:52817
[S8] ⇄ pheromone p=0.419 → S15@127.0.0.1:52815
[S2] ⇄ pheromone p=0.251 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.376 → S17@127.0.0.1:52817
[S11] ⇄ pheromone p=0.398 → S8@127.0.0.1:52809
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6920 head_norm=1.255463
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.552922e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6922 head_norm=1.063106 delta_norm=0.355292
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.320 → S9@127.0.0.1:52810
[S16] ⇄ pheromone p=0.240 → S7@127.0.0.1:52808
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3784 head_norm=0.843657
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.746931e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3801 head_norm=0.886960 delta_norm=0.374693
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.219 → S13@127.0.0.1:52813
[S2] START round=11 head_norm_before_train=1.782063 (no previous merge yet)
[S2] round=11 local utility u=0.288455 metrics={'f1_val': 0.699329985880033, 'auprc': 0.978467172809964, 'loss_val': 0.26985995317227285, 'psi': 0.8109848606520054}-{'f1_val': 0.6998710013059208, 'auprc': 0.7904631014373992, 'loss_val': 0.28600448093399927, 'psi': 0.7361078413585121}
[S3] START round=11 head_norm_before_train=1.514180 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.4059122689826149, 'auprc': 0.8074150794836409, 'loss_val': 0.8854674047098088, 'psi': 0.5665133931830253}-{'f1_val': 0.5979474516229408, 'auprc': 0.9206357080834485, 'loss_val': 0.6788134150472128, 'psi': 0.7270227542071439}
[S4] START round=11 head_norm_before_train=1.734439 (no previous merge yet)
[S4] round=11 local utility u=0.012539 metrics={'f1_val': 0.9405848959154601, 'auprc': 0.91615285193797, 'loss_val': 0.3414475207485467, 'psi': 0.930812078324464}-{'f1_val': 0.9415142404565684, 'auprc': 0.9080870261549119, 'loss_val': 0.34790323966913295, 'psi': 0.9281433547359057}
[S5] START round=11 head_norm_before_train=1.029148 cos_to_last_merge=0.9183 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=11 local utility u=0.042368 metrics={'f1_val': 0.7146275168069246, 'auprc': 0.7929812646878001, 'loss_val': 0.5875675469749617, 'psi': 0.7459690159592748}-{'f1_val': 0.7102780785648412, 'auprc': 0.7950765723673158, 'loss_val': 0.6524929245073329, 'psi': 0.744197476085831}
[S6] START round=11 head_norm_before_train=1.706412 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.7392749486983488, 'auprc': 0.9057353999313404, 'loss_val': 0.46283063279368897, 'psi': 0.8058591291915455}-{'f1_val': 0.9329520185665214, 'auprc': 0.9546503328719167, 'loss_val': 0.29341181190376364, 'psi': 0.9416313442886795}
[S7] START round=11 head_norm_before_train=1.071116 cos_to_last_merge=0.9972 (last merge round=9)
[S7] round=11 local utility u=0.055930 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7765993399519806, 'loss_val': 0.7577740373775042, 'psi': 0.5606658068474063}-{'f1_val': 0.41683246609844005, 'auprc': 0.7780060399464341, 'loss_val': 0.8745884202411964, 'psi': 0.5613018956376377}
[S8] START round=11 head_norm_before_train=0.967815 cos_to_last_merge=0.9942 (last merge round=9)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.771172576632242, 'auprc': 0.9952305833657871, 'loss_val': 0.25734239559630584, 'psi': 0.86079577932566}-{'f1_val': 0.9720176627156001, 'auprc': 0.9985212592923527, 'loss_val': 0.31623354653328756, 'psi': 0.982619101346301}
[S9] START round=11 head_norm_before_train=1.270620 cos_to_last_merge=0.9003 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.900
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.6173674840478033, 'auprc': 0.8670050742452446, 'loss_val': 0.3758632365281168, 'psi': 0.7172225201267799}-{'f1_val': 0.7014667606303384, 'auprc': 0.9984377838023425, 'loss_val': 0.2762890536536019, 'psi': 0.82025516989914}
[S10] START round=11 head_norm_before_train=1.276743 cos_to_last_merge=0.8125 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.812
[S10] round=11 local utility u=0.015185 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.995771380733949, 'loss_val': 0.11924917404042608, 'psi': 0.9952894642126253}-{'f1_val': 0.9955424740236036, 'auprc': 0.9966420253272295, 'loss_val': 0.15567761757328719, 'psi': 0.9959822945450539}
[S11] START round=11 head_norm_before_train=0.865777 cos_to_last_merge=0.9931 (last merge round=9)
[S11] round=11 local utility u=0.073111 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9401017987749184, 'loss_val': 0.6335139862313145, 'psi': 0.7970960825068462}-{'f1_val': 0.7042509793971966, 'auprc': 0.9415085115801649, 'loss_val': 0.7989089467142612, 'psi': 0.7991539922703839}
[S13] START round=11 head_norm_before_train=1.243708 cos_to_last_merge=0.8791 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.5277015202388611, 'auprc': 0.6924632982022556, 'loss_val': 0.7765306761588675, 'psi': 0.5936062314242189}-{'f1_val': 0.5801835366735651, 'auprc': 0.6551017692431237, 'loss_val': 0.6892662152337216, 'psi': 0.6101508297013886}
[S14] START round=11 head_norm_before_train=1.096531 cos_to_last_merge=0.9960 (last merge round=9)
[S14] round=11 local utility u=0.376317 metrics={'f1_val': 0.7147601614004545, 'auprc': 0.995267760024131, 'loss_val': 0.6189790820763043, 'psi': 0.8269632008499251}-{'f1_val': 0.644209628791274, 'auprc': 0.9587909878452121, 'loss_val': 0.8388798750871841, 'psi': 0.7700421724128492}
[S15] START round=11 head_norm_before_train=1.063106 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.694295039734521, 'auprc': 0.9737503158104622, 'loss_val': 0.3456278088542817, 'psi': 0.8060771501648976}-{'f1_val': 0.6920469885159382, 'auprc': 0.9798511311206111, 'loss_val': 0.33194590146457476, 'psi': 0.8071686455578073}
[S16] START round=11 head_norm_before_train=1.454665 (no previous merge yet)
[S16] round=11 local utility u=0.136300 metrics={'f1_val': 0.45905990898165516, 'auprc': 0.7548552911643487, 'loss_val': 0.7605888302944861, 'psi': 0.5773780618547326}-{'f1_val': 0.42724608205897974, 'auprc': 0.7439297740919053, 'loss_val': 0.8095296767968452, 'psi': 0.5539195588721499}
[S17] START round=11 head_norm_before_train=0.886960 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.725892 metrics={'f1_val': 0.49802873911668416, 'auprc': 0.757129081504833, 'loss_val': 0.7050427041355153, 'psi': 0.6016688760719437}-{'f1_val': 0.3784336981076769, 'auprc': 0.5471278888429452, 'loss_val': 0.8092525598147191, 'psi': 0.4459113744017842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:52812
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:52814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.811)
[S11] not sending this round → trigger blocked (psi=0.797)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:52809
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9347
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=0.9009
[S11] RECEIVED delta(kind=head bytes=1794) from S5
[S11] cosine check vs S5: cos=0.5681
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.6543
[S8] RECEIVED delta(kind=head bytes=1793) from S14
[S8] cosine check vs S14: cos=0.6401
[S17] RECEIVED delta(kind=head bytes=1802) from S7
[S17] cosine check vs S7: cos=0.3183
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.1296
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.5277 head_norm=1.283885
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.488949e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.5606 head_norm=0.848403 delta_norm=0.748895
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7018 head_norm=0.918481
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.650970e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.9597 head_norm=0.878359 delta_norm=0.465097
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7712 head_norm=1.058442
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.443469e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9299 head_norm=1.027151 delta_norm=0.244347
[S8] aggregate: ACCEPT kept=['S4', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=1.109721
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.431356e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=1.267198 delta_norm=0.343136
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.7148 head_norm=1.137811
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.421210e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.9447 head_norm=1.213621 delta_norm=0.242121
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.4980 head_norm=0.955458
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.060725e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3933 head_norm=0.839563 delta_norm=0.606073
[S17] aggregate: ROLLBACK (f1_val pre=0.498 post=0.393 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.810372 (no previous merge yet)
[S2] round=12 local utility u=0.005874 metrics={'f1_val': 0.699329985880033, 'auprc': 0.9818218565453924, 'loss_val': 0.26817625864507283, 'psi': 0.8123267341461768}-{'f1_val': 0.699329985880033, 'auprc': 0.978467172809964, 'loss_val': 0.26985995317227285, 'psi': 0.8109848606520054}
[S3] START round=12 head_norm_before_train=1.544171 (no previous merge yet)
[S3] round=12 local utility u=0.989877 metrics={'f1_val': 0.5874741872854727, 'auprc': 0.9929810944398907, 'loss_val': 0.5517838809287191, 'psi': 0.74967695014724}-{'f1_val': 0.4059122689826149, 'auprc': 0.8074150794836409, 'loss_val': 0.8854674047098088, 'psi': 0.5665133931830253}
[S4] START round=12 head_norm_before_train=1.761470 (no previous merge yet)
[S4] round=12 local utility u=0.076171 metrics={'f1_val': 0.9512830381730263, 'auprc': 0.9324274383218406, 'loss_val': 0.3021185060042893, 'psi': 0.943740798232552}-{'f1_val': 0.9405848959154601, 'auprc': 0.91615285193797, 'loss_val': 0.3414475207485467, 'psi': 0.930812078324464}
[S5] START round=12 head_norm_before_train=1.063980 cos_to_last_merge=0.9028 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.903
[S5] round=12 local utility u=0.014326 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.7950575559923452, 'loss_val': 0.4822808517123791, 'psi': 0.7385131377034523}-{'f1_val': 0.7146275168069246, 'auprc': 0.7929812646878001, 'loss_val': 0.5875675469749617, 'psi': 0.7459690159592748}
[S6] START round=12 head_norm_before_train=1.736739 (no previous merge yet)
[S6] round=12 local utility u=0.339227 metrics={'f1_val': 0.8081542297868065, 'auprc': 0.9466664264670912, 'loss_val': 0.3204459138421654, 'psi': 0.8635591084589204}-{'f1_val': 0.7392749486983488, 'auprc': 0.9057353999313404, 'loss_val': 0.46283063279368897, 'psi': 0.8058591291915455}
[S7] START round=12 head_norm_before_train=1.267198 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.806373 metrics={'f1_val': 0.6929906705965634, 'auprc': 0.7804390679931289, 'loss_val': 0.8142313902181076, 'psi': 0.7279700295551896}-{'f1_val': 0.41671011811102343, 'auprc': 0.7765993399519806, 'loss_val': 0.7577740373775042, 'psi': 0.5606658068474063}
[S8] START round=12 head_norm_before_train=1.027151 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.697117 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9956926945673047, 'loss_val': 0.2163953833953807, 'psi': 0.9961707433883269}-{'f1_val': 0.771172576632242, 'auprc': 0.9952305833657871, 'loss_val': 0.25734239559630584, 'psi': 0.86079577932566}
[S9] START round=12 head_norm_before_train=1.318874 cos_to_last_merge=0.8874 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.887
[S9] round=12 local utility u=1.000000 metrics={'f1_val': 0.9013924045775692, 'auprc': 0.9979001976993738, 'loss_val': 0.18984615035823746, 'psi': 0.939995521826291}-{'f1_val': 0.6173674840478033, 'auprc': 0.8670050742452446, 'loss_val': 0.3758632365281168, 'psi': 0.7172225201267799}
[S10] START round=12 head_norm_before_train=1.329806 cos_to_last_merge=0.8033 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.803
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9922616110202274, 'loss_val': 0.10866172055843296, 'psi': 0.9937680664176942}-{'f1_val': 0.9949681865317428, 'auprc': 0.995771380733949, 'loss_val': 0.11924917404042608, 'psi': 0.9952894642126253}
[S11] START round=12 head_norm_before_train=0.878359 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.011193 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9347570235281142, 'loss_val': 0.5961526437130987, 'psi': 0.7950639993902378}-{'f1_val': 0.7017589383281313, 'auprc': 0.9401017987749184, 'loss_val': 0.6335139862313145, 'psi': 0.7970960825068462}
[S13] START round=12 head_norm_before_train=0.848403 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.258101 metrics={'f1_val': 0.6319286481009497, 'auprc': 0.6197038492512309, 'loss_val': 0.6674132212900907, 'psi': 0.6270387285610621}-{'f1_val': 0.5277015202388611, 'auprc': 0.6924632982022556, 'loss_val': 0.7765306761588675, 'psi': 0.5936062314242189}
[S14] START round=12 head_norm_before_train=1.213621 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.637623 metrics={'f1_val': 0.9258318905024646, 'auprc': 0.9820619532350605, 'loss_val': 0.570545998534674, 'psi': 0.948323915595503}-{'f1_val': 0.7147601614004545, 'auprc': 0.995267760024131, 'loss_val': 0.6189790820763043, 'psi': 0.8269632008499251}
[S15] START round=12 head_norm_before_train=1.136990 cos_to_last_merge=0.9961 (last merge round=10)
[S15] round=12 local utility u=0.156134 metrics={'f1_val': 0.7422574054818376, 'auprc': 0.9645076312059049, 'loss_val': 0.2934061735525858, 'psi': 0.8311574957714645}-{'f1_val': 0.694295039734521, 'auprc': 0.9737503158104622, 'loss_val': 0.3456278088542817, 'psi': 0.8060771501648976}
[S16] START round=12 head_norm_before_train=1.488485 (no previous merge yet)
[S16] round=12 local utility u=0.417309 metrics={'f1_val': 0.5692459490359099, 'auprc': 0.7928584746488949, 'loss_val': 0.7010960426754856, 'psi': 0.6586909592811039}-{'f1_val': 0.45905990898165516, 'auprc': 0.7548552911643487, 'loss_val': 0.7605888302944861, 'psi': 0.5773780618547326}
[S17] START round=12 head_norm_before_train=0.839563 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.5054274996432203, 'auprc': 0.7026868268461639, 'loss_val': 0.701198879766955, 'psi': 0.5843312305243977}-{'f1_val': 0.49802873911668416, 'auprc': 0.757129081504833, 'loss_val': 0.7050427041355153, 'psi': 0.6016688760719437}
[S14] not sending this round → trigger blocked (psi=0.948)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.728)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:52808
[S16] not sending this round → trigger blocked (psi=0.659)
[S4] not sending this round → trigger blocked (psi=0.944)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S5] not sending this round → trigger blocked (psi=0.739)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.4014
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.1019
[S8] DROPPED delta from S2 (cos=-0.1019 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.4021
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.3890
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] cosine check vs S11: cos=-0.0171
[S8] DROPPED delta from S11 (cos=-0.0171 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=0.9051
[S9] RECEIVED delta(kind=head bytes=1806) from S15
[S9] cosine check vs S15: cos=-0.0370
[S9] DROPPED delta from S15 (cos=-0.0370 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=0.2125
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.6930 head_norm=1.294455
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.069306e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.5050 head_norm=0.865569 delta_norm=0.706931
[S7] aggregate: ROLLBACK (f1_val pre=0.693 post=0.505 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7423 head_norm=1.211643
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.575484e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.7660 head_norm=1.127871 delta_norm=0.257548
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7019 head_norm=0.922258
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.410804e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7019 head_norm=1.055279 delta_norm=0.741080
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.5054 head_norm=0.903583
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.824831e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3933 head_norm=0.894492 delta_norm=0.482483
[S17] aggregate: ROLLBACK (f1_val pre=0.505 post=0.393 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.834500 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6998450149870461, 'auprc': 0.8793790294362918, 'loss_val': 0.27674941963808536, 'psi': 0.7716586207667444}-{'f1_val': 0.699329985880033, 'auprc': 0.9818218565453924, 'loss_val': 0.26817625864507283, 'psi': 0.8123267341461768}
[S3] START round=13 head_norm_before_train=1.573236 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5864601119216223, 'auprc': 0.9785187755762581, 'loss_val': 0.5477416540210556, 'psi': 0.7432835773834766}-{'f1_val': 0.5874741872854727, 'auprc': 0.9929810944398907, 'loss_val': 0.5517838809287191, 'psi': 0.74967695014724}
[S4] START round=13 head_norm_before_train=1.783345 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9463192892048558, 'auprc': 0.9340351173906751, 'loss_val': 0.29870424396110085, 'psi': 0.9414056204791835}-{'f1_val': 0.9512830381730263, 'auprc': 0.9324274383218406, 'loss_val': 0.3021185060042893, 'psi': 0.943740798232552}
[S5] START round=13 head_norm_before_train=1.107162 cos_to_last_merge=0.8861 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.886
[S5] round=13 local utility u=0.059509 metrics={'f1_val': 0.7144008589453258, 'auprc': 0.7955065315806583, 'loss_val': 0.44611293918655853, 'psi': 0.7468431279994587}-{'f1_val': 0.7008168588441903, 'auprc': 0.7950575559923452, 'loss_val': 0.4822808517123791, 'psi': 0.7385131377034523}
[S6] START round=13 head_norm_before_train=1.767155 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.8024845763958397, 'auprc': 0.9380075346552355, 'loss_val': 0.423011564840669, 'psi': 0.856693759699598}-{'f1_val': 0.8081542297868065, 'auprc': 0.9466664264670912, 'loss_val': 0.3204459138421654, 'psi': 0.8635591084589204}
[S7] START round=13 head_norm_before_train=0.865569 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.6512839536344938, 'auprc': 0.7829170685087142, 'loss_val': 0.7592408857242837, 'psi': 0.703937199584182}-{'f1_val': 0.6929906705965634, 'auprc': 0.7804390679931289, 'loss_val': 0.8142313902181076, 'psi': 0.7279700295551896}
[S8] START round=13 head_norm_before_train=1.099440 cos_to_last_merge=0.9971 (last merge round=11)
[S8] round=13 local utility u=0.025428 metrics={'f1_val': 0.9939191410574828, 'auprc': 0.9987290786800627, 'loss_val': 0.15922585232292608, 'psi': 0.9958431161065147}-{'f1_val': 0.9964894426023416, 'auprc': 0.9956926945673047, 'loss_val': 0.2163953833953807, 'psi': 0.9961707433883269}
[S9] START round=13 head_norm_before_train=1.358519 cos_to_last_merge=0.8773 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.877
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.998292793853135, 'loss_val': 0.2268074458444417, 'psi': 0.8200470660052651}-{'f1_val': 0.9013924045775692, 'auprc': 0.9979001976993738, 'loss_val': 0.18984615035823746, 'psi': 0.939995521826291}
[S10] START round=13 head_norm_before_train=1.384347 cos_to_last_merge=0.7950 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.795
[S10] round=13 local utility u=0.018847 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9954354873782507, 'loss_val': 0.08140860840444916, 'psi': 0.9951295175954502}-{'f1_val': 0.9947723700160056, 'auprc': 0.9922616110202274, 'loss_val': 0.10866172055843296, 'psi': 0.9937680664176942}
[S11] START round=13 head_norm_before_train=1.055279 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.004583 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9263204986124065, 'loss_val': 0.5602262718888011, 'psi': 0.7915442871971174}-{'f1_val': 0.7019353166316534, 'auprc': 0.9347570235281142, 'loss_val': 0.5961526437130987, 'psi': 0.7950639993902378}
[S13] START round=13 head_norm_before_train=0.906812 cos_to_last_merge=0.9973 (last merge round=11)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5921751436014414, 'auprc': 0.6736056466344227, 'loss_val': 0.6969979418690416, 'psi': 0.6247473448146339}-{'f1_val': 0.6319286481009497, 'auprc': 0.6197038492512309, 'loss_val': 0.6674132212900907, 'psi': 0.6270387285610621}
[S14] START round=13 head_norm_before_train=1.248358 cos_to_last_merge=0.9977 (last merge round=11)
[S14] round=13 local utility u=0.120357 metrics={'f1_val': 0.9304819243259521, 'auprc': 0.9965992052857899, 'loss_val': 0.4013448173803192, 'psi': 0.9569288367098873}-{'f1_val': 0.9258318905024646, 'auprc': 0.9820619532350605, 'loss_val': 0.570545998534674, 'psi': 0.948323915595503}
[S15] START round=13 head_norm_before_train=1.127871 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.758880 metrics={'f1_val': 0.9867851016427338, 'auprc': 0.9689352637244227, 'loss_val': 0.25609497815536497, 'psi': 0.9796451664754093}-{'f1_val': 0.7422574054818376, 'auprc': 0.9645076312059049, 'loss_val': 0.2934061735525858, 'psi': 0.8311574957714645}
[S16] START round=13 head_norm_before_train=1.526968 (no previous merge yet)
[S16] round=13 local utility u=0.144823 metrics={'f1_val': 0.5823032601085885, 'auprc': 0.8360797224602118, 'loss_val': 0.619457586871711, 'psi': 0.6838138450492377}-{'f1_val': 0.5692459490359099, 'auprc': 0.7928584746488949, 'loss_val': 0.7010960426754856, 'psi': 0.6586909592811039}
[S17] START round=13 head_norm_before_train=0.894492 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3945969814847323, 'auprc': 0.7002286633055307, 'loss_val': 0.6793774465308658, 'psi': 0.5168496542130516}-{'f1_val': 0.5054274996432203, 'auprc': 0.7026868268461639, 'loss_val': 0.701198879766955, 'psi': 0.5843312305243977}
[S11] not sending this round → trigger blocked (psi=0.792)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[S15] not sending this round → trigger blocked (psi=0.980)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:52812
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:52814
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.9548
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.5600
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.7509
[S11] RECEIVED delta(kind=head bytes=1795) from S5
[S11] cosine check vs S5: cos=0.4223
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=1.091618
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.026368e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7019 head_norm=0.944981 delta_norm=0.602637
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.6513 head_norm=0.903213
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.330417e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.7045 head_norm=1.159026 delta_norm=0.533042
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9939 head_norm=1.173568
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.798368e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9950 head_norm=1.087909 delta_norm=0.579837
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9305 head_norm=1.289283
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.160439e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9829 head_norm=1.344431 delta_norm=0.216044
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.856308 (no previous merge yet)
[S2] round=14 local utility u=0.164537 metrics={'f1_val': 0.6996052466920027, 'auprc': 0.9824579621208547, 'loss_val': 0.2554730458899646, 'psi': 0.8127463328635436}-{'f1_val': 0.6998450149870461, 'auprc': 0.8793790294362918, 'loss_val': 0.27674941963808536, 'psi': 0.7716586207667444}
[S3] START round=14 head_norm_before_train=1.604453 (no previous merge yet)
[S3] round=14 local utility u=0.458509 metrics={'f1_val': 0.7005859652789095, 'auprc': 0.9929055840168739, 'loss_val': 0.3586386331965479, 'psi': 0.8175138127740953}-{'f1_val': 0.5864601119216223, 'auprc': 0.9785187755762581, 'loss_val': 0.5477416540210556, 'psi': 0.7432835773834766}
[S4] START round=14 head_norm_before_train=1.804256 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9412132784641762, 'auprc': 0.9209913638648904, 'loss_val': 0.30180632008159847, 'psi': 0.9331245126244618}-{'f1_val': 0.9463192892048558, 'auprc': 0.9340351173906751, 'loss_val': 0.29870424396110085, 'psi': 0.9414056204791835}
[S5] START round=14 head_norm_before_train=1.149213 cos_to_last_merge=0.8705 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.871
[S5] round=14 local utility u=0.273811 metrics={'f1_val': 0.7008332366747395, 'auprc': 0.9834873097238689, 'loss_val': 0.3810268105485586, 'psi': 0.8138948658943912}-{'f1_val': 0.7144008589453258, 'auprc': 0.7955065315806583, 'loss_val': 0.44611293918655853, 'psi': 0.7468431279994587}
[S6] START round=14 head_norm_before_train=1.798802 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.7289959086324346, 'auprc': 0.8366939176676482, 'loss_val': 0.6739602100035975, 'psi': 0.77207511224652}-{'f1_val': 0.8024845763958397, 'auprc': 0.9380075346552355, 'loss_val': 0.423011564840669, 'psi': 0.856693759699598}
[S7] START round=14 head_norm_before_train=1.159026 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4932985298201963, 'auprc': 0.7850269289391856, 'loss_val': 0.879263274884702, 'psi': 0.609989889467792}-{'f1_val': 0.6512839536344938, 'auprc': 0.7829170685087142, 'loss_val': 0.7592408857242837, 'psi': 0.703937199584182}
[S8] START round=14 head_norm_before_train=1.087909 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9953812994639146, 'auprc': 0.9979288022157987, 'loss_val': 0.21248979374487348, 'psi': 0.9964003005646682}-{'f1_val': 0.9939191410574828, 'auprc': 0.9987290786800627, 'loss_val': 0.15922585232292608, 'psi': 0.9958431161065147}
[S9] START round=14 head_norm_before_train=1.394639 cos_to_last_merge=0.8687 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=14 local utility u=0.931551 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9978004232435973, 'loss_val': 0.13240461022879177, 'psi': 0.9968678382769705}-{'f1_val': 0.7012165807733519, 'auprc': 0.998292793853135, 'loss_val': 0.2268074458444417, 'psi': 0.8200470660052651}
[S10] START round=14 head_norm_before_train=1.430415 cos_to_last_merge=0.7887 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.789
[S10] round=14 local utility u=0.007150 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.995427934810793, 'loss_val': 0.06708522422652521, 'psi': 0.9951264965684672}-{'f1_val': 0.9949255377402499, 'auprc': 0.9954354873782507, 'loss_val': 0.08140860840444916, 'psi': 0.9951295175954502}
[S11] START round=14 head_norm_before_train=0.944981 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9056400788238017, 'loss_val': 0.5258470045479611, 'psi': 0.7832721192816756}-{'f1_val': 0.7016934795869249, 'auprc': 0.9263204986124065, 'loss_val': 0.5602262718888011, 'psi': 0.7915442871971174}
[S13] START round=14 head_norm_before_train=0.965426 cos_to_last_merge=0.9917 (last merge round=11)
[S13] round=14 local utility u=0.036856 metrics={'f1_val': 0.601136050600564, 'auprc': 0.6778949121376994, 'loss_val': 0.6899189224816089, 'psi': 0.6318395952154181}-{'f1_val': 0.5921751436014414, 'auprc': 0.6736056466344227, 'loss_val': 0.6969979418690416, 'psi': 0.6247473448146339}
[S14] START round=14 head_norm_before_train=1.344431 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.215456 metrics={'f1_val': 0.99496713747233, 'auprc': 0.997828948787929, 'loss_val': 0.3610325474231682, 'psi': 0.9961118619985696}-{'f1_val': 0.9304819243259521, 'auprc': 0.9965992052857899, 'loss_val': 0.4013448173803192, 'psi': 0.9569288367098873}
[S15] START round=14 head_norm_before_train=1.192350 cos_to_last_merge=0.9972 (last merge round=12)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.700035512001849, 'auprc': 0.9684688309830559, 'loss_val': 0.3376334711374347, 'psi': 0.8074088395943317}-{'f1_val': 0.9867851016427338, 'auprc': 0.9689352637244227, 'loss_val': 0.25609497815536497, 'psi': 0.9796451664754093}
[S16] START round=14 head_norm_before_train=1.561779 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.5705783465264659, 'auprc': 0.8636736185167775, 'loss_val': 0.7279405873803866, 'psi': 0.6878164553225905}-{'f1_val': 0.5823032601085885, 'auprc': 0.8360797224602118, 'loss_val': 0.619457586871711, 'psi': 0.6838138450492377}
[S17] START round=14 head_norm_before_train=0.953499 cos_to_last_merge=0.9924 (last merge round=12)
[S17] round=14 local utility u=0.530918 metrics={'f1_val': 0.4992794175045605, 'auprc': 0.8267301192996948, 'loss_val': 0.6251408319898104, 'psi': 0.6302596982226143}-{'f1_val': 0.3945969814847323, 'auprc': 0.7002286633055307, 'loss_val': 0.6793774465308658, 'psi': 0.5168496542130516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:52808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[S14] not sending this round → trigger blocked (psi=0.996)
[S5] not sending this round → trigger blocked (psi=0.814)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S10] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=-0.0589
[S8] DROPPED delta from S2 (cos=-0.0589 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.5235
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.5386
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.3152
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.5304
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=0.978829
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.887085e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=1.154957 delta_norm=0.688709
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4933 head_norm=1.185945
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.536884e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.3985 head_norm=0.903207 delta_norm=0.653688
[S7] aggregate: ROLLBACK (f1_val pre=0.493 post=0.398 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6011 head_norm=1.039096
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.980848e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.5984 head_norm=0.899035 delta_norm=0.498085
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.4993 head_norm=1.016359
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.215331e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.5479 head_norm=1.069553 delta_norm=0.621533
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.878598 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7034790545605458, 'auprc': 0.8905704768637516, 'loss_val': 0.27894417898535256, 'psi': 0.7783156234818281}-{'f1_val': 0.6996052466920027, 'auprc': 0.9824579621208547, 'loss_val': 0.2554730458899646, 'psi': 0.8127463328635436}
[S3] START round=15 head_norm_before_train=1.630455 (no previous merge yet)
[S3] round=15 local utility u=0.014532 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9941327248917096, 'loss_val': 0.3317265936469502, 'psi': 0.817851641368601}-{'f1_val': 0.7005859652789095, 'auprc': 0.9929055840168739, 'loss_val': 0.3586386331965479, 'psi': 0.8175138127740953}
[S4] START round=15 head_norm_before_train=1.833213 (no previous merge yet)
[S4] round=15 local utility u=0.000335 metrics={'f1_val': 0.9401904490654032, 'auprc': 0.9233518851717754, 'loss_val': 0.30208008746882464, 'psi': 0.9334550235079521}-{'f1_val': 0.9412132784641762, 'auprc': 0.9209913638648904, 'loss_val': 0.30180632008159847, 'psi': 0.9331245126244618}
[S5] START round=15 head_norm_before_train=1.180228 cos_to_last_merge=0.8596 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.860
[S5] round=15 local utility u=0.035788 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9978759116484051, 'loss_val': 0.351028123756891, 'psi': 0.819491470662153}-{'f1_val': 0.7008332366747395, 'auprc': 0.9834873097238689, 'loss_val': 0.3810268105485586, 'psi': 0.8138948658943912}
[S6] START round=15 head_norm_before_train=1.823216 (no previous merge yet)
[S6] round=15 local utility u=0.281588 metrics={'f1_val': 0.8109882660887799, 'auprc': 0.8165440031776805, 'loss_val': 0.5422895866168072, 'psi': 0.8132105609243401}-{'f1_val': 0.7289959086324346, 'auprc': 0.8366939176676482, 'loss_val': 0.6739602100035975, 'psi': 0.77207511224652}
[S7] START round=15 head_norm_before_train=0.903207 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.921538 metrics={'f1_val': 0.6782832744934875, 'auprc': 0.9466049601247153, 'loss_val': 0.6308301940613797, 'psi': 0.7856119487459786}-{'f1_val': 0.4932985298201963, 'auprc': 0.7850269289391856, 'loss_val': 0.879263274884702, 'psi': 0.609989889467792}
[S8] START round=15 head_norm_before_train=1.147101 cos_to_last_merge=0.9972 (last merge round=13)
[S8] round=15 local utility u=0.031085 metrics={'f1_val': 0.9950130515203403, 'auprc': 0.9974790335613605, 'loss_val': 0.14676145392711976, 'psi': 0.9959994443367484}-{'f1_val': 0.9953812994639146, 'auprc': 0.9979288022157987, 'loss_val': 0.21248979374487348, 'psi': 0.9964003005646682}
[S9] START round=15 head_norm_before_train=1.423906 cos_to_last_merge=0.8617 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.862
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9787460450212913, 'auprc': 0.9888005206221513, 'loss_val': 0.14993658588932435, 'psi': 0.9827678352616354}-{'f1_val': 0.9962461149658858, 'auprc': 0.9978004232435973, 'loss_val': 0.13240461022879177, 'psi': 0.9968678382769705}
[S10] START round=15 head_norm_before_train=1.476717 cos_to_last_merge=0.7830 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.783
[S10] round=15 local utility u=0.004447 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9954277939226559, 'loss_val': 0.05687408417320418, 'psi': 0.9949947763383644}-{'f1_val': 0.9949255377402499, 'auprc': 0.995427934810793, 'loss_val': 0.06708522422652521, 'psi': 0.9951264965684672}
[S11] START round=15 head_norm_before_train=1.154957 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.033249 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9170569281070599, 'loss_val': 0.49544341146874665, 'psi': 0.7880232368103632}-{'f1_val': 0.7016934795869249, 'auprc': 0.9056400788238017, 'loss_val': 0.5258470045479611, 'psi': 0.7832721192816756}
[S13] START round=15 head_norm_before_train=0.899035 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6008862457507724, 'auprc': 0.6669624329330788, 'loss_val': 0.717065055473026, 'psi': 0.6273167206236949}-{'f1_val': 0.601136050600564, 'auprc': 0.6778949121376994, 'loss_val': 0.6899189224816089, 'psi': 0.6318395952154181}
[S14] START round=15 head_norm_before_train=1.380970 cos_to_last_merge=0.9986 (last merge round=13)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9320962117651244, 'auprc': 0.9953039406075982, 'loss_val': 0.3274775875110596, 'psi': 0.9573793033021138}-{'f1_val': 0.99496713747233, 'auprc': 0.997828948787929, 'loss_val': 0.3610325474231682, 'psi': 0.9961118619985696}
[S15] START round=15 head_norm_before_train=1.250625 cos_to_last_merge=0.9919 (last merge round=12)
[S15] round=15 local utility u=0.200758 metrics={'f1_val': 0.7657759919923721, 'auprc': 0.9580105809204864, 'loss_val': 0.29918479973212053, 'psi': 0.8426698275636177}-{'f1_val': 0.700035512001849, 'auprc': 0.9684688309830559, 'loss_val': 0.3376334711374347, 'psi': 0.8074088395943317}
[S16] START round=15 head_norm_before_train=1.597879 (no previous merge yet)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.9754054939947858, 'auprc': 0.990027381034293, 'loss_val': 0.2656605062966217, 'psi': 0.9812542488105886}-{'f1_val': 0.5705783465264659, 'auprc': 0.8636736185167775, 'loss_val': 0.7279405873803866, 'psi': 0.6878164553225905}
[S17] START round=15 head_norm_before_train=1.069553 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.461737 metrics={'f1_val': 0.6074777951917282, 'auprc': 0.9110843742818704, 'loss_val': 0.603920820821326, 'psi': 0.7289204268277851}-{'f1_val': 0.4992794175045605, 'auprc': 0.8267301192996948, 'loss_val': 0.6251408319898104, 'psi': 0.6302596982226143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.818)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:52809
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9706
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=0.3427
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=0.4827
[S8] RECEIVED delta(kind=head bytes=1789) from S11
[S8] cosine check vs S11: cos=-0.1054
[S8] DROPPED delta from S11 (cos=-0.1054 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.4464
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] cosine check vs S5: cos=0.3905
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.8293
[S9] RECEIVED delta(kind=head bytes=1804) from S15
[S9] cosine check vs S15: cos=-0.0531
[S9] DROPPED delta from S15 (cos=-0.0531 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1789) from S16
[S7] cosine check vs S16: cos=0.6604
[S17] not sending this round → trigger blocked (psi=0.729)
[S13] ⇄ pheromone p=0.107 → S7@127.0.0.1:52808
[S9] ⇄ pheromone p=0.375 → S17@127.0.0.1:52817
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9321 head_norm=1.414694
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.848733e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9494 head_norm=1.454848 delta_norm=0.184873
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.307 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.290 → S11@127.0.0.1:52812
[S2] ⇄ pheromone p=0.133 → S8@127.0.0.1:52809
[S4] ⇄ pheromone p=0.116 → S8@127.0.0.1:52809
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9950 head_norm=1.218839
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.522651e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9945 head_norm=1.317274 delta_norm=0.852265
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.218 → S15@127.0.0.1:52815
[S5] ⇄ pheromone p=0.184 → S11@127.0.0.1:52812
[S6] ⇄ pheromone p=0.230 → S17@127.0.0.1:52817
[S16] ⇄ pheromone p=0.351 → S7@127.0.0.1:52808
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7020 head_norm=1.184497
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.607117e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7022 head_norm=0.997880 delta_norm=0.660712
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.145 → S8@127.0.0.1:52809
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.7658 head_norm=1.307120
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.714138e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.7658 head_norm=1.207940 delta_norm=0.371414
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.258 → S9@127.0.0.1:52810
[S10] ⇄ pheromone p=0.145 → S14@127.0.0.1:52814
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6783 head_norm=0.933303
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.173636e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.7040 head_norm=1.177967 delta_norm=0.617364
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.347 → S17@127.0.0.1:52817
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.6075 head_norm=1.123429
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.572267e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.5921 head_norm=0.958513 delta_norm=0.557227
[S17] aggregate: ROLLBACK (f1_val pre=0.607 post=0.592 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.309 → S13@127.0.0.1:52813
[S2] START round=16 head_norm_before_train=1.896297 (no previous merge yet)
[S2] round=16 local utility u=0.158483 metrics={'f1_val': 0.7043929476671704, 'auprc': 0.979331725999441, 'loss_val': 0.23374615492406017, 'psi': 0.8143684590000786}-{'f1_val': 0.7034790545605458, 'auprc': 0.8905704768637516, 'loss_val': 0.27894417898535256, 'psi': 0.7783156234818281}
[S3] START round=16 head_norm_before_train=1.653096 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.6818995468279534, 'auprc': 0.9963120722270723, 'loss_val': 0.379106906521116, 'psi': 0.807664556987601}-{'f1_val': 0.700330919019862, 'auprc': 0.9941327248917096, 'loss_val': 0.3317265936469502, 'psi': 0.817851641368601}
[S4] START round=16 head_norm_before_train=1.854066 (no previous merge yet)
[S4] round=16 local utility u=0.007165 metrics={'f1_val': 0.9404062648493776, 'auprc': 0.9267098524468262, 'loss_val': 0.29911855365012047, 'psi': 0.9349276998883571}-{'f1_val': 0.9401904490654032, 'auprc': 0.9233518851717754, 'loss_val': 0.30208008746882464, 'psi': 0.9334550235079521}
[S5] START round=16 head_norm_before_train=1.208956 cos_to_last_merge=0.8496 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.850
[S5] round=16 local utility u=0.014880 metrics={'f1_val': 0.700320598491359, 'auprc': 0.997852455847001, 'loss_val': 0.3197102383515697, 'psi': 0.8193333414336158}-{'f1_val': 0.7005685100046517, 'auprc': 0.9978759116484051, 'loss_val': 0.351028123756891, 'psi': 0.819491470662153}
[S6] START round=16 head_norm_before_train=1.845110 (no previous merge yet)
[S6] round=16 local utility u=0.576366 metrics={'f1_val': 0.8869709480494324, 'auprc': 0.9533778139121732, 'loss_val': 0.2559558393889017, 'psi': 0.9135336943945287}-{'f1_val': 0.8109882660887799, 'auprc': 0.8165440031776805, 'loss_val': 0.5422895866168072, 'psi': 0.8132105609243401}
[S7] START round=16 head_norm_before_train=1.177967 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5555865286517081, 'auprc': 0.7895050058172556, 'loss_val': 0.7909804547248772, 'psi': 0.6491539195179271}-{'f1_val': 0.6782832744934875, 'auprc': 0.9466049601247153, 'loss_val': 0.6308301940613797, 'psi': 0.7856119487459786}
[S8] START round=16 head_norm_before_train=1.317274 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.020149 metrics={'f1_val': 0.9956682381346691, 'auprc': 0.9972299065314681, 'loss_val': 0.10964704862651536, 'psi': 0.9962929054933888}-{'f1_val': 0.9950130515203403, 'auprc': 0.9974790335613605, 'loss_val': 0.14676145392711976, 'psi': 0.9959994443367484}
[S9] START round=16 head_norm_before_train=1.452331 cos_to_last_merge=0.8549 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.855
[S9] round=16 local utility u=0.096672 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9992969365867432, 'loss_val': 0.08810115616084506, 'psi': 0.9969682741566688}-{'f1_val': 0.9787460450212913, 'auprc': 0.9888005206221513, 'loss_val': 0.14993658588932435, 'psi': 0.9827678352616354}
[S10] START round=16 head_norm_before_train=1.516629 cos_to_last_merge=0.7786 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.779
[S10] round=16 local utility u=0.002770 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9954403689618091, 'loss_val': 0.051371350246833536, 'psi': 0.9949998063540256}-{'f1_val': 0.9947060979488367, 'auprc': 0.9954277939226559, 'loss_val': 0.05687408417320418, 'psi': 0.9949947763383644}
[S11] START round=16 head_norm_before_train=0.997880 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.005047 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9075062013289489, 'loss_val': 0.4548525348028218, 'psi': 0.7840185682837344}-{'f1_val': 0.7020007759458987, 'auprc': 0.9170569281070599, 'loss_val': 0.49544341146874665, 'psi': 0.7880232368103632}
[S13] START round=16 head_norm_before_train=0.975522 cos_to_last_merge=0.9938 (last merge round=14)
[S13] round=16 local utility u=0.022797 metrics={'f1_val': 0.6003558176068698, 'auprc': 0.6781212323349332, 'loss_val': 0.7017646257235147, 'psi': 0.6314619834980952}-{'f1_val': 0.6008862457507724, 'auprc': 0.6669624329330788, 'loss_val': 0.717065055473026, 'psi': 0.6273167206236949}
[S14] START round=16 head_norm_before_train=1.454848 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.236022 metrics={'f1_val': 0.9976985674416128, 'auprc': 0.9968888500504136, 'loss_val': 0.2538025603389533, 'psi': 0.9973746804851331}-{'f1_val': 0.9320962117651244, 'auprc': 0.9953039406075982, 'loss_val': 0.3274775875110596, 'psi': 0.9573793033021138}
[S15] START round=16 head_norm_before_train=1.207940 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.124738 metrics={'f1_val': 0.7933868378618176, 'auprc': 0.9788502817156592, 'loss_val': 0.27789352461539896, 'psi': 0.8675722154033543}-{'f1_val': 0.7657759919923721, 'auprc': 0.9580105809204864, 'loss_val': 0.29918479973212053, 'psi': 0.8426698275636177}
[S16] START round=16 head_norm_before_train=1.632922 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.9092807912301624, 'auprc': 0.9879600419148726, 'loss_val': 0.4023294115911336, 'psi': 0.9407524915040465}-{'f1_val': 0.9754054939947858, 'auprc': 0.990027381034293, 'loss_val': 0.2656605062966217, 'psi': 0.9812542488105886}
[S17] START round=16 head_norm_before_train=0.958513 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.617475 metrics={'f1_val': 0.7951499788201015, 'auprc': 0.9290996075834885, 'loss_val': 0.5490489179013559, 'psi': 0.8487298303254562}-{'f1_val': 0.6074777951917282, 'auprc': 0.9110843742818704, 'loss_val': 0.603920820821326, 'psi': 0.7289204268277851}
[S15] not sending this round → trigger blocked (psi=0.868)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S6] not sending this round → trigger blocked (psi=0.914)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S4] not sending this round → trigger blocked (psi=0.935)
[S11] not sending this round → trigger blocked (psi=0.784)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[S5] not sending this round → trigger blocked (psi=0.819)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.5535
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=-0.1018
[S8] DROPPED delta from S2 (cos=-0.1018 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=0.3802
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=0.4461
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S17
[S13] cosine check vs S17: cos=0.8020
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9957 head_norm=1.383898
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.993667e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9964 head_norm=1.191604 delta_norm=0.799367
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.5556 head_norm=1.197452
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.982457e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.5240 head_norm=0.963012 delta_norm=0.598246
[S7] aggregate: ROLLBACK (f1_val pre=0.556 post=0.524 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6004 head_norm=1.066156
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.308207e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.5903 head_norm=0.997027 delta_norm=0.330821
[S13] aggregate: ROLLBACK (f1_val pre=0.600 post=0.590 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.7951 head_norm=1.034564
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.258692e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.6277 head_norm=1.113389 delta_norm=0.625869
[S17] aggregate: ROLLBACK (f1_val pre=0.795 post=0.628 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.923214 (no previous merge yet)
[S2] round=17 local utility u=0.330460 metrics={'f1_val': 0.8245552361910846, 'auprc': 0.9675402019387033, 'loss_val': 0.2584257869141482, 'psi': 0.8817492224901321}-{'f1_val': 0.7043929476671704, 'auprc': 0.979331725999441, 'loss_val': 0.23374615492406017, 'psi': 0.8143684590000786}
[S3] START round=17 head_norm_before_train=1.669883 (no previous merge yet)
[S3] round=17 local utility u=0.090183 metrics={'f1_val': 0.7000757262075916, 'auprc': 0.9984879464163249, 'loss_val': 0.31432553969001875, 'psi': 0.8194406142910848}-{'f1_val': 0.6818995468279534, 'auprc': 0.9963120722270723, 'loss_val': 0.379106906521116, 'psi': 0.807664556987601}
[S4] START round=17 head_norm_before_train=1.869451 (no previous merge yet)
[S4] round=17 local utility u=0.026325 metrics={'f1_val': 0.942054352054568, 'auprc': 0.9405023255908184, 'loss_val': 0.2977349097649547, 'psi': 0.9414335414690682}-{'f1_val': 0.9404062648493776, 'auprc': 0.9267098524468262, 'loss_val': 0.29911855365012047, 'psi': 0.9349276998883571}
[S5] START round=17 head_norm_before_train=1.238472 cos_to_last_merge=0.8396 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7929004927746163, 'loss_val': 0.41602130078337524, 'psi': 0.7458402366824517}-{'f1_val': 0.700320598491359, 'auprc': 0.997852455847001, 'loss_val': 0.3197102383515697, 'psi': 0.8193333414336158}
[S6] START round=17 head_norm_before_train=1.862987 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.5984904680284603, 'auprc': 0.7604018199081539, 'loss_val': 1.0232220114072446, 'psi': 0.6632550087803377}-{'f1_val': 0.8869709480494324, 'auprc': 0.9533778139121732, 'loss_val': 0.2559558393889017, 'psi': 0.9135336943945287}
[S7] START round=17 head_norm_before_train=0.963012 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.786763 metrics={'f1_val': 0.6821449902267028, 'auprc': 0.9900574548527888, 'loss_val': 0.5784621413475715, 'psi': 0.8053099760771373}-{'f1_val': 0.5555865286517081, 'auprc': 0.7895050058172556, 'loss_val': 0.7909804547248772, 'psi': 0.6491539195179271}
[S8] START round=17 head_norm_before_train=1.191604 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9944993143621779, 'auprc': 0.9958163494588498, 'loss_val': 0.13776965827267543, 'psi': 0.9950261284008466}-{'f1_val': 0.9956682381346691, 'auprc': 0.9972299065314681, 'loss_val': 0.10964704862651536, 'psi': 0.9962929054933888}
[S9] START round=17 head_norm_before_train=1.480666 cos_to_last_merge=0.8481 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.848
[S9] round=17 local utility u=0.003875 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9995533020402372, 'loss_val': 0.0710790927117714, 'psi': 0.9960666258099199}-{'f1_val': 0.9954158325366191, 'auprc': 0.9992969365867432, 'loss_val': 0.08810115616084506, 'psi': 0.9969682741566688}
[S10] START round=17 head_norm_before_train=1.555066 cos_to_last_merge=0.7745 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.775
[S10] round=17 local utility u=0.003640 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9954351190472587, 'loss_val': 0.04539248811076179, 'psi': 0.9951293702630535}-{'f1_val': 0.9947060979488367, 'auprc': 0.9954403689618091, 'loss_val': 0.051371350246833536, 'psi': 0.9949998063540256}
[S11] START round=17 head_norm_before_train=1.031729 cos_to_last_merge=0.9973 (last merge round=15)
[S11] round=17 local utility u=0.047208 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9167415448887553, 'loss_val': 0.3881421679111649, 'psi': 0.787712705707657}-{'f1_val': 0.7016934795869249, 'auprc': 0.9075062013289489, 'loss_val': 0.4548525348028218, 'psi': 0.7840185682837344}
[S13] START round=17 head_norm_before_train=0.997027 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.552613571916678, 'auprc': 0.6885005012099451, 'loss_val': 0.757905591310955, 'psi': 0.6069683436339849}-{'f1_val': 0.6003558176068698, 'auprc': 0.6781212323349332, 'loss_val': 0.7017646257235147, 'psi': 0.6314619834980952}
[S14] START round=17 head_norm_before_train=1.484130 cos_to_last_merge=0.9994 (last merge round=15)
[S14] round=17 local utility u=0.033372 metrics={'f1_val': 0.9972657600632533, 'auprc': 0.9975346325516723, 'loss_val': 0.18639954106244583, 'psi': 0.9973733090586209}-{'f1_val': 0.9976985674416128, 'auprc': 0.9968888500504136, 'loss_val': 0.2538025603389533, 'psi': 0.9973746804851331}
[S15] START round=17 head_norm_before_train=1.261708 cos_to_last_merge=0.9983 (last merge round=15)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6914175038488796, 'auprc': 0.9164633282533281, 'loss_val': 0.3987541263788038, 'psi': 0.781435833610659}-{'f1_val': 0.7933868378618176, 'auprc': 0.9788502817156592, 'loss_val': 0.27789352461539896, 'psi': 0.8675722154033543}
[S16] START round=17 head_norm_before_train=1.667402 (no previous merge yet)
[S16] round=17 local utility u=0.199205 metrics={'f1_val': 0.9436075768427366, 'auprc': 0.990084529742652, 'loss_val': 0.216254353021675, 'psi': 0.9621983580027027}-{'f1_val': 0.9092807912301624, 'auprc': 0.9879600419148726, 'loss_val': 0.4023294115911336, 'psi': 0.9407524915040465}
[S17] START round=17 head_norm_before_train=1.113389 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.567757398031995, 'auprc': 0.6942265510098056, 'loss_val': 0.7267899769736899, 'psi': 0.6183450592231192}-{'f1_val': 0.7951499788201015, 'auprc': 0.9290996075834885, 'loss_val': 0.5490489179013559, 'psi': 0.8487298303254562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[S9] not sending this round → trigger blocked (psi=0.996)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[S14] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.882)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.6746
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9824
[S17] RECEIVED delta(kind=head bytes=1803) from S7
[S17] cosine check vs S7: cos=0.5401
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=0.5241
[S8] RECEIVED delta(kind=head bytes=1797) from S11
[S8] cosine check vs S11: cos=-0.0463
[S8] DROPPED delta from S11 (cos=-0.0463 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.5709
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9973 head_norm=1.515485
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.496483e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9973 head_norm=1.544352 delta_norm=0.149648
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9945 head_norm=1.252413
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.179365e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9938 head_norm=1.383493 delta_norm=0.817936
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6821 head_norm=0.984945
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.332269e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6929 head_norm=1.237484 delta_norm=0.633227
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7017 head_norm=1.070053
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.931413e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7017 head_norm=1.228320 delta_norm=0.693141
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.5678 head_norm=1.178287
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.255581e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.5737 head_norm=0.950277 delta_norm=0.525558
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.941829 (no previous merge yet)
[S2] round=18 local utility u=0.008220 metrics={'f1_val': 0.828807475028177, 'auprc': 0.9669774718126354, 'loss_val': 0.265811437498685, 'psi': 0.8840754737419603}-{'f1_val': 0.8245552361910846, 'auprc': 0.9675402019387033, 'loss_val': 0.2584257869141482, 'psi': 0.8817492224901321}
[S3] START round=18 head_norm_before_train=1.683275 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.6054345536374317, 'auprc': 0.9995872529676857, 'loss_val': 0.4769896074340332, 'psi': 0.7630956333695333}-{'f1_val': 0.7000757262075916, 'auprc': 0.9984879464163249, 'loss_val': 0.31432553969001875, 'psi': 0.8194406142910848}
[S4] START round=18 head_norm_before_train=1.896736 (no previous merge yet)
[S4] round=18 local utility u=0.045729 metrics={'f1_val': 0.9465157429814723, 'auprc': 0.960551031643619, 'loss_val': 0.29319129542775707, 'psi': 0.9521298584463309}-{'f1_val': 0.942054352054568, 'auprc': 0.9405023255908184, 'loss_val': 0.2977349097649547, 'psi': 0.9414335414690682}
[S5] START round=18 head_norm_before_train=1.268327 cos_to_last_merge=0.8299 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=18 local utility u=0.011664 metrics={'f1_val': 0.7156455444204163, 'auprc': 0.7932022457261172, 'loss_val': 0.40067237051304333, 'psi': 0.7466682249426967}-{'f1_val': 0.7144667326210086, 'auprc': 0.7929004927746163, 'loss_val': 0.41602130078337524, 'psi': 0.7458402366824517}
[S6] START round=18 head_norm_before_train=1.888828 (no previous merge yet)
[S6] round=18 local utility u=1.000000 metrics={'f1_val': 0.8235971721325759, 'auprc': 0.949121662162266, 'loss_val': 0.5081076076906509, 'psi': 0.873806968144452}-{'f1_val': 0.5984904680284603, 'auprc': 0.7604018199081539, 'loss_val': 1.0232220114072446, 'psi': 0.6632550087803377}
[S7] START round=18 head_norm_before_train=1.237484 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.3934266919572619, 'auprc': 0.801281892242072, 'loss_val': 0.9910129282850387, 'psi': 0.5565687720711859}-{'f1_val': 0.6821449902267028, 'auprc': 0.9900574548527888, 'loss_val': 0.5784621413475715, 'psi': 0.8053099760771373}
[S8] START round=18 head_norm_before_train=1.383493 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.004548 metrics={'f1_val': 0.9933613156235134, 'auprc': 0.9965177454766032, 'loss_val': 0.12395060068754994, 'psi': 0.9946238875647493}-{'f1_val': 0.9944993143621779, 'auprc': 0.9958163494588498, 'loss_val': 0.13776965827267543, 'psi': 0.9950261284008466}
[S9] START round=18 head_norm_before_train=1.511805 cos_to_last_merge=0.8406 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=18 local utility u=0.008186 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9995250575038098, 'loss_val': 0.05713054417315558, 'psi': 0.996306083025198}-{'f1_val': 0.9937421749897083, 'auprc': 0.9995533020402372, 'loss_val': 0.0710790927117714, 'psi': 0.9960666258099199}
[S10] START round=18 head_norm_before_train=1.586864 cos_to_last_merge=0.7714 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.771
[S10] round=18 local utility u=0.001577 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9953637478976408, 'loss_val': 0.04309193792439798, 'psi': 0.9952075800047153}-{'f1_val': 0.9949255377402499, 'auprc': 0.9954351190472587, 'loss_val': 0.04539248811076179, 'psi': 0.9951293702630535}
[S11] START round=18 head_norm_before_train=1.228320 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.069096 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9618852893863887, 'loss_val': 0.38683174765351536, 'psi': 0.8059153057335475}-{'f1_val': 0.7016934795869249, 'auprc': 0.9167415448887553, 'loss_val': 0.3881421679111649, 'psi': 0.787712705707657}
[S13] START round=18 head_norm_before_train=1.065071 cos_to_last_merge=0.9953 (last merge round=16)
[S13] round=18 local utility u=0.165231 metrics={'f1_val': 0.5988756605851183, 'auprc': 0.6904837170737611, 'loss_val': 0.7109662615958487, 'psi': 0.6355188831805754}-{'f1_val': 0.552613571916678, 'auprc': 0.6885005012099451, 'loss_val': 0.757905591310955, 'psi': 0.6069683436339849}
[S14] START round=18 head_norm_before_train=1.544352 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.015206 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9992140831146152, 'loss_val': 0.16348750210874374, 'psi': 0.998291257739607}-{'f1_val': 0.9972657600632533, 'auprc': 0.9975346325516723, 'loss_val': 0.18639954106244583, 'psi': 0.9973733090586209}
[S15] START round=18 head_norm_before_train=1.322412 cos_to_last_merge=0.9941 (last merge round=15)
[S15] round=18 local utility u=0.420974 metrics={'f1_val': 0.7750812757120443, 'auprc': 0.987166722724191, 'loss_val': 0.2708987466528434, 'psi': 0.859915454516903}-{'f1_val': 0.6914175038488796, 'auprc': 0.9164633282533281, 'loss_val': 0.3987541263788038, 'psi': 0.781435833610659}
[S16] START round=18 head_norm_before_train=1.701344 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8815848524932216, 'auprc': 0.9889449716503332, 'loss_val': 0.42181484125324314, 'psi': 0.9245289001560664}-{'f1_val': 0.9436075768427366, 'auprc': 0.990084529742652, 'loss_val': 0.216254353021675, 'psi': 0.9621983580027027}
[S17] START round=18 head_norm_before_train=0.950277 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5526635037900236, 'auprc': 0.6350745223996594, 'loss_val': 0.7172403496496701, 'psi': 0.5856279112338779}-{'f1_val': 0.567757398031995, 'auprc': 0.6942265510098056, 'loss_val': 0.7267899769736899, 'psi': 0.6183450592231192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[S11] not sending this round → trigger blocked (psi=0.806)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.952)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:52810
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:52808
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] cosine check vs S5: cos=0.3887
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.8360
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=0.3751
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=-0.0939
[S9] DROPPED delta from S15 (cos=-0.0939 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.6728
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] cosine check vs S13: cos=0.4484
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=-0.0940
[S8] DROPPED delta from S2 (cos=-0.0940 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.3629
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.3934 head_norm=1.251452
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.275181e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.3840 head_norm=1.013906 delta_norm=0.627518
[S7] aggregate: ROLLBACK (f1_val pre=0.393 post=0.384 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7019 head_norm=1.263407
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.068374e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7019 head_norm=1.065196 delta_norm=0.706837
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.7751 head_norm=1.384508
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.051995e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.8086 head_norm=1.353067 delta_norm=0.405199
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9934 head_norm=1.439824
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.460006e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9827 head_norm=1.252667 delta_norm=0.846001
[S8] aggregate: ROLLBACK (f1_val pre=0.993 post=0.983 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.5527 head_norm=1.029193
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.401057e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.5573 head_norm=1.040748 delta_norm=0.440106
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.947781 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.713199919970541, 'auprc': 0.979746975157735, 'loss_val': 0.2639186539373913, 'psi': 0.8198187420454186}-{'f1_val': 0.828807475028177, 'auprc': 0.9669774718126354, 'loss_val': 0.265811437498685, 'psi': 0.8840754737419603}
[S3] START round=19 head_norm_before_train=1.695946 (no previous merge yet)
[S3] round=19 local utility u=0.364389 metrics={'f1_val': 0.69982954919712, 'auprc': 0.9999962526863435, 'loss_val': 0.3158081479030742, 'psi': 0.8198962305928095}-{'f1_val': 0.6054345536374317, 'auprc': 0.9995872529676857, 'loss_val': 0.4769896074340332, 'psi': 0.7630956333695333}
[S4] START round=19 head_norm_before_train=1.925888 (no previous merge yet)
[S4] round=19 local utility u=0.026659 metrics={'f1_val': 0.951034200779546, 'auprc': 0.9660179230282269, 'loss_val': 0.2833842934135098, 'psi': 0.9570276896790184}-{'f1_val': 0.9465157429814723, 'auprc': 0.960551031643619, 'loss_val': 0.29319129542775707, 'psi': 0.9521298584463309}
[S5] START round=19 head_norm_before_train=1.293185 cos_to_last_merge=0.8225 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.822
[S5] round=19 local utility u=0.920371 metrics={'f1_val': 0.9021356658274201, 'auprc': 0.9947034285754358, 'loss_val': 0.2833750648677503, 'psi': 0.9391627709266264}-{'f1_val': 0.7156455444204163, 'auprc': 0.7932022457261172, 'loss_val': 0.40067237051304333, 'psi': 0.7466682249426967}
[S6] START round=19 head_norm_before_train=1.903024 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6340119836885676, 'auprc': 0.9009129918825662, 'loss_val': 0.8752358926873945, 'psi': 0.7407723869661671}-{'f1_val': 0.8235971721325759, 'auprc': 0.949121662162266, 'loss_val': 0.5081076076906509, 'psi': 0.873806968144452}
[S7] START round=19 head_norm_before_train=1.013906 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=1.000000 metrics={'f1_val': 0.673786777402567, 'auprc': 0.9422563226570648, 'loss_val': 0.6132300163462605, 'psi': 0.7811745955043661}-{'f1_val': 0.3934266919572619, 'auprc': 0.801281892242072, 'loss_val': 0.9910129282850387, 'psi': 0.5565687720711859}
[S8] START round=19 head_norm_before_train=1.252667 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000145 metrics={'f1_val': 0.993553675737062, 'auprc': 0.9953245623583737, 'loss_val': 0.12123526811079965, 'psi': 0.9942620303855867}-{'f1_val': 0.9933613156235134, 'auprc': 0.9965177454766032, 'loss_val': 0.12395060068754994, 'psi': 0.9946238875647493}
[S9] START round=19 head_norm_before_train=1.542557 cos_to_last_merge=0.8333 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.833
[S9] round=19 local utility u=0.008941 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9994416184306743, 'loss_val': 0.04653204087622767, 'psi': 0.9970261468942412}-{'f1_val': 0.9941601000394567, 'auprc': 0.9995250575038098, 'loss_val': 0.05713054417315558, 'psi': 0.996306083025198}
[S10] START round=19 head_norm_before_train=1.618227 cos_to_last_merge=0.7684 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.768
[S10] round=19 local utility u=0.001789 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9952658147689236, 'loss_val': 0.040537563343744386, 'psi': 0.9953001982458076}-{'f1_val': 0.9951034680760983, 'auprc': 0.9953637478976408, 'loss_val': 0.04309193792439798, 'psi': 0.9952075800047153}
[S11] START round=19 head_norm_before_train=1.065196 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.020015 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9721407341617714, 'loss_val': 0.37611763982253316, 'psi': 0.8098723814168635}-{'f1_val': 0.7019353166316534, 'auprc': 0.9618852893863887, 'loss_val': 0.38683174765351536, 'psi': 0.8059153057335475}
[S13] START round=19 head_norm_before_train=1.130238 cos_to_last_merge=0.9858 (last merge round=16)
[S13] round=19 local utility u=0.066188 metrics={'f1_val': 0.6112976149563742, 'auprc': 0.6748889141627549, 'loss_val': 0.6063375268371674, 'psi': 0.6367341346389266}-{'f1_val': 0.5988756605851183, 'auprc': 0.6904837170737611, 'loss_val': 0.7109662615958487, 'psi': 0.6355188831805754}
[S14] START round=19 head_norm_before_train=1.580092 cos_to_last_merge=0.9994 (last merge round=17)
[S14] round=19 local utility u=0.020874 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9991925119509374, 'loss_val': 0.12167570878976328, 'psi': 0.998282629274136}-{'f1_val': 0.9976760408229349, 'auprc': 0.9992140831146152, 'loss_val': 0.16348750210874374, 'psi': 0.998291257739607}
[S15] START round=19 head_norm_before_train=1.353067 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7703415804980934, 'auprc': 0.9875973935479693, 'loss_val': 0.30571093834251417, 'psi': 0.8572439057180438}-{'f1_val': 0.7750812757120443, 'auprc': 0.987166722724191, 'loss_val': 0.2708987466528434, 'psi': 0.859915454516903}
[S16] START round=19 head_norm_before_train=1.733171 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8545864436954339, 'auprc': 0.9208231097145343, 'loss_val': 0.7362525393521298, 'psi': 0.881081110103074}-{'f1_val': 0.8815848524932216, 'auprc': 0.9889449716503332, 'loss_val': 0.42181484125324314, 'psi': 0.9245289001560664}
[S17] START round=19 head_norm_before_train=1.040748 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.47177530465127215, 'auprc': 0.6553074592802745, 'loss_val': 0.8910721422986666, 'psi': 0.545188166502873}-{'f1_val': 0.5526635037900236, 'auprc': 0.6350745223996594, 'loss_val': 0.7172403496496701, 'psi': 0.5856279112338779}
[S5] not sending this round → trigger blocked (psi=0.939)
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.994)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.637)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9872
[S17] RECEIVED delta(kind=head bytes=1801) from S7
[S17] cosine check vs S7: cos=0.7031
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=-0.0405
[S8] DROPPED delta from S11 (cos=-0.0405 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=0.5245
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.5744
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.939 u=0.9204 p_local=0.2627 f1=0.902 auprc=0.995 bytes=17935
[S13] r=20 psi=0.637 u=0.0662 p_local=0.0860 f1=0.611 auprc=0.675 bytes=14371
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9936 head_norm=1.300483
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.405092e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9927 head_norm=1.426293 delta_norm=0.840509
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.994 u=0.0001 p_local=0.0922 f1=0.994 auprc=0.995 bytes=16188
[S6] r=20 psi=0.741 u=0.0000 p_local=0.3131 f1=0.634 auprc=0.901 bytes=16170
[S9] r=20 psi=0.997 u=0.0089 p_local=0.1670 f1=0.995 auprc=0.999 bytes=16182
[S15] r=20 psi=0.857 u=0.0000 p_local=0.1858 f1=0.770 auprc=0.988 bytes=16192
[S2] r=20 psi=0.820 u=0.0000 p_local=0.1142 f1=0.713 auprc=0.980 bytes=16178
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9977 head_norm=1.619725
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.312394e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9977 head_norm=1.627813 delta_norm=0.131239
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0209 p_local=0.1608 f1=0.998 auprc=0.999 bytes=14364
[S3] r=20 psi=0.820 u=0.3644 p_local=0.2031 f1=0.700 auprc=1.000 bytes=16173
[S10] r=20 psi=0.995 u=0.0018 p_local=0.0609 f1=0.995 auprc=0.995 bytes=16202
[S7] r=20 psi=0.781 u=1.0000 p_local=0.4428 f1=0.674 auprc=0.942 bytes=17964
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7017 head_norm=1.100620
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.024974e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7017 head_norm=1.254908 delta_norm=0.702497
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.810 u=0.0200 p_local=0.0809 f1=0.702 auprc=0.972 bytes=16161
[S4] r=20 psi=0.957 u=0.0267 p_local=0.0644 f1=0.951 auprc=0.966 bytes=16186
[S16] r=20 psi=0.881 u=0.0000 p_local=0.1693 f1=0.855 auprc=0.921 bytes=16147
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.4718 head_norm=1.112487
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.144092e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.5210 head_norm=0.988409 delta_norm=0.414409
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.545 u=0.0000 p_local=0.1896 f1=0.472 auprc=0.655 bytes=14380
[S2] START round=20 head_norm_before_train=1.955165 (no previous merge yet)
[S2] round=20 local utility u=0.629385 metrics={'f1_val': 0.9122606111654219, 'auprc': 0.9739377561084357, 'loss_val': 0.18208565891485656, 'psi': 0.9369314691426274}-{'f1_val': 0.713199919970541, 'auprc': 0.979746975157735, 'loss_val': 0.2639186539373913, 'psi': 0.8198187420454186}
[S3] START round=20 head_norm_before_train=1.710330 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.6774207718027943, 'auprc': 0.9918609714330755, 'loss_val': 0.3609427052983197, 'psi': 0.8031968516549068}-{'f1_val': 0.69982954919712, 'auprc': 0.9999962526863435, 'loss_val': 0.3158081479030742, 'psi': 0.8198962305928095}
[S4] START round=20 head_norm_before_train=1.946864 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9456262544809472, 'auprc': 0.9470889206334381, 'loss_val': 0.2938452032968716, 'psi': 0.9462113209419436}-{'f1_val': 0.951034200779546, 'auprc': 0.9660179230282269, 'loss_val': 0.2833842934135098, 'psi': 0.9570276896790184}
[S5] START round=20 head_norm_before_train=1.315549 cos_to_last_merge=0.8169 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=20 local utility u=0.198139 metrics={'f1_val': 0.9614815788067936, 'auprc': 0.9959218122876308, 'loss_val': 0.2468282778528685, 'psi': 0.9752576721991284}-{'f1_val': 0.9021356658274201, 'auprc': 0.9947034285754358, 'loss_val': 0.2833750648677503, 'psi': 0.9391627709266264}
[S6] START round=20 head_norm_before_train=1.917411 (no previous merge yet)
[S6] round=20 local utility u=0.719438 metrics={'f1_val': 0.8012898892700989, 'auprc': 0.9371495029204573, 'loss_val': 0.5487359572908523, 'psi': 0.8556337347302423}-{'f1_val': 0.6340119836885676, 'auprc': 0.9009129918825662, 'loss_val': 0.8752358926873945, 'psi': 0.7407723869661671}
[S7] START round=20 head_norm_before_train=1.029441 cos_to_last_merge=0.9996 (last merge round=18)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.42921571132921255, 'auprc': 0.7780947700299722, 'loss_val': 0.9859950286810474, 'psi': 0.5687673348095164}-{'f1_val': 0.673786777402567, 'auprc': 0.9422563226570648, 'loss_val': 0.6132300163462605, 'psi': 0.7811745955043661}
[S8] START round=20 head_norm_before_train=1.426293 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.014894 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.9967151124625803, 'loss_val': 0.0912429390889424, 'psi': 0.9943806832556465}-{'f1_val': 0.993553675737062, 'auprc': 0.9953245623583737, 'loss_val': 0.12123526811079965, 'psi': 0.9942620303855867}
[S9] START round=20 head_norm_before_train=1.572378 cos_to_last_merge=0.8268 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.827
[S9] round=20 local utility u=0.002784 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9995580261551009, 'loss_val': 0.0412834807160171, 'psi': 0.9970697032151773}-{'f1_val': 0.9954158325366191, 'auprc': 0.9994416184306743, 'loss_val': 0.04653204087622767, 'psi': 0.9970261468942412}
[S10] START round=20 head_norm_before_train=1.646356 cos_to_last_merge=0.7658 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.766
[S10] round=20 local utility u=0.000703 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995344383169233, 'loss_val': 0.0380487571440874, 'psi': 0.9951998341133521}-{'f1_val': 0.9953231205637304, 'auprc': 0.9952658147689236, 'loss_val': 0.040537563343744386, 'psi': 0.9953001982458076}
[S11] START round=20 head_norm_before_train=1.254908 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.045602 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9946554410728321, 'loss_val': 0.3524569988370674, 'psi': 0.8188782641812877}-{'f1_val': 0.7016934795869249, 'auprc': 0.9721407341617714, 'loss_val': 0.37611763982253316, 'psi': 0.8098723814168635}
[S13] START round=20 head_norm_before_train=1.178049 cos_to_last_merge=0.9782 (last merge round=16)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5515071474292366, 'auprc': 0.6890809981181945, 'loss_val': 0.7672470364727769, 'psi': 0.6065366877048197}-{'f1_val': 0.6112976149563742, 'auprc': 0.6748889141627549, 'loss_val': 0.6063375268371674, 'psi': 0.6367341346389266}
[S14] START round=20 head_norm_before_train=1.627813 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.004079 metrics={'f1_val': 0.9974331919232962, 'auprc': 0.997481870931858, 'loss_val': 0.10692892136539445, 'psi': 0.9974526635267209}-{'f1_val': 0.9976760408229349, 'auprc': 0.9991925119509374, 'loss_val': 0.12167570878976328, 'psi': 0.998282629274136}
[S15] START round=20 head_norm_before_train=1.416442 cos_to_last_merge=0.9986 (last merge round=18)
[S15] round=20 local utility u=0.775344 metrics={'f1_val': 0.9915886459486265, 'auprc': 0.9925586843363452, 'loss_val': 0.09738873688645423, 'psi': 0.991976661303714}-{'f1_val': 0.7703415804980934, 'auprc': 0.9875973935479693, 'loss_val': 0.30571093834251417, 'psi': 0.8572439057180438}
[S16] START round=20 head_norm_before_train=1.762615 (no previous merge yet)
[S16] round=20 local utility u=0.834235 metrics={'f1_val': 0.9893420961818707, 'auprc': 0.9925417445974389, 'loss_val': 0.0914719311675878, 'psi': 0.990621955548098}-{'f1_val': 0.8545864436954339, 'auprc': 0.9208231097145343, 'loss_val': 0.7362525393521298, 'psi': 0.881081110103074}
[S17] START round=20 head_norm_before_train=0.988409 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.562886 metrics={'f1_val': 0.5716210656899903, 'auprc': 0.7345726155034393, 'loss_val': 0.6021711273299905, 'psi': 0.6368016856153699}-{'f1_val': 0.47177530465127215, 'auprc': 0.6553074592802745, 'loss_val': 0.8910721422986666, 'psi': 0.545188166502873}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:52808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[S11] not sending this round → trigger blocked (psi=0.819)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.5206
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.5382
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.3821
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0881
[S8] DROPPED delta from S2 (cos=-0.0881 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] cosine check vs S5: cos=0.3991
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.9339
[S9] RECEIVED delta(kind=head bytes=1804) from S15
[S9] cosine check vs S15: cos=-0.0632
[S9] DROPPED delta from S15 (cos=-0.0632 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] cosine check vs S16: cos=0.6682
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.8968
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.4292 head_norm=1.047411
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.704082e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.4974 head_norm=1.304941 delta_norm=0.670408
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.354 → S17@127.0.0.1:52817
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.7017 head_norm=1.289715
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.198231e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.7017 head_norm=1.097989 delta_norm=0.719823
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.074 → S8@127.0.0.1:52809
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.5515 head_norm=1.215625
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.695358e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.5564 head_norm=1.105853 delta_norm=0.269536
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.069 → S7@127.0.0.1:52808
[S4] ⇄ pheromone p=0.051 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.162 → S11@127.0.0.1:52812
[S10] ⇄ pheromone p=0.049 → S14@127.0.0.1:52814
[S9] ⇄ pheromone p=0.134 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=0.217 → S8@127.0.0.1:52809
[S6] ⇄ pheromone p=0.394 → S17@127.0.0.1:52817
[S16] ⇄ pheromone p=0.302 → S7@127.0.0.1:52808
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9928 head_norm=1.470401
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.754187e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9928 head_norm=1.304720 delta_norm=0.875419
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.077 → S15@127.0.0.1:52815
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.9916 head_norm=1.475915
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.678519e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.9916 head_norm=1.448605 delta_norm=0.267852
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.304 → S9@127.0.0.1:52810
[S14] ⇄ pheromone p=0.129 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=0.250 → S11@127.0.0.1:52812
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.5716 head_norm=1.055167
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.203095e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.5708 head_norm=1.077561 delta_norm=0.420310
[S17] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.264 → S13@127.0.0.1:52813
[S2] START round=21 head_norm_before_train=1.963323 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.908522667410806, 'auprc': 0.9744475429578807, 'loss_val': 0.23496678147151306, 'psi': 0.9348926176296359}-{'f1_val': 0.9122606111654219, 'auprc': 0.9739377561084357, 'loss_val': 0.18208565891485656, 'psi': 0.9369314691426274}
[S3] START round=21 head_norm_before_train=1.725652 (no previous merge yet)
[S3] round=21 local utility u=0.126492 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.9996229378038344, 'loss_val': 0.2701810021118399, 'psi': 0.8201953565093032}-{'f1_val': 0.6774207718027943, 'auprc': 0.9918609714330755, 'loss_val': 0.3609427052983197, 'psi': 0.8031968516549068}
[S4] START round=21 head_norm_before_train=1.954886 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9428702400228748, 'auprc': 0.9376785874486722, 'loss_val': 0.2991375952632734, 'psi': 0.9407935789931938}-{'f1_val': 0.9456262544809472, 'auprc': 0.9470889206334381, 'loss_val': 0.2938452032968716, 'psi': 0.9462113209419436}
[S5] START round=21 head_norm_before_train=1.335697 cos_to_last_merge=0.8145 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7168194463137841, 'auprc': 0.8433062385263278, 'loss_val': 0.33053977676788143, 'psi': 0.7674141631988016}-{'f1_val': 0.9614815788067936, 'auprc': 0.9959218122876308, 'loss_val': 0.2468282778528685, 'psi': 0.9752576721991284}
[S6] START round=21 head_norm_before_train=1.930483 (no previous merge yet)
[S6] round=21 local utility u=0.039540 metrics={'f1_val': 0.808520060252688, 'auprc': 0.9437785974784619, 'loss_val': 0.5329251832228461, 'psi': 0.8626234751429975}-{'f1_val': 0.8012898892700989, 'auprc': 0.9371495029204573, 'loss_val': 0.5487359572908523, 'psi': 0.8556337347302423}
[S7] START round=21 head_norm_before_train=1.304941 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.784159 metrics={'f1_val': 0.5877530082858207, 'auprc': 0.8856919464013516, 'loss_val': 0.69169223063066, 'psi': 0.7069285835320331}-{'f1_val': 0.42921571132921255, 'auprc': 0.7780947700299722, 'loss_val': 0.9859950286810474, 'psi': 0.5687673348095164}
[S8] START round=21 head_norm_before_train=1.304720 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9934014766727588, 'auprc': 0.9944073608366085, 'loss_val': 0.09988963283707213, 'psi': 0.9938038303382987}-{'f1_val': 0.9928243971176908, 'auprc': 0.9967151124625803, 'loss_val': 0.0912429390889424, 'psi': 0.9943806832556465}
[S9] START round=21 head_norm_before_train=1.599735 cos_to_last_merge=0.8212 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.9995631080757488, 'loss_val': 0.04898885764545631, 'psi': 0.9937925437354265}-{'f1_val': 0.9954108212552283, 'auprc': 0.9995580261551009, 'loss_val': 0.0412834807160171, 'psi': 0.9970697032151773}
[S10] START round=21 head_norm_before_train=1.668683 cos_to_last_merge=0.7637 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.764
[S10] round=21 local utility u=0.001263 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9953380245427453, 'loss_val': 0.03550334866089411, 'psi': 0.9951972906627571}-{'f1_val': 0.9951034680760983, 'auprc': 0.995344383169233, 'loss_val': 0.0380487571440874, 'psi': 0.9951998341133521}
[S11] START round=21 head_norm_before_train=1.097989 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.005502 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9949977985357925, 'loss_val': 0.3420893451174044, 'psi': 0.8189760887528599}-{'f1_val': 0.7016934795869249, 'auprc': 0.9946554410728321, 'loss_val': 0.3524569988370674, 'psi': 0.8188782641812877}
[S13] START round=21 head_norm_before_train=1.105853 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5387497362694942, 'auprc': 0.7032093425182089, 'loss_val': 0.7875667566435431, 'psi': 0.6045335787689801}-{'f1_val': 0.5515071474292366, 'auprc': 0.6890809981181945, 'loss_val': 0.7672470364727769, 'psi': 0.6065366877048197}
[S14] START round=21 head_norm_before_train=1.665901 cos_to_last_merge=0.9995 (last merge round=19)
[S14] round=21 local utility u=0.016665 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9991423301164213, 'loss_val': 0.08003724734103083, 'psi': 0.9982625565403296}-{'f1_val': 0.9974331919232962, 'auprc': 0.997481870931858, 'loss_val': 0.10692892136539445, 'psi': 0.9974526635267209}
[S15] START round=21 head_norm_before_train=1.448605 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7373628365633047, 'auprc': 0.9886950515770555, 'loss_val': 0.3544642324860845, 'psi': 0.8378957225688051}-{'f1_val': 0.9915886459486265, 'auprc': 0.9925586843363452, 'loss_val': 0.09738873688645423, 'psi': 0.991976661303714}
[S16] START round=21 head_norm_before_train=1.790969 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9022360992702689, 'auprc': 0.9845327262116532, 'loss_val': 0.3865882621986094, 'psi': 0.9351547500468226}-{'f1_val': 0.9893420961818707, 'auprc': 0.9925417445974389, 'loss_val': 0.0914719311675878, 'psi': 0.990621955548098}
[S17] START round=21 head_norm_before_train=1.077561 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5306554036008027, 'auprc': 0.7365872953593411, 'loss_val': 0.6144313990089123, 'psi': 0.613028160304218}-{'f1_val': 0.5716210656899903, 'auprc': 0.7345726155034393, 'loss_val': 0.6021711273299905, 'psi': 0.6368016856153699}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S6] not sending this round → trigger blocked (psi=0.863)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:52814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S7
[S17] cosine check vs S7: cos=0.3872
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] cosine check vs S11: cos=-0.0390
[S8] DROPPED delta from S11 (cos=-0.0390 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.5708
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9905
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9977 head_norm=1.701474
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.169307e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9977 head_norm=1.692516 delta_norm=0.116931
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.7016 head_norm=1.128659
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.182869e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.7016 head_norm=1.279885 delta_norm=0.718287
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.5307 head_norm=1.136719
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.844717e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.5785 head_norm=1.024650 delta_norm=0.684472
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.969876 (no previous merge yet)
[S2] round=22 local utility u=0.018572 metrics={'f1_val': 0.9106257590081188, 'auprc': 0.977671556051017, 'loss_val': 0.220113165289531, 'psi': 0.9374440778252782}-{'f1_val': 0.908522667410806, 'auprc': 0.9744475429578807, 'loss_val': 0.23496678147151306, 'psi': 0.9348926176296359}
[S3] START round=22 head_norm_before_train=1.741899 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.6930115195667043, 'auprc': 0.9919658021161586, 'loss_val': 0.3257977987498091, 'psi': 0.812593232586486}-{'f1_val': 0.7005769689796157, 'auprc': 0.9996229378038344, 'loss_val': 0.2701810021118399, 'psi': 0.8201953565093032}
[S4] START round=22 head_norm_before_train=1.961337 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9396051362493765, 'auprc': 0.931723607346894, 'loss_val': 0.3155238774193721, 'psi': 0.9364525246883835}-{'f1_val': 0.9428702400228748, 'auprc': 0.9376785874486722, 'loss_val': 0.2991375952632734, 'psi': 0.9407935789931938}
[S5] START round=22 head_norm_before_train=1.352502 cos_to_last_merge=0.8138 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=22 local utility u=1.000000 metrics={'f1_val': 0.9570535106097666, 'auprc': 0.9975159695700748, 'loss_val': 0.2169262841215813, 'psi': 0.9732384941938899}-{'f1_val': 0.7168194463137841, 'auprc': 0.8433062385263278, 'loss_val': 0.33053977676788143, 'psi': 0.7674141631988016}
[S6] START round=22 head_norm_before_train=1.947529 (no previous merge yet)
[S6] round=22 local utility u=0.086486 metrics={'f1_val': 0.8037953405433019, 'auprc': 0.9590777063291858, 'loss_val': 0.3775016547551736, 'psi': 0.8659082868576555}-{'f1_val': 0.808520060252688, 'auprc': 0.9437785974784619, 'loss_val': 0.5329251832228461, 'psi': 0.8626234751429975}
[S7] START round=22 head_norm_before_train=1.320867 cos_to_last_merge=0.9997 (last merge round=20)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.4108059273949596, 'auprc': 0.7807494171566949, 'loss_val': 0.9766017074792867, 'psi': 0.5587833232996537}-{'f1_val': 0.5877530082858207, 'auprc': 0.8856919464013516, 'loss_val': 0.69169223063066, 'psi': 0.7069285835320331}
[S8] START round=22 head_norm_before_train=1.359627 cos_to_last_merge=0.9985 (last merge round=20)
[S8] round=22 local utility u=0.015263 metrics={'f1_val': 0.994132812741702, 'auprc': 0.9954789198510176, 'loss_val': 0.07696654440000614, 'psi': 0.9946712555854282}-{'f1_val': 0.9934014766727588, 'auprc': 0.9944073608366085, 'loss_val': 0.09988963283707213, 'psi': 0.9938038303382987}
[S9] START round=22 head_norm_before_train=1.621162 cos_to_last_merge=0.8175 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.817
[S9] round=22 local utility u=0.024445 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9974040544337992, 'loss_val': 0.033912664639454734, 'psi': 0.9969579288618545}-{'f1_val': 0.9899455008418782, 'auprc': 0.9995631080757488, 'loss_val': 0.04898885764545631, 'psi': 0.9937925437354265}
[S10] START round=22 head_norm_before_train=1.691614 cos_to_last_merge=0.7617 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.762
[S10] round=22 local utility u=0.001023 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9953461222575767, 'loss_val': 0.03348143775657748, 'psi': 0.9952005297486897}-{'f1_val': 0.9951034680760983, 'auprc': 0.9953380245427453, 'loss_val': 0.03550334866089411, 'psi': 0.9951972906627571}
[S11] START round=22 head_norm_before_train=1.279885 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.021644 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9949164876589389, 'loss_val': 0.2985583330940718, 'psi': 0.8189435644021184}-{'f1_val': 0.7016282822309048, 'auprc': 0.9949977985357925, 'loss_val': 0.3420893451174044, 'psi': 0.8189760887528599}
[S13] START round=22 head_norm_before_train=1.144621 cos_to_last_merge=0.9992 (last merge round=20)
[S13] round=22 local utility u=0.201118 metrics={'f1_val': 0.5867799672947905, 'auprc': 0.6987908721275238, 'loss_val': 0.6602558933444262, 'psi': 0.6315843292278838}-{'f1_val': 0.5387497362694942, 'auprc': 0.7032093425182089, 'loss_val': 0.7875667566435431, 'psi': 0.6045335787689801}
[S14] START round=22 head_norm_before_train=1.692516 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000323 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9976975526416647, 'loss_val': 0.0734666924176375, 'psi': 0.9975256176173628}-{'f1_val': 0.9976760408229349, 'auprc': 0.9991423301164213, 'loss_val': 0.08003724734103083, 'psi': 0.9982625565403296}
[S15] START round=22 head_norm_before_train=1.499616 cos_to_last_merge=0.9988 (last merge round=20)
[S15] round=22 local utility u=0.441679 metrics={'f1_val': 0.859222649786536, 'auprc': 0.9897494371753888, 'loss_val': 0.20542775082602072, 'psi': 0.9114333647420771}-{'f1_val': 0.7373628365633047, 'auprc': 0.9886950515770555, 'loss_val': 0.3544642324860845, 'psi': 0.8378957225688051}
[S16] START round=22 head_norm_before_train=1.816654 (no previous merge yet)
[S16] round=22 local utility u=0.445624 metrics={'f1_val': 0.992600746330694, 'auprc': 0.9920226931179543, 'loss_val': 0.05999745476483191, 'psi': 0.992369525045598}-{'f1_val': 0.9022360992702689, 'auprc': 0.9845327262116532, 'loss_val': 0.3865882621986094, 'psi': 0.9351547500468226}
[S17] START round=22 head_norm_before_train=1.024650 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.5172571890669514, 'auprc': 0.6146887040709414, 'loss_val': 0.7498939711318636, 'psi': 0.5562297950685474}-{'f1_val': 0.5306554036008027, 'auprc': 0.7365872953593411, 'loss_val': 0.6144313990089123, 'psi': 0.613028160304218}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:52808
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:52817
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S11] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1806) from S9
[S17] cosine check vs S9: cos=0.4233
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.4310
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0245
[S8] DROPPED delta from S2 (cos=-0.0245 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S5
[S11] cosine check vs S5: cos=0.4056
[S15] RECEIVED delta(kind=head bytes=1806) from S8
[S15] cosine check vs S8: cos=0.8543
[S9] RECEIVED delta(kind=head bytes=1805) from S15
[S9] cosine check vs S15: cos=-0.0484
[S9] DROPPED delta from S15 (cos=-0.0484 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.9445
[S7] RECEIVED delta(kind=head bytes=1805) from S13
[S7] cosine check vs S13: cos=0.5454
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.8342
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.4108 head_norm=1.336246
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.399398e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.4139 head_norm=1.272161 delta_norm=0.139940
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.7016 head_norm=1.312837
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.305824e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.8004 head_norm=1.123001 delta_norm=0.730582
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9941 head_norm=1.411071
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.762782e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9941 head_norm=1.502987 delta_norm=0.476278
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.8592 head_norm=1.551106
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.054138e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.8667 head_norm=1.426242 delta_norm=0.405414
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.5173 head_norm=1.085590
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.321026e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.5179 head_norm=1.058311 delta_norm=0.532103
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.982112 (no previous merge yet)
[S2] round=23 local utility u=0.032912 metrics={'f1_val': 0.9140794377501885, 'auprc': 0.9749612175321805, 'loss_val': 0.166879463772531, 'psi': 0.9384321496629853}-{'f1_val': 0.9106257590081188, 'auprc': 0.977671556051017, 'loss_val': 0.220113165289531, 'psi': 0.9374440778252782}
[S3] START round=23 head_norm_before_train=1.754042 (no previous merge yet)
[S3] round=23 local utility u=0.068776 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.999617982794388, 'loss_val': 0.2581231559299446, 'psi': 0.8203462341330416}-{'f1_val': 0.6930115195667043, 'auprc': 0.9919658021161586, 'loss_val': 0.3257977987498091, 'psi': 0.812593232586486}
[S4] START round=23 head_norm_before_train=1.975001 (no previous merge yet)
[S4] round=23 local utility u=0.009708 metrics={'f1_val': 0.9415686590927731, 'auprc': 0.9317514523679093, 'loss_val': 0.30797302912551305, 'psi': 0.9376417764028275}-{'f1_val': 0.9396051362493765, 'auprc': 0.931723607346894, 'loss_val': 0.3155238774193721, 'psi': 0.9364525246883835}
[S5] START round=23 head_norm_before_train=1.366097 cos_to_last_merge=0.8131 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=23 local utility u=0.129900 metrics={'f1_val': 0.9967731002659072, 'auprc': 0.9975977259738472, 'loss_val': 0.19568883263092518, 'psi': 0.9971029505490832}-{'f1_val': 0.9570535106097666, 'auprc': 0.9975159695700748, 'loss_val': 0.2169262841215813, 'psi': 0.9732384941938899}
[S6] START round=23 head_norm_before_train=1.967264 (no previous merge yet)
[S6] round=23 local utility u=0.029348 metrics={'f1_val': 0.8212366629991361, 'auprc': 0.9585221895892658, 'loss_val': 0.4217878803158001, 'psi': 0.876150873635188}-{'f1_val': 0.8037953405433019, 'auprc': 0.9590777063291858, 'loss_val': 0.3775016547551736, 'psi': 0.8659082868576555}
[S7] START round=23 head_norm_before_train=1.272161 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.893120 metrics={'f1_val': 0.627591703707172, 'auprc': 0.8227862468328849, 'loss_val': 0.6171869897673384, 'psi': 0.7056695209574573}-{'f1_val': 0.4108059273949596, 'auprc': 0.7807494171566949, 'loss_val': 0.9766017074792867, 'psi': 0.5587833232996537}
[S8] START round=23 head_norm_before_train=1.502987 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9942782421240355, 'auprc': 0.9959071738199166, 'loss_val': 0.0876918197133372, 'psi': 0.9949298148023878}-{'f1_val': 0.994132812741702, 'auprc': 0.9954789198510176, 'loss_val': 0.07696654440000614, 'psi': 0.9946712555854282}
[S9] START round=23 head_norm_before_train=1.639100 cos_to_last_merge=0.8147 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.815
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.99654724040428, 'loss_val': 0.05108592947025335, 'psi': 0.992586196666839}-{'f1_val': 0.9966605118138915, 'auprc': 0.9974040544337992, 'loss_val': 0.033912664639454734, 'psi': 0.9969579288618545}
[S10] START round=23 head_norm_before_train=1.708223 cos_to_last_merge=0.7603 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.760
[S10] round=23 local utility u=0.000537 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995364458158955, 'loss_val': 0.03246145608314807, 'psi': 0.995207864109241}-{'f1_val': 0.9951034680760983, 'auprc': 0.9953461222575767, 'loss_val': 0.03348143775657748, 'psi': 0.9952005297486897}
[S11] START round=23 head_norm_before_train=1.123001 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.788921 metrics={'f1_val': 0.957891123412056, 'auprc': 0.997812101902159, 'loss_val': 0.2669794789345489, 'psi': 0.9738595148080972}-{'f1_val': 0.7016282822309048, 'auprc': 0.9949164876589389, 'loss_val': 0.2985583330940718, 'psi': 0.8189435644021184}
[S13] START round=23 head_norm_before_train=1.198286 cos_to_last_merge=0.9961 (last merge round=20)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5892242197041702, 'auprc': 0.7082854395668727, 'loss_val': 0.7609526283931404, 'psi': 0.6368487076492513}-{'f1_val': 0.5867799672947905, 'auprc': 0.6987908721275238, 'loss_val': 0.6602558933444262, 'psi': 0.6315843292278838}
[S14] START round=23 head_norm_before_train=1.726412 cos_to_last_merge=0.9997 (last merge round=21)
[S14] round=23 local utility u=0.008311 metrics={'f1_val': 0.9970229111636145, 'auprc': 0.9989386710611342, 'loss_val': 0.05823917636209139, 'psi': 0.9977892151226224}-{'f1_val': 0.9974109942678281, 'auprc': 0.9976975526416647, 'loss_val': 0.0734666924176375, 'psi': 0.9975256176173628}
[S15] START round=23 head_norm_before_train=1.426242 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.8300879550128588, 'auprc': 0.9909332199707747, 'loss_val': 0.23592247401650274, 'psi': 0.8944260609960252}-{'f1_val': 0.859222649786536, 'auprc': 0.9897494371753888, 'loss_val': 0.20542775082602072, 'psi': 0.9114333647420771}
[S16] START round=23 head_norm_before_train=1.841699 (no previous merge yet)
[S16] round=23 local utility u=0.003909 metrics={'f1_val': 0.9921627897003097, 'auprc': 0.9926836033122179, 'loss_val': 0.05153371688435539, 'psi': 0.992371115145073}-{'f1_val': 0.992600746330694, 'auprc': 0.9920226931179543, 'loss_val': 0.05999745476483191, 'psi': 0.992369525045598}
[S17] START round=23 head_norm_before_train=1.058311 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.44627424671775695, 'auprc': 0.6089432923011555, 'loss_val': 0.8929982738086627, 'psi': 0.5113418649511163}-{'f1_val': 0.5172571890669514, 'auprc': 0.6146887040709414, 'loss_val': 0.7498939711318636, 'psi': 0.5562297950685474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:52817
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9931
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=0.6763
[S17] RECEIVED delta(kind=head bytes=1793) from S7
[S17] cosine check vs S7: cos=0.5624
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.9574
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=0.2576
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=-0.0536
[S8] DROPPED delta from S11 (cos=-0.0536 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=0.0124
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] cosine check vs S3: cos=0.5722
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] cosine check vs S5: cos=0.8376
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.9145
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9943 head_norm=1.548286
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.008619e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9943 head_norm=1.233446 delta_norm=0.500862
[S8] aggregate: ACCEPT kept=['S14', 'S4', 'S2'] (k=3/3) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9579 head_norm=1.160445
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.904015e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9584 head_norm=1.136215 delta_norm=0.190402
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9970 head_norm=1.760440
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.035909e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9970 head_norm=1.740665 delta_norm=0.103591
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6276 head_norm=1.283601
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.313155e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6703 head_norm=1.540206 delta_norm=0.431316
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.4463 head_norm=1.128673
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.448152e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.4460 head_norm=1.132936 delta_norm=0.344815
[S17] aggregate: ACCEPT kept=['S6', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.999494 (no previous merge yet)
[S2] round=24 local utility u=0.236511 metrics={'f1_val': 0.9883435730226275, 'auprc': 0.9642400144452398, 'loss_val': 0.10727826472086939, 'psi': 0.9787021495916725}-{'f1_val': 0.9140794377501885, 'auprc': 0.9749612175321805, 'loss_val': 0.166879463772531, 'psi': 0.9384321496629853}
[S3] START round=24 head_norm_before_train=1.764437 (no previous merge yet)
[S3] round=24 local utility u=0.003578 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9999978867738224, 'loss_val': 0.2521077566646326, 'psi': 0.8204981957248154}-{'f1_val': 0.7008317350254774, 'auprc': 0.999617982794388, 'loss_val': 0.2581231559299446, 'psi': 0.8203462341330416}
[S4] START round=24 head_norm_before_train=1.968555 (no previous merge yet)
[S4] round=24 local utility u=0.084350 metrics={'f1_val': 0.9541184057782852, 'auprc': 0.9582290665961667, 'loss_val': 0.29400503654790466, 'psi': 0.9557626701054378}-{'f1_val': 0.9415686590927731, 'auprc': 0.9317514523679093, 'loss_val': 0.30797302912551305, 'psi': 0.9376417764028275}
[S5] START round=24 head_norm_before_train=1.376466 cos_to_last_merge=0.8122 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.812
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.9475860038308694, 'auprc': 0.994762867734646, 'loss_val': 0.19608607094203587, 'psi': 0.96645674939238}-{'f1_val': 0.9967731002659072, 'auprc': 0.9975977259738472, 'loss_val': 0.19568883263092518, 'psi': 0.9971029505490832}
[S6] START round=24 head_norm_before_train=1.984137 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7213077337397864, 'auprc': 0.8076618004610308, 'loss_val': 0.8537497288895225, 'psi': 0.7558493604282841}-{'f1_val': 0.8212366629991361, 'auprc': 0.9585221895892658, 'loss_val': 0.4217878803158001, 'psi': 0.876150873635188}
[S7] START round=24 head_norm_before_train=1.540206 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5092887356641309, 'auprc': 0.787543923313726, 'loss_val': 0.8744676426726217, 'psi': 0.6205908107239689}-{'f1_val': 0.627591703707172, 'auprc': 0.8227862468328849, 'loss_val': 0.6171869897673384, 'psi': 0.7056695209574573}
[S8] START round=24 head_norm_before_train=1.233446 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9917345774119155, 'auprc': 0.9981376009470093, 'loss_val': 0.11315773436147168, 'psi': 0.9942957868259531}-{'f1_val': 0.9942782421240355, 'auprc': 0.9959071738199166, 'loss_val': 0.0876918197133372, 'psi': 0.9949298148023878}
[S9] START round=24 head_norm_before_train=1.655775 cos_to_last_merge=0.8128 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.813
[S9] round=24 local utility u=0.034215 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9989667155934943, 'loss_val': 0.030204844276184088, 'psi': 0.9975829933257325}-{'f1_val': 0.9899455008418782, 'auprc': 0.99654724040428, 'loss_val': 0.05108592947025335, 'psi': 0.992586196666839}
[S10] START round=24 head_norm_before_train=1.726888 cos_to_last_merge=0.7586 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.759
[S10] round=24 local utility u=0.000370 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9954014861516296, 'loss_val': 0.03183299927285723, 'psi': 0.9952226753063108}-{'f1_val': 0.9951034680760983, 'auprc': 0.995364458158955, 'loss_val': 0.03246145608314807, 'psi': 0.995207864109241}
[S11] START round=24 head_norm_before_train=1.136215 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.123300 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976980828119208, 'loss_val': 0.25052121383558673, 'psi': 0.9968623336060849}-{'f1_val': 0.957891123412056, 'auprc': 0.997812101902159, 'loss_val': 0.2669794789345489, 'psi': 0.9738595148080972}
[S13] START round=24 head_norm_before_train=1.243674 cos_to_last_merge=0.9925 (last merge round=20)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5572216193976789, 'auprc': 0.7074418635019206, 'loss_val': 0.7221761051018816, 'psi': 0.6173097170393755}-{'f1_val': 0.5892242197041702, 'auprc': 0.7082854395668727, 'loss_val': 0.7609526283931404, 'psi': 0.6368487076492513}
[S14] START round=24 head_norm_before_train=1.740665 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9972219862485123, 'loss_val': 0.06110922322714956, 'psi': 0.997087299394004}-{'f1_val': 0.9970229111636145, 'auprc': 0.9989386710611342, 'loss_val': 0.05823917636209139, 'psi': 0.9977892151226224}
[S15] START round=24 head_norm_before_train=1.481487 cos_to_last_merge=0.9989 (last merge round=22)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7727925385525887, 'auprc': 0.9889494616565261, 'loss_val': 0.3352504575286342, 'psi': 0.8592553077941636}-{'f1_val': 0.8300879550128588, 'auprc': 0.9909332199707747, 'loss_val': 0.23592247401650274, 'psi': 0.8944260609960252}
[S16] START round=24 head_norm_before_train=1.862499 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9779367611846871, 'auprc': 0.9930077677816925, 'loss_val': 0.088598844195931, 'psi': 0.9839651638234893}-{'f1_val': 0.9921627897003097, 'auprc': 0.9926836033122179, 'loss_val': 0.05153371688435539, 'psi': 0.992371115145073}
[S17] START round=24 head_norm_before_train=1.132936 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.905447 metrics={'f1_val': 0.6353993803629108, 'auprc': 0.7755377106941653, 'loss_val': 0.7166392197535193, 'psi': 0.6914547124954126}-{'f1_val': 0.44627424671775695, 'auprc': 0.6089432923011555, 'loss_val': 0.8929982738086627, 'psi': 0.5113418649511163}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:52812
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9969
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.3449
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.2309
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=0.3868
[S8] RECEIVED delta(kind=head bytes=1797) from S11
[S8] cosine check vs S11: cos=0.0124
[S11] RECEIVED delta(kind=head bytes=1805) from S3
[S11] cosine check vs S3: cos=0.6937
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.7993
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9917 head_norm=1.292669
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.962309e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9914 head_norm=0.916369 delta_norm=0.696231
[S8] aggregate: ACCEPT kept=['S2', 'S4', 'S11'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9970 head_norm=1.768089
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.965233e-02
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9970 head_norm=1.755600 delta_norm=0.069652
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5572 head_norm=1.283902
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.948808e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5557 head_norm=1.175818 delta_norm=0.394881
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9963 head_norm=1.172185
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.421155e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9942 head_norm=1.363932 delta_norm=0.642115
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.6354 head_norm=1.195222
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.429501e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.5470 head_norm=1.182952 delta_norm=0.842950
[S17] aggregate: ROLLBACK (f1_val pre=0.635 post=0.547 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=2.018974 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.9131158426704998, 'auprc': 0.9709461038110219, 'loss_val': 0.21477298661816688, 'psi': 0.9362479471267087}-{'f1_val': 0.9883435730226275, 'auprc': 0.9642400144452398, 'loss_val': 0.10727826472086939, 'psi': 0.9787021495916725}
[S3] START round=25 head_norm_before_train=1.780794 (no previous merge yet)
[S3] round=25 local utility u=0.007546 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9999579489446819, 'loss_val': 0.23689514827470082, 'psi': 0.8204822205931592}-{'f1_val': 0.7008317350254774, 'auprc': 0.9999978867738224, 'loss_val': 0.2521077566646326, 'psi': 0.8204981957248154}
[S4] START round=25 head_norm_before_train=1.974459 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9409105263183927, 'auprc': 0.9275712933928262, 'loss_val': 0.30932154732846306, 'psi': 0.935574833148166}-{'f1_val': 0.9541184057782852, 'auprc': 0.9582290665961667, 'loss_val': 0.29400503654790466, 'psi': 0.9557626701054378}
[S5] START round=25 head_norm_before_train=1.388041 cos_to_last_merge=0.8118 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.812
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7145982412546548, 'auprc': 0.9551576990829104, 'loss_val': 0.2990347233385363, 'psi': 0.810822024385957}-{'f1_val': 0.9475860038308694, 'auprc': 0.994762867734646, 'loss_val': 0.19608607094203587, 'psi': 0.96645674939238}
[S6] START round=25 head_norm_before_train=1.990815 (no previous merge yet)
[S6] round=25 local utility u=0.715779 metrics={'f1_val': 0.8321627974352513, 'auprc': 0.9541052908367521, 'loss_val': 0.5266520885074408, 'psi': 0.8809397947958517}-{'f1_val': 0.7213077337397864, 'auprc': 0.8076618004610308, 'loss_val': 0.8537497288895225, 'psi': 0.7558493604282841}
[S7] START round=25 head_norm_before_train=1.548797 cos_to_last_merge=0.9999 (last merge round=23)
[S7] round=25 local utility u=0.855097 metrics={'f1_val': 0.6821531932230998, 'auprc': 0.8844136563535996, 'loss_val': 0.4920694146710958, 'psi': 0.7630573784752996}-{'f1_val': 0.5092887356641309, 'auprc': 0.787543923313726, 'loss_val': 0.8744676426726217, 'psi': 0.6205908107239689}
[S8] START round=25 head_norm_before_train=0.916369 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.994132812741702, 'auprc': 0.9958592613261028, 'loss_val': 0.23227448156574634, 'psi': 0.9948233921754623}-{'f1_val': 0.9917345774119155, 'auprc': 0.9981376009470093, 'loss_val': 0.11315773436147168, 'psi': 0.9942957868259531}
[S9] START round=25 head_norm_before_train=1.670726 cos_to_last_merge=0.8108 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.811
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9989452186184515, 'loss_val': 0.02980554774374695, 'psi': 0.9973407048856243}-{'f1_val': 0.9966605118138915, 'auprc': 0.9989667155934943, 'loss_val': 0.030204844276184088, 'psi': 0.9975829933257325}
[S10] START round=25 head_norm_before_train=1.745803 cos_to_last_merge=0.7570 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.757
[S10] round=25 local utility u=0.002187 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9954846367063075, 'loss_val': 0.030197828492753195, 'psi': 0.9955048377641161}-{'f1_val': 0.9951034680760983, 'auprc': 0.9954014861516296, 'loss_val': 0.03183299927285723, 'psi': 0.9952226753063108}
[S11] START round=25 head_norm_before_train=1.363932 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9586927636075923, 'auprc': 0.9963890778579628, 'loss_val': 0.30601531695477135, 'psi': 0.9737712893077405}-{'f1_val': 0.996305167468861, 'auprc': 0.9976980828119208, 'loss_val': 0.25052121383558673, 'psi': 0.9968623336060849}
[S13] START round=25 head_norm_before_train=1.175818 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.247752 metrics={'f1_val': 0.6273284355093929, 'auprc': 0.7233886064624433, 'loss_val': 0.6951532026484019, 'psi': 0.665752503890613}-{'f1_val': 0.5572216193976789, 'auprc': 0.7074418635019206, 'loss_val': 0.7221761051018816, 'psi': 0.6173097170393755}
[S14] START round=25 head_norm_before_train=1.755600 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.003152 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.997281372613296, 'loss_val': 0.057463742047798534, 'psi': 0.9973591456060154}-{'f1_val': 0.9969975081576651, 'auprc': 0.9972219862485123, 'loss_val': 0.06110922322714956, 'psi': 0.997087299394004}
[S15] START round=25 head_norm_before_train=1.544531 cos_to_last_merge=0.9958 (last merge round=22)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7001340338733335, 'auprc': 0.9364122870479579, 'loss_val': 0.46837699715338493, 'psi': 0.7946453351431833}-{'f1_val': 0.7727925385525887, 'auprc': 0.9889494616565261, 'loss_val': 0.3352504575286342, 'psi': 0.8592553077941636}
[S16] START round=25 head_norm_before_train=1.878977 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.893003187209306, 'auprc': 0.9860260215627306, 'loss_val': 0.43417363234986944, 'psi': 0.9302123209506759}-{'f1_val': 0.9779367611846871, 'auprc': 0.9930077677816925, 'loss_val': 0.088598844195931, 'psi': 0.9839651638234893}
[S17] START round=25 head_norm_before_train=1.182952 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5815834651077229, 'auprc': 0.6159497083025934, 'loss_val': 1.0637057210065364, 'psi': 0.5953299623856712}-{'f1_val': 0.6353993803629108, 'auprc': 0.7755377106941653, 'loss_val': 0.7166392197535193, 'psi': 0.6914547124954126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] cosine check vs S3: cos=0.9460
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=0.6151
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.4498
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9984
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.4065
[S17] RECEIVED delta(kind=head bytes=1802) from S7
[S17] cosine check vs S7: cos=0.2867
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.145 → S9@127.0.0.1:52810
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9587 head_norm=1.395337
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.304728e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9929 head_norm=1.577332 delta_norm=0.330473
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.148 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=0.201 → S11@127.0.0.1:52812
[S4] ⇄ pheromone p=0.032 → S8@127.0.0.1:52809
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9941 head_norm=0.991711
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.026523e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9945 head_norm=1.256199 delta_norm=0.702652
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.027 → S15@127.0.0.1:52815
[S9] ⇄ pheromone p=0.052 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=0.115 → S8@127.0.0.1:52809
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6822 head_norm=1.557771
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.443086e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6768 head_norm=1.189932 delta_norm=0.744309
[S7] aggregate: ROLLBACK (f1_val pre=0.682 post=0.677 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.466 → S17@127.0.0.1:52817
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9974 head_norm=1.777644
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.005046e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9970 head_norm=1.770128 delta_norm=0.050050
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.046 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.074 → S11@127.0.0.1:52812
[S10] ⇄ pheromone p=0.017 → S14@127.0.0.1:52814
[S6] ⇄ pheromone p=0.288 → S17@127.0.0.1:52817
[S13] ⇄ pheromone p=0.093 → S7@127.0.0.1:52808
[S16] ⇄ pheromone p=0.145 → S7@127.0.0.1:52808
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.5816 head_norm=1.232419
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.207538e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.5269 head_norm=1.078166 delta_norm=0.620754
[S17] aggregate: ROLLBACK (f1_val pre=0.582 post=0.527 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.231 → S13@127.0.0.1:52813
[S2] START round=26 head_norm_before_train=2.034832 (no previous merge yet)
[S2] round=26 local utility u=0.030374 metrics={'f1_val': 0.9144272598701505, 'auprc': 0.9748343046116155, 'loss_val': 0.17355814222162388, 'psi': 0.9385900777667364}-{'f1_val': 0.9131158426704998, 'auprc': 0.9709461038110219, 'loss_val': 0.21477298661816688, 'psi': 0.9362479471267087}
[S3] START round=26 head_norm_before_train=1.802058 (no previous merge yet)
[S3] round=26 local utility u=0.023918 metrics={'f1_val': 0.703143065141181, 'auprc': 0.9998738654143058, 'loss_val': 0.20267388605408346, 'psi': 0.8218353852504309}-{'f1_val': 0.7008317350254774, 'auprc': 0.9999579489446819, 'loss_val': 0.23689514827470082, 'psi': 0.8204822205931592}
[S4] START round=26 head_norm_before_train=1.981638 (no previous merge yet)
[S4] round=26 local utility u=0.018477 metrics={'f1_val': 0.9404884214543169, 'auprc': 0.9405878811321873, 'loss_val': 0.3088850527370756, 'psi': 0.9405282053254651}-{'f1_val': 0.9409105263183927, 'auprc': 0.9275712933928262, 'loss_val': 0.30932154732846306, 'psi': 0.935574833148166}
[S5] START round=26 head_norm_before_train=1.403596 cos_to_last_merge=0.8111 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=26 local utility u=0.756490 metrics={'f1_val': 0.9255811065553711, 'auprc': 0.9948932834548111, 'loss_val': 0.1711576801722978, 'psi': 0.9533059773151471}-{'f1_val': 0.7145982412546548, 'auprc': 0.9551576990829104, 'loss_val': 0.2990347233385363, 'psi': 0.810822024385957}
[S6] START round=26 head_norm_before_train=2.003602 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.5462492514523708, 'auprc': 0.7238117617217128, 'loss_val': 1.3239299592846738, 'psi': 0.6172742555601076}-{'f1_val': 0.8321627974352513, 'auprc': 0.9541052908367521, 'loss_val': 0.5266520885074408, 'psi': 0.8809397947958517}
[S7] START round=26 head_norm_before_train=1.189932 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5837736687999577, 'auprc': 0.7954658994521544, 'loss_val': 0.7001504857311445, 'psi': 0.6684505610608364}-{'f1_val': 0.6821531932230998, 'auprc': 0.8844136563535996, 'loss_val': 0.4920694146710958, 'psi': 0.7630573784752996}
[S8] START round=26 head_norm_before_train=1.256199 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.061686 metrics={'f1_val': 0.9946453664677153, 'auprc': 0.9948215706303031, 'loss_val': 0.10886464252319679, 'psi': 0.9947158481327504}-{'f1_val': 0.994132812741702, 'auprc': 0.9958592613261028, 'loss_val': 0.23227448156574634, 'psi': 0.9948233921754623}
[S9] START round=26 head_norm_before_train=1.682136 cos_to_last_merge=0.8089 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.809
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9989433807401649, 'loss_val': 0.04460432078312732, 'psi': 0.9930546881420461}-{'f1_val': 0.9962710290637395, 'auprc': 0.9989452186184515, 'loss_val': 0.02980554774374695, 'psi': 0.9973407048856243}
[S10] START round=26 head_norm_before_train=1.764000 cos_to_last_merge=0.7555 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.756
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9954951094866364, 'loss_val': 0.029609327399056206, 'psi': 0.9952601246403135}-{'f1_val': 0.9955183051359886, 'auprc': 0.9954846367063075, 'loss_val': 0.030197828492753195, 'psi': 0.9955048377641161}
[S11] START round=26 head_norm_before_train=1.577332 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.158940 metrics={'f1_val': 0.995050363072499, 'auprc': 0.9913365024426691, 'loss_val': 0.19112261123273303, 'psi': 0.993564818820567}-{'f1_val': 0.9586927636075923, 'auprc': 0.9963890778579628, 'loss_val': 0.30601531695477135, 'psi': 0.9737712893077405}
[S13] START round=26 head_norm_before_train=1.230128 cos_to_last_merge=0.9981 (last merge round=24)
[S13] round=26 local utility u=0.094181 metrics={'f1_val': 0.652800089056645, 'auprc': 0.7174773893375449, 'loss_val': 0.6418883236230806, 'psi': 0.6786710091690049}-{'f1_val': 0.6273284355093929, 'auprc': 0.7233886064624433, 'loss_val': 0.6951532026484019, 'psi': 0.665752503890613}
[S14] START round=26 head_norm_before_train=1.770128 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.001231 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9973157546925644, 'loss_val': 0.05654619915597078, 'psi': 0.997516972706938}-{'f1_val': 0.9974109942678281, 'auprc': 0.997281372613296, 'loss_val': 0.057463742047798534, 'psi': 0.9973591456060154}
[S15] START round=26 head_norm_before_train=1.598737 cos_to_last_merge=0.9924 (last merge round=22)
[S15] round=26 local utility u=0.408039 metrics={'f1_val': 0.786673740541028, 'auprc': 0.9919119943192632, 'loss_val': 0.33803700493948097, 'psi': 0.8687690420523222}-{'f1_val': 0.7001340338733335, 'auprc': 0.9364122870479579, 'loss_val': 0.46837699715338493, 'psi': 0.7946453351431833}
[S16] START round=26 head_norm_before_train=1.895448 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.863469182824794, 'auprc': 0.9193093841150396, 'loss_val': 0.7732155768068223, 'psi': 0.8858052633408923}-{'f1_val': 0.893003187209306, 'auprc': 0.9860260215627306, 'loss_val': 0.43417363234986944, 'psi': 0.9302123209506759}
[S17] START round=26 head_norm_before_train=1.078166 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.3621049520842618, 'auprc': 0.5496005064775537, 'loss_val': 1.6559828146200284, 'psi': 0.43710317384157854}-{'f1_val': 0.5815834651077229, 'auprc': 0.6159497083025934, 'loss_val': 1.0637057210065364, 'psi': 0.5953299623856712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[S13] not sending this round → trigger blocked (psi=0.679)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=0.9365
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=0.2320
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.9869
[S8] RECEIVED delta(kind=head bytes=1805) from S2
[S8] cosine check vs S2: cos=0.1973
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] cosine check vs S5: cos=0.1946
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.7843
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=-0.0895
[S9] DROPPED delta from S15 (cos=-0.0895 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] cosine check vs S11: cos=0.0203
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9946 head_norm=1.346896
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.989543e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9946 head_norm=1.041360 delta_norm=0.498954
[S8] aggregate: ACCEPT kept=['S14', 'S4', 'S2', 'S11'] (k=4/4) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.7867 head_norm=1.639032
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.093278e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.7815 head_norm=1.410979 delta_norm=0.509328
[S15] aggregate: ROLLBACK (f1_val pre=0.787 post=0.782 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9951 head_norm=1.601064
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.994232e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9955 head_norm=1.349812 delta_norm=0.399423
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=2.053546 (no previous merge yet)
[S2] round=27 local utility u=0.206724 metrics={'f1_val': 0.9714193389195086, 'auprc': 0.9727950370232741, 'loss_val': 0.09594442404016161, 'psi': 0.9719696181610148}-{'f1_val': 0.9144272598701505, 'auprc': 0.9748343046116155, 'loss_val': 0.17355814222162388, 'psi': 0.9385900777667364}
[S3] START round=27 head_norm_before_train=1.824811 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.7016531424747843, 'auprc': 0.9877110317613911, 'loss_val': 0.24665984106194577, 'psi': 0.816076298189427}-{'f1_val': 0.703143065141181, 'auprc': 0.9998738654143058, 'loss_val': 0.20267388605408346, 'psi': 0.8218353852504309}
[S4] START round=27 head_norm_before_train=1.993727 (no previous merge yet)
[S4] round=27 local utility u=0.041780 metrics={'f1_val': 0.9447650469461844, 'auprc': 0.9568350077219734, 'loss_val': 0.29972656654300356, 'psi': 0.9495930312565}-{'f1_val': 0.9404884214543169, 'auprc': 0.9405878811321873, 'loss_val': 0.3088850527370756, 'psi': 0.9405282053254651}
[S5] START round=27 head_norm_before_train=1.417674 cos_to_last_merge=0.8104 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.810
[S5] round=27 local utility u=0.232644 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9952684692514615, 'loss_val': 0.1332637215244608, 'psi': 0.9960829331587264}-{'f1_val': 0.9255811065553711, 'auprc': 0.9948932834548111, 'loss_val': 0.1711576801722978, 'psi': 0.9533059773151471}
[S6] START round=27 head_norm_before_train=2.015456 (no previous merge yet)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9188344429519931, 'auprc': 0.9665331933173679, 'loss_val': 0.2197774582280996, 'psi': 0.937913943098143}-{'f1_val': 0.5462492514523708, 'auprc': 0.7238117617217128, 'loss_val': 1.3239299592846738, 'psi': 0.6172742555601076}
[S7] START round=27 head_norm_before_train=1.204579 cos_to_last_merge=0.9998 (last merge round=25)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5579473185538248, 'auprc': 0.7936882541084985, 'loss_val': 0.7607044177520649, 'psi': 0.6522436927756943}-{'f1_val': 0.5837736687999577, 'auprc': 0.7954658994521544, 'loss_val': 0.7001504857311445, 'psi': 0.6684505610608364}
[S8] START round=27 head_norm_before_train=1.041360 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9915940414364243, 'auprc': 0.9966871163659636, 'loss_val': 0.1391234059216844, 'psi': 0.99363127140824}-{'f1_val': 0.9946453664677153, 'auprc': 0.9948215706303031, 'loss_val': 0.10886464252319679, 'psi': 0.9947158481327504}
[S9] START round=27 head_norm_before_train=1.695168 cos_to_last_merge=0.8069 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.807
[S9] round=27 local utility u=0.025617 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9989340428185051, 'loss_val': 0.028535766051012653, 'psi': 0.996570269585235}-{'f1_val': 0.9891288930766337, 'auprc': 0.9989433807401649, 'loss_val': 0.04460432078312732, 'psi': 0.9930546881420461}
[S10] START round=27 head_norm_before_train=1.775150 cos_to_last_merge=0.7545 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.755
[S10] round=27 local utility u=0.000246 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995503621879587, 'loss_val': 0.029142259957843065, 'psi': 0.9952635295974938}-{'f1_val': 0.9951034680760983, 'auprc': 0.9954951094866364, 'loss_val': 0.029609327399056206, 'psi': 0.9952601246403135}
[S11] START round=27 head_norm_before_train=1.349812 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.025323 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979018444501527, 'loss_val': 0.16915165136255003, 'psi': 0.9970889404882148}-{'f1_val': 0.995050363072499, 'auprc': 0.9913365024426691, 'loss_val': 0.19112261123273303, 'psi': 0.993564818820567}
[S13] START round=27 head_norm_before_train=1.278528 cos_to_last_merge=0.9940 (last merge round=24)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6223352947026567, 'auprc': 0.7447710486813934, 'loss_val': 0.7179178178654525, 'psi': 0.6713095962941513}-{'f1_val': 0.652800089056645, 'auprc': 0.7174773893375449, 'loss_val': 0.6418883236230806, 'psi': 0.6786710091690049}
[S14] START round=27 head_norm_before_train=1.791226 cos_to_last_merge=0.9999 (last merge round=25)
[S14] round=27 local utility u=0.001417 metrics={'f1_val': 0.9968028443251822, 'auprc': 0.9991453595464036, 'loss_val': 0.05411219747591899, 'psi': 0.9977398504136707}-{'f1_val': 0.9976511180498535, 'auprc': 0.9973157546925644, 'loss_val': 0.05654619915597078, 'psi': 0.997516972706938}
[S15] START round=27 head_norm_before_train=1.410979 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.720709 metrics={'f1_val': 0.9862204081156447, 'auprc': 0.9966794702940693, 'loss_val': 0.10820118542201529, 'psi': 0.9904040329870145}-{'f1_val': 0.786673740541028, 'auprc': 0.9919119943192632, 'loss_val': 0.33803700493948097, 'psi': 0.8687690420523222}
[S16] START round=27 head_norm_before_train=1.911700 (no previous merge yet)
[S16] round=27 local utility u=0.636637 metrics={'f1_val': 0.9446570042849236, 'auprc': 0.9907426941744022, 'loss_val': 0.20136923771349202, 'psi': 0.963091280240715}-{'f1_val': 0.863469182824794, 'auprc': 0.9193093841150396, 'loss_val': 0.7732155768068223, 'psi': 0.8858052633408923}
[S17] START round=27 head_norm_before_train=1.136411 cos_to_last_merge=0.9968 (last merge round=25)
[S17] round=27 local utility u=1.000000 metrics={'f1_val': 0.6423922402835169, 'auprc': 0.9120768661993096, 'loss_val': 0.6823943594128653, 'psi': 0.750266090649834}-{'f1_val': 0.3621049520842618, 'auprc': 0.5496005064775537, 'loss_val': 1.6559828146200284, 'psi': 0.43710317384157854}
[S5] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:52817
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.972)
[S15] not sending this round → trigger blocked (psi=0.990)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:52814
[S4] not sending this round → trigger blocked (psi=0.950)
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.5016
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.7853
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] cosine check vs S6: cos=0.6780
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9981
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=0.8891
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.6223 head_norm=1.312036
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.004086e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.6305 head_norm=1.214187 delta_norm=0.300409
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.5579 head_norm=1.220469
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.134006e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.5831 head_norm=1.490339 delta_norm=0.613401
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9968 head_norm=1.812798
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.637201e-02
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9968 head_norm=1.800436 delta_norm=0.056372
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.6424 head_norm=1.186404
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.546710e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.6858 head_norm=1.203147 delta_norm=0.354671
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=2.070185 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.9064944664028809, 'auprc': 0.9602625333180518, 'loss_val': 0.2843287151619932, 'psi': 0.9280016931689492}-{'f1_val': 0.9714193389195086, 'auprc': 0.9727950370232741, 'loss_val': 0.09594442404016161, 'psi': 0.9719696181610148}
[S3] START round=28 head_norm_before_train=1.849168 (no previous merge yet)
[S3] round=28 local utility u=0.932444 metrics={'f1_val': 0.9986389529228965, 'auprc': 0.999758226688157, 'loss_val': 0.1998288541782952, 'psi': 0.9990866624290007}-{'f1_val': 0.7016531424747843, 'auprc': 0.9877110317613911, 'loss_val': 0.24665984106194577, 'psi': 0.816076298189427}
[S4] START round=28 head_norm_before_train=1.995730 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9402685810959177, 'auprc': 0.9308723191213337, 'loss_val': 0.3339643717115789, 'psi': 0.9365100763060841}-{'f1_val': 0.9447650469461844, 'auprc': 0.9568350077219734, 'loss_val': 0.29972656654300356, 'psi': 0.9495930312565}
[S5] START round=28 head_norm_before_train=1.431833 cos_to_last_merge=0.8093 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=28 local utility u=0.014475 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9980914037605533, 'loss_val': 0.11278199750453369, 'psi': 0.9972121069623632}-{'f1_val': 0.996625909096903, 'auprc': 0.9952684692514615, 'loss_val': 0.1332637215244608, 'psi': 0.9960829331587264}
[S6] START round=28 head_norm_before_train=2.021808 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6667951365785889, 'auprc': 0.8591549784187626, 'loss_val': 0.9838509244539005, 'psi': 0.7437390733146585}-{'f1_val': 0.9188344429519931, 'auprc': 0.9665331933173679, 'loss_val': 0.2197774582280996, 'psi': 0.937913943098143}
[S7] START round=28 head_norm_before_train=1.490339 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.386003 metrics={'f1_val': 0.6496292527191884, 'auprc': 0.8081012190933101, 'loss_val': 0.5820281134572841, 'psi': 0.713018039268837}-{'f1_val': 0.5579473185538248, 'auprc': 0.7936882541084985, 'loss_val': 0.7607044177520649, 'psi': 0.6522436927756943}
[S8] START round=28 head_norm_before_train=1.136829 cos_to_last_merge=0.9947 (last merge round=26)
[S8] round=28 local utility u=0.026892 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9933913114624423, 'loss_val': 0.09156133073443222, 'psi': 0.993923828936395}-{'f1_val': 0.9915940414364243, 'auprc': 0.9966871163659636, 'loss_val': 0.1391234059216844, 'psi': 0.99363127140824}
[S9] START round=28 head_norm_before_train=1.709264 cos_to_last_merge=0.8049 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.805
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9936065745413156, 'loss_val': 0.026576153110031517, 'psi': 0.9951926866840928}-{'f1_val': 0.994994420763055, 'auprc': 0.9989340428185051, 'loss_val': 0.028535766051012653, 'psi': 0.996570269585235}
[S10] START round=28 head_norm_before_train=1.789765 cos_to_last_merge=0.7532 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.753
[S10] round=28 local utility u=0.001630 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9955038767459379, 'loss_val': 0.02837280799740505, 'psi': 0.9955125337799683}-{'f1_val': 0.9951034680760983, 'auprc': 0.995503621879587, 'loss_val': 0.029142259957843065, 'psi': 0.9952635295974938}
[S11] START round=28 head_norm_before_train=1.376590 cos_to_last_merge=0.9995 (last merge round=26)
[S11] round=28 local utility u=0.006861 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9976562320689699, 'loss_val': 0.15221330645324752, 'psi': 0.9967426977755736}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979018444501527, 'loss_val': 0.16915165136255003, 'psi': 0.9970889404882148}
[S13] START round=28 head_norm_before_train=1.214187 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.227775 metrics={'f1_val': 0.6721251844697068, 'auprc': 0.7536027324082494, 'loss_val': 0.5876021732041407, 'psi': 0.7047162036451239}-{'f1_val': 0.6223352947026567, 'auprc': 0.7447710486813934, 'loss_val': 0.7179178178654525, 'psi': 0.6713095962941513}
[S14] START round=28 head_norm_before_train=1.800436 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.001625 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9973064866785943, 'loss_val': 0.04651271047747829, 'psi': 0.9971210995660368}-{'f1_val': 0.9968028443251822, 'auprc': 0.9991453595464036, 'loss_val': 0.05411219747591899, 'psi': 0.9977398504136707}
[S15] START round=28 head_norm_before_train=1.457363 cos_to_last_merge=0.9993 (last merge round=26)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6988126975890613, 'auprc': 0.9027190866793039, 'loss_val': 0.47964595438714813, 'psi': 0.7803752532251583}-{'f1_val': 0.9862204081156447, 'auprc': 0.9966794702940693, 'loss_val': 0.10820118542201529, 'psi': 0.9904040329870145}
[S16] START round=28 head_norm_before_train=1.924889 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8632498647234021, 'auprc': 0.9075061878344677, 'loss_val': 0.8038646331588519, 'psi': 0.8809523939678283}-{'f1_val': 0.9446570042849236, 'auprc': 0.9907426941744022, 'loss_val': 0.20136923771349202, 'psi': 0.963091280240715}
[S17] START round=28 head_norm_before_train=1.203147 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.31324681853220393, 'auprc': 0.6081381154281869, 'loss_val': 1.6448675970267657, 'psi': 0.4312033372905971}-{'f1_val': 0.6423922402835169, 'auprc': 0.9120768661993096, 'loss_val': 0.6823943594128653, 'psi': 0.750266090649834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:52808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:52809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:52814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9989
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=0.3415
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.7855
[S8] RECEIVED delta(kind=head bytes=1793) from S11
[S8] cosine check vs S11: cos=0.2325
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.9280
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.4056
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] cosine check vs S8: cos=0.9131
[S7] RECEIVED delta(kind=head bytes=1807) from S13
[S7] cosine check vs S13: cos=0.5467
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.6988 head_norm=1.498312
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.127578e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.6988 head_norm=1.336078 delta_norm=0.312758
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6496 head_norm=1.502526
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.662396e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6311 head_norm=1.216288 delta_norm=0.666240
[S7] aggregate: ROLLBACK (f1_val pre=0.650 post=0.631 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9961 head_norm=1.403868
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.108940e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9961 head_norm=1.294688 delta_norm=0.210894
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9970 head_norm=1.821255
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.271340e-02
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9970 head_norm=1.812544 delta_norm=0.042713
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9943 head_norm=1.233251
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.699095e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9943 head_norm=1.104617 delta_norm=0.369909
[S8] aggregate: ACCEPT kept=['S14', 'S11'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.3132 head_norm=1.241796
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.945385e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.2794 head_norm=1.126290 delta_norm=0.794538
[S17] aggregate: ROLLBACK (f1_val pre=0.313 post=0.279 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=2.078271 (no previous merge yet)
[S2] round=29 local utility u=0.042325 metrics={'f1_val': 0.9103658433659703, 'auprc': 0.9709742183296, 'loss_val': 0.25504249579781, 'psi': 0.9346091933514221}-{'f1_val': 0.9064944664028809, 'auprc': 0.9602625333180518, 'loss_val': 0.2843287151619932, 'psi': 0.9280016931689492}
[S3] START round=29 head_norm_before_train=1.873400 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.7398695290056345, 'auprc': 0.8466944953972404, 'loss_val': 0.37179358576140203, 'psi': 0.7825995155622769}-{'f1_val': 0.9986389529228965, 'auprc': 0.999758226688157, 'loss_val': 0.1998288541782952, 'psi': 0.9990866624290007}
[S4] START round=29 head_norm_before_train=2.000051 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9386568732228601, 'auprc': 0.9263362170791951, 'loss_val': 0.34089265584171297, 'psi': 0.9337286107653942}-{'f1_val': 0.9402685810959177, 'auprc': 0.9308723191213337, 'loss_val': 0.3339643717115789, 'psi': 0.9365100763060841}
[S5] START round=29 head_norm_before_train=1.445166 cos_to_last_merge=0.8083 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.7945226883087747, 'loss_val': 0.3958702226310478, 'psi': 0.7464318223566644}-{'f1_val': 0.996625909096903, 'auprc': 0.9980914037605533, 'loss_val': 0.11278199750453369, 'psi': 0.9972121069623632}
[S6] START round=29 head_norm_before_train=2.030380 (no previous merge yet)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9499019887775836, 'auprc': 0.9834974357266903, 'loss_val': 0.1510387609207188, 'psi': 0.9633401675572263}-{'f1_val': 0.6667951365785889, 'auprc': 0.8591549784187626, 'loss_val': 0.9838509244539005, 'psi': 0.7437390733146585}
[S7] START round=29 head_norm_before_train=1.216288 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6303275914595193, 'auprc': 0.803965793027434, 'loss_val': 0.6024993327958197, 'psi': 0.6997828720866852}-{'f1_val': 0.6496292527191884, 'auprc': 0.8081012190933101, 'loss_val': 0.5820281134572841, 'psi': 0.713018039268837}
[S8] START round=29 head_norm_before_train=1.104617 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9891913127687362, 'loss_val': 0.12114978021672007, 'psi': 0.9911993598567956}-{'f1_val': 0.9942788405856967, 'auprc': 0.9933913114624423, 'loss_val': 0.09156133073443222, 'psi': 0.993923828936395}
[S9] START round=29 head_norm_before_train=1.721276 cos_to_last_merge=0.8028 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.803
[S9] round=29 local utility u=0.005713 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9990732067860909, 'loss_val': 0.026514632564239294, 'psi': 0.9968757754675732}-{'f1_val': 0.9962500947792776, 'auprc': 0.9936065745413156, 'loss_val': 0.026576153110031517, 'psi': 0.9951926866840928}
[S10] START round=29 head_norm_before_train=1.804802 cos_to_last_merge=0.7520 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.752
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9954109884150473, 'loss_val': 0.029365273813111145, 'psi': 0.9952264762116778}-{'f1_val': 0.9955183051359886, 'auprc': 0.9955038767459379, 'loss_val': 0.02837280799740505, 'psi': 0.9955125337799683}
[S11] START round=29 head_norm_before_train=1.294688 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.004330 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9980275747363656, 'loss_val': 0.1447898898043737, 'psi': 0.9969035147409935}-{'f1_val': 0.9961336749133093, 'auprc': 0.9976562320689699, 'loss_val': 0.15221330645324752, 'psi': 0.9967426977755736}
[S13] START round=29 head_norm_before_train=1.260508 cos_to_last_merge=0.9983 (last merge round=27)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6293965228332438, 'auprc': 0.7935397930841989, 'loss_val': 0.810908141522395, 'psi': 0.6950538309336258}-{'f1_val': 0.6721251844697068, 'auprc': 0.7536027324082494, 'loss_val': 0.5876021732041407, 'psi': 0.7047162036451239}
[S14] START round=29 head_norm_before_train=1.812544 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.001546 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9973404562486698, 'loss_val': 0.048453722534254305, 'psi': 0.997627893279799}-{'f1_val': 0.9969975081576651, 'auprc': 0.9973064866785943, 'loss_val': 0.04651271047747829, 'psi': 0.9971210995660368}
[S15] START round=29 head_norm_before_train=1.336078 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.716137 metrics={'f1_val': 0.8608216996612861, 'auprc': 0.9788559956908871, 'loss_val': 0.24783697437978544, 'psi': 0.9080354180731265}-{'f1_val': 0.6988126975890613, 'auprc': 0.9027190866793039, 'loss_val': 0.47964595438714813, 'psi': 0.7803752532251583}
[S16] START round=29 head_norm_before_train=1.937692 (no previous merge yet)
[S16] round=29 local utility u=0.437727 metrics={'f1_val': 0.9079082076030033, 'auprc': 0.9864896571719505, 'loss_val': 0.43331018131648097, 'psi': 0.9393407874305821}-{'f1_val': 0.8632498647234021, 'auprc': 0.9075061878344677, 'loss_val': 0.8038646331588519, 'psi': 0.8809523939678283}
[S17] START round=29 head_norm_before_train=1.126290 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=1.000000 metrics={'f1_val': 0.6294654875459424, 'auprc': 0.8860965783043321, 'loss_val': 0.7280419035293695, 'psi': 0.7321179238492983}-{'f1_val': 0.31324681853220393, 'auprc': 0.6081381154281869, 'loss_val': 1.6448675970267657, 'psi': 0.4312033372905971}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:52810
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.3978
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=0.4570
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=0.3742
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.8135
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=0.2525
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] cosine check vs S15: cos=-0.1479
[S9] DROPPED delta from S15 (cos=-0.1479 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.7588
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.8701
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.6294 head_norm=1.306620
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.225698e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.6265 head_norm=1.199679 delta_norm=0.322570
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9925 head_norm=1.197866
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.225934e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9925 head_norm=1.050522 delta_norm=0.422593
[S8] aggregate: ACCEPT kept=['S11', 'S14', 'S2'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6303 head_norm=1.231864
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.469473e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6594 head_norm=1.497020 delta_norm=0.646947
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.6295 head_norm=1.174439
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.596567e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.6518 head_norm=1.125273 delta_norm=0.559657
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.088353 (no previous merge yet)
[S2] round=30 local utility u=0.108295 metrics={'f1_val': 0.9174491887391168, 'auprc': 0.9819096736914246, 'loss_val': 0.11375824997749125, 'psi': 0.9432333827200399}-{'f1_val': 0.9103658433659703, 'auprc': 0.9709742183296, 'loss_val': 0.25504249579781, 'psi': 0.9346091933514221}
[S3] START round=30 head_norm_before_train=1.893555 (no previous merge yet)
[S3] round=30 local utility u=0.781478 metrics={'f1_val': 0.9055868077258452, 'auprc': 0.9929069483646488, 'loss_val': 0.2417785316907874, 'psi': 0.9405148639813666}-{'f1_val': 0.7398695290056345, 'auprc': 0.8466944953972404, 'loss_val': 0.37179358576140203, 'psi': 0.7825995155622769}
[S4] START round=30 head_norm_before_train=2.013965 (no previous merge yet)
[S4] round=30 local utility u=0.062767 metrics={'f1_val': 0.9419694654891948, 'auprc': 0.950044878873407, 'loss_val': 0.30636117280095604, 'psi': 0.9451996308428796}-{'f1_val': 0.9386568732228601, 'auprc': 0.9263362170791951, 'loss_val': 0.34089265584171297, 'psi': 0.9337286107653942}
[S5] START round=30 head_norm_before_train=1.457623 cos_to_last_merge=0.8076 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.9205442004702804, 'auprc': 0.9979232533735891, 'loss_val': 0.1418285830802373, 'psi': 0.9514958216316038}-{'f1_val': 0.7143712450552575, 'auprc': 0.7945226883087747, 'loss_val': 0.3958702226310478, 'psi': 0.7464318223566644}
[S6] START round=30 head_norm_before_train=2.043646 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7425301991136528, 'auprc': 0.7824634776831318, 'loss_val': 0.8038174754260679, 'psi': 0.7585035105414444}-{'f1_val': 0.9499019887775836, 'auprc': 0.9834974357266903, 'loss_val': 0.1510387609207188, 'psi': 0.9633401675572263}
[S7] START round=30 head_norm_before_train=1.497020 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5568335875574264, 'auprc': 0.7944377590699845, 'loss_val': 0.7577921977027336, 'psi': 0.6518752561624497}-{'f1_val': 0.6303275914595193, 'auprc': 0.803965793027434, 'loss_val': 0.6024993327958197, 'psi': 0.6997828720866852}
[S8] START round=30 head_norm_before_train=1.050522 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.992032490903249, 'auprc': 0.9986307944784052, 'loss_val': 0.15142281403794913, 'psi': 0.9946718123333114}-{'f1_val': 0.9925380579155019, 'auprc': 0.9891913127687362, 'loss_val': 0.12114978021672007, 'psi': 0.9911993598567956}
[S9] START round=30 head_norm_before_train=1.732310 cos_to_last_merge=0.8010 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=30 local utility u=0.004223 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9993589780224776, 'loss_val': 0.023938327207458587, 'psi': 0.9974912601885225}-{'f1_val': 0.9954108212552283, 'auprc': 0.9990732067860909, 'loss_val': 0.026514632564239294, 'psi': 0.9968757754675732}
[S10] START round=30 head_norm_before_train=1.815620 cos_to_last_merge=0.7510 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.751
[S10] round=30 local utility u=0.001840 metrics={'f1_val': 0.9952985899745774, 'auprc': 0.9955153280915268, 'loss_val': 0.027169829872974737, 'psi': 0.9953852852213572}-{'f1_val': 0.9951034680760983, 'auprc': 0.9954109884150473, 'loss_val': 0.029365273813111145, 'psi': 0.9952264762116778}
[S11] START round=30 head_norm_before_train=1.326086 cos_to_last_merge=0.9994 (last merge round=28)
[S11] round=30 local utility u=0.020803 metrics={'f1_val': 0.997050770792581, 'auprc': 0.9985606734491479, 'loss_val': 0.11016201110723083, 'psi': 0.9976547318552078}-{'f1_val': 0.9961541414107454, 'auprc': 0.9980275747363656, 'loss_val': 0.1447898898043737, 'psi': 0.9969035147409935}
[S13] START round=30 head_norm_before_train=1.199679 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6241769016099052, 'auprc': 0.6613429612471466, 'loss_val': 0.7405461504857049, 'psi': 0.6390433254648018}-{'f1_val': 0.6293965228332438, 'auprc': 0.7935397930841989, 'loss_val': 0.810908141522395, 'psi': 0.6950538309336258}
[S14] START round=30 head_norm_before_train=1.833335 cos_to_last_merge=0.9999 (last merge round=28)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9953280742010686, 'auprc': 0.9975919918482248, 'loss_val': 0.05142797188364731, 'psi': 0.9962336412599311}-{'f1_val': 0.9978195179672185, 'auprc': 0.9973404562486698, 'loss_val': 0.048453722534254305, 'psi': 0.997627893279799}
[S15] START round=30 head_norm_before_train=1.384909 cos_to_last_merge=0.9990 (last merge round=28)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6953128053203691, 'auprc': 0.9182372310009731, 'loss_val': 0.5018054023832023, 'psi': 0.7844825755926107}-{'f1_val': 0.8608216996612861, 'auprc': 0.9788559956908871, 'loss_val': 0.24783697437978544, 'psi': 0.9080354180731265}
[S16] START round=30 head_norm_before_train=1.949802 (no previous merge yet)
[S16] round=30 local utility u=0.407605 metrics={'f1_val': 0.9803045705867726, 'auprc': 0.9939166707938122, 'loss_val': 0.07475987268291381, 'psi': 0.9857494106695883}-{'f1_val': 0.9079082076030033, 'auprc': 0.9864896571719505, 'loss_val': 0.43331018131648097, 'psi': 0.9393407874305821}
[S17] START round=30 head_norm_before_train=1.125273 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.41501089522545487, 'auprc': 0.6426938354470144, 'loss_val': 1.6914882642673903, 'psi': 0.5060840713140787}-{'f1_val': 0.6294654875459424, 'auprc': 0.8860965783043321, 'loss_val': 0.7280419035293695, 'psi': 0.7321179238492983}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:52814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:52812
[S2] not sending this round → trigger blocked (psi=0.943)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.986)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9986
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.1948
[S11] RECEIVED delta(kind=head bytes=1794) from S3
[S11] cosine check vs S3: cos=0.8717
[S11] RECEIVED delta(kind=head bytes=1804) from S5
[S11] cosine check vs S5: cos=0.5213
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.357 → S17@127.0.0.1:52817
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9920 head_norm=1.168394
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.062810e+00
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9917 head_norm=1.260515 delta_norm=1.062810
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.017 → S15@127.0.0.1:52815
[S7] ⇄ pheromone p=0.202 → S17@127.0.0.1:52817
[S13] ⇄ pheromone p=0.067 → S7@127.0.0.1:52808
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9971 head_norm=1.361542
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.332069e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9971 head_norm=1.293885 delta_norm=0.133207
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.070 → S8@127.0.0.1:52809
[S2] ⇄ pheromone p=0.090 → S8@127.0.0.1:52809
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9953 head_norm=1.853509
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.026155e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9953 head_norm=1.839283 delta_norm=0.050262
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.016 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.021 → S17@127.0.0.1:52817
[S15] ⇄ pheromone p=0.269 → S9@127.0.0.1:52810
[S5] ⇄ pheromone p=0.353 → S11@127.0.0.1:52812
[S4] ⇄ pheromone p=0.029 → S8@127.0.0.1:52809
[S10] ⇄ pheromone p=0.006 → S14@127.0.0.1:52814
[S3] ⇄ pheromone p=0.302 → S11@127.0.0.1:52812
[S17] ⇄ pheromone p=0.338 → S13@127.0.0.1:52813
[S16] ⇄ pheromone p=0.264 → S7@127.0.0.1:52808
[S2] START round=31 head_norm_before_train=2.098002 (no previous merge yet)
[S2] round=31 local utility u=0.199569 metrics={'f1_val': 0.9823219871464806, 'auprc': 0.9724704156655326, 'loss_val': 0.07553861916006727, 'psi': 0.9783813585541015}-{'f1_val': 0.9174491887391168, 'auprc': 0.9819096736914246, 'loss_val': 0.11375824997749125, 'psi': 0.9432333827200399}
[S3] START round=31 head_norm_before_train=1.913846 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.6680118971890607, 'auprc': 0.9708352379340184, 'loss_val': 0.5768413042566346, 'psi': 0.7891412334870438}-{'f1_val': 0.9055868077258452, 'auprc': 0.9929069483646488, 'loss_val': 0.2417785316907874, 'psi': 0.9405148639813666}
[S4] START round=31 head_norm_before_train=2.017865 (no previous merge yet)
[S4] round=31 local utility u=0.053701 metrics={'f1_val': 0.9474090021157493, 'auprc': 0.9712362630117999, 'loss_val': 0.2951696078898265, 'psi': 0.9569399064741695}-{'f1_val': 0.9419694654891948, 'auprc': 0.950044878873407, 'loss_val': 0.30636117280095604, 'psi': 0.9451996308428796}
[S5] START round=31 head_norm_before_train=1.467204 cos_to_last_merge=0.8069 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=31 local utility u=0.143615 metrics={'f1_val': 0.9708099586677326, 'auprc': 0.9916831502540351, 'loss_val': 0.13747198169962455, 'psi': 0.9791592353022536}-{'f1_val': 0.9205442004702804, 'auprc': 0.9979232533735891, 'loss_val': 0.1418285830802373, 'psi': 0.9514958216316038}
[S6] START round=31 head_norm_before_train=2.055200 (no previous merge yet)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.9326692281556341, 'auprc': 0.9683928293045073, 'loss_val': 0.18421704953052828, 'psi': 0.9469586686151834}-{'f1_val': 0.7425301991136528, 'auprc': 0.7824634776831318, 'loss_val': 0.8038174754260679, 'psi': 0.7585035105414444}
[S7] START round=31 head_norm_before_train=1.510303 cos_to_last_merge=0.9999 (last merge round=29)
[S7] round=31 local utility u=0.090463 metrics={'f1_val': 0.5756854586173714, 'auprc': 0.7998336841236215, 'loss_val': 0.7061645602010377, 'psi': 0.6653447488198715}-{'f1_val': 0.5568335875574264, 'auprc': 0.7944377590699845, 'loss_val': 0.7577921977027336, 'psi': 0.6518752561624497}
[S8] START round=31 head_norm_before_train=1.260515 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.045039 metrics={'f1_val': 0.9938464732474644, 'auprc': 0.9975832038591239, 'loss_val': 0.06908645988353183, 'psi': 0.9953411654921283}-{'f1_val': 0.992032490903249, 'auprc': 0.9986307944784052, 'loss_val': 0.15142281403794913, 'psi': 0.9946718123333114}
[S9] START round=31 head_norm_before_train=1.744728 cos_to_last_merge=0.7991 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.799
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.9963078942972997, 'loss_val': 0.039429945029302235, 'psi': 0.992744368456496}-{'f1_val': 0.9962461149658858, 'auprc': 0.9993589780224776, 'loss_val': 0.023938327207458587, 'psi': 0.9974912601885225}
[S10] START round=31 head_norm_before_train=1.826329 cos_to_last_merge=0.7501 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.750
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9953430135774728, 'loss_val': 0.028841056047936395, 'psi': 0.9951992862766481}-{'f1_val': 0.9952985899745774, 'auprc': 0.9955153280915268, 'loss_val': 0.027169829872974737, 'psi': 0.9953852852213572}
[S11] START round=31 head_norm_before_train=1.293885 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978967157513043, 'loss_val': 0.11832122385153594, 'psi': 0.9969417867818383}-{'f1_val': 0.997050770792581, 'auprc': 0.9985606734491479, 'loss_val': 0.11016201110723083, 'psi': 0.9976547318552078}
[S13] START round=31 head_norm_before_train=1.247365 cos_to_last_merge=0.9980 (last merge round=29)
[S13] round=31 local utility u=0.326635 metrics={'f1_val': 0.6680089398282915, 'auprc': 0.7895543698319555, 'loss_val': 0.7349024332533713, 'psi': 0.7166271118297571}-{'f1_val': 0.6241769016099052, 'auprc': 0.6613429612471466, 'loss_val': 0.7405461504857049, 'psi': 0.6390433254648018}
[S14] START round=31 head_norm_before_train=1.839283 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.013610 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9989986894431369, 'loss_val': 0.04234972851139292, 'psi': 0.998188502737722}-{'f1_val': 0.9953280742010686, 'auprc': 0.9975919918482248, 'loss_val': 0.05142797188364731, 'psi': 0.9962336412599311}
[S15] START round=31 head_norm_before_train=1.448687 cos_to_last_merge=0.9958 (last merge round=28)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.993910103023387, 'auprc': 0.9919609295355719, 'loss_val': 0.07272889799564437, 'psi': 0.9931304336282609}-{'f1_val': 0.6953128053203691, 'auprc': 0.9182372310009731, 'loss_val': 0.5018054023832023, 'psi': 0.7844825755926107}
[S16] START round=31 head_norm_before_train=1.961012 (no previous merge yet)
[S16] round=31 local utility u=0.043366 metrics={'f1_val': 0.9897857903305745, 'auprc': 0.9942009866539052, 'loss_val': 0.045768226691826064, 'psi': 0.9915518688599068}-{'f1_val': 0.9803045705867726, 'auprc': 0.9939166707938122, 'loss_val': 0.07475987268291381, 'psi': 0.9857494106695883}
[S17] START round=31 head_norm_before_train=1.186962 cos_to_last_merge=0.9970 (last merge round=29)
[S17] round=31 local utility u=1.000000 metrics={'f1_val': 0.5972091301023692, 'auprc': 0.7665172747768849, 'loss_val': 0.7747094151639611, 'psi': 0.6649323879721756}-{'f1_val': 0.41501089522545487, 'auprc': 0.6426938354470144, 'loss_val': 1.6914882642673903, 'psi': 0.5060840713140787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=0.5193
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.6812
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.1167
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.8704
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.3552
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] cosine check vs S5: cos=0.5778
[S15] RECEIVED delta(kind=head bytes=1805) from S8
[S15] cosine check vs S8: cos=0.8068
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] cosine check vs S15: cos=-0.1414
[S9] DROPPED delta from S15 (cos=-0.1414 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.9589
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.7038
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=0.9173
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9963 head_norm=1.323475
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.469390e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9963 head_norm=1.244110 delta_norm=0.646939
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.5757 head_norm=1.524059
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.169531e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.5767 head_norm=1.463727 delta_norm=0.116953
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9938 head_norm=1.377234
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.425677e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9938 head_norm=1.177656 delta_norm=0.442568
[S8] aggregate: ACCEPT kept=['S2', 'S4', 'S14'] (k=3/3) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9939 head_norm=1.507796
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.525683e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9939 head_norm=1.371238 delta_norm=0.452568
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.6680 head_norm=1.283816
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.576220e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.6953 head_norm=1.236195 delta_norm=0.257622
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.5972 head_norm=1.241335
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.783875e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.5782 head_norm=1.228044 delta_norm=0.378388
[S17] aggregate: ROLLBACK (f1_val pre=0.597 post=0.578 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=2.108446 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.9048891214564218, 'auprc': 0.9348777017008296, 'loss_val': 0.29858702514651175, 'psi': 0.916884553554185}-{'f1_val': 0.9823219871464806, 'auprc': 0.9724704156655326, 'loss_val': 0.07553861916006727, 'psi': 0.9783813585541015}
[S3] START round=32 head_norm_before_train=1.934141 (no previous merge yet)
[S3] round=32 local utility u=0.705317 metrics={'f1_val': 0.8518742580162488, 'auprc': 0.9838468818694738, 'loss_val': 0.30841727488829335, 'psi': 0.9046633075575388}-{'f1_val': 0.6680118971890607, 'auprc': 0.9708352379340184, 'loss_val': 0.5768413042566346, 'psi': 0.7891412334870438}
[S4] START round=32 head_norm_before_train=2.024852 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.940770878784353, 'auprc': 0.9482310079389217, 'loss_val': 0.3088673339669809, 'psi': 0.9437549304461804}-{'f1_val': 0.9474090021157493, 'auprc': 0.9712362630117999, 'loss_val': 0.2951696078898265, 'psi': 0.9569399064741695}
[S5] START round=32 head_norm_before_train=1.476852 cos_to_last_merge=0.8065 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=32 local utility u=0.112149 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9977399474315589, 'loss_val': 0.08624037993194857, 'psi': 0.9970715244307654}-{'f1_val': 0.9708099586677326, 'auprc': 0.9916831502540351, 'loss_val': 0.13747198169962455, 'psi': 0.9791592353022536}
[S6] START round=32 head_norm_before_train=2.066399 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6793220025165823, 'auprc': 0.8582480408648075, 'loss_val': 1.0424196845580487, 'psi': 0.7508924178558724}-{'f1_val': 0.9326692281556341, 'auprc': 0.9683928293045073, 'loss_val': 0.18421704953052828, 'psi': 0.9469586686151834}
[S7] START round=32 head_norm_before_train=1.463727 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5690962727247527, 'auprc': 0.7976742223914285, 'loss_val': 0.740023976660703, 'psi': 0.6605274525914231}-{'f1_val': 0.5756854586173714, 'auprc': 0.7998336841236215, 'loss_val': 0.7061645602010377, 'psi': 0.6653447488198715}
[S8] START round=32 head_norm_before_train=1.177656 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9926723491866012, 'auprc': 0.9973074947244212, 'loss_val': 0.07489967322502238, 'psi': 0.9945264074017292}-{'f1_val': 0.9938464732474644, 'auprc': 0.9975832038591239, 'loss_val': 0.06908645988353183, 'psi': 0.9953411654921283}
[S9] START round=32 head_norm_before_train=1.754522 cos_to_last_merge=0.7980 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.798
[S9] round=32 local utility u=0.032211 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995474010495897, 'loss_val': 0.022477685226568282, 'psi': 0.9978152675081707}-{'f1_val': 0.9903686845626269, 'auprc': 0.9963078942972997, 'loss_val': 0.039429945029302235, 'psi': 0.992744368456496}
[S10] START round=32 head_norm_before_train=1.833245 cos_to_last_merge=0.7495 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.749
[S10] round=32 local utility u=0.002640 metrics={'f1_val': 0.9952985899745774, 'auprc': 0.9958891732539552, 'loss_val': 0.026370928059990657, 'psi': 0.9955348232863286}-{'f1_val': 0.9951034680760983, 'auprc': 0.9953430135774728, 'loss_val': 0.028841056047936395, 'psi': 0.9951992862766481}
[S11] START round=32 head_norm_before_train=1.244110 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983507546810706, 'loss_val': 0.1481689607829674, 'psi': 0.9972807842561564}-{'f1_val': 0.996305167468861, 'auprc': 0.9978967157513043, 'loss_val': 0.11832122385153594, 'psi': 0.9969417867818383}
[S13] START round=32 head_norm_before_train=1.236195 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6641924655665374, 'auprc': 0.7581996971347945, 'loss_val': 0.6923147846186034, 'psi': 0.7017953581938403}-{'f1_val': 0.6680089398282915, 'auprc': 0.7895543698319555, 'loss_val': 0.7349024332533713, 'psi': 0.7166271118297571}
[S14] START round=32 head_norm_before_train=1.857975 cos_to_last_merge=0.9999 (last merge round=30)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9949110635196168, 'auprc': 0.9968499454599611, 'loss_val': 0.046371089956732774, 'psi': 0.9956866162957545}-{'f1_val': 0.9976483782674455, 'auprc': 0.9989986894431369, 'loss_val': 0.04234972851139292, 'psi': 0.998188502737722}
[S15] START round=32 head_norm_before_train=1.371238 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.830537898277114, 'auprc': 0.9778040704333578, 'loss_val': 0.2594848849854803, 'psi': 0.8894443671396115}-{'f1_val': 0.993910103023387, 'auprc': 0.9919609295355719, 'loss_val': 0.07272889799564437, 'psi': 0.9931304336282609}
[S16] START round=32 head_norm_before_train=1.971106 (no previous merge yet)
[S16] round=32 local utility u=0.001763 metrics={'f1_val': 0.9905071380546533, 'auprc': 0.9942229363732666, 'loss_val': 0.04663633452238528, 'psi': 0.9919934573820985}-{'f1_val': 0.9897857903305745, 'auprc': 0.9942009866539052, 'loss_val': 0.045768226691826064, 'psi': 0.9915518688599068}
[S17] START round=32 head_norm_before_train=1.228044 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5894816397068212, 'auprc': 0.7531176110533562, 'loss_val': 0.7161087006654003, 'psi': 0.6549360282454352}-{'f1_val': 0.5972091301023692, 'auprc': 0.7665172747768849, 'loss_val': 0.7747094151639611, 'psi': 0.6649323879721756}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:52808
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:52817
[S9] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9985
[S17] RECEIVED delta(kind=head bytes=1804) from S9
[S17] cosine check vs S9: cos=0.3281
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.8950
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] cosine check vs S3: cos=0.4893
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.9391
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9949 head_norm=1.876183
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.311952e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9949 head_norm=1.858188 delta_norm=0.053120
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9966 head_norm=1.270018
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.735917e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9966 head_norm=1.235007 delta_norm=0.273592
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.5691 head_norm=1.473701
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.913404e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5748 head_norm=1.701336 delta_norm=0.391340
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.5895 head_norm=1.276215
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.037042e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.5832 head_norm=1.247332 delta_norm=0.903704
[S17] aggregate: ROLLBACK (f1_val pre=0.589 post=0.583 tol_abs=0.005 tol_rel=0.0)
[S2] START round=33 head_norm_before_train=2.119917 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8956235260444735, 'auprc': 0.8808124182914664, 'loss_val': 0.3465906667614357, 'psi': 0.8896990829432706}-{'f1_val': 0.9048891214564218, 'auprc': 0.9348777017008296, 'loss_val': 0.29858702514651175, 'psi': 0.916884553554185}
[S3] START round=33 head_norm_before_train=1.953367 (no previous merge yet)
[S3] round=33 local utility u=0.329761 metrics={'f1_val': 0.9294817826018604, 'auprc': 0.9972124469115886, 'loss_val': 0.1546361937427505, 'psi': 0.9565740483257517}-{'f1_val': 0.8518742580162488, 'auprc': 0.9838468818694738, 'loss_val': 0.30841727488829335, 'psi': 0.9046633075575388}
[S4] START round=33 head_norm_before_train=2.035825 (no previous merge yet)
[S4] round=33 local utility u=0.080601 metrics={'f1_val': 0.9538723698605586, 'auprc': 0.970552925921789, 'loss_val': 0.2932400033118218, 'psi': 0.9605445922850507}-{'f1_val': 0.940770878784353, 'auprc': 0.9482310079389217, 'loss_val': 0.3088673339669809, 'psi': 0.9437549304461804}
[S5] START round=33 head_norm_before_train=1.484107 cos_to_last_merge=0.8063 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.806
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9945133697005515, 'loss_val': 0.0885347181286667, 'psi': 0.9956930360518587}-{'f1_val': 0.996625909096903, 'auprc': 0.9977399474315589, 'loss_val': 0.08624037993194857, 'psi': 0.9970715244307654}
[S6] START round=33 head_norm_before_train=2.077072 (no previous merge yet)
[S6] round=33 local utility u=0.733956 metrics={'f1_val': 0.7998406957647491, 'auprc': 0.9443985522869226, 'loss_val': 0.5560712977479221, 'psi': 0.8576638383736186}-{'f1_val': 0.6793220025165823, 'auprc': 0.8582480408648075, 'loss_val': 1.0424196845580487, 'psi': 0.7508924178558724}
[S7] START round=33 head_norm_before_train=1.701336 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.136553 metrics={'f1_val': 0.5980660215075538, 'auprc': 0.8030554302823645, 'loss_val': 0.656879150815731, 'psi': 0.6800617850174782}-{'f1_val': 0.5690962727247527, 'auprc': 0.7976742223914285, 'loss_val': 0.740023976660703, 'psi': 0.6605274525914231}
[S8] START round=33 head_norm_before_train=1.259814 cos_to_last_merge=0.9978 (last merge round=31)
[S8] round=33 local utility u=0.007883 metrics={'f1_val': 0.9923086083290242, 'auprc': 0.9981146984175566, 'loss_val': 0.059373443722078784, 'psi': 0.9946310443644373}-{'f1_val': 0.9926723491866012, 'auprc': 0.9973074947244212, 'loss_val': 0.07489967322502238, 'psi': 0.9945264074017292}
[S9] START round=33 head_norm_before_train=1.765309 cos_to_last_merge=0.7966 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9995453107468738, 'loss_val': 0.02377187555663509, 'psi': 0.9973141553172608}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995474010495897, 'loss_val': 0.022477685226568282, 'psi': 0.9978152675081707}
[S10] START round=33 head_norm_before_train=1.841549 cos_to_last_merge=0.7488 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.749
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995506930898007, 'loss_val': 0.027287380828293455, 'psi': 0.9952648532048618}-{'f1_val': 0.9952985899745774, 'auprc': 0.9958891732539552, 'loss_val': 0.026370928059990657, 'psi': 0.9955348232863286}
[S11] START round=33 head_norm_before_train=1.235007 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.012402 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983079651429783, 'loss_val': 0.12323575747275718, 'psi': 0.9972636684409195}-{'f1_val': 0.996567470639547, 'auprc': 0.9983507546810706, 'loss_val': 0.1481689607829674, 'psi': 0.9972807842561564}
[S13] START round=33 head_norm_before_train=1.268966 cos_to_last_merge=0.9990 (last merge round=31)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6155007518837843, 'auprc': 0.7569204053830246, 'loss_val': 0.8444383356569575, 'psi': 0.6720686132834804}-{'f1_val': 0.6641924655665374, 'auprc': 0.7581996971347945, 'loss_val': 0.6923147846186034, 'psi': 0.7017953581938403}
[S14] START round=33 head_norm_before_train=1.858188 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.010761 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9967740286419305, 'loss_val': 0.03958738613628457, 'psi': 0.9971529292883627}-{'f1_val': 0.9949110635196168, 'auprc': 0.9968499454599611, 'loss_val': 0.046371089956732774, 'psi': 0.9956866162957545}
[S15] START round=33 head_norm_before_train=1.430971 cos_to_last_merge=0.9990 (last merge round=31)
[S15] round=33 local utility u=0.597432 metrics={'f1_val': 0.9921539778115896, 'auprc': 0.9934217494694182, 'loss_val': 0.08116968185620423, 'psi': 0.992661086474721}-{'f1_val': 0.830537898277114, 'auprc': 0.9778040704333578, 'loss_val': 0.2594848849854803, 'psi': 0.8894443671396115}
[S16] START round=33 head_norm_before_train=1.980806 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9133014771064307, 'auprc': 0.9841403609040703, 'loss_val': 0.44235008137660686, 'psi': 0.9416370306254866}-{'f1_val': 0.9905071380546533, 'auprc': 0.9942229363732666, 'loss_val': 0.04663633452238528, 'psi': 0.9919934573820985}
[S17] START round=33 head_norm_before_train=1.247332 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.022878 metrics={'f1_val': 0.6353922544643182, 'auprc': 0.7118352993568906, 'loss_val': 0.8219692424053887, 'psi': 0.6659694724213472}-{'f1_val': 0.5894816397068212, 'auprc': 0.7531176110533562, 'loss_val': 0.7161087006654003, 'psi': 0.6549360282454352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:52817
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:52810
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=0.3049
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=0.4078
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.7133
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.5499
[S8] RECEIVED delta(kind=head bytes=1796) from S11
[S8] cosine check vs S11: cos=0.1810
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.6688
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=0.9592
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=-0.1066
[S9] DROPPED delta from S15 (cos=-0.1066 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.8584
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.6155 head_norm=1.309636
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.464201e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.6187 head_norm=1.254522 delta_norm=0.346420
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9966 head_norm=1.266824
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.347575e-01
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9966 head_norm=1.487731 delta_norm=0.734757
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9922 head_norm=1.483539
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.152795e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9922 head_norm=1.390099 delta_norm=0.215280
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9923 head_norm=1.325349
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.529738e-01
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9920 head_norm=1.096102 delta_norm=0.352974
[S8] aggregate: ACCEPT kept=['S4', 'S14', 'S11'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.6354 head_norm=1.293259
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.479874e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.6108 head_norm=1.143273 delta_norm=0.647987
[S17] aggregate: ROLLBACK (f1_val pre=0.635 post=0.611 tol_abs=0.005 tol_rel=0.0)
[S2] START round=34 head_norm_before_train=2.127791 (no previous merge yet)
[S2] round=34 local utility u=0.282724 metrics={'f1_val': 0.9146377413089284, 'auprc': 0.9718764123419985, 'loss_val': 0.16842093629776977, 'psi': 0.9375332097221565}-{'f1_val': 0.8956235260444735, 'auprc': 0.8808124182914664, 'loss_val': 0.3465906667614357, 'psi': 0.8896990829432706}
[S3] START round=34 head_norm_before_train=1.975242 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.8431027896635914, 'auprc': 0.9767409165946033, 'loss_val': 0.3517847757508141, 'psi': 0.8965580404359962}-{'f1_val': 0.9294817826018604, 'auprc': 0.9972124469115886, 'loss_val': 0.1546361937427505, 'psi': 0.9565740483257517}
[S4] START round=34 head_norm_before_train=2.046157 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9373908032109788, 'auprc': 0.9259571483640094, 'loss_val': 0.33329212184015244, 'psi': 0.9328173412721911}-{'f1_val': 0.9538723698605586, 'auprc': 0.970552925921789, 'loss_val': 0.2932400033118218, 'psi': 0.9605445922850507}
[S5] START round=34 head_norm_before_train=1.492951 cos_to_last_merge=0.8057 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.806
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9917000762561337, 'loss_val': 0.09434353285294049, 'psi': 0.9943916444880401}-{'f1_val': 0.9964794802860635, 'auprc': 0.9945133697005515, 'loss_val': 0.0885347181286667, 'psi': 0.9956930360518587}
[S6] START round=34 head_norm_before_train=2.086274 (no previous merge yet)
[S6] round=34 local utility u=0.164486 metrics={'f1_val': 0.823425715317523, 'auprc': 0.9558227124230023, 'loss_val': 0.40288186306071605, 'psi': 0.8763845141597146}-{'f1_val': 0.7998406957647491, 'auprc': 0.9443985522869226, 'loss_val': 0.5560712977479221, 'psi': 0.8576638383736186}
[S7] START round=34 head_norm_before_train=1.709176 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=34 local utility u=0.211264 metrics={'f1_val': 0.646146650772722, 'auprc': 0.8128300623619323, 'loss_val': 0.5521580857244415, 'psi': 0.7128200154084061}-{'f1_val': 0.5980660215075538, 'auprc': 0.8030554302823645, 'loss_val': 0.656879150815731, 'psi': 0.6800617850174782}
[S8] START round=34 head_norm_before_train=1.096102 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9938464732474644, 'auprc': 0.9973032178590976, 'loss_val': 0.08850638439066356, 'psi': 0.9952291710921177}-{'f1_val': 0.9923086083290242, 'auprc': 0.9981146984175566, 'loss_val': 0.059373443722078784, 'psi': 0.9946310443644373}
[S9] START round=34 head_norm_before_train=1.776453 cos_to_last_merge=0.7952 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9994594173717566, 'loss_val': 0.0402417624823948, 'psi': 0.9935155799175057}-{'f1_val': 0.9958267183641853, 'auprc': 0.9995453107468738, 'loss_val': 0.02377187555663509, 'psi': 0.9973141553172608}
[S10] START round=34 head_norm_before_train=1.848364 cos_to_last_merge=0.7482 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.748
[S10] round=34 local utility u=0.000196 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995498963936931, 'loss_val': 0.026872334265925495, 'psi': 0.9952616664204313}-{'f1_val': 0.9951034680760983, 'auprc': 0.995506930898007, 'loss_val': 0.027287380828293455, 'psi': 0.9952648532048618}
[S11] START round=34 head_norm_before_train=1.487731 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.015046 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983116624675389, 'loss_val': 0.09315533114731668, 'psi': 0.9972651473707438}-{'f1_val': 0.996567470639547, 'auprc': 0.9983079651429783, 'loss_val': 0.12323575747275718, 'psi': 0.9972636684409195}
[S13] START round=34 head_norm_before_train=1.254522 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.017096 metrics={'f1_val': 0.6284206301968972, 'auprc': 0.7240006409368571, 'loss_val': 0.7890054385077144, 'psi': 0.6666526344928811}-{'f1_val': 0.6155007518837843, 'auprc': 0.7569204053830246, 'loss_val': 0.8444383356569575, 'psi': 0.6720686132834804}
[S14] START round=34 head_norm_before_train=1.876722 cos_to_last_merge=0.9999 (last merge round=32)
[S14] round=34 local utility u=0.001521 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9968940173047849, 'loss_val': 0.03313610616928588, 'psi': 0.9968240714933757}-{'f1_val': 0.9974055297193176, 'auprc': 0.9967740286419305, 'loss_val': 0.03958738613628457, 'psi': 0.9971529292883627}
[S15] START round=34 head_norm_before_train=1.390099 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7818048264148875, 'auprc': 0.9860727674669929, 'loss_val': 0.3360301865560269, 'psi': 0.8635120028357297}-{'f1_val': 0.9921539778115896, 'auprc': 0.9934217494694182, 'loss_val': 0.08116968185620423, 'psi': 0.992661086474721}
[S16] START round=34 head_norm_before_train=1.990635 (no previous merge yet)
[S16] round=34 local utility u=0.061424 metrics={'f1_val': 0.9264602827290972, 'auprc': 0.9862260277180248, 'loss_val': 0.4047128423220805, 'psi': 0.9503665807246683}-{'f1_val': 0.9133014771064307, 'auprc': 0.9841403609040703, 'loss_val': 0.44235008137660686, 'psi': 0.9416370306254866}
[S17] START round=34 head_norm_before_train=1.143273 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5884900146309624, 'auprc': 0.7548213726483999, 'loss_val': 0.80886485847003, 'psi': 0.6550225578379374}-{'f1_val': 0.6353922544643182, 'auprc': 0.7118352993568906, 'loss_val': 0.8219692424053887, 'psi': 0.6659694724213472}
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → trigger blocked (psi=0.876)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[S7] not sending this round → trigger blocked (psi=0.713)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:52808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:52814
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9986
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=0.2280
[S7] RECEIVED delta(kind=head bytes=1804) from S13
[S7] cosine check vs S13: cos=0.4255
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.9872
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9938 head_norm=1.160686
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.092909e+00
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9941 head_norm=1.326455 delta_norm=1.092909
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9968 head_norm=1.894148
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.184774e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9968 head_norm=1.876069 delta_norm=0.051848
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6461 head_norm=1.716434
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.178005e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6365 head_norm=1.506542 delta_norm=0.317801
[S7] aggregate: ROLLBACK (f1_val pre=0.646 post=0.636 tol_abs=0.005 tol_rel=0.0)
[S2] START round=35 head_norm_before_train=2.135573 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8303409821218858, 'auprc': 0.988314695337789, 'loss_val': 0.3356815402137077, 'psi': 0.8935304674082472}-{'f1_val': 0.9146377413089284, 'auprc': 0.9718764123419985, 'loss_val': 0.16842093629776977, 'psi': 0.9375332097221565}
[S3] START round=35 head_norm_before_train=1.995803 (no previous merge yet)
[S3] round=35 local utility u=0.188736 metrics={'f1_val': 0.8785947908643963, 'auprc': 0.9955759679991051, 'loss_val': 0.24376969712661456, 'psi': 0.9253872617182799}-{'f1_val': 0.8431027896635914, 'auprc': 0.9767409165946033, 'loss_val': 0.3517847757508141, 'psi': 0.8965580404359962}
[S4] START round=35 head_norm_before_train=2.052894 (no previous merge yet)
[S4] round=35 local utility u=0.043583 metrics={'f1_val': 0.9397129694221241, 'auprc': 0.9452497328199794, 'loss_val': 0.3179373836363076, 'psi': 0.9419276747812662}-{'f1_val': 0.9373908032109788, 'auprc': 0.9259571483640094, 'loss_val': 0.33329212184015244, 'psi': 0.9328173412721911}
[S5] START round=35 head_norm_before_train=1.501388 cos_to_last_merge=0.8051 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.805
[S5] round=35 local utility u=0.018649 metrics={'f1_val': 0.9967731002659072, 'auprc': 0.9982481140892319, 'loss_val': 0.08021139251495418, 'psi': 0.997363105795237}-{'f1_val': 0.996186023309311, 'auprc': 0.9917000762561337, 'loss_val': 0.09434353285294049, 'psi': 0.9943916444880401}
[S6] START round=35 head_norm_before_train=2.099901 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.6189140708787776, 'auprc': 0.7107561807748433, 'loss_val': 1.1971826227652271, 'psi': 0.6556509148372038}-{'f1_val': 0.823425715317523, 'auprc': 0.9558227124230023, 'loss_val': 0.40288186306071605, 'psi': 0.8763845141597146}
[S7] START round=35 head_norm_before_train=1.506542 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5557987749251606, 'auprc': 0.7948377844700208, 'loss_val': 0.7508998023080236, 'psi': 0.6514143787431047}-{'f1_val': 0.646146650772722, 'auprc': 0.8128300623619323, 'loss_val': 0.5521580857244415, 'psi': 0.7128200154084061}
[S8] START round=35 head_norm_before_train=1.326455 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9919561654725609, 'auprc': 0.9964264089284149, 'loss_val': 0.201774419866237, 'psi': 0.9937442628549026}-{'f1_val': 0.9938464732474644, 'auprc': 0.9973032178590976, 'loss_val': 0.08850638439066356, 'psi': 0.9952291710921177}
[S9] START round=35 head_norm_before_train=1.788085 cos_to_last_merge=0.7938 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=35 local utility u=0.023699 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.994831580527519, 'loss_val': 0.021605653082772208, 'psi': 0.9959289392993425}-{'f1_val': 0.9895530216146718, 'auprc': 0.9994594173717566, 'loss_val': 0.0402417624823948, 'psi': 0.9935155799175057}
[S10] START round=35 head_norm_before_train=1.859261 cos_to_last_merge=0.7472 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.747
[S10] round=35 local utility u=0.001763 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9955072751303482, 'loss_val': 0.02585952519960084, 'psi': 0.9955138931337324}-{'f1_val': 0.9951034680760983, 'auprc': 0.995498963936931, 'loss_val': 0.026872334265925495, 'psi': 0.9952616664204313}
[S11] START round=35 head_norm_before_train=1.520402 cos_to_last_merge=0.9995 (last merge round=33)
[S11] round=35 local utility u=0.008437 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983271959049101, 'loss_val': 0.0763272136281058, 'psi': 0.9972713607456922}-{'f1_val': 0.996567470639547, 'auprc': 0.9983116624675389, 'loss_val': 0.09315533114731668, 'psi': 0.9972651473707438}
[S13] START round=35 head_norm_before_train=1.296132 cos_to_last_merge=0.9984 (last merge round=33)
[S13] round=35 local utility u=0.043271 metrics={'f1_val': 0.6508605180969631, 'auprc': 0.6957316391633361, 'loss_val': 0.7522959035363901, 'psi': 0.6688089665235123}-{'f1_val': 0.6284206301968972, 'auprc': 0.7240006409368571, 'loss_val': 0.7890054385077144, 'psi': 0.6666526344928811}
[S14] START round=35 head_norm_before_train=1.876069 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.000809 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.99684346126253, 'loss_val': 0.03516813532324507, 'psi': 0.9971839810657088}-{'f1_val': 0.9967774409524363, 'auprc': 0.9968940173047849, 'loss_val': 0.03313610616928588, 'psi': 0.9968240714933757}
[S15] START round=35 head_norm_before_train=1.449307 cos_to_last_merge=0.9988 (last merge round=33)
[S15] round=35 local utility u=0.017661 metrics={'f1_val': 0.7832389360668852, 'auprc': 0.9917146827580272, 'loss_val': 0.32623764731794025, 'psi': 0.866629234743342}-{'f1_val': 0.7818048264148875, 'auprc': 0.9860727674669929, 'loss_val': 0.3360301865560269, 'psi': 0.8635120028357297}
[S16] START round=35 head_norm_before_train=2.000992 (no previous merge yet)
[S16] round=35 local utility u=0.387277 metrics={'f1_val': 0.9913128954493902, 'auprc': 0.9936734362909703, 'loss_val': 0.04161697184996036, 'psi': 0.9922571117860222}-{'f1_val': 0.9264602827290972, 'auprc': 0.9862260277180248, 'loss_val': 0.4047128423220805, 'psi': 0.9503665807246683}
[S17] START round=35 head_norm_before_train=1.201150 cos_to_last_merge=0.9976 (last merge round=33)
[S17] round=35 local utility u=0.269171 metrics={'f1_val': 0.60929679371975, 'auprc': 0.8647225679237981, 'loss_val': 0.7250680016061604, 'psi': 0.7114671034013692}-{'f1_val': 0.5884900146309624, 'auprc': 0.7548213726483999, 'loss_val': 0.80886485847003, 'psi': 0.6550225578379374}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:52812
[S13] not sending this round → trigger blocked (psi=0.669)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.992)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:52812
[S3] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S9
[S17] cosine check vs S9: cos=0.4911
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] cosine check vs S4: cos=0.2492
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.3412
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] cosine check vs S15: cos=-0.1015
[S9] DROPPED delta from S15 (cos=-0.1015 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1806) from S5
[S11] cosine check vs S5: cos=0.3793
[S11] RECEIVED delta(kind=head bytes=1791) from S3
[S11] cosine check vs S3: cos=0.9423
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] cosine check vs S11: cos=0.2901
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.9261
[S2] ⇄ pheromone p=0.091 → S8@127.0.0.1:52809
[S10] ⇄ pheromone p=0.003 → S14@127.0.0.1:52814
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.6509 head_norm=1.359541
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.564270e-01
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.6579 head_norm=1.283378 delta_norm=0.256427
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.060 → S7@127.0.0.1:52808
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9920 head_norm=1.392375
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.136555e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9920 head_norm=1.055263 delta_norm=0.613656
[S8] aggregate: ACCEPT kept=['S4', 'S14', 'S11'] (k=3/3) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.010 → S15@127.0.0.1:52815
[S6] ⇄ pheromone p=0.319 → S17@127.0.0.1:52817
[S7] ⇄ pheromone p=0.125 → S17@127.0.0.1:52817
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.9966 head_norm=1.551824
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.510996e-01
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.9966 head_norm=1.407477 delta_norm=0.251100
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.029 → S8@127.0.0.1:52809
[S4] ⇄ pheromone p=0.033 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.251 → S11@127.0.0.1:52812
[S5] ⇄ pheromone p=0.143 → S11@127.0.0.1:52812
[S15] ⇄ pheromone p=0.250 → S9@127.0.0.1:52810
[S14] ⇄ pheromone p=0.008 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.015 → S17@127.0.0.1:52817
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=35 metric=0.6093 head_norm=1.255896
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.045141e-01
[S17] stored merged vector for next round verification (round=35)
[S17] DEBUG after merge:  round=35 metric=0.5970 head_norm=1.324897 delta_norm=0.804514
[S17] aggregate: ROLLBACK (f1_val pre=0.609 post=0.597 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.250 → S13@127.0.0.1:52813
[S16] ⇄ pheromone p=0.178 → S7@127.0.0.1:52808
[S2] START round=36 head_norm_before_train=2.146328 (no previous merge yet)
[S2] round=36 local utility u=0.320750 metrics={'f1_val': 0.914432623785729, 'auprc': 0.9769778751000475, 'loss_val': 0.1647216239686841, 'psi': 0.9394507243114565}-{'f1_val': 0.8303409821218858, 'auprc': 0.988314695337789, 'loss_val': 0.3356815402137077, 'psi': 0.8935304674082472}
[S3] START round=36 head_norm_before_train=2.015146 (no previous merge yet)
[S3] round=36 local utility u=0.080092 metrics={'f1_val': 0.9059699271528423, 'auprc': 0.9801147795932207, 'loss_val': 0.2014528083810483, 'psi': 0.9356278681289937}-{'f1_val': 0.8785947908643963, 'auprc': 0.9955759679991051, 'loss_val': 0.24376969712661456, 'psi': 0.9253872617182799}
[S4] START round=36 head_norm_before_train=2.053232 (no previous merge yet)
[S4] round=36 local utility u=0.086367 metrics={'f1_val': 0.9500105938974599, 'auprc': 0.9758786564185007, 'loss_val': 0.29887568029657324, 'psi': 0.9603578189058762}-{'f1_val': 0.9397129694221241, 'auprc': 0.9452497328199794, 'loss_val': 0.3179373836363076, 'psi': 0.9419276747812662}
[S5] START round=36 head_norm_before_train=1.510751 cos_to_last_merge=0.8046 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.805
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.9143562783832028, 'auprc': 0.991660715036621, 'loss_val': 0.13532854274446307, 'psi': 0.94527805304457}-{'f1_val': 0.9967731002659072, 'auprc': 0.9982481140892319, 'loss_val': 0.08021139251495418, 'psi': 0.997363105795237}
[S6] START round=36 head_norm_before_train=2.113024 (no previous merge yet)
[S6] round=36 local utility u=0.107298 metrics={'f1_val': 0.6159584166893418, 'auprc': 0.7698826659257584, 'loss_val': 1.1422321009451968, 'psi': 0.6775281163839084}-{'f1_val': 0.6189140708787776, 'auprc': 0.7107561807748433, 'loss_val': 1.1971826227652271, 'psi': 0.6556509148372038}
[S7] START round=36 head_norm_before_train=1.516472 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=36 local utility u=0.305275 metrics={'f1_val': 0.6250377854097846, 'auprc': 0.8043926462492521, 'loss_val': 0.5844481313123192, 'psi': 0.6967797297455716}-{'f1_val': 0.5557987749251606, 'auprc': 0.7948377844700208, 'loss_val': 0.7508998023080236, 'psi': 0.6514143787431047}
[S8] START round=36 head_norm_before_train=1.055263 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.054241 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9981039577580004, 'loss_val': 0.10747061992868608, 'psi': 0.9953298999445745}-{'f1_val': 0.9919561654725609, 'auprc': 0.9964264089284149, 'loss_val': 0.201774419866237, 'psi': 0.9937442628549026}
[S9] START round=36 head_norm_before_train=1.796641 cos_to_last_merge=0.7922 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=36 local utility u=0.007529 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995602532244036, 'loss_val': 0.020732878382887985, 'psi': 0.9978204083780963}-{'f1_val': 0.9966605118138915, 'auprc': 0.994831580527519, 'loss_val': 0.021605653082772208, 'psi': 0.9959289392993425}
[S10] START round=36 head_norm_before_train=1.871045 cos_to_last_merge=0.7463 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.746
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995493859973521, 'loss_val': 0.02639243109536336, 'psi': 0.9952596248350674}-{'f1_val': 0.9955183051359886, 'auprc': 0.9955072751303482, 'loss_val': 0.02585952519960084, 'psi': 0.9955138931337324}
[S11] START round=36 head_norm_before_train=1.407477 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984525918992583, 'loss_val': 0.0817919798851391, 'psi': 0.9973215191434315}-{'f1_val': 0.996567470639547, 'auprc': 0.9983271959049101, 'loss_val': 0.0763272136281058, 'psi': 0.9972713607456922}
[S13] START round=36 head_norm_before_train=1.283378 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.417718 metrics={'f1_val': 0.7348864960930271, 'auprc': 0.7730497631355047, 'loss_val': 0.65297054752797, 'psi': 0.7501518029100182}-{'f1_val': 0.6508605180969631, 'auprc': 0.6957316391633361, 'loss_val': 0.7522959035363901, 'psi': 0.6688089665235123}
[S14] START round=36 head_norm_before_train=1.889620 cos_to_last_merge=0.9999 (last merge round=34)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9968526185203415, 'loss_val': 0.03405283703088721, 'psi': 0.9969414753366832}-{'f1_val': 0.9974109942678281, 'auprc': 0.99684346126253, 'loss_val': 0.03516813532324507, 'psi': 0.9971839810657088}
[S15] START round=36 head_norm_before_train=1.512009 cos_to_last_merge=0.9956 (last merge round=33)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7317979602734912, 'auprc': 0.874485638807744, 'loss_val': 0.49764020640172296, 'psi': 0.7888730316871924}-{'f1_val': 0.7832389360668852, 'auprc': 0.9917146827580272, 'loss_val': 0.32623764731794025, 'psi': 0.866629234743342}
[S16] START round=36 head_norm_before_train=2.012098 (no previous merge yet)
[S16] round=36 local utility u=0.004176 metrics={'f1_val': 0.9923817311281451, 'auprc': 0.9932512636346009, 'loss_val': 0.03841120920503317, 'psi': 0.9927295441307273}-{'f1_val': 0.9913128954493902, 'auprc': 0.9936734362909703, 'loss_val': 0.04161697184996036, 'psi': 0.9922571117860222}
[S17] START round=36 head_norm_before_train=1.324897 cos_to_last_merge=1.0000 (last merge round=35)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.38042974506374316, 'auprc': 0.5833371431890251, 'loss_val': 1.9239901922489537, 'psi': 0.4615927043138559}-{'f1_val': 0.60929679371975, 'auprc': 0.8647225679237981, 'loss_val': 0.7250680016061604, 'psi': 0.7114671034013692}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.936)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[S4] not sending this round → trigger blocked (psi=0.960)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S13
[S7] cosine check vs S13: cos=0.6009
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9535
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.3260
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] cosine check vs S7: cos=0.4307
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.8669
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.6250 head_norm=1.527962
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.482361e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.6226 head_norm=1.451398 delta_norm=0.148236
[S7] aggregate: ACCEPT kept=['S13', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.7318 head_norm=1.553904
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.964942e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.7276 head_norm=1.320415 delta_norm=0.396494
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.3804 head_norm=1.358594
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.748683e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.3753 head_norm=1.171319 delta_norm=0.674868
[S17] aggregate: ROLLBACK (f1_val pre=0.380 post=0.375 tol_abs=0.005 tol_rel=0.0)
[S2] START round=37 head_norm_before_train=2.153710 (no previous merge yet)
[S2] round=37 local utility u=0.013365 metrics={'f1_val': 0.9162212341657195, 'auprc': 0.9706916993555862, 'loss_val': 0.12986380776086726, 'psi': 0.9380094202416662}-{'f1_val': 0.914432623785729, 'auprc': 0.9769778751000475, 'loss_val': 0.1647216239686841, 'psi': 0.9394507243114565}
[S3] START round=37 head_norm_before_train=2.032840 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8086008027078793, 'auprc': 0.9985114077694042, 'loss_val': 0.44673037739144966, 'psi': 0.8845650447324892}-{'f1_val': 0.9059699271528423, 'auprc': 0.9801147795932207, 'loss_val': 0.2014528083810483, 'psi': 0.9356278681289937}
[S4] START round=37 head_norm_before_train=2.056833 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.947501904863812, 'auprc': 0.962020518259251, 'loss_val': 0.3083681717055828, 'psi': 0.9533093502219876}-{'f1_val': 0.9500105938974599, 'auprc': 0.9758786564185007, 'loss_val': 0.29887568029657324, 'psi': 0.9603578189058762}
[S5] START round=37 head_norm_before_train=1.523329 cos_to_last_merge=0.8038 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7015397642156803, 'auprc': 0.9879400802476881, 'loss_val': 0.26474069649572424, 'psi': 0.8160998906284834}-{'f1_val': 0.9143562783832028, 'auprc': 0.991660715036621, 'loss_val': 0.13532854274446307, 'psi': 0.94527805304457}
[S6] START round=37 head_norm_before_train=2.120073 (no previous merge yet)
[S6] round=37 local utility u=0.948082 metrics={'f1_val': 0.7439101316835968, 'auprc': 0.9336483594116767, 'loss_val': 0.5050760048420593, 'psi': 0.8198054227748288}-{'f1_val': 0.6159584166893418, 'auprc': 0.7698826659257584, 'loss_val': 1.1422321009451968, 'psi': 0.6775281163839084}
[S7] START round=37 head_norm_before_train=1.451398 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.543464877336529, 'auprc': 0.792728309960435, 'loss_val': 0.8053722769381876, 'psi': 0.6431702503860914}-{'f1_val': 0.6250377854097846, 'auprc': 0.8043926462492521, 'loss_val': 0.5844481313123192, 'psi': 0.6967797297455716}
[S8] START round=37 head_norm_before_train=1.177619 cos_to_last_merge=0.9909 (last merge round=35)
[S8] round=37 local utility u=0.014920 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9980870991854935, 'loss_val': 0.07192585574203955, 'psi': 0.9947576744234985}-{'f1_val': 0.9934805280689575, 'auprc': 0.9981039577580004, 'loss_val': 0.10747061992868608, 'psi': 0.9953298999445745}
[S9] START round=37 head_norm_before_train=1.801702 cos_to_last_merge=0.7916 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9995627650994645, 'loss_val': 0.02846436593875471, 'psi': 0.9955679760781893}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995602532244036, 'loss_val': 0.020732878382887985, 'psi': 0.9978204083780963}
[S10] START round=37 head_norm_before_train=1.882778 cos_to_last_merge=0.7453 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.745
[S10] round=37 local utility u=0.001692 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9955027692286412, 'loss_val': 0.02552397021864317, 'psi': 0.9955120907730497}-{'f1_val': 0.9951034680760983, 'auprc': 0.995493859973521, 'loss_val': 0.02639243109536336, 'psi': 0.9952596248350674}
[S11] START round=37 head_norm_before_train=1.438098 cos_to_last_merge=0.9997 (last merge round=35)
[S11] round=37 local utility u=0.002318 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9980117403101749, 'loss_val': 0.07335374995305881, 'psi': 0.9968971809705172}-{'f1_val': 0.996567470639547, 'auprc': 0.9984525918992583, 'loss_val': 0.0817919798851391, 'psi': 0.9973215191434315}
[S13] START round=37 head_norm_before_train=1.335146 cos_to_last_merge=0.9981 (last merge round=35)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6305955544241028, 'auprc': 0.6513361482397386, 'loss_val': 0.8435794956053294, 'psi': 0.6388917919503572}-{'f1_val': 0.7348864960930271, 'auprc': 0.7730497631355047, 'loss_val': 0.65297054752797, 'psi': 0.7501518029100182}
[S14] START round=37 head_norm_before_train=1.903100 cos_to_last_merge=0.9998 (last merge round=34)
[S14] round=37 local utility u=0.006045 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9989288992663985, 'loss_val': 0.030654089592744106, 'psi': 0.9980181562672563}-{'f1_val': 0.9970007132142444, 'auprc': 0.9968526185203415, 'loss_val': 0.03405283703088721, 'psi': 0.9969414753366832}
[S15] START round=37 head_norm_before_train=1.320415 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9917435854595178, 'auprc': 0.9954588549190088, 'loss_val': 0.10274292580077449, 'psi': 0.9932296932433142}-{'f1_val': 0.7317979602734912, 'auprc': 0.874485638807744, 'loss_val': 0.49764020640172296, 'psi': 0.7888730316871924}
[S16] START round=37 head_norm_before_train=2.020319 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9917505555831294, 'auprc': 0.9935783534382776, 'loss_val': 0.039031775859747514, 'psi': 0.9924816747251888}-{'f1_val': 0.9923817311281451, 'auprc': 0.9932512636346009, 'loss_val': 0.03841120920503317, 'psi': 0.9927295441307273}
[S17] START round=37 head_norm_before_train=1.171319 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.573099 metrics={'f1_val': 0.38156027531388637, 'auprc': 0.7782249207670565, 'loss_val': 1.3692385999163623, 'psi': 0.5402261334951545}-{'f1_val': 0.38042974506374316, 'auprc': 0.5833371431890251, 'loss_val': 1.9239901922489537, 'psi': 0.4615927043138559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:52811
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:52802
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=0.9560
[S3] RECEIVED delta(kind=head bytes=1795) from S11
[S3] cosine check vs S11: cos=0.8880
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] cosine check vs S14: cos=0.9984
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:52807
[S17] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S17
[S6] cosine check vs S17: cos=0.6620
[S8] sending update (kind=head size=1793 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=0.5129
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.7439 head_norm=2.129221
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.038731e-01
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.7367 head_norm=1.535745 delta_norm=0.803873
[S6] aggregate: ROLLBACK (f1_val pre=0.744 post=0.737 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=37 metric=0.9955 head_norm=1.887919
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.586546e-02
[S10] stored merged vector for next round verification (round=37)
[S10] DEBUG after merge:  round=37 metric=0.9955 head_norm=1.901704 delta_norm=0.055865
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.8086 head_norm=2.048794
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.026324e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.7870 head_norm=1.710212 delta_norm=0.502632
[S3] aggregate: ROLLBACK (f1_val pre=0.809 post=0.787 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9925 head_norm=1.280833
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.011853e-01
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9925 head_norm=1.310108 delta_norm=0.201185
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=37 metric=0.9162 head_norm=2.161740
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.318179e-01
[S2] stored merged vector for next round verification (round=37)
[S2] DEBUG after merge:  round=37 metric=0.9159 head_norm=1.512793 delta_norm=0.931818
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.512793 cos_to_last_merge=1.0000 (last merge round=37)
[S2] round=38 local utility u=0.001137 metrics={'f1_val': 0.914984211845635, 'auprc': 0.9812755712085144, 'loss_val': 0.15191894747088103, 'psi': 0.9415007555907868}-{'f1_val': 0.9162212341657195, 'auprc': 0.9706916993555862, 'loss_val': 0.12986380776086726, 'psi': 0.9380094202416662}
[S3] START round=38 head_norm_before_train=1.710212 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.78251800002087, 'auprc': 0.9639511899331208, 'loss_val': 0.4957990275496481, 'psi': 0.8550912759857703}-{'f1_val': 0.8086008027078793, 'auprc': 0.9985114077694042, 'loss_val': 0.44673037739144966, 'psi': 0.8845650447324892}
[S4] START round=38 head_norm_before_train=2.069370 (no previous merge yet)
[S4] round=38 local utility u=0.007127 metrics={'f1_val': 0.9505521196780466, 'auprc': 0.9602526802150102, 'loss_val': 0.307111300746657, 'psi': 0.954432343892832}-{'f1_val': 0.947501904863812, 'auprc': 0.962020518259251, 'loss_val': 0.3083681717055828, 'psi': 0.9533093502219876}
[S5] START round=38 head_norm_before_train=1.533512 cos_to_last_merge=0.8030 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.803
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.7145028925575769, 'auprc': 0.821899094106612, 'loss_val': 0.3653210032519084, 'psi': 0.757461373177191}-{'f1_val': 0.7015397642156803, 'auprc': 0.9879400802476881, 'loss_val': 0.26474069649572424, 'psi': 0.8160998906284834}
[S6] START round=38 head_norm_before_train=1.535745 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.7074881139498638, 'auprc': 0.9468978947409554, 'loss_val': 0.6993854076203652, 'psi': 0.8032520262663004}-{'f1_val': 0.7439101316835968, 'auprc': 0.9336483594116767, 'loss_val': 0.5050760048420593, 'psi': 0.8198054227748288}
[S7] START round=38 head_norm_before_train=1.461637 cos_to_last_merge=0.9999 (last merge round=36)
[S7] round=38 local utility u=0.599839 metrics={'f1_val': 0.6687333388516692, 'auprc': 0.8283449323487584, 'loss_val': 0.4641552351096454, 'psi': 0.7325779762505049}-{'f1_val': 0.543464877336529, 'auprc': 0.792728309960435, 'loss_val': 0.8053722769381876, 'psi': 0.6431702503860914}
[S8] START round=38 head_norm_before_train=1.310108 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.011981 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9981728748781633, 'loss_val': 0.049494300257111185, 'psi': 0.9949193290101574}-{'f1_val': 0.9925380579155019, 'auprc': 0.9980870991854935, 'loss_val': 0.07192585574203955, 'psi': 0.9947576744234985}
[S9] START round=38 head_norm_before_train=1.804847 cos_to_last_merge=0.7910 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=38 local utility u=0.015167 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995609732266617, 'loss_val': 0.02065997090306622, 'psi': 0.9978206963789995}-{'f1_val': 0.992904783397339, 'auprc': 0.9995627650994645, 'loss_val': 0.02846436593875471, 'psi': 0.9955679760781893}
[S10] START round=38 head_norm_before_train=1.901704 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9955068839295548, 'loss_val': 0.0255041063072067, 'psi': 0.9952648344174808}-{'f1_val': 0.9955183051359886, 'auprc': 0.9955027692286412, 'loss_val': 0.02552397021864317, 'psi': 0.9955120907730497}
[S11] START round=38 head_norm_before_train=1.468799 cos_to_last_merge=0.9988 (last merge round=35)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.8719103099146529, 'auprc': 0.9966011180892835, 'loss_val': 0.18105058841683003, 'psi': 0.9217866331845052}-{'f1_val': 0.9961541414107454, 'auprc': 0.9980117403101749, 'loss_val': 0.07335374995305881, 'psi': 0.9968971809705172}
[S13] START round=38 head_norm_before_train=1.377788 cos_to_last_merge=0.9947 (last merge round=35)
[S13] round=38 local utility u=0.569103 metrics={'f1_val': 0.7574524283181601, 'auprc': 0.74550473674468, 'loss_val': 0.7490213970184573, 'psi': 0.752673351688768}-{'f1_val': 0.6305955544241028, 'auprc': 0.6513361482397386, 'loss_val': 0.8435794956053294, 'psi': 0.6388917919503572}
[S14] START round=38 head_norm_before_train=1.917019 cos_to_last_merge=0.9996 (last merge round=34)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9971193220402326, 'loss_val': 0.028539803395579467, 'psi': 0.9972943253767899}-{'f1_val': 0.9974109942678281, 'auprc': 0.9989288992663985, 'loss_val': 0.030654089592744106, 'psi': 0.9980181562672563}
[S15] START round=38 head_norm_before_train=1.368642 cos_to_last_merge=0.9990 (last merge round=36)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7022652227388068, 'auprc': 0.9106830733637068, 'loss_val': 0.4606869895779997, 'psi': 0.7856323629887667}-{'f1_val': 0.9917435854595178, 'auprc': 0.9954588549190088, 'loss_val': 0.10274292580077449, 'psi': 0.9932296932433142}
[S16] START round=38 head_norm_before_train=2.028530 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9768094690693141, 'auprc': 0.9941225916716473, 'loss_val': 0.08345489114316872, 'psi': 0.9837347181102474}-{'f1_val': 0.9917505555831294, 'auprc': 0.9935783534382776, 'loss_val': 0.039031775859747514, 'psi': 0.9924816747251888}
[S17] START round=38 head_norm_before_train=1.214852 cos_to_last_merge=0.9987 (last merge round=36)
[S17] round=38 local utility u=1.000000 metrics={'f1_val': 0.6160342991600579, 'auprc': 0.801528384851699, 'loss_val': 0.7587388758783887, 'psi': 0.6902319334367144}-{'f1_val': 0.38156027531388637, 'auprc': 0.7782249207670565, 'loss_val': 1.3692385999163623, 'psi': 0.5402261334951545}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S13
[S17] cosine check vs S13: cos=0.9580
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:52802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:52816
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:52807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:52815
[S8] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=0.7057
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=0.9237
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] cosine check vs S17: cos=0.8490
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=-0.1181
[S15] DROPPED delta from S9 (cos=-0.1181 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.7075 head_norm=1.570032
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.163041e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.7016 head_norm=1.362813 delta_norm=0.416304
[S6] aggregate: ROLLBACK (f1_val pre=0.707 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.9150 head_norm=1.550852
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.672554e-01
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.9150 head_norm=1.352402 delta_norm=0.567255
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9768 head_norm=2.037660
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.407546e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9779 head_norm=1.722141 delta_norm=0.440755
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.6160 head_norm=1.263382
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.110637e-01
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.6324 head_norm=1.331068 delta_norm=0.211064
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.352402 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.910984344921133, 'auprc': 0.9678409776957613, 'loss_val': 0.276975779485921, 'psi': 0.9337269980309844}-{'f1_val': 0.914984211845635, 'auprc': 0.9812755712085144, 'loss_val': 0.15191894747088103, 'psi': 0.9415007555907868}
[S3] START round=39 head_norm_before_train=1.726281 cos_to_last_merge=0.9999 (last merge round=37)
[S3] round=39 local utility u=0.708601 metrics={'f1_val': 0.942445627059619, 'auprc': 0.9995974547611253, 'loss_val': 0.1451014808783194, 'psi': 0.9653063581402215}-{'f1_val': 0.78251800002087, 'auprc': 0.9639511899331208, 'loss_val': 0.4957990275496481, 'psi': 0.8550912759857703}
[S4] START round=39 head_norm_before_train=2.071068 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9448869768419532, 'auprc': 0.9511516200728087, 'loss_val': 0.3039365506039982, 'psi': 0.9473928341342954}-{'f1_val': 0.9505521196780466, 'auprc': 0.9602526802150102, 'loss_val': 0.307111300746657, 'psi': 0.954432343892832}
[S5] START round=39 head_norm_before_train=1.540338 cos_to_last_merge=0.8023 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.9960452462189745, 'auprc': 0.9948836938916212, 'loss_val': 0.0775289175914398, 'psi': 0.9955806252880333}-{'f1_val': 0.7145028925575769, 'auprc': 0.821899094106612, 'loss_val': 0.3653210032519084, 'psi': 0.757461373177191}
[S6] START round=39 head_norm_before_train=1.362813 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7019461590917336, 'auprc': 0.8930039426390397, 'loss_val': 0.6551794084473401, 'psi': 0.7783692725106561}-{'f1_val': 0.7074881139498638, 'auprc': 0.9468978947409554, 'loss_val': 0.6993854076203652, 'psi': 0.8032520262663004}
[S7] START round=39 head_norm_before_train=1.472417 cos_to_last_merge=0.9995 (last merge round=36)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5645987895497279, 'auprc': 0.7947616496837907, 'loss_val': 0.6946001292670148, 'psi': 0.6566639336033531}-{'f1_val': 0.6687333388516692, 'auprc': 0.8283449323487584, 'loss_val': 0.4641552351096454, 'psi': 0.7325779762505049}
[S8] START round=39 head_norm_before_train=1.377098 cos_to_last_merge=0.9993 (last merge round=37)
[S8] round=39 local utility u=0.006462 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9980835859705897, 'loss_val': 0.04400566059041522, 'psi': 0.9956539615328113}-{'f1_val': 0.992750298431487, 'auprc': 0.9981728748781633, 'loss_val': 0.049494300257111185, 'psi': 0.9949193290101574}
[S9] START round=39 head_norm_before_train=1.811090 cos_to_last_merge=0.7901 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9995656755292199, 'loss_val': 0.021906924445882672, 'psi': 0.9973223012301993}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995609732266617, 'loss_val': 0.02065997090306622, 'psi': 0.9978206963789995}
[S10] START round=39 head_norm_before_train=1.910700 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=39 local utility u=0.001465 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9955033977397587, 'loss_val': 0.025053134704638196, 'psi': 0.9955123421774966}-{'f1_val': 0.9951034680760983, 'auprc': 0.9955068839295548, 'loss_val': 0.0255041063072067, 'psi': 0.9952648344174808}
[S11] START round=39 head_norm_before_train=1.497775 cos_to_last_merge=0.9976 (last merge round=35)
[S11] round=39 local utility u=0.215116 metrics={'f1_val': 0.9338873771931556, 'auprc': 0.9966471000531936, 'loss_val': 0.12281867657830248, 'psi': 0.9589912663371707}-{'f1_val': 0.8719103099146529, 'auprc': 0.9966011180892835, 'loss_val': 0.18105058841683003, 'psi': 0.9217866331845052}
[S13] START round=39 head_norm_before_train=1.427041 cos_to_last_merge=0.9897 (last merge round=35)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.7585866847418329, 'auprc': 0.7434030287687073, 'loss_val': 0.7531663775060353, 'psi': 0.7525132223525827}-{'f1_val': 0.7574524283181601, 'auprc': 0.74550473674468, 'loss_val': 0.7490213970184573, 'psi': 0.752673351688768}
[S14] START round=39 head_norm_before_train=1.931309 cos_to_last_merge=0.9993 (last merge round=34)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9959982554610078, 'loss_val': 0.028414505057522188, 'psi': 0.9965978070790023}-{'f1_val': 0.9974109942678281, 'auprc': 0.9971193220402326, 'loss_val': 0.028539803395579467, 'psi': 0.9972943253767899}
[S15] START round=39 head_norm_before_train=1.430385 cos_to_last_merge=0.9959 (last merge round=36)
[S15] round=39 local utility u=0.741820 metrics={'f1_val': 0.864147962715959, 'auprc': 0.992891604768084, 'loss_val': 0.19496885678919634, 'psi': 0.915645419536809}-{'f1_val': 0.7022652227388068, 'auprc': 0.9106830733637068, 'loss_val': 0.4606869895779997, 'psi': 0.7856323629887667}
[S16] START round=39 head_norm_before_train=1.722141 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.925834273008245, 'auprc': 0.9882713595256309, 'loss_val': 0.3747623378409913, 'psi': 0.9508091076151993}-{'f1_val': 0.9768094690693141, 'auprc': 0.9941225916716473, 'loss_val': 0.08345489114316872, 'psi': 0.9837347181102474}
[S17] START round=39 head_norm_before_train=1.331068 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5178795700914889, 'auprc': 0.7133044070222929, 'loss_val': 0.9840516037610972, 'psi': 0.5960495048638106}-{'f1_val': 0.6160342991600579, 'auprc': 0.801528384851699, 'loss_val': 0.7587388758783887, 'psi': 0.6902319334367144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:52803
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:52802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1790 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1790) from S8
[S2] cosine check vs S8: cos=0.8795
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=0.9770
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S11
[S3] cosine check vs S11: cos=0.9555
[S3]  timeout peer S2
[S2]  timeout peer S3
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=39 metric=0.9424 head_norm=1.745315
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.671373e-01
[S3] stored merged vector for next round verification (round=39)
[S3] DEBUG after merge:  round=39 metric=0.9282 head_norm=1.616972 delta_norm=0.267137
[S3] aggregate: ROLLBACK (f1_val pre=0.942 post=0.928 tol_abs=0.005 tol_rel=0.0)
[S3] r=40 psi=0.965 u=0.7086 p_local=0.2528 f1=0.942 auprc=1.000 bytes=35954
[S6] r=40 psi=0.778 u=0.0000 p_local=0.2631 f1=0.702 auprc=0.893 bytes=34167
[S5] r=40 psi=0.996 u=1.0000 p_local=0.2585 f1=0.996 auprc=0.995 bytes=35961
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0094 f1=0.996 auprc=1.000 bytes=30597
[S10] r=40 psi=0.996 u=0.0015 p_local=0.0016 f1=0.996 auprc=0.996 bytes=36013
[S7] r=40 psi=0.657 u=0.0000 p_local=0.1784 f1=0.565 auprc=0.795 bytes=32344
[S13] r=40 psi=0.753 u=0.0000 p_local=0.1585 f1=0.759 auprc=0.743 bytes=26991
[S11] r=40 psi=0.959 u=0.2151 p_local=0.0550 f1=0.934 auprc=0.997 bytes=34139
[S15] r=40 psi=0.916 u=0.7418 p_local=0.3788 f1=0.864 auprc=0.993 bytes=32398
[S16] r=40 psi=0.951 u=0.0000 p_local=0.0732 f1=0.926 auprc=0.988 bytes=32344
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=39 metric=0.9110 head_norm=1.457373
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.535880e-01
[S2] stored merged vector for next round verification (round=39)
[S2] DEBUG after merge:  round=39 metric=0.9106 head_norm=1.394564 delta_norm=0.353588
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] r=40 psi=0.934 u=0.0000 p_local=0.0720 f1=0.911 auprc=0.968 bytes=35972
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0041 f1=0.997 auprc=0.996 bytes=34146
[S4] r=40 psi=0.947 u=0.0000 p_local=0.0234 f1=0.945 auprc=0.951 bytes=30588
[S17] r=40 psi=0.596 u=0.0000 p_local=0.3356 f1=0.518 auprc=0.713 bytes=30585
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9940 head_norm=1.419764
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.602600e-01
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9940 head_norm=1.448020 delta_norm=0.160260
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.996 u=0.0065 p_local=0.0149 f1=0.994 auprc=0.998 bytes=34160
[S2] START round=40 head_norm_before_train=1.394564 cos_to_last_merge=1.0000 (last merge round=39)
[S2] round=40 local utility u=0.231181 metrics={'f1_val': 0.9654892642791397, 'auprc': 0.9745749015890856, 'loss_val': 0.16184494679502512, 'psi': 0.969123519203118}-{'f1_val': 0.910984344921133, 'auprc': 0.9678409776957613, 'loss_val': 0.276975779485921, 'psi': 0.9337269980309844}
[S3] START round=40 head_norm_before_train=1.616972 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.8938318123133578, 'auprc': 0.9841186511936816, 'loss_val': 0.22773449499831153, 'psi': 0.9299465478654874}-{'f1_val': 0.942445627059619, 'auprc': 0.9995974547611253, 'loss_val': 0.1451014808783194, 'psi': 0.9653063581402215}
[S4] START round=40 head_norm_before_train=2.071277 (no previous merge yet)
[S4] round=40 local utility u=0.013340 metrics={'f1_val': 0.9457927055490708, 'auprc': 0.9574409507325504, 'loss_val': 0.30155915459331367, 'psi': 0.9504520036224626}-{'f1_val': 0.9448869768419532, 'auprc': 0.9511516200728087, 'loss_val': 0.3039365506039982, 'psi': 0.9473928341342954}
[S5] START round=40 head_norm_before_train=1.544227 cos_to_last_merge=0.8021 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9916180385916634, 'loss_val': 0.08951144343519254, 'psi': 0.994358829422252}-{'f1_val': 0.9960452462189745, 'auprc': 0.9948836938916212, 'loss_val': 0.0775289175914398, 'psi': 0.9955806252880333}
[S6] START round=40 head_norm_before_train=1.413227 cos_to_last_merge=0.9990 (last merge round=38)
[S6] round=40 local utility u=0.782412 metrics={'f1_val': 0.8619049003354545, 'auprc': 0.9913759642467892, 'loss_val': 0.3452240295685472, 'psi': 0.9136933258999884}-{'f1_val': 0.7019461590917336, 'auprc': 0.8930039426390397, 'loss_val': 0.6551794084473401, 'psi': 0.7783692725106561}
[S7] START round=40 head_norm_before_train=1.481677 cos_to_last_merge=0.9993 (last merge round=36)
[S7] round=40 local utility u=0.144517 metrics={'f1_val': 0.5947136421168938, 'auprc': 0.7994424095321465, 'loss_val': 0.6002973467205313, 'psi': 0.676605149082995}-{'f1_val': 0.5645987895497279, 'auprc': 0.7947616496837907, 'loss_val': 0.6946001292670148, 'psi': 0.6566639336033531}
[S8] START round=40 head_norm_before_train=1.448020 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9983602375998266, 'loss_val': 0.04100998029431991, 'psi': 0.9949942740988229}-{'f1_val': 0.9940342119076258, 'auprc': 0.9980835859705897, 'loss_val': 0.04400566059041522, 'psi': 0.9956539615328113}
[S9] START round=40 head_norm_before_train=1.818519 cos_to_last_merge=0.7892 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.789
[S9] round=40 local utility u=0.003450 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9995631887419664, 'loss_val': 0.01998066053362675, 'psi': 0.9978194826764333}-{'f1_val': 0.9958267183641853, 'auprc': 0.9995656755292199, 'loss_val': 0.021906924445882672, 'psi': 0.9973223012301993}
[S10] START round=40 head_norm_before_train=1.920734 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9955061487569516, 'loss_val': 0.025148561490319417, 'psi': 0.9952645403484396}-{'f1_val': 0.9955183051359886, 'auprc': 0.9955033977397587, 'loss_val': 0.025053134704638196, 'psi': 0.9955123421774966}
[S11] START round=40 head_norm_before_train=1.525056 cos_to_last_merge=0.9962 (last merge round=35)
[S11] round=40 local utility u=0.224763 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9980209914952817, 'loss_val': 0.051013978815887186, 'psi': 0.9969008814445599}-{'f1_val': 0.9338873771931556, 'auprc': 0.9966471000531936, 'loss_val': 0.12281867657830248, 'psi': 0.9589912663371707}
[S13] START round=40 head_norm_before_train=1.469721 cos_to_last_merge=0.9850 (last merge round=35)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.7058013360879755, 'auprc': 0.6545251201969761, 'loss_val': 0.9649149603896281, 'psi': 0.6852908497315757}-{'f1_val': 0.7585866847418329, 'auprc': 0.7434030287687073, 'loss_val': 0.7531663775060353, 'psi': 0.7525132223525827}
[S14] START round=40 head_norm_before_train=1.940909 cos_to_last_merge=0.9990 (last merge round=34)
[S14] round=40 local utility u=0.001236 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9960670178383538, 'loss_val': 0.028612984419891963, 'psi': 0.9968717688363768}-{'f1_val': 0.9969975081576651, 'auprc': 0.9959982554610078, 'loss_val': 0.028414505057522188, 'psi': 0.9965978070790023}
[S15] START round=40 head_norm_before_train=1.493039 cos_to_last_merge=0.9916 (last merge round=36)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7935008022617234, 'auprc': 0.9852461113390121, 'loss_val': 0.3438844620394393, 'psi': 0.8701989258926388}-{'f1_val': 0.864147962715959, 'auprc': 0.992891604768084, 'loss_val': 0.19496885678919634, 'psi': 0.915645419536809}
[S16] START round=40 head_norm_before_train=1.729990 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=40 local utility u=0.366868 metrics={'f1_val': 0.9915287283916352, 'auprc': 0.9914741629178615, 'loss_val': 0.04480142815331724, 'psi': 0.9915069022021257}-{'f1_val': 0.925834273008245, 'auprc': 0.9882713595256309, 'loss_val': 0.3747623378409913, 'psi': 0.9508091076151993}
[S17] START round=40 head_norm_before_train=1.373330 cos_to_last_merge=0.9995 (last merge round=38)
[S17] round=40 local utility u=0.591941 metrics={'f1_val': 0.6330237779646424, 'auprc': 0.8115628739530147, 'loss_val': 0.7858105673005896, 'psi': 0.7044394163599914}-{'f1_val': 0.5178795700914889, 'auprc': 0.7133044070222929, 'loss_val': 0.9840516037610972, 'psi': 0.5960495048638106}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:52815
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:52803
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:52811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:52816
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S11
[S3] cosine check vs S11: cos=0.9846
[S15] RECEIVED delta(kind=head bytes=1805) from S9
[S15] cosine check vs S9: cos=-0.1148
[S15] DROPPED delta from S9 (cos=-0.1148 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] cosine check vs S14: cos=0.9986
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.9713
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:52807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] cosine check vs S17: cos=0.9028
[S7] ⇄ pheromone p=0.172 → S16@127.0.0.1:52816
[S9] ⇄ pheromone p=0.008 → S15@127.0.0.1:52815
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.8938 head_norm=1.644159
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.478652e-01
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.8893 head_norm=1.590938 delta_norm=0.147865
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.127 → S17@127.0.0.1:52817
[S11] ⇄ pheromone p=0.089 → S3@127.0.0.1:52803
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=40 metric=0.9951 head_norm=1.921079
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.315377e-02
[S10] stored merged vector for next round verification (round=40)
[S10] DEBUG after merge:  round=40 metric=0.9951 head_norm=1.934893 delta_norm=0.053154
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.012 → S2@127.0.0.1:52802
[S15] ⇄ pheromone p=0.303 → S8@127.0.0.1:52809
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.8619 head_norm=1.495086
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.227077e-01
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.8610 head_norm=1.415362 delta_norm=0.322708
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.003 → S10@127.0.0.1:52811
[S17] ⇄ pheromone p=0.387 → S6@127.0.0.1:52807
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.9915 head_norm=1.742079
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.298803e-01
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.9915 head_norm=1.605838 delta_norm=0.229880
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.132 → S7@127.0.0.1:52808
[S2] START round=41 head_norm_before_train=1.510896 cos_to_last_merge=0.9934 (last merge round=39)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.9107801698383741, 'auprc': 0.963899246534556, 'loss_val': 0.28483712901005387, 'psi': 0.9320278005168469}-{'f1_val': 0.9654892642791397, 'auprc': 0.9745749015890856, 'loss_val': 0.16184494679502512, 'psi': 0.969123519203118}
[S3] START round=41 head_norm_before_train=1.590938 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.370884 metrics={'f1_val': 0.9846070322993064, 'auprc': 0.9997668536321388, 'loss_val': 0.07756311730162543, 'psi': 0.9906709608324393}-{'f1_val': 0.8938318123133578, 'auprc': 0.9841186511936816, 'loss_val': 0.22773449499831153, 'psi': 0.9299465478654874}
[S4] START round=41 head_norm_before_train=2.083038 (no previous merge yet)
[S4] round=41 local utility u=0.037402 metrics={'f1_val': 0.951761390195256, 'auprc': 0.9700869342762563, 'loss_val': 0.3005052900390991, 'psi': 0.9590916078276561}-{'f1_val': 0.9457927055490708, 'auprc': 0.9574409507325504, 'loss_val': 0.30155915459331367, 'psi': 0.9504520036224626}
[S5] START round=41 head_norm_before_train=1.548583 cos_to_last_merge=0.8021 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=41 local utility u=0.018241 metrics={'f1_val': 0.9964072015118757, 'auprc': 0.9980338287325977, 'loss_val': 0.07360461189745647, 'psi': 0.9970578524001645}-{'f1_val': 0.996186023309311, 'auprc': 0.9916180385916634, 'loss_val': 0.08951144343519254, 'psi': 0.994358829422252}
[S6] START round=41 head_norm_before_train=1.415362 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7696804669972909, 'auprc': 0.9266973625592366, 'loss_val': 0.5537728095274651, 'psi': 0.8324872252220692}-{'f1_val': 0.8619049003354545, 'auprc': 0.9913759642467892, 'loss_val': 0.3452240295685472, 'psi': 0.9136933258999884}
[S7] START round=41 head_norm_before_train=1.492743 cos_to_last_merge=0.9988 (last merge round=36)
[S7] round=41 local utility u=0.272991 metrics={'f1_val': 0.654820386337359, 'auprc': 0.8160435032362461, 'loss_val': 0.46475937369415976, 'psi': 0.7193096330969138}-{'f1_val': 0.5947136421168938, 'auprc': 0.7994424095321465, 'loss_val': 0.6002973467205313, 'psi': 0.676605149082995}
[S8] START round=41 head_norm_before_train=1.471447 cos_to_last_merge=0.9999 (last merge round=39)
[S8] round=41 local utility u=0.001737 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9990938744186142, 'loss_val': 0.039736877816014704, 'psi': 0.9952877288263379}-{'f1_val': 0.992750298431487, 'auprc': 0.9983602375998266, 'loss_val': 0.04100998029431991, 'psi': 0.9949942740988229}
[S9] START round=41 head_norm_before_train=1.827320 cos_to_last_merge=0.7880 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9905410059937811, 'auprc': 0.9995693117309041, 'loss_val': 0.031721091108042054, 'psi': 0.9941523282886304}-{'f1_val': 0.9966570119660778, 'auprc': 0.9995631887419664, 'loss_val': 0.01998066053362675, 'psi': 0.9978194826764333}
[S10] START round=41 head_norm_before_train=1.934893 cos_to_last_merge=1.0000 (last merge round=40)
[S10] round=41 local utility u=0.000113 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9955117894242445, 'loss_val': 0.02493985558110727, 'psi': 0.9952667966153568}-{'f1_val': 0.9951034680760983, 'auprc': 0.9955061487569516, 'loss_val': 0.025148561490319417, 'psi': 0.9952645403484396}
[S11] START round=41 head_norm_before_train=1.550045 cos_to_last_merge=0.9948 (last merge round=35)
[S11] round=41 local utility u=0.004748 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986226060006327, 'loss_val': 0.043323729468545465, 'psi': 0.9971415272467004}-{'f1_val': 0.9961541414107454, 'auprc': 0.9980209914952817, 'loss_val': 0.051013978815887186, 'psi': 0.9969008814445599}
[S13] START round=41 head_norm_before_train=1.497753 cos_to_last_merge=0.9819 (last merge round=35)
[S13] round=41 local utility u=0.373518 metrics={'f1_val': 0.7114271951397151, 'auprc': 0.7623977143725157, 'loss_val': 0.5752524654838058, 'psi': 0.7318154028328354}-{'f1_val': 0.7058013360879755, 'auprc': 0.6545251201969761, 'loss_val': 0.9649149603896281, 'psi': 0.6852908497315757}
[S14] START round=41 head_norm_before_train=1.950057 cos_to_last_merge=0.9988 (last merge round=34)
[S14] round=41 local utility u=0.002616 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9974340590691456, 'loss_val': 0.026177952367666162, 'psi': 0.9972880965877506}-{'f1_val': 0.9974082695017256, 'auprc': 0.9960670178383538, 'loss_val': 0.028612984419891963, 'psi': 0.9968717688363768}
[S15] START round=41 head_norm_before_train=1.540674 cos_to_last_merge=0.9879 (last merge round=36)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6997162522555377, 'auprc': 0.9068569795043241, 'loss_val': 0.5401566595255757, 'psi': 0.7825725431550523}-{'f1_val': 0.7935008022617234, 'auprc': 0.9852461113390121, 'loss_val': 0.3438844620394393, 'psi': 0.8701989258926388}
[S16] START round=41 head_norm_before_train=1.605838 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9226675518630038, 'auprc': 0.9886013090461682, 'loss_val': 0.37945364133669174, 'psi': 0.9490410547362695}-{'f1_val': 0.9915287283916352, 'auprc': 0.9914741629178615, 'loss_val': 0.04480142815331724, 'psi': 0.9915069022021257}
[S17] START round=41 head_norm_before_train=1.406946 cos_to_last_merge=0.9984 (last merge round=38)
[S17] round=41 local utility u=0.034092 metrics={'f1_val': 0.6409790389148208, 'auprc': 0.8110826227352992, 'loss_val': 0.7639173865340099, 'psi': 0.7090204724430121}-{'f1_val': 0.6330237779646424, 'auprc': 0.8115628739530147, 'loss_val': 0.7858105673005896, 'psi': 0.7044394163599914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:52811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:52814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:52816
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.9937
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.9889
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] cosine check vs S14: cos=0.9994
[S3] RECEIVED delta(kind=head bytes=1797) from S11
[S3] cosine check vs S11: cos=0.9937
[S16] RECEIVED delta(kind=head bytes=1795) from S7
[S16] cosine check vs S7: cos=0.9902
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9994
[S17] RECEIVED delta(kind=head bytes=1803) from S13
[S17] cosine check vs S13: cos=0.9761
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:52807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S17
[S6] cosine check vs S17: cos=0.9613
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=41 metric=0.9951 head_norm=1.938426
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.573785e-02
[S10] stored merged vector for next round verification (round=41)
[S10] DEBUG after merge:  round=41 metric=0.9951 head_norm=1.949086 delta_norm=0.035738
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.9846 head_norm=1.625612
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.387311e-02
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.9847 head_norm=1.596729 delta_norm=0.093873
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.7697 head_norm=1.493215
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.056500e-01
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.7649 head_norm=1.449018 delta_norm=0.205650
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=41 metric=0.9972 head_norm=1.960339
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.573785e-02
[S14] stored merged vector for next round verification (round=41)
[S14] DEBUG after merge:  round=41 metric=0.9972 head_norm=1.949086 delta_norm=0.035738
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9962 head_norm=1.572926
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.387311e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9962 head_norm=1.596729 delta_norm=0.093873
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.6997 head_norm=1.576892
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.222198e-01
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.6992 head_norm=1.528653 delta_norm=0.122220
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9227 head_norm=1.624005
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.244862e-01
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9227 head_norm=1.561074 delta_norm=0.124486
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.6410 head_norm=1.433249
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.667918e-01
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.6461 head_norm=1.467102 delta_norm=0.166792
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.612390 cos_to_last_merge=0.9828 (last merge round=39)
[S2] round=42 local utility u=0.097152 metrics={'f1_val': 0.914432623785729, 'auprc': 0.9823384524411712, 'loss_val': 0.1677661896163422, 'psi': 0.9415949552479059}-{'f1_val': 0.9107801698383741, 'auprc': 0.963899246534556, 'loss_val': 0.28483712901005387, 'psi': 0.9320278005168469}
[S3] START round=42 head_norm_before_train=1.596729 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9604349446125985, 'auprc': 0.9992643480715075, 'loss_val': 0.09157050957389123, 'psi': 0.9759667059961621}-{'f1_val': 0.9846070322993064, 'auprc': 0.9997668536321388, 'loss_val': 0.07756311730162543, 'psi': 0.9906709608324393}
[S4] START round=42 head_norm_before_train=2.091742 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9456678245730752, 'auprc': 0.9553925795024272, 'loss_val': 0.297541322367052, 'psi': 0.9495577265448161}-{'f1_val': 0.951761390195256, 'auprc': 0.9700869342762563, 'loss_val': 0.3005052900390991, 'psi': 0.9590916078276561}
[S5] START round=42 head_norm_before_train=1.554147 cos_to_last_merge=0.8020 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=42 local utility u=0.002314 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9944223221491284, 'loss_val': 0.056815388521371066, 'psi': 0.995480542845238}-{'f1_val': 0.9964072015118757, 'auprc': 0.9980338287325977, 'loss_val': 0.07360461189745647, 'psi': 0.9970578524001645}
[S6] START round=42 head_norm_before_train=1.449018 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7584802646196985, 'auprc': 0.9170613489908663, 'loss_val': 0.5794322013031583, 'psi': 0.8219126983681656}-{'f1_val': 0.7696804669972909, 'auprc': 0.9266973625592366, 'loss_val': 0.5537728095274651, 'psi': 0.8324872252220692}
[S7] START round=42 head_norm_before_train=1.505825 cos_to_last_merge=0.9982 (last merge round=36)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5932986638925261, 'auprc': 0.800247634605476, 'loss_val': 0.6337936339476316, 'psi': 0.676078252177706}-{'f1_val': 0.654820386337359, 'auprc': 0.8160435032362461, 'loss_val': 0.46475937369415976, 'psi': 0.7193096330969138}
[S8] START round=42 head_norm_before_train=1.488909 cos_to_last_merge=0.9998 (last merge round=39)
[S8] round=42 local utility u=0.003433 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9982470868895673, 'loss_val': 0.03803400090011754, 'psi': 0.9957193619004023}-{'f1_val': 0.992750298431487, 'auprc': 0.9990938744186142, 'loss_val': 0.039736877816014704, 'psi': 0.9952877288263379}
[S9] START round=42 head_norm_before_train=1.834812 cos_to_last_merge=0.7872 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.787
[S9] round=42 local utility u=0.024567 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995626530930696, 'loss_val': 0.019284453193332985, 'psi': 0.9978213683255627}-{'f1_val': 0.9905410059937811, 'auprc': 0.9995693117309041, 'loss_val': 0.031721091108042054, 'psi': 0.9941523282886304}
[S10] START round=42 head_norm_before_train=1.949086 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=42 local utility u=0.000066 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9955104192734947, 'loss_val': 0.02480418072323607, 'psi': 0.9952662485550569}-{'f1_val': 0.9951034680760983, 'auprc': 0.9955117894242445, 'loss_val': 0.02493985558110727, 'psi': 0.9952667966153568}
[S11] START round=42 head_norm_before_train=1.596729 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.001082 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986793617334202, 'loss_val': 0.041330471331525336, 'psi': 0.9971642295398153}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986226060006327, 'loss_val': 0.043323729468545465, 'psi': 0.9971415272467004}
[S13] START round=42 head_norm_before_train=1.518622 cos_to_last_merge=0.9794 (last merge round=35)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6735493291931947, 'auprc': 0.6846301929682101, 'loss_val': 0.9392617243579343, 'psi': 0.6779816747032008}-{'f1_val': 0.7114271951397151, 'auprc': 0.7623977143725157, 'loss_val': 0.5752524654838058, 'psi': 0.7318154028328354}
[S14] START round=42 head_norm_before_train=1.949086 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9960611422931496, 'loss_val': 0.02855242884412869, 'psi': 0.9968710534779568}-{'f1_val': 0.9971907882668205, 'auprc': 0.9974340590691456, 'loss_val': 0.026177952367666162, 'psi': 0.9972880965877506}
[S15] START round=42 head_norm_before_train=1.528653 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=1.000000 metrics={'f1_val': 0.9959219992619481, 'auprc': 0.9934784282046719, 'loss_val': 0.0414068997979671, 'psi': 0.9949445708390376}-{'f1_val': 0.6997162522555377, 'auprc': 0.9068569795043241, 'loss_val': 0.5401566595255757, 'psi': 0.7825725431550523}
[S16] START round=42 head_norm_before_train=1.561074 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.380597 metrics={'f1_val': 0.9917505555831294, 'auprc': 0.9957242393893715, 'loss_val': 0.05412546526727211, 'psi': 0.9933400291056262}-{'f1_val': 0.9226675518630038, 'auprc': 0.9886013090461682, 'loss_val': 0.37945364133669174, 'psi': 0.9490410547362695}
[S17] START round=42 head_norm_before_train=1.467102 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.2638849791769201, 'auprc': 0.6071232966112389, 'loss_val': 2.1446051681331273, 'psi': 0.4011803061506476}-{'f1_val': 0.6409790389148208, 'auprc': 0.8110826227352992, 'loss_val': 0.7639173865340099, 'psi': 0.7090204724430121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:52815
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:52814
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=0.8661
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=0.9956
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1799) from S9
[S15] cosine check vs S9: cos=-0.1189
[S15] DROPPED delta from S9 (cos=-0.1189 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.9961
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.9956
[S3] RECEIVED delta(kind=head bytes=1802) from S11
[S3] cosine check vs S11: cos=0.9995
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.5933 head_norm=1.517990
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.725237e-02
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.5996 head_norm=1.551920 delta_norm=0.077252
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9974 head_norm=1.957955
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.638289e-03
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9974 head_norm=1.957210 delta_norm=0.007638
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S13
[S8]  timeout peer S16
[S8]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.9940 head_norm=1.506884
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.978807e-01
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.9940 head_norm=1.519905 delta_norm=0.197881
[S8] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9959 head_norm=1.557101
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.609382e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9959 head_norm=1.530308 delta_norm=0.076094
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=42 metric=0.9604 head_norm=1.634470
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.664607e-02
[S3] stored merged vector for next round verification (round=42)
[S3] DEBUG after merge:  round=42 metric=0.9609 head_norm=1.625213 delta_norm=0.026646
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.690074 cos_to_last_merge=0.9740 (last merge round=39)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8150932976954326, 'auprc': 0.9149873870042464, 'loss_val': 0.5050245016762847, 'psi': 0.8550509334189581}-{'f1_val': 0.914432623785729, 'auprc': 0.9823384524411712, 'loss_val': 0.1677661896163422, 'psi': 0.9415949552479059}
[S3] START round=43 head_norm_before_train=1.625213 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.825216624144252, 'auprc': 0.9669546265528762, 'loss_val': 0.41066165582551667, 'psi': 0.8819118251077016}-{'f1_val': 0.9604349446125985, 'auprc': 0.9992643480715075, 'loss_val': 0.09157050957389123, 'psi': 0.9759667059961621}
[S4] START round=43 head_norm_before_train=2.089779 (no previous merge yet)
[S4] round=43 local utility u=0.012970 metrics={'f1_val': 0.9466034320704347, 'auprc': 0.9633238592532248, 'loss_val': 0.3010081193700417, 'psi': 0.9532916029435508}-{'f1_val': 0.9456678245730752, 'auprc': 0.9553925795024272, 'loss_val': 0.297541322367052, 'psi': 0.9495577265448161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=43 head_norm_before_train=1.559941 cos_to_last_merge=0.8019 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=43 local utility u=0.001504 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9945504069798026, 'loss_val': 0.05419080859917164, 'psi': 0.9955317767775076}-{'f1_val': 0.996186023309311, 'auprc': 0.9944223221491284, 'loss_val': 0.056815388521371066, 'psi': 0.995480542845238}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=43 head_norm_before_train=1.530066 cos_to_last_merge=0.9978 (last merge round=41)
[S6] round=43 local utility u=0.274198 metrics={'f1_val': 0.8216679336780139, 'auprc': 0.9180934234375323, 'loss_val': 0.41325922791814057, 'psi': 0.8602381295818213}-{'f1_val': 0.7584802646196985, 'auprc': 0.9170613489908663, 'loss_val': 0.5794322013031583, 'psi': 0.8219126983681656}
[S7] START round=43 head_norm_before_train=1.551920 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5405123364461537, 'auprc': 0.7928908016714606, 'loss_val': 0.8637131352320051, 'psi': 0.6414637225362765}-{'f1_val': 0.5932986638925261, 'auprc': 0.800247634605476, 'loss_val': 0.6337936339476316, 'psi': 0.676078252177706}
[S8] START round=43 head_norm_before_train=1.519905 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9978386100263812, 'loss_val': 0.03894922946193469, 'psi': 0.995223760851927}-{'f1_val': 0.9940342119076258, 'auprc': 0.9982470868895673, 'loss_val': 0.03803400090011754, 'psi': 0.9957193619004023}
[S9] START round=43 head_norm_before_train=1.840819 cos_to_last_merge=0.7862 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=43 local utility u=0.000064 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995627366415194, 'loss_val': 0.019157187123492476, 'psi': 0.9978214017449426}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995626530930696, 'loss_val': 0.019284453193332985, 'psi': 0.9978213683255627}
[S10] START round=43 head_norm_before_train=1.956494 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=43 local utility u=0.002103 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.995894397308932, 'loss_val': 0.02423835062463137, 'psi': 0.995668742005166}-{'f1_val': 0.9951034680760983, 'auprc': 0.9955104192734947, 'loss_val': 0.02480418072323607, 'psi': 0.9952662485550569}
[S11] START round=43 head_norm_before_train=1.616343 cos_to_last_merge=0.9999 (last merge round=41)
[S11] round=43 local utility u=0.001345 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987025084570986, 'loss_val': 0.038710678249913144, 'psi': 0.9971734882292866}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986793617334202, 'loss_val': 0.041330471331525336, 'psi': 0.9971642295398153}
[S13] START round=43 head_norm_before_train=1.532923 cos_to_last_merge=0.9777 (last merge round=35)
[S13] round=43 local utility u=0.157418 metrics={'f1_val': 0.6859445647633692, 'auprc': 0.7176065669965572, 'loss_val': 0.7977268108701551, 'psi': 0.6986093656566443}-{'f1_val': 0.6735493291931947, 'auprc': 0.6846301929682101, 'loss_val': 0.9392617243579343, 'psi': 0.6779816747032008}
[S14] START round=43 head_norm_before_train=1.957210 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9957280518089979, 'loss_val': 0.03012689133741571, 'psi': 0.996343939715818}-{'f1_val': 0.9974109942678281, 'auprc': 0.9960611422931496, 'loss_val': 0.02855242884412869, 'psi': 0.9968710534779568}
[S15] START round=43 head_norm_before_train=1.530308 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9329338617627253, 'auprc': 0.9950418182388365, 'loss_val': 0.13432643611085066, 'psi': 0.9577770443531698}-{'f1_val': 0.9959219992619481, 'auprc': 0.9934784282046719, 'loss_val': 0.0414068997979671, 'psi': 0.9949445708390376}
[S16] START round=43 head_norm_before_train=1.588885 cos_to_last_merge=0.9999 (last merge round=41)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9919474066492209, 'auprc': 0.9925431965123171, 'loss_val': 0.04964817045976243, 'psi': 0.9921857225944594}-{'f1_val': 0.9917505555831294, 'auprc': 0.9957242393893715, 'loss_val': 0.05412546526727211, 'psi': 0.9933400291056262}
[S17] START round=43 head_norm_before_train=1.485763 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=43 local utility u=1.000000 metrics={'f1_val': 0.6082193705932071, 'auprc': 0.8565946454941886, 'loss_val': 0.8301582086571605, 'psi': 0.7075694805535997}-{'f1_val': 0.2638849791769201, 'auprc': 0.6071232966112389, 'loss_val': 2.1446051681331273, 'psi': 0.4011803061506476}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:52815
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:52803
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.9540
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1803) from S13
[S17] cosine check vs S13: cos=0.9908
[S15] RECEIVED delta(kind=head bytes=1798) from S9
[S15] cosine check vs S9: cos=-0.1214
[S15] DROPPED delta from S9 (cos=-0.1214 < 0.0)
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S11
[S3] cosine check vs S11: cos=0.9992
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:52807
[S8] RoundReady barrier timeout: have=2 need=4 — continuing
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] cosine check vs S17: cos=0.9540
[S11]  timeout peer S3
[S11]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S7]  timeout peer S13
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S11
[S8]  timeout peer S14
[S14]  timeout peer S10
[S13]  timeout peer S17
[S15]  timeout peer S8
[S9]  timeout peer S15
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.6082 head_norm=1.502151
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.050807e-01
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.6081 head_norm=1.521555 delta_norm=0.105081
[S17] aggregate: ACCEPT kept=['S6', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.749925 cos_to_last_merge=0.9679 (last merge round=39)
[S2] round=44 local utility u=0.529102 metrics={'f1_val': 0.9124651496923796, 'auprc': 0.9905040456040886, 'loss_val': 0.25760198786219246, 'psi': 0.9436807080570632}-{'f1_val': 0.8150932976954326, 'auprc': 0.9149873870042464, 'loss_val': 0.5050245016762847, 'psi': 0.8550509334189581}
[S3] START round=44 head_norm_before_train=1.658670 cos_to_last_merge=0.9997 (last merge round=42)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.810253044039233, 'auprc': 0.9963800397546477, 'loss_val': 0.43949604042036816, 'psi': 0.884703842325399}-{'f1_val': 0.825216624144252, 'auprc': 0.9669546265528762, 'loss_val': 0.41066165582551667, 'psi': 0.8819118251077016}
[S4] START round=44 head_norm_before_train=2.092843 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9436394692575689, 'auprc': 0.9518417679306744, 'loss_val': 0.30299068672643903, 'psi': 0.9469203887268112}-{'f1_val': 0.9466034320704347, 'auprc': 0.9633238592532248, 'loss_val': 0.3010081193700417, 'psi': 0.9532916029435508}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.569561 cos_to_last_merge=0.8017 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=44 local utility u=0.008974 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9979697029154548, 'loss_val': 0.049139955568248475, 'psi': 0.9971634266243238}-{'f1_val': 0.996186023309311, 'auprc': 0.9945504069798026, 'loss_val': 0.05419080859917164, 'psi': 0.9955317767775076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=44 head_norm_before_train=1.612124 cos_to_last_merge=0.9925 (last merge round=41)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7203952408894382, 'auprc': 0.882829038653062, 'loss_val': 0.7214601361954877, 'psi': 0.7853687599948878}-{'f1_val': 0.8216679336780139, 'auprc': 0.9180934234375323, 'loss_val': 0.41325922791814057, 'psi': 0.8602381295818213}
[S7] START round=44 head_norm_before_train=1.560595 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=44 local utility u=0.948114 metrics={'f1_val': 0.6986048031249242, 'auprc': 0.9198530749133503, 'loss_val': 0.296926521890969, 'psi': 0.7871041118402947}-{'f1_val': 0.5405123364461537, 'auprc': 0.7928908016714606, 'loss_val': 0.8637131352320051, 'psi': 0.6414637225362765}
[S8] START round=44 head_norm_before_train=1.538439 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9916698259783234, 'auprc': 0.9982261012783415, 'loss_val': 0.04208756270764082, 'psi': 0.9942923360983307}-{'f1_val': 0.9934805280689575, 'auprc': 0.9978386100263812, 'loss_val': 0.03894922946193469, 'psi': 0.995223760851927}
[S9] START round=44 head_norm_before_train=1.847137 cos_to_last_merge=0.7852 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.785
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9905410059937811, 'auprc': 0.9995715433676298, 'loss_val': 0.03133117550803216, 'psi': 0.9941532209433206}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995627366415194, 'loss_val': 0.019157187123492476, 'psi': 0.9978214017449426}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.965046 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995509210711206, 'loss_val': 0.024596402478927405, 'psi': 0.9952657651301413}-{'f1_val': 0.9955183051359886, 'auprc': 0.995894397308932, 'loss_val': 0.02423835062463137, 'psi': 0.995668742005166}
[S11] START round=44 head_norm_before_train=1.633515 cos_to_last_merge=0.9998 (last merge round=41)
[S11] round=44 local utility u=0.000948 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.99868141595748, 'loss_val': 0.03675076148033958, 'psi': 0.9971650512294392}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987025084570986, 'loss_val': 0.038710678249913144, 'psi': 0.9971734882292866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=44 head_norm_before_train=1.544010 cos_to_last_merge=0.9763 (last merge round=35)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6748845634813943, 'auprc': 0.6525798345307543, 'loss_val': 1.038884631825906, 'psi': 0.6659626719011382}-{'f1_val': 0.6859445647633692, 'auprc': 0.7176065669965572, 'loss_val': 0.7977268108701551, 'psi': 0.6986093656566443}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.967508 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.005123 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9963531384627662, 'loss_val': 0.025679261038703067, 'psi': 0.9969862170861419}-{'f1_val': 0.996754531653698, 'auprc': 0.9957280518089979, 'loss_val': 0.03012689133741571, 'psi': 0.996343939715818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=44 metric=0.9974 head_norm=1.976019
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.434157e-02
[S14] stored merged vector for next round verification (round=44)
[S14] DEBUG after merge:  round=44 metric=0.9974 head_norm=1.970488 delta_norm=0.014342
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=44 head_norm_before_train=1.562741 cos_to_last_merge=0.9998 (last merge round=42)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6996061420512976, 'auprc': 0.8479943766285969, 'loss_val': 0.5821152736724183, 'psi': 0.7589614358822172}-{'f1_val': 0.9329338617627253, 'auprc': 0.9950418182388365, 'loss_val': 0.13432643611085066, 'psi': 0.9577770443531698}
[S16] START round=44 head_norm_before_train=1.622909 cos_to_last_merge=0.9994 (last merge round=41)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8924911707393718, 'auprc': 0.9850377673858304, 'loss_val': 0.45443362907403445, 'psi': 0.9295098093979552}-{'f1_val': 0.9919474066492209, 'auprc': 0.9925431965123171, 'loss_val': 0.04964817045976243, 'psi': 0.9921857225944594}
[S17] START round=44 head_norm_before_train=1.521555 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6072992889463681, 'auprc': 0.8200900224085765, 'loss_val': 0.867769426146072, 'psi': 0.6924155823312514}-{'f1_val': 0.6082193705932071, 'auprc': 0.8565946454941886, 'loss_val': 0.8301582086571605, 'psi': 0.7075694805535997}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:52816
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:52809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.8103 head_norm=1.690110
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.747252e-02
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.8051 head_norm=1.661059 delta_norm=0.057473
[S3] aggregate: ROLLBACK (f1_val pre=0.810 post=0.805 tol_abs=0.005 tol_rel=0.0)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.7204 head_norm=1.670101
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.766187e-01
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.7170 head_norm=1.564075 delta_norm=0.276619
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1807) from S2
[S8] cosine check vs S2: cos=0.9028
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.9972
[S2] START round=45 head_norm_before_train=1.799168 cos_to_last_merge=0.9630 (last merge round=39)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.8544374296853308, 'auprc': 0.9178607203330211, 'loss_val': 0.4059534354830381, 'psi': 0.879806745944407}-{'f1_val': 0.9124651496923796, 'auprc': 0.9905040456040886, 'loss_val': 0.25760198786219246, 'psi': 0.9436807080570632}
[S3] START round=45 head_norm_before_train=1.661059 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.6621443768650563, 'auprc': 0.8857469093195354, 'loss_val': 0.8460354130034929, 'psi': 0.751585389846848}-{'f1_val': 0.810253044039233, 'auprc': 0.9963800397546477, 'loss_val': 0.43949604042036816, 'psi': 0.884703842325399}
[S4] START round=45 head_norm_before_train=2.104304 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9413903928194376, 'auprc': 0.9501134048492612, 'loss_val': 0.30263664844328614, 'psi': 0.9448795976313671}-{'f1_val': 0.9436394692575689, 'auprc': 0.9518417679306744, 'loss_val': 0.30299068672643903, 'psi': 0.9469203887268112}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.583988 cos_to_last_merge=0.8008 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.801
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9961136692619228, 'loss_val': 0.046966547932850156, 'psi': 0.9961570816903558}-{'f1_val': 0.996625909096903, 'auprc': 0.9979697029154548, 'loss_val': 0.049139955568248475, 'psi': 0.9971634266243238}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.564075 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.5942640703991559, 'auprc': 0.7282803559991834, 'loss_val': 0.9458899920148218, 'psi': 0.6478705846391668}-{'f1_val': 0.7203952408894382, 'auprc': 0.882829038653062, 'loss_val': 0.7214601361954877, 'psi': 0.7853687599948878}
[S7] START round=45 head_norm_before_train=1.567301 cos_to_last_merge=0.9999 (last merge round=42)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5194658515202117, 'auprc': 0.7835188152679391, 'loss_val': 1.006210296141776, 'psi': 0.6250870370193027}-{'f1_val': 0.6986048031249242, 'auprc': 0.9198530749133503, 'loss_val': 0.296926521890969, 'psi': 0.7871041118402947}
[S8] START round=45 head_norm_before_train=1.559519 cos_to_last_merge=0.9998 (last merge round=42)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9916698259783234, 'auprc': 0.9873172325646361, 'loss_val': 0.03950599732953538, 'psi': 0.9899287886128485}-{'f1_val': 0.9916698259783234, 'auprc': 0.9982261012783415, 'loss_val': 0.04208756270764082, 'psi': 0.9942923360983307}
[S9] START round=45 head_norm_before_train=1.854944 cos_to_last_merge=0.7841 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.784
[S9] round=45 local utility u=0.024636 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995620866923935, 'loss_val': 0.018748087816648263, 'psi': 0.9978211417652922}-{'f1_val': 0.9905410059937811, 'auprc': 0.9995715433676298, 'loss_val': 0.03133117550803216, 'psi': 0.9941532209433206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=45 head_norm_before_train=1.973865 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=45 local utility u=0.001967 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9958989359106876, 'loss_val': 0.02432035273555134, 'psi': 0.9956705574458682}-{'f1_val': 0.9951034680760983, 'auprc': 0.995509210711206, 'loss_val': 0.024596402478927405, 'psi': 0.9952657651301413}
[S11] START round=45 head_norm_before_train=1.649985 cos_to_last_merge=0.9996 (last merge round=41)
[S11] round=45 local utility u=0.000499 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986537082478802, 'loss_val': 0.035670423691280616, 'psi': 0.9971539681455993}-{'f1_val': 0.9961541414107454, 'auprc': 0.99868141595748, 'loss_val': 0.03675076148033958, 'psi': 0.9971650512294392}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=45 head_norm_before_train=1.556669 cos_to_last_merge=0.9749 (last merge round=35)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6324461126517986, 'auprc': 0.6370593921040693, 'loss_val': 1.0945367267275574, 'psi': 0.6342914244327069}-{'f1_val': 0.6748845634813943, 'auprc': 0.6525798345307543, 'loss_val': 1.038884631825906, 'psi': 0.6659626719011382}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.970488 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9940755032987544, 'auprc': 0.9962429836512139, 'loss_val': 0.039290283235613045, 'psi': 0.9949424954397381}-{'f1_val': 0.9974082695017256, 'auprc': 0.9963531384627662, 'loss_val': 0.025679261038703067, 'psi': 0.9969862170861419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.600006 cos_to_last_merge=0.9991 (last merge round=42)
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.9963362515743834, 'auprc': 0.9947365237208818, 'loss_val': 0.033885504357858365, 'psi': 0.9956963604329828}-{'f1_val': 0.6996061420512976, 'auprc': 0.8479943766285969, 'loss_val': 0.5821152736724183, 'psi': 0.7589614358822172}
[S16] START round=45 head_norm_before_train=1.650732 cos_to_last_merge=0.9988 (last merge round=41)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8776946679866819, 'auprc': 0.9791079925950015, 'loss_val': 0.5500790198782816, 'psi': 0.9182599978300097}-{'f1_val': 0.8924911707393718, 'auprc': 0.9850377673858304, 'loss_val': 0.45443362907403445, 'psi': 0.9295098093979552}
[S17] START round=45 head_norm_before_train=1.541971 cos_to_last_merge=0.9998 (last merge round=43)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.44792584657903706, 'auprc': 0.7089353127155181, 'loss_val': 1.3380641459885374, 'psi': 0.5523296330336295}-{'f1_val': 0.6072992889463681, 'auprc': 0.8200900224085765, 'loss_val': 0.867769426146072, 'psi': 0.6924155823312514}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.129 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.097 → S11@127.0.0.1:52812
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=45 metric=0.8777 head_norm=1.678879
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.974300e-02
[S16] stored merged vector for next round verification (round=45)
[S16] DEBUG after merge:  round=45 metric=0.8777 head_norm=1.621568 delta_norm=0.089743
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.155 → S17@127.0.0.1:52817
[S7] ⇄ pheromone p=0.230 → S16@127.0.0.1:52816
[S17] ⇄ pheromone p=0.258 → S13@127.0.0.1:52813
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.9917 head_norm=1.570636
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.894789e-01
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.9920 head_norm=1.643246 delta_norm=0.389479
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.004 → S15@127.0.0.1:52815
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9999
[S10] ⇄ pheromone p=0.001 → S14@127.0.0.1:52814
[S2] START round=46 head_norm_before_train=1.834225 cos_to_last_merge=0.9600 (last merge round=39)
[S2] round=46 local utility u=0.270534 metrics={'f1_val': 0.9090294453544532, 'auprc': 0.951544972967066, 'loss_val': 0.29348965492180834, 'psi': 0.9260356563994984}-{'f1_val': 0.8544374296853308, 'auprc': 0.9178607203330211, 'loss_val': 0.4059534354830381, 'psi': 0.879806745944407}
[S3] START round=46 head_norm_before_train=1.689234 cos_to_last_merge=0.9998 (last merge round=44)
[S3] round=46 local utility u=1.000000 metrics={'f1_val': 0.8902592240343505, 'auprc': 0.9992702287177356, 'loss_val': 0.2356803373657148, 'psi': 0.9338636259077046}-{'f1_val': 0.6621443768650563, 'auprc': 0.8857469093195354, 'loss_val': 0.8460354130034929, 'psi': 0.751585389846848}
[S4] START round=46 head_norm_before_train=2.115501 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9384476698367369, 'auprc': 0.92829515654597, 'loss_val': 0.3231484758320632, 'psi': 0.9343866645204302}-{'f1_val': 0.9413903928194376, 'auprc': 0.9501134048492612, 'loss_val': 0.30263664844328614, 'psi': 0.9448795976313671}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.598184 cos_to_last_merge=0.7998 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.992769478986628, 'loss_val': 0.0469648851769898, 'psi': 0.9948194055802378}-{'f1_val': 0.996186023309311, 'auprc': 0.9961136692619228, 'loss_val': 0.046966547932850156, 'psi': 0.9961570816903558}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.604827 cos_to_last_merge=0.9996 (last merge round=44)
[S6] round=46 local utility u=0.898604 metrics={'f1_val': 0.7458997964497257, 'auprc': 0.9128980199251499, 'loss_val': 0.6123489826993357, 'psi': 0.8126990858398954}-{'f1_val': 0.5942640703991559, 'auprc': 0.7282803559991834, 'loss_val': 0.9458899920148218, 'psi': 0.6478705846391668}
[S7] START round=46 head_norm_before_train=1.571523 cos_to_last_merge=0.9998 (last merge round=42)
[S7] round=46 local utility u=1.000000 metrics={'f1_val': 0.7020280544772246, 'auprc': 0.9854435550831013, 'loss_val': 0.24513694920214865, 'psi': 0.8153942547195754}-{'f1_val': 0.5194658515202117, 'auprc': 0.7835188152679391, 'loss_val': 1.006210296141776, 'psi': 0.6250870370193027}
[S8] START round=46 head_norm_before_train=1.643246 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.005845 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9875406093325424, 'loss_val': 0.04267327585520744, 'psi': 0.9914367708775924}-{'f1_val': 0.9916698259783234, 'auprc': 0.9873172325646361, 'loss_val': 0.03950599732953538, 'psi': 0.9899287886128485}
[S9] START round=46 head_norm_before_train=1.863407 cos_to_last_merge=0.7830 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.783
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9937861286679945, 'loss_val': 0.020706328250926404, 'psi': 0.9952645083347644}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995620866923935, 'loss_val': 0.018748087816648263, 'psi': 0.9978211417652922}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.977740 cos_to_last_merge=0.9999 (last merge round=41)
[S10] round=46 local utility u=0.000079 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9959066774398586, 'loss_val': 0.024184667966097705, 'psi': 0.9956736540575366}-{'f1_val': 0.9955183051359886, 'auprc': 0.9958989359106876, 'loss_val': 0.02432035273555134, 'psi': 0.9956705574458682}
[S11] START round=46 head_norm_before_train=1.664185 cos_to_last_merge=0.9994 (last merge round=41)
[S11] round=46 local utility u=0.000412 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986188108819223, 'loss_val': 0.03474188317463124, 'psi': 0.9971400091992162}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986537082478802, 'loss_val': 0.035670423691280616, 'psi': 0.9971539681455993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=46 head_norm_before_train=1.564849 cos_to_last_merge=0.9738 (last merge round=35)
[S13] round=46 local utility u=0.231143 metrics={'f1_val': 0.6431457487739138, 'auprc': 0.7205526572072553, 'loss_val': 0.9469279081430751, 'psi': 0.6741085121472504}-{'f1_val': 0.6324461126517986, 'auprc': 0.6370593921040693, 'loss_val': 1.0945367267275574, 'psi': 0.6342914244327069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=46 head_norm_before_train=1.979358 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=46 local utility u=0.021384 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9991820364469094, 'loss_val': 0.024031505791769638, 'psi': 0.9979872875388561}-{'f1_val': 0.9940755032987544, 'auprc': 0.9962429836512139, 'loss_val': 0.039290283235613045, 'psi': 0.9949424954397381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=46 metric=0.9972 head_norm=1.987667
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.847539e-02
[S14] stored merged vector for next round verification (round=46)
[S14] DEBUG after merge:  round=46 metric=0.9972 head_norm=1.982624 delta_norm=0.018475
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=46 head_norm_before_train=1.623686 cos_to_last_merge=0.9985 (last merge round=42)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9372726028223745, 'auprc': 0.9929169370889105, 'loss_val': 0.1033340146187092, 'psi': 0.9595303365289889}-{'f1_val': 0.9963362515743834, 'auprc': 0.9947365237208818, 'loss_val': 0.033885504357858365, 'psi': 0.9956963604329828}
[S16] START round=46 head_norm_before_train=1.621568 cos_to_last_merge=1.0000 (last merge round=45)
[S16] round=46 local utility u=0.572683 metrics={'f1_val': 0.9825951037840022, 'auprc': 0.9930864521957741, 'loss_val': 0.0760511536554811, 'psi': 0.9867916431487109}-{'f1_val': 0.8776946679866819, 'auprc': 0.9791079925950015, 'loss_val': 0.5500790198782816, 'psi': 0.9182599978300097}
[S17] START round=46 head_norm_before_train=1.563554 cos_to_last_merge=0.9993 (last merge round=43)
[S17] round=46 local utility u=0.457523 metrics={'f1_val': 0.5792756352712338, 'auprc': 0.6571633632283254, 'loss_val': 1.0558016281410905, 'psi': 0.6104307264540705}-{'f1_val': 0.44792584657903706, 'auprc': 0.7089353127155181, 'loss_val': 1.3380641459885374, 'psi': 0.5523296330336295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9982
[S2] START round=47 head_norm_before_train=1.859679 cos_to_last_merge=0.9572 (last merge round=39)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.847939994023081, 'auprc': 0.9189979276221643, 'loss_val': 0.4525491220888325, 'psi': 0.8763631674627143}-{'f1_val': 0.9090294453544532, 'auprc': 0.951544972967066, 'loss_val': 0.29348965492180834, 'psi': 0.9260356563994984}
[S3] START round=47 head_norm_before_train=1.715815 cos_to_last_merge=0.9995 (last merge round=44)
[S3] round=47 local utility u=0.274992 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9995870651759857, 'loss_val': 0.10899914584353608, 'psi': 0.9762255649553595}-{'f1_val': 0.8902592240343505, 'auprc': 0.9992702287177356, 'loss_val': 0.2356803373657148, 'psi': 0.9338636259077046}
[S4] START round=47 head_norm_before_train=2.123147 (no previous merge yet)
[S4] round=47 local utility u=0.044460 metrics={'f1_val': 0.9416014289286773, 'auprc': 0.9461523122664914, 'loss_val': 0.3067219187112483, 'psi': 0.9434217822638029}-{'f1_val': 0.9384476698367369, 'auprc': 0.92829515654597, 'loss_val': 0.3231484758320632, 'psi': 0.9343866645204302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=47 head_norm_before_train=1.606852 cos_to_last_merge=0.7993 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=47 local utility u=0.009768 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9979231796909214, 'loss_val': 0.04288968348654583, 'psi': 0.9968808858619551}-{'f1_val': 0.996186023309311, 'auprc': 0.992769478986628, 'loss_val': 0.0469648851769898, 'psi': 0.9948194055802378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=47 head_norm_before_train=1.651562 cos_to_last_merge=0.9982 (last merge round=44)
[S6] round=47 local utility u=0.151127 metrics={'f1_val': 0.773656105496878, 'auprc': 0.9388315852386165, 'loss_val': 0.554434217934955, 'psi': 0.8397262973935734}-{'f1_val': 0.7458997964497257, 'auprc': 0.9128980199251499, 'loss_val': 0.6123489826993357, 'psi': 0.8126990858398954}
[S7] START round=47 head_norm_before_train=1.575056 cos_to_last_merge=0.9998 (last merge round=42)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5647061253406138, 'auprc': 0.7894756265573815, 'loss_val': 0.788265067049667, 'psi': 0.6546139258273209}-{'f1_val': 0.7020280544772246, 'auprc': 0.9854435550831013, 'loss_val': 0.24513694920214865, 'psi': 0.8153942547195754}
[S8] START round=47 head_norm_before_train=1.656833 cos_to_last_merge=0.9999 (last merge round=45)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9702390963292251, 'auprc': 0.9994062716950973, 'loss_val': 0.08700584421921431, 'psi': 0.981905966475574}-{'f1_val': 0.9940342119076258, 'auprc': 0.9875406093325424, 'loss_val': 0.04267327585520744, 'psi': 0.9914367708775924}
[S9] START round=47 head_norm_before_train=1.871123 cos_to_last_merge=0.7821 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.782
[S9] round=47 local utility u=0.005921 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964032416978509, 'loss_val': 0.01917799557556276, 'psi': 0.9965576037674753}-{'f1_val': 0.9962500947792776, 'auprc': 0.9937861286679945, 'loss_val': 0.020706328250926404, 'psi': 0.9952645083347644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=47 head_norm_before_train=1.983635 cos_to_last_merge=0.9998 (last merge round=41)
[S10] round=47 local utility u=0.000294 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9959179230603445, 'loss_val': 0.0236310427794981, 'psi': 0.995678152305731}-{'f1_val': 0.9955183051359886, 'auprc': 0.9959066774398586, 'loss_val': 0.024184667966097705, 'psi': 0.9956736540575366}
[S11] START round=47 head_norm_before_train=1.677555 cos_to_last_merge=0.9992 (last merge round=41)
[S11] round=47 local utility u=0.000830 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986485801528925, 'loss_val': 0.03317215153322693, 'psi': 0.9971519169076042}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986188108819223, 'loss_val': 0.03474188317463124, 'psi': 0.9971400091992162}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=1.571189 cos_to_last_merge=0.9730 (last merge round=35)
[S13] round=47 local utility u=0.303210 metrics={'f1_val': 0.7461318561520963, 'auprc': 0.687916374279316, 'loss_val': 0.8605159988429072, 'psi': 0.7228456634029842}-{'f1_val': 0.6431457487739138, 'auprc': 0.7205526572072553, 'loss_val': 0.9469279081430751, 'psi': 0.6741085121472504}
[S13] not sending this round → trigger blocked (psi=0.723)
[S14] START round=47 head_norm_before_train=1.982624 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9989397916338609, 'loss_val': 0.024615909408817305, 'psi': 0.9977763445820911}-{'f1_val': 0.9971907882668205, 'auprc': 0.9991820364469094, 'loss_val': 0.024031505791769638, 'psi': 0.9979872875388561}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.639894 cos_to_last_merge=0.9980 (last merge round=42)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7008305005721126, 'auprc': 0.9145522805473132, 'loss_val': 0.5673420124060522, 'psi': 0.786319212562193}-{'f1_val': 0.9372726028223745, 'auprc': 0.9929169370889105, 'loss_val': 0.1033340146187092, 'psi': 0.9595303365289889}
[S16] START round=47 head_norm_before_train=1.648658 cos_to_last_merge=0.9999 (last merge round=45)
[S16] round=47 local utility u=0.041229 metrics={'f1_val': 0.9908793938683479, 'auprc': 0.9939946661653614, 'loss_val': 0.04602394103309558, 'psi': 0.9921255027871533}-{'f1_val': 0.9825951037840022, 'auprc': 0.9930864521957741, 'loss_val': 0.0760511536554811, 'psi': 0.9867916431487109}
[S17] START round=47 head_norm_before_train=1.584683 cos_to_last_merge=0.9984 (last merge round=43)
[S17] round=47 local utility u=0.021745 metrics={'f1_val': 0.5706895755657146, 'auprc': 0.7105612720376926, 'loss_val': 1.1209897419053296, 'psi': 0.6266382541545058}-{'f1_val': 0.5792756352712338, 'auprc': 0.6571633632283254, 'loss_val': 1.0558016281410905, 'psi': 0.6104307264540705}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.627)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.992)
[S6] not sending this round → trigger blocked (psi=0.840)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.976)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.5647 head_norm=1.577702
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.116722e-02
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.5719 head_norm=1.612411 delta_norm=0.061167
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.880005 cos_to_last_merge=0.9550 (last merge round=39)
[S2] round=48 local utility u=0.226777 metrics={'f1_val': 0.858048355436748, 'auprc': 0.9943578985545096, 'loss_val': 0.28572566953685363, 'psi': 0.9125721726838527}-{'f1_val': 0.847939994023081, 'auprc': 0.9189979276221643, 'loss_val': 0.4525491220888325, 'psi': 0.8763631674627143}
[S3] START round=48 head_norm_before_train=1.743426 cos_to_last_merge=0.9988 (last merge round=44)
[S3] round=48 local utility u=0.018247 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.999724387922933, 'loss_val': 0.07546081161468046, 'psi': 0.9765348064088455}-{'f1_val': 0.960651231474942, 'auprc': 0.9995870651759857, 'loss_val': 0.10899914584353608, 'psi': 0.9762255649553595}
[S4] START round=48 head_norm_before_train=2.120856 (no previous merge yet)
[S4] round=48 local utility u=0.003318 metrics={'f1_val': 0.9414235272688016, 'auprc': 0.95032171435813, 'loss_val': 0.31152736306148204, 'psi': 0.9449828021045329}-{'f1_val': 0.9416014289286773, 'auprc': 0.9461523122664914, 'loss_val': 0.3067219187112483, 'psi': 0.9434217822638029}
[S4] not sending this round → trigger blocked (psi=0.945)
[S5] START round=48 head_norm_before_train=1.618418 cos_to_last_merge=0.7985 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.798
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9937634946521343, 'loss_val': 0.04373450259740408, 'psi': 0.9952170118464403}-{'f1_val': 0.996186023309311, 'auprc': 0.9979231796909214, 'loss_val': 0.04288968348654583, 'psi': 0.9968808858619551}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.694479 cos_to_last_merge=0.9965 (last merge round=44)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7473093865461948, 'auprc': 0.891754764783671, 'loss_val': 0.6906759570652671, 'psi': 0.8050875378411853}-{'f1_val': 0.773656105496878, 'auprc': 0.9388315852386165, 'loss_val': 0.554434217934955, 'psi': 0.8397262973935734}
[S7] START round=48 head_norm_before_train=1.612411 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.441560 metrics={'f1_val': 0.6562009641667224, 'auprc': 0.8074835967178002, 'loss_val': 0.5081387702292607, 'psi': 0.7167140171871536}-{'f1_val': 0.5647061253406138, 'auprc': 0.7894756265573815, 'loss_val': 0.788265067049667, 'psi': 0.6546139258273209}
[S8] START round=48 head_norm_before_train=1.669133 cos_to_last_merge=0.9998 (last merge round=45)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9699686898511469, 'auprc': 0.9922075446634976, 'loss_val': 0.09114099504242588, 'psi': 0.9788642317760872}-{'f1_val': 0.9702390963292251, 'auprc': 0.9994062716950973, 'loss_val': 0.08700584421921431, 'psi': 0.981905966475574}
[S9] START round=48 head_norm_before_train=1.875573 cos_to_last_merge=0.7815 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.782
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9996380606711399, 'loss_val': 0.0376345485326277, 'psi': 0.993568291339282}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964032416978509, 'loss_val': 0.01917799557556276, 'psi': 0.9965576037674753}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.988113 cos_to_last_merge=0.9997 (last merge round=41)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9960297746463964, 'loss_val': 0.02432562983334533, 'psi': 0.9954739907042175}-{'f1_val': 0.9955183051359886, 'auprc': 0.9959179230603445, 'loss_val': 0.0236310427794981, 'psi': 0.995678152305731}
[S11] START round=48 head_norm_before_train=1.690824 cos_to_last_merge=0.9989 (last merge round=41)
[S11] round=48 local utility u=0.000796 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986529371700328, 'loss_val': 0.03159419962641028, 'psi': 0.9971536597144603}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986485801528925, 'loss_val': 0.03317215153322693, 'psi': 0.9971519169076042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=48 head_norm_before_train=1.576263 cos_to_last_merge=0.9724 (last merge round=35)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.7527323209341586, 'auprc': 0.6855713129954145, 'loss_val': 0.9065071023117314, 'psi': 0.725867917758661}-{'f1_val': 0.7461318561520963, 'auprc': 0.687916374279316, 'loss_val': 0.8605159988429072, 'psi': 0.7228456634029842}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.991889 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9967842509228231, 'loss_val': 0.02495514064205298, 'psi': 0.9967683423952957}-{'f1_val': 0.9970007132142444, 'auprc': 0.9989397916338609, 'loss_val': 0.024615909408817305, 'psi': 0.9977763445820911}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.651131 cos_to_last_merge=0.9972 (last merge round=42)
[S15] round=48 local utility u=0.398342 metrics={'f1_val': 0.7583974422394648, 'auprc': 0.9894386167557077, 'loss_val': 0.340718789806518, 'psi': 0.8508139120459619}-{'f1_val': 0.7008305005721126, 'auprc': 0.9145522805473132, 'loss_val': 0.5673420124060522, 'psi': 0.786319212562193}
[S16] START round=48 head_norm_before_train=1.673092 cos_to_last_merge=0.9996 (last merge round=45)
[S16] round=48 local utility u=0.002869 metrics={'f1_val': 0.9910983341389921, 'auprc': 0.9945084876527386, 'loss_val': 0.04314074602099809, 'psi': 0.9924623955444907}-{'f1_val': 0.9908793938683479, 'auprc': 0.9939946661653614, 'loss_val': 0.04602394103309558, 'psi': 0.9921255027871533}
[S17] START round=48 head_norm_before_train=1.604057 cos_to_last_merge=0.9976 (last merge round=43)
[S17] round=48 local utility u=0.411326 metrics={'f1_val': 0.6199696898004493, 'auprc': 0.8602845647117202, 'loss_val': 1.0431892449616789, 'psi': 0.7160956397649576}-{'f1_val': 0.5706895755657146, 'auprc': 0.7105612720376926, 'loss_val': 1.1209897419053296, 'psi': 0.6266382541545058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] cosine check vs S16: cos=0.9985
[S2] START round=49 head_norm_before_train=1.898576 cos_to_last_merge=0.9527 (last merge round=39)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8265426194551714, 'auprc': 0.9947758562197265, 'loss_val': 0.3668316453709287, 'psi': 0.8938359141609935}-{'f1_val': 0.858048355436748, 'auprc': 0.9943578985545096, 'loss_val': 0.28572566953685363, 'psi': 0.9125721726838527}
[S3] START round=49 head_norm_before_train=1.769713 cos_to_last_merge=0.9981 (last merge round=44)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9993299752255551, 'loss_val': 0.09187347521914593, 'psi': 0.9763770413298943}-{'f1_val': 0.9610750853994537, 'auprc': 0.999724387922933, 'loss_val': 0.07546081161468046, 'psi': 0.9765348064088455}
[S4] START round=49 head_norm_before_train=2.130011 (no previous merge yet)
[S4] round=49 local utility u=0.083204 metrics={'f1_val': 0.9517726142228389, 'auprc': 0.9800854998543135, 'loss_val': 0.29650482735762085, 'psi': 0.9630977684754287}-{'f1_val': 0.9414235272688016, 'auprc': 0.95032171435813, 'loss_val': 0.31152736306148204, 'psi': 0.9449828021045329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=49 head_norm_before_train=1.631438 cos_to_last_merge=0.7977 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.798
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9914398128607754, 'loss_val': 0.04165490615554862, 'psi': 0.9942875391298968}-{'f1_val': 0.996186023309311, 'auprc': 0.9937634946521343, 'loss_val': 0.04373450259740408, 'psi': 0.9952170118464403}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.736045 cos_to_last_merge=0.9945 (last merge round=44)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6411230317186251, 'auprc': 0.8320310259356396, 'loss_val': 1.0630485420909819, 'psi': 0.7174862294054309}-{'f1_val': 0.7473093865461948, 'auprc': 0.891754764783671, 'loss_val': 0.6906759570652671, 'psi': 0.8050875378411853}
[S7] START round=49 head_norm_before_train=1.617791 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5678853006394883, 'auprc': 0.793529023037455, 'loss_val': 0.842253876347773, 'psi': 0.6581427895986749}-{'f1_val': 0.6562009641667224, 'auprc': 0.8074835967178002, 'loss_val': 0.5081387702292607, 'psi': 0.7167140171871536}
[S8] START round=49 head_norm_before_train=1.675894 cos_to_last_merge=0.9998 (last merge round=45)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.77999918145445, 'loss_val': 0.6493509264176079, 'psi': 0.7404099013660487}-{'f1_val': 0.9699686898511469, 'auprc': 0.9922075446634976, 'loss_val': 0.09114099504242588, 'psi': 0.9788642317760872}
[S9] START round=49 head_norm_before_train=1.879262 cos_to_last_merge=0.7813 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=49 local utility u=0.007029 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.9996997721019103, 'loss_val': 0.031379531702818174, 'psi': 0.9943547081250352}-{'f1_val': 0.9895217784513768, 'auprc': 0.9996380606711399, 'loss_val': 0.0376345485326277, 'psi': 0.993568291339282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=49 head_norm_before_train=1.992268 cos_to_last_merge=0.9996 (last merge round=41)
[S10] round=49 local utility u=0.000251 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9960974052925624, 'loss_val': 0.024026415687613878, 'psi': 0.9955010429626839}-{'f1_val': 0.9951034680760983, 'auprc': 0.9960297746463964, 'loss_val': 0.02432562983334533, 'psi': 0.9954739907042175}
[S11] START round=49 head_norm_before_train=1.703972 cos_to_last_merge=0.9986 (last merge round=41)
[S11] round=49 local utility u=0.000693 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986692829393703, 'loss_val': 0.03025811916835666, 'psi': 0.9971601980221954}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986529371700328, 'loss_val': 0.03159419962641028, 'psi': 0.9971536597144603}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=49 head_norm_before_train=1.580681 cos_to_last_merge=0.9717 (last merge round=35)
[S13] round=49 local utility u=0.104603 metrics={'f1_val': 0.7536383821987573, 'auprc': 0.7212767977951732, 'loss_val': 0.8098543948800165, 'psi': 0.7406937484373237}-{'f1_val': 0.7527323209341586, 'auprc': 0.6855713129954145, 'loss_val': 0.9065071023117314, 'psi': 0.725867917758661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=49 head_norm_before_train=2.001098 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=49 local utility u=0.003706 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9984115947670072, 'loss_val': 0.023882807792552484, 'psi': 0.9975650658353497}-{'f1_val': 0.9967577367102773, 'auprc': 0.9967842509228231, 'loss_val': 0.02495514064205298, 'psi': 0.9967683423952957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=49 head_norm_before_train=1.655675 cos_to_last_merge=0.9969 (last merge round=42)
[S15] round=49 local utility u=0.100180 metrics={'f1_val': 0.7777066800472188, 'auprc': 0.990001440073633, 'loss_val': 0.25790289218216483, 'psi': 0.8626245840577844}-{'f1_val': 0.7583974422394648, 'auprc': 0.9894386167557077, 'loss_val': 0.340718789806518, 'psi': 0.8508139120459619}
[S16] START round=49 head_norm_before_train=1.699063 cos_to_last_merge=0.9992 (last merge round=45)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9908793938683479, 'auprc': 0.9946239221642657, 'loss_val': 0.04300312945588986, 'psi': 0.992377205186715}-{'f1_val': 0.9910983341389921, 'auprc': 0.9945084876527386, 'loss_val': 0.04314074602099809, 'psi': 0.9924623955444907}
[S17] START round=49 head_norm_before_train=1.628414 cos_to_last_merge=0.9965 (last merge round=43)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6270558793746255, 'auprc': 0.8161455549614914, 'loss_val': 1.0567840871145457, 'psi': 0.7026917496093719}-{'f1_val': 0.6199696898004493, 'auprc': 0.8602845647117202, 'loss_val': 1.0431892449616789, 'psi': 0.7160956397649576}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.863)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=49 metric=0.5679 head_norm=1.626993
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.097718e-02
[S7] stored merged vector for next round verification (round=49)
[S7] DEBUG after merge:  round=49 metric=0.5685 head_norm=1.662300 delta_norm=0.060977
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=50 head_norm_before_train=1.917579 cos_to_last_merge=0.9506 (last merge round=39)
[S2] round=50 local utility u=0.317875 metrics={'f1_val': 0.9135904342348635, 'auprc': 0.9828993978359313, 'loss_val': 0.21773968773475963, 'psi': 0.9413140196752906}-{'f1_val': 0.8265426194551714, 'auprc': 0.9947758562197265, 'loss_val': 0.3668316453709287, 'psi': 0.8938359141609935}
[S3] START round=50 head_norm_before_train=1.794982 cos_to_last_merge=0.9973 (last merge round=44)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9996818249696604, 'loss_val': 0.10805399483994749, 'psi': 0.9765418843285556}-{'f1_val': 0.9610750853994537, 'auprc': 0.9993299752255551, 'loss_val': 0.09187347521914593, 'psi': 0.9763770413298943}
[S4] START round=50 head_norm_before_train=2.132730 (no previous merge yet)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.95270327984429, 'auprc': 0.967381956547104, 'loss_val': 0.3060791855931417, 'psi': 0.9585747505254156}-{'f1_val': 0.9517726142228389, 'auprc': 0.9800854998543135, 'loss_val': 0.29650482735762085, 'psi': 0.9630977684754287}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.643667 cos_to_last_merge=0.7969 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=50 local utility u=0.011717 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9978799754046181, 'loss_val': 0.03754049256795012, 'psi': 0.9968636041474339}-{'f1_val': 0.996186023309311, 'auprc': 0.9914398128607754, 'loss_val': 0.04165490615554862, 'psi': 0.9942875391298968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=50 head_norm_before_train=1.769384 cos_to_last_merge=0.9928 (last merge round=44)
[S6] round=50 local utility u=1.000000 metrics={'f1_val': 0.8228553871955607, 'auprc': 0.9522838428175121, 'loss_val': 0.4384403336444391, 'psi': 0.8746267694443413}-{'f1_val': 0.6411230317186251, 'auprc': 0.8320310259356396, 'loss_val': 1.0630485420909819, 'psi': 0.7174862294054309}
[S7] START round=50 head_norm_before_train=1.662300 cos_to_last_merge=1.0000 (last merge round=49)
[S7] round=50 local utility u=0.646752 metrics={'f1_val': 0.6871936246770372, 'auprc': 0.8381341278130067, 'loss_val': 0.3984151461602381, 'psi': 0.747569825931425}-{'f1_val': 0.5678853006394883, 'auprc': 0.793529023037455, 'loss_val': 0.842253876347773, 'psi': 0.6581427895986749}
[S8] START round=50 head_norm_before_train=1.684737 cos_to_last_merge=0.9996 (last merge round=45)
[S8] round=50 local utility u=1.000000 metrics={'f1_val': 0.9907243993413981, 'auprc': 0.999471296770863, 'loss_val': 0.04240722850169432, 'psi': 0.9942231583131841}-{'f1_val': 0.7140170479737811, 'auprc': 0.77999918145445, 'loss_val': 0.6493509264176079, 'psi': 0.7404099013660487}
[S9] START round=50 head_norm_before_train=1.884773 cos_to_last_merge=0.7805 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.780
[S9] round=50 local utility u=0.020255 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9974108402816929, 'loss_val': 0.019217878816749197, 'psi': 0.9969606432010121}-{'f1_val': 0.9907913321404518, 'auprc': 0.9996997721019103, 'loss_val': 0.031379531702818174, 'psi': 0.9943547081250352}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=50 head_norm_before_train=1.999319 cos_to_last_merge=0.9995 (last merge round=41)
[S10] round=50 local utility u=0.001477 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9961067928062958, 'loss_val': 0.023590077926240263, 'psi': 0.9957537002041115}-{'f1_val': 0.9951034680760983, 'auprc': 0.9960974052925624, 'loss_val': 0.024026415687613878, 'psi': 0.9955010429626839}
[S11] START round=50 head_norm_before_train=1.716410 cos_to_last_merge=0.9983 (last merge round=41)
[S11] round=50 local utility u=0.000598 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986918552709394, 'loss_val': 0.029129061027152313, 'psi': 0.997169226954823}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986692829393703, 'loss_val': 0.03025811916835666, 'psi': 0.9971601980221954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=50 head_norm_before_train=1.590135 cos_to_last_merge=0.9702 (last merge round=35)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.7027829543178244, 'auprc': 0.7372479559517723, 'loss_val': 0.7700469976433558, 'psi': 0.7165689549714036}-{'f1_val': 0.7536383821987573, 'auprc': 0.7212767977951732, 'loss_val': 0.8098543948800165, 'psi': 0.7406937484373237}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=2.007583 cos_to_last_merge=0.9999 (last merge round=46)
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9962607966644794, 'loss_val': 0.02679448264938835, 'psi': 0.9968051293241083}-{'f1_val': 0.9970007132142444, 'auprc': 0.9984115947670072, 'loss_val': 0.023882807792552484, 'psi': 0.9975650658353497}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=50 head_norm_before_train=1.661566 cos_to_last_merge=0.9964 (last merge round=42)
[S15] round=50 local utility u=0.764471 metrics={'f1_val': 0.9923462995299476, 'auprc': 0.9981861245227743, 'loss_val': 0.04135310885208595, 'psi': 0.9946822295270783}-{'f1_val': 0.7777066800472188, 'auprc': 0.990001440073633, 'loss_val': 0.25790289218216483, 'psi': 0.8626245840577844}
[S16] START round=50 head_norm_before_train=1.724738 cos_to_last_merge=0.9988 (last merge round=45)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.9912927424405764, 'auprc': 0.9951169311154079, 'loss_val': 0.04722845767660043, 'psi': 0.992822417910509}-{'f1_val': 0.9908793938683479, 'auprc': 0.9946239221642657, 'loss_val': 0.04300312945588986, 'psi': 0.992377205186715}
[S17] START round=50 head_norm_before_train=1.649829 cos_to_last_merge=0.9953 (last merge round=43)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.5643861216458244, 'auprc': 0.7472912594869925, 'loss_val': 1.2212952501425585, 'psi': 0.6375481767822916}-{'f1_val': 0.6270558793746255, 'auprc': 0.8161455549614914, 'loss_val': 1.0567840871145457, 'psi': 0.7026917496093719}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S16] ⇄ pheromone p=0.078 → S7@127.0.0.1:52808
[S2] START round=51 head_norm_before_train=1.930640 cos_to_last_merge=0.9490 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.8270663195105352, 'auprc': 0.983801390352804, 'loss_val': 0.4370311942543711, 'psi': 0.8897603478474427}-{'f1_val': 0.9135904342348635, 'auprc': 0.9828993978359313, 'loss_val': 0.21773968773475963, 'psi': 0.9413140196752906}
[S3] START round=51 head_norm_before_train=1.816675 cos_to_last_merge=0.9966 (last merge round=44)
[S3] round=51 local utility u=0.014985 metrics={'f1_val': 0.9615785680382265, 'auprc': 0.9996619428379252, 'loss_val': 0.08080424872316853, 'psi': 0.976811917958106}-{'f1_val': 0.9611152572344858, 'auprc': 0.9996818249696604, 'loss_val': 0.10805399483994749, 'psi': 0.9765418843285556}
[S4] START round=51 head_norm_before_train=2.136949 (no previous merge yet)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9412448012944761, 'auprc': 0.9545349377711717, 'loss_val': 0.30646534499836187, 'psi': 0.9465608558851544}-{'f1_val': 0.95270327984429, 'auprc': 0.967381956547104, 'loss_val': 0.3060791855931417, 'psi': 0.9585747505254156}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.653827 cos_to_last_merge=0.7962 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.796
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9942376937840107, 'loss_val': 0.03758965296222251, 'psi': 0.9954066914991909}-{'f1_val': 0.996186023309311, 'auprc': 0.9978799754046181, 'loss_val': 0.03754049256795012, 'psi': 0.9968636041474339}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.795995 cos_to_last_merge=0.9912 (last merge round=44)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.7559616433581201, 'auprc': 0.931136229761379, 'loss_val': 0.7479175976884579, 'psi': 0.8260314779194237}-{'f1_val': 0.8228553871955607, 'auprc': 0.9522838428175121, 'loss_val': 0.4384403336444391, 'psi': 0.8746267694443413}
[S7] START round=51 head_norm_before_train=1.671241 cos_to_last_merge=1.0000 (last merge round=49)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.5566515291110106, 'auprc': 0.7917084173227809, 'loss_val': 0.9128134688373616, 'psi': 0.6506742843957187}-{'f1_val': 0.6871936246770372, 'auprc': 0.8381341278130067, 'loss_val': 0.3984151461602381, 'psi': 0.747569825931425}
[S8] START round=51 head_norm_before_train=1.692178 cos_to_last_merge=0.9995 (last merge round=45)
[S8] round=51 local utility u=0.009051 metrics={'f1_val': 0.994132812741702, 'auprc': 0.9971271312238363, 'loss_val': 0.037723422663770885, 'psi': 0.9953305401345557}-{'f1_val': 0.9907243993413981, 'auprc': 0.999471296770863, 'loss_val': 0.04240722850169432, 'psi': 0.9942231583131841}
[S9] START round=51 head_norm_before_train=1.889398 cos_to_last_merge=0.7795 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.780
[S9] round=51 local utility u=0.003230 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996813720954173, 'loss_val': 0.019568515925082332, 'psi': 0.9978688559265018}-{'f1_val': 0.9966605118138915, 'auprc': 0.9974108402816929, 'loss_val': 0.019217878816749197, 'psi': 0.9969606432010121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=51 head_norm_before_train=2.001581 cos_to_last_merge=0.9993 (last merge round=41)
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9961255282867547, 'loss_val': 0.023551950584499378, 'psi': 0.9955122921603609}-{'f1_val': 0.9955183051359886, 'auprc': 0.9961067928062958, 'loss_val': 0.023590077926240263, 'psi': 0.9957537002041115}
[S11] START round=51 head_norm_before_train=1.728463 cos_to_last_merge=0.9980 (last merge round=41)
[S11] round=51 local utility u=0.000433 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998699630415199, 'loss_val': 0.028286041851282327, 'psi': 0.9971723370125268}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986918552709394, 'loss_val': 0.029129061027152313, 'psi': 0.997169226954823}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=51 head_norm_before_train=1.603823 cos_to_last_merge=0.9685 (last merge round=35)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.626085086834144, 'auprc': 0.6550571364743677, 'loss_val': 1.1627861094165202, 'psi': 0.6376739066902335}-{'f1_val': 0.7027829543178244, 'auprc': 0.7372479559517723, 'loss_val': 0.7700469976433558, 'psi': 0.7165689549714036}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=2.014581 cos_to_last_merge=0.9999 (last merge round=46)
[S14] round=51 local utility u=0.005784 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9990703554328829, 'loss_val': 0.02265219914630507, 'psi': 0.9978285701016998}-{'f1_val': 0.9971680177638609, 'auprc': 0.9962607966644794, 'loss_val': 0.02679448264938835, 'psi': 0.9968051293241083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=51 head_norm_before_train=1.676326 cos_to_last_merge=0.9959 (last merge round=42)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.8361680091847924, 'auprc': 0.9921839588086738, 'loss_val': 0.2855426626903492, 'psi': 0.898574389034345}-{'f1_val': 0.9923462995299476, 'auprc': 0.9981861245227743, 'loss_val': 0.04135310885208595, 'psi': 0.9946822295270783}
[S16] START round=51 head_norm_before_train=1.744650 cos_to_last_merge=0.9982 (last merge round=45)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.8755300932291934, 'auprc': 0.9883025566084276, 'loss_val': 0.6124451763277798, 'psi': 0.9206390785808871}-{'f1_val': 0.9912927424405764, 'auprc': 0.9951169311154079, 'loss_val': 0.04722845767660043, 'psi': 0.992822417910509}
[S17] START round=51 head_norm_before_train=1.669132 cos_to_last_merge=0.9943 (last merge round=43)
[S17] round=51 local utility u=0.306756 metrics={'f1_val': 0.6056156111265962, 'auprc': 0.7717453299919617, 'loss_val': 0.9285232942783596, 'psi': 0.6720674986727424}-{'f1_val': 0.5643861216458244, 'auprc': 0.7472912594869925, 'loss_val': 1.2212952501425585, 'psi': 0.6375481767822916}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=52 head_norm_before_train=1.941347 cos_to_last_merge=0.9479 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=52 local utility u=0.332573 metrics={'f1_val': 0.9100617644890938, 'auprc': 0.9886795462215164, 'loss_val': 0.2844928035942117, 'psi': 0.9415088771820629}-{'f1_val': 0.8270663195105352, 'auprc': 0.983801390352804, 'loss_val': 0.4370311942543711, 'psi': 0.8897603478474427}
[S3] START round=52 head_norm_before_train=1.836926 cos_to_last_merge=0.9958 (last merge round=44)
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.8702360422360679, 'auprc': 0.990599472528894, 'loss_val': 0.2882718534822329, 'psi': 0.9183814143531983}-{'f1_val': 0.9615785680382265, 'auprc': 0.9996619428379252, 'loss_val': 0.08080424872316853, 'psi': 0.976811917958106}
[S4] START round=52 head_norm_before_train=2.148011 (no previous merge yet)
[S4] round=52 local utility u=0.002031 metrics={'f1_val': 0.9407725917373508, 'auprc': 0.9560698751869561, 'loss_val': 0.3041758336032895, 'psi': 0.946891505117193}-{'f1_val': 0.9412448012944761, 'auprc': 0.9545349377711717, 'loss_val': 0.30646534499836187, 'psi': 0.9465608558851544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=52 head_norm_before_train=1.664114 cos_to_last_merge=0.7958 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.796
[S5] round=52 local utility u=0.001064 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9943740206047849, 'loss_val': 0.0358709387879362, 'psi': 0.9954612222275006}-{'f1_val': 0.996186023309311, 'auprc': 0.9942376937840107, 'loss_val': 0.03758965296222251, 'psi': 0.9954066914991909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=52 head_norm_before_train=1.819840 cos_to_last_merge=0.9897 (last merge round=44)
[S6] round=52 local utility u=0.043935 metrics={'f1_val': 0.7634403598845664, 'auprc': 0.9188998248069399, 'loss_val': 0.6682106395234204, 'psi': 0.8256241458535158}-{'f1_val': 0.7559616433581201, 'auprc': 0.931136229761379, 'loss_val': 0.7479175976884579, 'psi': 0.8260314779194237}
[S7] START round=52 head_norm_before_train=1.677857 cos_to_last_merge=0.9999 (last merge round=49)
[S7] round=52 local utility u=0.571065 metrics={'f1_val': 0.6600409836250156, 'auprc': 0.8120829819334692, 'loss_val': 0.4521430741341108, 'psi': 0.7208577829483971}-{'f1_val': 0.5566515291110106, 'auprc': 0.7917084173227809, 'loss_val': 0.9128134688373616, 'psi': 0.6506742843957187}
[S8] START round=52 head_norm_before_train=1.704165 cos_to_last_merge=0.9993 (last merge round=45)
[S8] round=52 local utility u=0.002349 metrics={'f1_val': 0.9934100914990341, 'auprc': 0.9994291698275747, 'loss_val': 0.03559581260596865, 'psi': 0.9958177228304503}-{'f1_val': 0.994132812741702, 'auprc': 0.9971271312238363, 'loss_val': 0.037723422663770885, 'psi': 0.9953305401345557}
[S9] START round=52 head_norm_before_train=1.895858 cos_to_last_merge=0.7788 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.779
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9997828369586333, 'loss_val': 0.04296013507891643, 'psi': 0.9931167592851141}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996813720954173, 'loss_val': 0.019568515925082332, 'psi': 0.9978688559265018}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=2.004128 cos_to_last_merge=0.9991 (last merge round=41)
[S10] round=52 local utility u=0.001645 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9961287494476094, 'loss_val': 0.022760245891112862, 'psi': 0.995762482860637}-{'f1_val': 0.9951034680760983, 'auprc': 0.9961255282867547, 'loss_val': 0.023551950584499378, 'psi': 0.9955122921603609}
[S11] START round=52 head_norm_before_train=1.739102 cos_to_last_merge=0.9977 (last merge round=41)
[S11] round=52 local utility u=0.000324 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986922568265103, 'loss_val': 0.0276155843742328, 'psi': 0.9971693875770513}-{'f1_val': 0.9961541414107454, 'auprc': 0.998699630415199, 'loss_val': 0.028286041851282327, 'psi': 0.9971723370125268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=52 head_norm_before_train=1.614886 cos_to_last_merge=0.9673 (last merge round=35)
[S13] round=52 local utility u=0.247081 metrics={'f1_val': 0.6534332236873439, 'auprc': 0.6935998737175374, 'loss_val': 0.9483406007679711, 'psi': 0.6694998836994213}-{'f1_val': 0.626085086834144, 'auprc': 0.6550571364743677, 'loss_val': 1.1627861094165202, 'psi': 0.6376739066902335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=52 head_norm_before_train=2.023034 cos_to_last_merge=0.9998 (last merge round=46)
[S14] round=52 local utility u=0.002330 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991402430494059, 'loss_val': 0.020663912748860622, 'psi': 0.9981026937804592}-{'f1_val': 0.9970007132142444, 'auprc': 0.9990703554328829, 'loss_val': 0.02265219914630507, 'psi': 0.9978285701016998}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=52 head_norm_before_train=1.689504 cos_to_last_merge=0.9956 (last merge round=42)
[S15] round=52 local utility u=0.614644 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9963286335094752, 'loss_val': 0.02993282732132952, 'psi': 0.9963567615899838}-{'f1_val': 0.8361680091847924, 'auprc': 0.9921839588086738, 'loss_val': 0.2855426626903492, 'psi': 0.898574389034345}
[S16] START round=52 head_norm_before_train=1.763790 cos_to_last_merge=0.9977 (last merge round=45)
[S16] round=52 local utility u=0.637193 metrics={'f1_val': 0.9917376510177964, 'auprc': 0.9906176017148628, 'loss_val': 0.042249817840723194, 'psi': 0.9912896312966231}-{'f1_val': 0.8755300932291934, 'auprc': 0.9883025566084276, 'loss_val': 0.6124451763277798, 'psi': 0.9206390785808871}
[S17] START round=52 head_norm_before_train=1.688550 cos_to_last_merge=0.9932 (last merge round=43)
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.5605446384183149, 'auprc': 0.672766942825333, 'loss_val': 1.4346065270989121, 'psi': 0.6054335601811222}-{'f1_val': 0.6056156111265962, 'auprc': 0.7717453299919617, 'loss_val': 0.9285232942783596, 'psi': 0.6720674986727424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.9977
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9977
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=52 metric=0.9917 head_norm=1.780027
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.628439e-02
[S16] stored merged vector for next round verification (round=52)
[S16] DEBUG after merge:  round=52 metric=0.9920 head_norm=1.730663 delta_norm=0.076284
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=53 head_norm_before_train=1.952087 cos_to_last_merge=0.9466 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.8105901753706557, 'auprc': 0.9160196716930327, 'loss_val': 0.5272954442268026, 'psi': 0.8527619738996065}-{'f1_val': 0.9100617644890938, 'auprc': 0.9886795462215164, 'loss_val': 0.2844928035942117, 'psi': 0.9415088771820629}
[S3] START round=53 head_norm_before_train=1.854196 cos_to_last_merge=0.9952 (last merge round=44)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.7829202972494593, 'auprc': 0.9799280622475008, 'loss_val': 0.5914390638095501, 'psi': 0.861723403248676}-{'f1_val': 0.8702360422360679, 'auprc': 0.990599472528894, 'loss_val': 0.2882718534822329, 'psi': 0.9183814143531983}
[S4] START round=53 head_norm_before_train=2.155363 (no previous merge yet)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9413490160282215, 'auprc': 0.9539372874534756, 'loss_val': 0.3065923691704722, 'psi': 0.9463843245983232}-{'f1_val': 0.9407725917373508, 'auprc': 0.9560698751869561, 'loss_val': 0.3041758336032895, 'psi': 0.946891505117193}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.676309 cos_to_last_merge=0.7950 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=53 local utility u=0.007715 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9982432108724888, 'loss_val': 0.032928527808113776, 'psi': 0.9970968389422898}-{'f1_val': 0.996186023309311, 'auprc': 0.9943740206047849, 'loss_val': 0.0358709387879362, 'psi': 0.9954612222275006}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=53 head_norm_before_train=1.841325 cos_to_last_merge=0.9880 (last merge round=44)
[S6] round=53 local utility u=0.550026 metrics={'f1_val': 0.8743326580294464, 'auprc': 0.9343526938499379, 'loss_val': 0.2798701587761728, 'psi': 0.898340672357643}-{'f1_val': 0.7634403598845664, 'auprc': 0.9188998248069399, 'loss_val': 0.6682106395234204, 'psi': 0.8256241458535158}
[S7] START round=53 head_norm_before_train=1.683310 cos_to_last_merge=0.9998 (last merge round=49)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.5560408947076909, 'auprc': 0.7922297738261692, 'loss_val': 0.9229627555381764, 'psi': 0.6505164463550822}-{'f1_val': 0.6600409836250156, 'auprc': 0.8120829819334692, 'loss_val': 0.4521430741341108, 'psi': 0.7208577829483971}
[S8] START round=53 head_norm_before_train=1.719076 cos_to_last_merge=0.9991 (last merge round=45)
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.9995908631444099, 'loss_val': 0.035390345996424905, 'psi': 0.9955309835283784}-{'f1_val': 0.9934100914990341, 'auprc': 0.9994291698275747, 'loss_val': 0.03559581260596865, 'psi': 0.9958177228304503}
[S9] START round=53 head_norm_before_train=1.901650 cos_to_last_merge=0.7783 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.778
[S9] round=53 local utility u=0.016773 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9996146107806982, 'loss_val': 0.02439841892394038, 'psi': 0.9945984432364239}-{'f1_val': 0.9886727075027679, 'auprc': 0.9997828369586333, 'loss_val': 0.04296013507891643, 'psi': 0.9931167592851141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=53 head_norm_before_train=2.008646 cos_to_last_merge=0.9988 (last merge round=41)
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9961201728318079, 'loss_val': 0.023745150911828848, 'psi': 0.9956419414709614}-{'f1_val': 0.9955183051359886, 'auprc': 0.9961287494476094, 'loss_val': 0.022760245891112862, 'psi': 0.995762482860637}
[S11] START round=53 head_norm_before_train=1.749571 cos_to_last_merge=0.9974 (last merge round=41)
[S11] round=53 local utility u=0.000188 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986769393967412, 'loss_val': 0.027193038188392252, 'psi': 0.9971632606051437}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986922568265103, 'loss_val': 0.0276155843742328, 'psi': 0.9971693875770513}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=53 head_norm_before_train=1.621118 cos_to_last_merge=0.9665 (last merge round=35)
[S13] round=53 local utility u=0.613097 metrics={'f1_val': 0.7491509564996842, 'auprc': 0.8326651983518372, 'loss_val': 0.7136497823108007, 'psi': 0.7825566532405455}-{'f1_val': 0.6534332236873439, 'auprc': 0.6935998737175374, 'loss_val': 0.9483406007679711, 'psi': 0.6694998836994213}
[S13] not sending this round → trigger blocked (psi=0.783)
[S14] START round=53 head_norm_before_train=2.027800 cos_to_last_merge=0.9997 (last merge round=46)
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9971967322653936, 'loss_val': 0.02186073408106828, 'psi': 0.9975717485188129}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991402430494059, 'loss_val': 0.020663912748860622, 'psi': 0.9981026937804592}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=53 head_norm_before_train=1.702984 cos_to_last_merge=0.9953 (last merge round=42)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.9620503382187028, 'auprc': 0.9937398360903735, 'loss_val': 0.06923347611222508, 'psi': 0.974726137367371}-{'f1_val': 0.9963755136436562, 'auprc': 0.9963286335094752, 'loss_val': 0.02993282732132952, 'psi': 0.9963567615899838}
[S16] START round=53 head_norm_before_train=1.730663 cos_to_last_merge=1.0000 (last merge round=52)
[S16] round=53 local utility u=0.013053 metrics={'f1_val': 0.9927032863016021, 'auprc': 0.9948879354055674, 'loss_val': 0.03474958234591611, 'psi': 0.9935771459431881}-{'f1_val': 0.9917376510177964, 'auprc': 0.9906176017148628, 'loss_val': 0.042249817840723194, 'psi': 0.9912896312966231}
[S17] START round=53 head_norm_before_train=1.699456 cos_to_last_merge=0.9925 (last merge round=43)
[S17] round=53 local utility u=0.380798 metrics={'f1_val': 0.6014146350612988, 'auprc': 0.8071087529944618, 'loss_val': 1.321256521391193, 'psi': 0.683692282234564}-{'f1_val': 0.5605446384183149, 'auprc': 0.672766942825333, 'loss_val': 1.4346065270989121, 'psi': 0.6054335601811222}
[S16] not sending this round → trigger blocked (psi=0.994)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.898)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=53 metric=0.5560 head_norm=1.691510
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.612194e-02
[S7] stored merged vector for next round verification (round=53)
[S7] DEBUG after merge:  round=53 metric=0.5588 head_norm=1.734663 delta_norm=0.076122
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=1.957960 cos_to_last_merge=0.9461 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.946
[S2] round=54 local utility u=0.027427 metrics={'f1_val': 0.8155190777990655, 'auprc': 0.9071283216350201, 'loss_val': 0.47534136252042525, 'psi': 0.8521627753334473}-{'f1_val': 0.8105901753706557, 'auprc': 0.9160196716930327, 'loss_val': 0.5272954442268026, 'psi': 0.8527619738996065}
[S3] START round=54 head_norm_before_train=1.871431 cos_to_last_merge=0.9944 (last merge round=44)
[S3] round=54 local utility u=0.256535 metrics={'f1_val': 0.8335816700964352, 'auprc': 0.9946986084745091, 'loss_val': 0.4266481855783197, 'psi': 0.8980284454476648}-{'f1_val': 0.7829202972494593, 'auprc': 0.9799280622475008, 'loss_val': 0.5914390638095501, 'psi': 0.861723403248676}
[S4] START round=54 head_norm_before_train=2.162008 (no previous merge yet)
[S4] round=54 local utility u=0.005008 metrics={'f1_val': 0.9444209877728871, 'auprc': 0.9549778819391895, 'loss_val': 0.31813016006983297, 'psi': 0.9486437454394081}-{'f1_val': 0.9413490160282215, 'auprc': 0.9539372874534756, 'loss_val': 0.3065923691704722, 'psi': 0.9463843245983232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=54 head_norm_before_train=1.690218 cos_to_last_merge=0.7938 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.794
[S5] round=54 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9946700500849894, 'loss_val': 0.033010385876817504, 'psi': 0.9955796340195824}-{'f1_val': 0.9963325909888239, 'auprc': 0.9982432108724888, 'loss_val': 0.032928527808113776, 'psi': 0.9970968389422898}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=54 head_norm_before_train=1.865657 cos_to_last_merge=0.9861 (last merge round=44)
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.7004636440692915, 'auprc': 0.8668461657239929, 'loss_val': 0.950100206217149, 'psi': 0.767016652731172}-{'f1_val': 0.8743326580294464, 'auprc': 0.9343526938499379, 'loss_val': 0.2798701587761728, 'psi': 0.898340672357643}
[S7] START round=54 head_norm_before_train=1.734663 cos_to_last_merge=1.0000 (last merge round=53)
[S7] round=54 local utility u=1.000000 metrics={'f1_val': 0.9643663363839485, 'auprc': 0.9924372799004749, 'loss_val': 0.16595858250337092, 'psi': 0.9755947137905591}-{'f1_val': 0.5560408947076909, 'auprc': 0.7922297738261692, 'loss_val': 0.9229627555381764, 'psi': 0.6505164463550822}
[S8] START round=54 head_norm_before_train=1.732181 cos_to_last_merge=0.9988 (last merge round=45)
[S8] round=54 local utility u=0.003343 metrics={'f1_val': 0.994132812741702, 'auprc': 0.9986310262857977, 'loss_val': 0.033675995691261125, 'psi': 0.9959320981593403}-{'f1_val': 0.9928243971176908, 'auprc': 0.9995908631444099, 'loss_val': 0.035390345996424905, 'psi': 0.9955309835283784}
[S9] START round=54 head_norm_before_train=1.909400 cos_to_last_merge=0.7773 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.777
[S9] round=54 local utility u=0.022860 metrics={'f1_val': 0.9975426610709598, 'auprc': 0.9996393348834769, 'loss_val': 0.016482842610069538, 'psi': 0.9983813305959667}-{'f1_val': 0.991254331540241, 'auprc': 0.9996146107806982, 'loss_val': 0.02439841892394038, 'psi': 0.9945984432364239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=54 head_norm_before_train=2.016024 cos_to_last_merge=0.9987 (last merge round=41)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9961304483186617, 'loss_val': 0.023347458890631088, 'psi': 0.9955142601731236}-{'f1_val': 0.9953231205637304, 'auprc': 0.9961201728318079, 'loss_val': 0.023745150911828848, 'psi': 0.9956419414709614}
[S11] START round=54 head_norm_before_train=1.758907 cos_to_last_merge=0.9971 (last merge round=41)
[S11] round=54 local utility u=0.000144 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986587710591064, 'loss_val': 0.02685066798600672, 'psi': 0.9971559932700897}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986769393967412, 'loss_val': 0.027193038188392252, 'psi': 0.9971632606051437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=54 head_norm_before_train=1.630654 cos_to_last_merge=0.9655 (last merge round=35)
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.6730214651012402, 'auprc': 0.8369450078840682, 'loss_val': 0.8753713540681854, 'psi': 0.7385908822143714}-{'f1_val': 0.7491509564996842, 'auprc': 0.8326651983518372, 'loss_val': 0.7136497823108007, 'psi': 0.7825566532405455}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=2.030754 cos_to_last_merge=0.9997 (last merge round=46)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.996333081002392, 'auprc': 0.9966072390598125, 'loss_val': 0.0319279761234449, 'psi': 0.9964427442253603}-{'f1_val': 0.9978217593544257, 'auprc': 0.9971967322653936, 'loss_val': 0.02186073408106828, 'psi': 0.9975717485188129}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=1.723978 cos_to_last_merge=0.9946 (last merge round=42)
[S15] round=54 local utility u=0.125176 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9940812568000211, 'loss_val': 0.025502493179941226, 'psi': 0.9954223654925611}-{'f1_val': 0.9620503382187028, 'auprc': 0.9937398360903735, 'loss_val': 0.06923347611222508, 'psi': 0.974726137367371}
[S16] START round=54 head_norm_before_train=1.745462 cos_to_last_merge=1.0000 (last merge round=52)
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.9078944647998461, 'auprc': 0.9931517468722296, 'loss_val': 0.2505185506478317, 'psi': 0.9419973776287995}-{'f1_val': 0.9927032863016021, 'auprc': 0.9948879354055674, 'loss_val': 0.03474958234591611, 'psi': 0.9935771459431881}
[S17] START round=54 head_norm_before_train=1.706550 cos_to_last_merge=0.9923 (last merge round=43)
[S17] round=54 local utility u=0.641198 metrics={'f1_val': 0.727398714334982, 'auprc': 0.8363655779035326, 'loss_val': 0.8825345426138953, 'psi': 0.7709854597624023}-{'f1_val': 0.6014146350612988, 'auprc': 0.8071087529944618, 'loss_val': 1.321256521391193, 'psi': 0.683692282234564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=0.9998
[S2]  timeout peer S8
[S17]  timeout peer S13
[S3]  timeout peer S11
[S8]  timeout peer S15
[S10]  timeout peer S14
[S15]  timeout peer S9
[S6]  timeout peer S17
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=54 metric=0.9079 head_norm=1.761080
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.868583e-02
[S16] stored merged vector for next round verification (round=54)
[S16] DEBUG after merge:  round=54 metric=0.9082 head_norm=1.750511 delta_norm=0.018686
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=55 head_norm_before_train=1.962106 cos_to_last_merge=0.9455 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.945
[S2] round=55 local utility u=0.240460 metrics={'f1_val': 0.8322740192456946, 'auprc': 0.9868167358741297, 'loss_val': 0.3340161114248515, 'psi': 0.8940911058970686}-{'f1_val': 0.8155190777990655, 'auprc': 0.9071283216350201, 'loss_val': 0.47534136252042525, 'psi': 0.8521627753334473}
[S2] not sending this round → trigger blocked (psi=0.894)
[S3] START round=55 head_norm_before_train=1.888350 cos_to_last_merge=0.9937 (last merge round=44)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.8453172819925351, 'auprc': 0.9707178164395986, 'loss_val': 0.43752290468005267, 'psi': 0.8954774957713605}-{'f1_val': 0.8335816700964352, 'auprc': 0.9946986084745091, 'loss_val': 0.4266481855783197, 'psi': 0.8980284454476648}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=2.165632 (no previous merge yet)
[S4] round=55 local utility u=0.082049 metrics={'f1_val': 0.9563022368980667, 'auprc': 0.9794805491930716, 'loss_val': 0.298827753171044, 'psi': 0.9655735618160687}-{'f1_val': 0.9444209877728871, 'auprc': 0.9549778819391895, 'loss_val': 0.31813016006983297, 'psi': 0.9486437454394081}
[S4] not sending this round → trigger blocked (psi=0.966)
[S5] START round=55 head_norm_before_train=1.702348 cos_to_last_merge=0.7928 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9916115149080541, 'loss_val': 0.037525666450942984, 'psi': 0.9943562199488083}-{'f1_val': 0.996186023309311, 'auprc': 0.9946700500849894, 'loss_val': 0.033010385876817504, 'psi': 0.9955796340195824}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.888707 cos_to_last_merge=0.9846 (last merge round=44)
[S6] round=55 local utility u=0.038785 metrics={'f1_val': 0.7433724299957605, 'auprc': 0.7458572063161513, 'loss_val': 0.7670160696795413, 'psi': 0.7443663405239168}-{'f1_val': 0.7004636440692915, 'auprc': 0.8668461657239929, 'loss_val': 0.950100206217149, 'psi': 0.767016652731172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=55 head_norm_before_train=1.740078 cos_to_last_merge=1.0000 (last merge round=53)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.6043501294368252, 'auprc': 0.7960115074970874, 'loss_val': 0.723029957358109, 'psi': 0.6810146806609301}-{'f1_val': 0.9643663363839485, 'auprc': 0.9924372799004749, 'loss_val': 0.16595858250337092, 'psi': 0.9755947137905591}
[S8] START round=55 head_norm_before_train=1.743067 cos_to_last_merge=0.9985 (last merge round=45)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9938464732474644, 'auprc': 0.9951700699332277, 'loss_val': 0.033727081428287745, 'psi': 0.9943759119217698}-{'f1_val': 0.994132812741702, 'auprc': 0.9986310262857977, 'loss_val': 0.033675995691261125, 'psi': 0.9959320981593403}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=1.913649 cos_to_last_merge=0.7764 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.776
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995985783463568, 'loss_val': 0.01742243053673962, 'psi': 0.9981011788458284}-{'f1_val': 0.9975426610709598, 'auprc': 0.9996393348834769, 'loss_val': 0.016482842610069538, 'psi': 0.9983813305959667}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=2.024312 cos_to_last_merge=0.9987 (last merge round=41)
[S10] round=55 local utility u=0.001911 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.996328065351775, 'loss_val': 0.022607562377779687, 'psi': 0.9958422092223032}-{'f1_val': 0.9951034680760983, 'auprc': 0.9961304483186617, 'loss_val': 0.023347458890631088, 'psi': 0.9955142601731236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=55 head_norm_before_train=1.767515 cos_to_last_merge=0.9969 (last merge round=41)
[S11] round=55 local utility u=0.000212 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986540681440802, 'loss_val': 0.026413030092097767, 'psi': 0.9971541121040793}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986587710591064, 'loss_val': 0.02685066798600672, 'psi': 0.9971559932700897}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=55 head_norm_before_train=1.639702 cos_to_last_merge=0.9645 (last merge round=35)
[S13] round=55 local utility u=0.314244 metrics={'f1_val': 0.7773030733275341, 'auprc': 0.772714063490696, 'loss_val': 0.679880262353394, 'psi': 0.7754674693927989}-{'f1_val': 0.6730214651012402, 'auprc': 0.8369450078840682, 'loss_val': 0.8753713540681854, 'psi': 0.7385908822143714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=55 head_norm_before_train=2.036083 cos_to_last_merge=0.9996 (last merge round=46)
[S14] round=55 local utility u=0.010285 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9974753671036289, 'loss_val': 0.020413292330425936, 'psi': 0.997435108542487}-{'f1_val': 0.996333081002392, 'auprc': 0.9966072390598125, 'loss_val': 0.0319279761234449, 'psi': 0.9964427442253603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=55 head_norm_before_train=1.747785 cos_to_last_merge=0.9937 (last merge round=42)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.7745764362728297, 'auprc': 0.9832908067998976, 'loss_val': 0.4526794440840275, 'psi': 0.8580621844836569}-{'f1_val': 0.9963164379542544, 'auprc': 0.9940812568000211, 'loss_val': 0.025502493179941226, 'psi': 0.9954223654925611}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.750511 cos_to_last_merge=1.0000 (last merge round=54)
[S16] round=55 local utility u=0.356980 metrics={'f1_val': 0.9921529403166653, 'auprc': 0.9929059335216214, 'loss_val': 0.04137103330077906, 'psi': 0.9924541375986478}-{'f1_val': 0.9078944647998461, 'auprc': 0.9931517468722296, 'loss_val': 0.2505185506478317, 'psi': 0.9419973776287995}
[S17] START round=55 head_norm_before_train=1.716967 cos_to_last_merge=0.9918 (last merge round=43)
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.6315224680727659, 'auprc': 0.8847301295300851, 'loss_val': 1.1607063695353512, 'psi': 0.7328055326556937}-{'f1_val': 0.727398714334982, 'auprc': 0.8363655779035326, 'loss_val': 0.8825345426138953, 'psi': 0.7709854597624023}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:52808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] ⇄ pheromone p=0.331 → S16@127.0.0.1:52816
[S7] RECEIVED delta(kind=head bytes=1804) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] ⇄ pheromone p=0.164 → S7@127.0.0.1:52808
[S2] START round=56 head_norm_before_train=1.965060 cos_to_last_merge=0.9443 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=56 local utility u=0.008628 metrics={'f1_val': 0.8377771050320431, 'auprc': 0.9732263986951067, 'loss_val': 0.30900785338067377, 'psi': 0.8919568224972685}-{'f1_val': 0.8322740192456946, 'auprc': 0.9868167358741297, 'loss_val': 0.3340161114248515, 'psi': 0.8940911058970686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=56 head_norm_before_train=1.903230 cos_to_last_merge=0.9930 (last merge round=44)
[S3] round=56 local utility u=0.569925 metrics={'f1_val': 0.9615156781046452, 'auprc': 0.9979000911337421, 'loss_val': 0.07641084839858388, 'psi': 0.976069443316284}-{'f1_val': 0.8453172819925351, 'auprc': 0.9707178164395986, 'loss_val': 0.43752290468005267, 'psi': 0.8954774957713605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=56 head_norm_before_train=2.175316 (no previous merge yet)
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.927946154651694, 'auprc': 0.9214207559435322, 'loss_val': 0.39111968611822484, 'psi': 0.9253359951684293}-{'f1_val': 0.9563022368980667, 'auprc': 0.9794805491930716, 'loss_val': 0.298827753171044, 'psi': 0.9655735618160687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.710953 cos_to_last_merge=0.7927 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=56 local utility u=0.013013 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9979215772886563, 'loss_val': 0.03130873774265178, 'psi': 0.9969681855087568}-{'f1_val': 0.996186023309311, 'auprc': 0.9916115149080541, 'loss_val': 0.037525666450942984, 'psi': 0.9943562199488083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=56 head_norm_before_train=1.907375 cos_to_last_merge=0.9833 (last merge round=44)
[S6] round=56 local utility u=0.616170 metrics={'f1_val': 0.8119077118065353, 'auprc': 0.9414127660016962, 'loss_val': 0.5325539896324384, 'psi': 0.8637097334845997}-{'f1_val': 0.7433724299957605, 'auprc': 0.7458572063161513, 'loss_val': 0.7670160696795413, 'psi': 0.7443663405239168}
[S6] not sending this round → trigger blocked (psi=0.864)
[S7] START round=56 head_norm_before_train=1.742684 cos_to_last_merge=1.0000 (last merge round=53)
[S7] round=56 local utility u=0.220883 metrics={'f1_val': 0.6399440920038135, 'auprc': 0.8054587588985378, 'loss_val': 0.5231697665490453, 'psi': 0.7061499587617033}-{'f1_val': 0.6043501294368252, 'auprc': 0.7960115074970874, 'loss_val': 0.723029957358109, 'psi': 0.6810146806609301}
[S8] START round=56 head_norm_before_train=1.754455 cos_to_last_merge=0.9982 (last merge round=45)
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.988515865222847, 'loss_val': 0.03323755838697021, 'psi': 0.9919736504405569}-{'f1_val': 0.9938464732474644, 'auprc': 0.9951700699332277, 'loss_val': 0.033727081428287745, 'psi': 0.9943759119217698}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=56 head_norm_before_train=1.918496 cos_to_last_merge=0.7760 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.776
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9998507194437812, 'loss_val': 0.021885791166760794, 'psi': 0.9967044775471339}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995985783463568, 'loss_val': 0.01742243053673962, 'psi': 0.9981011788458284}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=2.028500 cos_to_last_merge=0.9984 (last merge round=41)
[S10] round=56 local utility u=0.000292 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9966803645103235, 'loss_val': 0.023079879882664033, 'psi': 0.9959831288857226}-{'f1_val': 0.9955183051359886, 'auprc': 0.996328065351775, 'loss_val': 0.022607562377779687, 'psi': 0.9958422092223032}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=56 head_norm_before_train=1.776075 cos_to_last_merge=0.9966 (last merge round=41)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9983507454422971, 'loss_val': 0.030142163250257946, 'psi': 0.9970327830233661}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986540681440802, 'loss_val': 0.026413030092097767, 'psi': 0.9971541121040793}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.649655 cos_to_last_merge=0.9632 (last merge round=35)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6891219297673946, 'auprc': 0.6919426621000235, 'loss_val': 0.9811274113731469, 'psi': 0.6902502227004461}-{'f1_val': 0.7773030733275341, 'auprc': 0.772714063490696, 'loss_val': 0.679880262353394, 'psi': 0.7754674693927989}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=2.043680 cos_to_last_merge=0.9995 (last merge round=46)
[S14] round=56 local utility u=0.002378 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.999183266882115, 'loss_val': 0.019476404433413877, 'psi': 0.9979877797129384}-{'f1_val': 0.9974082695017256, 'auprc': 0.9974753671036289, 'loss_val': 0.020413292330425936, 'psi': 0.997435108542487}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=56 head_norm_before_train=1.768655 cos_to_last_merge=0.9929 (last merge round=42)
[S15] round=56 local utility u=0.898935 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9966190873466568, 'loss_val': 0.025233868880517745, 'psi': 0.9964374977112154}-{'f1_val': 0.7745764362728297, 'auprc': 0.9832908067998976, 'loss_val': 0.4526794440840275, 'psi': 0.8580621844836569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=56 head_norm_before_train=1.765335 cos_to_last_merge=1.0000 (last merge round=54)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.9917843895488756, 'auprc': 0.9925769079847562, 'loss_val': 0.040103119363110784, 'psi': 0.9921013969232279}-{'f1_val': 0.9921529403166653, 'auprc': 0.9929059335216214, 'loss_val': 0.04137103330077906, 'psi': 0.9924541375986478}
[S17] START round=56 head_norm_before_train=1.725127 cos_to_last_merge=0.9913 (last merge round=43)
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.6186702326500313, 'auprc': 0.8429025930571024, 'loss_val': 1.2726932953239494, 'psi': 0.7083631768128598}-{'f1_val': 0.6315224680727659, 'auprc': 0.8847301295300851, 'loss_val': 1.1607063695353512, 'psi': 0.7328055326556937}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.9997
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=56 metric=0.6399 head_norm=1.744812
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.967779e-02
[S7] stored merged vector for next round verification (round=56)
[S7] DEBUG after merge:  round=56 metric=0.6392 head_norm=1.754993 delta_norm=0.019678
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=57 head_norm_before_train=1.980328 cos_to_last_merge=0.9430 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.8318415422271593, 'auprc': 0.9897714012620389, 'loss_val': 0.32994665333563894, 'psi': 0.8950134858411112}-{'f1_val': 0.8377771050320431, 'auprc': 0.9732263986951067, 'loss_val': 0.30900785338067377, 'psi': 0.8919568224972685}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=1.916642 cos_to_last_merge=0.9924 (last merge round=44)
[S3] round=57 local utility u=0.032816 metrics={'f1_val': 0.9707791996370744, 'auprc': 0.9983918737672609, 'loss_val': 0.06783561057167298, 'psi': 0.981824269289149}-{'f1_val': 0.9615156781046452, 'auprc': 0.9979000911337421, 'loss_val': 0.07641084839858388, 'psi': 0.976069443316284}
[S3] not sending this round → trigger blocked (psi=0.982)
[S4] START round=57 head_norm_before_train=2.175891 (no previous merge yet)
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9160630031241734, 'auprc': 0.8833655028692833, 'loss_val': 0.4546434697064456, 'psi': 0.9029840030222174}-{'f1_val': 0.927946154651694, 'auprc': 0.9214207559435322, 'loss_val': 0.39111968611822484, 'psi': 0.9253359951684293}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.718756 cos_to_last_merge=0.7925 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9977158751681172, 'loss_val': 0.03160036357850508, 'psi': 0.9967979640528335}-{'f1_val': 0.9963325909888239, 'auprc': 0.9979215772886563, 'loss_val': 0.03130873774265178, 'psi': 0.9969681855087568}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=1.923210 cos_to_last_merge=0.9822 (last merge round=44)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.6928140294639435, 'auprc': 0.9256509842790828, 'loss_val': 0.933343788500805, 'psi': 0.7859488113899993}-{'f1_val': 0.8119077118065353, 'auprc': 0.9414127660016962, 'loss_val': 0.5325539896324384, 'psi': 0.8637097334845997}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.754993 cos_to_last_merge=1.0000 (last merge round=56)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.5870006343295893, 'auprc': 0.7938946679817108, 'loss_val': 0.7937705688847502, 'psi': 0.6697582477904379}-{'f1_val': 0.6399440920038135, 'auprc': 0.8054587588985378, 'loss_val': 0.5231697665490453, 'psi': 0.7061499587617033}
[S8] START round=57 head_norm_before_train=1.765177 cos_to_last_merge=0.9980 (last merge round=45)
[S8] round=57 local utility u=0.003363 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9903022868293501, 'loss_val': 0.0318702204548457, 'psi': 0.9926882190831581}-{'f1_val': 0.9942788405856967, 'auprc': 0.988515865222847, 'loss_val': 0.03323755838697021, 'psi': 0.9919736504405569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S8] sending update (kind=head size=1810 to 1 peers)
[S9] START round=57 head_norm_before_train=1.924384 cos_to_last_merge=0.7756 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.776
[S9] round=57 local utility u=0.009395 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9996151681273009, 'loss_val': 0.017364761599695133, 'psi': 0.9981078147582061}-{'f1_val': 0.9946069829493691, 'auprc': 0.9998507194437812, 'loss_val': 0.021885791166760794, 'psi': 0.9967044775471339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=57 head_norm_before_train=2.033816 cos_to_last_merge=0.9983 (last merge round=41)
[S10] round=57 local utility u=0.000054 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9966894891492093, 'loss_val': 0.02299890053317681, 'psi': 0.9959867787412768}-{'f1_val': 0.9955183051359886, 'auprc': 0.9966803645103235, 'loss_val': 0.023079879882664033, 'psi': 0.9959831288857226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=57 head_norm_before_train=1.782887 cos_to_last_merge=0.9964 (last merge round=41)
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9981696832943168, 'loss_val': 0.03687196481228721, 'psi': 0.9969603581641739}-{'f1_val': 0.9961541414107454, 'auprc': 0.9983507454422971, 'loss_val': 0.030142163250257946, 'psi': 0.9970327830233661}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.663525 cos_to_last_merge=0.9615 (last merge round=35)
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.6306566933893236, 'auprc': 0.6495418940729095, 'loss_val': 1.2118790220814462, 'psi': 0.638210773662758}-{'f1_val': 0.6891219297673946, 'auprc': 0.6919426621000235, 'loss_val': 0.9811274113731469, 'psi': 0.6902502227004461}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=2.052324 cos_to_last_merge=0.9994 (last merge round=46)
[S14] round=57 local utility u=0.000140 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.999152835957376, 'loss_val': 0.019104282216389944, 'psi': 0.9979756073430428}-{'f1_val': 0.9971907882668205, 'auprc': 0.999183266882115, 'loss_val': 0.019476404433413877, 'psi': 0.9979877797129384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=57 head_norm_before_train=1.778102 cos_to_last_merge=0.9924 (last merge round=42)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.8189194654056999, 'auprc': 0.9950684653730719, 'loss_val': 0.3400819517648355, 'psi': 0.8893790653926488}-{'f1_val': 0.9963164379542544, 'auprc': 0.9966190873466568, 'loss_val': 0.025233868880517745, 'psi': 0.9964374977112154}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.778224 cos_to_last_merge=0.9999 (last merge round=54)
[S16] round=57 local utility u=0.002526 metrics={'f1_val': 0.991303862592058, 'auprc': 0.9944000915221861, 'loss_val': 0.037637496978666085, 'psi': 0.9925423541641093}-{'f1_val': 0.9917843895488756, 'auprc': 0.9925769079847562, 'loss_val': 0.040103119363110784, 'psi': 0.9921013969232279}
[S17] START round=57 head_norm_before_train=1.734753 cos_to_last_merge=0.9908 (last merge round=43)
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.6068235024762636, 'auprc': 0.8533806561438653, 'loss_val': 1.2407409395865627, 'psi': 0.7054463639433043}-{'f1_val': 0.6186702326500313, 'auprc': 0.8429025930571024, 'loss_val': 1.2726932953239494, 'psi': 0.7083631768128598}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.9997
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=57 metric=0.9913 head_norm=1.793230
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.646423e-02
[S16] stored merged vector for next round verification (round=57)
[S16] DEBUG after merge:  round=57 metric=0.9913 head_norm=1.768811 delta_norm=0.036464
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=58 head_norm_before_train=1.996010 cos_to_last_merge=0.9420 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.942
[S2] round=58 local utility u=0.192360 metrics={'f1_val': 0.9090904500428306, 'auprc': 0.9471188166315241, 'loss_val': 0.2807619040771998, 'psi': 0.924301796678308}-{'f1_val': 0.8318415422271593, 'auprc': 0.9897714012620389, 'loss_val': 0.32994665333563894, 'psi': 0.8950134858411112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=58 head_norm_before_train=1.928754 cos_to_last_merge=0.9919 (last merge round=44)
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.9496147392978871, 'auprc': 0.9921164729942883, 'loss_val': 0.12407301845538644, 'psi': 0.9666154327764476}-{'f1_val': 0.9707791996370744, 'auprc': 0.9983918737672609, 'loss_val': 0.06783561057167298, 'psi': 0.981824269289149}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=2.150897 (no previous merge yet)
[S4] round=58 local utility u=0.023013 metrics={'f1_val': 0.9171351432935886, 'auprc': 0.8799828408124389, 'loss_val': 0.4049031234308784, 'psi': 0.9022742223011286}-{'f1_val': 0.9160630031241734, 'auprc': 0.8833655028692833, 'loss_val': 0.4546434697064456, 'psi': 0.9029840030222174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=58 head_norm_before_train=1.721742 cos_to_last_merge=0.7924 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9916628872961704, 'loss_val': 0.033136980322624486, 'psi': 0.9943767689040548}-{'f1_val': 0.996186023309311, 'auprc': 0.9977158751681172, 'loss_val': 0.03160036357850508, 'psi': 0.9967979640528335}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.937060 cos_to_last_merge=0.9813 (last merge round=44)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.6484521371635703, 'auprc': 0.6528519735662006, 'loss_val': 1.15536877810965, 'psi': 0.6502120717246225}-{'f1_val': 0.6928140294639435, 'auprc': 0.9256509842790828, 'loss_val': 0.933343788500805, 'psi': 0.7859488113899993}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.756594 cos_to_last_merge=1.0000 (last merge round=56)
[S7] round=58 local utility u=0.570426 metrics={'f1_val': 0.6840714294387162, 'auprc': 0.8341002784023495, 'loss_val': 0.35595959920981657, 'psi': 0.7440829690241695}-{'f1_val': 0.5870006343295893, 'auprc': 0.7938946679817108, 'loss_val': 0.7937705688847502, 'psi': 0.6697582477904379}
[S8] START round=58 head_norm_before_train=1.775932 cos_to_last_merge=0.9977 (last merge round=45)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9784469650889858, 'auprc': 0.999566716309559, 'loss_val': 0.06352846827737221, 'psi': 0.9868948655772151}-{'f1_val': 0.9942788405856967, 'auprc': 0.9903022868293501, 'loss_val': 0.0318702204548457, 'psi': 0.9926882190831581}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=1.931387 cos_to_last_merge=0.7750 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.775
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9998449459916738, 'loss_val': 0.02856729249668887, 'psi': 0.9949248617794063}-{'f1_val': 0.9971029125121428, 'auprc': 0.9996151681273009, 'loss_val': 0.017364761599695133, 'psi': 0.9981078147582061}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=2.041179 cos_to_last_merge=0.9982 (last merge round=41)
[S10] round=58 local utility u=0.000002 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9966099958680985, 'loss_val': 0.022755973902557618, 'psi': 0.9959549814288325}-{'f1_val': 0.9955183051359886, 'auprc': 0.9966894891492093, 'loss_val': 0.02299890053317681, 'psi': 0.9959867787412768}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=58 head_norm_before_train=1.790609 cos_to_last_merge=0.9961 (last merge round=41)
[S11] round=58 local utility u=0.002940 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9982894746248719, 'loss_val': 0.03135114570450704, 'psi': 0.997008274696396}-{'f1_val': 0.9961541414107454, 'auprc': 0.9981696832943168, 'loss_val': 0.03687196481228721, 'psi': 0.9969603581641739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=58 head_norm_before_train=1.679394 cos_to_last_merge=0.9597 (last merge round=35)
[S13] round=58 local utility u=0.386441 metrics={'f1_val': 0.6784049257380008, 'auprc': 0.705160669860034, 'loss_val': 0.8923420068088971, 'psi': 0.6891072233868141}-{'f1_val': 0.6306566933893236, 'auprc': 0.6495418940729095, 'loss_val': 1.2118790220814462, 'psi': 0.638210773662758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=58 head_norm_before_train=2.060361 cos_to_last_merge=0.9993 (last merge round=46)
[S14] round=58 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9974595025537264, 'loss_val': 0.019146175292518965, 'psi': 0.9974303975821874}-{'f1_val': 0.9971907882668205, 'auprc': 0.999152835957376, 'loss_val': 0.019104282216389944, 'psi': 0.9979756073430428}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=58 head_norm_before_train=1.787500 cos_to_last_merge=0.9919 (last merge round=42)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.774859286225757, 'auprc': 0.9951098624825645, 'loss_val': 0.45878197731741394, 'psi': 0.86295951672848}-{'f1_val': 0.8189194654056999, 'auprc': 0.9950684653730719, 'loss_val': 0.3400819517648355, 'psi': 0.8893790653926488}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.768811 cos_to_last_merge=1.0000 (last merge round=57)
[S16] round=58 local utility u=0.000743 metrics={'f1_val': 0.9915582458472608, 'auprc': 0.9942991185358783, 'loss_val': 0.03737513544425373, 'psi': 0.9926545949227079}-{'f1_val': 0.991303862592058, 'auprc': 0.9944000915221861, 'loss_val': 0.037637496978666085, 'psi': 0.9925423541641093}
[S17] START round=58 head_norm_before_train=1.744153 cos_to_last_merge=0.9902 (last merge round=43)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.5562828779958375, 'auprc': 0.7270782437864235, 'loss_val': 1.3590907717890932, 'psi': 0.6246010243120719}-{'f1_val': 0.6068235024762636, 'auprc': 0.8533806561438653, 'loss_val': 1.2407409395865627, 'psi': 0.7054463639433043}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:52816
[S16] not sending this round → trigger blocked (psi=0.993)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=58 metric=0.6841 head_norm=1.760717
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.812954e-02
[S7] stored merged vector for next round verification (round=58)
[S7] DEBUG after merge:  round=58 metric=0.6830 head_norm=1.776825 delta_norm=0.028130
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=59 head_norm_before_train=2.004191 cos_to_last_merge=0.9414 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.8432681814933868, 'auprc': 0.9146122882233512, 'loss_val': 0.4566313379561643, 'psi': 0.8718058241853726}-{'f1_val': 0.9090904500428306, 'auprc': 0.9471188166315241, 'loss_val': 0.2807619040771998, 'psi': 0.924301796678308}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.872 u=0.0000 p_local=0.0882 f1=0.843 auprc=0.915 bytes=53995
[S3] START round=59 head_norm_before_train=1.941077 cos_to_last_merge=0.9913 (last merge round=44)
[S3] round=59 local utility u=0.045204 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9961201920420931, 'loss_val': 0.11125176250806722, 'psi': 0.9747744005563055}-{'f1_val': 0.9496147392978871, 'auprc': 0.9921164729942883, 'loss_val': 0.12407301845538644, 'psi': 0.9666154327764476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S3] r=60 psi=0.975 u=0.0452 p_local=0.1083 f1=0.961 auprc=0.996 bytes=48556
[S4] START round=59 head_norm_before_train=2.130448 (no previous merge yet)
[S4] round=59 local utility u=0.161382 metrics={'f1_val': 0.9290068963401216, 'auprc': 0.9541078971391186, 'loss_val': 0.37574475699933985, 'psi': 0.9390472966597204}-{'f1_val': 0.9171351432935886, 'auprc': 0.8799828408124389, 'loss_val': 0.4049031234308784, 'psi': 0.9022742223011286}
[S4] not sending this round → trigger blocked (psi=0.939)
[S4] r=60 psi=0.939 u=0.1614 p_local=0.0461 f1=0.929 auprc=0.954 bytes=44973
[S5] START round=59 head_norm_before_train=1.723753 cos_to_last_merge=0.7924 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=59 local utility u=0.000426 metrics={'f1_val': 0.996186023309311, 'auprc': 0.991666685316398, 'loss_val': 0.03229648371835607, 'psi': 0.9943782881121458}-{'f1_val': 0.996186023309311, 'auprc': 0.9916628872961704, 'loss_val': 0.033136980322624486, 'psi': 0.9943767689040548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=60 psi=0.994 u=0.0004 p_local=0.0054 f1=0.996 auprc=0.992 bytes=50370
[S6] START round=59 head_norm_before_train=1.946095 cos_to_last_merge=0.9807 (last merge round=44)
[S6] round=59 local utility u=0.793145 metrics={'f1_val': 0.726134639175783, 'auprc': 0.9092692562858293, 'loss_val': 0.8044252941526161, 'psi': 0.7993884860198015}-{'f1_val': 0.6484521371635703, 'auprc': 0.6528519735662006, 'loss_val': 1.15536877810965, 'psi': 0.6502120717246225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S6] r=60 psi=0.799 u=0.7931 p_local=0.3012 f1=0.726 auprc=0.909 bytes=46786
[S7] START round=59 head_norm_before_train=1.776825 cos_to_last_merge=1.0000 (last merge round=58)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.5949819575067721, 'auprc': 0.7952143439750567, 'loss_val': 0.7563958521213049, 'psi': 0.675074912094086}-{'f1_val': 0.6840714294387162, 'auprc': 0.8341002784023495, 'loss_val': 0.35595959920981657, 'psi': 0.7440829690241695}
[S8] START round=59 head_norm_before_train=1.787476 cos_to_last_merge=0.9974 (last merge round=45)
[S8] round=59 local utility u=0.051630 metrics={'f1_val': 0.9913077019421868, 'auprc': 0.9995680001860873, 'loss_val': 0.037436269820241966, 'psi': 0.994611821239747}-{'f1_val': 0.9784469650889858, 'auprc': 0.999566716309559, 'loss_val': 0.06352846827737221, 'psi': 0.9868948655772151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S8] r=60 psi=0.995 u=0.0516 p_local=0.0385 f1=0.991 auprc=1.000 bytes=48578
[S9] START round=59 head_norm_before_train=1.938546 cos_to_last_merge=0.7744 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.774
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9901183584159563, 'auprc': 0.9998501457352854, 'loss_val': 0.03404210020961166, 'psi': 0.9940110733436879}-{'f1_val': 0.9916448056378947, 'auprc': 0.9998449459916738, 'loss_val': 0.02856729249668887, 'psi': 0.9949248617794063}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.994 u=0.0000 p_local=0.0049 f1=0.990 auprc=1.000 bytes=48594
[S10] START round=59 head_norm_before_train=2.049139 cos_to_last_merge=0.9981 (last merge round=41)
[S10] round=59 local utility u=0.000953 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972357036265367, 'loss_val': 0.022726567499318687, 'psi': 0.9962052645322078}-{'f1_val': 0.9955183051359886, 'auprc': 0.9966099958680985, 'loss_val': 0.022755973902557618, 'psi': 0.9959549814288325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] r=60 psi=0.996 u=0.0010 p_local=0.0006 f1=0.996 auprc=0.997 bytes=55811
[S11] START round=59 head_norm_before_train=1.798787 cos_to_last_merge=0.9958 (last merge round=41)
[S11] round=59 local utility u=0.002664 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985038931837282, 'loss_val': 0.02666639003331799, 'psi': 0.9970940421199386}-{'f1_val': 0.9961541414107454, 'auprc': 0.9982894746248719, 'loss_val': 0.03135114570450704, 'psi': 0.997008274696396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=60 psi=0.997 u=0.0027 p_local=0.0025 f1=0.996 auprc=0.999 bytes=55738
[S13] START round=59 head_norm_before_train=1.692763 cos_to_last_merge=0.9583 (last merge round=35)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6682652848499149, 'auprc': 0.7537949258172084, 'loss_val': 1.1134203062465893, 'psi': 0.7024771412368322}-{'f1_val': 0.6784049257380008, 'auprc': 0.705160669860034, 'loss_val': 0.8923420068088971, 'psi': 0.6891072233868141}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.702 u=0.0000 p_local=0.1431 f1=0.668 auprc=0.754 bytes=39609
[S14] START round=59 head_norm_before_train=2.064747 cos_to_last_merge=0.9992 (last merge round=46)
[S14] round=59 local utility u=0.000055 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9974195767120576, 'loss_val': 0.018915917379591002, 'psi': 0.9974144272455199}-{'f1_val': 0.9974109942678281, 'auprc': 0.9974595025537264, 'loss_val': 0.019146175292518965, 'psi': 0.9974303975821874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=60 psi=0.997 u=0.0001 p_local=0.0018 f1=0.997 auprc=0.997 bytes=50340
[S15] START round=59 head_norm_before_train=1.800007 cos_to_last_merge=0.9913 (last merge round=42)
[S15] round=59 local utility u=0.887159 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.997705573673122, 'loss_val': 0.02357533285157271, 'psi': 0.9971302305017611}-{'f1_val': 0.774859286225757, 'auprc': 0.9951098624825645, 'loss_val': 0.45878197731741394, 'psi': 0.86295951672848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S15] r=60 psi=0.997 u=0.8872 p_local=0.3506 f1=0.997 auprc=0.998 bytes=46805
[S16] START round=59 head_norm_before_train=1.785150 cos_to_last_merge=1.0000 (last merge round=57)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9410683078683063, 'auprc': 0.9874019072660921, 'loss_val': 0.28795501625223185, 'psi': 0.9596017476274207}-{'f1_val': 0.9915582458472608, 'auprc': 0.9942991185358783, 'loss_val': 0.03737513544425373, 'psi': 0.9926545949227079}
[S17] START round=59 head_norm_before_train=1.756029 cos_to_last_merge=0.9896 (last merge round=43)
[S17] round=59 local utility u=0.677255 metrics={'f1_val': 0.6590569266991252, 'auprc': 0.8779406750625088, 'loss_val': 1.0738118989062753, 'psi': 0.7466104260444787}-{'f1_val': 0.5562828779958375, 'auprc': 0.7270782437864235, 'loss_val': 1.3590907717890932, 'psi': 0.6246010243120719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S17] r=60 psi=0.747 u=0.6773 p_local=0.2315 f1=0.659 auprc=0.878 bytes=46822
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.675 u=0.0000 p_local=0.2494 f1=0.595 auprc=0.795 bytes=50329
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=59 metric=0.9411 head_norm=1.801023
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.756193e-02
[S16] stored merged vector for next round verification (round=59)
[S16] DEBUG after merge:  round=59 metric=0.9411 head_norm=1.780771 delta_norm=0.027562
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] r=60 psi=0.960 u=0.0000 p_local=0.0676 f1=0.941 auprc=0.987 bytes=44950
[S2] START round=60 head_norm_before_train=2.015454 cos_to_last_merge=0.9406 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=60 local utility u=0.360881 metrics={'f1_val': 0.9101637004905329, 'auprc': 0.9582829880273862, 'loss_val': 0.2672540082169292, 'psi': 0.9294114155052742}-{'f1_val': 0.8432681814933868, 'auprc': 0.9146122882233512, 'loss_val': 0.4566313379561643, 'psi': 0.8718058241853726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=60 head_norm_before_train=1.953517 cos_to_last_merge=0.9907 (last merge round=44)
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.8597207723681584, 'auprc': 0.974144978097276, 'loss_val': 0.35798417984921765, 'psi': 0.9054904546598054}-{'f1_val': 0.9605438728991138, 'auprc': 0.9961201920420931, 'loss_val': 0.11125176250806722, 'psi': 0.9747744005563055}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=2.129497 (no previous merge yet)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9264302568975691, 'auprc': 0.9586647228622696, 'loss_val': 0.3755473895025674, 'psi': 0.9393240432834493}-{'f1_val': 0.9290068963401216, 'auprc': 0.9541078971391186, 'loss_val': 0.37574475699933985, 'psi': 0.9390472966597204}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.727251 cos_to_last_merge=0.7922 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=60 local utility u=0.010061 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9977497078791305, 'loss_val': 0.030422647863178467, 'psi': 0.9968114971372388}-{'f1_val': 0.996186023309311, 'auprc': 0.991666685316398, 'loss_val': 0.03229648371835607, 'psi': 0.9943782881121458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=60 head_norm_before_train=1.958089 cos_to_last_merge=0.9800 (last merge round=44)
[S6] round=60 local utility u=0.376969 metrics={'f1_val': 0.8012233407755176, 'auprc': 0.9279011924217058, 'loss_val': 0.5569143934029263, 'psi': 0.8518944814339928}-{'f1_val': 0.726134639175783, 'auprc': 0.9092692562858293, 'loss_val': 0.8044252941526161, 'psi': 0.7993884860198015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=60 head_norm_before_train=1.782040 cos_to_last_merge=1.0000 (last merge round=58)
[S7] round=60 local utility u=0.596640 metrics={'f1_val': 0.6924983502283606, 'auprc': 0.8538658968275897, 'loss_val': 0.3241686634624213, 'psi': 0.7570453688680523}-{'f1_val': 0.5949819575067721, 'auprc': 0.7952143439750567, 'loss_val': 0.7563958521213049, 'psi': 0.675074912094086}
[S8] START round=60 head_norm_before_train=1.799147 cos_to_last_merge=0.9971 (last merge round=45)
[S8] round=60 local utility u=0.006004 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9990359381729, 'loss_val': 0.03248780892101793, 'psi': 0.9952645543280523}-{'f1_val': 0.9913077019421868, 'auprc': 0.9995680001860873, 'loss_val': 0.037436269820241966, 'psi': 0.994611821239747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=60 head_norm_before_train=1.945437 cos_to_last_merge=0.7736 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.774
[S9] round=60 local utility u=0.016972 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9941625194372105, 'loss_val': 0.019825907823462684, 'psi': 0.9954150646424508}-{'f1_val': 0.9901183584159563, 'auprc': 0.9998501457352854, 'loss_val': 0.03404210020961166, 'psi': 0.9940110733436879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=60 head_norm_before_train=2.051635 cos_to_last_merge=0.9978 (last merge round=41)
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9972482903402037, 'loss_val': 0.023477461448331554, 'psi': 0.9960931884743196}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972357036265367, 'loss_val': 0.022726567499318687, 'psi': 0.9962052645322078}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=1.806945 cos_to_last_merge=0.9955 (last merge round=41)
[S11] round=60 local utility u=0.000988 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986341555339172, 'loss_val': 0.02508130164785433, 'psi': 0.9971461470600141}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985038931837282, 'loss_val': 0.02666639003331799, 'psi': 0.9970940421199386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=60 head_norm_before_train=1.703227 cos_to_last_merge=0.9572 (last merge round=35)
[S13] round=60 local utility u=0.372902 metrics={'f1_val': 0.6923655914148243, 'auprc': 0.8855636922745272, 'loss_val': 0.9075252343826605, 'psi': 0.7696448317587055}-{'f1_val': 0.6682652848499149, 'auprc': 0.7537949258172084, 'loss_val': 1.1134203062465893, 'psi': 0.7024771412368322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=60 head_norm_before_train=2.071006 cos_to_last_merge=0.9990 (last merge round=46)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9971625532153504, 'auprc': 0.9967739029356109, 'loss_val': 0.024162419390917702, 'psi': 0.9970070931034546}-{'f1_val': 0.9974109942678281, 'auprc': 0.9974195767120576, 'loss_val': 0.018915917379591002, 'psi': 0.9974144272455199}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.816187 cos_to_last_merge=0.9906 (last merge round=42)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.993886085179512, 'loss_val': 0.02308615271257511, 'psi': 0.9953442968443575}-{'f1_val': 0.9967466683875206, 'auprc': 0.997705573673122, 'loss_val': 0.02357533285157271, 'psi': 0.9971302305017611}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=1.780771 cos_to_last_merge=1.0000 (last merge round=59)
[S16] round=60 local utility u=0.273078 metrics={'f1_val': 0.9923720851329062, 'auprc': 0.9860435854073474, 'loss_val': 0.04554656267980322, 'psi': 0.9898406852426826}-{'f1_val': 0.9410683078683063, 'auprc': 0.9874019072660921, 'loss_val': 0.28795501625223185, 'psi': 0.9596017476274207}
[S17] START round=60 head_norm_before_train=1.763696 cos_to_last_merge=0.9893 (last merge round=43)
[S17] round=60 local utility u=0.076527 metrics={'f1_val': 0.6539106864576346, 'auprc': 0.9296562807569009, 'loss_val': 1.0450270432915247, 'psi': 0.7642089241773411}-{'f1_val': 0.6590569266991252, 'auprc': 0.8779406750625088, 'loss_val': 1.0738118989062753, 'psi': 0.7466104260444787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=60 metric=0.6925 head_norm=1.787082
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.117861e-02
[S7] stored merged vector for next round verification (round=60)
[S7] DEBUG after merge:  round=60 metric=0.6921 head_norm=1.789928 delta_norm=0.011179
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.319 → S16@127.0.0.1:52816
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=60 metric=0.9924 head_norm=1.792840
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.117861e-02
[S16] stored merged vector for next round verification (round=60)
[S16] DEBUG after merge:  round=60 metric=0.9924 head_norm=1.789928 delta_norm=0.011179
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.109 → S7@127.0.0.1:52808
[S2] START round=61 head_norm_before_train=2.027644 cos_to_last_merge=0.9393 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.939
[S2] round=61 local utility u=0.053135 metrics={'f1_val': 0.9140468891204439, 'auprc': 0.9834414776114779, 'loss_val': 0.2597585975297601, 'psi': 0.9418047245168575}-{'f1_val': 0.9101637004905329, 'auprc': 0.9582829880273862, 'loss_val': 0.2672540082169292, 'psi': 0.9294114155052742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=61 head_norm_before_train=1.964846 cos_to_last_merge=0.9902 (last merge round=44)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.7010721732929397, 'auprc': 0.9477496221873434, 'loss_val': 0.8989954844665493, 'psi': 0.7997431528507012}-{'f1_val': 0.8597207723681584, 'auprc': 0.974144978097276, 'loss_val': 0.35798417984921765, 'psi': 0.9054904546598054}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=2.141088 (no previous merge yet)
[S4] round=61 local utility u=0.036192 metrics={'f1_val': 0.9317506901270807, 'auprc': 0.9686484048984296, 'loss_val': 0.3650365380640518, 'psi': 0.9465097760356203}-{'f1_val': 0.9264302568975691, 'auprc': 0.9586647228622696, 'loss_val': 0.3755473895025674, 'psi': 0.9393240432834493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=61 head_norm_before_train=1.734461 cos_to_last_merge=0.7914 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9943620830742792, 'loss_val': 0.030121383999658614, 'psi': 0.9954564472152982}-{'f1_val': 0.996186023309311, 'auprc': 0.9977497078791305, 'loss_val': 0.030422647863178467, 'psi': 0.9968114971372388}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.968915 cos_to_last_merge=0.9792 (last merge round=44)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.7686968886086488, 'auprc': 0.9337834895743082, 'loss_val': 0.642270963654291, 'psi': 0.8347315289949127}-{'f1_val': 0.8012233407755176, 'auprc': 0.9279011924217058, 'loss_val': 0.5569143934029263, 'psi': 0.8518944814339928}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.789928 cos_to_last_merge=1.0000 (last merge round=60)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.6113845247287142, 'auprc': 0.7966705119053425, 'loss_val': 0.6861217418200224, 'psi': 0.6854989195993655}-{'f1_val': 0.6924983502283606, 'auprc': 0.8538658968275897, 'loss_val': 0.3241686634624213, 'psi': 0.7570453688680523}
[S8] START round=61 head_norm_before_train=1.809886 cos_to_last_merge=0.9968 (last merge round=45)
[S8] round=61 local utility u=0.000874 metrics={'f1_val': 0.992750298431487, 'auprc': 0.9993568493804916, 'loss_val': 0.03170313503878209, 'psi': 0.9953929188110888}-{'f1_val': 0.992750298431487, 'auprc': 0.9990359381729, 'loss_val': 0.03248780892101793, 'psi': 0.9952645543280523}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=61 head_norm_before_train=1.949963 cos_to_last_merge=0.7727 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.773
[S9] round=61 local utility u=0.006581 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9973297243207673, 'loss_val': 0.018627490166187366, 'psi': 0.9969281968166418}-{'f1_val': 0.9962500947792776, 'auprc': 0.9941625194372105, 'loss_val': 0.019825907823462684, 'psi': 0.9954150646424508}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=61 head_norm_before_train=2.055795 cos_to_last_merge=0.9975 (last merge round=41)
[S10] round=61 local utility u=0.001051 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972384350486444, 'loss_val': 0.022517007714223353, 'psi': 0.9962063571010509}-{'f1_val': 0.9953231205637304, 'auprc': 0.9972482903402037, 'loss_val': 0.023477461448331554, 'psi': 0.9960931884743196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=61 head_norm_before_train=1.815017 cos_to_last_merge=0.9952 (last merge round=41)
[S11] round=61 local utility u=0.000293 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986127994024689, 'loss_val': 0.024432178983746385, 'psi': 0.9971376046074348}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986341555339172, 'loss_val': 0.02508130164785433, 'psi': 0.9971461470600141}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=61 head_norm_before_train=1.711218 cos_to_last_merge=0.9564 (last merge round=35)
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.642325380608181, 'auprc': 0.6688509554568354, 'loss_val': 1.219820674432727, 'psi': 0.6529356105476427}-{'f1_val': 0.6923655914148243, 'auprc': 0.8855636922745272, 'loss_val': 0.9075252343826605, 'psi': 0.7696448317587055}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=2.073400 cos_to_last_merge=0.9989 (last merge round=46)
[S14] round=61 local utility u=0.000000 metrics={'f1_val': 0.9919775121572035, 'auprc': 0.9991806061481577, 'loss_val': 0.032062736351838934, 'psi': 0.9948587497535852}-{'f1_val': 0.9971625532153504, 'auprc': 0.9967739029356109, 'loss_val': 0.024162419390917702, 'psi': 0.9970070931034546}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=61 head_norm_before_train=1.831790 cos_to_last_merge=0.9900 (last merge round=42)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.995548813944572, 'auprc': 0.9970157838896785, 'loss_val': 0.037295077162119876, 'psi': 0.9961356019226146}-{'f1_val': 0.9963164379542544, 'auprc': 0.993886085179512, 'loss_val': 0.02308615271257511, 'psi': 0.9953442968443575}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.789928 cos_to_last_merge=1.0000 (last merge round=60)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.9312585820391658, 'auprc': 0.9923111203091403, 'loss_val': 0.1883542623610758, 'psi': 0.9556795973471556}-{'f1_val': 0.9923720851329062, 'auprc': 0.9860435854073474, 'loss_val': 0.04554656267980322, 'psi': 0.9898406852426826}
[S17] START round=61 head_norm_before_train=1.772001 cos_to_last_merge=0.9889 (last merge round=43)
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.6370374010020372, 'auprc': 0.9326355976888003, 'loss_val': 1.203708866824224, 'psi': 0.7552766796767425}-{'f1_val': 0.6539106864576346, 'auprc': 0.9296562807569009, 'loss_val': 1.0450270432915247, 'psi': 0.7642089241773411}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=2.042567 cos_to_last_merge=0.9381 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.8636297189954582, 'auprc': 0.902935092930816, 'loss_val': 0.43051617746879356, 'psi': 0.8793518685696013}-{'f1_val': 0.9140468891204439, 'auprc': 0.9834414776114779, 'loss_val': 0.2597585975297601, 'psi': 0.9418047245168575}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=1.975530 cos_to_last_merge=0.9897 (last merge round=44)
[S3] round=62 local utility u=0.756995 metrics={'f1_val': 0.8456538007847942, 'auprc': 0.9913551614234417, 'loss_val': 0.3833122263880766, 'psi': 0.9039343450402532}-{'f1_val': 0.7010721732929397, 'auprc': 0.9477496221873434, 'loss_val': 0.8989954844665493, 'psi': 0.7997431528507012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=62 head_norm_before_train=2.149399 (no previous merge yet)
[S4] round=62 local utility u=0.060232 metrics={'f1_val': 0.9411743987366753, 'auprc': 0.9742401276827786, 'loss_val': 0.31789032401410916, 'psi': 0.9544006903151167}-{'f1_val': 0.9317506901270807, 'auprc': 0.9686484048984296, 'loss_val': 0.3650365380640518, 'psi': 0.9465097760356203}
[S4] not sending this round → trigger blocked (psi=0.954)
[S5] START round=62 head_norm_before_train=1.745585 cos_to_last_merge=0.7905 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=62 local utility u=0.000464 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9945545427920488, 'loss_val': 0.029771709470966603, 'psi': 0.9955334311024061}-{'f1_val': 0.996186023309311, 'auprc': 0.9943620830742792, 'loss_val': 0.030121383999658614, 'psi': 0.9954564472152982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=62 head_norm_before_train=1.987544 cos_to_last_merge=0.9780 (last merge round=44)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.772894028859811, 'auprc': 0.8976029585521151, 'loss_val': 0.6163009843060753, 'psi': 0.8227776007367327}-{'f1_val': 0.7686968886086488, 'auprc': 0.9337834895743082, 'loss_val': 0.642270963654291, 'psi': 0.8347315289949127}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.793590 cos_to_last_merge=1.0000 (last merge round=60)
[S7] round=62 local utility u=1.000000 metrics={'f1_val': 0.9544896496493898, 'auprc': 0.9777727724440732, 'loss_val': 0.21744137862204072, 'psi': 0.9638028987672631}-{'f1_val': 0.6113845247287142, 'auprc': 0.7966705119053425, 'loss_val': 0.6861217418200224, 'psi': 0.6854989195993655}
[S8] START round=62 head_norm_before_train=1.819081 cos_to_last_merge=0.9964 (last merge round=45)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.999560194162991, 'loss_val': 0.03724437418797649, 'psi': 0.9944757073106373}-{'f1_val': 0.992750298431487, 'auprc': 0.9993568493804916, 'loss_val': 0.03170313503878209, 'psi': 0.9953929188110888}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=1.954770 cos_to_last_merge=0.7719 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.772
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9912134460920485, 'auprc': 0.9998498793155608, 'loss_val': 0.03222160269590314, 'psi': 0.9946680193814534}-{'f1_val': 0.9966605118138915, 'auprc': 0.9973297243207673, 'loss_val': 0.018627490166187366, 'psi': 0.9969281968166418}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=2.058710 cos_to_last_merge=0.9971 (last merge round=41)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972455379770229, 'loss_val': 0.022662646401991983, 'psi': 0.9962091982724023}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972384350486444, 'loss_val': 0.022517007714223353, 'psi': 0.9962063571010509}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=1.822246 cos_to_last_merge=0.9950 (last merge round=41)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9982183645720213, 'loss_val': 0.031557743534063, 'psi': 0.9969798306752558}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986127994024689, 'loss_val': 0.024432178983746385, 'psi': 0.9971376046074348}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.714872 cos_to_last_merge=0.9559 (last merge round=35)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.6382650870892377, 'auprc': 0.676493931889316, 'loss_val': 1.2469131615411846, 'psi': 0.653556625009269}-{'f1_val': 0.642325380608181, 'auprc': 0.6688509554568354, 'loss_val': 1.219820674432727, 'psi': 0.6529356105476427}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=2.076005 cos_to_last_merge=0.9988 (last merge round=46)
[S14] round=62 local utility u=0.023449 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.9992053235808105, 'loss_val': 0.01897046503748344, 'psi': 0.9982417995821042}-{'f1_val': 0.9919775121572035, 'auprc': 0.9991806061481577, 'loss_val': 0.032062736351838934, 'psi': 0.9948587497535852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=62 head_norm_before_train=1.847892 cos_to_last_merge=0.9892 (last merge round=42)
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.9110634741593684, 'auprc': 0.9968102602316897, 'loss_val': 0.18957523211083213, 'psi': 0.9453621885882969}-{'f1_val': 0.995548813944572, 'auprc': 0.9970157838896785, 'loss_val': 0.037295077162119876, 'psi': 0.9961356019226146}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=62 head_norm_before_train=1.798666 cos_to_last_merge=1.0000 (last merge round=60)
[S16] round=62 local utility u=0.264128 metrics={'f1_val': 0.9922163343538072, 'auprc': 0.9953200892232734, 'loss_val': 0.03487088932413986, 'psi': 0.9934578363015936}-{'f1_val': 0.9312585820391658, 'auprc': 0.9923111203091403, 'loss_val': 0.1883542623610758, 'psi': 0.9556795973471556}
[S17] START round=62 head_norm_before_train=1.783990 cos_to_last_merge=0.9881 (last merge round=43)
[S17] round=62 local utility u=0.813590 metrics={'f1_val': 0.8235476229783635, 'auprc': 0.9016377461510412, 'loss_val': 0.6025956574965214, 'psi': 0.8547836722474346}-{'f1_val': 0.6370374010020372, 'auprc': 0.9326355976888003, 'loss_val': 1.203708866824224, 'psi': 0.7552766796767425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=62 metric=0.9545 head_norm=1.800410
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.481414e-02
[S7] stored merged vector for next round verification (round=62)
[S7] DEBUG after merge:  round=62 metric=0.9557 head_norm=1.805523 delta_norm=0.014814
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=62 metric=0.9922 head_norm=1.810743
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.481414e-02
[S16] stored merged vector for next round verification (round=62)
[S16] DEBUG after merge:  round=62 metric=0.9922 head_norm=1.805523 delta_norm=0.014814
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=63 head_norm_before_train=2.051574 cos_to_last_merge=0.9374 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.937
[S2] round=63 local utility u=0.260131 metrics={'f1_val': 0.8985339582624181, 'auprc': 0.9411760524798372, 'loss_val': 0.2344019023321157, 'psi': 0.9155907959493856}-{'f1_val': 0.8636297189954582, 'auprc': 0.902935092930816, 'loss_val': 0.43051617746879356, 'psi': 0.8793518685696013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=63 head_norm_before_train=1.986616 cos_to_last_merge=0.9891 (last merge round=44)
[S3] round=63 local utility u=0.490929 metrics={'f1_val': 0.9583479533302112, 'auprc': 0.9967085435069033, 'loss_val': 0.09367829623264108, 'psi': 0.9736921894008881}-{'f1_val': 0.8456538007847942, 'auprc': 0.9913551614234417, 'loss_val': 0.3833122263880766, 'psi': 0.9039343450402532}
[S3] not sending this round → trigger blocked (psi=0.974)
[S4] START round=63 head_norm_before_train=2.153399 (no previous merge yet)
[S4] round=63 local utility u=0.025383 metrics={'f1_val': 0.9479328707028494, 'auprc': 0.9754825389567605, 'loss_val': 0.31140201691223546, 'psi': 0.9589527380044138}-{'f1_val': 0.9411743987366753, 'auprc': 0.9742401276827786, 'loss_val': 0.31789032401410916, 'psi': 0.9544006903151167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=63 head_norm_before_train=1.750974 cos_to_last_merge=0.7905 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9944599301192629, 'loss_val': 0.02973833937426404, 'psi': 0.9954955860332918}-{'f1_val': 0.996186023309311, 'auprc': 0.9945545427920488, 'loss_val': 0.029771709470966603, 'psi': 0.9955334311024061}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=2.007292 cos_to_last_merge=0.9767 (last merge round=44)
[S6] round=63 local utility u=0.296923 metrics={'f1_val': 0.8431624750343505, 'auprc': 0.8943944908077877, 'loss_val': 0.4344411502904404, 'psi': 0.8636552813437254}-{'f1_val': 0.772894028859811, 'auprc': 0.8976029585521151, 'loss_val': 0.6163009843060753, 'psi': 0.8227776007367327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=63 head_norm_before_train=1.805523 cos_to_last_merge=1.0000 (last merge round=62)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.6062155868863445, 'auprc': 0.799106332661955, 'loss_val': 0.6344994836197129, 'psi': 0.6833718851965886}-{'f1_val': 0.9544896496493898, 'auprc': 0.9777727724440732, 'loss_val': 0.21744137862204072, 'psi': 0.9638028987672631}
[S8] START round=63 head_norm_before_train=1.830086 cos_to_last_merge=0.9961 (last merge round=45)
[S8] round=63 local utility u=0.000379 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9991771420039738, 'loss_val': 0.037510114879676024, 'psi': 0.9945397997274256}-{'f1_val': 0.9910860494090681, 'auprc': 0.999560194162991, 'loss_val': 0.03724437418797649, 'psi': 0.9944757073106373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=63 head_norm_before_train=1.960705 cos_to_last_merge=0.7713 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.771
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9998505658199217, 'loss_val': 0.04299035910874177, 'psi': 0.9931438508296295}-{'f1_val': 0.9912134460920485, 'auprc': 0.9998498793155608, 'loss_val': 0.03222160269590314, 'psi': 0.9946680193814534}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.065341 cos_to_last_merge=0.9970 (last merge round=41)
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9972518404764177, 'loss_val': 0.023167680042439655, 'psi': 0.9960946085288053}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972455379770229, 'loss_val': 0.022662646401991983, 'psi': 0.9962091982724023}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=1.828048 cos_to_last_merge=0.9948 (last merge round=41)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.8245445666225407, 'auprc': 0.9964115334822573, 'loss_val': 0.4030157369076019, 'psi': 0.8932913533664273}-{'f1_val': 0.9961541414107454, 'auprc': 0.9982183645720213, 'loss_val': 0.031557743534063, 'psi': 0.9969798306752558}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.716011 cos_to_last_merge=0.9558 (last merge round=35)
[S13] round=63 local utility u=0.362616 metrics={'f1_val': 0.6874924510068401, 'auprc': 0.7428056153224161, 'loss_val': 1.0159813763725767, 'psi': 0.7096177167330704}-{'f1_val': 0.6382650870892377, 'auprc': 0.676493931889316, 'loss_val': 1.2469131615411846, 'psi': 0.653556625009269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=63 head_norm_before_train=2.080327 cos_to_last_merge=0.9987 (last merge round=46)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9978538424388591, 'loss_val': 0.019627007906860814, 'psi': 0.9978332477558747}-{'f1_val': 0.9975994502496334, 'auprc': 0.9992053235808105, 'loss_val': 0.01897046503748344, 'psi': 0.9982417995821042}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=1.862741 cos_to_last_merge=0.9885 (last merge round=42)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.8987301729495321, 'auprc': 0.9967596988520484, 'loss_val': 0.25376864417561246, 'psi': 0.9379419833105387}-{'f1_val': 0.9110634741593684, 'auprc': 0.9968102602316897, 'loss_val': 0.18957523211083213, 'psi': 0.9453621885882969}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.805523 cos_to_last_merge=1.0000 (last merge round=62)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9791419480092457, 'auprc': 0.9925563081671551, 'loss_val': 0.08026155314851482, 'psi': 0.9845076920724094}-{'f1_val': 0.9922163343538072, 'auprc': 0.9953200892232734, 'loss_val': 0.03487088932413986, 'psi': 0.9934578363015936}
[S17] START round=63 head_norm_before_train=1.793429 cos_to_last_merge=0.9875 (last merge round=43)
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.6284222344049676, 'auprc': 0.902272490473212, 'loss_val': 1.2266560966877686, 'psi': 0.7379623368322654}-{'f1_val': 0.8235476229783635, 'auprc': 0.9016377461510412, 'loss_val': 0.6025956574965214, 'psi': 0.8547836722474346}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=2.060928 cos_to_last_merge=0.9364 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.936
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.7235623771247572, 'auprc': 0.9722543621463314, 'loss_val': 0.5171104836372269, 'psi': 0.8230391711333869}-{'f1_val': 0.8985339582624181, 'auprc': 0.9411760524798372, 'loss_val': 0.2344019023321157, 'psi': 0.9155907959493856}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=1.997697 cos_to_last_merge=0.9886 (last merge round=44)
[S3] round=64 local utility u=0.068267 metrics={'f1_val': 0.9741388352422122, 'auprc': 0.998981349691988, 'loss_val': 0.05870790693632624, 'psi': 0.9840758410221225}-{'f1_val': 0.9583479533302112, 'auprc': 0.9967085435069033, 'loss_val': 0.09367829623264108, 'psi': 0.9736921894008881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=64 head_norm_before_train=2.163999 (no previous merge yet)
[S4] round=64 local utility u=0.029624 metrics={'f1_val': 0.9511831463953031, 'auprc': 0.9848247314143996, 'loss_val': 0.29968175872770814, 'psi': 0.9646397804029416}-{'f1_val': 0.9479328707028494, 'auprc': 0.9754825389567605, 'loss_val': 0.31140201691223546, 'psi': 0.9589527380044138}
[S4] not sending this round → trigger blocked (psi=0.965)
[S5] START round=64 head_norm_before_train=1.755614 cos_to_last_merge=0.7906 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9931169691678678, 'loss_val': 0.029827551173795312, 'psi': 0.9949584016527337}-{'f1_val': 0.996186023309311, 'auprc': 0.9944599301192629, 'loss_val': 0.02973833937426404, 'psi': 0.9954955860332918}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=2.021815 cos_to_last_merge=0.9757 (last merge round=44)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.7343489740677197, 'auprc': 0.8737792632365355, 'loss_val': 0.8378456053182274, 'psi': 0.790121089735246}-{'f1_val': 0.8431624750343505, 'auprc': 0.8943944908077877, 'loss_val': 0.4344411502904404, 'psi': 0.8636552813437254}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.811028 cos_to_last_merge=1.0000 (last merge round=62)
[S7] round=64 local utility u=0.068005 metrics={'f1_val': 0.6295815154437961, 'auprc': 0.8030707963451293, 'loss_val': 0.6505782329911362, 'psi': 0.6989772278043295}-{'f1_val': 0.6062155868863445, 'auprc': 0.799106332661955, 'loss_val': 0.6344994836197129, 'psi': 0.6833718851965886}
[S8] START round=64 head_norm_before_train=1.840067 cos_to_last_merge=0.9957 (last merge round=45)
[S8] round=64 local utility u=0.002910 metrics={'f1_val': 0.9923860096923637, 'auprc': 0.9973920603182544, 'loss_val': 0.0319618669998343, 'psi': 0.99438842994272}-{'f1_val': 0.9914482382097267, 'auprc': 0.9991771420039738, 'loss_val': 0.037510114879676024, 'psi': 0.9945397997274256}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=64 head_norm_before_train=1.967315 cos_to_last_merge=0.7706 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.771
[S9] round=64 local utility u=0.012700 metrics={'f1_val': 0.9908021981609972, 'auprc': 0.9998540158045244, 'loss_val': 0.030378162767641957, 'psi': 0.994422925218408}-{'f1_val': 0.9886727075027679, 'auprc': 0.9998505658199217, 'loss_val': 0.04299035910874177, 'psi': 0.9931438508296295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=64 head_norm_before_train=2.069609 cos_to_last_merge=0.9967 (last merge round=41)
[S10] round=64 local utility u=0.001033 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972428117797745, 'loss_val': 0.0222448541110373, 'psi': 0.996208107793503}-{'f1_val': 0.9953231205637304, 'auprc': 0.9972518404764177, 'loss_val': 0.023167680042439655, 'psi': 0.9960946085288053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=64 head_norm_before_train=1.834106 cos_to_last_merge=0.9946 (last merge round=41)
[S11] round=64 local utility u=0.092980 metrics={'f1_val': 0.8397185561337105, 'auprc': 0.9966623985379308, 'loss_val': 0.3088526059836623, 'psi': 0.9024960930953986}-{'f1_val': 0.8245445666225407, 'auprc': 0.9964115334822573, 'loss_val': 0.4030157369076019, 'psi': 0.8932913533664273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=64 head_norm_before_train=1.722256 cos_to_last_merge=0.9551 (last merge round=35)
[S13] round=64 local utility u=0.331477 metrics={'f1_val': 0.7682059452331726, 'auprc': 0.784217365706217, 'loss_val': 0.9615443381803565, 'psi': 0.7746105134223904}-{'f1_val': 0.6874924510068401, 'auprc': 0.7428056153224161, 'loss_val': 1.0159813763725767, 'psi': 0.7096177167330704}
[S13] not sending this round → trigger blocked (psi=0.775)
[S14] START round=64 head_norm_before_train=2.086293 cos_to_last_merge=0.9985 (last merge round=46)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9690699036054896, 'auprc': 0.9968754024400345, 'loss_val': 0.04793118530900704, 'psi': 0.9801921031393075}-{'f1_val': 0.9978195179672185, 'auprc': 0.9978538424388591, 'loss_val': 0.019627007906860814, 'psi': 0.9978332477558747}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=64 head_norm_before_train=1.875716 cos_to_last_merge=0.9879 (last merge round=42)
[S15] round=64 local utility u=0.408429 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9960373936352375, 'loss_val': 0.02284188666042929, 'psi': 0.9964629584866074}-{'f1_val': 0.8987301729495321, 'auprc': 0.9967596988520484, 'loss_val': 0.25376864417561246, 'psi': 0.9379419833105387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=64 head_norm_before_train=1.816301 cos_to_last_merge=1.0000 (last merge round=62)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.8601865326949495, 'auprc': 0.8954983631396995, 'loss_val': 1.0058591821377039, 'psi': 0.8743112648728495}-{'f1_val': 0.9791419480092457, 'auprc': 0.9925563081671551, 'loss_val': 0.08026155314851482, 'psi': 0.9845076920724094}
[S17] START round=64 head_norm_before_train=1.803495 cos_to_last_merge=0.9868 (last merge round=43)
[S17] round=64 local utility u=0.205654 metrics={'f1_val': 0.6643779319763827, 'auprc': 0.8691813262888909, 'loss_val': 0.9318080600428296, 'psi': 0.746299289701386}-{'f1_val': 0.6284222344049676, 'auprc': 0.902272490473212, 'loss_val': 1.2266560966877686, 'psi': 0.7379623368322654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:52816
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=0.9999
[S2] START round=65 head_norm_before_train=2.066157 cos_to_last_merge=0.9357 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.936
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.7222043465292642, 'auprc': 0.8597333760705576, 'loss_val': 0.7079352067634386, 'psi': 0.7772159583457816}-{'f1_val': 0.7235623771247572, 'auprc': 0.9722543621463314, 'loss_val': 0.5171104836372269, 'psi': 0.8230391711333869}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=65 head_norm_before_train=2.008397 cos_to_last_merge=0.9881 (last merge round=44)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.9317164159106937, 'auprc': 0.9796676793624786, 'loss_val': 0.1980946033495118, 'psi': 0.9508969212914077}-{'f1_val': 0.9741388352422122, 'auprc': 0.998981349691988, 'loss_val': 0.05870790693632624, 'psi': 0.9840758410221225}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=2.182267 (no previous merge yet)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9482623847744618, 'auprc': 0.9787022235821906, 'loss_val': 0.2890009534328219, 'psi': 0.9604383202975534}-{'f1_val': 0.9511831463953031, 'auprc': 0.9848247314143996, 'loss_val': 0.29968175872770814, 'psi': 0.9646397804029416}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.759618 cos_to_last_merge=0.7905 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=65 local utility u=0.007012 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9975489835776643, 'loss_val': 0.029100077898720673, 'psi': 0.9967312074166523}-{'f1_val': 0.996186023309311, 'auprc': 0.9931169691678678, 'loss_val': 0.029827551173795312, 'psi': 0.9949584016527337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=65 head_norm_before_train=2.039232 cos_to_last_merge=0.9747 (last merge round=44)
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.7259751168719255, 'auprc': 0.7819119041410332, 'loss_val': 0.917348405856572, 'psi': 0.7483498317795686}-{'f1_val': 0.7343489740677197, 'auprc': 0.8737792632365355, 'loss_val': 0.8378456053182274, 'psi': 0.790121089735246}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=1.815305 cos_to_last_merge=1.0000 (last merge round=62)
[S7] round=65 local utility u=0.191990 metrics={'f1_val': 0.6651257590811896, 'auprc': 0.8123763114534821, 'loss_val': 0.5077793573504631, 'psi': 0.7240259800301065}-{'f1_val': 0.6295815154437961, 'auprc': 0.8030707963451293, 'loss_val': 0.6505782329911362, 'psi': 0.6989772278043295}
[S8] START round=65 head_norm_before_train=1.848422 cos_to_last_merge=0.9955 (last merge round=45)
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.7871810318335339, 'auprc': 0.9927735379955552, 'loss_val': 0.6634077987788515, 'psi': 0.8694180342983424}-{'f1_val': 0.9923860096923637, 'auprc': 0.9973920603182544, 'loss_val': 0.0319618669998343, 'psi': 0.99438842994272}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=65 head_norm_before_train=1.972455 cos_to_last_merge=0.7698 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.770
[S9] round=65 local utility u=0.023801 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.999847085003895, 'loss_val': 0.017905468528140914, 'psi': 0.9979351410898929}-{'f1_val': 0.9908021981609972, 'auprc': 0.9998540158045244, 'loss_val': 0.030378162767641957, 'psi': 0.994422925218408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=65 head_norm_before_train=2.074532 cos_to_last_merge=0.9965 (last merge round=41)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972545419735928, 'loss_val': 0.022314817691166906, 'psi': 0.9962127998710303}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972428117797745, 'loss_val': 0.0222448541110373, 'psi': 0.996208107793503}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=1.839941 cos_to_last_merge=0.9943 (last merge round=41)
[S11] round=65 local utility u=0.614759 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986452884301179, 'loss_val': 0.0238971848908577, 'psi': 0.9971506002184944}-{'f1_val': 0.8397185561337105, 'auprc': 0.9966623985379308, 'loss_val': 0.3088526059836623, 'psi': 0.9024960930953986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=65 head_norm_before_train=1.735508 cos_to_last_merge=0.9537 (last merge round=35)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.7285231483666234, 'auprc': 0.7395942295800498, 'loss_val': 0.9375683993331339, 'psi': 0.732951580851994}-{'f1_val': 0.7682059452331726, 'auprc': 0.784217365706217, 'loss_val': 0.9615443381803565, 'psi': 0.7746105134223904}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=2.091496 cos_to_last_merge=0.9984 (last merge round=46)
[S14] round=65 local utility u=0.084328 metrics={'f1_val': 0.9940755032987544, 'auprc': 0.997218555478816, 'loss_val': 0.030337954163742104, 'psi': 0.995332724170779}-{'f1_val': 0.9690699036054896, 'auprc': 0.9968754024400345, 'loss_val': 0.04793118530900704, 'psi': 0.9801921031393075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=65 head_norm_before_train=1.887341 cos_to_last_merge=0.9873 (last merge round=42)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.8876595342318652, 'auprc': 0.996352344901315, 'loss_val': 0.2911581059562752, 'psi': 0.9311366584996451}-{'f1_val': 0.9967466683875206, 'auprc': 0.9960373936352375, 'loss_val': 0.02284188666042929, 'psi': 0.9964629584866074}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=1.827674 cos_to_last_merge=0.9999 (last merge round=62)
[S16] round=65 local utility u=1.000000 metrics={'f1_val': 0.9915183330585845, 'auprc': 0.9931814583100882, 'loss_val': 0.04423094089304931, 'psi': 0.9921835831591861}-{'f1_val': 0.8601865326949495, 'auprc': 0.8954983631396995, 'loss_val': 1.0058591821377039, 'psi': 0.8743112648728495}
[S17] START round=65 head_norm_before_train=1.810285 cos_to_last_merge=0.9867 (last merge round=43)
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.6431435397115335, 'auprc': 0.8876400903507141, 'loss_val': 1.0295750533053178, 'psi': 0.7409421599672057}-{'f1_val': 0.6643779319763827, 'auprc': 0.8691813262888909, 'loss_val': 0.9318080600428296, 'psi': 0.746299289701386}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:52808
[S16] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S16
[S7] cosine check vs S16: cos=0.9997
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=65 metric=0.9915 head_norm=1.839772
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.317670e-02
[S16] stored merged vector for next round verification (round=65)
[S16] DEBUG after merge:  round=65 metric=0.9915 head_norm=1.827433 delta_norm=0.023177
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.263 → S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=65 metric=0.6651 head_norm=1.818158
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.419177e-02
[S7] stored merged vector for next round verification (round=65)
[S7] DEBUG after merge:  round=65 metric=0.6662 head_norm=1.828837 delta_norm=0.024192
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.256 → S16@127.0.0.1:52816
[S2] START round=66 head_norm_before_train=2.067724 cos_to_last_merge=0.9348 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=66 local utility u=0.724730 metrics={'f1_val': 0.8338091562870986, 'auprc': 0.9844218491172615, 'loss_val': 0.30216995600363905, 'psi': 0.8940542334191638}-{'f1_val': 0.7222043465292642, 'auprc': 0.8597333760705576, 'loss_val': 0.7079352067634386, 'psi': 0.7772159583457816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=66 head_norm_before_train=2.018548 cos_to_last_merge=0.9875 (last merge round=44)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.6661584251437276, 'auprc': 0.9173688077580978, 'loss_val': 1.0541269053869329, 'psi': 0.7666425781894757}-{'f1_val': 0.9317164159106937, 'auprc': 0.9796676793624786, 'loss_val': 0.1980946033495118, 'psi': 0.9508969212914077}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=2.187390 (no previous merge yet)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.944356289904081, 'auprc': 0.9662391700369789, 'loss_val': 0.2999455905827044, 'psi': 0.9531094419572401}-{'f1_val': 0.9482623847744618, 'auprc': 0.9787022235821906, 'loss_val': 0.2890009534328219, 'psi': 0.9604383202975534}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.761270 cos_to_last_merge=0.7907 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9959392427737541, 'loss_val': 0.02921589476884772, 'psi': 0.9960873110950883}-{'f1_val': 0.996186023309311, 'auprc': 0.9975489835776643, 'loss_val': 0.029100077898720673, 'psi': 0.9967312074166523}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=66 head_norm_before_train=2.056131 cos_to_last_merge=0.9737 (last merge round=44)
[S6] round=66 local utility u=0.804928 metrics={'f1_val': 0.8217444949309185, 'auprc': 0.9541234441684325, 'loss_val': 0.3987427036722885, 'psi': 0.8746960746259241}-{'f1_val': 0.7259751168719255, 'auprc': 0.7819119041410332, 'loss_val': 0.917348405856572, 'psi': 0.7483498317795686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=66 head_norm_before_train=1.828837 cos_to_last_merge=1.0000 (last merge round=65)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.6072803663592792, 'auprc': 0.7998182827207054, 'loss_val': 0.7292940313565085, 'psi': 0.6842955329038497}-{'f1_val': 0.6651257590811896, 'auprc': 0.8123763114534821, 'loss_val': 0.5077793573504631, 'psi': 0.7240259800301065}
[S8] START round=66 head_norm_before_train=1.857248 cos_to_last_merge=0.9952 (last merge round=45)
[S8] round=66 local utility u=0.940715 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9952465523874552, 'loss_val': 0.030514933481429588, 'psi': 0.9945191480995574}-{'f1_val': 0.7871810318335339, 'auprc': 0.9927735379955552, 'loss_val': 0.6634077987788515, 'psi': 0.8694180342983424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=66 head_norm_before_train=1.976650 cos_to_last_merge=0.7689 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.769
[S9] round=66 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.997660384917255, 'loss_val': 0.018564664958286337, 'psi': 0.9970604610552368}-{'f1_val': 0.9966605118138915, 'auprc': 0.999847085003895, 'loss_val': 0.017905468528140914, 'psi': 0.9979351410898929}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=66 head_norm_before_train=2.081818 cos_to_last_merge=0.9964 (last merge round=41)
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972532428285547, 'loss_val': 0.022524986379790116, 'psi': 0.996212280213015}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972545419735928, 'loss_val': 0.022314817691166906, 'psi': 0.9962127998710303}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=1.846571 cos_to_last_merge=0.9941 (last merge round=41)
[S11] round=66 local utility u=0.000308 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985617777613666, 'loss_val': 0.022907594718681375, 'psi': 0.9971049160525323}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986452884301179, 'loss_val': 0.0238971848908577, 'psi': 0.9971506002184944}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=66 head_norm_before_train=1.746781 cos_to_last_merge=0.9524 (last merge round=35)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6670993299086914, 'auprc': 0.696725024847134, 'loss_val': 1.2046895986469657, 'psi': 0.6789496078840684}-{'f1_val': 0.7285231483666234, 'auprc': 0.7395942295800498, 'loss_val': 0.9375683993331339, 'psi': 0.732951580851994}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=2.093514 cos_to_last_merge=0.9982 (last merge round=46)
[S14] round=66 local utility u=0.019165 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9991761859935557, 'loss_val': 0.01802967377556969, 'psi': 0.9981306564597782}-{'f1_val': 0.9940755032987544, 'auprc': 0.997218555478816, 'loss_val': 0.030337954163742104, 'psi': 0.995332724170779}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=66 head_norm_before_train=1.898853 cos_to_last_merge=0.9867 (last merge round=42)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.700681726646837, 'auprc': 0.8309295064021426, 'loss_val': 0.7447803431135656, 'psi': 0.7527808385489593}-{'f1_val': 0.8876595342318652, 'auprc': 0.996352344901315, 'loss_val': 0.2911581059562752, 'psi': 0.9311366584996451}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=1.827433 cos_to_last_merge=1.0000 (last merge round=65)
[S16] round=66 local utility u=0.009970 metrics={'f1_val': 0.9930978344437764, 'auprc': 0.9925664955508294, 'loss_val': 0.03192212311991156, 'psi': 0.9928852988865976}-{'f1_val': 0.9915183330585845, 'auprc': 0.9931814583100882, 'loss_val': 0.04423094089304931, 'psi': 0.9921835831591861}
[S17] START round=66 head_norm_before_train=1.819734 cos_to_last_merge=0.9862 (last merge round=43)
[S17] round=66 local utility u=0.030874 metrics={'f1_val': 0.640266709909622, 'auprc': 0.8995824942203867, 'loss_val': 0.9863928161897332, 'psi': 0.7439930236339278}-{'f1_val': 0.6431435397115335, 'auprc': 0.8876400903507141, 'loss_val': 1.0295750533053178, 'psi': 0.7409421599672057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] sending update (kind=head size=1809 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=66 metric=0.9931 head_norm=1.837561
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.740659e-02
[S16] stored merged vector for next round verification (round=66)
[S16] DEBUG after merge:  round=66 metric=0.9931 head_norm=1.827802 delta_norm=0.017407
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=67 head_norm_before_train=2.070955 cos_to_last_merge=0.9337 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.934
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.8284061692598278, 'auprc': 0.9267525680177086, 'loss_val': 0.39247449416777935, 'psi': 0.86774472876298}-{'f1_val': 0.8338091562870986, 'auprc': 0.9844218491172615, 'loss_val': 0.30216995600363905, 'psi': 0.8940542334191638}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.027186 cos_to_last_merge=0.9871 (last merge round=44)
[S3] round=67 local utility u=1.000000 metrics={'f1_val': 0.9823195016036461, 'auprc': 0.9993220183819178, 'loss_val': 0.04380848065838073, 'psi': 0.9891205083149548}-{'f1_val': 0.6661584251437276, 'auprc': 0.9173688077580978, 'loss_val': 1.0541269053869329, 'psi': 0.7666425781894757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=67 head_norm_before_train=2.195592 (no previous merge yet)
[S4] round=67 local utility u=0.052870 metrics={'f1_val': 0.95292042112798, 'auprc': 0.9850916492642017, 'loss_val': 0.30214740357503617, 'psi': 0.9657889123824687}-{'f1_val': 0.944356289904081, 'auprc': 0.9662391700369789, 'loss_val': 0.2999455905827044, 'psi': 0.9531094419572401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=67 head_norm_before_train=1.765522 cos_to_last_merge=0.7905 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9917427177511366, 'loss_val': 0.02920781734441475, 'psi': 0.9944087010860413}-{'f1_val': 0.996186023309311, 'auprc': 0.9959392427737541, 'loss_val': 0.02921589476884772, 'psi': 0.9960873110950883}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=2.074353 cos_to_last_merge=0.9724 (last merge round=44)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.8022747206845389, 'auprc': 0.9258491607305619, 'loss_val': 0.6608127336109452, 'psi': 0.8517044967029481}-{'f1_val': 0.8217444949309185, 'auprc': 0.9541234441684325, 'loss_val': 0.3987427036722885, 'psi': 0.8746960746259241}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.830479 cos_to_last_merge=1.0000 (last merge round=65)
[S7] round=67 local utility u=0.099676 metrics={'f1_val': 0.6237756660308377, 'auprc': 0.8030063877592746, 'loss_val': 0.6384782187001558, 'psi': 0.6954679547222125}-{'f1_val': 0.6072803663592792, 'auprc': 0.7998182827207054, 'loss_val': 0.7292940313565085, 'psi': 0.6842955329038497}
[S8] START round=67 head_norm_before_train=1.863364 cos_to_last_merge=0.9950 (last merge round=45)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9903754849676576, 'auprc': 0.9995304352316169, 'loss_val': 0.03911474096174046, 'psi': 0.9940374650732413}-{'f1_val': 0.9940342119076258, 'auprc': 0.9952465523874552, 'loss_val': 0.030514933481429588, 'psi': 0.9945191480995574}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=1.982001 cos_to_last_merge=0.7682 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.768
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9939206739243593, 'loss_val': 0.05156493066577712, 'psi': 0.9898550722596209}-{'f1_val': 0.9966605118138915, 'auprc': 0.997660384917255, 'loss_val': 0.018564664958286337, 'psi': 0.9970604610552368}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=2.084851 cos_to_last_merge=0.9960 (last merge round=41)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9972392379271209, 'loss_val': 0.022822278667891698, 'psi': 0.9959577760165073}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972532428285547, 'loss_val': 0.022524986379790116, 'psi': 0.996212280213015}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=67 head_norm_before_train=1.852507 cos_to_last_merge=0.9939 (last merge round=41)
[S11] round=67 local utility u=0.000388 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986612801057619, 'loss_val': 0.022430577441652073, 'psi': 0.9971447169902904}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985617777613666, 'loss_val': 0.022907594718681375, 'psi': 0.9971049160525323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=67 head_norm_before_train=1.759253 cos_to_last_merge=0.9510 (last merge round=35)
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.644538380735268, 'auprc': 0.7080728708190406, 'loss_val': 1.1779690890238075, 'psi': 0.669952176768777}-{'f1_val': 0.6670993299086914, 'auprc': 0.696725024847134, 'loss_val': 1.2046895986469657, 'psi': 0.6789496078840684}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=2.097702 cos_to_last_merge=0.9981 (last merge round=46)
[S14] round=67 local utility u=0.000297 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.999180387022887, 'loss_val': 0.01731284312113107, 'psi': 0.9981187513698517}-{'f1_val': 0.9974336367705932, 'auprc': 0.9991761859935557, 'loss_val': 0.01802967377556969, 'psi': 0.9981306564597782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=67 head_norm_before_train=1.910227 cos_to_last_merge=0.9860 (last merge round=42)
[S15] round=67 local utility u=1.000000 metrics={'f1_val': 0.8913845730204261, 'auprc': 0.9982248721574931, 'loss_val': 0.24455597024698988, 'psi': 0.9341206926752529}-{'f1_val': 0.700681726646837, 'auprc': 0.8309295064021426, 'loss_val': 0.7447803431135656, 'psi': 0.7527808385489593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=67 head_norm_before_train=1.827802 cos_to_last_merge=1.0000 (last merge round=66)
[S16] round=67 local utility u=0.003214 metrics={'f1_val': 0.9935378636588306, 'auprc': 0.9934291222121094, 'loss_val': 0.03072301588145204, 'psi': 0.993494367080142}-{'f1_val': 0.9930978344437764, 'auprc': 0.9925664955508294, 'loss_val': 0.03192212311991156, 'psi': 0.9928852988865976}
[S17] START round=67 head_norm_before_train=1.828250 cos_to_last_merge=0.9857 (last merge round=43)
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.6335370184896078, 'auprc': 0.9329681647238721, 'loss_val': 1.0992942292542631, 'psi': 0.7533094769833135}-{'f1_val': 0.640266709909622, 'auprc': 0.8995824942203867, 'loss_val': 0.9863928161897332, 'psi': 0.7439930236339278}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S16] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=1.0000
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S7
[S16] cosine check vs S7: cos=1.0000
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=67 metric=0.6238 head_norm=1.831989
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.144117e-03
[S7] stored merged vector for next round verification (round=67)
[S7] DEBUG after merge:  round=67 metric=0.6236 head_norm=1.835632 delta_norm=0.008144
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=68 head_norm_before_train=2.081625 cos_to_last_merge=0.9329 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.933
[S2] round=68 local utility u=0.413633 metrics={'f1_val': 0.9140003977221395, 'auprc': 0.9785184697419143, 'loss_val': 0.2340715578525237, 'psi': 0.9398076265300495}-{'f1_val': 0.8284061692598278, 'auprc': 0.9267525680177086, 'loss_val': 0.39247449416777935, 'psi': 0.86774472876298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=68 head_norm_before_train=2.035730 cos_to_last_merge=0.9867 (last merge round=44)
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9988039483851188, 'loss_val': 0.07902606292252676, 'psi': 0.9760193447367856}-{'f1_val': 0.9823195016036461, 'auprc': 0.9993220183819178, 'loss_val': 0.04380848065838073, 'psi': 0.9891205083149548}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=2.212081 (no previous merge yet)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9438560632432778, 'auprc': 0.9767814536905436, 'loss_val': 0.3069637607653862, 'psi': 0.9570262194221841}-{'f1_val': 0.95292042112798, 'auprc': 0.9850916492642017, 'loss_val': 0.30214740357503617, 'psi': 0.9657889123824687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.770392 cos_to_last_merge=0.7902 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=68 local utility u=0.008282 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9978038986982656, 'loss_val': 0.028640187412739316, 'psi': 0.9966143811459184}-{'f1_val': 0.996186023309311, 'auprc': 0.9917427177511366, 'loss_val': 0.02920781734441475, 'psi': 0.9944087010860413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=68 head_norm_before_train=2.088268 cos_to_last_merge=0.9715 (last merge round=44)
[S6] round=68 local utility u=0.071999 metrics={'f1_val': 0.7915178389236716, 'auprc': 0.9396190702591135, 'loss_val': 0.4935827144401779, 'psi': 0.8507583314578484}-{'f1_val': 0.8022747206845389, 'auprc': 0.9258491607305619, 'loss_val': 0.6608127336109452, 'psi': 0.8517044967029481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=68 head_norm_before_train=1.835632 cos_to_last_merge=1.0000 (last merge round=67)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.6166197978543425, 'auprc': 0.8018255512948894, 'loss_val': 0.6699982321318734, 'psi': 0.6907020992305613}-{'f1_val': 0.6237756660308377, 'auprc': 0.8030063877592746, 'loss_val': 0.6384782187001558, 'psi': 0.6954679547222125}
[S8] START round=68 head_norm_before_train=1.870201 cos_to_last_merge=0.9947 (last merge round=45)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9910230168595211, 'auprc': 0.9887405335684554, 'loss_val': 0.03625756276457659, 'psi': 0.9901100235430949}-{'f1_val': 0.9903754849676576, 'auprc': 0.9995304352316169, 'loss_val': 0.03911474096174046, 'psi': 0.9940374650732413}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=1.987277 cos_to_last_merge=0.7676 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.768
[S9] round=68 local utility u=0.053939 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9998437626971405, 'loss_val': 0.017048484888227754, 'psi': 0.9977836164791887}-{'f1_val': 0.9871446711497952, 'auprc': 0.9939206739243593, 'loss_val': 0.05156493066577712, 'psi': 0.9898550722596209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=68 head_norm_before_train=2.087906 cos_to_last_merge=0.9956 (last merge round=41)
[S10] round=68 local utility u=0.001290 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972204942255236, 'loss_val': 0.022674198863038633, 'psi': 0.9961991807718026}-{'f1_val': 0.9951034680760983, 'auprc': 0.9972392379271209, 'loss_val': 0.022822278667891698, 'psi': 0.9959577760165073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=68 head_norm_before_train=1.858855 cos_to_last_merge=0.9936 (last merge round=41)
[S11] round=68 local utility u=0.000213 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986773367167971, 'loss_val': 0.022051832162068408, 'psi': 0.9971511396347045}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986612801057619, 'loss_val': 0.022430577441652073, 'psi': 0.9971447169902904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=68 head_norm_before_train=1.766814 cos_to_last_merge=0.9502 (last merge round=35)
[S13] round=68 local utility u=0.016315 metrics={'f1_val': 0.6528528676724352, 'auprc': 0.7112949929394645, 'loss_val': 1.2048926493609486, 'psi': 0.6762297177792469}-{'f1_val': 0.644538380735268, 'auprc': 0.7080728708190406, 'loss_val': 1.1779690890238075, 'psi': 0.669952176768777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=68 head_norm_before_train=2.100703 cos_to_last_merge=0.9980 (last merge round=46)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9915563358382661, 'auprc': 0.9971572895635905, 'loss_val': 0.03606018896023716, 'psi': 0.9937967173283958}-{'f1_val': 0.9974109942678281, 'auprc': 0.999180387022887, 'loss_val': 0.01731284312113107, 'psi': 0.9981187513698517}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.920792 cos_to_last_merge=0.9854 (last merge round=42)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.700681726646837, 'auprc': 0.7778785153419671, 'loss_val': 0.7462690456049863, 'psi': 0.731560442124889}-{'f1_val': 0.8913845730204261, 'auprc': 0.9982248721574931, 'loss_val': 0.24455597024698988, 'psi': 0.9341206926752529}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=1.839304 cos_to_last_merge=1.0000 (last merge round=66)
[S16] round=68 local utility u=0.001816 metrics={'f1_val': 0.9937081501847713, 'auprc': 0.9942218634549997, 'loss_val': 0.03049063467047538, 'psi': 0.9939136354928627}-{'f1_val': 0.9935378636588306, 'auprc': 0.9934291222121094, 'loss_val': 0.03072301588145204, 'psi': 0.993494367080142}
[S17] START round=68 head_norm_before_train=1.836996 cos_to_last_merge=0.9851 (last merge round=43)
[S17] round=68 local utility u=0.240694 metrics={'f1_val': 0.6706408110591179, 'auprc': 0.9176419597678248, 'loss_val': 0.7945510989862623, 'psi': 0.7694412705426006}-{'f1_val': 0.6335370184896078, 'auprc': 0.9329681647238721, 'loss_val': 1.0992942292542631, 'psi': 0.7533094769833135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:52808
[S16] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] cosine check vs S16: cos=1.0000
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=68 metric=0.9937 head_norm=1.852738
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.429037e-02
[S16] stored merged vector for next round verification (round=68)
[S16] DEBUG after merge:  round=68 metric=0.9937 head_norm=1.842337 delta_norm=0.014290
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=68 metric=0.6166 head_norm=1.838987
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.000696e-02
[S7] stored merged vector for next round verification (round=68)
[S7] DEBUG after merge:  round=68 metric=0.6168 head_norm=1.845848 delta_norm=0.010007
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=69 head_norm_before_train=2.091760 cos_to_last_merge=0.9322 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.932
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.9098545425293076, 'auprc': 0.9471584357760965, 'loss_val': 0.2606065921480306, 'psi': 0.9247760998280231}-{'f1_val': 0.9140003977221395, 'auprc': 0.9785184697419143, 'loss_val': 0.2340715578525237, 'psi': 0.9398076265300495}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.043337 cos_to_last_merge=0.9863 (last merge round=44)
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.9493554484972682, 'auprc': 0.9908755228770989, 'loss_val': 0.14684062515209903, 'psi': 0.9659634782492004}-{'f1_val': 0.9608296089712303, 'auprc': 0.9988039483851188, 'loss_val': 0.07902606292252676, 'psi': 0.9760193447367856}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=2.225107 (no previous merge yet)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9395277063266178, 'auprc': 0.9612740874016067, 'loss_val': 0.3098677796151311, 'psi': 0.9482262587566134}-{'f1_val': 0.9438560632432778, 'auprc': 0.9767814536905436, 'loss_val': 0.3069637607653862, 'psi': 0.9570262194221841}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.774603 cos_to_last_merge=0.7901 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.7145680792825414, 'auprc': 0.9895350373638422, 'loss_val': 0.37172241694805624, 'psi': 0.8245548625150618}-{'f1_val': 0.9958213694443535, 'auprc': 0.9978038986982656, 'loss_val': 0.028640187412739316, 'psi': 0.9966143811459184}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=2.095902 cos_to_last_merge=0.9710 (last merge round=44)
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.7696640577521189, 'auprc': 0.9175809806056614, 'loss_val': 0.7649009617113783, 'psi': 0.8288308268935358}-{'f1_val': 0.7915178389236716, 'auprc': 0.9396190702591135, 'loss_val': 0.4935827144401779, 'psi': 0.8507583314578484}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=69 head_norm_before_train=1.845848 cos_to_last_merge=1.0000 (last merge round=68)
[S7] round=69 local utility u=0.194314 metrics={'f1_val': 0.6500586110497566, 'auprc': 0.8097893842563815, 'loss_val': 0.5058939561959939, 'psi': 0.7139509203324066}-{'f1_val': 0.6166197978543425, 'auprc': 0.8018255512948894, 'loss_val': 0.6699982321318734, 'psi': 0.6907020992305613}
[S8] START round=69 head_norm_before_train=1.877468 cos_to_last_merge=0.9944 (last merge round=45)
[S8] round=69 local utility u=0.025291 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9961113306079872, 'loss_val': 0.02732301287431522, 'psi': 0.9950118365946129}-{'f1_val': 0.9910230168595211, 'auprc': 0.9887405335684554, 'loss_val': 0.03625756276457659, 'psi': 0.9901100235430949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] sending update (kind=head size=1809 to 1 peers)
[S9] START round=69 head_norm_before_train=1.993310 cos_to_last_merge=0.7669 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.767
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9940556938208596, 'loss_val': 0.018589371026340763, 'psi': 0.9953723343959104}-{'f1_val': 0.9964101856672208, 'auprc': 0.9998437626971405, 'loss_val': 0.017048484888227754, 'psi': 0.9977836164791887}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=2.092161 cos_to_last_merge=0.9952 (last merge round=41)
[S10] round=69 local utility u=0.000045 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972444856926118, 'loss_val': 0.022655630983637494, 'psi': 0.9962087773586379}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972204942255236, 'loss_val': 0.022674198863038633, 'psi': 0.9961991807718026}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=69 head_norm_before_train=1.865240 cos_to_last_merge=0.9934 (last merge round=41)
[S11] round=69 local utility u=0.001317 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9986141062826213, 'loss_val': 0.021708847753812707, 'psi': 0.9973738452212022}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986773367167971, 'loss_val': 0.022051832162068408, 'psi': 0.9971511396347045}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=69 head_norm_before_train=1.773666 cos_to_last_merge=0.9494 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.6351711516421605, 'auprc': 0.6757386044201235, 'loss_val': 1.3318862208525508, 'psi': 0.6513981327533457}-{'f1_val': 0.6528528676724352, 'auprc': 0.7112949929394645, 'loss_val': 1.2048926493609486, 'psi': 0.6762297177792469}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=2.102840 cos_to_last_merge=0.9979 (last merge round=46)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.985359895093606, 'auprc': 0.9971141676662845, 'loss_val': 0.03977250088331837, 'psi': 0.9900616041226774}-{'f1_val': 0.9915563358382661, 'auprc': 0.9971572895635905, 'loss_val': 0.03606018896023716, 'psi': 0.9937967173283958}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=1.930771 cos_to_last_merge=0.9848 (last merge round=42)
[S15] round=69 local utility u=1.000000 metrics={'f1_val': 0.9960132106659711, 'auprc': 0.9981195122114964, 'loss_val': 0.02283964886535172, 'psi': 0.9968557312841813}-{'f1_val': 0.700681726646837, 'auprc': 0.7778785153419671, 'loss_val': 0.7462690456049863, 'psi': 0.731560442124889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=69 head_norm_before_train=1.842337 cos_to_last_merge=1.0000 (last merge round=68)
[S16] round=69 local utility u=0.000909 metrics={'f1_val': 0.9932913840280244, 'auprc': 0.9957469023080496, 'loss_val': 0.03074812399535496, 'psi': 0.9942735913400345}-{'f1_val': 0.9937081501847713, 'auprc': 0.9942218634549997, 'loss_val': 0.03049063467047538, 'psi': 0.9939136354928627}
[S17] START round=69 head_norm_before_train=1.846717 cos_to_last_merge=0.9845 (last merge round=43)
[S17] round=69 local utility u=0.619048 metrics={'f1_val': 0.8841951219036606, 'auprc': 0.8293130790966275, 'loss_val': 0.5727952584639522, 'psi': 0.8622423047808474}-{'f1_val': 0.6706408110591179, 'auprc': 0.9176419597678248, 'loss_val': 0.7945510989862623, 'psi': 0.7694412705426006}
[S17] not sending this round → trigger blocked (psi=0.862)
[S16] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] cosine check vs S7: cos=1.0000
[S2] START round=70 head_norm_before_train=2.093164 cos_to_last_merge=0.9320 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.932
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.8257954616823633, 'auprc': 0.9282691225049226, 'loss_val': 0.3846118363233786, 'psi': 0.866784926011387}-{'f1_val': 0.9098545425293076, 'auprc': 0.9471584357760965, 'loss_val': 0.2606065921480306, 'psi': 0.9247760998280231}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=2.050287 cos_to_last_merge=0.9859 (last merge round=44)
[S3] round=70 local utility u=0.064268 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9995986609014345, 'loss_val': 0.11479086245842048, 'psi': 0.9764845156002461}-{'f1_val': 0.9493554484972682, 'auprc': 0.9908755228770989, 'loss_val': 0.14684062515209903, 'psi': 0.9659634782492004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=70 head_norm_before_train=2.229868 (no previous merge yet)
[S4] round=70 local utility u=0.050055 metrics={'f1_val': 0.9418502662099069, 'auprc': 0.9844433119726923, 'loss_val': 0.29320097832053976, 'psi': 0.958887484515021}-{'f1_val': 0.9395277063266178, 'auprc': 0.9612740874016067, 'loss_val': 0.3098677796151311, 'psi': 0.9482262587566134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=70 head_norm_before_train=1.775853 cos_to_last_merge=0.7905 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=70 local utility u=1.000000 metrics={'f1_val': 0.9964799208068884, 'auprc': 0.9975493156038924, 'loss_val': 0.03367222904442039, 'psi': 0.9969076787256901}-{'f1_val': 0.7145680792825414, 'auprc': 0.9895350373638422, 'loss_val': 0.37172241694805624, 'psi': 0.8245548625150618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=70 head_norm_before_train=2.105640 cos_to_last_merge=0.9704 (last merge round=44)
[S6] round=70 local utility u=0.176664 metrics={'f1_val': 0.8008209473179447, 'auprc': 0.9221887872751506, 'loss_val': 0.6123382620775104, 'psi': 0.849368083300827}-{'f1_val': 0.7696640577521189, 'auprc': 0.9175809806056614, 'loss_val': 0.7649009617113783, 'psi': 0.8288308268935358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=70 head_norm_before_train=1.849070 cos_to_last_merge=1.0000 (last merge round=68)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.638931238383186, 'auprc': 0.8092188995121533, 'loss_val': 0.4980775467137897, 'psi': 0.7070463028347729}-{'f1_val': 0.6500586110497566, 'auprc': 0.8097893842563815, 'loss_val': 0.5058939561959939, 'psi': 0.7139509203324066}
[S8] START round=70 head_norm_before_train=1.885869 cos_to_last_merge=0.9941 (last merge round=45)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.992032490903249, 'auprc': 0.999056147856961, 'loss_val': 0.033098409331918044, 'psi': 0.9948419536847337}-{'f1_val': 0.9942788405856967, 'auprc': 0.9961113306079872, 'loss_val': 0.02732301287431522, 'psi': 0.9950118365946129}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=1.998251 cos_to_last_merge=0.7666 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.767
[S9] round=70 local utility u=0.010680 metrics={'f1_val': 0.9968210870560296, 'auprc': 0.9996893140023861, 'loss_val': 0.01755695540087972, 'psi': 0.9979683778345723}-{'f1_val': 0.9962500947792776, 'auprc': 0.9940556938208596, 'loss_val': 0.018589371026340763, 'psi': 0.9953723343959104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=70 head_norm_before_train=2.099463 cos_to_last_merge=0.9952 (last merge round=41)
[S10] round=70 local utility u=0.000220 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972553617600188, 'loss_val': 0.022247285617076198, 'psi': 0.9962131277856007}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972444856926118, 'loss_val': 0.022655630983637494, 'psi': 0.9962087773586379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=70 head_norm_before_train=1.870928 cos_to_last_merge=0.9932 (last merge round=41)
[S11] round=70 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998506677173289, 'loss_val': 0.021911810757739465, 'psi': 0.9970951557157628}-{'f1_val': 0.9965470045135896, 'auprc': 0.9986141062826213, 'loss_val': 0.021708847753812707, 'psi': 0.9973738452212022}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=70 head_norm_before_train=1.787115 cos_to_last_merge=0.9478 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.948
[S13] round=70 local utility u=0.830392 metrics={'f1_val': 0.7849730871536387, 'auprc': 0.7952932017631429, 'loss_val': 0.9285779534250906, 'psi': 0.7891011329974404}-{'f1_val': 0.6351711516421605, 'auprc': 0.6757386044201235, 'loss_val': 1.3318862208525508, 'psi': 0.6513981327533457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=70 head_norm_before_train=2.106103 cos_to_last_merge=0.9978 (last merge round=46)
[S14] round=70 local utility u=0.051495 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991782217193824, 'loss_val': 0.01774643116225708, 'psi': 0.9983643443004084}-{'f1_val': 0.985359895093606, 'auprc': 0.9971141676662845, 'loss_val': 0.03977250088331837, 'psi': 0.9900616041226774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=70 head_norm_before_train=1.939443 cos_to_last_merge=0.9843 (last merge round=42)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.9340166449198597, 'auprc': 0.9980411386195025, 'loss_val': 0.17799976058680558, 'psi': 0.9596264423997168}-{'f1_val': 0.9960132106659711, 'auprc': 0.9981195122114964, 'loss_val': 0.02283964886535172, 'psi': 0.9968557312841813}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=1.856457 cos_to_last_merge=1.0000 (last merge round=68)
[S16] round=70 local utility u=0.000508 metrics={'f1_val': 0.9935110968152479, 'auprc': 0.9957395292437696, 'loss_val': 0.03102793787947668, 'psi': 0.9944024697866565}-{'f1_val': 0.9932913840280244, 'auprc': 0.9957469023080496, 'loss_val': 0.03074812399535496, 'psi': 0.9942735913400345}
[S17] START round=70 head_norm_before_train=1.856972 cos_to_last_merge=0.9839 (last merge round=43)
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.8540766918045626, 'auprc': 0.8399562536327168, 'loss_val': 0.6703303312434236, 'psi': 0.8484285165358243}-{'f1_val': 0.8841951219036606, 'auprc': 0.8293130790966275, 'loss_val': 0.5727952584639522, 'psi': 0.8622423047808474}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.125 → S16@127.0.0.1:52816
[S16] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=70 metric=0.9935 head_norm=1.870473
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.479446e-02
[S16] stored merged vector for next round verification (round=70)
[S16] DEBUG after merge:  round=70 metric=0.9935 head_norm=1.859743 delta_norm=0.014794
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.088 → S7@127.0.0.1:52808
[S2] START round=71 head_norm_before_train=2.098953 cos_to_last_merge=0.9319 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.932
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.7368088493659397, 'auprc': 0.9768033921069531, 'loss_val': 0.4341076943346611, 'psi': 0.832806666462345}-{'f1_val': 0.8257954616823633, 'auprc': 0.9282691225049226, 'loss_val': 0.3846118363233786, 'psi': 0.866784926011387}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.057932 cos_to_last_merge=0.9855 (last merge round=44)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.8921004857475241, 'auprc': 0.9746166428052401, 'loss_val': 0.29161229381963877, 'psi': 0.9251069485706105}-{'f1_val': 0.9610750853994537, 'auprc': 0.9995986609014345, 'loss_val': 0.11479086245842048, 'psi': 0.9764845156002461}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=2.234142 (no previous merge yet)
[S4] round=71 local utility u=0.024637 metrics={'f1_val': 0.9465004284052522, 'auprc': 0.9862113599636615, 'loss_val': 0.2771327526458087, 'psi': 0.9623848010286159}-{'f1_val': 0.9418502662099069, 'auprc': 0.9844433119726923, 'loss_val': 0.29320097832053976, 'psi': 0.958887484515021}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=71 head_norm_before_train=1.776730 cos_to_last_merge=0.7907 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9918173173784174, 'loss_val': 0.031045499155368476, 'psi': 0.9944385409369536}-{'f1_val': 0.9964799208068884, 'auprc': 0.9975493156038924, 'loss_val': 0.03367222904442039, 'psi': 0.9969076787256901}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=2.117756 cos_to_last_merge=0.9696 (last merge round=44)
[S6] round=71 local utility u=0.643168 metrics={'f1_val': 0.9527903953061755, 'auprc': 0.9161380351402677, 'loss_val': 0.21966673674786888, 'psi': 0.9381294512398124}-{'f1_val': 0.8008209473179447, 'auprc': 0.9221887872751506, 'loss_val': 0.6123382620775104, 'psi': 0.849368083300827}
[S6] not sending this round → trigger blocked (psi=0.938)
[S7] START round=71 head_norm_before_train=1.854645 cos_to_last_merge=0.9999 (last merge round=68)
[S7] round=71 local utility u=0.056892 metrics={'f1_val': 0.6494748634661143, 'auprc': 0.8131234014936886, 'loss_val': 0.4592683316555715, 'psi': 0.714934278677144}-{'f1_val': 0.638931238383186, 'auprc': 0.8092188995121533, 'loss_val': 0.4980775467137897, 'psi': 0.7070463028347729}
[S8] START round=71 head_norm_before_train=1.893631 cos_to_last_merge=0.9939 (last merge round=45)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9919668639321886, 'auprc': 0.9995640322678401, 'loss_val': 0.045400886182766026, 'psi': 0.9950057312664492}-{'f1_val': 0.992032490903249, 'auprc': 0.999056147856961, 'loss_val': 0.033098409331918044, 'psi': 0.9948419536847337}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=2.003129 cos_to_last_merge=0.7665 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.766
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9998605325289203, 'loss_val': 0.018449573868830334, 'psi': 0.9974402440300794}-{'f1_val': 0.9968210870560296, 'auprc': 0.9996893140023861, 'loss_val': 0.01755695540087972, 'psi': 0.9979683778345723}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.105482 cos_to_last_merge=0.9951 (last merge round=41)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972563733258816, 'loss_val': 0.02249208743576372, 'psi': 0.9962135324119458}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972553617600188, 'loss_val': 0.022247285617076198, 'psi': 0.9962131277856007}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=1.877035 cos_to_last_merge=0.9929 (last merge round=41)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985936517866303, 'loss_val': 0.022386666427216886, 'psi': 0.9971299455610994}-{'f1_val': 0.9961541414107454, 'auprc': 0.998506677173289, 'loss_val': 0.021911810757739465, 'psi': 0.9970951557157628}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.795522 cos_to_last_merge=0.9468 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=71 local utility u=0.081944 metrics={'f1_val': 0.7896001797549381, 'auprc': 0.824444976957918, 'loss_val': 0.8799084856832132, 'psi': 0.80353809863613}-{'f1_val': 0.7849730871536387, 'auprc': 0.7952932017631429, 'loss_val': 0.9285779534250906, 'psi': 0.7891011329974404}
[S13] not sending this round → trigger blocked (psi=0.804)
[S14] START round=71 head_norm_before_train=2.111206 cos_to_last_merge=0.9977 (last merge round=46)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.999198633849727, 'loss_val': 0.01795034301014809, 'psi': 0.9978618485458806}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991782217193824, 'loss_val': 0.01774643116225708, 'psi': 0.9983643443004084}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=1.948585 cos_to_last_merge=0.9838 (last merge round=42)
[S15] round=71 local utility u=0.076654 metrics={'f1_val': 0.9487946098630656, 'auprc': 0.997873787879596, 'loss_val': 0.11285812307974122, 'psi': 0.9684262810696778}-{'f1_val': 0.9340166449198597, 'auprc': 0.9980411386195025, 'loss_val': 0.17799976058680558, 'psi': 0.9596264423997168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=71 head_norm_before_train=1.859743 cos_to_last_merge=1.0000 (last merge round=70)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9926517489705322, 'auprc': 0.994122277300993, 'loss_val': 0.0373812486834991, 'psi': 0.9932399603027166}-{'f1_val': 0.9935110968152479, 'auprc': 0.9957395292437696, 'loss_val': 0.03102793787947668, 'psi': 0.9944024697866565}
[S17] START round=71 head_norm_before_train=1.865847 cos_to_last_merge=0.9833 (last merge round=43)
[S17] round=71 local utility u=0.174090 metrics={'f1_val': 0.8748025676907187, 'auprc': 0.8858569036167343, 'loss_val': 0.5842066190637292, 'psi': 0.879224302061125}-{'f1_val': 0.8540766918045626, 'auprc': 0.8399562536327168, 'loss_val': 0.6703303312434236, 'psi': 0.8484285165358243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.9998
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=71 metric=0.6495 head_norm=1.862902
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.887159e-02
[S7] stored merged vector for next round verification (round=71)
[S7] DEBUG after merge:  round=71 metric=0.6509 head_norm=1.866596 delta_norm=0.018872
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=72 head_norm_before_train=2.105613 cos_to_last_merge=0.9314 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7209534570374553, 'auprc': 0.8596203975455794, 'loss_val': 0.7349822024939684, 'psi': 0.776420233240705}-{'f1_val': 0.7368088493659397, 'auprc': 0.9768033921069531, 'loss_val': 0.4341076943346611, 'psi': 0.832806666462345}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.062869 cos_to_last_merge=0.9853 (last merge round=44)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.8294346105661877, 'auprc': 0.9965607793556885, 'loss_val': 0.4394477731537541, 'psi': 0.896285078081988}-{'f1_val': 0.8921004857475241, 'auprc': 0.9746166428052401, 'loss_val': 0.29161229381963877, 'psi': 0.9251069485706105}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=2.239933 (no previous merge yet)
[S4] round=72 local utility u=0.012429 metrics={'f1_val': 0.9531361229196141, 'auprc': 0.985933375374654, 'loss_val': 0.2912556577493123, 'psi': 0.9662550239016301}-{'f1_val': 0.9465004284052522, 'auprc': 0.9862113599636615, 'loss_val': 0.2771327526458087, 'psi': 0.9623848010286159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=72 head_norm_before_train=1.777885 cos_to_last_merge=0.7907 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=72 local utility u=0.003827 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9941522361741233, 'loss_val': 0.030395946864940845, 'psi': 0.995372508455236}-{'f1_val': 0.996186023309311, 'auprc': 0.9918173173784174, 'loss_val': 0.031045499155368476, 'psi': 0.9944385409369536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=72 head_norm_before_train=2.126995 cos_to_last_merge=0.9689 (last merge round=44)
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.4996353746107596, 'auprc': 0.6575013372192174, 'loss_val': 2.0115681510629515, 'psi': 0.5627817596541427}-{'f1_val': 0.9527903953061755, 'auprc': 0.9161380351402677, 'loss_val': 0.21966673674786888, 'psi': 0.9381294512398124}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=1.866596 cos_to_last_merge=1.0000 (last merge round=71)
[S7] round=72 local utility u=0.027374 metrics={'f1_val': 0.6524142815426605, 'auprc': 0.8152053024841153, 'loss_val': 0.4284025471214577, 'psi': 0.7175306899192424}-{'f1_val': 0.6494748634661143, 'auprc': 0.8131234014936886, 'loss_val': 0.4592683316555715, 'psi': 0.714934278677144}
[S8] START round=72 head_norm_before_train=1.898831 cos_to_last_merge=0.9936 (last merge round=45)
[S8] round=72 local utility u=0.012319 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9982740004891008, 'loss_val': 0.028566035590620462, 'psi': 0.9956569650626483}-{'f1_val': 0.9919668639321886, 'auprc': 0.9995640322678401, 'loss_val': 0.045400886182766026, 'psi': 0.9950057312664492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=72 head_norm_before_train=2.004647 cos_to_last_merge=0.7659 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.766
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9998398349584372, 'loss_val': 0.02025424647477287, 'psi': 0.9974319650018861}-{'f1_val': 0.9958267183641853, 'auprc': 0.9998605325289203, 'loss_val': 0.018449573868830334, 'psi': 0.9974402440300794}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.109910 cos_to_last_merge=0.9948 (last merge round=41)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.997256643185981, 'loss_val': 0.02267205495957646, 'psi': 0.9962136403559856}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972563733258816, 'loss_val': 0.02249208743576372, 'psi': 0.9962135324119458}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=1.882264 cos_to_last_merge=0.9927 (last merge round=41)
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986002902593417, 'loss_val': 0.0228638972472422, 'psi': 0.997132600950184}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985936517866303, 'loss_val': 0.022386666427216886, 'psi': 0.9971299455610994}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.799921 cos_to_last_merge=0.9462 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.7290655582209614, 'auprc': 0.8629356621284274, 'loss_val': 0.9654760383401907, 'psi': 0.7826135997839478}-{'f1_val': 0.7896001797549381, 'auprc': 0.824444976957918, 'loss_val': 0.8799084856832132, 'psi': 0.80353809863613}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.115670 cos_to_last_merge=0.9976 (last merge round=46)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.9992015925348422, 'loss_val': 0.018622870522363177, 'psi': 0.9978630320199267}-{'f1_val': 0.9969706583433163, 'auprc': 0.999198633849727, 'loss_val': 0.01795034301014809, 'psi': 0.9978618485458806}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=1.957907 cos_to_last_merge=0.9833 (last merge round=42)
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.7819401478675628, 'auprc': 0.9488867939918264, 'loss_val': 0.5052762894909932, 'psi': 0.8487188063172683}-{'f1_val': 0.9487946098630656, 'auprc': 0.997873787879596, 'loss_val': 0.11285812307974122, 'psi': 0.9684262810696778}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=1.868674 cos_to_last_merge=1.0000 (last merge round=70)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9273378313092444, 'auprc': 0.9922020290331856, 'loss_val': 0.24262491289772706, 'psi': 0.9532835103988209}-{'f1_val': 0.9926517489705322, 'auprc': 0.994122277300993, 'loss_val': 0.0373812486834991, 'psi': 0.9932399603027166}
[S17] START round=72 head_norm_before_train=1.874461 cos_to_last_merge=0.9827 (last merge round=43)
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.7495361990511581, 'auprc': 0.9226505393768903, 'loss_val': 0.8972565194298547, 'psi': 0.8187819351814509}-{'f1_val': 0.8748025676907187, 'auprc': 0.8858569036167343, 'loss_val': 0.5842066190637292, 'psi': 0.879224302061125}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.718)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=72 metric=0.9273 head_norm=1.874448
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.870443e-02
[S16] stored merged vector for next round verification (round=72)
[S16] DEBUG after merge:  round=72 metric=0.9273 head_norm=1.868590 delta_norm=0.018704
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=73 head_norm_before_train=2.113121 cos_to_last_merge=0.9307 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=73 local utility u=0.610024 metrics={'f1_val': 0.8205250472696428, 'auprc': 0.954539473878979, 'loss_val': 0.39712120278295693, 'psi': 0.8741308179133773}-{'f1_val': 0.7209534570374553, 'auprc': 0.8596203975455794, 'loss_val': 0.7349822024939684, 'psi': 0.776420233240705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=73 head_norm_before_train=2.069185 cos_to_last_merge=0.9850 (last merge round=44)
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.7821125113662956, 'auprc': 0.9878845995035421, 'loss_val': 0.6251877568023434, 'psi': 0.8644213466211942}-{'f1_val': 0.8294346105661877, 'auprc': 0.9965607793556885, 'loss_val': 0.4394477731537541, 'psi': 0.896285078081988}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=2.248604 (no previous merge yet)
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9406670087867535, 'auprc': 0.9754097072129744, 'loss_val': 0.30220403139944774, 'psi': 0.9545640881572418}-{'f1_val': 0.9531361229196141, 'auprc': 0.985933375374654, 'loss_val': 0.2912556577493123, 'psi': 0.9662550239016301}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=1.776029 cos_to_last_merge=0.7912 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=73 local utility u=0.000758 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9945330514749164, 'loss_val': 0.03002241921770728, 'psi': 0.9955248345755532}-{'f1_val': 0.996186023309311, 'auprc': 0.9941522361741233, 'loss_val': 0.030395946864940845, 'psi': 0.995372508455236}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=73 head_norm_before_train=2.138033 cos_to_last_merge=0.9684 (last merge round=44)
[S6] round=73 local utility u=1.000000 metrics={'f1_val': 0.8378165693663793, 'auprc': 0.9631481562864409, 'loss_val': 0.3231986885461759, 'psi': 0.8879492041344039}-{'f1_val': 0.4996353746107596, 'auprc': 0.6575013372192174, 'loss_val': 2.0115681510629515, 'psi': 0.5627817596541427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=73 head_norm_before_train=1.871596 cos_to_last_merge=1.0000 (last merge round=71)
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.6258523100896534, 'auprc': 0.8020035022238833, 'loss_val': 0.6810186293797097, 'psi': 0.6963127869433454}-{'f1_val': 0.6524142815426605, 'auprc': 0.8152053024841153, 'loss_val': 0.4284025471214577, 'psi': 0.7175306899192424}
[S8] START round=73 head_norm_before_train=1.906961 cos_to_last_merge=0.9934 (last merge round=45)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9974985346226182, 'loss_val': 0.0289103234986902, 'psi': 0.9953467787160553}-{'f1_val': 0.9939122747783468, 'auprc': 0.9982740004891008, 'loss_val': 0.028566035590620462, 'psi': 0.9956569650626483}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=2.008624 cos_to_last_merge=0.7654 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.765
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9998361465205001, 'loss_val': 0.025656949468974132, 'psi': 0.9961797636020251}-{'f1_val': 0.9958267183641853, 'auprc': 0.9998398349584372, 'loss_val': 0.02025424647477287, 'psi': 0.9974319650018861}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=2.116908 cos_to_last_merge=0.9948 (last merge round=41)
[S10] round=73 local utility u=0.000005 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972524436895629, 'loss_val': 0.022649758502606417, 'psi': 0.9962119605574183}-{'f1_val': 0.9955183051359886, 'auprc': 0.997256643185981, 'loss_val': 0.02267205495957646, 'psi': 0.9962136403559856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=73 head_norm_before_train=1.887328 cos_to_last_merge=0.9925 (last merge round=41)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985118287496816, 'loss_val': 0.023472049303930348, 'psi': 0.9970972163463199}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986002902593417, 'loss_val': 0.0228638972472422, 'psi': 0.997132600950184}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.800357 cos_to_last_merge=0.9462 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=73 local utility u=0.436468 metrics={'f1_val': 0.8111916723370919, 'auprc': 0.8814213058744248, 'loss_val': 0.640754484029543, 'psi': 0.839283525752025}-{'f1_val': 0.7290655582209614, 'auprc': 0.8629356621284274, 'loss_val': 0.9654760383401907, 'psi': 0.7826135997839478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=73 head_norm_before_train=2.118228 cos_to_last_merge=0.9974 (last merge round=46)
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9934139723925135, 'auprc': 0.9974092676339075, 'loss_val': 0.033316611722831305, 'psi': 0.995012090489071}-{'f1_val': 0.9969706583433163, 'auprc': 0.9992015925348422, 'loss_val': 0.018622870522363177, 'psi': 0.9978630320199267}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=1.966225 cos_to_last_merge=0.9829 (last merge round=42)
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.700833884979711, 'auprc': 0.9157651513561295, 'loss_val': 0.7460093277976608, 'psi': 0.7868063915302783}-{'f1_val': 0.7819401478675628, 'auprc': 0.9488867939918264, 'loss_val': 0.5052762894909932, 'psi': 0.8487188063172683}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=1.868590 cos_to_last_merge=1.0000 (last merge round=72)
[S16] round=73 local utility u=0.304108 metrics={'f1_val': 0.9930759014009373, 'auprc': 0.9932237227653297, 'loss_val': 0.03190219072596159, 'psi': 0.9931350299466941}-{'f1_val': 0.9273378313092444, 'auprc': 0.9922020290331856, 'loss_val': 0.24262491289772706, 'psi': 0.9532835103988209}
[S17] START round=73 head_norm_before_train=1.883327 cos_to_last_merge=0.9820 (last merge round=43)
[S17] round=73 local utility u=0.248579 metrics={'f1_val': 0.8168392572501204, 'auprc': 0.8855593474532126, 'loss_val': 0.6926442577429024, 'psi': 0.8443272933313573}-{'f1_val': 0.7495361990511581, 'auprc': 0.9226505393768903, 'loss_val': 0.8972565194298547, 'psi': 0.8187819351814509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:52808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] cosine check vs S16: cos=0.9999
[S2] START round=74 head_norm_before_train=2.123945 cos_to_last_merge=0.9301 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.930
[S2] round=74 local utility u=0.161161 metrics={'f1_val': 0.8989644094663598, 'auprc': 0.886447239648716, 'loss_val': 0.34115924624170635, 'psi': 0.8939575415393023}-{'f1_val': 0.8205250472696428, 'auprc': 0.954539473878979, 'loss_val': 0.39712120278295693, 'psi': 0.8741308179133773}
[S2] not sending this round → trigger blocked (psi=0.894)
[S3] START round=74 head_norm_before_train=2.075429 cos_to_last_merge=0.9846 (last merge round=44)
[S3] round=74 local utility u=0.253606 metrics={'f1_val': 0.841618203983645, 'auprc': 0.9802633146179853, 'loss_val': 0.4521452611744397, 'psi': 0.8970762482373811}-{'f1_val': 0.7821125113662956, 'auprc': 0.9878845995035421, 'loss_val': 0.6251877568023434, 'psi': 0.8644213466211942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=74 head_norm_before_train=2.260403 (no previous merge yet)
[S4] round=74 local utility u=0.061954 metrics={'f1_val': 0.9545433316883717, 'auprc': 0.9862098070216604, 'loss_val': 0.29395445359763245, 'psi': 0.9672099218216872}-{'f1_val': 0.9406670087867535, 'auprc': 0.9754097072129744, 'loss_val': 0.30220403139944774, 'psi': 0.9545640881572418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=74 head_norm_before_train=1.778613 cos_to_last_merge=0.7911 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.991994258213972, 'loss_val': 0.031018316218816268, 'psi': 0.9945093172711754}-{'f1_val': 0.996186023309311, 'auprc': 0.9945330514749164, 'loss_val': 0.03002241921770728, 'psi': 0.9955248345755532}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=2.151327 cos_to_last_merge=0.9676 (last merge round=44)
[S6] round=74 local utility u=0.454123 metrics={'f1_val': 0.9498746246684584, 'auprc': 0.976404005551494, 'loss_val': 0.12706800647276537, 'psi': 0.9604863770216727}-{'f1_val': 0.8378165693663793, 'auprc': 0.9631481562864409, 'loss_val': 0.3231986885461759, 'psi': 0.8879492041344039}
[S6] not sending this round → trigger blocked (psi=0.960)
[S7] START round=74 head_norm_before_train=1.875164 cos_to_last_merge=1.0000 (last merge round=71)
[S7] round=74 local utility u=0.753698 metrics={'f1_val': 0.718462432576036, 'auprc': 0.9565249470459776, 'loss_val': 0.19284830762679425, 'psi': 0.8136874383640127}-{'f1_val': 0.6258523100896534, 'auprc': 0.8020035022238833, 'loss_val': 0.6810186293797097, 'psi': 0.6963127869433454}
[S8] START round=74 head_norm_before_train=1.914407 cos_to_last_merge=0.9931 (last merge round=45)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.9913077019421868, 'auprc': 0.9989504980046161, 'loss_val': 0.03400008760970774, 'psi': 0.9943648203671585}-{'f1_val': 0.9939122747783468, 'auprc': 0.9974985346226182, 'loss_val': 0.0289103234986902, 'psi': 0.9953467787160553}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=2.013723 cos_to_last_merge=0.7649 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.765
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9985467745586248, 'loss_val': 0.046457634543953394, 'psi': 0.9926223343251107}-{'f1_val': 0.9937421749897083, 'auprc': 0.9998361465205001, 'loss_val': 0.025656949468974132, 'psi': 0.9961797636020251}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.124664 cos_to_last_merge=0.9949 (last merge round=41)
[S10] round=74 local utility u=0.000098 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972467609116595, 'loss_val': 0.02243762161162877, 'psi': 0.9962096874462569}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972524436895629, 'loss_val': 0.022649758502606417, 'psi': 0.9962119605574183}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=74 head_norm_before_train=1.893007 cos_to_last_merge=0.9923 (last merge round=41)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.8473930998619847, 'auprc': 0.9966716134403614, 'loss_val': 0.3130318398186825, 'psi': 0.9071045052933354}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985118287496816, 'loss_val': 0.023472049303930348, 'psi': 0.9970972163463199}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.804857 cos_to_last_merge=0.9455 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6995214144647335, 'auprc': 0.9413868357285897, 'loss_val': 0.9559000379059724, 'psi': 0.796267582970276}-{'f1_val': 0.8111916723370919, 'auprc': 0.8814213058744248, 'loss_val': 0.640754484029543, 'psi': 0.839283525752025}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=2.120445 cos_to_last_merge=0.9972 (last merge round=46)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9810396865714109, 'auprc': 0.996856475000711, 'loss_val': 0.04207596486565956, 'psi': 0.987366401943131}-{'f1_val': 0.9934139723925135, 'auprc': 0.9974092676339075, 'loss_val': 0.033316611722831305, 'psi': 0.995012090489071}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=1.974234 cos_to_last_merge=0.9825 (last merge round=42)
[S15] round=74 local utility u=1.000000 metrics={'f1_val': 0.9934185961837458, 'auprc': 0.9974449383927013, 'loss_val': 0.02748727405452758, 'psi': 0.9950291330673281}-{'f1_val': 0.700833884979711, 'auprc': 0.9157651513561295, 'loss_val': 0.7460093277976608, 'psi': 0.7868063915302783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=74 head_norm_before_train=1.876448 cos_to_last_merge=1.0000 (last merge round=72)
[S16] round=74 local utility u=0.000113 metrics={'f1_val': 0.9937081501847713, 'auprc': 0.9917045736997825, 'loss_val': 0.030912768184022162, 'psi': 0.9929067195907758}-{'f1_val': 0.9930759014009373, 'auprc': 0.9932237227653297, 'loss_val': 0.03190219072596159, 'psi': 0.9931350299466941}
[S17] START round=74 head_norm_before_train=1.893004 cos_to_last_merge=0.9812 (last merge round=43)
[S17] round=74 local utility u=0.264227 metrics={'f1_val': 0.8899999159750693, 'auprc': 0.8726073081309589, 'loss_val': 0.5642985003959174, 'psi': 0.8830428728374251}-{'f1_val': 0.8168392572501204, 'auprc': 0.8855593474532126, 'loss_val': 0.6926442577429024, 'psi': 0.8443272933313573}
[S17] not sending this round → trigger blocked (psi=0.883)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:52816
[S16] not sending this round → trigger blocked (psi=0.993)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=0.9998
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=74 metric=0.7185 head_norm=1.878449
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.565618e-02
[S7] stored merged vector for next round verification (round=74)
[S7] DEBUG after merge:  round=74 metric=0.7255 head_norm=1.877384 delta_norm=0.015656
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=75 head_norm_before_train=2.123914 cos_to_last_merge=0.9300 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.930
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.8967086813115785, 'auprc': 0.8664509863937009, 'loss_val': 0.3306802710122272, 'psi': 0.8846056033444275}-{'f1_val': 0.8989644094663598, 'auprc': 0.886447239648716, 'loss_val': 0.34115924624170635, 'psi': 0.8939575415393023}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=2.082489 cos_to_last_merge=0.9843 (last merge round=44)
[S3] round=75 local utility u=0.456537 metrics={'f1_val': 0.9449665374384939, 'auprc': 0.983295004872273, 'loss_val': 0.16825560787527055, 'psi': 0.9602979244120056}-{'f1_val': 0.841618203983645, 'auprc': 0.9802633146179853, 'loss_val': 0.4521452611744397, 'psi': 0.8970762482373811}
[S3] not sending this round → trigger blocked (psi=0.960)
[S4] START round=75 head_norm_before_train=2.261741 (no previous merge yet)
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.943087974070019, 'auprc': 0.9793639779665616, 'loss_val': 0.3262813283187678, 'psi': 0.957598375628636}-{'f1_val': 0.9545433316883717, 'auprc': 0.9862098070216604, 'loss_val': 0.29395445359763245, 'psi': 0.9672099218216872}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=1.780535 cos_to_last_merge=0.7914 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=75 local utility u=0.008384 metrics={'f1_val': 0.996186023309311, 'auprc': 0.997267635989352, 'loss_val': 0.03007118498929753, 'psi': 0.9966186683813274}-{'f1_val': 0.996186023309311, 'auprc': 0.991994258213972, 'loss_val': 0.031018316218816268, 'psi': 0.9945093172711754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=75 head_norm_before_train=2.163434 cos_to_last_merge=0.9668 (last merge round=44)
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.8283864000997492, 'auprc': 0.9342763384496208, 'loss_val': 0.4520017671946135, 'psi': 0.8707423754396978}-{'f1_val': 0.9498746246684584, 'auprc': 0.976404005551494, 'loss_val': 0.12706800647276537, 'psi': 0.9604863770216727}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=1.877384 cos_to_last_merge=1.0000 (last merge round=74)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.5855921761659572, 'auprc': 0.7938870106325708, 'loss_val': 0.9792636872394762, 'psi': 0.6689101099526027}-{'f1_val': 0.718462432576036, 'auprc': 0.9565249470459776, 'loss_val': 0.19284830762679425, 'psi': 0.8136874383640127}
[S8] START round=75 head_norm_before_train=1.923298 cos_to_last_merge=0.9928 (last merge round=45)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9913077019421868, 'auprc': 0.9978545538848579, 'loss_val': 0.03352826280216681, 'psi': 0.9939264427192552}-{'f1_val': 0.9913077019421868, 'auprc': 0.9989504980046161, 'loss_val': 0.03400008760970774, 'psi': 0.9943648203671585}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=2.018857 cos_to_last_merge=0.7646 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.765
[S9] round=75 local utility u=0.036441 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9975041201960618, 'loss_val': 0.018375242314238906, 'psi': 0.9969979551667596}-{'f1_val': 0.9886727075027679, 'auprc': 0.9985467745586248, 'loss_val': 0.046457634543953394, 'psi': 0.9926223343251107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=75 head_norm_before_train=2.132295 cos_to_last_merge=0.9950 (last merge round=41)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9971833859380197, 'loss_val': 0.02250351665800881, 'psi': 0.996184337456801}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972467609116595, 'loss_val': 0.02243762161162877, 'psi': 0.9962096874462569}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=1.897369 cos_to_last_merge=0.9921 (last merge round=41)
[S11] round=75 local utility u=0.043531 metrics={'f1_val': 0.8553683888960779, 'auprc': 0.9972154541719347, 'loss_val': 0.275452100229243, 'psi': 0.9121072150064206}-{'f1_val': 0.8473930998619847, 'auprc': 0.9966716134403614, 'loss_val': 0.3130318398186825, 'psi': 0.9071045052933354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=75 head_norm_before_train=1.809329 cos_to_last_merge=0.9450 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.7651932998268274, 'auprc': 0.7818835269429505, 'loss_val': 1.01706797919149, 'psi': 0.7718693906732766}-{'f1_val': 0.6995214144647335, 'auprc': 0.9413868357285897, 'loss_val': 0.9559000379059724, 'psi': 0.796267582970276}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=2.123729 cos_to_last_merge=0.9970 (last merge round=46)
[S14] round=75 local utility u=0.062939 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9974957383907981, 'loss_val': 0.018808801572262238, 'psi': 0.9976913509689747}-{'f1_val': 0.9810396865714109, 'auprc': 0.996856475000711, 'loss_val': 0.04207596486565956, 'psi': 0.987366401943131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=75 head_norm_before_train=1.983003 cos_to_last_merge=0.9820 (last merge round=42)
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.9884791995733125, 'auprc': 0.9976266982119277, 'loss_val': 0.03247645934941993, 'psi': 0.9921381990287587}-{'f1_val': 0.9934185961837458, 'auprc': 0.9974449383927013, 'loss_val': 0.02748727405452758, 'psi': 0.9950291330673281}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=1.887355 cos_to_last_merge=1.0000 (last merge round=72)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9932686743926713, 'auprc': 0.9923249704140448, 'loss_val': 0.0316777924630262, 'psi': 0.9928911928012207}-{'f1_val': 0.9937081501847713, 'auprc': 0.9917045736997825, 'loss_val': 0.030912768184022162, 'psi': 0.9929067195907758}
[S17] START round=75 head_norm_before_train=1.901703 cos_to_last_merge=0.9806 (last merge round=43)
[S17] round=75 local utility u=0.094335 metrics={'f1_val': 0.9042544573182975, 'auprc': 0.8930492369846221, 'loss_val': 0.5224815172991403, 'psi': 0.8997723691848273}-{'f1_val': 0.8899999159750693, 'auprc': 0.8726073081309589, 'loss_val': 0.5642985003959174, 'psi': 0.8830428728374251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=75 metric=0.9933 head_norm=1.898411
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.235293e-02
[S16] stored merged vector for next round verification (round=75)
[S16] DEBUG after merge:  round=75 metric=0.9933 head_norm=1.888324 delta_norm=0.022353
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.068 → S7@127.0.0.1:52808
[S7] ⇄ pheromone p=0.169 → S16@127.0.0.1:52816
[S2] START round=76 head_norm_before_train=2.122691 cos_to_last_merge=0.9289 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.8485988951793494, 'auprc': 0.8693421344884958, 'loss_val': 0.487022868624506, 'psi': 0.856896190903008}-{'f1_val': 0.8967086813115785, 'auprc': 0.8664509863937009, 'loss_val': 0.3306802710122272, 'psi': 0.8846056033444275}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=2.090168 cos_to_last_merge=0.9839 (last merge round=44)
[S3] round=76 local utility u=0.015252 metrics={'f1_val': 0.9435076665748189, 'auprc': 0.9902257993788026, 'loss_val': 0.14978999333920234, 'psi': 0.9621949196964124}-{'f1_val': 0.9449665374384939, 'auprc': 0.983295004872273, 'loss_val': 0.16825560787527055, 'psi': 0.9602979244120056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=76 head_norm_before_train=2.265652 (no previous merge yet)
[S4] round=76 local utility u=0.032855 metrics={'f1_val': 0.9493405025738754, 'auprc': 0.9850911396470506, 'loss_val': 0.3152677187303488, 'psi': 0.9636407574031455}-{'f1_val': 0.943087974070019, 'auprc': 0.9793639779665616, 'loss_val': 0.3262813283187678, 'psi': 0.957598375628636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=76 head_norm_before_train=1.786847 cos_to_last_merge=0.7910 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9916822163663658, 'loss_val': 0.03106584556463894, 'psi': 0.9942970160853787}-{'f1_val': 0.996186023309311, 'auprc': 0.997267635989352, 'loss_val': 0.03007118498929753, 'psi': 0.9966186683813274}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=2.175766 cos_to_last_merge=0.9660 (last merge round=44)
[S6] round=76 local utility u=0.121748 metrics={'f1_val': 0.854947059422745, 'auprc': 0.9416731968299925, 'loss_val': 0.39006034230905706, 'psi': 0.8896375143856439}-{'f1_val': 0.8283864000997492, 'auprc': 0.9342763384496208, 'loss_val': 0.4520017671946135, 'psi': 0.8707423754396978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=76 head_norm_before_train=1.879752 cos_to_last_merge=1.0000 (last merge round=74)
[S7] round=76 local utility u=1.000000 metrics={'f1_val': 0.8378064561426596, 'auprc': 0.9656496364813738, 'loss_val': 0.19159352355160345, 'psi': 0.8889437282781453}-{'f1_val': 0.5855921761659572, 'auprc': 0.7938870106325708, 'loss_val': 0.9792636872394762, 'psi': 0.6689101099526027}
[S8] START round=76 head_norm_before_train=1.932657 cos_to_last_merge=0.9924 (last merge round=45)
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.8571612902329762, 'auprc': 0.9993172615376285, 'loss_val': 0.396842207286887, 'psi': 0.914023678754837}-{'f1_val': 0.9913077019421868, 'auprc': 0.9978545538848579, 'loss_val': 0.03352826280216681, 'psi': 0.9939264427192552}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=76 head_norm_before_train=2.020117 cos_to_last_merge=0.7638 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.764
[S9] round=76 local utility u=0.003618 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998535072223352, 'loss_val': 0.018187690551810205, 'psi': 0.9979377099772689}-{'f1_val': 0.9966605118138915, 'auprc': 0.9975041201960618, 'loss_val': 0.018375242314238906, 'psi': 0.9969979551667596}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=76 head_norm_before_train=2.134628 cos_to_last_merge=0.9946 (last merge round=41)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972192186136923, 'loss_val': 0.02282036115431918, 'psi': 0.9961986705270701}-{'f1_val': 0.9955183051359886, 'auprc': 0.9971833859380197, 'loss_val': 0.02250351665800881, 'psi': 0.996184337456801}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=1.901058 cos_to_last_merge=0.9919 (last merge round=41)
[S11] round=76 local utility u=0.551359 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986603251316497, 'loss_val': 0.021783158356505693, 'psi': 0.9971566148991071}-{'f1_val': 0.8553683888960779, 'auprc': 0.9972154541719347, 'loss_val': 0.275452100229243, 'psi': 0.9121072150064206}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=76 head_norm_before_train=1.814433 cos_to_last_merge=0.9444 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.7122718445276364, 'auprc': 0.7444289137677883, 'loss_val': 1.165089008258926, 'psi': 0.7251346722236971}-{'f1_val': 0.7651932998268274, 'auprc': 0.7818835269429505, 'loss_val': 1.01706797919149, 'psi': 0.7718693906732766}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=2.128171 cos_to_last_merge=0.9969 (last merge round=46)
[S14] round=76 local utility u=0.000959 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9992010590759819, 'loss_val': 0.019541927311507855, 'psi': 0.9981270201910897}-{'f1_val': 0.9978217593544257, 'auprc': 0.9974957383907981, 'loss_val': 0.018808801572262238, 'psi': 0.9976913509689747}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=76 head_norm_before_train=1.992083 cos_to_last_merge=0.9815 (last merge round=42)
[S15] round=76 local utility u=0.008162 metrics={'f1_val': 0.9912253277178847, 'auprc': 0.9977534688364902, 'loss_val': 0.033010058334199954, 'psi': 0.9938365841653269}-{'f1_val': 0.9884791995733125, 'auprc': 0.9976266982119277, 'loss_val': 0.03247645934941993, 'psi': 0.9921381990287587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=76 head_norm_before_train=1.888324 cos_to_last_merge=1.0000 (last merge round=75)
[S16] round=76 local utility u=0.000092 metrics={'f1_val': 0.9932452069557044, 'auprc': 0.9937212378114156, 'loss_val': 0.03554172732945605, 'psi': 0.993435619297989}-{'f1_val': 0.9932686743926713, 'auprc': 0.9923249704140448, 'loss_val': 0.0316777924630262, 'psi': 0.9928911928012207}
[S17] START round=76 head_norm_before_train=1.911423 cos_to_last_merge=0.9798 (last merge round=43)
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.7460001969730178, 'auprc': 0.9493208244987935, 'loss_val': 0.9368575386451984, 'psi': 0.827328447983328}-{'f1_val': 0.9042544573182975, 'auprc': 0.8930492369846221, 'loss_val': 0.5224815172991403, 'psi': 0.8997723691848273}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:52816
[S16] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=76 metric=0.9932 head_norm=1.896445
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.239907e-02
[S16] stored merged vector for next round verification (round=76)
[S16] DEBUG after merge:  round=76 metric=0.9932 head_norm=1.889035 delta_norm=0.012399
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=76 metric=0.8378 head_norm=1.881678
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.239906e-02
[S7] stored merged vector for next round verification (round=76)
[S7] DEBUG after merge:  round=76 metric=0.8477 head_norm=1.889035 delta_norm=0.012399
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=77 head_norm_before_train=2.125992 cos_to_last_merge=0.9282 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=77 local utility u=0.442647 metrics={'f1_val': 0.9094965731937293, 'auprc': 0.9756438910927938, 'loss_val': 0.2860197332254311, 'psi': 0.9359555003533552}-{'f1_val': 0.8485988951793494, 'auprc': 0.8693421344884958, 'loss_val': 0.487022868624506, 'psi': 0.856896190903008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=77 head_norm_before_train=2.097422 cos_to_last_merge=0.9835 (last merge round=44)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.8820369659867084, 'auprc': 0.9786994130254675, 'loss_val': 0.27366293572535755, 'psi': 0.920701944802212}-{'f1_val': 0.9435076665748189, 'auprc': 0.9902257993788026, 'loss_val': 0.14978999333920234, 'psi': 0.9621949196964124}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=2.266732 (no previous merge yet)
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9470223031079347, 'auprc': 0.985033815659304, 'loss_val': 0.3134018892562773, 'psi': 0.9622269081284824}-{'f1_val': 0.9493405025738754, 'auprc': 0.9850911396470506, 'loss_val': 0.3152677187303488, 'psi': 0.9636407574031455}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.794828 cos_to_last_merge=0.7901 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=77 local utility u=0.008318 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9963117678065769, 'loss_val': 0.029193649725105502, 'psi': 0.9962363211082174}-{'f1_val': 0.9960402158980539, 'auprc': 0.9916822163663658, 'loss_val': 0.03106584556463894, 'psi': 0.9942970160853787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=77 head_norm_before_train=2.188428 cos_to_last_merge=0.9652 (last merge round=44)
[S6] round=77 local utility u=0.591603 metrics={'f1_val': 0.9802491271918491, 'auprc': 0.9805279218610415, 'loss_val': 0.07523133210744704, 'psi': 0.980360645059526}-{'f1_val': 0.854947059422745, 'auprc': 0.9416731968299925, 'loss_val': 0.39006034230905706, 'psi': 0.8896375143856439}
[S6] not sending this round → trigger blocked (psi=0.980)
[S7] START round=77 head_norm_before_train=1.889035 cos_to_last_merge=1.0000 (last merge round=76)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.5969762947769763, 'auprc': 0.7917099880263172, 'loss_val': 0.8980814458676143, 'psi': 0.6748697720767127}-{'f1_val': 0.8378064561426596, 'auprc': 0.9656496364813738, 'loss_val': 0.19159352355160345, 'psi': 0.8889437282781453}
[S8] START round=77 head_norm_before_train=1.940711 cos_to_last_merge=0.9921 (last merge round=45)
[S8] round=77 local utility u=0.566512 metrics={'f1_val': 0.9873762633865157, 'auprc': 0.9981160044535219, 'loss_val': 0.041504348588436386, 'psi': 0.9916721598133182}-{'f1_val': 0.8571612902329762, 'auprc': 0.9993172615376285, 'loss_val': 0.396842207286887, 'psi': 0.914023678754837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=77 head_norm_before_train=2.023209 cos_to_last_merge=0.7634 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.763
[S9] round=77 local utility u=0.000278 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9998577093701972, 'loss_val': 0.017624286304629637, 'psi': 0.9979372909277255}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998535072223352, 'loss_val': 0.018187690551810205, 'psi': 0.9979377099772689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=77 head_norm_before_train=2.139582 cos_to_last_merge=0.9944 (last merge round=41)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9970863113380531, 'loss_val': 0.02272439449909714, 'psi': 0.9961455076168144}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972192186136923, 'loss_val': 0.02282036115431918, 'psi': 0.9961986705270701}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=1.905885 cos_to_last_merge=0.9917 (last merge round=41)
[S11] round=77 local utility u=0.000964 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982793871374427, 'loss_val': 0.021069730574266164, 'psi': 0.9972399575631308}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986603251316497, 'loss_val': 0.021783158356505693, 'psi': 0.9971566148991071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=77 head_norm_before_train=1.814484 cos_to_last_merge=0.9442 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6482544398521011, 'auprc': 0.7337169933978905, 'loss_val': 1.1480395882921492, 'psi': 0.6824394612704169}-{'f1_val': 0.7122718445276364, 'auprc': 0.7444289137677883, 'loss_val': 1.165089008258926, 'psi': 0.7251346722236971}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=2.132611 cos_to_last_merge=0.9967 (last merge round=46)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9991995059882062, 'loss_val': 0.01929663674831054, 'psi': 0.9979942753553748}-{'f1_val': 0.9974109942678281, 'auprc': 0.9992010590759819, 'loss_val': 0.019541927311507855, 'psi': 0.9981270201910897}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=2.000963 cos_to_last_merge=0.9810 (last merge round=42)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.9392067176543445, 'auprc': 0.9949790645658615, 'loss_val': 0.1246799926176214, 'psi': 0.9615156564189513}-{'f1_val': 0.9912253277178847, 'auprc': 0.9977534688364902, 'loss_val': 0.033010058334199954, 'psi': 0.9938365841653269}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=1.889035 cos_to_last_merge=1.0000 (last merge round=76)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9921712928326671, 'auprc': 0.9945287817221388, 'loss_val': 0.037558192651399196, 'psi': 0.9931142883884557}-{'f1_val': 0.9932452069557044, 'auprc': 0.9937212378114156, 'loss_val': 0.03554172732945605, 'psi': 0.993435619297989}
[S17] START round=77 head_norm_before_train=1.918744 cos_to_last_merge=0.9793 (last merge round=43)
[S17] round=77 local utility u=0.574909 metrics={'f1_val': 0.9093482353718547, 'auprc': 0.8574682237235108, 'loss_val': 0.49156976759979526, 'psi': 0.8885962307125171}-{'f1_val': 0.7460001969730178, 'auprc': 0.9493208244987935, 'loss_val': 0.9368575386451984, 'psi': 0.827328447983328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.136800 cos_to_last_merge=0.9278 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.8215915515265392, 'auprc': 0.9262445789341948, 'loss_val': 0.46101285856999374, 'psi': 0.8634527624896013}-{'f1_val': 0.9094965731937293, 'auprc': 0.9756438910927938, 'loss_val': 0.2860197332254311, 'psi': 0.9359555003533552}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.104390 cos_to_last_merge=0.9831 (last merge round=44)
[S3] round=78 local utility u=0.351776 metrics={'f1_val': 0.9599062073394293, 'auprc': 0.996331087135564, 'loss_val': 0.09022139590375208, 'psi': 0.9744761592578832}-{'f1_val': 0.8820369659867084, 'auprc': 0.9786994130254675, 'loss_val': 0.27366293572535755, 'psi': 0.920701944802212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=78 head_norm_before_train=2.267486 (no previous merge yet)
[S4] round=78 local utility u=0.028009 metrics={'f1_val': 0.954259215362039, 'auprc': 0.9858334827957174, 'loss_val': 0.303204465853974, 'psi': 0.9668889223355103}-{'f1_val': 0.9470223031079347, 'auprc': 0.985033815659304, 'loss_val': 0.3134018892562773, 'psi': 0.9622269081284824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=78 head_norm_before_train=1.805332 cos_to_last_merge=0.7888 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9917183210885808, 'loss_val': 0.029685050959083654, 'psi': 0.9943989424210189}-{'f1_val': 0.996186023309311, 'auprc': 0.9963117678065769, 'loss_val': 0.029193649725105502, 'psi': 0.9962363211082174}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=2.199509 cos_to_last_merge=0.9644 (last merge round=44)
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.6801853000060031, 'auprc': 0.8421845995250132, 'loss_val': 1.2719658761664867, 'psi': 0.7449850198136072}-{'f1_val': 0.9802491271918491, 'auprc': 0.9805279218610415, 'loss_val': 0.07523133210744704, 'psi': 0.980360645059526}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=78 head_norm_before_train=1.890082 cos_to_last_merge=1.0000 (last merge round=76)
[S7] round=78 local utility u=0.260470 metrics={'f1_val': 0.633345829607646, 'auprc': 0.7979069617691873, 'loss_val': 0.6139504309459152, 'psi': 0.6991702824722625}-{'f1_val': 0.5969762947769763, 'auprc': 0.7917099880263172, 'loss_val': 0.8980814458676143, 'psi': 0.6748697720767127}
[S8] START round=78 head_norm_before_train=1.949020 cos_to_last_merge=0.9918 (last merge round=45)
[S8] round=78 local utility u=0.016832 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9961410336254705, 'loss_val': 0.03242451024910781, 'psi': 0.9939331202665653}-{'f1_val': 0.9873762633865157, 'auprc': 0.9981160044535219, 'loss_val': 0.041504348588436386, 'psi': 0.9916721598133182}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=78 head_norm_before_train=2.028178 cos_to_last_merge=0.7630 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.763
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9998596485635034, 'loss_val': 0.018133522940041707, 'psi': 0.997689128110792}-{'f1_val': 0.9966570119660778, 'auprc': 0.9998577093701972, 'loss_val': 0.017624286304629637, 'psi': 0.9979372909277255}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=2.140842 cos_to_last_merge=0.9939 (last merge round=41)
[S10] round=78 local utility u=0.000078 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9971860827134992, 'loss_val': 0.022868682951356217, 'psi': 0.9961854161669929}-{'f1_val': 0.9955183051359886, 'auprc': 0.9970863113380531, 'loss_val': 0.02272439449909714, 'psi': 0.9961455076168144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=78 head_norm_before_train=1.911287 cos_to_last_merge=0.9915 (last merge round=41)
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9987762335419288, 'loss_val': 0.021325040583860814, 'psi': 0.9971906983647572}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982793871374427, 'loss_val': 0.021069730574266164, 'psi': 0.9972399575631308}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.813799 cos_to_last_merge=0.9439 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=78 local utility u=0.165099 metrics={'f1_val': 0.7121275179628395, 'auprc': 0.7327239448437923, 'loss_val': 1.198100350745506, 'psi': 0.7203660887152206}-{'f1_val': 0.6482544398521011, 'auprc': 0.7337169933978905, 'loss_val': 1.1480395882921492, 'psi': 0.6824394612704169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=78 head_norm_before_train=2.138720 cos_to_last_merge=0.9966 (last merge round=46)
[S14] round=78 local utility u=0.001010 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991931246308163, 'loss_val': 0.018577805305658505, 'psi': 0.9981238464130234}-{'f1_val': 0.9971907882668205, 'auprc': 0.9991995059882062, 'loss_val': 0.01929663674831054, 'psi': 0.9979942753553748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=78 head_norm_before_train=2.009353 cos_to_last_merge=0.9805 (last merge round=42)
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.7444654474264729, 'auprc': 0.9191981037209259, 'loss_val': 0.6801667687873701, 'psi': 0.8143585099442541}-{'f1_val': 0.9392067176543445, 'auprc': 0.9949790645658615, 'loss_val': 0.1246799926176214, 'psi': 0.9615156564189513}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=1.896479 cos_to_last_merge=1.0000 (last merge round=76)
[S16] round=78 local utility u=0.001041 metrics={'f1_val': 0.9919520384634068, 'auprc': 0.9958974388183341, 'loss_val': 0.03826584707464775, 'psi': 0.9935301986053777}-{'f1_val': 0.9921712928326671, 'auprc': 0.9945287817221388, 'loss_val': 0.037558192651399196, 'psi': 0.9931142883884557}
[S17] START round=78 head_norm_before_train=1.924397 cos_to_last_merge=0.9788 (last merge round=43)
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.6901483031891261, 'auprc': 0.8590710303161603, 'loss_val': 0.9018675237768083, 'psi': 0.7577173940399398}-{'f1_val': 0.9093482353718547, 'auprc': 0.8574682237235108, 'loss_val': 0.49156976759979526, 'psi': 0.8885962307125171}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.9999
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=78 metric=0.9920 head_norm=1.904289
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.426147e-02
[S16] stored merged vector for next round verification (round=78)
[S16] DEBUG after merge:  round=78 metric=0.9920 head_norm=1.898960 delta_norm=0.014261
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=79 head_norm_before_train=2.148746 cos_to_last_merge=0.9273 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.927
[S2] round=79 local utility u=0.169367 metrics={'f1_val': 0.8280426722680424, 'auprc': 0.986282905457279, 'loss_val': 0.3411010070205797, 'psi': 0.891338765543737}-{'f1_val': 0.8215915515265392, 'auprc': 0.9262445789341948, 'loss_val': 0.46101285856999374, 'psi': 0.8634527624896013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S2] r=80 psi=0.891 u=0.1694 p_local=0.1519 f1=0.828 auprc=0.986 bytes=68404
[S3] START round=79 head_norm_before_train=2.111564 cos_to_last_merge=0.9827 (last merge round=44)
[S3] round=79 local utility u=0.061588 metrics={'f1_val': 0.9750365715380557, 'auprc': 0.9982898393955184, 'loss_val': 0.06370474465119537, 'psi': 0.9843378786810408}-{'f1_val': 0.9599062073394293, 'auprc': 0.996331087135564, 'loss_val': 0.09022139590375208, 'psi': 0.9744761592578832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S3] r=80 psi=0.984 u=0.0616 p_local=0.1476 f1=0.975 auprc=0.998 bytes=62948
[S4] START round=79 head_norm_before_train=2.272888 (no previous merge yet)
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9519222967326555, 'auprc': 0.9859998294888002, 'loss_val': 0.292422887811822, 'psi': 0.9655533098351134}-{'f1_val': 0.954259215362039, 'auprc': 0.9858334827957174, 'loss_val': 0.303204465853974, 'psi': 0.9668889223355103}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.966 u=0.0000 p_local=0.0166 f1=0.952 auprc=0.986 bytes=59364
[S5] START round=79 head_norm_before_train=1.809578 cos_to_last_merge=0.7883 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=79 local utility u=0.005851 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9952061374676788, 'loss_val': 0.028447329907043212, 'psi': 0.9957940689726581}-{'f1_val': 0.996186023309311, 'auprc': 0.9917183210885808, 'loss_val': 0.029685050959083654, 'psi': 0.9943989424210189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=80 psi=0.996 u=0.0059 p_local=0.0303 f1=0.996 auprc=0.995 bytes=66568
[S6] START round=79 head_norm_before_train=2.210564 cos_to_last_merge=0.9638 (last merge round=44)
[S6] round=79 local utility u=1.000000 metrics={'f1_val': 0.8405318096149818, 'auprc': 0.901982577316655, 'loss_val': 0.3909555242830776, 'psi': 0.865112116695651}-{'f1_val': 0.6801853000060031, 'auprc': 0.8421845995250132, 'loss_val': 1.2719658761664867, 'psi': 0.7449850198136072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S6] r=80 psi=0.865 u=1.0000 p_local=0.4130 f1=0.841 auprc=0.902 bytes=61184
[S7] START round=79 head_norm_before_train=1.893722 cos_to_last_merge=1.0000 (last merge round=76)
[S7] round=79 local utility u=0.346411 metrics={'f1_val': 0.683971657188873, 'auprc': 0.8343561582939925, 'loss_val': 0.33423148501167826, 'psi': 0.7441254576309208}-{'f1_val': 0.633345829607646, 'auprc': 0.7979069617691873, 'loss_val': 0.6139504309459152, 'psi': 0.6991702824722625}
[S8] START round=79 head_norm_before_train=1.953995 cos_to_last_merge=0.9916 (last merge round=45)
[S8] round=79 local utility u=0.001740 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9931061956687761, 'loss_val': 0.028546589277643933, 'psi': 0.9935898431345185}-{'f1_val': 0.9924611780272952, 'auprc': 0.9961410336254705, 'loss_val': 0.03242451024910781, 'psi': 0.9939331202665653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S8] r=80 psi=0.994 u=0.0017 p_local=0.0874 f1=0.994 auprc=0.993 bytes=61207
[S9] START round=79 head_norm_before_train=2.034033 cos_to_last_merge=0.7625 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.763
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9905410059937811, 'auprc': 0.9998519903952674, 'loss_val': 0.03211865153616204, 'psi': 0.9942653997543757}-{'f1_val': 0.9962421144756511, 'auprc': 0.9998596485635034, 'loss_val': 0.018133522940041707, 'psi': 0.997689128110792}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.994 u=0.0000 p_local=0.0050 f1=0.991 auprc=1.000 bytes=61181
[S10] START round=79 head_norm_before_train=2.145180 cos_to_last_merge=0.9937 (last merge round=41)
[S10] round=79 local utility u=0.000031 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.997175005844969, 'loss_val': 0.022773653761382486, 'psi': 0.9961809854195808}-{'f1_val': 0.9955183051359886, 'auprc': 0.9971860827134992, 'loss_val': 0.022868682951356217, 'psi': 0.9961854161669929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=80 psi=0.996 u=0.0000 p_local=0.0001 f1=0.996 auprc=0.997 bytes=68426
[S11] START round=79 head_norm_before_train=1.915335 cos_to_last_merge=0.9913 (last merge round=41)
[S11] round=79 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986996971400972, 'loss_val': 0.021626558567432612, 'psi': 0.9971723637024861}-{'f1_val': 0.9961336749133093, 'auprc': 0.9987762335419288, 'loss_val': 0.021325040583860814, 'psi': 0.9971906983647572}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=80 psi=0.997 u=0.0000 p_local=0.0663 f1=0.996 auprc=0.999 bytes=68330
[S13] START round=79 head_norm_before_train=1.818875 cos_to_last_merge=0.9432 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=79 local utility u=0.552462 metrics={'f1_val': 0.7906796062513577, 'auprc': 0.8225689056467298, 'loss_val': 0.8340238465924019, 'psi': 0.8034353260095066}-{'f1_val': 0.7121275179628395, 'auprc': 0.7327239448437923, 'loss_val': 1.198100350745506, 'psi': 0.7203660887152206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] r=80 psi=0.803 u=0.5525 p_local=0.1922 f1=0.791 auprc=0.823 bytes=52226
[S14] START round=79 head_norm_before_train=2.145441 cos_to_last_merge=0.9965 (last merge round=46)
[S14] round=79 local utility u=0.000326 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991744137240874, 'loss_val': 0.017870200333956268, 'psi': 0.9981163620503319}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991931246308163, 'loss_val': 0.018577805305658505, 'psi': 0.9981238464130234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] r=80 psi=0.998 u=0.0003 p_local=0.0079 f1=0.997 auprc=0.999 bytes=62931
[S15] START round=79 head_norm_before_train=2.017618 cos_to_last_merge=0.9801 (last merge round=42)
[S15] round=79 local utility u=0.144841 metrics={'f1_val': 0.772993676462178, 'auprc': 0.9395804984277645, 'loss_val': 0.6228011417541286, 'psi': 0.8396284052484125}-{'f1_val': 0.7444654474264729, 'auprc': 0.9191981037209259, 'loss_val': 0.6801667687873701, 'psi': 0.8143585099442541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S15] r=80 psi=0.840 u=0.1448 p_local=0.1400 f1=0.773 auprc=0.940 bytes=59416
[S16] START round=79 head_norm_before_train=1.898960 cos_to_last_merge=1.0000 (last merge round=78)
[S16] round=79 local utility u=0.005348 metrics={'f1_val': 0.9932686743926713, 'auprc': 0.9944979334593502, 'loss_val': 0.0312702967230821, 'psi': 0.9937603780193429}-{'f1_val': 0.9919520384634068, 'auprc': 0.9958974388183341, 'loss_val': 0.03826584707464775, 'psi': 0.9935301986053777}
[S17] START round=79 head_norm_before_train=1.932584 cos_to_last_merge=0.9781 (last merge round=43)
[S17] round=79 local utility u=0.703612 metrics={'f1_val': 0.88037477639383, 'auprc': 0.8377383139773609, 'loss_val': 0.5720043965771618, 'psi': 0.8633201914272424}-{'f1_val': 0.6901483031891261, 'auprc': 0.8590710303161603, 'loss_val': 0.9018675237768083, 'psi': 0.7577173940399398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S17] r=80 psi=0.863 u=0.7036 p_local=0.2840 f1=0.880 auprc=0.838 bytes=64861
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=79 metric=0.6840 head_norm=1.899469
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.292586e-02
[S7] stored merged vector for next round verification (round=79)
[S7] DEBUG after merge:  round=79 metric=0.6839 head_norm=1.901651 delta_norm=0.012926
[S7] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] r=80 psi=0.744 u=0.3464 p_local=0.2826 f1=0.684 auprc=0.834 bytes=70144
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=79 metric=0.9933 head_norm=1.903592
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.221638e-02
[S16] stored merged vector for next round verification (round=79)
[S16] DEBUG after merge:  round=79 metric=0.9933 head_norm=1.901492 delta_norm=0.012216
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] r=80 psi=0.994 u=0.0053 p_local=0.0290 f1=0.993 auprc=0.994 bytes=62968
[S2] START round=80 head_norm_before_train=2.153177 cos_to_last_merge=0.9266 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.927
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.7193835274599882, 'auprc': 0.9189076222892971, 'loss_val': 0.5112297297231115, 'psi': 0.7991931653917118}-{'f1_val': 0.8280426722680424, 'auprc': 0.986282905457279, 'loss_val': 0.3411010070205797, 'psi': 0.891338765543737}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=80 head_norm_before_train=2.118768 cos_to_last_merge=0.9824 (last merge round=44)
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.9745957511059637, 'auprc': 0.9981987418981464, 'loss_val': 0.06501777359168898, 'psi': 0.9840369474228368}-{'f1_val': 0.9750365715380557, 'auprc': 0.9982898393955184, 'loss_val': 0.06370474465119537, 'psi': 0.9843378786810408}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=2.279473 (no previous merge yet)
[S4] round=80 local utility u=0.006356 metrics={'f1_val': 0.9509544178362448, 'auprc': 0.9865877591454509, 'loss_val': 0.27566766507355833, 'psi': 0.9652077543599273}-{'f1_val': 0.9519222967326555, 'auprc': 0.9859998294888002, 'loss_val': 0.292422887811822, 'psi': 0.9655533098351134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=80 head_norm_before_train=1.818292 cos_to_last_merge=0.7874 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=80 local utility u=0.003987 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9978008313403819, 'loss_val': 0.02825729294894952, 'psi': 0.9968319465217393}-{'f1_val': 0.996186023309311, 'auprc': 0.9952061374676788, 'loss_val': 0.028447329907043212, 'psi': 0.9957940689726581}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=80 head_norm_before_train=2.219160 cos_to_last_merge=0.9632 (last merge round=44)
[S6] round=80 local utility u=0.686311 metrics={'f1_val': 0.9794100335306807, 'auprc': 0.9814694061450078, 'loss_val': 0.09006386559039284, 'psi': 0.9802337825764116}-{'f1_val': 0.8405318096149818, 'auprc': 0.901982577316655, 'loss_val': 0.3909555242830776, 'psi': 0.865112116695651}
[S6] not sending this round → trigger blocked (psi=0.980)
[S7] START round=80 head_norm_before_train=1.901651 cos_to_last_merge=1.0000 (last merge round=79)
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.6249328283527169, 'auprc': 0.7969783312165577, 'loss_val': 0.6834833287700718, 'psi': 0.6937510294982532}-{'f1_val': 0.683971657188873, 'auprc': 0.8343561582939925, 'loss_val': 0.33423148501167826, 'psi': 0.7441254576309208}
[S8] START round=80 head_norm_before_train=1.961278 cos_to_last_merge=0.9913 (last merge round=45)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.897742263475501, 'auprc': 0.999408256728058, 'loss_val': 0.24499674262646617, 'psi': 0.9384086607765239}-{'f1_val': 0.9939122747783468, 'auprc': 0.9931061956687761, 'loss_val': 0.028546589277643933, 'psi': 0.9935898431345185}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.036921 cos_to_last_merge=0.7620 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.762
[S9] round=80 local utility u=0.021955 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.999852711280108, 'loss_val': 0.019924842149672398, 'psi': 0.9974371155305545}-{'f1_val': 0.9905410059937811, 'auprc': 0.9998519903952674, 'loss_val': 0.03211865153616204, 'psi': 0.9942653997543757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=80 head_norm_before_train=2.147417 cos_to_last_merge=0.9932 (last merge round=41)
[S10] round=80 local utility u=0.000161 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972120426006639, 'loss_val': 0.022561894579370852, 'psi': 0.9961958001218587}-{'f1_val': 0.9955183051359886, 'auprc': 0.997175005844969, 'loss_val': 0.022773653761382486, 'psi': 0.9961809854195808}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=80 head_norm_before_train=1.918730 cos_to_last_merge=0.9912 (last merge round=41)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986710553906226, 'loss_val': 0.021738917898253243, 'psi': 0.9971609070026963}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986996971400972, 'loss_val': 0.021626558567432612, 'psi': 0.9971723637024861}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.820650 cos_to_last_merge=0.9427 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.6629511113807565, 'auprc': 0.8365177997439498, 'loss_val': 1.2438810136501535, 'psi': 0.7323777867260338}-{'f1_val': 0.7906796062513577, 'auprc': 0.8225689056467298, 'loss_val': 0.8340238465924019, 'psi': 0.8034353260095066}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=2.149795 cos_to_last_merge=0.9963 (last merge round=46)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9968701823912187, 'loss_val': 0.019820985475453322, 'psi': 0.9972939978344383}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991744137240874, 'loss_val': 0.017870200333956268, 'psi': 0.9981163620503319}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=2.025692 cos_to_last_merge=0.9796 (last merge round=42)
[S15] round=80 local utility u=0.732833 metrics={'f1_val': 0.9192278940482226, 'auprc': 0.9964832590469134, 'loss_val': 0.2052496545690938, 'psi': 0.9501300400476989}-{'f1_val': 0.772993676462178, 'auprc': 0.9395804984277645, 'loss_val': 0.6228011417541286, 'psi': 0.8396284052484125}
[S15] not sending this round → trigger blocked (psi=0.950)
[S16] START round=80 head_norm_before_train=1.901492 cos_to_last_merge=1.0000 (last merge round=79)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.9936846582767345, 'auprc': 0.9924516396584295, 'loss_val': 0.030344304847285546, 'psi': 0.9931914508294125}-{'f1_val': 0.9932686743926713, 'auprc': 0.9944979334593502, 'loss_val': 0.0312702967230821, 'psi': 0.9937603780193429}
[S17] START round=80 head_norm_before_train=1.939154 cos_to_last_merge=0.9777 (last merge round=43)
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.4464492062810808, 'auprc': 0.7841198934760623, 'loss_val': 2.39879439196182, 'psi': 0.5815174811590734}-{'f1_val': 0.88037477639383, 'auprc': 0.8377383139773609, 'loss_val': 0.5720043965771618, 'psi': 0.8633201914272424}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.226 → S16@127.0.0.1:52816
[S16] ⇄ pheromone p=0.023 → S7@127.0.0.1:52808
[S2] START round=81 head_norm_before_train=2.160749 cos_to_last_merge=0.9262 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=81 local utility u=0.476742 metrics={'f1_val': 0.8326384310141379, 'auprc': 0.9535346090550243, 'loss_val': 0.34115639429466277, 'psi': 0.8809969022304924}-{'f1_val': 0.7193835274599882, 'auprc': 0.9189076222892971, 'loss_val': 0.5112297297231115, 'psi': 0.7991931653917118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=81 head_norm_before_train=2.125773 cos_to_last_merge=0.9820 (last merge round=44)
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.6717529993534812, 'auprc': 0.8744357789910718, 'loss_val': 1.18578071011107, 'psi': 0.7528261112085175}-{'f1_val': 0.9745957511059637, 'auprc': 0.9981987418981464, 'loss_val': 0.06501777359168898, 'psi': 0.9840369474228368}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=2.285877 (no previous merge yet)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9530417770850517, 'auprc': 0.9861244172556054, 'loss_val': 0.2923207213560587, 'psi': 0.9662748331532732}-{'f1_val': 0.9509544178362448, 'auprc': 0.9865877591454509, 'loss_val': 0.27566766507355833, 'psi': 0.9652077543599273}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.822358 cos_to_last_merge=0.7873 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9915729425627229, 'loss_val': 0.033517549107515206, 'psi': 0.9943407910106757}-{'f1_val': 0.996186023309311, 'auprc': 0.9978008313403819, 'loss_val': 0.02825729294894952, 'psi': 0.9968319465217393}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=2.226125 cos_to_last_merge=0.9627 (last merge round=44)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.7265159727423878, 'auprc': 0.8449356142306375, 'loss_val': 1.0975905109835098, 'psi': 0.7738838293376876}-{'f1_val': 0.9794100335306807, 'auprc': 0.9814694061450078, 'loss_val': 0.09006386559039284, 'psi': 0.9802337825764116}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.905636 cos_to_last_merge=1.0000 (last merge round=79)
[S7] round=81 local utility u=0.282360 metrics={'f1_val': 0.6672094424063775, 'auprc': 0.8125129457571663, 'loss_val': 0.41902667079414135, 'psi': 0.725330843746693}-{'f1_val': 0.6249328283527169, 'auprc': 0.7969783312165577, 'loss_val': 0.6834833287700718, 'psi': 0.6937510294982532}
[S8] START round=81 head_norm_before_train=1.966824 cos_to_last_merge=0.9910 (last merge round=45)
[S8] round=81 local utility u=0.388216 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9948755655973959, 'loss_val': 0.029357527001547923, 'psi': 0.9940347214166867}-{'f1_val': 0.897742263475501, 'auprc': 0.999408256728058, 'loss_val': 0.24499674262646617, 'psi': 0.9384086607765239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=81 head_norm_before_train=2.039065 cos_to_last_merge=0.7615 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.762
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.99742494164983, 'loss_val': 0.018651623255021656, 'psi': 0.9969662837482669}-{'f1_val': 0.9958267183641853, 'auprc': 0.999852711280108, 'loss_val': 0.019924842149672398, 'psi': 0.9974371155305545}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=81 head_norm_before_train=2.153582 cos_to_last_merge=0.9932 (last merge round=41)
[S10] round=81 local utility u=0.000017 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972696148646142, 'loss_val': 0.022701216679233856, 'psi': 0.9962188290274389}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972120426006639, 'loss_val': 0.022561894579370852, 'psi': 0.9961958001218587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=81 head_norm_before_train=1.923210 cos_to_last_merge=0.9910 (last merge round=41)
[S11] round=81 local utility u=0.000023 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986608404430694, 'loss_val': 0.021662066359338088, 'psi': 0.997156821023675}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986710553906226, 'loss_val': 0.021738917898253243, 'psi': 0.9971609070026963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=81 head_norm_before_train=1.825613 cos_to_last_merge=0.9420 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=81 local utility u=0.933031 metrics={'f1_val': 0.8304320907178634, 'auprc': 0.900244506451119, 'loss_val': 0.5738842903663492, 'psi': 0.8583570570111656}-{'f1_val': 0.6629511113807565, 'auprc': 0.8365177997439498, 'loss_val': 1.2438810136501535, 'psi': 0.7323777867260338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=81 head_norm_before_train=2.150588 cos_to_last_merge=0.9962 (last merge round=46)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9624544588945039, 'auprc': 0.9991482053011896, 'loss_val': 0.05249104897541666, 'psi': 0.9771319574571782}-{'f1_val': 0.9975765414632514, 'auprc': 0.9968701823912187, 'loss_val': 0.019820985475453322, 'psi': 0.9972939978344383}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=2.033270 cos_to_last_merge=0.9792 (last merge round=42)
[S15] round=81 local utility u=0.109100 metrics={'f1_val': 0.9442365324563569, 'auprc': 0.9980847228806876, 'loss_val': 0.14190515628130057, 'psi': 0.9657758086260891}-{'f1_val': 0.9192278940482226, 'auprc': 0.9964832590469134, 'loss_val': 0.2052496545690938, 'psi': 0.9501300400476989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=81 head_norm_before_train=1.909876 cos_to_last_merge=1.0000 (last merge round=79)
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.9936846582767345, 'auprc': 0.9918374583380798, 'loss_val': 0.03052167535839982, 'psi': 0.9929457783012726}-{'f1_val': 0.9936846582767345, 'auprc': 0.9924516396584295, 'loss_val': 0.030344304847285546, 'psi': 0.9931914508294125}
[S17] START round=81 head_norm_before_train=1.944969 cos_to_last_merge=0.9772 (last merge round=43)
[S17] round=81 local utility u=0.724774 metrics={'f1_val': 0.6122991065259362, 'auprc': 0.7529485348746385, 'loss_val': 1.85083158790072, 'psi': 0.6685588778654171}-{'f1_val': 0.4464492062810808, 'auprc': 0.7841198934760623, 'loss_val': 2.39879439196182, 'psi': 0.5815174811590734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=0.9999
[S2] START round=82 head_norm_before_train=2.165052 cos_to_last_merge=0.9265 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.8305337047555752, 'auprc': 0.9429977887757142, 'loss_val': 0.39388266221868495, 'psi': 0.8755193383636308}-{'f1_val': 0.8326384310141379, 'auprc': 0.9535346090550243, 'loss_val': 0.34115639429466277, 'psi': 0.8809969022304924}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=2.131953 cos_to_last_merge=0.9817 (last merge round=44)
[S3] round=82 local utility u=0.988179 metrics={'f1_val': 0.8233632786049274, 'auprc': 0.9881706201200309, 'loss_val': 0.46028803530383405, 'psi': 0.8892862152109688}-{'f1_val': 0.6717529993534812, 'auprc': 0.8744357789910718, 'loss_val': 1.18578071011107, 'psi': 0.7528261112085175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=82 head_norm_before_train=2.293312 (no previous merge yet)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9525303047468594, 'auprc': 0.9863712065682574, 'loss_val': 0.2907411675874188, 'psi': 0.9660666654754186}-{'f1_val': 0.9530417770850517, 'auprc': 0.9861244172556054, 'loss_val': 0.2923207213560587, 'psi': 0.9662748331532732}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=1.824304 cos_to_last_merge=0.7879 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=82 local utility u=0.012798 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9979898889024106, 'loss_val': 0.028051731071739933, 'psi': 0.9969955101542585}-{'f1_val': 0.996186023309311, 'auprc': 0.9915729425627229, 'loss_val': 0.033517549107515206, 'psi': 0.9943407910106757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=82 head_norm_before_train=2.235036 cos_to_last_merge=0.9621 (last merge round=44)
[S6] round=82 local utility u=0.183975 metrics={'f1_val': 0.7349461933700686, 'auprc': 0.900214737497449, 'loss_val': 0.9460584534779269, 'psi': 0.8010536110210207}-{'f1_val': 0.7265159727423878, 'auprc': 0.8449356142306375, 'loss_val': 1.0975905109835098, 'psi': 0.7738838293376876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=82 head_norm_before_train=1.909827 cos_to_last_merge=1.0000 (last merge round=79)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.6151209547168406, 'auprc': 0.7961008658620498, 'loss_val': 0.7402816445516759, 'psi': 0.6875129191749243}-{'f1_val': 0.6672094424063775, 'auprc': 0.8125129457571663, 'loss_val': 0.41902667079414135, 'psi': 0.725330843746693}
[S8] START round=82 head_norm_before_train=1.974280 cos_to_last_merge=0.9907 (last merge round=45)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9150014743396108, 'auprc': 0.9993777149865363, 'loss_val': 0.18211492719240752, 'psi': 0.9487519705983809}-{'f1_val': 0.9934741586295472, 'auprc': 0.9948755655973959, 'loss_val': 0.029357527001547923, 'psi': 0.9940347214166867}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=2.042663 cos_to_last_merge=0.7611 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.761
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9926462894722031, 'auprc': 0.9996963879512839, 'loss_val': 0.02577226733084103, 'psi': 0.9954663288638355}-{'f1_val': 0.9966605118138915, 'auprc': 0.99742494164983, 'loss_val': 0.018651623255021656, 'psi': 0.9969662837482669}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.160951 cos_to_last_merge=0.9933 (last merge round=41)
[S10] round=82 local utility u=0.000095 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972531686508287, 'loss_val': 0.02246176410018384, 'psi': 0.9962122505419246}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972696148646142, 'loss_val': 0.022701216679233856, 'psi': 0.9962188290274389}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=82 head_norm_before_train=1.928246 cos_to_last_merge=0.9908 (last merge round=41)
[S11] round=82 local utility u=0.000065 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986515729138428, 'loss_val': 0.02150494142284055, 'psi': 0.9971531140119844}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986608404430694, 'loss_val': 0.021662066359338088, 'psi': 0.997156821023675}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=82 head_norm_before_train=1.828387 cos_to_last_merge=0.9415 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6106134769636116, 'auprc': 0.6492047443411153, 'loss_val': 1.535069232876405, 'psi': 0.626049983914613}-{'f1_val': 0.8304320907178634, 'auprc': 0.900244506451119, 'loss_val': 0.5738842903663492, 'psi': 0.8583570570111656}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=2.151120 cos_to_last_merge=0.9961 (last merge round=46)
[S14] round=82 local utility u=0.084871 metrics={'f1_val': 0.9873410824383378, 'auprc': 0.99918611556134, 'loss_val': 0.032183082761002325, 'psi': 0.9920790956875387}-{'f1_val': 0.9624544588945039, 'auprc': 0.9991482053011896, 'loss_val': 0.05249104897541666, 'psi': 0.9771319574571782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=82 head_norm_before_train=2.039767 cos_to_last_merge=0.9788 (last merge round=42)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.7695788028352321, 'auprc': 0.8913625429198135, 'loss_val': 0.6621412005735331, 'psi': 0.8182922988690646}-{'f1_val': 0.9442365324563569, 'auprc': 0.9980847228806876, 'loss_val': 0.14190515628130057, 'psi': 0.9657758086260891}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=1.920154 cos_to_last_merge=1.0000 (last merge round=79)
[S16] round=82 local utility u=0.003521 metrics={'f1_val': 0.9937081501847713, 'auprc': 0.9939140164345263, 'loss_val': 0.029850164575869722, 'psi': 0.9937904966846733}-{'f1_val': 0.9936846582767345, 'auprc': 0.9918374583380798, 'loss_val': 0.03052167535839982, 'psi': 0.9929457783012726}
[S17] START round=82 head_norm_before_train=1.946404 cos_to_last_merge=0.9776 (last merge round=43)
[S17] round=82 local utility u=1.000000 metrics={'f1_val': 0.8267869015012479, 'auprc': 0.9453097668510562, 'loss_val': 0.7514905356863747, 'psi': 0.8741960476411712}-{'f1_val': 0.6122991065259362, 'auprc': 0.7529485348746385, 'loss_val': 1.85083158790072, 'psi': 0.6685588778654171}
[S17] not sending this round → trigger blocked (psi=0.874)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=82 metric=0.9937 head_norm=1.929482
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.550164e-02
[S16] stored merged vector for next round verification (round=82)
[S16] DEBUG after merge:  round=82 metric=0.9937 head_norm=1.919617 delta_norm=0.015502
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=83 head_norm_before_train=2.168784 cos_to_last_merge=0.9261 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=83 local utility u=0.124341 metrics={'f1_val': 0.8518711454182577, 'auprc': 0.955873464603851, 'loss_val': 0.311851948471028, 'psi': 0.893472073092495}-{'f1_val': 0.8305337047555752, 'auprc': 0.9429977887757142, 'loss_val': 0.39388266221868495, 'psi': 0.8755193383636308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=83 head_norm_before_train=2.137674 cos_to_last_merge=0.9814 (last merge round=44)
[S3] round=83 local utility u=0.609984 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.9994034209469136, 'loss_val': 0.09900211172560602, 'psi': 0.9762776630919399}-{'f1_val': 0.8233632786049274, 'auprc': 0.9881706201200309, 'loss_val': 0.46028803530383405, 'psi': 0.8892862152109688}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=83 head_norm_before_train=2.304548 (no previous merge yet)
[S4] round=83 local utility u=0.003573 metrics={'f1_val': 0.9517183847437836, 'auprc': 0.9861688520595415, 'loss_val': 0.27811754256755494, 'psi': 0.9654985716700868}-{'f1_val': 0.9525303047468594, 'auprc': 0.9863712065682574, 'loss_val': 0.2907411675874188, 'psi': 0.9660666654754186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=83 head_norm_before_train=1.822820 cos_to_last_merge=0.7885 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9922994471136469, 'loss_val': 0.028808346778550386, 'psi': 0.9945439083842912}-{'f1_val': 0.9963325909888239, 'auprc': 0.9979898889024106, 'loss_val': 0.028051731071739933, 'psi': 0.9969955101542585}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=2.245443 cos_to_last_merge=0.9613 (last merge round=44)
[S6] round=83 local utility u=0.968056 metrics={'f1_val': 0.9060045031523674, 'auprc': 0.964539184760841, 'loss_val': 0.22927001602080824, 'psi': 0.9294183757957568}-{'f1_val': 0.7349461933700686, 'auprc': 0.900214737497449, 'loss_val': 0.9460584534779269, 'psi': 0.8010536110210207}
[S6] not sending this round → trigger blocked (psi=0.929)
[S7] START round=83 head_norm_before_train=1.912806 cos_to_last_merge=1.0000 (last merge round=79)
[S7] round=83 local utility u=0.287372 metrics={'f1_val': 0.6540531587736871, 'auprc': 0.8127696874689628, 'loss_val': 0.44913778945591404, 'psi': 0.7175397702517974}-{'f1_val': 0.6151209547168406, 'auprc': 0.7961008658620498, 'loss_val': 0.7402816445516759, 'psi': 0.6875129191749243}
[S8] START round=83 head_norm_before_train=1.979912 cos_to_last_merge=0.9905 (last merge round=45)
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.8453029454023435, 'auprc': 0.9991644350136375, 'loss_val': 0.48361828417935177, 'psi': 0.9068475412468611}-{'f1_val': 0.9150014743396108, 'auprc': 0.9993777149865363, 'loss_val': 0.18211492719240752, 'psi': 0.9487519705983809}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.045688 cos_to_last_merge=0.7613 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.761
[S9] round=83 local utility u=0.013634 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9998476351956449, 'loss_val': 0.018041045896648226, 'psi': 0.9974350850967693}-{'f1_val': 0.9926462894722031, 'auprc': 0.9996963879512839, 'loss_val': 0.02577226733084103, 'psi': 0.9954663288638355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=83 head_norm_before_train=2.166032 cos_to_last_merge=0.9932 (last merge round=41)
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9971845548410292, 'loss_val': 0.02286642730542627, 'psi': 0.9961848050180049}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972531686508287, 'loss_val': 0.02246176410018384, 'psi': 0.9962122505419246}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=1.933553 cos_to_last_merge=0.9906 (last merge round=41)
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986160445092375, 'loss_val': 0.021482957081461713, 'psi': 0.9971389026501423}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986515729138428, 'loss_val': 0.02150494142284055, 'psi': 0.9971531140119844}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.830040 cos_to_last_merge=0.9412 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=83 local utility u=0.305456 metrics={'f1_val': 0.6422925175225214, 'auprc': 0.719840910417366, 'loss_val': 1.3261408658457075, 'psi': 0.6733118746804592}-{'f1_val': 0.6106134769636116, 'auprc': 0.6492047443411153, 'loss_val': 1.535069232876405, 'psi': 0.626049983914613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=83 head_norm_before_train=2.152342 cos_to_last_merge=0.9960 (last merge round=46)
[S14] round=83 local utility u=0.039063 metrics={'f1_val': 0.9980128044262995, 'auprc': 0.9995856857478718, 'loss_val': 0.019285749976877615, 'psi': 0.9986419569549284}-{'f1_val': 0.9873410824383378, 'auprc': 0.99918611556134, 'loss_val': 0.032183082761002325, 'psi': 0.9920790956875387}
[S14] not sending this round → trigger blocked (psi=0.999)
[S15] START round=83 head_norm_before_train=2.044032 cos_to_last_merge=0.9786 (last merge round=42)
[S15] round=83 local utility u=0.213813 metrics={'f1_val': 0.777629516574415, 'auprc': 0.9898090063434294, 'loss_val': 0.5781582929351695, 'psi': 0.8625013124820208}-{'f1_val': 0.7695788028352321, 'auprc': 0.8913625429198135, 'loss_val': 0.6621412005735331, 'psi': 0.8182922988690646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=83 head_norm_before_train=1.919617 cos_to_last_merge=1.0000 (last merge round=82)
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.8779841974201124, 'auprc': 0.9925056147381321, 'loss_val': 0.385759345418835, 'psi': 0.9237927643473203}-{'f1_val': 0.9937081501847713, 'auprc': 0.9939140164345263, 'loss_val': 0.029850164575869722, 'psi': 0.9937904966846733}
[S17] START round=83 head_norm_before_train=1.948783 cos_to_last_merge=0.9776 (last merge round=43)
[S17] round=83 local utility u=0.256413 metrics={'f1_val': 0.9028457049458884, 'auprc': 0.8851485350747246, 'loss_val': 0.5145330902367914, 'psi': 0.8957668369974229}-{'f1_val': 0.8267869015012479, 'auprc': 0.9453097668510562, 'loss_val': 0.7514905356863747, 'psi': 0.8741960476411712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=83 metric=0.6541 head_norm=1.919168
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.708009e-02
[S7] stored merged vector for next round verification (round=83)
[S7] DEBUG after merge:  round=83 metric=0.6576 head_norm=1.924256 delta_norm=0.017080
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=83 metric=0.8780 head_norm=1.923777
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.458126e-02
[S16] stored merged vector for next round verification (round=83)
[S16] DEBUG after merge:  round=83 metric=0.8783 head_norm=1.921419 delta_norm=0.014581
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=84 head_norm_before_train=2.170682 cos_to_last_merge=0.9252 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7200084974087314, 'auprc': 0.8152024521637706, 'loss_val': 0.8460597390123044, 'psi': 0.7580860793107471}-{'f1_val': 0.8518711454182577, 'auprc': 0.955873464603851, 'loss_val': 0.311851948471028, 'psi': 0.893472073092495}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.143288 cos_to_last_merge=0.9811 (last merge round=44)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.940418021794803, 'auprc': 0.9767697787125889, 'loss_val': 0.21243527866478537, 'psi': 0.9549587245619174}-{'f1_val': 0.9608604911886242, 'auprc': 0.9994034209469136, 'loss_val': 0.09900211172560602, 'psi': 0.9762776630919399}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=2.315197 (no previous merge yet)
[S4] round=84 local utility u=0.002141 metrics={'f1_val': 0.9534551537676985, 'auprc': 0.9862795533488451, 'loss_val': 0.28458735082819253, 'psi': 0.9665849136001572}-{'f1_val': 0.9517183847437836, 'auprc': 0.9861688520595415, 'loss_val': 0.27811754256755494, 'psi': 0.9654985716700868}
[S4] not sending this round → trigger blocked (psi=0.967)
[S5] START round=84 head_norm_before_train=1.825219 cos_to_last_merge=0.7886 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=84 local utility u=0.008126 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9979924650901737, 'loss_val': 0.02832315535719609, 'psi': 0.9966898077026816}-{'f1_val': 0.9960402158980539, 'auprc': 0.9922994471136469, 'loss_val': 0.028808346778550386, 'psi': 0.9945439083842912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=84 head_norm_before_train=2.256130 cos_to_last_merge=0.9605 (last merge round=44)
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.795890581187699, 'auprc': 0.9329506426953414, 'loss_val': 0.492093220688289, 'psi': 0.850714605790756}-{'f1_val': 0.9060045031523674, 'auprc': 0.964539184760841, 'loss_val': 0.22927001602080824, 'psi': 0.9294183757957568}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.924256 cos_to_last_merge=1.0000 (last merge round=83)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.6347797840615329, 'auprc': 0.8018180033208655, 'loss_val': 0.6411937958809325, 'psi': 0.7015950717652659}-{'f1_val': 0.6540531587736871, 'auprc': 0.8127696874689628, 'loss_val': 0.44913778945591404, 'psi': 0.7175397702517974}
[S8] START round=84 head_norm_before_train=1.985307 cos_to_last_merge=0.9903 (last merge round=45)
[S8] round=84 local utility u=0.671762 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.998224004159189, 'loss_val': 0.027461813455142686, 'psi': 0.9954901894748152}-{'f1_val': 0.8453029454023435, 'auprc': 0.9991644350136375, 'loss_val': 0.48361828417935177, 'psi': 0.9068475412468611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=84 head_norm_before_train=2.048029 cos_to_last_merge=0.7608 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.761
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9966815007825864, 'loss_val': 0.01690937589851197, 'psi': 0.9969343478203203}-{'f1_val': 0.9958267183641853, 'auprc': 0.9998476351956449, 'loss_val': 0.018041045896648226, 'psi': 0.9974350850967693}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.169198 cos_to_last_merge=0.9929 (last merge round=41)
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9971030743041388, 'loss_val': 0.0228029036007989, 'psi': 0.9961522128032487}-{'f1_val': 0.9955183051359886, 'auprc': 0.9971845548410292, 'loss_val': 0.02286642730542627, 'psi': 0.9961848050180049}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=1.937511 cos_to_last_merge=0.9904 (last merge round=41)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9983089761746995, 'loss_val': 0.02815548751309369, 'psi': 0.9970160753163271}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986160445092375, 'loss_val': 0.021482957081461713, 'psi': 0.9971389026501423}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=1.835140 cos_to_last_merge=0.9407 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=84 local utility u=0.520494 metrics={'f1_val': 0.7578739846893051, 'auprc': 0.7689746697170077, 'loss_val': 1.1260431079102566, 'psi': 0.7623142587003862}-{'f1_val': 0.6422925175225214, 'auprc': 0.719840910417366, 'loss_val': 1.3261408658457075, 'psi': 0.6733118746804592}
[S13] not sending this round → trigger blocked (psi=0.762)
[S14] START round=84 head_norm_before_train=2.153418 cos_to_last_merge=0.9958 (last merge round=46)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.947995559798403, 'auprc': 0.9970928464062891, 'loss_val': 0.09352972915733505, 'psi': 0.9676344744415575}-{'f1_val': 0.9980128044262995, 'auprc': 0.9995856857478718, 'loss_val': 0.019285749976877615, 'psi': 0.9986419569549284}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.045872 cos_to_last_merge=0.9783 (last merge round=42)
[S15] round=84 local utility u=0.550300 metrics={'f1_val': 0.9055920570944747, 'auprc': 0.9959256340900162, 'loss_val': 0.2636830038768935, 'psi': 0.9417254878926913}-{'f1_val': 0.777629516574415, 'auprc': 0.9898090063434294, 'loss_val': 0.5781582929351695, 'psi': 0.8625013124820208}
[S15] not sending this round → trigger blocked (psi=0.942)
[S16] START round=84 head_norm_before_train=1.921419 cos_to_last_merge=1.0000 (last merge round=83)
[S16] round=84 local utility u=0.514219 metrics={'f1_val': 0.9925915399265671, 'auprc': 0.9908291369318462, 'loss_val': 0.03993669249516909, 'psi': 0.9918865787286787}-{'f1_val': 0.8779841974201124, 'auprc': 0.9925056147381321, 'loss_val': 0.385759345418835, 'psi': 0.9237927643473203}
[S17] START round=84 head_norm_before_train=1.954929 cos_to_last_merge=0.9772 (last merge round=43)
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.795552701920861, 'auprc': 0.8590381237108833, 'loss_val': 0.9133415342280018, 'psi': 0.8209468706368699}-{'f1_val': 0.9028457049458884, 'auprc': 0.8851485350747246, 'loss_val': 0.5145330902367914, 'psi': 0.8957668369974229}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:52808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=1.0000
[S2] START round=85 head_norm_before_train=2.176917 cos_to_last_merge=0.9249 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=85 local utility u=1.000000 metrics={'f1_val': 0.9043423034841903, 'auprc': 0.9866362141455113, 'loss_val': 0.2955230099438425, 'psi': 0.9372598677487187}-{'f1_val': 0.7200084974087314, 'auprc': 0.8152024521637706, 'loss_val': 0.8460597390123044, 'psi': 0.7580860793107471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=85 head_norm_before_train=2.147559 cos_to_last_merge=0.9809 (last merge round=44)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.6922082578212111, 'auprc': 0.8837134953505483, 'loss_val': 1.1188187700523475, 'psi': 0.768810352832946}-{'f1_val': 0.940418021794803, 'auprc': 0.9767697787125889, 'loss_val': 0.21243527866478537, 'psi': 0.9549587245619174}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=2.327491 (no previous merge yet)
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9517618576905575, 'auprc': 0.9865567632768428, 'loss_val': 0.28293570819082464, 'psi': 0.9656798199250717}-{'f1_val': 0.9534551537676985, 'auprc': 0.9862795533488451, 'loss_val': 0.28458735082819253, 'psi': 0.9665849136001572}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.827242 cos_to_last_merge=0.7886 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.990532304925065, 'loss_val': 0.03207888809149857, 'psi': 0.9938370515088584}-{'f1_val': 0.9958213694443535, 'auprc': 0.9979924650901737, 'loss_val': 0.02832315535719609, 'psi': 0.9966898077026816}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=2.267097 cos_to_last_merge=0.9598 (last merge round=44)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.7818824529742112, 'auprc': 0.911955074481924, 'loss_val': 0.8991552345270692, 'psi': 0.8339115015772963}-{'f1_val': 0.795890581187699, 'auprc': 0.9329506426953414, 'loss_val': 0.492093220688289, 'psi': 0.850714605790756}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=85 head_norm_before_train=1.931235 cos_to_last_merge=1.0000 (last merge round=83)
[S7] round=85 local utility u=0.070411 metrics={'f1_val': 0.6455675602282218, 'auprc': 0.8057054631707272, 'loss_val': 0.5767610937967864, 'psi': 0.709622721405224}-{'f1_val': 0.6347797840615329, 'auprc': 0.8018180033208655, 'loss_val': 0.6411937958809325, 'psi': 0.7015950717652659}
[S8] START round=85 head_norm_before_train=1.989279 cos_to_last_merge=0.9901 (last merge round=45)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.8729384364798181, 'auprc': 0.9994760589402075, 'loss_val': 0.3020096921852921, 'psi': 0.9235534854639738}-{'f1_val': 0.9936676463518993, 'auprc': 0.998224004159189, 'loss_val': 0.027461813455142686, 'psi': 0.9954901894748152}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=85 head_norm_before_train=2.051132 cos_to_last_merge=0.7602 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.760
[S9] round=85 local utility u=0.004747 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9997631635437063, 'loss_val': 0.016660671048427618, 'psi': 0.9981670129247682}-{'f1_val': 0.9971029125121428, 'auprc': 0.9966815007825864, 'loss_val': 0.01690937589851197, 'psi': 0.9969343478203203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=85 head_norm_before_train=2.175266 cos_to_last_merge=0.9929 (last merge round=41)
[S10] round=85 local utility u=0.000090 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972263459284738, 'loss_val': 0.02299219802332241, 'psi': 0.9962015214529827}-{'f1_val': 0.9955183051359886, 'auprc': 0.9971030743041388, 'loss_val': 0.0228029036007989, 'psi': 0.9961522128032487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=85 head_norm_before_train=1.940472 cos_to_last_merge=0.9903 (last merge round=41)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9756784624585313, 'auprc': 0.9980300371544644, 'loss_val': 0.056506624339227395, 'psi': 0.9846190923369045}-{'f1_val': 0.9961541414107454, 'auprc': 0.9983089761746995, 'loss_val': 0.02815548751309369, 'psi': 0.9970160753163271}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=1.839962 cos_to_last_merge=0.9398 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.6715888266408547, 'auprc': 0.7492794166718597, 'loss_val': 0.9946683057189543, 'psi': 0.7026650626532567}-{'f1_val': 0.7578739846893051, 'auprc': 0.7689746697170077, 'loss_val': 1.1260431079102566, 'psi': 0.7623142587003862}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.156450 cos_to_last_merge=0.9956 (last merge round=46)
[S14] round=85 local utility u=0.060949 metrics={'f1_val': 0.9615279702020942, 'auprc': 0.9983257765518887, 'loss_val': 0.056524085339271904, 'psi': 0.976247092742012}-{'f1_val': 0.947995559798403, 'auprc': 0.9970928464062891, 'loss_val': 0.09352972915733505, 'psi': 0.9676344744415575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=85 head_norm_before_train=2.051269 cos_to_last_merge=0.9780 (last merge round=42)
[S15] round=85 local utility u=0.299639 metrics={'f1_val': 0.97162120175459, 'auprc': 0.9963799498219899, 'loss_val': 0.06194254601394258, 'psi': 0.98152470098155}-{'f1_val': 0.9055920570944747, 'auprc': 0.9959256340900162, 'loss_val': 0.2636830038768935, 'psi': 0.9417254878926913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=85 head_norm_before_train=1.929656 cos_to_last_merge=1.0000 (last merge round=83)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.8719886901251106, 'auprc': 0.9824994400366138, 'loss_val': 0.8989233345878926, 'psi': 0.9161929900897119}-{'f1_val': 0.9925915399265671, 'auprc': 0.9908291369318462, 'loss_val': 0.03993669249516909, 'psi': 0.9918865787286787}
[S17] START round=85 head_norm_before_train=1.962442 cos_to_last_merge=0.9766 (last merge round=43)
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.6774818629479149, 'auprc': 0.8072059427820828, 'loss_val': 1.6366605247029973, 'psi': 0.729371494881582}-{'f1_val': 0.795552701920861, 'auprc': 0.8590381237108833, 'loss_val': 0.9133415342280018, 'psi': 0.8209468706368699}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:52816
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] ⇄ pheromone p=0.090 → S7@127.0.0.1:52808
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=1.0000
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=85 metric=0.6456 head_norm=1.936392
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.490008e-03
[S7] stored merged vector for next round verification (round=85)
[S7] DEBUG after merge:  round=85 metric=0.6457 head_norm=1.933008 delta_norm=0.008490
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.148 → S16@127.0.0.1:52816
[S2] START round=86 head_norm_before_train=2.185701 cos_to_last_merge=0.9242 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.924
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.7210920999458266, 'auprc': 0.8638010591941537, 'loss_val': 0.6703349945025066, 'psi': 0.7781756836451574}-{'f1_val': 0.9043423034841903, 'auprc': 0.9866362141455113, 'loss_val': 0.2955230099438425, 'psi': 0.9372598677487187}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.150753 cos_to_last_merge=0.9807 (last merge round=44)
[S3] round=86 local utility u=1.000000 metrics={'f1_val': 0.9798709832537897, 'auprc': 0.9988202013566838, 'loss_val': 0.04787238208024657, 'psi': 0.9874506704949474}-{'f1_val': 0.6922082578212111, 'auprc': 0.8837134953505483, 'loss_val': 1.1188187700523475, 'psi': 0.768810352832946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=86 head_norm_before_train=2.332608 (no previous merge yet)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.953482026984434, 'auprc': 0.9862638586624628, 'loss_val': 0.2942837341992287, 'psi': 0.9665947596556455}-{'f1_val': 0.9517618576905575, 'auprc': 0.9865567632768428, 'loss_val': 0.28293570819082464, 'psi': 0.9656798199250717}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=1.829777 cos_to_last_merge=0.7885 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=86 local utility u=0.013038 metrics={'f1_val': 0.996186023309311, 'auprc': 0.997859516151328, 'loss_val': 0.028859209591751943, 'psi': 0.9968554204461177}-{'f1_val': 0.9960402158980539, 'auprc': 0.990532304925065, 'loss_val': 0.03207888809149857, 'psi': 0.9938370515088584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=86 head_norm_before_train=2.277688 cos_to_last_merge=0.9593 (last merge round=44)
[S6] round=86 local utility u=1.000000 metrics={'f1_val': 0.9637915698482696, 'auprc': 0.9736888384663991, 'loss_val': 0.11504262770486164, 'psi': 0.9677504772955214}-{'f1_val': 0.7818824529742112, 'auprc': 0.911955074481924, 'loss_val': 0.8991552345270692, 'psi': 0.8339115015772963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=86 head_norm_before_train=1.933008 cos_to_last_merge=1.0000 (last merge round=85)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6443061417827045, 'auprc': 0.8052014114428364, 'loss_val': 0.6480832062790549, 'psi': 0.7086642496467572}-{'f1_val': 0.6455675602282218, 'auprc': 0.8057054631707272, 'loss_val': 0.5767610937967864, 'psi': 0.709622721405224}
[S8] START round=86 head_norm_before_train=1.991902 cos_to_last_merge=0.9900 (last merge round=45)
[S8] round=86 local utility u=0.498648 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9987627541442113, 'loss_val': 0.029147773444519364, 'psi': 0.99592562880226}-{'f1_val': 0.8729384364798181, 'auprc': 0.9994760589402075, 'loss_val': 0.3020096921852921, 'psi': 0.9235534854639738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=86 head_norm_before_train=2.055780 cos_to_last_merge=0.7598 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.760
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.985286948729855, 'auprc': 0.999810473335048, 'loss_val': 0.05685250781249875, 'psi': 0.9910963585719321}-{'f1_val': 0.9971029125121428, 'auprc': 0.9997631635437063, 'loss_val': 0.016660671048427618, 'psi': 0.9981670129247682}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.182073 cos_to_last_merge=0.9930 (last merge round=41)
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9971810821733356, 'loss_val': 0.02313783833437214, 'psi': 0.9959345137149932}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972263459284738, 'loss_val': 0.02299219802332241, 'psi': 0.9962015214529827}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=1.944487 cos_to_last_merge=0.9901 (last merge round=41)
[S11] round=86 local utility u=0.079937 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9987847820596454, 'loss_val': 0.02162912601745288, 'psi': 0.9971941177718437}-{'f1_val': 0.9756784624585313, 'auprc': 0.9980300371544644, 'loss_val': 0.056506624339227395, 'psi': 0.9846190923369045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=86 head_norm_before_train=1.844566 cos_to_last_merge=0.9392 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6323588410116426, 'auprc': 0.9066349592760057, 'loss_val': 1.4222379851214648, 'psi': 0.7420692883173878}-{'f1_val': 0.6715888266408547, 'auprc': 0.7492794166718597, 'loss_val': 0.9946683057189543, 'psi': 0.7026650626532567}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=2.161739 cos_to_last_merge=0.9954 (last merge round=46)
[S14] round=86 local utility u=0.129851 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991833220614341, 'loss_val': 0.017157483078131648, 'psi': 0.998366384437229}-{'f1_val': 0.9615279702020942, 'auprc': 0.9983257765518887, 'loss_val': 0.056524085339271904, 'psi': 0.976247092742012}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=86 head_norm_before_train=2.057891 cos_to_last_merge=0.9776 (last merge round=42)
[S15] round=86 local utility u=0.039269 metrics={'f1_val': 0.9818069861846557, 'auprc': 0.9969125868301801, 'loss_val': 0.04611671475191025, 'psi': 0.9878492264428655}-{'f1_val': 0.97162120175459, 'auprc': 0.9963799498219899, 'loss_val': 0.06194254601394258, 'psi': 0.98152470098155}
[S15] not sending this round → trigger blocked (psi=0.988)
[S16] START round=86 head_norm_before_train=1.940188 cos_to_last_merge=1.0000 (last merge round=83)
[S16] round=86 local utility u=0.430123 metrics={'f1_val': 0.9318942052894432, 'auprc': 0.9907026778788658, 'loss_val': 0.4227191636830228, 'psi': 0.9554175943252122}-{'f1_val': 0.8719886901251106, 'auprc': 0.9824994400366138, 'loss_val': 0.8989233345878926, 'psi': 0.9161929900897119}
[S17] START round=86 head_norm_before_train=1.969714 cos_to_last_merge=0.9759 (last merge round=43)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.6636117703910848, 'auprc': 0.7733578400409835, 'loss_val': 1.7878343493361089, 'psi': 0.7075101982510443}-{'f1_val': 0.6774818629479149, 'auprc': 0.8072059427820828, 'loss_val': 1.6366605247029973, 'psi': 0.729371494881582}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:52808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=86 metric=0.9319 head_norm=1.951205
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.368957e-02
[S16] stored merged vector for next round verification (round=86)
[S16] DEBUG after merge:  round=86 metric=0.9319 head_norm=1.943764 delta_norm=0.013690
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=87 head_norm_before_train=2.192328 cos_to_last_merge=0.9239 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.924
[S2] round=87 local utility u=0.521546 metrics={'f1_val': 0.8272658878290791, 'auprc': 0.9306278113479278, 'loss_val': 0.464766616120001, 'psi': 0.8686106572366186}-{'f1_val': 0.7210920999458266, 'auprc': 0.8638010591941537, 'loss_val': 0.6703349945025066, 'psi': 0.7781756836451574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=87 head_norm_before_train=2.153507 cos_to_last_merge=0.9806 (last merge round=44)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.949771865713566, 'auprc': 0.9979879182619062, 'loss_val': 0.10818708930333028, 'psi': 0.9690582867329021}-{'f1_val': 0.9798709832537897, 'auprc': 0.9988202013566838, 'loss_val': 0.04787238208024657, 'psi': 0.9874506704949474}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=2.341624 (no previous merge yet)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9506818528397443, 'auprc': 0.9861981027564201, 'loss_val': 0.2973067982195746, 'psi': 0.9648883528064146}-{'f1_val': 0.953482026984434, 'auprc': 0.9862638586624628, 'loss_val': 0.2942837341992287, 'psi': 0.9665947596556455}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.833316 cos_to_last_merge=0.7883 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9948494027653483, 'loss_val': 0.02902305439208683, 'psi': 0.995651375091726}-{'f1_val': 0.996186023309311, 'auprc': 0.997859516151328, 'loss_val': 0.028859209591751943, 'psi': 0.9968554204461177}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=2.286066 cos_to_last_merge=0.9585 (last merge round=44)
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.7997446834154149, 'auprc': 0.9255779969877276, 'loss_val': 0.7574980116014876, 'psi': 0.85007800884434}-{'f1_val': 0.9637915698482696, 'auprc': 0.9736888384663991, 'loss_val': 0.11504262770486164, 'psi': 0.9677504772955214}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.936804 cos_to_last_merge=1.0000 (last merge round=85)
[S7] round=87 local utility u=0.171418 metrics={'f1_val': 0.660953461768192, 'auprc': 0.8164933006442197, 'loss_val': 0.4390064495750483, 'psi': 0.7231693973186031}-{'f1_val': 0.6443061417827045, 'auprc': 0.8052014114428364, 'loss_val': 0.6480832062790549, 'psi': 0.7086642496467572}
[S8] START round=87 head_norm_before_train=1.996040 cos_to_last_merge=0.9898 (last merge round=45)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9860892612913941, 'auprc': 0.9980426147760868, 'loss_val': 0.04558651892839144, 'psi': 0.9908706026852712}-{'f1_val': 0.9940342119076258, 'auprc': 0.9987627541442113, 'loss_val': 0.029147773444519364, 'psi': 0.99592562880226}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=2.060378 cos_to_last_merge=0.7595 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.760
[S9] round=87 local utility u=0.052857 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9998095081139172, 'loss_val': 0.017040457396180524, 'psi': 0.9976864206838105}-{'f1_val': 0.985286948729855, 'auprc': 0.999810473335048, 'loss_val': 0.05685250781249875, 'psi': 0.9910963585719321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=87 head_norm_before_train=2.183203 cos_to_last_merge=0.9925 (last merge round=41)
[S10] round=87 local utility u=0.001073 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9969411850543428, 'loss_val': 0.022761619984973603, 'psi': 0.9960874571033302}-{'f1_val': 0.9951034680760983, 'auprc': 0.9971810821733356, 'loss_val': 0.02313783833437214, 'psi': 0.9959345137149932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=87 head_norm_before_train=1.947114 cos_to_last_merge=0.9899 (last merge round=41)
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9570716024412402, 'auprc': 0.9982033975980242, 'loss_val': 0.09380595546751536, 'psi': 0.9735243205039538}-{'f1_val': 0.9961336749133093, 'auprc': 0.9987847820596454, 'loss_val': 0.02162912601745288, 'psi': 0.9971941177718437}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=1.850637 cos_to_last_merge=0.9386 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.6171237692438641, 'auprc': 0.6639364902022178, 'loss_val': 1.4965988729894302, 'psi': 0.6358488576272057}-{'f1_val': 0.6323588410116426, 'auprc': 0.9066349592760057, 'loss_val': 1.4222379851214648, 'psi': 0.7420692883173878}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=2.166957 cos_to_last_merge=0.9953 (last merge round=46)
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991861242004001, 'loss_val': 0.01926280595268847, 'psi': 0.9983675052928155}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991833220614341, 'loss_val': 0.017157483078131648, 'psi': 0.998366384437229}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=2.064738 cos_to_last_merge=0.9772 (last merge round=42)
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.9622737164014975, 'auprc': 0.9957081692993346, 'loss_val': 0.08925678547164453, 'psi': 0.9756474975606324}-{'f1_val': 0.9818069861846557, 'auprc': 0.9969125868301801, 'loss_val': 0.04611671475191025, 'psi': 0.9878492264428655}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=1.943764 cos_to_last_merge=1.0000 (last merge round=86)
[S16] round=87 local utility u=0.196231 metrics={'f1_val': 0.9509149175319812, 'auprc': 0.9915921343431454, 'loss_val': 0.14705073802713245, 'psi': 0.967185804256447}-{'f1_val': 0.9318942052894432, 'auprc': 0.9907026778788658, 'loss_val': 0.4227191636830228, 'psi': 0.9554175943252122}
[S17] START round=87 head_norm_before_train=1.975110 cos_to_last_merge=0.9755 (last merge round=43)
[S17] round=87 local utility u=0.227102 metrics={'f1_val': 0.6882375470360615, 'auprc': 0.7810445589569337, 'loss_val': 1.5044445460871012, 'psi': 0.7253603518044104}-{'f1_val': 0.6636117703910848, 'auprc': 0.7733578400409835, 'loss_val': 1.7878343493361089, 'psi': 0.7075101982510443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.967)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=87 metric=0.6610 head_norm=1.941064
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.366659e-02
[S7] stored merged vector for next round verification (round=87)
[S7] DEBUG after merge:  round=87 metric=0.6638 head_norm=1.946093 delta_norm=0.013667
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=88 head_norm_before_train=2.187286 cos_to_last_merge=0.9238 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.924
[S2] round=88 local utility u=0.355060 metrics={'f1_val': 0.9097744883312922, 'auprc': 0.9326467461085024, 'loss_val': 0.2557544323250464, 'psi': 0.9189233914421763}-{'f1_val': 0.8272658878290791, 'auprc': 0.9306278113479278, 'loss_val': 0.464766616120001, 'psi': 0.8686106572366186}
[S2] not sending this round → trigger blocked (psi=0.919)
[S3] START round=88 head_norm_before_train=2.153208 cos_to_last_merge=0.9807 (last merge round=44)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.7821125113662956, 'auprc': 0.9889091018418086, 'loss_val': 0.6124754709015744, 'psi': 0.8648311475565007}-{'f1_val': 0.949771865713566, 'auprc': 0.9979879182619062, 'loss_val': 0.10818708930333028, 'psi': 0.9690582867329021}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=2.347006 (no previous merge yet)
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9461925943546181, 'auprc': 0.9861960280567396, 'loss_val': 0.3052756051432239, 'psi': 0.9621939678354667}-{'f1_val': 0.9506818528397443, 'auprc': 0.9861981027564201, 'loss_val': 0.2973067982195746, 'psi': 0.9648883528064146}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.838608 cos_to_last_merge=0.7879 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9941164302830494, 'loss_val': 0.029124141962134857, 'psi': 0.9953581860988063}-{'f1_val': 0.996186023309311, 'auprc': 0.9948494027653483, 'loss_val': 0.02902305439208683, 'psi': 0.995651375091726}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=2.296950 cos_to_last_merge=0.9580 (last merge round=44)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.62508810191629, 'auprc': 0.6837368748106625, 'loss_val': 1.6849940443759819, 'psi': 0.648547611074039}-{'f1_val': 0.7997446834154149, 'auprc': 0.9255779969877276, 'loss_val': 0.7574980116014876, 'psi': 0.85007800884434}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.946093 cos_to_last_merge=1.0000 (last merge round=87)
[S7] round=88 local utility u=0.843342 metrics={'f1_val': 0.8808526154071803, 'auprc': 0.8868879609524266, 'loss_val': 0.28290073030332497, 'psi': 0.8832667536252788}-{'f1_val': 0.660953461768192, 'auprc': 0.8164933006442197, 'loss_val': 0.4390064495750483, 'psi': 0.7231693973186031}
[S8] START round=88 head_norm_before_train=2.002450 cos_to_last_merge=0.9896 (last merge round=45)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9783905912510161, 'auprc': 0.990279423960101, 'loss_val': 0.06282553754701568, 'psi': 0.98314612433465}-{'f1_val': 0.9860892612913941, 'auprc': 0.9980426147760868, 'loss_val': 0.04558651892839144, 'psi': 0.9908706026852712}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=2.063100 cos_to_last_merge=0.7591 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.759
[S9] round=88 local utility u=0.003261 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9998136281011396, 'loss_val': 0.01550492598418479, 'psi': 0.9981854809639938}-{'f1_val': 0.9962710290637395, 'auprc': 0.9998095081139172, 'loss_val': 0.017040457396180524, 'psi': 0.9976864206838105}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=88 head_norm_before_train=2.187343 cos_to_last_merge=0.9923 (last merge round=41)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9969239274749547, 'loss_val': 0.023038724312810743, 'psi': 0.996080554071575}-{'f1_val': 0.9955183051359886, 'auprc': 0.9969411850543428, 'loss_val': 0.022761619984973603, 'psi': 0.9960874571033302}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=1.950863 cos_to_last_merge=0.9898 (last merge round=41)
[S11] round=88 local utility u=0.151194 metrics={'f1_val': 0.996129246008257, 'auprc': 0.9982183297925477, 'loss_val': 0.025808115697278092, 'psi': 0.9969648795219732}-{'f1_val': 0.9570716024412402, 'auprc': 0.9982033975980242, 'loss_val': 0.09380595546751536, 'psi': 0.9735243205039538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=88 head_norm_before_train=1.852189 cos_to_last_merge=0.9384 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=88 local utility u=0.346953 metrics={'f1_val': 0.6689546000175425, 'auprc': 0.7356242688364562, 'loss_val': 1.3287405962838275, 'psi': 0.6956224675451079}-{'f1_val': 0.6171237692438641, 'auprc': 0.6639364902022178, 'loss_val': 1.4965988729894302, 'psi': 0.6358488576272057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=88 head_norm_before_train=2.172165 cos_to_last_merge=0.9952 (last merge round=46)
[S14] round=88 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991463433376537, 'loss_val': 0.018817196657809163, 'psi': 0.9981051338957584}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991861242004001, 'loss_val': 0.01926280595268847, 'psi': 0.9983675052928155}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=88 head_norm_before_train=2.071548 cos_to_last_merge=0.9768 (last merge round=42)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.93655897009149, 'auprc': 0.9958955359887578, 'loss_val': 0.1374391910876029, 'psi': 0.9602935964503971}-{'f1_val': 0.9622737164014975, 'auprc': 0.9957081692993346, 'loss_val': 0.08925678547164453, 'psi': 0.9756474975606324}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.954438 cos_to_last_merge=1.0000 (last merge round=86)
[S16] round=88 local utility u=0.175966 metrics={'f1_val': 0.9915341688360392, 'auprc': 0.9928303541050801, 'loss_val': 0.042549734879060865, 'psi': 0.9920526429436556}-{'f1_val': 0.9509149175319812, 'auprc': 0.9915921343431454, 'loss_val': 0.14705073802713245, 'psi': 0.967185804256447}
[S17] START round=88 head_norm_before_train=1.977897 cos_to_last_merge=0.9754 (last merge round=43)
[S17] round=88 local utility u=0.166725 metrics={'f1_val': 0.6991141385399589, 'auprc': 0.8324162464490528, 'loss_val': 1.3903683373335023, 'psi': 0.7524349817035965}-{'f1_val': 0.6882375470360615, 'auprc': 0.7810445589569337, 'loss_val': 1.5044445460871012, 'psi': 0.7253603518044104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.9999
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=88 metric=0.9915 head_norm=1.954673
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.241163e-02
[S16] stored merged vector for next round verification (round=88)
[S16] DEBUG after merge:  round=88 metric=0.9915 head_norm=1.950226 delta_norm=0.012412
[S16] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=88 metric=0.8809 head_norm=1.950643
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.120190e-02
[S7] stored merged vector for next round verification (round=88)
[S7] DEBUG after merge:  round=88 metric=0.8958 head_norm=1.952627 delta_norm=0.011202
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=89 head_norm_before_train=2.185292 cos_to_last_merge=0.9232 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.923
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.8272658878290791, 'auprc': 0.8919819665835974, 'loss_val': 0.42527169010465954, 'psi': 0.8531523193308864}-{'f1_val': 0.9097744883312922, 'auprc': 0.9326467461085024, 'loss_val': 0.2557544323250464, 'psi': 0.9189233914421763}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=2.154502 cos_to_last_merge=0.9806 (last merge round=44)
[S3] round=89 local utility u=0.652340 metrics={'f1_val': 0.9210869834778221, 'auprc': 0.9973826325794379, 'loss_val': 0.1670622642465122, 'psi': 0.9516052431184685}-{'f1_val': 0.7821125113662956, 'auprc': 0.9889091018418086, 'loss_val': 0.6124754709015744, 'psi': 0.8648311475565007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=89 head_norm_before_train=2.345856 (no previous merge yet)
[S4] round=89 local utility u=0.012512 metrics={'f1_val': 0.9481669575005032, 'auprc': 0.9867218498410644, 'loss_val': 0.29367606104757155, 'psi': 0.9635889144367276}-{'f1_val': 0.9461925943546181, 'auprc': 0.9861960280567396, 'loss_val': 0.3052756051432239, 'psi': 0.9621939678354667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=89 head_norm_before_train=1.840525 cos_to_last_merge=0.7879 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9927075876745004, 'loss_val': 0.028383746060819413, 'psi': 0.9947071646086325}-{'f1_val': 0.996186023309311, 'auprc': 0.9941164302830494, 'loss_val': 0.029124141962134857, 'psi': 0.9953581860988063}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=2.307166 cos_to_last_merge=0.9575 (last merge round=44)
[S6] round=89 local utility u=1.000000 metrics={'f1_val': 0.9347193356628406, 'auprc': 0.9428204698050702, 'loss_val': 0.21796675211500832, 'psi': 0.9379597893197325}-{'f1_val': 0.62508810191629, 'auprc': 0.6837368748106625, 'loss_val': 1.6849940443759819, 'psi': 0.648547611074039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=89 head_norm_before_train=1.952627 cos_to_last_merge=1.0000 (last merge round=88)
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.5484354786367296, 'auprc': 0.7818020790656293, 'loss_val': 1.2051699873257733, 'psi': 0.6417821188082895}-{'f1_val': 0.8808526154071803, 'auprc': 0.8868879609524266, 'loss_val': 0.28290073030332497, 'psi': 0.8832667536252788}
[S8] START round=89 head_norm_before_train=2.008654 cos_to_last_merge=0.9893 (last merge round=45)
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.910656517223066, 'auprc': 0.9994270559610441, 'loss_val': 0.19582703884213817, 'psi': 0.9461647327182572}-{'f1_val': 0.9783905912510161, 'auprc': 0.990279423960101, 'loss_val': 0.06282553754701568, 'psi': 0.98314612433465}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=89 head_norm_before_train=2.066649 cos_to_last_merge=0.7587 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.759
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9998169685936542, 'loss_val': 0.015574202294754945, 'psi': 0.9981868171609997}-{'f1_val': 0.9971000495392299, 'auprc': 0.9998136281011396, 'loss_val': 0.01550492598418479, 'psi': 0.9981854809639938}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.188817 cos_to_last_merge=0.9918 (last merge round=41)
[S10] round=89 local utility u=0.000254 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9971179384877675, 'loss_val': 0.02311355397857886, 'psi': 0.9961581584767002}-{'f1_val': 0.9955183051359886, 'auprc': 0.9969239274749547, 'loss_val': 0.023038724312810743, 'psi': 0.996080554071575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=89 head_norm_before_train=1.953036 cos_to_last_merge=0.9896 (last merge round=41)
[S11] round=89 local utility u=0.003688 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987412581079292, 'loss_val': 0.020150616846885502, 'psi': 0.997188988089619}-{'f1_val': 0.996129246008257, 'auprc': 0.9982183297925477, 'loss_val': 0.025808115697278092, 'psi': 0.9969648795219732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=89 head_norm_before_train=1.853194 cos_to_last_merge=0.9381 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=89 local utility u=0.548080 metrics={'f1_val': 0.7405121658749326, 'auprc': 0.8799497725206704, 'loss_val': 1.0949033063557407, 'psi': 0.7962872085332278}-{'f1_val': 0.6689546000175425, 'auprc': 0.7356242688364562, 'loss_val': 1.3287405962838275, 'psi': 0.6956224675451079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=89 head_norm_before_train=2.175233 cos_to_last_merge=0.9950 (last merge round=46)
[S14] round=89 local utility u=0.003260 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9991708424399548, 'loss_val': 0.01730310586591917, 'psi': 0.9986081434523049}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991463433376537, 'loss_val': 0.018817196657809163, 'psi': 0.9981051338957584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=89 head_norm_before_train=2.078220 cos_to_last_merge=0.9765 (last merge round=42)
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.9262955811078103, 'auprc': 0.9956694054709564, 'loss_val': 0.16760425463593806, 'psi': 0.9540451108530688}-{'f1_val': 0.93655897009149, 'auprc': 0.9958955359887578, 'loss_val': 0.1374391910876029, 'psi': 0.9602935964503971}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=1.950226 cos_to_last_merge=1.0000 (last merge round=88)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9163489897978014, 'auprc': 0.977952294097601, 'loss_val': 0.468433596917547, 'psi': 0.9409903115177213}-{'f1_val': 0.9915341688360392, 'auprc': 0.9928303541050801, 'loss_val': 0.042549734879060865, 'psi': 0.9920526429436556}
[S17] START round=89 head_norm_before_train=1.982728 cos_to_last_merge=0.9750 (last merge round=43)
[S17] round=89 local utility u=0.486356 metrics={'f1_val': 0.7792533848096801, 'auprc': 0.8652140859921088, 'loss_val': 0.9968845144947763, 'psi': 0.8136376652826516}-{'f1_val': 0.6991141385399589, 'auprc': 0.8324162464490528, 'loss_val': 1.3903683373335023, 'psi': 0.7524349817035965}
[S17] not sending this round → trigger blocked (psi=0.814)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=90 head_norm_before_train=2.184782 cos_to_last_merge=0.9222 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.922
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.721986097472912, 'auprc': 0.8620109702223675, 'loss_val': 0.5996933305682499, 'psi': 0.7779960465726943}-{'f1_val': 0.8272658878290791, 'auprc': 0.8919819665835974, 'loss_val': 0.42527169010465954, 'psi': 0.8531523193308864}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.158294 cos_to_last_merge=0.9803 (last merge round=44)
[S3] round=90 local utility u=0.251822 metrics={'f1_val': 0.9837849824105639, 'auprc': 0.9993835674826363, 'loss_val': 0.04560876407587461, 'psi': 0.9900244164393928}-{'f1_val': 0.9210869834778221, 'auprc': 0.9973826325794379, 'loss_val': 0.1670622642465122, 'psi': 0.9516052431184685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=90 head_norm_before_train=2.348294 (no previous merge yet)
[S4] round=90 local utility u=0.002256 metrics={'f1_val': 0.9526105483221643, 'auprc': 0.985656555028162, 'loss_val': 0.3126292360078538, 'psi': 0.9658289510045633}-{'f1_val': 0.9481669575005032, 'auprc': 0.9867218498410644, 'loss_val': 0.29367606104757155, 'psi': 0.9635889144367276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=90 head_norm_before_train=1.849302 cos_to_last_merge=0.7870 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=90 local utility u=0.004077 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9950295627650112, 'loss_val': 0.028070329747263964, 'psi': 0.9957234390915911}-{'f1_val': 0.9960402158980539, 'auprc': 0.9927075876745004, 'loss_val': 0.028383746060819413, 'psi': 0.9947071646086325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=90 head_norm_before_train=2.312456 cos_to_last_merge=0.9568 (last merge round=44)
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.922062317006231, 'auprc': 0.9542342498826544, 'loss_val': 0.29324177522664285, 'psi': 0.9349310901568003}-{'f1_val': 0.9347193356628406, 'auprc': 0.9428204698050702, 'loss_val': 0.21796675211500832, 'psi': 0.9379597893197325}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=1.957260 cos_to_last_merge=1.0000 (last merge round=88)
[S7] round=90 local utility u=0.708913 metrics={'f1_val': 0.6633917413467072, 'auprc': 0.807134806833387, 'loss_val': 0.5530802065917251, 'psi': 0.7208889675413792}-{'f1_val': 0.5484354786367296, 'auprc': 0.7818020790656293, 'loss_val': 1.2051699873257733, 'psi': 0.6417821188082895}
[S8] START round=90 head_norm_before_train=2.014661 cos_to_last_merge=0.9890 (last merge round=45)
[S8] round=90 local utility u=0.322934 metrics={'f1_val': 0.9913077019421868, 'auprc': 0.9984605456095088, 'loss_val': 0.030966699348958262, 'psi': 0.9941688394091156}-{'f1_val': 0.910656517223066, 'auprc': 0.9994270559610441, 'loss_val': 0.19582703884213817, 'psi': 0.9461647327182572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=90 head_norm_before_train=2.071346 cos_to_last_merge=0.7584 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.758
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9998117084548584, 'loss_val': 0.015652534283484894, 'psi': 0.9981847131054814}-{'f1_val': 0.9971000495392299, 'auprc': 0.9998169685936542, 'loss_val': 0.015574202294754945, 'psi': 0.9981868171609997}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.194311 cos_to_last_merge=0.9918 (last merge round=41)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.996907649058276, 'loss_val': 0.023103603046875337, 'psi': 0.9960740427049035}-{'f1_val': 0.9955183051359886, 'auprc': 0.9971179384877675, 'loss_val': 0.02311355397857886, 'psi': 0.9961581584767002}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=1.956697 cos_to_last_merge=0.9894 (last merge round=41)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998419641399921, 'loss_val': 0.02155456886893246, 'psi': 0.997048061507954}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987412581079292, 'loss_val': 0.020150616846885502, 'psi': 0.997188988089619}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=1.857777 cos_to_last_merge=0.9376 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=90 local utility u=0.337452 metrics={'f1_val': 0.7792647118935944, 'auprc': 0.9029503092903887, 'loss_val': 0.7215164305977673, 'psi': 0.8287389508523121}-{'f1_val': 0.7405121658749326, 'auprc': 0.8799497725206704, 'loss_val': 1.0949033063557407, 'psi': 0.7962872085332278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=90 head_norm_before_train=2.179241 cos_to_last_merge=0.9949 (last merge round=46)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992063369064452, 'loss_val': 0.01960899723660909, 'psi': 0.9983742455429091}-{'f1_val': 0.9982330107938716, 'auprc': 0.9991708424399548, 'loss_val': 0.01730310586591917, 'psi': 0.9986081434523049}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.084702 cos_to_last_merge=0.9761 (last merge round=42)
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9236687928143134, 'auprc': 0.9952782615964382, 'loss_val': 0.18343152572164104, 'psi': 0.9523125803271633}-{'f1_val': 0.9262955811078103, 'auprc': 0.9956694054709564, 'loss_val': 0.16760425463593806, 'psi': 0.9540451108530688}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=1.953292 cos_to_last_merge=1.0000 (last merge round=88)
[S16] round=90 local utility u=0.463021 metrics={'f1_val': 0.9915652462457047, 'auprc': 0.9916725470677957, 'loss_val': 0.03484897853717144, 'psi': 0.9916081665745411}-{'f1_val': 0.9163489897978014, 'auprc': 0.977952294097601, 'loss_val': 0.468433596917547, 'psi': 0.9409903115177213}
[S17] START round=90 head_norm_before_train=1.988725 cos_to_last_merge=0.9746 (last merge round=43)
[S17] round=90 local utility u=0.408440 metrics={'f1_val': 0.8544865907569896, 'auprc': 0.8911033924289308, 'loss_val': 0.709071129823798, 'psi': 0.8691333114257661}-{'f1_val': 0.7792533848096801, 'auprc': 0.8652140859921088, 'loss_val': 0.9968845144947763, 'psi': 0.8136376652826516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:52816
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=90 metric=0.9916 head_norm=1.959918
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.498243e-02
[S16] stored merged vector for next round verification (round=90)
[S16] DEBUG after merge:  round=90 metric=0.9916 head_norm=1.960256 delta_norm=0.014982
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.200 → S7@127.0.0.1:52808
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=90 metric=0.6634 head_norm=1.960709
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.498244e-02
[S7] stored merged vector for next round verification (round=90)
[S7] DEBUG after merge:  round=90 metric=0.6736 head_norm=1.960256 delta_norm=0.014982
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.316 → S16@127.0.0.1:52816
[S2] START round=91 head_norm_before_train=2.188376 cos_to_last_merge=0.9216 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.922
[S2] round=91 local utility u=0.571804 metrics={'f1_val': 0.8328400420692174, 'auprc': 0.9200212478296381, 'loss_val': 0.29524075130357297, 'psi': 0.8677125243733856}-{'f1_val': 0.721986097472912, 'auprc': 0.8620109702223675, 'loss_val': 0.5996933305682499, 'psi': 0.7779960465726943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=91 head_norm_before_train=2.162982 cos_to_last_merge=0.9801 (last merge round=44)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.9701388347827183, 'auprc': 0.9977542781811227, 'loss_val': 0.07240743628086377, 'psi': 0.9811850121420801}-{'f1_val': 0.9837849824105639, 'auprc': 0.9993835674826363, 'loss_val': 0.04560876407587461, 'psi': 0.9900244164393928}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=2.354208 (no previous merge yet)
[S4] round=91 local utility u=0.001784 metrics={'f1_val': 0.953400867513375, 'auprc': 0.9860616748243088, 'loss_val': 0.31501831251827633, 'psi': 0.9664651904377486}-{'f1_val': 0.9526105483221643, 'auprc': 0.985656555028162, 'loss_val': 0.3126292360078538, 'psi': 0.9658289510045633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=91 head_norm_before_train=1.858169 cos_to_last_merge=0.7861 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9912722531519478, 'loss_val': 0.028163017488855534, 'psi': 0.9942205152463657}-{'f1_val': 0.996186023309311, 'auprc': 0.9950295627650112, 'loss_val': 0.028070329747263964, 'psi': 0.9957234390915911}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=2.318993 cos_to_last_merge=0.9564 (last merge round=44)
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.8618006845171674, 'auprc': 0.8971664777577287, 'loss_val': 0.5726182571710511, 'psi': 0.8759470018133919}-{'f1_val': 0.922062317006231, 'auprc': 0.9542342498826544, 'loss_val': 0.29324177522664285, 'psi': 0.9349310901568003}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=1.960256 cos_to_last_merge=1.0000 (last merge round=90)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.6276348076447718, 'auprc': 0.7983262933698136, 'loss_val': 0.6584150192862617, 'psi': 0.6959114019347885}-{'f1_val': 0.6633917413467072, 'auprc': 0.807134806833387, 'loss_val': 0.5530802065917251, 'psi': 0.7208889675413792}
[S8] START round=91 head_norm_before_train=2.020480 cos_to_last_merge=0.9887 (last merge round=45)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9862631420740474, 'auprc': 0.9996196843208486, 'loss_val': 0.04848663128310226, 'psi': 0.9916057589727678}-{'f1_val': 0.9913077019421868, 'auprc': 0.9984605456095088, 'loss_val': 0.030966699348958262, 'psi': 0.9941688394091156}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=2.072633 cos_to_last_merge=0.7578 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.758
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9998112829403139, 'loss_val': 0.03129124409502063, 'psi': 0.9946710013130159}-{'f1_val': 0.9971000495392299, 'auprc': 0.9998117084548584, 'loss_val': 0.015652534283484894, 'psi': 0.9981847131054814}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.195879 cos_to_last_merge=0.9913 (last merge round=41)
[S10] round=91 local utility u=0.000342 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9970726660072377, 'loss_val': 0.02291447075805359, 'psi': 0.9961400494844882}-{'f1_val': 0.9955183051359886, 'auprc': 0.996907649058276, 'loss_val': 0.023103603046875337, 'psi': 0.9960740427049035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=91 head_norm_before_train=1.960881 cos_to_last_merge=0.9893 (last merge round=41)
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9984030329444491, 'loss_val': 0.022901961572252806, 'psi': 0.9968963158989281}-{'f1_val': 0.9961336749133093, 'auprc': 0.998419641399921, 'loss_val': 0.02155456886893246, 'psi': 0.997048061507954}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=1.861759 cos_to_last_merge=0.9368 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.937
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6749174076154136, 'auprc': 0.7855623570158965, 'loss_val': 1.2106198911910766, 'psi': 0.7191753873756068}-{'f1_val': 0.7792647118935944, 'auprc': 0.9029503092903887, 'loss_val': 0.7215164305977673, 'psi': 0.8287389508523121}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=2.184397 cos_to_last_merge=0.9949 (last merge round=46)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9992033946776601, 'loss_val': 0.025103613471052375, 'psi': 0.9978759840845334}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992063369064452, 'loss_val': 0.01960899723660909, 'psi': 0.9983742455429091}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=2.091028 cos_to_last_merge=0.9758 (last merge round=42)
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.9199482589194743, 'auprc': 0.9946865602277853, 'loss_val': 0.20488704632451274, 'psi': 0.9498435794427987}-{'f1_val': 0.9236687928143134, 'auprc': 0.9952782615964382, 'loss_val': 0.18343152572164104, 'psi': 0.9523125803271633}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=1.960256 cos_to_last_merge=1.0000 (last merge round=90)
[S16] round=91 local utility u=0.003339 metrics={'f1_val': 0.9923175937811748, 'auprc': 0.9930203228875445, 'loss_val': 0.036728512114151755, 'psi': 0.9925986854237226}-{'f1_val': 0.9915652462457047, 'auprc': 0.9916725470677957, 'loss_val': 0.03484897853717144, 'psi': 0.9916081665745411}
[S17] START round=91 head_norm_before_train=1.995799 cos_to_last_merge=0.9741 (last merge round=43)
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.7846217896379017, 'auprc': 0.9418977488972851, 'loss_val': 0.8230072988825343, 'psi': 0.8475321733416551}-{'f1_val': 0.8544865907569896, 'auprc': 0.8911033924289308, 'loss_val': 0.709071129823798, 'psi': 0.8691333114257661}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.194674 cos_to_last_merge=0.9210 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.7919251223045549, 'auprc': 0.8041850292707604, 'loss_val': 0.6411785067924414, 'psi': 0.7968290850910371}-{'f1_val': 0.8328400420692174, 'auprc': 0.9200212478296381, 'loss_val': 0.29524075130357297, 'psi': 0.8677125243733856}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.167066 cos_to_last_merge=0.9799 (last merge round=44)
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.8547482559969339, 'auprc': 0.9734015440507047, 'loss_val': 0.4039148572052754, 'psi': 0.9022095712184421}-{'f1_val': 0.9701388347827183, 'auprc': 0.9977542781811227, 'loss_val': 0.07240743628086377, 'psi': 0.9811850121420801}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=2.363372 (no previous merge yet)
[S4] round=92 local utility u=0.003735 metrics={'f1_val': 0.952080578125398, 'auprc': 0.9860348574614413, 'loss_val': 0.29954599977009205, 'psi': 0.9656622898598154}-{'f1_val': 0.953400867513375, 'auprc': 0.9860616748243088, 'loss_val': 0.31501831251827633, 'psi': 0.9664651904377486}
[S4] not sending this round → trigger blocked (psi=0.966)
[S5] START round=92 head_norm_before_train=1.866796 cos_to_last_merge=0.7851 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=92 local utility u=0.009762 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9976225879842268, 'loss_val': 0.02768996802404058, 'psi': 0.9967606491792773}-{'f1_val': 0.996186023309311, 'auprc': 0.9912722531519478, 'loss_val': 0.028163017488855534, 'psi': 0.9942205152463657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=92 head_norm_before_train=2.327305 cos_to_last_merge=0.9559 (last merge round=44)
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.7323697313805906, 'auprc': 0.8813471976753118, 'loss_val': 1.0314210034616476, 'psi': 0.7919607178984791}-{'f1_val': 0.8618006845171674, 'auprc': 0.8971664777577287, 'loss_val': 0.5726182571710511, 'psi': 0.8759470018133919}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.961833 cos_to_last_merge=1.0000 (last merge round=90)
[S7] round=92 local utility u=0.392304 metrics={'f1_val': 0.6901459521488253, 'auprc': 0.8571150376367926, 'loss_val': 0.4252397676863369, 'psi': 0.7569335863440123}-{'f1_val': 0.6276348076447718, 'auprc': 0.7983262933698136, 'loss_val': 0.6584150192862617, 'psi': 0.6959114019347885}
[S8] START round=92 head_norm_before_train=2.022183 cos_to_last_merge=0.9886 (last merge round=45)
[S8] round=92 local utility u=0.027774 metrics={'f1_val': 0.9934100914990341, 'auprc': 0.9992890232505824, 'loss_val': 0.03482759495343508, 'psi': 0.9957616641996534}-{'f1_val': 0.9862631420740474, 'auprc': 0.9996196843208486, 'loss_val': 0.04848663128310226, 'psi': 0.9916057589727678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=92 head_norm_before_train=2.074969 cos_to_last_merge=0.7577 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.758
[S9] round=92 local utility u=0.022298 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9998154007231499, 'loss_val': 0.016868262546025085, 'psi': 0.9976887777275036}-{'f1_val': 0.9912441468948172, 'auprc': 0.9998112829403139, 'loss_val': 0.03129124409502063, 'psi': 0.9946710013130159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=92 head_norm_before_train=2.201213 cos_to_last_merge=0.9913 (last merge round=41)
[S10] round=92 local utility u=0.000319 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972524994648175, 'loss_val': 0.02281628518302506, 'psi': 0.9962119828675202}-{'f1_val': 0.9955183051359886, 'auprc': 0.9970726660072377, 'loss_val': 0.02291447075805359, 'psi': 0.9961400494844882}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=92 head_norm_before_train=1.965660 cos_to_last_merge=0.9891 (last merge round=41)
[S11] round=92 local utility u=0.002085 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986728296134059, 'loss_val': 0.020992807217089536, 'psi': 0.9971493367933479}-{'f1_val': 0.9958918378685807, 'auprc': 0.9984030329444491, 'loss_val': 0.022901961572252806, 'psi': 0.9968963158989281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=92 head_norm_before_train=1.860042 cos_to_last_merge=0.9367 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.937
[S13] round=92 local utility u=0.405188 metrics={'f1_val': 0.7744948132843503, 'auprc': 0.8243971260222147, 'loss_val': 1.1142125790451567, 'psi': 0.7944557383794961}-{'f1_val': 0.6749174076154136, 'auprc': 0.7855623570158965, 'loss_val': 1.2106198911910766, 'psi': 0.7191753873756068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=92 head_norm_before_train=2.190094 cos_to_last_merge=0.9948 (last merge round=46)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9577926017469479, 'auprc': 0.9994926219924891, 'loss_val': 0.04977650879780085, 'psi': 0.9744726098451644}-{'f1_val': 0.9969910436891155, 'auprc': 0.9992033946776601, 'loss_val': 0.025103613471052375, 'psi': 0.9978759840845334}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=2.097224 cos_to_last_merge=0.9754 (last merge round=42)
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.9199482589194743, 'auprc': 0.9943479146561576, 'loss_val': 0.2074677012992999, 'psi': 0.9497081212141476}-{'f1_val': 0.9199482589194743, 'auprc': 0.9946865602277853, 'loss_val': 0.20488704632451274, 'psi': 0.9498435794427987}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=92 head_norm_before_train=1.968949 cos_to_last_merge=1.0000 (last merge round=90)
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9923175937811748, 'auprc': 0.9910627416707734, 'loss_val': 0.037155891312395446, 'psi': 0.9918156529370142}-{'f1_val': 0.9923175937811748, 'auprc': 0.9930203228875445, 'loss_val': 0.036728512114151755, 'psi': 0.9925986854237226}
[S17] START round=92 head_norm_before_train=2.002034 cos_to_last_merge=0.9735 (last merge round=43)
[S17] round=92 local utility u=0.256439 metrics={'f1_val': 0.878491724500639, 'auprc': 0.8569292948214449, 'loss_val': 0.6184426576750753, 'psi': 0.8698667526289613}-{'f1_val': 0.7846217896379017, 'auprc': 0.9418977488972851, 'loss_val': 0.8230072988825343, 'psi': 0.8475321733416551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.9999
[S2] START round=93 head_norm_before_train=2.202658 cos_to_last_merge=0.9211 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=93 local utility u=0.535525 metrics={'f1_val': 0.8330322449455301, 'auprc': 0.9700187574697677, 'loss_val': 0.314272165095939, 'psi': 0.8878268499552251}-{'f1_val': 0.7919251223045549, 'auprc': 0.8041850292707604, 'loss_val': 0.6411785067924414, 'psi': 0.7968290850910371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=93 head_norm_before_train=2.168514 cos_to_last_merge=0.9797 (last merge round=44)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.7078607012295295, 'auprc': 0.9386799472902696, 'loss_val': 1.0078551497153092, 'psi': 0.8001883996538255}-{'f1_val': 0.8547482559969339, 'auprc': 0.9734015440507047, 'loss_val': 0.4039148572052754, 'psi': 0.9022095712184421}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=2.370163 (no previous merge yet)
[S4] round=93 local utility u=0.021081 metrics={'f1_val': 0.9554283140578081, 'auprc': 0.9866278898196532, 'loss_val': 0.27924909750855126, 'psi': 0.9679081443625461}-{'f1_val': 0.952080578125398, 'auprc': 0.9860348574614413, 'loss_val': 0.29954599977009205, 'psi': 0.9656622898598154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=93 head_norm_before_train=1.867699 cos_to_last_merge=0.7853 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.993885803660178, 'loss_val': 0.02790538923869347, 'psi': 0.9952659354496578}-{'f1_val': 0.996186023309311, 'auprc': 0.9976225879842268, 'loss_val': 0.02768996802404058, 'psi': 0.9967606491792773}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=2.334919 cos_to_last_merge=0.9556 (last merge round=44)
[S6] round=93 local utility u=1.000000 metrics={'f1_val': 0.9720083330021908, 'auprc': 0.9855428078688886, 'loss_val': 0.07802534575797167, 'psi': 0.97742212294887}-{'f1_val': 0.7323697313805906, 'auprc': 0.8813471976753118, 'loss_val': 1.0314210034616476, 'psi': 0.7919607178984791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=93 head_norm_before_train=1.962922 cos_to_last_merge=0.9999 (last merge round=90)
[S7] round=93 local utility u=0.077535 metrics={'f1_val': 0.7273762750517673, 'auprc': 0.842236562631257, 'loss_val': 0.44891704057479404, 'psi': 0.7733203900835632}-{'f1_val': 0.6901459521488253, 'auprc': 0.8571150376367926, 'loss_val': 0.4252397676863369, 'psi': 0.7569335863440123}
[S8] START round=93 head_norm_before_train=2.026638 cos_to_last_merge=0.9883 (last merge round=45)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9926820383061284, 'auprc': 0.9988433673896968, 'loss_val': 0.0310479463846257, 'psi': 0.9951465699395557}-{'f1_val': 0.9934100914990341, 'auprc': 0.9992890232505824, 'loss_val': 0.03482759495343508, 'psi': 0.9957616641996534}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=2.078994 cos_to_last_merge=0.7574 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.757
[S9] round=93 local utility u=0.001384 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998327206486526, 'loss_val': 0.01648979727442266, 'psi': 0.9979293953477959}-{'f1_val': 0.9962710290637395, 'auprc': 0.9998154007231499, 'loss_val': 0.016868262546025085, 'psi': 0.9976887777275036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=93 head_norm_before_train=2.206448 cos_to_last_merge=0.9912 (last merge round=41)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972258445480305, 'loss_val': 0.022999443334694114, 'psi': 0.9962013209008054}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972524994648175, 'loss_val': 0.02281628518302506, 'psi': 0.9962119828675202}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=1.970639 cos_to_last_merge=0.9889 (last merge round=41)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.6933562117034714, 'auprc': 0.9397026060485862, 'loss_val': 1.257879487505254, 'psi': 0.7918947694415174}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986728296134059, 'loss_val': 0.020992807217089536, 'psi': 0.9971493367933479}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.859387 cos_to_last_merge=0.9368 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.937
[S13] round=93 local utility u=0.316661 metrics={'f1_val': 0.775374680262678, 'auprc': 0.9058980704624989, 'loss_val': 0.7306722135086906, 'psi': 0.8275840363426064}-{'f1_val': 0.7744948132843503, 'auprc': 0.8243971260222147, 'loss_val': 1.1142125790451567, 'psi': 0.7944557383794961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=93 head_norm_before_train=2.191793 cos_to_last_merge=0.9946 (last merge round=46)
[S14] round=93 local utility u=0.119733 metrics={'f1_val': 0.9944935406943898, 'auprc': 0.9995653780225435, 'loss_val': 0.03073535648462764, 'psi': 0.9965222756256513}-{'f1_val': 0.9577926017469479, 'auprc': 0.9994926219924891, 'loss_val': 0.04977650879780085, 'psi': 0.9744726098451644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=93 head_norm_before_train=2.103454 cos_to_last_merge=0.9751 (last merge round=42)
[S15] round=93 local utility u=0.001886 metrics={'f1_val': 0.920482890440086, 'auprc': 0.9940372244264387, 'loss_val': 0.20597125097149505, 'psi': 0.9499046240346272}-{'f1_val': 0.9199482589194743, 'auprc': 0.9943479146561576, 'loss_val': 0.2074677012992999, 'psi': 0.9497081212141476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=93 head_norm_before_train=1.978382 cos_to_last_merge=1.0000 (last merge round=90)
[S16] round=93 local utility u=0.000452 metrics={'f1_val': 0.992094582938667, 'auprc': 0.9915883813479676, 'loss_val': 0.03649007273289023, 'psi': 0.9918921023023872}-{'f1_val': 0.9923175937811748, 'auprc': 0.9910627416707734, 'loss_val': 0.037155891312395446, 'psi': 0.9918156529370142}
[S17] START round=93 head_norm_before_train=2.007436 cos_to_last_merge=0.9731 (last merge round=43)
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.7853854690380015, 'auprc': 0.8840442621967096, 'loss_val': 0.9638150057867032, 'psi': 0.8248489863014847}-{'f1_val': 0.878491724500639, 'auprc': 0.8569292948214449, 'loss_val': 0.6184426576750753, 'psi': 0.8698667526289613}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S16] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] cosine check vs S7: cos=0.9998
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=93 metric=0.9921 head_norm=1.985597
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.954381e-02
[S16] stored merged vector for next round verification (round=93)
[S16] DEBUG after merge:  round=93 metric=0.9921 head_norm=1.974945 delta_norm=0.019544
[S16] aggregate: ACCEPT kept=['S7', 'S7'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=93 metric=0.7274 head_norm=1.965949
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.069214e-02
[S7] stored merged vector for next round verification (round=93)
[S7] DEBUG after merge:  round=93 metric=0.6884 head_norm=1.975689 delta_norm=0.020692
[S7] aggregate: ROLLBACK (f1_val pre=0.727 post=0.688 tol_abs=0.005 tol_rel=0.0)
[S2] START round=94 head_norm_before_train=2.212979 cos_to_last_merge=0.9211 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.8334343888545236, 'auprc': 0.9450878810112177, 'loss_val': 0.3516660714512319, 'psi': 0.8780957857172011}-{'f1_val': 0.8330322449455301, 'auprc': 0.9700187574697677, 'loss_val': 0.314272165095939, 'psi': 0.8878268499552251}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.172152 cos_to_last_merge=0.9795 (last merge round=44)
[S3] round=94 local utility u=0.357228 metrics={'f1_val': 0.7658220857648395, 'auprc': 0.975186748959088, 'loss_val': 0.7506872748851998, 'psi': 0.8495679510425389}-{'f1_val': 0.7078607012295295, 'auprc': 0.9386799472902696, 'loss_val': 1.0078551497153092, 'psi': 0.8001883996538255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=94 head_norm_before_train=2.371883 (no previous merge yet)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9524865040066982, 'auprc': 0.9861940005481855, 'loss_val': 0.2738995808087679, 'psi': 0.9659695026232932}-{'f1_val': 0.9554283140578081, 'auprc': 0.9866278898196532, 'loss_val': 0.27924909750855126, 'psi': 0.9679081443625461}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.871355 cos_to_last_merge=0.7852 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9921484468120867, 'loss_val': 0.02739250660161958, 'psi': 0.9945709927104213}-{'f1_val': 0.996186023309311, 'auprc': 0.993885803660178, 'loss_val': 0.02790538923869347, 'psi': 0.9952659354496578}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=2.341442 cos_to_last_merge=0.9550 (last merge round=44)
[S6] round=94 local utility u=0.052858 metrics={'f1_val': 0.9864700774810946, 'auprc': 0.9877031974922967, 'loss_val': 0.06556194971354914, 'psi': 0.9869633254855754}-{'f1_val': 0.9720083330021908, 'auprc': 0.9855428078688886, 'loss_val': 0.07802534575797167, 'psi': 0.97742212294887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=94 head_norm_before_train=1.975689 cos_to_last_merge=1.0000 (last merge round=93)
[S7] round=94 local utility u=0.756080 metrics={'f1_val': 0.8567687071591819, 'auprc': 0.9900437920073806, 'loss_val': 0.15653263105882373, 'psi': 0.9100787410984613}-{'f1_val': 0.7273762750517673, 'auprc': 0.842236562631257, 'loss_val': 0.44891704057479404, 'psi': 0.7733203900835632}
[S8] START round=94 head_norm_before_train=2.033391 cos_to_last_merge=0.9881 (last merge round=45)
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.7293193151123368, 'auprc': 0.9867751782568106, 'loss_val': 1.1592665885746924, 'psi': 0.8323016603701263}-{'f1_val': 0.9926820383061284, 'auprc': 0.9988433673896968, 'loss_val': 0.0310479463846257, 'psi': 0.9951465699395557}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=94 head_norm_before_train=2.083791 cos_to_last_merge=0.7571 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.757
[S9] round=94 local utility u=0.000198 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998189164122495, 'loss_val': 0.016053021025131564, 'psi': 0.9979238736532346}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998327206486526, 'loss_val': 0.01648979727442266, 'psi': 0.9979293953477959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=94 head_norm_before_train=2.209129 cos_to_last_merge=0.9909 (last merge round=41)
[S10] round=94 local utility u=0.000012 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9972898685276587, 'loss_val': 0.023167158910296616, 'psi': 0.9962269304926566}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972258445480305, 'loss_val': 0.022999443334694114, 'psi': 0.9962013209008054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=94 head_norm_before_train=1.973593 cos_to_last_merge=0.9888 (last merge round=41)
[S11] round=94 local utility u=1.000000 metrics={'f1_val': 0.9773749954864703, 'auprc': 0.9971914865186887, 'loss_val': 0.0762452371776907, 'psi': 0.9853015918993576}-{'f1_val': 0.6933562117034714, 'auprc': 0.9397026060485862, 'loss_val': 1.257879487505254, 'psi': 0.7918947694415174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=94 head_norm_before_train=1.861555 cos_to_last_merge=0.9364 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.7205911454894809, 'auprc': 0.8206775214820305, 'loss_val': 1.0902171001296181, 'psi': 0.7606256958865008}-{'f1_val': 0.775374680262678, 'auprc': 0.9058980704624989, 'loss_val': 0.7306722135086906, 'psi': 0.8275840363426064}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=2.193615 cos_to_last_merge=0.9944 (last merge round=46)
[S14] round=94 local utility u=0.015252 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9995928287866965, 'loss_val': 0.02026991918059934, 'psi': 0.9985288422950096}-{'f1_val': 0.9944935406943898, 'auprc': 0.9995653780225435, 'loss_val': 0.03073535648462764, 'psi': 0.9965222756256513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=94 head_norm_before_train=2.109372 cos_to_last_merge=0.9748 (last merge round=42)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9188758249649953, 'auprc': 0.9936908477928966, 'loss_val': 0.21727146946048628, 'psi': 0.9488018340961559}-{'f1_val': 0.920482890440086, 'auprc': 0.9940372244264387, 'loss_val': 0.20597125097149505, 'psi': 0.9499046240346272}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=1.974945 cos_to_last_merge=1.0000 (last merge round=93)
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.8773600394951677, 'auprc': 0.9862799031880511, 'loss_val': 0.49014155422771205, 'psi': 0.9209279849723211}-{'f1_val': 0.992094582938667, 'auprc': 0.9915883813479676, 'loss_val': 0.03649007273289023, 'psi': 0.9918921023023872}
[S17] START round=94 head_norm_before_train=2.011599 cos_to_last_merge=0.9727 (last merge round=43)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.7430567482557935, 'auprc': 0.8832208904745401, 'loss_val': 1.1709463023539732, 'psi': 0.7991224051432921}-{'f1_val': 0.7853854690380015, 'auprc': 0.8840442621967096, 'loss_val': 0.9638150057867032, 'psi': 0.8248489863014847}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:52816
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=1.0000
[S2] START round=95 head_norm_before_train=2.220552 cos_to_last_merge=0.9206 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.921
[S2] round=95 local utility u=0.239023 metrics={'f1_val': 0.9098436900048912, 'auprc': 0.9274936233223237, 'loss_val': 0.27929383871723595, 'psi': 0.9169036633318641}-{'f1_val': 0.8334343888545236, 'auprc': 0.9450878810112177, 'loss_val': 0.3516660714512319, 'psi': 0.8780957857172011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=95 head_norm_before_train=2.177202 cos_to_last_merge=0.9793 (last merge round=44)
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.6905454813773613, 'auprc': 0.9332711786621098, 'loss_val': 0.975622867792508, 'psi': 0.7876357602912607}-{'f1_val': 0.7658220857648395, 'auprc': 0.975186748959088, 'loss_val': 0.7506872748851998, 'psi': 0.8495679510425389}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=95 head_norm_before_train=2.376354 (no previous merge yet)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9501881588209967, 'auprc': 0.9863555957825739, 'loss_val': 0.2735480114416027, 'psi': 0.9646551336056276}-{'f1_val': 0.9524865040066982, 'auprc': 0.9861940005481855, 'loss_val': 0.2738995808087679, 'psi': 0.9659695026232932}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.878341 cos_to_last_merge=0.7846 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=95 local utility u=0.007823 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9972788223948926, 'loss_val': 0.027137213908884607, 'psi': 0.9966231429435437}-{'f1_val': 0.996186023309311, 'auprc': 0.9921484468120867, 'loss_val': 0.02739250660161958, 'psi': 0.9945709927104213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=95 head_norm_before_train=2.349257 cos_to_last_merge=0.9544 (last merge round=44)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.8074772891649843, 'auprc': 0.9340370057201933, 'loss_val': 0.5988919918980097, 'psi': 0.8581011757870679}-{'f1_val': 0.9864700774810946, 'auprc': 0.9877031974922967, 'loss_val': 0.06556194971354914, 'psi': 0.9869633254855754}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.980047 cos_to_last_merge=1.0000 (last merge round=93)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.5985060968620652, 'auprc': 0.7943040753209399, 'loss_val': 0.9013396932191553, 'psi': 0.6768252882456152}-{'f1_val': 0.8567687071591819, 'auprc': 0.9900437920073806, 'loss_val': 0.15653263105882373, 'psi': 0.9100787410984613}
[S8] START round=95 head_norm_before_train=2.038144 cos_to_last_merge=0.9878 (last merge round=45)
[S8] round=95 local utility u=1.000000 metrics={'f1_val': 0.9939539858461368, 'auprc': 0.9986391890242627, 'loss_val': 0.027631139138679563, 'psi': 0.9958280671173871}-{'f1_val': 0.7293193151123368, 'auprc': 0.9867751782568106, 'loss_val': 1.1592665885746924, 'psi': 0.8323016603701263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=95 head_norm_before_train=2.088692 cos_to_last_merge=0.7570 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.757
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9998005850826399, 'loss_val': 0.01699239237100353, 'psi': 0.9974162650515672}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998189164122495, 'loss_val': 0.016053021025131564, 'psi': 0.9979238736532346}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.214916 cos_to_last_merge=0.9910 (last merge round=41)
[S10] round=95 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9971877759502213, 'loss_val': 0.02299753552171104, 'psi': 0.9961860934616817}-{'f1_val': 0.9955183051359886, 'auprc': 0.9972898685276587, 'loss_val': 0.023167158910296616, 'psi': 0.9962269304926566}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=95 head_norm_before_train=1.974909 cos_to_last_merge=0.9887 (last merge round=41)
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.8477407841464972, 'auprc': 0.9954500875944116, 'loss_val': 0.28652313955449216, 'psi': 0.906824505525663}-{'f1_val': 0.9773749954864703, 'auprc': 0.9971914865186887, 'loss_val': 0.0762452371776907, 'psi': 0.9853015918993576}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.865251 cos_to_last_merge=0.9357 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=95 local utility u=0.212760 metrics={'f1_val': 0.7642711339317266, 'auprc': 0.8260153154139831, 'loss_val': 0.9427909280920668, 'psi': 0.7889688065246292}-{'f1_val': 0.7205911454894809, 'auprc': 0.8206775214820305, 'loss_val': 1.0902171001296181, 'psi': 0.7606256958865008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=95 head_norm_before_train=2.197368 cos_to_last_merge=0.9942 (last merge round=46)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9679536653748086, 'auprc': 0.9989277396638169, 'loss_val': 0.04860957693502712, 'psi': 0.980343295090412}-{'f1_val': 0.9978195179672185, 'auprc': 0.9995928287866965, 'loss_val': 0.02026991918059934, 'psi': 0.9985288422950096}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.115070 cos_to_last_merge=0.9744 (last merge round=42)
[S15] round=95 local utility u=0.004674 metrics={'f1_val': 0.9195964050708181, 'auprc': 0.9935625922112771, 'loss_val': 0.2118619796060332, 'psi': 0.9491828799270017}-{'f1_val': 0.9188758249649953, 'auprc': 0.9936908477928966, 'loss_val': 0.21727146946048628, 'psi': 0.9488018340961559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=95 head_norm_before_train=1.979050 cos_to_last_merge=1.0000 (last merge round=93)
[S16] round=95 local utility u=0.582520 metrics={'f1_val': 0.9930936843367727, 'auprc': 0.9905114396760153, 'loss_val': 0.032198291806415875, 'psi': 0.9920607864724698}-{'f1_val': 0.8773600394951677, 'auprc': 0.9862799031880511, 'loss_val': 0.49014155422771205, 'psi': 0.9209279849723211}
[S17] START round=95 head_norm_before_train=2.016258 cos_to_last_merge=0.9724 (last merge round=43)
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.7335256341254579, 'auprc': 0.847070160552765, 'loss_val': 1.2129791751437873, 'psi': 0.7789434446963808}-{'f1_val': 0.7430567482557935, 'auprc': 0.8832208904745401, 'loss_val': 1.1709463023539732, 'psi': 0.7991224051432921}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.275 → S16@127.0.0.1:52816
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=95 metric=0.9931 head_norm=1.986601
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.098768e-02
[S16] stored merged vector for next round verification (round=95)
[S16] DEBUG after merge:  round=95 metric=0.9931 head_norm=1.983296 delta_norm=0.010988
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.182 → S7@127.0.0.1:52808
[S2] START round=96 head_norm_before_train=2.223560 cos_to_last_merge=0.9201 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.920
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.8123450435160613, 'auprc': 0.8900499881876222, 'loss_val': 0.38701458305821806, 'psi': 0.8434270213846857}-{'f1_val': 0.9098436900048912, 'auprc': 0.9274936233223237, 'loss_val': 0.27929383871723595, 'psi': 0.9169036633318641}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.182037 cos_to_last_merge=0.9790 (last merge round=44)
[S3] round=96 local utility u=1.000000 metrics={'f1_val': 0.970635380307765, 'auprc': 0.9962973132837805, 'loss_val': 0.0722480380679162, 'psi': 0.9809001534981712}-{'f1_val': 0.6905454813773613, 'auprc': 0.9332711786621098, 'loss_val': 0.975622867792508, 'psi': 0.7876357602912607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=96 head_norm_before_train=2.380864 (no previous merge yet)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9518207645072805, 'auprc': 0.9858223918725757, 'loss_val': 0.30443654860521835, 'psi': 0.9654214154533987}-{'f1_val': 0.9501881588209967, 'auprc': 0.9863555957825739, 'loss_val': 0.2735480114416027, 'psi': 0.9646551336056276}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=1.883105 cos_to_last_merge=0.7839 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9934678435077711, 'loss_val': 0.027703221021204674, 'psi': 0.9950987513886951}-{'f1_val': 0.996186023309311, 'auprc': 0.9972788223948926, 'loss_val': 0.027137213908884607, 'psi': 0.9966231429435437}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=2.359643 cos_to_last_merge=0.9540 (last merge round=44)
[S6] round=96 local utility u=0.102080 metrics={'f1_val': 0.8142038661527755, 'auprc': 0.9315588437032798, 'loss_val': 0.42765725038381636, 'psi': 0.8611458571729772}-{'f1_val': 0.8074772891649843, 'auprc': 0.9340370057201933, 'loss_val': 0.5988919918980097, 'psi': 0.8581011757870679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=96 head_norm_before_train=1.982685 cos_to_last_merge=1.0000 (last merge round=93)
[S7] round=96 local utility u=1.000000 metrics={'f1_val': 0.7618336968432766, 'auprc': 0.9750045152174597, 'loss_val': 0.1801606874457001, 'psi': 0.8471020241929499}-{'f1_val': 0.5985060968620652, 'auprc': 0.7943040753209399, 'loss_val': 0.9013396932191553, 'psi': 0.6768252882456152}
[S8] START round=96 head_norm_before_train=2.043601 cos_to_last_merge=0.9875 (last merge round=45)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9855580735015469, 'auprc': 0.9995693981389164, 'loss_val': 0.04905752117714109, 'psi': 0.9911626033564946}-{'f1_val': 0.9939539858461368, 'auprc': 0.9986391890242627, 'loss_val': 0.027631139138679563, 'psi': 0.9958280671173871}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.093736 cos_to_last_merge=0.7569 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.757
[S9] round=96 local utility u=0.002812 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998118445280944, 'loss_val': 0.01640401354513836, 'psi': 0.9979210448995726}-{'f1_val': 0.9958267183641853, 'auprc': 0.9998005850826399, 'loss_val': 0.01699239237100353, 'psi': 0.9974162650515672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=96 head_norm_before_train=2.219198 cos_to_last_merge=0.9909 (last merge round=41)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9971635333676744, 'loss_val': 0.0231537965417014, 'psi': 0.996176396428663}-{'f1_val': 0.9955183051359886, 'auprc': 0.9971877759502213, 'loss_val': 0.02299753552171104, 'psi': 0.9961860934616817}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=1.976291 cos_to_last_merge=0.9886 (last merge round=41)
[S11] round=96 local utility u=0.272213 metrics={'f1_val': 0.9112615529459192, 'auprc': 0.9970398011979205, 'loss_val': 0.12799180173538602, 'psi': 0.9455728522467197}-{'f1_val': 0.8477407841464972, 'auprc': 0.9954500875944116, 'loss_val': 0.28652313955449216, 'psi': 0.906824505525663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=96 head_norm_before_train=1.877490 cos_to_last_merge=0.9345 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6935247678037857, 'auprc': 0.7381718943373097, 'loss_val': 1.3197788045000631, 'psi': 0.7113836184171953}-{'f1_val': 0.7642711339317266, 'auprc': 0.8260153154139831, 'loss_val': 0.9427909280920668, 'psi': 0.7889688065246292}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.201708 cos_to_last_merge=0.9941 (last merge round=46)
[S14] round=96 local utility u=0.105608 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992016659244594, 'loss_val': 0.017410593097054793, 'psi': 0.9983723771501147}-{'f1_val': 0.9679536653748086, 'auprc': 0.9989277396638169, 'loss_val': 0.04860957693502712, 'psi': 0.980343295090412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=96 head_norm_before_train=2.120682 cos_to_last_merge=0.9741 (last merge round=42)
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.9195964050708181, 'auprc': 0.99336107335033, 'loss_val': 0.212028562288461, 'psi': 0.9491022723826229}-{'f1_val': 0.9195964050708181, 'auprc': 0.9935625922112771, 'loss_val': 0.2118619796060332, 'psi': 0.9491828799270017}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=1.983296 cos_to_last_merge=1.0000 (last merge round=95)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9932682580530146, 'auprc': 0.987902890736445, 'loss_val': 0.032171609753024605, 'psi': 0.9911221111263867}-{'f1_val': 0.9930936843367727, 'auprc': 0.9905114396760153, 'loss_val': 0.032198291806415875, 'psi': 0.9920607864724698}
[S17] START round=96 head_norm_before_train=2.021197 cos_to_last_merge=0.9722 (last merge round=43)
[S17] round=96 local utility u=0.079228 metrics={'f1_val': 0.7398942377454678, 'auprc': 0.8817463368182834, 'loss_val': 1.1967642340068163, 'psi': 0.796635077374594}-{'f1_val': 0.7335256341254579, 'auprc': 0.847070160552765, 'loss_val': 1.2129791751437873, 'psi': 0.7789434446963808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:52816
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S7
[S16] cosine check vs S7: cos=1.0000
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=96 metric=0.7618 head_norm=1.984905
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.291703e-02
[S7] stored merged vector for next round verification (round=96)
[S7] DEBUG after merge:  round=96 metric=0.7590 head_norm=1.985711 delta_norm=0.012917
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=97 head_norm_before_train=2.228688 cos_to_last_merge=0.9194 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.919
[S2] round=97 local utility u=0.166994 metrics={'f1_val': 0.8322706172101254, 'auprc': 0.9503976540971122, 'loss_val': 0.3536236845975963, 'psi': 0.87952143196492}-{'f1_val': 0.8123450435160613, 'auprc': 0.8900499881876222, 'loss_val': 0.38701458305821806, 'psi': 0.8434270213846857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=97 head_norm_before_train=2.187313 cos_to_last_merge=0.9787 (last merge round=44)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.9601028420892053, 'auprc': 0.9991783631216771, 'loss_val': 0.15592711082104194, 'psi': 0.975733050502194}-{'f1_val': 0.970635380307765, 'auprc': 0.9962973132837805, 'loss_val': 0.0722480380679162, 'psi': 0.9809001534981712}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=2.386822 (no previous merge yet)
[S4] round=97 local utility u=0.013176 metrics={'f1_val': 0.9544059268102161, 'auprc': 0.9864782453868842, 'loss_val': 0.2955631532858122, 'psi': 0.9672348542408833}-{'f1_val': 0.9518207645072805, 'auprc': 0.9858223918725757, 'loss_val': 0.30443654860521835, 'psi': 0.9654214154533987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=97 head_norm_before_train=1.886514 cos_to_last_merge=0.7837 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9908893258406599, 'loss_val': 0.028204862506502552, 'psi': 0.9940673443218506}-{'f1_val': 0.996186023309311, 'auprc': 0.9934678435077711, 'loss_val': 0.027703221021204674, 'psi': 0.9950987513886951}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=2.368102 cos_to_last_merge=0.9536 (last merge round=44)
[S6] round=97 local utility u=0.488583 metrics={'f1_val': 0.9225395620738821, 'auprc': 0.9668775510985647, 'loss_val': 0.20646059786405416, 'psi': 0.9402747576837551}-{'f1_val': 0.8142038661527755, 'auprc': 0.9315588437032798, 'loss_val': 0.42765725038381636, 'psi': 0.8611458571729772}
[S6] not sending this round → trigger blocked (psi=0.940)
[S7] START round=97 head_norm_before_train=1.985711 cos_to_last_merge=1.0000 (last merge round=96)
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.6531723748470349, 'auprc': 0.8141337705149411, 'loss_val': 0.4522727867489631, 'psi': 0.7175569331141973}-{'f1_val': 0.7618336968432766, 'auprc': 0.9750045152174597, 'loss_val': 0.1801606874457001, 'psi': 0.8471020241929499}
[S8] START round=97 head_norm_before_train=2.050301 cos_to_last_merge=0.9873 (last merge round=45)
[S8] round=97 local utility u=0.001582 metrics={'f1_val': 0.9859103570190708, 'auprc': 0.9993579943943847, 'loss_val': 0.04737209495772922, 'psi': 0.9912894119691964}-{'f1_val': 0.9855580735015469, 'auprc': 0.9995693981389164, 'loss_val': 0.04905752117714109, 'psi': 0.9911626033564946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=97 head_norm_before_train=2.099277 cos_to_last_merge=0.7566 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.757
[S9] round=97 local utility u=0.001663 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9998053855350104, 'loss_val': 0.015524840855054903, 'psi': 0.9981650021356243}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998118445280944, 'loss_val': 0.01640401354513836, 'psi': 0.9979210448995726}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=97 head_norm_before_train=2.221961 cos_to_last_merge=0.9905 (last merge round=41)
[S10] round=97 local utility u=0.000080 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9971806820722493, 'loss_val': 0.023046111917746248, 'psi': 0.9961832559104928}-{'f1_val': 0.9955183051359886, 'auprc': 0.9971635333676744, 'loss_val': 0.0231537965417014, 'psi': 0.996176396428663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=97 head_norm_before_train=1.977004 cos_to_last_merge=0.9886 (last merge round=41)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.8239105826225306, 'auprc': 0.9961839566954266, 'loss_val': 0.46843154173696633, 'psi': 0.892819932251689}-{'f1_val': 0.9112615529459192, 'auprc': 0.9970398011979205, 'loss_val': 0.12799180173538602, 'psi': 0.9455728522467197}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=1.886019 cos_to_last_merge=0.9336 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.934
[S13] round=97 local utility u=0.437192 metrics={'f1_val': 0.7757474364763516, 'auprc': 0.7876111572000217, 'loss_val': 1.0870479428246393, 'psi': 0.7804929247658197}-{'f1_val': 0.6935247678037857, 'auprc': 0.7381718943373097, 'loss_val': 1.3197788045000631, 'psi': 0.7113836184171953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=97 head_norm_before_train=2.207160 cos_to_last_merge=0.9940 (last merge round=46)
[S14] round=97 local utility u=0.003299 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9995536227593447, 'loss_val': 0.014349567873668667, 'psi': 0.9987612555800609}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992016659244594, 'loss_val': 0.017410593097054793, 'psi': 0.9983723771501147}
[S14] not sending this round → trigger blocked (psi=0.999)
[S15] START round=97 head_norm_before_train=2.126270 cos_to_last_merge=0.9738 (last merge round=42)
[S15] round=97 local utility u=0.001717 metrics={'f1_val': 0.9201308171911596, 'auprc': 0.9929704979154782, 'loss_val': 0.21063024141377015, 'psi': 0.9492666894808871}-{'f1_val': 0.9195964050708181, 'auprc': 0.99336107335033, 'loss_val': 0.212028562288461, 'psi': 0.9491022723826229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=97 head_norm_before_train=1.992202 cos_to_last_merge=1.0000 (last merge round=95)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9928059589596947, 'auprc': 0.9870056980626722, 'loss_val': 0.03571863355382497, 'psi': 0.9904858546008858}-{'f1_val': 0.9932682580530146, 'auprc': 0.987902890736445, 'loss_val': 0.032171609753024605, 'psi': 0.9911221111263867}
[S17] START round=97 head_norm_before_train=2.025289 cos_to_last_merge=0.9718 (last merge round=43)
[S17] round=97 local utility u=0.393557 metrics={'f1_val': 0.8247745535759918, 'auprc': 0.8396396841210717, 'loss_val': 0.7926130736676069, 'psi': 0.8307206057940237}-{'f1_val': 0.7398942377454678, 'auprc': 0.8817463368182834, 'loss_val': 1.1967642340068163, 'psi': 0.796635077374594}
[S17] not sending this round → trigger blocked (psi=0.831)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=97 metric=0.9928 head_norm=1.999470
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.435669e-02
[S16] stored merged vector for next round verification (round=97)
[S16] DEBUG after merge:  round=97 metric=0.9928 head_norm=1.992149 delta_norm=0.014357
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=98 head_norm_before_train=2.237463 cos_to_last_merge=0.9189 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.919
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7463376484217865, 'auprc': 0.8656494332819804, 'loss_val': 0.5694718838001215, 'psi': 0.794062362365864}-{'f1_val': 0.8322706172101254, 'auprc': 0.9503976540971122, 'loss_val': 0.3536236845975963, 'psi': 0.87952143196492}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.192074 cos_to_last_merge=0.9785 (last merge round=44)
[S3] round=98 local utility u=0.121929 metrics={'f1_val': 0.982537901173439, 'auprc': 0.9991761343167107, 'loss_val': 0.04667360074975424, 'psi': 0.9891931944307477}-{'f1_val': 0.9601028420892053, 'auprc': 0.9991783631216771, 'loss_val': 0.15592711082104194, 'psi': 0.975733050502194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=98 head_norm_before_train=2.391938 (no previous merge yet)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9486159809828555, 'auprc': 0.9832312020850704, 'loss_val': 0.3076330529903811, 'psi': 0.9624620694237414}-{'f1_val': 0.9544059268102161, 'auprc': 0.9864782453868842, 'loss_val': 0.2955631532858122, 'psi': 0.9672348542408833}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=1.887122 cos_to_last_merge=0.7840 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=98 local utility u=0.008886 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9965205547160527, 'loss_val': 0.02732649829619352, 'psi': 0.9963198358720077}-{'f1_val': 0.996186023309311, 'auprc': 0.9908893258406599, 'loss_val': 0.028204862506502552, 'psi': 0.9940673443218506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=98 head_norm_before_train=2.375313 cos_to_last_merge=0.9532 (last merge round=44)
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.9040058186869702, 'auprc': 0.9684651637956889, 'loss_val': 0.27293606946910176, 'psi': 0.9297895567304577}-{'f1_val': 0.9225395620738821, 'auprc': 0.9668775510985647, 'loss_val': 0.20646059786405416, 'psi': 0.9402747576837551}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=98 head_norm_before_train=1.987634 cos_to_last_merge=1.0000 (last merge round=96)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6156091970123072, 'auprc': 0.7999319487857474, 'loss_val': 0.8236880332624319, 'psi': 0.6893382977216833}-{'f1_val': 0.6531723748470349, 'auprc': 0.8141337705149411, 'loss_val': 0.4522727867489631, 'psi': 0.7175569331141973}
[S8] START round=98 head_norm_before_train=2.056901 cos_to_last_merge=0.9870 (last merge round=45)
[S8] round=98 local utility u=0.021679 metrics={'f1_val': 0.9915940414364243, 'auprc': 0.9974487574735105, 'loss_val': 0.03238874942443914, 'psi': 0.9939359278512587}-{'f1_val': 0.9859103570190708, 'auprc': 0.9993579943943847, 'loss_val': 0.04737209495772922, 'psi': 0.9912894119691964}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=98 head_norm_before_train=2.104768 cos_to_last_merge=0.7563 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.756
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.9996917321483317, 'loss_val': 0.04094552976705627, 'psi': 0.992949028951243}-{'f1_val': 0.9970714132027002, 'auprc': 0.9998053855350104, 'loss_val': 0.015524840855054903, 'psi': 0.9981650021356243}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.227876 cos_to_last_merge=0.9907 (last merge round=41)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9970144122309129, 'loss_val': 0.023201192519554065, 'psi': 0.9961167479739583}-{'f1_val': 0.9955183051359886, 'auprc': 0.9971806820722493, 'loss_val': 0.023046111917746248, 'psi': 0.9961832559104928}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=1.976108 cos_to_last_merge=0.9887 (last merge round=41)
[S11] round=98 local utility u=0.743124 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.998665589604297, 'loss_val': 0.02163965863478462, 'psi': 0.9970136181175057}-{'f1_val': 0.8239105826225306, 'auprc': 0.9961839566954266, 'loss_val': 0.46843154173696633, 'psi': 0.892819932251689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=98 head_norm_before_train=1.902035 cos_to_last_merge=0.9319 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.6516296599596196, 'auprc': 0.7060796565661743, 'loss_val': 1.455006409728316, 'psi': 0.6734096586022416}-{'f1_val': 0.7757474364763516, 'auprc': 0.7876111572000217, 'loss_val': 1.0870479428246393, 'psi': 0.7804929247658197}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=2.208598 cos_to_last_merge=0.9938 (last merge round=46)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9995850636399057, 'loss_val': 0.013870602230752257, 'psi': 0.9985270810686178}-{'f1_val': 0.9982330107938716, 'auprc': 0.9995536227593447, 'loss_val': 0.014349567873668667, 'psi': 0.9987612555800609}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.131691 cos_to_last_merge=0.9735 (last merge round=42)
[S15] round=98 local utility u=0.007971 metrics={'f1_val': 0.9217277839890318, 'auprc': 0.992703818473911, 'loss_val': 0.2034699935007645, 'psi': 0.9501181977829836}-{'f1_val': 0.9201308171911596, 'auprc': 0.9929704979154782, 'loss_val': 0.21063024141377015, 'psi': 0.9492666894808871}
[S15] not sending this round → trigger blocked (psi=0.950)
[S16] START round=98 head_norm_before_train=1.992149 cos_to_last_merge=1.0000 (last merge round=97)
[S16] round=98 local utility u=0.008446 metrics={'f1_val': 0.9943444002790122, 'auprc': 0.9878673950989691, 'loss_val': 0.030643338051054358, 'psi': 0.9917535982069949}-{'f1_val': 0.9928059589596947, 'auprc': 0.9870056980626722, 'loss_val': 0.03571863355382497, 'psi': 0.9904858546008858}
[S17] START round=98 head_norm_before_train=2.029427 cos_to_last_merge=0.9715 (last merge round=43)
[S17] round=98 local utility u=0.037389 metrics={'f1_val': 0.8257435680750773, 'auprc': 0.8646036086379862, 'loss_val': 0.7985409297723877, 'psi': 0.8412875843002409}-{'f1_val': 0.8247745535759918, 'auprc': 0.8396396841210717, 'loss_val': 0.7926130736676069, 'psi': 0.8307206057940237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=1.0000
[S2] START round=99 head_norm_before_train=2.243227 cos_to_last_merge=0.9185 (last merge round=39)
[S2] ⚠️ Model drifted since last merge! cos=0.918
[S2] round=99 local utility u=0.499285 metrics={'f1_val': 0.8315019066405558, 'auprc': 0.9564213625514241, 'loss_val': 0.35420309463808414, 'psi': 0.8814696890049031}-{'f1_val': 0.7463376484217865, 'auprc': 0.8656494332819804, 'loss_val': 0.5694718838001215, 'psi': 0.794062362365864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] r=100 psi=0.881 u=0.4993 p_local=0.2143 f1=0.832 auprc=0.956 bytes=84594
[S3] START round=99 head_norm_before_train=2.197386 cos_to_last_merge=0.9782 (last merge round=44)
[S3] round=99 local utility u=0.058891 metrics={'f1_val': 0.9969615070749143, 'auprc': 0.9988435370362785, 'loss_val': 0.014435118839205157, 'psi': 0.99771431905946}-{'f1_val': 0.982537901173439, 'auprc': 0.9991761343167107, 'loss_val': 0.04667360074975424, 'psi': 0.9891931944307477}
[S3] not sending this round → trigger blocked (psi=0.998)
[S3] r=100 psi=0.998 u=0.0589 p_local=0.1984 f1=0.997 auprc=0.999 bytes=75553
[S4] START round=99 head_norm_before_train=2.397321 (no previous merge yet)
[S4] round=99 local utility u=0.014715 metrics={'f1_val': 0.9566129147249401, 'auprc': 0.9799811395577002, 'loss_val': 0.31643493058427286, 'psi': 0.9659602046580441}-{'f1_val': 0.9486159809828555, 'auprc': 0.9832312020850704, 'loss_val': 0.3076330529903811, 'psi': 0.9624620694237414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=100 psi=0.966 u=0.0147 p_local=0.0065 f1=0.957 auprc=0.980 bytes=73772
[S5] START round=99 head_norm_before_train=1.892691 cos_to_last_merge=0.7836 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9912770381982539, 'loss_val': 0.027147596773154984, 'psi': 0.9941349448181339}-{'f1_val': 0.996186023309311, 'auprc': 0.9965205547160527, 'loss_val': 0.02732649829619352, 'psi': 0.9963198358720077}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.994 u=0.0000 p_local=0.0032 f1=0.996 auprc=0.991 bytes=79180
[S6] START round=99 head_norm_before_train=2.382365 cos_to_last_merge=0.9528 (last merge round=44)
[S6] round=99 local utility u=0.170455 metrics={'f1_val': 0.9356298565249523, 'auprc': 0.97654196240712, 'loss_val': 0.1460002639496256, 'psi': 0.9519946988778194}-{'f1_val': 0.9040058186869702, 'auprc': 0.9684651637956889, 'loss_val': 0.27293606946910176, 'psi': 0.9297895567304577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] r=100 psi=0.952 u=0.1705 p_local=0.2085 f1=0.936 auprc=0.977 bytes=73777
[S7] START round=99 head_norm_before_train=1.993245 cos_to_last_merge=1.0000 (last merge round=96)
[S7] round=99 local utility u=0.000000 metrics={'f1_val': 0.6206452368795743, 'auprc': 0.7974747139847085, 'loss_val': 0.9459460753696917, 'psi': 0.691377027721628}-{'f1_val': 0.6156091970123072, 'auprc': 0.7999319487857474, 'loss_val': 0.8236880332624319, 'psi': 0.6893382977216833}
[S8] START round=99 head_norm_before_train=2.063191 cos_to_last_merge=0.9868 (last merge round=45)
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.8495306646983742, 'auprc': 0.9993831316625565, 'loss_val': 0.5189665871534866, 'psi': 0.9094716514840471}-{'f1_val': 0.9915940414364243, 'auprc': 0.9974487574735105, 'loss_val': 0.03238874942443914, 'psi': 0.9939359278512587}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.909 u=0.0000 p_local=0.1080 f1=0.850 auprc=0.999 bytes=73806
[S9] START round=99 head_norm_before_train=2.105287 cos_to_last_merge=0.7558 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.756
[S9] round=99 local utility u=0.034004 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980843696428782, 'loss_val': 0.017355380493442773, 'psi': 0.9972300549454861}-{'f1_val': 0.9884538934865174, 'auprc': 0.9996917321483317, 'loss_val': 0.04094552976705627, 'psi': 0.992949028951243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] r=100 psi=0.997 u=0.0340 p_local=0.0093 f1=0.997 auprc=0.998 bytes=77336
[S10] START round=99 head_norm_before_train=2.231389 cos_to_last_merge=0.9905 (last merge round=41)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9955183051359886, 'auprc': 0.9969216179300378, 'loss_val': 0.02317145149977408, 'psi': 0.9960796302536082}-{'f1_val': 0.9955183051359886, 'auprc': 0.9970144122309129, 'loss_val': 0.023201192519554065, 'psi': 0.9961167479739583}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0001 f1=0.996 auprc=0.997 bytes=81032
[S11] START round=99 head_norm_before_train=1.976210 cos_to_last_merge=0.9888 (last merge round=41)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9983382821612565, 'loss_val': 0.022671505247195675, 'psi': 0.996870415585651}-{'f1_val': 0.9959123037929781, 'auprc': 0.998665589604297, 'loss_val': 0.02163965863478462, 'psi': 0.9970136181175057}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.997 u=0.0000 p_local=0.2167 f1=0.996 auprc=0.998 bytes=82709
[S13] START round=99 head_norm_before_train=1.912684 cos_to_last_merge=0.9308 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.931
[S13] round=99 local utility u=0.691008 metrics={'f1_val': 0.7446917252718068, 'auprc': 0.8974378710399775, 'loss_val': 1.2054381778348164, 'psi': 0.8057901835790751}-{'f1_val': 0.6516296599596196, 'auprc': 0.7060796565661743, 'loss_val': 1.455006409728316, 'psi': 0.6734096586022416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] r=100 psi=0.806 u=0.6910 p_local=0.2829 f1=0.745 auprc=0.897 bytes=70254
[S14] START round=99 head_norm_before_train=2.211142 cos_to_last_merge=0.9936 (last merge round=46)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9995179059835033, 'loss_val': 0.014189473835183207, 'psi': 0.9985002180060567}-{'f1_val': 0.9978217593544257, 'auprc': 0.9995850636399057, 'loss_val': 0.013870602230752257, 'psi': 0.9985270810686178}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.999 u=0.0000 p_local=0.0212 f1=0.998 auprc=1.000 bytes=73732
[S15] START round=99 head_norm_before_train=2.137040 cos_to_last_merge=0.9732 (last merge round=42)
[S15] round=99 local utility u=0.005156 metrics={'f1_val': 0.9227872525599111, 'auprc': 0.9931777294961239, 'loss_val': 0.2009373314271136, 'psi': 0.9509434433343962}-{'f1_val': 0.9217277839890318, 'auprc': 0.992703818473911, 'loss_val': 0.2034699935007645, 'psi': 0.9501181977829836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S15] r=100 psi=0.951 u=0.0052 p_local=0.0153 f1=0.923 auprc=0.993 bytes=72012
[S16] START round=99 head_norm_before_train=1.993562 cos_to_last_merge=1.0000 (last merge round=97)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9941479283492088, 'auprc': 0.9890421216433986, 'loss_val': 0.042429926835415466, 'psi': 0.9921056056668848}-{'f1_val': 0.9943444002790122, 'auprc': 0.9878673950989691, 'loss_val': 0.030643338051054358, 'psi': 0.9917535982069949}
[S17] START round=99 head_norm_before_train=2.035196 cos_to_last_merge=0.9710 (last merge round=43)
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.8004806275444367, 'auprc': 0.899884536553784, 'loss_val': 0.9267932249529517, 'psi': 0.8402421911481757}-{'f1_val': 0.8257435680750773, 'auprc': 0.8646036086379862, 'loss_val': 0.7985409297723877, 'psi': 0.8412875843002409}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.840 u=0.0000 p_local=0.1145 f1=0.800 auprc=0.900 bytes=79299
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=99 metric=0.6206 head_norm=1.996744
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.130097e-02
[S7] stored merged vector for next round verification (round=99)
[S7] DEBUG after merge:  round=99 metric=0.6211 head_norm=1.995122 delta_norm=0.011301
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] r=100 psi=0.691 u=0.0000 p_local=0.2149 f1=0.621 auprc=0.797 bytes=88142
[S16] r=100 psi=0.992 u=0.0000 p_local=0.0761 f1=0.994 auprc=0.989 bytes=77372
[runner] rounds complete.
[runner] all agents stopped.
