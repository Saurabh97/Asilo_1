[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:31603
[S3] → join 127.0.0.1:31602
[S4] → join 127.0.0.1:31602
[S5] → join 127.0.0.1:31602
[S6] → join 127.0.0.1:31602
[S7] → join 127.0.0.1:31602
[S8] → join 127.0.0.1:31602
[S9] → join 127.0.0.1:31602
[S10] → join 127.0.0.1:31602
[S11] → join 127.0.0.1:31602
[S13] → join 127.0.0.1:31602
[S14] → join 127.0.0.1:31602
[S15] → join 127.0.0.1:31602
[S16] → join 127.0.0.1:31602
[S17] → join 127.0.0.1:31602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.200941 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.129683 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.162066 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.167360 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.113779 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.142994 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.143939 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.207036 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.158837 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.159110 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.192724 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.149588 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.139514 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.123499 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.203055 (no previous merge yet)
[S7]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3] + discovered S7
[S3] + discovered S4
[S3] + discovered S15
[S3] + discovered S8
[S3] + discovered S5
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S13
[S3] + discovered S6
[S3] + discovered S9
[S3] + discovered S16
[S3] + discovered S10
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S14
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S14
[S4] + discovered S7
[S4] + discovered S5
[S5] + discovered S4
[S4] + discovered S8
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S17
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S15
[S4] + discovered S10
[S6] + discovered S2
[S5] + discovered S14
[S5] + discovered S15
[S5] + discovered S10
[S5] + discovered S16
[S6] + discovered S5
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S11
[S6] + discovered S3
[S5] + discovered S17
[S5] + discovered S7
[S5] + discovered S6
[S6] + discovered S4
[S6] + discovered S13
[S7] + discovered S4
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S16
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S7
[S6] + discovered S11
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S11
[S7] + discovered S13
[S8] + discovered S2
[S7] + discovered S15
[S7] + discovered S9
[S7] + discovered S16
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S3
[S7] + discovered S17
[S7] + discovered S8
[S8] + discovered S4
[S7] + discovered S10
[S7] + discovered S14
[S8] + discovered S13
[S8] + discovered S11
[S8] + discovered S17
[S9] + discovered S6
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S3
[S8] + discovered S16
[S8] + discovered S9
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S15
[S9] + discovered S14
[S10] + discovered S6
[S9] + discovered S13
[S10] + discovered S5
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S15
[S9] + discovered S11
[S10] + discovered S9
[S9] + discovered S10
[S10] + discovered S4
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S7
[S11] + discovered S3
[S11] + discovered S8
[S11] + discovered S2
[S11] + discovered S7
[S10] + discovered S14
[S11] + discovered S4
[S10] + discovered S17
[S10] + discovered S15
[S11] + discovered S6
[S10] + discovered S13
[S11] + discovered S5
[S10] + discovered S11
[S10] + discovered S16
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S17
[S13] + discovered S5
[S11] + discovered S15
[S13] + discovered S3
[S11] + discovered S14
[S13] + discovered S10
[S11] + discovered S16
[S13] + discovered S7
[S13] + discovered S11
[S13] + discovered S6
[S11] + discovered S13
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S2
[S13] + discovered S4
[S13] + discovered S14
[S13] + discovered S15
[S14] + discovered S2
[S14] + discovered S6
[S14] + discovered S3
[S14] + discovered S11
[S14] + discovered S7
[S14] + discovered S4
[S14] + discovered S13
[S14] + discovered S9
[S14] + discovered S5
[S13] + discovered S17
[S14] + discovered S10
[S14] + discovered S8
[S13] + discovered S16
[S15] + discovered S14
[S14] + discovered S16
[S15] + discovered S7
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S6
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S3
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S11
[S16] + discovered S2
[S16] + discovered S6
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S9
[S16] + discovered S7
[S16] + discovered S5
[S16] + discovered S15
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S13
[S16] + discovered S4
[S17] + discovered S7
[S17] + discovered S2
[S17] + discovered S3
[S17] + discovered S10
[S17] + discovered S15
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S16
[S17] + discovered S6
[S16] + discovered S17
[S17] + discovered S8
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S14@127.0.0.1:31614
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:31602
[S9] ⇄ pheromone p=1.000 → S4@127.0.0.1:31604
[S13] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S3] ⇄ pheromone p=1.000 → S8@127.0.0.1:31609
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:31611
[S14] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:31604
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:31617
[S2] ⇄ pheromone p=1.000 → S11@127.0.0.1:31612
[S10] ⇄ pheromone p=1.000 → S16@127.0.0.1:31616
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:31617
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:31613
[S17] ⇄ pheromone p=1.000 → S7@127.0.0.1:31608
[S2] START round=1 head_norm_before_train=1.201660 (no previous merge yet)
[S2] round=1 local utility u=0.005336 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6063396757825994, 'loss_val': 1.3332227000919443, 'psi': 0.3276021503461798}-{'f1_val': 0.23333730044972184, 'auprc': 0.431674340142999, 'loss_val': 1.3692592850226308, 'psi': 0.31267211632703273}
[S3] START round=1 head_norm_before_train=1.128030 (no previous merge yet)
[S3] round=1 local utility u=0.509010 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7192049703330476, 'loss_val': 1.3185288505290798, 'psi': 0.37158602750168324}-{'f1_val': 0.13984006561410703, 'auprc': 0.38762156087373173, 'loss_val': 1.34179926874891, 'psi': 0.23895266371795693}
[S4] START round=1 head_norm_before_train=1.170051 (no previous merge yet)
[S4] round=1 local utility u=1.000000 metrics={'f1_val': 0.4464995540562485, 'auprc': 0.767036443887808, 'loss_val': 1.3092944100246109, 'psi': 0.5747143099888723}-{'f1_val': 0.10593971631205673, 'auprc': 0.4301478297766562, 'loss_val': 1.3518534803989595, 'psi': 0.23562296169789654}
[S5] START round=1 head_norm_before_train=1.165769 (no previous merge yet)
[S5] round=1 local utility u=0.158677 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7310987082678901, 'loss_val': 1.323917643669521, 'psi': 0.37779662616429893}-{'f1_val': 0.14226190476190476, 'auprc': 0.6370046527258563, 'loss_val': 1.358989604844834, 'psi': 0.3401590039474854}
[S6] START round=1 head_norm_before_train=1.124804 (no previous merge yet)
[S6] round=1 local utility u=0.262473 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8644973457404073, 'loss_val': 1.3159524955641426, 'psi': 0.43065470752693213}-{'f1_val': 0.14142628205128205, 'auprc': 0.6994844151263762, 'loss_val': 1.3458601997058979, 'psi': 0.36464953528131966}
[S7] START round=1 head_norm_before_train=1.142933 (no previous merge yet)
[S7] round=1 local utility u=0.089991 metrics={'f1_val': 0.10548098434004474, 'auprc': 0.7737515808231765, 'loss_val': 1.33884056507058, 'psi': 0.37278922293329747}-{'f1_val': 0.10429108604291086, 'auprc': 0.7255722853411444, 'loss_val': 1.3671443943220247, 'psi': 0.3528035657622043}
[S8] START round=1 head_norm_before_train=1.141961 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7659993066121998, 'loss_val': 1.3328094383796245, 'psi': 0.3903733120806543}-{'f1_val': 0.41585420757840985, 'auprc': 0.7583466970497557, 'loss_val': 1.3620872480964317, 'psi': 0.5528512033669482}
[S9] START round=1 head_norm_before_train=1.208753 (no previous merge yet)
[S9] round=1 local utility u=0.065396 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7949338379901474, 'loss_val': 1.3169622732593464, 'psi': 0.4028123094800566}-{'f1_val': 0.141397957139996, 'auprc': 0.7642351437709298, 'loss_val': 1.3556577163966972, 'psi': 0.3905328317923696}
[S10] START round=1 head_norm_before_train=1.164096 (no previous merge yet)
[S10] round=1 local utility u=0.095448 metrics={'f1_val': 0.22764806673140311, 'auprc': 0.995440309617437, 'loss_val': 1.3227968931589738, 'psi': 0.5347649638858167}-{'f1_val': 0.24868739417901836, 'auprc': 0.9004265797644216, 'loss_val': 1.3548881580548138, 'psi': 0.5093830684131797}
[S11] START round=1 head_norm_before_train=1.160117 (no previous merge yet)
[S11] round=1 local utility u=0.070285 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9582766157387863, 'loss_val': 1.3139961666466269, 'psi': 0.4675588563193809}-{'f1_val': 0.14041368337311058, 'auprc': 0.9217654333504031, 'loss_val': 1.34503180265243, 'psi': 0.4529543833640276}
[S13] START round=1 head_norm_before_train=1.185191 (no previous merge yet)
[S13] round=1 local utility u=1.000000 metrics={'f1_val': 0.6510934394505323, 'auprc': 0.5319083379812997, 'loss_val': 1.3517776989584003, 'psi': 0.6034193988628394}-{'f1_val': 0.05619631901840491, 'auprc': 0.5303134993871097, 'loss_val': 1.3946727563139105, 'psi': 0.24584319116588685}
[S14] START round=1 head_norm_before_train=1.153574 (no previous merge yet)
[S14] round=1 local utility u=0.261310 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5477456630149328, 'loss_val': 1.335130159797709, 'psi': 0.3033129769355954}-{'f1_val': 0.14035785288270378, 'auprc': 0.3809417182453026, 'loss_val': 1.3573392852791644, 'psi': 0.2365913990277433}
[S15] START round=1 head_norm_before_train=1.143480 (no previous merge yet)
[S15] round=1 local utility u=0.355500 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7785703168015629, 'loss_val': 1.3393589312342618, 'psi': 0.39526831753756014}-{'f1_val': 0.13973365136155833, 'auprc': 0.5504575905859008, 'loss_val': 1.366020836178231, 'psi': 0.3040232270512953}
[S16] START round=1 head_norm_before_train=1.126403 (no previous merge yet)
[S16] round=1 local utility u=0.831742 metrics={'f1_val': 0.25314962197227037, 'auprc': 0.8035324432761097, 'loss_val': 1.3437913649657305, 'psi': 0.47330275049380616}-{'f1_val': 0.09148550724637682, 'auprc': 0.5825115011939218, 'loss_val': 1.37422705339148, 'psi': 0.28789590482539484}
[S17] START round=1 head_norm_before_train=1.192868 (no previous merge yet)
[S17] round=1 local utility u=0.749129 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5819393998891483, 'loss_val': 1.3496823581605584, 'psi': 0.31734513794609}-{'f1_val': 0.09754189944134078, 'auprc': 0.17787930517387862, 'loss_val': 1.375317905513273, 'psi': 0.1296768617343559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:31604
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S10] → sending delta(kind=head bytes=1785) to S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:31608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S5] → sending delta(kind=head bytes=1785) to S13@127.0.0.1:31613
[S6] sending update (kind=head size=1787 to 1 peers)
[S10] sending update (kind=head size=1785 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1785 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1788) from S13
[S7] cosine check vs S13: cos=-0.0183
[S7] DROPPED delta from S13 (cos=-0.0183 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1789) from S14
[S15] cosine check vs S14: cos=0.0256
[S5] RECEIVED delta(kind=head bytes=1793) from S16
[S5] cosine check vs S16: cos=-0.0303
[S5] DROPPED delta from S16 (cos=-0.0303 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1787) from S6
[S15] cosine check vs S6: cos=0.0234
[S9] RECEIVED delta(kind=head bytes=1793) from S4
[S9] cosine check vs S4: cos=-0.0052
[S9] DROPPED delta from S4 (cos=-0.0052 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1790) from S3
[S16] cosine check vs S3: cos=-0.1954
[S16] DROPPED delta from S3 (cos=-0.1954 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S11
[S4] cosine check vs S11: cos=0.0278
[S2] RECEIVED delta(kind=head bytes=1791) from S9
[S2] cosine check vs S9: cos=0.0502
[S14] RECEIVED delta(kind=head bytes=1790) from S7
[S14] cosine check vs S7: cos=0.0989
[S13] RECEIVED delta(kind=head bytes=1785) from S5
[S13] cosine check vs S5: cos=-0.0093
[S13] DROPPED delta from S5 (cos=-0.0093 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S2
[S8] cosine check vs S2: cos=0.0706
[S9] RECEIVED delta(kind=head bytes=1785) from S10
[S9] cosine check vs S10: cos=0.0250
[S5] RECEIVED delta(kind=head bytes=1788) from S15
[S5] cosine check vs S15: cos=0.0808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:31614
[S17] sending update (kind=head size=1789 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1789) from S17
[S14] cosine check vs S17: cos=-0.0759
[S14] DROPPED delta from S17 (cos=-0.0759 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.148923
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.051915e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.0915 head_norm=0.864127 delta_norm=0.805191
[S8] aggregate: ROLLBACK (f1_val pre=0.140 post=0.091 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.168260
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.794865e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1540 head_norm=0.860787 delta_norm=0.779487
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.4465 head_norm=1.186731
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.223978e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.3909 head_norm=0.845602 delta_norm=0.822398
[S4] aggregate: ROLLBACK (f1_val pre=0.446 post=0.391 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.157786
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.863676e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.709840 delta_norm=0.686368
[S15] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.212466
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.375593e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.880747 delta_norm=0.837559
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.175469
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.909339e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.857626 delta_norm=0.790934
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.218346
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.372493e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.858465 delta_norm=0.837249
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.880747 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.219911 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7487091961569642, 'loss_val': 1.320509907254376, 'psi': 0.3845499584959257}-{'f1_val': 0.1417771333885667, 'auprc': 0.6063396757825994, 'loss_val': 1.3332227000919443, 'psi': 0.3276021503461798}
[S3] START round=2 head_norm_before_train=1.136959 (no previous merge yet)
[S3] round=2 local utility u=0.115946 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7874991060747218, 'loss_val': 1.2915197652636896, 'psi': 0.398903681798353}-{'f1_val': 0.13984006561410703, 'auprc': 0.7192049703330476, 'loss_val': 1.3185288505290798, 'psi': 0.37158602750168324}
[S4] START round=2 head_norm_before_train=0.845602 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7532001428496348, 'loss_val': 1.2970116210176712, 'psi': 0.38541603447696443}-{'f1_val': 0.4464995540562485, 'auprc': 0.767036443887808, 'loss_val': 1.3092944100246109, 'psi': 0.5747143099888723}
[S5] START round=2 head_norm_before_train=0.857626 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7319632036332744, 'loss_val': 1.3373979076012434, 'psi': 0.37814242431045264}-{'f1_val': 0.14226190476190476, 'auprc': 0.7310987082678901, 'loss_val': 1.323917643669521, 'psi': 0.37779662616429893}
[S6] START round=2 head_norm_before_train=1.144632 (no previous merge yet)
[S6] round=2 local utility u=0.019543 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8651862838937746, 'loss_val': 1.27893324965132, 'psi': 0.43093028278827905}-{'f1_val': 0.14142628205128205, 'auprc': 0.8644973457404073, 'loss_val': 1.3159524955641426, 'psi': 0.43065470752693213}
[S7] START round=2 head_norm_before_train=1.154243 (no previous merge yet)
[S7] round=2 local utility u=0.139482 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.782197719682244, 'loss_val': 1.3046690541702404, 'psi': 0.39811318151035263}-{'f1_val': 0.10548098434004474, 'auprc': 0.7737515808231765, 'loss_val': 1.33884056507058, 'psi': 0.37278922293329747}
[S8] START round=2 head_norm_before_train=0.864127 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7656865971464712, 'loss_val': 1.3426384185151894, 'psi': 0.39024822829436284}-{'f1_val': 0.13995598239295717, 'auprc': 0.7659993066121998, 'loss_val': 1.3328094383796245, 'psi': 0.3903733120806543}
[S9] START round=2 head_norm_before_train=0.858465 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.246479 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9590787146879016, 'loss_val': 1.3164382488790347, 'psi': 0.46847026015915827}-{'f1_val': 0.141397957139996, 'auprc': 0.7949338379901474, 'loss_val': 1.3169622732593464, 'psi': 0.4028123094800566}
[S10] START round=2 head_norm_before_train=1.179631 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.963492683326935, 'loss_val': 1.2831620918297046, 'psi': 0.4685700558558084}-{'f1_val': 0.22764806673140311, 'auprc': 0.995440309617437, 'loss_val': 1.3227968931589738, 'psi': 0.5347649638858167}
[S11] START round=2 head_norm_before_train=1.172361 (no previous merge yet)
[S11] round=2 local utility u=0.024332 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9624416438685444, 'loss_val': 1.2778278459727843, 'psi': 0.4692248675712841}-{'f1_val': 0.14041368337311058, 'auprc': 0.9582766157387863, 'loss_val': 1.3139961666466269, 'psi': 0.4675588563193809}
[S13] START round=2 head_norm_before_train=1.190077 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5331916997824561, 'loss_val': 1.3021333020421402, 'psi': 0.2975081374592143}-{'f1_val': 0.6510934394505323, 'auprc': 0.5319083379812997, 'loss_val': 1.3517776989584003, 'psi': 0.6034193988628394}
[S14] START round=2 head_norm_before_train=0.860787 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.040094 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5762452708628993, 'loss_val': 1.3404406678247234, 'psi': 0.314712820074782}-{'f1_val': 0.14035785288270378, 'auprc': 0.5477456630149328, 'loss_val': 1.335130159797709, 'psi': 0.3033129769355954}
[S15] START round=2 head_norm_before_train=0.709840 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7348757545660153, 'loss_val': 1.3347681371742854, 'psi': 0.37779049264334114}-{'f1_val': 0.13973365136155833, 'auprc': 0.7785703168015629, 'loss_val': 1.3393589312342618, 'psi': 0.39526831753756014}
[S16] START round=2 head_norm_before_train=1.141841 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8075087348667954, 'loss_val': 1.3032494297195176, 'psi': 0.40738596406624006}-{'f1_val': 0.25314962197227037, 'auprc': 0.8035324432761097, 'loss_val': 1.3437913649657305, 'psi': 0.47330275049380616}
[S17] START round=2 head_norm_before_train=1.192816 (no previous merge yet)
[S17] round=2 local utility u=0.037760 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5985455898427743, 'loss_val': 1.323981045680426, 'psi': 0.3239876139275404}-{'f1_val': 0.14094896331738438, 'auprc': 0.5819393998891483, 'loss_val': 1.3496823581605584, 'psi': 0.31734513794609}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S8@127.0.0.1:31609
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:31612
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:31602
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1787 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S11
[S5] cosine check vs S11: cos=-0.0618
[S5] DROPPED delta from S11 (cos=-0.0618 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S14
[S6] cosine check vs S14: cos=-0.0528
[S6] DROPPED delta from S14 (cos=-0.0528 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S9
[S2] cosine check vs S9: cos=0.5280
[S6] RECEIVED delta(kind=head bytes=1789) from S7
[S6] cosine check vs S7: cos=0.0163
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] cosine check vs S3: cos=0.0175
[S8] RECEIVED delta(kind=head bytes=1787) from S6
[S8] cosine check vs S6: cos=-0.0460
[S8] DROPPED delta from S6 (cos=-0.0460 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S2
[S9] cosine check vs S2: cos=0.5280
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:31603
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] cosine check vs S17: cos=0.0202
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=0.875489
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.310977e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.775437 delta_norm=0.431098
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.194135
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.226417e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.837137 delta_norm=0.822642
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=2 metric=0.1398 head_norm=1.152873
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.239965e-01
[S3] stored merged vector for next round verification (round=2)
[S3] DEBUG after merge:  round=2 metric=0.1398 head_norm=0.840778 delta_norm=0.823997
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.898784
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.310977e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.775437 delta_norm=0.431098
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=1.174340
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.245429e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1717 head_norm=0.838133 delta_norm=0.824543
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.775437 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.009708 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7489501549791229, 'loss_val': 1.3018171378514298, 'psi': 0.3846463420247892}-{'f1_val': 0.1417771333885667, 'auprc': 0.7487091961569642, 'loss_val': 1.320509907254376, 'psi': 0.3845499584959257}
[S3] START round=3 head_norm_before_train=0.840778 cos_to_last_merge=1.0000 (last merge round=2)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7352458615271585, 'loss_val': 1.2960728947095137, 'psi': 0.3780023839793276}-{'f1_val': 0.13984006561410703, 'auprc': 0.7874991060747218, 'loss_val': 1.2915197652636896, 'psi': 0.398903681798353}
[S4] START round=3 head_norm_before_train=0.871118 cos_to_last_merge=0.9965 (last merge round=1)
[S4] round=3 local utility u=0.042121 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7631142817839656, 'loss_val': 1.2425122350760214, 'psi': 0.3893816900506967}-{'f1_val': 0.14022662889518414, 'auprc': 0.7532001428496348, 'loss_val': 1.2970116210176712, 'psi': 0.38541603447696443}
[S5] START round=3 head_norm_before_train=0.864908 cos_to_last_merge=0.9972 (last merge round=1)
[S5] round=3 local utility u=0.021813 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.735383414264676, 'loss_val': 1.3040328576652591, 'psi': 0.37951050856301327}-{'f1_val': 0.14226190476190476, 'auprc': 0.7319632036332744, 'loss_val': 1.3373979076012434, 'psi': 0.37814242431045264}
[S6] START round=3 head_norm_before_train=0.838133 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8311456220277262, 'loss_val': 1.2793562109381615, 'psi': 0.41731401804185975}-{'f1_val': 0.14142628205128205, 'auprc': 0.8651862838937746, 'loss_val': 1.27893324965132, 'psi': 0.43093028278827905}
[S7] START round=3 head_norm_before_train=1.177115 (no previous merge yet)
[S7] round=3 local utility u=0.027220 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7875010218022408, 'loss_val': 1.2661399479504891, 'psi': 0.40023450235835134}-{'f1_val': 0.14205682272909165, 'auprc': 0.782197719682244, 'loss_val': 1.3046690541702404, 'psi': 0.39811318151035263}
[S8] START round=3 head_norm_before_train=0.871191 cos_to_last_merge=0.9965 (last merge round=1)
[S8] round=3 local utility u=0.017664 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660933660239134, 'loss_val': 1.3085306611940042, 'psi': 0.3904109358453397}-{'f1_val': 0.13995598239295717, 'auprc': 0.7656865971464712, 'loss_val': 1.3426384185151894, 'psi': 0.39024822829436284}
[S9] START round=3 head_norm_before_train=0.775437 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.084756 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9995665701805547, 'loss_val': 1.268389294339906, 'psi': 0.4846654023562195}-{'f1_val': 0.141397957139996, 'auprc': 0.9590787146879016, 'loss_val': 1.3164382488790347, 'psi': 0.46847026015915827}
[S10] START round=3 head_norm_before_train=1.204835 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8329167477716414, 'loss_val': 1.2273134244172543, 'psi': 0.41633968163369095}-{'f1_val': 0.13862163754172394, 'auprc': 0.963492683326935, 'loss_val': 1.2831620918297046, 'psi': 0.4685700558558084}
[S11] START round=3 head_norm_before_train=0.837137 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.678661127738549, 'loss_val': 1.276320704865451, 'psi': 0.35571266111928596}-{'f1_val': 0.14041368337311058, 'auprc': 0.9624416438685444, 'loss_val': 1.2778278459727843, 'psi': 0.4692248675712841}
[S13] START round=3 head_norm_before_train=1.205768 (no previous merge yet)
[S13] round=3 local utility u=0.096655 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5774692873213048, 'loss_val': 1.241655859484751, 'psi': 0.3152191724747538}-{'f1_val': 0.1403857625770531, 'auprc': 0.5331916997824561, 'loss_val': 1.3021333020421402, 'psi': 0.2975081374592143}
[S14] START round=3 head_norm_before_train=0.875479 cos_to_last_merge=0.9972 (last merge round=1)
[S14] round=3 local utility u=0.056970 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.606165166920136, 'loss_val': 1.3162610515630615, 'psi': 0.3266807784976767}-{'f1_val': 0.14035785288270378, 'auprc': 0.5762452708628993, 'loss_val': 1.3404406678247234, 'psi': 0.314712820074782}
[S15] START round=3 head_norm_before_train=0.730922 cos_to_last_merge=0.9960 (last merge round=1)
[S15] round=3 local utility u=0.070494 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7713267732493929, 'loss_val': 1.3031325807994965, 'psi': 0.3923709001166922}-{'f1_val': 0.13973365136155833, 'auprc': 0.7348757545660153, 'loss_val': 1.3347681371742854, 'psi': 0.37779049264334114}
[S16] START round=3 head_norm_before_train=1.167954 (no previous merge yet)
[S16] round=3 local utility u=0.036399 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8138799813381382, 'loss_val': 1.2495659025247323, 'psi': 0.4099344626547772}-{'f1_val': 0.14063745019920318, 'auprc': 0.8075087348667954, 'loss_val': 1.3032494297195176, 'psi': 0.40738596406624006}
[S17] START round=3 head_norm_before_train=1.201099 (no previous merge yet)
[S17] round=3 local utility u=0.223150 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.73574253743843, 'loss_val': 1.289271694381202, 'psi': 0.37886639296580266}-{'f1_val': 0.14094896331738438, 'auprc': 0.5985455898427743, 'loss_val': 1.323981045680426, 'psi': 0.3239876139275404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:31611
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:31615
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:31612
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:31602
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] cosine check vs S4: cos=-0.0365
[S5] DROPPED delta from S4 (cos=-0.0365 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S13
[S5] cosine check vs S13: cos=-0.0265
[S5] DROPPED delta from S13 (cos=-0.0265 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S2
[S11] cosine check vs S2: cos=-0.0817
[S11] DROPPED delta from S2 (cos=-0.0817 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S16
[S2] cosine check vs S16: cos=-0.0219
[S2] DROPPED delta from S16 (cos=-0.0219 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S15
[S10] cosine check vs S15: cos=-0.0754
[S10] DROPPED delta from S15 (cos=-0.0754 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.0563
[S4] RECEIVED delta(kind=head bytes=1799) from S9
[S4] cosine check vs S9: cos=-0.0395
[S4] DROPPED delta from S9 (cos=-0.0395 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] cosine check vs S14: cos=0.2582
[S10] RECEIVED delta(kind=head bytes=1792) from S5
[S10] cosine check vs S5: cos=-0.0227
[S10] DROPPED delta from S5 (cos=-0.0227 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S7
[S5] cosine check vs S7: cos=-0.0671
[S5] DROPPED delta from S7 (cos=-0.0671 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1791 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S17
[S5] cosine check vs S17: cos=0.0303
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.882581
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.416490e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.763303 delta_norm=0.741649
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=0.763792
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.091193e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.660642 delta_norm=0.509119
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.219180
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.341059e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.774562 delta_norm=0.734106
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.798818 cos_to_last_merge=0.9958 (last merge round=2)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7307566532514145, 'loss_val': 1.2564483330211313, 'psi': 0.37736894133370585}-{'f1_val': 0.1417771333885667, 'auprc': 0.7489501549791229, 'loss_val': 1.3018171378514298, 'psi': 0.3846463420247892}
[S3] START round=4 head_norm_before_train=0.860885 cos_to_last_merge=0.9965 (last merge round=2)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6853889760753725, 'loss_val': 1.2576925471425753, 'psi': 0.3580596297986133}-{'f1_val': 0.13984006561410703, 'auprc': 0.7352458615271585, 'loss_val': 1.2960728947095137, 'psi': 0.3780023839793276}
[S4] START round=4 head_norm_before_train=0.900036 cos_to_last_merge=0.9884 (last merge round=1)
[S4] round=4 local utility u=0.060870 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7753657556786875, 'loss_val': 1.157527271553499, 'psi': 0.3942822796085855}-{'f1_val': 0.14022662889518414, 'auprc': 0.7631142817839656, 'loss_val': 1.2425122350760214, 'psi': 0.3893816900506967}
[S5] START round=4 head_norm_before_train=0.763303 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7288903700937704, 'loss_val': 1.311964039445288, 'psi': 0.37691329089465103}-{'f1_val': 0.14226190476190476, 'auprc': 0.735383414264676, 'loss_val': 1.3040328576652591, 'psi': 0.37951050856301327}
[S6] START round=4 head_norm_before_train=0.868222 cos_to_last_merge=0.9974 (last merge round=2)
[S6] round=4 local utility u=0.016615 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8228034710800073, 'loss_val': 1.221099648872913, 'psi': 0.41397715766277215}-{'f1_val': 0.14142628205128205, 'auprc': 0.8311456220277262, 'loss_val': 1.2793562109381615, 'psi': 0.41731401804185975}
[S7] START round=4 head_norm_before_train=1.206435 (no previous merge yet)
[S7] round=4 local utility u=0.023198 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7908062808915254, 'loss_val': 1.2296604850178443, 'psi': 0.4015566059940652}-{'f1_val': 0.14205682272909165, 'auprc': 0.7875010218022408, 'loss_val': 1.2661399479504891, 'psi': 0.40023450235835134}
[S8] START round=4 head_norm_before_train=0.889559 cos_to_last_merge=0.9867 (last merge round=1)
[S8] round=4 local utility u=0.022522 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661312291264559, 'loss_val': 1.263601022805141, 'psi': 0.39042608108635674}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660933660239134, 'loss_val': 1.3085306611940042, 'psi': 0.3904109358453397}
[S9] START round=4 head_norm_before_train=0.812935 cos_to_last_merge=0.9967 (last merge round=2)
[S9] round=4 local utility u=0.016375 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9930947102262886, 'loss_val': 1.2162237976785206, 'psi': 0.4820766583745131}-{'f1_val': 0.141397957139996, 'auprc': 0.9995665701805547, 'loss_val': 1.268389294339906, 'psi': 0.4846654023562195}
[S10] START round=4 head_norm_before_train=1.237507 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7923091643157508, 'loss_val': 1.1649403485680745, 'psi': 0.40009664825133473}-{'f1_val': 0.13862163754172394, 'auprc': 0.8329167477716414, 'loss_val': 1.2273134244172543, 'psi': 0.41633968163369095}
[S11] START round=4 head_norm_before_train=0.860840 cos_to_last_merge=0.9974 (last merge round=2)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5995260165549012, 'loss_val': 1.2123290301464154, 'psi': 0.32405861664582686}-{'f1_val': 0.14041368337311058, 'auprc': 0.678661127738549, 'loss_val': 1.276320704865451, 'psi': 0.35571266111928596}
[S13] START round=4 head_norm_before_train=1.229340 (no previous merge yet)
[S13] round=4 local utility u=0.115483 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6346515450286051, 'loss_val': 1.1822361137007338, 'psi': 0.3380920755576739}-{'f1_val': 0.1403857625770531, 'auprc': 0.5774692873213048, 'loss_val': 1.241655859484751, 'psi': 0.3152191724747538}
[S14] START round=4 head_norm_before_train=0.898845 cos_to_last_merge=0.9899 (last merge round=1)
[S14] round=4 local utility u=0.292387 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7907143162385037, 'loss_val': 1.2851335347038972, 'psi': 0.4005004382250238}-{'f1_val': 0.14035785288270378, 'auprc': 0.606165166920136, 'loss_val': 1.3162610515630615, 'psi': 0.3266807784976767}
[S15] START round=4 head_norm_before_train=0.660642 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7626900532925072, 'loss_val': 1.2999573309786676, 'psi': 0.3889162121339379}-{'f1_val': 0.13973365136155833, 'auprc': 0.7713267732493929, 'loss_val': 1.3031325807994965, 'psi': 0.3923709001166922}
[S16] START round=4 head_norm_before_train=1.201571 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6695337127238595, 'loss_val': 1.1889020448576597, 'psi': 0.35219595520906577}-{'f1_val': 0.14063745019920318, 'auprc': 0.8138799813381382, 'loss_val': 1.2495659025247323, 'psi': 0.4099344626547772}
[S17] START round=4 head_norm_before_train=0.774562 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.010778 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7396680131231096, 'loss_val': 1.2794917045989618, 'psi': 0.3804365832396745}-{'f1_val': 0.14094896331738438, 'auprc': 0.73574253743843, 'loss_val': 1.289271694381202, 'psi': 0.37886639296580266}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:31615
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:31604
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:31605
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:31604
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=-0.0849
[S4] DROPPED delta from S6 (cos=-0.0849 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S9
[S4] cosine check vs S9: cos=-0.0437
[S4] DROPPED delta from S9 (cos=-0.0437 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] cosine check vs S14: cos=0.8036
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.6036
[S5] RECEIVED delta(kind=head bytes=1791) from S7
[S5] cosine check vs S7: cos=-0.0420
[S5] DROPPED delta from S7 (cos=-0.0420 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S13
[S5] cosine check vs S13: cos=0.0348
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] cosine check vs S4: cos=0.0441
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S17
[S5] cosine check vs S17: cos=0.6983
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=0.686016
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.781028e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1397 head_norm=0.767786 delta_norm=0.278103
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.775801
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.928159e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.579100 delta_norm=0.392816
[S5] aggregate: ACCEPT kept=['S13', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.799722
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.855212e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.768721 delta_norm=0.385521
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.831575 cos_to_last_merge=0.9846 (last merge round=2)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6924892879071667, 'loss_val': 1.2247212720230158, 'psi': 0.36206199519600674}-{'f1_val': 0.1417771333885667, 'auprc': 0.7307566532514145, 'loss_val': 1.2564483330211313, 'psi': 0.37736894133370585}
[S3] START round=5 head_norm_before_train=0.886747 cos_to_last_merge=0.9882 (last merge round=2)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6152966415765035, 'loss_val': 1.2050223478158117, 'psi': 0.33002269599906564}-{'f1_val': 0.13984006561410703, 'auprc': 0.6853889760753725, 'loss_val': 1.2576925471425753, 'psi': 0.3580596297986133}
[S4] START round=5 head_norm_before_train=0.934106 cos_to_last_merge=0.9767 (last merge round=1)
[S4] round=5 local utility u=0.077404 metrics={'f1_val': 0.15029364453671418, 'auprc': 0.7692510080077588, 'loss_val': 1.0447776291892612, 'psi': 0.39787658992513203}-{'f1_val': 0.14022662889518414, 'auprc': 0.7753657556786875, 'loss_val': 1.157527271553499, 'psi': 0.3942822796085855}
[S5] START round=5 head_norm_before_train=0.579100 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.005653 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7289591200230154, 'loss_val': 1.3008635137862223, 'psi': 0.376940790866349}-{'f1_val': 0.14226190476190476, 'auprc': 0.7288903700937704, 'loss_val': 1.311964039445288, 'psi': 0.37691329089465103}
[S6] START round=5 head_norm_before_train=0.907633 cos_to_last_merge=0.9900 (last merge round=2)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6518425891931812, 'loss_val': 1.154221516180301, 'psi': 0.3455928049080417}-{'f1_val': 0.14142628205128205, 'auprc': 0.8228034710800073, 'loss_val': 1.221099648872913, 'psi': 0.41397715766277215}
[S7] START round=5 head_norm_before_train=1.230260 (no previous merge yet)
[S7] round=5 local utility u=0.007969 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7812178852849907, 'loss_val': 1.1849567311866498, 'psi': 0.3977212477514513}-{'f1_val': 0.14205682272909165, 'auprc': 0.7908062808915254, 'loss_val': 1.2296604850178443, 'psi': 0.4015566059940652}
[S8] START round=5 head_norm_before_train=0.916276 cos_to_last_merge=0.9739 (last merge round=1)
[S8] round=5 local utility u=0.039858 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7712167937241938, 'loss_val': 1.1991420198793432, 'psi': 0.39246030692545186}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661312291264559, 'loss_val': 1.263601022805141, 'psi': 0.39042608108635674}
[S9] START round=5 head_norm_before_train=0.859479 cos_to_last_merge=0.9885 (last merge round=2)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7924341746515355, 'loss_val': 1.177850092778194, 'psi': 0.40181244414461187}-{'f1_val': 0.141397957139996, 'auprc': 0.9930947102262886, 'loss_val': 1.2162237976785206, 'psi': 0.4820766583745131}
[S10] START round=5 head_norm_before_train=1.271171 (no previous merge yet)
[S10] round=5 local utility u=0.682075 metrics={'f1_val': 0.3465333203979617, 'auprc': 0.7980389002164417, 'loss_val': 1.0654505111982742, 'psi': 0.5271355523253537}-{'f1_val': 0.13862163754172394, 'auprc': 0.7923091643157508, 'loss_val': 1.1649403485680745, 'psi': 0.40009664825133473}
[S11] START round=5 head_norm_before_train=0.895223 cos_to_last_merge=0.9897 (last merge round=2)
[S11] round=5 local utility u=0.042352 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.598492369688221, 'loss_val': 1.1245234343794412, 'psi': 0.3236451578991547}-{'f1_val': 0.14041368337311058, 'auprc': 0.5995260165549012, 'loss_val': 1.2123290301464154, 'psi': 0.32405861664582686}
[S13] START round=5 head_norm_before_train=1.254956 (no previous merge yet)
[S13] round=5 local utility u=0.894057 metrics={'f1_val': 0.4158809972763461, 'auprc': 0.6599521930436449, 'loss_val': 1.122996206190654, 'psi': 0.5135094755832657}-{'f1_val': 0.1403857625770531, 'auprc': 0.6346515450286051, 'loss_val': 1.1822361137007338, 'psi': 0.3380920755576739}
[S14] START round=5 head_norm_before_train=0.929008 cos_to_last_merge=0.9801 (last merge round=1)
[S14] round=5 local utility u=0.031297 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7945032353491999, 'loss_val': 1.233905323399854, 'psi': 0.4020160058693022}-{'f1_val': 0.14035785288270378, 'auprc': 0.7907143162385037, 'loss_val': 1.2851335347038972, 'psi': 0.4005004382250238}
[S15] START round=5 head_norm_before_train=0.767786 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.023902 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7701305543225234, 'loss_val': 1.274474468974439, 'psi': 0.39189241254594437}-{'f1_val': 0.13973365136155833, 'auprc': 0.7626900532925072, 'loss_val': 1.2999573309786676, 'psi': 0.3889162121339379}
[S16] START round=5 head_norm_before_train=1.235384 (no previous merge yet)
[S16] round=5 local utility u=0.058427 metrics={'f1_val': 0.16476103881882204, 'auprc': 0.634084704939632, 'loss_val': 1.1104421790672594, 'psi': 0.352490505267146}-{'f1_val': 0.14063745019920318, 'auprc': 0.6695337127238595, 'loss_val': 1.1889020448576597, 'psi': 0.35219595520906577}
[S17] START round=5 head_norm_before_train=0.768721 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5520526817835372, 'loss_val': 1.2381554306155231, 'psi': 0.3053904507038455}-{'f1_val': 0.14094896331738438, 'auprc': 0.7396680131231096, 'loss_val': 1.2794917045989618, 'psi': 0.3804365832396745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:31605
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:31605
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:31602
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.1309
[S2] RECEIVED delta(kind=head bytes=1793) from S16
[S2] cosine check vs S16: cos=-0.0315
[S2] DROPPED delta from S16 (cos=-0.0315 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S15
[S10] cosine check vs S15: cos=-0.0361
[S10] DROPPED delta from S15 (cos=-0.0361 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.8858
[S16] RECEIVED delta(kind=head bytes=1798) from S10
[S16] cosine check vs S10: cos=-0.0309
[S16] DROPPED delta from S10 (cos=-0.0309 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S4
[S5] cosine check vs S4: cos=0.3754
[S5] RECEIVED delta(kind=head bytes=1802) from S7
[S5] cosine check vs S7: cos=-0.0321
[S5] DROPPED delta from S7 (cos=-0.0321 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S13
[S5] cosine check vs S13: cos=0.3485
[S10] RECEIVED delta(kind=head bytes=1806) from S5
[S10] cosine check vs S5: cos=-0.0581
[S10] DROPPED delta from S5 (cos=-0.0581 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] cosine check vs S14: cos=0.9419
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.352 → S11@127.0.0.1:31612
[S3] ⇄ pheromone p=0.381 → S8@127.0.0.1:31609
[S9] ⇄ pheromone p=0.372 → S4@127.0.0.1:31604
[S7] ⇄ pheromone p=0.358 → S5@127.0.0.1:31605
[S10] ⇄ pheromone p=0.472 → S16@127.0.0.1:31616
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.4159 head_norm=1.278825
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.409392e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.3961 head_norm=0.839886 delta_norm=0.740939
[S13] aggregate: ROLLBACK (f1_val pre=0.416 post=0.396 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.619 → S5@127.0.0.1:31605
[S8] ⇄ pheromone p=0.342 → S17@127.0.0.1:31617
[S11] ⇄ pheromone p=0.344 → S13@127.0.0.1:31613
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.789416
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.739048e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.866295 delta_norm=0.173905
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.371 → S10@127.0.0.1:31611
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.595013
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.914833e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.628045 delta_norm=0.391483
[S5] aggregate: ACCEPT kept=['S4', 'S13'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.345 → S10@127.0.0.1:31611
[S4] ⇄ pheromone p=0.440 → S5@127.0.0.1:31605
[S16] ⇄ pheromone p=0.412 → S2@127.0.0.1:31602
[S14] ⇄ pheromone p=0.414 → S15@127.0.0.1:31615
[S6] ⇄ pheromone p=0.354 → S4@127.0.0.1:31604
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.796205
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.214275e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.847764 delta_norm=0.221428
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.423 → S5@127.0.0.1:31605
[S2] START round=6 head_norm_before_train=0.854541 cos_to_last_merge=0.9742 (last merge round=2)
[S2] round=6 local utility u=0.143089 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7694158874123965, 'loss_val': 1.1693235039690641, 'psi': 0.3928326349980987}-{'f1_val': 0.1417771333885667, 'auprc': 0.6924892879071667, 'loss_val': 1.2247212720230158, 'psi': 0.36206199519600674}
[S3] START round=6 head_norm_before_train=0.918922 cos_to_last_merge=0.9764 (last merge round=2)
[S3] round=6 local utility u=0.320297 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7950750650104458, 'loss_val': 1.1037642029367156, 'psi': 0.40193406537264253}-{'f1_val': 0.13984006561410703, 'auprc': 0.6152966415765035, 'loss_val': 1.2050223478158117, 'psi': 0.33002269599906564}
[S4] START round=6 head_norm_before_train=0.972176 cos_to_last_merge=0.9637 (last merge round=1)
[S4] round=6 local utility u=1.000000 metrics={'f1_val': 0.6653147330036667, 'auprc': 0.7449933310931025, 'loss_val': 0.9711255265660466, 'psi': 0.697186172239441}-{'f1_val': 0.15029364453671418, 'auprc': 0.7692510080077588, 'loss_val': 1.0447776291892612, 'psi': 0.39787658992513203}
[S5] START round=6 head_norm_before_train=0.628045 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.009560 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.728791237779576, 'loss_val': 1.2812398738174944, 'psi': 0.3768736379689733}-{'f1_val': 0.14226190476190476, 'auprc': 0.7289591200230154, 'loss_val': 1.3008635137862223, 'psi': 0.376940790866349}
[S6] START round=6 head_norm_before_train=0.949077 cos_to_last_merge=0.9811 (last merge round=2)
[S6] round=6 local utility u=1.000000 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.8056248222288707, 'loss_val': 1.013996628766411, 'psi': 0.5724833516160687}-{'f1_val': 0.14142628205128205, 'auprc': 0.6518425891931812, 'loss_val': 1.154221516180301, 'psi': 0.3455928049080417}
[S7] START round=6 head_norm_before_train=1.256574 (no previous merge yet)
[S7] round=6 local utility u=0.056904 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7937188822245913, 'loss_val': 1.108651167993071, 'psi': 0.40272164652729153}-{'f1_val': 0.14205682272909165, 'auprc': 0.7812178852849907, 'loss_val': 1.1849567311866498, 'psi': 0.3977212477514513}
[S8] START round=6 head_norm_before_train=0.949487 cos_to_last_merge=0.9599 (last merge round=1)
[S8] round=6 local utility u=0.120269 metrics={'f1_val': 0.1648316831603016, 'auprc': 0.7769876498631753, 'loss_val': 1.1251710757979514, 'psi': 0.40969406984145107}-{'f1_val': 0.13995598239295717, 'auprc': 0.7712167937241938, 'loss_val': 1.1991420198793432, 'psi': 0.39246030692545186}
[S9] START round=6 head_norm_before_train=0.904791 cos_to_last_merge=0.9790 (last merge round=2)
[S9] round=6 local utility u=0.054802 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7916549680083587, 'loss_val': 1.065909179495812, 'psi': 0.4015007614873411}-{'f1_val': 0.141397957139996, 'auprc': 0.7924341746515355, 'loss_val': 1.177850092778194, 'psi': 0.40181244414461187}
[S10] START round=6 head_norm_before_train=1.300910 (no previous merge yet)
[S10] round=6 local utility u=0.325051 metrics={'f1_val': 0.41757619353244746, 'auprc': 0.8187511204627326, 'loss_val': 0.9037429975236901, 'psi': 0.5780461643045616}-{'f1_val': 0.3465333203979617, 'auprc': 0.7980389002164417, 'loss_val': 1.0654505111982742, 'psi': 0.5271355523253537}
[S11] START round=6 head_norm_before_train=0.934561 cos_to_last_merge=0.9787 (last merge round=2)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.4151419553975044, 'auprc': 0.7947676389320035, 'loss_val': 1.010267182935748, 'psi': 0.5669922288113041}-{'f1_val': 0.14041368337311058, 'auprc': 0.598492369688221, 'loss_val': 1.1245234343794412, 'psi': 0.3236451578991547}
[S13] START round=6 head_norm_before_train=0.839886 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.129753 metrics={'f1_val': 0.4156839344320697, 'auprc': 0.7403075196291864, 'loss_val': 1.1033736595555963, 'psi': 0.5455333685109164}-{'f1_val': 0.4158809972763461, 'auprc': 0.6599521930436449, 'loss_val': 1.122996206190654, 'psi': 0.5135094755832657}
[S14] START round=6 head_norm_before_train=0.968629 cos_to_last_merge=0.9678 (last merge round=1)
[S14] round=6 local utility u=0.103378 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8372645452171884, 'loss_val': 1.1554328645066112, 'psi': 0.4191205298164976}-{'f1_val': 0.14035785288270378, 'auprc': 0.7945032353491999, 'loss_val': 1.233905323399854, 'psi': 0.4020160058693022}
[S15] START round=6 head_norm_before_train=0.866295 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.018229 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7740564500616698, 'loss_val': 1.2497946144843861, 'psi': 0.3934627708416029}-{'f1_val': 0.13973365136155833, 'auprc': 0.7701305543225234, 'loss_val': 1.274474468974439, 'psi': 0.39189241254594437}
[S16] START round=6 head_norm_before_train=1.268740 (no previous merge yet)
[S16] round=6 local utility u=0.760051 metrics={'f1_val': 0.4173069283424069, 'auprc': 0.5960044705551117, 'loss_val': 0.9913750976342397, 'psi': 0.48878594522748886}-{'f1_val': 0.16476103881882204, 'auprc': 0.634084704939632, 'loss_val': 1.1104421790672594, 'psi': 0.352490505267146}
[S17] START round=6 head_norm_before_train=0.847764 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.016344 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5338604963907785, 'loss_val': 1.150891212885225, 'psi': 0.29811357654674203}-{'f1_val': 0.14094896331738438, 'auprc': 0.5520526817835372, 'loss_val': 1.2381554306155231, 'psi': 0.3053904507038455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:31604
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S9
[S4] cosine check vs S9: cos=-0.0395
[S4] DROPPED delta from S9 (cos=-0.0395 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S16
[S2] cosine check vs S16: cos=-0.0389
[S2] DROPPED delta from S16 (cos=-0.0389 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S10
[S16] cosine check vs S10: cos=-0.0346
[S16] DROPPED delta from S10 (cos=-0.0346 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] cosine check vs S15: cos=-0.0259
[S10] DROPPED delta from S15 (cos=-0.0259 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S7
[S5] cosine check vs S7: cos=-0.0186
[S5] DROPPED delta from S7 (cos=-0.0186 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.9726
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=0.6431
[S10] RECEIVED delta(kind=head bytes=1803) from S5
[S10] cosine check vs S5: cos=-0.1030
[S10] DROPPED delta from S5 (cos=-0.1030 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S13
[S5] cosine check vs S13: cos=0.7371
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] cosine check vs S4: cos=0.6151
[S11] RECEIVED delta(kind=head bytes=1794) from S2
[S11] cosine check vs S2: cos=-0.0492
[S11] DROPPED delta from S2 (cos=-0.0492 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] cosine check vs S6: cos=-0.0803
[S4] DROPPED delta from S6 (cos=-0.0803 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9546
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] cosine check vs S3: cos=0.0517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.2376
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.884765
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.276681e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1397 head_norm=0.941738 delta_norm=0.127668
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.1648 head_norm=0.983314
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.682054e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.1400 head_norm=0.703707 delta_norm=0.668205
[S8] aggregate: ROLLBACK (f1_val pre=0.165 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.4157 head_norm=0.871329
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.912086e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.2336 head_norm=0.834312 delta_norm=0.391209
[S13] aggregate: ROLLBACK (f1_val pre=0.416 post=0.234 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.645420
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.840906e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.607414 delta_norm=0.184091
[S5] aggregate: ACCEPT kept=['S13', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.1409 head_norm=0.877036
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.496767e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.1409 head_norm=0.919590 delta_norm=0.149677
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.874145 cos_to_last_merge=0.9645 (last merge round=2)
[S2] round=7 local utility u=0.868869 metrics={'f1_val': 0.4160938496492347, 'auprc': 0.7746308970832416, 'loss_val': 1.0931309434056644, 'psi': 0.5595086686228374}-{'f1_val': 0.1417771333885667, 'auprc': 0.7694158874123965, 'loss_val': 1.1693235039690641, 'psi': 0.3928326349980987}
[S3] START round=7 head_norm_before_train=0.957339 cos_to_last_merge=0.9616 (last merge round=2)
[S3] round=7 local utility u=0.844037 metrics={'f1_val': 0.392601475058182, 'auprc': 0.7961467216739285, 'loss_val': 0.9354741835399178, 'psi': 0.5540195737044806}-{'f1_val': 0.13984006561410703, 'auprc': 0.7950750650104458, 'loss_val': 1.1037642029367156, 'psi': 0.40193406537264253}
[S4] START round=7 head_norm_before_train=1.003101 cos_to_last_merge=0.9514 (last merge round=1)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.40659761948271333, 'auprc': 0.711377392890209, 'loss_val': 0.8126440069615309, 'psi': 0.5285095288457116}-{'f1_val': 0.6653147330036667, 'auprc': 0.7449933310931025, 'loss_val': 0.9711255265660466, 'psi': 0.697186172239441}
[S5] START round=7 head_norm_before_train=0.607414 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.009426 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7287618657549148, 'loss_val': 1.2622989451034154, 'psi': 0.3768618891591088}-{'f1_val': 0.14226190476190476, 'auprc': 0.728791237779576, 'loss_val': 1.2812398738174944, 'psi': 0.3768736379689733}
[S6] START round=7 head_norm_before_train=0.986712 cos_to_last_merge=0.9739 (last merge round=2)
[S6] round=7 local utility u=0.050087 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.7905244200450547, 'loss_val': 0.8697243858210518, 'psi': 0.5665633895922702}-{'f1_val': 0.41705570454086727, 'auprc': 0.8056248222288707, 'loss_val': 1.013996628766411, 'psi': 0.5724833516160687}
[S7] START round=7 head_norm_before_train=1.278272 (no previous merge yet)
[S7] round=7 local utility u=0.895497 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.7948635375146034, 'loss_val': 0.969997663251869, 'psi': 0.5680702547386169}-{'f1_val': 0.14205682272909165, 'auprc': 0.7937188822245913, 'loss_val': 1.108651167993071, 'psi': 0.40272164652729153}
[S8] START round=7 head_norm_before_train=0.703707 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.691274 metrics={'f1_val': 0.3916117097264612, 'auprc': 0.7768331459356185, 'loss_val': 1.102839500461661, 'psi': 0.5457002842101242}-{'f1_val': 0.1648316831603016, 'auprc': 0.7769876498631753, 'loss_val': 1.1251710757979514, 'psi': 0.40969406984145107}
[S9] START round=7 head_norm_before_train=0.943170 cos_to_last_merge=0.9703 (last merge round=2)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.41637066856105454, 'auprc': 0.9874363190049067, 'loss_val': 0.8853281970125989, 'psi': 0.6447969287385954}-{'f1_val': 0.141397957139996, 'auprc': 0.7916549680083587, 'loss_val': 1.065909179495812, 'psi': 0.4015007614873411}
[S10] START round=7 head_norm_before_train=1.333751 (no previous merge yet)
[S10] round=7 local utility u=0.744030 metrics={'f1_val': 0.5458915955294925, 'auprc': 0.9972831167769698, 'loss_val': 0.721171616262887, 'psi': 0.7264482040284834}-{'f1_val': 0.41757619353244746, 'auprc': 0.8187511204627326, 'loss_val': 0.9037429975236901, 'psi': 0.5780461643045616}
[S11] START round=7 head_norm_before_train=0.969035 cos_to_last_merge=0.9665 (last merge round=2)
[S11] round=7 local utility u=0.114129 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.8497826137036727, 'loss_val': 0.835516699625835, 'psi': 0.5778443870371929}-{'f1_val': 0.4151419553975044, 'auprc': 0.7947676389320035, 'loss_val': 1.010267182935748, 'psi': 0.5669922288113041}
[S13] START round=7 head_norm_before_train=0.834312 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000986 metrics={'f1_val': 0.4158809972763461, 'auprc': 0.7309300666614093, 'loss_val': 1.0744509568938791, 'psi': 0.5419006250303713}-{'f1_val': 0.4156839344320697, 'auprc': 0.7403075196291864, 'loss_val': 1.1033736595555963, 'psi': 0.5455333685109164}
[S14] START round=7 head_norm_before_train=1.011697 cos_to_last_merge=0.9547 (last merge round=1)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.5212944122005445, 'auprc': 0.9605843867173957, 'loss_val': 1.04464724986448, 'psi': 0.6970104020072849}-{'f1_val': 0.14035785288270378, 'auprc': 0.8372645452171884, 'loss_val': 1.1554328645066112, 'psi': 0.4191205298164976}
[S15] START round=7 head_norm_before_train=0.941738 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.459512 metrics={'f1_val': 0.2868773990354647, 'auprc': 0.7751294738648938, 'loss_val': 1.216852254672108, 'psi': 0.4821782289672364}-{'f1_val': 0.13973365136155833, 'auprc': 0.7740564500616698, 'loss_val': 1.2497946144843861, 'psi': 0.3934627708416029}
[S16] START round=7 head_norm_before_train=1.299960 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.3841721535499099, 'auprc': 0.5643111725741113, 'loss_val': 0.8794281545215612, 'psi': 0.4562277611595905}-{'f1_val': 0.4173069283424069, 'auprc': 0.5960044705551117, 'loss_val': 0.9913750976342397, 'psi': 0.48878594522748886}
[S17] START round=7 head_norm_before_train=0.919590 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.616639 metrics={'f1_val': 0.31776984612324355, 'auprc': 0.5514602496801386, 'loss_val': 1.03133772410623, 'psi': 0.4112460075460016}-{'f1_val': 0.14094896331738438, 'auprc': 0.5338604963907785, 'loss_val': 1.150891212885225, 'psi': 0.29811357654674203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:31613
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:31615
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:31605
[S3] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S3
[S8] cosine check vs S3: cos=0.6859
[S10] RECEIVED delta(kind=head bytes=1798) from S5
[S10] cosine check vs S5: cos=-0.0967
[S10] DROPPED delta from S5 (cos=-0.0967 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.7984
[S4] RECEIVED delta(kind=head bytes=1789) from S6
[S4] cosine check vs S6: cos=-0.0757
[S4] DROPPED delta from S6 (cos=-0.0757 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S9
[S4] cosine check vs S9: cos=-0.0324
[S4] DROPPED delta from S9 (cos=-0.0324 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.9846
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=0.8949
[S5] RECEIVED delta(kind=head bytes=1795) from S13
[S5] cosine check vs S13: cos=0.6903
[S16] RECEIVED delta(kind=head bytes=1795) from S10
[S16] cosine check vs S10: cos=-0.0357
[S16] DROPPED delta from S10 (cos=-0.0357 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=-0.0184
[S10] DROPPED delta from S15 (cos=-0.0184 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S2
[S11] cosine check vs S2: cos=-0.0370
[S11] DROPPED delta from S2 (cos=-0.0370 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S7
[S5] cosine check vs S7: cos=-0.0136
[S5] DROPPED delta from S7 (cos=-0.0136 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1790 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1790) from S17
[S5] cosine check vs S17: cos=0.3161
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4159 head_norm=0.862000
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.293797e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4147 head_norm=0.916837 delta_norm=0.229380
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.2869 head_norm=0.954308
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.020450e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4217 head_norm=1.001932 delta_norm=0.102045
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.1423 head_norm=0.623928
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.512163e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.1423 head_norm=0.585582 delta_norm=0.251216
[S5] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.3916 head_norm=0.739685
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.663751e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3929 head_norm=0.802395 delta_norm=0.366375
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3178 head_norm=0.954691
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.876189e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.2871 head_norm=0.804089 delta_norm=0.287619
[S17] aggregate: ROLLBACK (f1_val pre=0.318 post=0.287 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=0.906381 cos_to_last_merge=0.9507 (last merge round=2)
[S2] round=8 local utility u=0.038356 metrics={'f1_val': 0.4168583781965898, 'auprc': 0.7751413298193702, 'loss_val': 1.0225372049964214, 'psi': 0.5601715588457019}-{'f1_val': 0.4160938496492347, 'auprc': 0.7746308970832416, 'loss_val': 1.0931309434056644, 'psi': 0.5595086686228374}
[S3] START round=8 head_norm_before_train=1.004491 cos_to_last_merge=0.9424 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=8 local utility u=0.312912 metrics={'f1_val': 0.401708470248874, 'auprc': 0.93563536656757, 'loss_val': 0.7827583349782717, 'psi': 0.6152792287763524}-{'f1_val': 0.392601475058182, 'auprc': 0.7961467216739285, 'loss_val': 0.9354741835399178, 'psi': 0.5540195737044806}
[S4] START round=8 head_norm_before_train=1.049856 cos_to_last_merge=0.9344 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=8 local utility u=0.016869 metrics={'f1_val': 0.3777540431961674, 'auprc': 0.7611573723932858, 'loss_val': 0.7551843582461357, 'psi': 0.5311153748750148}-{'f1_val': 0.40659761948271333, 'auprc': 0.711377392890209, 'loss_val': 0.8126440069615309, 'psi': 0.5285095288457116}
[S5] START round=8 head_norm_before_train=0.585582 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.051428 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7529585785993641, 'loss_val': 1.2320339149808803, 'psi': 0.38654057429688854}-{'f1_val': 0.14226190476190476, 'auprc': 0.7287618657549148, 'loss_val': 1.2622989451034154, 'psi': 0.3768618891591088}
[S6] START round=8 head_norm_before_train=1.026204 cos_to_last_merge=0.9652 (last merge round=2)
[S6] round=8 local utility u=1.000000 metrics={'f1_val': 0.7105516856147643, 'auprc': 0.8297372732929212, 'loss_val': 0.667454807697865, 'psi': 0.7582259206860271}-{'f1_val': 0.4172560359570804, 'auprc': 0.7905244200450547, 'loss_val': 0.8697243858210518, 'psi': 0.5665633895922702}
[S7] START round=8 head_norm_before_train=1.305149 (no previous merge yet)
[S7] round=8 local utility u=0.913391 metrics={'f1_val': 0.7020546416766301, 'auprc': 0.7940293317097755, 'loss_val': 0.8517923676226238, 'psi': 0.7388445176898883}-{'f1_val': 0.4168747328879592, 'auprc': 0.7948635375146034, 'loss_val': 0.969997663251869, 'psi': 0.5680702547386169}
[S8] START round=8 head_norm_before_train=0.802395 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.046868 metrics={'f1_val': 0.3914144355226541, 'auprc': 0.7767716115267245, 'loss_val': 1.0077358375899133, 'psi': 0.5455573059242822}-{'f1_val': 0.3916117097264612, 'auprc': 0.7768331459356185, 'loss_val': 1.102839500461661, 'psi': 0.5457002842101242}
[S9] START round=8 head_norm_before_train=0.981067 cos_to_last_merge=0.9615 (last merge round=2)
[S9] round=8 local utility u=0.989421 metrics={'f1_val': 0.7021854095275352, 'auprc': 0.9999928053725181, 'loss_val': 0.6590439369812892, 'psi': 0.8213083678655284}-{'f1_val': 0.41637066856105454, 'auprc': 0.9874363190049067, 'loss_val': 0.8853281970125989, 'psi': 0.6447969287385954}
[S10] START round=8 head_norm_before_train=1.373603 (no previous merge yet)
[S10] round=8 local utility u=0.509619 metrics={'f1_val': 0.6925997575894374, 'auprc': 0.9981529080121408, 'loss_val': 0.584792144810031, 'psi': 0.8148210177585188}-{'f1_val': 0.5458915955294925, 'auprc': 0.9972831167769698, 'loss_val': 0.721171616262887, 'psi': 0.7264482040284834}
[S11] START round=8 head_norm_before_train=1.021453 cos_to_last_merge=0.9500 (last merge round=2)
[S11] round=8 local utility u=0.254999 metrics={'f1_val': 0.392422417932622, 'auprc': 0.9980893269538097, 'loss_val': 0.74566092808249, 'psi': 0.6346891815410971}-{'f1_val': 0.39655223592620625, 'auprc': 0.8497826137036727, 'loss_val': 0.835516699625835, 'psi': 0.5778443870371929}
[S13] START round=8 head_norm_before_train=0.916837 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.040756 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.7481198239466224, 'loss_val': 1.0452462861058218, 'psi': 0.548850249338126}-{'f1_val': 0.4158809972763461, 'auprc': 0.7309300666614093, 'loss_val': 1.0744509568938791, 'psi': 0.5419006250303713}
[S14] START round=8 head_norm_before_train=1.057288 cos_to_last_merge=0.9419 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=8 local utility u=0.051032 metrics={'f1_val': 0.4984469353985349, 'auprc': 0.9751617254689084, 'loss_val': 0.8492300165814451, 'psi': 0.6891328514266843}-{'f1_val': 0.5212944122005445, 'auprc': 0.9605843867173957, 'loss_val': 1.04464724986448, 'psi': 0.6970104020072849}
[S15] START round=8 head_norm_before_train=1.001932 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.043388 metrics={'f1_val': 0.28965904932344266, 'auprc': 0.7762285214022204, 'loss_val': 1.1500641333975867, 'psi': 0.48428683815495377}-{'f1_val': 0.2868773990354647, 'auprc': 0.7751294738648938, 'loss_val': 1.216852254672108, 'psi': 0.4821782289672364}
[S16] START round=8 head_norm_before_train=1.331873 (no previous merge yet)
[S16] round=8 local utility u=0.304877 metrics={'f1_val': 0.3846654422063627, 'auprc': 0.7562400848511356, 'loss_val': 0.8484202752207504, 'psi': 0.5332952992642719}-{'f1_val': 0.3841721535499099, 'auprc': 0.5643111725741113, 'loss_val': 0.8794281545215612, 'psi': 0.4562277611595905}
[S17] START round=8 head_norm_before_train=0.804089 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.447199 metrics={'f1_val': 0.3878660676315645, 'auprc': 0.7017069028164518, 'loss_val': 1.0082567839024483, 'psi': 0.5134024017055194}-{'f1_val': 0.31776984612324355, 'auprc': 0.5514602496801386, 'loss_val': 1.03133772410623, 'psi': 0.4112460075460016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:31605
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S2
[S11] cosine check vs S2: cos=-0.0220
[S11] DROPPED delta from S2 (cos=-0.0220 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] cosine check vs S3: cos=0.9122
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.7185
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] cosine check vs S11: cos=0.9581
[S2] RECEIVED delta(kind=head bytes=1795) from S16
[S2] cosine check vs S16: cos=-0.0530
[S2] DROPPED delta from S16 (cos=-0.0530 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S10
[S16] cosine check vs S10: cos=-0.0362
[S16] DROPPED delta from S10 (cos=-0.0362 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S7
[S5] cosine check vs S7: cos=-0.0203
[S5] DROPPED delta from S7 (cos=-0.0203 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S4
[S5] cosine check vs S4: cos=0.5251
[S5] RECEIVED delta(kind=head bytes=1799) from S13
[S5] cosine check vs S13: cos=0.6691
[S4] RECEIVED delta(kind=head bytes=1788) from S9
[S4] cosine check vs S9: cos=-0.0244
[S4] DROPPED delta from S9 (cos=-0.0244 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.9890
[S10] RECEIVED delta(kind=head bytes=1800) from S5
[S10] cosine check vs S5: cos=-0.0893
[S10] DROPPED delta from S5 (cos=-0.0893 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=-0.0079
[S10] DROPPED delta from S15 (cos=-0.0079 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=-0.0698
[S4] DROPPED delta from S6 (cos=-0.0698 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] cosine check vs S17: cos=0.6315
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3914 head_norm=0.831074
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.293560e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3914 head_norm=0.927480 delta_norm=0.229356
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4160 head_norm=0.938749
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.600536e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4162 head_norm=0.995532 delta_norm=0.160054
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.2897 head_norm=1.017340
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.265719e-02
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.5353 head_norm=1.063149 delta_norm=0.092657
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3879 head_norm=0.853425
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.161717e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3914 head_norm=0.780733 delta_norm=0.316172
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.1423 head_norm=0.600083
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.840345e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.1423 head_norm=0.622889 delta_norm=0.184034
[S5] aggregate: ACCEPT kept=['S4', 'S13', 'S17'] (k=3/3) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.946914 cos_to_last_merge=0.9346 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=9 local utility u=0.528014 metrics={'f1_val': 0.5756435451031837, 'auprc': 0.7766688394202084, 'loss_val': 0.9238033433948962, 'psi': 0.6560536628299936}-{'f1_val': 0.4168583781965898, 'auprc': 0.7751413298193702, 'loss_val': 1.0225372049964214, 'psi': 0.5601715588457019}
[S3] START round=9 head_norm_before_train=1.065346 cos_to_last_merge=0.9185 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=9 local utility u=0.113923 metrics={'f1_val': 0.401708470248874, 'auprc': 0.9984879937761981, 'loss_val': 0.743470334676865, 'psi': 0.6404202796598036}-{'f1_val': 0.401708470248874, 'auprc': 0.93563536656757, 'loss_val': 0.7827583349782717, 'psi': 0.6152792287763524}
[S4] START round=9 head_norm_before_train=1.101291 cos_to_last_merge=0.9164 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=9 local utility u=0.175448 metrics={'f1_val': 0.42877097673002595, 'auprc': 0.7622261649085745, 'loss_val': 0.7135959760809684, 'psi': 0.5621530520014454}-{'f1_val': 0.3777540431961674, 'auprc': 0.7611573723932858, 'loss_val': 0.7551843582461357, 'psi': 0.5311153748750148}
[S5] START round=9 head_norm_before_train=0.622889 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.616096 metrics={'f1_val': 0.41682233851178174, 'auprc': 0.6019663285116199, 'loss_val': 1.19422735866681, 'psi': 0.49087993451171696}-{'f1_val': 0.14226190476190476, 'auprc': 0.7529585785993641, 'loss_val': 1.2320339149808803, 'psi': 0.38654057429688854}
[S6] START round=9 head_norm_before_train=1.068954 cos_to_last_merge=0.9539 (last merge round=2)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.5366282876046485, 'auprc': 0.7858927711196555, 'loss_val': 0.665068803745146, 'psi': 0.6363340810106514}-{'f1_val': 0.7105516856147643, 'auprc': 0.8297372732929212, 'loss_val': 0.667454807697865, 'psi': 0.7582259206860271}
[S7] START round=9 head_norm_before_train=1.336854 (no previous merge yet)
[S7] round=9 local utility u=0.041785 metrics={'f1_val': 0.6995217640430342, 'auprc': 0.7927423486443751, 'loss_val': 0.7491635071672567, 'psi': 0.7368099978835706}-{'f1_val': 0.7020546416766301, 'auprc': 0.7940293317097755, 'loss_val': 0.8517923676226238, 'psi': 0.7388445176898883}
[S8] START round=9 head_norm_before_train=0.927480 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.055707 metrics={'f1_val': 0.39142297119173725, 'auprc': 0.7771031532614671, 'loss_val': 0.8973675999772073, 'psi': 0.5456950440196292}-{'f1_val': 0.3914144355226541, 'auprc': 0.7767716115267245, 'loss_val': 1.0077358375899133, 'psi': 0.5455573059242822}
[S9] START round=9 head_norm_before_train=1.032599 cos_to_last_merge=0.9482 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=9 local utility u=0.079648 metrics={'f1_val': 0.7020387521689408, 'auprc': 0.9991904847319932, 'loss_val': 0.49646121039129526, 'psi': 0.8208994451941618}-{'f1_val': 0.7021854095275352, 'auprc': 0.9999928053725181, 'loss_val': 0.6590439369812892, 'psi': 0.8213083678655284}
[S10] START round=9 head_norm_before_train=1.419408 (no previous merge yet)
[S10] round=9 local utility u=0.083729 metrics={'f1_val': 0.7016401924031649, 'auprc': 0.9981377910472897, 'loss_val': 0.47153045872840077, 'psi': 0.8202392318608148}-{'f1_val': 0.6925997575894374, 'auprc': 0.9981529080121408, 'loss_val': 0.584792144810031, 'psi': 0.8148210177585188}
[S11] START round=9 head_norm_before_train=1.073385 cos_to_last_merge=0.9322 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=9 local utility u=0.044950 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.998909804069036, 'loss_val': 0.7032400572926016, 'psi': 0.6395191733090776}-{'f1_val': 0.392422417932622, 'auprc': 0.9980893269538097, 'loss_val': 0.74566092808249, 'psi': 0.6346891815410971}
[S13] START round=9 head_norm_before_train=0.995532 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.908587 metrics={'f1_val': 0.7058395277862549, 'auprc': 0.7472492137296495, 'loss_val': 0.9644737901871412, 'psi': 0.7224034021636128}-{'f1_val': 0.4160038662657951, 'auprc': 0.7481198239466224, 'loss_val': 1.0452462861058218, 'psi': 0.548850249338126}
[S14] START round=9 head_norm_before_train=1.114793 cos_to_last_merge=0.9278 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.928
[S14] round=9 local utility u=0.711600 metrics={'f1_val': 0.697521861520324, 'auprc': 0.9932464449493369, 'loss_val': 0.6747328561308032, 'psi': 0.8158116948919292}-{'f1_val': 0.4984469353985349, 'auprc': 0.9751617254689084, 'loss_val': 0.8492300165814451, 'psi': 0.6891328514266843}
[S15] START round=9 head_norm_before_train=1.063149 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.7142054472305434, 'auprc': 0.7759997275434475, 'loss_val': 1.0355779447314635, 'psi': 0.7389231593557051}-{'f1_val': 0.28965904932344266, 'auprc': 0.7762285214022204, 'loss_val': 1.1500641333975867, 'psi': 0.48428683815495377}
[S16] START round=9 head_norm_before_train=1.368232 (no previous merge yet)
[S16] round=9 local utility u=0.015235 metrics={'f1_val': 0.38118534598803255, 'auprc': 0.7601326904225005, 'loss_val': 0.8087471436046069, 'psi': 0.5327642837618197}-{'f1_val': 0.3846654422063627, 'auprc': 0.7562400848511356, 'loss_val': 0.8484202752207504, 'psi': 0.5332952992642719}
[S17] START round=9 head_norm_before_train=0.780733 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.36818337687136754, 'auprc': 0.6455908479373595, 'loss_val': 0.9275441806820345, 'psi': 0.47914636529776433}-{'f1_val': 0.3878660676315645, 'auprc': 0.7017069028164518, 'loss_val': 1.0082567839024483, 'psi': 0.5134024017055194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:31605
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] cosine check vs S15: cos=0.0009
[S16] RECEIVED delta(kind=head bytes=1801) from S10
[S16] cosine check vs S10: cos=-0.0354
[S16] DROPPED delta from S10 (cos=-0.0354 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S7
[S5] cosine check vs S7: cos=-0.0120
[S5] DROPPED delta from S7 (cos=-0.0120 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1788) from S8
[S17] cosine check vs S8: cos=0.8326
[S11] RECEIVED delta(kind=head bytes=1803) from S2
[S11] cosine check vs S2: cos=-0.0051
[S11] DROPPED delta from S2 (cos=-0.0051 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S13
[S5] cosine check vs S13: cos=0.7572
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=0.9602
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=0.6507
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.9724
[S10] RECEIVED delta(kind=head bytes=1807) from S5
[S10] cosine check vs S5: cos=-0.0720
[S10] DROPPED delta from S5 (cos=-0.0720 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S9
[S4] cosine check vs S9: cos=-0.0166
[S4] DROPPED delta from S9 (cos=-0.0166 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9904
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] cosine check vs S16: cos=-0.0595
[S2] DROPPED delta from S16 (cos=-0.0595 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.7142 head_norm=1.085038
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.871152e-02
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.7109 head_norm=1.124181 delta_norm=0.088712
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4168 head_norm=0.643132
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.664566e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4177 head_norm=0.748493 delta_norm=0.266457
[S5] aggregate: ACCEPT kept=['S13', 'S4'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.7058 head_norm=1.019478
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.358125e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4158 head_norm=1.063812 delta_norm=0.135812
[S13] aggregate: ROLLBACK (f1_val pre=0.706 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.7016 head_norm=1.467058
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.119695e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.6957 head_norm=0.912740 delta_norm=0.911970
[S10] aggregate: ROLLBACK (f1_val pre=0.702 post=0.696 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3914 head_norm=0.955872
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.686344e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.4120 head_norm=1.029509 delta_norm=0.168634
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3682 head_norm=0.835245
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.654281e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3720 head_norm=0.857444 delta_norm=0.265428
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.992438 cos_to_last_merge=0.9165 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.917
[S2] round=10 local utility u=0.296837 metrics={'f1_val': 0.6630235128679949, 'auprc': 0.7792814555013718, 'loss_val': 0.862246808089645, 'psi': 0.7095266899213457}-{'f1_val': 0.5756435451031837, 'auprc': 0.7766688394202084, 'loss_val': 0.9238033433948962, 'psi': 0.6560536628299936}
[S3] START round=10 head_norm_before_train=1.123815 cos_to_last_merge=0.8958 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.896
[S3] round=10 local utility u=0.077426 metrics={'f1_val': 0.41339141450277506, 'auprc': 0.9985378478709975, 'loss_val': 0.6588653897787354, 'psi': 0.6474499878500641}-{'f1_val': 0.401708470248874, 'auprc': 0.9984879937761981, 'loss_val': 0.743470334676865, 'psi': 0.6404202796598036}
[S4] START round=10 head_norm_before_train=1.151879 cos_to_last_merge=0.8997 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.900
[S4] round=10 local utility u=0.007502 metrics={'f1_val': 0.43394881698403576, 'auprc': 0.7512341610251689, 'loss_val': 0.696683033312147, 'psi': 0.5608629546004891}-{'f1_val': 0.42877097673002595, 'auprc': 0.7622261649085745, 'loss_val': 0.7135959760809684, 'psi': 0.5621530520014454}
[S5] START round=10 head_norm_before_train=0.748493 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.293219 metrics={'f1_val': 0.41952175534048464, 'auprc': 0.7727928635031631, 'loss_val': 1.1364647058245754, 'psi': 0.560830198605556}-{'f1_val': 0.41682233851178174, 'auprc': 0.6019663285116199, 'loss_val': 1.19422735866681, 'psi': 0.49087993451171696}
[S6] START round=10 head_norm_before_train=1.113521 cos_to_last_merge=0.9411 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.49609987565242564, 'auprc': 0.7869344753893556, 'loss_val': 0.6599404704787714, 'psi': 0.6124337155471976}-{'f1_val': 0.5366282876046485, 'auprc': 0.7858927711196555, 'loss_val': 0.665068803745146, 'psi': 0.6363340810106514}
[S7] START round=10 head_norm_before_train=1.373250 (no previous merge yet)
[S7] round=10 local utility u=0.008658 metrics={'f1_val': 0.6836472947521146, 'auprc': 0.7927882178256953, 'loss_val': 0.6367390698932746, 'psi': 0.7273036639815469}-{'f1_val': 0.6995217640430342, 'auprc': 0.7927423486443751, 'loss_val': 0.7491635071672567, 'psi': 0.7368099978835706}
[S8] START round=10 head_norm_before_train=1.029509 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.039469 metrics={'f1_val': 0.3914192899596519, 'auprc': 0.7770970206565904, 'loss_val': 0.8183885097059227, 'psi': 0.5456903822384274}-{'f1_val': 0.39142297119173725, 'auprc': 0.7771031532614671, 'loss_val': 0.8973675999772073, 'psi': 0.5456950440196292}
[S9] START round=10 head_norm_before_train=1.094825 cos_to_last_merge=0.9324 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.932
[S9] round=10 local utility u=0.061004 metrics={'f1_val': 0.7017906989076834, 'auprc': 0.9988576889706899, 'loss_val': 0.37196578275587877, 'psi': 0.820617494932886}-{'f1_val': 0.7020387521689408, 'auprc': 0.9991904847319932, 'loss_val': 0.49646121039129526, 'psi': 0.8208994451941618}
[S10] START round=10 head_norm_before_train=0.912740 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.7002972970402976, 'auprc': 0.9977569347952607, 'loss_val': 0.5547017613840659, 'psi': 0.8192811521422829}-{'f1_val': 0.7016401924031649, 'auprc': 0.9981377910472897, 'loss_val': 0.47153045872840077, 'psi': 0.8202392318608148}
[S11] START round=10 head_norm_before_train=1.122918 cos_to_last_merge=0.9149 (last merge round=2)
[S11] ⚠️ Model drifted since last merge! cos=0.915
[S11] round=10 local utility u=0.261983 metrics={'f1_val': 0.4707358325682616, 'auprc': 0.9986495994923448, 'loss_val': 0.6033563528529452, 'psi': 0.681901339337895}-{'f1_val': 0.39992541946910537, 'auprc': 0.998909804069036, 'loss_val': 0.7032400572926016, 'psi': 0.6395191733090776}
[S13] START round=10 head_norm_before_train=1.063812 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.050804 metrics={'f1_val': 0.7116411800817113, 'auprc': 0.7456528153684054, 'loss_val': 0.8928869231921635, 'psi': 0.725245834196389}-{'f1_val': 0.7058395277862549, 'auprc': 0.7472492137296495, 'loss_val': 0.9644737901871412, 'psi': 0.7224034021636128}
[S14] START round=10 head_norm_before_train=1.168758 cos_to_last_merge=0.9137 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.914
[S14] round=10 local utility u=0.139776 metrics={'f1_val': 0.7018212924835998, 'auprc': 0.9959686847720324, 'loss_val': 0.4291433690423562, 'psi': 0.8194802493989728}-{'f1_val': 0.697521861520324, 'auprc': 0.9932464449493369, 'loss_val': 0.6747328561308032, 'psi': 0.8158116948919292}
[S15] START round=10 head_norm_before_train=1.124181 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.132379 metrics={'f1_val': 0.7123721830192656, 'auprc': 0.7999720180625132, 'loss_val': 0.8317368508538596, 'psi': 0.7474121170365646}-{'f1_val': 0.7142054472305434, 'auprc': 0.7759997275434475, 'loss_val': 1.0355779447314635, 'psi': 0.7389231593557051}
[S16] START round=10 head_norm_before_train=1.408995 (no previous merge yet)
[S16] round=10 local utility u=0.051261 metrics={'f1_val': 0.3856359387144706, 'auprc': 0.765218072212532, 'loss_val': 0.7481852201387347, 'psi': 0.5374687921136951}-{'f1_val': 0.38118534598803255, 'auprc': 0.7601326904225005, 'loss_val': 0.8087471436046069, 'psi': 0.5327642837618197}
[S17] START round=10 head_norm_before_train=0.857444 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3538791845436075, 'auprc': 0.6005735514594547, 'loss_val': 0.9064790883937095, 'psi': 0.45255693130994634}-{'f1_val': 0.36818337687136754, 'auprc': 0.6455908479373595, 'loss_val': 0.9275441806820345, 'psi': 0.47914636529776433}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9212
[S4] RECEIVED delta(kind=head bytes=1789) from S9
[S4] cosine check vs S9: cos=-0.0097
[S4] DROPPED delta from S9 (cos=-0.0097 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S7
[S5] cosine check vs S7: cos=0.0049
[S5] RECEIVED delta(kind=head bytes=1793) from S13
[S5] cosine check vs S13: cos=0.8057
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] cosine check vs S15: cos=0.5670
[S2] RECEIVED delta(kind=head bytes=1793) from S16
[S2] cosine check vs S16: cos=-0.0636
[S2] DROPPED delta from S16 (cos=-0.0636 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9905
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] cosine check vs S3: cos=0.9739
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=0.9779
[S10] RECEIVED delta(kind=head bytes=1797) from S5
[S10] cosine check vs S5: cos=-0.0654
[S10] DROPPED delta from S5 (cos=-0.0654 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S2
[S11] cosine check vs S2: cos=0.0123
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=0.7979
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.380 → S4@127.0.0.1:31604
[S2] ⇄ pheromone p=0.365 → S11@127.0.0.1:31612
[S4] ⇄ pheromone p=0.258 → S5@127.0.0.1:31605
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4195 head_norm=0.767433
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.978914e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4200 head_norm=0.771010 delta_norm=0.197891
[S5] aggregate: ACCEPT kept=['S7', 'S13', 'S4'] (k=3/3) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.278 → S10@127.0.0.1:31611
[S3] ⇄ pheromone p=0.311 → S8@127.0.0.1:31609
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3914 head_norm=1.059675
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.393158e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3914 head_norm=1.108995 delta_norm=0.139316
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.215 → S17@127.0.0.1:31617
[S6] ⇄ pheromone p=0.331 → S4@127.0.0.1:31604
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7124 head_norm=1.157461
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.984651e-02
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7031 head_norm=1.190704 delta_norm=0.089847
[S15] aggregate: ROLLBACK (f1_val pre=0.712 post=0.703 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.362 → S10@127.0.0.1:31611
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.7116 head_norm=1.090082
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.242237e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.7109 head_norm=1.121416 delta_norm=0.124224
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.374 → S5@127.0.0.1:31605
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.4707 head_norm=1.165218
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.772679e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.5590 head_norm=0.786855 delta_norm=0.777268
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.299 → S13@127.0.0.1:31613
[S14] ⇄ pheromone p=0.395 → S15@127.0.0.1:31615
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.7003 head_norm=0.967911
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.015503e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.7002 head_norm=0.941664 delta_norm=0.501550
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.336 → S16@127.0.0.1:31616
[S16] ⇄ pheromone p=0.249 → S2@127.0.0.1:31602
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3539 head_norm=0.905598
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.091355e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3539 head_norm=0.963209 delta_norm=0.209136
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.260 → S5@127.0.0.1:31605
[S7] ⇄ pheromone p=0.339 → S5@127.0.0.1:31605
[S2] START round=11 head_norm_before_train=1.043475 cos_to_last_merge=0.8973 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.6327769839494076, 'auprc': 0.7778380703765352, 'loss_val': 0.8810108994530764, 'psi': 0.6908014185202587}-{'f1_val': 0.6630235128679949, 'auprc': 0.7792814555013718, 'loss_val': 0.862246808089645, 'psi': 0.7095266899213457}
[S3] START round=11 head_norm_before_train=1.172879 cos_to_last_merge=0.8768 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.877
[S3] round=11 local utility u=0.957757 metrics={'f1_val': 0.69982954919712, 'auprc': 0.9971091358651196, 'loss_val': 0.4576935694154834, 'psi': 0.8187413838643198}-{'f1_val': 0.41339141450277506, 'auprc': 0.9985378478709975, 'loss_val': 0.6588653897787354, 'psi': 0.6474499878500641}
[S4] START round=11 head_norm_before_train=1.200984 cos_to_last_merge=0.8844 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.884
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.454508115196047, 'auprc': 0.6730382112819875, 'loss_val': 0.6137626311207246, 'psi': 0.5419201536304232}-{'f1_val': 0.43394881698403576, 'auprc': 0.7512341610251689, 'loss_val': 0.696683033312147, 'psi': 0.5608629546004891}
[S5] START round=11 head_norm_before_train=0.771010 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.4189168617038657, 'auprc': 0.6690235345468849, 'loss_val': 1.0650456396510828, 'psi': 0.5189595308410734}-{'f1_val': 0.41952175534048464, 'auprc': 0.7727928635031631, 'loss_val': 1.1364647058245754, 'psi': 0.560830198605556}
[S6] START round=11 head_norm_before_train=1.161433 cos_to_last_merge=0.9286 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=11 local utility u=0.984735 metrics={'f1_val': 0.7071507414533961, 'auprc': 0.9578582802843663, 'loss_val': 0.4695480732534059, 'psi': 0.8074337569857841}-{'f1_val': 0.49609987565242564, 'auprc': 0.7869344753893556, 'loss_val': 0.6599404704787714, 'psi': 0.6124337155471976}
[S7] START round=11 head_norm_before_train=1.399156 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.48257873898415127, 'auprc': 0.7842907157356955, 'loss_val': 0.7653304066438977, 'psi': 0.603263529684769}-{'f1_val': 0.6836472947521146, 'auprc': 0.7927882178256953, 'loss_val': 0.6367390698932746, 'psi': 0.7273036639815469}
[S8] START round=11 head_norm_before_train=1.108995 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.024776 metrics={'f1_val': 0.3914192899596519, 'auprc': 0.7769198233087143, 'loss_val': 0.7683044053113186, 'psi': 0.5456195032992769}-{'f1_val': 0.3914192899596519, 'auprc': 0.7770970206565904, 'loss_val': 0.8183885097059227, 'psi': 0.5456903822384274}
[S9] START round=11 head_norm_before_train=1.158326 cos_to_last_merge=0.9154 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.915
[S9] round=11 local utility u=0.024720 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.998355392319031, 'loss_val': 0.31907625780834953, 'psi': 0.8202222133058155}-{'f1_val': 0.7017906989076834, 'auprc': 0.9988576889706899, 'loss_val': 0.37196578275587877, 'psi': 0.820617494932886}
[S10] START round=11 head_norm_before_train=0.941664 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6915325146439928, 'auprc': 0.9934646117293239, 'loss_val': 0.6014189225594244, 'psi': 0.8123053534781253}-{'f1_val': 0.7002972970402976, 'auprc': 0.9977569347952607, 'loss_val': 0.5547017613840659, 'psi': 0.8192811521422829}
[S11] START round=11 head_norm_before_train=0.786855 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.497902 metrics={'f1_val': 0.6461488903267308, 'auprc': 0.998447732243477, 'loss_val': 0.6594250271978939, 'psi': 0.7870684270934294}-{'f1_val': 0.4707358325682616, 'auprc': 0.9986495994923448, 'loss_val': 0.6033563528529452, 'psi': 0.681901339337895}
[S13] START round=11 head_norm_before_train=1.121416 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.061802 metrics={'f1_val': 0.711815531100338, 'auprc': 0.7472944201866714, 'loss_val': 0.7752548186761348, 'psi': 0.7260070867348714}-{'f1_val': 0.7116411800817113, 'auprc': 0.7456528153684054, 'loss_val': 0.8928869231921635, 'psi': 0.725245834196389}
[S14] START round=11 head_norm_before_train=1.229627 cos_to_last_merge=0.8994 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.899
[S14] round=11 local utility u=0.052982 metrics={'f1_val': 0.7023047375160051, 'auprc': 0.9967603136848493, 'loss_val': 0.32845578372993367, 'psi': 0.8200869679835427}-{'f1_val': 0.7018212924835998, 'auprc': 0.9959686847720324, 'loss_val': 0.4291433690423562, 'psi': 0.8194802493989728}
[S15] START round=11 head_norm_before_train=1.190704 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.142288 metrics={'f1_val': 0.7083940254141221, 'auprc': 0.8344263208011753, 'loss_val': 0.6266538344577599, 'psi': 0.7588069435689434}-{'f1_val': 0.7123721830192656, 'auprc': 0.7999720180625132, 'loss_val': 0.8317368508538596, 'psi': 0.7474121170365646}
[S16] START round=11 head_norm_before_train=1.448715 (no previous merge yet)
[S16] round=11 local utility u=0.516291 metrics={'f1_val': 0.549490436289566, 'auprc': 0.7762514409392818, 'loss_val': 0.7318306487906122, 'psi': 0.6401948381494522}-{'f1_val': 0.3856359387144706, 'auprc': 0.765218072212532, 'loss_val': 0.7481852201387347, 'psi': 0.5374687921136951}
[S17] START round=11 head_norm_before_train=0.963209 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.019788 metrics={'f1_val': 0.35294217413206974, 'auprc': 0.6140852085681328, 'loss_val': 0.9018160606715955, 'psi': 0.4573993879064949}-{'f1_val': 0.3538791845436075, 'auprc': 0.6005735514594547, 'loss_val': 0.9064790883937095, 'psi': 0.45255693130994634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[S9] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9601
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] cosine check vs S6: cos=-0.0652
[S4] DROPPED delta from S6 (cos=-0.0652 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S9
[S4] cosine check vs S9: cos=-0.0054
[S4] DROPPED delta from S9 (cos=-0.0054 < 0.0)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] cosine check vs S15: cos=0.8684
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:31613
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:31609
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:31602
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.7463
[S5] RECEIVED delta(kind=head bytes=1796) from S13
[S5] cosine check vs S13: cos=0.7936
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.9899
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:31605
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S3
[S8] cosine check vs S3: cos=0.9791
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=-0.0654
[S2] DROPPED delta from S16 (cos=-0.0654 < 0.0)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S17
[S5] cosine check vs S17: cos=0.3157
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3914 head_norm=1.142305
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.265657e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3914 head_norm=1.174217 delta_norm=0.126566
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4189 head_norm=0.792543
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.379769e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4188 head_norm=0.774581 delta_norm=0.337977
[S5] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6915 head_norm=0.984761
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.089424e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6855 head_norm=1.072564 delta_norm=0.308942
[S10] aggregate: ROLLBACK (f1_val pre=0.692 post=0.686 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7084 head_norm=1.233664
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.379353e-02
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.7016 head_norm=1.258565 delta_norm=0.093794
[S15] aggregate: ROLLBACK (f1_val pre=0.708 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.7118 head_norm=1.145119
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.811999e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.7119 head_norm=0.927748 delta_norm=0.381200
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3529 head_norm=1.004058
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.663242e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3529 head_norm=1.062465 delta_norm=0.166324
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.101068 cos_to_last_merge=0.8783 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.878
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6179408723910556, 'auprc': 0.6471148210353407, 'loss_val': 0.7642590046381235, 'psi': 0.6296104518487696}-{'f1_val': 0.6327769839494076, 'auprc': 0.7778380703765352, 'loss_val': 0.8810108994530764, 'psi': 0.6908014185202587}
[S3] START round=12 head_norm_before_train=1.218503 cos_to_last_merge=0.8588 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.859
[S3] round=12 local utility u=0.032677 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9973438275566076, 'loss_val': 0.3990836967842266, 'psi': 0.8194392684687166}-{'f1_val': 0.69982954919712, 'auprc': 0.9971091358651196, 'loss_val': 0.4576935694154834, 'psi': 0.8187413838643198}
[S4] START round=12 head_norm_before_train=1.247271 cos_to_last_merge=0.8716 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.872
[S4] round=12 local utility u=0.307448 metrics={'f1_val': 0.5543416246186846, 'auprc': 0.6658256328530289, 'loss_val': 0.5762291903583031, 'psi': 0.5989352279124223}-{'f1_val': 0.454508115196047, 'auprc': 0.6730382112819875, 'loss_val': 0.6137626311207246, 'psi': 0.5419201536304232}
[S5] START round=12 head_norm_before_train=0.774581 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.036233 metrics={'f1_val': 0.4183096290822199, 'auprc': 0.6683017890464557, 'loss_val': 0.9867710717575013, 'psi': 0.5183064930679142}-{'f1_val': 0.4189168617038657, 'auprc': 0.6690235345468849, 'loss_val': 1.0650456396510828, 'psi': 0.5189595308410734}
[S6] START round=12 head_norm_before_train=1.202177 cos_to_last_merge=0.9180 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.918
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6175682257066223, 'auprc': 0.7975921899961425, 'loss_val': 0.5412780462684417, 'psi': 0.6895778114224304}-{'f1_val': 0.7071507414533961, 'auprc': 0.9578582802843663, 'loss_val': 0.4695480732534059, 'psi': 0.8074337569857841}
[S7] START round=12 head_norm_before_train=1.421754 (no previous merge yet)
[S7] round=12 local utility u=0.658962 metrics={'f1_val': 0.6555803004012234, 'auprc': 0.8169966162403552, 'loss_val': 0.5835331210577722, 'psi': 0.7201468267368761}-{'f1_val': 0.48257873898415127, 'auprc': 0.7842907157356955, 'loss_val': 0.7653304066438977, 'psi': 0.603263529684769}
[S8] START round=12 head_norm_before_train=1.174217 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.396891 metrics={'f1_val': 0.39261202980429966, 'auprc': 0.9976610973072186, 'loss_val': 0.643901775361878, 'psi': 0.6346316568054673}-{'f1_val': 0.3914192899596519, 'auprc': 0.7769198233087143, 'loss_val': 0.7683044053113186, 'psi': 0.5456195032992769}
[S9] START round=12 head_norm_before_train=1.220380 cos_to_last_merge=0.8989 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.899
[S9] round=12 local utility u=0.015074 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9981550984673957, 'loss_val': 0.2883281751307628, 'psi': 0.8201420957651613}-{'f1_val': 0.7014667606303384, 'auprc': 0.998355392319031, 'loss_val': 0.31907625780834953, 'psi': 0.8202222133058155}
[S10] START round=12 head_norm_before_train=1.072564 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.010282 metrics={'f1_val': 0.6932950742131788, 'auprc': 0.9916271043846834, 'loss_val': 0.5859174798967842, 'psi': 0.8126278862817806}-{'f1_val': 0.6915325146439928, 'auprc': 0.9934646117293239, 'loss_val': 0.6014189225594244, 'psi': 0.8123053534781253}
[S11] START round=12 head_norm_before_train=0.837115 cos_to_last_merge=0.9969 (last merge round=10)
[S11] round=12 local utility u=0.220728 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9979612138895055, 'loss_val': 0.5516204587806174, 'psi': 0.8203849511233414}-{'f1_val': 0.6461488903267308, 'auprc': 0.998447732243477, 'loss_val': 0.6594250271978939, 'psi': 0.7870684270934294}
[S13] START round=12 head_norm_before_train=0.927748 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.7122119308330156, 'auprc': 0.7466416177734164, 'loss_val': 0.7876451405989681, 'psi': 0.7259838056091759}-{'f1_val': 0.711815531100338, 'auprc': 0.7472944201866714, 'loss_val': 0.7752548186761348, 'psi': 0.7260070867348714}
[S14] START round=12 head_norm_before_train=1.289822 cos_to_last_merge=0.8853 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.885
[S14] round=12 local utility u=0.755443 metrics={'f1_val': 0.9411383670136257, 'auprc': 0.9960413015453948, 'loss_val': 0.24841436820490487, 'psi': 0.9630995408263334}-{'f1_val': 0.7023047375160051, 'auprc': 0.9967603136848493, 'loss_val': 0.32845578372993367, 'psi': 0.8200869679835427}
[S15] START round=12 head_norm_before_train=1.258565 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.272717 metrics={'f1_val': 0.695068897609503, 'auprc': 0.997425558202771, 'loss_val': 0.49026607462911526, 'psi': 0.8160115618468102}-{'f1_val': 0.7083940254141221, 'auprc': 0.8344263208011753, 'loss_val': 0.6266538344577599, 'psi': 0.7588069435689434}
[S16] START round=12 head_norm_before_train=1.484303 (no previous merge yet)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.4630400766304193, 'auprc': 0.7792993304269742, 'loss_val': 0.6912317591565487, 'psi': 0.5895437781490412}-{'f1_val': 0.549490436289566, 'auprc': 0.7762514409392818, 'loss_val': 0.7318306487906122, 'psi': 0.6401948381494522}
[S17] START round=12 head_norm_before_train=1.062465 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.35145309405070796, 'auprc': 0.5841810600921933, 'loss_val': 0.9255377976704993, 'psi': 0.4445442804673021}-{'f1_val': 0.35294217413206974, 'auprc': 0.6140852085681328, 'loss_val': 0.9018160606715955, 'psi': 0.4573993879064949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:31602
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:31613
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:31610
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=0.6229
[S13] RECEIVED delta(kind=head bytes=1804) from S5
[S13] cosine check vs S5: cos=0.8516
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] cosine check vs S4: cos=-0.0034
[S9] DROPPED delta from S4 (cos=-0.0034 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S10
[S15] cosine check vs S10: cos=0.9465
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.9908
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.9821
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9411 head_norm=1.346814
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.254770e-02
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9294 head_norm=1.321078 delta_norm=0.092548
[S14] aggregate: ROLLBACK (f1_val pre=0.941 post=0.929 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7008 head_norm=1.265180
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.201679e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7006 head_norm=1.232536 delta_norm=0.120168
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.6179 head_norm=1.155006
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.613805e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.6106 head_norm=0.930090 delta_norm=0.461381
[S2] aggregate: ROLLBACK (f1_val pre=0.618 post=0.611 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.7122 head_norm=0.956816
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.508794e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.7120 head_norm=0.846942 delta_norm=0.250879
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6951 head_norm=1.301427
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.191842e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6954 head_norm=1.187848 delta_norm=0.219184
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=0.930090 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.521615 metrics={'f1_val': 0.7120818973722733, 'auprc': 0.7789445917263431, 'loss_val': 0.6813647668818241, 'psi': 0.7388269751139013}-{'f1_val': 0.6179408723910556, 'auprc': 0.6471148210353407, 'loss_val': 0.7642590046381235, 'psi': 0.6296104518487696}
[S3] START round=13 head_norm_before_train=1.232536 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.016055 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9972941816268779, 'loss_val': 0.36529491802301645, 'psi': 0.8192665102460042}-{'f1_val': 0.7008362290767893, 'auprc': 0.9973438275566076, 'loss_val': 0.3990836967842266, 'psi': 0.8194392684687166}
[S4] START round=13 head_norm_before_train=1.291284 cos_to_last_merge=0.8597 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.860
[S4] round=13 local utility u=0.421132 metrics={'f1_val': 0.6797634222769384, 'auprc': 0.6743045763110166, 'loss_val': 0.5119332517084738, 'psi': 0.6775798838905697}-{'f1_val': 0.5543416246186846, 'auprc': 0.6658256328530289, 'loss_val': 0.5762291903583031, 'psi': 0.5989352279124223}
[S5] START round=13 head_norm_before_train=0.803122 cos_to_last_merge=0.9950 (last merge round=11)
[S5] round=13 local utility u=0.135154 metrics={'f1_val': 0.43729965937461046, 'auprc': 0.6683663767761638, 'loss_val': 0.8305962575849021, 'psi': 0.5297263463352317}-{'f1_val': 0.4183096290822199, 'auprc': 0.6683017890464557, 'loss_val': 0.9867710717575013, 'psi': 0.5183064930679142}
[S6] START round=13 head_norm_before_train=1.231817 cos_to_last_merge=0.9096 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.910
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.5317085931366, 'auprc': 0.779936894914051, 'loss_val': 0.6669089561739043, 'psi': 0.6309999138475805}-{'f1_val': 0.6175682257066223, 'auprc': 0.7975921899961425, 'loss_val': 0.5412780462684417, 'psi': 0.6895778114224304}
[S7] START round=13 head_norm_before_train=1.444848 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.598514760174685, 'auprc': 0.7970798835283792, 'loss_val': 0.6469617766287283, 'psi': 0.6779408095161628}-{'f1_val': 0.6555803004012234, 'auprc': 0.8169966162403552, 'loss_val': 0.5835331210577722, 'psi': 0.7201468267368761}
[S8] START round=13 head_norm_before_train=1.210988 cos_to_last_merge=0.9972 (last merge round=11)
[S8] round=13 local utility u=0.627570 metrics={'f1_val': 0.5863089899596456, 'auprc': 0.9962331938523418, 'loss_val': 0.5466602735877891, 'psi': 0.7502786715167241}-{'f1_val': 0.39261202980429966, 'auprc': 0.9976610973072186, 'loss_val': 0.643901775361878, 'psi': 0.6346316568054673}
[S9] START round=13 head_norm_before_train=1.273453 cos_to_last_merge=0.8852 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.885
[S9] round=13 local utility u=0.012943 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9981823395358883, 'loss_val': 0.2625235601473705, 'psi': 0.8201529921925583}-{'f1_val': 0.7014667606303384, 'auprc': 0.9981550984673957, 'loss_val': 0.2883281751307628, 'psi': 0.8201420957651613}
[S10] START round=13 head_norm_before_train=1.106498 cos_to_last_merge=0.9942 (last merge round=11)
[S10] round=13 local utility u=0.098860 metrics={'f1_val': 0.698229121893157, 'auprc': 0.9965875956516865, 'loss_val': 0.4326832133546838, 'psi': 0.8175725113965688}-{'f1_val': 0.6932950742131788, 'auprc': 0.9916271043846834, 'loss_val': 0.5859174798967842, 'psi': 0.8126278862817806}
[S11] START round=13 head_norm_before_train=0.906554 cos_to_last_merge=0.9882 (last merge round=10)
[S11] round=13 local utility u=0.002683 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.972528983845676, 'loss_val': 0.46956418657639526, 'psi': 0.8101727835172625}-{'f1_val': 0.7020007759458987, 'auprc': 0.9979612138895055, 'loss_val': 0.5516204587806174, 'psi': 0.8203849511233414}
[S13] START round=13 head_norm_before_train=0.846942 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.010253 metrics={'f1_val': 0.7116171793783117, 'auprc': 0.7373309481392769, 'loss_val': 0.7356389485810653, 'psi': 0.7219026868826978}-{'f1_val': 0.7122119308330156, 'auprc': 0.7466416177734164, 'loss_val': 0.7876451405989681, 'psi': 0.7259838056091759}
[S14] START round=13 head_norm_before_train=1.321078 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.196216 metrics={'f1_val': 0.9983274240503504, 'auprc': 0.9974930153736861, 'loss_val': 0.2034708589702741, 'psi': 0.9979936605796846}-{'f1_val': 0.9411383670136257, 'auprc': 0.9960413015453948, 'loss_val': 0.24841436820490487, 'psi': 0.9630995408263334}
[S15] START round=13 head_norm_before_train=1.187848 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.072914 metrics={'f1_val': 0.7139415660604722, 'auprc': 0.9821485819428772, 'loss_val': 0.4118427881759851, 'psi': 0.8212243724134343}-{'f1_val': 0.695068897609503, 'auprc': 0.997425558202771, 'loss_val': 0.49026607462911526, 'psi': 0.8160115618468102}
[S16] START round=13 head_norm_before_train=1.523057 (no previous merge yet)
[S16] round=13 local utility u=0.307910 metrics={'f1_val': 0.5587962976824006, 'auprc': 0.8006243068527285, 'loss_val': 0.7139246073830996, 'psi': 0.6555275013505317}-{'f1_val': 0.4630400766304193, 'auprc': 0.7792993304269742, 'loss_val': 0.6912317591565487, 'psi': 0.5895437781490412}
[S17] START round=13 head_norm_before_train=1.096747 cos_to_last_merge=0.9972 (last merge round=11)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.33430735930735933, 'auprc': 0.5682134013970137, 'loss_val': 1.0102897863137406, 'psi': 0.4278697761432211}-{'f1_val': 0.35145309405070796, 'auprc': 0.5841810600921933, 'loss_val': 0.9255377976704993, 'psi': 0.4445442804673021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:31615
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:31602
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S13
[S11] cosine check vs S13: cos=0.8218
[S16] RECEIVED delta(kind=head bytes=1795) from S2
[S16] cosine check vs S2: cos=-0.1038
[S16] DROPPED delta from S2 (cos=-0.1038 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=-0.0037
[S9] DROPPED delta from S4 (cos=-0.0037 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S5
[S13] cosine check vs S5: cos=0.9347
[S3] RECEIVED delta(kind=head bytes=1806) from S8
[S3] cosine check vs S8: cos=0.9851
[S14] RECEIVED delta(kind=head bytes=1794) from S15
[S14] cosine check vs S15: cos=0.9763
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=0.8469
[S10] RECEIVED delta(kind=head bytes=1795) from S16
[S10] cosine check vs S16: cos=-0.0360
[S10] DROPPED delta from S16 (cos=-0.0360 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S10
[S15] cosine check vs S10: cos=0.9637
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9983 head_norm=1.369908
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.567872e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9975 head_norm=1.294508 delta_norm=0.156787
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7006 head_norm=1.274192
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.097004e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7006 head_norm=1.256878 delta_norm=0.109700
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7019 head_norm=0.981751
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.826222e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7019 head_norm=0.892196 delta_norm=0.282622
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7121 head_norm=0.978613
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.712410e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7121 head_norm=0.941907 delta_norm=0.271241
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.7116 head_norm=0.887662
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.578053e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.7116 head_norm=0.848941 delta_norm=0.157805
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.7139 head_norm=1.234511
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.656384e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.7141 head_norm=1.185294 delta_norm=0.165638
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=0.941907 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7120863443748789, 'auprc': 0.7783870856170939, 'loss_val': 0.729364379013035, 'psi': 0.7386066408717649}-{'f1_val': 0.7120818973722733, 'auprc': 0.7789445917263431, 'loss_val': 0.6813647668818241, 'psi': 0.7388269751139013}
[S3] START round=14 head_norm_before_train=1.256878 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.6622649203069906, 'auprc': 0.9986084691357247, 'loss_val': 0.4252876213697797, 'psi': 0.7968023398384843}-{'f1_val': 0.7005813959920884, 'auprc': 0.9972941816268779, 'loss_val': 0.36529491802301645, 'psi': 0.8192665102460042}
[S4] START round=14 head_norm_before_train=1.337031 cos_to_last_merge=0.8479 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=14 local utility u=0.450641 metrics={'f1_val': 0.6767261394278266, 'auprc': 0.9551858100606465, 'loss_val': 0.4350718446178213, 'psi': 0.7881100076809545}-{'f1_val': 0.6797634222769384, 'auprc': 0.6743045763110166, 'loss_val': 0.5119332517084738, 'psi': 0.6775798838905697}
[S5] START round=14 head_norm_before_train=0.838607 cos_to_last_merge=0.9838 (last merge round=11)
[S5] round=14 local utility u=0.983649 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.737610662053435, 'loss_val': 0.6521340865313843, 'psi': 0.7155343801278882}-{'f1_val': 0.43729965937461046, 'auprc': 0.6683663767761638, 'loss_val': 0.8305962575849021, 'psi': 0.5297263463352317}
[S6] START round=14 head_norm_before_train=1.254680 cos_to_last_merge=0.9033 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.903
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.7090546479479054, 'auprc': 0.989781945953408, 'loss_val': 0.30193573271754376, 'psi': 0.8213455671501064}-{'f1_val': 0.5317085931366, 'auprc': 0.779936894914051, 'loss_val': 0.6669089561739043, 'psi': 0.6309999138475805}
[S7] START round=14 head_norm_before_train=1.463859 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.5516578925335697, 'auprc': 0.7837065822589107, 'loss_val': 0.7778298762385778, 'psi': 0.6444773684237061}-{'f1_val': 0.598514760174685, 'auprc': 0.7970798835283792, 'loss_val': 0.6469617766287283, 'psi': 0.6779408095161628}
[S8] START round=14 head_norm_before_train=1.248993 cos_to_last_merge=0.9914 (last merge round=11)
[S8] round=14 local utility u=1.000000 metrics={'f1_val': 0.997785552998875, 'auprc': 0.9971377037323881, 'loss_val': 0.3920827444402502, 'psi': 0.9975264132922802}-{'f1_val': 0.5863089899596456, 'auprc': 0.9962331938523418, 'loss_val': 0.5466602735877891, 'psi': 0.7502786715167241}
[S9] START round=14 head_norm_before_train=1.321945 cos_to_last_merge=0.8742 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.874
[S9] round=14 local utility u=0.013460 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9982229627580059, 'loss_val': 0.235724946242151, 'psi': 0.8201692414814055}-{'f1_val': 0.7014667606303384, 'auprc': 0.9981823395358883, 'loss_val': 0.2625235601473705, 'psi': 0.8201529921925583}
[S10] START round=14 head_norm_before_train=1.157885 cos_to_last_merge=0.9793 (last merge round=11)
[S10] round=14 local utility u=0.021193 metrics={'f1_val': 0.6947225090523133, 'auprc': 0.9974413520064767, 'loss_val': 0.3718185517998477, 'psi': 0.8158100462339786}-{'f1_val': 0.698229121893157, 'auprc': 0.9965875956516865, 'loss_val': 0.4326832133546838, 'psi': 0.8175725113965688}
[S11] START round=14 head_norm_before_train=0.892196 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9144623002101671, 'loss_val': 0.41569649723883906, 'psi': 0.7869461100630588}-{'f1_val': 0.7019353166316534, 'auprc': 0.972528983845676, 'loss_val': 0.46956418657639526, 'psi': 0.8101727835172625}
[S13] START round=14 head_norm_before_train=0.848941 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.7112201709221025, 'auprc': 0.7188757843278288, 'loss_val': 0.7000255752208379, 'psi': 0.714282416284393}-{'f1_val': 0.7116171793783117, 'auprc': 0.7373309481392769, 'loss_val': 0.7356389485810653, 'psi': 0.7219026868826978}
[S14] START round=14 head_norm_before_train=1.294508 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.007461 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9974720513862408, 'loss_val': 0.18590074903970388, 'psi': 0.9977267588504867}-{'f1_val': 0.9983274240503504, 'auprc': 0.9974930153736861, 'loss_val': 0.2034708589702741, 'psi': 0.9979936605796846}
[S15] START round=14 head_norm_before_train=1.185294 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.587324 metrics={'f1_val': 0.8971456439095769, 'auprc': 0.9971323749321196, 'loss_val': 0.3813702336196516, 'psi': 0.937140336318594}-{'f1_val': 0.7139415660604722, 'auprc': 0.9821485819428772, 'loss_val': 0.4118427881759851, 'psi': 0.8212243724134343}
[S16] START round=14 head_norm_before_train=1.559537 (no previous merge yet)
[S16] round=14 local utility u=0.897858 metrics={'f1_val': 0.8350716670699508, 'auprc': 0.8164929115065762, 'loss_val': 0.6234673985838506, 'psi': 0.827640164844601}-{'f1_val': 0.5587962976824006, 'auprc': 0.8006243068527285, 'loss_val': 0.7139246073830996, 'psi': 0.6555275013505317}
[S17] START round=14 head_norm_before_train=1.132125 cos_to_last_merge=0.9908 (last merge round=11)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.16524168082150031, 'auprc': 0.5852757081071231, 'loss_val': 1.4734676785955334, 'psi': 0.33325529173574947}-{'f1_val': 0.33430735930735933, 'auprc': 0.5682134013970137, 'loss_val': 1.0102897863137406, 'psi': 0.4278697761432211}
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:31613
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:31614
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:31603
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:31610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:31615
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S16
[S10] cosine check vs S16: cos=-0.0334
[S10] DROPPED delta from S16 (cos=-0.0334 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.9697
[S3] RECEIVED delta(kind=head bytes=1805) from S8
[S3] cosine check vs S8: cos=0.9883
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=-0.0067
[S9] DROPPED delta from S4 (cos=-0.0067 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S10
[S15] cosine check vs S10: cos=0.9767
[S13] RECEIVED delta(kind=head bytes=1800) from S5
[S13] cosine check vs S5: cos=0.9609
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.8971 head_norm=1.228735
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.319911e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.8959 head_norm=1.211767 delta_norm=0.131991
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] CommDone barrier timeout: have=1 need=3 — continuing
[S2] START round=15 head_norm_before_train=0.992621 cos_to_last_merge=0.9978 (last merge round=13)
[S2] round=15 local utility u=0.115901 metrics={'f1_val': 0.6952181941057012, 'auprc': 0.7910711545576907, 'loss_val': 0.4344048870445083, 'psi': 0.7335593782864971}-{'f1_val': 0.7120863443748789, 'auprc': 0.7783870856170939, 'loss_val': 0.729364379013035, 'psi': 0.7386066408717649}
[S3] START round=15 head_norm_before_train=1.298331 cos_to_last_merge=0.9990 (last merge round=13)
[S3] round=15 local utility u=0.104736 metrics={'f1_val': 0.6891653956046963, 'auprc': 0.9968682001840639, 'loss_val': 0.37199680114505057, 'psi': 0.8122465174364433}-{'f1_val': 0.6622649203069906, 'auprc': 0.9986084691357247, 'loss_val': 0.4252876213697797, 'psi': 0.7968023398384843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.6892 head_norm=1.338647
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.200443e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.6837 head_norm=1.306602 delta_norm=0.120044
[S3] aggregate: ROLLBACK (f1_val pre=0.689 post=0.684 tol_abs=0.005 tol_rel=0.0)
[S4] START round=15 head_norm_before_train=1.380034 cos_to_last_merge=0.8357 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.836
[S4] round=15 local utility u=0.851810 metrics={'f1_val': 0.9570827530003847, 'auprc': 0.9557142207498636, 'loss_val': 0.41517590508590874, 'psi': 0.9565353401001763}-{'f1_val': 0.6767261394278266, 'auprc': 0.9551858100606465, 'loss_val': 0.4350718446178213, 'psi': 0.7881100076809545}
[S5] START round=15 head_norm_before_train=0.880244 cos_to_last_merge=0.9695 (last merge round=11)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.4179075419145208, 'auprc': 0.6464800467104007, 'loss_val': 0.9506506746463852, 'psi': 0.5093365438328727}-{'f1_val': 0.7008168588441903, 'auprc': 0.737610662053435, 'loss_val': 0.6521340865313843, 'psi': 0.7155343801278882}
[S6] START round=15 head_norm_before_train=1.275539 cos_to_last_merge=0.8976 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.43359307899528904, 'auprc': 0.7745898011267014, 'loss_val': 0.7683296455716658, 'psi': 0.569991767847854}-{'f1_val': 0.7090546479479054, 'auprc': 0.989781945953408, 'loss_val': 0.30193573271754376, 'psi': 0.8213455671501064}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=15 head_norm_before_train=1.483205 (no previous merge yet)
[S7] round=15 local utility u=0.062105 metrics={'f1_val': 0.5628127618646783, 'auprc': 0.7897035999171989, 'loss_val': 0.7385401527148967, 'psi': 0.6535690970856866}-{'f1_val': 0.5516578925335697, 'auprc': 0.7837065822589107, 'loss_val': 0.7778298762385778, 'psi': 0.6444773684237061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=15 head_norm_before_train=1.285014 cos_to_last_merge=0.9851 (last merge round=11)
[S8] round=15 local utility u=0.031847 metrics={'f1_val': 0.9974993535273301, 'auprc': 0.9984382038565777, 'loss_val': 0.33057281556895757, 'psi': 0.9978748936590291}-{'f1_val': 0.997785552998875, 'auprc': 0.9971377037323881, 'loss_val': 0.3920827444402502, 'psi': 0.9975264132922802}
[S9] START round=15 head_norm_before_train=1.366623 cos_to_last_merge=0.8652 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.865
[S9] round=15 local utility u=0.004534 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982292810596696, 'loss_val': 0.22517503535589806, 'psi': 0.820021660887879}-{'f1_val': 0.7014667606303384, 'auprc': 0.9982229627580059, 'loss_val': 0.235724946242151, 'psi': 0.8201692414814055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=15 head_norm_before_train=1.209055 cos_to_last_merge=0.9640 (last merge round=11)
[S10] round=15 local utility u=0.296636 metrics={'f1_val': 0.7784500555882542, 'auprc': 0.9965493210277616, 'loss_val': 0.2782359647463167, 'psi': 0.8656897617640571}-{'f1_val': 0.6947225090523133, 'auprc': 0.9974413520064767, 'loss_val': 0.3718185517998477, 'psi': 0.8158100462339786}
[S11] START round=15 head_norm_before_train=0.962337 cos_to_last_merge=0.9983 (last merge round=13)
[S11] round=15 local utility u=0.148848 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9960734203597505, 'loss_val': 0.36283433927807524, 'psi': 0.8195905581228923}-{'f1_val': 0.7019353166316534, 'auprc': 0.9144623002101671, 'loss_val': 0.41569649723883906, 'psi': 0.7869461100630588}
[S13] START round=15 head_norm_before_train=0.892634 cos_to_last_merge=0.9956 (last merge round=13)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6348731826545386, 'auprc': 0.7059498709959364, 'loss_val': 0.6721200209153544, 'psi': 0.6633038579910977}-{'f1_val': 0.7112201709221025, 'auprc': 0.7188757843278288, 'loss_val': 0.7000255752208379, 'psi': 0.714282416284393}
[S14] START round=15 head_norm_before_train=1.341719 cos_to_last_merge=0.9991 (last merge round=13)
[S14] round=15 local utility u=0.023441 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9971583149786618, 'loss_val': 0.13807848936965333, 'psi': 0.997601264287455}-{'f1_val': 0.9978965638266506, 'auprc': 0.9974720513862408, 'loss_val': 0.18590074903970388, 'psi': 0.9977267588504867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9979 head_norm=1.391513
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.946542e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9975 head_norm=1.298137 delta_norm=0.194654
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] START round=15 head_norm_before_train=1.211767 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.163424 metrics={'f1_val': 0.9380176223189323, 'auprc': 0.9924470429187551, 'loss_val': 0.28569797534757724, 'psi': 0.9597893905588614}-{'f1_val': 0.8971456439095769, 'auprc': 0.9971323749321196, 'loss_val': 0.3813702336196516, 'psi': 0.937140336318594}
[S16] START round=15 head_norm_before_train=1.593895 (no previous merge yet)
[S16] round=15 local utility u=0.072745 metrics={'f1_val': 0.8471969272974152, 'auprc': 0.8332881335280145, 'loss_val': 0.6011141349534602, 'psi': 0.841633409789655}-{'f1_val': 0.8350716670699508, 'auprc': 0.8164929115065762, 'loss_val': 0.6234673985838506, 'psi': 0.827640164844601}
[S17] START round=15 head_norm_before_train=1.161238 cos_to_last_merge=0.9842 (last merge round=11)
[S17] round=15 local utility u=0.804124 metrics={'f1_val': 0.33305139648718685, 'auprc': 0.6417240893693363, 'loss_val': 1.0414230323872238, 'psi': 0.45652047364004666}-{'f1_val': 0.16524168082150031, 'auprc': 0.5852757081071231, 'loss_val': 1.4734676785955334, 'psi': 0.33325529173574947}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:31602
[S8] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:31615
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6349 head_norm=0.937859
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.544152e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6906 head_norm=0.896304 delta_norm=0.154415
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.129 → S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:31610
[S15] sending update (kind=head size=1793 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S15
[S14] cosine check vs S15: cos=0.9746
[S16] RECEIVED delta(kind=head bytes=1801) from S2
[S16] cosine check vs S2: cos=-0.1149
[S16] DROPPED delta from S2 (cos=-0.1149 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S16
[S10] cosine check vs S16: cos=-0.0304
[S10] DROPPED delta from S16 (cos=-0.0304 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9484
[S3] RECEIVED delta(kind=head bytes=1806) from S8
[S3] cosine check vs S8: cos=0.9935
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.8338
[S11] ⇄ pheromone p=0.191 → S2@127.0.0.1:31602
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.6952 head_norm=1.049872
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.990385e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.6941 head_norm=0.992314 delta_norm=0.299038
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.209 → S16@127.0.0.1:31616
[S16] ⇄ pheromone p=0.322 → S10@127.0.0.1:31611
[S17] ⇄ pheromone p=0.248 → S8@127.0.0.1:31609
[S15] ⇄ pheromone p=0.294 → S14@127.0.0.1:31614
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9975 head_norm=1.314077
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.103432e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9960 head_norm=1.235267 delta_norm=0.210343
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.360 → S3@127.0.0.1:31603
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S10
[S15] cosine check vs S10: cos=0.9863
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] cosine check vs S4: cos=-0.0105
[S9] DROPPED delta from S4 (cos=-0.0105 < 0.0)
[S10] ⇄ pheromone p=0.187 → S15@127.0.0.1:31615
[S4]  timeout peer S6
[S4]  timeout peer S9
[S8]  timeout peer S3
[S2]  timeout peer S16
[S15]  timeout peer S14
[S16]  timeout peer S10
[S11]  timeout peer S2
[S17]  timeout peer S8
[S5]  timeout peer S4
[S5]  timeout peer S7
[S5]  timeout peer S13
[S5]  timeout peer S17
[S10]  timeout peer S5
[S10]  timeout peer S15
[S13]  timeout peer S11
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=16 head_norm_before_train=0.992314 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6903551259768452, 'auprc': 0.7954675964688922, 'loss_val': 0.44128228090863253, 'psi': 0.732400114173664}-{'f1_val': 0.6952181941057012, 'auprc': 0.7910711545576907, 'loss_val': 0.4344048870445083, 'psi': 0.7335593782864971}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=16 head_norm_before_train=1.306602 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.050933 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9954982944152859, 'loss_val': 0.33151064345671893, 'psi': 0.8182474999222653}-{'f1_val': 0.6891653956046963, 'auprc': 0.9968682001840639, 'loss_val': 0.37199680114505057, 'psi': 0.8122465174364433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.7001 head_norm=1.338696
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.739313e-02
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.6996 head_norm=1.322863 delta_norm=0.097393
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=16 head_norm_before_train=1.418201 cos_to_last_merge=0.8253 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=16 local utility u=0.097101 metrics={'f1_val': 0.9719765736080117, 'auprc': 0.9615395297553799, 'loss_val': 0.32781371096189055, 'psi': 0.967801756066959}-{'f1_val': 0.9570827530003847, 'auprc': 0.9557142207498636, 'loss_val': 0.41517590508590874, 'psi': 0.9565353401001763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=16 head_norm_before_train=0.916744 cos_to_last_merge=0.9570 (last merge round=11)
[S5] round=16 local utility u=0.793662 metrics={'f1_val': 0.6208183154056209, 'auprc': 0.6705822441164961, 'loss_val': 0.6530983098544962, 'psi': 0.640723886889971}-{'f1_val': 0.4179075419145208, 'auprc': 0.6464800467104007, 'loss_val': 0.9506506746463852, 'psi': 0.5093365438328727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=16 head_norm_before_train=1.296770 cos_to_last_merge=0.8931 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.893
[S6] round=16 local utility u=1.000000 metrics={'f1_val': 0.8676674949758955, 'auprc': 0.9860816138504367, 'loss_val': 0.2708874972991302, 'psi': 0.9150331425257119}-{'f1_val': 0.43359307899528904, 'auprc': 0.7745898011267014, 'loss_val': 0.7683296455716658, 'psi': 0.569991767847854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=16 head_norm_before_train=1.499357 (no previous merge yet)
[S7] round=16 local utility u=0.339185 metrics={'f1_val': 0.6390359967191096, 'auprc': 0.8038854558055158, 'loss_val': 0.5600545099587806, 'psi': 0.704975780353672}-{'f1_val': 0.5628127618646783, 'auprc': 0.7897035999171989, 'loss_val': 0.7385401527148967, 'psi': 0.6535690970856866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=16 head_norm_before_train=1.235267 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9957129912683976, 'auprc': 0.9980574901685867, 'loss_val': 0.31905581023762053, 'psi': 0.9966507908284733}-{'f1_val': 0.9974993535273301, 'auprc': 0.9984382038565777, 'loss_val': 0.33057281556895757, 'psi': 0.9978748936590291}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=16 head_norm_before_train=1.403779 cos_to_last_merge=0.8585 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.858
[S9] round=16 local utility u=0.040295 metrics={'f1_val': 0.7062487318006859, 'auprc': 0.9982132285493945, 'loss_val': 0.1747288553148584, 'psi': 0.8230345305001694}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982292810596696, 'loss_val': 0.22517503535589806, 'psi': 0.820021660887879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=16 head_norm_before_train=1.251484 cos_to_last_merge=0.9523 (last merge round=11)
[S10] round=16 local utility u=0.339495 metrics={'f1_val': 0.8850431851809116, 'auprc': 0.9962366772607932, 'loss_val': 0.23786757671102732, 'psi': 0.9295205820128642}-{'f1_val': 0.7784500555882542, 'auprc': 0.9965493210277616, 'loss_val': 0.2782359647463167, 'psi': 0.8656897617640571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=16 head_norm_before_train=1.022737 cos_to_last_merge=0.9944 (last merge round=13)
[S11] round=16 local utility u=0.017069 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9961715994131839, 'loss_val': 0.3275402412092229, 'psi': 0.8194847275174284}-{'f1_val': 0.7019353166316534, 'auprc': 0.9960734203597505, 'loss_val': 0.36283433927807524, 'psi': 0.8195905581228923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=16 head_norm_before_train=0.896304 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6220960829999054, 'auprc': 0.6623537804744051, 'loss_val': 0.6938889643095305, 'psi': 0.6381991619897052}-{'f1_val': 0.6348731826545386, 'auprc': 0.7059498709959364, 'loss_val': 0.6721200209153544, 'psi': 0.6633038579910977}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=16 head_norm_before_train=1.298137 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971598002163647, 'loss_val': 0.14126404987030372, 'psi': 0.997454590916458}-{'f1_val': 0.9978965638266506, 'auprc': 0.9971583149786618, 'loss_val': 0.13807848936965333, 'psi': 0.997601264287455}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9977 head_norm=1.341163
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.677680e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9977 head_norm=1.284972 delta_norm=0.167768
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] START round=16 head_norm_before_train=1.248952 cos_to_last_merge=0.9993 (last merge round=14)
[S15] round=16 local utility u=0.114138 metrics={'f1_val': 0.9653332032862327, 'auprc': 0.9974499513566204, 'loss_val': 0.23632340543198582, 'psi': 0.9781799025143878}-{'f1_val': 0.9380176223189323, 'auprc': 0.9924470429187551, 'loss_val': 0.28569797534757724, 'psi': 0.9597893905588614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.9653 head_norm=1.279847
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.168007e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.9105 head_norm=1.260345 delta_norm=0.116801
[S15] aggregate: ROLLBACK (f1_val pre=0.965 post=0.910 tol_abs=0.005 tol_rel=0.0)
[S16] START round=16 head_norm_before_train=1.625616 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.7563175610159634, 'auprc': 0.8473643536946162, 'loss_val': 0.6434932384620533, 'psi': 0.7927362780874245}-{'f1_val': 0.8471969272974152, 'auprc': 0.8332881335280145, 'loss_val': 0.6011141349534602, 'psi': 0.841633409789655}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=16 head_norm_before_train=1.188891 cos_to_last_merge=0.9778 (last merge round=11)
[S17] round=16 local utility u=0.050179 metrics={'f1_val': 0.3357143315865187, 'auprc': 0.65756530644602, 'loss_val': 1.0045672186964507, 'psi': 0.4644547215303192}-{'f1_val': 0.33305139648718685, 'auprc': 0.6417240893693363, 'loss_val': 1.0414230323872238, 'psi': 0.45652047364004666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=17 head_norm_before_train=1.047765 cos_to_last_merge=0.9974 (last merge round=15)
[S2] round=17 local utility u=0.032173 metrics={'f1_val': 0.7046491845796363, 'auprc': 0.7882917121756037, 'loss_val': 0.44117381152781976, 'psi': 0.7381061956180233}-{'f1_val': 0.6903551259768452, 'auprc': 0.7954675964688922, 'loss_val': 0.44128228090863253, 'psi': 0.732400114173664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=17 head_norm_before_train=1.322863 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.017780 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9960683789064219, 'loss_val': 0.30171673713781255, 'psi': 0.8188810738037485}-{'f1_val': 0.7000803035935849, 'auprc': 0.9954982944152859, 'loss_val': 0.33151064345671893, 'psi': 0.8182474999222653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=17 head_norm_before_train=1.456186 cos_to_last_merge=0.8163 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.816
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9645013622719898, 'auprc': 0.9452206170850912, 'loss_val': 0.28792125232251814, 'psi': 0.9567890641972304}-{'f1_val': 0.9719765736080117, 'auprc': 0.9615395297553799, 'loss_val': 0.32781371096189055, 'psi': 0.967801756066959}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=17 head_norm_before_train=0.945356 cos_to_last_merge=0.9479 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=17 local utility u=0.803431 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9899379203913492, 'loss_val': 0.4828081998870694, 'psi': 0.816316661262698}-{'f1_val': 0.6208183154056209, 'auprc': 0.6705822441164961, 'loss_val': 0.6530983098544962, 'psi': 0.640723886889971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=17 head_norm_before_train=1.316516 cos_to_last_merge=0.8890 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.889
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6263296442242849, 'auprc': 0.8100436884376618, 'loss_val': 0.4821428843095569, 'psi': 0.6998152619096357}-{'f1_val': 0.8676674949758955, 'auprc': 0.9860816138504367, 'loss_val': 0.2708874972991302, 'psi': 0.9150331425257119}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=1.514060 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.6019817241089264, 'auprc': 0.7991819609948796, 'loss_val': 0.6422221031648341, 'psi': 0.6808618188633078}-{'f1_val': 0.6390359967191096, 'auprc': 0.8038854558055158, 'loss_val': 0.5600545099587806, 'psi': 0.704975780353672}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=1.265607 cos_to_last_merge=0.9995 (last merge round=15)
[S8] round=17 local utility u=0.052872 metrics={'f1_val': 0.995820808094383, 'auprc': 0.9988741907577369, 'loss_val': 0.21640974100357663, 'psi': 0.9970421611597245}-{'f1_val': 0.9957129912683976, 'auprc': 0.9980574901685867, 'loss_val': 0.31905581023762053, 'psi': 0.9966507908284733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=17 head_norm_before_train=1.434870 cos_to_last_merge=0.8537 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.854
[S9] round=17 local utility u=0.842124 metrics={'f1_val': 0.9830995522427075, 'auprc': 0.9982024665252126, 'loss_val': 0.15155282945201248, 'psi': 0.9891407179557096}-{'f1_val': 0.7062487318006859, 'auprc': 0.9982132285493945, 'loss_val': 0.1747288553148584, 'psi': 0.8230345305001694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=17 head_norm_before_train=1.283427 cos_to_last_merge=0.9441 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.782873163407, 'auprc': 0.9967385455756607, 'loss_val': 0.23819794613127127, 'psi': 0.8684193162744642}-{'f1_val': 0.8850431851809116, 'auprc': 0.9962366772607932, 'loss_val': 0.23786757671102732, 'psi': 0.9295205820128642}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=17 head_norm_before_train=1.076662 cos_to_last_merge=0.9893 (last merge round=13)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.6926382722061865, 'auprc': 0.9967265361022819, 'loss_val': 0.3507146598893001, 'psi': 0.8142735777646246}-{'f1_val': 0.7016934795869249, 'auprc': 0.9961715994131839, 'loss_val': 0.3275402412092229, 'psi': 0.8194847275174284}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=17 head_norm_before_train=0.938140 cos_to_last_merge=0.9972 (last merge round=15)
[S13] round=17 local utility u=0.029205 metrics={'f1_val': 0.6265429914883188, 'auprc': 0.6636122670998956, 'loss_val': 0.6659368573597598, 'psi': 0.6413707017329495}-{'f1_val': 0.6220960829999054, 'auprc': 0.6623537804744051, 'loss_val': 0.6938889643095305, 'psi': 0.6381991619897052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=17 head_norm_before_train=1.284972 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9970503203518015, 'loss_val': 0.14561157859357202, 'psi': 0.99701475435419}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971598002163647, 'loss_val': 0.14126404987030372, 'psi': 0.997454590916458}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=17 head_norm_before_train=1.260345 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6961135253796535, 'auprc': 0.9624702925798645, 'loss_val': 0.3226974238245188, 'psi': 0.8026562322597379}-{'f1_val': 0.9653332032862327, 'auprc': 0.9974499513566204, 'loss_val': 0.23632340543198582, 'psi': 0.9781799025143878}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=1.658412 (no previous merge yet)
[S16] round=17 local utility u=0.251720 metrics={'f1_val': 0.8340565885685531, 'auprc': 0.8665943240586234, 'loss_val': 0.6641766622560301, 'psi': 0.8470716827645812}-{'f1_val': 0.7563175610159634, 'auprc': 0.8473643536946162, 'loss_val': 0.6434932384620533, 'psi': 0.7927362780874245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=17 head_norm_before_train=1.212332 cos_to_last_merge=0.9721 (last merge round=11)
[S17] round=17 local utility u=0.329616 metrics={'f1_val': 0.35294217413206974, 'auprc': 0.8162454643717787, 'loss_val': 0.9247428703496768, 'psi': 0.5382634902279533}-{'f1_val': 0.3357143315865187, 'auprc': 0.65756530644602, 'loss_val': 1.0045672186964507, 'psi': 0.4644547215303192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=18 head_norm_before_train=1.105023 cos_to_last_merge=0.9913 (last merge round=15)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7116169142942013, 'auprc': 0.7722179778070801, 'loss_val': 0.6251876232446466, 'psi': 0.7358573396993529}-{'f1_val': 0.7046491845796363, 'auprc': 0.7882917121756037, 'loss_val': 0.44117381152781976, 'psi': 0.7381061956180233}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=18 head_norm_before_train=1.353743 cos_to_last_merge=0.9990 (last merge round=16)
[S3] round=18 local utility u=0.003821 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9950240076949697, 'loss_val': 0.29139443559761785, 'psi': 0.8185086440932743}-{'f1_val': 0.7007562037352997, 'auprc': 0.9960683789064219, 'loss_val': 0.30171673713781255, 'psi': 0.8188810738037485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=18 head_norm_before_train=1.492718 cos_to_last_merge=0.8084 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.808
[S4] round=18 local utility u=0.047527 metrics={'f1_val': 0.955927272587095, 'auprc': 0.9805435000252529, 'loss_val': 0.2473904265778601, 'psi': 0.9657737635623581}-{'f1_val': 0.9645013622719898, 'auprc': 0.9452206170850912, 'loss_val': 0.28792125232251814, 'psi': 0.9567890641972304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=18 head_norm_before_train=0.968539 cos_to_last_merge=0.9412 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.41918193734294057, 'auprc': 0.6454373706869212, 'loss_val': 0.9961249480808366, 'psi': 0.5096841106805328}-{'f1_val': 0.7005691551769304, 'auprc': 0.9899379203913492, 'loss_val': 0.4828081998870694, 'psi': 0.816316661262698}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=18 head_norm_before_train=1.333566 cos_to_last_merge=0.8855 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.886
[S6] round=18 local utility u=0.454118 metrics={'f1_val': 0.6828575850305214, 'auprc': 0.9584125342061656, 'loss_val': 0.3581804423129833, 'psi': 0.7930795647007791}-{'f1_val': 0.6263296442242849, 'auprc': 0.8100436884376618, 'loss_val': 0.4821428843095569, 'psi': 0.6998152619096357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=18 head_norm_before_train=1.524482 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5459456034548085, 'auprc': 0.7839561275364036, 'loss_val': 0.8229049886830135, 'psi': 0.6411498130874466}-{'f1_val': 0.6019817241089264, 'auprc': 0.7991819609948796, 'loss_val': 0.6422221031648341, 'psi': 0.6808618188633078}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.301301 cos_to_last_merge=0.9979 (last merge round=15)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7849867117454911, 'auprc': 0.9981505215878755, 'loss_val': 0.233411416244607, 'psi': 0.8702522356824448}-{'f1_val': 0.995820808094383, 'auprc': 0.9988741907577369, 'loss_val': 0.21640974100357663, 'psi': 0.9970421611597245}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=18 head_norm_before_train=1.463476 cos_to_last_merge=0.8501 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.850
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981131156585965, 'loss_val': 0.1753666600090698, 'psi': 0.8199751947274497}-{'f1_val': 0.9830995522427075, 'auprc': 0.9982024665252126, 'loss_val': 0.15155282945201248, 'psi': 0.9891407179557096}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=18 head_norm_before_train=1.310636 cos_to_last_merge=0.9381 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=18 local utility u=0.029662 metrics={'f1_val': 0.7868572257147464, 'auprc': 0.9965521784336616, 'loss_val': 0.20221898052166162, 'psi': 0.8707352068023124}-{'f1_val': 0.782873163407, 'auprc': 0.9967385455756607, 'loss_val': 0.23819794613127127, 'psi': 0.8684193162744642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=18 head_norm_before_train=1.121216 cos_to_last_merge=0.9837 (last merge round=13)
[S11] round=18 local utility u=0.053953 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9963074901944756, 'loss_val': 0.2973333337914515, 'psi': 0.8196841860567823}-{'f1_val': 0.6926382722061865, 'auprc': 0.9967265361022819, 'loss_val': 0.3507146598893001, 'psi': 0.8142735777646246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=18 head_norm_before_train=0.983282 cos_to_last_merge=0.9905 (last merge round=15)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.611506162775522, 'auprc': 0.6653335253254248, 'loss_val': 0.6642645027968643, 'psi': 0.6330371077954832}-{'f1_val': 0.6265429914883188, 'auprc': 0.6636122670998956, 'loss_val': 0.6659368573597598, 'psi': 0.6413707017329495}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=18 head_norm_before_train=1.329381 cos_to_last_merge=0.9991 (last merge round=16)
[S14] round=18 local utility u=0.018354 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9971595451286462, 'loss_val': 0.11565989016580715, 'psi': 0.9977012379606663}-{'f1_val': 0.9969910436891155, 'auprc': 0.9970503203518015, 'loss_val': 0.14561157859357202, 'psi': 0.99701475435419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=18 head_norm_before_train=1.291820 cos_to_last_merge=0.9996 (last merge round=16)
[S15] round=18 local utility u=1.000000 metrics={'f1_val': 0.99591712034856, 'auprc': 0.9976780289575576, 'loss_val': 0.15958388304143334, 'psi': 0.996621483792159}-{'f1_val': 0.6961135253796535, 'auprc': 0.9624702925798645, 'loss_val': 0.3226974238245188, 'psi': 0.8026562322597379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=18 head_norm_before_train=1.690986 (no previous merge yet)
[S16] round=18 local utility u=0.087608 metrics={'f1_val': 0.8093671266401907, 'auprc': 0.8949364140924215, 'loss_val': 0.42584937762924113, 'psi': 0.843594841621083}-{'f1_val': 0.8340565885685531, 'auprc': 0.8665943240586234, 'loss_val': 0.6641766622560301, 'psi': 0.8470716827645812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=18 head_norm_before_train=1.227858 cos_to_last_merge=0.9678 (last merge round=11)
[S17] round=18 local utility u=0.204015 metrics={'f1_val': 0.3747168204311317, 'auprc': 0.8626090648381476, 'loss_val': 0.7864513565880638, 'psi': 0.5698737181939381}-{'f1_val': 0.35294217413206974, 'auprc': 0.8162454643717787, 'loss_val': 0.9247428703496768, 'psi': 0.5382634902279533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=19 head_norm_before_train=1.159403 cos_to_last_merge=0.9835 (last merge round=15)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7116997861754384, 'auprc': 0.7707422802356996, 'loss_val': 0.7159172002113674, 'psi': 0.7353167837995429}-{'f1_val': 0.7116169142942013, 'auprc': 0.7722179778070801, 'loss_val': 0.6251876232446466, 'psi': 0.7358573396993529}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.735 u=0.0000 p_local=0.0899 f1=0.712 auprc=0.771 bytes=19774
[S3] START round=19 head_norm_before_train=1.382650 cos_to_last_merge=0.9968 (last merge round=16)
[S3] round=19 local utility u=0.004733 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9954896332095715, 'loss_val': 0.2833247888708561, 'psi': 0.818694894299115}-{'f1_val': 0.7008317350254774, 'auprc': 0.9950240076949697, 'loss_val': 0.29139443559761785, 'psi': 0.8185086440932743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S3] r=20 psi=0.819 u=0.0047 p_local=0.0938 f1=0.701 auprc=0.995 bytes=26992
[S4] START round=19 head_norm_before_train=1.524584 cos_to_last_merge=0.8025 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.803
[S4] round=19 local utility u=0.009914 metrics={'f1_val': 0.955179452681373, 'auprc': 0.9719581223822584, 'loss_val': 0.19731914435100362, 'psi': 0.9618909205617272}-{'f1_val': 0.955927272587095, 'auprc': 0.9805435000252529, 'loss_val': 0.2473904265778601, 'psi': 0.9657737635623581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S4] r=20 psi=0.962 u=0.0099 p_local=0.1884 f1=0.955 auprc=0.972 bytes=26960
[S5] START round=19 head_norm_before_train=0.990150 cos_to_last_merge=0.9355 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=19 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9356144420881438, 'loss_val': 0.4484123173323529, 'psi': 0.7944385672956058}-{'f1_val': 0.41918193734294057, 'auprc': 0.6454373706869212, 'loss_val': 0.9961249480808366, 'psi': 0.5096841106805328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=20 psi=0.794 u=1.0000 p_local=0.4946 f1=0.700 auprc=0.936 bytes=25190
[S6] START round=19 head_norm_before_train=1.351528 cos_to_last_merge=0.8830 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.883
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6810922401639727, 'auprc': 0.961154356778926, 'loss_val': 0.3631633262004896, 'psi': 0.793117086809954}-{'f1_val': 0.6828575850305214, 'auprc': 0.9584125342061656, 'loss_val': 0.3581804423129833, 'psi': 0.7930795647007791}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.793 u=0.0000 p_local=0.3181 f1=0.681 auprc=0.961 bytes=17965
[S7] START round=19 head_norm_before_train=1.533656 (no previous merge yet)
[S7] round=19 local utility u=0.784292 metrics={'f1_val': 0.6827046381957307, 'auprc': 0.8812385673888248, 'loss_val': 0.36672288167773204, 'psi': 0.7621182098729684}-{'f1_val': 0.5459456034548085, 'auprc': 0.7839561275364036, 'loss_val': 0.8229049886830135, 'psi': 0.6411498130874466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=20 psi=0.762 u=0.7843 p_local=0.2698 f1=0.683 auprc=0.881 bytes=25153
[S8] START round=19 head_norm_before_train=1.334425 cos_to_last_merge=0.9957 (last merge round=15)
[S8] round=19 local utility u=0.684634 metrics={'f1_val': 0.9956682381346691, 'auprc': 0.9987899951749025, 'loss_val': 0.13015014654689308, 'psi': 0.9969169409507626}-{'f1_val': 0.7849867117454911, 'auprc': 0.9981505215878755, 'loss_val': 0.233411416244607, 'psi': 0.8702522356824448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S8] r=20 psi=0.997 u=0.6846 p_local=0.2911 f1=0.996 auprc=0.999 bytes=26993
[S9] START round=19 head_norm_before_train=1.488967 cos_to_last_merge=0.8473 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.847
[S9] round=19 local utility u=0.897483 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9977999246278556, 'loss_val': 0.12455431907878894, 'psi': 0.9943591619791783}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981131156585965, 'loss_val': 0.1753666600090698, 'psi': 0.8199751947274497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S9] r=20 psi=0.994 u=0.8975 p_local=0.3459 f1=0.992 auprc=0.998 bytes=30485
[S10] START round=19 head_norm_before_train=1.340511 cos_to_last_merge=0.9328 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=19 local utility u=0.632646 metrics={'f1_val': 0.9926906659310591, 'auprc': 0.9859037886170131, 'loss_val': 0.13998224788472463, 'psi': 0.9899759150054408}-{'f1_val': 0.7868572257147464, 'auprc': 0.9965521784336616, 'loss_val': 0.20221898052166162, 'psi': 0.8707352068023124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=20 psi=0.990 u=0.6326 p_local=0.2425 f1=0.993 auprc=0.986 bytes=23373
[S11] START round=19 head_norm_before_train=1.156618 cos_to_last_merge=0.9790 (last merge round=13)
[S11] round=19 local utility u=0.004785 metrics={'f1_val': 0.7014546883134138, 'auprc': 0.996696935707755, 'loss_val': 0.28604848592099724, 'psi': 0.8195515872711503}-{'f1_val': 0.7019353166316534, 'auprc': 0.9963074901944756, 'loss_val': 0.2973333337914515, 'psi': 0.8196841860567823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S11] r=20 psi=0.820 u=0.0048 p_local=0.0897 f1=0.701 auprc=0.997 bytes=26962
[S13] START round=19 head_norm_before_train=1.024991 cos_to_last_merge=0.9825 (last merge round=15)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6023665871631334, 'auprc': 0.6700702608044321, 'loss_val': 0.6801648346163873, 'psi': 0.629448056619653}-{'f1_val': 0.611506162775522, 'auprc': 0.6653335253254248, 'loss_val': 0.6642645027968643, 'psi': 0.6330371077954832}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.629 u=0.0000 p_local=0.0566 f1=0.602 auprc=0.670 bytes=21534
[S14] START round=19 head_norm_before_train=1.368457 cos_to_last_merge=0.9972 (last merge round=16)
[S14] round=19 local utility u=0.006144 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9969613178334803, 'loss_val': 0.09883562410343082, 'psi': 0.9972278449649827}-{'f1_val': 0.9980623665153463, 'auprc': 0.9971595451286462, 'loss_val': 0.11565989016580715, 'psi': 0.9977012379606663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S14] r=20 psi=0.997 u=0.0061 p_local=0.1033 f1=0.997 auprc=0.997 bytes=30546
[S15] START round=19 head_norm_before_train=1.320563 cos_to_last_merge=0.9986 (last merge round=16)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7015120542927344, 'auprc': 0.9539216323661536, 'loss_val': 0.3126009379171738, 'psi': 0.8024758855221021}-{'f1_val': 0.99591712034856, 'auprc': 0.9976780289575576, 'loss_val': 0.15958388304143334, 'psi': 0.996621483792159}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=20 psi=0.802 u=0.0000 p_local=0.2922 f1=0.702 auprc=0.954 bytes=26945
[S16] START round=19 head_norm_before_train=1.720268 (no previous merge yet)
[S16] round=19 local utility u=0.097768 metrics={'f1_val': 0.8649579815848092, 'auprc': 0.8902621436636675, 'loss_val': 0.5498365691602224, 'psi': 0.8750796464163525}-{'f1_val': 0.8093671266401907, 'auprc': 0.8949364140924215, 'loss_val': 0.42584937762924113, 'psi': 0.843594841621083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] r=20 psi=0.875 u=0.0978 p_local=0.1975 f1=0.865 auprc=0.890 bytes=25157
[S17] START round=19 head_norm_before_train=1.243281 cos_to_last_merge=0.9637 (last merge round=11)
[S17] round=19 local utility u=0.176305 metrics={'f1_val': 0.3907912793961699, 'auprc': 0.9130670022960035, 'loss_val': 0.6816621164674628, 'psi': 0.5997015685561033}-{'f1_val': 0.3747168204311317, 'auprc': 0.8626090648381476, 'loss_val': 0.7864513565880638, 'psi': 0.5698737181939381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S17] r=20 psi=0.600 u=0.1763 p_local=0.2167 f1=0.391 auprc=0.913 bytes=23377
[S2] START round=20 head_norm_before_train=1.207865 cos_to_last_merge=0.9754 (last merge round=15)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7116829707427438, 'auprc': 0.7792652287596722, 'loss_val': 0.7440809379425529, 'psi': 0.7387158739495152}-{'f1_val': 0.7116997861754384, 'auprc': 0.7707422802356996, 'loss_val': 0.7159172002113674, 'psi': 0.7353167837995429}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.407625 cos_to_last_merge=0.9953 (last merge round=16)
[S3] round=20 local utility u=0.004944 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9966963686430431, 'loss_val': 0.2766035799683635, 'psi': 0.819132269698397}-{'f1_val': 0.7008317350254774, 'auprc': 0.9954896332095715, 'loss_val': 0.2833247888708561, 'psi': 0.818694894299115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=20 head_norm_before_train=1.548652 cos_to_last_merge=0.7979 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.798
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9537880885083753, 'auprc': 0.9831505307088421, 'loss_val': 0.23752001934421502, 'psi': 0.9655330653885621}-{'f1_val': 0.955179452681373, 'auprc': 0.9719581223822584, 'loss_val': 0.19731914435100362, 'psi': 0.9618909205617272}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=20 head_norm_before_train=1.007142 cos_to_last_merge=0.9313 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.931
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8646594996909044, 'loss_val': 0.4437457163894379, 'psi': 0.7660561589711772}-{'f1_val': 0.7003213174339138, 'auprc': 0.9356144420881438, 'loss_val': 0.4484123173323529, 'psi': 0.7944385672956058}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=20 head_norm_before_train=1.368773 cos_to_last_merge=0.8805 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.881
[S6] round=20 local utility u=0.148896 metrics={'f1_val': 0.8195627120563378, 'auprc': 0.814613935489189, 'loss_val': 0.45657306598331976, 'psi': 0.8175832014294783}-{'f1_val': 0.6810922401639727, 'auprc': 0.961154356778926, 'loss_val': 0.3631633262004896, 'psi': 0.793117086809954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=20 head_norm_before_train=1.545191 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.48311579746954, 'auprc': 0.781554261610438, 'loss_val': 0.9348930150475715, 'psi': 0.6024911831258992}-{'f1_val': 0.6827046381957307, 'auprc': 0.8812385673888248, 'loss_val': 0.36672288167773204, 'psi': 0.7621182098729684}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.370767 cos_to_last_merge=0.9927 (last merge round=15)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9956522998669254, 'auprc': 0.9957497750407985, 'loss_val': 0.13909871525898773, 'psi': 0.9956912899364747}-{'f1_val': 0.9956682381346691, 'auprc': 0.9987899951749025, 'loss_val': 0.13015014654689308, 'psi': 0.9969169409507626}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=20 head_norm_before_train=1.512202 cos_to_last_merge=0.8450 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.845
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.918140382737729, 'auprc': 0.9984855930562729, 'loss_val': 0.1318750227378625, 'psi': 0.9502784668651466}-{'f1_val': 0.9920653202133933, 'auprc': 0.9977999246278556, 'loss_val': 0.12455431907878894, 'psi': 0.9943591619791783}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=1.376443 cos_to_last_merge=0.9270 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=20 local utility u=0.028393 metrics={'f1_val': 0.994250896972037, 'auprc': 0.9958325274151583, 'loss_val': 0.1223440479078762, 'psi': 0.9948835491492855}-{'f1_val': 0.9926906659310591, 'auprc': 0.9859037886170131, 'loss_val': 0.13998224788472463, 'psi': 0.9899759150054408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=20 head_norm_before_train=1.189602 cos_to_last_merge=0.9761 (last merge round=13)
[S11] round=20 local utility u=0.012628 metrics={'f1_val': 0.7016944140051031, 'auprc': 0.998374870198509, 'loss_val': 0.2672641228917096, 'psi': 0.8203665964824655}-{'f1_val': 0.7014546883134138, 'auprc': 0.996696935707755, 'loss_val': 0.28604848592099724, 'psi': 0.8195515872711503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=20 head_norm_before_train=1.067224 cos_to_last_merge=0.9736 (last merge round=15)
[S13] round=20 local utility u=0.231530 metrics={'f1_val': 0.6427618754262978, 'auprc': 0.7105757640681434, 'loss_val': 0.5809929304890515, 'psi': 0.669887430883036}-{'f1_val': 0.6023665871631334, 'auprc': 0.6700702608044321, 'loss_val': 0.6801648346163873, 'psi': 0.629448056619653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=20 head_norm_before_train=1.410182 cos_to_last_merge=0.9943 (last merge round=16)
[S14] round=20 local utility u=0.008878 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970470961192813, 'loss_val': 0.07888808378314023, 'psi': 0.9970173433423115}-{'f1_val': 0.9974055297193176, 'auprc': 0.9969613178334803, 'loss_val': 0.09883562410343082, 'psi': 0.9972278449649827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=20 head_norm_before_train=1.351528 cos_to_last_merge=0.9970 (last merge round=16)
[S15] round=20 local utility u=1.000000 metrics={'f1_val': 0.9930682766325825, 'auprc': 0.9986594908079429, 'loss_val': 0.11823532898745101, 'psi': 0.9953047623027267}-{'f1_val': 0.7015120542927344, 'auprc': 0.9539216323661536, 'loss_val': 0.3126009379171738, 'psi': 0.8024758855221021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=20 head_norm_before_train=1.745709 (no previous merge yet)
[S16] round=20 local utility u=0.063945 metrics={'f1_val': 0.8318829469359286, 'auprc': 0.9232174025036584, 'loss_val': 0.32236301890514296, 'psi': 0.8684167291630205}-{'f1_val': 0.8649579815848092, 'auprc': 0.8902621436636675, 'loss_val': 0.5498365691602224, 'psi': 0.8750796464163525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=20 head_norm_before_train=1.260357 cos_to_last_merge=0.9594 (last merge round=11)
[S17] round=20 local utility u=0.009698 metrics={'f1_val': 0.3977311129732509, 'auprc': 0.9023994847961968, 'loss_val': 0.6719030519965496, 'psi': 0.5995984617024293}-{'f1_val': 0.3907912793961699, 'auprc': 0.9130670022960035, 'loss_val': 0.6816621164674628, 'psi': 0.5997015685561033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=21 head_norm_before_train=1.250875 cos_to_last_merge=0.9697 (last merge round=15)
[S2] round=21 local utility u=0.013948 metrics={'f1_val': 0.7116643829501719, 'auprc': 0.7789232882426798, 'loss_val': 0.7150472778127797, 'psi': 0.738567945067175}-{'f1_val': 0.7116829707427438, 'auprc': 0.7792652287596722, 'loss_val': 0.7440809379425529, 'psi': 0.7387158739495152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=21 head_norm_before_train=1.430775 cos_to_last_merge=0.9939 (last merge round=16)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9941693340101897, 'loss_val': 0.28151492912710224, 'psi': 0.8178662850159931}-{'f1_val': 0.7007562037352997, 'auprc': 0.9966963686430431, 'loss_val': 0.2766035799683635, 'psi': 0.819132269698397}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=1.572793 cos_to_last_merge=0.7933 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9513700981876112, 'auprc': 0.970950997840901, 'loss_val': 0.217876491788937, 'psi': 0.9592024580489271}-{'f1_val': 0.9537880885083753, 'auprc': 0.9831505307088421, 'loss_val': 0.23752001934421502, 'psi': 0.9655330653885621}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=21 head_norm_before_train=1.025001 cos_to_last_merge=0.9270 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6158843556875759, 'auprc': 0.8419934626747784, 'loss_val': 0.551895792282959, 'psi': 0.7063279984824569}-{'f1_val': 0.700320598491359, 'auprc': 0.8646594996909044, 'loss_val': 0.4437457163894379, 'psi': 0.7660561589711772}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.386487 cos_to_last_merge=0.8770 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.877
[S6] round=21 local utility u=0.093149 metrics={'f1_val': 0.8119541908717861, 'auprc': 0.8736937501111344, 'loss_val': 0.4018636377451432, 'psi': 0.8366500145675254}-{'f1_val': 0.8195627120563378, 'auprc': 0.814613935489189, 'loss_val': 0.45657306598331976, 'psi': 0.8175832014294783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=21 head_norm_before_train=1.556357 (no previous merge yet)
[S7] round=21 local utility u=0.364026 metrics={'f1_val': 0.5672727257718575, 'auprc': 0.7895683881227464, 'loss_val': 0.7358249396111546, 'psi': 0.6561909907122131}-{'f1_val': 0.48311579746954, 'auprc': 0.781554261610438, 'loss_val': 0.9348930150475715, 'psi': 0.6024911831258992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=21 head_norm_before_train=1.402907 cos_to_last_merge=0.9896 (last merge round=15)
[S8] round=21 local utility u=0.024721 metrics={'f1_val': 0.9947175364378282, 'auprc': 0.9995945004378668, 'loss_val': 0.09558179517568938, 'psi': 0.9966683220378436}-{'f1_val': 0.9956522998669254, 'auprc': 0.9957497750407985, 'loss_val': 0.13909871525898773, 'psi': 0.9956912899364747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=21 head_norm_before_train=1.533339 cos_to_last_merge=0.8427 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.843
[S9] round=21 local utility u=0.240751 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.998472628266367, 'loss_val': 0.0938835941696278, 'psi': 0.9946282434345828}-{'f1_val': 0.918140382737729, 'auprc': 0.9984855930562729, 'loss_val': 0.1318750227378625, 'psi': 0.9502784668651466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=21 head_norm_before_train=1.404129 cos_to_last_merge=0.9226 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=21 local utility u=0.011858 metrics={'f1_val': 0.9951941773951698, 'auprc': 0.9939748266712801, 'loss_val': 0.09871459466591159, 'psi': 0.994706437105614}-{'f1_val': 0.994250896972037, 'auprc': 0.9958325274151583, 'loss_val': 0.1223440479078762, 'psi': 0.9948835491492855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=21 head_norm_before_train=1.221190 cos_to_last_merge=0.9722 (last merge round=13)
[S11] round=21 local utility u=0.013046 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9979620878226314, 'loss_val': 0.24098747633275833, 'psi': 0.8203069062826012}-{'f1_val': 0.7016944140051031, 'auprc': 0.998374870198509, 'loss_val': 0.2672641228917096, 'psi': 0.8203665964824655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=21 head_norm_before_train=1.105539 cos_to_last_merge=0.9660 (last merge round=15)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6013435427341931, 'auprc': 0.686143254559539, 'loss_val': 0.6786195369189897, 'psi': 0.6352634274643314}-{'f1_val': 0.6427618754262978, 'auprc': 0.7105757640681434, 'loss_val': 0.5809929304890515, 'psi': 0.669887430883036}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.452205 cos_to_last_merge=0.9910 (last merge round=16)
[S14] round=21 local utility u=0.007354 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9977893049705943, 'loss_val': 0.07034456802035538, 'psi': 0.9977080276778113}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970470961192813, 'loss_val': 0.07888808378314023, 'psi': 0.9970173433423115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=21 head_norm_before_train=1.382992 cos_to_last_merge=0.9951 (last merge round=16)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.9846157814740444, 'auprc': 0.9973489401688483, 'loss_val': 0.13021612580691116, 'psi': 0.989709044951966}-{'f1_val': 0.9930682766325825, 'auprc': 0.9986594908079429, 'loss_val': 0.11823532898745101, 'psi': 0.9953047623027267}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.769536 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8265745486664435, 'auprc': 0.9346885588677506, 'loss_val': 0.8236129872220154, 'psi': 0.8698201527469663}-{'f1_val': 0.8318829469359286, 'auprc': 0.9232174025036584, 'loss_val': 0.32236301890514296, 'psi': 0.8684167291630205}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.277717 cos_to_last_merge=0.9555 (last merge round=11)
[S17] round=21 local utility u=0.038057 metrics={'f1_val': 0.40198972401968214, 'auprc': 0.9186830825302952, 'loss_val': 0.6701924417378271, 'psi': 0.6086670674239274}-{'f1_val': 0.3977311129732509, 'auprc': 0.9023994847961968, 'loss_val': 0.6719030519965496, 'psi': 0.5995984617024293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=22 head_norm_before_train=1.286175 cos_to_last_merge=0.9665 (last merge round=15)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6891016325142674, 'auprc': 0.6670722376194237, 'loss_val': 0.3456367072917525, 'psi': 0.6802898745563299}-{'f1_val': 0.7116643829501719, 'auprc': 0.7789232882426798, 'loss_val': 0.7150472778127797, 'psi': 0.738567945067175}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=1.450097 cos_to_last_merge=0.9928 (last merge round=16)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.9929365015196507, 'loss_val': 0.29876976527743265, 'psi': 0.8128245278972968}-{'f1_val': 0.700330919019862, 'auprc': 0.9941693340101897, 'loss_val': 0.28151492912710224, 'psi': 0.8178662850159931}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.595607 cos_to_last_merge=0.7896 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.790
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9514184683426953, 'auprc': 0.9675051079034477, 'loss_val': 0.24536335131230705, 'psi': 0.9578531241669962}-{'f1_val': 0.9513700981876112, 'auprc': 0.970950997840901, 'loss_val': 0.217876491788937, 'psi': 0.9592024580489271}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=1.047218 cos_to_last_merge=0.9220 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.922
[S5] round=22 local utility u=0.168971 metrics={'f1_val': 0.6526029454078159, 'auprc': 0.8533580636048458, 'loss_val': 0.4683584707718087, 'psi': 0.7329049926866279}-{'f1_val': 0.6158843556875759, 'auprc': 0.8419934626747784, 'loss_val': 0.551895792282959, 'psi': 0.7063279984824569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=22 head_norm_before_train=1.405665 cos_to_last_merge=0.8736 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.874
[S6] round=22 local utility u=0.321580 metrics={'f1_val': 0.8776820633881093, 'auprc': 0.9384152407997832, 'loss_val': 0.34723533470807433, 'psi': 0.9019753343527788}-{'f1_val': 0.8119541908717861, 'auprc': 0.8736937501111344, 'loss_val': 0.4018636377451432, 'psi': 0.8366500145675254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=22 head_norm_before_train=1.568079 (no previous merge yet)
[S7] round=22 local utility u=0.033973 metrics={'f1_val': 0.571525595413862, 'auprc': 0.7923427851562428, 'loss_val': 0.7017185948449889, 'psi': 0.6598524713108144}-{'f1_val': 0.5672727257718575, 'auprc': 0.7895683881227464, 'loss_val': 0.7358249396111546, 'psi': 0.6561909907122131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=22 head_norm_before_train=1.432159 cos_to_last_merge=0.9866 (last merge round=15)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.9982223334163853, 'loss_val': 0.18114751460541872, 'psi': 0.8280042007307075}-{'f1_val': 0.9947175364378282, 'auprc': 0.9995945004378668, 'loss_val': 0.09558179517568938, 'psi': 0.9966683220378436}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=22 head_norm_before_train=1.557511 cos_to_last_merge=0.8402 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.840
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9409715746458425, 'auprc': 0.9984926491361791, 'loss_val': 0.12032403660398779, 'psi': 0.9639800044419771}-{'f1_val': 0.9920653202133933, 'auprc': 0.998472628266367, 'loss_val': 0.0938835941696278, 'psi': 0.9946282434345828}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.433751 cos_to_last_merge=0.9183 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=22 local utility u=0.007580 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9959697861016448, 'loss_val': 0.08423155980000066, 'psi': 0.9949737218318386}-{'f1_val': 0.9951941773951698, 'auprc': 0.9939748266712801, 'loss_val': 0.09871459466591159, 'psi': 0.994706437105614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=22 head_norm_before_train=1.253749 cos_to_last_merge=0.9698 (last merge round=13)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.6985164414942584, 'auprc': 0.9983467306884108, 'loss_val': 0.22942218016805135, 'psi': 0.8184485571719193}-{'f1_val': 0.7018701185892477, 'auprc': 0.9979620878226314, 'loss_val': 0.24098747633275833, 'psi': 0.8203069062826012}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=22 head_norm_before_train=1.136499 cos_to_last_merge=0.9597 (last merge round=15)
[S13] round=22 local utility u=0.042463 metrics={'f1_val': 0.6172286265155246, 'auprc': 0.6622295999894595, 'loss_val': 0.6172626350031885, 'psi': 0.6352290159050986}-{'f1_val': 0.6013435427341931, 'auprc': 0.686143254559539, 'loss_val': 0.6786195369189897, 'psi': 0.6352634274643314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=22 head_norm_before_train=1.490055 cos_to_last_merge=0.9875 (last merge round=16)
[S14] round=22 local utility u=0.004852 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9989931249028188, 'loss_val': 0.06279459196134698, 'psi': 0.9980438465218244}-{'f1_val': 0.9976538428159559, 'auprc': 0.9977893049705943, 'loss_val': 0.07034456802035538, 'psi': 0.9977080276778113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=22 head_norm_before_train=1.413399 cos_to_last_merge=0.9928 (last merge round=16)
[S15] round=22 local utility u=0.035579 metrics={'f1_val': 0.9916701264206703, 'auprc': 0.9995469072661669, 'loss_val': 0.10797712345437431, 'psi': 0.994820838758869}-{'f1_val': 0.9846157814740444, 'auprc': 0.9973489401688483, 'loss_val': 0.13021612580691116, 'psi': 0.989709044951966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=22 head_norm_before_train=1.792776 (no previous merge yet)
[S16] round=22 local utility u=0.496956 metrics={'f1_val': 0.8907570483148424, 'auprc': 0.9445734475226538, 'loss_val': 0.24444973595393346, 'psi': 0.9122836079979669}-{'f1_val': 0.8265745486664435, 'auprc': 0.9346885588677506, 'loss_val': 0.8236129872220154, 'psi': 0.8698201527469663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=22 head_norm_before_train=1.292423 cos_to_last_merge=0.9523 (last merge round=11)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.3955209988283975, 'auprc': 0.9153301259887784, 'loss_val': 0.7020464069116413, 'psi': 0.6034446496925499}-{'f1_val': 0.40198972401968214, 'auprc': 0.9186830825302952, 'loss_val': 0.6701924417378271, 'psi': 0.6086670674239274}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.312609 cos_to_last_merge=0.9623 (last merge round=15)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6818393127818275, 'auprc': 0.6548876645832862, 'loss_val': 0.3865938974634384, 'psi': 0.671058653502411}-{'f1_val': 0.6891016325142674, 'auprc': 0.6670722376194237, 'loss_val': 0.3456367072917525, 'psi': 0.6802898745563299}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.469274 cos_to_last_merge=0.9913 (last merge round=16)
[S3] round=23 local utility u=0.040159 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9952820064299222, 'loss_val': 0.2709751069150855, 'psi': 0.8183113539838861}-{'f1_val': 0.6927498788157274, 'auprc': 0.9929365015196507, 'loss_val': 0.29876976527743265, 'psi': 0.8128245278972968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=23 head_norm_before_train=1.617489 cos_to_last_merge=0.7863 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.786
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9470945441937505, 'auprc': 0.9586193455772188, 'loss_val': 0.2547233163909904, 'psi': 0.9517044647471378}-{'f1_val': 0.9514184683426953, 'auprc': 0.9675051079034477, 'loss_val': 0.24536335131230705, 'psi': 0.9578531241669962}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=23 head_norm_before_train=1.072368 cos_to_last_merge=0.9165 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.916
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.5833001003091877, 'auprc': 0.8391440179384048, 'loss_val': 0.5768162007469898, 'psi': 0.6856376673608745}-{'f1_val': 0.6526029454078159, 'auprc': 0.8533580636048458, 'loss_val': 0.4683584707718087, 'psi': 0.7329049926866279}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=1.424280 cos_to_last_merge=0.8705 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.870
[S6] round=23 local utility u=0.347401 metrics={'f1_val': 0.9604340416690281, 'auprc': 0.9632024630432382, 'loss_val': 0.2233075708393149, 'psi': 0.9615414102187121}-{'f1_val': 0.8776820633881093, 'auprc': 0.9384152407997832, 'loss_val': 0.34723533470807433, 'psi': 0.9019753343527788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=23 head_norm_before_train=1.579606 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5198562039086896, 'auprc': 0.7841617056256628, 'loss_val': 0.895062379264285, 'psi': 0.6255784045954789}-{'f1_val': 0.571525595413862, 'auprc': 0.7923427851562428, 'loss_val': 0.7017185948449889, 'psi': 0.6598524713108144}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=1.456160 cos_to_last_merge=0.9840 (last merge round=15)
[S8] round=23 local utility u=0.888297 metrics={'f1_val': 0.9927475182363883, 'auprc': 0.9995756933874782, 'loss_val': 0.07794558928063336, 'psi': 0.9954787882968242}-{'f1_val': 0.7145254456069222, 'auprc': 0.9982223334163853, 'loss_val': 0.18114751460541872, 'psi': 0.8280042007307075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=23 head_norm_before_train=1.583073 cos_to_last_merge=0.8374 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.837
[S9] round=23 local utility u=0.185746 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9939489266238648, 'loss_val': 0.06933518253870125, 'psi': 0.9955758777378808}-{'f1_val': 0.9409715746458425, 'auprc': 0.9984926491361791, 'loss_val': 0.12032403660398779, 'psi': 0.9639800044419771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=23 head_norm_before_train=1.467546 cos_to_last_merge=0.9134 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=23 local utility u=0.005244 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9939669508251148, 'loss_val': 0.0716854848821239, 'psi': 0.9945676922490916}-{'f1_val': 0.9943096789853013, 'auprc': 0.9959697861016448, 'loss_val': 0.08423155980000066, 'psi': 0.9949737218318386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=23 head_norm_before_train=1.286571 cos_to_last_merge=0.9677 (last merge round=13)
[S11] round=23 local utility u=0.029990 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9978840435403044, 'loss_val': 0.18817666105291944, 'psi': 0.8202756885696705}-{'f1_val': 0.6985164414942584, 'auprc': 0.9983467306884108, 'loss_val': 0.22942218016805135, 'psi': 0.8184485571719193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=23 head_norm_before_train=1.159611 cos_to_last_merge=0.9543 (last merge round=15)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5893555348100905, 'auprc': 0.6824241255423503, 'loss_val': 0.7145866698318465, 'psi': 0.6265829711029944}-{'f1_val': 0.6172286265155246, 'auprc': 0.6622295999894595, 'loss_val': 0.6172626350031885, 'psi': 0.6352290159050986}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.523952 cos_to_last_merge=0.9845 (last merge round=16)
[S14] round=23 local utility u=0.007100 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9989102453820746, 'loss_val': 0.05081129062309261, 'psi': 0.9982571537654853}-{'f1_val': 0.9974109942678281, 'auprc': 0.9989931249028188, 'loss_val': 0.06279459196134698, 'psi': 0.9980438465218244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=23 head_norm_before_train=1.444459 cos_to_last_merge=0.9904 (last merge round=16)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.8181180915229515, 'auprc': 0.9909392270056413, 'loss_val': 0.19628300334756085, 'psi': 0.8872465457160275}-{'f1_val': 0.9916701264206703, 'auprc': 0.9995469072661669, 'loss_val': 0.10797712345437431, 'psi': 0.994820838758869}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.814274 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8929683634811192, 'auprc': 0.9580294828773671, 'loss_val': 0.47751768000430234, 'psi': 0.9189928112396184}-{'f1_val': 0.8907570483148424, 'auprc': 0.9445734475226538, 'loss_val': 0.24444973595393346, 'psi': 0.9122836079979669}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=1.305961 cos_to_last_merge=0.9499 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.950
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.4043995161021392, 'auprc': 0.8759600772124978, 'loss_val': 0.7665157284699571, 'psi': 0.5930237405462826}-{'f1_val': 0.3955209988283975, 'auprc': 0.9153301259887784, 'loss_val': 0.7020464069116413, 'psi': 0.6034446496925499}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=24 head_norm_before_train=1.336859 cos_to_last_merge=0.9593 (last merge round=15)
[S2] round=24 local utility u=0.095135 metrics={'f1_val': 0.7116997861754384, 'auprc': 0.7770738473117733, 'loss_val': 0.7420461022259442, 'psi': 0.7378494106299723}-{'f1_val': 0.6818393127818275, 'auprc': 0.6548876645832862, 'loss_val': 0.3865938974634384, 'psi': 0.671058653502411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=24 head_norm_before_train=1.490010 cos_to_last_merge=0.9903 (last merge round=16)
[S3] round=24 local utility u=0.003253 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9954848735517744, 'loss_val': 0.2665801130769196, 'psi': 0.8185427870159627}-{'f1_val': 0.700330919019862, 'auprc': 0.9952820064299222, 'loss_val': 0.2709751069150855, 'psi': 0.8183113539838861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=24 head_norm_before_train=1.637330 cos_to_last_merge=0.7838 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.784
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9415445564036081, 'auprc': 0.9416538447557653, 'loss_val': 0.25609080452365857, 'psi': 0.941588271744471}-{'f1_val': 0.9470945441937505, 'auprc': 0.9586193455772188, 'loss_val': 0.2547233163909904, 'psi': 0.9517044647471378}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.104045 cos_to_last_merge=0.9099 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.910
[S5] round=24 local utility u=0.706576 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898230238747965, 'loss_val': 0.3178294524700887, 'psi': 0.8161220000102669}-{'f1_val': 0.5833001003091877, 'auprc': 0.8391440179384048, 'loss_val': 0.5768162007469898, 'psi': 0.6856376673608745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=24 head_norm_before_train=1.440503 cos_to_last_merge=0.8681 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.868
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8229118258851126, 'auprc': 0.9577903709056877, 'loss_val': 0.34400549858346097, 'psi': 0.8768632438933427}-{'f1_val': 0.9604340416690281, 'auprc': 0.9632024630432382, 'loss_val': 0.2233075708393149, 'psi': 0.9615414102187121}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.592871 (no previous merge yet)
[S7] round=24 local utility u=0.780331 metrics={'f1_val': 0.6711564568284022, 'auprc': 0.8387421163196066, 'loss_val': 0.4059438031304174, 'psi': 0.738190720624884}-{'f1_val': 0.5198562039086896, 'auprc': 0.7841617056256628, 'loss_val': 0.895062379264285, 'psi': 0.6255784045954789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=24 head_norm_before_train=1.477493 cos_to_last_merge=0.9816 (last merge round=15)
[S8] round=24 local utility u=0.001287 metrics={'f1_val': 0.9945442167881289, 'auprc': 0.9985429255789595, 'loss_val': 0.0830526490158921, 'psi': 0.9961437003044612}-{'f1_val': 0.9927475182363883, 'auprc': 0.9995756933874782, 'loss_val': 0.07794558928063336, 'psi': 0.9954787882968242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=24 head_norm_before_train=1.607303 cos_to_last_merge=0.8347 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.835
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.7009662546266813, 'auprc': 0.9795962125586535, 'loss_val': 0.28441718745590344, 'psi': 0.8124182377994702}-{'f1_val': 0.9966605118138915, 'auprc': 0.9939489266238648, 'loss_val': 0.06933518253870125, 'psi': 0.9955758777378808}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.501177 cos_to_last_merge=0.9085 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.909
[S10] round=24 local utility u=0.004507 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9943916544851058, 'loss_val': 0.06394586868346791, 'psi': 0.994737573713088}-{'f1_val': 0.9949681865317428, 'auprc': 0.9939669508251148, 'loss_val': 0.0716854848821239, 'psi': 0.9945676922490916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=24 head_norm_before_train=1.317955 cos_to_last_merge=0.9648 (last merge round=13)
[S11] round=24 local utility u=0.892956 metrics={'f1_val': 0.9973550136825626, 'auprc': 0.9983484700168738, 'loss_val': 0.1765678080794261, 'psi': 0.9977523962162871}-{'f1_val': 0.7018701185892477, 'auprc': 0.9978840435403044, 'loss_val': 0.18817666105291944, 'psi': 0.8202756885696705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=24 head_norm_before_train=1.182234 cos_to_last_merge=0.9494 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5937608581425315, 'auprc': 0.6463484428438203, 'loss_val': 0.7034683289743741, 'psi': 0.614795892023047}-{'f1_val': 0.5893555348100905, 'auprc': 0.6824241255423503, 'loss_val': 0.7145866698318465, 'psi': 0.6265829711029944}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.556162 cos_to_last_merge=0.9815 (last merge round=16)
[S14] round=24 local utility u=0.003140 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9991411703403679, 'loss_val': 0.04421695283509922, 'psi': 0.9982487738257207}-{'f1_val': 0.9978217593544257, 'auprc': 0.9989102453820746, 'loss_val': 0.05081129062309261, 'psi': 0.9982571537654853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=24 head_norm_before_train=1.469936 cos_to_last_merge=0.9883 (last merge round=16)
[S15] round=24 local utility u=0.593344 metrics={'f1_val': 0.99271255640402, 'auprc': 0.999562883926558, 'loss_val': 0.08303351067410032, 'psi': 0.9954526874130352}-{'f1_val': 0.8181180915229515, 'auprc': 0.9909392270056413, 'loss_val': 0.19628300334756085, 'psi': 0.8872465457160275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=24 head_norm_before_train=1.829552 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8456447081618442, 'auprc': 0.8725594151916278, 'loss_val': 0.813237007395233, 'psi': 0.8564105909737576}-{'f1_val': 0.8929683634811192, 'auprc': 0.9580294828773671, 'loss_val': 0.47751768000430234, 'psi': 0.9189928112396184}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.323312 cos_to_last_merge=0.9473 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.37953815913916883, 'auprc': 0.8680018866345144, 'loss_val': 0.8411661263069452, 'psi': 0.5749236501373071}-{'f1_val': 0.4043995161021392, 'auprc': 0.8759600772124978, 'loss_val': 0.7665157284699571, 'psi': 0.5930237405462826}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.358169 cos_to_last_merge=0.9572 (last merge round=15)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6649216853845307, 'auprc': 0.7772656996276883, 'loss_val': 0.9674481919492969, 'psi': 0.7098592910817938}-{'f1_val': 0.7116997861754384, 'auprc': 0.7770738473117733, 'loss_val': 0.7420461022259442, 'psi': 0.7378494106299723}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=1.510991 cos_to_last_merge=0.9892 (last merge round=16)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.6126778803592564, 'auprc': 0.9933969381150072, 'loss_val': 0.44526351271385745, 'psi': 0.7649655034615568}-{'f1_val': 0.7005813959920884, 'auprc': 0.9954848735517744, 'loss_val': 0.2665801130769196, 'psi': 0.8185427870159627}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.653879 cos_to_last_merge=0.7821 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.782
[S4] round=25 local utility u=0.074658 metrics={'f1_val': 0.9492786620258242, 'auprc': 0.9749182249422838, 'loss_val': 0.2529720156360463, 'psi': 0.9595344871924081}-{'f1_val': 0.9415445564036081, 'auprc': 0.9416538447557653, 'loss_val': 0.25609080452365857, 'psi': 0.941588271744471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=25 head_norm_before_train=1.132303 cos_to_last_merge=0.9032 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.903
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.5746091736899597, 'auprc': 0.8549108314145416, 'loss_val': 0.564893797894357, 'psi': 0.6867298367797925}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898230238747965, 'loss_val': 0.3178294524700887, 'psi': 0.8161220000102669}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.458374 cos_to_last_merge=0.8652 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.8223135976702485, 'auprc': 0.9564062084135377, 'loss_val': 0.3999838887661919, 'psi': 0.8759506419675642}-{'f1_val': 0.8229118258851126, 'auprc': 0.9577903709056877, 'loss_val': 0.34400549858346097, 'psi': 0.8768632438933427}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.602147 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.536255378069594, 'auprc': 0.7865651522959578, 'loss_val': 0.8232320680971452, 'psi': 0.6363792877601395}-{'f1_val': 0.6711564568284022, 'auprc': 0.8387421163196066, 'loss_val': 0.4059438031304174, 'psi': 0.738190720624884}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=1.498465 cos_to_last_merge=0.9797 (last merge round=15)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9913835465578158, 'auprc': 0.9966492521297867, 'loss_val': 0.07580585482774675, 'psi': 0.9934898287866042}-{'f1_val': 0.9945442167881289, 'auprc': 0.9985429255789595, 'loss_val': 0.0830526490158921, 'psi': 0.9961437003044612}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=1.632908 cos_to_last_merge=0.8320 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.832
[S9] round=25 local utility u=1.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9984689084925262, 'loss_val': 0.05427534209918124, 'psi': 0.996637062918982}-{'f1_val': 0.7009662546266813, 'auprc': 0.9795962125586535, 'loss_val': 0.28441718745590344, 'psi': 0.8124182377994702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=25 head_norm_before_train=1.532569 cos_to_last_merge=0.9044 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=25 local utility u=0.001228 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.992482127208705, 'loss_val': 0.057079312099197775, 'psi': 0.9941055542951068}-{'f1_val': 0.9949681865317428, 'auprc': 0.9943916544851058, 'loss_val': 0.06394586868346791, 'psi': 0.994737573713088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=25 head_norm_before_train=1.348180 cos_to_last_merge=0.9612 (last merge round=13)
[S11] round=25 local utility u=0.023058 metrics={'f1_val': 0.9962831863807413, 'auprc': 0.9981312873856703, 'loss_val': 0.12336961044281618, 'psi': 0.9970224267827128}-{'f1_val': 0.9973550136825626, 'auprc': 0.9983484700168738, 'loss_val': 0.1765678080794261, 'psi': 0.9977523962162871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=25 head_norm_before_train=1.205583 cos_to_last_merge=0.9454 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=25 local utility u=0.031973 metrics={'f1_val': 0.6054557243577195, 'auprc': 0.6374066524899665, 'loss_val': 0.6828668216562856, 'psi': 0.6182360956106183}-{'f1_val': 0.5937608581425315, 'auprc': 0.6463484428438203, 'loss_val': 0.7034683289743741, 'psi': 0.614795892023047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=25 head_norm_before_train=1.585090 cos_to_last_merge=0.9789 (last merge round=16)
[S14] round=25 local utility u=0.000820 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.999124153563108, 'loss_val': 0.04106964969158993, 'psi': 0.99809625798594}-{'f1_val': 0.9976538428159559, 'auprc': 0.9991411703403679, 'loss_val': 0.04421695283509922, 'psi': 0.9982487738257207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=25 head_norm_before_train=1.494424 cos_to_last_merge=0.9860 (last merge round=16)
[S15] round=25 local utility u=0.018257 metrics={'f1_val': 0.995706722102432, 'auprc': 0.9980414947015854, 'loss_val': 0.059920366317044456, 'psi': 0.9966406311420934}-{'f1_val': 0.99271255640402, 'auprc': 0.999562883926558, 'loss_val': 0.08303351067410032, 'psi': 0.9954526874130352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=25 head_norm_before_train=1.844212 (no previous merge yet)
[S16] round=25 local utility u=0.384086 metrics={'f1_val': 0.8846854993682998, 'auprc': 0.9522441037548239, 'loss_val': 0.5183634135232605, 'psi': 0.9117089411229095}-{'f1_val': 0.8456447081618442, 'auprc': 0.8725594151916278, 'loss_val': 0.813237007395233, 'psi': 0.8564105909737576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=25 head_norm_before_train=1.339625 cos_to_last_merge=0.9451 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.39116024346323924, 'auprc': 0.8477824230174432, 'loss_val': 0.9555301016366315, 'psi': 0.5738091152849208}-{'f1_val': 0.37953815913916883, 'auprc': 0.8680018866345144, 'loss_val': 0.8411661263069452, 'psi': 0.5749236501373071}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=1.374932 cos_to_last_merge=0.9544 (last merge round=15)
[S2] round=26 local utility u=0.202335 metrics={'f1_val': 0.7116997861754384, 'auprc': 0.7658172577561994, 'loss_val': 0.8091011204985474, 'psi': 0.7333467748077428}-{'f1_val': 0.6649216853845307, 'auprc': 0.7772656996276883, 'loss_val': 0.9674481919492969, 'psi': 0.7098592910817938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=26 head_norm_before_train=1.530643 cos_to_last_merge=0.9879 (last merge round=16)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.5969440392199856, 'auprc': 0.9915858633707157, 'loss_val': 0.4684660219069401, 'psi': 0.7548007688802777}-{'f1_val': 0.6126778803592564, 'auprc': 0.9933969381150072, 'loss_val': 0.44526351271385745, 'psi': 0.7649655034615568}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.666589 cos_to_last_merge=0.7809 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9421036264370961, 'auprc': 0.9499977448855754, 'loss_val': 0.26519359626211964, 'psi': 0.9452612738164878}-{'f1_val': 0.9492786620258242, 'auprc': 0.9749182249422838, 'loss_val': 0.2529720156360463, 'psi': 0.9595344871924081}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=1.157863 cos_to_last_merge=0.8972 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.897
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.43573098225952556, 'auprc': 0.804236404739212, 'loss_val': 0.7704834564188043, 'psi': 0.5831331512514002}-{'f1_val': 0.5746091736899597, 'auprc': 0.8549108314145416, 'loss_val': 0.564893797894357, 'psi': 0.6867298367797925}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.470893 cos_to_last_merge=0.8634 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.863
[S6] round=26 local utility u=0.001907 metrics={'f1_val': 0.8226579713304489, 'auprc': 0.95386475129641, 'loss_val': 0.3906126193198262, 'psi': 0.8751406833168334}-{'f1_val': 0.8223135976702485, 'auprc': 0.9564062084135377, 'loss_val': 0.3999838887661919, 'psi': 0.8759506419675642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=26 head_norm_before_train=1.607789 (no previous merge yet)
[S7] round=26 local utility u=0.798787 metrics={'f1_val': 0.68382755499896, 'auprc': 0.8631494000472897, 'loss_val': 0.3408441890851757, 'psi': 0.7555562930182919}-{'f1_val': 0.536255378069594, 'auprc': 0.7865651522959578, 'loss_val': 0.8232320680971452, 'psi': 0.6363792877601395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=26 head_norm_before_train=1.519531 cos_to_last_merge=0.9779 (last merge round=15)
[S8] round=26 local utility u=0.014668 metrics={'f1_val': 0.9945442167881289, 'auprc': 0.9985019690774883, 'loss_val': 0.07099133024567528, 'psi': 0.9961273177038727}-{'f1_val': 0.9913835465578158, 'auprc': 0.9966492521297867, 'loss_val': 0.07580585482774675, 'psi': 0.9934898287866042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=26 head_norm_before_train=1.650499 cos_to_last_merge=0.8300 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.830
[S9] round=26 local utility u=0.006337 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980846128484315, 'loss_val': 0.04791631513955671, 'psi': 0.9972301522277075}-{'f1_val': 0.9954158325366191, 'auprc': 0.9984689084925262, 'loss_val': 0.05427534209918124, 'psi': 0.996637062918982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=26 head_norm_before_train=1.562971 cos_to_last_merge=0.9004 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.900
[S10] round=26 local utility u=0.001399 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9924759613469271, 'loss_val': 0.05177002540192202, 'psi': 0.9938538065483742}-{'f1_val': 0.9951878390193748, 'auprc': 0.992482127208705, 'loss_val': 0.057079312099197775, 'psi': 0.9941055542951068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=26 head_norm_before_train=1.375593 cos_to_last_merge=0.9574 (last merge round=13)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9875641088375804, 'auprc': 0.9963135673962269, 'loss_val': 0.21559799988060643, 'psi': 0.991063892261039}-{'f1_val': 0.9962831863807413, 'auprc': 0.9981312873856703, 'loss_val': 0.12336961044281618, 'psi': 0.9970224267827128}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.227839 cos_to_last_merge=0.9415 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=26 local utility u=0.170861 metrics={'f1_val': 0.6343978405981435, 'auprc': 0.6664980043319824, 'loss_val': 0.6020715028806497, 'psi': 0.6472379060916791}-{'f1_val': 0.6054557243577195, 'auprc': 0.6374066524899665, 'loss_val': 0.6828668216562856, 'psi': 0.6182360956106183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=26 head_norm_before_train=1.610621 cos_to_last_merge=0.9766 (last merge round=16)
[S14] round=26 local utility u=0.001297 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9992277388743193, 'loss_val': 0.03876951385059159, 'psi': 0.998136057250763}-{'f1_val': 0.9974109942678281, 'auprc': 0.999124153563108, 'loss_val': 0.04106964969158993, 'psi': 0.99809625798594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=26 head_norm_before_train=1.513951 cos_to_last_merge=0.9843 (last merge round=16)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8977271251173848, 'auprc': 0.9933200005187345, 'loss_val': 0.22027635504640436, 'psi': 0.9359642752779247}-{'f1_val': 0.995706722102432, 'auprc': 0.9980414947015854, 'loss_val': 0.059920366317044456, 'psi': 0.9966406311420934}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.859128 (no previous merge yet)
[S16] round=26 local utility u=0.144629 metrics={'f1_val': 0.9121048627837197, 'auprc': 0.9664478599794067, 'loss_val': 0.43623282994969415, 'psi': 0.9338420616619946}-{'f1_val': 0.8846854993682998, 'auprc': 0.9522441037548239, 'loss_val': 0.5183634135232605, 'psi': 0.9117089411229095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=26 head_norm_before_train=1.357713 cos_to_last_merge=0.9425 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.39177756270849085, 'auprc': 0.8442661104588474, 'loss_val': 0.9916026740237617, 'psi': 0.5727729818086335}-{'f1_val': 0.39116024346323924, 'auprc': 0.8477824230174432, 'loss_val': 0.9555301016366315, 'psi': 0.5738091152849208}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.389799 cos_to_last_merge=0.9520 (last merge round=15)
[S2] round=27 local utility u=0.025222 metrics={'f1_val': 0.7114594500949879, 'auprc': 0.7790684291829441, 'loss_val': 0.7969683674815632, 'psi': 0.7385030417301703}-{'f1_val': 0.7116997861754384, 'auprc': 0.7658172577561994, 'loss_val': 0.8091011204985474, 'psi': 0.7333467748077428}
[S2] not sending this round → trigger blocked (psi=0.739)
[S3] START round=27 head_norm_before_train=1.550253 cos_to_last_merge=0.9866 (last merge round=16)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.5431467121331752, 'auprc': 0.9972553191296971, 'loss_val': 0.5820048596096528, 'psi': 0.724790154931784}-{'f1_val': 0.5969440392199856, 'auprc': 0.9915858633707157, 'loss_val': 0.4684660219069401, 'psi': 0.7548007688802777}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.676352 cos_to_last_merge=0.7800 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.780
[S4] round=27 local utility u=0.060462 metrics={'f1_val': 0.948712193106059, 'auprc': 0.9744666794287098, 'loss_val': 0.2573280389120023, 'psi': 0.9590139876351194}-{'f1_val': 0.9421036264370961, 'auprc': 0.9499977448855754, 'loss_val': 0.26519359626211964, 'psi': 0.9452612738164878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=27 head_norm_before_train=1.178005 cos_to_last_merge=0.8933 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.893
[S5] round=27 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989189214749822, 'loss_val': 0.3127554451276387, 'psi': 0.815868476360277}-{'f1_val': 0.43573098225952556, 'auprc': 0.804236404739212, 'loss_val': 0.7704834564188043, 'psi': 0.5831331512514002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=27 head_norm_before_train=1.484832 cos_to_last_merge=0.8614 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=27 local utility u=0.530532 metrics={'f1_val': 0.9611112672651703, 'auprc': 0.9664751029955359, 'loss_val': 0.1980984664119768, 'psi': 0.9632568015573165}-{'f1_val': 0.8226579713304489, 'auprc': 0.95386475129641, 'loss_val': 0.3906126193198262, 'psi': 0.8751406833168334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=27 head_norm_before_train=1.613866 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5492610232145598, 'auprc': 0.7874584967950817, 'loss_val': 0.8014061229404171, 'psi': 0.6445400126467686}-{'f1_val': 0.68382755499896, 'auprc': 0.8631494000472897, 'loss_val': 0.3408441890851757, 'psi': 0.7555562930182919}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=1.537711 cos_to_last_merge=0.9763 (last merge round=15)
[S8] round=27 local utility u=0.007674 metrics={'f1_val': 0.9945651807947898, 'auprc': 0.998586517337515, 'loss_val': 0.056022115769084994, 'psi': 0.9961737154118799}-{'f1_val': 0.9945442167881289, 'auprc': 0.9985019690774883, 'loss_val': 0.07099133024567528, 'psi': 0.9961273177038727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=27 head_norm_before_train=1.670726 cos_to_last_merge=0.8278 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.828
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9984727338496893, 'loss_val': 0.04714074684924151, 'psi': 0.9956343985337007}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980846128484315, 'loss_val': 0.04791631513955671, 'psi': 0.9972301522277075}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.591950 cos_to_last_merge=0.8967 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.897
[S10] round=27 local utility u=0.002679 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9924913438467342, 'loss_val': 0.04763236675972517, 'psi': 0.9939774494577394}-{'f1_val': 0.9947723700160056, 'auprc': 0.9924759613469271, 'loss_val': 0.05177002540192202, 'psi': 0.9938538065483742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=27 head_norm_before_train=1.400606 cos_to_last_merge=0.9542 (last merge round=13)
[S11] round=27 local utility u=0.086532 metrics={'f1_val': 0.9953465495061331, 'auprc': 0.9980313711348832, 'loss_val': 0.09438139509222514, 'psi': 0.9964204781576331}-{'f1_val': 0.9875641088375804, 'auprc': 0.9963135673962269, 'loss_val': 0.21559799988060643, 'psi': 0.991063892261039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=27 head_norm_before_train=1.245404 cos_to_last_merge=0.9378 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6027200599684295, 'auprc': 0.6766241277919229, 'loss_val': 0.7203212271248003, 'psi': 0.632281687097827}-{'f1_val': 0.6343978405981435, 'auprc': 0.6664980043319824, 'loss_val': 0.6020715028806497, 'psi': 0.6472379060916791}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.631427 cos_to_last_merge=0.9746 (last merge round=16)
[S14] round=27 local utility u=0.001680 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9991418428357232, 'loss_val': 0.03515106458447695, 'psi': 0.9981016988353246}-{'f1_val': 0.9974082695017256, 'auprc': 0.9992277388743193, 'loss_val': 0.03876951385059159, 'psi': 0.998136057250763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=27 head_norm_before_train=1.531894 cos_to_last_merge=0.9827 (last merge round=16)
[S15] round=27 local utility u=0.271500 metrics={'f1_val': 0.9638496723525984, 'auprc': 0.9973928455961032, 'loss_val': 0.08623106543795743, 'psi': 0.9772669416500004}-{'f1_val': 0.8977271251173848, 'auprc': 0.9933200005187345, 'loss_val': 0.22027635504640436, 'psi': 0.9359642752779247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=27 head_norm_before_train=1.874242 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.898261445598173, 'auprc': 0.973162647089348, 'loss_val': 0.492811088142633, 'psi': 0.9282219261946429}-{'f1_val': 0.9121048627837197, 'auprc': 0.9664478599794067, 'loss_val': 0.43623282994969415, 'psi': 0.9338420616619946}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.377371 cos_to_last_merge=0.9394 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.939
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.4036390202056436, 'auprc': 0.8105526738901561, 'loss_val': 1.0019560713083722, 'psi': 0.5664044816794486}-{'f1_val': 0.39177756270849085, 'auprc': 0.8442661104588474, 'loss_val': 0.9916026740237617, 'psi': 0.5727729818086335}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=28 head_norm_before_train=1.405156 cos_to_last_merge=0.9503 (last merge round=15)
[S2] round=28 local utility u=0.010169 metrics={'f1_val': 0.7114409401176323, 'auprc': 0.7773589041376889, 'loss_val': 0.7713912029700636, 'psi': 0.7378081257256549}-{'f1_val': 0.7114594500949879, 'auprc': 0.7790684291829441, 'loss_val': 0.7969683674815632, 'psi': 0.7385030417301703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=28 head_norm_before_train=1.571284 cos_to_last_merge=0.9855 (last merge round=16)
[S3] round=28 local utility u=0.218201 metrics={'f1_val': 0.592088398331498, 'auprc': 0.9971419786170382, 'loss_val': 0.43891206015699447, 'psi': 0.7541098304457141}-{'f1_val': 0.5431467121331752, 'auprc': 0.9972553191296971, 'loss_val': 0.5820048596096528, 'psi': 0.724790154931784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] sending update (kind=head size=1807 to 1 peers)
[S4] START round=28 head_norm_before_train=1.682618 cos_to_last_merge=0.7796 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.780
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9406666818318987, 'auprc': 0.9372053910922413, 'loss_val': 0.2679250380518621, 'psi': 0.9392821655360357}-{'f1_val': 0.948712193106059, 'auprc': 0.9744666794287098, 'loss_val': 0.2573280389120023, 'psi': 0.9590139876351194}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.194586 cos_to_last_merge=0.8905 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.890
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9285084233725935, 'loss_val': 0.33333512517514013, 'psi': 0.7914469008493648}-{'f1_val': 0.7003213174339138, 'auprc': 0.989189214749822, 'loss_val': 0.3127554451276387, 'psi': 0.815868476360277}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.499864 cos_to_last_merge=0.8599 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.860
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.8226183199973368, 'auprc': 0.9526862959227229, 'loss_val': 0.44667294810169966, 'psi': 0.8746455103674913}-{'f1_val': 0.9611112672651703, 'auprc': 0.9664751029955359, 'loss_val': 0.1980984664119768, 'psi': 0.9632568015573165}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.620795 (no previous merge yet)
[S7] round=28 local utility u=0.486012 metrics={'f1_val': 0.6479616419115138, 'auprc': 0.808125094917084, 'loss_val': 0.4835859925396786, 'psi': 0.7120270231137419}-{'f1_val': 0.5492610232145598, 'auprc': 0.7874584967950817, 'loss_val': 0.8014061229404171, 'psi': 0.6445400126467686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=28 head_norm_before_train=1.557356 cos_to_last_merge=0.9740 (last merge round=15)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9938326055531397, 'auprc': 0.9995368274721007, 'loss_val': 0.056074591468656634, 'psi': 0.9961142943207242}-{'f1_val': 0.9945651807947898, 'auprc': 0.998586517337515, 'loss_val': 0.056022115769084994, 'psi': 0.9961737154118799}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.692090 cos_to_last_merge=0.8256 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.826
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.9984741439025157, 'loss_val': 0.04445980777234971, 'psi': 0.9948808447485381}-{'f1_val': 0.9937421749897083, 'auprc': 0.9984727338496893, 'loss_val': 0.04714074684924151, 'psi': 0.9956343985337007}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.618376 cos_to_last_merge=0.8934 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.893
[S10] round=28 local utility u=0.002870 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9933633063778953, 'loss_val': 0.04450758353118265, 'psi': 0.9943262344702037}-{'f1_val': 0.9949681865317428, 'auprc': 0.9924913438467342, 'loss_val': 0.04763236675972517, 'psi': 0.9939774494577394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=28 head_norm_before_train=1.425522 cos_to_last_merge=0.9509 (last merge round=13)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9588982503386194, 'auprc': 0.9980060444865486, 'loss_val': 0.09592041033760118, 'psi': 0.974541367997791}-{'f1_val': 0.9953465495061331, 'auprc': 0.9980313711348832, 'loss_val': 0.09438139509222514, 'psi': 0.9964204781576331}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=1.258217 cos_to_last_merge=0.9353 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=28 local utility u=0.124219 metrics={'f1_val': 0.6264507266938913, 'auprc': 0.6698245457817583, 'loss_val': 0.5938680629654821, 'psi': 0.6438002543290382}-{'f1_val': 0.6027200599684295, 'auprc': 0.6766241277919229, 'loss_val': 0.7203212271248003, 'psi': 0.632281687097827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=28 head_norm_before_train=1.651644 cos_to_last_merge=0.9728 (last merge round=16)
[S14] round=28 local utility u=0.001732 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992264692119761, 'loss_val': 0.03440871721974169, 'psi': 0.9983822984651215}-{'f1_val': 0.9974082695017256, 'auprc': 0.9991418428357232, 'loss_val': 0.03515106458447695, 'psi': 0.9981016988353246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=28 head_norm_before_train=1.550550 cos_to_last_merge=0.9809 (last merge round=16)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.935175844013853, 'auprc': 0.9983490018947461, 'loss_val': 0.09561314267999632, 'psi': 0.9604451071662102}-{'f1_val': 0.9638496723525984, 'auprc': 0.9973928455961032, 'loss_val': 0.08623106543795743, 'psi': 0.9772669416500004}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.889886 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.820454472562067, 'auprc': 0.8481436705936438, 'loss_val': 1.1318726027218258, 'psi': 0.8315301517746978}-{'f1_val': 0.898261445598173, 'auprc': 0.973162647089348, 'loss_val': 0.492811088142633, 'psi': 0.9282219261946429}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.396924 cos_to_last_merge=0.9363 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=28 local utility u=0.315173 metrics={'f1_val': 0.5054234588005873, 'auprc': 0.8133898010497815, 'loss_val': 0.9908285134493343, 'psi': 0.628609995700265}-{'f1_val': 0.4036390202056436, 'auprc': 0.8105526738901561, 'loss_val': 1.0019560713083722, 'psi': 0.5664044816794486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=29 head_norm_before_train=1.420351 cos_to_last_merge=0.9491 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=29 local utility u=0.086104 metrics={'f1_val': 0.7030310923716869, 'auprc': 0.7638183865644483, 'loss_val': 0.5081029873421508, 'psi': 0.7273460100487915}-{'f1_val': 0.7114409401176323, 'auprc': 0.7773589041376889, 'loss_val': 0.7713912029700636, 'psi': 0.7378081257256549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=29 head_norm_before_train=1.591937 cos_to_last_merge=0.9842 (last merge round=16)
[S3] round=29 local utility u=0.925394 metrics={'f1_val': 0.8550130441512245, 'auprc': 0.9995043792443666, 'loss_val': 0.17275838410893568, 'psi': 0.9128095781884813}-{'f1_val': 0.592088398331498, 'auprc': 0.9971419786170382, 'loss_val': 0.43891206015699447, 'psi': 0.7541098304457141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=29 head_norm_before_train=1.687009 cos_to_last_merge=0.7792 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.779
[S4] round=29 local utility u=0.084874 metrics={'f1_val': 0.9506485572127988, 'auprc': 0.9703072076802466, 'loss_val': 0.25737320463744556, 'psi': 0.9585120173997779}-{'f1_val': 0.9406666818318987, 'auprc': 0.9372053910922413, 'loss_val': 0.2679250380518621, 'psi': 0.9392821655360357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=29 head_norm_before_train=1.209496 cos_to_last_merge=0.8875 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.887
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.6750678059155606, 'auprc': 0.9450713499904201, 'loss_val': 0.3374196387948934, 'psi': 0.7830692235455043}-{'f1_val': 0.7000725525005456, 'auprc': 0.9285084233725935, 'loss_val': 0.33333512517514013, 'psi': 0.7914469008493648}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.514416 cos_to_last_merge=0.8575 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.858
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7067174794015445, 'auprc': 0.8006133270943316, 'loss_val': 0.7341465145328097, 'psi': 0.7442758184786593}-{'f1_val': 0.8226183199973368, 'auprc': 0.9526862959227229, 'loss_val': 0.44667294810169966, 'psi': 0.8746455103674913}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.626470 (no previous merge yet)
[S7] round=29 local utility u=0.180845 metrics={'f1_val': 0.6790047778866756, 'auprc': 0.8335583230123093, 'loss_val': 0.38445500756615714, 'psi': 0.7408261959369291}-{'f1_val': 0.6479616419115138, 'auprc': 0.808125094917084, 'loss_val': 0.4835859925396786, 'psi': 0.7120270231137419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=29 head_norm_before_train=1.578092 cos_to_last_merge=0.9716 (last merge round=15)
[S8] round=29 local utility u=0.002538 metrics={'f1_val': 0.9938326055531397, 'auprc': 0.9995462344947922, 'loss_val': 0.05102645703077305, 'psi': 0.9961180571298007}-{'f1_val': 0.9938326055531397, 'auprc': 0.9995368274721007, 'loss_val': 0.056074591468656634, 'psi': 0.9961142943207242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=29 head_norm_before_train=1.714259 cos_to_last_merge=0.8231 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.823
[S9] round=29 local utility u=0.012799 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9984732676282763, 'loss_val': 0.03644166778978988, 'psi': 0.9966388065732821}-{'f1_val': 0.9924853119792197, 'auprc': 0.9984741439025157, 'loss_val': 0.04445980777234971, 'psi': 0.9948808447485381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=29 head_norm_before_train=1.640812 cos_to_last_merge=0.8909 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.891
[S10] round=29 local utility u=0.001594 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9936423192161997, 'loss_val': 0.04215689539496458, 'psi': 0.9944378396055256}-{'f1_val': 0.9949681865317428, 'auprc': 0.9933633063778953, 'loss_val': 0.04450758353118265, 'psi': 0.9943262344702037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=29 head_norm_before_train=1.451031 cos_to_last_merge=0.9466 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=29 local utility u=0.129989 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983851202819963, 'loss_val': 0.06297200988686849, 'psi': 0.9972822508209522}-{'f1_val': 0.9588982503386194, 'auprc': 0.9980060444865486, 'loss_val': 0.09592041033760118, 'psi': 0.974541367997791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=29 head_norm_before_train=1.270986 cos_to_last_merge=0.9330 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.933
[S13] round=29 local utility u=0.045944 metrics={'f1_val': 0.6358941370110377, 'auprc': 0.6809608069836766, 'loss_val': 0.5920502340550975, 'psi': 0.6539208050000933}-{'f1_val': 0.6264507266938913, 'auprc': 0.6698245457817583, 'loss_val': 0.5938680629654821, 'psi': 0.6438002543290382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=29 head_norm_before_train=1.671825 cos_to_last_merge=0.9710 (last merge round=16)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9982446586033832, 'loss_val': 0.03304754785670626, 'psi': 0.9977444600020502}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992264692119761, 'loss_val': 0.03440871721974169, 'psi': 0.9983822984651215}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.571953 cos_to_last_merge=0.9790 (last merge round=16)
[S15] round=29 local utility u=0.213988 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9983717171694122, 'loss_val': 0.03882902762431706, 'psi': 0.9975666443187527}-{'f1_val': 0.935175844013853, 'auprc': 0.9983490018947461, 'loss_val': 0.09561314267999632, 'psi': 0.9604451071662102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=29 head_norm_before_train=1.900146 (no previous merge yet)
[S16] round=29 local utility u=0.604733 metrics={'f1_val': 0.8684054251638669, 'auprc': 0.9895983502999367, 'loss_val': 0.6344768719894445, 'psi': 0.9168825952182947}-{'f1_val': 0.820454472562067, 'auprc': 0.8481436705936438, 'loss_val': 1.1318726027218258, 'psi': 0.8315301517746978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=29 head_norm_before_train=1.416171 cos_to_last_merge=0.9335 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.4012854369607644, 'auprc': 0.6965141583775769, 'loss_val': 1.199851245599781, 'psi': 0.5193769255274894}-{'f1_val': 0.5054234588005873, 'auprc': 0.8133898010497815, 'loss_val': 0.9908285134493343, 'psi': 0.628609995700265}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.433797 cos_to_last_merge=0.9479 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7114764868468497, 'auprc': 0.7751107160268416, 'loss_val': 0.7550990430621495, 'psi': 0.7369301785188465}-{'f1_val': 0.7030310923716869, 'auprc': 0.7638183865644483, 'loss_val': 0.5081029873421508, 'psi': 0.7273460100487915}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.613227 cos_to_last_merge=0.9828 (last merge round=16)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8116609318280884, 'auprc': 0.999372637260272, 'loss_val': 0.2852331777711347, 'psi': 0.8867456140009619}-{'f1_val': 0.8550130441512245, 'auprc': 0.9995043792443666, 'loss_val': 0.17275838410893568, 'psi': 0.9128095781884813}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.693899 cos_to_last_merge=0.7787 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.779
[S4] round=30 local utility u=0.025837 metrics={'f1_val': 0.9519624212287413, 'auprc': 0.9827796157056907, 'loss_val': 0.25099971942709953, 'psi': 0.9642892990195211}-{'f1_val': 0.9506485572127988, 'auprc': 0.9703072076802466, 'loss_val': 0.25737320463744556, 'psi': 0.9585120173997779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=30 head_norm_before_train=1.224455 cos_to_last_merge=0.8838 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.884
[S5] round=30 local utility u=0.169898 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9895440176641498, 'loss_val': 0.2825633599221684, 'psi': 0.8160103975260082}-{'f1_val': 0.6750678059155606, 'auprc': 0.9450713499904201, 'loss_val': 0.3374196387948934, 'psi': 0.7830692235455043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=30 head_norm_before_train=1.526396 cos_to_last_merge=0.8559 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=30 local utility u=0.872143 metrics={'f1_val': 0.8489206664589121, 'auprc': 0.9524595138304184, 'loss_val': 0.29861724952205726, 'psi': 0.8903362054075146}-{'f1_val': 0.7067174794015445, 'auprc': 0.8006133270943316, 'loss_val': 0.7341465145328097, 'psi': 0.7442758184786593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=30 head_norm_before_train=1.630842 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5283705732733378, 'auprc': 0.7825493198523417, 'loss_val': 0.8320711260798859, 'psi': 0.6300420719049393}-{'f1_val': 0.6790047778866756, 'auprc': 0.8335583230123093, 'loss_val': 0.38445500756615714, 'psi': 0.7408261959369291}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.598355 cos_to_last_merge=0.9695 (last merge round=15)
[S8] round=30 local utility u=0.001887 metrics={'f1_val': 0.9935410521849493, 'auprc': 0.9996491019722606, 'loss_val': 0.04581246802736844, 'psi': 0.9959842720998737}-{'f1_val': 0.9938326055531397, 'auprc': 0.9995462344947922, 'loss_val': 0.05102645703077305, 'psi': 0.9961180571298007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=30 head_norm_before_train=1.733398 cos_to_last_merge=0.8207 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9909734396342953, 'auprc': 0.9983677435457605, 'loss_val': 0.04227360244253776, 'psi': 0.9939311611988814}-{'f1_val': 0.9954158325366191, 'auprc': 0.9984732676282763, 'loss_val': 0.03644166778978988, 'psi': 0.9966388065732821}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.661913 cos_to_last_merge=0.8885 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.888
[S10] round=30 local utility u=0.000922 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9935808189182564, 'loss_val': 0.04012830520053945, 'psi': 0.9944132394863483}-{'f1_val': 0.9949681865317428, 'auprc': 0.9936423192161997, 'loss_val': 0.04215689539496458, 'psi': 0.9944378396055256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=30 head_norm_before_train=1.476859 cos_to_last_merge=0.9418 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998418962392678, 'loss_val': 0.0723543474053069, 'psi': 0.9970477899050568}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983851202819963, 'loss_val': 0.06297200988686849, 'psi': 0.9972822508209522}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.281976 cos_to_last_merge=0.9315 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.931
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5730502727406752, 'auprc': 0.659974834253615, 'loss_val': 0.839717211926457, 'psi': 0.6078200973458512}-{'f1_val': 0.6358941370110377, 'auprc': 0.6809608069836766, 'loss_val': 0.5920502340550975, 'psi': 0.6539208050000933}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.687211 cos_to_last_merge=0.9698 (last merge round=16)
[S14] round=30 local utility u=0.002770 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9992264011025941, 'loss_val': 0.030437008319595005, 'psi': 0.998135522142073}-{'f1_val': 0.9974109942678281, 'auprc': 0.9982446586033832, 'loss_val': 0.03304754785670626, 'psi': 0.9977444600020502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=30 head_norm_before_train=1.590382 cos_to_last_merge=0.9772 (last merge round=16)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9002763491037017, 'auprc': 0.9963557951627983, 'loss_val': 0.2051917086396357, 'psi': 0.9387081275273403}-{'f1_val': 0.9970299290849798, 'auprc': 0.9983717171694122, 'loss_val': 0.03882902762431706, 'psi': 0.9975666443187527}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.908791 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.7651994560130916, 'auprc': 0.9193609983201787, 'loss_val': 0.889343061991084, 'psi': 0.8268640729359265}-{'f1_val': 0.8684054251638669, 'auprc': 0.9895983502999367, 'loss_val': 0.6344768719894445, 'psi': 0.9168825952182947}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.432512 cos_to_last_merge=0.9310 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.931
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.38996113617155087, 'auprc': 0.6884672069135455, 'loss_val': 1.2422076006955893, 'psi': 0.5093635644683487}-{'f1_val': 0.4012854369607644, 'auprc': 0.6965141583775769, 'loss_val': 1.199851245599781, 'psi': 0.5193769255274894}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.447187 cos_to_last_merge=0.9469 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=31 local utility u=0.085219 metrics={'f1_val': 0.7106307756773731, 'auprc': 0.7908748931521847, 'loss_val': 0.6268789960716439, 'psi': 0.7427284226672977}-{'f1_val': 0.7114764868468497, 'auprc': 0.7751107160268416, 'loss_val': 0.7550990430621495, 'psi': 0.7369301785188465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=31 head_norm_before_train=1.632609 cos_to_last_merge=0.9814 (last merge round=16)
[S3] round=31 local utility u=0.396227 metrics={'f1_val': 0.9297709049263386, 'auprc': 0.9990475881636375, 'loss_val': 0.2004644665923587, 'psi': 0.9574815782212582}-{'f1_val': 0.8116609318280884, 'auprc': 0.999372637260272, 'loss_val': 0.2852331777711347, 'psi': 0.8867456140009619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=31 head_norm_before_train=1.704275 cos_to_last_merge=0.7775 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.778
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9416139809327542, 'auprc': 0.9435139574706914, 'loss_val': 0.2680434497523082, 'psi': 0.9423739715479291}-{'f1_val': 0.9519624212287413, 'auprc': 0.9827796157056907, 'loss_val': 0.25099971942709953, 'psi': 0.9642892990195211}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.245553 cos_to_last_merge=0.8799 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.880
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.5262107257458587, 'auprc': 0.847875764976048, 'loss_val': 0.6659784875892165, 'psi': 0.6548767414379344}-{'f1_val': 0.7003213174339138, 'auprc': 0.9895440176641498, 'loss_val': 0.2825633599221684, 'psi': 0.8160103975260082}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.537563 cos_to_last_merge=0.8545 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8234559373944835, 'auprc': 0.9524176380870575, 'loss_val': 0.378648010551816, 'psi': 0.8750406176715131}-{'f1_val': 0.8489206664589121, 'auprc': 0.9524595138304184, 'loss_val': 0.29861724952205726, 'psi': 0.8903362054075146}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.634708 (no previous merge yet)
[S7] round=31 local utility u=0.539885 metrics={'f1_val': 0.6443049197900541, 'auprc': 0.8024584423827523, 'loss_val': 0.5076353752980626, 'psi': 0.7075663288271334}-{'f1_val': 0.5283705732733378, 'auprc': 0.7825493198523417, 'loss_val': 0.8320711260798859, 'psi': 0.6300420719049393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=31 head_norm_before_train=1.619255 cos_to_last_merge=0.9675 (last merge round=15)
[S8] round=31 local utility u=0.002159 metrics={'f1_val': 0.9938326055531397, 'auprc': 0.9993302660834381, 'loss_val': 0.04228768375583774, 'psi': 0.9960316697652591}-{'f1_val': 0.9935410521849493, 'auprc': 0.9996491019722606, 'loss_val': 0.04581246802736844, 'psi': 0.9959842720998737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=31 head_norm_before_train=1.751626 cos_to_last_merge=0.8184 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.818
[S9] round=31 local utility u=0.004193 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9983669745460861, 'loss_val': 0.03893543506654696, 'psi': 0.9944357862584681}-{'f1_val': 0.9909734396342953, 'auprc': 0.9983677435457605, 'loss_val': 0.04227360244253776, 'psi': 0.9939311611988814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=31 head_norm_before_train=1.681667 cos_to_last_merge=0.8862 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.886
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9925451258151927, 'loss_val': 0.0394765839988402, 'psi': 0.99363188935313}-{'f1_val': 0.9949681865317428, 'auprc': 0.9935808189182564, 'loss_val': 0.04012830520053945, 'psi': 0.9944132394863483}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=1.502683 cos_to_last_merge=0.9375 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9470457205120986, 'auprc': 0.9985316251631718, 'loss_val': 0.193571297621422, 'psi': 0.967640082372528}-{'f1_val': 0.9961336749133093, 'auprc': 0.998418962392678, 'loss_val': 0.0723543474053069, 'psi': 0.9970477899050568}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.288393 cos_to_last_merge=0.9299 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=31 local utility u=0.365935 metrics={'f1_val': 0.6410738700558621, 'auprc': 0.6707611806803232, 'loss_val': 0.5483486256455715, 'psi': 0.6529487943056466}-{'f1_val': 0.5730502727406752, 'auprc': 0.659974834253615, 'loss_val': 0.839717211926457, 'psi': 0.6078200973458512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=31 head_norm_before_train=1.699236 cos_to_last_merge=0.9688 (last merge round=16)
[S14] round=31 local utility u=0.001630 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992292193240321, 'loss_val': 0.029653427965373378, 'psi': 0.9983833985099438}-{'f1_val': 0.9974082695017256, 'auprc': 0.9992264011025941, 'loss_val': 0.030437008319595005, 'psi': 0.998135522142073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=31 head_norm_before_train=1.606498 cos_to_last_merge=0.9758 (last merge round=16)
[S15] round=31 local utility u=0.376009 metrics={'f1_val': 0.9961474906414098, 'auprc': 0.9988357876634633, 'loss_val': 0.03584109763482565, 'psi': 0.9972228094502311}-{'f1_val': 0.9002763491037017, 'auprc': 0.9963557951627983, 'loss_val': 0.2051917086396357, 'psi': 0.9387081275273403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=31 head_norm_before_train=1.918082 (no previous merge yet)
[S16] round=31 local utility u=0.297515 metrics={'f1_val': 0.861654042845017, 'auprc': 0.8863778984373731, 'loss_val': 0.7740904695919725, 'psi': 0.8715435850819595}-{'f1_val': 0.7651994560130916, 'auprc': 0.9193609983201787, 'loss_val': 0.889343061991084, 'psi': 0.8268640729359265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=31 head_norm_before_train=1.448351 cos_to_last_merge=0.9289 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.929
[S17] round=31 local utility u=0.657435 metrics={'f1_val': 0.5490769755651665, 'auprc': 0.736487354509741, 'loss_val': 1.0260926242493538, 'psi': 0.6240411271429963}-{'f1_val': 0.38996113617155087, 'auprc': 0.6884672069135455, 'loss_val': 1.2422076006955893, 'psi': 0.5093635644683487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=32 head_norm_before_train=1.458833 cos_to_last_merge=0.9455 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.945
[S2] round=32 local utility u=0.010842 metrics={'f1_val': 0.7056128844485768, 'auprc': 0.7852723310954448, 'loss_val': 0.5582809560065197, 'psi': 0.737476663107324}-{'f1_val': 0.7106307756773731, 'auprc': 0.7908748931521847, 'loss_val': 0.6268789960716439, 'psi': 0.7427284226672977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S2] sending update (kind=head size=1809 to 1 peers)
[S3] START round=32 head_norm_before_train=1.651450 cos_to_last_merge=0.9799 (last merge round=16)
[S3] round=32 local utility u=0.053837 metrics={'f1_val': 0.9353969058652587, 'auprc': 0.9995905355532633, 'loss_val': 0.12817498454450804, 'psi': 0.9610743577404606}-{'f1_val': 0.9297709049263386, 'auprc': 0.9990475881636375, 'loss_val': 0.2004644665923587, 'psi': 0.9574815782212582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=32 head_norm_before_train=1.711444 cos_to_last_merge=0.7768 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.777
[S4] round=32 local utility u=0.069944 metrics={'f1_val': 0.9487714044464641, 'auprc': 0.9728219114463581, 'loss_val': 0.2590232522793724, 'psi': 0.9583916072464217}-{'f1_val': 0.9416139809327542, 'auprc': 0.9435139574706914, 'loss_val': 0.2680434497523082, 'psi': 0.9423739715479291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=32 head_norm_before_train=1.266309 cos_to_last_merge=0.8751 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.875
[S5] round=32 local utility u=0.170284 metrics={'f1_val': 0.5659961908030573, 'auprc': 0.8556551189029553, 'loss_val': 0.5874610000151707, 'psi': 0.6818597620430165}-{'f1_val': 0.5262107257458587, 'auprc': 0.847875764976048, 'loss_val': 0.6659784875892165, 'psi': 0.6548767414379344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=32 head_norm_before_train=1.549764 cos_to_last_merge=0.8540 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8026780527776349, 'auprc': 0.9384140317244003, 'loss_val': 0.44622672092393045, 'psi': 0.8569724443563411}-{'f1_val': 0.8234559373944835, 'auprc': 0.9524176380870575, 'loss_val': 0.378648010551816, 'psi': 0.8750406176715131}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.640729 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5889731326012602, 'auprc': 0.7928920947006335, 'loss_val': 0.6571295227992916, 'psi': 0.6705407174410094}-{'f1_val': 0.6443049197900541, 'auprc': 0.8024584423827523, 'loss_val': 0.5076353752980626, 'psi': 0.7075663288271334}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.641088 cos_to_last_merge=0.9655 (last merge round=15)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.9994528507725147, 'loss_val': 0.03990751815830503, 'psi': 0.9956479417820729}-{'f1_val': 0.9938326055531397, 'auprc': 0.9993302660834381, 'loss_val': 0.04228768375583774, 'psi': 0.9960316697652591}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.768454 cos_to_last_merge=0.8165 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.817
[S9] round=32 local utility u=0.014498 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9953128892884564, 'loss_val': 0.02985111125686867, 'psi': 0.9961214628037174}-{'f1_val': 0.9918149940667227, 'auprc': 0.9983669745460861, 'loss_val': 0.03893543506654696, 'psi': 0.9944357862584681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=32 head_norm_before_train=1.700165 cos_to_last_merge=0.8840 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.884
[S10] round=32 local utility u=0.004269 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929346975387137, 'loss_val': 0.03709521737442896, 'psi': 0.9942865824271103}-{'f1_val': 0.9943563983784213, 'auprc': 0.9925451258151927, 'loss_val': 0.0394765839988402, 'psi': 0.99363188935313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=32 head_norm_before_train=1.527230 cos_to_last_merge=0.9339 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=32 local utility u=0.223173 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9987036377128365, 'loss_val': 0.04226998420289346, 'psi': 0.9971616600331202}-{'f1_val': 0.9470457205120986, 'auprc': 0.9985316251631718, 'loss_val': 0.193571297621422, 'psi': 0.967640082372528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=32 head_norm_before_train=1.293767 cos_to_last_merge=0.9287 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5763418848124086, 'auprc': 0.694802893708597, 'loss_val': 0.7672782532203479, 'psi': 0.623726288370884}-{'f1_val': 0.6410738700558621, 'auprc': 0.6707611806803232, 'loss_val': 0.5483486256455715, 'psi': 0.6529487943056466}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.712685 cos_to_last_merge=0.9676 (last merge round=16)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992301988136342, 'loss_val': 0.030599847149630106, 'psi': 0.9983851351381091}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992292193240321, 'loss_val': 0.029653427965373378, 'psi': 0.9983833985099438}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.622629 cos_to_last_merge=0.9743 (last merge round=16)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9958570336960555, 'auprc': 0.9989706927674462, 'loss_val': 0.042344911619981045, 'psi': 0.9971024973246118}-{'f1_val': 0.9961474906414098, 'auprc': 0.9988357876634633, 'loss_val': 0.03584109763482565, 'psi': 0.9972228094502311}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.926407 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8472045885616932, 'auprc': 0.8536225326050995, 'loss_val': 0.8918633675656367, 'psi': 0.8497717661790557}-{'f1_val': 0.861654042845017, 'auprc': 0.8863778984373731, 'loss_val': 0.7740904695919725, 'psi': 0.8715435850819595}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.463749 cos_to_last_merge=0.9265 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.927
[S17] round=32 local utility u=0.011682 metrics={'f1_val': 0.6297587442992564, 'auprc': 0.6765510679597098, 'loss_val': 1.3070110732768192, 'psi': 0.6484756737634377}-{'f1_val': 0.5490769755651665, 'auprc': 0.736487354509741, 'loss_val': 1.0260926242493538, 'psi': 0.6240411271429963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=33 head_norm_before_train=1.470903 cos_to_last_merge=0.9441 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7187758360383856, 'auprc': 0.7756405284209081, 'loss_val': 0.7501871831184451, 'psi': 0.7415217129913947}-{'f1_val': 0.7056128844485768, 'auprc': 0.7852723310954448, 'loss_val': 0.5582809560065197, 'psi': 0.737476663107324}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.672837 cos_to_last_merge=0.9781 (last merge round=16)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7424218022825193, 'auprc': 0.953752539964925, 'loss_val': 0.6604012709307533, 'psi': 0.8269540973554816}-{'f1_val': 0.9353969058652587, 'auprc': 0.9995905355532633, 'loss_val': 0.12817498454450804, 'psi': 0.9610743577404606}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.717485 cos_to_last_merge=0.7766 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.777
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9381312106955817, 'auprc': 0.9281885487478183, 'loss_val': 0.2551098726058888, 'psi': 0.9341541459164764}-{'f1_val': 0.9487714044464641, 'auprc': 0.9728219114463581, 'loss_val': 0.2590232522793724, 'psi': 0.9583916072464217}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.284066 cos_to_last_merge=0.8718 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.872
[S5] round=33 local utility u=0.546011 metrics={'f1_val': 0.6688375904765398, 'auprc': 0.9297893523582923, 'loss_val': 0.3348892501048645, 'psi': 0.7732182952292408}-{'f1_val': 0.5659961908030573, 'auprc': 0.8556551189029553, 'loss_val': 0.5874610000151707, 'psi': 0.6818597620430165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=33 head_norm_before_train=1.561977 cos_to_last_merge=0.8528 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.853
[S6] round=33 local utility u=0.285832 metrics={'f1_val': 0.8632238121455427, 'auprc': 0.9546348863013675, 'loss_val': 0.2864990140424527, 'psi': 0.8997882418078726}-{'f1_val': 0.8026780527776349, 'auprc': 0.9384140317244003, 'loss_val': 0.44622672092393045, 'psi': 0.8569724443563411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=33 head_norm_before_train=1.649537 (no previous merge yet)
[S7] round=33 local utility u=0.520557 metrics={'f1_val': 0.6847818547712577, 'auprc': 0.8439157590784735, 'loss_val': 0.3439383169403061, 'psi': 0.748435416494144}-{'f1_val': 0.5889731326012602, 'auprc': 0.7928920947006335, 'loss_val': 0.6571295227992916, 'psi': 0.6705407174410094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=33 head_norm_before_train=1.662901 cos_to_last_merge=0.9636 (last merge round=15)
[S8] round=33 local utility u=0.000796 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.9993648752916879, 'loss_val': 0.03805163397323996, 'psi': 0.9956127515897422}-{'f1_val': 0.9931113357884451, 'auprc': 0.9994528507725147, 'loss_val': 0.03990751815830503, 'psi': 0.9956479417820729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=33 head_norm_before_train=1.783142 cos_to_last_merge=0.8145 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.815
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9983606108862948, 'loss_val': 0.03074500728841289, 'psi': 0.996443548188487}-{'f1_val': 0.9966605118138915, 'auprc': 0.9953128892884564, 'loss_val': 0.02985111125686867, 'psi': 0.9961214628037174}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.717880 cos_to_last_merge=0.8819 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.882
[S10] round=33 local utility u=0.000939 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9933143283123038, 'loss_val': 0.03635593129348131, 'psi': 0.9944384347365464}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929346975387137, 'loss_val': 0.03709521737442896, 'psi': 0.9942865824271103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=33 head_norm_before_train=1.550176 cos_to_last_merge=0.9306 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=33 local utility u=0.001009 metrics={'f1_val': 0.9960674261864149, 'auprc': 0.9986534926082984, 'loss_val': 0.0397050165054321, 'psi': 0.9971018527551683}-{'f1_val': 0.9961336749133093, 'auprc': 0.9987036377128365, 'loss_val': 0.04226998420289346, 'psi': 0.9971616600331202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=33 head_norm_before_train=1.299574 cos_to_last_merge=0.9273 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.927
[S13] round=33 local utility u=0.083991 metrics={'f1_val': 0.5993873363743921, 'auprc': 0.6893597907758547, 'loss_val': 0.7212394851082436, 'psi': 0.6353763181349772}-{'f1_val': 0.5763418848124086, 'auprc': 0.694802893708597, 'loss_val': 0.7672782532203479, 'psi': 0.623726288370884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=33 head_norm_before_train=1.721062 cos_to_last_merge=0.9667 (last merge round=16)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9977120345862676, 'loss_val': 0.030104455577971895, 'psi': 0.997531410395204}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992301988136342, 'loss_val': 0.030599847149630106, 'psi': 0.9983851351381091}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.640132 cos_to_last_merge=0.9727 (last merge round=16)
[S15] round=33 local utility u=0.009046 metrics={'f1_val': 0.9968092060862683, 'auprc': 0.9990451938056701, 'loss_val': 0.030189089665637003, 'psi': 0.997703601174029}-{'f1_val': 0.9958570336960555, 'auprc': 0.9989706927674462, 'loss_val': 0.042344911619981045, 'psi': 0.9971024973246118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=33 head_norm_before_train=1.933489 (no previous merge yet)
[S16] round=33 local utility u=0.388769 metrics={'f1_val': 0.8391111794558092, 'auprc': 0.9831168683114286, 'loss_val': 0.4542488518497674, 'psi': 0.8967134549980569}-{'f1_val': 0.8472045885616932, 'auprc': 0.8536225326050995, 'loss_val': 0.8918633675656367, 'psi': 0.8497717661790557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=33 head_norm_before_train=1.475692 cos_to_last_merge=0.9248 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.925
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.39087684338753914, 'auprc': 0.8373869388512338, 'loss_val': 1.2638713006863904, 'psi': 0.569480881573017}-{'f1_val': 0.6297587442992564, 'auprc': 0.6765510679597098, 'loss_val': 1.3070110732768192, 'psi': 0.6484756737634377}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.486379 cos_to_last_merge=0.9420 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.942
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7156980215576769, 'auprc': 0.757442037190607, 'loss_val': 0.7056964535392984, 'psi': 0.732395627810849}-{'f1_val': 0.7187758360383856, 'auprc': 0.7756405284209081, 'loss_val': 0.7501871831184451, 'psi': 0.7415217129913947}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.695066 cos_to_last_merge=0.9758 (last merge round=16)
[S3] round=34 local utility u=0.995141 metrics={'f1_val': 0.9600800976779673, 'auprc': 0.9996406823179744, 'loss_val': 0.11373248259940975, 'psi': 0.9759043315339702}-{'f1_val': 0.7424218022825193, 'auprc': 0.953752539964925, 'loss_val': 0.6604012709307533, 'psi': 0.8269540973554816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=34 head_norm_before_train=1.722673 cos_to_last_merge=0.7763 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.776
[S4] round=34 local utility u=0.001974 metrics={'f1_val': 0.9338009395781517, 'auprc': 0.9295389166103764, 'loss_val': 0.22923051137162345, 'psi': 0.9320961303910416}-{'f1_val': 0.9381312106955817, 'auprc': 0.9281885487478183, 'loss_val': 0.2551098726058888, 'psi': 0.9341541459164764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=34 head_norm_before_train=1.303885 cos_to_last_merge=0.8691 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.869
[S5] round=34 local utility u=0.216349 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.98616860556305, 'loss_val': 0.2602318499369967, 'psi': 0.8146602326855683}-{'f1_val': 0.6688375904765398, 'auprc': 0.9297893523582923, 'loss_val': 0.3348892501048645, 'psi': 0.7732182952292408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=34 head_norm_before_train=1.574664 cos_to_last_merge=0.8515 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.852
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.5990676740484504, 'auprc': 0.939203533042811, 'loss_val': 0.8339143140925471, 'psi': 0.7351220176461947}-{'f1_val': 0.8632238121455427, 'auprc': 0.9546348863013675, 'loss_val': 0.2864990140424527, 'psi': 0.8997882418078726}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.657577 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5338839253852387, 'auprc': 0.7830382540257621, 'loss_val': 0.8262913669982505, 'psi': 0.633545656841448}-{'f1_val': 0.6847818547712577, 'auprc': 0.8439157590784735, 'loss_val': 0.3439383169403061, 'psi': 0.748435416494144}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.679526 cos_to_last_merge=0.9624 (last merge round=15)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9887962955380838, 'auprc': 0.9958160473633119, 'loss_val': 0.052943828308377384, 'psi': 0.991604196268175}-{'f1_val': 0.9931113357884451, 'auprc': 0.9993648752916879, 'loss_val': 0.03805163397323996, 'psi': 0.9956127515897422}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.796855 cos_to_last_merge=0.8131 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.813
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9983719147043267, 'loss_val': 0.03800160065898279, 'psi': 0.9936798890903267}-{'f1_val': 0.9951655063899485, 'auprc': 0.9983606108862948, 'loss_val': 0.03074500728841289, 'psi': 0.996443548188487}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.732878 cos_to_last_merge=0.8804 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.880
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9923025584168803, 'loss_val': 0.0351378717871353, 'psi': 0.994033726778377}-{'f1_val': 0.9951878390193748, 'auprc': 0.9933143283123038, 'loss_val': 0.03635593129348131, 'psi': 0.9944384347365464}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.571415 cos_to_last_merge=0.9277 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9953465495061331, 'auprc': 0.9986250239057899, 'loss_val': 0.037460546294386284, 'psi': 0.9966579392659958}-{'f1_val': 0.9960674261864149, 'auprc': 0.9986534926082984, 'loss_val': 0.0397050165054321, 'psi': 0.9971018527551683}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.310566 cos_to_last_merge=0.9259 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.926
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6004279802807607, 'auprc': 0.6747342788327138, 'loss_val': 0.7095970017325052, 'psi': 0.6301504997015419}-{'f1_val': 0.5993873363743921, 'auprc': 0.6893597907758547, 'loss_val': 0.7212394851082436, 'psi': 0.6353763181349772}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.732165 cos_to_last_merge=0.9657 (last merge round=16)
[S14] round=34 local utility u=0.003266 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9992306021182412, 'loss_val': 0.02797884917449185, 'psi': 0.9981239978360453}-{'f1_val': 0.9974109942678281, 'auprc': 0.9977120345862676, 'loss_val': 0.030104455577971895, 'psi': 0.997531410395204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=34 head_norm_before_train=1.657965 cos_to_last_merge=0.9711 (last merge round=16)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9440133186211385, 'auprc': 0.9974491751648898, 'loss_val': 0.0739290842632633, 'psi': 0.965387661238639}-{'f1_val': 0.9968092060862683, 'auprc': 0.9990451938056701, 'loss_val': 0.030189089665637003, 'psi': 0.997703601174029}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.941627 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8561073903518508, 'auprc': 0.9016526124800917, 'loss_val': 0.7788786828795267, 'psi': 0.8743254792031471}-{'f1_val': 0.8391111794558092, 'auprc': 0.9831168683114286, 'loss_val': 0.4542488518497674, 'psi': 0.8967134549980569}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.487317 cos_to_last_merge=0.9232 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.923
[S17] round=34 local utility u=0.763392 metrics={'f1_val': 0.6396842456056209, 'auprc': 0.8343129416477384, 'loss_val': 1.2207089569564626, 'psi': 0.7175357240224679}-{'f1_val': 0.39087684338753914, 'auprc': 0.8373869388512338, 'loss_val': 1.2638713006863904, 'psi': 0.569480881573017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=35 head_norm_before_train=1.506492 cos_to_last_merge=0.9396 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=35 local utility u=0.039838 metrics={'f1_val': 0.715871408546712, 'auprc': 0.7776553326541226, 'loss_val': 0.6877006018639231, 'psi': 0.7405849781896763}-{'f1_val': 0.7156980215576769, 'auprc': 0.757442037190607, 'loss_val': 0.7056964535392984, 'psi': 0.732395627810849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=35 head_norm_before_train=1.717438 cos_to_last_merge=0.9734 (last merge round=16)
[S3] round=35 local utility u=0.141224 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9991614930478089, 'loss_val': 0.05392837887239725, 'psi': 0.9981208747910582}-{'f1_val': 0.9600800976779673, 'auprc': 0.9996406823179744, 'loss_val': 0.11373248259940975, 'psi': 0.9759043315339702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=35 head_norm_before_train=1.726337 cos_to_last_merge=0.7758 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.776
[S4] round=35 local utility u=0.056315 metrics={'f1_val': 0.9393660981742414, 'auprc': 0.9532140473929542, 'loss_val': 0.22101717707576019, 'psi': 0.9449052778617265}-{'f1_val': 0.9338009395781517, 'auprc': 0.9295389166103764, 'loss_val': 0.22923051137162345, 'psi': 0.9320961303910416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=35 head_norm_before_train=1.321806 cos_to_last_merge=0.8668 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.867
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8551521079968245, 'loss_val': 0.8941821495641584, 'psi': 0.604120581501953}-{'f1_val': 0.7003213174339138, 'auprc': 0.98616860556305, 'loss_val': 0.2602318499369967, 'psi': 0.8146602326855683}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.581669 cos_to_last_merge=0.8509 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=35 local utility u=1.000000 metrics={'f1_val': 0.9629857584146284, 'auprc': 0.9652060434427248, 'loss_val': 0.17658254618824623, 'psi': 0.963873872425867}-{'f1_val': 0.5990676740484504, 'auprc': 0.939203533042811, 'loss_val': 0.8339143140925471, 'psi': 0.7351220176461947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=35 head_norm_before_train=1.664085 (no previous merge yet)
[S7] round=35 local utility u=0.522513 metrics={'f1_val': 0.6459552558824441, 'auprc': 0.8012574081452165, 'loss_val': 0.5083517795644705, 'psi': 0.7080761167875531}-{'f1_val': 0.5338839253852387, 'auprc': 0.7830382540257621, 'loss_val': 0.8262913669982505, 'psi': 0.633545656841448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=35 head_norm_before_train=1.690885 cos_to_last_merge=0.9620 (last merge round=15)
[S8] round=35 local utility u=0.030319 metrics={'f1_val': 0.994753542178155, 'auprc': 0.9989377282841228, 'loss_val': 0.037414656669196654, 'psi': 0.9964272166205421}-{'f1_val': 0.9887962955380838, 'auprc': 0.9958160473633119, 'loss_val': 0.052943828308377384, 'psi': 0.991604196268175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=35 head_norm_before_train=1.811992 cos_to_last_merge=0.8117 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.812
[S9] round=35 local utility u=0.008763 metrics={'f1_val': 0.9926544572506684, 'auprc': 0.9984797210004303, 'loss_val': 0.03341375601042249, 'psi': 0.9949845627505731}-{'f1_val': 0.9905518720143266, 'auprc': 0.9983719147043267, 'loss_val': 0.03800160065898279, 'psi': 0.9936798890903267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=35 head_norm_before_train=1.746482 cos_to_last_merge=0.8790 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.879
[S10] round=35 local utility u=0.000745 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9924309619972457, 'loss_val': 0.03403336308920056, 'psi': 0.9940850882105231}-{'f1_val': 0.9951878390193748, 'auprc': 0.9923025584168803, 'loss_val': 0.0351378717871353, 'psi': 0.994033726778377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=35 head_norm_before_train=1.593135 cos_to_last_merge=0.9244 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.924
[S11] round=35 local utility u=0.004469 metrics={'f1_val': 0.9960663761953501, 'auprc': 0.9986478948596593, 'loss_val': 0.03290982324523971, 'psi': 0.9970989836610739}-{'f1_val': 0.9953465495061331, 'auprc': 0.9986250239057899, 'loss_val': 0.037460546294386284, 'psi': 0.9966579392659958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=35 head_norm_before_train=1.324370 cos_to_last_merge=0.9244 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6011885256361943, 'auprc': 0.6546116749458867, 'loss_val': 0.6555037844641132, 'psi': 0.6225577853600712}-{'f1_val': 0.6004279802807607, 'auprc': 0.6747342788327138, 'loss_val': 0.7095970017325052, 'psi': 0.6301504997015419}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.743927 cos_to_last_merge=0.9648 (last merge round=16)
[S14] round=35 local utility u=0.001914 metrics={'f1_val': 0.9976015531333403, 'auprc': 0.9992290341165004, 'loss_val': 0.025438457089659444, 'psi': 0.9982525455266044}-{'f1_val': 0.9973862616479148, 'auprc': 0.9992306021182412, 'loss_val': 0.02797884917449185, 'psi': 0.9981239978360453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=35 head_norm_before_train=1.671978 cos_to_last_merge=0.9699 (last merge round=16)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7105156364983652, 'auprc': 0.9940011398702808, 'loss_val': 0.29660822158115646, 'psi': 0.8239098378471315}-{'f1_val': 0.9440133186211385, 'auprc': 0.9974491751648898, 'loss_val': 0.0739290842632633, 'psi': 0.965387661238639}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.951278 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8282206643471879, 'auprc': 0.8315447960419038, 'loss_val': 1.1409911457680832, 'psi': 0.8295503170250742}-{'f1_val': 0.8561073903518508, 'auprc': 0.9016526124800917, 'loss_val': 0.7788786828795267, 'psi': 0.8743254792031471}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.496562 cos_to_last_merge=0.9220 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.922
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6549797939166954, 'auprc': 0.7125845022473305, 'loss_val': 1.2350313771712091, 'psi': 0.6780216772489494}-{'f1_val': 0.6396842456056209, 'auprc': 0.8343129416477384, 'loss_val': 1.2207089569564626, 'psi': 0.7175357240224679}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.522920 cos_to_last_merge=0.9373 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.937
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6958903150001984, 'auprc': 0.7464807521233234, 'loss_val': 0.7363799932995181, 'psi': 0.7161264898494484}-{'f1_val': 0.715871408546712, 'auprc': 0.7776553326541226, 'loss_val': 0.6877006018639231, 'psi': 0.7405849781896763}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.738477 cos_to_last_merge=0.9710 (last merge round=16)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9629642435515284, 'auprc': 0.9997750230747953, 'loss_val': 0.0746815590495048, 'psi': 0.9776885553608352}-{'f1_val': 0.9974271292865575, 'auprc': 0.9991614930478089, 'loss_val': 0.05392837887239725, 'psi': 0.9981208747910582}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.729408 cos_to_last_merge=0.7751 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.775
[S4] round=36 local utility u=0.031667 metrics={'f1_val': 0.9500760732071079, 'auprc': 0.9605389096567047, 'loss_val': 0.2439185638981554, 'psi': 0.9542612077869466}-{'f1_val': 0.9393660981742414, 'auprc': 0.9532140473929542, 'loss_val': 0.22101717707576019, 'psi': 0.9449052778617265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=36 head_norm_before_train=1.340034 cos_to_last_merge=0.8643 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.864
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8544392007987777, 'loss_val': 0.9440246825958358, 'psi': 0.6038354186227344}-{'f1_val': 0.43676623050537206, 'auprc': 0.8551521079968245, 'loss_val': 0.8941821495641584, 'psi': 0.604120581501953}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.587120 cos_to_last_merge=0.8501 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.850
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.811354464207914, 'auprc': 0.9527435992466564, 'loss_val': 0.513819603060298, 'psi': 0.867910118223411}-{'f1_val': 0.9629857584146284, 'auprc': 0.9652060434427248, 'loss_val': 0.17658254618824623, 'psi': 0.963873872425867}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.672004 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.610113928504811, 'auprc': 0.7959670385615751, 'loss_val': 0.6366811757876788, 'psi': 0.6844551725275168}-{'f1_val': 0.6459552558824441, 'auprc': 0.8012574081452165, 'loss_val': 0.5083517795644705, 'psi': 0.7080761167875531}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.701719 cos_to_last_merge=0.9614 (last merge round=15)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9898564228592382, 'auprc': 0.9995321154190407, 'loss_val': 0.04057762051571062, 'psi': 0.9937266998831593}-{'f1_val': 0.994753542178155, 'auprc': 0.9989377282841228, 'loss_val': 0.037414656669196654, 'psi': 0.9964272166205421}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.825539 cos_to_last_merge=0.8105 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.811
[S9] round=36 local utility u=0.009979 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9953153378743164, 'loss_val': 0.025513132636413517, 'psi': 0.9958738041292581}-{'f1_val': 0.9926544572506684, 'auprc': 0.9984797210004303, 'loss_val': 0.03341375601042249, 'psi': 0.9949845627505731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=36 head_norm_before_train=1.760431 cos_to_last_merge=0.8776 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.878
[S10] round=36 local utility u=0.001129 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9928062677838414, 'loss_val': 0.032900478259988604, 'psi': 0.9942352105251614}-{'f1_val': 0.9951878390193748, 'auprc': 0.9924309619972457, 'loss_val': 0.03403336308920056, 'psi': 0.9940850882105231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=36 head_norm_before_train=1.611698 cos_to_last_merge=0.9215 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.922
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9392458874405302, 'auprc': 0.9986473001699896, 'loss_val': 0.2594257523212995, 'psi': 0.963006452532314}-{'f1_val': 0.9960663761953501, 'auprc': 0.9986478948596593, 'loss_val': 0.03290982324523971, 'psi': 0.9970989836610739}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.335734 cos_to_last_merge=0.9229 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5918648677051009, 'auprc': 0.6845120205085448, 'loss_val': 0.744696326533942, 'psi': 0.6289237288264784}-{'f1_val': 0.6011885256361943, 'auprc': 0.6546116749458867, 'loss_val': 0.6555037844641132, 'psi': 0.6225577853600712}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.756856 cos_to_last_merge=0.9637 (last merge round=16)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9971625532153504, 'auprc': 0.9971570481303905, 'loss_val': 0.033765321481408477, 'psi': 0.9971603511813665}-{'f1_val': 0.9976015531333403, 'auprc': 0.9992290341165004, 'loss_val': 0.025438457089659444, 'psi': 0.9982525455266044}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.684427 cos_to_last_merge=0.9688 (last merge round=16)
[S15] round=36 local utility u=1.000000 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9984986305518297, 'loss_val': 0.02621536095151881, 'psi': 0.9976174096717197}-{'f1_val': 0.7105156364983652, 'auprc': 0.9940011398702808, 'loss_val': 0.29660822158115646, 'psi': 0.8239098378471315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=36 head_norm_before_train=1.959827 (no previous merge yet)
[S16] round=36 local utility u=1.000000 metrics={'f1_val': 0.9914830398608031, 'auprc': 0.9871743947114283, 'loss_val': 0.056303804612643824, 'psi': 0.9897595818010532}-{'f1_val': 0.8282206643471879, 'auprc': 0.8315447960419038, 'loss_val': 1.1409911457680832, 'psi': 0.8295503170250742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=36 head_norm_before_train=1.510872 cos_to_last_merge=0.9208 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.921
[S17] round=36 local utility u=0.185807 metrics={'f1_val': 0.6415423269307159, 'auprc': 0.8399801626317284, 'loss_val': 1.164978610406009, 'psi': 0.7209174612111209}-{'f1_val': 0.6549797939166954, 'auprc': 0.7125845022473305, 'loss_val': 1.2350313771712091, 'psi': 0.6780216772489494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=37 head_norm_before_train=1.537847 cos_to_last_merge=0.9353 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=37 local utility u=0.019277 metrics={'f1_val': 0.710514715637411, 'auprc': 0.7407898007533599, 'loss_val': 0.7684999221318815, 'psi': 0.7226247496837905}-{'f1_val': 0.6958903150001984, 'auprc': 0.7464807521233234, 'loss_val': 0.7363799932995181, 'psi': 0.7161264898494484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=37 head_norm_before_train=1.755969 cos_to_last_merge=0.9689 (last merge round=16)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9993169179023932, 'loss_val': 0.08813775396281247, 'psi': 0.9763959215016487}-{'f1_val': 0.9629642435515284, 'auprc': 0.9997750230747953, 'loss_val': 0.0746815590495048, 'psi': 0.9776885553608352}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.732574 cos_to_last_merge=0.7739 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.774
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9420776682385559, 'auprc': 0.9455468541428376, 'loss_val': 0.2771300420370765, 'psi': 0.9434653426002686}-{'f1_val': 0.9500760732071079, 'auprc': 0.9605389096567047, 'loss_val': 0.2439185638981554, 'psi': 0.9542612077869466}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.353803 cos_to_last_merge=0.8624 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.862
[S5] round=37 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9739739305119125, 'loss_val': 0.2760482055028334, 'psi': 0.8097823626651133}-{'f1_val': 0.43676623050537206, 'auprc': 0.8544392007987777, 'loss_val': 0.9440246825958358, 'psi': 0.6038354186227344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=37 head_norm_before_train=1.593415 cos_to_last_merge=0.8485 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.46682180805864903, 'auprc': 0.9032341227395085, 'loss_val': 0.8130420320533146, 'psi': 0.6413867339309929}-{'f1_val': 0.811354464207914, 'auprc': 0.9527435992466564, 'loss_val': 0.513819603060298, 'psi': 0.867910118223411}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.686868 (no previous merge yet)
[S7] round=37 local utility u=0.111540 metrics={'f1_val': 0.6342421987635242, 'auprc': 0.8014000821713055, 'loss_val': 0.5746698891293618, 'psi': 0.7011053521266367}-{'f1_val': 0.610113928504811, 'auprc': 0.7959670385615751, 'loss_val': 0.6366811757876788, 'psi': 0.6844551725275168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=37 head_norm_before_train=1.713642 cos_to_last_merge=0.9606 (last merge round=15)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9865587943374389, 'auprc': 0.9883096082177327, 'loss_val': 0.07211232265812288, 'psi': 0.9872591198895564}-{'f1_val': 0.9898564228592382, 'auprc': 0.9995321154190407, 'loss_val': 0.04057762051571062, 'psi': 0.9937266998831593}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.840090 cos_to_last_merge=0.8093 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.809
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9984728810702853, 'loss_val': 0.02995100907013885, 'psi': 0.9956344574219391}-{'f1_val': 0.9962461149658858, 'auprc': 0.9953153378743164, 'loss_val': 0.025513132636413517, 'psi': 0.9958738041292581}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.773761 cos_to_last_merge=0.8761 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.876
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9924048823809601, 'loss_val': 0.03231194755956507, 'psi': 0.9940746563640088}-{'f1_val': 0.9951878390193748, 'auprc': 0.9928062677838414, 'loss_val': 0.032900478259988604, 'psi': 0.9942352105251614}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.629465 cos_to_last_merge=0.9189 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.919
[S11] round=37 local utility u=0.270119 metrics={'f1_val': 0.9924737983551225, 'auprc': 0.9986871974811846, 'loss_val': 0.03867429403592443, 'psi': 0.9949591580055472}-{'f1_val': 0.9392458874405302, 'auprc': 0.9986473001699896, 'loss_val': 0.2594257523212995, 'psi': 0.963006452532314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=37 head_norm_before_train=1.346326 cos_to_last_merge=0.9215 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.922
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5436658224990123, 'auprc': 0.6982253685220685, 'loss_val': 0.7862348991586958, 'psi': 0.6054896409082348}-{'f1_val': 0.5918648677051009, 'auprc': 0.6845120205085448, 'loss_val': 0.744696326533942, 'psi': 0.6289237288264784}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.768947 cos_to_last_merge=0.9626 (last merge round=16)
[S14] round=37 local utility u=0.010668 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992312333356415, 'loss_val': 0.022607871587605844, 'psi': 0.998385548946912}-{'f1_val': 0.9971625532153504, 'auprc': 0.9971570481303905, 'loss_val': 0.033765321481408477, 'psi': 0.9971603511813665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=37 head_norm_before_train=1.697634 cos_to_last_merge=0.9676 (last merge round=16)
[S15] round=37 local utility u=0.001669 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9992049624846999, 'loss_val': 0.024996158711527446, 'psi': 0.9978999424448678}-{'f1_val': 0.9970299290849798, 'auprc': 0.9984986305518297, 'loss_val': 0.02621536095151881, 'psi': 0.9976174096717197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=37 head_norm_before_train=1.968520 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9403862994043539, 'auprc': 0.9888763874696604, 'loss_val': 0.20790172378864105, 'psi': 0.9597823346304765}-{'f1_val': 0.9914830398608031, 'auprc': 0.9871743947114283, 'loss_val': 0.056303804612643824, 'psi': 0.9897595818010532}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.527487 cos_to_last_merge=0.9194 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.919
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6612293594596608, 'auprc': 0.8162887506572989, 'loss_val': 1.2321448477675783, 'psi': 0.7232531159387161}-{'f1_val': 0.6415423269307159, 'auprc': 0.8399801626317284, 'loss_val': 1.164978610406009, 'psi': 0.7209174612111209}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.550515 cos_to_last_merge=0.9333 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.933
[S2] round=38 local utility u=0.026751 metrics={'f1_val': 0.718135454331766, 'auprc': 0.7578166259438976, 'loss_val': 0.8118019482422645, 'psi': 0.7340079229766187}-{'f1_val': 0.710514715637411, 'auprc': 0.7407898007533599, 'loss_val': 0.7684999221318815, 'psi': 0.7226247496837905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=38 head_norm_before_train=1.774630 cos_to_last_merge=0.9667 (last merge round=16)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9992162863591587, 'loss_val': 0.09148409742712134, 'psi': 0.9763556688843549}-{'f1_val': 0.9611152572344858, 'auprc': 0.9993169179023932, 'loss_val': 0.08813775396281247, 'psi': 0.9763959215016487}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.742559 cos_to_last_merge=0.7719 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.772
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.7959941518469642, 'auprc': 0.90776352421747, 'loss_val': 0.4397352597194447, 'psi': 0.8407019007951665}-{'f1_val': 0.9420776682385559, 'auprc': 0.9455468541428376, 'loss_val': 0.2771300420370765, 'psi': 0.9434653426002686}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.365484 cos_to_last_merge=0.8607 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.861
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.5732962514815007, 'auprc': 0.8557207793541572, 'loss_val': 0.6123037942666197, 'psi': 0.6862660626305632}-{'f1_val': 0.7003213174339138, 'auprc': 0.9739739305119125, 'loss_val': 0.2760482055028334, 'psi': 0.8097823626651133}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.600204 cos_to_last_merge=0.8474 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.847
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.7717712943465967, 'auprc': 0.9486075729098504, 'loss_val': 0.6194864603952767, 'psi': 0.8425058057718982}-{'f1_val': 0.46682180805864903, 'auprc': 0.9032341227395085, 'loss_val': 0.8130420320533146, 'psi': 0.6413867339309929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=38 head_norm_before_train=1.696649 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5469245908844357, 'auprc': 0.7847415286443127, 'loss_val': 0.7997867433430572, 'psi': 0.6420513659883864}-{'f1_val': 0.6342421987635242, 'auprc': 0.8014000821713055, 'loss_val': 0.5746698891293618, 'psi': 0.7011053521266367}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.722634 cos_to_last_merge=0.9603 (last merge round=15)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.967331170859437, 'auprc': 0.9935081728003218, 'loss_val': 0.11629162796420948, 'psi': 0.9778019716357909}-{'f1_val': 0.9865587943374389, 'auprc': 0.9883096082177327, 'loss_val': 0.07211232265812288, 'psi': 0.9872591198895564}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.853713 cos_to_last_merge=0.8082 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.808
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9892714523047061, 'auprc': 0.9984683803240941, 'loss_val': 0.04125367427428662, 'psi': 0.9929502235124614}-{'f1_val': 0.9937421749897083, 'auprc': 0.9984728810702853, 'loss_val': 0.02995100907013885, 'psi': 0.9956344574219391}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.786647 cos_to_last_merge=0.8747 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.875
[S10] round=38 local utility u=0.000529 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9925892490910857, 'loss_val': 0.031806667161074886, 'psi': 0.9941484030480592}-{'f1_val': 0.9951878390193748, 'auprc': 0.9924048823809601, 'loss_val': 0.03231194755956507, 'psi': 0.9940746563640088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=38 head_norm_before_train=1.644108 cos_to_last_merge=0.9169 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.917
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9918218357885851, 'auprc': 0.9987157322526915, 'loss_val': 0.04019763025579963, 'psi': 0.9945793943742276}-{'f1_val': 0.9924737983551225, 'auprc': 0.9986871974811846, 'loss_val': 0.03867429403592443, 'psi': 0.9949591580055472}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.357462 cos_to_last_merge=0.9198 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=38 local utility u=0.201281 metrics={'f1_val': 0.5889943788498058, 'auprc': 0.6924675219749331, 'loss_val': 0.6383716745168384, 'psi': 0.6303836360998567}-{'f1_val': 0.5436658224990123, 'auprc': 0.6982253685220685, 'loss_val': 0.7862348991586958, 'psi': 0.6054896409082348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=38 head_norm_before_train=1.778593 cos_to_last_merge=0.9617 (last merge round=16)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.997389947818302, 'auprc': 0.9988547542101642, 'loss_val': 0.022139700514440492, 'psi': 0.997975870375047}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992312333356415, 'loss_val': 0.022607871587605844, 'psi': 0.998385548946912}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.710175 cos_to_last_merge=0.9665 (last merge round=16)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6990441952578096, 'auprc': 0.9147659742977936, 'loss_val': 0.4563478755382301, 'psi': 0.7853329068738033}-{'f1_val': 0.9970299290849798, 'auprc': 0.9992049624846999, 'loss_val': 0.024996158711527446, 'psi': 0.9978999424448678}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.978155 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8610493596659234, 'auprc': 0.9897575136250814, 'loss_val': 0.7761486212844482, 'psi': 0.9125326212495866}-{'f1_val': 0.9403862994043539, 'auprc': 0.9888763874696604, 'loss_val': 0.20790172378864105, 'psi': 0.9597823346304765}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.544530 cos_to_last_merge=0.9175 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.917
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6244031837707001, 'auprc': 0.6884296169910126, 'loss_val': 1.383435225683996, 'psi': 0.6500137570588251}-{'f1_val': 0.6612293594596608, 'auprc': 0.8162887506572989, 'loss_val': 1.2321448477675783, 'psi': 0.7232531159387161}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.563472 cos_to_last_merge=0.9311 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6444673719554168, 'auprc': 0.7186176023860984, 'loss_val': 1.1793661955853696, 'psi': 0.6741274641276894}-{'f1_val': 0.718135454331766, 'auprc': 0.7578166259438976, 'loss_val': 0.8118019482422645, 'psi': 0.7340079229766187}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.674 u=0.0000 p_local=0.0197 f1=0.644 auprc=0.719 bytes=37813
[S3] START round=39 head_norm_before_train=1.794397 cos_to_last_merge=0.9644 (last merge round=16)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9990927340606864, 'loss_val': 0.09859034815480378, 'psi': 0.9762821448639468}-{'f1_val': 0.9611152572344858, 'auprc': 0.9992162863591587, 'loss_val': 0.09148409742712134, 'psi': 0.9763556688843549}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.976 u=0.0000 p_local=0.1173 f1=0.961 auprc=0.999 bytes=43216
[S4] START round=39 head_norm_before_train=1.745617 cos_to_last_merge=0.7712 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.771
[S4] round=39 local utility u=0.556305 metrics={'f1_val': 0.9411668577918575, 'auprc': 0.9388794520192245, 'loss_val': 0.29150910769202204, 'psi': 0.9402518954828043}-{'f1_val': 0.7959941518469642, 'auprc': 0.90776352421747, 'loss_val': 0.4397352597194447, 'psi': 0.8407019007951665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S4] r=40 psi=0.940 u=0.5563 p_local=0.1284 f1=0.941 auprc=0.939 bytes=43162
[S5] START round=39 head_norm_before_train=1.376513 cos_to_last_merge=0.8581 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.858
[S5] round=39 local utility u=0.424915 metrics={'f1_val': 0.6281823848987079, 'auprc': 0.9461965250726443, 'loss_val': 0.363216975490241, 'psi': 0.7553880409682825}-{'f1_val': 0.5732962514815007, 'auprc': 0.8557207793541572, 'loss_val': 0.6123037942666197, 'psi': 0.6862660626305632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] r=40 psi=0.755 u=0.4249 p_local=0.2927 f1=0.628 auprc=0.946 bytes=41400
[S6] START round=39 head_norm_before_train=1.605376 cos_to_last_merge=0.8467 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.847
[S6] round=39 local utility u=0.037676 metrics={'f1_val': 0.7859583095816094, 'auprc': 0.9407375100508233, 'loss_val': 0.6056469134616234, 'psi': 0.847869989769295}-{'f1_val': 0.7717712943465967, 'auprc': 0.9486075729098504, 'loss_val': 0.6194864603952767, 'psi': 0.8425058057718982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S6] r=40 psi=0.848 u=0.0377 p_local=0.3030 f1=0.786 auprc=0.941 bytes=37752
[S7] START round=39 head_norm_before_train=1.703383 (no previous merge yet)
[S7] round=39 local utility u=0.407924 metrics={'f1_val': 0.6303958785461764, 'auprc': 0.797891263455029, 'loss_val': 0.5242164341823731, 'psi': 0.6973940325097174}-{'f1_val': 0.5469245908844357, 'auprc': 0.7847415286443127, 'loss_val': 0.7997867433430572, 'psi': 0.6420513659883864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] r=40 psi=0.697 u=0.4079 p_local=0.2152 f1=0.630 auprc=0.798 bytes=44950
[S8] START round=39 head_norm_before_train=1.729485 cos_to_last_merge=0.9596 (last merge round=15)
[S8] round=39 local utility u=0.125522 metrics={'f1_val': 0.9936377668526739, 'auprc': 0.9993218394732043, 'loss_val': 0.04052791413315408, 'psi': 0.9959113959008861}-{'f1_val': 0.967331170859437, 'auprc': 0.9935081728003218, 'loss_val': 0.11629162796420948, 'psi': 0.9778019716357909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S8] r=40 psi=0.996 u=0.1255 p_local=0.0365 f1=0.994 auprc=0.999 bytes=46828
[S9] START round=39 head_norm_before_train=1.865592 cos_to_last_merge=0.8073 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.807
[S9] round=39 local utility u=0.024842 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9984739932042358, 'loss_val': 0.025924968401470235, 'psi': 0.9963862497395273}-{'f1_val': 0.9892714523047061, 'auprc': 0.9984683803240941, 'loss_val': 0.04125367427428662, 'psi': 0.9929502235124614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S9] r=40 psi=0.996 u=0.0248 p_local=0.0225 f1=0.995 auprc=0.998 bytes=48476
[S10] START round=39 head_norm_before_train=1.799070 cos_to_last_merge=0.8733 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.873
[S10] round=39 local utility u=0.001264 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9932489271787281, 'loss_val': 0.031257245656745675, 'psi': 0.9944122742831161}-{'f1_val': 0.9951878390193748, 'auprc': 0.9925892490910857, 'loss_val': 0.031806667161074886, 'psi': 0.9941484030480592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S10] r=40 psi=0.994 u=0.0013 p_local=0.0039 f1=0.995 auprc=0.993 bytes=54010
[S11] START round=39 head_norm_before_train=1.658876 cos_to_last_merge=0.9148 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.915
[S11] round=39 local utility u=0.000942 metrics={'f1_val': 0.9918218357885851, 'auprc': 0.9987243538849726, 'loss_val': 0.03833983538120904, 'psi': 0.9945828430271401}-{'f1_val': 0.9918218357885851, 'auprc': 0.9987157322526915, 'loss_val': 0.04019763025579963, 'psi': 0.9945793943742276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=40 psi=0.995 u=0.0009 p_local=0.0563 f1=0.992 auprc=0.999 bytes=48538
[S13] START round=39 head_norm_before_train=1.366107 cos_to_last_merge=0.9183 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.918
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5690835091102151, 'auprc': 0.720690647419785, 'loss_val': 0.8400745761272596, 'psi': 0.629726364434043}-{'f1_val': 0.5889943788498058, 'auprc': 0.6924675219749331, 'loss_val': 0.6383716745168384, 'psi': 0.6303836360998567}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.630 u=0.0000 p_local=0.0557 f1=0.569 auprc=0.721 bytes=37726
[S14] START round=39 head_norm_before_train=1.788952 cos_to_last_merge=0.9610 (last merge round=16)
[S14] round=39 local utility u=0.001251 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.999230451758466, 'loss_val': 0.02335513847332416, 'psi': 0.9983852363160418}-{'f1_val': 0.997389947818302, 'auprc': 0.9988547542101642, 'loss_val': 0.022139700514440492, 'psi': 0.997975870375047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] r=40 psi=0.998 u=0.0013 p_local=0.0035 f1=0.998 auprc=0.999 bytes=57515
[S15] START round=39 head_norm_before_train=1.722136 cos_to_last_merge=0.9653 (last merge round=16)
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9976608184477834, 'loss_val': 0.024443838980143115, 'psi': 0.9972822848301013}-{'f1_val': 0.6990441952578096, 'auprc': 0.9147659742977936, 'loss_val': 0.4563478755382301, 'psi': 0.7853329068738033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] r=40 psi=0.997 u=1.0000 p_local=0.3348 f1=0.997 auprc=0.998 bytes=46747
[S16] START round=39 head_norm_before_train=1.988052 (no previous merge yet)
[S16] round=39 local utility u=0.512501 metrics={'f1_val': 0.9385922384578508, 'auprc': 0.9980764188486093, 'loss_val': 0.24135971686788404, 'psi': 0.9623859106141542}-{'f1_val': 0.8610493596659234, 'auprc': 0.9897575136250814, 'loss_val': 0.7761486212844482, 'psi': 0.9125326212495866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] r=40 psi=0.962 u=0.5125 p_local=0.2579 f1=0.939 auprc=0.998 bytes=41353
[S17] START round=39 head_norm_before_train=1.564563 cos_to_last_merge=0.9154 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.915
[S17] round=39 local utility u=0.481614 metrics={'f1_val': 0.67785819488933, 'auprc': 0.8221383228176082, 'loss_val': 1.1420643628505882, 'psi': 0.7355702460606413}-{'f1_val': 0.6244031837707001, 'auprc': 0.6884296169910126, 'loss_val': 1.383435225683996, 'psi': 0.6500137570588251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S17] r=40 psi=0.736 u=0.4816 p_local=0.1960 f1=0.678 auprc=0.822 bytes=37786
[S2] START round=40 head_norm_before_train=1.573807 cos_to_last_merge=0.9292 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=40 local utility u=0.483902 metrics={'f1_val': 0.7180297082587849, 'auprc': 0.7691929570143391, 'loss_val': 0.8046619908685494, 'psi': 0.7384950077610066}-{'f1_val': 0.6444673719554168, 'auprc': 0.7186176023860984, 'loss_val': 1.1793661955853696, 'psi': 0.6741274641276894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=40 head_norm_before_train=1.814497 cos_to_last_merge=0.9621 (last merge round=16)
[S3] round=40 local utility u=0.102950 metrics={'f1_val': 0.9884213825187769, 'auprc': 0.9992844977587163, 'loss_val': 0.05734266539001024, 'psi': 0.9927666286147527}-{'f1_val': 0.9610750853994537, 'auprc': 0.9990927340606864, 'loss_val': 0.09859034815480378, 'psi': 0.9762821448639468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=40 head_norm_before_train=1.750386 cos_to_last_merge=0.7710 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.771
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9375503850832007, 'auprc': 0.9250887503886145, 'loss_val': 0.2737583707324662, 'psi': 0.9325657312053662}-{'f1_val': 0.9411668577918575, 'auprc': 0.9388794520192245, 'loss_val': 0.29150910769202204, 'psi': 0.9402518954828043}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.385501 cos_to_last_merge=0.8565 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.856
[S5] round=40 local utility u=0.161758 metrics={'f1_val': 0.6682494282000994, 'auprc': 0.9558203262436463, 'loss_val': 0.3089742153329423, 'psi': 0.7832777874175182}-{'f1_val': 0.6281823848987079, 'auprc': 0.9461965250726443, 'loss_val': 0.363216975490241, 'psi': 0.7553880409682825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=40 head_norm_before_train=1.611253 cos_to_last_merge=0.8459 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.788345018311137, 'auprc': 0.9047236074858649, 'loss_val': 0.562206756016004, 'psi': 0.8348964539810282}-{'f1_val': 0.7859583095816094, 'auprc': 0.9407375100508233, 'loss_val': 0.6056469134616234, 'psi': 0.847869989769295}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.708349 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5959209097006708, 'auprc': 0.7932188902165729, 'loss_val': 0.6386468029057519, 'psi': 0.6748401019070316}-{'f1_val': 0.6303958785461764, 'auprc': 0.797891263455029, 'loss_val': 0.5242164341823731, 'psi': 0.6973940325097174}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.737806 cos_to_last_merge=0.9588 (last merge round=15)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9898564228592382, 'auprc': 0.9991890009795067, 'loss_val': 0.03836820832589846, 'psi': 0.9935894541073457}-{'f1_val': 0.9936377668526739, 'auprc': 0.9993218394732043, 'loss_val': 0.04052791413315408, 'psi': 0.9959113959008861}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.876618 cos_to_last_merge=0.8062 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.806
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9935033258496955, 'loss_val': 0.023323963324219384, 'psi': 0.9953976374282131}-{'f1_val': 0.994994420763055, 'auprc': 0.9984739932042358, 'loss_val': 0.025924968401470235, 'psi': 0.9963862497395273}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.811273 cos_to_last_merge=0.8720 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.872
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9921757710165774, 'loss_val': 0.03160659439212028, 'psi': 0.9937337304162343}-{'f1_val': 0.9951878390193748, 'auprc': 0.9932489271787281, 'loss_val': 0.031257245656745675, 'psi': 0.9944122742831161}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.674190 cos_to_last_merge=0.9128 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.913
[S11] round=40 local utility u=0.008152 metrics={'f1_val': 0.9934294934240196, 'auprc': 0.9986753904427537, 'loss_val': 0.03153578088422658, 'psi': 0.9955278522315132}-{'f1_val': 0.9918218357885851, 'auprc': 0.9987243538849726, 'loss_val': 0.03833983538120904, 'psi': 0.9945828430271401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=40 head_norm_before_train=1.375562 cos_to_last_merge=0.9171 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.917
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.530973119704616, 'auprc': 0.744182357622738, 'loss_val': 0.9465712942996959, 'psi': 0.6162568148718648}-{'f1_val': 0.5690835091102151, 'auprc': 0.720690647419785, 'loss_val': 0.8400745761272596, 'psi': 0.629726364434043}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.800846 cos_to_last_merge=0.9603 (last merge round=16)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9986449601575108, 'loss_val': 0.02273213552151788, 'psi': 0.9981510396756598}-{'f1_val': 0.9978217593544257, 'auprc': 0.999230451758466, 'loss_val': 0.02335513847332416, 'psi': 0.9983852363160418}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.731783 cos_to_last_merge=0.9643 (last merge round=16)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.901373541316951, 'auprc': 0.992945610573468, 'loss_val': 0.16566687106182584, 'psi': 0.9380023690195578}-{'f1_val': 0.9970299290849798, 'auprc': 0.9976608184477834, 'loss_val': 0.024443838980143115, 'psi': 0.9972822848301013}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.993680 (no previous merge yet)
[S16] round=40 local utility u=0.012466 metrics={'f1_val': 0.9402064812154758, 'auprc': 0.991680533418586, 'loss_val': 0.20692501242200728, 'psi': 0.9607961020967198}-{'f1_val': 0.9385922384578508, 'auprc': 0.9980764188486093, 'loss_val': 0.24135971686788404, 'psi': 0.9623859106141542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=40 head_norm_before_train=1.580782 cos_to_last_merge=0.9134 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.913
[S17] round=40 local utility u=0.057095 metrics={'f1_val': 0.6832983108333959, 'auprc': 0.8261861281557293, 'loss_val': 1.0726579570743553, 'psi': 0.7404534377623293}-{'f1_val': 0.67785819488933, 'auprc': 0.8221383228176082, 'loss_val': 1.1420643628505882, 'psi': 0.7355702460606413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=41 head_norm_before_train=1.582048 cos_to_last_merge=0.9278 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7198860086644209, 'auprc': 0.7614667854376356, 'loss_val': 0.8471512248576437, 'psi': 0.7365183193737068}-{'f1_val': 0.7180297082587849, 'auprc': 0.7691929570143391, 'loss_val': 0.8046619908685494, 'psi': 0.7384950077610066}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.833922 cos_to_last_merge=0.9599 (last merge round=16)
[S3] round=41 local utility u=0.014311 metrics={'f1_val': 0.9919237531864131, 'auprc': 0.9993377575378406, 'loss_val': 0.04989531341440212, 'psi': 0.9948893549269842}-{'f1_val': 0.9884213825187769, 'auprc': 0.9992844977587163, 'loss_val': 0.05734266539001024, 'psi': 0.9927666286147527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=41 head_norm_before_train=1.754351 cos_to_last_merge=0.7714 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.771
[S4] round=41 local utility u=0.087465 metrics={'f1_val': 0.944835751458156, 'auprc': 0.9639605011349623, 'loss_val': 0.25915655668435844, 'psi': 0.9524856513288786}-{'f1_val': 0.9375503850832007, 'auprc': 0.9250887503886145, 'loss_val': 0.2737583707324662, 'psi': 0.9325657312053662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=41 head_norm_before_train=1.394004 cos_to_last_merge=0.8554 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.855
[S5] round=41 local utility u=0.022677 metrics={'f1_val': 0.6832110373342353, 'auprc': 0.945703957737826, 'loss_val': 0.3230399647510389, 'psi': 0.7882082054956716}-{'f1_val': 0.6682494282000994, 'auprc': 0.9558203262436463, 'loss_val': 0.3089742153329423, 'psi': 0.7832777874175182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=41 head_norm_before_train=1.620391 cos_to_last_merge=0.8440 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6397677709592663, 'auprc': 0.7816676619678006, 'loss_val': 0.8897366823697019, 'psi': 0.69652772736268}-{'f1_val': 0.788345018311137, 'auprc': 0.9047236074858649, 'loss_val': 0.562206756016004, 'psi': 0.8348964539810282}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.716444 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5759400452494212, 'auprc': 0.7901439656066032, 'loss_val': 0.7458736083330921, 'psi': 0.6616216133922941}-{'f1_val': 0.5959209097006708, 'auprc': 0.7932188902165729, 'loss_val': 0.6386468029057519, 'psi': 0.6748401019070316}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.747620 cos_to_last_merge=0.9579 (last merge round=15)
[S8] round=41 local utility u=0.011713 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.9994022042886596, 'loss_val': 0.035111726376735077, 'psi': 0.9956276831885309}-{'f1_val': 0.9898564228592382, 'auprc': 0.9991890009795067, 'loss_val': 0.03836820832589846, 'psi': 0.9935894541073457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=41 head_norm_before_train=1.888120 cos_to_last_merge=0.8051 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.805
[S9] round=41 local utility u=0.002992 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9984728013609706, 'loss_val': 0.023278738374756976, 'psi': 0.9964884243783573}-{'f1_val': 0.9966605118138915, 'auprc': 0.9935033258496955, 'loss_val': 0.023323963324219384, 'psi': 0.9953976374282131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=41 head_norm_before_train=1.819607 cos_to_last_merge=0.8714 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.871
[S10] round=41 local utility u=0.003790 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934950338999449, 'loss_val': 0.030476977812711768, 'psi': 0.9945107169716028}-{'f1_val': 0.9947723700160056, 'auprc': 0.9921757710165774, 'loss_val': 0.03160659439212028, 'psi': 0.9937337304162343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=41 head_norm_before_train=1.688966 cos_to_last_merge=0.9111 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.911
[S11] round=41 local utility u=0.011091 metrics={'f1_val': 0.9960663761953501, 'auprc': 0.9986915854130601, 'loss_val': 0.025223633986920967, 'psi': 0.9971164598824341}-{'f1_val': 0.9934294934240196, 'auprc': 0.9986753904427537, 'loss_val': 0.03153578088422658, 'psi': 0.9955278522315132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=41 head_norm_before_train=1.382807 cos_to_last_merge=0.9157 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.916
[S13] round=41 local utility u=0.348124 metrics={'f1_val': 0.6143258082841563, 'auprc': 0.7111862088915517, 'loss_val': 0.6514511769112064, 'psi': 0.6530699685271144}-{'f1_val': 0.530973119704616, 'auprc': 0.744182357622738, 'loss_val': 0.9465712942996959, 'psi': 0.6162568148718648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=41 head_norm_before_train=1.812994 cos_to_last_merge=0.9596 (last merge round=16)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9971579768232329, 'loss_val': 0.025475230474150144, 'psi': 0.9975549015096242}-{'f1_val': 0.9978217593544257, 'auprc': 0.9986449601575108, 'loss_val': 0.02273213552151788, 'psi': 0.9981510396756598}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.742087 cos_to_last_merge=0.9635 (last merge round=16)
[S15] round=41 local utility u=0.004470 metrics={'f1_val': 0.9031662165952834, 'auprc': 0.9971871100815555, 'loss_val': 0.1802074833635928, 'psi': 0.9407745739897923}-{'f1_val': 0.901373541316951, 'auprc': 0.992945610573468, 'loss_val': 0.16566687106182584, 'psi': 0.9380023690195578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=41 head_norm_before_train=1.996797 (no previous merge yet)
[S16] round=41 local utility u=0.085752 metrics={'f1_val': 0.9563506923860188, 'auprc': 0.9900141830607455, 'loss_val': 0.12728712498954975, 'psi': 0.9698160886559095}-{'f1_val': 0.9402064812154758, 'auprc': 0.991680533418586, 'loss_val': 0.20692501242200728, 'psi': 0.9607961020967198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=41 head_norm_before_train=1.593153 cos_to_last_merge=0.9116 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.912
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6334063357920081, 'auprc': 0.7498317998993869, 'loss_val': 1.3110399569363211, 'psi': 0.6799765214349596}-{'f1_val': 0.6832983108333959, 'auprc': 0.8261861281557293, 'loss_val': 1.0726579570743553, 'psi': 0.7404534377623293}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.591649 cos_to_last_merge=0.9261 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=42 local utility u=0.003983 metrics={'f1_val': 0.7198204826185411, 'auprc': 0.7635606433178604, 'loss_val': 0.8450745226773637, 'psi': 0.7373165468982689}-{'f1_val': 0.7198860086644209, 'auprc': 0.7614667854376356, 'loss_val': 0.8471512248576437, 'psi': 0.7365183193737068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[S3] START round=42 head_norm_before_train=1.852283 cos_to_last_merge=0.9577 (last merge round=16)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9991913817037149, 'loss_val': 0.10581321242763041, 'psi': 0.9763216039211582}-{'f1_val': 0.9919237531864131, 'auprc': 0.9993377575378406, 'loss_val': 0.04989531341440212, 'psi': 0.9948893549269842}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.757103 cos_to_last_merge=0.7717 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.772
[S4] round=42 local utility u=0.011096 metrics={'f1_val': 0.945727518252753, 'auprc': 0.9695845938745692, 'loss_val': 0.2591865491233763, 'psi': 0.9552703485014795}-{'f1_val': 0.944835751458156, 'auprc': 0.9639605011349623, 'loss_val': 0.25915655668435844, 'psi': 0.9524856513288786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=42 head_norm_before_train=1.403400 cos_to_last_merge=0.8545 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.854
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6605032417987081, 'auprc': 0.936307298573366, 'loss_val': 0.3553317861934011, 'psi': 0.7708248645085714}-{'f1_val': 0.6832110373342353, 'auprc': 0.945703957737826, 'loss_val': 0.3230399647510389, 'psi': 0.7882082054956716}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.628232 cos_to_last_merge=0.8425 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.843
[S6] round=42 local utility u=0.950047 metrics={'f1_val': 0.7757331412466293, 'auprc': 0.9348832203261442, 'loss_val': 0.26508257182892825, 'psi': 0.8393931728784352}-{'f1_val': 0.6397677709592663, 'auprc': 0.7816676619678006, 'loss_val': 0.8897366823697019, 'psi': 0.69652772736268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=42 head_norm_before_train=1.725722 (no previous merge yet)
[S7] round=42 local utility u=0.015579 metrics={'f1_val': 0.5752764191617681, 'auprc': 0.7883538879363815, 'loss_val': 0.7053637597778166, 'psi': 0.6605074066716135}-{'f1_val': 0.5759400452494212, 'auprc': 0.7901439656066032, 'loss_val': 0.7458736083330921, 'psi': 0.6616216133922941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=42 head_norm_before_train=1.756499 cos_to_last_merge=0.9572 (last merge round=15)
[S8] round=42 local utility u=0.002096 metrics={'f1_val': 0.9940049367381726, 'auprc': 0.9994671819840576, 'loss_val': 0.03647553086803949, 'psi': 0.9961898348365266}-{'f1_val': 0.9931113357884451, 'auprc': 0.9994022042886596, 'loss_val': 0.035111726376735077, 'psi': 0.9956276831885309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=42 head_norm_before_train=1.897084 cos_to_last_merge=0.8041 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.804
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9984760475238187, 'loss_val': 0.023858385316043954, 'psi': 0.9964897228434966}-{'f1_val': 0.9951655063899485, 'auprc': 0.9984728013609706, 'loss_val': 0.023278738374756976, 'psi': 0.9964884243783573}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.826079 cos_to_last_merge=0.8712 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.871
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9922342096403076, 'loss_val': 0.030180242034473937, 'psi': 0.9940063872677478}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934950338999449, 'loss_val': 0.030476977812711768, 'psi': 0.9945107169716028}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.702459 cos_to_last_merge=0.9094 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.909
[S11] round=42 local utility u=0.000639 metrics={'f1_val': 0.9961344836672389, 'auprc': 0.9987619503081206, 'loss_val': 0.024565338878059676, 'psi': 0.9971854703235916}-{'f1_val': 0.9960663761953501, 'auprc': 0.9986915854130601, 'loss_val': 0.025223633986920967, 'psi': 0.9971164598824341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=42 head_norm_before_train=1.389451 cos_to_last_merge=0.9147 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5968097056102926, 'auprc': 0.7201957173287261, 'loss_val': 0.7831270978542667, 'psi': 0.646164110297666}-{'f1_val': 0.6143258082841563, 'auprc': 0.7111862088915517, 'loss_val': 0.6514511769112064, 'psi': 0.6530699685271144}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.821550 cos_to_last_merge=0.9591 (last merge round=16)
[S14] round=42 local utility u=0.004348 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992278116509336, 'loss_val': 0.02298840545811981, 'psi': 0.9983828354407045}-{'f1_val': 0.9978195179672185, 'auprc': 0.9971579768232329, 'loss_val': 0.025475230474150144, 'psi': 0.9975549015096242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=42 head_norm_before_train=1.752426 cos_to_last_merge=0.9625 (last merge round=16)
[S15] round=42 local utility u=0.361189 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982460863912732, 'loss_val': 0.022488696623840874, 'psi': 0.9973464355890216}-{'f1_val': 0.9031662165952834, 'auprc': 0.9971871100815555, 'loss_val': 0.1802074833635928, 'psi': 0.9407745739897923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=42 head_norm_before_train=2.003081 (no previous merge yet)
[S16] round=42 local utility u=0.085682 metrics={'f1_val': 0.9773938845601243, 'auprc': 0.9879135282547331, 'loss_val': 0.07587974938545743, 'psi': 0.9816017420379679}-{'f1_val': 0.9563506923860188, 'auprc': 0.9900141830607455, 'loss_val': 0.12728712498954975, 'psi': 0.9698160886559095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=42 head_norm_before_train=1.602182 cos_to_last_merge=0.9104 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.910
[S17] round=42 local utility u=0.228882 metrics={'f1_val': 0.6642979721374874, 'auprc': 0.8122079155524632, 'loss_val': 1.2257534633738427, 'psi': 0.7234619495034778}-{'f1_val': 0.6334063357920081, 'auprc': 0.7498317998993869, 'loss_val': 1.3110399569363211, 'psi': 0.6799765214349596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=43 head_norm_before_train=1.604595 cos_to_last_merge=0.9239 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.924
[S2] round=43 local utility u=0.000373 metrics={'f1_val': 0.7198204826185411, 'auprc': 0.7650108090206511, 'loss_val': 0.8486781174954864, 'psi': 0.7378966131793852}-{'f1_val': 0.7198204826185411, 'auprc': 0.7635606433178604, 'loss_val': 0.8450745226773637, 'psi': 0.7373165468982689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=43 head_norm_before_train=1.868046 cos_to_last_merge=0.9559 (last merge round=16)
[S3] round=43 local utility u=0.001998 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9991885172393615, 'loss_val': 0.0986209476771132, 'psi': 0.9760017306352129}-{'f1_val': 0.9610750853994537, 'auprc': 0.9991913817037149, 'loss_val': 0.10581321242763041, 'psi': 0.9763216039211582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=43 head_norm_before_train=1.766186 cos_to_last_merge=0.7713 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.771
[S4] round=43 local utility u=0.012312 metrics={'f1_val': 0.9479483193980363, 'auprc': 0.9757052037099545, 'loss_val': 0.2662501658353262, 'psi': 0.9590510731228036}-{'f1_val': 0.945727518252753, 'auprc': 0.9695845938745692, 'loss_val': 0.2591865491233763, 'psi': 0.9552703485014795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=43 head_norm_before_train=1.410201 cos_to_last_merge=0.8536 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.854
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8554594653060866, 'loss_val': 1.1221875252906874, 'psi': 0.6042435244256579}-{'f1_val': 0.6605032417987081, 'auprc': 0.936307298573366, 'loss_val': 0.3553317861934011, 'psi': 0.7708248645085714}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.631860 cos_to_last_merge=0.8416 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7880551612195406, 'auprc': 0.9393260478102973, 'loss_val': 0.5815950559693452, 'psi': 0.8485635158558432}-{'f1_val': 0.7757331412466293, 'auprc': 0.9348832203261442, 'loss_val': 0.26508257182892825, 'psi': 0.8393931728784352}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.732135 (no previous merge yet)
[S7] round=43 local utility u=0.810836 metrics={'f1_val': 0.7105675501138884, 'auprc': 0.8991343199179122, 'loss_val': 0.22778065298416716, 'psi': 0.7859942580354979}-{'f1_val': 0.5752764191617681, 'auprc': 0.7883538879363815, 'loss_val': 0.7053637597778166, 'psi': 0.6605074066716135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=43 head_norm_before_train=1.763851 cos_to_last_merge=0.9566 (last merge round=15)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.8456301967137534, 'auprc': 0.9982911854788576, 'loss_val': 0.24616041870134708, 'psi': 0.9066945922197951}-{'f1_val': 0.9940049367381726, 'auprc': 0.9994671819840576, 'loss_val': 0.03647553086803949, 'psi': 0.9961898348365266}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.905832 cos_to_last_merge=0.8031 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.803
[S9] round=43 local utility u=0.000556 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9984767353293471, 'loss_val': 0.022747451477361708, 'psi': 0.9964899979657079}-{'f1_val': 0.9951655063899485, 'auprc': 0.9984760475238187, 'loss_val': 0.023858385316043954, 'psi': 0.9964897228434966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=43 head_norm_before_train=1.834325 cos_to_last_merge=0.8706 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.871
[S10] round=43 local utility u=0.001208 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9928995621896022, 'loss_val': 0.029760329302074142, 'psi': 0.9942725282874657}-{'f1_val': 0.9951878390193748, 'auprc': 0.9922342096403076, 'loss_val': 0.030180242034473937, 'psi': 0.9940063872677478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=43 head_norm_before_train=1.714278 cos_to_last_merge=0.9079 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9450423100174974, 'auprc': 0.9987490176102127, 'loss_val': 0.18758388235812412, 'psi': 0.9665249930545836}-{'f1_val': 0.9961344836672389, 'auprc': 0.9987619503081206, 'loss_val': 0.024565338878059676, 'psi': 0.9971854703235916}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.397190 cos_to_last_merge=0.9135 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.914
[S13] round=43 local utility u=0.028771 metrics={'f1_val': 0.5935750408662227, 'auprc': 0.7147680610622553, 'loss_val': 0.6898939993557118, 'psi': 0.6420522489446358}-{'f1_val': 0.5968097056102926, 'auprc': 0.7201957173287261, 'loss_val': 0.7831270978542667, 'psi': 0.646164110297666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=43 head_norm_before_train=1.830598 cos_to_last_merge=0.9585 (last merge round=16)
[S14] round=43 local utility u=0.001316 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.9988550315103695, 'loss_val': 0.020576546966485244, 'psi': 0.9983676557182026}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992278116509336, 'loss_val': 0.02298840545811981, 'psi': 0.9983828354407045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=43 head_norm_before_train=1.762582 cos_to_last_merge=0.9615 (last merge round=16)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9592206264811329, 'auprc': 0.9995017535858506, 'loss_val': 0.09242462285720901, 'psi': 0.97533307732302}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982460863912732, 'loss_val': 0.022488696623840874, 'psi': 0.9973464355890216}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=2.008931 (no previous merge yet)
[S16] round=43 local utility u=0.048015 metrics={'f1_val': 0.9895234982844874, 'auprc': 0.9874522693075167, 'loss_val': 0.051243240643573905, 'psi': 0.988695006693699}-{'f1_val': 0.9773938845601243, 'auprc': 0.9879135282547331, 'loss_val': 0.07587974938545743, 'psi': 0.9816017420379679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=43 head_norm_before_train=1.614877 cos_to_last_merge=0.9090 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.909
[S17] round=43 local utility u=0.091364 metrics={'f1_val': 0.6779902435896709, 'auprc': 0.8234366319521955, 'loss_val': 1.1588655155547274, 'psi': 0.7361687989346808}-{'f1_val': 0.6642979721374874, 'auprc': 0.8122079155524632, 'loss_val': 1.2257534633738427, 'psi': 0.7234619495034778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=44 head_norm_before_train=1.615576 cos_to_last_merge=0.9220 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.922
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7198204826185411, 'auprc': 0.7637045315314555, 'loss_val': 0.85160933647532, 'psi': 0.7373741021837069}-{'f1_val': 0.7198204826185411, 'auprc': 0.7650108090206511, 'loss_val': 0.8486781174954864, 'psi': 0.7378966131793852}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.882190 cos_to_last_merge=0.9543 (last merge round=16)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8996903075443559, 'auprc': 0.9980770902864524, 'loss_val': 0.1977458271999386, 'psi': 0.9390450206411944}-{'f1_val': 0.9605438728991138, 'auprc': 0.9991885172393615, 'loss_val': 0.0986209476771132, 'psi': 0.9760017306352129}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.774179 cos_to_last_merge=0.7708 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.771
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9423204454044136, 'auprc': 0.9477516707663932, 'loss_val': 0.2822601602951538, 'psi': 0.9444929355492054}-{'f1_val': 0.9479483193980363, 'auprc': 0.9757052037099545, 'loss_val': 0.2662501658353262, 'psi': 0.9590510731228036}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.416302 cos_to_last_merge=0.8527 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.853
[S5] round=44 local utility u=0.150192 metrics={'f1_val': 0.43960796518818884, 'auprc': 0.8562761965793623, 'loss_val': 0.8413036089284183, 'psi': 0.6062752577446582}-{'f1_val': 0.43676623050537206, 'auprc': 0.8554594653060866, 'loss_val': 1.1221875252906874, 'psi': 0.6042435244256579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=44 head_norm_before_train=1.634800 cos_to_last_merge=0.8403 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.840
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6984871786411398, 'auprc': 0.944627865297476, 'loss_val': 0.8531152488778591, 'psi': 0.7969434533036743}-{'f1_val': 0.7880551612195406, 'auprc': 0.9393260478102973, 'loss_val': 0.5815950559693452, 'psi': 0.8485635158558432}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.739308 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5101807937226953, 'auprc': 0.781732238284618, 'loss_val': 0.880734063717741, 'psi': 0.6188013715474645}-{'f1_val': 0.7105675501138884, 'auprc': 0.8991343199179122, 'loss_val': 0.22778065298416716, 'psi': 0.7859942580354979}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.771670 cos_to_last_merge=0.9560 (last merge round=15)
[S8] round=44 local utility u=0.498355 metrics={'f1_val': 0.9869646624183867, 'auprc': 0.9876768122028902, 'loss_val': 0.06561424342856056, 'psi': 0.987249522332188}-{'f1_val': 0.8456301967137534, 'auprc': 0.9982911854788576, 'loss_val': 0.24616041870134708, 'psi': 0.9066945922197951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=44 head_norm_before_train=1.914305 cos_to_last_merge=0.8024 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.802
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9984840492976681, 'loss_val': 0.027076013121591743, 'psi': 0.9954887290248898}-{'f1_val': 0.9951655063899485, 'auprc': 0.9984767353293471, 'loss_val': 0.022747451477361708, 'psi': 0.9964899979657079}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.843362 cos_to_last_merge=0.8697 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.870
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9922960875655269, 'loss_val': 0.02949139607398466, 'psi': 0.9940311384378355}-{'f1_val': 0.9951878390193748, 'auprc': 0.9928995621896022, 'loss_val': 0.029760329302074142, 'psi': 0.9942725282874657}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.725933 cos_to_last_merge=0.9065 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=44 local utility u=0.235685 metrics={'f1_val': 0.9961344836672389, 'auprc': 0.9987580261247105, 'loss_val': 0.022793647286771006, 'psi': 0.9971839006502276}-{'f1_val': 0.9450423100174974, 'auprc': 0.9987490176102127, 'loss_val': 0.18758388235812412, 'psi': 0.9665249930545836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=44 head_norm_before_train=1.405689 cos_to_last_merge=0.9124 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.912
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5793588822310707, 'auprc': 0.7235258747598332, 'loss_val': 0.7821556032705826, 'psi': 0.6370256792425757}-{'f1_val': 0.5935750408662227, 'auprc': 0.7147680610622553, 'loss_val': 0.6898939993557118, 'psi': 0.6420522489446358}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.840217 cos_to_last_merge=0.9578 (last merge round=16)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9983826715787395, 'loss_val': 0.021538260820582154, 'psi': 0.9977996651921928}-{'f1_val': 0.9980427385234248, 'auprc': 0.9988550315103695, 'loss_val': 0.020576546966485244, 'psi': 0.9983676557182026}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.774417 cos_to_last_merge=0.9605 (last merge round=16)
[S15] round=44 local utility u=0.144169 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9976661062044477, 'loss_val': 0.02543612883790449, 'psi': 0.997284399932767}-{'f1_val': 0.9592206264811329, 'auprc': 0.9995017535858506, 'loss_val': 0.09242462285720901, 'psi': 0.97533307732302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=44 head_norm_before_train=2.015198 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.864351169511572, 'auprc': 0.9210714237507203, 'loss_val': 0.795915149574367, 'psi': 0.8870392712072313}-{'f1_val': 0.9895234982844874, 'auprc': 0.9874522693075167, 'loss_val': 0.051243240643573905, 'psi': 0.988695006693699}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.627867 cos_to_last_merge=0.9076 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.908
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6754421382390889, 'auprc': 0.8177897733546333, 'loss_val': 1.1748938336034458, 'psi': 0.7323811922853067}-{'f1_val': 0.6779902435896709, 'auprc': 0.8234366319521955, 'loss_val': 1.1588655155547274, 'psi': 0.7361687989346808}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.627872 cos_to_last_merge=0.9199 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.920
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7150946535640312, 'auprc': 0.7376027968656821, 'loss_val': 0.8212271349293745, 'psi': 0.7240979108846917}-{'f1_val': 0.7198204826185411, 'auprc': 0.7637045315314555, 'loss_val': 0.85160933647532, 'psi': 0.7373741021837069}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.896104 cos_to_last_merge=0.9528 (last merge round=16)
[S3] round=45 local utility u=0.205460 metrics={'f1_val': 0.9541366215661146, 'auprc': 0.9987652244438598, 'loss_val': 0.11556895583944853, 'psi': 0.9719880627172127}-{'f1_val': 0.8996903075443559, 'auprc': 0.9980770902864524, 'loss_val': 0.1977458271999386, 'psi': 0.9390450206411944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=45 head_norm_before_train=1.781509 cos_to_last_merge=0.7705 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.771
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9415420335537968, 'auprc': 0.9440817767676178, 'loss_val': 0.28948067381866427, 'psi': 0.9425579308393253}-{'f1_val': 0.9423204454044136, 'auprc': 0.9477516707663932, 'loss_val': 0.2822601602951538, 'psi': 0.9444929355492054}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.420946 cos_to_last_merge=0.8520 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.852
[S5] round=45 local utility u=0.793203 metrics={'f1_val': 0.6439411449092747, 'auprc': 0.8595392181139636, 'loss_val': 0.4906860677005551, 'psi': 0.7301803741911503}-{'f1_val': 0.43960796518818884, 'auprc': 0.8562761965793623, 'loss_val': 0.8413036089284183, 'psi': 0.6062752577446582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=45 head_norm_before_train=1.637179 cos_to_last_merge=0.8397 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.840
[S6] round=45 local utility u=0.492844 metrics={'f1_val': 0.8135626020358852, 'auprc': 0.9557937232529129, 'loss_val': 0.5913771026141444, 'psi': 0.8704550505226962}-{'f1_val': 0.6984871786411398, 'auprc': 0.944627865297476, 'loss_val': 0.8531152488778591, 'psi': 0.7969434533036743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=45 head_norm_before_train=1.743149 (no previous merge yet)
[S7] round=45 local utility u=0.514556 metrics={'f1_val': 0.6232265747490958, 'auprc': 0.7944834244039193, 'loss_val': 0.5681505319302621, 'psi': 0.6917293146110253}-{'f1_val': 0.5101807937226953, 'auprc': 0.781732238284618, 'loss_val': 0.880734063717741, 'psi': 0.6188013715474645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=45 head_norm_before_train=1.778416 cos_to_last_merge=0.9556 (last merge round=15)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9735913934963676, 'auprc': 0.9962067358116635, 'loss_val': 0.0641686007859878, 'psi': 0.9826375304224859}-{'f1_val': 0.9869646624183867, 'auprc': 0.9876768122028902, 'loss_val': 0.06561424342856056, 'psi': 0.987249522332188}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.922983 cos_to_last_merge=0.8018 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.802
[S9] round=45 local utility u=0.010203 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9984755326670642, 'loss_val': 0.02166711659581803, 'psi': 0.9969876863583547}-{'f1_val': 0.9934918488430377, 'auprc': 0.9984840492976681, 'loss_val': 0.027076013121591743, 'psi': 0.9954887290248898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=45 head_norm_before_train=1.852616 cos_to_last_merge=0.8687 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.869
[S10] round=45 local utility u=0.000874 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.992806953418249, 'loss_val': 0.029276927555146732, 'psi': 0.9942354847789244}-{'f1_val': 0.9951878390193748, 'auprc': 0.9922960875655269, 'loss_val': 0.02949139607398466, 'psi': 0.9940311384378355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=45 head_norm_before_train=1.736488 cos_to_last_merge=0.9053 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.905
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9927770647851784, 'auprc': 0.9987135573708024, 'loss_val': 0.03036669243916879, 'psi': 0.995151661819428}-{'f1_val': 0.9961344836672389, 'auprc': 0.9987580261247105, 'loss_val': 0.022793647286771006, 'psi': 0.9971839006502276}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.416469 cos_to_last_merge=0.9111 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.911
[S13] round=45 local utility u=0.267113 metrics={'f1_val': 0.6671995886820574, 'auprc': 0.7425570765161957, 'loss_val': 0.8320670212745441, 'psi': 0.6973425838157128}-{'f1_val': 0.5793588822310707, 'auprc': 0.7235258747598332, 'loss_val': 0.7821556032705826, 'psi': 0.6370256792425757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=45 head_norm_before_train=1.847861 cos_to_last_merge=0.9570 (last merge round=16)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9981276444686216, 'loss_val': 0.022559722768527024, 'psi': 0.9975518684457652}-{'f1_val': 0.9974109942678281, 'auprc': 0.9983826715787395, 'loss_val': 0.021538260820582154, 'psi': 0.9977996651921928}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.786125 cos_to_last_merge=0.9594 (last merge round=16)
[S15] round=45 local utility u=0.004869 metrics={'f1_val': 0.9974005142255595, 'auprc': 0.9992517187074721, 'loss_val': 0.02267916238819513, 'psi': 0.9981409960183245}-{'f1_val': 0.9970299290849798, 'auprc': 0.9976661062044477, 'loss_val': 0.02543612883790449, 'psi': 0.997284399932767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=45 head_norm_before_train=2.021176 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8376933152284954, 'auprc': 0.8896530816390436, 'loss_val': 1.093730608750789, 'psi': 0.8584772217927147}-{'f1_val': 0.864351169511572, 'auprc': 0.9210714237507203, 'loss_val': 0.795915149574367, 'psi': 0.8870392712072313}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.644142 cos_to_last_merge=0.9061 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.906
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6567002959075563, 'auprc': 0.7547652153699527, 'loss_val': 1.3100368925321095, 'psi': 0.6959262636925149}-{'f1_val': 0.6754421382390889, 'auprc': 0.8177897733546333, 'loss_val': 1.1748938336034458, 'psi': 0.7323811922853067}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.638575 cos_to_last_merge=0.9181 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.918
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6278460591865449, 'auprc': 0.7538918213441758, 'loss_val': 0.9758801299005383, 'psi': 0.6782643640495973}-{'f1_val': 0.7150946535640312, 'auprc': 0.7376027968656821, 'loss_val': 0.8212271349293745, 'psi': 0.7240979108846917}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.909920 cos_to_last_merge=0.9513 (last merge round=16)
[S3] round=46 local utility u=0.013779 metrics={'f1_val': 0.9602580484078469, 'auprc': 0.9990484797262932, 'loss_val': 0.12558953368996942, 'psi': 0.9757742209352255}-{'f1_val': 0.9541366215661146, 'auprc': 0.9987652244438598, 'loss_val': 0.11556895583944853, 'psi': 0.9719880627172127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=46 head_norm_before_train=1.792177 cos_to_last_merge=0.7697 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.770
[S4] round=46 local utility u=0.084698 metrics={'f1_val': 0.9509464220982936, 'auprc': 0.9757579081940808, 'loss_val': 0.2715398323499812, 'psi': 0.9608710165366086}-{'f1_val': 0.9415420335537968, 'auprc': 0.9440817767676178, 'loss_val': 0.28948067381866427, 'psi': 0.9425579308393253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=46 head_norm_before_train=1.425904 cos_to_last_merge=0.8511 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.851
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.6007102921057997, 'auprc': 0.8537572779902524, 'loss_val': 0.6148463170317539, 'psi': 0.7019290864595809}-{'f1_val': 0.6439411449092747, 'auprc': 0.8595392181139636, 'loss_val': 0.4906860677005551, 'psi': 0.7301803741911503}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.640453 cos_to_last_merge=0.8393 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7572306086291607, 'auprc': 0.9444598115217319, 'loss_val': 0.7185889591155693, 'psi': 0.8321222897861891}-{'f1_val': 0.8135626020358852, 'auprc': 0.9557937232529129, 'loss_val': 0.5913771026141444, 'psi': 0.8704550505226962}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.747590 (no previous merge yet)
[S7] round=46 local utility u=0.223694 metrics={'f1_val': 0.6576505136320541, 'auprc': 0.8115502752635941, 'loss_val': 0.3785069457827624, 'psi': 0.7192104182846701}-{'f1_val': 0.6232265747490958, 'auprc': 0.7944834244039193, 'loss_val': 0.5681505319302621, 'psi': 0.6917293146110253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=46 head_norm_before_train=1.787036 cos_to_last_merge=0.9549 (last merge round=15)
[S8] round=46 local utility u=0.062717 metrics={'f1_val': 0.9895116842672763, 'auprc': 0.9974396093460021, 'loss_val': 0.037954028296690305, 'psi': 0.9926828542987667}-{'f1_val': 0.9735913934963676, 'auprc': 0.9962067358116635, 'loss_val': 0.0641686007859878, 'psi': 0.9826375304224859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=46 head_norm_before_train=1.933413 cos_to_last_merge=0.8009 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984817892516274, 'loss_val': 0.02346046356781412, 'psi': 0.9967385510311597}-{'f1_val': 0.9959957888192151, 'auprc': 0.9984755326670642, 'loss_val': 0.02166711659581803, 'psi': 0.9969876863583547}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.860180 cos_to_last_merge=0.8681 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.868
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9922730044043225, 'loss_val': 0.029137505288095097, 'psi': 0.9940219051733539}-{'f1_val': 0.9951878390193748, 'auprc': 0.992806953418249, 'loss_val': 0.029276927555146732, 'psi': 0.9942354847789244}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.745579 cos_to_last_merge=0.9043 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.904
[S11] round=46 local utility u=0.006435 metrics={'f1_val': 0.9943870686390696, 'auprc': 0.9986177439926525, 'loss_val': 0.026868684298065867, 'psi': 0.9960793387805027}-{'f1_val': 0.9927770647851784, 'auprc': 0.9987135573708024, 'loss_val': 0.03036669243916879, 'psi': 0.995151661819428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=46 head_norm_before_train=1.422572 cos_to_last_merge=0.9101 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.611614709696325, 'auprc': 0.7321670319193203, 'loss_val': 0.6355177390592237, 'psi': 0.6598356385855231}-{'f1_val': 0.6671995886820574, 'auprc': 0.7425570765161957, 'loss_val': 0.8320670212745441, 'psi': 0.6973425838157128}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.855043 cos_to_last_merge=0.9561 (last merge round=16)
[S14] round=46 local utility u=0.002779 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988498169574918, 'loss_val': 0.02294476467506293, 'psi': 0.9982184329389334}-{'f1_val': 0.9971680177638609, 'auprc': 0.9981276444686216, 'loss_val': 0.022559722768527024, 'psi': 0.9975518684457652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=46 head_norm_before_train=1.796602 cos_to_last_merge=0.9586 (last merge round=16)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7700157369806525, 'auprc': 0.9141279216648657, 'loss_val': 0.5740259169508315, 'psi': 0.8276606108543377}-{'f1_val': 0.9974005142255595, 'auprc': 0.9992517187074721, 'loss_val': 0.02267916238819513, 'psi': 0.9981409960183245}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=2.028575 (no previous merge yet)
[S16] round=46 local utility u=0.115367 metrics={'f1_val': 0.8481039388218973, 'auprc': 0.9079499780750035, 'loss_val': 0.9803503049943258, 'psi': 0.8720423545231398}-{'f1_val': 0.8376933152284954, 'auprc': 0.8896530816390436, 'loss_val': 1.093730608750789, 'psi': 0.8584772217927147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=46 head_norm_before_train=1.661046 cos_to_last_merge=0.9043 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=46 local utility u=0.173369 metrics={'f1_val': 0.6729349799721467, 'auprc': 0.8139786093285719, 'loss_val': 1.2383473147819963, 'psi': 0.7293524317147169}-{'f1_val': 0.6567002959075563, 'auprc': 0.7547652153699527, 'loss_val': 1.3100368925321095, 'psi': 0.6959262636925149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=47 head_norm_before_train=1.649050 cos_to_last_merge=0.9164 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.916
[S2] round=47 local utility u=0.321263 metrics={'f1_val': 0.7187283724004877, 'auprc': 0.74532452267984, 'loss_val': 0.8529463956153142, 'psi': 0.7293668325122287}-{'f1_val': 0.6278460591865449, 'auprc': 0.7538918213441758, 'loss_val': 0.9758801299005383, 'psi': 0.6782643640495973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=47 head_norm_before_train=1.922855 cos_to_last_merge=0.9499 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=47 local utility u=0.085581 metrics={'f1_val': 0.9764875287483505, 'auprc': 0.9995380650105172, 'loss_val': 0.053273192382387015, 'psi': 0.9857077432532172}-{'f1_val': 0.9602580484078469, 'auprc': 0.9990484797262932, 'loss_val': 0.12558953368996942, 'psi': 0.9757742209352255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=47 head_norm_before_train=1.802272 cos_to_last_merge=0.7689 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.769
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9490096889020533, 'auprc': 0.9699538152924335, 'loss_val': 0.2802597299117537, 'psi': 0.9573873394582054}-{'f1_val': 0.9509464220982936, 'auprc': 0.9757579081940808, 'loss_val': 0.2715398323499812, 'psi': 0.9608710165366086}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.432563 cos_to_last_merge=0.8496 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.850
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.5804650123441957, 'auprc': 0.8396511958714601, 'loss_val': 0.6769086731939539, 'psi': 0.6841394857551015}-{'f1_val': 0.6007102921057997, 'auprc': 0.8537572779902524, 'loss_val': 0.6148463170317539, 'psi': 0.7019290864595809}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.645143 cos_to_last_merge=0.8387 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6246352764406292, 'auprc': 0.9359192478928873, 'loss_val': 0.9239105876656477, 'psi': 0.7491488650215326}-{'f1_val': 0.7572306086291607, 'auprc': 0.9444598115217319, 'loss_val': 0.7185889591155693, 'psi': 0.8321222897861891}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.753197 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5809011699797435, 'auprc': 0.7852263116792668, 'loss_val': 0.6536851899200529, 'psi': 0.6626312266595529}-{'f1_val': 0.6576505136320541, 'auprc': 0.8115502752635941, 'loss_val': 0.3785069457827624, 'psi': 0.7192104182846701}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.795001 cos_to_last_merge=0.9543 (last merge round=15)
[S8] round=47 local utility u=0.019169 metrics={'f1_val': 0.9943863538992247, 'auprc': 0.9996812471138079, 'loss_val': 0.03558932021203047, 'psi': 0.996504311185058}-{'f1_val': 0.9895116842672763, 'auprc': 0.9974396093460021, 'loss_val': 0.037954028296690305, 'psi': 0.9926828542987667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=47 head_norm_before_train=1.943629 cos_to_last_merge=0.8002 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=47 local utility u=0.002072 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9984793742609512, 'loss_val': 0.02182477780681451, 'psi': 0.9969892229959095}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984817892516274, 'loss_val': 0.02346046356781412, 'psi': 0.9967385510311597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=47 head_norm_before_train=1.867052 cos_to_last_merge=0.8676 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.868
[S10] round=47 local utility u=0.000378 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9924454093135548, 'loss_val': 0.028899066200672386, 'psi': 0.9940908671370468}-{'f1_val': 0.9951878390193748, 'auprc': 0.9922730044043225, 'loss_val': 0.029137505288095097, 'psi': 0.9940219051733539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=47 head_norm_before_train=1.754560 cos_to_last_merge=0.9032 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.903
[S11] round=47 local utility u=0.002539 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9987295198468165, 'loss_val': 0.03260508654452755, 'psi': 0.9971720128867122}-{'f1_val': 0.9943870686390696, 'auprc': 0.9986177439926525, 'loss_val': 0.026868684298065867, 'psi': 0.9960793387805027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=47 head_norm_before_train=1.430359 cos_to_last_merge=0.9093 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.909
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6136945256804951, 'auprc': 0.7609441887945532, 'loss_val': 0.8398262958191602, 'psi': 0.6725943909261183}-{'f1_val': 0.611614709696325, 'auprc': 0.7321670319193203, 'loss_val': 0.6355177390592237, 'psi': 0.6598356385855231}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.861199 cos_to_last_merge=0.9553 (last merge round=16)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9810902640889714, 'auprc': 0.9992361755428212, 'loss_val': 0.04095868830115863, 'psi': 0.9883486286705112}-{'f1_val': 0.9977975102598944, 'auprc': 0.9988498169574918, 'loss_val': 0.02294476467506293, 'psi': 0.9982184329389334}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.807455 cos_to_last_merge=0.9576 (last merge round=16)
[S15] round=47 local utility u=0.831851 metrics={'f1_val': 0.93404964149986, 'auprc': 0.9993396649015316, 'loss_val': 0.15016318059292127, 'psi': 0.9601656508605287}-{'f1_val': 0.7700157369806525, 'auprc': 0.9141279216648657, 'loss_val': 0.5740259169508315, 'psi': 0.8276606108543377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=47 head_norm_before_train=2.033543 (no previous merge yet)
[S16] round=47 local utility u=1.000000 metrics={'f1_val': 0.9914430642051142, 'auprc': 0.9914595142537741, 'loss_val': 0.04459238827581045, 'psi': 0.9914496442245782}-{'f1_val': 0.8481039388218973, 'auprc': 0.9079499780750035, 'loss_val': 0.9803503049943258, 'psi': 0.8720423545231398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=47 head_norm_before_train=1.676197 cos_to_last_merge=0.9024 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.902
[S17] round=47 local utility u=0.013766 metrics={'f1_val': 0.6745144031016985, 'auprc': 0.8175933640771911, 'loss_val': 1.2311369309606601, 'psi': 0.7317459874918956}-{'f1_val': 0.6729349799721467, 'auprc': 0.8139786093285719, 'loss_val': 1.2383473147819963, 'psi': 0.7293524317147169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=48 head_norm_before_train=1.656921 cos_to_last_merge=0.9151 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.915
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7186554331816538, 'auprc': 0.7563629788753937, 'loss_val': 0.8929697516675176, 'psi': 0.7337384514591498}-{'f1_val': 0.7187283724004877, 'auprc': 0.74532452267984, 'loss_val': 0.8529463956153142, 'psi': 0.7293668325122287}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.936368 cos_to_last_merge=0.9484 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=48 local utility u=0.031726 metrics={'f1_val': 0.9874783527983229, 'auprc': 0.9992146528171034, 'loss_val': 0.054796358409214645, 'psi': 0.992172872805835}-{'f1_val': 0.9764875287483505, 'auprc': 0.9995380650105172, 'loss_val': 0.053273192382387015, 'psi': 0.9857077432532172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=48 head_norm_before_train=1.805851 cos_to_last_merge=0.7686 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.769
[S4] round=48 local utility u=0.006660 metrics={'f1_val': 0.9476809805421745, 'auprc': 0.9766250507545586, 'loss_val': 0.2789819873174397, 'psi': 0.9592586086271282}-{'f1_val': 0.9490096889020533, 'auprc': 0.9699538152924335, 'loss_val': 0.2802597299117537, 'psi': 0.9573873394582054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=48 head_norm_before_train=1.440391 cos_to_last_merge=0.8481 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.848
[S5] round=48 local utility u=0.807954 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9902729105477023, 'loss_val': 0.23303459129479262, 'psi': 0.8164051411003723}-{'f1_val': 0.5804650123441957, 'auprc': 0.8396511958714601, 'loss_val': 0.6769086731939539, 'psi': 0.6841394857551015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=48 head_norm_before_train=1.652330 cos_to_last_merge=0.8383 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=48 local utility u=0.452217 metrics={'f1_val': 0.7358143770488164, 'auprc': 0.9427664800432173, 'loss_val': 0.7070920556364656, 'psi': 0.8185952182465768}-{'f1_val': 0.6246352764406292, 'auprc': 0.9359192478928873, 'loss_val': 0.9239105876656477, 'psi': 0.7491488650215326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=48 head_norm_before_train=1.760924 (no previous merge yet)
[S7] round=48 local utility u=0.167841 metrics={'f1_val': 0.6195836212161032, 'auprc': 0.7946383373396002, 'loss_val': 0.5783340736396089, 'psi': 0.6896055076655021}-{'f1_val': 0.5809011699797435, 'auprc': 0.7852263116792668, 'loss_val': 0.6536851899200529, 'psi': 0.6626312266595529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=48 head_norm_before_train=1.800920 cos_to_last_merge=0.9542 (last merge round=15)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9905759849775806, 'auprc': 0.9987519529093727, 'loss_val': 0.03688193759597434, 'psi': 0.9938463721502975}-{'f1_val': 0.9943863538992247, 'auprc': 0.9996812471138079, 'loss_val': 0.03558932021203047, 'psi': 0.996504311185058}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.952936 cos_to_last_merge=0.7996 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9984608968179933, 'loss_val': 0.030748718612807317, 'psi': 0.9937154819357933}-{'f1_val': 0.9959957888192151, 'auprc': 0.9984793742609512, 'loss_val': 0.02182477780681451, 'psi': 0.9969892229959095}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.874891 cos_to_last_merge=0.8668 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.867
[S10] round=48 local utility u=0.000905 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929450938858235, 'loss_val': 0.028587675239227783, 'psi': 0.9942907409659543}-{'f1_val': 0.9951878390193748, 'auprc': 0.9924454093135548, 'loss_val': 0.028899066200672386, 'psi': 0.9940908671370468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=48 head_norm_before_train=1.762528 cos_to_last_merge=0.9020 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=48 local utility u=0.004342 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998785963840529, 'loss_val': 0.024091253807156772, 'psi': 0.9971945904841972}-{'f1_val': 0.9961336749133093, 'auprc': 0.9987295198468165, 'loss_val': 0.03260508654452755, 'psi': 0.9971720128867122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=48 head_norm_before_train=1.440895 cos_to_last_merge=0.9079 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.908
[S13] round=48 local utility u=0.174851 metrics={'f1_val': 0.6441151971517755, 'auprc': 0.7437069346365195, 'loss_val': 0.6209370636106105, 'psi': 0.6839518921456731}-{'f1_val': 0.6136945256804951, 'auprc': 0.7609441887945532, 'loss_val': 0.8398262958191602, 'psi': 0.6725943909261183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=48 head_norm_before_train=1.868743 cos_to_last_merge=0.9548 (last merge round=16)
[S14] round=48 local utility u=0.049278 metrics={'f1_val': 0.9951309379239566, 'auprc': 0.9988555611918597, 'loss_val': 0.02550484350890885, 'psi': 0.9966207872311178}-{'f1_val': 0.9810902640889714, 'auprc': 0.9992361755428212, 'loss_val': 0.04095868830115863, 'psi': 0.9883486286705112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=48 head_norm_before_train=1.817834 cos_to_last_merge=0.9566 (last merge round=16)
[S15] round=48 local utility u=0.250021 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9974732266095381, 'loss_val': 0.020703232898270644, 'psi': 0.9970372916763276}-{'f1_val': 0.93404964149986, 'auprc': 0.9993396649015316, 'loss_val': 0.15016318059292127, 'psi': 0.9601656508605287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=48 head_norm_before_train=2.039838 (no previous merge yet)
[S16] round=48 local utility u=0.008019 metrics={'f1_val': 0.992948220546797, 'auprc': 0.9917597034208445, 'loss_val': 0.038486242799261536, 'psi': 0.992472813696416}-{'f1_val': 0.9914430642051142, 'auprc': 0.9914595142537741, 'loss_val': 0.04459238827581045, 'psi': 0.9914496442245782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=48 head_norm_before_train=1.689507 cos_to_last_merge=0.9009 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6530918407316306, 'auprc': 0.7575612547888048, 'loss_val': 1.311807163793722, 'psi': 0.6948796063545003}-{'f1_val': 0.6745144031016985, 'auprc': 0.8175933640771911, 'loss_val': 1.2311369309606601, 'psi': 0.7317459874918956}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.664284 cos_to_last_merge=0.9141 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.914
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7201103021888824, 'auprc': 0.7384594894638916, 'loss_val': 0.8822106593476012, 'psi': 0.727449977098886}-{'f1_val': 0.7186554331816538, 'auprc': 0.7563629788753937, 'loss_val': 0.8929697516675176, 'psi': 0.7337384514591498}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.947376 cos_to_last_merge=0.9472 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.947
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9350344401992448, 'auprc': 0.9971250024488547, 'loss_val': 0.13864005931882498, 'psi': 0.9598706650990888}-{'f1_val': 0.9874783527983229, 'auprc': 0.9992146528171034, 'loss_val': 0.054796358409214645, 'psi': 0.992172872805835}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.808758 cos_to_last_merge=0.7682 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.768
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9423997916485323, 'auprc': 0.9449184935089705, 'loss_val': 0.293307329687747, 'psi': 0.9434072723927075}-{'f1_val': 0.9476809805421745, 'auprc': 0.9766250507545586, 'loss_val': 0.2789819873174397, 'psi': 0.9592586086271282}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.446942 cos_to_last_merge=0.8474 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.847
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.8736395453184521, 'loss_val': 0.37569295313179435, 'psi': 0.7696999639559419}-{'f1_val': 0.7004932948021524, 'auprc': 0.9902729105477023, 'loss_val': 0.23303459129479262, 'psi': 0.8164051411003723}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.662156 cos_to_last_merge=0.8370 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.837
[S6] round=49 local utility u=0.369507 metrics={'f1_val': 0.8223385636668652, 'auprc': 0.947269102856934, 'loss_val': 0.5007306000583222, 'psi': 0.8723107793428928}-{'f1_val': 0.7358143770488164, 'auprc': 0.9427664800432173, 'loss_val': 0.7070920556364656, 'psi': 0.8185952182465768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] sending update (kind=head size=1790 to 1 peers)
[S7] START round=49 head_norm_before_train=1.767888 (no previous merge yet)
[S7] round=49 local utility u=0.352666 metrics={'f1_val': 0.6747365212308895, 'auprc': 0.8374048951649105, 'loss_val': 0.3322184894075999, 'psi': 0.7398038708044978}-{'f1_val': 0.6195836212161032, 'auprc': 0.7946383373396002, 'loss_val': 0.5783340736396089, 'psi': 0.6896055076655021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=49 head_norm_before_train=1.809881 cos_to_last_merge=0.9534 (last merge round=15)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9762913981867902, 'auprc': 0.9975745643273901, 'loss_val': 0.05516449285197182, 'psi': 0.9848046646430302}-{'f1_val': 0.9905759849775806, 'auprc': 0.9987519529093727, 'loss_val': 0.03688193759597434, 'psi': 0.9938463721502975}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.960978 cos_to_last_merge=0.7989 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.799
[S9] round=49 local utility u=0.014482 metrics={'f1_val': 0.9943271883459407, 'auprc': 0.9984850981223499, 'loss_val': 0.02450884936138733, 'psi': 0.9959903522565043}-{'f1_val': 0.9905518720143266, 'auprc': 0.9984608968179933, 'loss_val': 0.030748718612807317, 'psi': 0.9937154819357933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=49 head_norm_before_train=1.883259 cos_to_last_merge=0.8660 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.866
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921904491908855, 'loss_val': 0.028517860393293095, 'psi': 0.9939888830879791}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929450938858235, 'loss_val': 0.028587675239227783, 'psi': 0.9942907409659543}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.772107 cos_to_last_merge=0.9009 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9922992176464547, 'auprc': 0.9987517922708526, 'loss_val': 0.030827454670228457, 'psi': 0.9948802474962138}-{'f1_val': 0.9961336749133093, 'auprc': 0.998785963840529, 'loss_val': 0.024091253807156772, 'psi': 0.9971945904841972}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.449868 cos_to_last_merge=0.9069 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.907
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.618743601847373, 'auprc': 0.7873351387046986, 'loss_val': 0.97178150845724, 'psi': 0.6861802165903033}-{'f1_val': 0.6441151971517755, 'auprc': 0.7437069346365195, 'loss_val': 0.6209370636106105, 'psi': 0.6839518921456731}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.876245 cos_to_last_merge=0.9542 (last merge round=16)
[S14] round=49 local utility u=0.012033 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.9988536208132106, 'loss_val': 0.018904289653166817, 'psi': 0.9983670914393391}-{'f1_val': 0.9951309379239566, 'auprc': 0.9988555611918597, 'loss_val': 0.02550484350890885, 'psi': 0.9966207872311178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=49 head_norm_before_train=1.827684 cos_to_last_merge=0.9557 (last merge round=16)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9061423356279148, 'auprc': 0.9970525232782824, 'loss_val': 0.09755828925961257, 'psi': 0.9425064106880618}-{'f1_val': 0.9967466683875206, 'auprc': 0.9974732266095381, 'loss_val': 0.020703232898270644, 'psi': 0.9970372916763276}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=2.047145 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9223583250975455, 'auprc': 0.910427294706317, 'loss_val': 0.4901984386757496, 'psi': 0.917585912941054}-{'f1_val': 0.992948220546797, 'auprc': 0.9917597034208445, 'loss_val': 0.038486242799261536, 'psi': 0.992472813696416}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.700143 cos_to_last_merge=0.8998 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.900
[S17] round=49 local utility u=0.235594 metrics={'f1_val': 0.6781090271373582, 'auprc': 0.8347883261377791, 'loss_val': 1.2224040105929501, 'psi': 0.7407807467375266}-{'f1_val': 0.6530918407316306, 'auprc': 0.7575612547888048, 'loss_val': 1.311807163793722, 'psi': 0.6948796063545003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=50 head_norm_before_train=1.673155 cos_to_last_merge=0.9127 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.913
[S2] round=50 local utility u=0.010302 metrics={'f1_val': 0.7198204826185411, 'auprc': 0.7461416582547677, 'loss_val': 0.8829141904376749, 'psi': 0.7303489528730318}-{'f1_val': 0.7201103021888824, 'auprc': 0.7384594894638916, 'loss_val': 0.8822106593476012, 'psi': 0.727449977098886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=50 head_norm_before_train=1.958426 cos_to_last_merge=0.9460 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=50 local utility u=0.155266 metrics={'f1_val': 0.975517250418979, 'auprc': 0.9991824760065553, 'loss_val': 0.07717752805796944, 'psi': 0.9849833406540095}-{'f1_val': 0.9350344401992448, 'auprc': 0.9971250024488547, 'loss_val': 0.13864005931882498, 'psi': 0.9598706650990888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=50 head_norm_before_train=1.814695 cos_to_last_merge=0.7675 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.767
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.8297350918278362, 'auprc': 0.9002944428632413, 'loss_val': 0.44648082734530087, 'psi': 0.8579588322419983}-{'f1_val': 0.9423997916485323, 'auprc': 0.9449184935089705, 'loss_val': 0.293307329687747, 'psi': 0.9434072723927075}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.454259 cos_to_last_merge=0.8465 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.846
[S5] round=50 local utility u=0.224391 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9902860354636345, 'loss_val': 0.2768551745651645, 'psi': 0.816358947117382}-{'f1_val': 0.7004069097142683, 'auprc': 0.8736395453184521, 'loss_val': 0.37569295313179435, 'psi': 0.7696999639559419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=50 head_norm_before_train=1.676980 cos_to_last_merge=0.8352 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.835
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.8099908420757325, 'auprc': 0.9511959961128128, 'loss_val': 0.5073739616134294, 'psi': 0.8664729036905646}-{'f1_val': 0.8223385636668652, 'auprc': 0.947269102856934, 'loss_val': 0.5007306000583222, 'psi': 0.8723107793428928}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=50 head_norm_before_train=1.775172 (no previous merge yet)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.4865429355591231, 'auprc': 0.781597042895551, 'loss_val': 1.1498541470801127, 'psi': 0.6045645784936942}-{'f1_val': 0.6747365212308895, 'auprc': 0.8374048951649105, 'loss_val': 0.3322184894075999, 'psi': 0.7398038708044978}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=1.818893 cos_to_last_merge=0.9528 (last merge round=15)
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.983853942658719, 'auprc': 0.9856628818508797, 'loss_val': 0.06988233961088156, 'psi': 0.9845775183355833}-{'f1_val': 0.9762913981867902, 'auprc': 0.9975745643273901, 'loss_val': 0.05516449285197182, 'psi': 0.9848046646430302}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=50 head_norm_before_train=1.966866 cos_to_last_merge=0.7980 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.798
[S9] round=50 local utility u=0.003244 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9953118249366171, 'loss_val': 0.020998702472237042, 'psi': 0.9959708413749794}-{'f1_val': 0.9943271883459407, 'auprc': 0.9984850981223499, 'loss_val': 0.02450884936138733, 'psi': 0.9959903522565043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=50 head_norm_before_train=1.891732 cos_to_last_merge=0.8651 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.865
[S10] round=50 local utility u=0.002077 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934734260629977, 'loss_val': 0.02821181499212068, 'psi': 0.994502073836824}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921904491908855, 'loss_val': 0.028517860393293095, 'psi': 0.9939888830879791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=50 head_norm_before_train=1.782127 cos_to_last_merge=0.8998 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.900
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9881957623940799, 'auprc': 0.9986407273365603, 'loss_val': 0.05039143441038861, 'psi': 0.9923737483710722}-{'f1_val': 0.9922992176464547, 'auprc': 0.9987517922708526, 'loss_val': 0.030827454670228457, 'psi': 0.9948802474962138}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.458941 cos_to_last_merge=0.9060 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.906
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.5800306427564718, 'auprc': 0.775592795445827, 'loss_val': 0.9246326388282329, 'psi': 0.6582555038322139}-{'f1_val': 0.618743601847373, 'auprc': 0.7873351387046986, 'loss_val': 0.97178150845724, 'psi': 0.6861802165903033}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=1.884146 cos_to_last_merge=0.9536 (last merge round=16)
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9970933966257663, 'loss_val': 0.019809224982331383, 'psi': 0.9972708337760449}-{'f1_val': 0.9980427385234248, 'auprc': 0.9988536208132106, 'loss_val': 0.018904289653166817, 'psi': 0.9983670914393391}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=50 head_norm_before_train=1.837526 cos_to_last_merge=0.9548 (last merge round=16)
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.9009136400069071, 'auprc': 0.9956970810854221, 'loss_val': 0.25233856759690143, 'psi': 0.9388270164383131}-{'f1_val': 0.9061423356279148, 'auprc': 0.9970525232782824, 'loss_val': 0.09755828925961257, 'psi': 0.9425064106880618}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=2.048611 (no previous merge yet)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.851956326297304, 'auprc': 0.8871355048810233, 'loss_val': 1.0056154357568803, 'psi': 0.8660279977307918}-{'f1_val': 0.9223583250975455, 'auprc': 0.910427294706317, 'loss_val': 0.4901984386757496, 'psi': 0.917585912941054}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.710121 cos_to_last_merge=0.8988 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.899
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6708107799445242, 'auprc': 0.8271982836912459, 'loss_val': 1.2781903689985687, 'psi': 0.7333657814432128}-{'f1_val': 0.6781090271373582, 'auprc': 0.8347883261377791, 'loss_val': 1.2224040105929501, 'psi': 0.7407807467375266}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=1.681199 cos_to_last_merge=0.9115 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.912
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.7197122862425902, 'auprc': 0.7410213831726267, 'loss_val': 0.8845886588657484, 'psi': 0.7282359250146049}-{'f1_val': 0.7198204826185411, 'auprc': 0.7461416582547677, 'loss_val': 0.8829141904376749, 'psi': 0.7303489528730318}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=1.970380 cos_to_last_merge=0.9447 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.9335545064337779, 'auprc': 0.988982278196396, 'loss_val': 0.19160070902953746, 'psi': 0.9557256151388251}-{'f1_val': 0.975517250418979, 'auprc': 0.9991824760065553, 'loss_val': 0.07717752805796944, 'psi': 0.9849833406540095}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.818059 cos_to_last_merge=0.7668 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.767
[S4] round=51 local utility u=0.480705 metrics={'f1_val': 0.9428382360994008, 'auprc': 0.9429228117900289, 'loss_val': 0.291574585606401, 'psi': 0.942872066375652}-{'f1_val': 0.8297350918278362, 'auprc': 0.9002944428632413, 'loss_val': 0.44648082734530087, 'psi': 0.8579588322419983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=51 head_norm_before_train=1.460731 cos_to_last_merge=0.8452 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.6789063459345933, 'auprc': 0.8535027512519022, 'loss_val': 0.43875359686683024, 'psi': 0.748744908061517}-{'f1_val': 0.700407554886547, 'auprc': 0.9902860354636345, 'loss_val': 0.2768551745651645, 'psi': 0.816358947117382}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.687612 cos_to_last_merge=0.8341 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.834
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.7665946464008785, 'auprc': 0.9438317258227819, 'loss_val': 0.6588930089389274, 'psi': 0.8374894781696398}-{'f1_val': 0.8099908420757325, 'auprc': 0.9511959961128128, 'loss_val': 0.5073739616134294, 'psi': 0.8664729036905646}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.778948 (no previous merge yet)
[S7] round=51 local utility u=1.000000 metrics={'f1_val': 0.7983193599637934, 'auprc': 0.9301280592763191, 'loss_val': 0.19460284878749823, 'psi': 0.8510428396888037}-{'f1_val': 0.4865429355591231, 'auprc': 0.781597042895551, 'loss_val': 1.1498541470801127, 'psi': 0.6045645784936942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=51 head_norm_before_train=1.827251 cos_to_last_merge=0.9523 (last merge round=15)
[S8] round=51 local utility u=0.063973 metrics={'f1_val': 0.9920215160826699, 'auprc': 0.9995731135683513, 'loss_val': 0.03267337944549227, 'psi': 0.9950421550769425}-{'f1_val': 0.983853942658719, 'auprc': 0.9856628818508797, 'loss_val': 0.06988233961088156, 'psi': 0.9845775183355833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=51 head_norm_before_train=1.974465 cos_to_last_merge=0.7972 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9942353879582231, 'loss_val': 0.020449903138329402, 'psi': 0.9955402665836217}-{'f1_val': 0.9964101856672208, 'auprc': 0.9953118249366171, 'loss_val': 0.020998702472237042, 'psi': 0.9959708413749794}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=1.900190 cos_to_last_merge=0.8642 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.864
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9920800675671682, 'loss_val': 0.028614406317806727, 'psi': 0.9936954490364706}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934734260629977, 'loss_val': 0.02821181499212068, 'psi': 0.994502073836824}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=1.791958 cos_to_last_merge=0.8988 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.899
[S11] round=51 local utility u=0.005666 metrics={'f1_val': 0.9893804692398428, 'auprc': 0.9985480860305171, 'loss_val': 0.045890689255673696, 'psi': 0.9930475159561125}-{'f1_val': 0.9881957623940799, 'auprc': 0.9986407273365603, 'loss_val': 0.05039143441038861, 'psi': 0.9923737483710722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=51 head_norm_before_train=1.464663 cos_to_last_merge=0.9056 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.906
[S13] round=51 local utility u=0.424616 metrics={'f1_val': 0.6812677444603267, 'auprc': 0.7621315303621724, 'loss_val': 0.642439749069174, 'psi': 0.713613258821065}-{'f1_val': 0.5800306427564718, 'auprc': 0.775592795445827, 'loss_val': 0.9246326388282329, 'psi': 0.6582555038322139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=51 head_norm_before_train=1.893271 cos_to_last_merge=0.9530 (last merge round=16)
[S14] round=51 local utility u=0.000678 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9978221184010662, 'loss_val': 0.02063969921472289, 'psi': 0.9975623224861647}-{'f1_val': 0.9973891252095638, 'auprc': 0.9970933966257663, 'loss_val': 0.019809224982331383, 'psi': 0.9972708337760449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=51 head_norm_before_train=1.847539 cos_to_last_merge=0.9539 (last merge round=16)
[S15] round=51 local utility u=0.223628 metrics={'f1_val': 0.943730532135611, 'auprc': 0.9968831114395496, 'loss_val': 0.06554162945178302, 'psi': 0.9649915638571864}-{'f1_val': 0.9009136400069071, 'auprc': 0.9956970810854221, 'loss_val': 0.25233856759690143, 'psi': 0.9388270164383131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=51 head_norm_before_train=2.053983 (no previous merge yet)
[S16] round=51 local utility u=0.535714 metrics={'f1_val': 0.8946789376265482, 'auprc': 0.9975373319890097, 'loss_val': 0.5217290279216932, 'psi': 0.9358222953715327}-{'f1_val': 0.851956326297304, 'auprc': 0.8871355048810233, 'loss_val': 1.0056154357568803, 'psi': 0.8660279977307918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=51 head_norm_before_train=1.721888 cos_to_last_merge=0.8976 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.898
[S17] round=51 local utility u=0.174732 metrics={'f1_val': 0.6928837167958796, 'auprc': 0.8420636078556835, 'loss_val': 1.105760402186529, 'psi': 0.7525556732198011}-{'f1_val': 0.6708107799445242, 'auprc': 0.8271982836912459, 'loss_val': 1.2781903689985687, 'psi': 0.7333657814432128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=52 head_norm_before_train=1.691278 cos_to_last_merge=0.9101 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.910
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.6531844584855088, 'auprc': 0.7571856986440126, 'loss_val': 0.8817800088872472, 'psi': 0.6947849545489103}-{'f1_val': 0.7197122862425902, 'auprc': 0.7410213831726267, 'loss_val': 0.8845886588657484, 'psi': 0.7282359250146049}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=1.981593 cos_to_last_merge=0.9435 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=52 local utility u=0.156004 metrics={'f1_val': 0.9612927942165166, 'auprc': 0.999482750278519, 'loss_val': 0.07752357755675231, 'psi': 0.9765687766413176}-{'f1_val': 0.9335545064337779, 'auprc': 0.988982278196396, 'loss_val': 0.19160070902953746, 'psi': 0.9557256151388251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=52 head_norm_before_train=1.821778 cos_to_last_merge=0.7662 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.766
[S4] round=52 local utility u=0.008046 metrics={'f1_val': 0.9431676093858792, 'auprc': 0.9462855585691827, 'loss_val': 0.28754717498212073, 'psi': 0.9444147890592005}-{'f1_val': 0.9428382360994008, 'auprc': 0.9429228117900289, 'loss_val': 0.291574585606401, 'psi': 0.942872066375652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=52 head_norm_before_train=1.466039 cos_to_last_merge=0.8444 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.844
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.6496005024834814, 'auprc': 0.8535731277723827, 'loss_val': 0.49955394207744047, 'psi': 0.731189552599042}-{'f1_val': 0.6789063459345933, 'auprc': 0.8535027512519022, 'loss_val': 0.43875359686683024, 'psi': 0.748744908061517}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=52 head_norm_before_train=1.697123 cos_to_last_merge=0.8327 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.833
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.6175636349197473, 'auprc': 0.7904691806210572, 'loss_val': 0.9638289876330406, 'psi': 0.6867258532002714}-{'f1_val': 0.7665946464008785, 'auprc': 0.9438317258227819, 'loss_val': 0.6588930089389274, 'psi': 0.8374894781696398}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.781383 (no previous merge yet)
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.5768174334546543, 'auprc': 0.7849992592989258, 'loss_val': 0.7822436005166827, 'psi': 0.6600901637923628}-{'f1_val': 0.7983193599637934, 'auprc': 0.9301280592763191, 'loss_val': 0.19460284878749823, 'psi': 0.8510428396888037}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=52 head_norm_before_train=1.833787 cos_to_last_merge=0.9519 (last merge round=15)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.8407160618222025, 'auprc': 0.9994700292695192, 'loss_val': 0.27006439979680963, 'psi': 0.9042176488011291}-{'f1_val': 0.9920215160826699, 'auprc': 0.9995731135683513, 'loss_val': 0.03267337944549227, 'psi': 0.9950421550769425}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=1.983228 cos_to_last_merge=0.7966 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=52 local utility u=0.002463 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984805454873326, 'loss_val': 0.02325699856533355, 'psi': 0.9967380535254418}-{'f1_val': 0.9964101856672208, 'auprc': 0.9942353879582231, 'loss_val': 0.020449903138329402, 'psi': 0.9955402665836217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=52 head_norm_before_train=1.907131 cos_to_last_merge=0.8636 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.864
[S10] round=52 local utility u=0.001506 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921122883985951, 'loss_val': 0.02819195178228859, 'psi': 0.9939576187710628}-{'f1_val': 0.9947723700160056, 'auprc': 0.9920800675671682, 'loss_val': 0.028614406317806727, 'psi': 0.9936954490364706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=52 head_norm_before_train=1.801757 cos_to_last_merge=0.8978 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.898
[S11] round=52 local utility u=0.032501 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9982439023691458, 'loss_val': 0.021525260274360896, 'psi': 0.9970806614289749}-{'f1_val': 0.9893804692398428, 'auprc': 0.9985480860305171, 'loss_val': 0.045890689255673696, 'psi': 0.9930475159561125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=52 head_norm_before_train=1.469302 cos_to_last_merge=0.9051 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.905
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6341822414112916, 'auprc': 0.7785597719419506, 'loss_val': 0.7795405397797266, 'psi': 0.6919332536235552}-{'f1_val': 0.6812677444603267, 'auprc': 0.7621315303621724, 'loss_val': 0.642439749069174, 'psi': 0.713613258821065}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=1.897108 cos_to_last_merge=0.9525 (last merge round=16)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9674680229327013, 'auprc': 0.9988540903295868, 'loss_val': 0.06045166094975114, 'psi': 0.9800224498914556}-{'f1_val': 0.9973891252095638, 'auprc': 0.9978221184010662, 'loss_val': 0.02063969921472289, 'psi': 0.9975623224861647}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=1.857083 cos_to_last_merge=0.9531 (last merge round=16)
[S15] round=52 local utility u=0.067599 metrics={'f1_val': 0.9641301409518149, 'auprc': 0.9979052969661152, 'loss_val': 0.05580752147820787, 'psi': 0.9776402033575351}-{'f1_val': 0.943730532135611, 'auprc': 0.9968831114395496, 'loss_val': 0.06554162945178302, 'psi': 0.9649915638571864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=52 head_norm_before_train=2.061324 (no previous merge yet)
[S16] round=52 local utility u=0.176992 metrics={'f1_val': 0.929476362378166, 'auprc': 0.9974531844989726, 'loss_val': 0.3762772994703482, 'psi': 0.9566670912264886}-{'f1_val': 0.8946789376265482, 'auprc': 0.9975373319890097, 'loss_val': 0.5217290279216932, 'psi': 0.9358222953715327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=52 head_norm_before_train=1.736003 cos_to_last_merge=0.8961 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.896
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.6807888347152576, 'auprc': 0.8351022467325253, 'loss_val': 1.2486707954229803, 'psi': 0.7425141995221647}-{'f1_val': 0.6928837167958796, 'auprc': 0.8420636078556835, 'loss_val': 1.105760402186529, 'psi': 0.7525556732198011}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=1.702154 cos_to_last_merge=0.9085 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.909
[S2] round=53 local utility u=0.065514 metrics={'f1_val': 0.6639557628125329, 'auprc': 0.7616363929752459, 'loss_val': 0.8287322444669191, 'psi': 0.703028014877618}-{'f1_val': 0.6531844584855088, 'auprc': 0.7571856986440126, 'loss_val': 0.8817800088872472, 'psi': 0.6947849545489103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=53 head_norm_before_train=1.991885 cos_to_last_merge=0.9425 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=53 local utility u=0.136998 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9994707763580855, 'loss_val': 0.020297678796669313, 'psi': 0.9982445881151687}-{'f1_val': 0.9612927942165166, 'auprc': 0.999482750278519, 'loss_val': 0.07752357755675231, 'psi': 0.9765687766413176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=53 head_norm_before_train=1.826560 cos_to_last_merge=0.7655 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.766
[S4] round=53 local utility u=0.037590 metrics={'f1_val': 0.9490392943489836, 'auprc': 0.9589201947990219, 'loss_val': 0.2855002318020346, 'psi': 0.9529916545289989}-{'f1_val': 0.9431676093858792, 'auprc': 0.9462855585691827, 'loss_val': 0.28754717498212073, 'psi': 0.9444147890592005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=53 head_norm_before_train=1.471444 cos_to_last_merge=0.8432 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.843
[S5] round=53 local utility u=1.000000 metrics={'f1_val': 0.9699349429752493, 'auprc': 0.9849995403221844, 'loss_val': 0.17824872514012463, 'psi': 0.9759607819140234}-{'f1_val': 0.6496005024834814, 'auprc': 0.8535731277723827, 'loss_val': 0.49955394207744047, 'psi': 0.731189552599042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=53 head_norm_before_train=1.707412 cos_to_last_merge=0.8318 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.832
[S6] round=53 local utility u=1.000000 metrics={'f1_val': 0.9504200053786889, 'auprc': 0.9618719419940758, 'loss_val': 0.2547068428662384, 'psi': 0.9550007800248436}-{'f1_val': 0.6175636349197473, 'auprc': 0.7904691806210572, 'loss_val': 0.9638289876330406, 'psi': 0.6867258532002714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=53 head_norm_before_train=1.782544 (no previous merge yet)
[S7] round=53 local utility u=1.000000 metrics={'f1_val': 0.9209358162034926, 'auprc': 0.9109814609358868, 'loss_val': 0.22427293397887343, 'psi': 0.9169540740964502}-{'f1_val': 0.5768174334546543, 'auprc': 0.7849992592989258, 'loss_val': 0.7822436005166827, 'psi': 0.6600901637923628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=53 head_norm_before_train=1.841493 cos_to_last_merge=0.9514 (last merge round=15)
[S8] round=53 local utility u=0.574733 metrics={'f1_val': 0.992449403539837, 'auprc': 0.9995823585005505, 'loss_val': 0.0313361530553126, 'psi': 0.9953025855241224}-{'f1_val': 0.8407160618222025, 'auprc': 0.9994700292695192, 'loss_val': 0.27006439979680963, 'psi': 0.9042176488011291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=53 head_norm_before_train=1.991089 cos_to_last_merge=0.7960 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.796
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.9987171821760674, 'loss_val': 0.03400694044497208, 'psi': 0.9935647373543042}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984805454873326, 'loss_val': 0.02325699856533355, 'psi': 0.9967380535254418}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=1.912513 cos_to_last_merge=0.8632 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.863
[S10] round=53 local utility u=0.000199 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.992161563368652, 'loss_val': 0.027941412845168583, 'psi': 0.9939773287590856}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921122883985951, 'loss_val': 0.02819195178228859, 'psi': 0.9939576187710628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=53 head_norm_before_train=1.810694 cos_to_last_merge=0.8969 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.897
[S11] round=53 local utility u=0.001474 metrics={'f1_val': 0.9963070332985724, 'auprc': 0.9986903968974593, 'loss_val': 0.019927037605839422, 'psi': 0.9972603787381271}-{'f1_val': 0.996305167468861, 'auprc': 0.9982439023691458, 'loss_val': 0.021525260274360896, 'psi': 0.9970806614289749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=53 head_norm_before_train=1.475774 cos_to_last_merge=0.9043 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.904
[S13] round=53 local utility u=0.081747 metrics={'f1_val': 0.6487783031970744, 'auprc': 0.7668333814789643, 'loss_val': 0.6684434278320447, 'psi': 0.6960003345098305}-{'f1_val': 0.6341822414112916, 'auprc': 0.7785597719419506, 'loss_val': 0.7795405397797266, 'psi': 0.6919332536235552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=53 head_norm_before_train=1.900836 cos_to_last_merge=0.9521 (last merge round=16)
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.9396150245427278, 'auprc': 0.9975355121563578, 'loss_val': 0.12046450496006827, 'psi': 0.9627832195881798}-{'f1_val': 0.9674680229327013, 'auprc': 0.9988540903295868, 'loss_val': 0.06045166094975114, 'psi': 0.9800224498914556}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=53 head_norm_before_train=1.866785 cos_to_last_merge=0.9522 (last merge round=16)
[S15] round=53 local utility u=0.091060 metrics={'f1_val': 0.9900168862174994, 'auprc': 0.9991052332471684, 'loss_val': 0.03260813737991906, 'psi': 0.993652225029367}-{'f1_val': 0.9641301409518149, 'auprc': 0.9979052969661152, 'loss_val': 0.05580752147820787, 'psi': 0.9776402033575351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=53 head_norm_before_train=2.069094 (no previous merge yet)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.8955926803755538, 'auprc': 0.9980197814005243, 'loss_val': 0.5147315694842128, 'psi': 0.936563520785542}-{'f1_val': 0.929476362378166, 'auprc': 0.9974531844989726, 'loss_val': 0.3762772994703482, 'psi': 0.9566670912264886}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.747543 cos_to_last_merge=0.8949 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.895
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.6403691428775998, 'auprc': 0.8365691767748374, 'loss_val': 1.3650251544368044, 'psi': 0.7188491564364949}-{'f1_val': 0.6807888347152576, 'auprc': 0.8351022467325253, 'loss_val': 1.2486707954229803, 'psi': 0.7425141995221647}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=1.715565 cos_to_last_merge=0.9066 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.907
[S2] round=54 local utility u=0.115663 metrics={'f1_val': 0.7151601327973858, 'auprc': 0.7468481874846356, 'loss_val': 0.8602683200010197, 'psi': 0.7278353546722857}-{'f1_val': 0.6639557628125329, 'auprc': 0.7616363929752459, 'loss_val': 0.8287322444669191, 'psi': 0.703028014877618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=54 head_norm_before_train=2.001743 cos_to_last_merge=0.9414 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9987256652755543, 'loss_val': 0.11135970040092462, 'psi': 0.9761594204509132}-{'f1_val': 0.9974271292865575, 'auprc': 0.9994707763580855, 'loss_val': 0.020297678796669313, 'psi': 0.9982445881151687}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=1.834980 cos_to_last_merge=0.7646 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.765
[S4] round=54 local utility u=0.009634 metrics={'f1_val': 0.954232242136366, 'auprc': 0.9544598963252181, 'loss_val': 0.28400982111594375, 'psi': 0.9543233038119069}-{'f1_val': 0.9490392943489836, 'auprc': 0.9589201947990219, 'loss_val': 0.2855002318020346, 'psi': 0.9529916545289989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=54 head_norm_before_train=1.476075 cos_to_last_merge=0.8420 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=54 local utility u=0.000000 metrics={'f1_val': 0.43173466366402913, 'auprc': 0.8560057442473797, 'loss_val': 1.3630811549455844, 'psi': 0.6014430958973693}-{'f1_val': 0.9699349429752493, 'auprc': 0.9849995403221844, 'loss_val': 0.17824872514012463, 'psi': 0.9759607819140234}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=54 head_norm_before_train=1.712751 cos_to_last_merge=0.8313 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.58834040867535, 'auprc': 0.8624779840248791, 'loss_val': 1.086235081939339, 'psi': 0.6979954388151617}-{'f1_val': 0.9504200053786889, 'auprc': 0.9618719419940758, 'loss_val': 0.2547068428662384, 'psi': 0.9550007800248436}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.787031 (no previous merge yet)
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.5760499982302667, 'auprc': 0.784566989624558, 'loss_val': 0.7970517783855202, 'psi': 0.6594567947879832}-{'f1_val': 0.9209358162034926, 'auprc': 0.9109814609358868, 'loss_val': 0.22427293397887343, 'psi': 0.9169540740964502}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.849420 cos_to_last_merge=0.9507 (last merge round=15)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9856853584178104, 'loss_val': 0.47674884605082396, 'psi': 0.8228176066058217}-{'f1_val': 0.992449403539837, 'auprc': 0.9995823585005505, 'loss_val': 0.0313361530553126, 'psi': 0.9953025855241224}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=1.995343 cos_to_last_merge=0.7953 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=54 local utility u=0.021416 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9952871259681504, 'loss_val': 0.020068427395348414, 'psi': 0.996111157475595}-{'f1_val': 0.9901297741397954, 'auprc': 0.9987171821760674, 'loss_val': 0.03400694044497208, 'psi': 0.9935647373543042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=54 head_norm_before_train=1.919001 cos_to_last_merge=0.8627 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.863
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921485479925436, 'loss_val': 0.02791080648102569, 'psi': 0.9939721226086422}-{'f1_val': 0.9951878390193748, 'auprc': 0.992161563368652, 'loss_val': 0.027941412845168583, 'psi': 0.9939773287590856}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=1.816951 cos_to_last_merge=0.8961 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.896
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.9884929270252856, 'auprc': 0.9987239013591765, 'loss_val': 0.0651766524176055, 'psi': 0.9925853167588419}-{'f1_val': 0.9963070332985724, 'auprc': 0.9986903968974593, 'loss_val': 0.019927037605839422, 'psi': 0.9972603787381271}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=54 head_norm_before_train=1.481865 cos_to_last_merge=0.9035 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.904
[S13] round=54 local utility u=0.217344 metrics={'f1_val': 0.7246344418405093, 'auprc': 0.785484486505786, 'loss_val': 0.7448453303077388, 'psi': 0.7489744597066199}-{'f1_val': 0.6487783031970744, 'auprc': 0.7668333814789643, 'loss_val': 0.6684434278320447, 'psi': 0.6960003345098305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=54 head_norm_before_train=1.907423 cos_to_last_merge=0.9516 (last merge round=16)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9360900579952742, 'auprc': 0.9971578634836087, 'loss_val': 0.14218568481514082, 'psi': 0.9605171801906079}-{'f1_val': 0.9396150245427278, 'auprc': 0.9975355121563578, 'loss_val': 0.12046450496006827, 'psi': 0.9627832195881798}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=1.876191 cos_to_last_merge=0.9514 (last merge round=16)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.9030444739236343, 'auprc': 0.9975879835180522, 'loss_val': 0.1435059440227211, 'psi': 0.9408618777614015}-{'f1_val': 0.9900168862174994, 'auprc': 0.9991052332471684, 'loss_val': 0.03260813737991906, 'psi': 0.993652225029367}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=2.070745 (no previous merge yet)
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.8639376886424721, 'auprc': 0.9859772414855678, 'loss_val': 0.8068307741920987, 'psi': 0.9127535097797104}-{'f1_val': 0.8955926803755538, 'auprc': 0.9980197814005243, 'loss_val': 0.5147315694842128, 'psi': 0.936563520785542}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=54 head_norm_before_train=1.755856 cos_to_last_merge=0.8940 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.894
[S17] round=54 local utility u=0.295380 metrics={'f1_val': 0.6734829417092217, 'auprc': 0.8735994584615954, 'loss_val': 1.08403785294957, 'psi': 0.7535295484101712}-{'f1_val': 0.6403691428775998, 'auprc': 0.8365691767748374, 'loss_val': 1.3650251544368044, 'psi': 0.7188491564364949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=55 head_norm_before_train=1.729004 cos_to_last_merge=0.9047 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.905
[S2] round=55 local utility u=0.014198 metrics={'f1_val': 0.7185709051606113, 'auprc': 0.7646605513350142, 'loss_val': 0.9057737351921769, 'psi': 0.7370067636303724}-{'f1_val': 0.7151601327973858, 'auprc': 0.7468481874846356, 'loss_val': 0.8602683200010197, 'psi': 0.7278353546722857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=55 head_norm_before_train=2.009954 cos_to_last_merge=0.9406 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9554842649199782, 'auprc': 0.9944247692782249, 'loss_val': 0.1284587397544687, 'psi': 0.9710604666632768}-{'f1_val': 0.9611152572344858, 'auprc': 0.9987256652755543, 'loss_val': 0.11135970040092462, 'psi': 0.9761594204509132}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.844555 cos_to_last_merge=0.7635 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.763
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9485083517711486, 'auprc': 0.9536765412390935, 'loss_val': 0.29245450461798245, 'psi': 0.9505756275583265}-{'f1_val': 0.954232242136366, 'auprc': 0.9544598963252181, 'loss_val': 0.28400982111594375, 'psi': 0.9543233038119069}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.480055 cos_to_last_merge=0.8420 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=55 local utility u=1.000000 metrics={'f1_val': 0.6718171824320522, 'auprc': 0.9748877397302216, 'loss_val': 0.230497647385813, 'psi': 0.7930454053513201}-{'f1_val': 0.43173466366402913, 'auprc': 0.8560057442473797, 'loss_val': 1.3630811549455844, 'psi': 0.6014430958973693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=55 head_norm_before_train=1.716962 cos_to_last_merge=0.8306 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=55 local utility u=1.000000 metrics={'f1_val': 0.9299632449123229, 'auprc': 0.9675704842884992, 'loss_val': 0.25994536723194944, 'psi': 0.9450061406627934}-{'f1_val': 0.58834040867535, 'auprc': 0.8624779840248791, 'loss_val': 1.086235081939339, 'psi': 0.6979954388151617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=55 head_norm_before_train=1.789481 (no previous merge yet)
[S7] round=55 local utility u=0.515798 metrics={'f1_val': 0.667340667214637, 'auprc': 0.8161433765534374, 'loss_val': 0.4079279788792411, 'psi': 0.7268617509501571}-{'f1_val': 0.5760499982302667, 'auprc': 0.784566989624558, 'loss_val': 0.7970517783855202, 'psi': 0.6594567947879832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=55 head_norm_before_train=1.858427 cos_to_last_merge=0.9500 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.950
[S8] round=55 local utility u=1.000000 metrics={'f1_val': 0.9760142357181587, 'auprc': 0.9995698410310822, 'loss_val': 0.05665889442138099, 'psi': 0.9854364778433281}-{'f1_val': 0.7142391053978291, 'auprc': 0.9856853584178104, 'loss_val': 0.47674884605082396, 'psi': 0.8228176066058217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=55 head_norm_before_train=2.001073 cos_to_last_merge=0.7946 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9987292066750076, 'loss_val': 0.021831770540627956, 'psi': 0.996488335127836}-{'f1_val': 0.9966605118138915, 'auprc': 0.9952871259681504, 'loss_val': 0.020068427395348414, 'psi': 0.996111157475595}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=1.925796 cos_to_last_merge=0.8620 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.862
[S10] round=55 local utility u=0.000096 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921576028128779, 'loss_val': 0.027745339262190964, 'psi': 0.9939757445367761}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921485479925436, 'loss_val': 0.02791080648102569, 'psi': 0.9939721226086422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=55 head_norm_before_train=1.822474 cos_to_last_merge=0.8954 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.895
[S11] round=55 local utility u=0.026330 metrics={'f1_val': 0.9918218357885851, 'auprc': 0.9987825264320006, 'loss_val': 0.032665852510264104, 'psi': 0.9946061120459513}-{'f1_val': 0.9884929270252856, 'auprc': 0.9987239013591765, 'loss_val': 0.0651766524176055, 'psi': 0.9925853167588419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=55 head_norm_before_train=1.488666 cos_to_last_merge=0.9026 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.903
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.6546421545501285, 'auprc': 0.7633823470324868, 'loss_val': 0.6232365404619568, 'psi': 0.6981382315430719}-{'f1_val': 0.7246344418405093, 'auprc': 0.785484486505786, 'loss_val': 0.7448453303077388, 'psi': 0.7489744597066199}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=1.915357 cos_to_last_merge=0.9511 (last merge round=16)
[S14] round=55 local utility u=0.066600 metrics={'f1_val': 0.9504139876593508, 'auprc': 0.9978997094192854, 'loss_val': 0.0971551091563676, 'psi': 0.9694082763633246}-{'f1_val': 0.9360900579952742, 'auprc': 0.9971578634836087, 'loss_val': 0.14218568481514082, 'psi': 0.9605171801906079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=55 head_norm_before_train=1.884202 cos_to_last_merge=0.9506 (last merge round=16)
[S15] round=55 local utility u=0.344554 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981351809830777, 'loss_val': 0.018253371359161018, 'psi': 0.9973020734257434}-{'f1_val': 0.9030444739236343, 'auprc': 0.9975879835180522, 'loss_val': 0.1435059440227211, 'psi': 0.9408618777614015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=55 head_norm_before_train=2.071841 (no previous merge yet)
[S16] round=55 local utility u=0.731300 metrics={'f1_val': 0.9826941744934419, 'auprc': 0.9885054586437502, 'loss_val': 0.06435379474253855, 'psi': 0.9850186881535652}-{'f1_val': 0.8639376886424721, 'auprc': 0.9859772414855678, 'loss_val': 0.8068307741920987, 'psi': 0.9127535097797104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=55 head_norm_before_train=1.763567 cos_to_last_merge=0.8931 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.893
[S17] round=55 local utility u=0.256897 metrics={'f1_val': 0.7075218931695105, 'auprc': 0.8875553029423344, 'loss_val': 0.8163452345488763, 'psi': 0.77953525707864}-{'f1_val': 0.6734829417092217, 'auprc': 0.8735994584615954, 'loss_val': 1.08403785294957, 'psi': 0.7535295484101712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=56 head_norm_before_train=1.742136 cos_to_last_merge=0.9029 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.903
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.7187394899978918, 'auprc': 0.7320549407233343, 'loss_val': 0.9133752018051151, 'psi': 0.7240656702880688}-{'f1_val': 0.7185709051606113, 'auprc': 0.7646605513350142, 'loss_val': 0.9057737351921769, 'psi': 0.7370067636303724}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=2.018180 cos_to_last_merge=0.9398 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=56 local utility u=0.062416 metrics={'f1_val': 0.9646860512777722, 'auprc': 0.9994712680419273, 'loss_val': 0.07397722910565627, 'psi': 0.9786001379834343}-{'f1_val': 0.9554842649199782, 'auprc': 0.9944247692782249, 'loss_val': 0.1284587397544687, 'psi': 0.9710604666632768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=56 head_norm_before_train=1.847777 cos_to_last_merge=0.7629 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.763
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9445144404259966, 'auprc': 0.9561687574180261, 'loss_val': 0.2862888457775651, 'psi': 0.9491761672228084}-{'f1_val': 0.9485083517711486, 'auprc': 0.9536765412390935, 'loss_val': 0.29245450461798245, 'psi': 0.9505756275583265}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.482472 cos_to_last_merge=0.8418 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.6786018297732571, 'auprc': 0.8556219980832739, 'loss_val': 0.4521107668997792, 'psi': 0.7494098970972638}-{'f1_val': 0.6718171824320522, 'auprc': 0.9748877397302216, 'loss_val': 0.230497647385813, 'psi': 0.7930454053513201}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.720814 cos_to_last_merge=0.8309 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.8305787083086438, 'auprc': 0.9545168797818018, 'loss_val': 0.4708386742844942, 'psi': 0.880153976897907}-{'f1_val': 0.9299632449123229, 'auprc': 0.9675704842884992, 'loss_val': 0.25994536723194944, 'psi': 0.9450061406627934}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=56 head_norm_before_train=1.792765 (no previous merge yet)
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.6336614843498773, 'auprc': 0.7990505259102706, 'loss_val': 0.5596944047415693, 'psi': 0.6998171009740346}-{'f1_val': 0.667340667214637, 'auprc': 0.8161433765534374, 'loss_val': 0.4079279788792411, 'psi': 0.7268617509501571}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=1.864248 cos_to_last_merge=0.9494 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.9245607818534464, 'auprc': 0.9967329414659395, 'loss_val': 0.16206646546635703, 'psi': 0.9534296456984436}-{'f1_val': 0.9760142357181587, 'auprc': 0.9995698410310822, 'loss_val': 0.05665889442138099, 'psi': 0.9854364778433281}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=56 head_norm_before_train=2.002500 cos_to_last_merge=0.7944 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9908021981609972, 'auprc': 0.9988159075860826, 'loss_val': 0.03108635343932144, 'psi': 0.9940076819310313}-{'f1_val': 0.994994420763055, 'auprc': 0.9987292066750076, 'loss_val': 0.021831770540627956, 'psi': 0.996488335127836}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=1.932820 cos_to_last_merge=0.8613 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.861
[S10] round=56 local utility u=0.000628 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9925160956574723, 'loss_val': 0.02756415293708226, 'psi': 0.9941191416746138}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921576028128779, 'loss_val': 0.027745339262190964, 'psi': 0.9939757445367761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=56 head_norm_before_train=1.829142 cos_to_last_merge=0.8948 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.895
[S11] round=56 local utility u=0.020477 metrics={'f1_val': 0.9965478132675192, 'auprc': 0.9983515865891547, 'loss_val': 0.018775052082760008, 'psi': 0.9972693225961733}-{'f1_val': 0.9918218357885851, 'auprc': 0.9987825264320006, 'loss_val': 0.032665852510264104, 'psi': 0.9946061120459513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=56 head_norm_before_train=1.498780 cos_to_last_merge=0.9011 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.901
[S13] round=56 local utility u=0.192781 metrics={'f1_val': 0.7269530494572951, 'auprc': 0.7822282491496716, 'loss_val': 0.7280779897801593, 'psi': 0.7490631293342458}-{'f1_val': 0.6546421545501285, 'auprc': 0.7633823470324868, 'loss_val': 0.6232365404619568, 'psi': 0.6981382315430719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=56 head_norm_before_train=1.922437 cos_to_last_merge=0.9510 (last merge round=16)
[S14] round=56 local utility u=0.182226 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9988541519694886, 'loss_val': 0.019882182374363466, 'psi': 0.9982215950536628}-{'f1_val': 0.9504139876593508, 'auprc': 0.9978997094192854, 'loss_val': 0.0971551091563676, 'psi': 0.9694082763633246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=56 head_norm_before_train=1.891316 cos_to_last_merge=0.9500 (last merge round=16)
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.994204015060997, 'auprc': 0.999605047078508, 'loss_val': 0.02673379818316921, 'psi': 0.9963644278680013}-{'f1_val': 0.9967466683875206, 'auprc': 0.9981351809830777, 'loss_val': 0.018253371359161018, 'psi': 0.9973020734257434}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=2.076159 (no previous merge yet)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.9418202477255793, 'auprc': 0.9791773207922349, 'loss_val': 0.2625876426910853, 'psi': 0.9567630769522415}-{'f1_val': 0.9826941744934419, 'auprc': 0.9885054586437502, 'loss_val': 0.06435379474253855, 'psi': 0.9850186881535652}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=1.771704 cos_to_last_merge=0.8922 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.892
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.6807887498185584, 'auprc': 0.9135089572488224, 'loss_val': 0.9166509406034173, 'psi': 0.773876832790664}-{'f1_val': 0.7075218931695105, 'auprc': 0.8875553029423344, 'loss_val': 0.8163452345488763, 'psi': 0.77953525707864}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=57 head_norm_before_train=1.752710 cos_to_last_merge=0.9016 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=57 local utility u=0.015222 metrics={'f1_val': 0.7196041130186943, 'auprc': 0.7423025781267734, 'loss_val': 0.9188613465183827, 'psi': 0.728683499061926}-{'f1_val': 0.7187394899978918, 'auprc': 0.7320549407233343, 'loss_val': 0.9133752018051151, 'psi': 0.7240656702880688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=57 head_norm_before_train=2.025929 cos_to_last_merge=0.9390 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9993899669677604, 'loss_val': 0.1222201812247104, 'psi': 0.9760823105265723}-{'f1_val': 0.9646860512777722, 'auprc': 0.9994712680419273, 'loss_val': 0.07397722910565627, 'psi': 0.9786001379834343}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.843371 cos_to_last_merge=0.7632 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.763
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9402094116127269, 'auprc': 0.9282244095037271, 'loss_val': 0.3042700550239916, 'psi': 0.935415410769127}-{'f1_val': 0.9445144404259966, 'auprc': 0.9561687574180261, 'loss_val': 0.2862888457775651, 'psi': 0.9491761672228084}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.485107 cos_to_last_merge=0.8418 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=57 local utility u=0.382589 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9908683501274506, 'loss_val': 0.2229883391813404, 'psi': 0.8165401305113285}-{'f1_val': 0.6786018297732571, 'auprc': 0.8556219980832739, 'loss_val': 0.4521107668997792, 'psi': 0.7494098970972638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=57 head_norm_before_train=1.718978 cos_to_last_merge=0.8308 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.7641646807507964, 'auprc': 0.9288607771159365, 'loss_val': 0.6785629342894723, 'psi': 0.8300431192968525}-{'f1_val': 0.8305787083086438, 'auprc': 0.9545168797818018, 'loss_val': 0.4708386742844942, 'psi': 0.880153976897907}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.795997 (no previous merge yet)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.620739320799924, 'auprc': 0.7949413571194733, 'loss_val': 0.6198953248050414, 'psi': 0.6904201353277437}-{'f1_val': 0.6336614843498773, 'auprc': 0.7990505259102706, 'loss_val': 0.5596944047415693, 'psi': 0.6998171009740346}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=1.866969 cos_to_last_merge=0.9492 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=57 local utility u=0.276935 metrics={'f1_val': 0.9943795289865018, 'auprc': 0.998263651777619, 'loss_val': 0.03170033063576973, 'psi': 0.9959331781029488}-{'f1_val': 0.9245607818534464, 'auprc': 0.9967329414659395, 'loss_val': 0.16206646546635703, 'psi': 0.9534296456984436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=57 head_norm_before_train=2.005385 cos_to_last_merge=0.7940 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=57 local utility u=0.013545 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9932887546701428, 'loss_val': 0.02010172981649433, 'psi': 0.9950655587356236}-{'f1_val': 0.9908021981609972, 'auprc': 0.9988159075860826, 'loss_val': 0.03108635343932144, 'psi': 0.9940076819310313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=57 head_norm_before_train=1.939888 cos_to_last_merge=0.8606 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.861
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921733203660039, 'loss_val': 0.027546049302284423, 'psi': 0.9939820315580263}-{'f1_val': 0.9951878390193748, 'auprc': 0.9925160956574723, 'loss_val': 0.02756415293708226, 'psi': 0.9941191416746138}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=57 head_norm_before_train=1.837131 cos_to_last_merge=0.8941 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.894
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983293690288487, 'loss_val': 0.01929047001935527, 'psi': 0.9972599503196933}-{'f1_val': 0.9965478132675192, 'auprc': 0.9983515865891547, 'loss_val': 0.018775052082760008, 'psi': 0.9972693225961733}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.507229 cos_to_last_merge=0.8998 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.900
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.6460089658178072, 'auprc': 0.7707943402939321, 'loss_val': 0.8150041084368322, 'psi': 0.6959231156082571}-{'f1_val': 0.7269530494572951, 'auprc': 0.7822282491496716, 'loss_val': 0.7280779897801593, 'psi': 0.7490631293342458}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=1.926222 cos_to_last_merge=0.9506 (last merge round=16)
[S14] round=57 local utility u=0.001430 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9991511050517371, 'loss_val': 0.017912848915382352, 'psi': 0.9983403762865622}-{'f1_val': 0.9977998904431125, 'auprc': 0.9988541519694886, 'loss_val': 0.019882182374363466, 'psi': 0.9982215950536628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=57 head_norm_before_train=1.898446 cos_to_last_merge=0.9494 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.7023150858049892, 'auprc': 0.9963702950636468, 'loss_val': 0.41694257053047584, 'psi': 0.8199371695084523}-{'f1_val': 0.994204015060997, 'auprc': 0.999605047078508, 'loss_val': 0.02673379818316921, 'psi': 0.9963644278680013}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=2.080993 (no previous merge yet)
[S16] round=57 local utility u=0.062347 metrics={'f1_val': 0.9478937220172706, 'auprc': 0.9775639274588039, 'loss_val': 0.16949358280070811, 'psi': 0.959761804193884}-{'f1_val': 0.9418202477255793, 'auprc': 0.9791773207922349, 'loss_val': 0.2625876426910853, 'psi': 0.9567630769522415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=57 head_norm_before_train=1.776324 cos_to_last_merge=0.8917 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.892
[S17] round=57 local utility u=0.146198 metrics={'f1_val': 0.7052578418266516, 'auprc': 0.9137466470183446, 'loss_val': 0.771782720735026, 'psi': 0.7886533639033289}-{'f1_val': 0.6807887498185584, 'auprc': 0.9135089572488224, 'loss_val': 0.9166509406034173, 'psi': 0.773876832790664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] sending update (kind=head size=1809 to 1 peers)
[S2] START round=58 head_norm_before_train=1.763980 cos_to_last_merge=0.9002 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.900
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.7186314988204078, 'auprc': 0.7343736841612083, 'loss_val': 0.9219199708179278, 'psi': 0.724928372956728}-{'f1_val': 0.7196041130186943, 'auprc': 0.7423025781267734, 'loss_val': 0.9188613465183827, 'psi': 0.728683499061926}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=2.033949 cos_to_last_merge=0.9382 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.7437350964572162, 'auprc': 0.9610150103420556, 'loss_val': 0.5977086152330388, 'psi': 0.8306470620111519}-{'f1_val': 0.9605438728991138, 'auprc': 0.9993899669677604, 'loss_val': 0.1222201812247104, 'psi': 0.9760823105265723}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.840409 cos_to_last_merge=0.7633 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.763
[S4] round=58 local utility u=0.036103 metrics={'f1_val': 0.9430381132465862, 'auprc': 0.9424192461553349, 'loss_val': 0.2916211142459734, 'psi': 0.9427905664100856}-{'f1_val': 0.9402094116127269, 'auprc': 0.9282244095037271, 'loss_val': 0.3042700550239916, 'psi': 0.935415410769127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=58 head_norm_before_train=1.485927 cos_to_last_merge=0.8412 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.8565169671620839, 'loss_val': 0.41267913699364345, 'psi': 0.7628513197967618}-{'f1_val': 0.7003213174339138, 'auprc': 0.9908683501274506, 'loss_val': 0.2229883391813404, 'psi': 0.8165401305113285}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.718588 cos_to_last_merge=0.8299 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.7263812808329115, 'auprc': 0.9268969904900697, 'loss_val': 0.7260368245851816, 'psi': 0.8065875646957748}-{'f1_val': 0.7641646807507964, 'auprc': 0.9288607771159365, 'loss_val': 0.6785629342894723, 'psi': 0.8300431192968525}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.802312 (no previous merge yet)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.6062643971275924, 'auprc': 0.7944333223411654, 'loss_val': 0.6993932199858702, 'psi': 0.6815319672130216}-{'f1_val': 0.620739320799924, 'auprc': 0.7949413571194733, 'loss_val': 0.6198953248050414, 'psi': 0.6904201353277437}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.871986 cos_to_last_merge=0.9488 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=58 local utility u=0.003606 metrics={'f1_val': 0.9946307902678028, 'auprc': 0.9992137546636075, 'loss_val': 0.028846046930201957, 'psi': 0.9964639760261247}-{'f1_val': 0.9943795289865018, 'auprc': 0.998263651777619, 'loss_val': 0.03170033063576973, 'psi': 0.9959331781029488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=58 head_norm_before_train=2.010688 cos_to_last_merge=0.7935 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=58 local utility u=0.004457 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9953171691158719, 'loss_val': 0.019735475109732184, 'psi': 0.9961231747346836}-{'f1_val': 0.9962500947792776, 'auprc': 0.9932887546701428, 'loss_val': 0.02010172981649433, 'psi': 0.9950655587356236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=58 head_norm_before_train=1.947024 cos_to_last_merge=0.8598 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.860
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921051519822256, 'loss_val': 0.02758157402733411, 'psi': 0.993954764204515}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921733203660039, 'loss_val': 0.027546049302284423, 'psi': 0.9939820315580263}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=1.845446 cos_to_last_merge=0.8932 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.893
[S11] round=58 local utility u=0.000172 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983500284423941, 'loss_val': 0.019008098528304207, 'psi': 0.9972682140851113}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983293690288487, 'loss_val': 0.01929047001935527, 'psi': 0.9972599503196933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=58 head_norm_before_train=1.515308 cos_to_last_merge=0.8987 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=58 local utility u=0.310723 metrics={'f1_val': 0.7252542314389273, 'auprc': 0.7734797642039293, 'loss_val': 0.6770855923312865, 'psi': 0.7445444445449281}-{'f1_val': 0.6460089658178072, 'auprc': 0.7707943402939321, 'loss_val': 0.8150041084368322, 'psi': 0.6959231156082571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=58 head_norm_before_train=1.929690 cos_to_last_merge=0.9500 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.950
[S14] round=58 local utility u=0.000000 metrics={'f1_val': 0.9919775121572035, 'auprc': 0.9992337824937132, 'loss_val': 0.030924122383593697, 'psi': 0.9948800202918073}-{'f1_val': 0.9977998904431125, 'auprc': 0.9991511050517371, 'loss_val': 0.017912848915382352, 'psi': 0.9983403762865622}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=58 head_norm_before_train=1.906000 cos_to_last_merge=0.9488 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=58 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985841278103812, 'loss_val': 0.017635852775022824, 'psi': 0.9974816521566648}-{'f1_val': 0.7023150858049892, 'auprc': 0.9963702950636468, 'loss_val': 0.41694257053047584, 'psi': 0.8199371695084523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=58 head_norm_before_train=2.084532 (no previous merge yet)
[S16] round=58 local utility u=0.215394 metrics={'f1_val': 0.9929586256997991, 'auprc': 0.986296287562735, 'loss_val': 0.0352927034150699, 'psi': 0.9902936904449735}-{'f1_val': 0.9478937220172706, 'auprc': 0.9775639274588039, 'loss_val': 0.16949358280070811, 'psi': 0.959761804193884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=58 head_norm_before_train=1.783343 cos_to_last_merge=0.8910 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.891
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6847531384517943, 'auprc': 0.9133250356806292, 'loss_val': 1.0173397705059808, 'psi': 0.7761818973433283}-{'f1_val': 0.7052578418266516, 'auprc': 0.9137466470183446, 'loss_val': 0.771782720735026, 'psi': 0.7886533639033289}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=1.775736 cos_to_last_merge=0.8986 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.899
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.6529320176797775, 'auprc': 0.7594679423497085, 'loss_val': 0.9250521298714295, 'psi': 0.6955463875477499}-{'f1_val': 0.7186314988204078, 'auprc': 0.7343736841612083, 'loss_val': 0.9219199708179278, 'psi': 0.724928372956728}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.696 u=0.0000 p_local=0.0205 f1=0.653 auprc=0.759 bytes=54029
[S3] START round=59 head_norm_before_train=2.041685 cos_to_last_merge=0.9374 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=59 local utility u=0.932989 metrics={'f1_val': 0.9533087160273793, 'auprc': 0.9986445124835476, 'loss_val': 0.10205995247343555, 'psi': 0.9714430346098466}-{'f1_val': 0.7437350964572162, 'auprc': 0.9610150103420556, 'loss_val': 0.5977086152330388, 'psi': 0.8306470620111519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S3] r=60 psi=0.971 u=0.9330 p_local=0.2163 f1=0.953 auprc=0.999 bytes=64813
[S4] START round=59 head_norm_before_train=1.837388 cos_to_last_merge=0.7634 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.763
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9406050194799215, 'auprc': 0.9323241720365154, 'loss_val': 0.3168454989317789, 'psi': 0.9372926805025591}-{'f1_val': 0.9430381132465862, 'auprc': 0.9424192461553349, 'loss_val': 0.2916211142459734, 'psi': 0.9427905664100856}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.937 u=0.0000 p_local=0.0278 f1=0.941 auprc=0.932 bytes=61157
[S5] START round=59 head_norm_before_train=1.493558 cos_to_last_merge=0.8397 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.4432351449342727, 'auprc': 0.8560015287678959, 'loss_val': 0.9347964667378924, 'psi': 0.608341698467722}-{'f1_val': 0.700407554886547, 'auprc': 0.8565169671620839, 'loss_val': 0.41267913699364345, 'psi': 0.7628513197967618}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.608 u=0.0000 p_local=0.2152 f1=0.443 auprc=0.856 bytes=57608
[S6] START round=59 head_norm_before_train=1.723376 cos_to_last_merge=0.8289 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.829
[S6] round=59 local utility u=0.591610 metrics={'f1_val': 0.8624244685020267, 'auprc': 0.94721145470858, 'loss_val': 0.4200192616643041, 'psi': 0.896339262984648}-{'f1_val': 0.7263812808329115, 'auprc': 0.9268969904900697, 'loss_val': 0.7260368245851816, 'psi': 0.8065875646957748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=60 psi=0.896 u=0.5916 p_local=0.2805 f1=0.862 auprc=0.947 bytes=50322
[S7] START round=59 head_norm_before_train=1.810577 (no previous merge yet)
[S7] round=59 local utility u=0.279368 metrics={'f1_val': 0.6596276824056788, 'auprc': 0.8059052710926571, 'loss_val': 0.4952526979972963, 'psi': 0.7181387178804701}-{'f1_val': 0.6062643971275924, 'auprc': 0.7944333223411654, 'loss_val': 0.6993932199858702, 'psi': 0.6815319672130216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=60 psi=0.718 u=0.2794 p_local=0.2087 f1=0.660 auprc=0.806 bytes=62969
[S8] START round=59 head_norm_before_train=1.875418 cos_to_last_merge=0.9477 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.992384245702453, 'auprc': 0.999515482430437, 'loss_val': 0.03283214295732849, 'psi': 0.9952367403936465}-{'f1_val': 0.9946307902678028, 'auprc': 0.9992137546636075, 'loss_val': 0.028846046930201957, 'psi': 0.9964639760261247}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=60 psi=0.995 u=0.0000 p_local=0.1552 f1=0.992 auprc=1.000 bytes=64859
[S9] START round=59 head_norm_before_train=2.017705 cos_to_last_merge=0.7932 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.998813494767181, 'loss_val': 0.02691899448173889, 'psi': 0.9950165850944042}-{'f1_val': 0.9966605118138915, 'auprc': 0.9953171691158719, 'loss_val': 0.019735475109732184, 'psi': 0.9961231747346836}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.995 u=0.0000 p_local=0.0047 f1=0.992 auprc=0.999 bytes=66443
[S10] START round=59 head_norm_before_train=1.950812 cos_to_last_merge=0.8597 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.860
[S10] round=59 local utility u=0.000065 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921167143656374, 'loss_val': 0.027485303172791645, 'psi': 0.9939593891578797}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921051519822256, 'loss_val': 0.02758157402733411, 'psi': 0.993954764204515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S10] r=60 psi=0.994 u=0.0001 p_local=0.0003 f1=0.995 auprc=0.992 bytes=73832
[S11] START round=59 head_norm_before_train=1.853800 cos_to_last_merge=0.8923 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.892
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9390247027232878, 'auprc': 0.9983304307046666, 'loss_val': 0.28803165952059123, 'psi': 0.9627469939158393}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983500284423941, 'loss_val': 0.019008098528304207, 'psi': 0.9972682140851113}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.963 u=0.0000 p_local=0.0085 f1=0.939 auprc=0.998 bytes=71898
[S13] START round=59 head_norm_before_train=1.517455 cos_to_last_merge=0.8979 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.898
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6818875543155193, 'auprc': 0.7815497152548216, 'loss_val': 0.6880241335629044, 'psi': 0.7217524186912403}-{'f1_val': 0.7252542314389273, 'auprc': 0.7734797642039293, 'loss_val': 0.6770855923312865, 'psi': 0.7445444445449281}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.722 u=0.0000 p_local=0.1096 f1=0.682 auprc=0.782 bytes=53932
[S14] START round=59 head_norm_before_train=1.934394 cos_to_last_merge=0.9493 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9363330344992414, 'auprc': 0.9975350618178543, 'loss_val': 0.15219264902005442, 'psi': 0.9608138454266866}-{'f1_val': 0.9919775121572035, 'auprc': 0.9992337824937132, 'loss_val': 0.030924122383593697, 'psi': 0.9948800202918073}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.961 u=0.0000 p_local=0.0255 f1=0.936 auprc=0.998 bytes=73706
[S15] START round=59 head_norm_before_train=1.913291 cos_to_last_merge=0.9481 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.9963837865381971, 'auprc': 0.9995790092302861, 'loss_val': 0.01988475901412304, 'psi': 0.9976618756150327}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985841278103812, 'loss_val': 0.017635852775022824, 'psi': 0.9974816521566648}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.998 u=0.0000 p_local=0.2256 f1=0.996 auprc=1.000 bytes=66537
[S16] START round=59 head_norm_before_train=2.088085 (no previous merge yet)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9916201842169952, 'auprc': 0.988580624220669, 'loss_val': 0.04785134919117051, 'psi': 0.9904043602184647}-{'f1_val': 0.9929586256997991, 'auprc': 0.986296287562735, 'loss_val': 0.0352927034150699, 'psi': 0.9902936904449735}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.990 u=0.0000 p_local=0.1469 f1=0.992 auprc=0.989 bytes=62946
[S17] START round=59 head_norm_before_train=1.796802 cos_to_last_merge=0.8897 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.890
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6744468513344741, 'auprc': 0.8838613663145358, 'loss_val': 1.1364544641075887, 'psi': 0.7582126573264989}-{'f1_val': 0.6847531384517943, 'auprc': 0.9133250356806292, 'loss_val': 1.0173397705059808, 'psi': 0.7761818973433283}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.758 u=0.0000 p_local=0.0761 f1=0.674 auprc=0.884 bytes=55834
[S2] START round=60 head_norm_before_train=1.784310 cos_to_last_merge=0.8975 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.898
[S2] round=60 local utility u=0.228425 metrics={'f1_val': 0.7195927380493318, 'auprc': 0.7734315164568626, 'loss_val': 0.9100574524254753, 'psi': 0.7411282494123441}-{'f1_val': 0.6529320176797775, 'auprc': 0.7594679423497085, 'loss_val': 0.9250521298714295, 'psi': 0.6955463875477499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=60 head_norm_before_train=2.049646 cos_to_last_merge=0.9365 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=60 local utility u=0.010474 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.999494516362857, 'loss_val': 0.1287877616990823, 'psi': 0.976295571927881}-{'f1_val': 0.9533087160273793, 'auprc': 0.9986445124835476, 'loss_val': 0.10205995247343555, 'psi': 0.9714430346098466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=60 head_norm_before_train=1.838977 cos_to_last_merge=0.7630 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.763
[S4] round=60 local utility u=0.015777 metrics={'f1_val': 0.9408595464926839, 'auprc': 0.9373566605569139, 'loss_val': 0.30191519464008826, 'psi': 0.9394583921183759}-{'f1_val': 0.9406050194799215, 'auprc': 0.9323241720365154, 'loss_val': 0.3168454989317789, 'psi': 0.9372926805025591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=60 head_norm_before_train=1.498486 cos_to_last_merge=0.8384 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=60 local utility u=1.000000 metrics={'f1_val': 0.995996280939491, 'auprc': 0.9944274658015513, 'loss_val': 0.13417999216406493, 'psi': 0.9953687548843151}-{'f1_val': 0.4432351449342727, 'auprc': 0.8560015287678959, 'loss_val': 0.9347964667378924, 'psi': 0.608341698467722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=60 head_norm_before_train=1.732567 cos_to_last_merge=0.8278 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.828
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.6607957493873593, 'auprc': 0.8692718859329325, 'loss_val': 0.8023773617190126, 'psi': 0.7441862040055885}-{'f1_val': 0.8624244685020267, 'auprc': 0.94721145470858, 'loss_val': 0.4200192616643041, 'psi': 0.896339262984648}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.817100 (no previous merge yet)
[S7] round=60 local utility u=0.409288 metrics={'f1_val': 0.6954549537819832, 'auprc': 0.9162864683242581, 'loss_val': 0.2227838176796795, 'psi': 0.7837875595988932}-{'f1_val': 0.6596276824056788, 'auprc': 0.8059052710926571, 'loss_val': 0.4952526979972963, 'psi': 0.7181387178804701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=60 head_norm_before_train=1.881145 cos_to_last_merge=0.9466 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=60 local utility u=0.009318 metrics={'f1_val': 0.994753542178155, 'auprc': 0.999389316666464, 'loss_val': 0.028033244835241364, 'psi': 0.9966078519734787}-{'f1_val': 0.992384245702453, 'auprc': 0.999515482430437, 'loss_val': 0.03283214295732849, 'psi': 0.9952367403936465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=60 head_norm_before_train=2.022043 cos_to_last_merge=0.7929 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=60 local utility u=0.011396 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9955776617581202, 'loss_val': 0.01947047981868735, 'psi': 0.9962273717915829}-{'f1_val': 0.9924853119792197, 'auprc': 0.998813494767181, 'loss_val': 0.02691899448173889, 'psi': 0.9950165850944042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=60 head_norm_before_train=1.956008 cos_to_last_merge=0.8593 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.859
[S10] round=60 local utility u=0.000895 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9926370902783607, 'loss_val': 0.02725660827387512, 'psi': 0.9941675395229691}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921167143656374, 'loss_val': 0.027485303172791645, 'psi': 0.9939593891578797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=60 head_norm_before_train=1.860302 cos_to_last_merge=0.8914 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.891
[S11] round=60 local utility u=0.304351 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9979510915307082, 'loss_val': 0.02175283704368928, 'psi': 0.9969514536946568}-{'f1_val': 0.9390247027232878, 'auprc': 0.9983304307046666, 'loss_val': 0.28803165952059123, 'psi': 0.9627469939158393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=60 head_norm_before_train=1.521183 cos_to_last_merge=0.8971 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.897
[S13] round=60 local utility u=0.019321 metrics={'f1_val': 0.6963802647330061, 'auprc': 0.7904816626602982, 'loss_val': 0.7631343497131498, 'psi': 0.734020823903923}-{'f1_val': 0.6818875543155193, 'auprc': 0.7815497152548216, 'loss_val': 0.6880241335629044, 'psi': 0.7217524186912403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=60 head_norm_before_train=1.938496 cos_to_last_merge=0.9485 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9327626984003987, 'auprc': 0.9992318927023246, 'loss_val': 0.18211787872316293, 'psi': 0.9593503761211691}-{'f1_val': 0.9363330344992414, 'auprc': 0.9975350618178543, 'loss_val': 0.15219264902005442, 'psi': 0.9608138454266866}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.921401 cos_to_last_merge=0.9473 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.8191090255040182, 'auprc': 0.9189307315832954, 'loss_val': 0.3841923090484642, 'psi': 0.8590377079357291}-{'f1_val': 0.9963837865381971, 'auprc': 0.9995790092302861, 'loss_val': 0.01988475901412304, 'psi': 0.9976618756150327}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=2.091051 (no previous merge yet)
[S16] round=60 local utility u=0.007047 metrics={'f1_val': 0.9931779129721021, 'auprc': 0.9857889953571276, 'loss_val': 0.03472958179718073, 'psi': 0.9902223459261124}-{'f1_val': 0.9916201842169952, 'auprc': 0.988580624220669, 'loss_val': 0.04785134919117051, 'psi': 0.9904043602184647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=60 head_norm_before_train=1.807479 cos_to_last_merge=0.8886 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.889
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.65991938314294, 'auprc': 0.8768264527098315, 'loss_val': 1.3168891231217785, 'psi': 0.7466822109696967}-{'f1_val': 0.6744468513344741, 'auprc': 0.8838613663145358, 'loss_val': 1.1364544641075887, 'psi': 0.7582126573264989}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=61 head_norm_before_train=1.792017 cos_to_last_merge=0.8966 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7212894676821902, 'auprc': 0.7286387098437762, 'loss_val': 0.9428557055920715, 'psi': 0.7242291645468246}-{'f1_val': 0.7195927380493318, 'auprc': 0.7734315164568626, 'loss_val': 0.9100574524254753, 'psi': 0.7411282494123441}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.056802 cos_to_last_merge=0.9358 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.8510499996438772, 'auprc': 0.99836264583776, 'loss_val': 0.3260838344601551, 'psi': 0.9099750581214303}-{'f1_val': 0.9608296089712303, 'auprc': 0.999494516362857, 'loss_val': 0.1287877616990823, 'psi': 0.976295571927881}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.843292 cos_to_last_merge=0.7630 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.763
[S4] round=61 local utility u=0.001537 metrics={'f1_val': 0.9414583580916333, 'auprc': 0.9369954521954343, 'loss_val': 0.30135112536966935, 'psi': 0.9396731957331537}-{'f1_val': 0.9408595464926839, 'auprc': 0.9373566605569139, 'loss_val': 0.30191519464008826, 'psi': 0.9394583921183759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=61 head_norm_before_train=1.502659 cos_to_last_merge=0.8372 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.837
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.4214778670881308, 'auprc': 0.791638585189074, 'loss_val': 1.27604038851304, 'psi': 0.5695421543285081}-{'f1_val': 0.995996280939491, 'auprc': 0.9944274658015513, 'loss_val': 0.13417999216406493, 'psi': 0.9953687548843151}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.741890 cos_to_last_merge=0.8260 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.826
[S6] round=61 local utility u=1.000000 metrics={'f1_val': 0.8673585892184931, 'auprc': 0.9642403627826089, 'loss_val': 0.28587855123348876, 'psi': 0.9061112986441394}-{'f1_val': 0.6607957493873593, 'auprc': 0.8692718859329325, 'loss_val': 0.8023773617190126, 'psi': 0.7441862040055885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=61 head_norm_before_train=1.822403 (no previous merge yet)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.49347988724498526, 'auprc': 0.7811971505613301, 'loss_val': 1.161339230357353, 'psi': 0.6085667925715232}-{'f1_val': 0.6954549537819832, 'auprc': 0.9162864683242581, 'loss_val': 0.2227838176796795, 'psi': 0.7837875595988932}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.886518 cos_to_last_merge=0.9460 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9931022471969293, 'auprc': 0.9994978363537619, 'loss_val': 0.02811356536355306, 'psi': 0.9956604828596622}-{'f1_val': 0.994753542178155, 'auprc': 0.999389316666464, 'loss_val': 0.028033244835241364, 'psi': 0.9966078519734787}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=61 head_norm_before_train=2.026558 cos_to_last_merge=0.7923 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=61 local utility u=0.001047 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.998807295104593, 'loss_val': 0.01959818496373998, 'psi': 0.9967724175638086}-{'f1_val': 0.9966605118138915, 'auprc': 0.9955776617581202, 'loss_val': 0.01947047981868735, 'psi': 0.9962273717915829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=61 head_norm_before_train=1.961912 cos_to_last_merge=0.8587 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.859
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9920921891469809, 'loss_val': 0.027397506702624995, 'psi': 0.9939495790704171}-{'f1_val': 0.9951878390193748, 'auprc': 0.9926370902783607, 'loss_val': 0.02725660827387512, 'psi': 0.9941675395229691}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=1.865022 cos_to_last_merge=0.8907 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.891
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.982069060121811, 'auprc': 0.9982984797362255, 'loss_val': 0.076537951772001, 'psi': 0.9885608279675768}-{'f1_val': 0.9962850284706224, 'auprc': 0.9979510915307082, 'loss_val': 0.02175283704368928, 'psi': 0.9969514536946568}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=1.525610 cos_to_last_merge=0.8965 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.897
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6371658590676138, 'auprc': 0.7828906678440557, 'loss_val': 0.7984128843928985, 'psi': 0.6954557825781906}-{'f1_val': 0.6963802647330061, 'auprc': 0.7904816626602982, 'loss_val': 0.7631343497131498, 'psi': 0.734020823903923}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=1.941679 cos_to_last_merge=0.9481 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=61 local utility u=0.277174 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992343839081999, 'loss_val': 0.018131650209981285, 'psi': 0.9983868091759354}-{'f1_val': 0.9327626984003987, 'auprc': 0.9992318927023246, 'loss_val': 0.18211787872316293, 'psi': 0.9593503761211691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=61 head_norm_before_train=1.929011 cos_to_last_merge=0.9466 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=61 local utility u=0.835135 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9993619025443718, 'loss_val': 0.023265941931141416, 'psi': 0.9980151131346089}-{'f1_val': 0.8191090255040182, 'auprc': 0.9189307315832954, 'loss_val': 0.3841923090484642, 'psi': 0.8590377079357291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=61 head_norm_before_train=2.092880 (no previous merge yet)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.8662788949888875, 'auprc': 0.8666672349289326, 'loss_val': 0.8821957380029204, 'psi': 0.8664342309649056}-{'f1_val': 0.9931779129721021, 'auprc': 0.9857889953571276, 'loss_val': 0.03472958179718073, 'psi': 0.9902223459261124}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=1.814913 cos_to_last_merge=0.8878 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.888
[S17] round=61 local utility u=0.362499 metrics={'f1_val': 0.7193428371982833, 'auprc': 0.8694073917485247, 'loss_val': 0.9261748477979275, 'psi': 0.7793686590183798}-{'f1_val': 0.65991938314294, 'auprc': 0.8768264527098315, 'loss_val': 1.3168891231217785, 'psi': 0.7466822109696967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[S2] START round=62 head_norm_before_train=1.800018 cos_to_last_merge=0.8957 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.896
[S2] round=62 local utility u=0.013840 metrics={'f1_val': 0.7201296721664179, 'auprc': 0.7445322703658864, 'loss_val': 0.9558977938933181, 'psi': 0.7298907114462053}-{'f1_val': 0.7212894676821902, 'auprc': 0.7286387098437762, 'loss_val': 0.9428557055920715, 'psi': 0.7242291645468246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=62 head_norm_before_train=2.062433 cos_to_last_merge=0.9352 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=62 local utility u=0.296186 metrics={'f1_val': 0.921506457545612, 'auprc': 0.9983902677781805, 'loss_val': 0.15653245064188986, 'psi': 0.9522599816386395}-{'f1_val': 0.8510499996438772, 'auprc': 0.99836264583776, 'loss_val': 0.3260838344601551, 'psi': 0.9099750581214303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=62 head_norm_before_train=1.846135 cos_to_last_merge=0.7628 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.763
[S4] round=62 local utility u=0.027274 metrics={'f1_val': 0.943259165449996, 'auprc': 0.9488578339777638, 'loss_val': 0.29319488826997236, 'psi': 0.945498632861103}-{'f1_val': 0.9414583580916333, 'auprc': 0.9369954521954343, 'loss_val': 0.30135112536966935, 'psi': 0.9396731957331537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=62 head_norm_before_train=1.506440 cos_to_last_merge=0.8366 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.837
[S5] round=62 local utility u=1.000000 metrics={'f1_val': 0.7777083374702096, 'auprc': 0.9897784284753282, 'loss_val': 0.22313444139269314, 'psi': 0.862536373872257}-{'f1_val': 0.4214778670881308, 'auprc': 0.791638585189074, 'loss_val': 1.27604038851304, 'psi': 0.5695421543285081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=62 head_norm_before_train=1.750261 cos_to_last_merge=0.8248 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.825
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.8639952854477864, 'auprc': 0.9648136351843593, 'loss_val': 0.4017016181062175, 'psi': 0.9043226253424155}-{'f1_val': 0.8673585892184931, 'auprc': 0.9642403627826089, 'loss_val': 0.28587855123348876, 'psi': 0.9061112986441394}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.824296 (no previous merge yet)
[S7] round=62 local utility u=1.000000 metrics={'f1_val': 0.8789645505093857, 'auprc': 0.9742225040107122, 'loss_val': 0.17599224077815628, 'psi': 0.9170677319099163}-{'f1_val': 0.49347988724498526, 'auprc': 0.7811971505613301, 'loss_val': 1.161339230357353, 'psi': 0.6085667925715232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=62 head_norm_before_train=1.893276 cos_to_last_merge=0.9454 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.992384245702453, 'auprc': 0.9987007912758973, 'loss_val': 0.03149568546065599, 'psi': 0.9949108639318307}-{'f1_val': 0.9931022471969293, 'auprc': 0.9994978363537619, 'loss_val': 0.02811356536355306, 'psi': 0.9956604828596622}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=2.032475 cos_to_last_merge=0.7920 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9987021232777981, 'loss_val': 0.03868169529309577, 'psi': 0.9931939163819453}-{'f1_val': 0.9954158325366191, 'auprc': 0.998807295104593, 'loss_val': 0.01959818496373998, 'psi': 0.9967724175638086}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=1.965611 cos_to_last_merge=0.8585 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.859
[S10] round=62 local utility u=0.000090 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.992107548303406, 'loss_val': 0.027263319158368316, 'psi': 0.9939557227329872}-{'f1_val': 0.9951878390193748, 'auprc': 0.9920921891469809, 'loss_val': 0.027397506702624995, 'psi': 0.9939495790704171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=62 head_norm_before_train=1.868962 cos_to_last_merge=0.8901 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.890
[S11] round=62 local utility u=0.071684 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9982927684553236, 'loss_val': 0.019898924980023904, 'psi': 0.9972332262795086}-{'f1_val': 0.982069060121811, 'auprc': 0.9982984797362255, 'loss_val': 0.076537951772001, 'psi': 0.9885608279675768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=62 head_norm_before_train=1.534366 cos_to_last_merge=0.8956 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.896
[S13] round=62 local utility u=0.372722 metrics={'f1_val': 0.7292006328922978, 'auprc': 0.8069391250106235, 'loss_val': 0.6773231475777192, 'psi': 0.7602960297396281}-{'f1_val': 0.6371658590676138, 'auprc': 0.7828906678440557, 'loss_val': 0.7984128843928985, 'psi': 0.6954557825781906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=62 head_norm_before_train=1.945069 cos_to_last_merge=0.9481 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.996847995041602, 'loss_val': 0.020747854816829153, 'psi': 0.9971857945773377}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992343839081999, 'loss_val': 0.018131650209981285, 'psi': 0.9983868091759354}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.934972 cos_to_last_merge=0.9461 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9978519407729298, 'loss_val': 0.017865209239861245, 'psi': 0.9969306390817245}-{'f1_val': 0.9971172535281002, 'auprc': 0.9993619025443718, 'loss_val': 0.023265941931141416, 'psi': 0.9980151131346089}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=62 head_norm_before_train=2.095187 (no previous merge yet)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.8437524305442297, 'auprc': 0.8429997447312847, 'loss_val': 1.2072965283313633, 'psi': 0.8434513562190517}-{'f1_val': 0.8662788949888875, 'auprc': 0.8666672349289326, 'loss_val': 0.8821957380029204, 'psi': 0.8664342309649056}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=1.824504 cos_to_last_merge=0.8869 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.887
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.6858300243110208, 'auprc': 0.872940611637561, 'loss_val': 1.2279053468101468, 'psi': 0.7606742592416369}-{'f1_val': 0.7193428371982833, 'auprc': 0.8694073917485247, 'loss_val': 0.9261748477979275, 'psi': 0.7793686590183798}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=1.808065 cos_to_last_merge=0.8947 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.895
[S2] round=63 local utility u=0.010111 metrics={'f1_val': 0.7198204826185411, 'auprc': 0.745566732845085, 'loss_val': 0.9369237483579281, 'psi': 0.7301189827091588}-{'f1_val': 0.7201296721664179, 'auprc': 0.7445322703658864, 'loss_val': 0.9558977938933181, 'psi': 0.7298907114462053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=63 head_norm_before_train=2.067868 cos_to_last_merge=0.9346 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.8292582731228967, 'auprc': 0.9823324426079292, 'loss_val': 0.3589945576165904, 'psi': 0.8904879409169097}-{'f1_val': 0.921506457545612, 'auprc': 0.9983902677781805, 'loss_val': 0.15653245064188986, 'psi': 0.9522599816386395}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.850268 cos_to_last_merge=0.7623 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.762
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.9425335304998672, 'auprc': 0.9451068480204872, 'loss_val': 0.2984511973288293, 'psi': 0.9435628575081152}-{'f1_val': 0.943259165449996, 'auprc': 0.9488578339777638, 'loss_val': 0.29319488826997236, 'psi': 0.945498632861103}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.508968 cos_to_last_merge=0.8364 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=63 local utility u=0.088707 metrics={'f1_val': 0.799591485355196, 'auprc': 0.9909249850031048, 'loss_val': 0.18045941477602895, 'psi': 0.8761248852143595}-{'f1_val': 0.7777083374702096, 'auprc': 0.9897784284753282, 'loss_val': 0.22313444139269314, 'psi': 0.862536373872257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=63 head_norm_before_train=1.757684 cos_to_last_merge=0.8238 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.824
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.6600598482020866, 'auprc': 0.8981430649662226, 'loss_val': 0.801730257647391, 'psi': 0.755293134907741}-{'f1_val': 0.8639952854477864, 'auprc': 0.9648136351843593, 'loss_val': 0.4017016181062175, 'psi': 0.9043226253424155}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=1.826139 (no previous merge yet)
[S7] round=63 local utility u=0.283762 metrics={'f1_val': 0.971580286758311, 'auprc': 0.9821839083054246, 'loss_val': 0.18804757653236817, 'psi': 0.9758217353771564}-{'f1_val': 0.8789645505093857, 'auprc': 0.9742225040107122, 'loss_val': 0.17599224077815628, 'psi': 0.9170677319099163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=63 head_norm_before_train=1.898059 cos_to_last_merge=0.9450 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=63 local utility u=0.000000 metrics={'f1_val': 0.9897980771885292, 'auprc': 0.993470492177207, 'loss_val': 0.05523612667924479, 'psi': 0.9912670431840003}-{'f1_val': 0.992384245702453, 'auprc': 0.9987007912758973, 'loss_val': 0.03149568546065599, 'psi': 0.9949108639318307}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=63 head_norm_before_train=2.038547 cos_to_last_merge=0.7918 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=63 local utility u=0.027169 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9988071689978806, 'loss_val': 0.020022264981862704, 'psi': 0.9967723671211237}-{'f1_val': 0.9895217784513768, 'auprc': 0.9987021232777981, 'loss_val': 0.03868169529309577, 'psi': 0.9931939163819453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=63 head_norm_before_train=1.969773 cos_to_last_merge=0.8583 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.858
[S10] round=63 local utility u=0.000298 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9922617339496131, 'loss_val': 0.02712928085375485, 'psi': 0.9940173969914701}-{'f1_val': 0.9951878390193748, 'auprc': 0.992107548303406, 'loss_val': 0.027263319158368316, 'psi': 0.9939557227329872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=63 head_norm_before_train=1.874241 cos_to_last_merge=0.8895 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.890
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9982150176488767, 'loss_val': 0.021353063311210025, 'psi': 0.9970570241419241}-{'f1_val': 0.9965268648289654, 'auprc': 0.9982927684553236, 'loss_val': 0.019898924980023904, 'psi': 0.9972332262795086}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.541270 cos_to_last_merge=0.8947 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.895
[S13] round=63 local utility u=0.088768 metrics={'f1_val': 0.753817512457397, 'auprc': 0.8110250218248247, 'loss_val': 0.6597468098885823, 'psi': 0.7767005162043681}-{'f1_val': 0.7292006328922978, 'auprc': 0.8069391250106235, 'loss_val': 0.6773231475777192, 'psi': 0.7602960297396281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=63 head_norm_before_train=1.950637 cos_to_last_merge=0.9480 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9940717027317836, 'loss_val': 0.021139998097327042, 'psi': 0.9960752776534103}-{'f1_val': 0.9974109942678281, 'auprc': 0.996847995041602, 'loss_val': 0.020747854816829153, 'psi': 0.9971857945773377}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=1.941329 cos_to_last_merge=0.9455 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=63 local utility u=0.005339 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9995809537636984, 'loss_val': 0.017179643350012708, 'psi': 0.9981027336223395}-{'f1_val': 0.9963164379542544, 'auprc': 0.9978519407729298, 'loss_val': 0.017865209239861245, 'psi': 0.9969306390817245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=63 head_norm_before_train=2.100679 (no previous merge yet)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.8352859474667935, 'auprc': 0.8168581683952221, 'loss_val': 1.2951912347054668, 'psi': 0.8279148358381649}-{'f1_val': 0.8437524305442297, 'auprc': 0.8429997447312847, 'loss_val': 1.2072965283313633, 'psi': 0.8434513562190517}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=1.833307 cos_to_last_merge=0.8860 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.886
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.652661998462177, 'auprc': 0.883878339304352, 'loss_val': 1.4203578158524188, 'psi': 0.745148534799047}-{'f1_val': 0.6858300243110208, 'auprc': 0.872940611637561, 'loss_val': 1.2279053468101468, 'psi': 0.7606742592416369}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=1.814886 cos_to_last_merge=0.8933 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.893
[S2] round=64 local utility u=0.082547 metrics={'f1_val': 0.7189443517654868, 'auprc': 0.7791345948757511, 'loss_val': 0.867276035059964, 'psi': 0.7430204490095924}-{'f1_val': 0.7198204826185411, 'auprc': 0.745566732845085, 'loss_val': 0.9369237483579281, 'psi': 0.7301189827091588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=64 head_norm_before_train=2.072332 cos_to_last_merge=0.9341 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=64 local utility u=0.293423 metrics={'f1_val': 0.90250130540418, 'auprc': 0.9863305021044524, 'loss_val': 0.2236002491390221, 'psi': 0.936032984084289}-{'f1_val': 0.8292582731228967, 'auprc': 0.9823324426079292, 'loss_val': 0.3589945576165904, 'psi': 0.8904879409169097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=64 head_norm_before_train=1.853455 cos_to_last_merge=0.7619 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.762
[S4] round=64 local utility u=0.001478 metrics={'f1_val': 0.9416956485712165, 'auprc': 0.9486200881173132, 'loss_val': 0.301007021202829, 'psi': 0.9444654243896551}-{'f1_val': 0.9425335304998672, 'auprc': 0.9451068480204872, 'loss_val': 0.2984511973288293, 'psi': 0.9435628575081152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=64 head_norm_before_train=1.513741 cos_to_last_merge=0.8363 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.6828600632179206, 'auprc': 0.8803669745268404, 'loss_val': 0.4771864594982739, 'psi': 0.7618628277414885}-{'f1_val': 0.799591485355196, 'auprc': 0.9909249850031048, 'loss_val': 0.18045941477602895, 'psi': 0.8761248852143595}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=1.763877 cos_to_last_merge=0.8229 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.823
[S6] round=64 local utility u=0.499262 metrics={'f1_val': 0.7776393965192653, 'auprc': 0.9297754542231105, 'loss_val': 0.603581219694371, 'psi': 0.8384938196008034}-{'f1_val': 0.6600598482020866, 'auprc': 0.8981430649662226, 'loss_val': 0.801730257647391, 'psi': 0.755293134907741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=64 head_norm_before_train=1.823913 (no previous merge yet)
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.5147576424403755, 'auprc': 0.7810554074791249, 'loss_val': 0.953955598980871, 'psi': 0.6212767484558752}-{'f1_val': 0.971580286758311, 'auprc': 0.9821839083054246, 'loss_val': 0.18804757653236817, 'psi': 0.9758217353771564}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=64 head_norm_before_train=1.903145 cos_to_last_merge=0.9445 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=64 local utility u=0.024033 metrics={'f1_val': 0.9921395546714198, 'auprc': 0.9984471677199948, 'loss_val': 0.036149515130746164, 'psi': 0.9946625998908498}-{'f1_val': 0.9897980771885292, 'auprc': 0.993470492177207, 'loss_val': 0.05523612667924479, 'psi': 0.9912670431840003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=64 head_norm_before_train=2.045137 cos_to_last_merge=0.7914 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=64 local utility u=0.003878 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998606493179111, 'loss_val': 0.0191320180673308, 'psi': 0.9974389043599793}-{'f1_val': 0.9954158325366191, 'auprc': 0.9988071689978806, 'loss_val': 0.020022264981862704, 'psi': 0.9967723671211237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=64 head_norm_before_train=1.974935 cos_to_last_merge=0.8578 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.858
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921350236009104, 'loss_val': 0.027170574469416245, 'psi': 0.993966712851989}-{'f1_val': 0.9951878390193748, 'auprc': 0.9922617339496131, 'loss_val': 0.02712928085375485, 'psi': 0.9940173969914701}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=1.878675 cos_to_last_merge=0.8888 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.889
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9218666570070816, 'auprc': 0.9986813882655119, 'loss_val': 0.3990048343714986, 'psi': 0.9525925495104537}-{'f1_val': 0.9962850284706224, 'auprc': 0.9982150176488767, 'loss_val': 0.021353063311210025, 'psi': 0.9970570241419241}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.547585 cos_to_last_merge=0.8939 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.894
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.7131418086003001, 'auprc': 0.805697830462505, 'loss_val': 0.7578112471484632, 'psi': 0.7501642173451821}-{'f1_val': 0.753817512457397, 'auprc': 0.8110250218248247, 'loss_val': 0.6597468098885823, 'psi': 0.7767005162043681}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=1.958319 cos_to_last_merge=0.9476 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=64 local utility u=0.002490 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9964120713954909, 'loss_val': 0.02304969533910377, 'psi': 0.9969983036839347}-{'f1_val': 0.9974109942678281, 'auprc': 0.9940717027317836, 'loss_val': 0.021139998097327042, 'psi': 0.9960752776534103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=64 head_norm_before_train=1.947420 cos_to_last_merge=0.9451 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=64 local utility u=0.000218 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9996263091099935, 'loss_val': 0.016879128302094332, 'psi': 0.9981208757608575}-{'f1_val': 0.9971172535281002, 'auprc': 0.9995809537636984, 'loss_val': 0.017179643350012708, 'psi': 0.9981027336223395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=64 head_norm_before_train=2.103940 (no previous merge yet)
[S16] round=64 local utility u=1.000000 metrics={'f1_val': 0.9931673086796463, 'auprc': 0.9875513585813607, 'loss_val': 0.04108517172775629, 'psi': 0.990920928640332}-{'f1_val': 0.8352859474667935, 'auprc': 0.8168581683952221, 'loss_val': 1.2951912347054668, 'psi': 0.8279148358381649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=64 head_norm_before_train=1.841382 cos_to_last_merge=0.8853 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.885
[S17] round=64 local utility u=0.320446 metrics={'f1_val': 0.6979984418981295, 'auprc': 0.8755489141350814, 'loss_val': 1.0264958536144269, 'psi': 0.7690186307929103}-{'f1_val': 0.652661998462177, 'auprc': 0.883878339304352, 'loss_val': 1.4203578158524188, 'psi': 0.745148534799047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=65 head_norm_before_train=1.820254 cos_to_last_merge=0.8922 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.892
[S2] round=65 local utility u=0.032701 metrics={'f1_val': 0.7184185826154892, 'auprc': 0.7817798529633538, 'loss_val': 0.8066555329753529, 'psi': 0.7437630907546351}-{'f1_val': 0.7189443517654868, 'auprc': 0.7791345948757511, 'loss_val': 0.867276035059964, 'psi': 0.7430204490095924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=65 head_norm_before_train=2.077077 cos_to_last_merge=0.9336 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=65 local utility u=0.406071 metrics={'f1_val': 0.9970129389118929, 'auprc': 0.9995103575739983, 'loss_val': 0.018067980447101003, 'psi': 0.9980119063767351}-{'f1_val': 0.90250130540418, 'auprc': 0.9863305021044524, 'loss_val': 0.2236002491390221, 'psi': 0.936032984084289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=65 head_norm_before_train=1.860037 cos_to_last_merge=0.7614 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.761
[S4] round=65 local utility u=0.005849 metrics={'f1_val': 0.9419150203405731, 'auprc': 0.9512662644725453, 'loss_val': 0.298563081200206, 'psi': 0.9456555179933619}-{'f1_val': 0.9416956485712165, 'auprc': 0.9486200881173132, 'loss_val': 0.301007021202829, 'psi': 0.9444654243896551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=65 head_norm_before_train=1.519746 cos_to_last_merge=0.8358 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=65 local utility u=0.699491 metrics={'f1_val': 0.8086753935393363, 'auprc': 0.9911591279419034, 'loss_val': 0.16547209824926484, 'psi': 0.8816688873003631}-{'f1_val': 0.6828600632179206, 'auprc': 0.8803669745268404, 'loss_val': 0.4771864594982739, 'psi': 0.7618628277414885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=65 head_norm_before_train=1.770834 cos_to_last_merge=0.8226 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.823
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.7630296225688018, 'auprc': 0.9332111260136069, 'loss_val': 0.61619949783134, 'psi': 0.8311022239467238}-{'f1_val': 0.7776393965192653, 'auprc': 0.9297754542231105, 'loss_val': 0.603581219694371, 'psi': 0.8384938196008034}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=1.821225 (no previous merge yet)
[S7] round=65 local utility u=1.000000 metrics={'f1_val': 0.9936712648096122, 'auprc': 0.9922491481571754, 'loss_val': 0.14278654846591213, 'psi': 0.9931024181486375}-{'f1_val': 0.5147576424403755, 'auprc': 0.7810554074791249, 'loss_val': 0.953955598980871, 'psi': 0.6212767484558752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=65 head_norm_before_train=1.907472 cos_to_last_merge=0.9442 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=65 local utility u=0.005681 metrics={'f1_val': 0.992384245702453, 'auprc': 0.9995286484461627, 'loss_val': 0.02949986973986975, 'psi': 0.9952420067999368}-{'f1_val': 0.9921395546714198, 'auprc': 0.9984471677199948, 'loss_val': 0.036149515130746164, 'psi': 0.9946625998908498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=65 head_norm_before_train=2.051482 cos_to_last_merge=0.7912 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983951959573782, 'loss_val': 0.01910697147598023, 'psi': 0.9973543854712862}-{'f1_val': 0.9966605118138915, 'auprc': 0.998606493179111, 'loss_val': 0.0191320180673308, 'psi': 0.9974389043599793}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=1.980608 cos_to_last_merge=0.8573 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.857
[S10] round=65 local utility u=0.000281 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9922610158370576, 'loss_val': 0.026986543296131597, 'psi': 0.9940171097464479}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921350236009104, 'loss_val': 0.027170574469416245, 'psi': 0.993966712851989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=65 head_norm_before_train=1.877707 cos_to_last_merge=0.8878 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.888
[S11] round=65 local utility u=0.412927 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9988090213392621, 'loss_val': 0.020165252400720646, 'psi': 0.9973067090170213}-{'f1_val': 0.9218666570070816, 'auprc': 0.9986813882655119, 'loss_val': 0.3990048343714986, 'psi': 0.9525925495104537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=65 head_norm_before_train=1.553850 cos_to_last_merge=0.8931 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.893
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.6902543101713681, 'auprc': 0.8010710411689177, 'loss_val': 0.6563800826576669, 'psi': 0.7345810025703879}-{'f1_val': 0.7131418086003001, 'auprc': 0.805697830462505, 'loss_val': 0.7578112471484632, 'psi': 0.7501642173451821}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=1.960879 cos_to_last_merge=0.9473 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=65 local utility u=0.000520 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9966143949524221, 'loss_val': 0.02261744696316655, 'psi': 0.9970792331067071}-{'f1_val': 0.9973891252095638, 'auprc': 0.9964120713954909, 'loss_val': 0.02304969533910377, 'psi': 0.9969983036839347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=65 head_norm_before_train=1.953635 cos_to_last_merge=0.9446 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982122375596505, 'loss_val': 0.01795961090688037, 'psi': 0.9973328960563725}-{'f1_val': 0.9971172535281002, 'auprc': 0.9996263091099935, 'loss_val': 0.016879128302094332, 'psi': 0.9981208757608575}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=2.106738 (no previous merge yet)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.8363109920174019, 'auprc': 0.988415257062041, 'loss_val': 0.6036460019824735, 'psi': 0.8971526980352575}-{'f1_val': 0.9931673086796463, 'auprc': 0.9875513585813607, 'loss_val': 0.04108517172775629, 'psi': 0.990920928640332}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.844727 cos_to_last_merge=0.8849 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.885
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.6722919193717801, 'auprc': 0.8800321181461205, 'loss_val': 1.1900943054260233, 'psi': 0.7553879988815163}-{'f1_val': 0.6979984418981295, 'auprc': 0.8755489141350814, 'loss_val': 1.0264958536144269, 'psi': 0.7690186307929103}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=66 head_norm_before_train=1.827804 cos_to_last_merge=0.8910 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.891
[S2] round=66 local utility u=0.011836 metrics={'f1_val': 0.7137746853116814, 'auprc': 0.7840821726072125, 'loss_val': 0.7620266507283141, 'psi': 0.7418976802298938}-{'f1_val': 0.7184185826154892, 'auprc': 0.7817798529633538, 'loss_val': 0.8066555329753529, 'psi': 0.7437630907546351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=66 head_norm_before_train=2.081393 cos_to_last_merge=0.9332 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=66 local utility u=0.000620 metrics={'f1_val': 0.9970158049264538, 'auprc': 0.9994966663607359, 'loss_val': 0.01680476902032712, 'psi': 0.9980081495001667}-{'f1_val': 0.9970129389118929, 'auprc': 0.9995103575739983, 'loss_val': 0.018067980447101003, 'psi': 0.9980119063767351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=66 head_norm_before_train=1.865452 cos_to_last_merge=0.7607 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.761
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9414583580916333, 'auprc': 0.9470993445337751, 'loss_val': 0.3038141299025803, 'psi': 0.9437147526684899}-{'f1_val': 0.9419150203405731, 'auprc': 0.9512662644725453, 'loss_val': 0.298563081200206, 'psi': 0.9456555179933619}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.525716 cos_to_last_merge=0.8352 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.4254101862489646, 'auprc': 0.7593517581487296, 'loss_val': 1.1186792988712508, 'psi': 0.5589868150088706}-{'f1_val': 0.8086753935393363, 'auprc': 0.9911591279419034, 'loss_val': 0.16547209824926484, 'psi': 0.8816688873003631}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=66 head_norm_before_train=1.777699 cos_to_last_merge=0.8221 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.822
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.7539755777799934, 'auprc': 0.9157312144822709, 'loss_val': 0.6354975336219217, 'psi': 0.8186778324609044}-{'f1_val': 0.7630296225688018, 'auprc': 0.9332111260136069, 'loss_val': 0.61619949783134, 'psi': 0.8311022239467238}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.822887 (no previous merge yet)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.6784368708701077, 'auprc': 0.8138319325556718, 'loss_val': 0.3761340172593783, 'psi': 0.7325948955443333}-{'f1_val': 0.9936712648096122, 'auprc': 0.9922491481571754, 'loss_val': 0.14278654846591213, 'psi': 0.9931024181486375}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=1.914800 cos_to_last_merge=0.9437 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.8944484079207454, 'auprc': 0.987085052207825, 'loss_val': 0.11927879451870302, 'psi': 0.9315030656355773}-{'f1_val': 0.992384245702453, 'auprc': 0.9995286484461627, 'loss_val': 0.02949986973986975, 'psi': 0.9952420067999368}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=2.058557 cos_to_last_merge=0.7909 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=66 local utility u=0.000457 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985859019528485, 'loss_val': 0.018764957041442976, 'psi': 0.9974306678694742}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983951959573782, 'loss_val': 0.01910697147598023, 'psi': 0.9973543854712862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=66 head_norm_before_train=1.984651 cos_to_last_merge=0.8570 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.857
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921299132485378, 'loss_val': 0.02704312095115604, 'psi': 0.99396466871104}-{'f1_val': 0.9951878390193748, 'auprc': 0.9922610158370576, 'loss_val': 0.026986543296131597, 'psi': 0.9940171097464479}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=1.879391 cos_to_last_merge=0.8871 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.887
[S11] round=66 local utility u=0.001227 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9988314847091586, 'loss_val': 0.01923059277000218, 'psi': 0.9974607965918172}-{'f1_val': 0.996305167468861, 'auprc': 0.9988090213392621, 'loss_val': 0.020165252400720646, 'psi': 0.9973067090170213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=66 head_norm_before_train=1.560831 cos_to_last_merge=0.8923 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.892
[S13] round=66 local utility u=0.147187 metrics={'f1_val': 0.7373450211798396, 'auprc': 0.8047319796791205, 'loss_val': 0.6555340879352582, 'psi': 0.7642998045795519}-{'f1_val': 0.6902543101713681, 'auprc': 0.8010710411689177, 'loss_val': 0.6563800826576669, 'psi': 0.7345810025703879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=66 head_norm_before_train=1.966596 cos_to_last_merge=0.9468 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=66 local utility u=0.001986 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9974360356321929, 'loss_val': 0.02111084025994004, 'psi': 0.9974078893786155}-{'f1_val': 0.9973891252095638, 'auprc': 0.9966143949524221, 'loss_val': 0.02261744696316655, 'psi': 0.9970792331067071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=66 head_norm_before_train=1.960235 cos_to_last_merge=0.9441 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9971676237710326, 'loss_val': 0.02923732733206586, 'psi': 0.9970850069594008}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982122375596505, 'loss_val': 0.01795961090688037, 'psi': 0.9973328960563725}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=2.108342 (no previous merge yet)
[S16] round=66 local utility u=0.686055 metrics={'f1_val': 0.9818518684379804, 'auprc': 0.9777024951469174, 'loss_val': 0.07264229437404131, 'psi': 0.9801921191215552}-{'f1_val': 0.8363109920174019, 'auprc': 0.988415257062041, 'loss_val': 0.6036460019824735, 'psi': 0.8971526980352575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=66 head_norm_before_train=1.849331 cos_to_last_merge=0.8844 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.884
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.6461039707511659, 'auprc': 0.8866544081551714, 'loss_val': 1.381394351480487, 'psi': 0.7423241457127681}-{'f1_val': 0.6722919193717801, 'auprc': 0.8800321181461205, 'loss_val': 1.1900943054260233, 'psi': 0.7553879988815163}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=1.833385 cos_to_last_merge=0.8904 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.890
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.7187283724004877, 'auprc': 0.7665462807884448, 'loss_val': 0.879464899480932, 'psi': 0.7378555357556706}-{'f1_val': 0.7137746853116814, 'auprc': 0.7840821726072125, 'loss_val': 0.7620266507283141, 'psi': 0.7418976802298938}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.086738 cos_to_last_merge=0.9327 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.9030436675939271, 'auprc': 0.9977979865942832, 'loss_val': 0.1797520870165053, 'psi': 0.9409453951940695}-{'f1_val': 0.9970158049264538, 'auprc': 0.9994966663607359, 'loss_val': 0.01680476902032712, 'psi': 0.9980081495001667}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.874347 cos_to_last_merge=0.7599 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.760
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9406995528886373, 'auprc': 0.9423770164969053, 'loss_val': 0.3288843061798917, 'psi': 0.9413705383319445}-{'f1_val': 0.9414583580916333, 'auprc': 0.9470993445337751, 'loss_val': 0.3038141299025803, 'psi': 0.9437147526684899}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=1.531093 cos_to_last_merge=0.8346 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=67 local utility u=1.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9167359245732568, 'loss_val': 0.36734108801433324, 'psi': 0.786938902761231}-{'f1_val': 0.4254101862489646, 'auprc': 0.7593517581487296, 'loss_val': 1.1186792988712508, 'psi': 0.5589868150088706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=67 head_norm_before_train=1.788064 cos_to_last_merge=0.8214 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.821
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.7440997284928388, 'auprc': 0.9332312717349279, 'loss_val': 0.7040155819228869, 'psi': 0.8197523457896745}-{'f1_val': 0.7539755777799934, 'auprc': 0.9157312144822709, 'loss_val': 0.6354975336219217, 'psi': 0.8186778324609044}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.822737 (no previous merge yet)
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.6131458999489334, 'auprc': 0.7836237695105712, 'loss_val': 0.7506196151045891, 'psi': 0.6813370477735885}-{'f1_val': 0.6784368708701077, 'auprc': 0.8138319325556718, 'loss_val': 0.3761340172593783, 'psi': 0.7325948955443333}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=1.922179 cos_to_last_merge=0.9433 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=67 local utility u=0.359635 metrics={'f1_val': 0.9928127407686298, 'auprc': 0.9996745301520684, 'loss_val': 0.027964062975639217, 'psi': 0.9955574565220052}-{'f1_val': 0.8944484079207454, 'auprc': 0.987085052207825, 'loss_val': 0.11927879451870302, 'psi': 0.9315030656355773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=67 head_norm_before_train=2.066134 cos_to_last_merge=0.7905 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9905410059937811, 'auprc': 0.9988124119559761, 'loss_val': 0.03474811073316514, 'psi': 0.9938495683786592}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985859019528485, 'loss_val': 0.018764957041442976, 'psi': 0.9974306678694742}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=1.988369 cos_to_last_merge=0.8568 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.857
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.992018962132746, 'loss_val': 0.02722988183324532, 'psi': 0.9939202882647232}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921299132485378, 'loss_val': 0.02704312095115604, 'psi': 0.99396466871104}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=67 head_norm_before_train=1.883086 cos_to_last_merge=0.8864 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.886
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9958937036982921, 'auprc': 0.9989503996686137, 'loss_val': 0.019858342389069254, 'psi': 0.9971163820864208}-{'f1_val': 0.9965470045135896, 'auprc': 0.9988314847091586, 'loss_val': 0.01923059277000218, 'psi': 0.9974607965918172}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=1.570114 cos_to_last_merge=0.8910 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.891
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.7424827587875082, 'auprc': 0.8128262688581753, 'loss_val': 0.7325514840412997, 'psi': 0.7706201628157752}-{'f1_val': 0.7373450211798396, 'auprc': 0.8047319796791205, 'loss_val': 0.6555340879352582, 'psi': 0.7642998045795519}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=1.970770 cos_to_last_merge=0.9464 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=67 local utility u=0.005957 metrics={'f1_val': 0.9982111419559175, 'auprc': 0.999171299453909, 'loss_val': 0.01933455834745187, 'psi': 0.9985952049551141}-{'f1_val': 0.9973891252095638, 'auprc': 0.9974360356321929, 'loss_val': 0.02111084025994004, 'psi': 0.9974078893786155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=67 head_norm_before_train=1.966998 cos_to_last_merge=0.9435 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=67 local utility u=0.007140 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9986372838187115, 'loss_val': 0.017666075522647557, 'psi': 0.997502914559997}-{'f1_val': 0.9970299290849798, 'auprc': 0.9971676237710326, 'loss_val': 0.02923732733206586, 'psi': 0.9970850069594008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=67 head_norm_before_train=2.111425 (no previous merge yet)
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.9206964495611943, 'auprc': 0.8878491238834718, 'loss_val': 0.532870212269458, 'psi': 0.9075575192901053}-{'f1_val': 0.9818518684379804, 'auprc': 0.9777024951469174, 'loss_val': 0.07264229437404131, 'psi': 0.9801921191215552}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=1.855212 cos_to_last_merge=0.8838 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.884
[S17] round=67 local utility u=0.143625 metrics={'f1_val': 0.6742840229780949, 'auprc': 0.8770016223890678, 'loss_val': 1.2342653362679228, 'psi': 0.7553710627424841}-{'f1_val': 0.6461039707511659, 'auprc': 0.8866544081551714, 'loss_val': 1.381394351480487, 'psi': 0.7423241457127681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=68 head_norm_before_train=1.841392 cos_to_last_merge=0.8895 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.7200446381060452, 'auprc': 0.7568425588870029, 'loss_val': 0.9613278319334718, 'psi': 0.7347638064184283}-{'f1_val': 0.7187283724004877, 'auprc': 0.7665462807884448, 'loss_val': 0.879464899480932, 'psi': 0.7378555357556706}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.090404 cos_to_last_merge=0.9324 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.7809928166130815, 'auprc': 0.9536334340842776, 'loss_val': 0.4890017868181887, 'psi': 0.85004906360156}-{'f1_val': 0.9030436675939271, 'auprc': 0.9977979865942832, 'loss_val': 0.1797520870165053, 'psi': 0.9409453951940695}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.878758 cos_to_last_merge=0.7593 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.759
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9396355270352911, 'auprc': 0.9330972983802884, 'loss_val': 0.32599267137900995, 'psi': 0.9370202355732901}-{'f1_val': 0.9406995528886373, 'auprc': 0.9423770164969053, 'loss_val': 0.3288843061798917, 'psi': 0.9413705383319445}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.533331 cos_to_last_merge=0.8343 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.834
[S5] round=68 local utility u=0.137891 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9786092406297106, 'loss_val': 0.27717966172573516, 'psi': 0.8116882291838124}-{'f1_val': 0.700407554886547, 'auprc': 0.9167359245732568, 'loss_val': 0.36734108801433324, 'psi': 0.786938902761231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=68 head_norm_before_train=1.793416 cos_to_last_merge=0.8211 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.821
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.7138836018004556, 'auprc': 0.952178103620918, 'loss_val': 0.7387637571283623, 'psi': 0.8092014025286407}-{'f1_val': 0.7440997284928388, 'auprc': 0.9332312717349279, 'loss_val': 0.7040155819228869, 'psi': 0.8197523457896745}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.822167 (no previous merge yet)
[S7] round=68 local utility u=0.319344 metrics={'f1_val': 0.6611218246774034, 'auprc': 0.8011438685711098, 'loss_val': 0.452346496626248, 'psi': 0.717130642234886}-{'f1_val': 0.6131458999489334, 'auprc': 0.7836237695105712, 'loss_val': 0.7506196151045891, 'psi': 0.6813370477735885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=68 head_norm_before_train=1.928839 cos_to_last_merge=0.9428 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=68 local utility u=0.002655 metrics={'f1_val': 0.9935325668363719, 'auprc': 0.9995841304282436, 'loss_val': 0.026701861453690003, 'psi': 0.9959531922731206}-{'f1_val': 0.9928127407686298, 'auprc': 0.9996745301520684, 'loss_val': 0.027964062975639217, 'psi': 0.9955574565220052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=68 head_norm_before_train=2.069591 cos_to_last_merge=0.7898 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=68 local utility u=0.002349 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9988152808239172, 'loss_val': 0.03012371802733217, 'psi': 0.9938572355381629}-{'f1_val': 0.9905410059937811, 'auprc': 0.9988124119559761, 'loss_val': 0.03474811073316514, 'psi': 0.9938495683786592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=68 head_norm_before_train=1.992576 cos_to_last_merge=0.8565 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=68 local utility u=0.000373 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921640697854055, 'loss_val': 0.026919235251909073, 'psi': 0.9939783313257871}-{'f1_val': 0.9951878390193748, 'auprc': 0.992018962132746, 'loss_val': 0.02722988183324532, 'psi': 0.9939202882647232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=68 head_norm_before_train=1.884708 cos_to_last_merge=0.8860 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.886
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.8092361931407804, 'auprc': 0.9984619976808792, 'loss_val': 0.4005422837863796, 'psi': 0.88492651495682}-{'f1_val': 0.9958937036982921, 'auprc': 0.9989503996686137, 'loss_val': 0.019858342389069254, 'psi': 0.9971163820864208}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.578161 cos_to_last_merge=0.8902 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.890
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6751615654764056, 'auprc': 0.7983564680892006, 'loss_val': 0.7302820659584712, 'psi': 0.7244395265215235}-{'f1_val': 0.7424827587875082, 'auprc': 0.8128262688581753, 'loss_val': 0.7325514840412997, 'psi': 0.7706201628157752}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=1.974880 cos_to_last_merge=0.9459 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9347692789129906, 'auprc': 0.9988549175517129, 'loss_val': 0.16288402160132306, 'psi': 0.9604035343684796}-{'f1_val': 0.9982111419559175, 'auprc': 0.999171299453909, 'loss_val': 0.01933455834745187, 'psi': 0.9985952049551141}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.973678 cos_to_last_merge=0.9429 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.9033183004617408, 'auprc': 0.9974510473113942, 'loss_val': 0.19451865924337033, 'psi': 0.9409713992016021}-{'f1_val': 0.9967466683875206, 'auprc': 0.9986372838187115, 'loss_val': 0.017666075522647557, 'psi': 0.997502914559997}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=2.117191 (no previous merge yet)
[S16] round=68 local utility u=0.151809 metrics={'f1_val': 0.9200985978776814, 'auprc': 0.9828010615585032, 'loss_val': 0.5105208606640308, 'psi': 0.9451795833500101}-{'f1_val': 0.9206964495611943, 'auprc': 0.8878491238834718, 'loss_val': 0.532870212269458, 'psi': 0.9075575192901053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=68 head_norm_before_train=1.861753 cos_to_last_merge=0.8832 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.883
[S17] round=68 local utility u=0.379688 metrics={'f1_val': 0.7359773341316164, 'auprc': 0.8758757508737879, 'loss_val': 0.8416723216001012, 'psi': 0.791936700828485}-{'f1_val': 0.6742840229780949, 'auprc': 0.8770016223890678, 'loss_val': 1.2342653362679228, 'psi': 0.7553710627424841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] sending update (kind=head size=1809 to 1 peers)
[S2] START round=69 head_norm_before_train=1.849910 cos_to_last_merge=0.8884 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.888
[S2] round=69 local utility u=0.004367 metrics={'f1_val': 0.7201296721664179, 'auprc': 0.7648177082850006, 'loss_val': 0.977028657810187, 'psi': 0.738004886613851}-{'f1_val': 0.7200446381060452, 'auprc': 0.7568425588870029, 'loss_val': 0.9613278319334718, 'psi': 0.7347638064184283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=69 head_norm_before_train=2.094524 cos_to_last_merge=0.9321 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=69 local utility u=0.385991 metrics={'f1_val': 0.8527033374349052, 'auprc': 0.9981398897071212, 'loss_val': 0.28080282571533455, 'psi': 0.9108779583437916}-{'f1_val': 0.7809928166130815, 'auprc': 0.9536334340842776, 'loss_val': 0.4890017868181887, 'psi': 0.85004906360156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=69 head_norm_before_train=1.881597 cos_to_last_merge=0.7591 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.759
[S4] round=69 local utility u=0.046629 metrics={'f1_val': 0.9429164436953071, 'auprc': 0.9471462226013097, 'loss_val': 0.29456610971382885, 'psi': 0.9446083552577081}-{'f1_val': 0.9396355270352911, 'auprc': 0.9330972983802884, 'loss_val': 0.32599267137900995, 'psi': 0.9370202355732901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=69 head_norm_before_train=1.534224 cos_to_last_merge=0.8340 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.834
[S5] round=69 local utility u=0.247202 metrics={'f1_val': 0.7848254691823995, 'auprc': 0.9671600394859108, 'loss_val': 0.2549357773659128, 'psi': 0.857759297303804}-{'f1_val': 0.700407554886547, 'auprc': 0.9786092406297106, 'loss_val': 0.27717966172573516, 'psi': 0.8116882291838124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=69 head_norm_before_train=1.797854 cos_to_last_merge=0.8203 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.820
[S6] round=69 local utility u=0.424418 metrics={'f1_val': 0.8175209287667538, 'auprc': 0.9550085629317742, 'loss_val': 0.5202429366616369, 'psi': 0.872515982432762}-{'f1_val': 0.7138836018004556, 'auprc': 0.952178103620918, 'loss_val': 0.7387637571283623, 'psi': 0.8092014025286407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=69 head_norm_before_train=1.822833 (no previous merge yet)
[S7] round=69 local utility u=0.130101 metrics={'f1_val': 0.6709058034566482, 'auprc': 0.8293687584372004, 'loss_val': 0.33552210680494926, 'psi': 0.7342909854488691}-{'f1_val': 0.6611218246774034, 'auprc': 0.8011438685711098, 'loss_val': 0.452346496626248, 'psi': 0.717130642234886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=69 head_norm_before_train=1.935085 cos_to_last_merge=0.9425 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9906408182937092, 'auprc': 0.9996587014853319, 'loss_val': 0.03270150498248782, 'psi': 0.9942479715703583}-{'f1_val': 0.9935325668363719, 'auprc': 0.9995841304282436, 'loss_val': 0.026701861453690003, 'psi': 0.9959531922731206}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=2.075207 cos_to_last_merge=0.7892 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.789
[S9] round=69 local utility u=0.018908 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9954073578274208, 'loss_val': 0.018735762409747142, 'psi': 0.9961592502193032}-{'f1_val': 0.9905518720143266, 'auprc': 0.9988152808239172, 'loss_val': 0.03012371802733217, 'psi': 0.9938572355381629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=69 head_norm_before_train=1.995143 cos_to_last_merge=0.8564 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=69 local utility u=0.001860 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9933457908389434, 'loss_val': 0.02674407755065283, 'psi': 0.9944510197472022}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921640697854055, 'loss_val': 0.026919235251909073, 'psi': 0.9939783313257871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=69 head_norm_before_train=1.888052 cos_to_last_merge=0.8856 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.886
[S11] round=69 local utility u=0.737634 metrics={'f1_val': 0.9929514124583878, 'auprc': 0.9988225034913868, 'loss_val': 0.028647867113683365, 'psi': 0.9952998488715874}-{'f1_val': 0.8092361931407804, 'auprc': 0.9984619976808792, 'loss_val': 0.4005422837863796, 'psi': 0.88492651495682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=69 head_norm_before_train=1.585067 cos_to_last_merge=0.8893 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.889
[S13] round=69 local utility u=0.124841 metrics={'f1_val': 0.7221912899013208, 'auprc': 0.8077168031655989, 'loss_val': 0.7908601859770793, 'psi': 0.756401495207032}-{'f1_val': 0.6751615654764056, 'auprc': 0.7983564680892006, 'loss_val': 0.7302820659584712, 'psi': 0.7244395265215235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=69 head_norm_before_train=1.978563 cos_to_last_merge=0.9453 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=69 local utility u=0.105166 metrics={'f1_val': 0.9544845288706083, 'auprc': 0.9992356596863984, 'loss_val': 0.0719850060792358, 'psi': 0.9723849811969243}-{'f1_val': 0.9347692789129906, 'auprc': 0.9988549175517129, 'loss_val': 0.16288402160132306, 'psi': 0.9604035343684796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=69 head_norm_before_train=1.979970 cos_to_last_merge=0.9424 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.9014745293525864, 'auprc': 0.996944754165793, 'loss_val': 0.2111579804632886, 'psi': 0.9396626192778691}-{'f1_val': 0.9033183004617408, 'auprc': 0.9974510473113942, 'loss_val': 0.19451865924337033, 'psi': 0.9409713992016021}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=2.120784 (no previous merge yet)
[S16] round=69 local utility u=0.027281 metrics={'f1_val': 0.921218003003813, 'auprc': 0.9901303311598864, 'loss_val': 0.4846632499600676, 'psi': 0.9487829342662423}-{'f1_val': 0.9200985978776814, 'auprc': 0.9828010615585032, 'loss_val': 0.5105208606640308, 'psi': 0.9451795833500101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=69 head_norm_before_train=1.867126 cos_to_last_merge=0.8827 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.883
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.6584505490885669, 'auprc': 0.8911814581225166, 'loss_val': 1.3364921436459463, 'psi': 0.7515429127021468}-{'f1_val': 0.7359773341316164, 'auprc': 0.8758757508737879, 'loss_val': 0.8416723216001012, 'psi': 0.791936700828485}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=1.857673 cos_to_last_merge=0.8876 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.888
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.7189279632319854, 'auprc': 0.724270452827096, 'loss_val': 1.0272841212645833, 'psi': 0.7210649590700295}-{'f1_val': 0.7201296721664179, 'auprc': 0.7648177082850006, 'loss_val': 0.977028657810187, 'psi': 0.738004886613851}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=2.097044 cos_to_last_merge=0.9320 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.7375462956328547, 'auprc': 0.9905359397334427, 'loss_val': 0.6141022373504538, 'psi': 0.8387421532730899}-{'f1_val': 0.8527033374349052, 'auprc': 0.9981398897071212, 'loss_val': 0.28080282571533455, 'psi': 0.9108779583437916}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=1.880195 cos_to_last_merge=0.7589 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.759
[S4] round=70 local utility u=0.000000 metrics={'f1_val': 0.9407511639296118, 'auprc': 0.9309146942345312, 'loss_val': 0.3019466873440675, 'psi': 0.9368165760515796}-{'f1_val': 0.9429164436953071, 'auprc': 0.9471462226013097, 'loss_val': 0.29456610971382885, 'psi': 0.9446083552577081}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=70 head_norm_before_train=1.537127 cos_to_last_merge=0.8333 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.6174272759386205, 'auprc': 0.8567276961556279, 'loss_val': 0.6235676650469253, 'psi': 0.7131474440254235}-{'f1_val': 0.7848254691823995, 'auprc': 0.9671600394859108, 'loss_val': 0.2549357773659128, 'psi': 0.857759297303804}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=1.804058 cos_to_last_merge=0.8194 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.819
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.7690417112677937, 'auprc': 0.9567642600692973, 'loss_val': 0.500890003446149, 'psi': 0.8441307307883952}-{'f1_val': 0.8175209287667538, 'auprc': 0.9550085629317742, 'loss_val': 0.5202429366616369, 'psi': 0.872515982432762}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.831152 (no previous merge yet)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.6554779988510192, 'auprc': 0.8038289043522591, 'loss_val': 0.5263566470912173, 'psi': 0.7148183610515151}-{'f1_val': 0.6709058034566482, 'auprc': 0.8293687584372004, 'loss_val': 0.33552210680494926, 'psi': 0.7342909854488691}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=1.939394 cos_to_last_merge=0.9421 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9709570503949985, 'auprc': 0.9995791726383954, 'loss_val': 0.08161335294395418, 'psi': 0.9824058992923572}-{'f1_val': 0.9906408182937092, 'auprc': 0.9996587014853319, 'loss_val': 0.03270150498248782, 'psi': 0.9942479715703583}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.081405 cos_to_last_merge=0.7887 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.789
[S9] round=70 local utility u=0.003797 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9988098007077847, 'loss_val': 0.01886317682459831, 'psi': 0.9972715892626454}-{'f1_val': 0.9966605118138915, 'auprc': 0.9954073578274208, 'loss_val': 0.018735762409747142, 'psi': 0.9961592502193032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=70 head_norm_before_train=1.999344 cos_to_last_merge=0.8561 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9922875274340663, 'loss_val': 0.02681019830734274, 'psi': 0.9940277143852514}-{'f1_val': 0.9951878390193748, 'auprc': 0.9933457908389434, 'loss_val': 0.02674407755065283, 'psi': 0.9944510197472022}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=70 head_norm_before_train=1.893449 cos_to_last_merge=0.8851 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.885
[S11] round=70 local utility u=0.015785 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984473977231503, 'loss_val': 0.01752599443508942, 'psi': 0.9973071617974139}-{'f1_val': 0.9929514124583878, 'auprc': 0.9988225034913868, 'loss_val': 0.028647867113683365, 'psi': 0.9952998488715874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=70 head_norm_before_train=1.591803 cos_to_last_merge=0.8882 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.888
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6342167882447085, 'auprc': 0.7926568112965686, 'loss_val': 0.8296891881406494, 'psi': 0.6975927974654526}-{'f1_val': 0.7221912899013208, 'auprc': 0.8077168031655989, 'loss_val': 0.7908601859770793, 'psi': 0.756401495207032}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=1.984815 cos_to_last_merge=0.9447 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=70 local utility u=0.085229 metrics={'f1_val': 0.9782232826213212, 'auprc': 0.9992359127287483, 'loss_val': 0.043960414460699766, 'psi': 0.986628334664292}-{'f1_val': 0.9544845288706083, 'auprc': 0.9992356596863984, 'loss_val': 0.0719850060792358, 'psi': 0.9723849811969243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=70 head_norm_before_train=1.986024 cos_to_last_merge=0.9418 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=70 local utility u=0.381093 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979778639604344, 'loss_val': 0.023703616641872902, 'psi': 0.9972391466166861}-{'f1_val': 0.9014745293525864, 'auprc': 0.996944754165793, 'loss_val': 0.2111579804632886, 'psi': 0.9396626192778691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=70 head_norm_before_train=2.122128 (no previous merge yet)
[S16] round=70 local utility u=0.012385 metrics={'f1_val': 0.9234888604733575, 'auprc': 0.990185160966716, 'loss_val': 0.4736834959194862, 'psi': 0.950167380670701}-{'f1_val': 0.921218003003813, 'auprc': 0.9901303311598864, 'loss_val': 0.4846632499600676, 'psi': 0.9487829342662423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=70 head_norm_before_train=1.871805 cos_to_last_merge=0.8822 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.882
[S17] round=70 local utility u=0.161237 metrics={'f1_val': 0.6867501229624198, 'auprc': 0.8813079346164956, 'loss_val': 1.1541942520085584, 'psi': 0.7645732476240501}-{'f1_val': 0.6584505490885669, 'auprc': 0.8911814581225166, 'loss_val': 1.3364921436459463, 'psi': 0.7515429127021468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=71 head_norm_before_train=1.862306 cos_to_last_merge=0.8871 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.887
[S2] round=71 local utility u=0.107822 metrics={'f1_val': 0.7188604350012351, 'auprc': 0.7777999634233541, 'loss_val': 0.9718232293712724, 'psi': 0.7424362463700827}-{'f1_val': 0.7189279632319854, 'auprc': 0.724270452827096, 'loss_val': 1.0272841212645833, 'psi': 0.7210649590700295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=71 head_norm_before_train=2.100510 cos_to_last_merge=0.9317 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.7086014061759687, 'auprc': 0.9679230869930574, 'loss_val': 0.686359180461126, 'psi': 0.8123300785028043}-{'f1_val': 0.7375462956328547, 'auprc': 0.9905359397334427, 'loss_val': 0.6141022373504538, 'psi': 0.8387421532730899}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.879057 cos_to_last_merge=0.7583 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.758
[S4] round=71 local utility u=0.011294 metrics={'f1_val': 0.9406661322794028, 'auprc': 0.9425719524358559, 'loss_val': 0.3138200863448502, 'psi': 0.941428460341984}-{'f1_val': 0.9407511639296118, 'auprc': 0.9309146942345312, 'loss_val': 0.3019466873440675, 'psi': 0.9368165760515796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=71 head_norm_before_train=1.539960 cos_to_last_merge=0.8329 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=71 local utility u=0.374187 metrics={'f1_val': 0.6973999557049076, 'auprc': 0.8761565305554044, 'loss_val': 0.413316875202484, 'psi': 0.7689025856451064}-{'f1_val': 0.6174272759386205, 'auprc': 0.8567276961556279, 'loss_val': 0.6235676650469253, 'psi': 0.7131474440254235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=71 head_norm_before_train=1.812677 cos_to_last_merge=0.8188 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.819
[S6] round=71 local utility u=0.272091 metrics={'f1_val': 0.8458810819720586, 'auprc': 0.9487880089077899, 'loss_val': 0.3938156521500795, 'psi': 0.8870438527463511}-{'f1_val': 0.7690417112677937, 'auprc': 0.9567642600692973, 'loss_val': 0.500890003446149, 'psi': 0.8441307307883952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=71 head_norm_before_train=1.840510 (no previous merge yet)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.6052454820400213, 'auprc': 0.7948669347846862, 'loss_val': 0.829098579289086, 'psi': 0.6810940631378872}-{'f1_val': 0.6554779988510192, 'auprc': 0.8038289043522591, 'loss_val': 0.5263566470912173, 'psi': 0.7148183610515151}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=1.942035 cos_to_last_merge=0.9416 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=71 local utility u=0.069362 metrics={'f1_val': 0.9911766515107343, 'auprc': 0.9924873629240433, 'loss_val': 0.042931394380347355, 'psi': 0.9917009360760579}-{'f1_val': 0.9709570503949985, 'auprc': 0.9995791726383954, 'loss_val': 0.08161335294395418, 'psi': 0.9824058992923572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=71 head_norm_before_train=2.087532 cos_to_last_merge=0.7885 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9988107305796263, 'loss_val': 0.02334306598982461, 'psi': 0.9958701565675221}-{'f1_val': 0.9962461149658858, 'auprc': 0.9988098007077847, 'loss_val': 0.01886317682459831, 'psi': 0.9972715892626454}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.004369 cos_to_last_merge=0.8556 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.992150410448969, 'loss_val': 0.02687766646064764, 'psi': 0.9939728675912125}-{'f1_val': 0.9951878390193748, 'auprc': 0.9922875274340663, 'loss_val': 0.02681019830734274, 'psi': 0.9940277143852514}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=1.899961 cos_to_last_merge=0.8847 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.885
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984943279672416, 'loss_val': 0.01840203103419645, 'psi': 0.9973259338950504}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984473977231503, 'loss_val': 0.01752599443508942, 'psi': 0.9973071617974139}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.598567 cos_to_last_merge=0.8871 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=71 local utility u=0.168600 metrics={'f1_val': 0.6741670938103119, 'auprc': 0.8194348344779445, 'loss_val': 0.8125244240905772, 'psi': 0.7322741900773649}-{'f1_val': 0.6342167882447085, 'auprc': 0.7926568112965686, 'loss_val': 0.8296891881406494, 'psi': 0.6975927974654526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=71 head_norm_before_train=1.987698 cos_to_last_merge=0.9447 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9556296486367702, 'auprc': 0.9987492560710516, 'loss_val': 0.07941382662490232, 'psi': 0.9728774916104828}-{'f1_val': 0.9782232826213212, 'auprc': 0.9992359127287483, 'loss_val': 0.043960414460699766, 'psi': 0.986628334664292}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=1.991981 cos_to_last_merge=0.9413 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=71 local utility u=0.005738 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9988351093741747, 'loss_val': 0.017023585527296048, 'psi': 0.99780439586653}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979778639604344, 'loss_val': 0.023703616641872902, 'psi': 0.9972391466166861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=71 head_norm_before_train=2.124091 (no previous merge yet)
[S16] round=71 local utility u=0.022492 metrics={'f1_val': 0.9266166475239845, 'auprc': 0.9902929658025399, 'loss_val': 0.4477898155113634, 'psi': 0.9520871748354067}-{'f1_val': 0.9234888604733575, 'auprc': 0.990185160966716, 'loss_val': 0.4736834959194862, 'psi': 0.950167380670701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=71 head_norm_before_train=1.877742 cos_to_last_merge=0.8817 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.882
[S17] round=71 local utility u=0.201157 metrics={'f1_val': 0.7189995252616123, 'auprc': 0.8846520514663423, 'loss_val': 0.9554085743002072, 'psi': 0.7852605357435043}-{'f1_val': 0.6867501229624198, 'auprc': 0.8813079346164956, 'loss_val': 1.1541942520085584, 'psi': 0.7645732476240501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] sending update (kind=head size=1809 to 1 peers)
[S2] START round=72 head_norm_before_train=1.865644 cos_to_last_merge=0.8867 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.887
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7198204826185411, 'auprc': 0.7471110360558467, 'loss_val': 0.960538859104976, 'psi': 0.7307367039934634}-{'f1_val': 0.7188604350012351, 'auprc': 0.7777999634233541, 'loss_val': 0.9718232293712724, 'psi': 0.7424362463700827}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.104218 cos_to_last_merge=0.9314 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=72 local utility u=0.355990 metrics={'f1_val': 0.7996088143074165, 'auprc': 0.9549403347720375, 'loss_val': 0.4814746886825831, 'psi': 0.8617414224932649}-{'f1_val': 0.7086014061759687, 'auprc': 0.9679230869930574, 'loss_val': 0.686359180461126, 'psi': 0.8123300785028043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=72 head_norm_before_train=1.881355 cos_to_last_merge=0.7574 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.757
[S4] round=72 local utility u=0.009583 metrics={'f1_val': 0.9416922315000537, 'auprc': 0.9427360107548985, 'loss_val': 0.3013033528035866, 'psi': 0.9421097432019916}-{'f1_val': 0.9406661322794028, 'auprc': 0.9425719524358559, 'loss_val': 0.3138200863448502, 'psi': 0.941428460341984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=72 head_norm_before_train=1.543827 cos_to_last_merge=0.8330 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=72 local utility u=0.298977 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.992830227370199, 'loss_val': 0.18291152343963774, 'psi': 0.8173248814084279}-{'f1_val': 0.6973999557049076, 'auprc': 0.8761565305554044, 'loss_val': 0.413316875202484, 'psi': 0.7689025856451064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=72 head_norm_before_train=1.824783 cos_to_last_merge=0.8186 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.819
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.6800365380711041, 'auprc': 0.9059837334818794, 'loss_val': 0.7264398771090231, 'psi': 0.7704154162354142}-{'f1_val': 0.8458810819720586, 'auprc': 0.9487880089077899, 'loss_val': 0.3938156521500795, 'psi': 0.8870438527463511}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=1.848186 (no previous merge yet)
[S7] round=72 local utility u=0.060195 metrics={'f1_val': 0.611699760931618, 'auprc': 0.7957386341210193, 'loss_val': 0.7500497726306798, 'psi': 0.6853153102073786}-{'f1_val': 0.6052454820400213, 'auprc': 0.7948669347846862, 'loss_val': 0.829098579289086, 'psi': 0.6810940631378872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=72 head_norm_before_train=1.945034 cos_to_last_merge=0.9414 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.974263738691655, 'auprc': 0.9944444990988088, 'loss_val': 0.06562109189939093, 'psi': 0.9823360428545165}-{'f1_val': 0.9911766515107343, 'auprc': 0.9924873629240433, 'loss_val': 0.042931394380347355, 'psi': 0.9917009360760579}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=2.089730 cos_to_last_merge=0.7878 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9908021981609972, 'auprc': 0.9987955031721851, 'loss_val': 0.028963649529483923, 'psi': 0.9939995201654723}-{'f1_val': 0.993909773892786, 'auprc': 0.9988107305796263, 'loss_val': 0.02334306598982461, 'psi': 0.9958701565675221}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.009886 cos_to_last_merge=0.8550 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.855
[S10] round=72 local utility u=0.000360 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9923501027601263, 'loss_val': 0.026756296012253305, 'psi': 0.9940527445156753}-{'f1_val': 0.9951878390193748, 'auprc': 0.992150410448969, 'loss_val': 0.02687766646064764, 'psi': 0.9939728675912125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=72 head_norm_before_train=1.906664 cos_to_last_merge=0.8842 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.884
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9963079617129205, 'auprc': 0.9988275965035164, 'loss_val': 0.019289814403846875, 'psi': 0.9973158156291588}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984943279672416, 'loss_val': 0.01840203103419645, 'psi': 0.9973259338950504}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.603739 cos_to_last_merge=0.8862 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=72 local utility u=0.214920 metrics={'f1_val': 0.7271123491487422, 'auprc': 0.7931412869291661, 'loss_val': 0.6214745681020878, 'psi': 0.7535239242609117}-{'f1_val': 0.6741670938103119, 'auprc': 0.8194348344779445, 'loss_val': 0.8125244240905772, 'psi': 0.7322741900773649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=72 head_norm_before_train=1.991665 cos_to_last_merge=0.9446 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=72 local utility u=0.158083 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992319810313515, 'loss_val': 0.017849511526012773, 'psi': 0.998385848025196}-{'f1_val': 0.9556296486367702, 'auprc': 0.9987492560710516, 'loss_val': 0.07941382662490232, 'psi': 0.9728774916104828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=72 head_norm_before_train=1.998142 cos_to_last_merge=0.9408 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=72 local utility u=0.000459 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9990854704619788, 'loss_val': 0.016856339146801756, 'psi': 0.9979045403016517}-{'f1_val': 0.9971172535281002, 'auprc': 0.9988351093741747, 'loss_val': 0.017023585527296048, 'psi': 0.99780439586653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=72 head_norm_before_train=2.128302 (no previous merge yet)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9236974101006137, 'auprc': 0.9903553286855931, 'loss_val': 0.47059906626262155, 'psi': 0.9503605775346055}-{'f1_val': 0.9266166475239845, 'auprc': 0.9902929658025399, 'loss_val': 0.4477898155113634, 'psi': 0.9520871748354067}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=1.886877 cos_to_last_merge=0.8810 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.881
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.6703947137524386, 'auprc': 0.8958418478497843, 'loss_val': 1.3436600353239192, 'psi': 0.7605735673913769}-{'f1_val': 0.7189995252616123, 'auprc': 0.8846520514663423, 'loss_val': 0.9554085743002072, 'psi': 0.7852605357435043}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=1.868529 cos_to_last_merge=0.8864 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=73 local utility u=0.052578 metrics={'f1_val': 0.7185709051606113, 'auprc': 0.7842706366227359, 'loss_val': 0.9593639164472215, 'psi': 0.744850797745461}-{'f1_val': 0.7198204826185411, 'auprc': 0.7471110360558467, 'loss_val': 0.960538859104976, 'psi': 0.7307367039934634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=73 head_norm_before_train=2.108978 cos_to_last_merge=0.9309 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=73 local utility u=0.152800 metrics={'f1_val': 0.8210981336403724, 'auprc': 0.979648420887526, 'loss_val': 0.3789341983266978, 'psi': 0.8845182485392339}-{'f1_val': 0.7996088143074165, 'auprc': 0.9549403347720375, 'loss_val': 0.4814746886825831, 'psi': 0.8617414224932649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=73 head_norm_before_train=1.886013 cos_to_last_merge=0.7567 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.757
[S4] round=73 local utility u=0.001348 metrics={'f1_val': 0.9419206170733077, 'auprc': 0.9429767945754739, 'loss_val': 0.300699258724187, 'psi': 0.9423430880741741}-{'f1_val': 0.9416922315000537, 'auprc': 0.9427360107548985, 'loss_val': 0.3013033528035866, 'psi': 0.9421097432019916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=73 head_norm_before_train=1.548637 cos_to_last_merge=0.8329 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.666373203199326, 'auprc': 0.8611079646720228, 'loss_val': 0.5044164758610787, 'psi': 0.7442671077884047}-{'f1_val': 0.7003213174339138, 'auprc': 0.992830227370199, 'loss_val': 0.18291152343963774, 'psi': 0.8173248814084279}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=1.833131 cos_to_last_merge=0.8182 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.818
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6390974078558712, 'auprc': 0.8941671130441705, 'loss_val': 0.8461986879698777, 'psi': 0.7411252899311909}-{'f1_val': 0.6800365380711041, 'auprc': 0.9059837334818794, 'loss_val': 0.7264398771090231, 'psi': 0.7704154162354142}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.853503 (no previous merge yet)
[S7] round=73 local utility u=0.356814 metrics={'f1_val': 0.6626593548862659, 'auprc': 0.8179791063828585, 'loss_val': 0.408901739890125, 'psi': 0.724787255484903}-{'f1_val': 0.611699760931618, 'auprc': 0.7957386341210193, 'loss_val': 0.7500497726306798, 'psi': 0.6853153102073786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=73 head_norm_before_train=1.945763 cos_to_last_merge=0.9418 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9693027211960918, 'auprc': 0.9936573252642721, 'loss_val': 0.09162884760661029, 'psi': 0.9790445628233639}-{'f1_val': 0.974263738691655, 'auprc': 0.9944444990988088, 'loss_val': 0.06562109189939093, 'psi': 0.9823360428545165}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=2.090676 cos_to_last_merge=0.7872 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.787
[S9] round=73 local utility u=0.018097 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956432116811623, 'loss_val': 0.01846262167665607, 'psi': 0.9962535917607998}-{'f1_val': 0.9908021981609972, 'auprc': 0.9987955031721851, 'loss_val': 0.028963649529483923, 'psi': 0.9939995201654723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=73 head_norm_before_train=2.015548 cos_to_last_merge=0.8545 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.854
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921474527175279, 'loss_val': 0.026833196556511146, 'psi': 0.9939716844986359}-{'f1_val': 0.9951878390193748, 'auprc': 0.9923501027601263, 'loss_val': 0.026756296012253305, 'psi': 0.9940527445156753}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=1.913201 cos_to_last_merge=0.8837 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.884
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9548405990891691, 'auprc': 0.9991185995852421, 'loss_val': 0.17698869478901116, 'psi': 0.9725517992875983}-{'f1_val': 0.9963079617129205, 'auprc': 0.9988275965035164, 'loss_val': 0.019289814403846875, 'psi': 0.9973158156291588}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.608413 cos_to_last_merge=0.8854 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.6313532089033989, 'auprc': 0.7829598974253726, 'loss_val': 0.9303016986108016, 'psi': 0.6919958843121883}-{'f1_val': 0.7271123491487422, 'auprc': 0.7931412869291661, 'loss_val': 0.6214745681020878, 'psi': 0.7535239242609117}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=1.995205 cos_to_last_merge=0.9443 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9969374045495891, 'loss_val': 0.019629083733993635, 'psi': 0.9972215583805326}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992319810313515, 'loss_val': 0.017849511526012773, 'psi': 0.998385848025196}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=2.004289 cos_to_last_merge=0.9403 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985520352742125, 'loss_val': 0.017340120146160376, 'psi': 0.9974688151421973}-{'f1_val': 0.9971172535281002, 'auprc': 0.9990854704619788, 'loss_val': 0.016856339146801756, 'psi': 0.9979045403016517}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=2.133856 (no previous merge yet)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9232803052933249, 'auprc': 0.9909075158077612, 'loss_val': 0.476645854942524, 'psi': 0.9503311894990994}-{'f1_val': 0.9236974101006137, 'auprc': 0.9903553286855931, 'loss_val': 0.47059906626262155, 'psi': 0.9503605775346055}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=1.895633 cos_to_last_merge=0.8801 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=73 local utility u=0.243678 metrics={'f1_val': 0.6970570374933706, 'auprc': 0.8972929939359414, 'loss_val': 1.020631849882688, 'psi': 0.7771514200703988}-{'f1_val': 0.6703947137524386, 'auprc': 0.8958418478497843, 'loss_val': 1.3436600353239192, 'psi': 0.7605735673913769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=74 head_norm_before_train=1.871715 cos_to_last_merge=0.8862 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=74 local utility u=0.000000 metrics={'f1_val': 0.7199321250250644, 'auprc': 0.7229248933736102, 'loss_val': 1.0320663773124403, 'psi': 0.7211292323644828}-{'f1_val': 0.7185709051606113, 'auprc': 0.7842706366227359, 'loss_val': 0.9593639164472215, 'psi': 0.744850797745461}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=74 head_norm_before_train=2.112422 cos_to_last_merge=0.9306 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=74 local utility u=0.009616 metrics={'f1_val': 0.828006570688097, 'auprc': 0.9696676071921984, 'loss_val': 0.37120992359027605, 'psi': 0.8846709852897375}-{'f1_val': 0.8210981336403724, 'auprc': 0.979648420887526, 'loss_val': 0.3789341983266978, 'psi': 0.8845182485392339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=74 head_norm_before_train=1.895267 cos_to_last_merge=0.7559 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.756
[S4] round=74 local utility u=0.044104 metrics={'f1_val': 0.9447305305141097, 'auprc': 0.9661246952049117, 'loss_val': 0.2987949215419547, 'psi': 0.9532881963904305}-{'f1_val': 0.9419206170733077, 'auprc': 0.9429767945754739, 'loss_val': 0.300699258724187, 'psi': 0.9423430880741741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=74 head_norm_before_train=1.555754 cos_to_last_merge=0.8319 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=74 local utility u=0.920063 metrics={'f1_val': 0.8498517210389029, 'auprc': 0.9915170641147897, 'loss_val': 0.1563885983740236, 'psi': 0.9065178582692576}-{'f1_val': 0.666373203199326, 'auprc': 0.8611079646720228, 'loss_val': 0.5044164758610787, 'psi': 0.7442671077884047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=74 head_norm_before_train=1.840384 cos_to_last_merge=0.8177 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.818
[S6] round=74 local utility u=1.000000 metrics={'f1_val': 0.8662507627971305, 'auprc': 0.9590573387194252, 'loss_val': 0.3840392001388296, 'psi': 0.9033733931660484}-{'f1_val': 0.6390974078558712, 'auprc': 0.8941671130441705, 'loss_val': 0.8461986879698777, 'psi': 0.7411252899311909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=74 head_norm_before_train=1.857782 (no previous merge yet)
[S7] round=74 local utility u=0.079944 metrics={'f1_val': 0.6671229978993322, 'auprc': 0.8347519237309541, 'loss_val': 0.32611431661524026, 'psi': 0.7341745682319809}-{'f1_val': 0.6626593548862659, 'auprc': 0.8179791063828585, 'loss_val': 0.408901739890125, 'psi': 0.724787255484903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=74 head_norm_before_train=1.948835 cos_to_last_merge=0.9419 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=74 local utility u=0.092275 metrics={'f1_val': 0.9895116842672763, 'auprc': 0.9967165935175435, 'loss_val': 0.0375095996533023, 'psi': 0.9923936479673832}-{'f1_val': 0.9693027211960918, 'auprc': 0.9936573252642721, 'loss_val': 0.09162884760661029, 'psi': 0.9790445628233639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=74 head_norm_before_train=2.094764 cos_to_last_merge=0.7865 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=74 local utility u=0.000725 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9987958382662006, 'loss_val': 0.019002456522774377, 'psi': 0.9967678348284517}-{'f1_val': 0.9966605118138915, 'auprc': 0.9956432116811623, 'loss_val': 0.01846262167665607, 'psi': 0.9962535917607998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=74 head_norm_before_train=2.021204 cos_to_last_merge=0.8539 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.854
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9920758722161254, 'loss_val': 0.0269839193685576, 'psi': 0.993943052298075}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921474527175279, 'loss_val': 0.026833196556511146, 'psi': 0.9939716844986359}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=1.919719 cos_to_last_merge=0.8833 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=74 local utility u=0.204018 metrics={'f1_val': 0.9961344836672389, 'auprc': 0.9991562101403867, 'loss_val': 0.016828137825449563, 'psi': 0.997343174256498}-{'f1_val': 0.9548405990891691, 'auprc': 0.9991185995852421, 'loss_val': 0.17698869478901116, 'psi': 0.9725517992875983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=74 head_norm_before_train=1.610985 cos_to_last_merge=0.8851 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=74 local utility u=0.059554 metrics={'f1_val': 0.6127226501066887, 'auprc': 0.8909485697094007, 'loss_val': 1.0233755667375182, 'psi': 0.7240130179477735}-{'f1_val': 0.6313532089033989, 'auprc': 0.7829598974253726, 'loss_val': 0.9303016986108016, 'psi': 0.6919958843121883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=74 head_norm_before_train=2.000373 cos_to_last_merge=0.9439 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9968287715771973, 'loss_val': 0.02078068086659006, 'psi': 0.9971649837566172}-{'f1_val': 0.9974109942678281, 'auprc': 0.9969374045495891, 'loss_val': 0.019629083733993635, 'psi': 0.9972215583805326}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=2.010431 cos_to_last_merge=0.9398 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982520590454435, 'loss_val': 0.018135912808906987, 'psi': 0.9973488246506897}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985520352742125, 'loss_val': 0.017340120146160376, 'psi': 0.9974688151421973}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=2.139064 (no previous merge yet)
[S16] round=74 local utility u=0.002958 metrics={'f1_val': 0.9232803052933249, 'auprc': 0.9923574932600913, 'loss_val': 0.47508010395254163, 'psi': 0.9509111804800314}-{'f1_val': 0.9232803052933249, 'auprc': 0.9909075158077612, 'loss_val': 0.476645854942524, 'psi': 0.9503311894990994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=74 head_norm_before_train=1.901518 cos_to_last_merge=0.8795 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=74 local utility u=0.240909 metrics={'f1_val': 0.7517053956460844, 'auprc': 0.8865027666498972, 'loss_val': 0.8343327059324946, 'psi': 0.8056243440476095}-{'f1_val': 0.6970570374933706, 'auprc': 0.8972929939359414, 'loss_val': 1.020631849882688, 'psi': 0.7771514200703988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S17] sending update (kind=head size=1810 to 1 peers)
[S2] START round=75 head_norm_before_train=1.874943 cos_to_last_merge=0.8859 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=75 local utility u=0.080524 metrics={'f1_val': 0.7198204826185411, 'auprc': 0.7549693700135225, 'loss_val': 0.9664811002670163, 'psi': 0.7338800375765338}-{'f1_val': 0.7199321250250644, 'auprc': 0.7229248933736102, 'loss_val': 1.0320663773124403, 'psi': 0.7211292323644828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=75 head_norm_before_train=2.117265 cos_to_last_merge=0.9301 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=75 local utility u=0.570856 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.999347520321475, 'loss_val': 0.11547534239934419, 'psi': 0.9762367735113282}-{'f1_val': 0.828006570688097, 'auprc': 0.9696676071921984, 'loss_val': 0.37120992359027605, 'psi': 0.8846709852897375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=75 head_norm_before_train=1.901295 cos_to_last_merge=0.7553 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.755
[S4] round=75 local utility u=0.027630 metrics={'f1_val': 0.9525717462483608, 'auprc': 0.967519130220306, 'loss_val': 0.29476466236497567, 'psi': 0.9585506998371389}-{'f1_val': 0.9447305305141097, 'auprc': 0.9661246952049117, 'loss_val': 0.2987949215419547, 'psi': 0.9532881963904305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=75 head_norm_before_train=1.562730 cos_to_last_merge=0.8305 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.5612465722164274, 'auprc': 0.8521976893515836, 'loss_val': 0.8449843531304095, 'psi': 0.6776270190704898}-{'f1_val': 0.8498517210389029, 'auprc': 0.9915170641147897, 'loss_val': 0.1563885983740236, 'psi': 0.9065178582692576}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=1.849287 cos_to_last_merge=0.8169 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.817
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.6119977718442905, 'auprc': 0.9036572692979256, 'loss_val': 1.0392697267618398, 'psi': 0.7286615708257445}-{'f1_val': 0.8662507627971305, 'auprc': 0.9590573387194252, 'loss_val': 0.3840392001388296, 'psi': 0.9033733931660484}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=1.860733 (no previous merge yet)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.599468332508085, 'auprc': 0.7949451050647922, 'loss_val': 0.680692609826545, 'psi': 0.6776590415307678}-{'f1_val': 0.6671229978993322, 'auprc': 0.8347519237309541, 'loss_val': 0.32611431661524026, 'psi': 0.7341745682319809}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=1.954382 cos_to_last_merge=0.9416 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=75 local utility u=0.012031 metrics={'f1_val': 0.9916593272820113, 'auprc': 0.9982738704673848, 'loss_val': 0.03100543446877555, 'psi': 0.9943051445561607}-{'f1_val': 0.9895116842672763, 'auprc': 0.9967165935175435, 'loss_val': 0.0375095996533023, 'psi': 0.9923936479673832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=75 head_norm_before_train=2.098702 cos_to_last_merge=0.7862 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9948793612660215, 'loss_val': 0.01842615582374499, 'psi': 0.9959480515947434}-{'f1_val': 0.9954158325366191, 'auprc': 0.9987958382662006, 'loss_val': 0.019002456522774377, 'psi': 0.9967678348284517}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.026809 cos_to_last_merge=0.8533 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.853
[S10] round=75 local utility u=0.000114 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921123140258704, 'loss_val': 0.026866116356408332, 'psi': 0.9939576290219729}-{'f1_val': 0.9951878390193748, 'auprc': 0.9920758722161254, 'loss_val': 0.0269839193685576, 'psi': 0.993943052298075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=75 head_norm_before_train=1.924215 cos_to_last_merge=0.8829 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9983802813051936, 'loss_val': 0.020865767769545025, 'psi': 0.9972826655191358}-{'f1_val': 0.9961344836672389, 'auprc': 0.9991562101403867, 'loss_val': 0.016828137825449563, 'psi': 0.997343174256498}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=1.613198 cos_to_last_merge=0.8847 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=75 local utility u=0.059079 metrics={'f1_val': 0.6648157238276245, 'auprc': 0.774390193751443, 'loss_val': 0.8681002823374032, 'psi': 0.708645511797152}-{'f1_val': 0.6127226501066887, 'auprc': 0.8909485697094007, 'loss_val': 1.0233755667375182, 'psi': 0.7240130179477735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=75 head_norm_before_train=2.006265 cos_to_last_merge=0.9436 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=75 local utility u=0.000328 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9968005956292229, 'loss_val': 0.020039194729232438, 'psi': 0.9971537133774275}-{'f1_val': 0.9973891252095638, 'auprc': 0.9968287715771973, 'loss_val': 0.02078068086659006, 'psi': 0.9971649837566172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=75 head_norm_before_train=2.016468 cos_to_last_merge=0.9394 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.9016001089992542, 'auprc': 0.9975532660188672, 'loss_val': 0.21297574259263624, 'psi': 0.9399813718070995}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982520590454435, 'loss_val': 0.018135912808906987, 'psi': 0.9973488246506897}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=2.141221 (no previous merge yet)
[S16] round=75 local utility u=0.006408 metrics={'f1_val': 0.9241144935941227, 'auprc': 0.9925607298333969, 'loss_val': 0.46787952495685053, 'psi': 0.9514929880898324}-{'f1_val': 0.9232803052933249, 'auprc': 0.9923574932600913, 'loss_val': 0.47508010395254163, 'psi': 0.9509111804800314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=75 head_norm_before_train=1.908085 cos_to_last_merge=0.8788 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.879
[S17] round=75 local utility u=0.102348 metrics={'f1_val': 0.7906789183519767, 'auprc': 0.8858774273631623, 'loss_val': 0.8616009054171976, 'psi': 0.8287583219564509}-{'f1_val': 0.7517053956460844, 'auprc': 0.8865027666498972, 'loss_val': 0.8343327059324946, 'psi': 0.8056243440476095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=76 head_norm_before_train=1.876603 cos_to_last_merge=0.8860 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=76 local utility u=0.017606 metrics={'f1_val': 0.7188604350012351, 'auprc': 0.7717779653183949, 'loss_val': 0.9759346595728959, 'psi': 0.740027447128099}-{'f1_val': 0.7198204826185411, 'auprc': 0.7549693700135225, 'loss_val': 0.9664811002670163, 'psi': 0.7338800375765338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=76 head_norm_before_train=2.121428 cos_to_last_merge=0.9299 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.999467170191466, 'loss_val': 0.11896556529275068, 'psi': 0.9764560224172778}-{'f1_val': 0.9608296089712303, 'auprc': 0.999347520321475, 'loss_val': 0.11547534239934419, 'psi': 0.9762367735113282}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.903666 cos_to_last_merge=0.7546 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.755
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.9490583314152339, 'auprc': 0.9603099810306296, 'loss_val': 0.3061513583657715, 'psi': 0.9535589912613922}-{'f1_val': 0.9525717462483608, 'auprc': 0.967519130220306, 'loss_val': 0.29476466236497567, 'psi': 0.9585506998371389}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=76 head_norm_before_train=1.568363 cos_to_last_merge=0.8293 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.829
[S5] round=76 local utility u=1.000000 metrics={'f1_val': 0.8630813284118812, 'auprc': 0.984091319596604, 'loss_val': 0.1771780013780262, 'psi': 0.9114853248857704}-{'f1_val': 0.5612465722164274, 'auprc': 0.8521976893515836, 'loss_val': 0.8449843531304095, 'psi': 0.6776270190704898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=76 head_norm_before_train=1.861057 cos_to_last_merge=0.8158 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.816
[S6] round=76 local utility u=0.748100 metrics={'f1_val': 0.7716290574822848, 'auprc': 0.9295965129316732, 'loss_val': 0.5786752942118526, 'psi': 0.8348160396620402}-{'f1_val': 0.6119977718442905, 'auprc': 0.9036572692979256, 'loss_val': 1.0392697267618398, 'psi': 0.7286615708257445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=76 head_norm_before_train=1.863619 (no previous merge yet)
[S7] round=76 local utility u=0.137859 metrics={'f1_val': 0.6228851640357181, 'auprc': 0.8008511125901878, 'loss_val': 0.5631939899625763, 'psi': 0.694071543457506}-{'f1_val': 0.599468332508085, 'auprc': 0.7949451050647922, 'loss_val': 0.680692609826545, 'psi': 0.6776590415307678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=76 head_norm_before_train=1.959180 cos_to_last_merge=0.9411 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9831467042873564, 'auprc': 0.9964018677966582, 'loss_val': 0.05367112592116085, 'psi': 0.9884487696910771}-{'f1_val': 0.9916593272820113, 'auprc': 0.9982738704673848, 'loss_val': 0.03100543446877555, 'psi': 0.9943051445561607}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=76 head_norm_before_train=2.104087 cos_to_last_merge=0.7860 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=76 local utility u=0.005859 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986680260232795, 'loss_val': 0.01807334781464544, 'psi': 0.9974635174976467}-{'f1_val': 0.9966605118138915, 'auprc': 0.9948793612660215, 'loss_val': 0.01842615582374499, 'psi': 0.9959480515947434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=76 head_norm_before_train=2.031618 cos_to_last_merge=0.8529 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.853
[S10] round=76 local utility u=0.000427 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9923412267579423, 'loss_val': 0.026698514845717985, 'psi': 0.9940491941148017}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921123140258704, 'loss_val': 0.026866116356408332, 'psi': 0.9939576290219729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=76 head_norm_before_train=1.927535 cos_to_last_merge=0.8824 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.882
[S11] round=76 local utility u=0.001729 metrics={'f1_val': 0.9963109504467467, 'auprc': 0.9990947261128694, 'loss_val': 0.018112229579025328, 'psi': 0.9974244607131957}-{'f1_val': 0.9965509216617638, 'auprc': 0.9983802813051936, 'loss_val': 0.020865767769545025, 'psi': 0.9972826655191358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=76 head_norm_before_train=1.615337 cos_to_last_merge=0.8844 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.884
[S13] round=76 local utility u=0.408617 metrics={'f1_val': 0.7412261537968068, 'auprc': 0.8058590742075538, 'loss_val': 0.6037348507488803, 'psi': 0.7670793219611056}-{'f1_val': 0.6648157238276245, 'auprc': 0.774390193751443, 'loss_val': 0.8681002823374032, 'psi': 0.708645511797152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=76 head_norm_before_train=2.008933 cos_to_last_merge=0.9433 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9966990970254094, 'loss_val': 0.02011987882567256, 'psi': 0.9971131139359021}-{'f1_val': 0.9973891252095638, 'auprc': 0.9968005956292229, 'loss_val': 0.020039194729232438, 'psi': 0.9971537133774275}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=2.022651 cos_to_last_merge=0.9388 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.9007650301110999, 'auprc': 0.9972168325424736, 'loss_val': 0.2787827598242075, 'psi': 0.9393457510836494}-{'f1_val': 0.9016001089992542, 'auprc': 0.9975532660188672, 'loss_val': 0.21297574259263624, 'psi': 0.9399813718070995}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=2.145393 (no previous merge yet)
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.9253656341444889, 'auprc': 0.9874692561987926, 'loss_val': 0.46647698955272937, 'psi': 0.9502070829662104}-{'f1_val': 0.9241144935941227, 'auprc': 0.9925607298333969, 'loss_val': 0.46787952495685053, 'psi': 0.9514929880898324}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=1.917693 cos_to_last_merge=0.8780 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.878
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.6688288378366702, 'auprc': 0.8809034119134941, 'loss_val': 1.447898858399114, 'psi': 0.7536586674673997}-{'f1_val': 0.7906789183519767, 'auprc': 0.8858774273631623, 'loss_val': 0.8616009054171976, 'psi': 0.8287583219564509}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=77 head_norm_before_train=1.879137 cos_to_last_merge=0.8859 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.7201103021888824, 'auprc': 0.7369526247942607, 'loss_val': 0.9756335366493751, 'psi': 0.7268472312310337}-{'f1_val': 0.7188604350012351, 'auprc': 0.7717779653183949, 'loss_val': 0.9759346595728959, 'psi': 0.740027447128099}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.124674 cos_to_last_merge=0.9296 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=77 local utility u=0.062956 metrics={'f1_val': 0.9735465826090846, 'auprc': 0.9985221668682638, 'loss_val': 0.0648065064396532, 'psi': 0.9835368163127562}-{'f1_val': 0.9611152572344858, 'auprc': 0.999467170191466, 'loss_val': 0.11896556529275068, 'psi': 0.9764560224172778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=77 head_norm_before_train=1.908596 cos_to_last_merge=0.7537 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.754
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9407494442956463, 'auprc': 0.9392334305615033, 'loss_val': 0.3128381471065539, 'psi': 0.9401430388019891}-{'f1_val': 0.9490583314152339, 'auprc': 0.9603099810306296, 'loss_val': 0.3061513583657715, 'psi': 0.9535589912613922}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.567438 cos_to_last_merge=0.8288 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.829
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.6629354093130263, 'auprc': 0.9318063487355313, 'loss_val': 0.42347786316881225, 'psi': 0.7704837850820283}-{'f1_val': 0.8630813284118812, 'auprc': 0.984091319596604, 'loss_val': 0.1771780013780262, 'psi': 0.9114853248857704}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=77 head_norm_before_train=1.870891 cos_to_last_merge=0.8151 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.815
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.6778946701078321, 'auprc': 0.9102808325003753, 'loss_val': 0.715283170672132, 'psi': 0.7708491350648494}-{'f1_val': 0.7716290574822848, 'auprc': 0.9295965129316732, 'loss_val': 0.5786752942118526, 'psi': 0.8348160396620402}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.869395 (no previous merge yet)
[S7] round=77 local utility u=0.663731 metrics={'f1_val': 0.7152897689559026, 'auprc': 0.9345302394027103, 'loss_val': 0.191197131678997, 'psi': 0.8029859571346256}-{'f1_val': 0.6228851640357181, 'auprc': 0.8008511125901878, 'loss_val': 0.5631939899625763, 'psi': 0.694071543457506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=77 head_norm_before_train=1.961310 cos_to_last_merge=0.9409 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=77 local utility u=0.027395 metrics={'f1_val': 0.9898564228592382, 'auprc': 0.9964330149895195, 'loss_val': 0.03923318722485085, 'psi': 0.9924870597113508}-{'f1_val': 0.9831467042873564, 'auprc': 0.9964018677966582, 'loss_val': 0.05367112592116085, 'psi': 0.9884487696910771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=77 head_norm_before_train=2.110566 cos_to_last_merge=0.7858 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9988018552831204, 'loss_val': 0.03955403748277758, 'psi': 0.9932338091840742}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986680260232795, 'loss_val': 0.01807334781464544, 'psi': 0.9974635174976467}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=77 head_norm_before_train=2.034098 cos_to_last_merge=0.8528 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.853
[S10] round=77 local utility u=0.000394 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9926020105255069, 'loss_val': 0.026693398382211814, 'psi': 0.9941535076218275}-{'f1_val': 0.9951878390193748, 'auprc': 0.9923412267579423, 'loss_val': 0.026698514845717985, 'psi': 0.9940491941148017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=77 head_norm_before_train=1.930606 cos_to_last_merge=0.8818 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.882
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9951104163810016, 'auprc': 0.9991627034693776, 'loss_val': 0.022600639925126714, 'psi': 0.9967313312163519}-{'f1_val': 0.9963109504467467, 'auprc': 0.9990947261128694, 'loss_val': 0.018112229579025328, 'psi': 0.9974244607131957}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.617384 cos_to_last_merge=0.8840 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.884
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6759047811513682, 'auprc': 0.8090232470706407, 'loss_val': 0.800729696749888, 'psi': 0.7291521675190772}-{'f1_val': 0.7412261537968068, 'auprc': 0.8058590742075538, 'loss_val': 0.6037348507488803, 'psi': 0.7670793219611056}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=2.012733 cos_to_last_merge=0.9430 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=77 local utility u=0.005476 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9988554277816654, 'loss_val': 0.018102099309016666, 'psi': 0.9982221053785336}-{'f1_val': 0.9973891252095638, 'auprc': 0.9966990970254094, 'loss_val': 0.02011987882567256, 'psi': 0.9971131139359021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=77 head_norm_before_train=2.028585 cos_to_last_merge=0.9383 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=77 local utility u=0.064515 metrics={'f1_val': 0.9037402512786699, 'auprc': 0.9976893160322361, 'loss_val': 0.1690223507639796, 'psi': 0.9413198771800964}-{'f1_val': 0.9007650301110999, 'auprc': 0.9972168325424736, 'loss_val': 0.2787827598242075, 'psi': 0.9393457510836494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=77 head_norm_before_train=2.144647 (no previous merge yet)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.922470093214298, 'auprc': 0.981250208598152, 'loss_val': 0.4983501582228121, 'psi': 0.9459821393678396}-{'f1_val': 0.9253656341444889, 'auprc': 0.9874692561987926, 'loss_val': 0.46647698955272937, 'psi': 0.9502070829662104}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=1.926065 cos_to_last_merge=0.8772 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=77 local utility u=0.012973 metrics={'f1_val': 0.6703172843405065, 'auprc': 0.8815879166257561, 'loss_val': 1.432936663090358, 'psi': 0.7548255372546064}-{'f1_val': 0.6688288378366702, 'auprc': 0.8809034119134941, 'loss_val': 1.447898858399114, 'psi': 0.7536586674673997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=78 head_norm_before_train=1.881973 cos_to_last_merge=0.8857 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=78 local utility u=0.006526 metrics={'f1_val': 0.7201103021888824, 'auprc': 0.7428001239122225, 'loss_val': 0.9801236253804173, 'psi': 0.7291862308782184}-{'f1_val': 0.7201103021888824, 'auprc': 0.7369526247942607, 'loss_val': 0.9756335366493751, 'psi': 0.7268472312310337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=78 head_norm_before_train=2.126562 cos_to_last_merge=0.9293 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.9613192636176109, 'auprc': 0.9977394442281078, 'loss_val': 0.08123392184246332, 'psi': 0.9758873358618096}-{'f1_val': 0.9735465826090846, 'auprc': 0.9985221668682638, 'loss_val': 0.0648065064396532, 'psi': 0.9835368163127562}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=1.908126 cos_to_last_merge=0.7533 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.753
[S4] round=78 local utility u=0.021564 metrics={'f1_val': 0.9430165378442464, 'auprc': 0.9439980293182231, 'loss_val': 0.29760709667356583, 'psi': 0.9434091344338371}-{'f1_val': 0.9407494442956463, 'auprc': 0.9392334305615033, 'loss_val': 0.3128381471065539, 'psi': 0.9401430388019891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=78 head_norm_before_train=1.565897 cos_to_last_merge=0.8287 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.829
[S5] round=78 local utility u=0.666295 metrics={'f1_val': 0.8150977677737443, 'auprc': 0.9913951694151522, 'loss_val': 0.18262772968821325, 'psi': 0.8856167284303075}-{'f1_val': 0.6629354093130263, 'auprc': 0.9318063487355313, 'loss_val': 0.42347786316881225, 'psi': 0.7704837850820283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=78 head_norm_before_train=1.880696 cos_to_last_merge=0.8143 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.814
[S6] round=78 local utility u=0.071691 metrics={'f1_val': 0.7017463416440395, 'auprc': 0.9138199690097607, 'loss_val': 0.7256286961383639, 'psi': 0.7865757925903281}-{'f1_val': 0.6778946701078321, 'auprc': 0.9102808325003753, 'loss_val': 0.715283170672132, 'psi': 0.7708491350648494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=78 head_norm_before_train=1.877569 (no previous merge yet)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.5416439732770227, 'auprc': 0.7830093869350025, 'loss_val': 1.051715259276124, 'psi': 0.6381901387402147}-{'f1_val': 0.7152897689559026, 'auprc': 0.9345302394027103, 'loss_val': 0.191197131678997, 'psi': 0.8029859571346256}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=1.964816 cos_to_last_merge=0.9407 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9880134983236396, 'auprc': 0.9963810499877803, 'loss_val': 0.04898707174630012, 'psi': 0.9913605189892959}-{'f1_val': 0.9898564228592382, 'auprc': 0.9964330149895195, 'loss_val': 0.03923318722485085, 'psi': 0.9924870597113508}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=2.115964 cos_to_last_merge=0.7858 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=78 local utility u=0.028472 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9987980458639092, 'loss_val': 0.02042867824214155, 'psi': 0.9970152493640749}-{'f1_val': 0.9895217784513768, 'auprc': 0.9988018552831204, 'loss_val': 0.03955403748277758, 'psi': 0.9932338091840742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=78 head_norm_before_train=2.037941 cos_to_last_merge=0.8525 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.852
[S10] round=78 local utility u=0.000974 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9932497461963321, 'loss_val': 0.02668845443894512, 'psi': 0.9944126018901577}-{'f1_val': 0.9951878390193748, 'auprc': 0.9926020105255069, 'loss_val': 0.026693398382211814, 'psi': 0.9941535076218275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=78 head_norm_before_train=1.935687 cos_to_last_merge=0.8812 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.881
[S11] round=78 local utility u=0.002639 metrics={'f1_val': 0.9955906376354449, 'auprc': 0.9991940591388362, 'loss_val': 0.020298314327910436, 'psi': 0.9970320062368014}-{'f1_val': 0.9951104163810016, 'auprc': 0.9991627034693776, 'loss_val': 0.022600639925126714, 'psi': 0.9967313312163519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=78 head_norm_before_train=1.620470 cos_to_last_merge=0.8836 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.884
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6243846988799886, 'auprc': 0.8257386028118237, 'loss_val': 0.9046999624607381, 'psi': 0.7049262604527227}-{'f1_val': 0.6759047811513682, 'auprc': 0.8090232470706407, 'loss_val': 0.800729696749888, 'psi': 0.7291521675190772}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=2.018120 cos_to_last_merge=0.9427 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9428069557620071, 'auprc': 0.9988551498964386, 'loss_val': 0.10649702756827654, 'psi': 0.9652262334157797}-{'f1_val': 0.9977998904431125, 'auprc': 0.9988554277816654, 'loss_val': 0.018102099309016666, 'psi': 0.9982221053785336}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=2.034497 cos_to_last_merge=0.9378 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=78 local utility u=0.299947 metrics={'f1_val': 0.9810700326853032, 'auprc': 0.9981802317424247, 'loss_val': 0.03458051036212552, 'psi': 0.9879141123081518}-{'f1_val': 0.9037402512786699, 'auprc': 0.9976893160322361, 'loss_val': 0.1690223507639796, 'psi': 0.9413198771800964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=78 head_norm_before_train=2.142942 (no previous merge yet)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.9203075416950046, 'auprc': 0.9120893155330378, 'loss_val': 0.5307389805285082, 'psi': 0.9170202512302179}-{'f1_val': 0.922470093214298, 'auprc': 0.981250208598152, 'loss_val': 0.4983501582228121, 'psi': 0.9459821393678396}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=1.932321 cos_to_last_merge=0.8766 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=78 local utility u=0.750151 metrics={'f1_val': 0.8185604306913727, 'auprc': 0.8875749856643735, 'loss_val': 0.8400544478326617, 'psi': 0.8461662526805731}-{'f1_val': 0.6703172843405065, 'auprc': 0.8815879166257561, 'loss_val': 1.432936663090358, 'psi': 0.7548255372546064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=79 head_norm_before_train=1.885877 cos_to_last_merge=0.8853 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.885
[S2] round=79 local utility u=0.006318 metrics={'f1_val': 0.7200446381060452, 'auprc': 0.7462093458034718, 'loss_val': 0.9773209653055049, 'psi': 0.7305105211850158}-{'f1_val': 0.7201103021888824, 'auprc': 0.7428001239122225, 'loss_val': 0.9801236253804173, 'psi': 0.7291862308782184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S2] r=80 psi=0.731 u=0.0063 p_local=0.0192 f1=0.720 auprc=0.746 bytes=77458
[S3] START round=79 head_norm_before_train=2.129883 cos_to_last_merge=0.9290 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=79 local utility u=0.005819 metrics={'f1_val': 0.9625076301522169, 'auprc': 0.9985115311738753, 'loss_val': 0.07904193360583993, 'psi': 0.9769091905608802}-{'f1_val': 0.9613192636176109, 'auprc': 0.9977394442281078, 'loss_val': 0.08123392184246332, 'psi': 0.9758873358618096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S3] r=80 psi=0.977 u=0.0058 p_local=0.0973 f1=0.963 auprc=0.999 bytes=86379
[S4] START round=79 head_norm_before_train=1.901080 cos_to_last_merge=0.7530 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.753
[S4] round=79 local utility u=0.011740 metrics={'f1_val': 0.9439782335792194, 'auprc': 0.9491553397283957, 'loss_val': 0.29536857057430893, 'psi': 0.94604907603889}-{'f1_val': 0.9430165378442464, 'auprc': 0.9439980293182231, 'loss_val': 0.29760709667356583, 'psi': 0.9434091344338371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S4] r=80 psi=0.946 u=0.0117 p_local=0.0134 f1=0.944 auprc=0.949 bytes=84577
[S5] START round=79 head_norm_before_train=1.567099 cos_to_last_merge=0.8283 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8567912122526083, 'loss_val': 0.9711013232404168, 'psi': 0.6047762232042666}-{'f1_val': 0.8150977677737443, 'auprc': 0.9913951694151522, 'loss_val': 0.18262772968821325, 'psi': 0.8856167284303075}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.605 u=0.0000 p_local=0.3323 f1=0.437 auprc=0.857 bytes=79218
[S6] START round=79 head_norm_before_train=1.887227 cos_to_last_merge=0.8130 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=79 local utility u=0.268295 metrics={'f1_val': 0.7574713944529775, 'auprc': 0.9439700324705382, 'loss_val': 0.6138392031780034, 'psi': 0.8320708496600018}-{'f1_val': 0.7017463416440395, 'auprc': 0.9138199690097607, 'loss_val': 0.7256286961383639, 'psi': 0.7865757925903281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S6] r=80 psi=0.832 u=0.2683 p_local=0.2359 f1=0.757 auprc=0.944 bytes=64704
[S7] START round=79 head_norm_before_train=1.880747 (no previous merge yet)
[S7] round=79 local utility u=0.117905 metrics={'f1_val': 0.5569326570573158, 'auprc': 0.7847084453913437, 'loss_val': 0.9127352991355661, 'psi': 0.6480429723909269}-{'f1_val': 0.5416439732770227, 'auprc': 0.7830093869350025, 'loss_val': 1.051715259276124, 'psi': 0.6381901387402147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S7] r=80 psi=0.648 u=0.1179 p_local=0.1759 f1=0.557 auprc=0.785 bytes=84583
[S8] START round=79 head_norm_before_train=1.968884 cos_to_last_merge=0.9405 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=79 local utility u=0.033722 metrics={'f1_val': 0.9943863538992247, 'auprc': 0.9994335723639279, 'loss_val': 0.02893800506605843, 'psi': 0.996405241285106}-{'f1_val': 0.9880134983236396, 'auprc': 0.9963810499877803, 'loss_val': 0.04898707174630012, 'psi': 0.9913605189892959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] r=80 psi=0.996 u=0.0337 p_local=0.0266 f1=0.994 auprc=0.999 bytes=82877
[S9] START round=79 head_norm_before_train=2.122085 cos_to_last_merge=0.7856 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956387443651259, 'loss_val': 0.01826461674474177, 'psi': 0.9962518048343852}-{'f1_val': 0.9958267183641853, 'auprc': 0.9987980458639092, 'loss_val': 0.02042867824214155, 'psi': 0.9970152493640749}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.996 u=0.0000 p_local=0.0070 f1=0.997 auprc=0.996 bytes=87971
[S10] START round=79 head_norm_before_train=2.039142 cos_to_last_merge=0.8525 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.853
[S10] round=79 local utility u=0.000485 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993570925671272, 'loss_val': 0.026682893531517232, 'psi': 0.9945410736801337}-{'f1_val': 0.9951878390193748, 'auprc': 0.9932497461963321, 'loss_val': 0.02668845443894512, 'psi': 0.9944126018901577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S10] r=80 psi=0.995 u=0.0005 p_local=0.0004 f1=0.995 auprc=0.994 bytes=95441
[S11] START round=79 head_norm_before_train=1.941638 cos_to_last_merge=0.8808 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.881
[S11] round=79 local utility u=0.002440 metrics={'f1_val': 0.9958937036982921, 'auprc': 0.9992019670950496, 'loss_val': 0.017260268590835855, 'psi': 0.9972170090569952}-{'f1_val': 0.9955906376354449, 'auprc': 0.9991940591388362, 'loss_val': 0.020298314327910436, 'psi': 0.9970320062368014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=80 psi=0.997 u=0.0024 p_local=0.0357 f1=0.996 auprc=0.999 bytes=89900
[S13] START round=79 head_norm_before_train=1.626054 cos_to_last_merge=0.8828 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=79 local utility u=0.430975 metrics={'f1_val': 0.7297865328870216, 'auprc': 0.813461848799367, 'loss_val': 0.6383307107844068, 'psi': 0.7632566592519597}-{'f1_val': 0.6243846988799886, 'auprc': 0.8257386028118237, 'loss_val': 0.9046999624607381, 'psi': 0.7049262604527227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] r=80 psi=0.763 u=0.4310 p_local=0.1592 f1=0.730 auprc=0.813 bytes=73739
[S14] START round=79 head_norm_before_train=2.024423 cos_to_last_merge=0.9424 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=79 local utility u=0.169189 metrics={'f1_val': 0.9868621968364966, 'auprc': 0.9992334183358242, 'loss_val': 0.0335856675663745, 'psi': 0.9918106854362276}-{'f1_val': 0.9428069557620071, 'auprc': 0.9988551498964386, 'loss_val': 0.10649702756827654, 'psi': 0.9652262334157797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=80 psi=0.992 u=0.1692 p_local=0.0472 f1=0.987 auprc=0.999 bytes=93482
[S15] START round=79 head_norm_before_train=2.040179 cos_to_last_merge=0.9374 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=79 local utility u=0.058886 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9992338945154826, 'loss_val': 0.01625280453978241, 'psi': 0.9979639099230532}-{'f1_val': 0.9810700326853032, 'auprc': 0.9981802317424247, 'loss_val': 0.03458051036212552, 'psi': 0.9879141123081518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] r=80 psi=0.998 u=0.0589 p_local=0.0842 f1=0.997 auprc=0.999 bytes=84522
[S16] START round=79 head_norm_before_train=2.141815 (no previous merge yet)
[S16] round=79 local utility u=0.023533 metrics={'f1_val': 0.9255287145364359, 'auprc': 0.9077604432729605, 'loss_val': 0.5020136906122226, 'psi': 0.9184214060310457}-{'f1_val': 0.9203075416950046, 'auprc': 0.9120893155330378, 'loss_val': 0.5307389805285082, 'psi': 0.9170202512302179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=80 psi=0.918 u=0.0235 p_local=0.0260 f1=0.926 auprc=0.908 bytes=80934
[S17] START round=79 head_norm_before_train=1.937082 cos_to_last_merge=0.8761 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.876
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.7333330390240073, 'auprc': 0.8850553395818626, 'loss_val': 0.9641022582223467, 'psi': 0.7940219592471494}-{'f1_val': 0.8185604306913727, 'auprc': 0.8875749856643735, 'loss_val': 0.8400544478326617, 'psi': 0.8461662526805731}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.794 u=0.0000 p_local=0.1826 f1=0.733 auprc=0.885 bytes=75698
[S2] START round=80 head_norm_before_train=1.891068 cos_to_last_merge=0.8850 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.885
[S2] round=80 local utility u=0.000748 metrics={'f1_val': 0.7198204826185411, 'auprc': 0.745574535844659, 'loss_val': 0.9725764070913506, 'psi': 0.7301221039089882}-{'f1_val': 0.7200446381060452, 'auprc': 0.7462093458034718, 'loss_val': 0.9773209653055049, 'psi': 0.7305105211850158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=80 head_norm_before_train=2.134700 cos_to_last_merge=0.9285 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.8157106852169361, 'auprc': 0.9713686948219822, 'loss_val': 0.4206480994366511, 'psi': 0.8779738890589546}-{'f1_val': 0.9625076301522169, 'auprc': 0.9985115311738753, 'loss_val': 0.07904193360583993, 'psi': 0.9769091905608802}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.899267 cos_to_last_merge=0.7528 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.753
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9416974337846724, 'auprc': 0.9283654681822214, 'loss_val': 0.30603441435326795, 'psi': 0.936364647543692}-{'f1_val': 0.9439782335792194, 'auprc': 0.9491553397283957, 'loss_val': 0.29536857057430893, 'psi': 0.94604907603889}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=1.571026 cos_to_last_merge=0.8281 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=80 local utility u=0.424757 metrics={'f1_val': 0.5383381529381523, 'auprc': 0.8581005800697021, 'loss_val': 0.7349474956059113, 'psi': 0.6662431237907722}-{'f1_val': 0.43676623050537206, 'auprc': 0.8567912122526083, 'loss_val': 0.9711013232404168, 'psi': 0.6047762232042666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=80 head_norm_before_train=1.893614 cos_to_last_merge=0.8116 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.812
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.7464636048707378, 'auprc': 0.9551096961804664, 'loss_val': 0.6483564268999527, 'psi': 0.8299220413946293}-{'f1_val': 0.7574713944529775, 'auprc': 0.9439700324705382, 'loss_val': 0.6138392031780034, 'psi': 0.8320708496600018}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=1.881661 (no previous merge yet)
[S7] round=80 local utility u=1.000000 metrics={'f1_val': 0.7511265212739152, 'auprc': 0.965925323181134, 'loss_val': 0.19182824984293598, 'psi': 0.8370460420368027}-{'f1_val': 0.5569326570573158, 'auprc': 0.7847084453913437, 'loss_val': 0.9127352991355661, 'psi': 0.6480429723909269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=80 head_norm_before_train=1.973081 cos_to_last_merge=0.9405 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.940
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9640774653482641, 'auprc': 0.994972777283309, 'loss_val': 0.10051555103655958, 'psi': 0.9764355901222821}-{'f1_val': 0.9943863538992247, 'auprc': 0.9994335723639279, 'loss_val': 0.02893800506605843, 'psi': 0.996405241285106}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.128679 cos_to_last_merge=0.7854 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.785
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9929259745712864, 'loss_val': 0.018793896559447694, 'psi': 0.9949204466960812}-{'f1_val': 0.9966605118138915, 'auprc': 0.9956387443651259, 'loss_val': 0.01826461674474177, 'psi': 0.9962518048343852}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.042386 cos_to_last_merge=0.8523 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.852
[S10] round=80 local utility u=0.000001 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993551937011395, 'loss_val': 0.026623817798403365, 'psi': 0.9945334782161828}-{'f1_val': 0.9951878390193748, 'auprc': 0.993570925671272, 'loss_val': 0.026682893531517232, 'psi': 0.9945410736801337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=80 head_norm_before_train=1.948010 cos_to_last_merge=0.8803 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.880
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9879630665152123, 'auprc': 0.9991926958534637, 'loss_val': 0.05509536230705868, 'psi': 0.9924549182505129}-{'f1_val': 0.9958937036982921, 'auprc': 0.9992019670950496, 'loss_val': 0.017260268590835855, 'psi': 0.9972170090569952}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.632557 cos_to_last_merge=0.8820 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.882
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.7294110370182421, 'auprc': 0.8237398387834203, 'loss_val': 0.7801167802497819, 'psi': 0.7671425577243134}-{'f1_val': 0.7297865328870216, 'auprc': 0.813461848799367, 'loss_val': 0.6383307107844068, 'psi': 0.7632566592519597}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=2.027333 cos_to_last_merge=0.9419 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=80 local utility u=0.039829 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9991386751436544, 'loss_val': 0.017071251256763096, 'psi': 0.9981156521198176}-{'f1_val': 0.9868621968364966, 'auprc': 0.9992334183358242, 'loss_val': 0.0335856675663745, 'psi': 0.9918106854362276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=80 head_norm_before_train=2.045761 cos_to_last_merge=0.9369 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9104876945584951, 'auprc': 0.997547109424221, 'loss_val': 0.12430772483979319, 'psi': 0.9453114605047854}-{'f1_val': 0.9971172535281002, 'auprc': 0.9992338945154826, 'loss_val': 0.01625280453978241, 'psi': 0.9979639099230532}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=2.144662 (no previous merge yet)
[S16] round=80 local utility u=0.153722 metrics={'f1_val': 0.9360299971097356, 'auprc': 0.9668644336267167, 'loss_val': 0.43489008941523044, 'psi': 0.9483637717165281}-{'f1_val': 0.9255287145364359, 'auprc': 0.9077604432729605, 'loss_val': 0.5020136906122226, 'psi': 0.9184214060310457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=80 head_norm_before_train=1.939998 cos_to_last_merge=0.8757 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.876
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.6698225684531931, 'auprc': 0.8989715596130812, 'loss_val': 1.2814133736150277, 'psi': 0.7614821649171484}-{'f1_val': 0.7333330390240073, 'auprc': 0.8850553395818626, 'loss_val': 0.9641022582223467, 'psi': 0.7940219592471494}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=81 head_norm_before_train=1.896442 cos_to_last_merge=0.8846 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.885
[S2] round=81 local utility u=0.017734 metrics={'f1_val': 0.6732344606784806, 'auprc': 0.7808660264834383, 'loss_val': 0.7634659467070793, 'psi': 0.7162870870004636}-{'f1_val': 0.7198204826185411, 'auprc': 0.745574535844659, 'loss_val': 0.9725764070913506, 'psi': 0.7301221039089882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=81 head_norm_before_train=2.139603 cos_to_last_merge=0.9281 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.7081815301283736, 'auprc': 0.9429230212924251, 'loss_val': 0.8159434197864904, 'psi': 0.8020781265939942}-{'f1_val': 0.8157106852169361, 'auprc': 0.9713686948219822, 'loss_val': 0.4206480994366511, 'psi': 0.8779738890589546}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=1.905671 cos_to_last_merge=0.7521 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.752
[S4] round=81 local utility u=0.052688 metrics={'f1_val': 0.9438952349907435, 'auprc': 0.9550129379877962, 'loss_val': 0.29378747193498134, 'psi': 0.9483423161895645}-{'f1_val': 0.9416974337846724, 'auprc': 0.9283654681822214, 'loss_val': 0.30603441435326795, 'psi': 0.936364647543692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=81 head_norm_before_train=1.575336 cos_to_last_merge=0.8281 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=81 local utility u=1.000000 metrics={'f1_val': 0.8077531745431892, 'auprc': 0.976216817124612, 'loss_val': 0.2412047455336113, 'psi': 0.8751386315757583}-{'f1_val': 0.5383381529381523, 'auprc': 0.8581005800697021, 'loss_val': 0.7349474956059113, 'psi': 0.6662431237907722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=81 head_norm_before_train=1.897110 cos_to_last_merge=0.8105 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.811
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.6752231219868433, 'auprc': 0.9408073629897031, 'loss_val': 0.8952419628566339, 'psi': 0.7814568183879873}-{'f1_val': 0.7464636048707378, 'auprc': 0.9551096961804664, 'loss_val': 0.6483564268999527, 'psi': 0.8299220413946293}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.882507 (no previous merge yet)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.4709526830149659, 'auprc': 0.7807049596458961, 'loss_val': 1.1617663119837696, 'psi': 0.594853593667338}-{'f1_val': 0.7511265212739152, 'auprc': 0.965925323181134, 'loss_val': 0.19182824984293598, 'psi': 0.8370460420368027}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=1.979823 cos_to_last_merge=0.9400 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.940
[S8] round=81 local utility u=0.133549 metrics={'f1_val': 0.9940197241108746, 'auprc': 0.9994761571006041, 'loss_val': 0.02658197408406664, 'psi': 0.9962022973067663}-{'f1_val': 0.9640774653482641, 'auprc': 0.994972777283309, 'loss_val': 0.10051555103655958, 'psi': 0.9764355901222821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=81 head_norm_before_train=2.131632 cos_to_last_merge=0.7847 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.785
[S9] round=81 local utility u=0.003865 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9946270950396474, 'loss_val': 0.018629630359252018, 'psi': 0.9958471451041938}-{'f1_val': 0.9962500947792776, 'auprc': 0.9929259745712864, 'loss_val': 0.018793896559447694, 'psi': 0.9949204466960812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=81 head_norm_before_train=2.046630 cos_to_last_merge=0.8519 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.852
[S10] round=81 local utility u=0.000243 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937030021418549, 'loss_val': 0.0265916315022238, 'psi': 0.9945939042683668}-{'f1_val': 0.9951878390193748, 'auprc': 0.993551937011395, 'loss_val': 0.026623817798403365, 'psi': 0.9945334782161828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=81 head_norm_before_train=1.954006 cos_to_last_merge=0.8799 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.880
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.8343620093845507, 'auprc': 0.9986897868777075, 'loss_val': 0.18049577366621905, 'psi': 0.9000931203818134}-{'f1_val': 0.9879630665152123, 'auprc': 0.9991926958534637, 'loss_val': 0.05509536230705868, 'psi': 0.9924549182505129}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=1.639809 cos_to_last_merge=0.8812 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=81 local utility u=0.008455 metrics={'f1_val': 0.7340143283665577, 'auprc': 0.8201769769338407, 'loss_val': 0.7801380816942721, 'psi': 0.7684793877934708}-{'f1_val': 0.7294110370182421, 'auprc': 0.8237398387834203, 'loss_val': 0.7801167802497819, 'psi': 0.7671425577243134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=81 head_norm_before_train=2.028316 cos_to_last_merge=0.9413 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9963416100719005, 'loss_val': 0.019065917353731903, 'psi': 0.9967239503898828}-{'f1_val': 0.9974336367705932, 'auprc': 0.9991386751436544, 'loss_val': 0.017071251256763096, 'psi': 0.9981156521198176}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=2.051286 cos_to_last_merge=0.9365 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.8798175984455496, 'auprc': 0.9969423283143215, 'loss_val': 0.25551859685018674, 'psi': 0.9266674903930583}-{'f1_val': 0.9104876945584951, 'auprc': 0.997547109424221, 'loss_val': 0.12430772483979319, 'psi': 0.9453114605047854}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=2.149681 (no previous merge yet)
[S16] round=81 local utility u=0.065442 metrics={'f1_val': 0.9397568626345024, 'auprc': 0.9828038985626633, 'loss_val': 0.3741859000722412, 'psi': 0.9569756770057668}-{'f1_val': 0.9360299971097356, 'auprc': 0.9668644336267167, 'loss_val': 0.43489008941523044, 'psi': 0.9483637717165281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=81 head_norm_before_train=1.944861 cos_to_last_merge=0.8753 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.875
[S17] round=81 local utility u=0.529852 metrics={'f1_val': 0.7232198806418265, 'auprc': 0.94423685568166, 'loss_val': 0.6778899130064068, 'psi': 0.81162667065776}-{'f1_val': 0.6698225684531931, 'auprc': 0.8989715596130812, 'loss_val': 1.2814133736150277, 'psi': 0.7614821649171484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=82 head_norm_before_train=1.899627 cos_to_last_merge=0.8842 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.884
[S2] round=82 local utility u=0.159858 metrics={'f1_val': 0.7014573124226482, 'auprc': 0.8110746942740383, 'loss_val': 0.703713647772755, 'psi': 0.7453042651632042}-{'f1_val': 0.6732344606784806, 'auprc': 0.7808660264834383, 'loss_val': 0.7634659467070793, 'psi': 0.7162870870004636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=82 head_norm_before_train=2.145284 cos_to_last_merge=0.9276 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=82 local utility u=0.717859 metrics={'f1_val': 0.8558174680277528, 'auprc': 0.9757144133184679, 'loss_val': 0.3644150703928557, 'psi': 0.9037762461440388}-{'f1_val': 0.7081815301283736, 'auprc': 0.9429230212924251, 'loss_val': 0.8159434197864904, 'psi': 0.8020781265939942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=82 head_norm_before_train=1.910783 cos_to_last_merge=0.7517 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.752
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9423383595617827, 'auprc': 0.9525733295187957, 'loss_val': 0.29993168731369924, 'psi': 0.9464323475445879}-{'f1_val': 0.9438952349907435, 'auprc': 0.9550129379877962, 'loss_val': 0.29378747193498134, 'psi': 0.9483423161895645}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=1.580892 cos_to_last_merge=0.8280 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.5853250043982825, 'auprc': 0.8629239130439441, 'loss_val': 0.633466067747836, 'psi': 0.6963645678565471}-{'f1_val': 0.8077531745431892, 'auprc': 0.976216817124612, 'loss_val': 0.2412047455336113, 'psi': 0.8751386315757583}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=1.900851 cos_to_last_merge=0.8094 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.809
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.5982773564134474, 'auprc': 0.6620260465112269, 'loss_val': 1.5163744583378935, 'psi': 0.6237768324525592}-{'f1_val': 0.6752231219868433, 'auprc': 0.9408073629897031, 'loss_val': 0.8952419628566339, 'psi': 0.7814568183879873}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.882295 (no previous merge yet)
[S7] round=82 local utility u=1.000000 metrics={'f1_val': 0.7050618130438605, 'auprc': 0.8906469817758924, 'loss_val': 0.25637019176321796, 'psi': 0.7792958805366732}-{'f1_val': 0.4709526830149659, 'auprc': 0.7807049596458961, 'loss_val': 1.1617663119837696, 'psi': 0.594853593667338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=82 head_norm_before_train=1.985262 cos_to_last_merge=0.9397 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.940
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9811237681924704, 'auprc': 0.9996803534800514, 'loss_val': 0.04489356460712732, 'psi': 0.9885464023075028}-{'f1_val': 0.9940197241108746, 'auprc': 0.9994761571006041, 'loss_val': 0.02658197408406664, 'psi': 0.9962022973067663}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=2.135663 cos_to_last_merge=0.7843 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.784
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9987816616648008, 'loss_val': 0.02149864688169707, 'psi': 0.9962591733614872}-{'f1_val': 0.9966605118138915, 'auprc': 0.9946270950396474, 'loss_val': 0.018629630359252018, 'psi': 0.9958471451041938}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.050710 cos_to_last_merge=0.8515 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.852
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935506999987271, 'loss_val': 0.02661189565974842, 'psi': 0.9945329834111156}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937030021418549, 'loss_val': 0.0265916315022238, 'psi': 0.9945939042683668}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=1.958812 cos_to_last_merge=0.8795 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.879
[S11] round=82 local utility u=0.565071 metrics={'f1_val': 0.9955906376354449, 'auprc': 0.9991932457816393, 'loss_val': 0.01923631762594647, 'psi': 0.9970316808939227}-{'f1_val': 0.8343620093845507, 'auprc': 0.9986897868777075, 'loss_val': 0.18049577366621905, 'psi': 0.9000931203818134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=82 head_norm_before_train=1.646488 cos_to_last_merge=0.8805 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.880
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.684555706290752, 'auprc': 0.7796389099429393, 'loss_val': 0.7444126927235694, 'psi': 0.7225889877516269}-{'f1_val': 0.7340143283665577, 'auprc': 0.8201769769338407, 'loss_val': 0.7801380816942721, 'psi': 0.7684793877934708}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=2.030008 cos_to_last_merge=0.9409 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9971461492914482, 'auprc': 0.9960470164367432, 'loss_val': 0.021935816368001092, 'psi': 0.9967064961495662}-{'f1_val': 0.9969788439352044, 'auprc': 0.9963416100719005, 'loss_val': 0.019065917353731903, 'psi': 0.9967239503898828}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=2.056597 cos_to_last_merge=0.9360 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=82 local utility u=0.446222 metrics={'f1_val': 0.9906072445952735, 'auprc': 0.9994100078919098, 'loss_val': 0.03521609102270978, 'psi': 0.9941283499139281}-{'f1_val': 0.8798175984455496, 'auprc': 0.9969423283143215, 'loss_val': 0.25551859685018674, 'psi': 0.9266674903930583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=82 head_norm_before_train=2.155813 (no previous merge yet)
[S16] round=82 local utility u=0.028828 metrics={'f1_val': 0.9403833341751155, 'auprc': 0.9872387749945218, 'loss_val': 0.333594126587717, 'psi': 0.9591255105028781}-{'f1_val': 0.9397568626345024, 'auprc': 0.9828038985626633, 'loss_val': 0.3741859000722412, 'psi': 0.9569756770057668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=82 head_norm_before_train=1.950176 cos_to_last_merge=0.8749 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.875
[S17] round=82 local utility u=0.883192 metrics={'f1_val': 0.9261054604987313, 'auprc': 0.9829978237722825, 'loss_val': 0.24510236289644322, 'psi': 0.9488624058081517}-{'f1_val': 0.7232198806418265, 'auprc': 0.94423685568166, 'loss_val': 0.6778899130064068, 'psi': 0.81162667065776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=83 head_norm_before_train=1.904057 cos_to_last_merge=0.8837 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.884
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.7123228357621215, 'auprc': 0.7594704045384594, 'loss_val': 0.8001152235067577, 'psi': 0.7311818632726567}-{'f1_val': 0.7014573124226482, 'auprc': 0.8110746942740383, 'loss_val': 0.703713647772755, 'psi': 0.7453042651632042}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.151020 cos_to_last_merge=0.9271 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.761529554696972, 'auprc': 0.9944914941137228, 'loss_val': 0.6308302443640088, 'psi': 0.8547143304636724}-{'f1_val': 0.8558174680277528, 'auprc': 0.9757144133184679, 'loss_val': 0.3644150703928557, 'psi': 0.9037762461440388}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=1.915281 cos_to_last_merge=0.7516 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.752
[S4] round=83 local utility u=0.000000 metrics={'f1_val': 0.9413770261025652, 'auprc': 0.9503002705170724, 'loss_val': 0.30495857262437476, 'psi': 0.9449463238683682}-{'f1_val': 0.9423383595617827, 'auprc': 0.9525733295187957, 'loss_val': 0.29993168731369924, 'psi': 0.9464323475445879}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=83 head_norm_before_train=1.587246 cos_to_last_merge=0.8271 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=83 local utility u=0.746442 metrics={'f1_val': 0.7578386221516241, 'auprc': 0.941537659807162, 'loss_val': 0.411504475361185, 'psi': 0.8313182372138392}-{'f1_val': 0.5853250043982825, 'auprc': 0.8629239130439441, 'loss_val': 0.633466067747836, 'psi': 0.6963645678565471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=83 head_norm_before_train=1.903593 cos_to_last_merge=0.8086 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.809
[S6] round=83 local utility u=1.000000 metrics={'f1_val': 0.871957141703071, 'auprc': 0.9654677071202429, 'loss_val': 0.33692613636065544, 'psi': 0.9093613678699397}-{'f1_val': 0.5982773564134474, 'auprc': 0.6620260465112269, 'loss_val': 1.5163744583378935, 'psi': 0.6237768324525592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=83 head_norm_before_train=1.883739 (no previous merge yet)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.687365665342406, 'auprc': 0.8517041933397744, 'loss_val': 0.2846670124064287, 'psi': 0.7531010765413534}-{'f1_val': 0.7050618130438605, 'auprc': 0.8906469817758924, 'loss_val': 0.25637019176321796, 'psi': 0.7792958805366732}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=1.988986 cos_to_last_merge=0.9395 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.940
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.8051476899349329, 'auprc': 0.9993220407470186, 'loss_val': 0.4135757099355338, 'psi': 0.8828174302597671}-{'f1_val': 0.9811237681924704, 'auprc': 0.9996803534800514, 'loss_val': 0.04489356460712732, 'psi': 0.9885464023075028}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.140000 cos_to_last_merge=0.7841 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.784
[S9] round=83 local utility u=0.004544 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9987922761403485, 'loss_val': 0.01993760863280588, 'psi': 0.9970129414746507}-{'f1_val': 0.9945775144926113, 'auprc': 0.9987816616648008, 'loss_val': 0.02149864688169707, 'psi': 0.9962591733614872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=83 head_norm_before_train=2.052820 cos_to_last_merge=0.8514 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.851
[S10] round=83 local utility u=0.000022 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993584821685531, 'loss_val': 0.02666995649848248, 'psi': 0.9945466320858372}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935506999987271, 'loss_val': 0.02661189565974842, 'psi': 0.9945329834111156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=83 head_norm_before_train=1.963133 cos_to_last_merge=0.8791 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.879
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9746440580943745, 'auprc': 0.9991717483420195, 'loss_val': 0.11135524465644607, 'psi': 0.9844551341934324}-{'f1_val': 0.9955906376354449, 'auprc': 0.9991932457816393, 'loss_val': 0.01923631762594647, 'psi': 0.9970316808939227}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.651871 cos_to_last_merge=0.8799 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.880
[S13] round=83 local utility u=0.199944 metrics={'f1_val': 0.7310402030820201, 'auprc': 0.8111984483934965, 'loss_val': 0.7181108283238175, 'psi': 0.7631035012066107}-{'f1_val': 0.684555706290752, 'auprc': 0.7796389099429393, 'loss_val': 0.7444126927235694, 'psi': 0.7225889877516269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=83 head_norm_before_train=2.033325 cos_to_last_merge=0.9407 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.994485577723117, 'loss_val': 0.01981699215215974, 'psi': 0.9961272462985569}-{'f1_val': 0.9971461492914482, 'auprc': 0.9960470164367432, 'loss_val': 0.021935816368001092, 'psi': 0.9967064961495662}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=2.061599 cos_to_last_merge=0.9356 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=83 local utility u=0.005642 metrics={'f1_val': 0.9916807219202586, 'auprc': 0.99930992755757, 'loss_val': 0.030073708608689655, 'psi': 0.9947324041751832}-{'f1_val': 0.9906072445952735, 'auprc': 0.9994100078919098, 'loss_val': 0.03521609102270978, 'psi': 0.9941283499139281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=83 head_norm_before_train=2.160474 (no previous merge yet)
[S16] round=83 local utility u=0.018344 metrics={'f1_val': 0.9410099208471432, 'auprc': 0.9840939590667325, 'loss_val': 0.2912308707863061, 'psi': 0.9582435361349789}-{'f1_val': 0.9403833341751155, 'auprc': 0.9872387749945218, 'loss_val': 0.333594126587717, 'psi': 0.9591255105028781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=83 head_norm_before_train=1.956366 cos_to_last_merge=0.8745 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.7186326468727371, 'auprc': 0.9495656950859606, 'loss_val': 0.9084170684946499, 'psi': 0.8110058661580265}-{'f1_val': 0.9261054604987313, 'auprc': 0.9829978237722825, 'loss_val': 0.24510236289644322, 'psi': 0.9488624058081517}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=1.907072 cos_to_last_merge=0.8834 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.71879491590081, 'auprc': 0.789516196088006, 'loss_val': 0.9503950955294895, 'psi': 0.7470834279756884}-{'f1_val': 0.7123228357621215, 'auprc': 0.7594704045384594, 'loss_val': 0.8001152235067577, 'psi': 0.7311818632726567}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.156128 cos_to_last_merge=0.9266 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.7300573674435551, 'auprc': 0.9902402389532274, 'loss_val': 0.7310311094927707, 'psi': 0.834130516047424}-{'f1_val': 0.761529554696972, 'auprc': 0.9944914941137228, 'loss_val': 0.6308302443640088, 'psi': 0.8547143304636724}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=1.918043 cos_to_last_merge=0.7515 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.752
[S4] round=84 local utility u=0.045870 metrics={'f1_val': 0.9437724182368473, 'auprc': 0.9723463175146585, 'loss_val': 0.2937300645129143, 'psi': 0.9552019779479718}-{'f1_val': 0.9413770261025652, 'auprc': 0.9503002705170724, 'loss_val': 0.30495857262437476, 'psi': 0.9449463238683682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=84 head_norm_before_train=1.595126 cos_to_last_merge=0.8259 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=84 local utility u=0.846102 metrics={'f1_val': 0.9622275343857696, 'auprc': 0.997432064457621, 'loss_val': 0.11331665476592291, 'psi': 0.9763093464145101}-{'f1_val': 0.7578386221516241, 'auprc': 0.941537659807162, 'loss_val': 0.411504475361185, 'psi': 0.8313182372138392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=84 head_norm_before_train=1.905004 cos_to_last_merge=0.8084 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.808
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.8371061395688708, 'auprc': 0.9041296173184239, 'loss_val': 0.5742258861757221, 'psi': 0.8639155306686921}-{'f1_val': 0.871957141703071, 'auprc': 0.9654677071202429, 'loss_val': 0.33692613636065544, 'psi': 0.9093613678699397}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.885077 (no previous merge yet)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.662787321211689, 'auprc': 0.7987221280356299, 'loss_val': 0.4853798146519192, 'psi': 0.7171612439412653}-{'f1_val': 0.687365665342406, 'auprc': 0.8517041933397744, 'loss_val': 0.2846670124064287, 'psi': 0.7531010765413534}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=1.993271 cos_to_last_merge=0.9392 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=84 local utility u=0.755549 metrics={'f1_val': 0.9927475182363883, 'auprc': 0.9994927232817942, 'loss_val': 0.028587828869151753, 'psi': 0.9954456002545506}-{'f1_val': 0.8051476899349329, 'auprc': 0.9993220407470186, 'loss_val': 0.4135757099355338, 'psi': 0.8828174302597671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=84 head_norm_before_train=2.145011 cos_to_last_merge=0.7839 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.784
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956318141990835, 'loss_val': 0.017838731535488987, 'psi': 0.9962490327679683}-{'f1_val': 0.9958267183641853, 'auprc': 0.9987922761403485, 'loss_val': 0.01993760863280588, 'psi': 0.9970129414746507}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.056395 cos_to_last_merge=0.8511 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.851
[S10] round=84 local utility u=0.000044 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935964509676553, 'loss_val': 0.02661731492763098, 'psi': 0.994551283798687}-{'f1_val': 0.9951878390193748, 'auprc': 0.993584821685531, 'loss_val': 0.02666995649848248, 'psi': 0.9945466320858372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=84 head_norm_before_train=1.968185 cos_to_last_merge=0.8788 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.879
[S11] round=84 local utility u=0.110416 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998822597766255, 'loss_val': 0.018413124842511876, 'psi': 0.9972092440544876}-{'f1_val': 0.9746440580943745, 'auprc': 0.9991717483420195, 'loss_val': 0.11135524465644607, 'psi': 0.9844551341934324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=84 head_norm_before_train=1.656674 cos_to_last_merge=0.8794 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.7257798340599111, 'auprc': 0.8213756406789725, 'loss_val': 0.8009079470164996, 'psi': 0.7640181567075357}-{'f1_val': 0.7310402030820201, 'auprc': 0.8111984483934965, 'loss_val': 0.7181108283238175, 'psi': 0.7631035012066107}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=2.035854 cos_to_last_merge=0.9404 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=84 local utility u=0.010361 metrics={'f1_val': 0.9976298044288424, 'auprc': 0.999232535529969, 'loss_val': 0.01578551159360502, 'psi': 0.998270896869293}-{'f1_val': 0.9972216920155168, 'auprc': 0.994485577723117, 'loss_val': 0.01981699215215974, 'psi': 0.9961272462985569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=84 head_norm_before_train=2.066810 cos_to_last_merge=0.9352 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.9111929131762665, 'auprc': 0.9980297209235041, 'loss_val': 0.14308770615661692, 'psi': 0.9459276362751614}-{'f1_val': 0.9916807219202586, 'auprc': 0.99930992755757, 'loss_val': 0.030073708608689655, 'psi': 0.9947324041751832}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=2.158774 (no previous merge yet)
[S16] round=84 local utility u=0.025556 metrics={'f1_val': 0.9424724390055018, 'auprc': 0.983993845502521, 'loss_val': 0.24859335147877362, 'psi': 0.9590810016043094}-{'f1_val': 0.9410099208471432, 'auprc': 0.9840939590667325, 'loss_val': 0.2912308707863061, 'psi': 0.9582435361349789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=84 head_norm_before_train=1.961504 cos_to_last_merge=0.8740 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.6966333473942927, 'auprc': 0.9339809898331881, 'loss_val': 1.0714910057997056, 'psi': 0.7915724043698509}-{'f1_val': 0.7186326468727371, 'auprc': 0.9495656950859606, 'loss_val': 0.9084170684946499, 'psi': 0.8110058661580265}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=1.909896 cos_to_last_merge=0.8833 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.7200446381060452, 'auprc': 0.7568508750975591, 'loss_val': 0.9624914643332603, 'psi': 0.7347671329026508}-{'f1_val': 0.71879491590081, 'auprc': 0.789516196088006, 'loss_val': 0.9503950955294895, 'psi': 0.7470834279756884}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.161540 cos_to_last_merge=0.9260 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=85 local utility u=0.604527 metrics={'f1_val': 0.8583221529859104, 'auprc': 0.9982649786668983, 'loss_val': 0.3156406169598089, 'psi': 0.9142992832583056}-{'f1_val': 0.7300573674435551, 'auprc': 0.9902402389532274, 'loss_val': 0.7310311094927707, 'psi': 0.834130516047424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=85 head_norm_before_train=1.920525 cos_to_last_merge=0.7509 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.751
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9417991688136585, 'auprc': 0.9524741565216303, 'loss_val': 0.3014957156198027, 'psi': 0.9460691638968473}-{'f1_val': 0.9437724182368473, 'auprc': 0.9723463175146585, 'loss_val': 0.2937300645129143, 'psi': 0.9552019779479718}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.598217 cos_to_last_merge=0.8258 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.6154882600121141, 'auprc': 0.8648153208618214, 'loss_val': 0.6877911861905197, 'psi': 0.715219084351997}-{'f1_val': 0.9622275343857696, 'auprc': 0.997432064457621, 'loss_val': 0.11331665476592291, 'psi': 0.9763093464145101}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=1.905789 cos_to_last_merge=0.8074 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.49726433686766336, 'auprc': 0.6949040439923128, 'loss_val': 1.3391549715679039, 'psi': 0.5763202197175231}-{'f1_val': 0.8371061395688708, 'auprc': 0.9041296173184239, 'loss_val': 0.5742258861757221, 'psi': 0.8639155306686921}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=85 head_norm_before_train=1.886730 (no previous merge yet)
[S7] round=85 local utility u=0.184635 metrics={'f1_val': 0.6760767485415724, 'auprc': 0.837174626992627, 'loss_val': 0.31120394072192403, 'psi': 0.7405158999219943}-{'f1_val': 0.662787321211689, 'auprc': 0.7987221280356299, 'loss_val': 0.4853798146519192, 'psi': 0.7171612439412653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=85 head_norm_before_train=1.996284 cos_to_last_merge=0.9392 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=85 local utility u=0.006155 metrics={'f1_val': 0.9943863538992247, 'auprc': 0.9997231960858962, 'loss_val': 0.026803174726907908, 'psi': 0.9965210907738933}-{'f1_val': 0.9927475182363883, 'auprc': 0.9994927232817942, 'loss_val': 0.028587828869151753, 'psi': 0.9954456002545506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=85 head_norm_before_train=2.148141 cos_to_last_merge=0.7833 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.783
[S9] round=85 local utility u=0.004910 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987856299734256, 'loss_val': 0.017480850021370068, 'psi': 0.9975105590777051}-{'f1_val': 0.9966605118138915, 'auprc': 0.9956318141990835, 'loss_val': 0.017838731535488987, 'psi': 0.9962490327679683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=85 head_norm_before_train=2.060775 cos_to_last_merge=0.8507 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.851
[S10] round=85 local utility u=0.000066 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936060778258515, 'loss_val': 0.026515130697784668, 'psi': 0.9945551345419654}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935964509676553, 'loss_val': 0.02661731492763098, 'psi': 0.994551283798687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=85 head_norm_before_train=1.973394 cos_to_last_merge=0.8784 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.878
[S11] round=85 local utility u=0.000111 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9988294395769927, 'loss_val': 0.018212409047934947, 'psi': 0.9972119807787827}-{'f1_val': 0.9961336749133093, 'auprc': 0.998822597766255, 'loss_val': 0.018413124842511876, 'psi': 0.9972092440544876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=85 head_norm_before_train=1.662869 cos_to_last_merge=0.8789 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=85 local utility u=0.006224 metrics={'f1_val': 0.7260376751747608, 'auprc': 0.8698638490519143, 'loss_val': 0.9354714536504284, 'psi': 0.7835681447256222}-{'f1_val': 0.7257798340599111, 'auprc': 0.8213756406789725, 'loss_val': 0.8009079470164996, 'psi': 0.7640181567075357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=85 head_norm_before_train=2.035611 cos_to_last_merge=0.9406 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.995965419164117, 'auprc': 0.9992364332481185, 'loss_val': 0.020805830686804066, 'psi': 0.9972738247977175}-{'f1_val': 0.9976298044288424, 'auprc': 0.999232535529969, 'loss_val': 0.01578551159360502, 'psi': 0.998270896869293}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=2.071905 cos_to_last_merge=0.9348 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.9044576113934475, 'auprc': 0.9975744945999446, 'loss_val': 0.13747384014642447, 'psi': 0.9417043646760463}-{'f1_val': 0.9111929131762665, 'auprc': 0.9980297209235041, 'loss_val': 0.14308770615661692, 'psi': 0.9459276362751614}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=85 head_norm_before_train=2.161175 (no previous merge yet)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9408010454480484, 'auprc': 0.9823655124179473, 'loss_val': 0.31755162515238283, 'psi': 0.957426832236008}-{'f1_val': 0.9424724390055018, 'auprc': 0.983993845502521, 'loss_val': 0.24859335147877362, 'psi': 0.9590810016043094}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=1.966319 cos_to_last_merge=0.8736 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=85 local utility u=0.186601 metrics={'f1_val': 0.7196910536000136, 'auprc': 0.93988676433133, 'loss_val': 0.8543518626657202, 'psi': 0.8077693378925401}-{'f1_val': 0.6966333473942927, 'auprc': 0.9339809898331881, 'loss_val': 1.0714910057997056, 'psi': 0.7915724043698509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=86 head_norm_before_train=1.913836 cos_to_last_merge=0.8829 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=86 local utility u=0.022624 metrics={'f1_val': 0.7200446381060452, 'auprc': 0.7763832048256066, 'loss_val': 0.9758401090945613, 'psi': 0.7425800647938698}-{'f1_val': 0.7200446381060452, 'auprc': 0.7568508750975591, 'loss_val': 0.9624914643332603, 'psi': 0.7347671329026508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=86 head_norm_before_train=2.167872 cos_to_last_merge=0.9254 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.688081702550678, 'auprc': 0.9863265767779299, 'loss_val': 0.922381166755953, 'psi': 0.8073796522415788}-{'f1_val': 0.8583221529859104, 'auprc': 0.9982649786668983, 'loss_val': 0.3156406169598089, 'psi': 0.9142992832583056}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=1.928217 cos_to_last_merge=0.7499 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.750
[S4] round=86 local utility u=0.039007 metrics={'f1_val': 0.9438952349907435, 'auprc': 0.9718502877054234, 'loss_val': 0.2941863373008505, 'psi': 0.9550772560766154}-{'f1_val': 0.9417991688136585, 'auprc': 0.9524741565216303, 'loss_val': 0.3014957156198027, 'psi': 0.9460691638968473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=86 head_norm_before_train=1.602254 cos_to_last_merge=0.8251 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=86 local utility u=1.000000 metrics={'f1_val': 0.995996280939491, 'auprc': 0.9971878973623246, 'loss_val': 0.07391672276986037, 'psi': 0.9964729275086245}-{'f1_val': 0.6154882600121141, 'auprc': 0.8648153208618214, 'loss_val': 0.6877911861905197, 'psi': 0.715219084351997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=86 head_norm_before_train=1.908726 cos_to_last_merge=0.8068 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=86 local utility u=0.807384 metrics={'f1_val': 0.6136762080852467, 'auprc': 0.8662454590787754, 'loss_val': 0.9368816643135734, 'psi': 0.7147039084826582}-{'f1_val': 0.49726433686766336, 'auprc': 0.6949040439923128, 'loss_val': 1.3391549715679039, 'psi': 0.5763202197175231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=86 head_norm_before_train=1.889939 (no previous merge yet)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6160400304065882, 'auprc': 0.7887282154301507, 'loss_val': 0.7032768764275352, 'psi': 0.6851153044160132}-{'f1_val': 0.6760767485415724, 'auprc': 0.837174626992627, 'loss_val': 0.31120394072192403, 'psi': 0.7405158999219943}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=2.000772 cos_to_last_merge=0.9389 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.992384245702453, 'auprc': 0.9993374732366145, 'loss_val': 0.02835419442971327, 'psi': 0.9951655367161175}-{'f1_val': 0.9943863538992247, 'auprc': 0.9997231960858962, 'loss_val': 0.026803174726907908, 'psi': 0.9965210907738933}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=2.150071 cos_to_last_merge=0.7829 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.783
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9986628292687993, 'loss_val': 0.04016476602837147, 'psi': 0.9931781987783458}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987856299734256, 'loss_val': 0.017480850021370068, 'psi': 0.9975105590777051}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.065549 cos_to_last_merge=0.8502 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.850
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935867054332016, 'loss_val': 0.026510717989645535, 'psi': 0.9945473855849054}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936060778258515, 'loss_val': 0.026515130697784668, 'psi': 0.9945551345419654}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=1.976806 cos_to_last_merge=0.8779 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.878
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9913449160568414, 'auprc': 0.9992055651683196, 'loss_val': 0.03714978503097058, 'psi': 0.9944891757014327}-{'f1_val': 0.9961336749133093, 'auprc': 0.9988294395769927, 'loss_val': 0.018212409047934947, 'psi': 0.9972119807787827}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=1.670192 cos_to_last_merge=0.8783 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6684625830107823, 'auprc': 0.79083276723165, 'loss_val': 0.8222037653642332, 'psi': 0.7174106566991294}-{'f1_val': 0.7260376751747608, 'auprc': 0.8698638490519143, 'loss_val': 0.9354714536504284, 'psi': 0.7835681447256222}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=2.039710 cos_to_last_merge=0.9407 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9464951252171072, 'auprc': 0.999237184550003, 'loss_val': 0.07276054301567098, 'psi': 0.9675919489502656}-{'f1_val': 0.995965419164117, 'auprc': 0.9992364332481185, 'loss_val': 0.020805830686804066, 'psi': 0.9972738247977175}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=2.076921 cos_to_last_merge=0.9344 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.9017484837457268, 'auprc': 0.9974634275703828, 'loss_val': 0.2989244281122709, 'psi': 0.9400344612755892}-{'f1_val': 0.9044576113934475, 'auprc': 0.9975744945999446, 'loss_val': 0.13747384014642447, 'psi': 0.9417043646760463}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=2.164840 (no previous merge yet)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9404154258907993, 'auprc': 0.9742873078874539, 'loss_val': 0.3432881155050385, 'psi': 0.9539641786894612}-{'f1_val': 0.9408010454480484, 'auprc': 0.9823655124179473, 'loss_val': 0.31755162515238283, 'psi': 0.957426832236008}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=1.969307 cos_to_last_merge=0.8732 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.873
[S17] round=86 local utility u=0.301643 metrics={'f1_val': 0.7842103292392492, 'auprc': 0.923428084367858, 'loss_val': 0.5888054875461746, 'psi': 0.8398974312906926}-{'f1_val': 0.7196910536000136, 'auprc': 0.93988676433133, 'loss_val': 0.8543518626657202, 'psi': 0.8077693378925401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=87 head_norm_before_train=1.918254 cos_to_last_merge=0.8825 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.882
[S2] round=87 local utility u=0.003167 metrics={'f1_val': 0.7200446381060452, 'auprc': 0.7777814518362647, 'loss_val': 0.9737003288135897, 'psi': 0.7431393635981329}-{'f1_val': 0.7200446381060452, 'auprc': 0.7763832048256066, 'loss_val': 0.9758401090945613, 'psi': 0.7425800647938698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=87 head_norm_before_train=2.174095 cos_to_last_merge=0.9249 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=87 local utility u=0.972566 metrics={'f1_val': 0.8920859024814758, 'auprc': 0.9975085943084862, 'loss_val': 0.23481997230284699, 'psi': 0.9342549792122798}-{'f1_val': 0.688081702550678, 'auprc': 0.9863265767779299, 'loss_val': 0.922381166755953, 'psi': 0.8073796522415788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=87 head_norm_before_train=1.937739 cos_to_last_merge=0.7491 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.749
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9406382943335427, 'auprc': 0.9443631754207369, 'loss_val': 0.30524095842606414, 'psi': 0.9421282467684204}-{'f1_val': 0.9438952349907435, 'auprc': 0.9718502877054234, 'loss_val': 0.2941863373008505, 'psi': 0.9550772560766154}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.608549 cos_to_last_merge=0.8232 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.7004465831882414, 'auprc': 0.9858533410433477, 'loss_val': 0.47712790300821906, 'psi': 0.8146092863302838}-{'f1_val': 0.995996280939491, 'auprc': 0.9971878973623246, 'loss_val': 0.07391672276986037, 'psi': 0.9964729275086245}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=1.913960 cos_to_last_merge=0.8069 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=87 local utility u=0.366151 metrics={'f1_val': 0.673407427246004, 'auprc': 0.9307996221682129, 'loss_val': 0.756629658773946, 'psi': 0.7763643052148876}-{'f1_val': 0.6136762080852467, 'auprc': 0.8662454590787754, 'loss_val': 0.9368816643135734, 'psi': 0.7147039084826582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=87 head_norm_before_train=1.894671 (no previous merge yet)
[S7] round=87 local utility u=0.433827 metrics={'f1_val': 0.6755666950527068, 'auprc': 0.832917859396317, 'loss_val': 0.32535117119786294, 'psi': 0.738507160790151}-{'f1_val': 0.6160400304065882, 'auprc': 0.7887282154301507, 'loss_val': 0.7032768764275352, 'psi': 0.6851153044160132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=87 head_norm_before_train=2.006004 cos_to_last_merge=0.9386 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=87 local utility u=0.005066 metrics={'f1_val': 0.9941844798433713, 'auprc': 0.9997889773781989, 'loss_val': 0.03037758803157313, 'psi': 0.9964262788573024}-{'f1_val': 0.992384245702453, 'auprc': 0.9993374732366145, 'loss_val': 0.02835419442971327, 'psi': 0.9951655367161175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=87 head_norm_before_train=2.153474 cos_to_last_merge=0.7828 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.783
[S9] round=87 local utility u=0.015687 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.998797657466275, 'loss_val': 0.026975776305671714, 'psi': 0.9950102501740419}-{'f1_val': 0.9895217784513768, 'auprc': 0.9986628292687993, 'loss_val': 0.04016476602837147, 'psi': 0.9931781987783458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=87 head_norm_before_train=2.068610 cos_to_last_merge=0.8500 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.850
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935010135316105, 'loss_val': 0.02662830498971212, 'psi': 0.994513108824269}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935867054332016, 'loss_val': 0.026510717989645535, 'psi': 0.9945473855849054}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=1.977289 cos_to_last_merge=0.8771 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.877
[S11] round=87 local utility u=0.025303 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9991409538289662, 'loss_val': 0.01758597987856571, 'psi': 0.9975869345286448}-{'f1_val': 0.9913449160568414, 'auprc': 0.9992055651683196, 'loss_val': 0.03714978503097058, 'psi': 0.9944891757014327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=87 head_norm_before_train=1.676252 cos_to_last_merge=0.8776 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=87 local utility u=0.130643 metrics={'f1_val': 0.6911449783220105, 'auprc': 0.7758618348168757, 'loss_val': 0.6521001584271827, 'psi': 0.7250317209199566}-{'f1_val': 0.6684625830107823, 'auprc': 0.79083276723165, 'loss_val': 0.8222037653642332, 'psi': 0.7174106566991294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=87 head_norm_before_train=2.044739 cos_to_last_merge=0.9410 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.9433390454747701, 'auprc': 0.9991946856442966, 'loss_val': 0.0831572647887665, 'psi': 0.9656813015425807}-{'f1_val': 0.9464951252171072, 'auprc': 0.999237184550003, 'loss_val': 0.07276054301567098, 'psi': 0.9675919489502656}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=2.081720 cos_to_last_merge=0.9340 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=87 local utility u=0.032280 metrics={'f1_val': 0.9034672669907312, 'auprc': 0.9979799919822248, 'loss_val': 0.24622710640574197, 'psi': 0.9412723569873287}-{'f1_val': 0.9017484837457268, 'auprc': 0.9974634275703828, 'loss_val': 0.2989244281122709, 'psi': 0.9400344612755892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=87 head_norm_before_train=2.164125 (no previous merge yet)
[S16] round=87 local utility u=0.021749 metrics={'f1_val': 0.9418202477255793, 'auprc': 0.9707765838523315, 'loss_val': 0.2976868774880547, 'psi': 0.95340278217628}-{'f1_val': 0.9404154258907993, 'auprc': 0.9742873078874539, 'loss_val': 0.3432881155050385, 'psi': 0.9539641786894612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=87 head_norm_before_train=1.973135 cos_to_last_merge=0.8728 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.873
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.7026878951931642, 'auprc': 0.9069771052346429, 'loss_val': 0.9581116407297997, 'psi': 0.7844035792097557}-{'f1_val': 0.7842103292392492, 'auprc': 0.923428084367858, 'loss_val': 0.5888054875461746, 'psi': 0.8398974312906926}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=1.923519 cos_to_last_merge=0.8819 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.882
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.7199364990407165, 'auprc': 0.7531481917647789, 'loss_val': 0.9727883196277135, 'psi': 0.7332211761303415}-{'f1_val': 0.7200446381060452, 'auprc': 0.7777814518362647, 'loss_val': 0.9737003288135897, 'psi': 0.7431393635981329}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=2.179744 cos_to_last_merge=0.9244 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=88 local utility u=0.317864 metrics={'f1_val': 0.9701228698495734, 'auprc': 0.9993335298625712, 'loss_val': 0.07278929256801522, 'psi': 0.9818071338547725}-{'f1_val': 0.8920859024814758, 'auprc': 0.9975085943084862, 'loss_val': 0.23481997230284699, 'psi': 0.9342549792122798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=88 head_norm_before_train=1.938162 cos_to_last_merge=0.7483 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.748
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9407184503455046, 'auprc': 0.9403769094141121, 'loss_val': 0.3090039151140713, 'psi': 0.9405818339729477}-{'f1_val': 0.9406382943335427, 'auprc': 0.9443631754207369, 'loss_val': 0.30524095842606414, 'psi': 0.9421282467684204}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.615423 cos_to_last_merge=0.8213 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.821
[S5] round=88 local utility u=1.000000 metrics={'f1_val': 0.9958798017551914, 'auprc': 0.9968335952780457, 'loss_val': 0.06195131551701571, 'psi': 0.9962613191643331}-{'f1_val': 0.7004465831882414, 'auprc': 0.9858533410433477, 'loss_val': 0.47712790300821906, 'psi': 0.8146092863302838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=88 head_norm_before_train=1.921439 cos_to_last_merge=0.8067 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=88 local utility u=1.000000 metrics={'f1_val': 0.9482725441141626, 'auprc': 0.9648904578053867, 'loss_val': 0.23846350578697129, 'psi': 0.9549197095906523}-{'f1_val': 0.673407427246004, 'auprc': 0.9307996221682129, 'loss_val': 0.756629658773946, 'psi': 0.7763643052148876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=88 head_norm_before_train=1.899725 (no previous merge yet)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.6156471194668626, 'auprc': 0.7900249803409412, 'loss_val': 0.7541187423900844, 'psi': 0.6853982638164939}-{'f1_val': 0.6755666950527068, 'auprc': 0.832917859396317, 'loss_val': 0.32535117119786294, 'psi': 0.738507160790151}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=2.009714 cos_to_last_merge=0.9382 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=88 local utility u=0.004331 metrics={'f1_val': 0.99528437219618, 'auprc': 0.9997586452074275, 'loss_val': 0.028223538056298854, 'psi': 0.997074081400679}-{'f1_val': 0.9941844798433713, 'auprc': 0.9997889773781989, 'loss_val': 0.03037758803157313, 'psi': 0.9964262788573024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=88 head_norm_before_train=2.157739 cos_to_last_merge=0.7826 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.783
[S9] round=88 local utility u=0.012795 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9960942908793248, 'loss_val': 0.018327090427160964, 'psi': 0.9964340234400648}-{'f1_val': 0.9924853119792197, 'auprc': 0.998797657466275, 'loss_val': 0.026975776305671714, 'psi': 0.9950102501740419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=88 head_norm_before_train=2.071282 cos_to_last_merge=0.8498 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.850
[S10] round=88 local utility u=0.000045 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935233642372077, 'loss_val': 0.026604393092675795, 'psi': 0.9945220491065079}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935010135316105, 'loss_val': 0.02662830498971212, 'psi': 0.994513108824269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=88 head_norm_before_train=1.979010 cos_to_last_merge=0.8766 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.877
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9988874545757505, 'loss_val': 0.02598097949616983, 'psi': 0.9974855348273586}-{'f1_val': 0.9965509216617638, 'auprc': 0.9991409538289662, 'loss_val': 0.01758597987856571, 'psi': 0.9975869345286448}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=1.679438 cos_to_last_merge=0.8772 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.877
[S13] round=88 local utility u=0.100863 metrics={'f1_val': 0.7198005584675697, 'auprc': 0.8835437058439701, 'loss_val': 0.9453538067399356, 'psi': 0.78529781741813}-{'f1_val': 0.6911449783220105, 'auprc': 0.7758618348168757, 'loss_val': 0.6521001584271827, 'psi': 0.7250317209199566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=88 head_norm_before_train=2.049845 cos_to_last_merge=0.9412 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=88 local utility u=0.180310 metrics={'f1_val': 0.9940755032987544, 'auprc': 0.9991535909213912, 'loss_val': 0.026832810428629426, 'psi': 0.996106738347809}-{'f1_val': 0.9433390454747701, 'auprc': 0.9991946856442966, 'loss_val': 0.0831572647887665, 'psi': 0.9656813015425807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=88 head_norm_before_train=2.086441 cos_to_last_merge=0.9337 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=88 local utility u=0.319818 metrics={'f1_val': 0.9758195547070906, 'auprc': 0.9975717736065437, 'loss_val': 0.03947982643396709, 'psi': 0.9845204422668719}-{'f1_val': 0.9034672669907312, 'auprc': 0.9979799919822248, 'loss_val': 0.24622710640574197, 'psi': 0.9412723569873287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=88 head_norm_before_train=2.165623 (no previous merge yet)
[S16] round=88 local utility u=0.076081 metrics={'f1_val': 0.9453997733129846, 'auprc': 0.9806965817955802, 'loss_val': 0.1967616219072044, 'psi': 0.9595184967060228}-{'f1_val': 0.9418202477255793, 'auprc': 0.9707765838523315, 'loss_val': 0.2976868774880547, 'psi': 0.95340278217628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=88 head_norm_before_train=1.980027 cos_to_last_merge=0.8722 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.6829678815629258, 'auprc': 0.9016052978193893, 'loss_val': 1.2061288569380006, 'psi': 0.7704228480655112}-{'f1_val': 0.7026878951931642, 'auprc': 0.9069771052346429, 'loss_val': 0.9581116407297997, 'psi': 0.7844035792097557}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=89 head_norm_before_train=1.927776 cos_to_last_merge=0.8815 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.882
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.7200446381060452, 'auprc': 0.7513308966989876, 'loss_val': 0.9799501102239123, 'psi': 0.7325591415432222}-{'f1_val': 0.7199364990407165, 'auprc': 0.7531481917647789, 'loss_val': 0.9727883196277135, 'psi': 0.7332211761303415}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=2.183993 cos_to_last_merge=0.9239 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.9569663749734476, 'auprc': 0.9979090027741093, 'loss_val': 0.09713673322949391, 'psi': 0.9733434260937123}-{'f1_val': 0.9701228698495734, 'auprc': 0.9993335298625712, 'loss_val': 0.07278929256801522, 'psi': 0.9818071338547725}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=1.940329 cos_to_last_merge=0.7477 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.748
[S4] round=89 local utility u=0.106643 metrics={'f1_val': 0.9546964882834719, 'auprc': 0.9751589596578056, 'loss_val': 0.283932237132822, 'psi': 0.9628814768332055}-{'f1_val': 0.9407184503455046, 'auprc': 0.9403769094141121, 'loss_val': 0.3090039151140713, 'psi': 0.9405818339729477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=89 head_norm_before_train=1.620977 cos_to_last_merge=0.8198 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.820
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9278622185670604, 'auprc': 0.9962079019458697, 'loss_val': 0.11972414355631854, 'psi': 0.9552004919185841}-{'f1_val': 0.9958798017551914, 'auprc': 0.9968335952780457, 'loss_val': 0.06195131551701571, 'psi': 0.9962613191643331}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=1.928595 cos_to_last_merge=0.8065 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.8125000309552538, 'auprc': 0.9490359760532288, 'loss_val': 0.5056993878927757, 'psi': 0.8671144089944438}-{'f1_val': 0.9482725441141626, 'auprc': 0.9648904578053867, 'loss_val': 0.23846350578697129, 'psi': 0.9549197095906523}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.903168 (no previous merge yet)
[S7] round=89 local utility u=0.177986 metrics={'f1_val': 0.626897098060856, 'auprc': 0.8000975316050727, 'loss_val': 0.49586448349583423, 'psi': 0.6961772714785427}-{'f1_val': 0.6156471194668626, 'auprc': 0.7900249803409412, 'loss_val': 0.7541187423900844, 'psi': 0.6853982638164939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=89 head_norm_before_train=2.013838 cos_to_last_merge=0.9376 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.9923740886046254, 'auprc': 0.9997935306098206, 'loss_val': 0.025827780273457338, 'psi': 0.9953418654067034}-{'f1_val': 0.99528437219618, 'auprc': 0.9997586452074275, 'loss_val': 0.028223538056298854, 'psi': 0.997074081400679}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=89 head_norm_before_train=2.159534 cos_to_last_merge=0.7821 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.782
[S9] round=89 local utility u=0.004081 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987738598745726, 'loss_val': 0.018202876668073385, 'psi': 0.9975058510381639}-{'f1_val': 0.9966605118138915, 'auprc': 0.9960942908793248, 'loss_val': 0.018327090427160964, 'psi': 0.9964340234400648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=89 head_norm_before_train=2.075116 cos_to_last_merge=0.8495 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.849
[S10] round=89 local utility u=0.000187 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936354016757856, 'loss_val': 0.026567398830160297, 'psi': 0.9945668640819391}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935233642372077, 'loss_val': 0.026604393092675795, 'psi': 0.9945220491065079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=89 head_norm_before_train=1.983171 cos_to_last_merge=0.8761 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.876
[S11] round=89 local utility u=0.004351 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9991861548893859, 'loss_val': 0.01817449705663029, 'psi': 0.9976050149528127}-{'f1_val': 0.9965509216617638, 'auprc': 0.9988874545757505, 'loss_val': 0.02598097949616983, 'psi': 0.9974855348273586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=89 head_norm_before_train=1.681869 cos_to_last_merge=0.8770 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.877
[S13] round=89 local utility u=0.062971 metrics={'f1_val': 0.7361238838399405, 'auprc': 0.8442236050285813, 'loss_val': 0.7993918515287266, 'psi': 0.7793637723153968}-{'f1_val': 0.7198005584675697, 'auprc': 0.8835437058439701, 'loss_val': 0.9453538067399356, 'psi': 0.78529781741813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=89 head_norm_before_train=2.051690 cos_to_last_merge=0.9407 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=89 local utility u=0.017726 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9991422405829217, 'loss_val': 0.01629270819939317, 'psi': 0.9985967027094916}-{'f1_val': 0.9940755032987544, 'auprc': 0.9991535909213912, 'loss_val': 0.026832810428629426, 'psi': 0.996106738347809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=89 head_norm_before_train=2.091167 cos_to_last_merge=0.9333 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.963671457910184, 'auprc': 0.9980429576837813, 'loss_val': 0.05323004165561619, 'psi': 0.9774200578196229}-{'f1_val': 0.9758195547070906, 'auprc': 0.9975717736065437, 'loss_val': 0.03947982643396709, 'psi': 0.9845204422668719}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=2.170295 (no previous merge yet)
[S16] round=89 local utility u=0.072148 metrics={'f1_val': 0.9560585072211243, 'auprc': 0.9864428407159341, 'loss_val': 0.13365598973292162, 'psi': 0.9682122406190482}-{'f1_val': 0.9453997733129846, 'auprc': 0.9806965817955802, 'loss_val': 0.1967616219072044, 'psi': 0.9595184967060228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=89 head_norm_before_train=1.988375 cos_to_last_merge=0.8716 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=89 local utility u=0.732379 metrics={'f1_val': 0.8372333876446916, 'auprc': 0.9215790137175401, 'loss_val': 0.7268848782615618, 'psi': 0.870971638073831}-{'f1_val': 0.6829678815629258, 'auprc': 0.9016052978193893, 'loss_val': 1.2061288569380006, 'psi': 0.7704228480655112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=90 head_norm_before_train=1.933380 cos_to_last_merge=0.8811 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.881
[S2] round=90 local utility u=0.042610 metrics={'f1_val': 0.7116678387765198, 'auprc': 0.7550356421820794, 'loss_val': 0.8555843965162501, 'psi': 0.7290149601387437}-{'f1_val': 0.7200446381060452, 'auprc': 0.7513308966989876, 'loss_val': 0.9799501102239123, 'psi': 0.7325591415432222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=90 head_norm_before_train=2.187511 cos_to_last_merge=0.9236 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.8006920966205197, 'auprc': 0.9836779802517165, 'loss_val': 0.5733505823335109, 'psi': 0.8738864500729984}-{'f1_val': 0.9569663749734476, 'auprc': 0.9979090027741093, 'loss_val': 0.09713673322949391, 'psi': 0.9733434260937123}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=1.941033 cos_to_last_merge=0.7473 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.747
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.9521929937373989, 'auprc': 0.9617449979104539, 'loss_val': 0.3037748218513677, 'psi': 0.9560137954066209}-{'f1_val': 0.9546964882834719, 'auprc': 0.9751589596578056, 'loss_val': 0.283932237132822, 'psi': 0.9628814768332055}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=1.626744 cos_to_last_merge=0.8182 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.818
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.8736364250324787, 'auprc': 0.99527092721789, 'loss_val': 0.16795650220813996, 'psi': 0.9222902259066432}-{'f1_val': 0.9278622185670604, 'auprc': 0.9962079019458697, 'loss_val': 0.11972414355631854, 'psi': 0.9552004919185841}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=1.933805 cos_to_last_merge=0.8061 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.806
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.7813321722528664, 'auprc': 0.8874792951704105, 'loss_val': 0.5350952445782265, 'psi': 0.823791021419884}-{'f1_val': 0.8125000309552538, 'auprc': 0.9490359760532288, 'loss_val': 0.5056993878927757, 'psi': 0.8671144089944438}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=1.905751 (no previous merge yet)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.616919152534653, 'auprc': 0.7976252054993087, 'loss_val': 0.5330018791328353, 'psi': 0.6892015737205153}-{'f1_val': 0.626897098060856, 'auprc': 0.8000975316050727, 'loss_val': 0.49586448349583423, 'psi': 0.6961772714785427}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=2.018274 cos_to_last_merge=0.9367 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.974600571072251, 'auprc': 0.9982468911222251, 'loss_val': 0.06503390269126291, 'psi': 0.9840590990922407}-{'f1_val': 0.9923740886046254, 'auprc': 0.9997935306098206, 'loss_val': 0.025827780273457338, 'psi': 0.9953418654067034}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=90 head_norm_before_train=2.161476 cos_to_last_merge=0.7817 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.782
[S9] round=90 local utility u=0.000172 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987677541646327, 'loss_val': 0.01783980504693153, 'psi': 0.997503408754188}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987738598745726, 'loss_val': 0.018202876668073385, 'psi': 0.9975058510381639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=90 head_norm_before_train=2.079520 cos_to_last_merge=0.8490 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.849
[S10] round=90 local utility u=0.000037 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936460049553397, 'loss_val': 0.02652496288870962, 'psi': 0.9945711053937607}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936354016757856, 'loss_val': 0.026567398830160297, 'psi': 0.9945668640819391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=90 head_norm_before_train=1.988604 cos_to_last_merge=0.8758 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.876
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9913016519435816, 'auprc': 0.9992031236809176, 'loss_val': 0.03841270336780475, 'psi': 0.994462240638516}-{'f1_val': 0.9965509216617638, 'auprc': 0.9991861548893859, 'loss_val': 0.01817449705663029, 'psi': 0.9976050149528127}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=1.685782 cos_to_last_merge=0.8766 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.877
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.7233256199254703, 'auprc': 0.809909714289724, 'loss_val': 0.65826810523645, 'psi': 0.7579592576711718}-{'f1_val': 0.7361238838399405, 'auprc': 0.8442236050285813, 'loss_val': 0.7993918515287266, 'psi': 0.7793637723153968}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=2.054895 cos_to_last_merge=0.9403 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991505862395426, 'loss_val': 0.015310489223420534, 'psi': 0.9983532901084724}-{'f1_val': 0.9982330107938716, 'auprc': 0.9991422405829217, 'loss_val': 0.01629270819939317, 'psi': 0.9985967027094916}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.096029 cos_to_last_merge=0.9329 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.948604372467424, 'auprc': 0.9981821055664404, 'loss_val': 0.07463242667184702, 'psi': 0.9684354657070307}-{'f1_val': 0.963671457910184, 'auprc': 0.9980429576837813, 'loss_val': 0.05323004165561619, 'psi': 0.9774200578196229}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=2.176413 (no previous merge yet)
[S16] round=90 local utility u=0.043771 metrics={'f1_val': 0.9651766641168241, 'auprc': 0.9910035067385045, 'loss_val': 0.11450542065525672, 'psi': 0.9755074011654963}-{'f1_val': 0.9560585072211243, 'auprc': 0.9864428407159341, 'loss_val': 0.13365598973292162, 'psi': 0.9682122406190482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=90 head_norm_before_train=1.998466 cos_to_last_merge=0.8709 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.871
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.7725076636343129, 'auprc': 0.9167306299112923, 'loss_val': 0.8900456858335474, 'psi': 0.8301968501451047}-{'f1_val': 0.8372333876446916, 'auprc': 0.9215790137175401, 'loss_val': 0.7268848782615618, 'psi': 0.870971638073831}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=1.939026 cos_to_last_merge=0.8804 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.880
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.6832265312753277, 'auprc': 0.7729079226598473, 'loss_val': 0.8100723281593213, 'psi': 0.7190990878291356}-{'f1_val': 0.7116678387765198, 'auprc': 0.7550356421820794, 'loss_val': 0.8555843965162501, 'psi': 0.7290149601387437}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=91 head_norm_before_train=2.190917 cos_to_last_merge=0.9232 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.715687039104514, 'auprc': 0.9898990554083201, 'loss_val': 0.7910637347495891, 'psi': 0.8253718456260365}-{'f1_val': 0.8006920966205197, 'auprc': 0.9836779802517165, 'loss_val': 0.5733505823335109, 'psi': 0.8738864500729984}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=1.940658 cos_to_last_merge=0.7470 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.747
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9508418141914272, 'auprc': 0.9531127362162781, 'loss_val': 0.31061681211484404, 'psi': 0.9517501830013675}-{'f1_val': 0.9521929937373989, 'auprc': 0.9617449979104539, 'loss_val': 0.3037748218513677, 'psi': 0.9560137954066209}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.633346 cos_to_last_merge=0.8168 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.7665534106492451, 'auprc': 0.9820933842881852, 'loss_val': 0.2913654587930473, 'psi': 0.8527694001048212}-{'f1_val': 0.8736364250324787, 'auprc': 0.99527092721789, 'loss_val': 0.16795650220813996, 'psi': 0.9222902259066432}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=1.939724 cos_to_last_merge=0.8055 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.6861515129351583, 'auprc': 0.8745019586748856, 'loss_val': 0.7242128701550451, 'psi': 0.7614916912310492}-{'f1_val': 0.7813321722528664, 'auprc': 0.8874792951704105, 'loss_val': 0.5350952445782265, 'psi': 0.823791021419884}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=1.912082 (no previous merge yet)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.6220243091556753, 'auprc': 0.7950525130870191, 'loss_val': 0.6996230308951431, 'psi': 0.6912355907282128}-{'f1_val': 0.616919152534653, 'auprc': 0.7976252054993087, 'loss_val': 0.5330018791328353, 'psi': 0.6892015737205153}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=2.024346 cos_to_last_merge=0.9360 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.936
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.8106068318272792, 'auprc': 0.9986150380518132, 'loss_val': 0.4398862667417783, 'psi': 0.8858101143170929}-{'f1_val': 0.974600571072251, 'auprc': 0.9982468911222251, 'loss_val': 0.06503390269126291, 'psi': 0.9840590990922407}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=2.165605 cos_to_last_merge=0.7814 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9909631199453779, 'auprc': 0.9987759103747542, 'loss_val': 0.029421106393714442, 'psi': 0.9940882361171284}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987677541646327, 'loss_val': 0.01783980504693153, 'psi': 0.997503408754188}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.084194 cos_to_last_merge=0.8486 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.849
[S10] round=91 local utility u=0.000005 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936471950088233, 'loss_val': 0.026517941241742185, 'psi': 0.9945715814151541}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936460049553397, 'loss_val': 0.02652496288870962, 'psi': 0.9945711053937607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=91 head_norm_before_train=1.994009 cos_to_last_merge=0.8755 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.875
[S11] round=91 local utility u=0.027322 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9992122643724606, 'loss_val': 0.01529176542798788, 'psi': 0.9976154587460426}-{'f1_val': 0.9913016519435816, 'auprc': 0.9992031236809176, 'loss_val': 0.03841270336780475, 'psi': 0.994462240638516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=91 head_norm_before_train=1.690175 cos_to_last_merge=0.8760 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.876
[S13] round=91 local utility u=0.082878 metrics={'f1_val': 0.7534439151206449, 'auprc': 0.8593036159312684, 'loss_val': 0.8214032230402917, 'psi': 0.7957877954448942}-{'f1_val': 0.7233256199254703, 'auprc': 0.809909714289724, 'loss_val': 0.65826810523645, 'psi': 0.7579592576711718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=91 head_norm_before_train=2.060192 cos_to_last_merge=0.9400 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9991838569884752, 'loss_val': 0.015306548375090259, 'psi': 0.9983534770612575}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991505862395426, 'loss_val': 0.015310489223420534, 'psi': 0.9983532901084724}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=2.100839 cos_to_last_merge=0.9325 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=91 local utility u=0.002694 metrics={'f1_val': 0.9495692536736018, 'auprc': 0.9982602508591287, 'loss_val': 0.07526865172407962, 'psi': 0.9690456525478125}-{'f1_val': 0.948604372467424, 'auprc': 0.9981821055664404, 'loss_val': 0.07463242667184702, 'psi': 0.9684354657070307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=91 head_norm_before_train=2.182980 (no previous merge yet)
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9636952761952762, 'auprc': 0.9935673154067882, 'loss_val': 0.11816963132083812, 'psi': 0.975644091879881}-{'f1_val': 0.9651766641168241, 'auprc': 0.9910035067385045, 'loss_val': 0.11450542065525672, 'psi': 0.9755074011654963}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.010194 cos_to_last_merge=0.8701 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.7177229145262002, 'auprc': 0.9350609015831479, 'loss_val': 0.9104655646865268, 'psi': 0.8046581093489793}-{'f1_val': 0.7725076636343129, 'auprc': 0.9167306299112923, 'loss_val': 0.8900456858335474, 'psi': 0.8301968501451047}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=1.945723 cos_to_last_merge=0.8795 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.879
[S2] round=92 local utility u=0.081653 metrics={'f1_val': 0.7184045280834774, 'auprc': 0.7698345433633249, 'loss_val': 0.848613496682744, 'psi': 0.7389765341954164}-{'f1_val': 0.6832265312753277, 'auprc': 0.7729079226598473, 'loss_val': 0.8100723281593213, 'psi': 0.7190990878291356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=92 head_norm_before_train=2.195228 cos_to_last_merge=0.9229 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.6930578490540013, 'auprc': 0.9475775310044878, 'loss_val': 0.9737663920101981, 'psi': 0.7948657218341959}-{'f1_val': 0.715687039104514, 'auprc': 0.9898990554083201, 'loss_val': 0.7910637347495891, 'psi': 0.8253718456260365}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=1.941341 cos_to_last_merge=0.7466 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.747
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9405431142220564, 'auprc': 0.9269008954176348, 'loss_val': 0.30365458667893114, 'psi': 0.9350862267002877}-{'f1_val': 0.9508418141914272, 'auprc': 0.9531127362162781, 'loss_val': 0.31061681211484404, 'psi': 0.9517501830013675}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=1.639698 cos_to_last_merge=0.8148 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=92 local utility u=0.831163 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9981308453914959, 'loss_val': 0.05541201865771851, 'psi': 0.9970103292828545}-{'f1_val': 0.7665534106492451, 'auprc': 0.9820933842881852, 'loss_val': 0.2913654587930473, 'psi': 0.8527694001048212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=92 head_norm_before_train=1.943372 cos_to_last_merge=0.8049 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=92 local utility u=0.640697 metrics={'f1_val': 0.8379280393579287, 'auprc': 0.9204661469591642, 'loss_val': 0.49137052054279784, 'psi': 0.8709432823984229}-{'f1_val': 0.6861515129351583, 'auprc': 0.8745019586748856, 'loss_val': 0.7242128701550451, 'psi': 0.7614916912310492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=92 head_norm_before_train=1.919860 (no previous merge yet)
[S7] round=92 local utility u=0.043183 metrics={'f1_val': 0.6350608307055623, 'auprc': 0.7988513805421408, 'loss_val': 0.7028732041634886, 'psi': 0.7005770506401937}-{'f1_val': 0.6220243091556753, 'auprc': 0.7950525130870191, 'loss_val': 0.6996230308951431, 'psi': 0.6912355907282128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] START round=92 head_norm_before_train=2.027429 cos_to_last_merge=0.9356 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.936
[S8] round=92 local utility u=0.741010 metrics={'f1_val': 0.9901428157804911, 'auprc': 0.9982744288581428, 'loss_val': 0.03406065991217929, 'psi': 0.9933954610115519}-{'f1_val': 0.8106068318272792, 'auprc': 0.9986150380518132, 'loss_val': 0.4398862667417783, 'psi': 0.8858101143170929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=92 head_norm_before_train=2.170917 cos_to_last_merge=0.7813 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=92 local utility u=0.003395 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9987898350605557, 'loss_val': 0.027783691524087578, 'psi': 0.9946049304642559}-{'f1_val': 0.9909631199453779, 'auprc': 0.9987759103747542, 'loss_val': 0.029421106393714442, 'psi': 0.9940882361171284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=92 head_norm_before_train=2.088991 cos_to_last_merge=0.8481 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.848
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935766852794606, 'loss_val': 0.026781369419057125, 'psi': 0.9945433775234092}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936471950088233, 'loss_val': 0.026517941241742185, 'psi': 0.9945715814151541}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=1.998542 cos_to_last_merge=0.8753 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.875
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9942497496748522, 'auprc': 0.9987894735343776, 'loss_val': 0.07289479369252362, 'psi': 0.9960656392186624}-{'f1_val': 0.9965509216617638, 'auprc': 0.9992122643724606, 'loss_val': 0.01529176542798788, 'psi': 0.9976154587460426}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=1.694835 cos_to_last_merge=0.8755 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.875
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.6949560174227263, 'auprc': 0.8440134110819778, 'loss_val': 0.8884025126777574, 'psi': 0.7545789748864269}-{'f1_val': 0.7534439151206449, 'auprc': 0.8593036159312684, 'loss_val': 0.8214032230402917, 'psi': 0.7957877954448942}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=2.066311 cos_to_last_merge=0.9397 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=92 local utility u=0.000104 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9991924100386671, 'loss_val': 0.015124821900503516, 'psi': 0.9983568982813342}-{'f1_val': 0.9977998904431125, 'auprc': 0.9991838569884752, 'loss_val': 0.015306548375090259, 'psi': 0.9983534770612575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=92 head_norm_before_train=2.105466 cos_to_last_merge=0.9322 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=92 local utility u=0.037913 metrics={'f1_val': 0.9599764271466189, 'auprc': 0.998606923527574, 'loss_val': 0.0629263624746146, 'psi': 0.9754286256990009}-{'f1_val': 0.9495692536736018, 'auprc': 0.9982602508591287, 'loss_val': 0.07526865172407962, 'psi': 0.9690456525478125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=92 head_norm_before_train=2.189494 (no previous merge yet)
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9552646563066358, 'auprc': 0.9961574343301981, 'loss_val': 0.13339730846045625, 'psi': 0.9716217675160608}-{'f1_val': 0.9636952761952762, 'auprc': 0.9935673154067882, 'loss_val': 0.11816963132083812, 'psi': 0.975644091879881}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.020660 cos_to_last_merge=0.8695 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=92 local utility u=0.655244 metrics={'f1_val': 0.8336162082821151, 'auprc': 0.9927711884851228, 'loss_val': 0.4684688694948748, 'psi': 0.8972782003633182}-{'f1_val': 0.7177229145262002, 'auprc': 0.9350609015831479, 'loss_val': 0.9104655646865268, 'psi': 0.8046581093489793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=93 head_norm_before_train=1.951877 cos_to_last_merge=0.8788 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.879
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.7200446381060452, 'auprc': 0.776495853534861, 'loss_val': 0.9835025153293309, 'psi': 0.7426251242775714}-{'f1_val': 0.7184045280834774, 'auprc': 0.7698345433633249, 'loss_val': 0.848613496682744, 'psi': 0.7389765341954164}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.200432 cos_to_last_merge=0.9224 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=93 local utility u=1.000000 metrics={'f1_val': 0.9496450263474249, 'auprc': 0.9918197246539371, 'loss_val': 0.15042201384305842, 'psi': 0.9665149056700297}-{'f1_val': 0.6930578490540013, 'auprc': 0.9475775310044878, 'loss_val': 0.9737663920101981, 'psi': 0.7948657218341959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=93 head_norm_before_train=1.942958 cos_to_last_merge=0.7456 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.746
[S4] round=93 local utility u=0.061384 metrics={'f1_val': 0.944310363735331, 'auprc': 0.9532109567090786, 'loss_val': 0.2824199713323787, 'psi': 0.9478706009248301}-{'f1_val': 0.9405431142220564, 'auprc': 0.9269008954176348, 'loss_val': 0.30365458667893114, 'psi': 0.9350862267002877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=93 head_norm_before_train=1.646960 cos_to_last_merge=0.8131 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9958503366986691, 'auprc': 0.9965922005325514, 'loss_val': 0.05489815861822721, 'psi': 0.996147082232222}-{'f1_val': 0.9962633185437604, 'auprc': 0.9981308453914959, 'loss_val': 0.05541201865771851, 'psi': 0.9970103292828545}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=1.947006 cos_to_last_merge=0.8045 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.5959573545010888, 'auprc': 0.7582257622688516, 'loss_val': 1.1976733855115211, 'psi': 0.6608647176081939}-{'f1_val': 0.8379280393579287, 'auprc': 0.9204661469591642, 'loss_val': 0.49137052054279784, 'psi': 0.8709432823984229}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=1.927687 (no previous merge yet)
[S7] round=93 local utility u=0.066301 metrics={'f1_val': 0.6323796033738213, 'auprc': 0.803771755032088, 'loss_val': 0.5689447224925306, 'psi': 0.700936464037128}-{'f1_val': 0.6350608307055623, 'auprc': 0.7988513805421408, 'loss_val': 0.7028732041634886, 'psi': 0.7005770506401937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=93 head_norm_before_train=2.030837 cos_to_last_merge=0.9354 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.935
[S8] round=93 local utility u=0.020833 metrics={'f1_val': 0.995039935099408, 'auprc': 0.9997468874901154, 'loss_val': 0.026195239632539658, 'psi': 0.996922716055691}-{'f1_val': 0.9901428157804911, 'auprc': 0.9982744288581428, 'loss_val': 0.03406065991217929, 'psi': 0.9933954610115519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=93 head_norm_before_train=2.177113 cos_to_last_merge=0.7811 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=93 local utility u=0.014703 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.995631397238318, 'loss_val': 0.017975150457080903, 'psi': 0.996248865983662}-{'f1_val': 0.9918149940667227, 'auprc': 0.9987898350605557, 'loss_val': 0.027783691524087578, 'psi': 0.9946049304642559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=93 head_norm_before_train=2.093796 cos_to_last_merge=0.8476 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.848
[S10] round=93 local utility u=0.000093 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935911605840553, 'loss_val': 0.026638298145391183, 'psi': 0.9945491676452469}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935766852794606, 'loss_val': 0.026781369419057125, 'psi': 0.9945433775234092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=93 head_norm_before_train=2.002922 cos_to_last_merge=0.8751 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.875
[S11] round=93 local utility u=0.033670 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9991982604978968, 'loss_val': 0.01913741361848045, 'psi': 0.9974647549693799}-{'f1_val': 0.9942497496748522, 'auprc': 0.9987894735343776, 'loss_val': 0.07289479369252362, 'psi': 0.9960656392186624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=93 head_norm_before_train=1.699207 cos_to_last_merge=0.8751 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.875
[S13] round=93 local utility u=0.373019 metrics={'f1_val': 0.7732336835539552, 'auprc': 0.8533047342680853, 'loss_val': 0.6399038921448944, 'psi': 0.8052621038396073}-{'f1_val': 0.6949560174227263, 'auprc': 0.8440134110819778, 'loss_val': 0.8884025126777574, 'psi': 0.7545789748864269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=93 head_norm_before_train=2.072857 cos_to_last_merge=0.9394 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9982111419559175, 'auprc': 0.9988437677183184, 'loss_val': 0.017051114094470687, 'psi': 0.9984641922608779}-{'f1_val': 0.9977998904431125, 'auprc': 0.9991924100386671, 'loss_val': 0.015124821900503516, 'psi': 0.9983568982813342}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.109987 cos_to_last_merge=0.9318 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=93 local utility u=0.022876 metrics={'f1_val': 0.9655020067130645, 'auprc': 0.9986851981956417, 'loss_val': 0.05056232097139066, 'psi': 0.9787752833060954}-{'f1_val': 0.9599764271466189, 'auprc': 0.998606923527574, 'loss_val': 0.0629263624746146, 'psi': 0.9754286256990009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=93 head_norm_before_train=2.195847 (no previous merge yet)
[S16] round=93 local utility u=0.097712 metrics={'f1_val': 0.9803307171521585, 'auprc': 0.9910731451009628, 'loss_val': 0.07311616906536146, 'psi': 0.9846276883316802}-{'f1_val': 0.9552646563066358, 'auprc': 0.9961574343301981, 'loss_val': 0.13339730846045625, 'psi': 0.9716217675160608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=93 head_norm_before_train=2.029474 cos_to_last_merge=0.8689 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.7488863999717302, 'auprc': 0.9962939166602431, 'loss_val': 0.681217656730208, 'psi': 0.8478494066471354}-{'f1_val': 0.8336162082821151, 'auprc': 0.9927711884851228, 'loss_val': 0.4684688694948748, 'psi': 0.8972782003633182}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=94 head_norm_before_train=1.955715 cos_to_last_merge=0.8788 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.879
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.7201296721664179, 'auprc': 0.7669646120536491, 'loss_val': 1.0141938789065674, 'psi': 0.7388636481213104}-{'f1_val': 0.7200446381060452, 'auprc': 0.776495853534861, 'loss_val': 0.9835025153293309, 'psi': 0.7426251242775714}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.206446 cos_to_last_merge=0.9217 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.8251190965686421, 'auprc': 0.9606157728028026, 'loss_val': 0.44824109090463654, 'psi': 0.8793177670623062}-{'f1_val': 0.9496450263474249, 'auprc': 0.9918197246539371, 'loss_val': 0.15042201384305842, 'psi': 0.9665149056700297}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=1.941286 cos_to_last_merge=0.7449 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.745
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.940287991538513, 'auprc': 0.9489403628639359, 'loss_val': 0.29830347120760786, 'psi': 0.9437489400686822}-{'f1_val': 0.944310363735331, 'auprc': 0.9532109567090786, 'loss_val': 0.2824199713323787, 'psi': 0.9478706009248301}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.656017 cos_to_last_merge=0.8111 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9414888745710226, 'auprc': 0.9969536983604854, 'loss_val': 0.09584557186411119, 'psi': 0.9636748040868077}-{'f1_val': 0.9958503366986691, 'auprc': 0.9965922005325514, 'loss_val': 0.05489815861822721, 'psi': 0.996147082232222}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=1.951214 cos_to_last_merge=0.8040 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.804
[S6] round=94 local utility u=1.000000 metrics={'f1_val': 0.7900248685374641, 'auprc': 0.9381348527692176, 'loss_val': 0.6351400736044629, 'psi': 0.8492688622301655}-{'f1_val': 0.5959573545010888, 'auprc': 0.7582257622688516, 'loss_val': 1.1976733855115211, 'psi': 0.6608647176081939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=94 head_norm_before_train=1.933142 (no previous merge yet)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.619283744168438, 'auprc': 0.7953584447430703, 'loss_val': 0.7048452635733938, 'psi': 0.6897136243982909}-{'f1_val': 0.6323796033738213, 'auprc': 0.803771755032088, 'loss_val': 0.5689447224925306, 'psi': 0.700936464037128}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.031965 cos_to_last_merge=0.9353 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.935
[S8] round=94 local utility u=0.002271 metrics={'f1_val': 0.9949979787983566, 'auprc': 0.9997881791923512, 'loss_val': 0.02152614734387699, 'psi': 0.9969140589559544}-{'f1_val': 0.995039935099408, 'auprc': 0.9997468874901154, 'loss_val': 0.026195239632539658, 'psi': 0.996922716055691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=94 head_norm_before_train=2.182848 cos_to_last_merge=0.7808 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9903869619999369, 'loss_val': 0.01873182812507229, 'psi': 0.9939048416675413}-{'f1_val': 0.9966605118138915, 'auprc': 0.995631397238318, 'loss_val': 0.017975150457080903, 'psi': 0.996248865983662}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.098624 cos_to_last_merge=0.8472 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=94 local utility u=0.000060 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936094496374892, 'loss_val': 0.026573325330456, 'psi': 0.9945564832666205}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935911605840553, 'loss_val': 0.026638298145391183, 'psi': 0.9945491676452469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=94 head_norm_before_train=2.007029 cos_to_last_merge=0.8747 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.875
[S11] round=94 local utility u=0.001966 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9992122742913216, 'loss_val': 0.016820156935284866, 'psi': 0.9976276585838034}-{'f1_val': 0.9963090846170353, 'auprc': 0.9991982604978968, 'loss_val': 0.01913741361848045, 'psi': 0.9974647549693799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=94 head_norm_before_train=1.704149 cos_to_last_merge=0.8746 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.875
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6825745625324893, 'auprc': 0.8539363215859573, 'loss_val': 0.991845028172886, 'psi': 0.7511192661538766}-{'f1_val': 0.7732336835539552, 'auprc': 0.8533047342680853, 'loss_val': 0.6399038921448944, 'psi': 0.8052621038396073}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=2.072083 cos_to_last_merge=0.9389 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9979900342899044, 'auprc': 0.9989877171911874, 'loss_val': 0.017733761597030804, 'psi': 0.9983891074504176}-{'f1_val': 0.9982111419559175, 'auprc': 0.9988437677183184, 'loss_val': 0.017051114094470687, 'psi': 0.9984641922608779}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=2.114295 cos_to_last_merge=0.9315 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=94 local utility u=0.025509 metrics={'f1_val': 0.9722698961093575, 'auprc': 0.9987278040707763, 'loss_val': 0.040279860316335514, 'psi': 0.9828530592939251}-{'f1_val': 0.9655020067130645, 'auprc': 0.9986851981956417, 'loss_val': 0.05056232097139066, 'psi': 0.9787752833060954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=94 head_norm_before_train=2.194954 (no previous merge yet)
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.8697689698725992, 'auprc': 0.8828740881958402, 'loss_val': 0.917266152844007, 'psi': 0.8750110172018956}-{'f1_val': 0.9803307171521585, 'auprc': 0.9910731451009628, 'loss_val': 0.07311616906536146, 'psi': 0.9846276883316802}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=2.036137 cos_to_last_merge=0.8684 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=94 local utility u=0.848443 metrics={'f1_val': 0.9389754532071333, 'auprc': 0.9965981210012962, 'loss_val': 0.12577763669739325, 'psi': 0.9620245203247983}-{'f1_val': 0.7488863999717302, 'auprc': 0.9962939166602431, 'loss_val': 0.681217656730208, 'psi': 0.8478494066471354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=95 head_norm_before_train=1.960788 cos_to_last_merge=0.8785 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.878
[S2] round=95 local utility u=0.029474 metrics={'f1_val': 0.7200446381060452, 'auprc': 0.7818804982936063, 'loss_val': 0.9994823684152585, 'psi': 0.7447789821810696}-{'f1_val': 0.7201296721664179, 'auprc': 0.7669646120536491, 'loss_val': 1.0141938789065674, 'psi': 0.7388636481213104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=95 head_norm_before_train=2.211305 cos_to_last_merge=0.9213 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=95 local utility u=0.131097 metrics={'f1_val': 0.8439096880941168, 'auprc': 0.9852799144452453, 'loss_val': 0.37278403954760164, 'psi': 0.9004577786345682}-{'f1_val': 0.8251190965686421, 'auprc': 0.9606157728028026, 'loss_val': 0.44824109090463654, 'psi': 0.8793177670623062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=95 head_norm_before_train=1.942748 cos_to_last_merge=0.7447 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.745
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9396588553006695, 'auprc': 0.9412999223050884, 'loss_val': 0.3087986011684007, 'psi': 0.940315282102437}-{'f1_val': 0.940287991538513, 'auprc': 0.9489403628639359, 'loss_val': 0.29830347120760786, 'psi': 0.9437489400686822}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.668747 cos_to_last_merge=0.8089 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=95 local utility u=0.190763 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9976394132916317, 'loss_val': 0.045023768965489694, 'psi': 0.9968137564429089}-{'f1_val': 0.9414888745710226, 'auprc': 0.9969536983604854, 'loss_val': 0.09584557186411119, 'psi': 0.9636748040868077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=95 head_norm_before_train=1.953081 cos_to_last_merge=0.8036 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.804
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.6008886013885034, 'auprc': 0.9263236140571052, 'loss_val': 1.0906770607096508, 'psi': 0.7310626064559441}-{'f1_val': 0.7900248685374641, 'auprc': 0.9381348527692176, 'loss_val': 0.6351400736044629, 'psi': 0.8492688622301655}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.936400 (no previous merge yet)
[S7] round=95 local utility u=0.435442 metrics={'f1_val': 0.6750157957213196, 'auprc': 0.8417911411002723, 'loss_val': 0.3076524745789071, 'psi': 0.7417259338729008}-{'f1_val': 0.619283744168438, 'auprc': 0.7953584447430703, 'loss_val': 0.7048452635733938, 'psi': 0.6897136243982909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=95 head_norm_before_train=2.035640 cos_to_last_merge=0.9349 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.935
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9909365638023653, 'auprc': 0.9965023601954557, 'loss_val': 0.029257133952815772, 'psi': 0.9931628823596015}-{'f1_val': 0.9949979787983566, 'auprc': 0.9997881791923512, 'loss_val': 0.02152614734387699, 'psi': 0.9969140589559544}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=2.184970 cos_to_last_merge=0.7807 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=95 local utility u=0.014974 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9987711730491442, 'loss_val': 0.016570397452645932, 'psi': 0.9975219581983608}-{'f1_val': 0.9962500947792776, 'auprc': 0.9903869619999369, 'loss_val': 0.01873182812507229, 'psi': 0.9939048416675413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=95 head_norm_before_train=2.099946 cos_to_last_merge=0.8471 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=95 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993578474392594, 'loss_val': 0.02659789185743454, 'psi': 0.9945440931686624}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936094496374892, 'loss_val': 0.026573325330456, 'psi': 0.9945564832666205}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=95 head_norm_before_train=2.008166 cos_to_last_merge=0.8740 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.874
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9992131908979156, 'loss_val': 0.01682192177636477, 'psi': 0.9976158293562246}-{'f1_val': 0.9965712481121245, 'auprc': 0.9992122742913216, 'loss_val': 0.016820156935284866, 'psi': 0.9976276585838034}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.710579 cos_to_last_merge=0.8741 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.874
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6212858656873216, 'auprc': 0.9520117221736063, 'loss_val': 1.1050487006295804, 'psi': 0.7535762082818355}-{'f1_val': 0.6825745625324893, 'auprc': 0.8539363215859573, 'loss_val': 0.991845028172886, 'psi': 0.7511192661538766}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.072965 cos_to_last_merge=0.9388 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=95 local utility u=0.002357 metrics={'f1_val': 0.9982111419559175, 'auprc': 0.999179178553356, 'loss_val': 0.014920674184941527, 'psi': 0.9985983565948929}-{'f1_val': 0.9979900342899044, 'auprc': 0.9989877171911874, 'loss_val': 0.017733761597030804, 'psi': 0.9983891074504176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=95 head_norm_before_train=2.118614 cos_to_last_merge=0.9311 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=95 local utility u=0.023656 metrics={'f1_val': 0.9788928787035713, 'auprc': 0.9987484120304919, 'loss_val': 0.032767187443882885, 'psi': 0.9868350920343396}-{'f1_val': 0.9722698961093575, 'auprc': 0.9987278040707763, 'loss_val': 0.040279860316335514, 'psi': 0.9828530592939251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=95 head_norm_before_train=2.194582 (no previous merge yet)
[S16] round=95 local utility u=0.732148 metrics={'f1_val': 0.9439356967498624, 'auprc': 0.9853189434931681, 'loss_val': 0.2053042337026469, 'psi': 0.9604889954471847}-{'f1_val': 0.8697689698725992, 'auprc': 0.8828740881958402, 'loss_val': 0.917266152844007, 'psi': 0.8750110172018956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=95 head_norm_before_train=2.042239 cos_to_last_merge=0.8680 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.8987571417039836, 'auprc': 0.9967387115684789, 'loss_val': 0.30128224803800463, 'psi': 0.9379497696497817}-{'f1_val': 0.9389754532071333, 'auprc': 0.9965981210012962, 'loss_val': 0.12577763669739325, 'psi': 0.9620245203247983}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=96 head_norm_before_train=1.967493 cos_to_last_merge=0.8779 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.878
[S2] round=96 local utility u=0.151127 metrics={'f1_val': 0.7186431368721646, 'auprc': 0.8045536078810251, 'loss_val': 0.7568378717257854, 'psi': 0.7530073252757088}-{'f1_val': 0.7200446381060452, 'auprc': 0.7818804982936063, 'loss_val': 0.9994823684152585, 'psi': 0.7447789821810696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=96 head_norm_before_train=2.216233 cos_to_last_merge=0.9209 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=96 local utility u=0.340630 metrics={'f1_val': 0.9174009924857498, 'auprc': 0.9984950959546839, 'loss_val': 0.17211827559628962, 'psi': 0.9498386338733235}-{'f1_val': 0.8439096880941168, 'auprc': 0.9852799144452453, 'loss_val': 0.37278403954760164, 'psi': 0.9004577786345682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=96 head_norm_before_train=1.945696 cos_to_last_merge=0.7445 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.744
[S4] round=96 local utility u=0.045258 metrics={'f1_val': 0.9406265482060985, 'auprc': 0.9677765190324945, 'loss_val': 0.30351839245539375, 'psi': 0.9514865365366569}-{'f1_val': 0.9396588553006695, 'auprc': 0.9412999223050884, 'loss_val': 0.3087986011684007, 'psi': 0.940315282102437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=96 head_norm_before_train=1.679523 cos_to_last_merge=0.8071 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9975620990423352, 'loss_val': 0.045941250072646024, 'psi': 0.9967828307431903}-{'f1_val': 0.9962633185437604, 'auprc': 0.9976394132916317, 'loss_val': 0.045023768965489694, 'psi': 0.9968137564429089}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=1.955780 cos_to_last_merge=0.8031 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.803
[S6] round=96 local utility u=0.735249 metrics={'f1_val': 0.7583131396477814, 'auprc': 0.9422518521134363, 'loss_val': 0.6125102634808183, 'psi': 0.8318886246340433}-{'f1_val': 0.6008886013885034, 'auprc': 0.9263236140571052, 'loss_val': 1.0906770607096508, 'psi': 0.7310626064559441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=96 head_norm_before_train=1.938344 (no previous merge yet)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.6140153838706671, 'auprc': 0.7945236091779226, 'loss_val': 0.6753282263670417, 'psi': 0.6862186739935694}-{'f1_val': 0.6750157957213196, 'auprc': 0.8417911411002723, 'loss_val': 0.3076524745789071, 'psi': 0.7417259338729008}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.039656 cos_to_last_merge=0.9345 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.934
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9762913981867902, 'auprc': 0.9964305558005868, 'loss_val': 0.05784926663333602, 'psi': 0.9843470612323089}-{'f1_val': 0.9909365638023653, 'auprc': 0.9965023601954557, 'loss_val': 0.029257133952815772, 'psi': 0.9931628823596015}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.182133 cos_to_last_merge=0.7812 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9805286250677576, 'auprc': 0.997389946470911, 'loss_val': 0.07225569244521457, 'psi': 0.9872731536290189}-{'f1_val': 0.9966891482978385, 'auprc': 0.9987711730491442, 'loss_val': 0.016570397452645932, 'psi': 0.9975219581983608}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.102174 cos_to_last_merge=0.8470 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=96 local utility u=0.000044 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936233358630979, 'loss_val': 0.026643860263042916, 'psi': 0.994562037756864}-{'f1_val': 0.9951878390193748, 'auprc': 0.993578474392594, 'loss_val': 0.02659789185743454, 'psi': 0.9945440931686624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=96 head_norm_before_train=2.011563 cos_to_last_merge=0.8735 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.873
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9992021972022614, 'loss_val': 0.01790355971021838, 'psi': 0.9974785251775189}-{'f1_val': 0.9965509216617638, 'auprc': 0.9992131908979156, 'loss_val': 0.01682192177636477, 'psi': 0.9976158293562246}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=1.713705 cos_to_last_merge=0.8737 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.874
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6204968957379255, 'auprc': 0.7656607031971356, 'loss_val': 0.9412038118157701, 'psi': 0.6785624187216096}-{'f1_val': 0.6212858656873216, 'auprc': 0.9520117221736063, 'loss_val': 1.1050487006295804, 'psi': 0.7535762082818355}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.075991 cos_to_last_merge=0.9387 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.999231319539811, 'loss_val': 0.01553430494158996, 'psi': 0.9985167428200485}-{'f1_val': 0.9982111419559175, 'auprc': 0.999179178553356, 'loss_val': 0.014920674184941527, 'psi': 0.9985983565948929}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.122902 cos_to_last_merge=0.9308 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=96 local utility u=0.019142 metrics={'f1_val': 0.9845230985192723, 'auprc': 0.9987713752389494, 'loss_val': 0.028332838530555873, 'psi': 0.9902224092071432}-{'f1_val': 0.9788928787035713, 'auprc': 0.9987484120304919, 'loss_val': 0.032767187443882885, 'psi': 0.9868350920343396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=96 head_norm_before_train=2.196369 (no previous merge yet)
[S16] round=96 local utility u=0.233484 metrics={'f1_val': 0.992749258058351, 'auprc': 0.9879039065795178, 'loss_val': 0.0389726073028384, 'psi': 0.9908111174668177}-{'f1_val': 0.9439356967498624, 'auprc': 0.9853189434931681, 'loss_val': 0.2053042337026469, 'psi': 0.9604889954471847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=96 head_norm_before_train=2.049162 cos_to_last_merge=0.8675 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.7649572200026689, 'auprc': 0.9952922089601125, 'loss_val': 0.6346404896246055, 'psi': 0.8570912155856463}-{'f1_val': 0.8987571417039836, 'auprc': 0.9967387115684789, 'loss_val': 0.30128224803800463, 'psi': 0.9379497696497817}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=1.971598 cos_to_last_merge=0.8777 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.878
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.6858981584720816, 'auprc': 0.8332763586443777, 'loss_val': 0.680293006126151, 'psi': 0.744849438541}-{'f1_val': 0.7186431368721646, 'auprc': 0.8045536078810251, 'loss_val': 0.7568378717257854, 'psi': 0.7530073252757088}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=2.221328 cos_to_last_merge=0.9204 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.9129386132961157, 'auprc': 0.9811762731959616, 'loss_val': 0.23582839949180653, 'psi': 0.9402336772560541}-{'f1_val': 0.9174009924857498, 'auprc': 0.9984950959546839, 'loss_val': 0.17211827559628962, 'psi': 0.9498386338733235}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=1.945524 cos_to_last_merge=0.7442 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.744
[S4] round=97 local utility u=0.049417 metrics={'f1_val': 0.9508007836702276, 'auprc': 0.9752303969605709, 'loss_val': 0.2880915476075034, 'psi': 0.960572628986365}-{'f1_val': 0.9406265482060985, 'auprc': 0.9677765190324945, 'loss_val': 0.30351839245539375, 'psi': 0.9514865365366569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=97 head_norm_before_train=1.688690 cos_to_last_merge=0.8054 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.805
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9970517508973011, 'loss_val': 0.042983905187765306, 'psi': 0.996357800495651}-{'f1_val': 0.9962633185437604, 'auprc': 0.9975620990423352, 'loss_val': 0.045941250072646024, 'psi': 0.9967828307431903}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=1.957241 cos_to_last_merge=0.8033 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.803
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.6457699477004689, 'auprc': 0.908350048010155, 'loss_val': 0.7249310242718927, 'psi': 0.7508019878243433}-{'f1_val': 0.7583131396477814, 'auprc': 0.9422518521134363, 'loss_val': 0.6125102634808183, 'psi': 0.8318886246340433}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=1.938482 (no previous merge yet)
[S7] round=97 local utility u=0.093474 metrics={'f1_val': 0.6224332337020609, 'auprc': 0.7994704930298013, 'loss_val': 0.5537284034699761, 'psi': 0.6932481374331572}-{'f1_val': 0.6140153838706671, 'auprc': 0.7945236091779226, 'loss_val': 0.6753282263670417, 'psi': 0.6862186739935694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=97 head_norm_before_train=2.044327 cos_to_last_merge=0.9340 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.934
[S8] round=97 local utility u=0.020287 metrics={'f1_val': 0.9834376114489917, 'auprc': 0.9943074947743831, 'loss_val': 0.05378416938857923, 'psi': 0.9877855647791483}-{'f1_val': 0.9762913981867902, 'auprc': 0.9964305558005868, 'loss_val': 0.05784926663333602, 'psi': 0.9843470612323089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=97 head_norm_before_train=2.183487 cos_to_last_merge=0.7814 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=97 local utility u=0.075272 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9986077201817611, 'loss_val': 0.01735328976809669, 'psi': 0.9969591705984977}-{'f1_val': 0.9805286250677576, 'auprc': 0.997389946470911, 'loss_val': 0.07225569244521457, 'psi': 0.9872731536290189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=97 head_norm_before_train=2.102904 cos_to_last_merge=0.8470 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=97 local utility u=0.000100 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936747690064005, 'loss_val': 0.026599159438154104, 'psi': 0.9945826110141851}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936233358630979, 'loss_val': 0.026643860263042916, 'psi': 0.994562037756864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=97 head_norm_before_train=2.016131 cos_to_last_merge=0.8731 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.873
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.8757809960484512, 'auprc': 0.9991378908526141, 'loss_val': 0.12355462789909852, 'psi': 0.9251237539701164}-{'f1_val': 0.9963294104943571, 'auprc': 0.9992021972022614, 'loss_val': 0.01790355971021838, 'psi': 0.9974785251775189}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=1.715149 cos_to_last_merge=0.8736 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.874
[S13] round=97 local utility u=0.595305 metrics={'f1_val': 0.7377967641032006, 'auprc': 0.909018893055573, 'loss_val': 0.884467838695998, 'psi': 0.8062856156841496}-{'f1_val': 0.6204968957379255, 'auprc': 0.7656607031971356, 'loss_val': 0.9412038118157701, 'psi': 0.6785624187216096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=97 head_norm_before_train=2.076303 cos_to_last_merge=0.9384 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988528195431521, 'loss_val': 0.01785732085299509, 'psi': 0.9982196339731975}-{'f1_val': 0.9980403583402068, 'auprc': 0.999231319539811, 'loss_val': 0.01553430494158996, 'psi': 0.9985167428200485}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.127093 cos_to_last_merge=0.9305 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=97 local utility u=0.039619 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9988064060286437, 'loss_val': 0.022541743356707195, 'psi': 0.9975705634439698}-{'f1_val': 0.9845230985192723, 'auprc': 0.9987713752389494, 'loss_val': 0.028332838530555873, 'psi': 0.9902224092071432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=97 head_norm_before_train=2.192951 (no previous merge yet)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9916140223814152, 'auprc': 0.9888692465647211, 'loss_val': 0.04224446187386456, 'psi': 0.9905161120547376}-{'f1_val': 0.992749258058351, 'auprc': 0.9879039065795178, 'loss_val': 0.0389726073028384, 'psi': 0.9908111174668177}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.056361 cos_to_last_merge=0.8669 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.867
[S17] round=97 local utility u=0.490388 metrics={'f1_val': 0.8873156611576931, 'auprc': 0.992887889300598, 'loss_val': 0.38080131443541443, 'psi': 0.9295445524148551}-{'f1_val': 0.7649572200026689, 'auprc': 0.9952922089601125, 'loss_val': 0.6346404896246055, 'psi': 0.8570912155856463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=98 head_norm_before_train=1.975676 cos_to_last_merge=0.8774 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.877
[S2] round=98 local utility u=0.085181 metrics={'f1_val': 0.719724515691504, 'auprc': 0.8343974453968848, 'loss_val': 0.7162533240154121, 'psi': 0.7655936875736563}-{'f1_val': 0.6858981584720816, 'auprc': 0.8332763586443777, 'loss_val': 0.680293006126151, 'psi': 0.744849438541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=98 head_norm_before_train=2.225850 cos_to_last_merge=0.9200 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.6635585519743438, 'auprc': 0.9227961541394079, 'loss_val': 1.0284222229591193, 'psi': 0.7672535928403694}-{'f1_val': 0.9129386132961157, 'auprc': 0.9811762731959616, 'loss_val': 0.23582839949180653, 'psi': 0.9402336772560541}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=1.946846 cos_to_last_merge=0.7442 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.744
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9506918475680322, 'auprc': 0.975125923247795, 'loss_val': 0.2996073958094902, 'psi': 0.9604654778399373}-{'f1_val': 0.9508007836702276, 'auprc': 0.9752303969605709, 'loss_val': 0.2880915476075034, 'psi': 0.960572628986365}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=1.699564 cos_to_last_merge=0.8036 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=98 local utility u=0.005123 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9981315200387559, 'loss_val': 0.038186123443314665, 'psi': 0.9970105991417586}-{'f1_val': 0.995895166894551, 'auprc': 0.9970517508973011, 'loss_val': 0.042983905187765306, 'psi': 0.996357800495651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=98 head_norm_before_train=1.956899 cos_to_last_merge=0.8030 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.803
[S6] round=98 local utility u=0.631264 metrics={'f1_val': 0.8104606932100269, 'auprc': 0.9198732996218946, 'loss_val': 0.48511652001274735, 'psi': 0.854225735774774}-{'f1_val': 0.6457699477004689, 'auprc': 0.908350048010155, 'loss_val': 0.7249310242718927, 'psi': 0.7508019878243433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=98 head_norm_before_train=1.939662 (no previous merge yet)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6225625833630524, 'auprc': 0.7956622112716217, 'loss_val': 0.6780014527273789, 'psi': 0.6918024345264802}-{'f1_val': 0.6224332337020609, 'auprc': 0.7994704930298013, 'loss_val': 0.5537284034699761, 'psi': 0.6932481374331572}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.048871 cos_to_last_merge=0.9336 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.934
[S8] round=98 local utility u=0.033850 metrics={'f1_val': 0.9887962955380838, 'auprc': 0.9995777445801555, 'loss_val': 0.03404676579023613, 'psi': 0.9931088751549124}-{'f1_val': 0.9834376114489917, 'auprc': 0.9943074947743831, 'loss_val': 0.05378416938857923, 'psi': 0.9877855647791483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=98 head_norm_before_train=2.186468 cos_to_last_merge=0.7815 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.782
[S9] round=98 local utility u=0.002896 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9987335418917844, 'loss_val': 0.016913360502924267, 'psi': 0.9975069057354169}-{'f1_val': 0.9958601375429889, 'auprc': 0.9986077201817611, 'loss_val': 0.01735328976809669, 'psi': 0.9969591705984977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=98 head_norm_before_train=2.105533 cos_to_last_merge=0.8468 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=98 local utility u=0.000139 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937419544280433, 'loss_val': 0.02652246645878871, 'psi': 0.9946094851828422}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936747690064005, 'loss_val': 0.026599159438154104, 'psi': 0.9945826110141851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=98 head_norm_before_train=2.020742 cos_to_last_merge=0.8727 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.873
[S11] round=98 local utility u=0.415835 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.999211103596248, 'loss_val': 0.016844986415751495, 'psi': 0.997627190305774}-{'f1_val': 0.8757809960484512, 'auprc': 0.9991378908526141, 'loss_val': 0.12355462789909852, 'psi': 0.9251237539701164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=98 head_norm_before_train=1.717200 cos_to_last_merge=0.8734 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.873
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.7088884095440742, 'auprc': 0.8665007170643376, 'loss_val': 0.8966928689876276, 'psi': 0.7719333325521796}-{'f1_val': 0.7377967641032006, 'auprc': 0.909018893055573, 'loss_val': 0.884467838695998, 'psi': 0.8062856156841496}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=2.076959 cos_to_last_merge=0.9384 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988132470953834, 'loss_val': 0.017779984291715335, 'psi': 0.99820380499409}-{'f1_val': 0.9977975102598944, 'auprc': 0.9988528195431521, 'loss_val': 0.01785732085299509, 'psi': 0.9982196339731975}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.131201 cos_to_last_merge=0.9301 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=98 local utility u=0.001483 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9984256199106205, 'loss_val': 0.01843403731053389, 'psi': 0.9974182489967606}-{'f1_val': 0.9967466683875206, 'auprc': 0.9988064060286437, 'loss_val': 0.022541743356707195, 'psi': 0.9975705634439698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=98 head_norm_before_train=2.193852 (no previous merge yet)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.8330844991434805, 'auprc': 0.8113506094789714, 'loss_val': 1.473877239168828, 'psi': 0.8243909432776768}-{'f1_val': 0.9916140223814152, 'auprc': 0.9888692465647211, 'loss_val': 0.04224446187386456, 'psi': 0.9905161120547376}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.063221 cos_to_last_merge=0.8664 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.866
[S17] round=98 local utility u=0.044555 metrics={'f1_val': 0.8994223473382783, 'auprc': 0.9890218151699923, 'loss_val': 0.35273340515278867, 'psi': 0.935262134470964}-{'f1_val': 0.8873156611576931, 'auprc': 0.992887889300598, 'loss_val': 0.38080131443541443, 'psi': 0.9295445524148551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=99 head_norm_before_train=1.981102 cos_to_last_merge=0.8769 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.877
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.7200254149967206, 'auprc': 0.7921390523694772, 'loss_val': 0.8384890501156539, 'psi': 0.7488708699458233}-{'f1_val': 0.719724515691504, 'auprc': 0.8343974453968848, 'loss_val': 0.7162533240154121, 'psi': 0.7655936875736563}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.749 u=0.0000 p_local=0.0374 f1=0.720 auprc=0.792 bytes=95470
[S3] START round=99 head_norm_before_train=2.230395 cos_to_last_merge=0.9196 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=99 local utility u=1.000000 metrics={'f1_val': 0.8857498984305151, 'auprc': 0.9954288068504393, 'loss_val': 0.24748025629663722, 'psi': 0.9296214617984848}-{'f1_val': 0.6635585519743438, 'auprc': 0.9227961541394079, 'loss_val': 1.0284222229591193, 'psi': 0.7672535928403694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=100 psi=0.930 u=1.0000 p_local=0.3265 f1=0.886 auprc=0.995 bytes=100755
[S4] START round=99 head_norm_before_train=1.950056 cos_to_last_merge=0.7437 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.744
[S4] round=99 local utility u=0.027191 metrics={'f1_val': 0.9537711322649179, 'auprc': 0.980810615624128, 'loss_val': 0.28075504305838855, 'psi': 0.9645869256086019}-{'f1_val': 0.9506918475680322, 'auprc': 0.975125923247795, 'loss_val': 0.2996073958094902, 'psi': 0.9604654778399373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] r=100 psi=0.965 u=0.0272 p_local=0.0230 f1=0.954 auprc=0.981 bytes=98978
[S5] START round=99 head_norm_before_train=1.709064 cos_to_last_merge=0.8020 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.996639908346885, 'loss_val': 0.040139272559552394, 'psi': 0.9964139544650101}-{'f1_val': 0.9962633185437604, 'auprc': 0.9981315200387559, 'loss_val': 0.038186123443314665, 'psi': 0.9970105991417586}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.996 u=0.0000 p_local=0.0983 f1=0.996 auprc=0.997 bytes=95437
[S6] START round=99 head_norm_before_train=1.959783 cos_to_last_merge=0.8027 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.803
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.6073458690221197, 'auprc': 0.8827228900352928, 'loss_val': 0.9366683239638244, 'psi': 0.717496677427389}-{'f1_val': 0.8104606932100269, 'auprc': 0.9198732996218946, 'loss_val': 0.48511652001274735, 'psi': 0.854225735774774}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.717 u=0.0000 p_local=0.3081 f1=0.607 auprc=0.883 bytes=79071
[S7] START round=99 head_norm_before_train=1.945911 (no previous merge yet)
[S7] round=99 local utility u=0.036850 metrics={'f1_val': 0.626750263977175, 'auprc': 0.7983845663239976, 'loss_val': 0.6375942573986333, 'psi': 0.695403984915904}-{'f1_val': 0.6225625833630524, 'auprc': 0.7956622112716217, 'loss_val': 0.6780014527273789, 'psi': 0.6918024345264802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] r=100 psi=0.695 u=0.0369 p_local=0.0811 f1=0.627 auprc=0.798 bytes=102571
[S8] START round=99 head_norm_before_train=2.051745 cos_to_last_merge=0.9334 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9785926379597033, 'auprc': 0.9965395203649383, 'loss_val': 0.05226163215935693, 'psi': 0.9857713909217973}-{'f1_val': 0.9887962955380838, 'auprc': 0.9995777445801555, 'loss_val': 0.03404676579023613, 'psi': 0.9931088751549124}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.986 u=0.0000 p_local=0.0466 f1=0.979 auprc=0.997 bytes=100879
[S9] START round=99 head_norm_before_train=2.187759 cos_to_last_merge=0.7814 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.781
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9922651407836713, 'auprc': 0.9987311396354881, 'loss_val': 0.027111891637405402, 'psi': 0.994851540324398}-{'f1_val': 0.9966891482978385, 'auprc': 0.9987335418917844, 'loss_val': 0.016913360502924267, 'psi': 0.9975069057354169}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.995 u=0.0000 p_local=0.0129 f1=0.992 auprc=0.999 bytes=109515
[S10] START round=99 head_norm_before_train=2.109232 cos_to_last_merge=0.8465 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.846
[S10] round=99 local utility u=0.000209 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9938731827531755, 'loss_val': 0.02649857393827525, 'psi': 0.994661976512895}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937419544280433, 'loss_val': 0.02652246645878871, 'psi': 0.9946094851828422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S10] r=100 psi=0.995 u=0.0002 p_local=0.0001 f1=0.995 auprc=0.994 bytes=122410
[S11] START round=99 head_norm_before_train=2.025856 cos_to_last_merge=0.8724 (last merge round=13)
[S11] ⚠️ Model drifted since last merge! cos=0.872
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9992047954810848, 'loss_val': 0.018519067822139443, 'psi': 0.9974673689626551}-{'f1_val': 0.9965712481121245, 'auprc': 0.999211103596248, 'loss_val': 0.016844986415751495, 'psi': 0.997627190305774}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.997 u=0.0000 p_local=0.0735 f1=0.996 auprc=0.999 bytes=106090
[S13] START round=99 head_norm_before_train=1.723109 cos_to_last_merge=0.8728 (last merge round=15)
[S13] ⚠️ Model drifted since last merge! cos=0.873
[S13] round=99 local utility u=0.287738 metrics={'f1_val': 0.7594769510065676, 'auprc': 0.8504665855231783, 'loss_val': 0.5766464525942664, 'psi': 0.795872804813212}-{'f1_val': 0.7088884095440742, 'auprc': 0.8665007170643376, 'loss_val': 0.8966928689876276, 'psi': 0.7719333325521796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] r=100 psi=0.796 u=0.2877 p_local=0.1640 f1=0.759 auprc=0.850 bytes=91760
[S14] START round=99 head_norm_before_train=2.081545 cos_to_last_merge=0.9384 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=99 local utility u=0.001720 metrics={'f1_val': 0.9982111419559175, 'auprc': 0.9988060549628088, 'loss_val': 0.016799561839469648, 'psi': 0.9984491071586741}-{'f1_val': 0.9977975102598944, 'auprc': 0.9988132470953834, 'loss_val': 0.017779984291715335, 'psi': 0.99820380499409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] r=100 psi=0.998 u=0.0017 p_local=0.0048 f1=0.998 auprc=0.999 bytes=106060
[S15] START round=99 head_norm_before_train=2.135243 cos_to_last_merge=0.9298 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9984222936368303, 'loss_val': 0.018911653714224198, 'psi': 0.9974169184872445}-{'f1_val': 0.9967466683875206, 'auprc': 0.9984256199106205, 'loss_val': 0.01843403731053389, 'psi': 0.9974182489967606}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.997 u=0.0000 p_local=0.0227 f1=0.997 auprc=0.998 bytes=106106
[S16] START round=99 head_norm_before_train=2.197403 (no previous merge yet)
[S16] round=99 local utility u=1.000000 metrics={'f1_val': 0.9472453947266184, 'auprc': 0.9731691640862421, 'loss_val': 0.19811870070562168, 'psi': 0.9576149024704679}-{'f1_val': 0.8330844991434805, 'auprc': 0.8113506094789714, 'loss_val': 1.473877239168828, 'psi': 0.8243909432776768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S16] r=100 psi=0.958 u=1.0000 p_local=0.2947 f1=0.947 auprc=0.973 bytes=104328
[S17] START round=99 head_norm_before_train=2.067613 cos_to_last_merge=0.8660 (last merge round=11)
[S17] ⚠️ Model drifted since last merge! cos=0.866
[S17] round=99 local utility u=0.140095 metrics={'f1_val': 0.9300847963220795, 'auprc': 0.9879200635637861, 'loss_val': 0.25321327737838695, 'psi': 0.9532189032187621}-{'f1_val': 0.8994223473382783, 'auprc': 0.9890218151699923, 'loss_val': 0.35273340515278867, 'psi': 0.935262134470964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S17] r=100 psi=0.953 u=0.1401 p_local=0.2097 f1=0.930 auprc=0.988 bytes=93726
[runner] rounds complete.
[runner] all agents stopped.
