[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:40403
[S3] → join 127.0.0.1:40402
[S4] → join 127.0.0.1:40402
[S5] → join 127.0.0.1:40402
[S6] → join 127.0.0.1:40402
[S7] → join 127.0.0.1:40402
[S8] → join 127.0.0.1:40402
[S9] → join 127.0.0.1:40402
[S10] → join 127.0.0.1:40402
[S11] → join 127.0.0.1:40402
[S13] → join 127.0.0.1:40402
[S14] → join 127.0.0.1:40402
[S15] → join 127.0.0.1:40402
[S16] → join 127.0.0.1:40402
[S17] → join 127.0.0.1:40402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.187696 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.203656 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.197698 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.218278 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.191943 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.200560 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.236974 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.164854 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.151576 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.171108 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.174314 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.160560 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.197091 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.168424 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.191709 (no previous merge yet)
[S11]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3] + discovered S7
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S5
[S3] + discovered S15
[S3] + discovered S4
[S3] + discovered S8
[S3] + discovered S17
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S6
[S3] + discovered S11
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S13
[S5] + discovered S4
[S5] + discovered S3
[S4] + discovered S7
[S4] + discovered S13
[S4] + discovered S10
[S4] + discovered S11
[S4] + discovered S9
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S8
[S4] + discovered S15
[S4] + discovered S5
[S5] + discovered S2
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S10
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S13
[S5] + discovered S6
[S5] + discovered S14
[S5] + discovered S15
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S11
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S4
[S6] + discovered S17
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S16
[S6] + discovered S9
[S6] + discovered S13
[S6] + discovered S10
[S7] + discovered S9
[S7] + discovered S17
[S8] + discovered S5
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S4
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S16
[S7] + discovered S13
[S8] + discovered S11
[S8] + discovered S14
[S8] + discovered S15
[S9] + discovered S2
[S9] + discovered S5
[S8] + discovered S13
[S9] + discovered S6
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S3
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S10
[S8] + discovered S16
[S10] + discovered S3
[S9] + discovered S13
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S10
[S10] + discovered S6
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S8
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S2
[S11] + discovered S3
[S11] + discovered S8
[S11] + discovered S4
[S11] + discovered S10
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S17
[S11] + discovered S7
[S10] + discovered S16
[S10] + discovered S11
[S10] + discovered S13
[S11] + discovered S6
[S13] + discovered S4
[S13] + discovered S11
[S11] + discovered S16
[S13] + discovered S8
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S6
[S11] + discovered S14
[S13] + discovered S3
[S11] + discovered S17
[S11] + discovered S13
[S11] + discovered S15
[S13] + discovered S2
[S13] + discovered S9
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S17
[S14] + discovered S3
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S13
[S14] + discovered S5
[S14] + discovered S8
[S15] + discovered S5
[S15] + discovered S11
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S3
[S15] + discovered S13
[S15] + discovered S9
[S15] + discovered S7
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S14
[S15] + discovered S4
[S14] + discovered S17
[S16] + discovered S2
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S8
[S16] + discovered S13
[S16] + discovered S9
[S16] + discovered S3
[S16] + discovered S6
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S10
[S15] + discovered S17
[S16] + discovered S5
[S15] + discovered S16
[S16] + discovered S15
[S17] + discovered S8
[S17] + discovered S9
[S16] + discovered S17
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S11
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S5
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S10
[S17] + discovered S15
[S17] + discovered S7
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:40402
[S14] ⇄ pheromone p=1.000 → S4@127.0.0.1:40404
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:40412
[S9] ⇄ pheromone p=1.000 → S13@127.0.0.1:40413
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S15] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S7] ⇄ pheromone p=1.000 → S10@127.0.0.1:40411
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:40414
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:40417
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:40414
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:40416
[S4] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:40404
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:40410
[S2] START round=1 head_norm_before_train=1.201382 (no previous merge yet)
[S2] round=1 local utility u=0.163787 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6967450733590959, 'loss_val': 1.2458881911538002, 'psi': 0.3637643093767784}-{'f1_val': 0.1417771333885667, 'auprc': 0.6127543047450223, 'loss_val': 1.3214902587904707, 'psi': 0.330168001931149}
[S3] START round=1 head_norm_before_train=1.210406 (no previous merge yet)
[S3] round=1 local utility u=0.903622 metrics={'f1_val': 0.37663494025998095, 'auprc': 0.790436174561281, 'loss_val': 1.3406808836663855, 'psi': 0.542155433980501}-{'f1_val': 0.10292146877512731, 'auprc': 0.7477811561223525, 'loss_val': 1.3776781441766, 'psi': 0.3608653437140174}
[S4] START round=1 head_norm_before_train=1.209595 (no previous merge yet)
[S4] round=1 local utility u=0.037682 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7859791793122657, 'loss_val': 1.22728924580412, 'psi': 0.39852764906201676}-{'f1_val': 0.14022662889518414, 'auprc': 0.7894791699743661, 'loss_val': 1.3131532720795713, 'psi': 0.39992764532685693}
[S5] START round=1 head_norm_before_train=1.220577 (no previous merge yet)
[S5] round=1 local utility u=0.282877 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7294789246790576, 'loss_val': 1.3270324794086112, 'psi': 0.37714871272876593}-{'f1_val': 0.14226190476190476, 'auprc': 0.5527004190134093, 'loss_val': 1.3624503699990353, 'psi': 0.30643731046250655}
[S6] START round=1 head_norm_before_train=1.206673 (no previous merge yet)
[S6] round=1 local utility u=0.063274 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6670490427782921, 'loss_val': 1.2717753178040438, 'psi': 0.35167538634208606}-{'f1_val': 0.14142628205128205, 'auprc': 0.6424227920903899, 'loss_val': 1.3244445672028042, 'psi': 0.3418248860669252}
[S7] START round=1 head_norm_before_train=1.209743 (no previous merge yet)
[S7] round=1 local utility u=0.224986 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6459247201499039, 'loss_val': 1.3304876173888978, 'psi': 0.34360398169741657}-{'f1_val': 0.14205682272909165, 'auprc': 0.5063911333921207, 'loss_val': 1.361858723716557, 'psi': 0.2877905469943033}
[S8] START round=1 head_norm_before_train=1.244906 (no previous merge yet)
[S8] round=1 local utility u=0.339026 metrics={'f1_val': 0.2106781861869355, 'auprc': 0.5610536030810103, 'loss_val': 1.2692957525514428, 'psi': 0.35082835294456544}-{'f1_val': 0.15472509523120692, 'auprc': 0.47005606522017196, 'loss_val': 1.3386359564229295, 'psi': 0.28085748322679294}
[S9] START round=1 head_norm_before_train=1.176469 (no previous merge yet)
[S9] round=1 local utility u=0.202569 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657765626743666, 'loss_val': 1.2947361037334273, 'psi': 0.4311493993537443}-{'f1_val': 0.141397957139996, 'auprc': 0.7438184779505981, 'loss_val': 1.3339988941853924, 'psi': 0.38236616546423685}
[S10] START round=1 head_norm_before_train=1.167604 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5882448364329882, 'loss_val': 1.2748128533933358, 'psi': 0.3184709170982296}-{'f1_val': 0.1671797300497277, 'auprc': 0.5797983190481363, 'loss_val': 1.3398323556289424, 'psi': 0.33222716564909116}
[S11] START round=1 head_norm_before_train=1.170128 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8302071210958657, 'loss_val': 1.3222272269408835, 'psi': 0.41633105846221263}-{'f1_val': 0.3993663457249397, 'auprc': 0.5749041362300839, 'loss_val': 1.3509704382968035, 'psi': 0.46958146192699735}
[S13] START round=1 head_norm_before_train=1.186528 (no previous merge yet)
[S13] round=1 local utility u=0.095687 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.648308030994224, 'loss_val': 1.2835534156193849, 'psi': 0.3435546699439214}-{'f1_val': 0.1403857625770531, 'auprc': 0.6032133554856053, 'loss_val': 1.3396440209538552, 'psi': 0.325516799740474}
[S14] START round=1 head_norm_before_train=1.164067 (no previous merge yet)
[S14] round=1 local utility u=0.778420 metrics={'f1_val': 0.3962590400303592, 'auprc': 0.7025333997626113, 'loss_val': 1.3323826372168939, 'psi': 0.5187687839232601}-{'f1_val': 0.28120407841975126, 'auprc': 0.4206494248615491, 'loss_val': 1.353240217729163, 'psi': 0.3369822169964704}
[S15] START round=1 head_norm_before_train=1.211883 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7802445218887692, 'loss_val': 1.2642267118810038, 'psi': 0.39593799957244274}-{'f1_val': 0.4191346769885148, 'auprc': 0.7877497757421592, 'loss_val': 1.3259902387328637, 'psi': 0.5665807164899725}
[S16] START round=1 head_norm_before_train=1.178964 (no previous merge yet)
[S16] round=1 local utility u=0.349784 metrics={'f1_val': 0.18336678609187293, 'auprc': 0.7186517715361872, 'loss_val': 1.3293332837851028, 'psi': 0.39748078026959865}-{'f1_val': 0.10386473429951691, 'auprc': 0.653837117667843, 'loss_val': 1.3574453782417981, 'psi': 0.32385368764684735}
[S17] START round=1 head_norm_before_train=1.202024 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6511889804930107, 'loss_val': 1.2899454593237245, 'psi': 0.3450449701876349}-{'f1_val': 0.1414, 'auprc': 0.6751984158423002, 'loss_val': 1.3590652160450414, 'psi': 0.3549193663369201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:40415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:40405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:40412
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:40415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:40411
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:40412
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S7
[S16] cosine check vs S7: cos=0.0024
[S17] RECEIVED delta(kind=head bytes=1793) from S14
[S17] cosine check vs S14: cos=0.0098
[S15] RECEIVED delta(kind=head bytes=1791) from S5
[S15] cosine check vs S5: cos=0.0216
[S15] RECEIVED delta(kind=head bytes=1790) from S8
[S15] cosine check vs S8: cos=0.0889
[S5] RECEIVED delta(kind=head bytes=1794) from S16
[S5] cosine check vs S16: cos=-0.0462
[S5] DROPPED delta from S16 (cos=-0.0462 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1789) from S4
[S11] cosine check vs S4: cos=0.0254
[S11] RECEIVED delta(kind=head bytes=1792) from S9
[S11] cosine check vs S9: cos=0.0913
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=-0.0063
[S6] DROPPED delta from S3 (cos=-0.0063 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1792) from S2
[S10] cosine check vs S2: cos=0.0284
[S14] RECEIVED delta(kind=head bytes=1796) from S13
[S14] cosine check vs S13: cos=0.0030
[S14] RECEIVED delta(kind=head bytes=1790) from S6
[S14] cosine check vs S6: cos=-0.0729
[S14] DROPPED delta from S6 (cos=-0.0729 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.202264
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.512599e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.875790 delta_norm=0.851260
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.180174
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.099105e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.766259 delta_norm=0.709911
[S11] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.3963 head_norm=1.176018
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.482543e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.850780 delta_norm=0.848254
[S14] aggregate: ROLLBACK (f1_val pre=0.396 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1834 head_norm=1.196758
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.552727e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1232 head_norm=0.857317 delta_norm=0.855273
[S16] aggregate: ROLLBACK (f1_val pre=0.183 post=0.123 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.238766
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.498362e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.858230 delta_norm=0.849836
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.249536
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.331053e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.790539 delta_norm=0.733105
[S15] aggregate: ACCEPT kept=['S5', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.240106 (no previous merge yet)
[S2] round=2 local utility u=0.041205 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6962408638982216, 'loss_val': 1.1619651010087355, 'psi': 0.3635626255924287}-{'f1_val': 0.1417771333885667, 'auprc': 0.6967450733590959, 'loss_val': 1.2458881911538002, 'psi': 0.3637643093767784}
[S3] START round=2 head_norm_before_train=1.223381 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8490098963704922, 'loss_val': 1.2998540903455715, 'psi': 0.42350799791666116}-{'f1_val': 0.37663494025998095, 'auprc': 0.790436174561281, 'loss_val': 1.3406808836663855, 'psi': 0.542155433980501}
[S4] START round=2 head_norm_before_train=1.253726 (no previous merge yet)
[S4] round=2 local utility u=0.072323 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7838796659008737, 'loss_val': 1.0763442891431743, 'psi': 0.39768784369745996}-{'f1_val': 0.14022662889518414, 'auprc': 0.7859791793122657, 'loss_val': 1.22728924580412, 'psi': 0.39852764906201676}
[S5] START round=2 head_norm_before_train=1.232931 (no previous merge yet)
[S5] round=2 local utility u=0.016760 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7278558285641091, 'loss_val': 1.2886430217199167, 'psi': 0.3764994742827865}-{'f1_val': 0.14226190476190476, 'auprc': 0.7294789246790576, 'loss_val': 1.3270324794086112, 'psi': 0.37714871272876593}
[S6] START round=2 head_norm_before_train=1.239620 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6427906403033578, 'loss_val': 1.2283884810359764, 'psi': 0.3419720253521123}-{'f1_val': 0.14142628205128205, 'auprc': 0.6670490427782921, 'loss_val': 1.2717753178040438, 'psi': 0.35167538634208606}
[S7] START round=2 head_norm_before_train=1.225046 (no previous merge yet)
[S7] round=2 local utility u=0.156243 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7379156396300646, 'loss_val': 1.2939748214912843, 'psi': 0.3804003494894808}-{'f1_val': 0.14205682272909165, 'auprc': 0.6459247201499039, 'loss_val': 1.3304876173888978, 'psi': 0.34360398169741657}
[S8] START round=2 head_norm_before_train=1.276212 (no previous merge yet)
[S8] round=2 local utility u=0.601981 metrics={'f1_val': 0.28667347451961706, 'auprc': 0.766549331909635, 'loss_val': 1.137793529416765, 'psi': 0.4786238174756242}-{'f1_val': 0.2106781861869355, 'auprc': 0.5610536030810103, 'loss_val': 1.2692957525514428, 'psi': 0.35082835294456544}
[S9] START round=2 head_norm_before_train=1.195556 (no previous merge yet)
[S9] round=2 local utility u=0.025331 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658147386219501, 'loss_val': 1.2441885339446546, 'psi': 0.4311646697327777}-{'f1_val': 0.141397957139996, 'auprc': 0.8657765626743666, 'loss_val': 1.2947361037334273, 'psi': 0.4311493993537443}
[S10] START round=2 head_norm_before_train=0.875790 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.057898 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6102057631459458, 'loss_val': 1.2248988699610017, 'psi': 0.3272552877834127}-{'f1_val': 0.13862163754172394, 'auprc': 0.5882448364329882, 'loss_val': 1.2748128533933358, 'psi': 0.3184709170982296}
[S11] START round=2 head_norm_before_train=0.766259 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8033113633113235, 'loss_val': 1.320534053446302, 'psi': 0.40557275534839576}-{'f1_val': 0.14041368337311058, 'auprc': 0.8302071210958657, 'loss_val': 1.3222272269408835, 'psi': 0.41633105846221263}
[S13] START round=2 head_norm_before_train=1.226257 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6082605510206865, 'loss_val': 1.2289916989376863, 'psi': 0.3275356779545065}-{'f1_val': 0.1403857625770531, 'auprc': 0.648308030994224, 'loss_val': 1.2835534156193849, 'psi': 0.3435546699439214}
[S14] START round=2 head_norm_before_train=0.850780 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7197322376271988, 'loss_val': 1.3353490141493103, 'psi': 0.3721076067805018}-{'f1_val': 0.3962590400303592, 'auprc': 0.7025333997626113, 'loss_val': 1.3323826372168939, 'psi': 0.5187687839232601}
[S15] START round=2 head_norm_before_train=0.790539 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.018089 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7823357598875333, 'loss_val': 1.2343220339827994, 'psi': 0.39677449477194837}-{'f1_val': 0.13973365136155833, 'auprc': 0.7802445218887692, 'loss_val': 1.2642267118810038, 'psi': 0.39593799957244274}
[S16] START round=2 head_norm_before_train=0.857317 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7034487166502081, 'loss_val': 1.3377371896069854, 'psi': 0.3657619567796052}-{'f1_val': 0.18336678609187293, 'auprc': 0.7186517715361872, 'loss_val': 1.3293332837851028, 'psi': 0.39748078026959865}
[S17] START round=2 head_norm_before_train=0.858230 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5301401000194346, 'loss_val': 1.2129304924547644, 'psi': 0.29662541799820447}-{'f1_val': 0.14094896331738438, 'auprc': 0.6511889804930107, 'loss_val': 1.2899454593237245, 'psi': 0.3450449701876349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:40411
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:40405
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:40414
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:40410
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=-0.1006
[S5] DROPPED delta from S10 (cos=-0.1006 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=-0.0885
[S10] DROPPED delta from S4 (cos=-0.0885 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S8
[S13] cosine check vs S8: cos=0.1507
[S10] RECEIVED delta(kind=head bytes=1791) from S2
[S10] cosine check vs S2: cos=0.6995
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=-0.0512
[S10] DROPPED delta from S15 (cos=-0.0512 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S5
[S9] cosine check vs S5: cos=-0.0028
[S9] DROPPED delta from S5 (cos=-0.0028 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=-0.0508
[S14] DROPPED delta from S9 (cos=-0.0508 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=-0.0169
[S14] DROPPED delta from S7 (cos=-0.0169 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.275925
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.498076e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.989023 delta_norm=0.849808
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=0.926010
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.596683e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=1.021902 delta_norm=0.459668
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.285948 (no previous merge yet)
[S2] round=3 local utility u=0.725834 metrics={'f1_val': 0.32847257297416266, 'auprc': 0.7526905958407366, 'loss_val': 0.9998185127910058, 'psi': 0.49815978212079226}-{'f1_val': 0.1417771333885667, 'auprc': 0.6962408638982216, 'loss_val': 1.1619651010087355, 'psi': 0.3635626255924287}
[S3] START round=3 head_norm_before_train=1.244870 (no previous merge yet)
[S3] round=3 local utility u=0.253044 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9992262859381486, 'loss_val': 1.2444161417434236, 'psi': 0.4835945537437236}-{'f1_val': 0.13984006561410703, 'auprc': 0.8490098963704922, 'loss_val': 1.2998540903455715, 'psi': 0.42350799791666116}
[S4] START round=3 head_norm_before_train=1.312672 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6856508774947015, 'auprc': 0.7848667497433364, 'loss_val': 0.80617325164644, 'psi': 0.7253372263941555}-{'f1_val': 0.14022662889518414, 'auprc': 0.7838796659008737, 'loss_val': 1.0763442891431743, 'psi': 0.39768784369745996}
[S5] START round=3 head_norm_before_train=1.256855 (no previous merge yet)
[S5] round=3 local utility u=0.019130 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7289231301593464, 'loss_val': 1.2535850440030247, 'psi': 0.3769263949208814}-{'f1_val': 0.14226190476190476, 'auprc': 0.7278558285641091, 'loss_val': 1.2886430217199167, 'psi': 0.3764994742827865}
[S6] START round=3 head_norm_before_train=1.272486 (no previous merge yet)
[S6] round=3 local utility u=0.041629 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.643027197219128, 'loss_val': 1.1458397355813723, 'psi': 0.3420666481184204}-{'f1_val': 0.14142628205128205, 'auprc': 0.6427906403033578, 'loss_val': 1.2283884810359764, 'psi': 0.3419720253521123}
[S7] START round=3 head_norm_before_train=1.245410 (no previous merge yet)
[S7] round=3 local utility u=0.095906 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7917036285684986, 'loss_val': 1.263527162597112, 'psi': 0.40191554506485444}-{'f1_val': 0.14205682272909165, 'auprc': 0.7379156396300646, 'loss_val': 1.2939748214912843, 'psi': 0.3804003494894808}
[S8] START round=3 head_norm_before_train=1.331426 (no previous merge yet)
[S8] round=3 local utility u=0.454790 metrics={'f1_val': 0.4049147559255721, 'auprc': 0.7781683734382532, 'loss_val': 0.9725181307636127, 'psi': 0.5542162029306446}-{'f1_val': 0.28667347451961706, 'auprc': 0.766549331909635, 'loss_val': 1.137793529416765, 'psi': 0.4786238174756242}
[S9] START round=3 head_norm_before_train=1.223174 (no previous merge yet)
[S9] round=3 local utility u=0.034738 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659117557031668, 'loss_val': 1.1750045232421396, 'psi': 0.43120347656526437}-{'f1_val': 0.141397957139996, 'auprc': 0.8658147386219501, 'loss_val': 1.2441885339446546, 'psi': 0.4311646697327777}
[S10] START round=3 head_norm_before_train=1.021902 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.131357 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6570390112742155, 'loss_val': 1.102684077787291, 'psi': 0.3459885870347206}-{'f1_val': 0.13862163754172394, 'auprc': 0.6102057631459458, 'loss_val': 1.2248988699610017, 'psi': 0.3272552877834127}
[S11] START round=3 head_norm_before_train=0.785348 cos_to_last_merge=0.9957 (last merge round=1)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7812035749431399, 'loss_val': 1.2812799017976568, 'psi': 0.3967296400011223}-{'f1_val': 0.14041368337311058, 'auprc': 0.8033113633113235, 'loss_val': 1.320534053446302, 'psi': 0.40557275534839576}
[S13] START round=3 head_norm_before_train=0.989023 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.767097 metrics={'f1_val': 0.40099726925077306, 'auprc': 0.5788061789692911, 'loss_val': 1.1701041095567446, 'psi': 0.47212083313818026}-{'f1_val': 0.1403857625770531, 'auprc': 0.6082605510206865, 'loss_val': 1.2289916989376863, 'psi': 0.3275356779545065}
[S14] START round=3 head_norm_before_train=0.865702 cos_to_last_merge=0.9970 (last merge round=1)
[S14] round=3 local utility u=0.036495 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.732305127300292, 'loss_val': 1.3000783204359125, 'psi': 0.37713676264973905}-{'f1_val': 0.14035785288270378, 'auprc': 0.7197322376271988, 'loss_val': 1.3353490141493103, 'psi': 0.3721076067805018}
[S15] START round=3 head_norm_before_train=0.847070 cos_to_last_merge=0.9926 (last merge round=1)
[S15] round=3 local utility u=0.462824 metrics={'f1_val': 0.27576992326619, 'auprc': 0.7774388439049879, 'loss_val': 1.1102008999830408, 'psi': 0.4764374915217091}-{'f1_val': 0.13973365136155833, 'auprc': 0.7823357598875333, 'loss_val': 1.2343220339827994, 'psi': 0.39677449477194837}
[S16] START round=3 head_norm_before_train=0.878265 cos_to_last_merge=0.9967 (last merge round=1)
[S16] round=3 local utility u=0.157115 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7940202339580893, 'loss_val': 1.295221314132353, 'psi': 0.40199056370275765}-{'f1_val': 0.14063745019920318, 'auprc': 0.7034487166502081, 'loss_val': 1.3377371896069854, 'psi': 0.3657619567796052}
[S17] START round=3 head_norm_before_train=0.908589 cos_to_last_merge=0.9924 (last merge round=1)
[S17] round=3 local utility u=0.898827 metrics={'f1_val': 0.3918628032171344, 'auprc': 0.5680305790788969, 'loss_val': 1.0344314392287925, 'psi': 0.4623299135618394}-{'f1_val': 0.14094896331738438, 'auprc': 0.5301401000194346, 'loss_val': 1.2129304924547644, 'psi': 0.29662541799820447}
[S8] not sending this round → trigger blocked (psi=0.554)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:40416
[S14] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1790) from S15
[S16] cosine check vs S15: cos=0.1111
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=-0.0459
[S14] DROPPED delta from S10 (cos=-0.0459 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0320
[S8] DROPPED delta from S2 (cos=-0.0320 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] cosine check vs S16: cos=0.0134
[S13] RECEIVED delta(kind=head bytes=1802) from S9
[S13] cosine check vs S9: cos=-0.0037
[S13] DROPPED delta from S9 (cos=-0.0037 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S14
[S4] cosine check vs S14: cos=0.0324
[S10] RECEIVED delta(kind=head bytes=1796) from S7
[S10] cosine check vs S7: cos=0.0612
[S4] RECEIVED delta(kind=head bytes=1804) from S3
[S4] cosine check vs S3: cos=-0.0730
[S4] DROPPED delta from S3 (cos=-0.0730 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] cosine check vs S5: cos=-0.0002
[S9] DROPPED delta from S5 (cos=-0.0002 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S4
[S9] cosine check vs S4: cos=0.0461
[S11] RECEIVED delta(kind=head bytes=1791) from S6
[S11] cosine check vs S6: cos=-0.0633
[S11] DROPPED delta from S6 (cos=-0.0633 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] cosine check vs S13: cos=-0.0209
[S16] DROPPED delta from S13 (cos=-0.0209 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S17
[S9] cosine check vs S17: cos=-0.0747
[S9] DROPPED delta from S17 (cos=-0.0747 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.4049 head_norm=1.380713
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.216306e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.4164 head_norm=0.831832 delta_norm=0.821631
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.259598
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.146484e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.957638 delta_norm=0.914648
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.909767
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.074852e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.679156 delta_norm=0.607485
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=1.066314
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.024310e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.852353 delta_norm=0.802431
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.6857 head_norm=1.385899
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.118242e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.6855 head_norm=0.836139 delta_norm=0.811824
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.334958 (no previous merge yet)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.6996395837866252, 'auprc': 0.6525098436342011, 'loss_val': 0.7132843900153725, 'psi': 0.6807876877256556}-{'f1_val': 0.32847257297416266, 'auprc': 0.7526905958407366, 'loss_val': 0.9998185127910058, 'psi': 0.49815978212079226}
[S3] START round=4 head_norm_before_train=1.274420 (no previous merge yet)
[S3] round=4 local utility u=0.034752 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9994619034146319, 'loss_val': 1.1756182597815028, 'psi': 0.48368880073431697}-{'f1_val': 0.13984006561410703, 'auprc': 0.9992262859381486, 'loss_val': 1.2444161417434236, 'psi': 0.4835945537437236}
[S4] START round=4 head_norm_before_train=0.836139 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.6695510769581474, 'auprc': 0.6625095062207397, 'loss_val': 0.7110386113861632, 'psi': 0.6667344486631843}-{'f1_val': 0.6856508774947015, 'auprc': 0.7848667497433364, 'loss_val': 0.80617325164644, 'psi': 0.7253372263941555}
[S5] START round=4 head_norm_before_train=1.281843 (no previous merge yet)
[S5] round=4 local utility u=0.034730 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.738043111865399, 'loss_val': 1.2114854931745402, 'psi': 0.3805743876033024}-{'f1_val': 0.14226190476190476, 'auprc': 0.7289231301593464, 'loss_val': 1.2535850440030247, 'psi': 0.3769263949208814}
[S6] START round=4 head_norm_before_train=1.303775 (no previous merge yet)
[S6] round=4 local utility u=1.000000 metrics={'f1_val': 0.41605123052148413, 'auprc': 0.7439281025050676, 'loss_val': 0.9600444770042562, 'psi': 0.5472019793149174}-{'f1_val': 0.14142628205128205, 'auprc': 0.643027197219128, 'loss_val': 1.1458397355813723, 'psi': 0.3420666481184204}
[S7] START round=4 head_norm_before_train=1.266404 (no previous merge yet)
[S7] round=4 local utility u=0.018089 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7939385848495739, 'loss_val': 1.2340547647881543, 'psi': 0.40280952757728455}-{'f1_val': 0.14205682272909165, 'auprc': 0.7917036285684986, 'loss_val': 1.263527162597112, 'psi': 0.40191554506485444}
[S8] START round=4 head_norm_before_train=0.831832 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.7790314513143838, 'loss_val': 0.9408514557160589, 'psi': 0.5352117469880332}-{'f1_val': 0.4049147559255721, 'auprc': 0.7781683734382532, 'loss_val': 0.9725181307636127, 'psi': 0.5542162029306446}
[S9] START round=4 head_norm_before_train=0.957638 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.004295 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8661562483609613, 'loss_val': 1.1671484087344999, 'psi': 0.43130127362838216}-{'f1_val': 0.141397957139996, 'auprc': 0.8659117557031668, 'loss_val': 1.1750045232421396, 'psi': 0.43120347656526437}
[S10] START round=4 head_norm_before_train=0.852353 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.904448 metrics={'f1_val': 0.43599794373817335, 'auprc': 0.6097670427221914, 'loss_val': 0.9362290217240354, 'psi': 0.5055055833317805}-{'f1_val': 0.13862163754172394, 'auprc': 0.6570390112742155, 'loss_val': 1.102684077787291, 'psi': 0.3459885870347206}
[S11] START round=4 head_norm_before_train=0.815037 cos_to_last_merge=0.9844 (last merge round=1)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6087911121352487, 'loss_val': 1.2191211419542147, 'psi': 0.32776465487796586}-{'f1_val': 0.14041368337311058, 'auprc': 0.7812035749431399, 'loss_val': 1.2812799017976568, 'psi': 0.3967296400011223}
[S13] START round=4 head_norm_before_train=1.027050 cos_to_last_merge=0.9961 (last merge round=2)
[S13] round=4 local utility u=0.104329 metrics={'f1_val': 0.4163539771616168, 'auprc': 0.5567698904723192, 'loss_val': 0.9874765575932081, 'psi': 0.4725203424858978}-{'f1_val': 0.40099726925077306, 'auprc': 0.5788061789692911, 'loss_val': 1.1701041095567446, 'psi': 0.47212083313818026}
[S14] START round=4 head_norm_before_train=0.891997 cos_to_last_merge=0.9884 (last merge round=1)
[S14] round=4 local utility u=0.019192 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7290082350335584, 'loss_val': 1.251803746403797, 'psi': 0.37581800574304564}-{'f1_val': 0.14035785288270378, 'auprc': 0.732305127300292, 'loss_val': 1.3000783204359125, 'psi': 0.37713676264973905}
[S15] START round=4 head_norm_before_train=0.912637 cos_to_last_merge=0.9770 (last merge round=1)
[S15] round=4 local utility u=1.000000 metrics={'f1_val': 0.7154931559639712, 'auprc': 0.7871957270665003, 'loss_val': 0.8458928299182591, 'psi': 0.7441741844049828}-{'f1_val': 0.27576992326619, 'auprc': 0.7774388439049879, 'loss_val': 1.1102008999830408, 'psi': 0.4764374915217091}
[S16] START round=4 head_norm_before_train=0.679156 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.289228 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9767624164859384, 'loss_val': 1.2649910692755626, 'psi': 0.4750874367138973}-{'f1_val': 0.14063745019920318, 'auprc': 0.7940202339580893, 'loss_val': 1.295221314132353, 'psi': 0.40199056370275765}
[S17] START round=4 head_norm_before_train=0.979444 cos_to_last_merge=0.9716 (last merge round=1)
[S17] round=4 local utility u=0.157643 metrics={'f1_val': 0.3539720190935716, 'auprc': 0.700829347252213, 'loss_val': 0.8901978878237985, 'psi': 0.49271495035702817}-{'f1_val': 0.3918628032171344, 'auprc': 0.5680305790788969, 'loss_val': 1.0344314392287925, 'psi': 0.4623299135618394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:40409
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:40416
[S13] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1787 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=-0.0242
[S14] DROPPED delta from S10 (cos=-0.0242 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1787) from S15
[S16] cosine check vs S15: cos=0.7169
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] cosine check vs S14: cos=0.5089
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] cosine check vs S13: cos=0.1580
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.0184
[S9] DROPPED delta from S5 (cos=-0.0184 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S6
[S11] cosine check vs S6: cos=-0.0554
[S11] DROPPED delta from S6 (cos=-0.0554 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=0.7364
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=0.0391
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=-0.0277
[S8] DROPPED delta from S2 (cos=-0.0277 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] cosine check vs S16: cos=0.6119
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=-0.0131
[S4] DROPPED delta from S3 (cos=-0.0131 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] cosine check vs S17: cos=-0.0407
[S9] DROPPED delta from S17 (cos=-0.0407 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.6696 head_norm=0.935994
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.611444e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.6699 head_norm=0.808236 delta_norm=0.461144
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.3727 head_norm=0.908321
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.678925e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.3804 head_norm=0.729801 delta_norm=0.367893
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.4164 head_norm=1.074719
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.136731e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.4164 head_norm=0.742043 delta_norm=0.713673
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.4360 head_norm=0.914168
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.361836e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.1797 head_norm=1.028419 delta_norm=0.436184
[S10] aggregate: ROLLBACK (f1_val pre=0.436 post=0.180 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.714748
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.709049e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.674163 delta_norm=0.370905
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.404509 (no previous merge yet)
[S2] round=5 local utility u=0.073347 metrics={'f1_val': 0.7007773267636337, 'auprc': 0.6483372571594815, 'loss_val': 0.5608999010639623, 'psi': 0.6798012989219728}-{'f1_val': 0.6996395837866252, 'auprc': 0.6525098436342011, 'loss_val': 0.7132843900153725, 'psi': 0.6807876877256556}
[S3] START round=5 head_norm_before_train=1.305769 (no previous merge yet)
[S3] round=5 local utility u=0.041935 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9980416780519763, 'loss_val': 1.0874883886832498, 'psi': 0.48312071058925476}-{'f1_val': 0.13984006561410703, 'auprc': 0.9994619034146319, 'loss_val': 1.1756182597815028, 'psi': 0.48368880073431697}
[S4] START round=5 head_norm_before_train=0.808236 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.003287 metrics={'f1_val': 0.6645624639759162, 'auprc': 0.6608058165137713, 'loss_val': 0.6694220198383095, 'psi': 0.6630598049910583}-{'f1_val': 0.6695510769581474, 'auprc': 0.6625095062207397, 'loss_val': 0.7110386113861632, 'psi': 0.6667344486631843}
[S5] START round=5 head_norm_before_train=1.302693 (no previous merge yet)
[S5] round=5 local utility u=0.080777 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7701406858042879, 'loss_val': 1.146225026417799, 'psi': 0.393413417178858}-{'f1_val': 0.14226190476190476, 'auprc': 0.738043111865399, 'loss_val': 1.2114854931745402, 'psi': 0.3805743876033024}
[S6] START round=5 head_norm_before_train=1.361908 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.38146039706623996, 'auprc': 0.7134724518751914, 'loss_val': 0.7931440318384978, 'psi': 0.5142652189898205}-{'f1_val': 0.41605123052148413, 'auprc': 0.7439281025050676, 'loss_val': 0.9600444770042562, 'psi': 0.5472019793149174}
[S7] START round=5 head_norm_before_train=1.288449 (no previous merge yet)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775185087336003, 'loss_val': 1.2014382833106498, 'psi': 0.3962414971308951}-{'f1_val': 0.14205682272909165, 'auprc': 0.7939385848495739, 'loss_val': 1.2340547647881543, 'psi': 0.40280952757728455}
[S8] START round=5 head_norm_before_train=0.729801 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.018201 metrics={'f1_val': 0.37589509341319993, 'auprc': 0.7724878891538525, 'loss_val': 0.9041967405617336, 'psi': 0.534532211709461}-{'f1_val': 0.3726652774371328, 'auprc': 0.7790314513143838, 'loss_val': 0.9408514557160589, 'psi': 0.5352117469880332}
[S9] START round=5 head_norm_before_train=0.982289 cos_to_last_merge=0.9974 (last merge round=3)
[S9] round=5 local utility u=0.060584 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656520615553616, 'loss_val': 1.0444682862262664, 'psi': 0.43109959890614225}-{'f1_val': 0.141397957139996, 'auprc': 0.8661562483609613, 'loss_val': 1.1671484087344999, 'psi': 0.43130127362838216}
[S10] START round=5 head_norm_before_train=1.028419 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.1879504796322625, 'auprc': 0.6269878758483801, 'loss_val': 0.8223728306550521, 'psi': 0.36356543811870956}-{'f1_val': 0.43599794373817335, 'auprc': 0.6097670427221914, 'loss_val': 0.9362290217240354, 'psi': 0.5055055833317805}
[S11] START round=5 head_norm_before_train=0.853772 cos_to_last_merge=0.9681 (last merge round=1)
[S11] round=5 local utility u=0.031614 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6010045285643966, 'loss_val': 1.1325342202543827, 'psi': 0.32465002144962496}-{'f1_val': 0.14041368337311058, 'auprc': 0.6087911121352487, 'loss_val': 1.2191211419542147, 'psi': 0.32776465487796586}
[S13] START round=5 head_norm_before_train=0.742043 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.41592377599636055, 'auprc': 0.5399509165753957, 'loss_val': 0.9359220572639634, 'psi': 0.46553463222797464}-{'f1_val': 0.4163539771616168, 'auprc': 0.5567698904723192, 'loss_val': 0.9874765575932081, 'psi': 0.4725203424858978}
[S14] START round=5 head_norm_before_train=0.925049 cos_to_last_merge=0.9761 (last merge round=1)
[S14] round=5 local utility u=0.037115 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7311356027079096, 'loss_val': 1.1839555592412552, 'psi': 0.37666895281278606}-{'f1_val': 0.14035785288270378, 'auprc': 0.7290082350335584, 'loss_val': 1.251803746403797, 'psi': 0.37581800574304564}
[S15] START round=5 head_norm_before_train=1.000182 cos_to_last_merge=0.9528 (last merge round=1)
[S15] round=5 local utility u=0.144677 metrics={'f1_val': 0.7018250996377084, 'auprc': 0.8058279080803836, 'loss_val': 0.5304267677740477, 'psi': 0.7434262230147786}-{'f1_val': 0.7154931559639712, 'auprc': 0.7871957270665003, 'loss_val': 0.8458928299182591, 'psi': 0.7441741844049828}
[S16] START round=5 head_norm_before_train=0.674163 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7912330101727751, 'loss_val': 1.2276408928995564, 'psi': 0.400875674188632}-{'f1_val': 0.14063745019920318, 'auprc': 0.9767624164859384, 'loss_val': 1.2649910692755626, 'psi': 0.4750874367138973}
[S17] START round=5 head_norm_before_train=1.071315 cos_to_last_merge=0.9412 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35278451398518107, 'auprc': 0.6649100358666971, 'loss_val': 0.8874961583917754, 'psi': 0.47763472273778745}-{'f1_val': 0.3539720190935716, 'auprc': 0.700829347252213, 'loss_val': 0.8901978878237985, 'psi': 0.49271495035702817}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:40413
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=0.7830
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0333
[S8] DROPPED delta from S2 (cos=-0.0333 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.0374
[S13] RECEIVED delta(kind=head bytes=1797) from S9
[S13] cosine check vs S9: cos=0.6318
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] cosine check vs S4: cos=0.4231
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=-0.0179
[S9] DROPPED delta from S5 (cos=-0.0179 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=0.8141
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=-0.0446
[S17] DROPPED delta from S8 (cos=-0.0446 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.0798
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.4159 head_norm=0.801951
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.030190e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.4159 head_norm=0.824098 delta_norm=0.403019
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.450 → S16@127.0.0.1:40416
[S7] ⇄ pheromone p=0.377 → S10@127.0.0.1:40411
[S10] ⇄ pheromone p=0.495 → S14@127.0.0.1:40414
[S6] ⇄ pheromone p=0.498 → S11@127.0.0.1:40412
[S11] ⇄ pheromone p=0.334 → S14@127.0.0.1:40414
[S15] ⇄ pheromone p=0.578 → S16@127.0.0.1:40416
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.957464
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.291090e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.681350 delta_norm=0.629109
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.407 → S4@127.0.0.1:40404
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=1.019803
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.196719e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.813380 delta_norm=0.519672
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.364 → S13@127.0.0.1:40413
[S3] ⇄ pheromone p=0.448 → S4@127.0.0.1:40404
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.6646 head_norm=0.907355
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.618736e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.6655 head_norm=0.759114 delta_norm=0.461874
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.467 → S9@127.0.0.1:40410
[S5] ⇄ pheromone p=0.377 → S9@127.0.0.1:40410
[S2] ⇄ pheromone p=0.613 → S8@127.0.0.1:40409
[S8] ⇄ pheromone p=0.479 → S17@127.0.0.1:40417
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.708414
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.318347e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.862028 delta_norm=0.331835
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.423 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.468 → S9@127.0.0.1:40410
[S2] START round=6 head_norm_before_train=1.480353 (no previous merge yet)
[S2] round=6 local utility u=0.103567 metrics={'f1_val': 0.7016506089258296, 'auprc': 0.6716965116662647, 'loss_val': 0.42908412297420606, 'psi': 0.6896689700220037}-{'f1_val': 0.7007773267636337, 'auprc': 0.6483372571594815, 'loss_val': 0.5608999010639623, 'psi': 0.6798012989219728}
[S3] START round=6 head_norm_before_train=1.344823 (no previous merge yet)
[S3] round=6 local utility u=0.864805 metrics={'f1_val': 0.39629664251078706, 'auprc': 0.9992472880744903, 'loss_val': 0.9002350384490828, 'psi': 0.6374769007362684}-{'f1_val': 0.13984006561410703, 'auprc': 0.9980416780519763, 'loss_val': 1.0874883886832498, 'psi': 0.48312071058925476}
[S4] START round=6 head_norm_before_train=0.759114 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.005324 metrics={'f1_val': 0.6665811474101742, 'auprc': 0.6608083310233167, 'loss_val': 0.6708942235446007, 'psi': 0.6642720208554311}-{'f1_val': 0.6645624639759162, 'auprc': 0.6608058165137713, 'loss_val': 0.6694220198383095, 'psi': 0.6630598049910583}
[S5] START round=6 head_norm_before_train=1.325554 (no previous merge yet)
[S5] round=6 local utility u=0.877640 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7777560424782085, 'loss_val': 1.0679275076869614, 'psi': 0.5618732315699352}-{'f1_val': 0.14226190476190476, 'auprc': 0.7701406858042879, 'loss_val': 1.146225026417799, 'psi': 0.393413417178858}
[S6] START round=6 head_norm_before_train=1.421698 (no previous merge yet)
[S6] round=6 local utility u=1.000000 metrics={'f1_val': 0.7004174483243395, 'auprc': 0.7949553521255212, 'loss_val': 0.5042519774157682, 'psi': 0.7382326098448122}-{'f1_val': 0.38146039706623996, 'auprc': 0.7134724518751914, 'loss_val': 0.7931440318384978, 'psi': 0.5142652189898205}
[S7] START round=6 head_norm_before_train=1.310611 (no previous merge yet)
[S7] round=6 local utility u=0.030535 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774333731680365, 'loss_val': 1.1401120450049584, 'psi': 0.39620744290466964}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775185087336003, 'loss_val': 1.2014382833106498, 'psi': 0.3962414971308951}
[S8] START round=6 head_norm_before_train=0.818130 cos_to_last_merge=0.9858 (last merge round=4)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.6991860290782679, 'auprc': 0.9913386106194764, 'loss_val': 0.7272676362478177, 'psi': 0.8160470616947513}-{'f1_val': 0.37589509341319993, 'auprc': 0.7724878891538525, 'loss_val': 0.9041967405617336, 'psi': 0.534532211709461}
[S9] START round=6 head_norm_before_train=0.813380 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.095378 metrics={'f1_val': 0.15516483516483517, 'auprc': 0.8654136487514437, 'loss_val': 0.9355992932209886, 'psi': 0.4392643605994786}-{'f1_val': 0.141397957139996, 'auprc': 0.8656520615553616, 'loss_val': 1.0444682862262664, 'psi': 0.43109959890614225}
[S10] START round=6 head_norm_before_train=1.090400 cos_to_last_merge=0.9876 (last merge round=4)
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.6882847090856022, 'auprc': 0.7686412834224359, 'loss_val': 0.5794263567708002, 'psi': 0.7204273388203357}-{'f1_val': 0.1879504796322625, 'auprc': 0.6269878758483801, 'loss_val': 0.8223728306550521, 'psi': 0.36356543811870956}
[S11] START round=6 head_norm_before_train=0.896268 cos_to_last_merge=0.9508 (last merge round=1)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.4149909032149046, 'auprc': 0.7910416740664712, 'loss_val': 0.978360343745506, 'psi': 0.5654112115555312}-{'f1_val': 0.14041368337311058, 'auprc': 0.6010045285643966, 'loss_val': 1.1325342202543827, 'psi': 0.32465002144962496}
[S13] START round=6 head_norm_before_train=0.824098 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.188966 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.647949902769823, 'loss_val': 0.8812870880971552, 'psi': 0.5086643222993475}-{'f1_val': 0.41592377599636055, 'auprc': 0.5399509165753957, 'loss_val': 0.9359220572639634, 'psi': 0.46553463222797464}
[S14] START round=6 head_norm_before_train=0.681350 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.049191 metrics={'f1_val': 0.15381263616557733, 'auprc': 0.7330572945510407, 'loss_val': 1.1720664737381061, 'psi': 0.3855104995197627}-{'f1_val': 0.14035785288270378, 'auprc': 0.7311356027079096, 'loss_val': 1.1839555592412552, 'psi': 0.37666895281278606}
[S15] START round=6 head_norm_before_train=1.097526 cos_to_last_merge=0.9254 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=6 local utility u=0.317060 metrics={'f1_val': 0.6953935457165975, 'auprc': 0.9854882346190104, 'loss_val': 0.3966993453723751, 'psi': 0.8114314212775626}-{'f1_val': 0.7018250996377084, 'auprc': 0.8058279080803836, 'loss_val': 0.5304267677740477, 'psi': 0.7434262230147786}
[S16] START round=6 head_norm_before_train=0.862028 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6665309667607077, 'loss_val': 1.156756375633997, 'psi': 0.35099485682380493}-{'f1_val': 0.14063745019920318, 'auprc': 0.7912330101727751, 'loss_val': 1.2276408928995564, 'psi': 0.400875674188632}
[S17] START round=6 head_norm_before_train=1.148406 cos_to_last_merge=0.9142 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.914
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35228783858720547, 'auprc': 0.6476887677060057, 'loss_val': 0.9200748783711504, 'psi': 0.4704482102347256}-{'f1_val': 0.35278451398518107, 'auprc': 0.6649100358666971, 'loss_val': 0.8874961583917754, 'psi': 0.47763472273778745}
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S2] not sending this round → trigger blocked (psi=0.690)
[S8] not sending this round → trigger blocked (psi=0.816)
[S4] not sending this round → trigger blocked (psi=0.664)
[S14] not sending this round → trigger blocked (psi=0.386)
[S11] not sending this round → trigger blocked (psi=0.565)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:40412
[S15] not sending this round → trigger blocked (psi=0.811)
[S9] not sending this round → trigger blocked (psi=0.439)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[S3] not sending this round → trigger blocked (psi=0.637)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:40416
[S13] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=-0.0373
[S11] DROPPED delta from S6 (cos=-0.0373 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1789) from S13
[S16] cosine check vs S13: cos=0.1738
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.8726
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=-0.0394
[S14] DROPPED delta from S10 (cos=-0.0394 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.6883 head_norm=1.166005
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.242621e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.5140 head_norm=1.206551 delta_norm=0.324262
[S10] aggregate: ROLLBACK (f1_val pre=0.688 post=0.514 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1406 head_norm=0.893267
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.712009e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4145 head_norm=0.680838 delta_norm=0.571201
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.547704 (no previous merge yet)
[S2] round=7 local utility u=0.056125 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.676422226866395, 'loss_val': 0.33053417618928205, 'psi': 0.691511526169707}-{'f1_val': 0.7016506089258296, 'auprc': 0.6716965116662647, 'loss_val': 0.42908412297420606, 'psi': 0.6896689700220037}
[S3] START round=7 head_norm_before_train=1.379595 (no previous merge yet)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.6988201799346228, 'auprc': 0.9992502506690202, 'loss_val': 0.6982106553268035, 'psi': 0.8189922082283818}-{'f1_val': 0.39629664251078706, 'auprc': 0.9992472880744903, 'loss_val': 0.9002350384490828, 'psi': 0.6374769007362684}
[S4] START round=7 head_norm_before_train=0.859290 cos_to_last_merge=0.9750 (last merge round=5)
[S4] round=7 local utility u=0.255323 metrics={'f1_val': 0.6642452088086352, 'auprc': 0.804028518090812, 'loss_val': 0.5758932719603744, 'psi': 0.720158532521506}-{'f1_val': 0.6665811474101742, 'auprc': 0.6608083310233167, 'loss_val': 0.6708942235446007, 'psi': 0.6642720208554311}
[S5] START round=7 head_norm_before_train=1.342774 (no previous merge yet)
[S5] round=7 local utility u=0.074590 metrics={'f1_val': 0.4179091272005397, 'auprc': 0.7776528827148652, 'loss_val': 0.9181841704207934, 'psi': 0.5618066294062699}-{'f1_val': 0.41795135763108626, 'auprc': 0.7777560424782085, 'loss_val': 1.0679275076869614, 'psi': 0.5618732315699352}
[S6] START round=7 head_norm_before_train=1.476110 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.5974313310758873, 'auprc': 0.7715837232231189, 'loss_val': 0.6929463230847612, 'psi': 0.6670922879347799}-{'f1_val': 0.7004174483243395, 'auprc': 0.7949553521255212, 'loss_val': 0.5042519774157682, 'psi': 0.7382326098448122}
[S7] START round=7 head_norm_before_train=1.327499 (no previous merge yet)
[S7] round=7 local utility u=0.891022 metrics={'f1_val': 0.41606030461571797, 'auprc': 0.7909369413986053, 'loss_val': 1.0426002297696693, 'psi': 0.5660109593288729}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774333731680365, 'loss_val': 1.1401120450049584, 'psi': 0.39620744290466964}
[S8] START round=7 head_norm_before_train=0.900766 cos_to_last_merge=0.9640 (last merge round=4)
[S8] round=7 local utility u=0.148893 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9964353553599584, 'loss_val': 0.5337585463779577, 'psi': 0.826984370928252}-{'f1_val': 0.6991860290782679, 'auprc': 0.9913386106194764, 'loss_val': 0.7272676362478177, 'psi': 0.8160470616947513}
[S9] START round=7 head_norm_before_train=0.852791 cos_to_last_merge=0.9953 (last merge round=5)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.6891736182580841, 'auprc': 0.999204591729077, 'loss_val': 0.7526587711788046, 'psi': 0.8131860076464812}-{'f1_val': 0.15516483516483517, 'auprc': 0.8654136487514437, 'loss_val': 0.9355992932209886, 'psi': 0.4392643605994786}
[S10] START round=7 head_norm_before_train=1.206551 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.411336 metrics={'f1_val': 0.6907320388328403, 'auprc': 0.9955305132806598, 'loss_val': 0.4521061667789917, 'psi': 0.8126514286119682}-{'f1_val': 0.6882847090856022, 'auprc': 0.7686412834224359, 'loss_val': 0.5794263567708002, 'psi': 0.7204273388203357}
[S11] START round=7 head_norm_before_train=0.944289 cos_to_last_merge=0.9324 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=7 local utility u=0.297968 metrics={'f1_val': 0.39519241550357, 'auprc': 0.973734499599602, 'loss_val': 0.8117119800032704, 'psi': 0.6266092491419828}-{'f1_val': 0.4149909032149046, 'auprc': 0.7910416740664712, 'loss_val': 0.978360343745506, 'psi': 0.5654112115555312}
[S13] START round=7 head_norm_before_train=0.884136 cos_to_last_merge=0.9853 (last merge round=5)
[S13] round=7 local utility u=0.603533 metrics={'f1_val': 0.6129803692668382, 'auprc': 0.6247479597223864, 'loss_val': 0.7876543238076142, 'psi': 0.6176874054490574}-{'f1_val': 0.41580726865236384, 'auprc': 0.647949902769823, 'loss_val': 0.8812870880971552, 'psi': 0.5086643222993475}
[S14] START round=7 head_norm_before_train=0.715254 cos_to_last_merge=0.9960 (last merge round=5)
[S14] round=7 local utility u=0.812234 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.7356531100381258, 'loss_val': 1.0120715485511687, 'psi': 0.5322174060440076}-{'f1_val': 0.15381263616557733, 'auprc': 0.7330572945510407, 'loss_val': 1.1720664737381061, 'psi': 0.3855104995197627}
[S15] START round=7 head_norm_before_train=1.200448 cos_to_last_merge=0.8954 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.895
[S15] round=7 local utility u=0.072094 metrics={'f1_val': 0.6971570972659059, 'auprc': 0.994122044521502, 'loss_val': 0.28899327466689817, 'psi': 0.8159430761681443}-{'f1_val': 0.6953935457165975, 'auprc': 0.9854882346190104, 'loss_val': 0.3966993453723751, 'psi': 0.8114314212775626}
[S16] START round=7 head_norm_before_train=0.680838 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.745764 metrics={'f1_val': 0.4170779150236796, 'auprc': 0.5937628769381309, 'loss_val': 1.1055671116034274, 'psi': 0.4877518997894601}-{'f1_val': 0.14063745019920318, 'auprc': 0.6665309667607077, 'loss_val': 1.156756375633997, 'psi': 0.35099485682380493}
[S17] START round=7 head_norm_before_train=1.196466 cos_to_last_merge=0.8958 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.896
[S17] round=7 local utility u=0.002498 metrics={'f1_val': 0.3533286766591427, 'auprc': 0.6516738028629445, 'loss_val': 0.9332780202672519, 'psi': 0.47266672714066343}-{'f1_val': 0.35228783858720547, 'auprc': 0.6476887677060057, 'loss_val': 0.9200748783711504, 'psi': 0.4704482102347256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:40413
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:40417
[S13] not sending this round → trigger blocked (psi=0.618)
[S7] not sending this round → trigger blocked (psi=0.566)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[S10] not sending this round → trigger blocked (psi=0.813)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1790) from S4
[S9] cosine check vs S4: cos=0.6943
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=-0.0690
[S17] DROPPED delta from S8 (cos=-0.0690 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=-0.0535
[S8] DROPPED delta from S2 (cos=-0.0535 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.5845
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=0.8131
[S4] RECEIVED delta(kind=head bytes=1796) from S14
[S4] cosine check vs S14: cos=0.6691
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] cosine check vs S3: cos=0.3744
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.0179
[S9] DROPPED delta from S5 (cos=-0.0179 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S15
[S16] cosine check vs S15: cos=0.6634
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.6584
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.1165
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.6130 head_norm=0.956141
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.859061e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4156 head_norm=0.887595 delta_norm=0.285906
[S13] aggregate: ROLLBACK (f1_val pre=0.613 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6642 head_norm=0.975384
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.963986e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6639 head_norm=0.816178 delta_norm=0.396399
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.6892 head_norm=0.908256
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.448281e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.6749 head_norm=0.755332 delta_norm=0.444828
[S9] aggregate: ROLLBACK (f1_val pre=0.689 post=0.675 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7140 head_norm=0.981202
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.039964e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7140 head_norm=0.755764 delta_norm=0.403996
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4171 head_norm=0.711356
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.864824e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4170 head_norm=0.918530 delta_norm=0.486482
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3966 head_norm=0.767048
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.808222e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3966 head_norm=0.806851 delta_norm=0.380822
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.608152 (no previous merge yet)
[S2] round=8 local utility u=0.074861 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.716056035946497, 'loss_val': 0.29814821495089067, 'psi': 0.7072084932023199}-{'f1_val': 0.7015710590385817, 'auprc': 0.676422226866395, 'loss_val': 0.33053417618928205, 'psi': 0.691511526169707}
[S3] START round=8 head_norm_before_train=1.416693 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.4769065146628745, 'auprc': 0.9992463736732047, 'loss_val': 0.6427607750961676, 'psi': 0.6858424582670066}-{'f1_val': 0.6988201799346228, 'auprc': 0.9992502506690202, 'loss_val': 0.6982106553268035, 'psi': 0.8189922082283818}
[S4] START round=8 head_norm_before_train=0.816178 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=1.000000 metrics={'f1_val': 0.943873133175461, 'auprc': 0.9417656250636611, 'loss_val': 0.6015633404698809, 'psi': 0.9430301299307411}-{'f1_val': 0.6642452088086352, 'auprc': 0.804028518090812, 'loss_val': 0.5758932719603744, 'psi': 0.720158532521506}
[S5] START round=8 head_norm_before_train=1.367838 (no previous merge yet)
[S5] round=8 local utility u=0.077984 metrics={'f1_val': 0.4183933784651467, 'auprc': 0.7773962112045535, 'loss_val': 0.7643507804666883, 'psi': 0.5619945115609094}-{'f1_val': 0.4179091272005397, 'auprc': 0.7776528827148652, 'loss_val': 0.9181841704207934, 'psi': 0.5618066294062699}
[S6] START round=8 head_norm_before_train=1.521556 (no previous merge yet)
[S6] round=8 local utility u=0.130915 metrics={'f1_val': 0.61787810983388, 'auprc': 0.7798509699782905, 'loss_val': 0.5785990768978997, 'psi': 0.6826672538916443}-{'f1_val': 0.5974313310758873, 'auprc': 0.7715837232231189, 'loss_val': 0.6929463230847612, 'psi': 0.6670922879347799}
[S7] START round=8 head_norm_before_train=1.345893 (no previous merge yet)
[S7] round=8 local utility u=0.907334 metrics={'f1_val': 0.6985524321561767, 'auprc': 0.7920548476013779, 'loss_val': 0.926237768888425, 'psi': 0.7359533983342572}-{'f1_val': 0.41606030461571797, 'auprc': 0.7909369413986053, 'loss_val': 1.0426002297696693, 'psi': 0.5660109593288729}
[S8] START round=8 head_norm_before_train=0.755764 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.7060018445913003, 'auprc': 0.995163193977454, 'loss_val': 0.5191096285212873, 'psi': 0.8216663843457619}-{'f1_val': 0.7140170479737811, 'auprc': 0.9964353553599584, 'loss_val': 0.5337585463779577, 'psi': 0.826984370928252}
[S9] START round=8 head_norm_before_train=0.755332 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.068912 metrics={'f1_val': 0.7011888050472792, 'auprc': 0.9984135655855997, 'loss_val': 0.6845532617684095, 'psi': 0.8200787092626074}-{'f1_val': 0.6891736182580841, 'auprc': 0.999204591729077, 'loss_val': 0.7526587711788046, 'psi': 0.8131860076464812}
[S10] START round=8 head_norm_before_train=1.259035 cos_to_last_merge=0.9944 (last merge round=6)
[S10] round=8 local utility u=0.337790 metrics={'f1_val': 0.7849019892988074, 'auprc': 0.9975891500557813, 'loss_val': 0.3477218717928657, 'psi': 0.869976853601597}-{'f1_val': 0.6907320388328403, 'auprc': 0.9955305132806598, 'loss_val': 0.4521061667789917, 'psi': 0.8126514286119682}
[S11] START round=8 head_norm_before_train=1.001851 cos_to_last_merge=0.9104 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=8 local utility u=0.700005 metrics={'f1_val': 0.6001255778781294, 'auprc': 0.9771213191962911, 'loss_val': 0.6514620369907799, 'psi': 0.7509238744053941}-{'f1_val': 0.39519241550357, 'auprc': 0.973734499599602, 'loss_val': 0.8117119800032704, 'psi': 0.6266092491419828}
[S13] START round=8 head_norm_before_train=0.887595 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.5756659692268117, 'auprc': 0.5515523391812891, 'loss_val': 0.7926110705189382, 'psi': 0.5660205172086027}-{'f1_val': 0.6129803692668382, 'auprc': 0.6247479597223864, 'loss_val': 0.7876543238076142, 'psi': 0.6176874054490574}
[S14] START round=8 head_norm_before_train=0.806851 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.250147 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.8782722481770121, 'loss_val': 0.9394366057133635, 'psi': 0.5892452206569999}-{'f1_val': 0.39659360338126215, 'auprc': 0.7356531100381258, 'loss_val': 1.0120715485511687, 'psi': 0.5322174060440076}
[S15] START round=8 head_norm_before_train=1.286351 cos_to_last_merge=0.8688 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.869
[S15] round=8 local utility u=0.024124 metrics={'f1_val': 0.6938805944742128, 'auprc': 0.9947790557145841, 'loss_val': 0.2230566433675596, 'psi': 0.8142399789703614}-{'f1_val': 0.6971570972659059, 'auprc': 0.994122044521502, 'loss_val': 0.28899327466689817, 'psi': 0.8159430761681443}
[S16] START round=8 head_norm_before_train=0.918530 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.073660 metrics={'f1_val': 0.42769101250256836, 'auprc': 0.5679770455995093, 'loss_val': 0.9445681210707102, 'psi': 0.4838054257413448}-{'f1_val': 0.4170779150236796, 'auprc': 0.5937628769381309, 'loss_val': 1.1055671116034274, 'psi': 0.4877518997894601}
[S17] START round=8 head_norm_before_train=1.231601 cos_to_last_merge=0.8806 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.881
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3506245478465975, 'auprc': 0.6423066407211191, 'loss_val': 0.973691381553757, 'psi': 0.46729738499640616}-{'f1_val': 0.3533286766591427, 'auprc': 0.6516738028629445, 'loss_val': 0.9332780202672519, 'psi': 0.47266672714066343}
[S14] not sending this round → trigger blocked (psi=0.589)
[S5] not sending this round → trigger blocked (psi=0.562)
[S16] not sending this round → trigger blocked (psi=0.484)
[S11] not sending this round → trigger blocked (psi=0.751)
[S4] not sending this round → trigger blocked (psi=0.943)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:40411
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.707)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:40412
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:40414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.814)
[S10] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] cosine check vs S10: cos=-0.0348
[S14] DROPPED delta from S10 (cos=-0.0348 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=-0.0147
[S11] DROPPED delta from S6 (cos=-0.0147 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=0.9269
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.7849 head_norm=1.307234
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.579844e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.7849 head_norm=1.314590 delta_norm=0.257984
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.658401 (no previous merge yet)
[S2] round=9 local utility u=0.159351 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.8127797087048784, 'loss_val': 0.27070664783701126, 'psi': 0.7460069732202589}-{'f1_val': 0.7013101313728686, 'auprc': 0.716056035946497, 'loss_val': 0.29814821495089067, 'psi': 0.7072084932023199}
[S3] START round=9 head_norm_before_train=1.458410 (no previous merge yet)
[S3] round=9 local utility u=0.388437 metrics={'f1_val': 0.5931360959604456, 'auprc': 0.994955007282518, 'loss_val': 0.5503910738734036, 'psi': 0.7538636604892746}-{'f1_val': 0.4769065146628745, 'auprc': 0.9992463736732047, 'loss_val': 0.6427607750961676, 'psi': 0.6858424582670066}
[S4] START round=9 head_norm_before_train=0.907112 cos_to_last_merge=0.9895 (last merge round=7)
[S4] round=9 local utility u=0.029804 metrics={'f1_val': 0.9414227672486764, 'auprc': 0.9422755603689723, 'loss_val': 0.528782252049149, 'psi': 0.9417638844967948}-{'f1_val': 0.943873133175461, 'auprc': 0.9417656250636611, 'loss_val': 0.6015633404698809, 'psi': 0.9430301299307411}
[S5] START round=9 head_norm_before_train=1.404828 (no previous merge yet)
[S5] round=9 local utility u=0.931797 metrics={'f1_val': 0.7149202099987672, 'auprc': 0.7742501112000753, 'loss_val': 0.6704786793972171, 'psi': 0.7386521704792904}-{'f1_val': 0.4183933784651467, 'auprc': 0.7773962112045535, 'loss_val': 0.7643507804666883, 'psi': 0.5619945115609094}
[S6] START round=9 head_norm_before_train=1.560419 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.6175819349745525, 'auprc': 0.7742341297522164, 'loss_val': 0.6220537281448985, 'psi': 0.6802428128856182}-{'f1_val': 0.61787810983388, 'auprc': 0.7798509699782905, 'loss_val': 0.5785990768978997, 'psi': 0.6826672538916443}
[S7] START round=9 head_norm_before_train=1.371329 (no previous merge yet)
[S7] round=9 local utility u=0.008902 metrics={'f1_val': 0.684404185525501, 'auprc': 0.7908141977651101, 'loss_val': 0.8198227283093359, 'psi': 0.7269681904213445}-{'f1_val': 0.6985524321561767, 'auprc': 0.7920548476013779, 'loss_val': 0.926237768888425, 'psi': 0.7359533983342572}
[S8] START round=9 head_norm_before_train=0.840535 cos_to_last_merge=0.9927 (last merge round=7)
[S8] round=9 local utility u=0.034616 metrics={'f1_val': 0.7009060531918208, 'auprc': 0.9941234845620257, 'loss_val': 0.41618328111021485, 'psi': 0.8181930257399027}-{'f1_val': 0.7060018445913003, 'auprc': 0.995163193977454, 'loss_val': 0.5191096285212873, 'psi': 0.8216663843457619}
[S9] START round=9 head_norm_before_train=0.808077 cos_to_last_merge=0.9933 (last merge round=7)
[S9] round=9 local utility u=0.076747 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9984420470640025, 'loss_val': 0.532645860679217, 'psi': 0.8202402989945738}-{'f1_val': 0.7011888050472792, 'auprc': 0.9984135655855997, 'loss_val': 0.6845532617684095, 'psi': 0.8200787092626074}
[S10] START round=9 head_norm_before_train=1.314590 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.651648 metrics={'f1_val': 0.9922675090193217, 'auprc': 0.9976774363067668, 'loss_val': 0.28888298012333363, 'psi': 0.9944314799342997}-{'f1_val': 0.7849019892988074, 'auprc': 0.9975891500557813, 'loss_val': 0.3477218717928657, 'psi': 0.869976853601597}
[S11] START round=9 head_norm_before_train=1.065740 cos_to_last_merge=0.8871 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.887
[S11] round=9 local utility u=0.390339 metrics={'f1_val': 0.7016486767242034, 'auprc': 0.9837963661654606, 'loss_val': 0.4999482559283205, 'psi': 0.8145077525007063}-{'f1_val': 0.6001255778781294, 'auprc': 0.9771213191962911, 'loss_val': 0.6514620369907799, 'psi': 0.7509238744053941}
[S13] START round=9 head_norm_before_train=0.954581 cos_to_last_merge=0.9925 (last merge round=7)
[S13] round=9 local utility u=0.274273 metrics={'f1_val': 0.6076882173390115, 'auprc': 0.6364600437018835, 'loss_val': 0.6909206970482895, 'psi': 0.6191969478841602}-{'f1_val': 0.5756659692268117, 'auprc': 0.5515523391812891, 'loss_val': 0.7926110705189382, 'psi': 0.5660205172086027}
[S14] START round=9 head_norm_before_train=0.845470 cos_to_last_merge=0.9941 (last merge round=7)
[S14] round=9 local utility u=0.134240 metrics={'f1_val': 0.39632432388018624, 'auprc': 0.9322891528746386, 'loss_val': 0.8315895933129408, 'psi': 0.6107102554779672}-{'f1_val': 0.39656053564365834, 'auprc': 0.8782722481770121, 'loss_val': 0.9394366057133635, 'psi': 0.5892452206569999}
[S15] START round=9 head_norm_before_train=1.349985 cos_to_last_merge=0.8487 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.849
[S15] round=9 local utility u=0.209028 metrics={'f1_val': 0.7764462129309867, 'auprc': 0.9868930374194174, 'loss_val': 0.2767365143139921, 'psi': 0.8606249427263589}-{'f1_val': 0.6938805944742128, 'auprc': 0.9947790557145841, 'loss_val': 0.2230566433675596, 'psi': 0.8142399789703614}
[S16] START round=9 head_norm_before_train=0.956051 cos_to_last_merge=0.9955 (last merge round=7)
[S16] round=9 local utility u=0.204306 metrics={'f1_val': 0.3858056857044932, 'auprc': 0.7544348102286543, 'loss_val': 0.8440182208938468, 'psi': 0.5332573355141577}-{'f1_val': 0.42769101250256836, 'auprc': 0.5679770455995093, 'loss_val': 0.9445681210707102, 'psi': 0.4838054257413448}
[S17] START round=9 head_norm_before_train=1.249490 cos_to_last_merge=0.8706 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.871
[S17] round=9 local utility u=0.112818 metrics={'f1_val': 0.35243618488830136, 'auprc': 0.710298484245732, 'loss_val': 0.9629005260350734, 'psi': 0.4955811046312736}-{'f1_val': 0.3506245478465975, 'auprc': 0.6423066407211191, 'loss_val': 0.973691381553757, 'psi': 0.46729738499640616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:40416
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:40410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S7] not sending this round → trigger blocked (psi=0.727)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] cosine check vs S2: cos=-0.0527
[S8] DROPPED delta from S2 (cos=-0.0527 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S15
[S16] cosine check vs S15: cos=0.9189
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.7426
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] cosine check vs S13: cos=0.2897
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] cosine check vs S11: cos=0.8694
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] cosine check vs S14: cos=0.5364
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=0.5568
[S9] RECEIVED delta(kind=head bytes=1787) from S4
[S9] cosine check vs S4: cos=0.6836
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=-0.1042
[S17] DROPPED delta from S8 (cos=-0.1042 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S16
[S8] cosine check vs S16: cos=0.7020
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.0083
[S9] DROPPED delta from S5 (cos=-0.0083 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.4676
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.9414 head_norm=1.011356
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.503134e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.9424 head_norm=0.886879 delta_norm=0.350313
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3858 head_norm=1.002879
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.283736e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3863 head_norm=0.919782 delta_norm=0.228374
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.7009 head_norm=0.929409
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.744472e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.7007 head_norm=0.891389 delta_norm=0.374447
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7014 head_norm=0.873190
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.977879e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7014 head_norm=0.804946 delta_norm=0.297788
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.6077 head_norm=1.029106
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.488994e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.6079 head_norm=0.888273 delta_norm=0.348899
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3963 head_norm=0.892565
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.807529e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3962 head_norm=0.974986 delta_norm=0.280753
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.696147 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.6940939423934331, 'auprc': 0.8058444092211616, 'loss_val': 0.32817277956942503, 'psi': 0.7387941291245246}-{'f1_val': 0.7014918162305126, 'auprc': 0.8127797087048784, 'loss_val': 0.27070664783701126, 'psi': 0.7460069732202589}
[S3] START round=10 head_norm_before_train=1.497786 (no previous merge yet)
[S3] round=10 local utility u=0.399934 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9971513796135527, 'loss_val': 0.4002821219022218, 'psi': 0.8190591032573383}-{'f1_val': 0.5931360959604456, 'auprc': 0.994955007282518, 'loss_val': 0.5503910738734036, 'psi': 0.7538636604892746}
[S4] START round=10 head_norm_before_train=0.886879 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.9468500185415181, 'auprc': 0.9390002197027796, 'loss_val': 0.5534212159942424, 'psi': 0.9437100990060227}-{'f1_val': 0.9414227672486764, 'auprc': 0.9422755603689723, 'loss_val': 0.528782252049149, 'psi': 0.9417638844967948}
[S5] START round=10 head_norm_before_train=1.443158 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.661601918538484, 'loss_val': 0.5508515103644119, 'psi': 0.6852794247740679}-{'f1_val': 0.7149202099987672, 'auprc': 0.7742501112000753, 'loss_val': 0.6704786793972171, 'psi': 0.7386521704792904}
[S6] START round=10 head_norm_before_train=1.603686 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.5943643151340867, 'auprc': 0.7689373434563985, 'loss_val': 0.6784786517995459, 'psi': 0.6641935264630114}-{'f1_val': 0.6175819349745525, 'auprc': 0.7742341297522164, 'loss_val': 0.6220537281448985, 'psi': 0.6802428128856182}
[S7] START round=10 head_norm_before_train=1.407739 (no previous merge yet)
[S7] round=10 local utility u=0.060711 metrics={'f1_val': 0.6818941275571957, 'auprc': 0.7898339335612299, 'loss_val': 0.6803991855225958, 'psi': 0.7250700499588094}-{'f1_val': 0.684404185525501, 'auprc': 0.7908141977651101, 'loss_val': 0.8198227283093359, 'psi': 0.7269681904213445}
[S8] START round=10 head_norm_before_train=0.891389 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.7137948385190309, 'auprc': 0.9090546674600692, 'loss_val': 0.43569489206110973, 'psi': 0.7918987700954463}-{'f1_val': 0.7009060531918208, 'auprc': 0.9941234845620257, 'loss_val': 0.41618328111021485, 'psi': 0.8181930257399027}
[S9] START round=10 head_norm_before_train=0.804946 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.009047 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9984367652297369, 'loss_val': 0.5136440273650782, 'psi': 0.8201489962164328}-{'f1_val': 0.7014391336149548, 'auprc': 0.9984420470640025, 'loss_val': 0.532645860679217, 'psi': 0.8202402989945738}
[S10] START round=10 head_norm_before_train=1.352364 cos_to_last_merge=0.9988 (last merge round=8)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.9591737075116811, 'auprc': 0.9969780304150576, 'loss_val': 0.22832742807500886, 'psi': 0.9742954366730318}-{'f1_val': 0.9922675090193217, 'auprc': 0.9976774363067668, 'loss_val': 0.28888298012333363, 'psi': 0.9944314799342997}
[S11] START round=10 head_norm_before_train=1.123462 cos_to_last_merge=0.8673 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.867
[S11] round=10 local utility u=0.043587 metrics={'f1_val': 0.7023082095754619, 'auprc': 0.9962009977069258, 'loss_val': 0.45394554053257236, 'psi': 0.8198653248280474}-{'f1_val': 0.7016486767242034, 'auprc': 0.9837963661654606, 'loss_val': 0.4999482559283205, 'psi': 0.8145077525007063}
[S13] START round=10 head_norm_before_train=0.888273 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5686735882440686, 'auprc': 0.5454184440928487, 'loss_val': 0.822675788864057, 'psi': 0.5593715305835806}-{'f1_val': 0.6076882173390115, 'auprc': 0.6364600437018835, 'loss_val': 0.6909206970482895, 'psi': 0.6191969478841602}
[S14] START round=10 head_norm_before_train=0.974986 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.126039 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9949556876811089, 'loss_val': 0.7691266923563542, 'psi': 0.6359384371012008}-{'f1_val': 0.39632432388018624, 'auprc': 0.9322891528746386, 'loss_val': 0.8315895933129408, 'psi': 0.6107102554779672}
[S15] START round=10 head_norm_before_train=1.398432 cos_to_last_merge=0.8355 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.835
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6985420690370332, 'auprc': 0.8986541260776755, 'loss_val': 0.3332502370174929, 'psi': 0.7785868918532901}-{'f1_val': 0.7764462129309867, 'auprc': 0.9868930374194174, 'loss_val': 0.2767365143139921, 'psi': 0.8606249427263589}
[S16] START round=10 head_norm_before_train=0.919782 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3494125317346933, 'auprc': 0.7601945528903252, 'loss_val': 0.8201207805143313, 'psi': 0.5137253401969462}-{'f1_val': 0.3858056857044932, 'auprc': 0.7544348102286543, 'loss_val': 0.8440182208938468, 'psi': 0.5332573355141577}
[S17] START round=10 head_norm_before_train=1.260992 cos_to_last_merge=0.8679 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=10 local utility u=0.096753 metrics={'f1_val': 0.37394798833154996, 'auprc': 0.7250016693698695, 'loss_val': 0.9425751363317493, 'psi': 0.5143694607468778}-{'f1_val': 0.35243618488830136, 'auprc': 0.710298484245732, 'loss_val': 0.9629005260350734, 'psi': 0.4955811046312736}
[S9] not sending this round → trigger blocked (psi=0.820)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.636)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.819)
[S11] not sending this round → trigger blocked (psi=0.820)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.9573
[S17] not sending this round → trigger blocked (psi=0.514)
[S2] ⇄ pheromone p=0.250 → S8@127.0.0.1:40409
[S11] ⇄ pheromone p=0.383 → S14@127.0.0.1:40414
[S9] ⇄ pheromone p=0.252 → S13@127.0.0.1:40413
[S8] ⇄ pheromone p=0.260 → S17@127.0.0.1:40417
[S5] ⇄ pheromone p=0.362 → S9@127.0.0.1:40410
[S13] ⇄ pheromone p=0.269 → S16@127.0.0.1:40416
[S14] ⇄ pheromone p=0.299 → S4@127.0.0.1:40404
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.9592 head_norm=1.397019
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.089167e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.9578 head_norm=1.405014 delta_norm=0.208917
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.434 → S14@127.0.0.1:40414
[S15] ⇄ pheromone p=0.259 → S16@127.0.0.1:40416
[S4] ⇄ pheromone p=0.312 → S9@127.0.0.1:40410
[S3] ⇄ pheromone p=0.462 → S4@127.0.0.1:40404
[S6] ⇄ pheromone p=0.262 → S11@127.0.0.1:40412
[S7] ⇄ pheromone p=0.347 → S10@127.0.0.1:40411
[S16] ⇄ pheromone p=0.257 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.191 → S9@127.0.0.1:40410
[S2] START round=11 head_norm_before_train=1.725440 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7263907478508741, 'auprc': 0.7669731935232776, 'loss_val': 0.7406550234534277, 'psi': 0.7426237261198355}-{'f1_val': 0.6940939423934331, 'auprc': 0.8058444092211616, 'loss_val': 0.32817277956942503, 'psi': 0.7387941291245246}
[S3] START round=11 head_norm_before_train=1.534946 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.6902002807210639, 'auprc': 0.9956797364108587, 'loss_val': 0.3852815212468144, 'psi': 0.8123920629969819}-{'f1_val': 0.700330919019862, 'auprc': 0.9971513796135527, 'loss_val': 0.4002821219022218, 'psi': 0.8190591032573383}
[S4] START round=11 head_norm_before_train=0.968589 cos_to_last_merge=0.9936 (last merge round=9)
[S4] round=11 local utility u=0.122849 metrics={'f1_val': 0.9535571199208659, 'auprc': 0.9593721767257338, 'loss_val': 0.4090810075616765, 'psi': 0.9558831426428132}-{'f1_val': 0.9468500185415181, 'auprc': 0.9390002197027796, 'loss_val': 0.5534212159942424, 'psi': 0.9437100990060227}
[S5] START round=11 head_norm_before_train=1.473470 (no previous merge yet)
[S5] round=11 local utility u=0.059735 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.6934918511415868, 'loss_val': 0.5255659375490093, 'psi': 0.697886855763149}-{'f1_val': 0.7010644289311239, 'auprc': 0.661601918538484, 'loss_val': 0.5508515103644119, 'psi': 0.6852794247740679}
[S6] START round=11 head_norm_before_train=1.636807 (no previous merge yet)
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.9555299486743156, 'auprc': 0.9459749971209483, 'loss_val': 0.23194765721707017, 'psi': 0.9517079680529688}-{'f1_val': 0.5943643151340867, 'auprc': 0.7689373434563985, 'loss_val': 0.6784786517995459, 'psi': 0.6641935264630114}
[S7] START round=11 head_norm_before_train=1.443524 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.3819540071865276, 'auprc': 0.7716104629876837, 'loss_val': 0.8825431646247561, 'psi': 0.53781658950699}-{'f1_val': 0.6818941275571957, 'auprc': 0.7898339335612299, 'loss_val': 0.6803991855225958, 'psi': 0.7250700499588094}
[S8] START round=11 head_norm_before_train=0.964529 cos_to_last_merge=0.9939 (last merge round=9)
[S8] round=11 local utility u=0.065692 metrics={'f1_val': 0.6915146307906169, 'auprc': 0.9953943319626539, 'loss_val': 0.42964914665967624, 'psi': 0.8130665112594317}-{'f1_val': 0.7137948385190309, 'auprc': 0.9090546674600692, 'loss_val': 0.43569489206110973, 'psi': 0.7918987700954463}
[S9] START round=11 head_norm_before_train=0.863572 cos_to_last_merge=0.9944 (last merge round=9)
[S9] round=11 local utility u=0.053282 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9978948483020695, 'loss_val': 0.40545337578495116, 'psi': 0.8199322294453659}-{'f1_val': 0.7012904835408967, 'auprc': 0.9984367652297369, 'loss_val': 0.5136440273650782, 'psi': 0.8201489962164328}
[S10] START round=11 head_norm_before_train=1.405014 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.105397 metrics={'f1_val': 0.9944975983808788, 'auprc': 0.9977117677297187, 'loss_val': 0.23167818969451867, 'psi': 0.9957832661204148}-{'f1_val': 0.9591737075116811, 'auprc': 0.9969780304150576, 'loss_val': 0.22832742807500886, 'psi': 0.9742954366730318}
[S11] START round=11 head_norm_before_train=1.171432 cos_to_last_merge=0.8515 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.852
[S11] round=11 local utility u=0.047031 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9981629816118861, 'loss_val': 0.36353239426340317, 'psi': 0.8204263826237466}-{'f1_val': 0.7023082095754619, 'auprc': 0.9962009977069258, 'loss_val': 0.45394554053257236, 'psi': 0.8198653248280474}
[S13] START round=11 head_norm_before_train=0.956780 cos_to_last_merge=0.9935 (last merge round=9)
[S13] round=11 local utility u=0.357263 metrics={'f1_val': 0.616004886125388, 'auprc': 0.6437325743322493, 'loss_val': 0.6870791759109386, 'psi': 0.6270959614081325}-{'f1_val': 0.5686735882440686, 'auprc': 0.5454184440928487, 'loss_val': 0.822675788864057, 'psi': 0.5593715305835806}
[S14] START round=11 head_norm_before_train=1.007998 cos_to_last_merge=0.9968 (last merge round=9)
[S14] round=11 local utility u=0.018282 metrics={'f1_val': 0.3963900194967479, 'auprc': 0.992995454084717, 'loss_val': 0.7254603621573406, 'psi': 0.6350321933319356}-{'f1_val': 0.39659360338126215, 'auprc': 0.9949556876811089, 'loss_val': 0.7691266923563542, 'psi': 0.6359384371012008}
[S15] START round=11 head_norm_before_train=1.445246 cos_to_last_merge=0.8244 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.824
[S15] round=11 local utility u=0.448032 metrics={'f1_val': 0.7867125021907272, 'auprc': 0.9879446394877394, 'loss_val': 0.23408000627673506, 'psi': 0.8672053571095321}-{'f1_val': 0.6985420690370332, 'auprc': 0.8986541260776755, 'loss_val': 0.3332502370174929, 'psi': 0.7785868918532901}
[S16] START round=11 head_norm_before_train=0.968843 cos_to_last_merge=0.9964 (last merge round=9)
[S16] round=11 local utility u=0.223988 metrics={'f1_val': 0.43617608506256395, 'auprc': 0.7357291326526401, 'loss_val': 0.8193295095671155, 'psi': 0.5559973040985944}-{'f1_val': 0.3494125317346933, 'auprc': 0.7601945528903252, 'loss_val': 0.8201207805143313, 'psi': 0.5137253401969462}
[S17] START round=11 head_norm_before_train=1.278831 cos_to_last_merge=0.8619 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.862
[S17] round=11 local utility u=0.045822 metrics={'f1_val': 0.38261387686248105, 'auprc': 0.7323865763128563, 'loss_val': 0.9250821742940817, 'psi': 0.5225229566426312}-{'f1_val': 0.37394798833154996, 'auprc': 0.7250016693698695, 'loss_val': 0.9425751363317493, 'psi': 0.5143694607468778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:40414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:40416
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.0032
[S4] RECEIVED delta(kind=head bytes=1803) from S14
[S4] cosine check vs S14: cos=0.5126
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=-0.1061
[S17] DROPPED delta from S8 (cos=-0.1061 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S4
[S9] cosine check vs S4: cos=0.6306
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=-0.0045
[S11] DROPPED delta from S6 (cos=-0.0045 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=-0.0333
[S14] DROPPED delta from S10 (cos=-0.0333 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1791) from S16
[S8] cosine check vs S16: cos=0.8472
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.7690
[S16] RECEIVED delta(kind=head bytes=1790) from S15
[S16] cosine check vs S15: cos=0.8636
[S16] RECEIVED delta(kind=head bytes=1796) from S13
[S16] cosine check vs S13: cos=0.3958
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.9374
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.6040
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6160 head_norm=1.021351
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.345723e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6103 head_norm=0.918778 delta_norm=0.334572
[S13] aggregate: ROLLBACK (f1_val pre=0.616 post=0.610 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7013 head_norm=0.932214
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.302585e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=0.772725 delta_norm=0.330259
[S9] aggregate: ACCEPT kept=['S5', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.6915 head_norm=1.041364
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.855298e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.6912 head_norm=0.992382 delta_norm=0.285530
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.9536 head_norm=1.051348
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.153714e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.9550 head_norm=0.907866 delta_norm=0.515371
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4362 head_norm=1.023845
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.979053e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4056 head_norm=0.951991 delta_norm=0.197905
[S16] aggregate: ROLLBACK (f1_val pre=0.436 post=0.406 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3964 head_norm=1.036495
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.197041e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.3964 head_norm=1.111642 delta_norm=0.219704
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.749234 (no previous merge yet)
[S2] round=12 local utility u=0.465036 metrics={'f1_val': 0.7609389844695267, 'auprc': 0.8609148161818327, 'loss_val': 0.2996982568479863, 'psi': 0.8009293171544491}-{'f1_val': 0.7263907478508741, 'auprc': 0.7669731935232776, 'loss_val': 0.7406550234534277, 'psi': 0.7426237261198355}
[S3] START round=12 head_norm_before_train=1.563194 (no previous merge yet)
[S3] round=12 local utility u=0.063182 metrics={'f1_val': 0.69982954919712, 'auprc': 0.9958469419664143, 'loss_val': 0.31719475225595906, 'psi': 0.8182365063048378}-{'f1_val': 0.6902002807210639, 'auprc': 0.9956797364108587, 'loss_val': 0.3852815212468144, 'psi': 0.8123920629969819}
[S4] START round=12 head_norm_before_train=0.907866 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.9527117204678763, 'auprc': 0.9537109035706676, 'loss_val': 0.3950412477050914, 'psi': 0.9531113937089928}-{'f1_val': 0.9535571199208659, 'auprc': 0.9593721767257338, 'loss_val': 0.4090810075616765, 'psi': 0.9558831426428132}
[S5] START round=12 head_norm_before_train=1.499367 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.6615924485145392, 'loss_val': 0.46144408265514497, 'psi': 0.684978472511974}-{'f1_val': 0.7008168588441903, 'auprc': 0.6934918511415868, 'loss_val': 0.5255659375490093, 'psi': 0.697886855763149}
[S6] START round=12 head_norm_before_train=1.657432 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.8221395204143797, 'auprc': 0.9348368225977685, 'loss_val': 0.3026279950307754, 'psi': 0.8672184412877352}-{'f1_val': 0.9555299486743156, 'auprc': 0.9459749971209483, 'loss_val': 0.23194765721707017, 'psi': 0.9517079680529688}
[S7] START round=12 head_norm_before_train=1.469618 (no previous merge yet)
[S7] round=12 local utility u=1.000000 metrics={'f1_val': 0.6724547872949154, 'auprc': 0.8403367771699528, 'loss_val': 0.536492485008276, 'psi': 0.7396075832449304}-{'f1_val': 0.3819540071865276, 'auprc': 0.7716104629876837, 'loss_val': 0.8825431646247561, 'psi': 0.53781658950699}
[S8] START round=12 head_norm_before_train=0.992382 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.100545 metrics={'f1_val': 0.7137948385190309, 'auprc': 0.9955978099827054, 'loss_val': 0.3628504244225674, 'psi': 0.8265160271045007}-{'f1_val': 0.6915146307906169, 'auprc': 0.9953943319626539, 'loss_val': 0.42964914665967624, 'psi': 0.8130665112594317}
[S9] START round=12 head_norm_before_train=0.772725 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9979237228570115, 'loss_val': 0.4470220865305541, 'psi': 0.8199437792673426}-{'f1_val': 0.7012904835408967, 'auprc': 0.9978948483020695, 'loss_val': 0.40545337578495116, 'psi': 0.8199322294453659}
[S10] START round=12 head_norm_before_train=1.437307 cos_to_last_merge=0.9993 (last merge round=10)
[S10] round=12 local utility u=0.010756 metrics={'f1_val': 0.9949140915418154, 'auprc': 0.9975187634540748, 'loss_val': 0.21208684322980395, 'psi': 0.9959559603067192}-{'f1_val': 0.9944975983808788, 'auprc': 0.9977117677297187, 'loss_val': 0.23167818969451867, 'psi': 0.9957832661204148}
[S11] START round=12 head_norm_before_train=1.222175 cos_to_last_merge=0.8379 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.838
[S11] round=12 local utility u=0.021178 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9983934816714696, 'loss_val': 0.32186808432026287, 'psi': 0.8205185826475798}-{'f1_val': 0.7019353166316534, 'auprc': 0.9981629816118861, 'loss_val': 0.36353239426340317, 'psi': 0.8204263826237466}
[S13] START round=12 head_norm_before_train=0.918778 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.029461 metrics={'f1_val': 0.6328216484384996, 'auprc': 0.6351766370448455, 'loss_val': 0.7033905307589247, 'psi': 0.633763643881038}-{'f1_val': 0.616004886125388, 'auprc': 0.6437325743322493, 'loss_val': 0.6870791759109386, 'psi': 0.6270959614081325}
[S14] START round=12 head_norm_before_train=1.111642 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.005798 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9924181732414572, 'loss_val': 0.7133548908976729, 'psi': 0.6349234313253401}-{'f1_val': 0.3963900194967479, 'auprc': 0.992995454084717, 'loss_val': 0.7254603621573406, 'psi': 0.6350321933319356}
[S15] START round=12 head_norm_before_train=1.493281 cos_to_last_merge=0.8143 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.814
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7021092897242835, 'auprc': 0.8620966026835017, 'loss_val': 0.40293470226774036, 'psi': 0.7661042149079709}-{'f1_val': 0.7867125021907272, 'auprc': 0.9879446394877394, 'loss_val': 0.23408000627673506, 'psi': 0.8672053571095321}
[S16] START round=12 head_norm_before_train=0.951991 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.277440 metrics={'f1_val': 0.5309731237478073, 'auprc': 0.7597483841719772, 'loss_val': 0.9052889489914181, 'psi': 0.6224832279174752}-{'f1_val': 0.43617608506256395, 'auprc': 0.7357291326526401, 'loss_val': 0.8193295095671155, 'psi': 0.5559973040985944}
[S17] START round=12 head_norm_before_train=1.301369 cos_to_last_merge=0.8556 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.856
[S17] round=12 local utility u=0.047533 metrics={'f1_val': 0.38307937940820175, 'auprc': 0.7637824370092359, 'loss_val': 0.9269964294350216, 'psi': 0.5353606024486154}-{'f1_val': 0.38261387686248105, 'auprc': 0.7323865763128563, 'loss_val': 0.9250821742940817, 'psi': 0.5225229566426312}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.821)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.827)
[S13] not sending this round → trigger blocked (psi=0.634)
[S14] not sending this round → trigger blocked (psi=0.635)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:40411
[S16] not sending this round → trigger blocked (psi=0.622)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0343
[S8] DROPPED delta from S2 (cos=-0.0343 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=0.9734
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=0.3908
[S17] not sending this round → trigger blocked (psi=0.535)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9527 head_norm=0.986059
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.545493e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.9515 head_norm=1.087391 delta_norm=0.754549
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.9949 head_norm=1.460976
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.709573e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9949 head_norm=1.465788 delta_norm=0.170957
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.771000 (no previous merge yet)
[S2] round=13 local utility u=0.150828 metrics={'f1_val': 0.8148589539555019, 'auprc': 0.9013219916059754, 'loss_val': 0.4427828908054501, 'psi': 0.8494441690156913}-{'f1_val': 0.7609389844695267, 'auprc': 0.8609148161818327, 'loss_val': 0.2996982568479863, 'psi': 0.8009293171544491}
[S3] START round=13 head_norm_before_train=1.590980 (no previous merge yet)
[S3] round=13 local utility u=0.026548 metrics={'f1_val': 0.700330919019862, 'auprc': 0.995857891348907, 'loss_val': 0.26713928283877, 'psi': 0.8185417079514801}-{'f1_val': 0.69982954919712, 'auprc': 0.9958469419664143, 'loss_val': 0.31719475225595906, 'psi': 0.8182365063048378}
[S4] START round=13 head_norm_before_train=1.087391 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9530457273091739, 'auprc': 0.9557255297326034, 'loss_val': 0.4197141530973109, 'psi': 0.9541176482785457}-{'f1_val': 0.9527117204678763, 'auprc': 0.9537109035706676, 'loss_val': 0.3950412477050914, 'psi': 0.9531113937089928}
[S5] START round=13 head_norm_before_train=1.524847 (no previous merge yet)
[S5] round=13 local utility u=0.027546 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.6616246749054908, 'loss_val': 0.40644870186162224, 'psi': 0.6849913630683546}-{'f1_val': 0.7005691551769304, 'auprc': 0.6615924485145392, 'loss_val': 0.46144408265514497, 'psi': 0.684978472511974}
[S6] START round=13 head_norm_before_train=1.677095 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.8099511687440367, 'auprc': 0.8191468516435281, 'loss_val': 0.3846837356918541, 'psi': 0.8136294419038332}-{'f1_val': 0.8221395204143797, 'auprc': 0.9348368225977685, 'loss_val': 0.3026279950307754, 'psi': 0.8672184412877352}
[S7] START round=13 head_norm_before_train=1.490325 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.554668929364245, 'auprc': 0.7797731738403333, 'loss_val': 0.7427011986828708, 'psi': 0.6447106271546803}-{'f1_val': 0.6724547872949154, 'auprc': 0.8403367771699528, 'loss_val': 0.536492485008276, 'psi': 0.7396075832449304}
[S8] START round=13 head_norm_before_train=1.056365 cos_to_last_merge=0.9963 (last merge round=11)
[S8] round=13 local utility u=0.004631 metrics={'f1_val': 0.7060686964708273, 'auprc': 0.9857594428353281, 'loss_val': 0.2777165270599562, 'psi': 0.8179449950166277}-{'f1_val': 0.7137948385190309, 'auprc': 0.9955978099827054, 'loss_val': 0.3628504244225674, 'psi': 0.8265160271045007}
[S9] START round=13 head_norm_before_train=0.834721 cos_to_last_merge=0.9945 (last merge round=11)
[S9] round=13 local utility u=0.038082 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.997958200639724, 'loss_val': 0.37096211167382387, 'psi': 0.8199575703804276}-{'f1_val': 0.7012904835408967, 'auprc': 0.9979237228570115, 'loss_val': 0.4470220865305541, 'psi': 0.8199437792673426}
[S10] START round=13 head_norm_before_train=1.465788 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.9813059898989643, 'auprc': 0.9862924265166106, 'loss_val': 0.25128438907864603, 'psi': 0.9833005645460229}-{'f1_val': 0.9949140915418154, 'auprc': 0.9975187634540748, 'loss_val': 0.21208684322980395, 'psi': 0.9959559603067192}
[S11] START round=13 head_norm_before_train=1.272167 cos_to_last_merge=0.8264 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.826
[S11] round=13 local utility u=0.012603 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9986820945161057, 'loss_val': 0.29752841840114125, 'psi': 0.8206340277854343}-{'f1_val': 0.7019353166316534, 'auprc': 0.9983934816714696, 'loss_val': 0.32186808432026287, 'psi': 0.8205185826475798}
[S13] START round=13 head_norm_before_train=0.974568 cos_to_last_merge=0.9955 (last merge round=11)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6204290995808712, 'auprc': 0.5978916020605017, 'loss_val': 0.7070972871451267, 'psi': 0.6114141005727234}-{'f1_val': 0.6328216484384996, 'auprc': 0.6351766370448455, 'loss_val': 0.7033905307589247, 'psi': 0.633763643881038}
[S14] START round=13 head_norm_before_train=1.137109 cos_to_last_merge=0.9987 (last merge round=11)
[S14] round=13 local utility u=0.008640 metrics={'f1_val': 0.39621953074959476, 'auprc': 0.9896404714414189, 'loss_val': 0.6854972175134424, 'psi': 0.6335879070263244}-{'f1_val': 0.39659360338126215, 'auprc': 0.9924181732414572, 'loss_val': 0.7133548908976729, 'psi': 0.6349234313253401}
[S15] START round=13 head_norm_before_train=1.540150 cos_to_last_merge=0.8056 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.806
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6945896212251824, 'auprc': 0.8459486068795498, 'loss_val': 0.45799023925061894, 'psi': 0.7551332154869294}-{'f1_val': 0.7021092897242835, 'auprc': 0.8620966026835017, 'loss_val': 0.40293470226774036, 'psi': 0.7661042149079709}
[S16] START round=13 head_norm_before_train=0.996499 cos_to_last_merge=0.9983 (last merge round=11)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.41044725298515244, 'auprc': 0.7448221221598992, 'loss_val': 0.8116725193564439, 'psi': 0.5441972006550512}-{'f1_val': 0.5309731237478073, 'auprc': 0.7597483841719772, 'loss_val': 0.9052889489914181, 'psi': 0.6224832279174752}
[S17] START round=13 head_norm_before_train=1.320472 cos_to_last_merge=0.8519 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.852
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3699645132463034, 'auprc': 0.7890161803068934, 'loss_val': 1.0546910399515288, 'psi': 0.5375851800705395}-{'f1_val': 0.38307937940820175, 'auprc': 0.7637824370092359, 'loss_val': 0.9269964294350216, 'psi': 0.5353606024486154}
[S3] not sending this round → trigger blocked (psi=0.819)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:40413
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.849)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.9621
[S17] RECEIVED delta(kind=head bytes=1789) from S8
[S17] cosine check vs S8: cos=-0.0923
[S17] DROPPED delta from S8 (cos=-0.0923 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S14
[S4] cosine check vs S14: cos=0.4045
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.2336
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] cosine check vs S9: cos=0.8230
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.9530 head_norm=1.157999
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.334023e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.9532 head_norm=0.972776 delta_norm=0.633402
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6204 head_norm=1.039339
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.961323e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6058 head_norm=0.927453 delta_norm=0.296132
[S13] aggregate: ROLLBACK (f1_val pre=0.620 post=0.606 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7013 head_norm=0.903051
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.015232e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7013 head_norm=0.984823 delta_norm=0.801523
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.3962 head_norm=1.163625
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.859374e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.3962 head_norm=1.226925 delta_norm=0.185937
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.790998 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.5953246149904097, 'auprc': 0.8424250954179731, 'loss_val': 0.41136653766618575, 'psi': 0.694164807161435}-{'f1_val': 0.8148589539555019, 'auprc': 0.9013219916059754, 'loss_val': 0.4427828908054501, 'psi': 0.8494441690156913}
[S3] START round=14 head_norm_before_train=1.623248 (no previous merge yet)
[S3] round=14 local utility u=0.005108 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9956960335846133, 'loss_val': 0.2594692329168793, 'psi': 0.818780150879919}-{'f1_val': 0.700330919019862, 'auprc': 0.995857891348907, 'loss_val': 0.26713928283877, 'psi': 0.8185417079514801}
[S4] START round=14 head_norm_before_train=0.972776 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.007958 metrics={'f1_val': 0.9503678294975163, 'auprc': 0.9532514380452547, 'loss_val': 0.3803087380369135, 'psi': 0.9515212729166117}-{'f1_val': 0.9530457273091739, 'auprc': 0.9557255297326034, 'loss_val': 0.4197141530973109, 'psi': 0.9541176482785457}
[S5] START round=14 head_norm_before_train=1.552137 (no previous merge yet)
[S5] round=14 local utility u=0.028966 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.664325115935509, 'loss_val': 0.3566222324294179, 'psi': 0.6860720072039692}-{'f1_val': 0.7005691551769304, 'auprc': 0.6616246749054908, 'loss_val': 0.40644870186162224, 'psi': 0.6849913630683546}
[S6] START round=14 head_norm_before_train=1.698313 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.7672804524748362, 'auprc': 0.7729339943914282, 'loss_val': 0.5123352792665627, 'psi': 0.769541869241473}-{'f1_val': 0.8099511687440367, 'auprc': 0.8191468516435281, 'loss_val': 0.3846837356918541, 'psi': 0.8136294419038332}
[S7] START round=14 head_norm_before_train=1.509386 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4492577348601068, 'auprc': 0.7792199076401455, 'loss_val': 0.8874989987597951, 'psi': 0.5812426039721224}-{'f1_val': 0.554668929364245, 'auprc': 0.7797731738403333, 'loss_val': 0.7427011986828708, 'psi': 0.6447106271546803}
[S8] START round=14 head_norm_before_train=1.115498 cos_to_last_merge=0.9884 (last merge round=11)
[S8] round=14 local utility u=0.912408 metrics={'f1_val': 0.9944076404752983, 'auprc': 0.9980929543322694, 'loss_val': 0.21993533239466312, 'psi': 0.9958817660180868}-{'f1_val': 0.7060686964708273, 'auprc': 0.9857594428353281, 'loss_val': 0.2777165270599562, 'psi': 0.8179449950166277}
[S9] START round=14 head_norm_before_train=0.984823 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982070172480315, 'loss_val': 0.48721092800413685, 'psi': 0.8200570970237506}-{'f1_val': 0.7012904835408967, 'auprc': 0.997958200639724, 'loss_val': 0.37096211167382387, 'psi': 0.8199575703804276}
[S10] START round=14 head_norm_before_train=1.490269 cos_to_last_merge=0.9995 (last merge round=12)
[S10] round=14 local utility u=0.086999 metrics={'f1_val': 0.9924177930491953, 'auprc': 0.9976753787441264, 'loss_val': 0.17810597355812335, 'psi': 0.9945208273271677}-{'f1_val': 0.9813059898989643, 'auprc': 0.9862924265166106, 'loss_val': 0.25128438907864603, 'psi': 0.9833005645460229}
[S11] START round=14 head_norm_before_train=1.313702 cos_to_last_merge=0.8161 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.816
[S11] round=14 local utility u=0.007371 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9985733508594281, 'loss_val': 0.2824602198103754, 'psi': 0.8205905303227633}-{'f1_val': 0.7019353166316534, 'auprc': 0.9986820945161057, 'loss_val': 0.29752841840114125, 'psi': 0.8206340277854343}
[S13] START round=14 head_norm_before_train=0.927453 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5989281521243636, 'auprc': 0.5381723689176894, 'loss_val': 0.8497174660369949, 'psi': 0.5746258388416938}-{'f1_val': 0.6204290995808712, 'auprc': 0.5978916020605017, 'loss_val': 0.7070972871451267, 'psi': 0.6114141005727234}
[S14] START round=14 head_norm_before_train=1.226925 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.018498 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9915770477796537, 'loss_val': 0.6565563194940442, 'psi': 0.6345869811406187}-{'f1_val': 0.39621953074959476, 'auprc': 0.9896404714414189, 'loss_val': 0.6854972175134424, 'psi': 0.6335879070263244}
[S15] START round=14 head_norm_before_train=1.578189 cos_to_last_merge=0.7989 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.799
[S15] round=14 local utility u=0.102626 metrics={'f1_val': 0.6981149461912491, 'auprc': 0.8914661273505016, 'loss_val': 0.4104437355014747, 'psi': 0.77545541865495}-{'f1_val': 0.6945896212251824, 'auprc': 0.8459486068795498, 'loss_val': 0.45799023925061894, 'psi': 0.7551332154869294}
[S16] START round=14 head_norm_before_train=1.036003 cos_to_last_merge=0.9947 (last merge round=11)
[S16] round=14 local utility u=0.435193 metrics={'f1_val': 0.5285761869475063, 'auprc': 0.7854919649787024, 'loss_val': 0.7720695562103662, 'psi': 0.6313424981599848}-{'f1_val': 0.41044725298515244, 'auprc': 0.7448221221598992, 'loss_val': 0.8116725193564439, 'psi': 0.5441972006550512}
[S17] START round=14 head_norm_before_train=1.346647 cos_to_last_merge=0.8484 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.848
[S17] round=14 local utility u=0.205600 metrics={'f1_val': 0.3914104769082568, 'auprc': 0.8224121253596341, 'loss_val': 0.8723556262925964, 'psi': 0.5638111362888077}-{'f1_val': 0.3699645132463034, 'auprc': 0.7890161803068934, 'loss_val': 1.0546910399515288, 'psi': 0.5375851800705395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.635)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.821)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S5] not sending this round → trigger blocked (psi=0.686)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:40409
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S16
[S8] cosine check vs S16: cos=0.8784
[S4] RECEIVED delta(kind=head bytes=1800) from S3
[S4] cosine check vs S3: cos=0.5113
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=0.8385
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=-0.0308
[S14] DROPPED delta from S10 (cos=-0.0308 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=0.2948
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.2792
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7013 head_norm=1.021998
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.218308e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7013 head_norm=0.792874 delta_norm=0.521831
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9944 head_norm=1.164368
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.793212e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9947 head_norm=1.083786 delta_norm=0.279321
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9504 head_norm=1.057963
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.179140e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9500 head_norm=1.187098 delta_norm=0.717914
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5286 head_norm=1.072134
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.616609e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.6653 head_norm=1.289998 delta_norm=0.461661
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.815129 (no previous merge yet)
[S2] round=15 local utility u=1.000000 metrics={'f1_val': 0.9092309133057468, 'auprc': 0.857899616817793, 'loss_val': 0.3104654374999976, 'psi': 0.8886983947105653}-{'f1_val': 0.5953246149904097, 'auprc': 0.8424250954179731, 'loss_val': 0.41136653766618575, 'psi': 0.694164807161435}
[S3] START round=15 head_norm_before_train=1.652247 (no previous merge yet)
[S3] round=15 local utility u=0.034140 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.997103389975684, 'loss_val': 0.19385630622208172, 'psi': 0.8191875373780431}-{'f1_val': 0.7008362290767893, 'auprc': 0.9956960335846133, 'loss_val': 0.2594692329168793, 'psi': 0.818780150879919}
[S4] START round=15 head_norm_before_train=1.187098 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9505851853826102, 'auprc': 0.9320644924595834, 'loss_val': 0.44398493662281163, 'psi': 0.9431769082133994}-{'f1_val': 0.9503678294975163, 'auprc': 0.9532514380452547, 'loss_val': 0.3803087380369135, 'psi': 0.9515212729166117}
[S5] START round=15 head_norm_before_train=1.574459 (no previous merge yet)
[S5] round=15 local utility u=0.159336 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.7764276777212942, 'loss_val': 0.3759754695718445, 'psi': 0.7310848646244443}-{'f1_val': 0.7005699347162762, 'auprc': 0.664325115935509, 'loss_val': 0.3566222324294179, 'psi': 0.6860720072039692}
[S6] START round=15 head_norm_before_train=1.728648 (no previous merge yet)
[S6] round=15 local utility u=0.857706 metrics={'f1_val': 0.9302365366997964, 'auprc': 0.9370760866109218, 'loss_val': 0.26708569695910805, 'psi': 0.9329723566642466}-{'f1_val': 0.7672804524748362, 'auprc': 0.7729339943914282, 'loss_val': 0.5123352792665627, 'psi': 0.769541869241473}
[S7] START round=15 head_norm_before_train=1.528003 (no previous merge yet)
[S7] round=15 local utility u=0.525769 metrics={'f1_val': 0.593823832980731, 'auprc': 0.782797944753389, 'loss_val': 0.7140917233243855, 'psi': 0.6694134776897942}-{'f1_val': 0.4492577348601068, 'auprc': 0.7792199076401455, 'loss_val': 0.8874989987597951, 'psi': 0.5812426039721224}
[S8] START round=15 head_norm_before_train=1.083786 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.7939374319829582, 'loss_val': 0.48365831258537156, 'psi': 0.745985201577452}-{'f1_val': 0.9944076404752983, 'auprc': 0.9980929543322694, 'loss_val': 0.21993533239466312, 'psi': 0.9958817660180868}
[S9] START round=15 head_norm_before_train=0.792874 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.033349 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9988398926604822, 'loss_val': 0.42241090321940955, 'psi': 0.8203102471887309}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982070172480315, 'loss_val': 0.48721092800413685, 'psi': 0.8200570970237506}
[S10] START round=15 head_norm_before_train=1.520609 cos_to_last_merge=0.9979 (last merge round=12)
[S10] round=15 local utility u=0.005422 metrics={'f1_val': 0.9953300781987324, 'auprc': 0.9943871440011172, 'loss_val': 0.17487012434638952, 'psi': 0.9949529045196863}-{'f1_val': 0.9924177930491953, 'auprc': 0.9976753787441264, 'loss_val': 0.17810597355812335, 'psi': 0.9945208273271677}
[S11] START round=15 head_norm_before_train=1.350075 cos_to_last_merge=0.8092 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.809
[S11] round=15 local utility u=0.005509 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9985884263653544, 'loss_val': 0.2714882321969466, 'psi': 0.8205965605251337}-{'f1_val': 0.7019353166316534, 'auprc': 0.9985733508594281, 'loss_val': 0.2824602198103754, 'psi': 0.8205905303227633}
[S13] START round=15 head_norm_before_train=0.983668 cos_to_last_merge=0.9955 (last merge round=13)
[S13] round=15 local utility u=0.120463 metrics={'f1_val': 0.5796474123399342, 'auprc': 0.6626344647440787, 'loss_val': 0.8664939153949532, 'psi': 0.612842233301592}-{'f1_val': 0.5989281521243636, 'auprc': 0.5381723689176894, 'loss_val': 0.8497174660369949, 'psi': 0.5746258388416938}
[S14] START round=15 head_norm_before_train=1.248315 cos_to_last_merge=0.9991 (last merge round=13)
[S14] round=15 local utility u=0.001013 metrics={'f1_val': 0.3963900194967479, 'auprc': 0.9873252497412873, 'loss_val': 0.640553927505398, 'psi': 0.6327641115945637}-{'f1_val': 0.39659360338126215, 'auprc': 0.9915770477796537, 'loss_val': 0.6565563194940442, 'psi': 0.6345869811406187}
[S15] START round=15 head_norm_before_train=1.613995 cos_to_last_merge=0.7937 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.794
[S15] round=15 local utility u=1.000000 metrics={'f1_val': 0.9928774866222313, 'auprc': 0.9959672203708845, 'loss_val': 0.07179751908460526, 'psi': 0.9941133801216926}-{'f1_val': 0.6981149461912491, 'auprc': 0.8914661273505016, 'loss_val': 0.4104437355014747, 'psi': 0.77545541865495}
[S16] START round=15 head_norm_before_train=1.289998 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.8320404493474911, 'auprc': 0.8207645975402239, 'loss_val': 0.6612241396430354, 'psi': 0.8275301086245842}-{'f1_val': 0.5285761869475063, 'auprc': 0.7854919649787024, 'loss_val': 0.7720695562103662, 'psi': 0.6313424981599848}
[S17] START round=15 head_norm_before_train=1.380464 cos_to_last_merge=0.8434 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.843
[S17] round=15 local utility u=0.177497 metrics={'f1_val': 0.4038696279214873, 'auprc': 0.8480464783719239, 'loss_val': 0.6690194092656918, 'psi': 0.581540368101662}-{'f1_val': 0.3914104769082568, 'auprc': 0.8224121253596341, 'loss_val': 0.8723556262925964, 'psi': 0.5638111362888077}
[S16] not sending this round → trigger blocked (psi=0.828)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:40404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:40412
[S15] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:40411
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:40410
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=-0.0018
[S11] DROPPED delta from S6 (cos=-0.0018 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=0.1845
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.9775
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0234
[S8] DROPPED delta from S2 (cos=-0.0234 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S9
[S13] cosine check vs S9: cos=0.7479
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=0.9717
[S4] RECEIVED delta(kind=head bytes=1803) from S14
[S4] cosine check vs S14: cos=0.3881
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.5185
[S17] not sending this round → trigger blocked (psi=0.582)
[S8] ⇄ pheromone p=0.247 → S17@127.0.0.1:40417
[S15] ⇄ pheromone p=0.338 → S16@127.0.0.1:40416
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9506 head_norm=1.235974
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.934850e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9512 head_norm=1.044309 delta_norm=0.693485
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.114 → S9@127.0.0.1:40410
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9953 head_norm=1.571220
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.857216e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9953 head_norm=1.546504 delta_norm=0.185722
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.167 → S14@127.0.0.1:40414
[S3] ⇄ pheromone p=0.169 → S4@127.0.0.1:40404
[S11] ⇄ pheromone p=0.135 → S14@127.0.0.1:40414
[S5] ⇄ pheromone p=0.164 → S9@127.0.0.1:40410
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.5796 head_norm=1.047744
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.493429e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.5758 head_norm=0.888045 delta_norm=0.349343
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.144 → S16@127.0.0.1:40416
[S7] ⇄ pheromone p=0.321 → S10@127.0.0.1:40411
[S6] ⇄ pheromone p=0.339 → S11@127.0.0.1:40412
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7013 head_norm=0.850624
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.817842e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7013 head_norm=1.080742 delta_norm=0.681784
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.099 → S13@127.0.0.1:40413
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.3964 head_norm=1.270974
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.509689e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.6920 head_norm=1.318749 delta_norm=0.150969
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.104 → S4@127.0.0.1:40404
[S2] ⇄ pheromone p=0.349 → S8@127.0.0.1:40409
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.8320 head_norm=1.319565
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.630250e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.8103 head_norm=0.915042 delta_norm=0.763025
[S16] aggregate: ROLLBACK (f1_val pre=0.832 post=0.810 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.401 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.140 → S9@127.0.0.1:40410
[S2] START round=16 head_norm_before_train=1.836816 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6515373418622948, 'auprc': 0.8404005218404497, 'loss_val': 0.45602377320910115, 'psi': 0.7270826138535569}-{'f1_val': 0.9092309133057468, 'auprc': 0.857899616817793, 'loss_val': 0.3104654374999976, 'psi': 0.8886983947105653}
[S3] START round=16 head_norm_before_train=1.675255 (no previous merge yet)
[S3] round=16 local utility u=0.003988 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9986799274431324, 'loss_val': 0.1916858842762578, 'psi': 0.8199256932184327}-{'f1_val': 0.7005769689796157, 'auprc': 0.997103389975684, 'loss_val': 0.19385630622208172, 'psi': 0.8191875373780431}
[S4] START round=16 head_norm_before_train=1.044309 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9393883168279343, 'auprc': 0.9314473248304749, 'loss_val': 0.3880412023536868, 'psi': 0.9362119200289506}-{'f1_val': 0.9505851853826102, 'auprc': 0.9320644924595834, 'loss_val': 0.44398493662281163, 'psi': 0.9431769082133994}
[S5] START round=16 head_norm_before_train=1.594398 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.6644600097581954, 'loss_val': 0.3282744098716386, 'psi': 0.6862981739927974}-{'f1_val': 0.7008563225598777, 'auprc': 0.7764276777212942, 'loss_val': 0.3759754695718445, 'psi': 0.7310848646244443}
[S6] START round=16 head_norm_before_train=1.751670 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.615052135008518, 'auprc': 0.7684416940812139, 'loss_val': 0.7564100185683159, 'psi': 0.6764079586375964}-{'f1_val': 0.9302365366997964, 'auprc': 0.9370760866109218, 'loss_val': 0.26708569695910805, 'psi': 0.9329723566642466}
[S7] START round=16 head_norm_before_train=1.543892 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5398861913137022, 'auprc': 0.7804398152790345, 'loss_val': 0.7962752665090803, 'psi': 0.6361076408998352}-{'f1_val': 0.593823832980731, 'auprc': 0.782797944753389, 'loss_val': 0.7140917233243855, 'psi': 0.6694134776897942}
[S8] START round=16 head_norm_before_train=1.130214 cos_to_last_merge=0.9983 (last merge round=14)
[S8] round=16 local utility u=0.408355 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9962967217688445, 'loss_val': 0.27402657534053826, 'psi': 0.8269289174918064}-{'f1_val': 0.7140170479737811, 'auprc': 0.7939374319829582, 'loss_val': 0.48365831258537156, 'psi': 0.745985201577452}
[S9] START round=16 head_norm_before_train=1.080742 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.993256582463528, 'loss_val': 0.4796032081103805, 'psi': 0.8180769231099493}-{'f1_val': 0.7012904835408967, 'auprc': 0.9988398926604822, 'loss_val': 0.42241090321940955, 'psi': 0.8203102471887309}
[S10] START round=16 head_norm_before_train=1.546504 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.022719 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9980091725767303, 'loss_val': 0.14147380241306654, 'psi': 0.9965192139851592}-{'f1_val': 0.9953300781987324, 'auprc': 0.9943871440011172, 'loss_val': 0.17487012434638952, 'psi': 0.9949529045196863}
[S11] START round=16 head_norm_before_train=1.381451 cos_to_last_merge=0.8041 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.804
[S11] round=16 local utility u=0.005125 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9984876959451091, 'loss_val': 0.26093614120072883, 'psi': 0.8205562683570358}-{'f1_val': 0.7019353166316534, 'auprc': 0.9985884263653544, 'loss_val': 0.2714882321969466, 'psi': 0.8205965605251337}
[S13] START round=16 head_norm_before_train=0.888045 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.045008 metrics={'f1_val': 0.6053536167731453, 'auprc': 0.6255111508427615, 'loss_val': 0.8193450666411032, 'psi': 0.6134166304009918}-{'f1_val': 0.5796474123399342, 'auprc': 0.6626344647440787, 'loss_val': 0.8664939153949532, 'psi': 0.612842233301592}
[S14] START round=16 head_norm_before_train=1.318749 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.708933 metrics={'f1_val': 0.6240549746107364, 'auprc': 0.9916294379274523, 'loss_val': 0.6015901366992421, 'psi': 0.7710847599374229}-{'f1_val': 0.3963900194967479, 'auprc': 0.9873252497412873, 'loss_val': 0.640553927505398, 'psi': 0.6327641115945637}
[S15] START round=16 head_norm_before_train=1.641410 cos_to_last_merge=0.7894 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.789
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.8156575391112507, 'auprc': 0.9920538943723248, 'loss_val': 0.277917261944906, 'psi': 0.8862160812156803}-{'f1_val': 0.9928774866222313, 'auprc': 0.9959672203708845, 'loss_val': 0.07179751908460526, 'psi': 0.9941133801216926}
[S16] START round=16 head_norm_before_train=0.915042 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.7930347220501384, 'auprc': 0.8647491860774256, 'loss_val': 0.6730513636306983, 'psi': 0.8217205076610532}-{'f1_val': 0.8320404493474911, 'auprc': 0.8207645975402239, 'loss_val': 0.6612241396430354, 'psi': 0.8275301086245842}
[S17] START round=16 head_norm_before_train=1.411483 cos_to_last_merge=0.8381 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=16 local utility u=0.095748 metrics={'f1_val': 0.41739979515859066, 'auprc': 0.8553350683564306, 'loss_val': 0.5805705828547163, 'psi': 0.5925739044377266}-{'f1_val': 0.4038696279214873, 'auprc': 0.8480464783719239, 'loss_val': 0.6690194092656918, 'psi': 0.581540368101662}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.821)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S13] not sending this round → trigger blocked (psi=0.613)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:40417
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:40414
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.771)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=-0.0683
[S17] DROPPED delta from S8 (cos=-0.0683 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S3
[S4] cosine check vs S3: cos=0.5277
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=-0.0373
[S14] DROPPED delta from S10 (cos=-0.0373 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] cosine check vs S17: cos=0.2448
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9394 head_norm=1.110730
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.302694e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9392 head_norm=1.237082 delta_norm=0.730269
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7013 head_norm=1.113359
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.938222e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7013 head_norm=1.010816 delta_norm=0.793822
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.860117 (no previous merge yet)
[S2] round=17 local utility u=0.849187 metrics={'f1_val': 0.9092866997601848, 'auprc': 0.8409234490155654, 'loss_val': 0.3057148290866324, 'psi': 0.8819413994623371}-{'f1_val': 0.6515373418622948, 'auprc': 0.8404005218404497, 'loss_val': 0.45602377320910115, 'psi': 0.7270826138535569}
[S3] START round=17 head_norm_before_train=1.701062 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.6798088382197569, 'auprc': 0.9973185930168037, 'loss_val': 0.27290082757724426, 'psi': 0.8068127401385756}-{'f1_val': 0.7007562037352997, 'auprc': 0.9986799274431324, 'loss_val': 0.1916858842762578, 'psi': 0.8199256932184327}
[S4] START round=17 head_norm_before_train=1.237082 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9389925586462937, 'auprc': 0.8830160425646054, 'loss_val': 0.41057847374833834, 'psi': 0.9166019522136184}-{'f1_val': 0.9393883168279343, 'auprc': 0.9314473248304749, 'loss_val': 0.3880412023536868, 'psi': 0.9362119200289506}
[S5] START round=17 head_norm_before_train=1.615835 (no previous merge yet)
[S5] round=17 local utility u=0.016569 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.6736258443257495, 'loss_val': 0.3211460400155206, 'psi': 0.6898157941337683}-{'f1_val': 0.7008569501491988, 'auprc': 0.6644600097581954, 'loss_val': 0.3282744098716386, 'psi': 0.6862981739927974}
[S6] START round=17 head_norm_before_train=1.767809 (no previous merge yet)
[S6] round=17 local utility u=0.215501 metrics={'f1_val': 0.6439518266550854, 'auprc': 0.8008196562725793, 'loss_val': 0.5959390951026382, 'psi': 0.7066989585020831}-{'f1_val': 0.615052135008518, 'auprc': 0.7684416940812139, 'loss_val': 0.7564100185683159, 'psi': 0.6764079586375964}
[S7] START round=17 head_norm_before_train=1.556264 (no previous merge yet)
[S7] round=17 local utility u=0.587616 metrics={'f1_val': 0.6659198371802499, 'auprc': 0.8203473990189307, 'loss_val': 0.4969687887708357, 'psi': 0.7276908619157223}-{'f1_val': 0.5398861913137022, 'auprc': 0.7804398152790345, 'loss_val': 0.7962752665090803, 'psi': 0.6361076408998352}
[S8] START round=17 head_norm_before_train=1.180665 cos_to_last_merge=0.9939 (last merge round=14)
[S8] round=17 local utility u=0.892870 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9980733067366946, 'loss_val': 0.17371872371198574, 'psi': 0.9956498498392532}-{'f1_val': 0.7140170479737811, 'auprc': 0.9962967217688445, 'loss_val': 0.27402657534053826, 'psi': 0.8269289174918064}
[S9] START round=17 head_norm_before_train=1.010816 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.038783 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9980262159596239, 'loss_val': 0.41634620162612845, 'psi': 0.8199847765083876}-{'f1_val': 0.7012904835408967, 'auprc': 0.993256582463528, 'loss_val': 0.4796032081103805, 'psi': 0.8180769231099493}
[S10] START round=17 head_norm_before_train=1.593810 cos_to_last_merge=0.9988 (last merge round=15)
[S10] round=17 local utility u=0.023128 metrics={'f1_val': 0.9949949984746631, 'auprc': 0.9980601766560825, 'loss_val': 0.0921861676554929, 'psi': 0.9962210697472309}-{'f1_val': 0.9955259082574451, 'auprc': 0.9980091725767303, 'loss_val': 0.14147380241306654, 'psi': 0.9965192139851592}
[S11] START round=17 head_norm_before_train=1.409549 cos_to_last_merge=0.8008 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.801
[S11] round=17 local utility u=0.004029 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9985815374927214, 'loss_val': 0.2531592857186172, 'psi': 0.8205938049760806}-{'f1_val': 0.7019353166316534, 'auprc': 0.9984876959451091, 'loss_val': 0.26093614120072883, 'psi': 0.8205562683570358}
[S13] START round=17 head_norm_before_train=0.947687 cos_to_last_merge=0.9943 (last merge round=15)
[S13] round=17 local utility u=0.074792 metrics={'f1_val': 0.61628975387014, 'auprc': 0.6246956064171965, 'loss_val': 0.7329305678313546, 'psi': 0.6196520948889626}-{'f1_val': 0.6053536167731453, 'auprc': 0.6255111508427615, 'loss_val': 0.8193450666411032, 'psi': 0.6134166304009918}
[S14] START round=17 head_norm_before_train=1.343014 cos_to_last_merge=0.9992 (last merge round=15)
[S14] round=17 local utility u=0.214570 metrics={'f1_val': 0.6912030863054826, 'auprc': 0.9910662954403879, 'loss_val': 0.5736493829025406, 'psi': 0.8111483699594447}-{'f1_val': 0.6240549746107364, 'auprc': 0.9916294379274523, 'loss_val': 0.6015901366992421, 'psi': 0.7710847599374229}
[S15] START round=17 head_norm_before_train=1.672288 cos_to_last_merge=0.7870 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.787
[S15] round=17 local utility u=0.359572 metrics={'f1_val': 0.9082245633782856, 'auprc': 0.9931058870863096, 'loss_val': 0.11733122678567755, 'psi': 0.9421770928614952}-{'f1_val': 0.8156575391112507, 'auprc': 0.9920538943723248, 'loss_val': 0.277917261944906, 'psi': 0.8862160812156803}
[S16] START round=17 head_norm_before_train=0.955314 cos_to_last_merge=0.9979 (last merge round=15)
[S16] round=17 local utility u=0.165192 metrics={'f1_val': 0.8286629248547857, 'auprc': 0.9112689836935746, 'loss_val': 0.6959960416513333, 'psi': 0.8617053483903012}-{'f1_val': 0.7930347220501384, 'auprc': 0.8647491860774256, 'loss_val': 0.6730513636306983, 'psi': 0.8217205076610532}
[S17] START round=17 head_norm_before_train=1.436745 cos_to_last_merge=0.8333 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.833
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.4171404173081712, 'auprc': 0.857824295451002, 'loss_val': 0.5937891572968985, 'psi': 0.5934139685653035}-{'f1_val': 0.41739979515859066, 'auprc': 0.8553350683564306, 'loss_val': 0.5805705828547163, 'psi': 0.5925739044377266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:40416
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:40413
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:40411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:40404
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=-0.0282
[S8] DROPPED delta from S2 (cos=-0.0282 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] cosine check vs S16: cos=0.8410
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] cosine check vs S9: cos=0.6907
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=0.9750
[S4] RECEIVED delta(kind=head bytes=1798) from S14
[S4] cosine check vs S14: cos=0.3911
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.4897
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=-0.0018
[S11] DROPPED delta from S6 (cos=-0.0018 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=0.6633
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=0.7212
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.9852
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9390 head_norm=1.292066
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.338442e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9390 head_norm=1.108474 delta_norm=0.733844
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9950 head_norm=1.651125
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.844950e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9944 head_norm=1.600036 delta_norm=0.184495
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9940 head_norm=1.225330
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.315908e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9937 head_norm=1.074917 delta_norm=0.331591
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.7013 head_norm=1.050543
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.248327e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.7013 head_norm=1.169633 delta_norm=0.724833
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.6912 head_norm=1.365669
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.252124e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.6916 head_norm=1.394479 delta_norm=0.125212
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6163 head_norm=1.012542
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.060160e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6065 head_norm=0.948468 delta_norm=0.406016
[S13] aggregate: ROLLBACK (f1_val pre=0.616 post=0.606 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8287 head_norm=1.014577
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.815606e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8245 head_norm=0.998678 delta_norm=0.181561
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.878811 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.886941910504118, 'auprc': 0.8466446485722618, 'loss_val': 0.2599761262669548, 'psi': 0.8708230057313755}-{'f1_val': 0.9092866997601848, 'auprc': 0.8409234490155654, 'loss_val': 0.3057148290866324, 'psi': 0.8819413994623371}
[S3] START round=18 head_norm_before_train=1.722931 (no previous merge yet)
[S3] round=18 local utility u=0.824958 metrics={'f1_val': 0.9410040235215229, 'auprc': 0.9974011630104546, 'loss_val': 0.19040396638649007, 'psi': 0.9635628793170955}-{'f1_val': 0.6798088382197569, 'auprc': 0.9973185930168037, 'loss_val': 0.27290082757724426, 'psi': 0.8068127401385756}
[S4] START round=18 head_norm_before_train=1.108474 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.075591 metrics={'f1_val': 0.9419714196820639, 'auprc': 0.9060845858248907, 'loss_val': 0.34647593308579167, 'psi': 0.9276166861391946}-{'f1_val': 0.9389925586462937, 'auprc': 0.8830160425646054, 'loss_val': 0.41057847374833834, 'psi': 0.9166019522136184}
[S5] START round=18 head_norm_before_train=1.638050 (no previous merge yet)
[S5] round=18 local utility u=0.069243 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7230022920114261, 'loss_val': 0.3307861681267056, 'psi': 0.709565952402175}-{'f1_val': 0.7006090940057808, 'auprc': 0.6736258443257495, 'loss_val': 0.3211460400155206, 'psi': 0.6898157941337683}
[S6] START round=18 head_norm_before_train=1.774133 (no previous merge yet)
[S6] round=18 local utility u=0.746349 metrics={'f1_val': 0.8107136579172654, 'auprc': 0.8936870934850051, 'loss_val': 0.3824135382757842, 'psi': 0.8439030321443612}-{'f1_val': 0.6439518266550854, 'auprc': 0.8008196562725793, 'loss_val': 0.5959390951026382, 'psi': 0.7066989585020831}
[S7] START round=18 head_norm_before_train=1.569107 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.42851476658438986, 'auprc': 0.7785895744127795, 'loss_val': 0.9702319884067933, 'psi': 0.5685446897157458}-{'f1_val': 0.6659198371802499, 'auprc': 0.8203473990189307, 'loss_val': 0.4969687887708357, 'psi': 0.7276908619157223}
[S8] START round=18 head_norm_before_train=1.074917 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.992056363747547, 'loss_val': 0.24550280267797703, 'psi': 0.9933561276702413}-{'f1_val': 0.9940342119076258, 'auprc': 0.9980733067366946, 'loss_val': 0.17371872371198574, 'psi': 0.9956498498392532}
[S9] START round=18 head_norm_before_train=1.169633 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9955527162687197, 'loss_val': 0.43244564579935013, 'psi': 0.8189953766320259}-{'f1_val': 0.7012904835408967, 'auprc': 0.9980262159596239, 'loss_val': 0.41634620162612845, 'psi': 0.8199847765083876}
[S10] START round=18 head_norm_before_train=1.600036 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9950211272454115, 'loss_val': 0.11739770163836862, 'psi': 0.9951211543097894}-{'f1_val': 0.9949949984746631, 'auprc': 0.9980601766560825, 'loss_val': 0.0921861676554929, 'psi': 0.9962210697472309}
[S11] START round=18 head_norm_before_train=1.433683 cos_to_last_merge=0.7969 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.797
[S11] round=18 local utility u=0.005364 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9983889295775963, 'loss_val': 0.24185393085651755, 'psi': 0.8205167618100306}-{'f1_val': 0.7019353166316534, 'auprc': 0.9985815374927214, 'loss_val': 0.2531592857186172, 'psi': 0.8205938049760806}
[S13] START round=18 head_norm_before_train=0.948468 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5480049609218465, 'auprc': 0.5117121162768068, 'loss_val': 1.0067868943117384, 'psi': 0.5334878230638306}-{'f1_val': 0.61628975387014, 'auprc': 0.6246956064171965, 'loss_val': 0.7329305678313546, 'psi': 0.6196520948889626}
[S14] START round=18 head_norm_before_train=1.394479 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.032391 metrics={'f1_val': 0.6923177505287506, 'auprc': 0.9920848022954716, 'loss_val': 0.5186101673977304, 'psi': 0.812224571235439}-{'f1_val': 0.6912030863054826, 'auprc': 0.9910662954403879, 'loss_val': 0.5736493829025406, 'psi': 0.8111483699594447}
[S15] START round=18 head_norm_before_train=1.704795 cos_to_last_merge=0.7847 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.785
[S15] round=18 local utility u=0.241625 metrics={'f1_val': 0.9774005952312095, 'auprc': 0.997329511275866, 'loss_val': 0.061808344585046346, 'psi': 0.985372161649072}-{'f1_val': 0.9082245633782856, 'auprc': 0.9931058870863096, 'loss_val': 0.11733122678567755, 'psi': 0.9421770928614952}
[S16] START round=18 head_norm_before_train=0.998678 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.021590 metrics={'f1_val': 0.8303092164578746, 'auprc': 0.9210399192179938, 'loss_val': 0.6920066313456189, 'psi': 0.8666014975619223}-{'f1_val': 0.8286629248547857, 'auprc': 0.9112689836935746, 'loss_val': 0.6959960416513333, 'psi': 0.8617053483903012}
[S17] START round=18 head_norm_before_train=1.466660 cos_to_last_merge=0.8282 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=18 local utility u=0.668722 metrics={'f1_val': 0.6565799078392265, 'auprc': 0.8462137366368653, 'loss_val': 0.6581494398838925, 'psi': 0.7324334393582821}-{'f1_val': 0.4171404173081712, 'auprc': 0.857824295451002, 'loss_val': 0.5937891572968985, 'psi': 0.5934139685653035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:40416
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:40410
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:40404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:40414
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.9923
[S4] RECEIVED delta(kind=head bytes=1803) from S14
[S4] cosine check vs S14: cos=0.8231
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] cosine check vs S6: cos=-0.0031
[S11] DROPPED delta from S6 (cos=-0.0031 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] cosine check vs S16: cos=0.9304
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=0.8085
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=0.5181
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] cosine check vs S4: cos=0.0964
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9048
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] cosine check vs S17: cos=0.3742
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.7013 head_norm=1.197563
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.585536e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7013 head_norm=0.958389 delta_norm=0.358554
[S9] aggregate: ACCEPT kept=['S4', 'S5', 'S17'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9942 head_norm=1.124645
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.062543e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9942 head_norm=1.074692 delta_norm=0.206254
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.6923 head_norm=1.420362
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.097726e-02
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.6919 head_norm=1.435889 delta_norm=0.090977
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9420 head_norm=1.187162
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.338798e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9413 head_norm=1.133231 delta_norm=0.233880
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8303 head_norm=1.063100
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.378125e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8289 head_norm=1.334251 delta_norm=0.537812
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.897614 (no previous merge yet)
[S2] round=19 local utility u=0.065915 metrics={'f1_val': 0.9111777841998154, 'auprc': 0.8425339510577199, 'loss_val': 0.2612302605074118, 'psi': 0.8837202509429771}-{'f1_val': 0.886941910504118, 'auprc': 0.8466446485722618, 'loss_val': 0.2599761262669548, 'psi': 0.8708230057313755}
[S3] START round=19 head_norm_before_train=1.741419 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7510360311431236, 'auprc': 0.9988713665350964, 'loss_val': 0.17351069437741795, 'psi': 0.8501701652999127}-{'f1_val': 0.9410040235215229, 'auprc': 0.9974011630104546, 'loss_val': 0.19040396638649007, 'psi': 0.9635628793170955}
[S4] START round=19 head_norm_before_train=1.133231 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.020707 metrics={'f1_val': 0.9463714395933343, 'auprc': 0.9052891220041097, 'loss_val': 0.3290766191346251, 'psi': 0.9299385125576445}-{'f1_val': 0.9419714196820639, 'auprc': 0.9060845858248907, 'loss_val': 0.34647593308579167, 'psi': 0.9276166861391946}
[S5] START round=19 head_norm_before_train=1.656097 (no previous merge yet)
[S5] round=19 local utility u=0.251750 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8805447078547292, 'loss_val': 0.2999140913856652, 'psi': 0.7725829187394962}-{'f1_val': 0.7006083926626743, 'auprc': 0.7230022920114261, 'loss_val': 0.3307861681267056, 'psi': 0.709565952402175}
[S6] START round=19 head_norm_before_train=1.784243 (no previous merge yet)
[S6] round=19 local utility u=0.543792 metrics={'f1_val': 0.9452630074034919, 'auprc': 0.9433968973478752, 'loss_val': 0.25125529533545726, 'psi': 0.9445165633812451}-{'f1_val': 0.8107136579172654, 'auprc': 0.8936870934850051, 'loss_val': 0.3824135382757842, 'psi': 0.8439030321443612}
[S7] START round=19 head_norm_before_train=1.580192 (no previous merge yet)
[S7] round=19 local utility u=0.951783 metrics={'f1_val': 0.6495930831357045, 'auprc': 0.8197209180972997, 'loss_val': 0.5165294564383143, 'psi': 0.7176442171203425}-{'f1_val': 0.42851476658438986, 'auprc': 0.7785895744127795, 'loss_val': 0.9702319884067933, 'psi': 0.5685446897157458}
[S8] START round=19 head_norm_before_train=1.074692 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.992137462026031, 'auprc': 0.9840717203196933, 'loss_val': 0.26898049766828114, 'psi': 0.9889111653434959}-{'f1_val': 0.9942226369520374, 'auprc': 0.992056363747547, 'loss_val': 0.24550280267797703, 'psi': 0.9933561276702413}
[S9] START round=19 head_norm_before_train=0.958389 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.026375 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9980733574702093, 'loss_val': 0.3872570194483682, 'psi': 0.8200036331126218}-{'f1_val': 0.7012904835408967, 'auprc': 0.9955527162687197, 'loss_val': 0.43244564579935013, 'psi': 0.8189953766320259}
[S10] START round=19 head_norm_before_train=1.651772 cos_to_last_merge=0.9986 (last merge round=17)
[S10] round=19 local utility u=0.016608 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9964591478040778, 'loss_val': 0.08849591862752045, 'psi': 0.995696362533256}-{'f1_val': 0.9951878390193748, 'auprc': 0.9950211272454115, 'loss_val': 0.11739770163836862, 'psi': 0.9951211543097894}
[S11] START round=19 head_norm_before_train=1.456941 cos_to_last_merge=0.7936 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.794
[S11] round=19 local utility u=0.008101 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9985447231735514, 'loss_val': 0.22611994031985078, 'psi': 0.8205790792484127}-{'f1_val': 0.7019353166316534, 'auprc': 0.9983889295775963, 'loss_val': 0.24185393085651755, 'psi': 0.8205167618100306}
[S13] START round=19 head_norm_before_train=0.982247 cos_to_last_merge=0.9974 (last merge round=17)
[S13] round=19 local utility u=0.271249 metrics={'f1_val': 0.5483777696025961, 'auprc': 0.6689791242603075, 'loss_val': 0.938326388329197, 'psi': 0.5966183114656807}-{'f1_val': 0.5480049609218465, 'auprc': 0.5117121162768068, 'loss_val': 1.0067868943117384, 'psi': 0.5334878230638306}
[S14] START round=19 head_norm_before_train=1.435889 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.007771 metrics={'f1_val': 0.6912030863054826, 'auprc': 0.9917368852895133, 'loss_val': 0.49533571526964415, 'psi': 0.8114166058990948}-{'f1_val': 0.6923177505287506, 'auprc': 0.9920848022954716, 'loss_val': 0.5186101673977304, 'psi': 0.812224571235439}
[S15] START round=19 head_norm_before_train=1.734576 cos_to_last_merge=0.7828 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.783
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.758057561328623, 'auprc': 0.93172119213969, 'loss_val': 0.41276991654474726, 'psi': 0.8275230136530498}-{'f1_val': 0.9774005952312095, 'auprc': 0.997329511275866, 'loss_val': 0.061808344585046346, 'psi': 0.985372161649072}
[S16] START round=19 head_norm_before_train=1.334251 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.500047 metrics={'f1_val': 0.9277735702114803, 'auprc': 0.9388864808058361, 'loss_val': 0.3302387568930459, 'psi': 0.9322187344492227}-{'f1_val': 0.8303092164578746, 'auprc': 0.9210399192179938, 'loss_val': 0.6920066313456189, 'psi': 0.8666014975619223}
[S17] START round=19 head_norm_before_train=1.504969 cos_to_last_merge=0.8221 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.822
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6441286275048316, 'auprc': 0.8288385726882285, 'loss_val': 0.7522941024352413, 'psi': 0.7180126055781904}-{'f1_val': 0.6565799078392265, 'auprc': 0.8462137366368653, 'loss_val': 0.6581494398838925, 'psi': 0.7324334393582821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:40409
[S6] not sending this round → trigger blocked (psi=0.945)
[S4] not sending this round → trigger blocked (psi=0.930)
[S5] not sending this round → trigger blocked (psi=0.773)
[S14] not sending this round → trigger blocked (psi=0.811)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:40413
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.932)
[S11] not sending this round → trigger blocked (psi=0.821)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:40416
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=-0.0245
[S8] DROPPED delta from S2 (cos=-0.0245 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S9
[S13] cosine check vs S9: cos=0.7979
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=0.9770
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=0.2736
[S14] RECEIVED delta(kind=head bytes=1806) from S10
[S14] cosine check vs S10: cos=-0.0474
[S14] DROPPED delta from S10 (cos=-0.0474 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.945 u=0.5438 p_local=0.3947 f1=0.945 auprc=0.943 bytes=16156
[S15] r=20 psi=0.828 u=0.0000 p_local=0.2232 f1=0.758 auprc=0.932 bytes=17952
[S8] r=20 psi=0.989 u=0.0000 p_local=0.2574 f1=0.992 auprc=0.984 bytes=14351
[S3] r=20 psi=0.850 u=0.0000 p_local=0.2016 f1=0.751 auprc=0.999 bytes=18001
[S11] r=20 psi=0.821 u=0.0081 p_local=0.0589 f1=0.702 auprc=0.999 bytes=14395
[S4] r=20 psi=0.930 u=0.0207 p_local=0.0628 f1=0.946 auprc=0.905 bytes=16156
[S5] r=20 psi=0.773 u=0.2517 p_local=0.1305 f1=0.701 auprc=0.881 bytes=21558
[S14] r=20 psi=0.811 u=0.0078 p_local=0.1496 f1=0.691 auprc=0.992 bytes=19798
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.5484 head_norm=1.029225
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.229629e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.5350 head_norm=0.962533 delta_norm=0.322963
[S13] aggregate: ROLLBACK (f1_val pre=0.548 post=0.535 tol_abs=0.005 tol_rel=0.0)
[S13] r=20 psi=0.597 u=0.2712 p_local=0.1276 f1=0.548 auprc=0.669 bytes=16167
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9952 head_norm=1.701198
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.849519e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9952 head_norm=1.636635 delta_norm=0.184952
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.996 u=0.0166 p_local=0.0770 f1=0.995 auprc=0.996 bytes=16194
[S2] r=20 psi=0.884 u=0.0659 p_local=0.2648 f1=0.911 auprc=0.843 bytes=19780
[S7] r=20 psi=0.718 u=0.9518 p_local=0.3972 f1=0.650 auprc=0.820 bytes=19789
[S9] r=20 psi=0.820 u=0.0264 p_local=0.0506 f1=0.701 auprc=0.998 bytes=21565
[S17] r=20 psi=0.718 u=0.0000 p_local=0.1740 f1=0.644 auprc=0.829 bytes=14388
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9278 head_norm=1.392746
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.441040e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9284 head_norm=0.972539 delta_norm=0.744104
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.932 u=0.5000 p_local=0.2887 f1=0.928 auprc=0.939 bytes=16162
[S2] START round=20 head_norm_before_train=1.919327 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.8888634026660972, 'auprc': 0.8435552900947574, 'loss_val': 0.2786711851253453, 'psi': 0.8707401576375613}-{'f1_val': 0.9111777841998154, 'auprc': 0.8425339510577199, 'loss_val': 0.2612302605074118, 'psi': 0.8837202509429771}
[S3] START round=20 head_norm_before_train=1.763624 (no previous merge yet)
[S3] round=20 local utility u=0.558806 metrics={'f1_val': 0.9382674123128285, 'auprc': 0.9988715039268534, 'loss_val': 0.179286456597923, 'psi': 0.9625090489584385}-{'f1_val': 0.7510360311431236, 'auprc': 0.9988713665350964, 'loss_val': 0.17351069437741795, 'psi': 0.8501701652999127}
[S4] START round=20 head_norm_before_train=1.206268 cos_to_last_merge=0.9954 (last merge round=18)
[S4] round=20 local utility u=0.056292 metrics={'f1_val': 0.9437466562687973, 'auprc': 0.9391749516105177, 'loss_val': 0.30240043752224943, 'psi': 0.9419179744054854}-{'f1_val': 0.9463714395933343, 'auprc': 0.9052891220041097, 'loss_val': 0.3290766191346251, 'psi': 0.9299385125576445}
[S5] START round=20 head_norm_before_train=1.677906 (no previous merge yet)
[S5] round=20 local utility u=0.188051 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9914271502577536, 'loss_val': 0.2579508144764137, 'psi': 0.8170850301926207}-{'f1_val': 0.7006083926626743, 'auprc': 0.8805447078547292, 'loss_val': 0.2999140913856652, 'psi': 0.7725829187394962}
[S6] START round=20 head_norm_before_train=1.799486 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8662016756691897, 'auprc': 0.9360705229777769, 'loss_val': 0.31963598898369755, 'psi': 0.8941492145926246}-{'f1_val': 0.9452630074034919, 'auprc': 0.9433968973478752, 'loss_val': 0.25125529533545726, 'psi': 0.9445165633812451}
[S7] START round=20 head_norm_before_train=1.591065 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.3843194050140174, 'auprc': 0.7793586244300177, 'loss_val': 1.1574455649815858, 'psi': 0.5423350927804175}-{'f1_val': 0.6495930831357045, 'auprc': 0.8197209180972997, 'loss_val': 0.5165294564383143, 'psi': 0.7176442171203425}
[S8] START round=20 head_norm_before_train=1.130989 cos_to_last_merge=0.9962 (last merge round=18)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9335304723021269, 'auprc': 0.986472278315686, 'loss_val': 0.23401652499697342, 'psi': 0.9547071947075505}-{'f1_val': 0.992137462026031, 'auprc': 0.9840717203196933, 'loss_val': 0.26898049766828114, 'psi': 0.9889111653434959}
[S9] START round=20 head_norm_before_train=1.001123 cos_to_last_merge=0.9961 (last merge round=18)
[S9] round=20 local utility u=0.028352 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9980945727042749, 'loss_val': 0.3306169506256394, 'psi': 0.8200121192062481}-{'f1_val': 0.7012904835408967, 'auprc': 0.9980733574702093, 'loss_val': 0.3872570194483682, 'psi': 0.8200036331126218}
[S10] START round=20 head_norm_before_train=1.636635 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.006142 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9979770844114294, 'loss_val': 0.07812936565951187, 'psi': 0.9960399992961952}-{'f1_val': 0.9951878390193748, 'auprc': 0.9964591478040778, 'loss_val': 0.08849591862752045, 'psi': 0.995696362533256}
[S11] START round=20 head_norm_before_train=1.479060 cos_to_last_merge=0.7913 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.791
[S11] round=20 local utility u=0.771558 metrics={'f1_val': 0.9549338538164186, 'auprc': 0.9978494744246612, 'loss_val': 0.19890936534196102, 'psi': 0.9721001020597156}-{'f1_val': 0.7019353166316534, 'auprc': 0.9985447231735514, 'loss_val': 0.22611994031985078, 'psi': 0.8205790792484127}
[S13] START round=20 head_norm_before_train=0.962533 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5553308473837505, 'auprc': 0.5437959513509631, 'loss_val': 0.9619220875056148, 'psi': 0.5507168889706355}-{'f1_val': 0.5483777696025961, 'auprc': 0.6689791242603075, 'loss_val': 0.938326388329197, 'psi': 0.5966183114656807}
[S14] START round=20 head_norm_before_train=1.459324 cos_to_last_merge=0.9994 (last merge round=18)
[S14] round=20 local utility u=0.412654 metrics={'f1_val': 0.817342942207993, 'auprc': 0.9945949184848619, 'loss_val': 0.43544155016429537, 'psi': 0.8882437327187405}-{'f1_val': 0.6912030863054826, 'auprc': 0.9917368852895133, 'loss_val': 0.49533571526964415, 'psi': 0.8114166058990948}
[S15] START round=20 head_norm_before_train=1.757936 cos_to_last_merge=0.7813 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.781
[S15] round=20 local utility u=0.779989 metrics={'f1_val': 0.9321823854735708, 'auprc': 0.9937212372022265, 'loss_val': 0.08354036662293078, 'psi': 0.956797926165033}-{'f1_val': 0.758057561328623, 'auprc': 0.93172119213969, 'loss_val': 0.41276991654474726, 'psi': 0.8275230136530498}
[S16] START round=20 head_norm_before_train=0.972539 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8296909297016286, 'auprc': 0.9454930431362739, 'loss_val': 0.7229573015554988, 'psi': 0.8760117750754868}-{'f1_val': 0.9277735702114803, 'auprc': 0.9388864808058361, 'loss_val': 0.3302387568930459, 'psi': 0.9322187344492227}
[S17] START round=20 head_norm_before_train=1.540409 cos_to_last_merge=0.8169 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.6461933532063562, 'auprc': 0.8201387886995668, 'loss_val': 0.8380252957331554, 'psi': 0.7157715274036405}-{'f1_val': 0.6441286275048316, 'auprc': 0.8288385726882285, 'loss_val': 0.7522941024352413, 'psi': 0.7180126055781904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[S9] not sending this round → trigger blocked (psi=0.820)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:40410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S3
[S4] cosine check vs S3: cos=0.6293
[S4] RECEIVED delta(kind=head bytes=1799) from S14
[S4] cosine check vs S14: cos=0.7293
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.7665
[S9] RECEIVED delta(kind=head bytes=1795) from S4
[S9] cosine check vs S4: cos=0.3269
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=0.7395
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.9913
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.063 → S14@127.0.0.1:40414
[S13] ⇄ pheromone p=0.102 → S16@127.0.0.1:40416
[S7] ⇄ pheromone p=0.318 → S10@127.0.0.1:40411
[S2] ⇄ pheromone p=0.212 → S8@127.0.0.1:40409
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.7013 head_norm=1.050537
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.255244e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.7013 head_norm=1.003628 delta_norm=0.325524
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.046 → S13@127.0.0.1:40413
[S8] ⇄ pheromone p=0.206 → S17@127.0.0.1:40417
[S6] ⇄ pheromone p=0.316 → S11@127.0.0.1:40412
[S3] ⇄ pheromone p=0.273 → S4@127.0.0.1:40404
[S11] ⇄ pheromone p=0.201 → S14@127.0.0.1:40414
[S5] ⇄ pheromone p=0.142 → S9@127.0.0.1:40410
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.8173 head_norm=1.484711
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.903024e-02
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.8113 head_norm=1.490613 delta_norm=0.099030
[S14] aggregate: ROLLBACK (f1_val pre=0.817 post=0.811 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.202 → S4@127.0.0.1:40404
[S15] ⇄ pheromone p=0.335 → S16@127.0.0.1:40416
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9437 head_norm=1.267990
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.020803e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9437 head_norm=1.199742 delta_norm=0.202080
[S4] aggregate: ACCEPT kept=['S3', 'S14'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.061 → S9@127.0.0.1:40410
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8297 head_norm=1.024716
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.158941e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8281 head_norm=1.314082 delta_norm=0.615894
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.231 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.139 → S9@127.0.0.1:40410
[S2] START round=21 head_norm_before_train=1.941416 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.88532807666954, 'auprc': 0.8452291856772882, 'loss_val': 0.2683057014485634, 'psi': 0.8692885202726393}-{'f1_val': 0.8888634026660972, 'auprc': 0.8435552900947574, 'loss_val': 0.2786711851253453, 'psi': 0.8707401576375613}
[S3] START round=21 head_norm_before_train=1.784825 (no previous merge yet)
[S3] round=21 local utility u=0.222807 metrics={'f1_val': 0.997542018298261, 'auprc': 0.9992403733661877, 'loss_val': 0.0904266153464114, 'psi': 0.9982213603254315}-{'f1_val': 0.9382674123128285, 'auprc': 0.9988715039268534, 'loss_val': 0.179286456597923, 'psi': 0.9625090489584385}
[S4] START round=21 head_norm_before_train=1.199742 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9381980424908631, 'auprc': 0.8558018652178767, 'loss_val': 0.3348759742153782, 'psi': 0.9052395715816686}-{'f1_val': 0.9437466562687973, 'auprc': 0.9391749516105177, 'loss_val': 0.30240043752224943, 'psi': 0.9419179744054854}
[S5] START round=21 head_norm_before_train=1.697881 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.5807027300630825, 'auprc': 0.85380605640904, 'loss_val': 0.5187552125629712, 'psi': 0.6899440606014655}-{'f1_val': 0.7008569501491988, 'auprc': 0.9914271502577536, 'loss_val': 0.2579508144764137, 'psi': 0.8170850301926207}
[S6] START round=21 head_norm_before_train=1.819347 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.8033341632325344, 'auprc': 0.9303928262199607, 'loss_val': 0.4178873762228578, 'psi': 0.8541576284275049}-{'f1_val': 0.8662016756691897, 'auprc': 0.9360705229777769, 'loss_val': 0.31963598898369755, 'psi': 0.8941492145926246}
[S7] START round=21 head_norm_before_train=1.601176 (no previous merge yet)
[S7] round=21 local utility u=1.000000 metrics={'f1_val': 0.6704581513131036, 'auprc': 0.8376644548493386, 'loss_val': 0.43784244365044195, 'psi': 0.7373406727275976}-{'f1_val': 0.3843194050140174, 'auprc': 0.7793586244300177, 'loss_val': 1.1574455649815858, 'psi': 0.5423350927804175}
[S8] START round=21 head_norm_before_train=1.190629 cos_to_last_merge=0.9882 (last merge round=18)
[S8] round=21 local utility u=0.196536 metrics={'f1_val': 0.9887443014841408, 'auprc': 0.9831262583690268, 'loss_val': 0.16218943083351023, 'psi': 0.9864970842380951}-{'f1_val': 0.9335304723021269, 'auprc': 0.986472278315686, 'loss_val': 0.23401652499697342, 'psi': 0.9547071947075505}
[S9] START round=21 head_norm_before_train=1.003628 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.002000 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9987262443735403, 'loss_val': 0.3289563725871943, 'psi': 0.8203092983809217}-{'f1_val': 0.7012904835408967, 'auprc': 0.9980945727042749, 'loss_val': 0.3306169506256394, 'psi': 0.8200121192062481}
[S10] START round=21 head_norm_before_train=1.687360 cos_to_last_merge=0.9988 (last merge round=19)
[S10] round=21 local utility u=0.005848 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9963968053808361, 'loss_val': 0.0643273514524409, 'psi': 0.9956714255639593}-{'f1_val': 0.9947486092193725, 'auprc': 0.9979770844114294, 'loss_val': 0.07812936565951187, 'psi': 0.9960399992961952}
[S11] START round=21 head_norm_before_train=1.503030 cos_to_last_merge=0.7897 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.790
[S11] round=21 local utility u=0.021846 metrics={'f1_val': 0.9577957292568001, 'auprc': 0.9983476142087919, 'loss_val': 0.17388387299094105, 'psi': 0.9740164832375968}-{'f1_val': 0.9549338538164186, 'auprc': 0.9978494744246612, 'loss_val': 0.19890936534196102, 'psi': 0.9721001020597156}
[S13] START round=21 head_norm_before_train=1.009614 cos_to_last_merge=0.9947 (last merge round=19)
[S13] round=21 local utility u=0.218096 metrics={'f1_val': 0.5597210501970262, 'auprc': 0.6532077086483, 'loss_val': 0.8803057961258206, 'psi': 0.5971157135775358}-{'f1_val': 0.5553308473837505, 'auprc': 0.5437959513509631, 'loss_val': 0.9619220875056148, 'psi': 0.5507168889706355}
[S14] START round=21 head_norm_before_train=1.490613 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.004925 metrics={'f1_val': 0.8160172041100777, 'auprc': 0.9956896696802969, 'loss_val': 0.4209204774172872, 'psi': 0.8878861903381654}-{'f1_val': 0.817342942207993, 'auprc': 0.9945949184848619, 'loss_val': 0.43544155016429537, 'psi': 0.8882437327187405}
[S15] START round=21 head_norm_before_train=1.778267 cos_to_last_merge=0.7798 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.780
[S15] round=21 local utility u=0.218749 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9923910905050181, 'loss_val': 0.027210855581368865, 'psi': 0.994781744388201}-{'f1_val': 0.9321823854735708, 'auprc': 0.9937212372022265, 'loss_val': 0.08354036662293078, 'psi': 0.956797926165033}
[S16] START round=21 head_norm_before_train=1.314082 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.502235 metrics={'f1_val': 0.9169228015781206, 'auprc': 0.9813161853462977, 'loss_val': 0.3493486694082928, 'psi': 0.9426801550853914}-{'f1_val': 0.8296909297016286, 'auprc': 0.9454930431362739, 'loss_val': 0.7229573015554988, 'psi': 0.8760117750754868}
[S17] START round=21 head_norm_before_train=1.579033 cos_to_last_merge=0.8116 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.6402961024951564, 'auprc': 0.8152893749355917, 'loss_val': 0.9612864357265831, 'psi': 0.7102934114713306}-{'f1_val': 0.6461933532063562, 'auprc': 0.8201387886995668, 'loss_val': 0.8380252957331554, 'psi': 0.7157715274036405}
[S14] not sending this round → trigger blocked (psi=0.888)
[S15] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:40417
[S3] not sending this round → trigger blocked (psi=0.998)
[S11] not sending this round → trigger blocked (psi=0.974)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:40416
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:40414
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:40411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=-0.0550
[S14] DROPPED delta from S10 (cos=-0.0550 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.0496
[S8] RECEIVED delta(kind=head bytes=1792) from S16
[S8] cosine check vs S16: cos=0.8683
[S13] RECEIVED delta(kind=head bytes=1795) from S9
[S13] cosine check vs S9: cos=0.8221
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] cosine check vs S7: cos=0.9778
[S16] RECEIVED delta(kind=head bytes=1806) from S13
[S16] cosine check vs S13: cos=0.3666
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9169 head_norm=1.356972
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.948248e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9127 head_norm=1.009561 delta_norm=0.694825
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.5597 head_norm=1.078247
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.176849e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.5672 head_norm=1.015670 delta_norm=0.317685
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9887 head_norm=1.236469
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.377574e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9907 head_norm=1.253409 delta_norm=0.337757
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9952 head_norm=1.746446
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.891454e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9952 head_norm=1.669355 delta_norm=0.189145
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.6403 head_norm=1.613777
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.918414e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.6404 head_norm=1.040584 delta_norm=0.991841
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.955041 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.8001151875713252, 'auprc': 0.8247784247169806, 'loss_val': 0.5692379907383355, 'psi': 0.8099804824295873}-{'f1_val': 0.88532807666954, 'auprc': 0.8452291856772882, 'loss_val': 0.2683057014485634, 'psi': 0.8692885202726393}
[S3] START round=22 head_norm_before_train=1.804448 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9313197576461416, 'auprc': 0.9988707274892822, 'loss_val': 0.14482512651206148, 'psi': 0.9583401455833979}-{'f1_val': 0.997542018298261, 'auprc': 0.9992403733661877, 'loss_val': 0.0904266153464114, 'psi': 0.9982213603254315}
[S4] START round=22 head_norm_before_train=1.254367 cos_to_last_merge=0.9981 (last merge round=20)
[S4] round=22 local utility u=0.164505 metrics={'f1_val': 0.9460605199425024, 'auprc': 0.9371682464368868, 'loss_val': 0.2971396813403044, 'psi': 0.9425036105402562}-{'f1_val': 0.9381980424908631, 'auprc': 0.8558018652178767, 'loss_val': 0.3348759742153782, 'psi': 0.9052395715816686}
[S5] START round=22 head_norm_before_train=1.715620 (no previous merge yet)
[S5] round=22 local utility u=0.491875 metrics={'f1_val': 0.6603800632752211, 'auprc': 0.95153317300394, 'loss_val': 0.3062502753716037, 'psi': 0.7768413071667086}-{'f1_val': 0.5807027300630825, 'auprc': 0.85380605640904, 'loss_val': 0.5187552125629712, 'psi': 0.6899440606014655}
[S6] START round=22 head_norm_before_train=1.847893 (no previous merge yet)
[S6] round=22 local utility u=0.175179 metrics={'f1_val': 0.8628793922462135, 'auprc': 0.9017812005647002, 'loss_val': 0.3389662770769415, 'psi': 0.8784401155736081}-{'f1_val': 0.8033341632325344, 'auprc': 0.9303928262199607, 'loss_val': 0.4178873762228578, 'psi': 0.8541576284275049}
[S7] START round=22 head_norm_before_train=1.610893 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.49985685255156087, 'auprc': 0.7813828105363072, 'loss_val': 0.8382183969867497, 'psi': 0.6124672357454595}-{'f1_val': 0.6704581513131036, 'auprc': 0.8376644548493386, 'loss_val': 0.43784244365044195, 'psi': 0.7373406727275976}
[S8] START round=22 head_norm_before_train=1.253409 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9921505420845177, 'auprc': 0.9844936834418221, 'loss_val': 0.21843124382299914, 'psi': 0.9890877986274395}-{'f1_val': 0.9887443014841408, 'auprc': 0.9831262583690268, 'loss_val': 0.16218943083351023, 'psi': 0.9864970842380951}
[S9] START round=22 head_norm_before_train=1.049953 cos_to_last_merge=0.9976 (last merge round=20)
[S9] round=22 local utility u=0.895076 metrics={'f1_val': 0.9866379999029397, 'auprc': 0.9990894780549733, 'loss_val': 0.2515348665429477, 'psi': 0.9916185911637531}-{'f1_val': 0.7013646677191758, 'auprc': 0.9987262443735403, 'loss_val': 0.3289563725871943, 'psi': 0.8203092983809217}
[S10] START round=22 head_norm_before_train=1.669355 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996924902956098, 'loss_val': 0.0725785315507513, 'psi': 0.995882664594064}-{'f1_val': 0.9951878390193748, 'auprc': 0.9963968053808361, 'loss_val': 0.0643273514524409, 'psi': 0.9956714255639593}
[S11] START round=22 head_norm_before_train=1.526734 cos_to_last_merge=0.7883 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.788
[S11] round=22 local utility u=0.026541 metrics={'f1_val': 0.9601905572999714, 'auprc': 0.9984123101467359, 'loss_val': 0.13536470663880562, 'psi': 0.9754792584386772}-{'f1_val': 0.9577957292568001, 'auprc': 0.9983476142087919, 'loss_val': 0.17388387299094105, 'psi': 0.9740164832375968}
[S13] START round=22 head_norm_before_train=1.015670 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5672625684113692, 'auprc': 0.6333353854960023, 'loss_val': 0.9115073059230364, 'psi': 0.5936916952452225}-{'f1_val': 0.5597210501970262, 'auprc': 0.6532077086483, 'loss_val': 0.8803057961258206, 'psi': 0.5971157135775358}
[S14] START round=22 head_norm_before_train=1.509771 cos_to_last_merge=0.9995 (last merge round=20)
[S14] round=22 local utility u=0.016260 metrics={'f1_val': 0.8169073014923094, 'auprc': 0.9954256702141805, 'loss_val': 0.392948335982604, 'psi': 0.8883146489810578}-{'f1_val': 0.8160172041100777, 'auprc': 0.9956896696802969, 'loss_val': 0.4209204774172872, 'psi': 0.8878861903381654}
[S15] START round=22 head_norm_before_train=1.803962 cos_to_last_merge=0.7784 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.778
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7840826664945204, 'auprc': 0.9922835424403839, 'loss_val': 0.3358439444165878, 'psi': 0.8673630168728658}-{'f1_val': 0.9963755136436562, 'auprc': 0.9923910905050181, 'loss_val': 0.027210855581368865, 'psi': 0.994781744388201}
[S16] START round=22 head_norm_before_train=1.009561 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9171220854501552, 'auprc': 0.9779618096330852, 'loss_val': 0.37639068826105543, 'psi': 0.9414579751233272}-{'f1_val': 0.9169228015781206, 'auprc': 0.9813161853462977, 'loss_val': 0.3493486694082928, 'psi': 0.9426801550853914}
[S17] START round=22 head_norm_before_train=1.040584 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.079498 metrics={'f1_val': 0.6376521816062718, 'auprc': 0.8145276761727807, 'loss_val': 0.7841427992487651, 'psi': 0.7084023794328753}-{'f1_val': 0.6402961024951564, 'auprc': 0.8152893749355917, 'loss_val': 0.9612864357265831, 'psi': 0.7102934114713306}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:40410
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:40412
[S9] not sending this round → trigger blocked (psi=0.992)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.9916
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=-0.0026
[S11] DROPPED delta from S6 (cos=-0.0026 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.7842
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] cosine check vs S14: cos=0.6858
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] cosine check vs S4: cos=0.4886
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] cosine check vs S17: cos=0.3902
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9866 head_norm=1.096900
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.554021e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.7014 head_norm=0.932414 delta_norm=0.255402
[S9] aggregate: ROLLBACK (f1_val pre=0.987 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9461 head_norm=1.307924
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.717101e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9461 head_norm=1.303697 delta_norm=0.571710
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.8169 head_norm=1.530456
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.006899e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.8173 head_norm=1.537788 delta_norm=0.100690
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.971820 (no previous merge yet)
[S2] round=23 local utility u=0.358009 metrics={'f1_val': 0.8805905363404996, 'auprc': 0.8339025564732157, 'loss_val': 0.36344529969480666, 'psi': 0.8619153443935861}-{'f1_val': 0.8001151875713252, 'auprc': 0.8247784247169806, 'loss_val': 0.5692379907383355, 'psi': 0.8099804824295873}
[S3] START round=23 head_norm_before_train=1.824280 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9320880599324066, 'auprc': 0.9988708854319204, 'loss_val': 0.15024662009061754, 'psi': 0.9588011901322122}-{'f1_val': 0.9313197576461416, 'auprc': 0.9988707274892822, 'loss_val': 0.14482512651206148, 'psi': 0.9583401455833979}
[S4] START round=23 head_norm_before_train=1.303697 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9410799898250856, 'auprc': 0.9214267907117905, 'loss_val': 0.31296061097906086, 'psi': 0.9332187101797675}-{'f1_val': 0.9460605199425024, 'auprc': 0.9371682464368868, 'loss_val': 0.2971396813403044, 'psi': 0.9425036105402562}
[S5] START round=23 head_norm_before_train=1.733586 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.625677768430998, 'auprc': 0.8653479976000601, 'loss_val': 0.41434131744478, 'psi': 0.7215458600986229}-{'f1_val': 0.6603800632752211, 'auprc': 0.95153317300394, 'loss_val': 0.3062502753716037, 'psi': 0.7768413071667086}
[S6] START round=23 head_norm_before_train=1.867070 (no previous merge yet)
[S6] round=23 local utility u=0.003793 metrics={'f1_val': 0.8551015987976502, 'auprc': 0.9455759305967244, 'loss_val': 0.4160973087250787, 'psi': 0.8912913315172799}-{'f1_val': 0.8628793922462135, 'auprc': 0.9017812005647002, 'loss_val': 0.3389662770769415, 'psi': 0.8784401155736081}
[S7] START round=23 head_norm_before_train=1.618669 (no previous merge yet)
[S7] round=23 local utility u=0.677671 metrics={'f1_val': 0.6502592035926356, 'auprc': 0.8217900526280917, 'loss_val': 0.5065124635102065, 'psi': 0.718871543206818}-{'f1_val': 0.49985685255156087, 'auprc': 0.7813828105363072, 'loss_val': 0.8382183969867497, 'psi': 0.6124672357454595}
[S8] START round=23 head_norm_before_train=1.290648 cos_to_last_merge=0.9991 (last merge round=21)
[S8] round=23 local utility u=0.043676 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9869556723907679, 'loss_val': 0.14210552331611834, 'psi': 0.9904366053793827}-{'f1_val': 0.9921505420845177, 'auprc': 0.9844936834418221, 'loss_val': 0.21843124382299914, 'psi': 0.9890877986274395}
[S9] START round=23 head_norm_before_train=0.932414 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.021498 metrics={'f1_val': 0.9979557977304231, 'auprc': 0.9992460209558364, 'loss_val': 0.2769154634071406, 'psi': 0.9984718870205884}-{'f1_val': 0.9866379999029397, 'auprc': 0.9990894780549733, 'loss_val': 0.2515348665429477, 'psi': 0.9916185911637531}
[S10] START round=23 head_norm_before_train=1.725996 cos_to_last_merge=0.9986 (last merge round=21)
[S10] round=23 local utility u=0.014382 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9978682847830352, 'loss_val': 0.04745672661755236, 'psi': 0.9963411862514523}-{'f1_val': 0.9951878390193748, 'auprc': 0.996924902956098, 'loss_val': 0.0725785315507513, 'psi': 0.995882664594064}
[S11] START round=23 head_norm_before_train=1.551634 cos_to_last_merge=0.7866 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.787
[S11] round=23 local utility u=0.099695 metrics={'f1_val': 0.9884915100843162, 'auprc': 0.9983968571100864, 'loss_val': 0.10573496885657764, 'psi': 0.9924536488946243}-{'f1_val': 0.9601905572999714, 'auprc': 0.9984123101467359, 'loss_val': 0.13536470663880562, 'psi': 0.9754792584386772}
[S13] START round=23 head_norm_before_train=1.081992 cos_to_last_merge=0.9931 (last merge round=21)
[S13] round=23 local utility u=0.108613 metrics={'f1_val': 0.5771125920757926, 'auprc': 0.6664490337645578, 'loss_val': 0.8527229927646979, 'psi': 0.6128471687512986}-{'f1_val': 0.5672625684113692, 'auprc': 0.6333353854960023, 'loss_val': 0.9115073059230364, 'psi': 0.5936916952452225}
[S14] START round=23 head_norm_before_train=1.537788 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.003302 metrics={'f1_val': 0.8141111979278014, 'auprc': 0.9960038628407474, 'loss_val': 0.3713026310252697, 'psi': 0.8868682638929798}-{'f1_val': 0.8169073014923094, 'auprc': 0.9954256702141805, 'loss_val': 0.392948335982604, 'psi': 0.8883146489810578}
[S15] START round=23 head_norm_before_train=1.826943 cos_to_last_merge=0.7772 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.777
[S15] round=23 local utility u=0.800380 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9967656902618683, 'loss_val': 0.02451403406982211, 'psi': 0.9967542771372597}-{'f1_val': 0.7840826664945204, 'auprc': 0.9922835424403839, 'loss_val': 0.3358439444165878, 'psi': 0.8673630168728658}
[S16] START round=23 head_norm_before_train=1.051905 cos_to_last_merge=0.9982 (last merge round=21)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8238322758820886, 'auprc': 0.9735963664384178, 'loss_val': 0.7455068769281797, 'psi': 0.8837379121046203}-{'f1_val': 0.9171220854501552, 'auprc': 0.9779618096330852, 'loss_val': 0.37639068826105543, 'psi': 0.9414579751233272}
[S17] START round=23 head_norm_before_train=1.109985 cos_to_last_merge=0.9957 (last merge round=21)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6409563048080491, 'auprc': 0.8165716506821152, 'loss_val': 0.8354665103108287, 'psi': 0.7112024431576756}-{'f1_val': 0.6376521816062718, 'auprc': 0.8145276761727807, 'loss_val': 0.7841427992487651, 'psi': 0.7084023794328753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:40413
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.891)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:40411
[S11] not sending this round → trigger blocked (psi=0.992)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:40414
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:40416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:40417
[S14] not sending this round → trigger blocked (psi=0.887)
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=0.5246
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0271
[S8] DROPPED delta from S2 (cos=-0.0271 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=0.9171
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] cosine check vs S7: cos=0.9795
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.7429
[S16] RECEIVED delta(kind=head bytes=1793) from S15
[S16] cosine check vs S15: cos=0.7296
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=-0.0586
[S14] DROPPED delta from S10 (cos=-0.0586 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9953 head_norm=1.775757
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.875530e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9957 head_norm=1.692816 delta_norm=0.187553
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5771 head_norm=1.146536
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.313227e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5678 head_norm=1.041043 delta_norm=0.231323
[S13] aggregate: ROLLBACK (f1_val pre=0.577 post=0.568 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.8238 head_norm=1.101584
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.816335e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.8234 head_norm=1.115427 delta_norm=0.181633
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.6410 head_norm=1.214711
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.256602e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6438 head_norm=1.116509 delta_norm=0.625660
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.988326 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7321886821913415, 'auprc': 0.8153055621725492, 'loss_val': 0.9996127734191782, 'psi': 0.7654354341838245}-{'f1_val': 0.8805905363404996, 'auprc': 0.8339025564732157, 'loss_val': 0.36344529969480666, 'psi': 0.8619153443935861}
[S3] START round=24 head_norm_before_train=1.841725 (no previous merge yet)
[S3] round=24 local utility u=0.242539 metrics={'f1_val': 0.9971723632406959, 'auprc': 0.9990833409228741, 'loss_val': 0.056310841428069996, 'psi': 0.9979367543135672}-{'f1_val': 0.9320880599324066, 'auprc': 0.9988708854319204, 'loss_val': 0.15024662009061754, 'psi': 0.9588011901322122}
[S4] START round=24 head_norm_before_train=1.349029 cos_to_last_merge=0.9989 (last merge round=22)
[S4] round=24 local utility u=0.011295 metrics={'f1_val': 0.9385364430887391, 'auprc': 0.9319831759712005, 'loss_val': 0.30677819865714917, 'psi': 0.9359151362417236}-{'f1_val': 0.9410799898250856, 'auprc': 0.9214267907117905, 'loss_val': 0.31296061097906086, 'psi': 0.9332187101797675}
[S5] START round=24 head_norm_before_train=1.749891 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.44459483991944904, 'auprc': 0.8536352180219464, 'loss_val': 0.7611988721119716, 'psi': 0.608210991160448}-{'f1_val': 0.625677768430998, 'auprc': 0.8653479976000601, 'loss_val': 0.41434131744478, 'psi': 0.7215458600986229}
[S6] START round=24 head_norm_before_train=1.883083 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.603720840338506, 'auprc': 0.7476197572352262, 'loss_val': 1.1522015860506645, 'psi': 0.661280407097194}-{'f1_val': 0.8551015987976502, 'auprc': 0.9455759305967244, 'loss_val': 0.4160973087250787, 'psi': 0.8912913315172799}
[S7] START round=24 head_norm_before_train=1.627359 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.43073598538946123, 'auprc': 0.7800788949153845, 'loss_val': 0.9459946954947693, 'psi': 0.5704731491998305}-{'f1_val': 0.6502592035926356, 'auprc': 0.8217900526280917, 'loss_val': 0.5065124635102065, 'psi': 0.718871543206818}
[S8] START round=24 head_norm_before_train=1.341851 cos_to_last_merge=0.9956 (last merge round=21)
[S8] round=24 local utility u=0.034262 metrics={'f1_val': 0.9920372758728229, 'auprc': 0.9978190809774947, 'loss_val': 0.10185277609399385, 'psi': 0.9943499979146916}-{'f1_val': 0.9927572273717925, 'auprc': 0.9869556723907679, 'loss_val': 0.14210552331611834, 'psi': 0.9904366053793827}
[S9] START round=24 head_norm_before_train=0.979805 cos_to_last_merge=0.9980 (last merge round=22)
[S9] round=24 local utility u=0.023050 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9992037410524551, 'loss_val': 0.22324268045137002, 'psi': 0.9977104420835716}-{'f1_val': 0.9979557977304231, 'auprc': 0.9992460209558364, 'loss_val': 0.2769154634071406, 'psi': 0.9984718870205884}
[S10] START round=24 head_norm_before_train=1.692816 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.996152572193934, 'auprc': 0.9976280073169563, 'loss_val': 0.057580675371154355, 'psi': 0.996742746243143}-{'f1_val': 0.9953231205637304, 'auprc': 0.9978682847830352, 'loss_val': 0.04745672661755236, 'psi': 0.9963411862514523}
[S11] START round=24 head_norm_before_train=1.577091 cos_to_last_merge=0.7850 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.785
[S11] round=24 local utility u=0.036035 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9985048426420128, 'loss_val': 0.08482595050070864, 'psi': 0.9975804910325514}-{'f1_val': 0.9884915100843162, 'auprc': 0.9983968571100864, 'loss_val': 0.10573496885657764, 'psi': 0.9924536488946243}
[S13] START round=24 head_norm_before_train=1.041043 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5342568310254049, 'auprc': 0.689353700467244, 'loss_val': 0.9753041018367956, 'psi': 0.5962955788021405}-{'f1_val': 0.5771125920757926, 'auprc': 0.6664490337645578, 'loss_val': 0.8527229927646979, 'psi': 0.6128471687512986}
[S14] START round=24 head_norm_before_train=1.558869 cos_to_last_merge=0.9996 (last merge round=22)
[S14] round=24 local utility u=0.546753 metrics={'f1_val': 0.9963412126234941, 'auprc': 0.9945796892630443, 'loss_val': 0.3669033019251525, 'psi': 0.9956366032793141}-{'f1_val': 0.8141111979278014, 'auprc': 0.9960038628407474, 'loss_val': 0.3713026310252697, 'psi': 0.8868682638929798}
[S15] START round=24 head_norm_before_train=1.846401 cos_to_last_merge=0.7759 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.776
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.926010497280738, 'auprc': 0.9966085455208081, 'loss_val': 0.09412139674858912, 'psi': 0.954249716576766}-{'f1_val': 0.9967466683875206, 'auprc': 0.9967656902618683, 'loss_val': 0.02451403406982211, 'psi': 0.9967542771372597}
[S16] START round=24 head_norm_before_train=1.115427 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.782457 metrics={'f1_val': 0.9907272864510681, 'auprc': 0.9808996721184913, 'loss_val': 0.20387270624393922, 'psi': 0.9867962407180373}-{'f1_val': 0.8238322758820886, 'auprc': 0.9735963664384178, 'loss_val': 0.7455068769281797, 'psi': 0.8837379121046203}
[S17] START round=24 head_norm_before_train=1.116509 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.121210 metrics={'f1_val': 0.6502982061609581, 'auprc': 0.8590021301870248, 'loss_val': 0.7763897760153113, 'psi': 0.7337797757713849}-{'f1_val': 0.6409563048080491, 'auprc': 0.8165716506821152, 'loss_val': 0.8354665103108287, 'psi': 0.7112024431576756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:40413
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:40404
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=0.9544
[S4] RECEIVED delta(kind=head bytes=1799) from S14
[S4] cosine check vs S14: cos=0.9093
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] cosine check vs S3: cos=0.3572
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.8222
[S8] RECEIVED delta(kind=head bytes=1800) from S16
[S8] cosine check vs S16: cos=0.9009
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.4939
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.9920
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.5349
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5343 head_norm=1.099172
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.643631e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5395 head_norm=1.051854 delta_norm=0.164363
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9920 head_norm=1.410559
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.107371e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9920 head_norm=1.255285 delta_norm=0.310737
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9385 head_norm=1.396835
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.543070e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9385 head_norm=1.262307 delta_norm=0.354307
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9967 head_norm=1.028904
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.804757e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9917 head_norm=0.911057 delta_norm=0.380476
[S9] aggregate: ROLLBACK (f1_val pre=0.997 post=0.992 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9963 head_norm=1.581894
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.012061e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9959 head_norm=1.588364 delta_norm=0.101206
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.6503 head_norm=1.200484
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.019519e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.6513 head_norm=1.246537 delta_norm=0.401952
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.999602 (no previous merge yet)
[S2] round=25 local utility u=0.724494 metrics={'f1_val': 0.843766947305713, 'auprc': 0.8500145763446798, 'loss_val': 0.3242211250469888, 'psi': 0.8462659989212997}-{'f1_val': 0.7321886821913415, 'auprc': 0.8153055621725492, 'loss_val': 0.9996127734191782, 'psi': 0.7654354341838245}
[S3] START round=25 head_norm_before_train=1.857026 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9970861769288293, 'auprc': 0.9988697137196417, 'loss_val': 0.09292631082171449, 'psi': 0.9977995916451542}-{'f1_val': 0.9971723632406959, 'auprc': 0.9990833409228741, 'loss_val': 0.056310841428069996, 'psi': 0.9979367543135672}
[S4] START round=25 head_norm_before_train=1.262307 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9478384871777256, 'auprc': 0.9002975570905359, 'loss_val': 0.29105876396395125, 'psi': 0.9288221151428497}-{'f1_val': 0.9385364430887391, 'auprc': 0.9319831759712005, 'loss_val': 0.30677819865714917, 'psi': 0.9359151362417236}
[S5] START round=25 head_norm_before_train=1.763092 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.43692658691564545, 'auprc': 0.853612220976334, 'loss_val': 0.835535005221303, 'psi': 0.6036008405399209}-{'f1_val': 0.44459483991944904, 'auprc': 0.8536352180219464, 'loss_val': 0.7611988721119716, 'psi': 0.608210991160448}
[S6] START round=25 head_norm_before_train=1.896265 (no previous merge yet)
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.7853965779859365, 'auprc': 0.9627645092841555, 'loss_val': 0.18738080444602218, 'psi': 0.856343750505224}-{'f1_val': 0.603720840338506, 'auprc': 0.7476197572352262, 'loss_val': 1.1522015860506645, 'psi': 0.661280407097194}
[S7] START round=25 head_norm_before_train=1.635661 (no previous merge yet)
[S7] round=25 local utility u=0.648191 metrics={'f1_val': 0.5998484629245922, 'auprc': 0.7886947517027503, 'loss_val': 0.6901353018594372, 'psi': 0.6753869784358555}-{'f1_val': 0.43073598538946123, 'auprc': 0.7800788949153845, 'loss_val': 0.9459946954947693, 'psi': 0.5704731491998305}
[S8] START round=25 head_norm_before_train=1.255285 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9916739394511156, 'auprc': 0.9926517794321236, 'loss_val': 0.12839464500379252, 'psi': 0.9920650754435187}-{'f1_val': 0.9920372758728229, 'auprc': 0.9978190809774947, 'loss_val': 0.10185277609399385, 'psi': 0.9943499979146916}
[S9] START round=25 head_norm_before_train=0.911057 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.988736075591129, 'auprc': 0.9994032450748052, 'loss_val': 0.2623290033565099, 'psi': 0.9930029433845995}-{'f1_val': 0.9967149094376494, 'auprc': 0.9992037410524551, 'loss_val': 0.22324268045137002, 'psi': 0.9977104420835716}
[S10] START round=25 head_norm_before_train=1.737339 cos_to_last_merge=0.9991 (last merge round=23)
[S10] round=25 local utility u=0.004581 metrics={'f1_val': 0.9957380956904327, 'auprc': 0.9977921942948806, 'loss_val': 0.046424347553762464, 'psi': 0.996559735132212}-{'f1_val': 0.996152572193934, 'auprc': 0.9976280073169563, 'loss_val': 0.057580675371154355, 'psi': 0.996742746243143}
[S11] START round=25 head_norm_before_train=1.601218 cos_to_last_merge=0.7830 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.783
[S11] round=25 local utility u=0.009001 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9983966772313223, 'loss_val': 0.06649860582353816, 'psi': 0.9975372248682752}-{'f1_val': 0.9969642566262439, 'auprc': 0.9985048426420128, 'loss_val': 0.08482595050070864, 'psi': 0.9975804910325514}
[S13] START round=25 head_norm_before_train=1.051854 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.104449 metrics={'f1_val': 0.5493277675485936, 'auprc': 0.7174395099147886, 'loss_val': 0.941089213974494, 'psi': 0.6165724644950716}-{'f1_val': 0.5342568310254049, 'auprc': 0.689353700467244, 'loss_val': 0.9753041018367956, 'psi': 0.5962955788021405}
[S14] START round=25 head_norm_before_train=1.588364 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.8894294926200796, 'auprc': 0.9991485598390206, 'loss_val': 0.31854509991998686, 'psi': 0.9333171195076561}-{'f1_val': 0.9963412126234941, 'auprc': 0.9945796892630443, 'loss_val': 0.3669033019251525, 'psi': 0.9956366032793141}
[S15] START round=25 head_norm_before_train=1.868340 cos_to_last_merge=0.7748 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.775
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.8243916751026261, 'auprc': 0.9923163349795585, 'loss_val': 0.21920860803858966, 'psi': 0.8915615390533991}-{'f1_val': 0.926010497280738, 'auprc': 0.9966085455208081, 'loss_val': 0.09412139674858912, 'psi': 0.954249716576766}
[S16] START round=25 head_norm_before_train=1.164009 cos_to_last_merge=0.9986 (last merge round=23)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9204697463465854, 'auprc': 0.9899554653572107, 'loss_val': 0.3456319168193749, 'psi': 0.9482640339508355}-{'f1_val': 0.9907272864510681, 'auprc': 0.9808996721184913, 'loss_val': 0.20387270624393922, 'psi': 0.9867962407180373}
[S17] START round=25 head_norm_before_train=1.246537 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.6363029473686301, 'auprc': 0.8120986188451295, 'loss_val': 0.8448737526192308, 'psi': 0.7066212159592299}-{'f1_val': 0.6502982061609581, 'auprc': 0.8590021301870248, 'loss_val': 0.7763897760153113, 'psi': 0.7337797757713849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:40411
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:40414
[S11] not sending this round → trigger blocked (psi=0.998)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:40416
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:40409
[S2] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=-0.0430
[S8] DROPPED delta from S2 (cos=-0.0430 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1805) from S7
[S10] cosine check vs S7: cos=0.9838
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=-0.0039
[S11] DROPPED delta from S6 (cos=-0.0039 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S13
[S16] cosine check vs S13: cos=0.6827
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=-0.0601
[S14] DROPPED delta from S10 (cos=-0.0601 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.230 → S16@127.0.0.1:40416
[S9] ⇄ pheromone p=0.113 → S13@127.0.0.1:40413
[S3] ⇄ pheromone p=0.147 → S4@127.0.0.1:40404
[S8] ⇄ pheromone p=0.095 → S17@127.0.0.1:40417
[S4] ⇄ pheromone p=0.039 → S9@127.0.0.1:40410
[S11] ⇄ pheromone p=0.091 → S14@127.0.0.1:40414
[S14] ⇄ pheromone p=0.156 → S4@127.0.0.1:40404
[S5] ⇄ pheromone p=0.097 → S9@127.0.0.1:40410
[S13] ⇄ pheromone p=0.086 → S16@127.0.0.1:40416
[S6] ⇄ pheromone p=0.322 → S11@127.0.0.1:40412
[S7] ⇄ pheromone p=0.402 → S10@127.0.0.1:40411
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9957 head_norm=1.781109
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.679275e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9957 head_norm=1.707676 delta_norm=0.167928
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.024 → S14@127.0.0.1:40414
[S2] ⇄ pheromone p=0.260 → S8@127.0.0.1:40409
[S17] ⇄ pheromone p=0.073 → S9@127.0.0.1:40410
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9205 head_norm=1.215049
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.654980e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9159 head_norm=1.066294 delta_norm=0.465498
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.242 → S8@127.0.0.1:40409
[S2] START round=26 head_norm_before_train=2.011854 (no previous merge yet)
[S2] round=26 local utility u=0.010583 metrics={'f1_val': 0.8328103916484413, 'auprc': 0.9108481806200093, 'loss_val': 0.4198163974639643, 'psi': 0.8640255072370684}-{'f1_val': 0.843766947305713, 'auprc': 0.8500145763446798, 'loss_val': 0.3242211250469888, 'psi': 0.8462659989212997}
[S3] START round=26 head_norm_before_train=1.869053 (no previous merge yet)
[S3] round=26 local utility u=0.012672 metrics={'f1_val': 0.9971279671228781, 'auprc': 0.9988708445750059, 'loss_val': 0.06783600841245331, 'psi': 0.9978251181037292}-{'f1_val': 0.9970861769288293, 'auprc': 0.9988697137196417, 'loss_val': 0.09292631082171449, 'psi': 0.9977995916451542}
[S4] START round=26 head_norm_before_train=1.310897 cos_to_last_merge=0.9989 (last merge round=24)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.8645672890431857, 'auprc': 0.9663118113363907, 'loss_val': 0.38512645016224933, 'psi': 0.9052650979604677}-{'f1_val': 0.9478384871777256, 'auprc': 0.9002975570905359, 'loss_val': 0.29105876396395125, 'psi': 0.9288221151428497}
[S5] START round=26 head_norm_before_train=1.773492 (no previous merge yet)
[S5] round=26 local utility u=1.000000 metrics={'f1_val': 0.7742858841055608, 'auprc': 0.992197564220813, 'loss_val': 0.16501948763194527, 'psi': 0.8614505561516617}-{'f1_val': 0.43692658691564545, 'auprc': 0.853612220976334, 'loss_val': 0.835535005221303, 'psi': 0.6036008405399209}
[S6] START round=26 head_norm_before_train=1.905313 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6027053268435233, 'auprc': 0.7273384370934051, 'loss_val': 1.1779438435007423, 'psi': 0.652558570943476}-{'f1_val': 0.7853965779859365, 'auprc': 0.9627645092841555, 'loss_val': 0.18738080444602218, 'psi': 0.856343750505224}
[S7] START round=26 head_norm_before_train=1.648140 (no previous merge yet)
[S7] round=26 local utility u=0.177174 metrics={'f1_val': 0.6295774361908151, 'auprc': 0.8080618283864593, 'loss_val': 0.5722621256049178, 'psi': 0.7009711930690727}-{'f1_val': 0.5998484629245922, 'auprc': 0.7886947517027503, 'loss_val': 0.6901353018594372, 'psi': 0.6753869784358555}
[S8] START round=26 head_norm_before_train=1.330023 cos_to_last_merge=0.9969 (last merge round=24)
[S8] round=26 local utility u=0.019375 metrics={'f1_val': 0.9895052486271397, 'auprc': 0.9982455563010701, 'loss_val': 0.09341283429507863, 'psi': 0.9930013716967119}-{'f1_val': 0.9916739394511156, 'auprc': 0.9926517794321236, 'loss_val': 0.12839464500379252, 'psi': 0.9920650754435187}
[S9] START round=26 head_norm_before_train=0.957852 cos_to_last_merge=0.9978 (last merge round=24)
[S9] round=26 local utility u=0.058214 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9992432841891618, 'loss_val': 0.19827326781199295, 'psi': 0.998224247682051}-{'f1_val': 0.988736075591129, 'auprc': 0.9994032450748052, 'loss_val': 0.2623290033565099, 'psi': 0.9930029433845995}
[S10] START round=26 head_norm_before_train=1.707676 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9954588843928018, 'auprc': 0.9982182257440543, 'loss_val': 0.054377291649443056, 'psi': 0.9965626209333027}-{'f1_val': 0.9957380956904327, 'auprc': 0.9977921942948806, 'loss_val': 0.046424347553762464, 'psi': 0.996559735132212}
[S11] START round=26 head_norm_before_train=1.628260 cos_to_last_merge=0.7812 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.781
[S11] round=26 local utility u=0.004625 metrics={'f1_val': 0.996960829744628, 'auprc': 0.998609661783209, 'loss_val': 0.05786796170845495, 'psi': 0.9976203625600604}-{'f1_val': 0.9969642566262439, 'auprc': 0.9983966772313223, 'loss_val': 0.06649860582353816, 'psi': 0.9975372248682752}
[S13] START round=26 head_norm_before_train=1.109504 cos_to_last_merge=0.9958 (last merge round=24)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6025522143202208, 'auprc': 0.5355171393432633, 'loss_val': 0.9016654385851745, 'psi': 0.5757381843294378}-{'f1_val': 0.5493277675485936, 'auprc': 0.7174395099147886, 'loss_val': 0.941089213974494, 'psi': 0.6165724644950716}
[S14] START round=26 head_norm_before_train=1.608019 cos_to_last_merge=0.9997 (last merge round=24)
[S14] round=26 local utility u=0.314888 metrics={'f1_val': 0.9964636404359815, 'auprc': 0.9975370880456272, 'loss_val': 0.3261398679077749, 'psi': 0.9968930194798398}-{'f1_val': 0.8894294926200796, 'auprc': 0.9991485598390206, 'loss_val': 0.31854509991998686, 'psi': 0.9333171195076561}
[S15] START round=26 head_norm_before_train=1.888188 cos_to_last_merge=0.7735 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.774
[S15] round=26 local utility u=0.617560 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9976779713476964, 'loss_val': 0.03298004248510253, 'psi': 0.9969867559048293}-{'f1_val': 0.8243916751026261, 'auprc': 0.9923163349795585, 'loss_val': 0.21920860803858966, 'psi': 0.8915615390533991}
[S16] START round=26 head_norm_before_train=1.066294 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8501565851344313, 'auprc': 0.9690308064959606, 'loss_val': 0.6304568961710464, 'psi': 0.897706273679043}-{'f1_val': 0.9204697463465854, 'auprc': 0.9899554653572107, 'loss_val': 0.3456319168193749, 'psi': 0.9482640339508355}
[S17] START round=26 head_norm_before_train=1.305993 cos_to_last_merge=0.9923 (last merge round=24)
[S17] round=26 local utility u=0.079345 metrics={'f1_val': 0.6524584846323687, 'auprc': 0.8239708939108313, 'loss_val': 0.8187345476881248, 'psi': 0.7210634483437537}-{'f1_val': 0.6363029473686301, 'auprc': 0.8120986188451295, 'loss_val': 0.8448737526192308, 'psi': 0.7066212159592299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:40414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S7] not sending this round → trigger blocked (psi=0.701)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:40413
[S2] not sending this round → trigger blocked (psi=0.864)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.8879
[S4] RECEIVED delta(kind=head bytes=1796) from S14
[S4] cosine check vs S14: cos=0.8012
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.9083
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=0.5847
[S4] RECEIVED delta(kind=head bytes=1800) from S3
[S4] cosine check vs S3: cos=0.5618
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.9933
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=0.4691
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.6051
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.6026 head_norm=1.155013
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.423952e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.6003 head_norm=1.056926 delta_norm=0.242395
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.8646 head_norm=1.357618
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.142548e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.8657 head_norm=1.283422 delta_norm=0.214255
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9965 head_norm=1.626549
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.572964e-02
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9960 head_norm=1.638240 delta_norm=0.095730
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9975 head_norm=1.008782
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.755503e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9980 head_norm=1.036954 delta_norm=0.475550
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8502 head_norm=1.114497
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.731515e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8479 head_norm=1.356379 delta_norm=0.773152
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6525 head_norm=1.401535
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.327652e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.6512 head_norm=1.365334 delta_norm=0.332765
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=2.025271 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6870982876156029, 'auprc': 0.7752714299191178, 'loss_val': 1.1056026392686784, 'psi': 0.7223675445370088}-{'f1_val': 0.8328103916484413, 'auprc': 0.9108481806200093, 'loss_val': 0.4198163974639643, 'psi': 0.8640255072370684}
[S3] START round=27 head_norm_before_train=1.879376 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9985230629159273, 'loss_val': 0.08389242945594236, 'psi': 0.9758775167832303}-{'f1_val': 0.9971279671228781, 'auprc': 0.9988708445750059, 'loss_val': 0.06783600841245331, 'psi': 0.9978251181037292}
[S4] START round=27 head_norm_before_train=1.283422 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.243718 metrics={'f1_val': 0.9398727773831557, 'auprc': 0.9516226472722322, 'loss_val': 0.3054559336264614, 'psi': 0.9445727253387862}-{'f1_val': 0.8645672890431857, 'auprc': 0.9663118113363907, 'loss_val': 0.38512645016224933, 'psi': 0.9052650979604677}
[S5] START round=27 head_norm_before_train=1.780803 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6424609199366063, 'auprc': 0.8887457694672298, 'loss_val': 0.40333615557613484, 'psi': 0.7409748597488557}-{'f1_val': 0.7742858841055608, 'auprc': 0.992197564220813, 'loss_val': 0.16501948763194527, 'psi': 0.8614505561516617}
[S6] START round=27 head_norm_before_train=1.908723 (no previous merge yet)
[S6] round=27 local utility u=0.087807 metrics={'f1_val': 0.549204535160736, 'auprc': 0.7685056773201965, 'loss_val': 0.8048262519575923, 'psi': 0.6369249920245201}-{'f1_val': 0.6027053268435233, 'auprc': 0.7273384370934051, 'loss_val': 1.1779438435007423, 'psi': 0.652558570943476}
[S7] START round=27 head_norm_before_train=1.661960 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6080478779890263, 'auprc': 0.7914777017362569, 'loss_val': 0.6794652989370039, 'psi': 0.6814198074879185}-{'f1_val': 0.6295774361908151, 'auprc': 0.8080618283864593, 'loss_val': 0.5722621256049178, 'psi': 0.7009711930690727}
[S8] START round=27 head_norm_before_train=1.409056 cos_to_last_merge=0.9901 (last merge round=24)
[S8] round=27 local utility u=0.000393 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9861060843935144, 'loss_val': 0.07134371903195245, 'psi': 0.989659139859357}-{'f1_val': 0.9895052486271397, 'auprc': 0.9982455563010701, 'loss_val': 0.09341283429507863, 'psi': 0.9930013716967119}
[S9] START round=27 head_norm_before_train=1.036954 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9954695508442518, 'auprc': 0.9996258663654937, 'loss_val': 0.21199062684231684, 'psi': 0.9971320770527485}-{'f1_val': 0.9975448900106438, 'auprc': 0.9992432841891618, 'loss_val': 0.19827326781199295, 'psi': 0.998224247682051}
[S10] START round=27 head_norm_before_train=1.751014 cos_to_last_merge=0.9991 (last merge round=25)
[S10] round=27 local utility u=0.007219 metrics={'f1_val': 0.9961605415649639, 'auprc': 0.9978252009013179, 'loss_val': 0.04297012184508485, 'psi': 0.9968264052995055}-{'f1_val': 0.9954588843928018, 'auprc': 0.9982182257440543, 'loss_val': 0.054377291649443056, 'psi': 0.9965626209333027}
[S11] START round=27 head_norm_before_train=1.655393 cos_to_last_merge=0.7796 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.780
[S11] round=27 local utility u=0.006063 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9985705695992045, 'loss_val': 0.04564437160330926, 'psi': 0.9976067818154282}-{'f1_val': 0.996960829744628, 'auprc': 0.998609661783209, 'loss_val': 0.05786796170845495, 'psi': 0.9976203625600604}
[S13] START round=27 head_norm_before_train=1.056926 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.178542 metrics={'f1_val': 0.5615973430645845, 'auprc': 0.7435690684695131, 'loss_val': 0.9230083221559456, 'psi': 0.634386033226556}-{'f1_val': 0.6025522143202208, 'auprc': 0.5355171393432633, 'loss_val': 0.9016654385851745, 'psi': 0.5757381843294378}
[S14] START round=27 head_norm_before_train=1.638240 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.021099 metrics={'f1_val': 0.9930611278268856, 'auprc': 0.9991875860482259, 'loss_val': 0.2684784464512673, 'psi': 0.9955117111154217}-{'f1_val': 0.9964636404359815, 'auprc': 0.9975370880456272, 'loss_val': 0.3261398679077749, 'psi': 0.9968930194798398}
[S15] START round=27 head_norm_before_train=1.906030 cos_to_last_merge=0.7725 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.773
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.9590454470553955, 'auprc': 0.9973067427322856, 'loss_val': 0.06475381411166982, 'psi': 0.9743499653261516}-{'f1_val': 0.9965259456095847, 'auprc': 0.9976779713476964, 'loss_val': 0.03298004248510253, 'psi': 0.9969867559048293}
[S16] START round=27 head_norm_before_train=1.356379 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.721936 metrics={'f1_val': 0.9920018769208533, 'auprc': 0.9894442592432993, 'loss_val': 0.09889743289064769, 'psi': 0.9909788298498317}-{'f1_val': 0.8501565851344313, 'auprc': 0.9690308064959606, 'loss_val': 0.6304568961710464, 'psi': 0.897706273679043}
[S17] START round=27 head_norm_before_train=1.365334 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6438549652772246, 'auprc': 0.8028544300808474, 'loss_val': 0.9292202786553776, 'psi': 0.7074547511986737}-{'f1_val': 0.6524584846323687, 'auprc': 0.8239708939108313, 'loss_val': 0.8187345476881248, 'psi': 0.7210634483437537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S8] not sending this round → trigger blocked (psi=0.990)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:40412
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1790) from S16
[S8] cosine check vs S16: cos=0.9202
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.3223
[S11] RECEIVED delta(kind=head bytes=1803) from S6
[S11] cosine check vs S6: cos=-0.0053
[S11] DROPPED delta from S6 (cos=-0.0053 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=0.5336
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=-0.0621
[S14] DROPPED delta from S10 (cos=-0.0621 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9955 head_norm=1.084566
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.104632e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9967 head_norm=0.985023 delta_norm=0.710463
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9920 head_norm=1.471287
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.889186e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9920 head_norm=1.407252 delta_norm=0.288919
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9920 head_norm=1.401063
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.161612e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9920 head_norm=1.091606 delta_norm=0.616161
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=2.041124 (no previous merge yet)
[S2] round=28 local utility u=0.910426 metrics={'f1_val': 0.8291148855063837, 'auprc': 0.8696185517838408, 'loss_val': 0.41989064119671404, 'psi': 0.8453163520173665}-{'f1_val': 0.6870982876156029, 'auprc': 0.7752714299191178, 'loss_val': 1.1056026392686784, 'psi': 0.7223675445370088}
[S3] START round=28 head_norm_before_train=1.889710 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998692555044759, 'loss_val': 0.09433831951311542, 'psi': 0.9760981726811697}-{'f1_val': 0.9607804860280988, 'auprc': 0.9985230629159273, 'loss_val': 0.08389242945594236, 'psi': 0.9758775167832303}
[S4] START round=28 head_norm_before_train=1.331830 cos_to_last_merge=0.9989 (last merge round=26)
[S4] round=28 local utility u=0.025965 metrics={'f1_val': 0.9465772489444891, 'auprc': 0.949115865213296, 'loss_val': 0.286232632071179, 'psi': 0.9475926954520119}-{'f1_val': 0.9398727773831557, 'auprc': 0.9516226472722322, 'loss_val': 0.3054559336264614, 'psi': 0.9445727253387862}
[S5] START round=28 head_norm_before_train=1.785499 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.5868037479140211, 'auprc': 0.8497310186079102, 'loss_val': 0.6030051864751871, 'psi': 0.6919746561915767}-{'f1_val': 0.6424609199366063, 'auprc': 0.8887457694672298, 'loss_val': 0.40333615557613484, 'psi': 0.7409748597488557}
[S6] START round=28 head_norm_before_train=1.918259 (no previous merge yet)
[S6] round=28 local utility u=0.045326 metrics={'f1_val': 0.5964950868976617, 'auprc': 0.7631654919987358, 'loss_val': 0.9818972352663903, 'psi': 0.6631632489380914}-{'f1_val': 0.549204535160736, 'auprc': 0.7685056773201965, 'loss_val': 0.8048262519575923, 'psi': 0.6369249920245201}
[S7] START round=28 head_norm_before_train=1.674105 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5968205769475252, 'auprc': 0.7901652209918473, 'loss_val': 0.6911302182332434, 'psi': 0.674158434565254}-{'f1_val': 0.6080478779890263, 'auprc': 0.7914777017362569, 'loss_val': 0.6794652989370039, 'psi': 0.6814198074879185}
[S8] START round=28 head_norm_before_train=1.407252 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9918205515801142, 'auprc': 0.9845595555952309, 'loss_val': 0.09546730175025749, 'psi': 0.9889161531861608}-{'f1_val': 0.992027843503252, 'auprc': 0.9861060843935144, 'loss_val': 0.07134371903195245, 'psi': 0.989659139859357}
[S9] START round=28 head_norm_before_train=0.985023 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9994548494851027, 'loss_val': 0.23958952971276087, 'psi': 0.9978108854566307}-{'f1_val': 0.9954695508442518, 'auprc': 0.9996258663654937, 'loss_val': 0.21199062684231684, 'psi': 0.9971320770527485}
[S10] START round=28 head_norm_before_train=1.792017 cos_to_last_merge=0.9970 (last merge round=25)
[S10] round=28 local utility u=0.001279 metrics={'f1_val': 0.9957380956904327, 'auprc': 0.9976046659993283, 'loss_val': 0.037216759543092524, 'psi': 0.9964847238139909}-{'f1_val': 0.9961605415649639, 'auprc': 0.9978252009013179, 'loss_val': 0.04297012184508485, 'psi': 0.9968264052995055}
[S11] START round=28 head_norm_before_train=1.681519 cos_to_last_merge=0.7778 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.778
[S11] round=28 local utility u=0.001585 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9977652486738325, 'loss_val': 0.040058225079310936, 'psi': 0.9972846534452793}-{'f1_val': 0.9969642566262439, 'auprc': 0.9985705695992045, 'loss_val': 0.04564437160330926, 'psi': 0.9976067818154282}
[S13] START round=28 head_norm_before_train=1.086066 cos_to_last_merge=0.9990 (last merge round=26)
[S13] round=28 local utility u=0.018157 metrics={'f1_val': 0.5692601836911205, 'auprc': 0.7404855060532374, 'loss_val': 0.9234198419431294, 'psi': 0.6377503126359673}-{'f1_val': 0.5615973430645845, 'auprc': 0.7435690684695131, 'loss_val': 0.9230083221559456, 'psi': 0.634386033226556}
[S14] START round=28 head_norm_before_train=1.655416 cos_to_last_merge=0.9998 (last merge round=26)
[S14] round=28 local utility u=0.030914 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9975338989340798, 'loss_val': 0.22544523860866553, 'psi': 0.9972257332473573}-{'f1_val': 0.9930611278268856, 'auprc': 0.9991875860482259, 'loss_val': 0.2684784464512673, 'psi': 0.9955117111154217}
[S15] START round=28 head_norm_before_train=1.924404 cos_to_last_merge=0.7717 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.772
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7968001996139722, 'auprc': 0.9902635863424121, 'loss_val': 0.3643282326621391, 'psi': 0.8741855543053481}-{'f1_val': 0.9590454470553955, 'auprc': 0.9973067427322856, 'loss_val': 0.06475381411166982, 'psi': 0.9743499653261516}
[S16] START round=28 head_norm_before_train=1.091606 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9926605645761105, 'auprc': 0.9913157440951635, 'loss_val': 0.17594267826362095, 'psi': 0.9921226363837318}-{'f1_val': 0.9920018769208533, 'auprc': 0.9894442592432993, 'loss_val': 0.09889743289064769, 'psi': 0.9909788298498317}
[S17] START round=28 head_norm_before_train=1.453654 cos_to_last_merge=0.9926 (last merge round=26)
[S17] round=28 local utility u=0.002226 metrics={'f1_val': 0.6503190077751978, 'auprc': 0.8220493254675668, 'loss_val': 1.021137954277719, 'psi': 0.7190111348521454}-{'f1_val': 0.6438549652772246, 'auprc': 0.8028544300808474, 'loss_val': 0.9292202786553776, 'psi': 0.7074547511986737}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:40409
[S4] not sending this round → trigger blocked (psi=0.948)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S13] not sending this round → trigger blocked (psi=0.638)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:40404
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.663)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:40414
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S2
[S8] cosine check vs S2: cos=-0.0382
[S8] DROPPED delta from S2 (cos=-0.0382 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1806) from S14
[S4] cosine check vs S14: cos=0.7342
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.9947
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.4436
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9967 head_norm=1.034296
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.043954e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9925 head_norm=1.092396 delta_norm=0.704395
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9466 head_norm=1.382021
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.728497e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9464 head_norm=1.422919 delta_norm=0.572850
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9970 head_norm=1.672042
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.819431e-02
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9970 head_norm=1.686601 delta_norm=0.088194
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=2.059761 (no previous merge yet)
[S2] round=29 local utility u=0.034260 metrics={'f1_val': 0.8445360772714836, 'auprc': 0.8414154980360813, 'loss_val': 0.35928861184384814, 'psi': 0.8432878455773227}-{'f1_val': 0.8291148855063837, 'auprc': 0.8696185517838408, 'loss_val': 0.41989064119671404, 'psi': 0.8453163520173665}
[S3] START round=29 head_norm_before_train=1.901626 (no previous merge yet)
[S3] round=29 local utility u=0.099588 metrics={'f1_val': 0.9877274083160191, 'auprc': 0.9988701515560906, 'loss_val': 0.0558473479193213, 'psi': 0.9921845056120477}-{'f1_val': 0.9610352511054436, 'auprc': 0.998692555044759, 'loss_val': 0.09433831951311542, 'psi': 0.9760981726811697}
[S4] START round=29 head_norm_before_train=1.422919 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9386971816588231, 'auprc': 0.9281579451938475, 'loss_val': 0.3082560213321624, 'psi': 0.9344814870728329}-{'f1_val': 0.9465772489444891, 'auprc': 0.949115865213296, 'loss_val': 0.286232632071179, 'psi': 0.9475926954520119}
[S5] START round=29 head_norm_before_train=1.789521 (no previous merge yet)
[S5] round=29 local utility u=0.755576 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9906267094818759, 'loss_val': 0.1972001317322085, 'psi': 0.8165988345111547}-{'f1_val': 0.5868037479140211, 'auprc': 0.8497310186079102, 'loss_val': 0.6030051864751871, 'psi': 0.6919746561915767}
[S6] START round=29 head_norm_before_train=1.939762 (no previous merge yet)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.8701936522008048, 'auprc': 0.9416420322355302, 'loss_val': 0.22141236550407634, 'psi': 0.8987730042146949}-{'f1_val': 0.5964950868976617, 'auprc': 0.7631654919987358, 'loss_val': 0.9818972352663903, 'psi': 0.6631632489380914}
[S7] START round=29 head_norm_before_train=1.685559 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5226267464761742, 'auprc': 0.7825494371006712, 'loss_val': 0.7975285780390079, 'psi': 0.626595822725973}-{'f1_val': 0.5968205769475252, 'auprc': 0.7901652209918473, 'loss_val': 0.6911302182332434, 'psi': 0.674158434565254}
[S8] START round=29 head_norm_before_train=1.458620 cos_to_last_merge=0.9990 (last merge round=27)
[S8] round=29 local utility u=0.017906 metrics={'f1_val': 0.9887866173042084, 'auprc': 0.9965982856513943, 'loss_val': 0.07756755607658429, 'psi': 0.9919112846430828}-{'f1_val': 0.9918205515801142, 'auprc': 0.9845595555952309, 'loss_val': 0.09546730175025749, 'psi': 0.9889161531861608}
[S9] START round=29 head_norm_before_train=1.092396 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.017439 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9990979525357182, 'loss_val': 0.20862129002052407, 'psi': 0.9981661150206735}-{'f1_val': 0.9967149094376494, 'auprc': 0.9994548494851027, 'loss_val': 0.23958952971276087, 'psi': 0.9978108854566307}
[S10] START round=29 head_norm_before_train=1.828960 cos_to_last_merge=0.9946 (last merge round=25)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9959440467111853, 'loss_val': 0.04029957141753158, 'psi': 0.9955714910227123}-{'f1_val': 0.9957380956904327, 'auprc': 0.9976046659993283, 'loss_val': 0.037216759543092524, 'psi': 0.9964847238139909}
[S11] START round=29 head_norm_before_train=1.705601 cos_to_last_merge=0.7759 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.776
[S11] round=29 local utility u=0.002116 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986475065988842, 'loss_val': 0.03599234927031598, 'psi': 0.997389555636612}-{'f1_val': 0.9969642566262439, 'auprc': 0.9977652486738325, 'loss_val': 0.040058225079310936, 'psi': 0.9972846534452793}
[S13] START round=29 head_norm_before_train=1.124672 cos_to_last_merge=0.9957 (last merge round=26)
[S13] round=29 local utility u=0.099991 metrics={'f1_val': 0.5977290670931833, 'auprc': 0.716257639921044, 'loss_val': 0.8215668969941596, 'psi': 0.6451404962243276}-{'f1_val': 0.5692601836911205, 'auprc': 0.7404855060532374, 'loss_val': 0.9234198419431294, 'psi': 0.6377503126359673}
[S14] START round=29 head_norm_before_train=1.686601 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9969987740343681, 'auprc': 0.9971578865379624, 'loss_val': 0.23683225981713227, 'psi': 0.997062419035806}-{'f1_val': 0.9970202894562089, 'auprc': 0.9975338989340798, 'loss_val': 0.22544523860866553, 'psi': 0.9972257332473573}
[S15] START round=29 head_norm_before_train=1.941913 cos_to_last_merge=0.7708 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.771
[S15] round=29 local utility u=0.691567 metrics={'f1_val': 0.9713761023590266, 'auprc': 0.9974046533268309, 'loss_val': 0.05007259122017796, 'psi': 0.9817875227461483}-{'f1_val': 0.7968001996139722, 'auprc': 0.9902635863424121, 'loss_val': 0.3643282326621391, 'psi': 0.8741855543053481}
[S16] START round=29 head_norm_before_train=1.136300 cos_to_last_merge=0.9988 (last merge round=27)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9379432479306843, 'auprc': 0.9882006791467064, 'loss_val': 0.3088495792782016, 'psi': 0.9580462204170932}-{'f1_val': 0.9926605645761105, 'auprc': 0.9913157440951635, 'loss_val': 0.17594267826362095, 'psi': 0.9921226363837318}
[S17] START round=29 head_norm_before_train=1.519617 cos_to_last_merge=0.9826 (last merge round=26)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6527791556173177, 'auprc': 0.8192850376446332, 'loss_val': 1.085671208159083, 'psi': 0.7193815084282439}-{'f1_val': 0.6503190077751978, 'auprc': 0.8220493254675668, 'loss_val': 1.021137954277719, 'psi': 0.7190111348521454}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:40417
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:40416
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.843)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:40404
[S3] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.8804
[S13] RECEIVED delta(kind=head bytes=1795) from S9
[S13] cosine check vs S9: cos=0.8459
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.3219
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=-0.0062
[S11] DROPPED delta from S6 (cos=-0.0062 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=0.7314
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.4062
[S16] RECEIVED delta(kind=head bytes=1806) from S13
[S16] cosine check vs S13: cos=0.8128
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9387 head_norm=1.463525
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.001447e+00
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9386 head_norm=1.380698 delta_norm=1.001447
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.5977 head_norm=1.159982
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.189468e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.5905 head_norm=1.103242 delta_norm=0.318947
[S13] aggregate: ROLLBACK (f1_val pre=0.598 post=0.591 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9975 head_norm=1.136742
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.446292e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9975 head_norm=1.241698 delta_norm=0.844629
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9379 head_norm=1.185045
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.885507e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9359 head_norm=1.200918 delta_norm=0.188551
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.6528 head_norm=1.577577
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.793668e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.6542 head_norm=1.499759 delta_norm=0.379367
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.078512 (no previous merge yet)
[S2] round=30 local utility u=0.002716 metrics={'f1_val': 0.8322996251540667, 'auprc': 0.9033912916267578, 'loss_val': 0.4663652197600119, 'psi': 0.8607362917431431}-{'f1_val': 0.8445360772714836, 'auprc': 0.8414154980360813, 'loss_val': 0.35928861184384814, 'psi': 0.8432878455773227}
[S3] START round=30 head_norm_before_train=1.917430 (no previous merge yet)
[S3] round=30 local utility u=0.015551 metrics={'f1_val': 0.9924159261378052, 'auprc': 0.9988709954183586, 'loss_val': 0.05287853161934062, 'psi': 0.9949979538500265}-{'f1_val': 0.9877274083160191, 'auprc': 0.9988701515560906, 'loss_val': 0.0558473479193213, 'psi': 0.9921845056120477}
[S4] START round=30 head_norm_before_train=1.380698 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9241237061355803, 'auprc': 0.9605788107345952, 'loss_val': 0.36056359483866607, 'psi': 0.9387057479751862}-{'f1_val': 0.9386971816588231, 'auprc': 0.9281579451938475, 'loss_val': 0.3082560213321624, 'psi': 0.9344814870728329}
[S5] START round=30 head_norm_before_train=1.793945 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.43692658691564545, 'auprc': 0.8536113770785988, 'loss_val': 1.0355730001813046, 'psi': 0.6036005029808268}-{'f1_val': 0.7005802511973405, 'auprc': 0.9906267094818759, 'loss_val': 0.1972001317322085, 'psi': 0.8165988345111547}
[S6] START round=30 head_norm_before_train=1.957846 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.5958165039051181, 'auprc': 0.8062344470059468, 'loss_val': 0.7084816159411282, 'psi': 0.6799836811454496}-{'f1_val': 0.8701936522008048, 'auprc': 0.9416420322355302, 'loss_val': 0.22141236550407634, 'psi': 0.8987730042146949}
[S7] START round=30 head_norm_before_train=1.694525 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.496851942306491, 'auprc': 0.779805544829455, 'loss_val': 0.8273141509918424, 'psi': 0.6100333833156766}-{'f1_val': 0.5226267464761742, 'auprc': 0.7825494371006712, 'loss_val': 0.7975285780390079, 'psi': 0.626595822725973}
[S8] START round=30 head_norm_before_train=1.515798 cos_to_last_merge=0.9962 (last merge round=27)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9921686949136479, 'auprc': 0.9838368282385914, 'loss_val': 0.0745279211209319, 'psi': 0.9888359482436253}-{'f1_val': 0.9887866173042084, 'auprc': 0.9965982856513943, 'loss_val': 0.07756755607658429, 'psi': 0.9919112846430828}
[S9] START round=30 head_norm_before_train=1.241698 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9921172834657093, 'auprc': 0.9966414722433152, 'loss_val': 0.19402701514501516, 'psi': 0.9939269589767517}-{'f1_val': 0.9975448900106438, 'auprc': 0.9990979525357182, 'loss_val': 0.20862129002052407, 'psi': 0.9981661150206735}
[S10] START round=30 head_norm_before_train=1.861284 cos_to_last_merge=0.9924 (last merge round=25)
[S10] round=30 local utility u=0.004255 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9967089169591055, 'loss_val': 0.03408499774059788, 'psi': 0.9958774391218803}-{'f1_val': 0.9953231205637304, 'auprc': 0.9959440467111853, 'loss_val': 0.04029957141753158, 'psi': 0.9955714910227123}
[S11] START round=30 head_norm_before_train=1.728052 cos_to_last_merge=0.7741 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.774
[S11] round=30 local utility u=0.000567 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9983928215863968, 'loss_val': 0.03264343203516335, 'psi': 0.9971425794047799}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986475065988842, 'loss_val': 0.03599234927031598, 'psi': 0.997389555636612}
[S13] START round=30 head_norm_before_train=1.103242 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.011151 metrics={'f1_val': 0.5926435051653701, 'auprc': 0.7523740485550456, 'loss_val': 0.8771000724571075, 'psi': 0.6565357225212403}-{'f1_val': 0.5977290670931833, 'auprc': 0.716257639921044, 'loss_val': 0.8215668969941596, 'psi': 0.6451404962243276}
[S14] START round=30 head_norm_before_train=1.705368 cos_to_last_merge=0.9998 (last merge round=28)
[S14] round=30 local utility u=0.027664 metrics={'f1_val': 0.9974862827730671, 'auprc': 0.9971571752206494, 'loss_val': 0.18442668293715836, 'psi': 0.9973546397521}-{'f1_val': 0.9969987740343681, 'auprc': 0.9971578865379624, 'loss_val': 0.23683225981713227, 'psi': 0.997062419035806}
[S15] START round=30 head_norm_before_train=1.956690 cos_to_last_merge=0.7700 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.770
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7692331596455979, 'auprc': 0.957036236906725, 'loss_val': 0.45434655852183314, 'psi': 0.8443543905500488}-{'f1_val': 0.9713761023590266, 'auprc': 0.9974046533268309, 'loss_val': 0.05007259122017796, 'psi': 0.9817875227461483}
[S16] START round=30 head_norm_before_train=1.200918 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9271092604870546, 'auprc': 0.9883838619710666, 'loss_val': 0.3561140379398969, 'psi': 0.9516191010806594}-{'f1_val': 0.9379432479306843, 'auprc': 0.9882006791467064, 'loss_val': 0.3088495792782016, 'psi': 0.9580462204170932}
[S17] START round=30 head_norm_before_train=1.499759 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.073486 metrics={'f1_val': 0.6613618264703205, 'auprc': 0.8125904613171698, 'loss_val': 0.9701117176397107, 'psi': 0.7218532804090603}-{'f1_val': 0.6527791556173177, 'auprc': 0.8192850376446332, 'loss_val': 1.085671208159083, 'psi': 0.7193815084282439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[S3] not sending this round → trigger blocked (psi=0.995)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:40409
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.657)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0402
[S8] DROPPED delta from S2 (cos=-0.0402 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=0.5062
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.9958
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=-0.0564
[S14] DROPPED delta from S10 (cos=-0.0564 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.6544
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9921 head_norm=1.282171
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.032552e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9909 head_norm=1.292503 delta_norm=0.603255
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.045 → S13@127.0.0.1:40413
[S13] ⇄ pheromone p=0.067 → S16@127.0.0.1:40416
[S5] ⇄ pheromone p=0.235 → S9@127.0.0.1:40410
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9241 head_norm=1.430749
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.931003e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9134 head_norm=1.369398 delta_norm=0.793100
[S4] aggregate: ROLLBACK (f1_val pre=0.924 post=0.913 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.041 → S9@127.0.0.1:40410
[S15] ⇄ pheromone p=0.237 → S16@127.0.0.1:40416
[S3] ⇄ pheromone p=0.068 → S4@127.0.0.1:40404
[S8] ⇄ pheromone p=0.036 → S17@127.0.0.1:40417
[S6] ⇄ pheromone p=0.280 → S11@127.0.0.1:40412
[S7] ⇄ pheromone p=0.146 → S10@127.0.0.1:40411
[S2] ⇄ pheromone p=0.209 → S8@127.0.0.1:40409
[S11] ⇄ pheromone p=0.031 → S14@127.0.0.1:40414
[S10] ⇄ pheromone p=0.010 → S14@127.0.0.1:40414
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9975 head_norm=1.720894
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.011176e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9975 head_norm=1.732347 delta_norm=0.080112
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.089 → S4@127.0.0.1:40404
[S17] ⇄ pheromone p=0.045 → S9@127.0.0.1:40410
[S16] ⇄ pheromone p=0.153 → S8@127.0.0.1:40409
[S2] START round=31 head_norm_before_train=2.091139 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.8264995451716248, 'auprc': 0.8564513857107201, 'loss_val': 0.5052300775725653, 'psi': 0.8384802813872629}-{'f1_val': 0.8322996251540667, 'auprc': 0.9033912916267578, 'loss_val': 0.4663652197600119, 'psi': 0.8607362917431431}
[S3] START round=31 head_norm_before_train=1.938611 (no previous merge yet)
[S3] round=31 local utility u=0.023003 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.9988701515560907, 'loss_val': 0.0367486006173562, 'psi': 0.9979854786682498}-{'f1_val': 0.9924159261378052, 'auprc': 0.9988709954183586, 'loss_val': 0.05287853161934062, 'psi': 0.9949979538500265}
[S4] START round=31 head_norm_before_train=1.369398 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.056424 metrics={'f1_val': 0.9404651295404476, 'auprc': 0.9433915492893622, 'loss_val': 0.2942020172425614, 'psi': 0.9416356974400135}-{'f1_val': 0.9241237061355803, 'auprc': 0.9605788107345952, 'loss_val': 0.36056359483866607, 'psi': 0.9387057479751862}
[S5] START round=31 head_norm_before_train=1.796665 (no previous merge yet)
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.9914656447243804, 'loss_val': 0.15971575579794023, 'psi': 0.8169282187195178}-{'f1_val': 0.43692658691564545, 'auprc': 0.8536113770785988, 'loss_val': 1.0355730001813046, 'psi': 0.6036005029808268}
[S6] START round=31 head_norm_before_train=1.977517 (no previous merge yet)
[S6] round=31 local utility u=0.421147 metrics={'f1_val': 0.6763095029462765, 'auprc': 0.9273798804691862, 'loss_val': 0.7125821413399883, 'psi': 0.7767376539554404}-{'f1_val': 0.5958165039051181, 'auprc': 0.8062344470059468, 'loss_val': 0.7084816159411282, 'psi': 0.6799836811454496}
[S7] START round=31 head_norm_before_train=1.701683 (no previous merge yet)
[S7] round=31 local utility u=0.354843 metrics={'f1_val': 0.5811126119119501, 'auprc': 0.7883967896332663, 'loss_val': 0.6489655077719506, 'psi': 0.6640262830004766}-{'f1_val': 0.496851942306491, 'auprc': 0.779805544829455, 'loss_val': 0.8273141509918424, 'psi': 0.6100333833156766}
[S8] START round=31 head_norm_before_train=1.565240 cos_to_last_merge=0.9929 (last merge round=27)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9836651576079667, 'auprc': 0.9991616071357887, 'loss_val': 0.07242792399041494, 'psi': 0.9898637374190955}-{'f1_val': 0.9921686949136479, 'auprc': 0.9838368282385914, 'loss_val': 0.0745279211209319, 'psi': 0.9888359482436253}
[S9] START round=31 head_norm_before_train=1.292503 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.024271 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9970447493952789, 'loss_val': 0.17926119297074564, 'psi': 0.9973448337644978}-{'f1_val': 0.9921172834657093, 'auprc': 0.9966414722433152, 'loss_val': 0.19402701514501516, 'psi': 0.9939269589767517}
[S10] START round=31 head_norm_before_train=1.889759 cos_to_last_merge=0.9903 (last merge round=25)
[S10] round=31 local utility u=0.001348 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9968631818697914, 'loss_val': 0.03185226244686476, 'psi': 0.9959391450861548}-{'f1_val': 0.9953231205637304, 'auprc': 0.9967089169591055, 'loss_val': 0.03408499774059788, 'psi': 0.9958774391218803}
[S11] START round=31 head_norm_before_train=1.747403 cos_to_last_merge=0.7726 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.773
[S11] round=31 local utility u=0.003752 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.998850463887928, 'loss_val': 0.0289919773396941, 'psi': 0.9975736373040804}-{'f1_val': 0.9963090846170353, 'auprc': 0.9983928215863968, 'loss_val': 0.03264343203516335, 'psi': 0.9971425794047799}
[S13] START round=31 head_norm_before_train=1.145071 cos_to_last_merge=0.9987 (last merge round=29)
[S13] round=31 local utility u=0.195548 metrics={'f1_val': 0.6283038092322453, 'auprc': 0.7293500943502156, 'loss_val': 0.6308937947663262, 'psi': 0.6687223232794334}-{'f1_val': 0.5926435051653701, 'auprc': 0.7523740485550456, 'loss_val': 0.8771000724571075, 'psi': 0.6565357225212403}
[S14] START round=31 head_norm_before_train=1.732347 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.003196 metrics={'f1_val': 0.997288414402867, 'auprc': 0.9956581008032429, 'loss_val': 0.17235004610749272, 'psi': 0.9966362889630174}-{'f1_val': 0.9974862827730671, 'auprc': 0.9971571752206494, 'loss_val': 0.18442668293715836, 'psi': 0.9973546397521}
[S15] START round=31 head_norm_before_train=1.969140 cos_to_last_merge=0.7696 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.770
[S15] round=31 local utility u=0.960238 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9978284974933456, 'loss_val': 0.02132903228025175, 'psi': 0.9971794000298506}-{'f1_val': 0.7692331596455979, 'auprc': 0.957036236906725, 'loss_val': 0.45434655852183314, 'psi': 0.8443543905500488}
[S16] START round=31 head_norm_before_train=1.245481 cos_to_last_merge=0.9993 (last merge round=29)
[S16] round=31 local utility u=0.325694 metrics={'f1_val': 0.9915364364988188, 'auprc': 0.990553624899557, 'loss_val': 0.0977975038043404, 'psi': 0.9911433118591142}-{'f1_val': 0.9271092604870546, 'auprc': 0.9883838619710666, 'loss_val': 0.3561140379398969, 'psi': 0.9516191010806594}
[S17] START round=31 head_norm_before_train=1.557241 cos_to_last_merge=0.9979 (last merge round=29)
[S17] round=31 local utility u=0.116181 metrics={'f1_val': 0.6827431158594439, 'auprc': 0.8419936380277393, 'loss_val': 0.9542469213074971, 'psi': 0.7464433247267621}-{'f1_val': 0.6613618264703205, 'auprc': 0.8125904613171698, 'loss_val': 0.9701117176397107, 'psi': 0.7218532804090603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:40411
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:40410
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:40413
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:40416
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:40412
[S6] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] cosine check vs S16: cos=0.9293
[S13] RECEIVED delta(kind=head bytes=1800) from S9
[S13] cosine check vs S9: cos=0.8668
[S10] RECEIVED delta(kind=head bytes=1805) from S7
[S10] cosine check vs S7: cos=0.9692
[S4] RECEIVED delta(kind=head bytes=1800) from S3
[S4] cosine check vs S3: cos=0.4473
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.6543
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.1413
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=-0.0059
[S11] DROPPED delta from S6 (cos=-0.0059 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S15
[S16] cosine check vs S15: cos=0.8218
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=0.8300
[S17] not sending this round → trigger blocked (psi=0.746)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9837 head_norm=1.602104
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.129231e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9837 head_norm=1.418007 delta_norm=0.312923
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9953 head_norm=1.914513
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.474449e-01
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9953 head_norm=1.796351 delta_norm=0.247445
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9975 head_norm=1.327391
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.560707e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9975 head_norm=1.106753 delta_norm=0.556071
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.6283 head_norm=1.186037
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.314758e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.6658 head_norm=1.214269 delta_norm=0.331476
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9915 head_norm=1.284754
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.501586e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9911 head_norm=1.304184 delta_norm=0.150159
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9405 head_norm=1.430098
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.190125e-01
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9405 head_norm=1.448562 delta_norm=0.919012
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=2.099458 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7424604330818977, 'auprc': 0.8298509073868174, 'loss_val': 0.7993310688136589, 'psi': 0.7774166228038656}-{'f1_val': 0.8264995451716248, 'auprc': 0.8564513857107201, 'loss_val': 0.5052300775725653, 'psi': 0.8384802813872629}
[S3] START round=32 head_norm_before_train=1.959758 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9667522457977621, 'auprc': 0.9983236610632178, 'loss_val': 0.06106618417020777, 'psi': 0.9793808119039444}-{'f1_val': 0.9973956967430226, 'auprc': 0.9988701515560907, 'loss_val': 0.0367486006173562, 'psi': 0.9979854786682498}
[S4] START round=32 head_norm_before_train=1.448562 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.008575 metrics={'f1_val': 0.9416297486746666, 'auprc': 0.9506793719190744, 'loss_val': 0.3059029925348514, 'psi': 0.9452495979724298}-{'f1_val': 0.9404651295404476, 'auprc': 0.9433915492893622, 'loss_val': 0.2942020172425614, 'psi': 0.9416356974400135}
[S5] START round=32 head_norm_before_train=1.799674 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.4261979806429993, 'auprc': 0.8474792863884021, 'loss_val': 1.2752525686739242, 'psi': 0.5947105029411605}-{'f1_val': 0.7005699347162762, 'auprc': 0.9914656447243804, 'loss_val': 0.15971575579794023, 'psi': 0.8169282187195178}
[S6] START round=32 head_norm_before_train=1.993527 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6718883438106574, 'auprc': 0.7544192475424328, 'loss_val': 0.9032203938420259, 'psi': 0.7049007053033676}-{'f1_val': 0.6763095029462765, 'auprc': 0.9273798804691862, 'loss_val': 0.7125821413399883, 'psi': 0.7767376539554404}
[S7] START round=32 head_norm_before_train=1.706122 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5175179872241931, 'auprc': 0.7819207584719401, 'loss_val': 0.7899281903145998, 'psi': 0.6232790957232919}-{'f1_val': 0.5811126119119501, 'auprc': 0.7883967896332663, 'loss_val': 0.6489655077719506, 'psi': 0.6640262830004766}
[S8] START round=32 head_norm_before_train=1.418007 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.002091 metrics={'f1_val': 0.9916639743166928, 'auprc': 0.9886160614383238, 'loss_val': 0.08460261464766955, 'psi': 0.9904448091653452}-{'f1_val': 0.9836651576079667, 'auprc': 0.9991616071357887, 'loss_val': 0.07242792399041494, 'psi': 0.9898637374190955}
[S9] START round=32 head_norm_before_train=1.106753 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9880606630973037, 'auprc': 0.9977599286247533, 'loss_val': 0.2062435603857614, 'psi': 0.9919403693082836}-{'f1_val': 0.9975448900106438, 'auprc': 0.9970447493952789, 'loss_val': 0.17926119297074564, 'psi': 0.9973448337644978}
[S10] START round=32 head_norm_before_train=1.796351 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975613469819868, 'loss_val': 0.04262938215307394, 'psi': 0.9962184111310329}-{'f1_val': 0.9953231205637304, 'auprc': 0.9968631818697914, 'loss_val': 0.03185226244686476, 'psi': 0.9959391450861548}
[S11] START round=32 head_norm_before_train=1.764942 cos_to_last_merge=0.7714 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.771
[S11] round=32 local utility u=0.002597 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.999088624041651, 'loss_val': 0.025963921304854448, 'psi': 0.9978140035924067}-{'f1_val': 0.9967224195815153, 'auprc': 0.998850463887928, 'loss_val': 0.0289919773396941, 'psi': 0.9975736373040804}
[S13] START round=32 head_norm_before_train=1.214269 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5812102264565849, 'auprc': 0.6465123012328745, 'loss_val': 0.902567870041807, 'psi': 0.6073310563671008}-{'f1_val': 0.6283038092322453, 'auprc': 0.7293500943502156, 'loss_val': 0.6308937947663262, 'psi': 0.6687223232794334}
[S14] START round=32 head_norm_before_train=1.749073 cos_to_last_merge=0.9998 (last merge round=30)
[S14] round=32 local utility u=0.021798 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9978580309128734, 'loss_val': 0.13652238111985518, 'psi': 0.997633058995042}-{'f1_val': 0.997288414402867, 'auprc': 0.9956581008032429, 'loss_val': 0.17235004610749272, 'psi': 0.9966362889630174}
[S15] START round=32 head_norm_before_train=1.981473 cos_to_last_merge=0.7691 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.769
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9004674511166857, 'auprc': 0.9959486622451745, 'loss_val': 0.2695761648354021, 'psi': 0.9386599355680812}-{'f1_val': 0.9967466683875206, 'auprc': 0.9978284974933456, 'loss_val': 0.02132903228025175, 'psi': 0.9971794000298506}
[S16] START round=32 head_norm_before_train=1.304184 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.005051 metrics={'f1_val': 0.9908592012438583, 'auprc': 0.9946011064606486, 'loss_val': 0.09577495873279986, 'psi': 0.9923559633305744}-{'f1_val': 0.9915364364988188, 'auprc': 0.990553624899557, 'loss_val': 0.0977975038043404, 'psi': 0.9911433118591142}
[S17] START round=32 head_norm_before_train=1.615863 cos_to_last_merge=0.9930 (last merge round=29)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6521718777850798, 'auprc': 0.8163897131678814, 'loss_val': 1.1310852126414792, 'psi': 0.7178590119382005}-{'f1_val': 0.6827431158594439, 'auprc': 0.8419936380277393, 'loss_val': 0.9542469213074971, 'psi': 0.7464433247267621}
[S16] not sending this round → trigger blocked (psi=0.992)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.945)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:40404
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:40417
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.9966
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] cosine check vs S14: cos=0.4499
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9238
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9416 head_norm=1.507807
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.659202e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9416 head_norm=1.395972 delta_norm=0.865920
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9975 head_norm=1.767379
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.332364e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9975 head_norm=1.772027 delta_norm=0.073324
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.6522 head_norm=1.653879
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.185942e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.6544 head_norm=1.525349 delta_norm=0.318594
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=2.103656 (no previous merge yet)
[S2] round=33 local utility u=0.493765 metrics={'f1_val': 0.8246168371114592, 'auprc': 0.8850733292363804, 'loss_val': 0.47040675639883683, 'psi': 0.8487994339614277}-{'f1_val': 0.7424604330818977, 'auprc': 0.8298509073868174, 'loss_val': 0.7993310688136589, 'psi': 0.7774166228038656}
[S3] START round=33 head_norm_before_train=1.977454 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9988703058344442, 'loss_val': 0.09652574154565291, 'psi': 0.9761931735734499}-{'f1_val': 0.9667522457977621, 'auprc': 0.9983236610632178, 'loss_val': 0.06106618417020777, 'psi': 0.9793808119039444}
[S4] START round=33 head_norm_before_train=1.395972 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9404495000543014, 'auprc': 0.9482800189407146, 'loss_val': 0.29622256055990814, 'psi': 0.9435817076088666}-{'f1_val': 0.9416297486746666, 'auprc': 0.9506793719190744, 'loss_val': 0.3059029925348514, 'psi': 0.9452495979724298}
[S5] START round=33 head_norm_before_train=1.802711 (no previous merge yet)
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9543275085436568, 'loss_val': 0.34813692523088274, 'psi': 0.8020964598209313}-{'f1_val': 0.4261979806429993, 'auprc': 0.8474792863884021, 'loss_val': 1.2752525686739242, 'psi': 0.5947105029411605}
[S6] START round=33 head_norm_before_train=2.006030 (no previous merge yet)
[S6] round=33 local utility u=0.956230 metrics={'f1_val': 0.8412673373289852, 'auprc': 0.904795990017502, 'loss_val': 0.4581642156755883, 'psi': 0.8666787984043919}-{'f1_val': 0.6718883438106574, 'auprc': 0.7544192475424328, 'loss_val': 0.9032203938420259, 'psi': 0.7049007053033676}
[S7] START round=33 head_norm_before_train=1.711302 (no previous merge yet)
[S7] round=33 local utility u=0.618344 metrics={'f1_val': 0.6521002114532076, 'auprc': 0.8168168002921361, 'loss_val': 0.46542148104100545, 'psi': 0.717986846988779}-{'f1_val': 0.5175179872241931, 'auprc': 0.7819207584719401, 'loss_val': 0.7899281903145998, 'psi': 0.6232790957232919}
[S8] START round=33 head_norm_before_train=1.456388 cos_to_last_merge=0.9995 (last merge round=31)
[S8] round=33 local utility u=0.017022 metrics={'f1_val': 0.9916739394511156, 'auprc': 0.9954728699805749, 'loss_val': 0.0711887169551618, 'psi': 0.9931935116628994}-{'f1_val': 0.9916639743166928, 'auprc': 0.9886160614383238, 'loss_val': 0.08460261464766955, 'psi': 0.9904448091653452}
[S9] START round=33 head_norm_before_train=1.144180 cos_to_last_merge=0.9988 (last merge round=31)
[S9] round=33 local utility u=0.051138 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9961923751979112, 'loss_val': 0.1561698195806804, 'psi': 0.9970038840855507}-{'f1_val': 0.9880606630973037, 'auprc': 0.9977599286247533, 'loss_val': 0.2062435603857614, 'psi': 0.9919403693082836}
[S10] START round=33 head_norm_before_train=1.821876 cos_to_last_merge=0.9998 (last merge round=31)
[S10] round=33 local utility u=0.002391 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9973814242670476, 'loss_val': 0.03730811153081643, 'psi': 0.9961464420450572}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975613469819868, 'loss_val': 0.04262938215307394, 'psi': 0.9962184111310329}
[S11] START round=33 head_norm_before_train=1.779685 cos_to_last_merge=0.7703 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.770
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9986438131995234, 'loss_val': 0.02585469867194869, 'psi': 0.9974909770287186}-{'f1_val': 0.9969642566262439, 'auprc': 0.999088624041651, 'loss_val': 0.025963921304854448, 'psi': 0.9978140035924067}
[S13] START round=33 head_norm_before_train=1.235480 cos_to_last_merge=0.9994 (last merge round=31)
[S13] round=33 local utility u=0.264572 metrics={'f1_val': 0.6168619271823741, 'auprc': 0.7681884901384746, 'loss_val': 0.9523619571785578, 'psi': 0.6773925523648143}-{'f1_val': 0.5812102264565849, 'auprc': 0.6465123012328745, 'loss_val': 0.902567870041807, 'psi': 0.6073310563671008}
[S14] START round=33 head_norm_before_train=1.772027 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.006380 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9978210176654514, 'loss_val': 0.12465942216753931, 'psi': 0.9977190778960927}-{'f1_val': 0.9974830777164877, 'auprc': 0.9978580309128734, 'loss_val': 0.13652238111985518, 'psi': 0.997633058995042}
[S15] START round=33 head_norm_before_train=1.992239 cos_to_last_merge=0.7689 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.769
[S15] round=33 local utility u=0.378934 metrics={'f1_val': 0.9870890720085022, 'auprc': 0.9972163928908259, 'loss_val': 0.03524077492744037, 'psi': 0.9911400003614317}-{'f1_val': 0.9004674511166857, 'auprc': 0.9959486622451745, 'loss_val': 0.2695761648354021, 'psi': 0.9386599355680812}
[S16] START round=33 head_norm_before_train=1.338617 cos_to_last_merge=0.9996 (last merge round=31)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8638636380012689, 'auprc': 0.978929607758864, 'loss_val': 0.5725288957111647, 'psi': 0.9098900259043068}-{'f1_val': 0.9908592012438583, 'auprc': 0.9946011064606486, 'loss_val': 0.09577495873279986, 'psi': 0.9923559633305744}
[S17] START round=33 head_norm_before_train=1.525349 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.129834 metrics={'f1_val': 0.6708287354135468, 'auprc': 0.8132594367801678, 'loss_val': 0.9739684834023999, 'psi': 0.7278010159601952}-{'f1_val': 0.6521718777850798, 'auprc': 0.8163897131678814, 'loss_val': 1.1310852126414792, 'psi': 0.7178590119382005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:40414
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:40417
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:40413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:40411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:40410
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.7790
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=-0.0062
[S11] DROPPED delta from S6 (cos=-0.0062 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S13
[S16] cosine check vs S13: cos=0.8767
[S16] RECEIVED delta(kind=head bytes=1793) from S15
[S16] cosine check vs S15: cos=0.8697
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=-0.0533
[S14] DROPPED delta from S10 (cos=-0.0533 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.9669
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0491
[S8] DROPPED delta from S2 (cos=-0.0491 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=0.9248
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.9847
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] cosine check vs S14: cos=0.8697
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:40410
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] cosine check vs S17: cos=0.7387
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9404 head_norm=1.450079
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.460210e-01
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9404 head_norm=1.568650 delta_norm=0.446021
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9975 head_norm=1.179272
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.916304e-01
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.9975 head_norm=1.263786 delta_norm=0.291630
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9953 head_norm=1.854106
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.704391e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9953 head_norm=1.778448 delta_norm=0.170439
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.6169 head_norm=1.261912
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.401842e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.6167 head_norm=1.197441 delta_norm=0.240184
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.8639 head_norm=1.369789
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.331619e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.8625 head_norm=1.403027 delta_norm=0.133162
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.6708 head_norm=1.570152
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.003927e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.6717 head_norm=1.525792 delta_norm=0.200393
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=2.114276 (no previous merge yet)
[S2] round=34 local utility u=0.082078 metrics={'f1_val': 0.8320388603714196, 'auprc': 0.915915222009678, 'loss_val': 0.4433095582556154, 'psi': 0.865589405026723}-{'f1_val': 0.8246168371114592, 'auprc': 0.8850733292363804, 'loss_val': 0.47040675639883683, 'psi': 0.8487994339614277}
[S3] START round=34 head_norm_before_train=1.985574 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9046503603151306, 'auprc': 0.9988426592274894, 'loss_val': 0.1710396201560252, 'psi': 0.9423272798800741}-{'f1_val': 0.9610750853994537, 'auprc': 0.9988703058344442, 'loss_val': 0.09652574154565291, 'psi': 0.9761931735734499}
[S4] START round=34 head_norm_before_train=1.568650 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.047916 metrics={'f1_val': 0.9430227867169074, 'auprc': 0.9710373472252567, 'loss_val': 0.2841022621931612, 'psi': 0.9542286109202471}-{'f1_val': 0.9404495000543014, 'auprc': 0.9482800189407146, 'loss_val': 0.29622256055990814, 'psi': 0.9435817076088666}
[S5] START round=34 head_norm_before_train=1.803082 (no previous merge yet)
[S5] round=34 local utility u=0.140243 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9923071303459349, 'loss_val': 0.17986906968825514, 'psi': 0.8171161545277732}-{'f1_val': 0.7006090940057808, 'auprc': 0.9543275085436568, 'loss_val': 0.34813692523088274, 'psi': 0.8020964598209313}
[S6] START round=34 head_norm_before_train=2.021410 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7408363245550917, 'auprc': 0.8726727518995521, 'loss_val': 0.7078763245278716, 'psi': 0.7935708954928758}-{'f1_val': 0.8412673373289852, 'auprc': 0.904795990017502, 'loss_val': 0.4581642156755883, 'psi': 0.8666787984043919}
[S7] START round=34 head_norm_before_train=1.716433 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.4673917178708402, 'auprc': 0.7808532883197792, 'loss_val': 0.8566089021267864, 'psi': 0.5927763460504158}-{'f1_val': 0.6521002114532076, 'auprc': 0.8168168002921361, 'loss_val': 0.46542148104100545, 'psi': 0.717986846988779}
[S8] START round=34 head_norm_before_train=1.506991 cos_to_last_merge=0.9976 (last merge round=31)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9918205515801142, 'auprc': 0.9847953630653989, 'loss_val': 0.062255357125258315, 'psi': 0.989010476174228}-{'f1_val': 0.9916739394511156, 'auprc': 0.9954728699805749, 'loss_val': 0.0711887169551618, 'psi': 0.9931935116628994}
[S9] START round=34 head_norm_before_train=1.263786 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.992714837543047, 'auprc': 0.9976019123260543, 'loss_val': 0.15172013786698274, 'psi': 0.99466966745625}-{'f1_val': 0.9975448900106438, 'auprc': 0.9961923751979112, 'loss_val': 0.1561698195806804, 'psi': 0.9970038840855507}
[S10] START round=34 head_norm_before_train=1.778448 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9970070097766456, 'loss_val': 0.04667060537787646, 'psi': 0.9959966762488964}-{'f1_val': 0.9953231205637304, 'auprc': 0.9973814242670476, 'loss_val': 0.03730811153081643, 'psi': 0.9961464420450572}
[S11] START round=34 head_norm_before_train=1.794340 cos_to_last_merge=0.7691 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.769
[S11] round=34 local utility u=0.001230 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987164298545957, 'loss_val': 0.02361158431628346, 'psi': 0.9975200236907475}-{'f1_val': 0.9967224195815153, 'auprc': 0.9986438131995234, 'loss_val': 0.02585469867194869, 'psi': 0.9974909770287186}
[S13] START round=34 head_norm_before_train=1.197441 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6122784030900126, 'auprc': 0.5858351780108638, 'loss_val': 0.811121120403417, 'psi': 0.601701113058353}-{'f1_val': 0.6168619271823741, 'auprc': 0.7681884901384746, 'loss_val': 0.9523619571785578, 'psi': 0.6773925523648143}
[S14] START round=34 head_norm_before_train=1.793450 cos_to_last_merge=0.9998 (last merge round=32)
[S14] round=34 local utility u=0.009564 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9978338507340728, 'loss_val': 0.10702663734754228, 'psi': 0.997869843729958}-{'f1_val': 0.9976511180498535, 'auprc': 0.9978210176654514, 'loss_val': 0.12465942216753931, 'psi': 0.9977190778960927}
[S15] START round=34 head_norm_before_train=2.002875 cos_to_last_merge=0.7684 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.768
[S15] round=34 local utility u=0.032758 metrics={'f1_val': 0.9960178881123269, 'auprc': 0.998797145733735, 'loss_val': 0.02803964447696103, 'psi': 0.9971295911608902}-{'f1_val': 0.9870890720085022, 'auprc': 0.9972163928908259, 'loss_val': 0.03524077492744037, 'psi': 0.9911400003614317}
[S16] START round=34 head_norm_before_train=1.403027 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8528192034808504, 'auprc': 0.9728193258175704, 'loss_val': 0.6947485211384384, 'psi': 0.9008192524155384}-{'f1_val': 0.8638636380012689, 'auprc': 0.978929607758864, 'loss_val': 0.5725288957111647, 'psi': 0.9098900259043068}
[S17] START round=34 head_norm_before_train=1.525792 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.153554 metrics={'f1_val': 0.6895844538632317, 'auprc': 0.8466765514898735, 'loss_val': 0.879646769832235, 'psi': 0.7524212929138885}-{'f1_val': 0.6708287354135468, 'auprc': 0.8132594367801678, 'loss_val': 0.9739684834023999, 'psi': 0.7278010159601952}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.817)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.997)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.866)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S14] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:40414
[S4] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S4
[S9] cosine check vs S4: cos=0.2052
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.9966
[S17] not sending this round → trigger blocked (psi=0.752)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9979 head_norm=1.818016
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.524148e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9979 head_norm=1.811170 delta_norm=0.075241
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9927 head_norm=1.299755
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.249095e-01
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9927 head_norm=1.133467 delta_norm=0.924909
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=2.123995 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8366344835701561, 'auprc': 0.8411703712663068, 'loss_val': 0.36877408434385384, 'psi': 0.8384488386486164}-{'f1_val': 0.8320388603714196, 'auprc': 0.915915222009678, 'loss_val': 0.4433095582556154, 'psi': 0.865589405026723}
[S3] START round=35 head_norm_before_train=1.991918 (no previous merge yet)
[S3] round=35 local utility u=0.349628 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9988699979668567, 'loss_val': 0.030997310305054305, 'psi': 0.9982513556666299}-{'f1_val': 0.9046503603151306, 'auprc': 0.9988426592274894, 'loss_val': 0.1710396201560252, 'psi': 0.9423272798800741}
[S4] START round=35 head_norm_before_train=1.609673 cos_to_last_merge=0.9993 (last merge round=33)
[S4] round=35 local utility u=0.012407 metrics={'f1_val': 0.9507148922115511, 'auprc': 0.9609035964665871, 'loss_val': 0.2750391266780026, 'psi': 0.9547903739135655}-{'f1_val': 0.9430227867169074, 'auprc': 0.9710373472252567, 'loss_val': 0.2841022621931612, 'psi': 0.9542286109202471}
[S5] START round=35 head_norm_before_train=1.802877 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.42576721121137656, 'auprc': 0.8534038156547008, 'loss_val': 1.22396592745454, 'psi': 0.5968218529887063}-{'f1_val': 0.7003221706489986, 'auprc': 0.9923071303459349, 'loss_val': 0.17986906968825514, 'psi': 0.8171161545277732}
[S6] START round=35 head_norm_before_train=2.036062 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.44126754382863703, 'auprc': 0.7615294353280531, 'loss_val': 1.2303812354147505, 'psi': 0.5693723004284035}-{'f1_val': 0.7408363245550917, 'auprc': 0.8726727518995521, 'loss_val': 0.7078763245278716, 'psi': 0.7935708954928758}
[S7] START round=35 head_norm_before_train=1.725484 (no previous merge yet)
[S7] round=35 local utility u=0.664748 metrics={'f1_val': 0.6322151754852339, 'auprc': 0.7943533480071576, 'loss_val': 0.5565531471741427, 'psi': 0.6970704444940035}-{'f1_val': 0.4673917178708402, 'auprc': 0.7808532883197792, 'loss_val': 0.8566089021267864, 'psi': 0.5927763460504158}
[S8] START round=35 head_norm_before_train=1.557334 cos_to_last_merge=0.9949 (last merge round=31)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9794932345022554, 'auprc': 0.9989370525113552, 'loss_val': 0.08212490220805406, 'psi': 0.9872707617058953}-{'f1_val': 0.9918205515801142, 'auprc': 0.9847953630653989, 'loss_val': 0.062255357125258315, 'psi': 0.989010476174228}
[S9] START round=35 head_norm_before_train=1.133467 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.002047 metrics={'f1_val': 0.9972923331772335, 'auprc': 0.9992360948326251, 'loss_val': 0.179992917803026, 'psi': 0.9980698378393902}-{'f1_val': 0.992714837543047, 'auprc': 0.9976019123260543, 'loss_val': 0.15172013786698274, 'psi': 0.99466966745625}
[S10] START round=35 head_norm_before_train=1.813269 cos_to_last_merge=0.9994 (last merge round=33)
[S10] round=35 local utility u=0.004867 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9973056514872111, 'loss_val': 0.037832920912200856, 'psi': 0.9961161329331226}-{'f1_val': 0.9953231205637304, 'auprc': 0.9970070097766456, 'loss_val': 0.04667060537787646, 'psi': 0.9959966762488964}
[S11] START round=35 head_norm_before_train=1.807434 cos_to_last_merge=0.7680 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.768
[S11] round=35 local utility u=0.002075 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9990929694053465, 'loss_val': 0.02204131106892897, 'psi': 0.9978157417378849}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987164298545957, 'loss_val': 0.02361158431628346, 'psi': 0.9975200236907475}
[S13] START round=35 head_norm_before_train=1.226805 cos_to_last_merge=0.9992 (last merge round=33)
[S13] round=35 local utility u=0.586322 metrics={'f1_val': 0.7152957144206753, 'auprc': 0.7688445627981125, 'loss_val': 0.8056094814804857, 'psi': 0.7367152537716501}-{'f1_val': 0.6122784030900126, 'auprc': 0.5858351780108638, 'loss_val': 0.811121120403417, 'psi': 0.601701113058353}
[S14] START round=35 head_norm_before_train=1.811170 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9978858681210765, 'loss_val': 0.10593702485863175, 'psi': 0.9977453217090704}-{'f1_val': 0.9978938390605482, 'auprc': 0.9978338507340728, 'loss_val': 0.10702663734754228, 'psi': 0.997869843729958}
[S15] START round=35 head_norm_before_train=2.016314 cos_to_last_merge=0.7678 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.768
[S15] round=35 local utility u=0.005554 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981805168448719, 'loss_val': 0.019454459081359, 'psi': 0.997320207770461}-{'f1_val': 0.9960178881123269, 'auprc': 0.998797145733735, 'loss_val': 0.02803964447696103, 'psi': 0.9971295911608902}
[S16] START round=35 head_norm_before_train=1.431027 cos_to_last_merge=0.9998 (last merge round=33)
[S16] round=35 local utility u=0.082933 metrics={'f1_val': 0.8590339714745696, 'auprc': 0.9879871570658804, 'loss_val': 0.611674872187109, 'psi': 0.910615245711094}-{'f1_val': 0.8528192034808504, 'auprc': 0.9728193258175704, 'loss_val': 0.6947485211384384, 'psi': 0.9008192524155384}
[S17] START round=35 head_norm_before_train=1.586476 cos_to_last_merge=0.9968 (last merge round=33)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6921098132048917, 'auprc': 0.8470345848756595, 'loss_val': 0.9315734327366647, 'psi': 0.7540797218731988}-{'f1_val': 0.6895844538632317, 'auprc': 0.8466765514898735, 'loss_val': 0.879646769832235, 'psi': 0.7524212929138885}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:40409
[S4] not sending this round → trigger blocked (psi=0.955)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:40413
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:40414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:40416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:40411
[S10] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.9626
[S13] RECEIVED delta(kind=head bytes=1802) from S9
[S13] cosine check vs S9: cos=0.8031
[S10] RECEIVED delta(kind=head bytes=1806) from S7
[S10] cosine check vs S7: cos=0.9879
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] cosine check vs S3: cos=0.2387
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=0.8191
[S16] RECEIVED delta(kind=head bytes=1793) from S15
[S16] cosine check vs S15: cos=0.9003
[S14] RECEIVED delta(kind=head bytes=1807) from S10
[S14] cosine check vs S10: cos=-0.0544
[S14] DROPPED delta from S10 (cos=-0.0544 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.145 → S8@127.0.0.1:40409
[S11] ⇄ pheromone p=0.011 → S14@127.0.0.1:40414
[S6] ⇄ pheromone p=0.249 → S11@127.0.0.1:40412
[S5] ⇄ pheromone p=0.309 → S9@127.0.0.1:40410
[S14] ⇄ pheromone p=0.034 → S4@127.0.0.1:40404
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9795 head_norm=1.595262
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.199019e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9798 head_norm=1.510810 delta_norm=0.219902
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.014 → S17@127.0.0.1:40417
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9507 head_norm=1.635654
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.130272e+00
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9511 head_norm=1.434593 delta_norm=1.130272
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.029 → S9@127.0.0.1:40410
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.9953 head_norm=1.849298
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.505751e-01
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.9953 head_norm=1.787141 delta_norm=0.150575
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.005 → S14@127.0.0.1:40414
[S7] ⇄ pheromone p=0.289 → S10@127.0.0.1:40411
[S9] ⇄ pheromone p=0.024 → S13@127.0.0.1:40413
[S3] ⇄ pheromone p=0.094 → S4@127.0.0.1:40404
[S15] ⇄ pheromone p=0.211 → S16@127.0.0.1:40416
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.8590 head_norm=1.454974
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.239867e-02
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.8582 head_norm=1.443803 delta_norm=0.092399
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.094 → S8@127.0.0.1:40409
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.7153 head_norm=1.253582
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.826863e-01
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.6277 head_norm=1.152511 delta_norm=0.382686
[S13] aggregate: ROLLBACK (f1_val pre=0.715 post=0.628 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.189 → S16@127.0.0.1:40416
[S17] ⇄ pheromone p=0.066 → S9@127.0.0.1:40410
[S2] START round=36 head_norm_before_train=2.137027 (no previous merge yet)
[S2] round=36 local utility u=0.008724 metrics={'f1_val': 0.8458522087981015, 'auprc': 0.8280990552429986, 'loss_val': 0.36741925603213116, 'psi': 0.8387509473760604}-{'f1_val': 0.8366344835701561, 'auprc': 0.8411703712663068, 'loss_val': 0.36877408434385384, 'psi': 0.8384488386486164}
[S3] START round=36 head_norm_before_train=1.998944 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9383814944246931, 'auprc': 0.998936565377517, 'loss_val': 0.1404870803428156, 'psi': 0.9626035228058226}-{'f1_val': 0.9978389274664787, 'auprc': 0.9988699979668567, 'loss_val': 0.030997310305054305, 'psi': 0.9982513556666299}
[S4] START round=36 head_norm_before_train=1.434593 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9235868470511698, 'auprc': 0.9173514372257541, 'loss_val': 0.36228715156180386, 'psi': 0.9210926831210035}-{'f1_val': 0.9507148922115511, 'auprc': 0.9609035964665871, 'loss_val': 0.2750391266780026, 'psi': 0.9547903739135655}
[S5] START round=36 head_norm_before_train=1.802077 (no previous merge yet)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9909367923198723, 'loss_val': 0.21369495271601557, 'psi': 0.8166192498598772}-{'f1_val': 0.42576721121137656, 'auprc': 0.8534038156547008, 'loss_val': 1.22396592745454, 'psi': 0.5968218529887063}
[S6] START round=36 head_norm_before_train=2.053125 (no previous merge yet)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.9391450685482934, 'auprc': 0.9647121387223964, 'loss_val': 0.1677958351111869, 'psi': 0.9493718966179345}-{'f1_val': 0.44126754382863703, 'auprc': 0.7615294353280531, 'loss_val': 1.2303812354147505, 'psi': 0.5693723004284035}
[S7] START round=36 head_norm_before_train=1.735853 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6287273229387997, 'auprc': 0.7945541981986044, 'loss_val': 0.5744756256962636, 'psi': 0.6950580730427216}-{'f1_val': 0.6322151754852339, 'auprc': 0.7943533480071576, 'loss_val': 0.5565531471741427, 'psi': 0.6970704444940035}
[S8] START round=36 head_norm_before_train=1.510810 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.016879 metrics={'f1_val': 0.9925364588750162, 'auprc': 0.9837037960801809, 'loss_val': 0.08092576435668705, 'psi': 0.989003393757082}-{'f1_val': 0.9794932345022554, 'auprc': 0.9989370525113552, 'loss_val': 0.08212490220805406, 'psi': 0.9872707617058953}
[S9] START round=36 head_norm_before_train=1.173879 cos_to_last_merge=0.9987 (last merge round=34)
[S9] round=36 local utility u=0.019503 metrics={'f1_val': 0.9964645815439231, 'auprc': 0.9992379003290405, 'loss_val': 0.1360260673548215, 'psi': 0.99757390905797}-{'f1_val': 0.9972923331772335, 'auprc': 0.9992360948326251, 'loss_val': 0.179992917803026, 'psi': 0.9980698378393902}
[S10] START round=36 head_norm_before_train=1.787141 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9971057982191606, 'loss_val': 0.04364332727834842, 'psi': 0.9960361916259024}-{'f1_val': 0.9953231205637304, 'auprc': 0.9973056514872111, 'loss_val': 0.037832920912200856, 'psi': 0.9961161329331226}
[S11] START round=36 head_norm_before_train=1.819147 cos_to_last_merge=0.7670 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.767
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9987565907976581, 'loss_val': 0.021969195548416722, 'psi': 0.9974331893161216}-{'f1_val': 0.9969642566262439, 'auprc': 0.9990929694053465, 'loss_val': 0.02204131106892897, 'psi': 0.9978157417378849}
[S13] START round=36 head_norm_before_train=1.152511 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6153760915203651, 'auprc': 0.65523909109623, 'loss_val': 0.8754290845116809, 'psi': 0.6313212913507111}-{'f1_val': 0.7152957144206753, 'auprc': 0.7688445627981125, 'loss_val': 0.8056094814804857, 'psi': 0.7367152537716501}
[S14] START round=36 head_norm_before_train=1.836125 cos_to_last_merge=0.9998 (last merge round=34)
[S14] round=36 local utility u=0.009218 metrics={'f1_val': 0.9978910992781401, 'auprc': 0.9974877784749878, 'loss_val': 0.08774446740252287, 'psi': 0.9977297709568793}-{'f1_val': 0.9976516241010662, 'auprc': 0.9978858681210765, 'loss_val': 0.10593702485863175, 'psi': 0.9977453217090704}
[S15] START round=36 head_norm_before_train=2.029258 cos_to_last_merge=0.7673 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.767
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979885042217407, 'loss_val': 0.02070876001229167, 'psi': 0.9972434027212086}-{'f1_val': 0.9967466683875206, 'auprc': 0.9981805168448719, 'loss_val': 0.019454459081359, 'psi': 0.997320207770461}
[S16] START round=36 head_norm_before_train=1.443803 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.848628501039776, 'auprc': 0.9685452667808135, 'loss_val': 0.7699196893567033, 'psi': 0.896595207336191}-{'f1_val': 0.8590339714745696, 'auprc': 0.9879871570658804, 'loss_val': 0.611674872187109, 'psi': 0.910615245711094}
[S17] START round=36 head_norm_before_train=1.651820 cos_to_last_merge=0.9899 (last merge round=33)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.669671242335377, 'auprc': 0.8289368983170413, 'loss_val': 1.0916893526032032, 'psi': 0.7333775047280428}-{'f1_val': 0.6921098132048917, 'auprc': 0.8470345848756595, 'loss_val': 0.9315734327366647, 'psi': 0.7540797218731988}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:40417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:40404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:40412
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:40409
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=-0.0460
[S8] DROPPED delta from S2 (cos=-0.0460 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] cosine check vs S14: cos=0.5540
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=-0.0063
[S11] DROPPED delta from S6 (cos=-0.0063 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.4705
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9525
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9236 head_norm=1.468236
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.047429e-01
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9200 head_norm=1.470062 delta_norm=0.804743
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=36 metric=0.9965 head_norm=1.217640
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.159840e-01
[S9] stored merged vector for next round verification (round=36)
[S9] DEBUG after merge:  round=36 metric=0.9973 head_norm=1.302948 delta_norm=0.815984
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.6697 head_norm=1.703935
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.621039e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.6714 head_norm=1.607444 delta_norm=0.262104
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.149341 (no previous merge yet)
[S2] round=37 local utility u=0.058532 metrics={'f1_val': 0.8624749177728903, 'auprc': 0.8297524006707333, 'loss_val': 0.35505082480480865, 'psi': 0.8493859109320274}-{'f1_val': 0.8458522087981015, 'auprc': 0.8280990552429986, 'loss_val': 0.36741925603213116, 'psi': 0.8387509473760604}
[S3] START round=37 head_norm_before_train=2.007990 (no previous merge yet)
[S3] round=37 local utility u=0.143367 metrics={'f1_val': 0.9739845981079245, 'auprc': 0.9988697663496463, 'loss_val': 0.06717117883199096, 'psi': 0.9839386654046132}-{'f1_val': 0.9383814944246931, 'auprc': 0.998936565377517, 'loss_val': 0.1404870803428156, 'psi': 0.9626035228058226}
[S4] START round=37 head_norm_before_train=1.470062 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.125397 metrics={'f1_val': 0.9407508479159031, 'auprc': 0.9438720248965642, 'loss_val': 0.29403861666570147, 'psi': 0.9419993187081676}-{'f1_val': 0.9235868470511698, 'auprc': 0.9173514372257541, 'loss_val': 0.36228715156180386, 'psi': 0.9210926831210035}
[S5] START round=37 head_norm_before_train=1.801211 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.6782421636649721, 'auprc': 0.8725828485520932, 'loss_val': 0.3390868395406384, 'psi': 0.7559784376198206}-{'f1_val': 0.700407554886547, 'auprc': 0.9909367923198723, 'loss_val': 0.21369495271601557, 'psi': 0.8166192498598772}
[S6] START round=37 head_norm_before_train=2.063044 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6847692878974152, 'auprc': 0.7379058682467602, 'loss_val': 1.0560709482187083, 'psi': 0.7060239200371532}-{'f1_val': 0.9391450685482934, 'auprc': 0.9647121387223964, 'loss_val': 0.1677958351111869, 'psi': 0.9493718966179345}
[S7] START round=37 head_norm_before_train=1.744404 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.48755006516670685, 'auprc': 0.7812674003992078, 'loss_val': 0.9265111933070356, 'psi': 0.6050369992597073}-{'f1_val': 0.6287273229387997, 'auprc': 0.7945541981986044, 'loss_val': 0.5744756256962636, 'psi': 0.6950580730427216}
[S8] START round=37 head_norm_before_train=1.549759 cos_to_last_merge=0.9995 (last merge round=35)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9833148225481475, 'auprc': 0.9990124022227616, 'loss_val': 0.07428372545981883, 'psi': 0.9895938544179932}-{'f1_val': 0.9925364588750162, 'auprc': 0.9837037960801809, 'loss_val': 0.08092576435668705, 'psi': 0.989003393757082}
[S9] START round=37 head_norm_before_train=1.302948 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9972923331772335, 'auprc': 0.9971277239083614, 'loss_val': 0.13547504319515408, 'psi': 0.9972264894696847}-{'f1_val': 0.9964645815439231, 'auprc': 0.9992379003290405, 'loss_val': 0.1360260673548215, 'psi': 0.99757390905797}
[S10] START round=37 head_norm_before_train=1.822803 cos_to_last_merge=0.9994 (last merge round=35)
[S10] round=37 local utility u=0.003279 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9969689370285864, 'loss_val': 0.036675735573417655, 'psi': 0.9959814471496727}-{'f1_val': 0.9953231205637304, 'auprc': 0.9971057982191606, 'loss_val': 0.04364332727834842, 'psi': 0.9960361916259024}
[S11] START round=37 head_norm_before_train=1.830847 cos_to_last_merge=0.7660 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.766
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9984293568983631, 'loss_val': 0.023221868209188833, 'psi': 0.9973022957564036}-{'f1_val': 0.9965509216617638, 'auprc': 0.9987565907976581, 'loss_val': 0.021969195548416722, 'psi': 0.9974331893161216}
[S13] START round=37 head_norm_before_train=1.181661 cos_to_last_merge=0.9992 (last merge round=35)
[S13] round=37 local utility u=0.125017 metrics={'f1_val': 0.5979025881974577, 'auprc': 0.7802494711573366, 'loss_val': 0.8955845911394466, 'psi': 0.6708413413814092}-{'f1_val': 0.6153760915203651, 'auprc': 0.65523909109623, 'loss_val': 0.8754290845116809, 'psi': 0.6313212913507111}
[S14] START round=37 head_norm_before_train=1.860556 cos_to_last_merge=0.9993 (last merge round=34)
[S14] round=37 local utility u=0.007554 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9974696721916905, 'loss_val': 0.07114135787815158, 'psi': 0.9975785397065884}-{'f1_val': 0.9978910992781401, 'auprc': 0.9974877784749878, 'loss_val': 0.08774446740252287, 'psi': 0.9977297709568793}
[S15] START round=37 head_norm_before_train=2.042607 cos_to_last_merge=0.7668 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.767
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.701112287123778, 'auprc': 0.8715532100379713, 'loss_val': 0.6697236841087382, 'psi': 0.7692886562894554}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979885042217407, 'loss_val': 0.02070876001229167, 'psi': 0.9972434027212086}
[S16] START round=37 head_norm_before_train=1.463736 cos_to_last_merge=0.9999 (last merge round=35)
[S16] round=37 local utility u=0.512712 metrics={'f1_val': 0.9314511470421722, 'auprc': 0.9940013916517706, 'loss_val': 0.31779911941362676, 'psi': 0.9564712448860115}-{'f1_val': 0.848628501039776, 'auprc': 0.9685452667808135, 'loss_val': 0.7699196893567033, 'psi': 0.896595207336191}
[S17] START round=37 head_norm_before_train=1.607444 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.193821 metrics={'f1_val': 0.6878942153872447, 'auprc': 0.859052339202343, 'loss_val': 0.903731794564712, 'psi': 0.756357464913284}-{'f1_val': 0.669671242335377, 'auprc': 0.8289368983170413, 'loss_val': 1.0916893526032032, 'psi': 0.7333775047280428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.849)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:40403
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.8641
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.9953
[S3] RECEIVED delta(kind=head bytes=1803) from S4
[S3] cosine check vs S4: cos=0.4163
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.9892
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:40415
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.9119
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:40409
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9788
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9833 head_norm=1.582287
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.696332e-01
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9830 head_norm=1.606767 delta_norm=0.169633
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.9973 head_norm=1.343203
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.389300e-01
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.9969 head_norm=1.233329 delta_norm=0.338930
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9740 head_norm=2.016566
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.759824e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9735 head_norm=1.489785 delta_norm=0.975982
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.7011 head_norm=2.054696
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.644739e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.7011 head_norm=1.731042 delta_norm=0.464474
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9966 head_norm=1.840368
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.297945e-02
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9966 head_norm=1.860663 delta_norm=0.092979
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.4876 head_norm=1.751685
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.436660e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.4945 head_norm=1.801451 delta_norm=0.143666
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=2.162761 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.5589111069331522, 'auprc': 0.8058552821548417, 'loss_val': 1.8961157465878347, 'psi': 0.657688777021828}-{'f1_val': 0.8624749177728903, 'auprc': 0.8297524006707333, 'loss_val': 0.35505082480480865, 'psi': 0.8493859109320274}
[S3] START round=38 head_norm_before_train=1.489785 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.044831 metrics={'f1_val': 0.9966508675148381, 'auprc': 0.9988688565342219, 'loss_val': 0.11350506104186535, 'psi': 0.9975380631225916}-{'f1_val': 0.9739845981079245, 'auprc': 0.9988697663496463, 'loss_val': 0.06717117883199096, 'psi': 0.9839386654046132}
[S4] START round=38 head_norm_before_train=1.509126 cos_to_last_merge=0.9994 (last merge round=36)
[S4] round=38 local utility u=0.037707 metrics={'f1_val': 0.9418730320097954, 'auprc': 0.9651251228078201, 'loss_val': 0.28911752270519087, 'psi': 0.9511738683290054}-{'f1_val': 0.9407508479159031, 'auprc': 0.9438720248965642, 'loss_val': 0.29403861666570147, 'psi': 0.9419993187081676}
[S5] START round=38 head_norm_before_train=1.803970 (no previous merge yet)
[S5] round=38 local utility u=0.306728 metrics={'f1_val': 0.7344526323765078, 'auprc': 0.9502048222794208, 'loss_val': 0.295760119644278, 'psi': 0.820753508337673}-{'f1_val': 0.6782421636649721, 'auprc': 0.8725828485520932, 'loss_val': 0.3390868395406384, 'psi': 0.7559784376198206}
[S6] START round=38 head_norm_before_train=2.076348 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6116025151002564, 'auprc': 0.7534340670269379, 'loss_val': 0.9040312521757896, 'psi': 0.6683351358709291}-{'f1_val': 0.6847692878974152, 'auprc': 0.7379058682467602, 'loss_val': 1.0560709482187083, 'psi': 0.7060239200371532}
[S7] START round=38 head_norm_before_train=1.801451 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.630845 metrics={'f1_val': 0.6308714842532341, 'auprc': 0.7965373251685135, 'loss_val': 0.5705590694139256, 'psi': 0.6971378206193459}-{'f1_val': 0.48755006516670685, 'auprc': 0.7812674003992078, 'loss_val': 0.9265111933070356, 'psi': 0.6050369992597073}
[S8] START round=38 head_norm_before_train=1.606767 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.017288 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.9852612666892877, 'loss_val': 0.056088998456613984, 'psi': 0.989856831192437}-{'f1_val': 0.9833148225481475, 'auprc': 0.9990124022227616, 'loss_val': 0.07428372545981883, 'psi': 0.9895938544179932}
[S9] START round=38 head_norm_before_train=1.233329 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.020797 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9995926882017051, 'loss_val': 0.09781140614131616, 'psi': 0.9978660209432717}-{'f1_val': 0.9972923331772335, 'auprc': 0.9971277239083614, 'loss_val': 0.13547504319515408, 'psi': 0.9972264894696847}
[S10] START round=38 head_norm_before_train=1.861002 cos_to_last_merge=0.9977 (last merge round=35)
[S10] round=38 local utility u=0.002545 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9973213531593084, 'loss_val': 0.03264393977417503, 'psi': 0.9961224136019615}-{'f1_val': 0.9953231205637304, 'auprc': 0.9969689370285864, 'loss_val': 0.036675735573417655, 'psi': 0.9959814471496727}
[S11] START round=38 head_norm_before_train=1.860663 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.003455 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988738808312981, 'loss_val': 0.020126230811860223, 'psi': 0.9977281063082655}-{'f1_val': 0.9965509216617638, 'auprc': 0.9984293568983631, 'loss_val': 0.023221868209188833, 'psi': 0.9973022957564036}
[S13] START round=38 head_norm_before_train=1.211510 cos_to_last_merge=0.9972 (last merge round=35)
[S13] round=38 local utility u=0.339994 metrics={'f1_val': 0.6925631274515227, 'auprc': 0.783821680172989, 'loss_val': 0.7942764248770019, 'psi': 0.7290665485401093}-{'f1_val': 0.5979025881974577, 'auprc': 0.7802494711573366, 'loss_val': 0.8955845911394466, 'psi': 0.6708413413814092}
[S14] START round=38 head_norm_before_train=1.885329 cos_to_last_merge=0.9986 (last merge round=34)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9511425337221405, 'auprc': 0.9974403368303657, 'loss_val': 0.1088112921470495, 'psi': 0.9696616549654307}-{'f1_val': 0.9976511180498535, 'auprc': 0.9974696721916905, 'loss_val': 0.07114135787815158, 'psi': 0.9975785397065884}
[S15] START round=38 head_norm_before_train=1.731042 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=1.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9987839935855495, 'loss_val': 0.024733125904481613, 'psi': 0.9977839495510799}-{'f1_val': 0.701112287123778, 'auprc': 0.8715532100379713, 'loss_val': 0.6697236841087382, 'psi': 0.7692886562894554}
[S16] START round=38 head_norm_before_train=1.484152 cos_to_last_merge=0.9996 (last merge round=35)
[S16] round=38 local utility u=0.306506 metrics={'f1_val': 0.9908793938683479, 'auprc': 0.9949531791893473, 'loss_val': 0.06421270663257206, 'psi': 0.9925089079967476}-{'f1_val': 0.9314511470421722, 'auprc': 0.9940013916517706, 'loss_val': 0.31779911941362676, 'psi': 0.9564712448860115}
[S17] START round=38 head_norm_before_train=1.648428 cos_to_last_merge=0.9989 (last merge round=36)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6682837921734801, 'auprc': 0.8462304174711948, 'loss_val': 1.0376208057713852, 'psi': 0.739462442292566}-{'f1_val': 0.6878942153872447, 'auprc': 0.859052339202343, 'loss_val': 0.903731794564712, 'psi': 0.756357464913284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:40407
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] cosine check vs S11: cos=-0.0030
[S6] DROPPED delta from S11 (cos=-0.0030 < 0.0)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:40405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:40402
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.9600
[S7] RECEIVED delta(kind=head bytes=1806) from S10
[S7] cosine check vs S10: cos=0.9953
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=0.7762
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=-0.0540
[S2] DROPPED delta from S8 (cos=-0.0540 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:40415
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S16
[S15] cosine check vs S16: cos=0.9682
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] → sending delta(kind=head bytes=1808) to S3@127.0.0.1:40403
[S4] sending update (kind=head size=1808 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1808) from S4
[S3] cosine check vs S4: cos=0.7844
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.6309 head_norm=1.807143
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.974013e-02
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.6307 head_norm=1.848762 delta_norm=0.099740
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.7345 head_norm=1.808709
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.737820e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.6596 head_norm=1.456319 delta_norm=0.573782
[S5] aggregate: ROLLBACK (f1_val pre=0.734 post=0.660 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9967 head_norm=1.519619
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.040541e-01
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9969 head_norm=1.449403 delta_norm=0.504054
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=38 metric=0.9967 head_norm=1.276226
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.790989e-01
[S9] stored merged vector for next round verification (round=38)
[S9] DEBUG after merge:  round=38 metric=0.9967 head_norm=1.248841 delta_norm=0.179099
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9971 head_norm=1.752170
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.392704e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9967 head_norm=1.615462 delta_norm=0.239270
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=2.169574 (no previous merge yet)
[S2] round=39 local utility u=1.000000 metrics={'f1_val': 0.8303092688279184, 'auprc': 0.829252081928643, 'loss_val': 0.4792044708677195, 'psi': 0.8298863940682083}-{'f1_val': 0.5589111069331522, 'auprc': 0.8058552821548417, 'loss_val': 1.8961157465878347, 'psi': 0.657688777021828}
[S3] START round=39 head_norm_before_train=1.449403 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9364146499426915, 'auprc': 0.9820910470903769, 'loss_val': 0.20951252876740073, 'psi': 0.9546852088017657}-{'f1_val': 0.9966508675148381, 'auprc': 0.9988688565342219, 'loss_val': 0.11350506104186535, 'psi': 0.9975380631225916}
[S4] START round=39 head_norm_before_train=1.549334 cos_to_last_merge=0.9980 (last merge round=36)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9469729472647974, 'auprc': 0.9492066646859706, 'loss_val': 0.2936415760691271, 'psi': 0.9478664342332667}-{'f1_val': 0.9418730320097954, 'auprc': 0.9651251228078201, 'loss_val': 0.28911752270519087, 'psi': 0.9511738683290054}
[S5] START round=39 head_norm_before_train=1.456319 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.43692783079575537, 'auprc': 0.8571866035782144, 'loss_val': 0.7062011454138072, 'psi': 0.605031339908739}-{'f1_val': 0.7344526323765078, 'auprc': 0.9502048222794208, 'loss_val': 0.295760119644278, 'psi': 0.820753508337673}
[S6] START round=39 head_norm_before_train=2.086524 (no previous merge yet)
[S6] round=39 local utility u=0.637511 metrics={'f1_val': 0.7508362100625044, 'auprc': 0.86032564210911, 'loss_val': 0.7850868198686595, 'psi': 0.7946319828811467}-{'f1_val': 0.6116025151002564, 'auprc': 0.7534340670269379, 'loss_val': 0.9040312521757896, 'psi': 0.6683351358709291}
[S7] START round=39 head_norm_before_train=1.848762 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6246562071297396, 'auprc': 0.7941234013352587, 'loss_val': 0.5704777979739271, 'psi': 0.6924430848119473}-{'f1_val': 0.6308714842532341, 'auprc': 0.7965373251685135, 'loss_val': 0.5705590694139256, 'psi': 0.6971378206193459}
[S8] START round=39 head_norm_before_train=1.634135 cos_to_last_merge=0.9998 (last merge round=37)
[S8] round=39 local utility u=0.012736 metrics={'f1_val': 0.9900449566491589, 'auprc': 0.998823412935895, 'loss_val': 0.054050202183099846, 'psi': 0.9935563391638533}-{'f1_val': 0.9929205408612032, 'auprc': 0.9852612666892877, 'loss_val': 0.056088998456613984, 'psi': 0.989856831192437}
[S9] START round=39 head_norm_before_train=1.248841 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=39 local utility u=0.006154 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.997523662395614, 'loss_val': 0.08427559720636654, 'psi': 0.9975363989646319}-{'f1_val': 0.9967149094376494, 'auprc': 0.9995926882017051, 'loss_val': 0.09781140614131616, 'psi': 0.9978660209432717}
[S10] START round=39 head_norm_before_train=1.894722 cos_to_last_merge=0.9957 (last merge round=35)
[S10] round=39 local utility u=0.001411 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9973856283599425, 'loss_val': 0.030015466858049802, 'psi': 0.9961481236822152}-{'f1_val': 0.9953231205637304, 'auprc': 0.9973213531593084, 'loss_val': 0.03264393977417503, 'psi': 0.9961224136019615}
[S11] START round=39 head_norm_before_train=1.871286 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=39 local utility u=0.000064 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987216383924401, 'loss_val': 0.01954209326967586, 'psi': 0.9976672093327223}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988738808312981, 'loss_val': 0.020126230811860223, 'psi': 0.9977281063082655}
[S13] START round=39 head_norm_before_train=1.246839 cos_to_last_merge=0.9938 (last merge round=35)
[S13] round=39 local utility u=0.008815 metrics={'f1_val': 0.6854146550014536, 'auprc': 0.7851266364410735, 'loss_val': 0.7376712603613548, 'psi': 0.7252994475773016}-{'f1_val': 0.6925631274515227, 'auprc': 0.783821680172989, 'loss_val': 0.7942764248770019, 'psi': 0.7290665485401093}
[S14] START round=39 head_norm_before_train=1.905785 cos_to_last_merge=0.9977 (last merge round=34)
[S14] round=39 local utility u=0.161329 metrics={'f1_val': 0.997288414402867, 'auprc': 0.9960619956763925, 'loss_val': 0.05889335326092231, 'psi': 0.9967978469122771}-{'f1_val': 0.9511425337221405, 'auprc': 0.9974403368303657, 'loss_val': 0.1088112921470495, 'psi': 0.9696616549654307}
[S15] START round=39 head_norm_before_train=1.615462 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.8262378055183992, 'auprc': 0.9959884808136578, 'loss_val': 0.31578302192646096, 'psi': 0.8941380756365026}-{'f1_val': 0.9971172535281002, 'auprc': 0.9987839935855495, 'loss_val': 0.024733125904481613, 'psi': 0.9977839495510799}
[S16] START round=39 head_norm_before_train=1.504606 cos_to_last_merge=0.9991 (last merge round=35)
[S16] round=39 local utility u=0.001825 metrics={'f1_val': 0.9915364364988188, 'auprc': 0.9934757169144373, 'loss_val': 0.0600717260631221, 'psi': 0.9923121486650662}-{'f1_val': 0.9908793938683479, 'auprc': 0.9949531791893473, 'loss_val': 0.06421270663257206, 'psi': 0.9925089079967476}
[S17] START round=39 head_norm_before_train=1.686042 cos_to_last_merge=0.9966 (last merge round=36)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6664219281638609, 'auprc': 0.8278963411290277, 'loss_val': 1.1189249405373298, 'psi': 0.7310116933499275}-{'f1_val': 0.6682837921734801, 'auprc': 0.8462304174711948, 'loss_val': 1.0376208057713852, 'psi': 0.739462442292566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:40405
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:40408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:40410
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:40402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:40415
[S8] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S8
[S2] cosine check vs S8: cos=-0.0549
[S2] DROPPED delta from S8 (cos=-0.0549 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=0.9979
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9971
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] cosine check vs S11: cos=-0.0028
[S6] DROPPED delta from S11 (cos=-0.0028 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S13
[S9] cosine check vs S13: cos=0.9867
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=0.9890
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.8598
[S13] r=40 psi=0.725 u=0.0088 p_local=0.1496 f1=0.685 auprc=0.785 bytes=36005
[S6] r=40 psi=0.795 u=0.6375 p_local=0.3318 f1=0.751 auprc=0.860 bytes=30541
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.4369 head_norm=1.461585
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.734716e-01
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.4442 head_norm=1.324840 delta_norm=0.373472
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] r=40 psi=0.605 u=0.0000 p_local=0.2781 f1=0.437 auprc=0.857 bytes=35947
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.6247 head_norm=1.852845
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.039764e-02
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.6248 head_norm=1.886630 delta_norm=0.070398
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.692 u=0.0000 p_local=0.2194 f1=0.625 auprc=0.794 bytes=32418
[S3] r=40 psi=0.955 u=0.0000 p_local=0.0641 f1=0.936 auprc=0.982 bytes=32384
[S4] r=40 psi=0.948 u=0.0000 p_local=0.0340 f1=0.947 auprc=0.949 bytes=30571
[S8] r=40 psi=0.994 u=0.0127 p_local=0.0128 f1=0.990 auprc=0.999 bytes=32348
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.9970 head_norm=1.882268
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.471968e-02
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.9970 head_norm=1.900009 delta_norm=0.074720
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.998 u=0.0001 p_local=0.0053 f1=0.997 auprc=0.999 bytes=32390
[S14] r=40 psi=0.997 u=0.1613 p_local=0.0481 f1=0.997 auprc=0.996 bytes=39606
[S10] r=40 psi=0.996 u=0.0014 p_local=0.0030 f1=0.995 auprc=0.997 bytes=34213
[S2] r=40 psi=0.830 u=1.0000 p_local=0.2677 f1=0.830 auprc=0.829 bytes=32363
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9975 head_norm=1.285743
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.048940e-01
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9975 head_norm=1.279988 delta_norm=0.104894
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.998 u=0.0062 p_local=0.0162 f1=0.998 auprc=0.998 bytes=39552
[S16] r=40 psi=0.992 u=0.0018 p_local=0.1535 f1=0.992 auprc=0.993 bytes=30541
[S17] r=40 psi=0.731 u=0.0000 p_local=0.0517 f1=0.666 auprc=0.828 bytes=26985
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.8262 head_norm=1.653252
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.346739e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.8255 head_norm=1.583584 delta_norm=0.134674
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.894 u=0.0000 p_local=0.2464 f1=0.826 auprc=0.996 bytes=32305
[S2] START round=40 head_norm_before_train=2.176053 (no previous merge yet)
[S2] round=40 local utility u=0.015855 metrics={'f1_val': 0.8321667256668881, 'auprc': 0.8361346387392825, 'loss_val': 0.47928771811741433, 'psi': 0.833753890895846}-{'f1_val': 0.8303092688279184, 'auprc': 0.829252081928643, 'loss_val': 0.4792044708677195, 'psi': 0.8298863940682083}
[S3] START round=40 head_norm_before_train=1.498364 cos_to_last_merge=0.9989 (last merge round=38)
[S3] round=40 local utility u=0.211871 metrics={'f1_val': 0.9817384364555352, 'auprc': 0.9984207167318436, 'loss_val': 0.10670163239593465, 'psi': 0.9884113485660586}-{'f1_val': 0.9364146499426915, 'auprc': 0.9820910470903769, 'loss_val': 0.20951252876740073, 'psi': 0.9546852088017657}
[S4] START round=40 head_norm_before_train=1.579544 cos_to_last_merge=0.9964 (last merge round=36)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.6462318698424248, 'auprc': 0.9564616440534646, 'loss_val': 0.6519451671156156, 'psi': 0.7703237795268407}-{'f1_val': 0.9469729472647974, 'auprc': 0.9492066646859706, 'loss_val': 0.2936415760691271, 'psi': 0.9478664342332667}
[S5] START round=40 head_norm_before_train=1.324840 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8949383310690415, 'loss_val': 0.38996354844171127, 'psi': 0.778167691522432}-{'f1_val': 0.43692783079575537, 'auprc': 0.8571866035782144, 'loss_val': 0.7062011454138072, 'psi': 0.605031339908739}
[S6] START round=40 head_norm_before_train=2.101437 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7119560978137153, 'auprc': 0.8009435719284796, 'loss_val': 0.6953652513948425, 'psi': 0.747551087459621}-{'f1_val': 0.7508362100625044, 'auprc': 0.86032564210911, 'loss_val': 0.7850868198686595, 'psi': 0.7946319828811467}
[S7] START round=40 head_norm_before_train=1.886630 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.123528 metrics={'f1_val': 0.6459820673485566, 'auprc': 0.8049603462970114, 'loss_val': 0.48388832501822665, 'psi': 0.7095733789279386}-{'f1_val': 0.6246562071297396, 'auprc': 0.7941234013352587, 'loss_val': 0.5704777979739271, 'psi': 0.6924430848119473}
[S8] START round=40 head_norm_before_train=1.658758 cos_to_last_merge=0.9994 (last merge round=37)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9918205515801142, 'auprc': 0.986782217696168, 'loss_val': 0.048976054871122644, 'psi': 0.9898052180265358}-{'f1_val': 0.9900449566491589, 'auprc': 0.998823412935895, 'loss_val': 0.054050202183099846, 'psi': 0.9935563391638533}
[S9] START round=40 head_norm_before_train=1.279988 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.004715 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9995993366677113, 'loss_val': 0.0760922836814598, 'psi': 0.9978686803296741}-{'f1_val': 0.9975448900106438, 'auprc': 0.997523662395614, 'loss_val': 0.08427559720636654, 'psi': 0.9975363989646319}
[S10] START round=40 head_norm_before_train=1.922401 cos_to_last_merge=0.9940 (last merge round=35)
[S10] round=40 local utility u=0.000603 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9974501976593552, 'loss_val': 0.029003895355549307, 'psi': 0.9961739514019803}-{'f1_val': 0.9953231205637304, 'auprc': 0.9973856283599425, 'loss_val': 0.030015466858049802, 'psi': 0.9961481236822152}
[S11] START round=40 head_norm_before_train=1.900009 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000019 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9986229006266393, 'loss_val': 0.019207645819696997, 'psi': 0.9976277142264021}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987216383924401, 'loss_val': 0.01954209326967586, 'psi': 0.9976672093327223}
[S13] START round=40 head_norm_before_train=1.282813 cos_to_last_merge=0.9899 (last merge round=35)
[S13] round=40 local utility u=0.024695 metrics={'f1_val': 0.7195442035680791, 'auprc': 0.8012632770346564, 'loss_val': 0.941467567899436, 'psi': 0.75223183295471}-{'f1_val': 0.6854146550014536, 'auprc': 0.7851266364410735, 'loss_val': 0.7376712603613548, 'psi': 0.7252994475773016}
[S14] START round=40 head_norm_before_train=1.920494 cos_to_last_merge=0.9968 (last merge round=34)
[S14] round=40 local utility u=0.006927 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.99886737778915, 'loss_val': 0.054622842075017414, 'psi': 0.9980367977455527}-{'f1_val': 0.997288414402867, 'auprc': 0.9960619956763925, 'loss_val': 0.05889335326092231, 'psi': 0.9967978469122771}
[S15] START round=40 head_norm_before_train=1.583584 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.303922 metrics={'f1_val': 0.9037402512786699, 'auprc': 0.9974770946031968, 'loss_val': 0.17741984574200764, 'psi': 0.9412349886084806}-{'f1_val': 0.8262378055183992, 'auprc': 0.9959884808136578, 'loss_val': 0.31578302192646096, 'psi': 0.8941380756365026}
[S16] START round=40 head_norm_before_train=1.522665 cos_to_last_merge=0.9986 (last merge round=35)
[S16] round=40 local utility u=0.001536 metrics={'f1_val': 0.9908793938683479, 'auprc': 0.9948935559147121, 'loss_val': 0.057311714172257194, 'psi': 0.9924850586868935}-{'f1_val': 0.9915364364988188, 'auprc': 0.9934757169144373, 'loss_val': 0.0600717260631221, 'psi': 0.9923121486650662}
[S17] START round=40 head_norm_before_train=1.718839 cos_to_last_merge=0.9940 (last merge round=36)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6666035091746221, 'auprc': 0.8145611238823394, 'loss_val': 1.150806302439074, 'psi': 0.725786555057709}-{'f1_val': 0.6664219281638609, 'auprc': 0.8278963411290277, 'loss_val': 1.1189249405373298, 'psi': 0.7310116933499275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:40415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:40407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:40408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:40410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:40412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:40405
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=0.9991
[S9] RECEIVED delta(kind=head bytes=1807) from S13
[S9] cosine check vs S13: cos=0.9943
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=0.9987
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=0.9953
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.9344
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S11
[S6] cosine check vs S11: cos=-0.0019
[S6] DROPPED delta from S11 (cos=-0.0019 < 0.0)
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=40 metric=0.7003 head_norm=1.341043
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.406772e-01
[S5] stored merged vector for next round verification (round=40)
[S5] DEBUG after merge:  round=40 metric=0.7003 head_norm=1.305028 delta_norm=0.240677
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.6460 head_norm=1.893182
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.776653e-02
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.6462 head_norm=1.917433 delta_norm=0.047767
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.010 → S2@127.0.0.1:40402
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.9037 head_norm=1.635230
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.044634e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.9037 head_norm=1.585347 delta_norm=0.090446
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.027 → S3@127.0.0.1:40403
[S14] ⇄ pheromone p=0.040 → S11@127.0.0.1:40412
[S13] ⇄ pheromone p=0.125 → S9@127.0.0.1:40410
[S16] ⇄ pheromone p=0.123 → S15@127.0.0.1:40415
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=40 metric=0.9967 head_norm=1.312880
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.000419e-02
[S9] stored merged vector for next round verification (round=40)
[S9] DEBUG after merge:  round=40 metric=0.9967 head_norm=1.310668 delta_norm=0.070004
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.014 → S5@127.0.0.1:40405
[S17] ⇄ pheromone p=0.041 → S8@127.0.0.1:40409
[S10] ⇄ pheromone p=0.002 → S7@127.0.0.1:40408
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.9970 head_norm=1.910723
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.007072e-02
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.9970 head_norm=1.918629 delta_norm=0.050071
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.004 → S6@127.0.0.1:40407
[S2] START round=41 head_norm_before_train=2.185819 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.632572945443022, 'auprc': 0.8038517049810842, 'loss_val': 1.3759388408492161, 'psi': 0.7010844492582469}-{'f1_val': 0.8321667256668881, 'auprc': 0.8361346387392825, 'loss_val': 0.47928771811741433, 'psi': 0.833753890895846}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.555439 cos_to_last_merge=0.9958 (last merge round=38)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9612927942165166, 'auprc': 0.9988362492836267, 'loss_val': 0.10548695231843142, 'psi': 0.9763101762433606}-{'f1_val': 0.9817384364555352, 'auprc': 0.9984207167318436, 'loss_val': 0.10670163239593465, 'psi': 0.9884113485660586}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.600198 cos_to_last_merge=0.9951 (last merge round=36)
[S4] round=41 local utility u=1.000000 metrics={'f1_val': 0.9459888187891624, 'auprc': 0.9630384367071637, 'loss_val': 0.29099900759546754, 'psi': 0.9528086659563629}-{'f1_val': 0.6462318698424248, 'auprc': 0.9564616440534646, 'loss_val': 0.6519451671156156, 'psi': 0.7703237795268407}
[S5] START round=41 head_norm_before_train=1.305028 cos_to_last_merge=1.0000 (last merge round=40)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.6908363537794662, 'auprc': 0.826598472952339, 'loss_val': 0.4588771242430132, 'psi': 0.7451412014486153}-{'f1_val': 0.700320598491359, 'auprc': 0.8949383310690415, 'loss_val': 0.38996354844171127, 'psi': 0.778167691522432}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=2.119154 (no previous merge yet)
[S6] round=41 local utility u=0.418951 metrics={'f1_val': 0.8013729675248471, 'auprc': 0.9047617974748694, 'loss_val': 0.7054196889679495, 'psi': 0.8427284995048561}-{'f1_val': 0.7119560978137153, 'auprc': 0.8009435719284796, 'loss_val': 0.6953652513948425, 'psi': 0.747551087459621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=41 head_norm_before_train=1.917433 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5659308709427602, 'auprc': 0.7846736330244328, 'loss_val': 0.7107606604377226, 'psi': 0.6534279757754293}-{'f1_val': 0.6459820673485566, 'auprc': 0.8049603462970114, 'loss_val': 0.48388832501822665, 'psi': 0.7095733789279386}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.683853 cos_to_last_merge=0.9988 (last merge round=37)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9680725536335113, 'auprc': 0.9988037350077841, 'loss_val': 0.09897622442048558, 'psi': 0.9803650261832204}-{'f1_val': 0.9918205515801142, 'auprc': 0.986782217696168, 'loss_val': 0.048976054871122644, 'psi': 0.9898052180265358}
[S9] START round=41 head_norm_before_train=1.310668 cos_to_last_merge=1.0000 (last merge round=40)
[S9] round=41 local utility u=0.001286 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9971536025884653, 'loss_val': 0.07116286936486318, 'psi': 0.9973883750417724}-{'f1_val': 0.9967149094376494, 'auprc': 0.9995993366677113, 'loss_val': 0.0760922836814598, 'psi': 0.9978686803296741}
[S10] START round=41 head_norm_before_train=1.942556 cos_to_last_merge=0.9929 (last merge round=35)
[S10] round=41 local utility u=0.000532 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975616854942359, 'loss_val': 0.028275119612925528, 'psi': 0.9962185465359326}-{'f1_val': 0.9953231205637304, 'auprc': 0.9974501976593552, 'loss_val': 0.029003895355549307, 'psi': 0.9961739514019803}
[S11] START round=41 head_norm_before_train=1.918629 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.000057 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9986139663854302, 'loss_val': 0.019067233906917683, 'psi': 0.9976241405299184}-{'f1_val': 0.9969642566262439, 'auprc': 0.9986229006266393, 'loss_val': 0.019207645819696997, 'psi': 0.9976277142264021}
[S13] START round=41 head_norm_before_train=1.312192 cos_to_last_merge=0.9866 (last merge round=35)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6588443099450928, 'auprc': 0.6674382113308929, 'loss_val': 0.8033456845719584, 'psi': 0.6622818704994128}-{'f1_val': 0.7195442035680791, 'auprc': 0.8012632770346564, 'loss_val': 0.941467567899436, 'psi': 0.75223183295471}
[S14] START round=41 head_norm_before_train=1.927802 cos_to_last_merge=0.9958 (last merge round=34)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.997156667827352, 'loss_val': 0.051154197394115204, 'psi': 0.997453337960853}-{'f1_val': 0.9974830777164877, 'auprc': 0.99886737778915, 'loss_val': 0.054622842075017414, 'psi': 0.9980367977455527}
[S15] START round=41 head_norm_before_train=1.585347 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.240000 metrics={'f1_val': 0.9645881246318284, 'auprc': 0.9982720053173457, 'loss_val': 0.06489271669279859, 'psi': 0.9780616769060353}-{'f1_val': 0.9037402512786699, 'auprc': 0.9974770946031968, 'loss_val': 0.17741984574200764, 'psi': 0.9412349886084806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=41 head_norm_before_train=1.539167 cos_to_last_merge=0.9980 (last merge round=35)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.990417376720609, 'auprc': 0.9942974240911674, 'loss_val': 0.06161218115060063, 'psi': 0.9919693956688325}-{'f1_val': 0.9908793938683479, 'auprc': 0.9948935559147121, 'loss_val': 0.057311714172257194, 'psi': 0.9924850586868935}
[S17] START round=41 head_norm_before_train=1.750030 cos_to_last_merge=0.9915 (last merge round=36)
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.8902853502305175, 'auprc': 0.9618965322215642, 'loss_val': 0.3409581703159585, 'psi': 0.9189298230269363}-{'f1_val': 0.6666035091746221, 'auprc': 0.8145611238823394, 'loss_val': 1.150806302439074, 'psi': 0.725786555057709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:40409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:40408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:40407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:40403
[S17] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.9995
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.9761
[S4] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S4
[S3] cosine check vs S4: cos=0.9087
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9681 head_norm=1.707821
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.931396e-01
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9658 head_norm=1.730868 delta_norm=0.193140
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S11
[S6] cosine check vs S11: cos=-0.0007
[S6] DROPPED delta from S11 (cos=-0.0007 < 0.0)
[S9] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:40405
[S4] CommDone barrier timeout: have=0 need=1 — continuing
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9705
[S8]  timeout peer S2
[S8]  timeout peer S16
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S17
[S17]  timeout peer S8
[S16]  timeout peer S13
[S16]  timeout peer S15
[S4]  timeout peer S3
[S4]  timeout peer S14
[S14]  timeout peer S10
[S14]  timeout peer S11
[S13]  timeout peer S9
[S11]  timeout peer S6
[S10]  timeout peer S7
[S2] START round=42 head_norm_before_train=2.189838 (no previous merge yet)
[S2] round=42 local utility u=0.901632 metrics={'f1_val': 0.7887314777198562, 'auprc': 0.8364042546095973, 'loss_val': 0.6072835666562162, 'psi': 0.8078005884757526}-{'f1_val': 0.632572945443022, 'auprc': 0.8038517049810842, 'loss_val': 1.3759388408492161, 'psi': 0.7010844492582469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=42 head_norm_before_train=1.616618 cos_to_last_merge=0.9914 (last merge round=38)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9565340049067158, 'auprc': 0.9988398400531341, 'loss_val': 0.12638107935555423, 'psi': 0.973456338965283}-{'f1_val': 0.9612927942165166, 'auprc': 0.9988362492836267, 'loss_val': 0.10548695231843142, 'psi': 0.9763101762433606}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=42 metric=0.9565 head_norm=1.674280
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.752071e-01
[S3] stored merged vector for next round verification (round=42)
[S3] DEBUG after merge:  round=42 metric=0.9600 head_norm=1.604732 delta_norm=0.375207
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] START round=42 head_norm_before_train=1.621320 cos_to_last_merge=0.9938 (last merge round=36)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9411072812493737, 'auprc': 0.9573865657377986, 'loss_val': 0.3008759398721114, 'psi': 0.9476189950447437}-{'f1_val': 0.9459888187891624, 'auprc': 0.9630384367071637, 'loss_val': 0.29099900759546754, 'psi': 0.9528086659563629}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.329049 cos_to_last_merge=0.9994 (last merge round=40)
[S5] round=42 local utility u=0.343887 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9891579597267139, 'loss_val': 0.316209763794365, 'psi': 0.8159077168226139}-{'f1_val': 0.6908363537794662, 'auprc': 0.826598472952339, 'loss_val': 0.4588771242430132, 'psi': 0.7451412014486153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.7004 head_norm=1.359583
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.805671e-01
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.7003 head_norm=1.337539 delta_norm=0.180567
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] START round=42 head_norm_before_train=2.138283 (no previous merge yet)
[S6] round=42 local utility u=0.359193 metrics={'f1_val': 0.8428360411528761, 'auprc': 0.9463862223390461, 'loss_val': 0.3606853246256406, 'psi': 0.8842561136273441}-{'f1_val': 0.8013729675248471, 'auprc': 0.9047617974748694, 'loss_val': 0.7054196889679495, 'psi': 0.8427284995048561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=42 head_norm_before_train=1.926296 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=42 local utility u=0.382270 metrics={'f1_val': 0.6509822407467534, 'auprc': 0.8089039228389348, 'loss_val': 0.5292205914104979, 'psi': 0.7141509135836259}-{'f1_val': 0.5659308709427602, 'auprc': 0.7846736330244328, 'loss_val': 0.7107606604377226, 'psi': 0.6534279757754293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6510 head_norm=1.936087
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.642767e-02
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.6506 head_norm=1.948050 delta_norm=0.036428
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] START round=42 head_norm_before_train=1.730868 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.7135780681239317, 'auprc': 0.9823101265198566, 'loss_val': 0.46917052515336555, 'psi': 0.8210708914823017}-{'f1_val': 0.9680725536335113, 'auprc': 0.9988037350077841, 'loss_val': 0.09897622442048558, 'psi': 0.9803650261832204}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.339687 cos_to_last_merge=0.9997 (last merge round=40)
[S9] round=42 local utility u=0.002222 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9957066145144041, 'loss_val': 0.062377022440866375, 'psi': 0.9968095798121479}-{'f1_val': 0.9975448900106438, 'auprc': 0.9971536025884653, 'loss_val': 0.07116286936486318, 'psi': 0.9973883750417724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=42 head_norm_before_train=1.960617 cos_to_last_merge=0.9919 (last merge round=35)
[S10] round=42 local utility u=0.000410 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975834777413202, 'loss_val': 0.02751972076862809, 'psi': 0.9962272634347662}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975616854942359, 'loss_val': 0.028275119612925528, 'psi': 0.9962185465359326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=42 head_norm_before_train=1.927799 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=42 local utility u=0.000190 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9986405733175194, 'loss_val': 0.018766801942110133, 'psi': 0.9976347833027541}-{'f1_val': 0.9969642566262439, 'auprc': 0.9986139663854302, 'loss_val': 0.019067233906917683, 'psi': 0.9976241405299184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=42 head_norm_before_train=1.335767 cos_to_last_merge=0.9836 (last merge round=35)
[S13] round=42 local utility u=0.059351 metrics={'f1_val': 0.6272247950116967, 'auprc': 0.7872640540150826, 'loss_val': 0.8544040130762013, 'psi': 0.6912404986130511}-{'f1_val': 0.6588443099450928, 'auprc': 0.6674382113308929, 'loss_val': 0.8033456845719584, 'psi': 0.6622818704994128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=42 head_norm_before_train=1.938154 cos_to_last_merge=0.9949 (last merge round=34)
[S14] round=42 local utility u=0.003310 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.99940329364049, 'loss_val': 0.04997009033372172, 'psi': 0.9982214995185519}-{'f1_val': 0.9976511180498535, 'auprc': 0.997156667827352, 'loss_val': 0.051154197394115204, 'psi': 0.997453337960853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=42 head_norm_before_train=1.642753 cos_to_last_merge=0.9997 (last merge round=40)
[S15] round=42 local utility u=0.112501 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.997873073633511, 'loss_val': 0.03164551087020956, 'psi': 0.9971972304859167}-{'f1_val': 0.9645881246318284, 'auprc': 0.9982720053173457, 'loss_val': 0.06489271669279859, 'psi': 0.9780616769060353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=42 head_norm_before_train=1.554696 cos_to_last_merge=0.9974 (last merge round=35)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9693519202896299, 'auprc': 0.9928421531147876, 'loss_val': 0.10721987414449724, 'psi': 0.978748013419693}-{'f1_val': 0.990417376720609, 'auprc': 0.9942974240911674, 'loss_val': 0.06161218115060063, 'psi': 0.9919693956688325}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.774757 cos_to_last_merge=0.9890 (last merge round=36)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6472534061455888, 'auprc': 0.8294923340423, 'loss_val': 1.1891679371069874, 'psi': 0.7201489773042733}-{'f1_val': 0.8902853502305175, 'auprc': 0.9618965322215642, 'loss_val': 0.3409581703159585, 'psi': 0.9189298230269363}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.202223 (no previous merge yet)
[S2] round=43 local utility u=0.232646 metrics={'f1_val': 0.8346074689898796, 'auprc': 0.8279403231305833, 'loss_val': 0.3918554511400076, 'psi': 0.8319406106461611}-{'f1_val': 0.7887314777198562, 'auprc': 0.8364042546095973, 'loss_val': 0.6072835666562162, 'psi': 0.8078005884757526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=43 head_norm_before_train=1.604732 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8814703205248609, 'auprc': 0.9990576504504464, 'loss_val': 0.23321933877116607, 'psi': 0.9285052524950951}-{'f1_val': 0.9565340049067158, 'auprc': 0.9988398400531341, 'loss_val': 0.12638107935555423, 'psi': 0.973456338965283}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.636149 cos_to_last_merge=0.9928 (last merge round=36)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.681104491044442, 'auprc': 0.9273119423024829, 'loss_val': 0.6412092378951607, 'psi': 0.7795874715476584}-{'f1_val': 0.9411072812493737, 'auprc': 0.9573865657377986, 'loss_val': 0.3008759398721114, 'psi': 0.9476189950447437}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.337539 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.700179676873236, 'auprc': 0.8330101198571946, 'loss_val': 0.4471016941306136, 'psi': 0.7533118540668196}-{'f1_val': 0.700407554886547, 'auprc': 0.9891579597267139, 'loss_val': 0.316209763794365, 'psi': 0.8159077168226139}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=2.152478 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6156246532704713, 'auprc': 0.6529180779393742, 'loss_val': 1.543757073481544, 'psi': 0.6305420231380325}-{'f1_val': 0.8428360411528761, 'auprc': 0.9463862223390461, 'loss_val': 0.3606853246256406, 'psi': 0.8842561136273441}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.948050 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5581048849062971, 'auprc': 0.7833840895856181, 'loss_val': 0.8399404182689387, 'psi': 0.6482165667780255}-{'f1_val': 0.6509822407467534, 'auprc': 0.8089039228389348, 'loss_val': 0.5292205914104979, 'psi': 0.7141509135836259}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.752789 cos_to_last_merge=0.9999 (last merge round=41)
[S8] round=43 local utility u=0.990945 metrics={'f1_val': 0.971350392621316, 'auprc': 0.9988906838444398, 'loss_val': 0.08365671444405233, 'psi': 0.9823665091105656}-{'f1_val': 0.7135780681239317, 'auprc': 0.9823101265198566, 'loss_val': 0.46917052515336555, 'psi': 0.8210708914823017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=43 head_norm_before_train=1.365537 cos_to_last_merge=0.9991 (last merge round=40)
[S9] round=43 local utility u=0.002513 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9970649588377587, 'loss_val': 0.05644630027009576, 'psi': 0.9968549291976931}-{'f1_val': 0.9975448900106438, 'auprc': 0.9957066145144041, 'loss_val': 0.062377022440866375, 'psi': 0.9968095798121479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=43 head_norm_before_train=1.978307 cos_to_last_merge=0.9909 (last merge round=35)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9973398943702777, 'loss_val': 0.02729805113527301, 'psi': 0.9961298300863493}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975834777413202, 'loss_val': 0.02751972076862809, 'psi': 0.9962272634347662}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.935706 cos_to_last_merge=0.9999 (last merge round=40)
[S11] round=43 local utility u=0.000233 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987782083697487, 'loss_val': 0.01871451709617708, 'psi': 0.9976898373236458}-{'f1_val': 0.9969642566262439, 'auprc': 0.9986405733175194, 'loss_val': 0.018766801942110133, 'psi': 0.9976347833027541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=43 head_norm_before_train=1.354318 cos_to_last_merge=0.9810 (last merge round=35)
[S13] round=43 local utility u=0.303717 metrics={'f1_val': 0.7302882754043162, 'auprc': 0.8036021702851721, 'loss_val': 0.9143659509072496, 'psi': 0.7596138333566586}-{'f1_val': 0.6272247950116967, 'auprc': 0.7872640540150826, 'loss_val': 0.8544040130762013, 'psi': 0.6912404986130511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=43 head_norm_before_train=1.949827 cos_to_last_merge=0.9939 (last merge round=34)
[S14] round=43 local utility u=0.000722 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9984859591750885, 'loss_val': 0.043293372515408116, 'psi': 0.9976065573437608}-{'f1_val': 0.9974336367705932, 'auprc': 0.99940329364049, 'loss_val': 0.04997009033372172, 'psi': 0.9982214995185519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=43 head_norm_before_train=1.695996 cos_to_last_merge=0.9989 (last merge round=40)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9969550878574741, 'loss_val': 0.23522554426955397, 'psi': 0.9406841408608619}-{'f1_val': 0.9967466683875206, 'auprc': 0.997873073633511, 'loss_val': 0.03164551087020956, 'psi': 0.9971972304859167}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.568437 cos_to_last_merge=0.9967 (last merge round=35)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9473922478694218, 'auprc': 0.9926651849949599, 'loss_val': 0.14201714432412432, 'psi': 0.965501422719637}-{'f1_val': 0.9693519202896299, 'auprc': 0.9928421531147876, 'loss_val': 0.10721987414449724, 'psi': 0.978748013419693}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.794227 cos_to_last_merge=0.9873 (last merge round=36)
[S17] round=43 local utility u=0.243255 metrics={'f1_val': 0.6857973587055616, 'auprc': 0.87877981897028, 'loss_val': 1.0817846910388218, 'psi': 0.762990342811449}-{'f1_val': 0.6472534061455888, 'auprc': 0.8294923340423, 'loss_val': 1.1891679371069874, 'psi': 0.7201489773042733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=44 head_norm_before_train=2.207166 (no previous merge yet)
[S2] round=44 local utility u=0.030903 metrics={'f1_val': 0.8338404335587014, 'auprc': 0.8619667846779744, 'loss_val': 0.4275274227635792, 'psi': 0.8450909740064105}-{'f1_val': 0.8346074689898796, 'auprc': 0.8279403231305833, 'loss_val': 0.3918554511400076, 'psi': 0.8319406106461611}
[S2] not sending this round → trigger blocked (psi=0.845)
[S3] START round=44 head_norm_before_train=1.647153 cos_to_last_merge=0.9994 (last merge round=42)
[S3] round=44 local utility u=0.058903 metrics={'f1_val': 0.8978833532749458, 'auprc': 0.9994083073268374, 'loss_val': 0.21494307672611465, 'psi': 0.9384933348957025}-{'f1_val': 0.8814703205248609, 'auprc': 0.9990576504504464, 'loss_val': 0.23321933877116607, 'psi': 0.9285052524950951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=44 head_norm_before_train=1.649759 cos_to_last_merge=0.9918 (last merge round=36)
[S4] round=44 local utility u=0.961078 metrics={'f1_val': 0.9393953210262722, 'auprc': 0.942485649737846, 'loss_val': 0.31431888905827876, 'psi': 0.9406314525109016}-{'f1_val': 0.681104491044442, 'auprc': 0.9273119423024829, 'loss_val': 0.6412092378951607, 'psi': 0.7795874715476584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=44 head_norm_before_train=1.371195 cos_to_last_merge=0.9991 (last merge round=42)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6001250993126175, 'auprc': 0.8277658201255685, 'loss_val': 0.5673489318088052, 'psi': 0.6911813876377979}-{'f1_val': 0.700179676873236, 'auprc': 0.8330101198571946, 'loss_val': 0.4471016941306136, 'psi': 0.7533118540668196}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=2.164590 (no previous merge yet)
[S6] round=44 local utility u=1.000000 metrics={'f1_val': 0.8384512756926622, 'auprc': 0.9540381752603875, 'loss_val': 0.3097222032372895, 'psi': 0.8846860355197523}-{'f1_val': 0.6156246532704713, 'auprc': 0.6529180779393742, 'loss_val': 1.543757073481544, 'psi': 0.6305420231380325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=44 head_norm_before_train=1.953778 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=44 local utility u=0.216101 metrics={'f1_val': 0.5919894744306089, 'auprc': 0.7880606220724518, 'loss_val': 0.625074659505958, 'psi': 0.670417933487346}-{'f1_val': 0.5581048849062971, 'auprc': 0.7833840895856181, 'loss_val': 0.8399404182689387, 'psi': 0.6482165667780255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=44 head_norm_before_train=1.767367 cos_to_last_merge=0.9997 (last merge round=41)
[S8] round=44 local utility u=0.068795 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.9882751754933109, 'loss_val': 0.04364021292149816, 'psi': 0.9910623947140462}-{'f1_val': 0.971350392621316, 'auprc': 0.9988906838444398, 'loss_val': 0.08365671444405233, 'psi': 0.9823665091105656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=44 head_norm_before_train=1.387451 cos_to_last_merge=0.9984 (last merge round=40)
[S9] round=44 local utility u=0.003127 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9954664924741689, 'loss_val': 0.0503757847188017, 'psi': 0.9967135309960538}-{'f1_val': 0.9967149094376494, 'auprc': 0.9970649588377587, 'loss_val': 0.05644630027009576, 'psi': 0.9968549291976931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=44 head_norm_before_train=1.995118 cos_to_last_merge=0.9898 (last merge round=35)
[S10] round=44 local utility u=0.000610 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975971746906065, 'loss_val': 0.026849942732085325, 'psi': 0.9962327422144808}-{'f1_val': 0.9953231205637304, 'auprc': 0.9973398943702777, 'loss_val': 0.02729805113527301, 'psi': 0.9961298300863493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=44 head_norm_before_train=1.943343 cos_to_last_merge=0.9998 (last merge round=40)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986302448173312, 'loss_val': 0.018757424455254943, 'psi': 0.9973826509239908}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987782083697487, 'loss_val': 0.01871451709617708, 'psi': 0.9976898373236458}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.371577 cos_to_last_merge=0.9788 (last merge round=35)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6649295086305108, 'auprc': 0.7784649467179328, 'loss_val': 0.7978254510486569, 'psi': 0.7103436838654795}-{'f1_val': 0.7302882754043162, 'auprc': 0.8036021702851721, 'loss_val': 0.9143659509072496, 'psi': 0.7596138333566586}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.963495 cos_to_last_merge=0.9931 (last merge round=34)
[S14] round=44 local utility u=0.001132 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971566575748874, 'loss_val': 0.040825485799847246, 'psi': 0.9974533338598671}-{'f1_val': 0.9970202894562089, 'auprc': 0.9984859591750885, 'loss_val': 0.043293372515408116, 'psi': 0.9976065573437608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=44 head_norm_before_train=1.741328 cos_to_last_merge=0.9980 (last merge round=40)
[S15] round=44 local utility u=0.005121 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9964390391473297, 'loss_val': 0.22343467074463147, 'psi': 0.9404777213768043}-{'f1_val': 0.903170176196454, 'auprc': 0.9969550878574741, 'loss_val': 0.23522554426955397, 'psi': 0.9406841408608619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=44 head_norm_before_train=1.581914 cos_to_last_merge=0.9961 (last merge round=35)
[S16] round=44 local utility u=0.014058 metrics={'f1_val': 0.9507482444719435, 'auprc': 0.9929432434627331, 'loss_val': 0.1348715390911454, 'psi': 0.9676262440682593}-{'f1_val': 0.9473922478694218, 'auprc': 0.9926651849949599, 'loss_val': 0.14201714432412432, 'psi': 0.965501422719637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=44 head_norm_before_train=1.807655 cos_to_last_merge=0.9862 (last merge round=36)
[S17] round=44 local utility u=0.018710 metrics={'f1_val': 0.6869258975554831, 'auprc': 0.8898602116786912, 'loss_val': 1.084377835309528, 'psi': 0.7680996232047663}-{'f1_val': 0.6857973587055616, 'auprc': 0.87877981897028, 'loss_val': 1.0817846910388218, 'psi': 0.762990342811449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=45 head_norm_before_train=2.213244 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.5568486721428577, 'auprc': 0.7574969025582026, 'loss_val': 1.9027316303171766, 'psi': 0.6371079643089956}-{'f1_val': 0.8338404335587014, 'auprc': 0.8619667846779744, 'loss_val': 0.4275274227635792, 'psi': 0.8450909740064105}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.694491 cos_to_last_merge=0.9978 (last merge round=42)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.7798320121427338, 'auprc': 0.9985897669393419, 'loss_val': 0.3410690271956989, 'psi': 0.867335114061377}-{'f1_val': 0.8978833532749458, 'auprc': 0.9994083073268374, 'loss_val': 0.21494307672611465, 'psi': 0.9384933348957025}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.665939 cos_to_last_merge=0.9906 (last merge round=36)
[S4] round=45 local utility u=0.048780 metrics={'f1_val': 0.9424929743779029, 'auprc': 0.9646581513408453, 'loss_val': 0.3018618497508341, 'psi': 0.9513590451630799}-{'f1_val': 0.9393953210262722, 'auprc': 0.942485649737846, 'loss_val': 0.31431888905827876, 'psi': 0.9406314525109016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=45 head_norm_before_train=1.407044 cos_to_last_merge=0.9968 (last merge round=42)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.5740593868659273, 'auprc': 0.8076130855335844, 'loss_val': 0.6667990885543306, 'psi': 0.6674808663329901}-{'f1_val': 0.6001250993126175, 'auprc': 0.8277658201255685, 'loss_val': 0.5673489318088052, 'psi': 0.6911813876377979}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=2.174646 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6730874118893496, 'auprc': 0.7646396328181133, 'loss_val': 1.0909514313649356, 'psi': 0.7097083002608551}-{'f1_val': 0.8384512756926622, 'auprc': 0.9540381752603875, 'loss_val': 0.3097222032372895, 'psi': 0.8846860355197523}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.956065 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.557637826549839, 'auprc': 0.7844088909753497, 'loss_val': 0.6681507187206795, 'psi': 0.6483462523200433}-{'f1_val': 0.5919894744306089, 'auprc': 0.7880606220724518, 'loss_val': 0.625074659505958, 'psi': 0.670417933487346}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.785144 cos_to_last_merge=0.9994 (last merge round=41)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9826156281884603, 'auprc': 0.9991173865935856, 'loss_val': 0.05862931020699675, 'psi': 0.9892163315505104}-{'f1_val': 0.9929205408612032, 'auprc': 0.9882751754933109, 'loss_val': 0.04364021292149816, 'psi': 0.9910623947140462}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.408853 cos_to_last_merge=0.9976 (last merge round=40)
[S9] round=45 local utility u=0.008610 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9994449574793101, 'loss_val': 0.04509033921869195, 'psi': 0.9983049169981103}-{'f1_val': 0.9975448900106438, 'auprc': 0.9954664924741689, 'loss_val': 0.0503757847188017, 'psi': 0.9967135309960538}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=45 head_norm_before_train=2.007996 cos_to_last_merge=0.9892 (last merge round=35)
[S10] round=45 local utility u=0.001245 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980911950116598, 'loss_val': 0.025842191360807232, 'psi': 0.9964303503429022}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975971746906065, 'loss_val': 0.026849942732085325, 'psi': 0.9962327422144808}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=45 head_norm_before_train=1.950409 cos_to_last_merge=0.9998 (last merge round=40)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9981523354212364, 'loss_val': 0.01999890194610753, 'psi': 0.997191487165553}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986302448173312, 'loss_val': 0.018757424455254943, 'psi': 0.9973826509239908}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.391110 cos_to_last_merge=0.9761 (last merge round=35)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6132906401344684, 'auprc': 0.666913139893621, 'loss_val': 1.0707644368500113, 'psi': 0.6347396400381295}-{'f1_val': 0.6649295086305108, 'auprc': 0.7784649467179328, 'loss_val': 0.7978254510486569, 'psi': 0.7103436838654795}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.975374 cos_to_last_merge=0.9923 (last merge round=34)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9974110356658187, 'loss_val': 0.03864328944097919, 'psi': 0.9971784278728744}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971566575748874, 'loss_val': 0.040825485799847246, 'psi': 0.9974533338598671}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.779007 cos_to_last_merge=0.9971 (last merge round=40)
[S15] round=45 local utility u=0.290642 metrics={'f1_val': 0.9704797095968619, 'auprc': 0.9979521585483253, 'loss_val': 0.05054633117466086, 'psi': 0.9814686891774472}-{'f1_val': 0.903170176196454, 'auprc': 0.9964390391473297, 'loss_val': 0.22343467074463147, 'psi': 0.9404777213768043}
[S15] not sending this round → trigger blocked (psi=0.981)
[S16] START round=45 head_norm_before_train=1.594804 cos_to_last_merge=0.9956 (last merge round=35)
[S16] round=45 local utility u=0.062274 metrics={'f1_val': 0.9667883752874782, 'auprc': 0.9935138736990224, 'loss_val': 0.10827569834848719, 'psi': 0.977478574652096}-{'f1_val': 0.9507482444719435, 'auprc': 0.9929432434627331, 'loss_val': 0.1348715390911454, 'psi': 0.9676262440682593}
[S16] not sending this round → trigger blocked (psi=0.977)
[S17] START round=45 head_norm_before_train=1.821872 cos_to_last_merge=0.9847 (last merge round=36)
[S17] round=45 local utility u=0.230844 metrics={'f1_val': 0.7365147621789481, 'auprc': 0.8843650321074651, 'loss_val': 0.9037383943158562, 'psi': 0.795654870150355}-{'f1_val': 0.6869258975554831, 'auprc': 0.8898602116786912, 'loss_val': 1.084377835309528, 'psi': 0.7680996232047663}
[S17] not sending this round → trigger blocked (psi=0.796)
[S2] START round=46 head_norm_before_train=2.212067 (no previous merge yet)
[S2] round=46 local utility u=1.000000 metrics={'f1_val': 0.8284077145752056, 'auprc': 0.8683376952647519, 'loss_val': 0.4727429124345862, 'psi': 0.8443797068510241}-{'f1_val': 0.5568486721428577, 'auprc': 0.7574969025582026, 'loss_val': 1.9027316303171766, 'psi': 0.6371079643089956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=46 head_norm_before_train=1.735121 cos_to_last_merge=0.9958 (last merge round=42)
[S3] round=46 local utility u=0.687297 metrics={'f1_val': 0.9647628391264124, 'auprc': 0.9995500036132106, 'loss_val': 0.07894125284876684, 'psi': 0.9786777049211317}-{'f1_val': 0.7798320121427338, 'auprc': 0.9985897669393419, 'loss_val': 0.3410690271956989, 'psi': 0.867335114061377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=46 head_norm_before_train=1.676015 cos_to_last_merge=0.9896 (last merge round=36)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.940888075419153, 'auprc': 0.9592106073409074, 'loss_val': 0.306813654208584, 'psi': 0.9482170881878547}-{'f1_val': 0.9424929743779029, 'auprc': 0.9646581513408453, 'loss_val': 0.3018618497508341, 'psi': 0.9513590451630799}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.445701 cos_to_last_merge=0.9935 (last merge round=42)
[S5] round=46 local utility u=0.863052 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9905361142152009, 'loss_val': 0.2470351475111348, 'psi': 0.8164072361464286}-{'f1_val': 0.5740593868659273, 'auprc': 0.8076130855335844, 'loss_val': 0.6667990885543306, 'psi': 0.6674808663329901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=46 head_norm_before_train=2.187757 (no previous merge yet)
[S6] round=46 local utility u=0.434106 metrics={'f1_val': 0.7262935200386592, 'auprc': 0.8546542046133652, 'loss_val': 0.8120199608256099, 'psi': 0.7776377938685416}-{'f1_val': 0.6730874118893496, 'auprc': 0.7646396328181133, 'loss_val': 1.0909514313649356, 'psi': 0.7097083002608551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=46 head_norm_before_train=1.959205 cos_to_last_merge=0.9999 (last merge round=42)
[S7] round=46 local utility u=0.294840 metrics={'f1_val': 0.6321537002385853, 'auprc': 0.7963373040328401, 'loss_val': 0.5613513629876319, 'psi': 0.6978271417562872}-{'f1_val': 0.557637826549839, 'auprc': 0.7844088909753497, 'loss_val': 0.6681507187206795, 'psi': 0.6483462523200433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=46 head_norm_before_train=1.804473 cos_to_last_merge=0.9990 (last merge round=41)
[S8] round=46 local utility u=0.022061 metrics={'f1_val': 0.9882500123346475, 'auprc': 0.9987980348215123, 'loss_val': 0.04735617953354906, 'psi': 0.9924692213293935}-{'f1_val': 0.9826156281884603, 'auprc': 0.9991173865935856, 'loss_val': 0.05862931020699675, 'psi': 0.9892163315505104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=46 head_norm_before_train=1.428167 cos_to_last_merge=0.9967 (last merge round=40)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9966002736346722, 'loss_val': 0.04210390248887095, 'psi': 0.9969207886125038}-{'f1_val': 0.9975448900106438, 'auprc': 0.9994449574793101, 'loss_val': 0.04509033921869195, 'psi': 0.9983049169981103}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.021480 cos_to_last_merge=0.9883 (last merge round=35)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9977547487605489, 'loss_val': 0.02613015988900716, 'psi': 0.9962957718424578}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980911950116598, 'loss_val': 0.025842191360807232, 'psi': 0.9964303503429022}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.957904 cos_to_last_merge=0.9997 (last merge round=40)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9984281403304383, 'loss_val': 0.019483824756027793, 'psi': 0.9971567069023966}-{'f1_val': 0.9965509216617638, 'auprc': 0.9981523354212364, 'loss_val': 0.01999890194610753, 'psi': 0.997191487165553}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.409672 cos_to_last_merge=0.9736 (last merge round=35)
[S13] round=46 local utility u=0.429538 metrics={'f1_val': 0.7205495162115179, 'auprc': 0.7200646761552695, 'loss_val': 1.0146960663102549, 'psi': 0.7203555801890185}-{'f1_val': 0.6132906401344684, 'auprc': 0.666913139893621, 'loss_val': 1.0707644368500113, 'psi': 0.6347396400381295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=46 head_norm_before_train=1.984984 cos_to_last_merge=0.9916 (last merge round=34)
[S14] round=46 local utility u=0.002933 metrics={'f1_val': 0.9970456931804658, 'auprc': 0.9992902642466435, 'loss_val': 0.03854965002883873, 'psi': 0.9979435216069368}-{'f1_val': 0.9970233560109115, 'auprc': 0.9974110356658187, 'loss_val': 0.03864328944097919, 'psi': 0.9971784278728744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=46 head_norm_before_train=1.810297 cos_to_last_merge=0.9963 (last merge round=40)
[S15] round=46 local utility u=0.033995 metrics={'f1_val': 0.9797655229955603, 'auprc': 0.998021048463649, 'loss_val': 0.038477997548182014, 'psi': 0.9870677331827957}-{'f1_val': 0.9704797095968619, 'auprc': 0.9979521585483253, 'loss_val': 0.05054633117466086, 'psi': 0.9814686891774472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=46 head_norm_before_train=1.607058 cos_to_last_merge=0.9951 (last merge round=35)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8565807844864541, 'auprc': 0.9829617696891256, 'loss_val': 0.7565705091538008, 'psi': 0.9071331785675227}-{'f1_val': 0.9667883752874782, 'auprc': 0.9935138736990224, 'loss_val': 0.10827569834848719, 'psi': 0.977478574652096}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.840128 cos_to_last_merge=0.9829 (last merge round=36)
[S17] round=46 local utility u=0.077199 metrics={'f1_val': 0.7461277004434768, 'auprc': 0.9135020407418054, 'loss_val': 0.8944287575831249, 'psi': 0.8130774365628082}-{'f1_val': 0.7365147621789481, 'auprc': 0.8843650321074651, 'loss_val': 0.9037383943158562, 'psi': 0.795654870150355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=47 head_norm_before_train=2.216866 (no previous merge yet)
[S2] round=47 local utility u=0.035014 metrics={'f1_val': 0.8312650624055093, 'auprc': 0.8833671597498294, 'loss_val': 0.46494751391638006, 'psi': 0.8521059013432373}-{'f1_val': 0.8284077145752056, 'auprc': 0.8683376952647519, 'loss_val': 0.4727429124345862, 'psi': 0.8443797068510241}
[S2] not sending this round → trigger blocked (psi=0.852)
[S3] START round=47 head_norm_before_train=1.771978 cos_to_last_merge=0.9938 (last merge round=42)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998925799813497, 'loss_val': 0.09641294683665792, 'psi': 0.976191470588665}-{'f1_val': 0.9647628391264124, 'auprc': 0.9995500036132106, 'loss_val': 0.07894125284876684, 'psi': 0.9786777049211317}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.689397 cos_to_last_merge=0.9884 (last merge round=36)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9403508708058032, 'auprc': 0.9400790662974154, 'loss_val': 0.3079776389618685, 'psi': 0.9402421490024482}-{'f1_val': 0.940888075419153, 'auprc': 0.9592106073409074, 'loss_val': 0.306813654208584, 'psi': 0.9482170881878547}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.476930 cos_to_last_merge=0.9906 (last merge round=42)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.6625449259156126, 'auprc': 0.8006214809860558, 'loss_val': 0.4891427417618022, 'psi': 0.71777554794379}-{'f1_val': 0.7003213174339138, 'auprc': 0.9905361142152009, 'loss_val': 0.2470351475111348, 'psi': 0.8164072361464286}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=2.200521 (no previous merge yet)
[S6] round=47 local utility u=0.484105 metrics={'f1_val': 0.8203918368423407, 'auprc': 0.9282070131065584, 'loss_val': 0.6290579497512482, 'psi': 0.8635179073480278}-{'f1_val': 0.7262935200386592, 'auprc': 0.8546542046133652, 'loss_val': 0.8120199608256099, 'psi': 0.7776377938685416}
[S6] not sending this round → trigger blocked (psi=0.864)
[S7] START round=47 head_norm_before_train=1.966694 cos_to_last_merge=0.9999 (last merge round=42)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5320649414175627, 'auprc': 0.7820797891739983, 'loss_val': 0.913745588420064, 'psi': 0.6320708805201369}-{'f1_val': 0.6321537002385853, 'auprc': 0.7963373040328401, 'loss_val': 0.5613513629876319, 'psi': 0.6978271417562872}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.821263 cos_to_last_merge=0.9986 (last merge round=41)
[S8] round=47 local utility u=0.005848 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9917441413538342, 'loss_val': 0.039352097498304504, 'psi': 0.9921330128292121}-{'f1_val': 0.9882500123346475, 'auprc': 0.9987980348215123, 'loss_val': 0.04735617953354906, 'psi': 0.9924692213293935}
[S8] not sending this round → trigger blocked (psi=0.992)
[S9] START round=47 head_norm_before_train=1.445722 cos_to_last_merge=0.9958 (last merge round=40)
[S9] round=47 local utility u=0.007260 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995452221395745, 'loss_val': 0.038880997510290526, 'psi': 0.998345022862216}-{'f1_val': 0.9971344652643916, 'auprc': 0.9966002736346722, 'loss_val': 0.04210390248887095, 'psi': 0.9969207886125038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=47 head_norm_before_train=2.034835 cos_to_last_merge=0.9874 (last merge round=35)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9976603748999364, 'loss_val': 0.02591192389266265, 'psi': 0.9962580222982127}-{'f1_val': 0.9953231205637304, 'auprc': 0.9977547487605489, 'loss_val': 0.02613015988900716, 'psi': 0.9962957718424578}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.965950 cos_to_last_merge=0.9996 (last merge round=40)
[S11] round=47 local utility u=0.003331 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988442054171229, 'loss_val': 0.018000112476165692, 'psi': 0.9977162361425955}-{'f1_val': 0.9963090846170353, 'auprc': 0.9984281403304383, 'loss_val': 0.019483824756027793, 'psi': 0.9971567069023966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=47 head_norm_before_train=1.425372 cos_to_last_merge=0.9717 (last merge round=35)
[S13] round=47 local utility u=0.236631 metrics={'f1_val': 0.708429700648237, 'auprc': 0.7793501712618724, 'loss_val': 0.6465711959309315, 'psi': 0.7367978888936912}-{'f1_val': 0.7205495162115179, 'auprc': 0.7200646761552695, 'loss_val': 1.0146960663102549, 'psi': 0.7203555801890185}
[S13] not sending this round → trigger blocked (psi=0.737)
[S14] START round=47 head_norm_before_train=1.993392 cos_to_last_merge=0.9908 (last merge round=34)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9971584061350987, 'loss_val': 0.040296658084628595, 'psi': 0.9974543369146791}-{'f1_val': 0.9970456931804658, 'auprc': 0.9992902642466435, 'loss_val': 0.03854965002883873, 'psi': 0.9979435216069368}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.837169 cos_to_last_merge=0.9955 (last merge round=40)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9980373247349075, 'loss_val': 0.17846828597321385, 'psi': 0.9451740536015273}-{'f1_val': 0.9797655229955603, 'auprc': 0.998021048463649, 'loss_val': 0.038477997548182014, 'psi': 0.9870677331827957}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.616491 cos_to_last_merge=0.9946 (last merge round=35)
[S16] round=47 local utility u=0.765312 metrics={'f1_val': 0.9895471503383761, 'auprc': 0.9957530236875153, 'loss_val': 0.06211761931349094, 'psi': 0.9920294996780318}-{'f1_val': 0.8565807844864541, 'auprc': 0.9829617696891256, 'loss_val': 0.7565705091538008, 'psi': 0.9071331785675227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=47 head_norm_before_train=1.862371 cos_to_last_merge=0.9807 (last merge round=36)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6417800018769059, 'auprc': 0.8899193423749621, 'loss_val': 1.2706162434664368, 'psi': 0.7410357380761283}-{'f1_val': 0.7461277004434768, 'auprc': 0.9135020407418054, 'loss_val': 0.8944287575831249, 'psi': 0.8130774365628082}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.224154 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.8338404335587014, 'auprc': 0.8290984366222562, 'loss_val': 0.40519395237989114, 'psi': 0.8319436347841234}-{'f1_val': 0.8312650624055093, 'auprc': 0.8833671597498294, 'loss_val': 0.46494751391638006, 'psi': 0.8521059013432373}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.809301 cos_to_last_merge=0.9915 (last merge round=42)
[S3] round=48 local utility u=0.129049 metrics={'f1_val': 0.9940335392918865, 'auprc': 0.9988653653260642, 'loss_val': 0.03612416428082954, 'psi': 0.9959662697055576}-{'f1_val': 0.9610352511054436, 'auprc': 0.998925799813497, 'loss_val': 0.09641294683665792, 'psi': 0.976191470588665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=48 head_norm_before_train=1.698136 cos_to_last_merge=0.9872 (last merge round=36)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9390316919928563, 'auprc': 0.9303523424311072, 'loss_val': 0.3173124711832958, 'psi': 0.9355599521681567}-{'f1_val': 0.9403508708058032, 'auprc': 0.9400790662974154, 'loss_val': 0.3079776389618685, 'psi': 0.9402421490024482}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.503193 cos_to_last_merge=0.9880 (last merge round=42)
[S5] round=48 local utility u=0.136566 metrics={'f1_val': 0.6429297961556457, 'auprc': 0.9008217845810103, 'loss_val': 0.39892071599365586, 'psi': 0.7460865915257915}-{'f1_val': 0.6625449259156126, 'auprc': 0.8006214809860558, 'loss_val': 0.4891427417618022, 'psi': 0.71777554794379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=48 head_norm_before_train=2.214000 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7290233624977261, 'auprc': 0.9010788846929447, 'loss_val': 0.8843817533733027, 'psi': 0.7978455713758136}-{'f1_val': 0.8203918368423407, 'auprc': 0.9282070131065584, 'loss_val': 0.6290579497512482, 'psi': 0.8635179073480278}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.974084 cos_to_last_merge=0.9999 (last merge round=42)
[S7] round=48 local utility u=0.738596 metrics={'f1_val': 0.6648975577209757, 'auprc': 0.8314804377799795, 'loss_val': 0.381751819490659, 'psi': 0.7315307097445771}-{'f1_val': 0.5320649414175627, 'auprc': 0.7820797891739983, 'loss_val': 0.913745588420064, 'psi': 0.6320708805201369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=48 head_norm_before_train=1.838579 cos_to_last_merge=0.9982 (last merge round=41)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.9812617103154722, 'loss_val': 0.5919211117383719, 'psi': 0.8207569776854904}-{'f1_val': 0.992392260479464, 'auprc': 0.9917441413538342, 'loss_val': 0.039352097498304504, 'psi': 0.9921330128292121}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.462339 cos_to_last_merge=0.9949 (last merge round=40)
[S9] round=48 local utility u=0.001064 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995560979746091, 'loss_val': 0.03678539052135157, 'psi': 0.9983493731962299}-{'f1_val': 0.9975448900106438, 'auprc': 0.9995452221395745, 'loss_val': 0.038880997510290526, 'psi': 0.998345022862216}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=48 head_norm_before_train=2.047701 cos_to_last_merge=0.9865 (last merge round=35)
[S10] round=48 local utility u=0.000604 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9979691941807802, 'loss_val': 0.025631282212682793, 'psi': 0.9963815500105503}-{'f1_val': 0.9953231205637304, 'auprc': 0.9976603748999364, 'loss_val': 0.02591192389266265, 'psi': 0.9962580222982127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=48 head_norm_before_train=1.972825 cos_to_last_merge=0.9994 (last merge round=40)
[S11] round=48 local utility u=0.000403 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988817948391515, 'loss_val': 0.017306489731082033, 'psi': 0.9977312719114069}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988442054171229, 'loss_val': 0.018000112476165692, 'psi': 0.9977162361425955}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=48 head_norm_before_train=1.440161 cos_to_last_merge=0.9696 (last merge round=35)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6020559564522078, 'auprc': 0.6159485122050878, 'loss_val': 1.3072941691493087, 'psi': 0.6076129787533597}-{'f1_val': 0.708429700648237, 'auprc': 0.7793501712618724, 'loss_val': 0.6465711959309315, 'psi': 0.7367978888936912}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.000754 cos_to_last_merge=0.9900 (last merge round=34)
[S14] round=48 local utility u=0.002411 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9971571920653337, 'loss_val': 0.03446037886153555, 'psi': 0.9973527234560261}-{'f1_val': 0.9976516241010662, 'auprc': 0.9971584061350987, 'loss_val': 0.040296658084628595, 'psi': 0.9974543369146791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=48 head_norm_before_train=1.860451 cos_to_last_merge=0.9948 (last merge round=40)
[S15] round=48 local utility u=0.027333 metrics={'f1_val': 0.9137986355292711, 'auprc': 0.9977691917041315, 'loss_val': 0.14619886093753048, 'psi': 0.9473868579992152}-{'f1_val': 0.9099318728459405, 'auprc': 0.9980373247349075, 'loss_val': 0.17846828597321385, 'psi': 0.9451740536015273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=48 head_norm_before_train=1.626235 cos_to_last_merge=0.9941 (last merge round=35)
[S16] round=48 local utility u=0.007245 metrics={'f1_val': 0.9911095318775243, 'auprc': 0.9928348502334632, 'loss_val': 0.048246847855601405, 'psi': 0.9917996592198999}-{'f1_val': 0.9895471503383761, 'auprc': 0.9957530236875153, 'loss_val': 0.06211761931349094, 'psi': 0.9920294996780318}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=48 head_norm_before_train=1.876848 cos_to_last_merge=0.9794 (last merge round=36)
[S17] round=48 local utility u=0.913054 metrics={'f1_val': 0.8241494928680526, 'auprc': 0.9443432065383589, 'loss_val': 0.7019966195685515, 'psi': 0.8722269783361751}-{'f1_val': 0.6417800018769059, 'auprc': 0.8899193423749621, 'loss_val': 1.2706162434664368, 'psi': 0.7410357380761283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=49 head_norm_before_train=2.230802 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.831587653815581, 'auprc': 0.8422043962722829, 'loss_val': 0.4639110608549822, 'psi': 0.8358343507982617}-{'f1_val': 0.8338404335587014, 'auprc': 0.8290984366222562, 'loss_val': 0.40519395237989114, 'psi': 0.8319436347841234}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.845956 cos_to_last_merge=0.9890 (last merge round=42)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9988523274699922, 'loss_val': 0.07895954048529266, 'psi': 0.9764402191519485}-{'f1_val': 0.9940335392918865, 'auprc': 0.9988653653260642, 'loss_val': 0.03612416428082954, 'psi': 0.9959662697055576}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.706605 cos_to_last_merge=0.9860 (last merge round=36)
[S4] round=49 local utility u=0.064267 metrics={'f1_val': 0.9424929743779029, 'auprc': 0.9633324017035821, 'loss_val': 0.30848646880561437, 'psi': 0.9508287453081746}-{'f1_val': 0.9390316919928563, 'auprc': 0.9303523424311072, 'loss_val': 0.3173124711832958, 'psi': 0.9355599521681567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=49 head_norm_before_train=1.525422 cos_to_last_merge=0.9857 (last merge round=42)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.5986473576806036, 'auprc': 0.8452409433412698, 'loss_val': 0.5715342143085, 'psi': 0.6972847919448701}-{'f1_val': 0.6429297961556457, 'auprc': 0.9008217845810103, 'loss_val': 0.39892071599365586, 'psi': 0.7460865915257915}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=2.237891 (no previous merge yet)
[S6] round=49 local utility u=0.175623 metrics={'f1_val': 0.7762691869543596, 'auprc': 0.896514581179199, 'loss_val': 0.8029175305278807, 'psi': 0.8243673446442954}-{'f1_val': 0.7290233624977261, 'auprc': 0.9010788846929447, 'loss_val': 0.8843817533733027, 'psi': 0.7978455713758136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=49 head_norm_before_train=1.978101 cos_to_last_merge=0.9998 (last merge round=42)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.44645170692867553, 'auprc': 0.7803706833913787, 'loss_val': 1.0986071204230343, 'psi': 0.5800192975137568}-{'f1_val': 0.6648975577209757, 'auprc': 0.8314804377799795, 'loss_val': 0.381751819490659, 'psi': 0.7315307097445771}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.849445 cos_to_last_merge=0.9979 (last merge round=41)
[S8] round=49 local utility u=1.000000 metrics={'f1_val': 0.991490485949629, 'auprc': 0.9991946752584441, 'loss_val': 0.040831314067107716, 'psi': 0.994572161673155}-{'f1_val': 0.7137538225988359, 'auprc': 0.9812617103154722, 'loss_val': 0.5919211117383719, 'psi': 0.8207569776854904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=49 head_norm_before_train=1.477909 cos_to_last_merge=0.9941 (last merge round=40)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9973040786543159, 'loss_val': 0.03583211646356244, 'psi': 0.9974485654681127}-{'f1_val': 0.9975448900106438, 'auprc': 0.9995560979746091, 'loss_val': 0.03678539052135157, 'psi': 0.9983493731962299}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.057795 cos_to_last_merge=0.9860 (last merge round=35)
[S10] round=49 local utility u=0.000130 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980617758695278, 'loss_val': 0.025648461927030807, 'psi': 0.9964185826860493}-{'f1_val': 0.9953231205637304, 'auprc': 0.9979691941807802, 'loss_val': 0.025631282212682793, 'psi': 0.9963815500105503}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=49 head_norm_before_train=1.978469 cos_to_last_merge=0.9993 (last merge round=40)
[S11] round=49 local utility u=0.000298 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987908472360956, 'loss_val': 0.016437128996130937, 'psi': 0.9976948928701845}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988817948391515, 'loss_val': 0.017306489731082033, 'psi': 0.9977312719114069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=49 head_norm_before_train=1.450736 cos_to_last_merge=0.9683 (last merge round=35)
[S13] round=49 local utility u=0.915670 metrics={'f1_val': 0.7276302939406274, 'auprc': 0.8046368022562733, 'loss_val': 0.7954656390361807, 'psi': 0.7584328972668857}-{'f1_val': 0.6020559564522078, 'auprc': 0.6159485122050878, 'loss_val': 1.3072941691493087, 'psi': 0.6076129787533597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=49 head_norm_before_train=2.011677 cos_to_last_merge=0.9893 (last merge round=34)
[S14] round=49 local utility u=0.000452 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9975300073661792, 'loss_val': 0.03568206748824611, 'psi': 0.9976026737763839}-{'f1_val': 0.9974830777164877, 'auprc': 0.9971571920653337, 'loss_val': 0.03446037886153555, 'psi': 0.9973527234560261}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=1.881652 cos_to_last_merge=0.9942 (last merge round=40)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9126995218950944, 'auprc': 0.9977462329577018, 'loss_val': 0.1590189232920126, 'psi': 0.9467182063201374}-{'f1_val': 0.9137986355292711, 'auprc': 0.9977691917041315, 'loss_val': 0.14619886093753048, 'psi': 0.9473868579992152}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.636718 cos_to_last_merge=0.9937 (last merge round=35)
[S16] round=49 local utility u=0.000958 metrics={'f1_val': 0.9911177701878751, 'auprc': 0.9931259849969769, 'loss_val': 0.04725451522753046, 'psi': 0.9919210561115158}-{'f1_val': 0.9911095318775243, 'auprc': 0.9928348502334632, 'loss_val': 0.048246847855601405, 'psi': 0.9917996592198999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=49 head_norm_before_train=1.892220 cos_to_last_merge=0.9782 (last merge round=36)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6866186324084982, 'auprc': 0.9076639034899068, 'loss_val': 1.0573498045052905, 'psi': 0.7750367408410617}-{'f1_val': 0.8241494928680526, 'auprc': 0.9443432065383589, 'loss_val': 0.7019966195685515, 'psi': 0.8722269783361751}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=2.234863 (no previous merge yet)
[S2] round=50 local utility u=0.013973 metrics={'f1_val': 0.8287405263689985, 'auprc': 0.8580824553110922, 'loss_val': 0.46651589998814846, 'psi': 0.8404772979458359}-{'f1_val': 0.831587653815581, 'auprc': 0.8422043962722829, 'loss_val': 0.4639110608549822, 'psi': 0.8358343507982617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=50 head_norm_before_train=1.877110 cos_to_last_merge=0.9869 (last merge round=42)
[S3] round=50 local utility u=0.037065 metrics={'f1_val': 0.9715229121240536, 'auprc': 0.9988536370318459, 'loss_val': 0.06497730489937503, 'psi': 0.9824552020871705}-{'f1_val': 0.961498813606586, 'auprc': 0.9988523274699922, 'loss_val': 0.07895954048529266, 'psi': 0.9764402191519485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=50 head_norm_before_train=1.715974 cos_to_last_merge=0.9851 (last merge round=36)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9422429786383393, 'auprc': 0.9616634164982729, 'loss_val': 0.30868121313591546, 'psi': 0.9500111537823127}-{'f1_val': 0.9424929743779029, 'auprc': 0.9633324017035821, 'loss_val': 0.30848646880561437, 'psi': 0.9508287453081746}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.547687 cos_to_last_merge=0.9835 (last merge round=42)
[S5] round=50 local utility u=0.694708 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.991453832305607, 'loss_val': 0.2318368525965549, 'psi': 0.8168778525879167}-{'f1_val': 0.5986473576806036, 'auprc': 0.8452409433412698, 'loss_val': 0.5715342143085, 'psi': 0.6972847919448701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=50 head_norm_before_train=2.257845 (no previous merge yet)
[S6] round=50 local utility u=0.324501 metrics={'f1_val': 0.8280197952413028, 'auprc': 0.9356122409536032, 'loss_val': 0.5817128178118641, 'psi': 0.8710567735262229}-{'f1_val': 0.7762691869543596, 'auprc': 0.896514581179199, 'loss_val': 0.8029175305278807, 'psi': 0.8243673446442954}
[S6] not sending this round → trigger blocked (psi=0.871)
[S7] START round=50 head_norm_before_train=1.979775 cos_to_last_merge=0.9998 (last merge round=42)
[S7] round=50 local utility u=1.000000 metrics={'f1_val': 0.6804942328888217, 'auprc': 0.8295007571799713, 'loss_val': 0.3305258123154913, 'psi': 0.7400968426052815}-{'f1_val': 0.44645170692867553, 'auprc': 0.7803706833913787, 'loss_val': 1.0986071204230343, 'psi': 0.5800192975137568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=50 head_norm_before_train=1.851776 cos_to_last_merge=0.9978 (last merge round=41)
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.9808761635397599, 'auprc': 0.9988108300925186, 'loss_val': 0.0714337348674232, 'psi': 0.9880500301608633}-{'f1_val': 0.991490485949629, 'auprc': 0.9991946752584441, 'loss_val': 0.040831314067107716, 'psi': 0.994572161673155}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=50 head_norm_before_train=1.491798 cos_to_last_merge=0.9933 (last merge round=40)
[S9] round=50 local utility u=0.003146 metrics={'f1_val': 0.9971290324227131, 'auprc': 0.9995659643634243, 'loss_val': 0.03382993335320663, 'psi': 0.9981038051989977}-{'f1_val': 0.9975448900106438, 'auprc': 0.9973040786543159, 'loss_val': 0.03583211646356244, 'psi': 0.9974485654681127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=50 head_norm_before_train=2.066308 cos_to_last_merge=0.9856 (last merge round=35)
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980036620595218, 'loss_val': 0.025667443383912122, 'psi': 0.9963953371620469}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980617758695278, 'loss_val': 0.025648461927030807, 'psi': 0.9964185826860493}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=50 head_norm_before_train=1.984691 cos_to_last_merge=0.9991 (last merge round=40)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9988370551505898, 'loss_val': 0.017393012814728513, 'psi': 0.9975682738091451}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987908472360956, 'loss_val': 0.016437128996130937, 'psi': 0.9976948928701845}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.456411 cos_to_last_merge=0.9674 (last merge round=35)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.7249971682175587, 'auprc': 0.8472113455658739, 'loss_val': 0.9477726551546435, 'psi': 0.7738828391568848}-{'f1_val': 0.7276302939406274, 'auprc': 0.8046368022562733, 'loss_val': 0.7954656390361807, 'psi': 0.7584328972668857}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=2.021889 cos_to_last_merge=0.9886 (last merge round=34)
[S14] round=50 local utility u=0.000686 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9971527906973159, 'loss_val': 0.031738396981761924, 'psi': 0.9973077128396233}-{'f1_val': 0.9976511180498535, 'auprc': 0.9975300073661792, 'loss_val': 0.03568206748824611, 'psi': 0.9976026737763839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=50 head_norm_before_train=1.901122 cos_to_last_merge=0.9936 (last merge round=40)
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9977038919429435, 'loss_val': 0.1995326871733382, 'psi': 0.942007606484506}-{'f1_val': 0.9126995218950944, 'auprc': 0.9977462329577018, 'loss_val': 0.1590189232920126, 'psi': 0.9467182063201374}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=1.647501 cos_to_last_merge=0.9932 (last merge round=35)
[S16] round=50 local utility u=0.005760 metrics={'f1_val': 0.9908793938683479, 'auprc': 0.9973214100555918, 'loss_val': 0.046891329199456495, 'psi': 0.9934562003432454}-{'f1_val': 0.9911177701878751, 'auprc': 0.9931259849969769, 'loss_val': 0.04725451522753046, 'psi': 0.9919210561115158}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=50 head_norm_before_train=1.909099 cos_to_last_merge=0.9768 (last merge round=36)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6497007300192027, 'auprc': 0.8993437795566412, 'loss_val': 1.2315989526085638, 'psi': 0.7495579498341781}-{'f1_val': 0.6866186324084982, 'auprc': 0.9076639034899068, 'loss_val': 1.0573498045052905, 'psi': 0.7750367408410617}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=2.236289 (no previous merge yet)
[S2] round=51 local utility u=0.029019 metrics={'f1_val': 0.831587653815581, 'auprc': 0.868755672123512, 'loss_val': 0.4575807248227327, 'psi': 0.8464548611387535}-{'f1_val': 0.8287405263689985, 'auprc': 0.8580824553110922, 'loss_val': 0.46651589998814846, 'psi': 0.8404772979458359}
[S2] not sending this round → trigger blocked (psi=0.846)
[S3] START round=51 head_norm_before_train=1.901077 cos_to_last_merge=0.9852 (last merge round=42)
[S3] round=51 local utility u=0.040623 metrics={'f1_val': 0.9816704223582675, 'auprc': 0.9990185835029459, 'loss_val': 0.04511079691813475, 'psi': 0.9886096868161389}-{'f1_val': 0.9715229121240536, 'auprc': 0.9988536370318459, 'loss_val': 0.06497730489937503, 'psi': 0.9824552020871705}
[S3] not sending this round → trigger blocked (psi=0.989)
[S4] START round=51 head_norm_before_train=1.723434 cos_to_last_merge=0.9842 (last merge round=36)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9426999461425802, 'auprc': 0.947206109669176, 'loss_val': 0.318865744121575, 'psi': 0.9445024115532186}-{'f1_val': 0.9422429786383393, 'auprc': 0.9616634164982729, 'loss_val': 0.30868121313591546, 'psi': 0.9500111537823127}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.567313 cos_to_last_merge=0.9814 (last merge round=42)
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.6205566215690448, 'auprc': 0.7168262281589417, 'loss_val': 0.6330310452446065, 'psi': 0.6590644642050035}-{'f1_val': 0.7004938661094564, 'auprc': 0.991453832305607, 'loss_val': 0.2318368525965549, 'psi': 0.8168778525879167}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=2.271872 (no previous merge yet)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.8241052967886886, 'auprc': 0.9107541263582186, 'loss_val': 0.7423559667560218, 'psi': 0.8587648286165006}-{'f1_val': 0.8280197952413028, 'auprc': 0.9356122409536032, 'loss_val': 0.5817128178118641, 'psi': 0.8710567735262229}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.981455 cos_to_last_merge=0.9997 (last merge round=42)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.6548140737997493, 'auprc': 0.8038893057765854, 'loss_val': 0.4344235098174358, 'psi': 0.7144441665904837}-{'f1_val': 0.6804942328888217, 'auprc': 0.8295007571799713, 'loss_val': 0.3305258123154913, 'psi': 0.7400968426052815}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.859629 cos_to_last_merge=0.9976 (last merge round=41)
[S8] round=51 local utility u=0.052441 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9989738539377783, 'loss_val': 0.03613799345180233, 'psi': 0.9950248978627898}-{'f1_val': 0.9808761635397599, 'auprc': 0.9988108300925186, 'loss_val': 0.0714337348674232, 'psi': 0.9880500301608633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=51 head_norm_before_train=1.504611 cos_to_last_merge=0.9926 (last merge round=40)
[S9] round=51 local utility u=0.001086 metrics={'f1_val': 0.9972923331772335, 'auprc': 0.9995642017245094, 'loss_val': 0.03263288747023693, 'psi': 0.9982010805961439}-{'f1_val': 0.9971290324227131, 'auprc': 0.9995659643634243, 'loss_val': 0.03382993335320663, 'psi': 0.9981038051989977}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=51 head_norm_before_train=2.074709 cos_to_last_merge=0.9852 (last merge round=35)
[S10] round=51 local utility u=0.000538 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9982331958896502, 'loss_val': 0.025279074356404432, 'psi': 0.9964871506940982}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980036620595218, 'loss_val': 0.025667443383912122, 'psi': 0.9963953371620469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=51 head_norm_before_train=1.989660 cos_to_last_merge=0.9989 (last merge round=40)
[S11] round=51 local utility u=0.000990 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988290804273994, 'loss_val': 0.016840112651551456, 'psi': 0.997710186146706}-{'f1_val': 0.9967224195815153, 'auprc': 0.9988370551505898, 'loss_val': 0.017393012814728513, 'psi': 0.9975682738091451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=51 head_norm_before_train=1.459120 cos_to_last_merge=0.9669 (last merge round=35)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.6117004202252319, 'auprc': 0.7805172242304744, 'loss_val': 1.0798565161287017, 'psi': 0.6792271418273289}-{'f1_val': 0.7249971682175587, 'auprc': 0.8472113455658739, 'loss_val': 0.9477726551546435, 'psi': 0.7738828391568848}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=2.032184 cos_to_last_merge=0.9880 (last merge round=34)
[S14] round=51 local utility u=0.000633 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.997133848510001, 'loss_val': 0.0318560786878413, 'psi': 0.9974442102339125}-{'f1_val': 0.9974109942678281, 'auprc': 0.9971527906973159, 'loss_val': 0.031738396981761924, 'psi': 0.9973077128396233}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=51 head_norm_before_train=1.918480 cos_to_last_merge=0.9930 (last merge round=40)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9977163620635465, 'loss_val': 0.20624768460972004, 'psi': 0.9420125945327472}-{'f1_val': 0.9048767495122143, 'auprc': 0.9977038919429435, 'loss_val': 0.1995326871733382, 'psi': 0.942007606484506}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.658254 cos_to_last_merge=0.9927 (last merge round=35)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.990198520174784, 'auprc': 0.9949766341893767, 'loss_val': 0.055490885490067476, 'psi': 0.9921097657806212}-{'f1_val': 0.9908793938683479, 'auprc': 0.9973214100555918, 'loss_val': 0.046891329199456495, 'psi': 0.9934562003432454}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=1.922198 cos_to_last_merge=0.9756 (last merge round=36)
[S17] round=51 local utility u=0.776545 metrics={'f1_val': 0.7530085154844254, 'auprc': 0.9836685459552909, 'loss_val': 0.5513301485201851, 'psi': 0.8452725276727715}-{'f1_val': 0.6497007300192027, 'auprc': 0.8993437795566412, 'loss_val': 1.2315989526085638, 'psi': 0.7495579498341781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=52 head_norm_before_train=2.244584 (no previous merge yet)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.8326898918056047, 'auprc': 0.8105773225547407, 'loss_val': 0.43113928184068623, 'psi': 0.8238448641052591}-{'f1_val': 0.831587653815581, 'auprc': 0.868755672123512, 'loss_val': 0.4575807248227327, 'psi': 0.8464548611387535}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=1.922201 cos_to_last_merge=0.9836 (last merge round=42)
[S3] round=52 local utility u=0.057348 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9994811106989335, 'loss_val': 0.028813208955807516, 'psi': 0.9984958007594606}-{'f1_val': 0.9816704223582675, 'auprc': 0.9990185835029459, 'loss_val': 0.04511079691813475, 'psi': 0.9886096868161389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=52 head_norm_before_train=1.731475 cos_to_last_merge=0.9834 (last merge round=36)
[S4] round=52 local utility u=0.047644 metrics={'f1_val': 0.9480732011099193, 'auprc': 0.9638681753348946, 'loss_val': 0.30580343781306285, 'psi': 0.9543911907999094}-{'f1_val': 0.9426999461425802, 'auprc': 0.947206109669176, 'loss_val': 0.318865744121575, 'psi': 0.9445024115532186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=52 head_norm_before_train=1.583406 cos_to_last_merge=0.9797 (last merge round=42)
[S5] round=52 local utility u=0.579591 metrics={'f1_val': 0.6907266012070163, 'auprc': 0.8913106353455437, 'loss_val': 0.4183229411343209, 'psi': 0.7709602148624273}-{'f1_val': 0.6205566215690448, 'auprc': 0.7168262281589417, 'loss_val': 0.6330310452446065, 'psi': 0.6590644642050035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=52 head_norm_before_train=2.287467 (no previous merge yet)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.70048465622335, 'auprc': 0.699277243328075, 'loss_val': 1.1795247836459617, 'psi': 0.70000169106524}-{'f1_val': 0.8241052967886886, 'auprc': 0.9107541263582186, 'loss_val': 0.7423559667560218, 'psi': 0.8587648286165006}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.982484 cos_to_last_merge=0.9997 (last merge round=42)
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.6106345218293336, 'auprc': 0.787073630584192, 'loss_val': 0.5974066054754544, 'psi': 0.681210165331277}-{'f1_val': 0.6548140737997493, 'auprc': 0.8038893057765854, 'loss_val': 0.4344235098174358, 'psi': 0.7144441665904837}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=52 head_norm_before_train=1.867039 cos_to_last_merge=0.9972 (last merge round=41)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9918431215757397, 'auprc': 0.99926352619418, 'loss_val': 0.03736008890911895, 'psi': 0.9948112834231159}-{'f1_val': 0.992392260479464, 'auprc': 0.9989738539377783, 'loss_val': 0.03613799345180233, 'psi': 0.9950248978627898}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=1.515597 cos_to_last_merge=0.9920 (last merge round=40)
[S9] round=52 local utility u=0.001269 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9994834168300217, 'loss_val': 0.03136716670862882, 'psi': 0.998320300738395}-{'f1_val': 0.9972923331772335, 'auprc': 0.9995642017245094, 'loss_val': 0.03263288747023693, 'psi': 0.9982010805961439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=52 head_norm_before_train=2.083655 cos_to_last_merge=0.9847 (last merge round=35)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980509839987994, 'loss_val': 0.0253807204194512, 'psi': 0.996414265937758}-{'f1_val': 0.9953231205637304, 'auprc': 0.9982331958896502, 'loss_val': 0.025279074356404432, 'psi': 0.9964871506940982}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=52 head_norm_before_train=1.994028 cos_to_last_merge=0.9987 (last merge round=40)
[S11] round=52 local utility u=0.000390 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9990163214798389, 'loss_val': 0.016621708906760777, 'psi': 0.9977850825676818}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988290804273994, 'loss_val': 0.016840112651551456, 'psi': 0.997710186146706}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=52 head_norm_before_train=1.462392 cos_to_last_merge=0.9663 (last merge round=35)
[S13] round=52 local utility u=0.632172 metrics={'f1_val': 0.7309940557360407, 'auprc': 0.8363642350833647, 'loss_val': 0.6988148925498631, 'psi': 0.7731421274749704}-{'f1_val': 0.6117004202252319, 'auprc': 0.7805172242304744, 'loss_val': 1.0798565161287017, 'psi': 0.6792271418273289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=52 head_norm_before_train=2.043037 cos_to_last_merge=0.9874 (last merge round=34)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971571588246122, 'loss_val': 0.03500117804714667, 'psi': 0.997453534359757}-{'f1_val': 0.9976511180498535, 'auprc': 0.997133848510001, 'loss_val': 0.0318560786878413, 'psi': 0.9974442102339125}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=1.934218 cos_to_last_merge=0.9925 (last merge round=40)
[S15] round=52 local utility u=0.034203 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9977759645599981, 'loss_val': 0.16835041776444878, 'psi': 0.9450695095315635}-{'f1_val': 0.9048767495122143, 'auprc': 0.9977163620635465, 'loss_val': 0.20624768460972004, 'psi': 0.9420125945327472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=52 head_norm_before_train=1.667400 cos_to_last_merge=0.9922 (last merge round=35)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9404320407388727, 'auprc': 0.990803173309911, 'loss_val': 0.2281268381616933, 'psi': 0.9605804937672879}-{'f1_val': 0.990198520174784, 'auprc': 0.9949766341893767, 'loss_val': 0.055490885490067476, 'psi': 0.9921097657806212}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.933242 cos_to_last_merge=0.9746 (last merge round=36)
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.654360392520398, 'auprc': 0.8898482744426136, 'loss_val': 1.0329141291774901, 'psi': 0.7485555452892843}-{'f1_val': 0.7530085154844254, 'auprc': 0.9836685459552909, 'loss_val': 0.5513301485201851, 'psi': 0.8452725276727715}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=2.253142 (no previous merge yet)
[S2] round=53 local utility u=0.065662 metrics={'f1_val': 0.8314580742912931, 'auprc': 0.8738470137883213, 'loss_val': 0.48223295507768477, 'psi': 0.8484136500901045}-{'f1_val': 0.8326898918056047, 'auprc': 0.8105773225547407, 'loss_val': 0.43113928184068623, 'psi': 0.8238448641052591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=53 head_norm_before_train=1.934970 cos_to_last_merge=0.9823 (last merge round=42)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.9966508675148381, 'auprc': 0.9994171008791887, 'loss_val': 0.05111991983571481, 'psi': 0.9977573608605783}-{'f1_val': 0.9978389274664787, 'auprc': 0.9994811106989335, 'loss_val': 0.028813208955807516, 'psi': 0.9984958007594606}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.738829 cos_to_last_merge=0.9827 (last merge round=36)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9394176231379747, 'auprc': 0.9273983481739532, 'loss_val': 0.32687309557599825, 'psi': 0.9346099131523662}-{'f1_val': 0.9480732011099193, 'auprc': 0.9638681753348946, 'loss_val': 0.30580343781306285, 'psi': 0.9543911907999094}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.596205 cos_to_last_merge=0.9783 (last merge round=42)
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.5491398460812261, 'auprc': 0.6961989827700132, 'loss_val': 0.8151418994748282, 'psi': 0.607963500756741}-{'f1_val': 0.6907266012070163, 'auprc': 0.8913106353455437, 'loss_val': 0.4183229411343209, 'psi': 0.7709602148624273}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=2.301068 (no previous merge yet)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.6380379187750512, 'auprc': 0.7012768392164032, 'loss_val': 1.468562683710605, 'psi': 0.663333486951592}-{'f1_val': 0.70048465622335, 'auprc': 0.699277243328075, 'loss_val': 1.1795247836459617, 'psi': 0.70000169106524}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.984330 cos_to_last_merge=0.9997 (last merge round=42)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.5901654777924669, 'auprc': 0.7825796474334229, 'loss_val': 0.7384528887482587, 'psi': 0.6671311456488493}-{'f1_val': 0.6106345218293336, 'auprc': 0.787073630584192, 'loss_val': 0.5974066054754544, 'psi': 0.681210165331277}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=1.876890 cos_to_last_merge=0.9969 (last merge round=41)
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9905810174751647, 'loss_val': 0.035258656354465255, 'psi': 0.9923169021677942}-{'f1_val': 0.9918431215757397, 'auprc': 0.99926352619418, 'loss_val': 0.03736008890911895, 'psi': 0.9948112834231159}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=1.525601 cos_to_last_merge=0.9914 (last merge round=40)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9995535350786005, 'loss_val': 0.03743954539217359, 'psi': 0.995432099120359}-{'f1_val': 0.9975448900106438, 'auprc': 0.9994834168300217, 'loss_val': 0.03136716670862882, 'psi': 0.998320300738395}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=2.091380 cos_to_last_merge=0.9843 (last merge round=35)
[S10] round=53 local utility u=0.000066 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980900089640874, 'loss_val': 0.025365814910669957, 'psi': 0.9964298759238732}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980509839987994, 'loss_val': 0.0253807204194512, 'psi': 0.996414265937758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=53 head_norm_before_train=1.999478 cos_to_last_merge=0.9986 (last merge round=40)
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989370581137802, 'loss_val': 0.018032072820650242, 'psi': 0.9975053762425704}-{'f1_val': 0.9969642566262439, 'auprc': 0.9990163214798389, 'loss_val': 0.016621708906760777, 'psi': 0.9977850825676818}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=1.468822 cos_to_last_merge=0.9653 (last merge round=35)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6090526294036143, 'auprc': 0.8007401723730153, 'loss_val': 1.0387929462733494, 'psi': 0.6857276465913746}-{'f1_val': 0.7309940557360407, 'auprc': 0.8363642350833647, 'loss_val': 0.6988148925498631, 'psi': 0.7731421274749704}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=2.051074 cos_to_last_merge=0.9865 (last merge round=34)
[S14] round=53 local utility u=0.003139 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9973658052881397, 'loss_val': 0.028341740219527477, 'psi': 0.9974361687451485}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971571588246122, 'loss_val': 0.03500117804714667, 'psi': 0.997453534359757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=53 head_norm_before_train=1.949199 cos_to_last_merge=0.9920 (last merge round=40)
[S15] round=53 local utility u=0.025747 metrics={'f1_val': 0.9148932727677044, 'auprc': 0.9978225010069732, 'loss_val': 0.14676500493023542, 'psi': 0.9480649640634119}-{'f1_val': 0.9099318728459405, 'auprc': 0.9977759645599981, 'loss_val': 0.16835041776444878, 'psi': 0.9450695095315635}
[S15] not sending this round → trigger blocked (psi=0.948)
[S16] START round=53 head_norm_before_train=1.676194 cos_to_last_merge=0.9917 (last merge round=35)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.860123241217832, 'auprc': 0.9803424452460197, 'loss_val': 0.7600229909158334, 'psi': 0.9082109228291071}-{'f1_val': 0.9404320407388727, 'auprc': 0.990803173309911, 'loss_val': 0.2281268381616933, 'psi': 0.9605804937672879}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.943022 cos_to_last_merge=0.9735 (last merge round=36)
[S17] round=53 local utility u=0.344431 metrics={'f1_val': 0.7278163962641024, 'auprc': 0.9326956606059704, 'loss_val': 0.9133307314279229, 'psi': 0.8097681020008496}-{'f1_val': 0.654360392520398, 'auprc': 0.8898482744426136, 'loss_val': 1.0329141291774901, 'psi': 0.7485555452892843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=54 head_norm_before_train=2.261598 (no previous merge yet)
[S2] round=54 local utility u=0.013798 metrics={'f1_val': 0.8330035929183446, 'auprc': 0.8695686652406435, 'loss_val': 0.45107425824703773, 'psi': 0.8476296218472641}-{'f1_val': 0.8314580742912931, 'auprc': 0.8738470137883213, 'loss_val': 0.48223295507768477, 'psi': 0.8484136500901045}
[S2] not sending this round → trigger blocked (psi=0.848)
[S3] START round=54 head_norm_before_train=1.948580 cos_to_last_merge=0.9810 (last merge round=42)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.9816838519470642, 'auprc': 0.9993478188195382, 'loss_val': 0.07467969982269501, 'psi': 0.9887494386960538}-{'f1_val': 0.9966508675148381, 'auprc': 0.9994171008791887, 'loss_val': 0.05111991983571481, 'psi': 0.9977573608605783}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=1.748383 cos_to_last_merge=0.9819 (last merge round=36)
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.8269051915584981, 'auprc': 0.9326340757969958, 'loss_val': 0.45290499628303094, 'psi': 0.8691967452538971}-{'f1_val': 0.9394176231379747, 'auprc': 0.9273983481739532, 'loss_val': 0.32687309557599825, 'psi': 0.9346099131523662}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.608260 cos_to_last_merge=0.9770 (last merge round=42)
[S5] round=54 local utility u=1.000000 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.9178330798285564, 'loss_val': 0.3842372353199701, 'psi': 0.7875257654432606}-{'f1_val': 0.5491398460812261, 'auprc': 0.6961989827700132, 'loss_val': 0.8151418994748282, 'psi': 0.607963500756741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=54 head_norm_before_train=2.319326 (no previous merge yet)
[S6] round=54 local utility u=1.000000 metrics={'f1_val': 0.9678058163515895, 'auprc': 0.9595051328812485, 'loss_val': 0.13002640462723375, 'psi': 0.9644855429634531}-{'f1_val': 0.6380379187750512, 'auprc': 0.7012768392164032, 'loss_val': 1.468562683710605, 'psi': 0.663333486951592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=54 head_norm_before_train=1.986152 cos_to_last_merge=0.9996 (last merge round=42)
[S7] round=54 local utility u=0.271942 metrics={'f1_val': 0.6443508971114325, 'auprc': 0.7960291751330759, 'loss_val': 0.560030903330133, 'psi': 0.7050222083200899}-{'f1_val': 0.5901654777924669, 'auprc': 0.7825796474334229, 'loss_val': 0.7384528887482587, 'psi': 0.6671311456488493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=54 head_norm_before_train=1.887381 cos_to_last_merge=0.9964 (last merge round=41)
[S8] round=54 local utility u=0.004693 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9956954710347757, 'loss_val': 0.03472448941455599, 'psi': 0.9937135447015888}-{'f1_val': 0.9934741586295472, 'auprc': 0.9905810174751647, 'loss_val': 0.035258656354465255, 'psi': 0.9923169021677942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=54 head_norm_before_train=1.535263 cos_to_last_merge=0.9908 (last merge round=40)
[S9] round=54 local utility u=0.011425 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9953226092988139, 'loss_val': 0.031060228679702977, 'psi': 0.9966559777259119}-{'f1_val': 0.992684475148198, 'auprc': 0.9995535350786005, 'loss_val': 0.03743954539217359, 'psi': 0.995432099120359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=54 head_norm_before_train=2.100819 cos_to_last_merge=0.9837 (last merge round=35)
[S10] round=54 local utility u=0.000184 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9981872689816469, 'loss_val': 0.025288659725334013, 'psi': 0.9964687799308969}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980900089640874, 'loss_val': 0.025365814910669957, 'psi': 0.9964298759238732}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=54 head_norm_before_train=2.005105 cos_to_last_merge=0.9984 (last merge round=40)
[S11] round=54 local utility u=0.000564 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990073462223439, 'loss_val': 0.01711427636990112, 'psi': 0.9975334914859959}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989370581137802, 'loss_val': 0.018032072820650242, 'psi': 0.9975053762425704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=54 head_norm_before_train=1.478706 cos_to_last_merge=0.9640 (last merge round=35)
[S13] round=54 local utility u=0.209431 metrics={'f1_val': 0.6532968420037457, 'auprc': 0.7636647522260321, 'loss_val': 0.7741701141274488, 'psi': 0.6974440060926603}-{'f1_val': 0.6090526294036143, 'auprc': 0.8007401723730153, 'loss_val': 1.0387929462733494, 'psi': 0.6857276465913746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=54 head_norm_before_train=2.060000 cos_to_last_merge=0.9858 (last merge round=34)
[S14] round=54 local utility u=0.001003 metrics={'f1_val': 0.997244067813585, 'auprc': 0.9991824849180201, 'loss_val': 0.0303519724929136, 'psi': 0.998019434655359}-{'f1_val': 0.9974830777164877, 'auprc': 0.9973658052881397, 'loss_val': 0.028341740219527477, 'psi': 0.9974361687451485}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=54 head_norm_before_train=1.963318 cos_to_last_merge=0.9915 (last merge round=40)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9977566930441439, 'loss_val': 0.18261546522343655, 'psi': 0.9450618009252219}-{'f1_val': 0.9148932727677044, 'auprc': 0.9978225010069732, 'loss_val': 0.14676500493023542, 'psi': 0.9480649640634119}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=1.683522 cos_to_last_merge=0.9913 (last merge round=35)
[S16] round=54 local utility u=0.769068 metrics={'f1_val': 0.9912763242951694, 'auprc': 0.9936995782238623, 'loss_val': 0.048877221739017096, 'psi': 0.9922456258666466}-{'f1_val': 0.860123241217832, 'auprc': 0.9803424452460197, 'loss_val': 0.7600229909158334, 'psi': 0.9082109228291071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=54 head_norm_before_train=1.958492 cos_to_last_merge=0.9721 (last merge round=36)
[S17] round=54 local utility u=0.510413 metrics={'f1_val': 0.826327742981507, 'auprc': 0.9807253591311302, 'loss_val': 0.6276624380206388, 'psi': 0.8880867894413563}-{'f1_val': 0.7278163962641024, 'auprc': 0.9326956606059704, 'loss_val': 0.9133307314279229, 'psi': 0.8097681020008496}
[S17] not sending this round → trigger blocked (psi=0.888)
[S2] START round=55 head_norm_before_train=2.268265 (no previous merge yet)
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.8067699743448781, 'auprc': 0.8299353609104252, 'loss_val': 0.5418211366834698, 'psi': 0.8160361289710969}-{'f1_val': 0.8330035929183446, 'auprc': 0.8695686652406435, 'loss_val': 0.45107425824703773, 'psi': 0.8476296218472641}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=55 head_norm_before_train=1.964777 cos_to_last_merge=0.9797 (last merge round=42)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9610069327789146, 'auprc': 0.9996405248232889, 'loss_val': 0.1115411860931746, 'psi': 0.9764603695966643}-{'f1_val': 0.9816838519470642, 'auprc': 0.9993478188195382, 'loss_val': 0.07467969982269501, 'psi': 0.9887494386960538}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.755799 cos_to_last_merge=0.9813 (last merge round=36)
[S4] round=55 local utility u=0.291467 metrics={'f1_val': 0.9205340938123483, 'auprc': 0.9133003190698957, 'loss_val': 0.3737441252493765, 'psi': 0.9176405839153673}-{'f1_val': 0.8269051915584981, 'auprc': 0.9326340757969958, 'loss_val': 0.45290499628303094, 'psi': 0.8691967452538971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=55 head_norm_before_train=1.614619 cos_to_last_merge=0.9764 (last merge round=42)
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.6723674452414141, 'auprc': 0.9524172805992913, 'loss_val': 0.3197783904503087, 'psi': 0.784387379384565}-{'f1_val': 0.7006542225197299, 'auprc': 0.9178330798285564, 'loss_val': 0.3842372353199701, 'psi': 0.7875257654432606}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=2.333660 (no previous merge yet)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.8262220791814228, 'auprc': 0.9399105222709012, 'loss_val': 0.3371081701832264, 'psi': 0.8716974564172142}-{'f1_val': 0.9678058163515895, 'auprc': 0.9595051328812485, 'loss_val': 0.13002640462723375, 'psi': 0.9644855429634531}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.989404 cos_to_last_merge=0.9996 (last merge round=42)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.5924140050379325, 'auprc': 0.784883478579119, 'loss_val': 0.6764278590636622, 'psi': 0.6694017944544071}-{'f1_val': 0.6443508971114325, 'auprc': 0.7960291751330759, 'loss_val': 0.560030903330133, 'psi': 0.7050222083200899}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=55 head_norm_before_train=1.900158 cos_to_last_merge=0.9960 (last merge round=41)
[S8] round=55 local utility u=0.001286 metrics={'f1_val': 0.991490485949629, 'auprc': 0.9993447394011896, 'loss_val': 0.03768938742196979, 'psi': 0.9946321873302533}-{'f1_val': 0.992392260479464, 'auprc': 0.9956954710347757, 'loss_val': 0.03472448941455599, 'psi': 0.9937135447015888}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=55 head_norm_before_train=1.545277 cos_to_last_merge=0.9901 (last merge round=40)
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9995179459744367, 'loss_val': 0.032614111873918994, 'psi': 0.9966712327863207}-{'f1_val': 0.9975448900106438, 'auprc': 0.9953226092988139, 'loss_val': 0.031060228679702977, 'psi': 0.9966559777259119}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=2.109731 cos_to_last_merge=0.9831 (last merge round=35)
[S10] round=55 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980757691033901, 'loss_val': 0.02513617399684982, 'psi': 0.9964241799795943}-{'f1_val': 0.9953231205637304, 'auprc': 0.9981872689816469, 'loss_val': 0.025288659725334013, 'psi': 0.9964687799308969}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=55 head_norm_before_train=2.011785 cos_to_last_merge=0.9983 (last merge round=40)
[S11] round=55 local utility u=0.001835 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9990070743727799, 'loss_val': 0.015923198861843155, 'psi': 0.9977813837248583}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990073462223439, 'loss_val': 0.01711427636990112, 'psi': 0.9975334914859959}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=55 head_norm_before_train=1.488480 cos_to_last_merge=0.9628 (last merge round=35)
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.6469933724194444, 'auprc': 0.77754351247481, 'loss_val': 0.893412018909105, 'psi': 0.6992134284415907}-{'f1_val': 0.6532968420037457, 'auprc': 0.7636647522260321, 'loss_val': 0.7741701141274488, 'psi': 0.6974440060926603}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=2.068891 cos_to_last_merge=0.9852 (last merge round=34)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971567020396472, 'loss_val': 0.02563930314836063, 'psi': 0.9972068948393347}-{'f1_val': 0.997244067813585, 'auprc': 0.9991824849180201, 'loss_val': 0.0303519724929136, 'psi': 0.998019434655359}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.976512 cos_to_last_merge=0.9910 (last merge round=40)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9977293080850618, 'loss_val': 0.2055891708749423, 'psi': 0.9420177729413534}-{'f1_val': 0.9099318728459405, 'auprc': 0.9977566930441439, 'loss_val': 0.18261546522343655, 'psi': 0.9450618009252219}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.692219 cos_to_last_merge=0.9909 (last merge round=35)
[S16] round=55 local utility u=0.003076 metrics={'f1_val': 0.9915364364988188, 'auprc': 0.9938040210490782, 'loss_val': 0.04459890491906907, 'psi': 0.9924434703189227}-{'f1_val': 0.9912763242951694, 'auprc': 0.9936995782238623, 'loss_val': 0.048877221739017096, 'psi': 0.9922456258666466}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=55 head_norm_before_train=1.977419 cos_to_last_merge=0.9706 (last merge round=36)
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.6230206677374424, 'auprc': 0.8212964847377153, 'loss_val': 1.5585979064037518, 'psi': 0.7023309945375515}-{'f1_val': 0.826327742981507, 'auprc': 0.9807253591311302, 'loss_val': 0.6276624380206388, 'psi': 0.8880867894413563}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=56 head_norm_before_train=2.269862 (no previous merge yet)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.699652457111956, 'auprc': 0.7678945954426242, 'loss_val': 1.0373291246010137, 'psi': 0.7269493124442232}-{'f1_val': 0.8067699743448781, 'auprc': 0.8299353609104252, 'loss_val': 0.5418211366834698, 'psi': 0.8160361289710969}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=1.981746 cos_to_last_merge=0.9785 (last merge round=42)
[S3] round=56 local utility u=0.007444 metrics={'f1_val': 0.9610069327789146, 'auprc': 0.9993737905942599, 'loss_val': 0.09585333601971312, 'psi': 0.9763536759050526}-{'f1_val': 0.9610069327789146, 'auprc': 0.9996405248232889, 'loss_val': 0.1115411860931746, 'psi': 0.9764603695966643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=56 head_norm_before_train=1.757708 cos_to_last_merge=0.9808 (last merge round=36)
[S4] round=56 local utility u=0.105456 metrics={'f1_val': 0.9354381586152516, 'auprc': 0.9394124634983736, 'loss_val': 0.33059200509890996, 'psi': 0.9370278805685004}-{'f1_val': 0.9205340938123483, 'auprc': 0.9133003190698957, 'loss_val': 0.3737441252493765, 'psi': 0.9176405839153673}
[S4] not sending this round → trigger blocked (psi=0.937)
[S5] START round=56 head_norm_before_train=1.621452 cos_to_last_merge=0.9757 (last merge round=42)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.43692658691564545, 'auprc': 0.8534543827610713, 'loss_val': 1.1319732943887229, 'psi': 0.6035377052538158}-{'f1_val': 0.6723674452414141, 'auprc': 0.9524172805992913, 'loss_val': 0.3197783904503087, 'psi': 0.784387379384565}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=2.346267 (no previous merge yet)
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.7719288875945609, 'auprc': 0.8947873609394277, 'loss_val': 0.8464540290477667, 'psi': 0.8210722769325076}-{'f1_val': 0.8262220791814228, 'auprc': 0.9399105222709012, 'loss_val': 0.3371081701832264, 'psi': 0.8716974564172142}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=56 head_norm_before_train=1.993734 cos_to_last_merge=0.9996 (last merge round=42)
[S7] round=56 local utility u=0.391164 metrics={'f1_val': 0.6553210261149052, 'auprc': 0.8211324427345522, 'loss_val': 0.3802878788876404, 'psi': 0.7216455927627641}-{'f1_val': 0.5924140050379325, 'auprc': 0.784883478579119, 'loss_val': 0.6764278590636622, 'psi': 0.6694017944544071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=56 head_norm_before_train=1.911956 cos_to_last_merge=0.9956 (last merge round=41)
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.9815462313836643, 'auprc': 0.9992463462750345, 'loss_val': 0.05515193335850373, 'psi': 0.9886262773402124}-{'f1_val': 0.991490485949629, 'auprc': 0.9993447394011896, 'loss_val': 0.03768938742196979, 'psi': 0.9946321873302533}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=56 head_norm_before_train=1.554812 cos_to_last_merge=0.9895 (last merge round=40)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9945961973539869, 'loss_val': 0.03014211687161782, 'psi': 0.995853973700452}-{'f1_val': 0.9947734239942433, 'auprc': 0.9995179459744367, 'loss_val': 0.032614111873918994, 'psi': 0.9966712327863207}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=2.116858 cos_to_last_merge=0.9827 (last merge round=35)
[S10] round=56 local utility u=0.000202 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9981589051464879, 'loss_val': 0.024981879421917978, 'psi': 0.9964574343968333}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980757691033901, 'loss_val': 0.02513617399684982, 'psi': 0.9964241799795943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=56 head_norm_before_train=2.016634 cos_to_last_merge=0.9981 (last merge round=40)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9982146553892757, 'loss_val': 0.019956240290711035, 'psi': 0.9970713129259314}-{'f1_val': 0.9969642566262439, 'auprc': 0.9990070743727799, 'loss_val': 0.015923198861843155, 'psi': 0.9977813837248583}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.498704 cos_to_last_merge=0.9616 (last merge round=35)
[S13] round=56 local utility u=0.293961 metrics={'f1_val': 0.7225248517965129, 'auprc': 0.8086448909234019, 'loss_val': 0.8519834705087322, 'psi': 0.7569728674472684}-{'f1_val': 0.6469933724194444, 'auprc': 0.77754351247481, 'loss_val': 0.893412018909105, 'psi': 0.6992134284415907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=56 head_norm_before_train=2.077278 cos_to_last_merge=0.9845 (last merge round=34)
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.997110088197853, 'loss_val': 0.0351551937083413, 'psi': 0.997681455188349}-{'f1_val': 0.997240356705793, 'auprc': 0.9971567020396472, 'loss_val': 0.02563930314836063, 'psi': 0.9972068948393347}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=56 head_norm_before_train=1.988855 cos_to_last_merge=0.9906 (last merge round=40)
[S15] round=56 local utility u=0.009487 metrics={'f1_val': 0.906572453969457, 'auprc': 0.9977341082990168, 'loss_val': 0.19680439091572022, 'psi': 0.9430371157012809}-{'f1_val': 0.9048767495122143, 'auprc': 0.9977293080850618, 'loss_val': 0.2055891708749423, 'psi': 0.9420177729413534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=56 head_norm_before_train=1.701033 cos_to_last_merge=0.9905 (last merge round=35)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.9913138240137411, 'auprc': 0.9920659203627248, 'loss_val': 0.05321291581083742, 'psi': 0.9916146625533346}-{'f1_val': 0.9915364364988188, 'auprc': 0.9938040210490782, 'loss_val': 0.04459890491906907, 'psi': 0.9924434703189227}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=1.989762 cos_to_last_merge=0.9694 (last merge round=36)
[S17] round=56 local utility u=1.000000 metrics={'f1_val': 0.8545854556883912, 'auprc': 0.9877553456982215, 'loss_val': 0.3900410792588403, 'psi': 0.9078534116923234}-{'f1_val': 0.6230206677374424, 'auprc': 0.8212964847377153, 'loss_val': 1.5585979064037518, 'psi': 0.7023309945375515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=57 head_norm_before_train=2.275347 (no previous merge yet)
[S2] round=57 local utility u=0.860479 metrics={'f1_val': 0.8314580742912931, 'auprc': 0.8908177911762416, 'loss_val': 0.4759749817547424, 'psi': 0.8552019610452726}-{'f1_val': 0.699652457111956, 'auprc': 0.7678945954426242, 'loss_val': 1.0373291246010137, 'psi': 0.7269493124442232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=57 head_norm_before_train=1.997309 cos_to_last_merge=0.9775 (last merge round=42)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.8902457204076988, 'auprc': 0.9982990015896355, 'loss_val': 0.17440714040943736, 'psi': 0.9334670328804735}-{'f1_val': 0.9610069327789146, 'auprc': 0.9993737905942599, 'loss_val': 0.09585333601971312, 'psi': 0.9763536759050526}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.757194 cos_to_last_merge=0.9801 (last merge round=36)
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9373848545963486, 'auprc': 0.9154980324053241, 'loss_val': 0.3303725130541647, 'psi': 0.9286301257199387}-{'f1_val': 0.9354381586152516, 'auprc': 0.9394124634983736, 'loss_val': 0.33059200509890996, 'psi': 0.9370278805685004}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.631594 cos_to_last_merge=0.9746 (last merge round=42)
[S5] round=57 local utility u=1.000000 metrics={'f1_val': 0.8725885662480996, 'auprc': 0.9923187842692163, 'loss_val': 0.13562739547811037, 'psi': 0.9204806534565463}-{'f1_val': 0.43692658691564545, 'auprc': 0.8534543827610713, 'loss_val': 1.1319732943887229, 'psi': 0.6035377052538158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=57 head_norm_before_train=2.360366 (no previous merge yet)
[S6] round=57 local utility u=0.107719 metrics={'f1_val': 0.7968159811041482, 'auprc': 0.9080747873841223, 'loss_val': 0.8202008488132575, 'psi': 0.8413195036161378}-{'f1_val': 0.7719288875945609, 'auprc': 0.8947873609394277, 'loss_val': 0.8464540290477667, 'psi': 0.8210722769325076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=57 head_norm_before_train=1.998718 cos_to_last_merge=0.9995 (last merge round=42)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.5038999944537322, 'auprc': 0.7808622523759852, 'loss_val': 0.8431886641583336, 'psi': 0.6146848976226333}-{'f1_val': 0.6553210261149052, 'auprc': 0.8211324427345522, 'loss_val': 0.3802878788876404, 'psi': 0.7216455927627641}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=1.918725 cos_to_last_merge=0.9953 (last merge round=41)
[S8] round=57 local utility u=0.037268 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9966364372993572, 'loss_val': 0.035676765703296, 'psi': 0.9938712810216941}-{'f1_val': 0.9815462313836643, 'auprc': 0.9992463462750345, 'loss_val': 0.05515193335850373, 'psi': 0.9886262773402124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=57 head_norm_before_train=1.562980 cos_to_last_merge=0.9890 (last merge round=40)
[S9] round=57 local utility u=0.003535 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9991524471111138, 'loss_val': 0.032710052791106774, 'psi': 0.9972734000307579}-{'f1_val': 0.9966924912647621, 'auprc': 0.9945961973539869, 'loss_val': 0.03014211687161782, 'psi': 0.995853973700452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=57 head_norm_before_train=2.125418 cos_to_last_merge=0.9821 (last merge round=35)
[S10] round=57 local utility u=0.000035 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9982324219766336, 'loss_val': 0.025132479923619208, 'psi': 0.9964868411288916}-{'f1_val': 0.9953231205637304, 'auprc': 0.9981589051464879, 'loss_val': 0.024981879421917978, 'psi': 0.9964574343968333}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=57 head_norm_before_train=2.020853 cos_to_last_merge=0.9979 (last merge round=40)
[S11] round=57 local utility u=0.002862 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989163489721407, 'loss_val': 0.017788897697575294, 'psi': 0.9974970925859146}-{'f1_val': 0.9963090846170353, 'auprc': 0.9982146553892757, 'loss_val': 0.019956240290711035, 'psi': 0.9970713129259314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=57 head_norm_before_train=1.512613 cos_to_last_merge=0.9601 (last merge round=35)
[S13] round=57 local utility u=0.136247 metrics={'f1_val': 0.747517442796295, 'auprc': 0.806580203503888, 'loss_val': 0.7232513712476981, 'psi': 0.7711425470793323}-{'f1_val': 0.7225248517965129, 'auprc': 0.8086448909234019, 'loss_val': 0.8519834705087322, 'psi': 0.7569728674472684}
[S13] not sending this round → trigger blocked (psi=0.771)
[S14] START round=57 head_norm_before_train=2.084734 cos_to_last_merge=0.9840 (last merge round=34)
[S14] round=57 local utility u=0.000262 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9974458469328769, 'loss_val': 0.030394381265434593, 'psi': 0.9972912599752648}-{'f1_val': 0.9980623665153463, 'auprc': 0.997110088197853, 'loss_val': 0.0351551937083413, 'psi': 0.997681455188349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=57 head_norm_before_train=2.000831 cos_to_last_merge=0.9901 (last merge round=40)
[S15] round=57 local utility u=0.007946 metrics={'f1_val': 0.9076969618858638, 'auprc': 0.9977473446982943, 'loss_val': 0.18769898108146657, 'psi': 0.943717115010836}-{'f1_val': 0.906572453969457, 'auprc': 0.9977341082990168, 'loss_val': 0.19680439091572022, 'psi': 0.9430371157012809}
[S15] not sending this round → trigger blocked (psi=0.944)
[S16] START round=57 head_norm_before_train=1.708442 cos_to_last_merge=0.9900 (last merge round=35)
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.9259809948668976, 'auprc': 0.9910276986385342, 'loss_val': 0.38760251283082253, 'psi': 0.9519996763755523}-{'f1_val': 0.9913138240137411, 'auprc': 0.9920659203627248, 'loss_val': 0.05321291581083742, 'psi': 0.9916146625533346}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=1.998708 cos_to_last_merge=0.9686 (last merge round=36)
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.7403291664751992, 'auprc': 0.9332348172894684, 'loss_val': 0.869432668022998, 'psi': 0.8174914268009069}-{'f1_val': 0.8545854556883912, 'auprc': 0.9877553456982215, 'loss_val': 0.3900410792588403, 'psi': 0.9078534116923234}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=58 head_norm_before_train=2.283748 (no previous merge yet)
[S2] round=58 local utility u=0.051446 metrics={'f1_val': 0.8257518331687904, 'auprc': 0.9431728696366375, 'loss_val': 0.4959101873199654, 'psi': 0.8727202477559293}-{'f1_val': 0.8314580742912931, 'auprc': 0.8908177911762416, 'loss_val': 0.4759749817547424, 'psi': 0.8552019610452726}
[S2] not sending this round → trigger blocked (psi=0.873)
[S3] START round=58 head_norm_before_train=2.010567 cos_to_last_merge=0.9766 (last merge round=42)
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.8579530433479912, 'auprc': 0.9986097370810558, 'loss_val': 0.24395855256557558, 'psi': 0.914215720841217}-{'f1_val': 0.8902457204076988, 'auprc': 0.9982990015896355, 'loss_val': 0.17440714040943736, 'psi': 0.9334670328804735}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.757364 cos_to_last_merge=0.9793 (last merge round=36)
[S4] round=58 local utility u=0.068137 metrics={'f1_val': 0.9476423662753513, 'auprc': 0.9352454181914505, 'loss_val': 0.3148850985211346, 'psi': 0.9426835870417909}-{'f1_val': 0.9373848545963486, 'auprc': 0.9154980324053241, 'loss_val': 0.3303725130541647, 'psi': 0.9286301257199387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=58 head_norm_before_train=1.640035 cos_to_last_merge=0.9738 (last merge round=42)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.9417792973500307, 'loss_val': 0.42567011333470334, 'psi': 0.7971042524518502}-{'f1_val': 0.8725885662480996, 'auprc': 0.9923187842692163, 'loss_val': 0.13562739547811037, 'psi': 0.9204806534565463}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=2.369065 (no previous merge yet)
[S6] round=58 local utility u=0.747840 metrics={'f1_val': 0.9205073183282376, 'auprc': 0.954171183331675, 'loss_val': 0.20495731981849258, 'psi': 0.9339728643296126}-{'f1_val': 0.7968159811041482, 'auprc': 0.9080747873841223, 'loss_val': 0.8202008488132575, 'psi': 0.8413195036161378}
[S6] not sending this round → trigger blocked (psi=0.934)
[S7] START round=58 head_norm_before_train=2.002392 cos_to_last_merge=0.9994 (last merge round=42)
[S7] round=58 local utility u=0.615379 metrics={'f1_val': 0.6469586699330537, 'auprc': 0.8002435235513138, 'loss_val': 0.528927022397418, 'psi': 0.7082726113803578}-{'f1_val': 0.5038999944537322, 'auprc': 0.7808622523759852, 'loss_val': 0.8431886641583336, 'psi': 0.6146848976226333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=58 head_norm_before_train=1.922679 cos_to_last_merge=0.9950 (last merge round=41)
[S8] round=58 local utility u=0.002591 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9983402582618711, 'loss_val': 0.03560590302685622, 'psi': 0.9945528094066997}-{'f1_val': 0.992027843503252, 'auprc': 0.9966364372993572, 'loss_val': 0.035676765703296, 'psi': 0.9938712810216941}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=58 head_norm_before_train=1.570053 cos_to_last_merge=0.9886 (last merge round=40)
[S9] round=58 local utility u=0.002606 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9978689288628355, 'loss_val': 0.028638863260524033, 'psi': 0.9972591228004886}-{'f1_val': 0.9960207019771873, 'auprc': 0.9991524471111138, 'loss_val': 0.032710052791106774, 'psi': 0.9972734000307579}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=58 head_norm_before_train=2.134272 cos_to_last_merge=0.9815 (last merge round=35)
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9981717394601182, 'loss_val': 0.02523303297510808, 'psi': 0.9964625681222854}-{'f1_val': 0.9953231205637304, 'auprc': 0.9982324219766336, 'loss_val': 0.025132479923619208, 'psi': 0.9964868411288916}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=2.025555 cos_to_last_merge=0.9977 (last merge round=40)
[S11] round=58 local utility u=0.000351 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989794969766713, 'loss_val': 0.01727613870345802, 'psi': 0.9975223517877269}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989163489721407, 'loss_val': 0.017788897697575294, 'psi': 0.9974970925859146}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=58 head_norm_before_train=1.524901 cos_to_last_merge=0.9589 (last merge round=35)
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.7274244960346865, 'auprc': 0.7747648811399006, 'loss_val': 0.8646875957730132, 'psi': 0.7463606500767721}-{'f1_val': 0.747517442796295, 'auprc': 0.806580203503888, 'loss_val': 0.7232513712476981, 'psi': 0.7711425470793323}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=2.089955 cos_to_last_merge=0.9835 (last merge round=34)
[S14] round=58 local utility u=0.005949 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9992246685989172, 'loss_val': 0.02530525324881564, 'psi': 0.9981500495019228}-{'f1_val': 0.9971882020035234, 'auprc': 0.9974458469328769, 'loss_val': 0.030394381265434593, 'psi': 0.9972912599752648}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=58 head_norm_before_train=2.012156 cos_to_last_merge=0.9897 (last merge round=40)
[S15] round=58 local utility u=0.011601 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9977783214887341, 'loss_val': 0.17799940801904532, 'psi': 0.945070452303058}-{'f1_val': 0.9076969618858638, 'auprc': 0.9977473446982943, 'loss_val': 0.18769898108146657, 'psi': 0.943717115010836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=58 head_norm_before_train=1.714919 cos_to_last_merge=0.9896 (last merge round=35)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.848822562114995, 'auprc': 0.9824444999888482, 'loss_val': 0.9169300617019229, 'psi': 0.9022713372645362}-{'f1_val': 0.9259809948668976, 'auprc': 0.9910276986385342, 'loss_val': 0.38760251283082253, 'psi': 0.9519996763755523}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=2.005846 cos_to_last_merge=0.9679 (last merge round=36)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.670766542226691, 'auprc': 0.8205197069905857, 'loss_val': 1.3248989644597038, 'psi': 0.7306678081322489}-{'f1_val': 0.7403291664751992, 'auprc': 0.9332348172894684, 'loss_val': 0.869432668022998, 'psi': 0.8174914268009069}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=2.289697 (no previous merge yet)
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.828546302106276, 'auprc': 0.8467488556765937, 'loss_val': 0.5059932248595327, 'psi': 0.8358273235344031}-{'f1_val': 0.8257518331687904, 'auprc': 0.9431728696366375, 'loss_val': 0.4959101873199654, 'psi': 0.8727202477559293}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.836 u=0.0000 p_local=0.1443 f1=0.829 auprc=0.847 bytes=44953
[S3] START round=59 head_norm_before_train=2.022910 cos_to_last_merge=0.9758 (last merge round=42)
[S3] round=59 local utility u=0.161550 metrics={'f1_val': 0.9001958296472979, 'auprc': 0.9987336851222853, 'loss_val': 0.17468636270700336, 'psi': 0.9396109718372929}-{'f1_val': 0.8579530433479912, 'auprc': 0.9986097370810558, 'loss_val': 0.24395855256557558, 'psi': 0.914215720841217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] r=60 psi=0.940 u=0.1616 p_local=0.0494 f1=0.900 auprc=0.999 bytes=46783
[S4] START round=59 head_norm_before_train=1.759593 cos_to_last_merge=0.9783 (last merge round=36)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9451098640454435, 'auprc': 0.9323735107233504, 'loss_val': 0.3245083106138403, 'psi': 0.9400153227166063}-{'f1_val': 0.9476423662753513, 'auprc': 0.9352454181914505, 'loss_val': 0.3148850985211346, 'psi': 0.9426835870417909}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.940 u=0.0000 p_local=0.0601 f1=0.945 auprc=0.932 bytes=43178
[S5] START round=59 head_norm_before_train=1.645241 cos_to_last_merge=0.9728 (last merge round=42)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.7005679112968205, 'auprc': 0.9217655636257914, 'loss_val': 0.37756688654088744, 'psi': 0.7890469722284089}-{'f1_val': 0.7006542225197299, 'auprc': 0.9417792973500307, 'loss_val': 0.42567011333470334, 'psi': 0.7971042524518502}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.789 u=0.0000 p_local=0.2560 f1=0.701 auprc=0.922 bytes=50366
[S6] START round=59 head_norm_before_train=2.380298 (no previous merge yet)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.8457747766487271, 'auprc': 0.91955806893006, 'loss_val': 0.5853527752723598, 'psi': 0.8752880935612602}-{'f1_val': 0.9205073183282376, 'auprc': 0.954171183331675, 'loss_val': 0.20495731981849258, 'psi': 0.9339728643296126}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.875 u=0.0000 p_local=0.2369 f1=0.846 auprc=0.920 bytes=43115
[S7] START round=59 head_norm_before_train=2.006938 cos_to_last_merge=0.9993 (last merge round=42)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.5434687905498868, 'auprc': 0.782120376705682, 'loss_val': 0.9727008357796368, 'psi': 0.638929425012205}-{'f1_val': 0.6469586699330537, 'auprc': 0.8002435235513138, 'loss_val': 0.528927022397418, 'psi': 0.7082726113803578}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.639 u=0.0000 p_local=0.2052 f1=0.543 auprc=0.782 bytes=48635
[S8] START round=59 head_norm_before_train=1.929878 cos_to_last_merge=0.9946 (last merge round=41)
[S8] round=59 local utility u=0.000225 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9989045958764328, 'loss_val': 0.03580063303772679, 'psi': 0.9946737674568825}-{'f1_val': 0.992027843503252, 'auprc': 0.9983402582618711, 'loss_val': 0.03560590302685622, 'psi': 0.9945528094066997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S8] r=60 psi=0.995 u=0.0002 p_local=0.0354 f1=0.992 auprc=0.999 bytes=46747
[S9] START round=59 head_norm_before_train=1.577712 cos_to_last_merge=0.9881 (last merge round=40)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9972945621169176, 'auprc': 0.9961570000288544, 'loss_val': 0.028891409158123767, 'psi': 0.9968395372816923}-{'f1_val': 0.9968525854255906, 'auprc': 0.9978689288628355, 'loss_val': 0.028638863260524033, 'psi': 0.9972591228004886}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.997 u=0.0000 p_local=0.0022 f1=0.997 auprc=0.996 bytes=57555
[S10] START round=59 head_norm_before_train=2.142064 cos_to_last_merge=0.9810 (last merge round=35)
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9981179003713118, 'loss_val': 0.025092948870285514, 'psi': 0.996441032486763}-{'f1_val': 0.9953231205637304, 'auprc': 0.9981717394601182, 'loss_val': 0.02523303297510808, 'psi': 0.9964625681222854}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=60 psi=0.996 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.998 bytes=48600
[S11] START round=59 head_norm_before_train=2.030161 cos_to_last_merge=0.9976 (last merge round=40)
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986767075884695, 'loss_val': 0.01905797575714826, 'psi': 0.997256133805609}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989794969766713, 'loss_val': 0.01727613870345802, 'psi': 0.9975223517877269}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.997 u=0.0000 p_local=0.0008 f1=0.996 auprc=0.999 bytes=48607
[S13] START round=59 head_norm_before_train=1.533657 cos_to_last_merge=0.9580 (last merge round=35)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6333037570381821, 'auprc': 0.6731219045851022, 'loss_val': 1.055562444230643, 'psi': 0.6492310160569501}-{'f1_val': 0.7274244960346865, 'auprc': 0.7747648811399006, 'loss_val': 0.8646875957730132, 'psi': 0.7463606500767721}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.649 u=0.0000 p_local=0.1192 f1=0.633 auprc=0.673 bytes=50434
[S14] START round=59 head_norm_before_train=2.096225 cos_to_last_merge=0.9829 (last merge round=34)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971567224999741, 'loss_val': 0.02388846420929858, 'psi': 0.9972069030234655}-{'f1_val': 0.9974336367705932, 'auprc': 0.9992246685989172, 'loss_val': 0.02530525324881564, 'psi': 0.9981500495019228}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0019 f1=0.997 auprc=0.997 bytes=55790
[S15] START round=59 head_norm_before_train=2.022935 cos_to_last_merge=0.9893 (last merge round=40)
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.906572453969457, 'auprc': 0.9977475144968633, 'loss_val': 0.19880543446276053, 'psi': 0.9430424781804195}-{'f1_val': 0.9099318728459405, 'auprc': 0.9977783214887341, 'loss_val': 0.17799940801904532, 'psi': 0.945070452303058}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.943 u=0.0000 p_local=0.0152 f1=0.907 auprc=0.998 bytes=48476
[S16] START round=59 head_norm_before_train=1.719208 cos_to_last_merge=0.9892 (last merge round=35)
[S16] round=59 local utility u=0.879108 metrics={'f1_val': 0.9910847237329736, 'auprc': 0.9933159130895528, 'loss_val': 0.04490208096849784, 'psi': 0.9919771994756053}-{'f1_val': 0.848822562114995, 'auprc': 0.9824444999888482, 'loss_val': 0.9169300617019229, 'psi': 0.9022713372645362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] r=60 psi=0.992 u=0.8791 p_local=0.2397 f1=0.991 auprc=0.993 bytes=41334
[S17] START round=59 head_norm_before_train=2.014728 cos_to_last_merge=0.9671 (last merge round=36)
[S17] round=59 local utility u=0.420509 metrics={'f1_val': 0.6929421421739612, 'auprc': 0.929926979281922, 'loss_val': 0.9451569928460403, 'psi': 0.7877360770171455}-{'f1_val': 0.670766542226691, 'auprc': 0.8205197069905857, 'loss_val': 1.3248989644597038, 'psi': 0.7306678081322489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S17] r=60 psi=0.788 u=0.4205 p_local=0.2883 f1=0.693 auprc=0.930 bytes=43205
[S2] START round=60 head_norm_before_train=2.291947 (no previous merge yet)
[S2] round=60 local utility u=0.035726 metrics={'f1_val': 0.8292596923352412, 'auprc': 0.865295828626421, 'loss_val': 0.4944631111516477, 'psi': 0.843674146851713}-{'f1_val': 0.828546302106276, 'auprc': 0.8467488556765937, 'loss_val': 0.5059932248595327, 'psi': 0.8358273235344031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=60 head_norm_before_train=2.035632 cos_to_last_merge=0.9751 (last merge round=42)
[S3] round=60 local utility u=0.219587 metrics={'f1_val': 0.959523692640043, 'auprc': 0.9987530377246989, 'loss_val': 0.09153800453747661, 'psi': 0.9752154306739054}-{'f1_val': 0.9001958296472979, 'auprc': 0.9987336851222853, 'loss_val': 0.17468636270700336, 'psi': 0.9396109718372929}
[S3] not sending this round → trigger blocked (psi=0.975)
[S4] START round=60 head_norm_before_train=1.767050 cos_to_last_merge=0.9777 (last merge round=36)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9401938786388216, 'auprc': 0.9269564917170419, 'loss_val': 0.31739350739853966, 'psi': 0.9348989238701098}-{'f1_val': 0.9451098640454435, 'auprc': 0.9323735107233504, 'loss_val': 0.3245083106138403, 'psi': 0.9400153227166063}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.650206 cos_to_last_merge=0.9716 (last merge round=42)
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.6850301632116547, 'auprc': 0.9024776550895983, 'loss_val': 0.4061285899679168, 'psi': 0.7720091599628321}-{'f1_val': 0.7005679112968205, 'auprc': 0.9217655636257914, 'loss_val': 0.37756688654088744, 'psi': 0.7890469722284089}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=2.395034 (no previous merge yet)
[S6] round=60 local utility u=0.377590 metrics={'f1_val': 0.9082115727069744, 'auprc': 0.9437775354391793, 'loss_val': 0.2774524970839653, 'psi': 0.9224379577998563}-{'f1_val': 0.8457747766487271, 'auprc': 0.91955806893006, 'loss_val': 0.5853527752723598, 'psi': 0.8752880935612602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S7] START round=60 head_norm_before_train=2.010635 cos_to_last_merge=0.9992 (last merge round=42)
[S7] round=60 local utility u=0.631364 metrics={'f1_val': 0.6577437551158863, 'auprc': 0.8112253599695404, 'loss_val': 0.4829370563766401, 'psi': 0.7191363970573479}-{'f1_val': 0.5434687905498868, 'auprc': 0.782120376705682, 'loss_val': 0.9727008357796368, 'psi': 0.638929425012205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=60 head_norm_before_train=1.941953 cos_to_last_merge=0.9942 (last merge round=41)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9875357054597707, 'auprc': 0.9991665092854292, 'loss_val': 0.04194557477007553, 'psi': 0.992188026990034}-{'f1_val': 0.9918532151771823, 'auprc': 0.9989045958764328, 'loss_val': 0.03580063303772679, 'psi': 0.9946737674568825}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=1.586196 cos_to_last_merge=0.9875 (last merge round=40)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9884857476974027, 'auprc': 0.99947870473864, 'loss_val': 0.04636974361249714, 'psi': 0.9928829305138976}-{'f1_val': 0.9972945621169176, 'auprc': 0.9961570000288544, 'loss_val': 0.028891409158123767, 'psi': 0.9968395372816923}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=2.147966 cos_to_last_merge=0.9807 (last merge round=35)
[S10] round=60 local utility u=0.000181 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9982229283562123, 'loss_val': 0.025045152292975215, 'psi': 0.996483043680723}-{'f1_val': 0.9953231205637304, 'auprc': 0.9981179003713118, 'loss_val': 0.025092948870285514, 'psi': 0.996441032486763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=60 head_norm_before_train=2.034649 cos_to_last_merge=0.9975 (last merge round=40)
[S11] round=60 local utility u=0.005196 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9994884086520921, 'loss_val': 0.015172856265611536, 'psi': 0.9979880743153663}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986767075884695, 'loss_val': 0.01905797575714826, 'psi': 0.997256133805609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=60 head_norm_before_train=1.540173 cos_to_last_merge=0.9570 (last merge round=35)
[S13] round=60 local utility u=0.114130 metrics={'f1_val': 0.6557773391037789, 'auprc': 0.6914315850481652, 'loss_val': 1.0170725657138853, 'psi': 0.6700390374815334}-{'f1_val': 0.6333037570381821, 'auprc': 0.6731219045851022, 'loss_val': 1.055562444230643, 'psi': 0.6492310160569501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=60 head_norm_before_train=2.103923 cos_to_last_merge=0.9823 (last merge round=34)
[S14] round=60 local utility u=0.000575 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971548781900682, 'loss_val': 0.02519769918647673, 'psi': 0.9974526221059394}-{'f1_val': 0.997240356705793, 'auprc': 0.9971567224999741, 'loss_val': 0.02388846420929858, 'psi': 0.9972069030234655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=60 head_norm_before_train=2.033308 cos_to_last_merge=0.9889 (last merge round=40)
[S15] round=60 local utility u=0.016788 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9977755659787265, 'loss_val': 0.18546995975899386, 'psi': 0.9450693500990549}-{'f1_val': 0.906572453969457, 'auprc': 0.9977475144968633, 'loss_val': 0.19880543446276053, 'psi': 0.9430424781804195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=60 head_norm_before_train=1.724922 cos_to_last_merge=0.9889 (last merge round=35)
[S16] round=60 local utility u=0.010009 metrics={'f1_val': 0.9919545878295252, 'auprc': 0.9970145152698109, 'loss_val': 0.04119993629800402, 'psi': 0.9939785588056395}-{'f1_val': 0.9910847237329736, 'auprc': 0.9933159130895528, 'loss_val': 0.04490208096849784, 'psi': 0.9919771994756053}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=60 head_norm_before_train=2.024496 cos_to_last_merge=0.9662 (last merge round=36)
[S17] round=60 local utility u=0.542775 metrics={'f1_val': 0.8031502917239602, 'auprc': 0.9785836160337317, 'loss_val': 0.6668256485472218, 'psi': 0.8733236214478688}-{'f1_val': 0.6929421421739612, 'auprc': 0.929926979281922, 'loss_val': 0.9451569928460403, 'psi': 0.7877360770171455}
[S17] not sending this round → trigger blocked (psi=0.873)
[S2] START round=61 head_norm_before_train=2.295999 (no previous merge yet)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.833128272836096, 'auprc': 0.8045039865556181, 'loss_val': 0.43913265732732126, 'psi': 0.8216785583239048}-{'f1_val': 0.8292596923352412, 'auprc': 0.865295828626421, 'loss_val': 0.4944631111516477, 'psi': 0.843674146851713}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.047768 cos_to_last_merge=0.9743 (last merge round=42)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.7765977675542635, 'auprc': 0.9950612125444782, 'loss_val': 0.3881489441395645, 'psi': 0.8639831455503494}-{'f1_val': 0.959523692640043, 'auprc': 0.9987530377246989, 'loss_val': 0.09153800453747661, 'psi': 0.9752154306739054}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.774377 cos_to_last_merge=0.9772 (last merge round=36)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.8409814435192702, 'auprc': 0.9376619669064936, 'loss_val': 0.4241154672208229, 'psi': 0.8796536528741595}-{'f1_val': 0.9401938786388216, 'auprc': 0.9269564917170419, 'loss_val': 0.31739350739853966, 'psi': 0.9348989238701098}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.653011 cos_to_last_merge=0.9706 (last merge round=42)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.604057542888884, 'auprc': 0.8636204451974716, 'loss_val': 0.661535897416533, 'psi': 0.707882703812319}-{'f1_val': 0.6850301632116547, 'auprc': 0.9024776550895983, 'loss_val': 0.4061285899679168, 'psi': 0.7720091599628321}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=2.408500 (no previous merge yet)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.8471912477663184, 'auprc': 0.943182371075441, 'loss_val': 0.4088030375245056, 'psi': 0.8855876970899674}-{'f1_val': 0.9082115727069744, 'auprc': 0.9437775354391793, 'loss_val': 0.2774524970839653, 'psi': 0.9224379577998563}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=2.012218 cos_to_last_merge=0.9992 (last merge round=42)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.4485792535383013, 'auprc': 0.7796378264519397, 'loss_val': 1.0797909723173633, 'psi': 0.5810026827037567}-{'f1_val': 0.6577437551158863, 'auprc': 0.8112253599695404, 'loss_val': 0.4829370563766401, 'psi': 0.7191363970573479}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.951001 cos_to_last_merge=0.9938 (last merge round=41)
[S8] round=61 local utility u=0.016233 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9984263667337271, 'loss_val': 0.03421215892499018, 'psi': 0.994587252795442}-{'f1_val': 0.9875357054597707, 'auprc': 0.9991665092854292, 'loss_val': 0.04194557477007553, 'psi': 0.992188026990034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=61 head_norm_before_train=1.594918 cos_to_last_merge=0.9869 (last merge round=40)
[S9] round=61 local utility u=0.031278 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9954880402524993, 'loss_val': 0.026196719481351372, 'psi': 0.996722150107386}-{'f1_val': 0.9884857476974027, 'auprc': 0.99947870473864, 'loss_val': 0.04636974361249714, 'psi': 0.9928829305138976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=61 head_norm_before_train=2.155499 cos_to_last_merge=0.9802 (last merge round=35)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.998059092631373, 'loss_val': 0.025030973482422215, 'psi': 0.9964175093907874}-{'f1_val': 0.9953231205637304, 'auprc': 0.9982229283562123, 'loss_val': 0.025045152292975215, 'psi': 0.996483043680723}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=2.039706 cos_to_last_merge=0.9973 (last merge round=40)
[S11] round=61 local utility u=0.001409 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9994778968809388, 'loss_val': 0.014803046318806481, 'psi': 0.9982318731824213}-{'f1_val': 0.9969878514242156, 'auprc': 0.9994884086520921, 'loss_val': 0.015172856265611536, 'psi': 0.9979880743153663}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=61 head_norm_before_train=1.548707 cos_to_last_merge=0.9560 (last merge round=35)
[S13] round=61 local utility u=0.316799 metrics={'f1_val': 0.6994418417578326, 'auprc': 0.7452519487741827, 'loss_val': 0.8069231968316595, 'psi': 0.7177658845643726}-{'f1_val': 0.6557773391037789, 'auprc': 0.6914315850481652, 'loss_val': 1.0170725657138853, 'psi': 0.6700390374815334}
[S13] not sending this round → trigger blocked (psi=0.718)
[S14] START round=61 head_norm_before_train=2.111981 cos_to_last_merge=0.9816 (last merge round=34)
[S14] round=61 local utility u=0.001915 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9992084829416794, 'loss_val': 0.023762162058770717, 'psi': 0.9978974067832187}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971548781900682, 'loss_val': 0.02519769918647673, 'psi': 0.9974526221059394}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=61 head_norm_before_train=2.043307 cos_to_last_merge=0.9886 (last merge round=40)
[S15] round=61 local utility u=0.000047 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9977875908529092, 'loss_val': 0.1854111416814063, 'psi': 0.945074160048728}-{'f1_val': 0.9099318728459405, 'auprc': 0.9977755659787265, 'loss_val': 0.18546995975899386, 'psi': 0.9450693500990549}
[S15] not sending this round → trigger blocked (psi=0.945)
[S16] START round=61 head_norm_before_train=1.730710 cos_to_last_merge=0.9886 (last merge round=35)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.9922163343538072, 'auprc': 0.994311333087698, 'loss_val': 0.048138615770457464, 'psi': 0.9930543338473634}-{'f1_val': 0.9919545878295252, 'auprc': 0.9970145152698109, 'loss_val': 0.04119993629800402, 'psi': 0.9939785588056395}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=2.036225 cos_to_last_merge=0.9652 (last merge round=36)
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.784284177877129, 'auprc': 0.980436319864517, 'loss_val': 0.5977699475564491, 'psi': 0.8627450346720842}-{'f1_val': 0.8031502917239602, 'auprc': 0.9785836160337317, 'loss_val': 0.6668256485472218, 'psi': 0.8733236214478688}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=2.302207 (no previous merge yet)
[S2] round=62 local utility u=0.082393 metrics={'f1_val': 0.8284077145752056, 'auprc': 0.8898332367718401, 'loss_val': 0.502011581074141, 'psi': 0.8529779234538595}-{'f1_val': 0.833128272836096, 'auprc': 0.8045039865556181, 'loss_val': 0.43913265732732126, 'psi': 0.8216785583239048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=62 head_norm_before_train=2.058984 cos_to_last_merge=0.9736 (last merge round=42)
[S3] round=62 local utility u=0.268568 metrics={'f1_val': 0.8383977244726291, 'auprc': 0.998531154033414, 'loss_val': 0.23222202211347553, 'psi': 0.9024510962969431}-{'f1_val': 0.7765977675542635, 'auprc': 0.9950612125444782, 'loss_val': 0.3881489441395645, 'psi': 0.8639831455503494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] sending update (kind=head size=1807 to 1 peers)
[S4] START round=62 head_norm_before_train=1.780294 cos_to_last_merge=0.9767 (last merge round=36)
[S4] round=62 local utility u=0.254228 metrics={'f1_val': 0.9182553893052209, 'auprc': 0.9330550769106551, 'loss_val': 0.3654830597795825, 'psi': 0.9241752643473946}-{'f1_val': 0.8409814435192702, 'auprc': 0.9376619669064936, 'loss_val': 0.4241154672208229, 'psi': 0.8796536528741595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=62 head_norm_before_train=1.654920 cos_to_last_merge=0.9698 (last merge round=42)
[S5] round=62 local utility u=0.655802 metrics={'f1_val': 0.7019308194147154, 'auprc': 0.9777788598714998, 'loss_val': 0.27964659191565433, 'psi': 0.812270035597429}-{'f1_val': 0.604057542888884, 'auprc': 0.8636204451974716, 'loss_val': 0.661535897416533, 'psi': 0.707882703812319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=62 head_norm_before_train=2.415427 (no previous merge yet)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.8273814897870868, 'auprc': 0.9231917147886581, 'loss_val': 0.453690386896222, 'psi': 0.8657055797877153}-{'f1_val': 0.8471912477663184, 'auprc': 0.943182371075441, 'loss_val': 0.4088030375245056, 'psi': 0.8855876970899674}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=2.012914 cos_to_last_merge=0.9992 (last merge round=42)
[S7] round=62 local utility u=1.000000 metrics={'f1_val': 0.8852571418461787, 'auprc': 0.876237958149733, 'loss_val': 0.21846479317733078, 'psi': 0.8816494683676004}-{'f1_val': 0.4485792535383013, 'auprc': 0.7796378264519397, 'loss_val': 1.0797909723173633, 'psi': 0.5810026827037567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=62 head_norm_before_train=1.954431 cos_to_last_merge=0.9934 (last merge round=41)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9683620776055503, 'auprc': 0.9991628081129613, 'loss_val': 0.08956938402556512, 'psi': 0.9806823698085146}-{'f1_val': 0.992027843503252, 'auprc': 0.9984263667337271, 'loss_val': 0.03421215892499018, 'psi': 0.994587252795442}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=1.601734 cos_to_last_merge=0.9864 (last merge round=40)
[S9] round=62 local utility u=0.001564 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.996107354115085, 'loss_val': 0.024925985242402363, 'psi': 0.9969698756524202}-{'f1_val': 0.9975448900106438, 'auprc': 0.9954880402524993, 'loss_val': 0.026196719481351372, 'psi': 0.996722150107386}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=62 head_norm_before_train=2.161292 cos_to_last_merge=0.9798 (last merge round=35)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980155946438726, 'loss_val': 0.025130926107396485, 'psi': 0.9964001101957872}-{'f1_val': 0.9953231205637304, 'auprc': 0.998059092631373, 'loss_val': 0.025030973482422215, 'psi': 0.9964175093907874}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=2.045542 cos_to_last_merge=0.9972 (last merge round=40)
[S11] round=62 local utility u=0.000032 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9994498718929068, 'loss_val': 0.01465512711307985, 'psi': 0.9982206631872085}-{'f1_val': 0.9974011907167429, 'auprc': 0.9994778968809388, 'loss_val': 0.014803046318806481, 'psi': 0.9982318731824213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=62 head_norm_before_train=1.557785 cos_to_last_merge=0.9551 (last merge round=35)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.6945474921762278, 'auprc': 0.7318250272548917, 'loss_val': 0.8459759871953317, 'psi': 0.7094585062076935}-{'f1_val': 0.6994418417578326, 'auprc': 0.7452519487741827, 'loss_val': 0.8069231968316595, 'psi': 0.7177658845643726}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=2.118968 cos_to_last_merge=0.9811 (last merge round=34)
[S14] round=62 local utility u=0.000521 metrics={'f1_val': 0.9969931333709598, 'auprc': 0.9995753151656726, 'loss_val': 0.02363936961466603, 'psi': 0.9980260060888448}-{'f1_val': 0.9970233560109115, 'auprc': 0.9992084829416794, 'loss_val': 0.023762162058770717, 'psi': 0.9978974067832187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=62 head_norm_before_train=2.052840 cos_to_last_merge=0.9882 (last merge round=40)
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9977688872332419, 'loss_val': 0.1929495641389089, 'psi': 0.945066678600861}-{'f1_val': 0.9099318728459405, 'auprc': 0.9977875908529092, 'loss_val': 0.1854111416814063, 'psi': 0.945074160048728}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=62 head_norm_before_train=1.735520 cos_to_last_merge=0.9881 (last merge round=35)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9301325514530512, 'auprc': 0.9868960376603871, 'loss_val': 0.39372343182926695, 'psi': 0.9528379459359856}-{'f1_val': 0.9922163343538072, 'auprc': 0.994311333087698, 'loss_val': 0.048138615770457464, 'psi': 0.9930543338473634}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=2.043452 cos_to_last_merge=0.9644 (last merge round=36)
[S17] round=62 local utility u=0.298308 metrics={'f1_val': 0.8463532805564522, 'auprc': 0.9966647236068493, 'loss_val': 0.42225476024725533, 'psi': 0.906477857776611}-{'f1_val': 0.784284177877129, 'auprc': 0.980436319864517, 'loss_val': 0.5977699475564491, 'psi': 0.8627450346720842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=63 head_norm_before_train=2.309516 (no previous merge yet)
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.8102862112492287, 'auprc': 0.8818952127285237, 'loss_val': 0.5536768388170222, 'psi': 0.8389298118409467}-{'f1_val': 0.8284077145752056, 'auprc': 0.8898332367718401, 'loss_val': 0.502011581074141, 'psi': 0.8529779234538595}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=2.069609 cos_to_last_merge=0.9729 (last merge round=42)
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.8027419201001352, 'auprc': 0.9984095080270706, 'loss_val': 0.2861727577474993, 'psi': 0.8810089552709094}-{'f1_val': 0.8383977244726291, 'auprc': 0.998531154033414, 'loss_val': 0.23222202211347553, 'psi': 0.9024510962969431}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.790857 cos_to_last_merge=0.9760 (last merge round=36)
[S4] round=63 local utility u=0.059774 metrics={'f1_val': 0.9393932787487804, 'auprc': 0.9180009070022058, 'loss_val': 0.3275991072982961, 'psi': 0.9308363300501505}-{'f1_val': 0.9182553893052209, 'auprc': 0.9330550769106551, 'loss_val': 0.3654830597795825, 'psi': 0.9241752643473946}
[S4] not sending this round → trigger blocked (psi=0.931)
[S5] START round=63 head_norm_before_train=1.658292 cos_to_last_merge=0.9693 (last merge round=42)
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9718161045386372, 'loss_val': 0.3255340959751626, 'psi': 0.8091708063800233}-{'f1_val': 0.7019308194147154, 'auprc': 0.9777788598714998, 'loss_val': 0.27964659191565433, 'psi': 0.812270035597429}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=2.424986 (no previous merge yet)
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.7040505764716153, 'auprc': 0.8325777105717485, 'loss_val': 1.2351912958139082, 'psi': 0.7554614301116687}-{'f1_val': 0.8273814897870868, 'auprc': 0.9231917147886581, 'loss_val': 0.453690386896222, 'psi': 0.8657055797877153}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=2.014371 cos_to_last_merge=0.9992 (last merge round=42)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.5945600484844163, 'auprc': 0.789970175430793, 'loss_val': 0.5655434431217337, 'psi': 0.6727240992629671}-{'f1_val': 0.8852571418461787, 'auprc': 0.876237958149733, 'loss_val': 0.21846479317733078, 'psi': 0.8816494683676004}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.961227 cos_to_last_merge=0.9930 (last merge round=41)
[S8] round=63 local utility u=0.092008 metrics={'f1_val': 0.9905756323661, 'auprc': 0.99920334608699, 'loss_val': 0.03895710109879107, 'psi': 0.9940267178544561}-{'f1_val': 0.9683620776055503, 'auprc': 0.9991628081129613, 'loss_val': 0.08956938402556512, 'psi': 0.9806823698085146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=63 head_norm_before_train=1.609326 cos_to_last_merge=0.9859 (last merge round=40)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9952192229505256, 'auprc': 0.9995480951429662, 'loss_val': 0.026807924390282577, 'psi': 0.9969507718275019}-{'f1_val': 0.9975448900106438, 'auprc': 0.996107354115085, 'loss_val': 0.024925985242402363, 'psi': 0.9969698756524202}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.167265 cos_to_last_merge=0.9795 (last merge round=35)
[S10] round=63 local utility u=0.000071 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980547449858655, 'loss_val': 0.025106833430420118, 'psi': 0.9964157703325844}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980155946438726, 'loss_val': 0.025130926107396485, 'psi': 0.9964001101957872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=63 head_norm_before_train=2.048640 cos_to_last_merge=0.9970 (last merge round=40)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.999431576673944, 'loss_val': 0.014814374154406196, 'psi': 0.997951184645324}-{'f1_val': 0.9974011907167429, 'auprc': 0.9994498718929068, 'loss_val': 0.01465512711307985, 'psi': 0.9982206631872085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.568403 cos_to_last_merge=0.9540 (last merge round=35)
[S13] round=63 local utility u=0.000000 metrics={'f1_val': 0.671477059244079, 'auprc': 0.7013815765000506, 'loss_val': 0.9577931238143523, 'psi': 0.6834388661464676}-{'f1_val': 0.6945474921762278, 'auprc': 0.7318250272548917, 'loss_val': 0.8459759871953317, 'psi': 0.7094585062076935}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=63 head_norm_before_train=2.124799 cos_to_last_merge=0.9804 (last merge round=34)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9978596448935944, 'loss_val': 0.03307504318897588, 'psi': 0.9976024882618154}-{'f1_val': 0.9969931333709598, 'auprc': 0.9995753151656726, 'loss_val': 0.02363936961466603, 'psi': 0.9980260060888448}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=2.062104 cos_to_last_merge=0.9879 (last merge round=40)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.906572453969457, 'auprc': 0.9977467776501788, 'loss_val': 0.20891029711137218, 'psi': 0.9430421834417457}-{'f1_val': 0.9099318728459405, 'auprc': 0.9977688872332419, 'loss_val': 0.1929495641389089, 'psi': 0.945066678600861}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.741050 cos_to_last_merge=0.9878 (last merge round=35)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.8830435480198993, 'auprc': 0.9869370741381149, 'loss_val': 0.5926538707314079, 'psi': 0.9246009584671856}-{'f1_val': 0.9301325514530512, 'auprc': 0.9868960376603871, 'loss_val': 0.39372343182926695, 'psi': 0.9528379459359856}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=2.054234 cos_to_last_merge=0.9634 (last merge round=36)
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.8241797894920538, 'auprc': 0.9765762430642134, 'loss_val': 0.5852323299920927, 'psi': 0.8851383709209177}-{'f1_val': 0.8463532805564522, 'auprc': 0.9966647236068493, 'loss_val': 0.42225476024725533, 'psi': 0.906477857776611}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=2.313902 (no previous merge yet)
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.7447010335967794, 'auprc': 0.7687386417633845, 'loss_val': 0.853523197724366, 'psi': 0.7543160768634214}-{'f1_val': 0.8102862112492287, 'auprc': 0.8818952127285237, 'loss_val': 0.5536768388170222, 'psi': 0.8389298118409467}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=2.079360 cos_to_last_merge=0.9722 (last merge round=42)
[S3] round=64 local utility u=0.419406 metrics={'f1_val': 0.9191581096576598, 'auprc': 0.9990448515197842, 'loss_val': 0.14776432942801554, 'psi': 0.9511128064025095}-{'f1_val': 0.8027419201001352, 'auprc': 0.9984095080270706, 'loss_val': 0.2861727577474993, 'psi': 0.8810089552709094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S3] sending update (kind=head size=1808 to 1 peers)
[S4] START round=64 head_norm_before_train=1.798162 cos_to_last_merge=0.9752 (last merge round=36)
[S4] round=64 local utility u=0.055274 metrics={'f1_val': 0.9421107061887543, 'auprc': 0.9474252727101433, 'loss_val': 0.321628691284097, 'psi': 0.9442365327973099}-{'f1_val': 0.9393932787487804, 'auprc': 0.9180009070022058, 'loss_val': 0.3275991072982961, 'psi': 0.9308363300501505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=64 head_norm_before_train=1.663815 cos_to_last_merge=0.9688 (last merge round=42)
[S5] round=64 local utility u=0.821281 metrics={'f1_val': 0.9303808655198202, 'auprc': 0.9920686792354996, 'loss_val': 0.12157148977237694, 'psi': 0.955055991006092}-{'f1_val': 0.7007406076076139, 'auprc': 0.9718161045386372, 'loss_val': 0.3255340959751626, 'psi': 0.8091708063800233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=64 head_norm_before_train=2.438650 (no previous merge yet)
[S6] round=64 local utility u=0.259509 metrics={'f1_val': 0.753277736913893, 'auprc': 0.8627003439888242, 'loss_val': 1.1019032034970062, 'psi': 0.7970467797438654}-{'f1_val': 0.7040505764716153, 'auprc': 0.8325777105717485, 'loss_val': 1.2351912958139082, 'psi': 0.7554614301116687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=64 head_norm_before_train=2.014544 cos_to_last_merge=0.9992 (last merge round=42)
[S7] round=64 local utility u=0.007864 metrics={'f1_val': 0.6032843779277822, 'auprc': 0.7873419917707682, 'loss_val': 0.5942768557669972, 'psi': 0.6769074234649766}-{'f1_val': 0.5945600484844163, 'auprc': 0.789970175430793, 'loss_val': 0.5655434431217337, 'psi': 0.6727240992629671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=64 head_norm_before_train=1.966382 cos_to_last_merge=0.9926 (last merge round=41)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9808509939921313, 'auprc': 0.9991250101912463, 'loss_val': 0.06426249094529617, 'psi': 0.9881606004717772}-{'f1_val': 0.9905756323661, 'auprc': 0.99920334608699, 'loss_val': 0.03895710109879107, 'psi': 0.9940267178544561}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=1.614990 cos_to_last_merge=0.9856 (last merge round=40)
[S9] round=64 local utility u=0.004150 metrics={'f1_val': 0.9964645815439231, 'auprc': 0.9995464895859584, 'loss_val': 0.02597547380234357, 'psi': 0.9976973447607372}-{'f1_val': 0.9952192229505256, 'auprc': 0.9995480951429662, 'loss_val': 0.026807924390282577, 'psi': 0.9969507718275019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=64 head_norm_before_train=2.174522 cos_to_last_merge=0.9790 (last merge round=35)
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980249510822978, 'loss_val': 0.025103859822094565, 'psi': 0.9964038527711574}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980547449858655, 'loss_val': 0.025106833430420118, 'psi': 0.9964157703325844}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=2.053302 cos_to_last_merge=0.9968 (last merge round=40)
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.99943365339319, 'loss_val': 0.015037527896169564, 'psi': 0.9979520153330224}-{'f1_val': 0.9969642566262439, 'auprc': 0.999431576673944, 'loss_val': 0.014814374154406196, 'psi': 0.997951184645324}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.578573 cos_to_last_merge=0.9528 (last merge round=35)
[S13] round=64 local utility u=0.166716 metrics={'f1_val': 0.7212773774951537, 'auprc': 0.7409052660367388, 'loss_val': 1.0417333596613305, 'psi': 0.7291285329117878}-{'f1_val': 0.671477059244079, 'auprc': 0.7013815765000506, 'loss_val': 0.9577931238143523, 'psi': 0.6834388661464676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=64 head_norm_before_train=2.127628 cos_to_last_merge=0.9798 (last merge round=34)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9971172568502809, 'loss_val': 0.03779812021077006, 'psi': 0.9971872380824585}-{'f1_val': 0.9974310505072961, 'auprc': 0.9978596448935944, 'loss_val': 0.03307504318897588, 'psi': 0.9976024882618154}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=64 head_norm_before_train=2.071094 cos_to_last_merge=0.9875 (last merge round=40)
[S15] round=64 local utility u=0.018500 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.997781450560016, 'loss_val': 0.19217182695338156, 'psi': 0.9450717039315707}-{'f1_val': 0.906572453969457, 'auprc': 0.9977467776501788, 'loss_val': 0.20891029711137218, 'psi': 0.9430421834417457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=64 head_norm_before_train=1.747209 cos_to_last_merge=0.9875 (last merge round=35)
[S16] round=64 local utility u=0.612993 metrics={'f1_val': 0.9916846636119114, 'auprc': 0.9949901912179585, 'loss_val': 0.04267488000105199, 'psi': 0.9930068746543304}-{'f1_val': 0.8830435480198993, 'auprc': 0.9869370741381149, 'loss_val': 0.5926538707314079, 'psi': 0.9246009584671856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=64 head_norm_before_train=2.065455 cos_to_last_merge=0.9625 (last merge round=36)
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.6480151032717512, 'auprc': 0.8794984479755676, 'loss_val': 1.4078793454087277, 'psi': 0.7406084411532778}-{'f1_val': 0.8241797894920538, 'auprc': 0.9765762430642134, 'loss_val': 0.5852323299920927, 'psi': 0.8851383709209177}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=2.316939 (no previous merge yet)
[S2] round=65 local utility u=0.691223 metrics={'f1_val': 0.8308816644389775, 'auprc': 0.9317420300538946, 'loss_val': 0.4771716370904375, 'psi': 0.8712258106849443}-{'f1_val': 0.7447010335967794, 'auprc': 0.7687386417633845, 'loss_val': 0.853523197724366, 'psi': 0.7543160768634214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=65 head_norm_before_train=2.089949 cos_to_last_merge=0.9716 (last merge round=42)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.7582398907809808, 'auprc': 0.9982732442742118, 'loss_val': 0.3744536003908446, 'psi': 0.8542532321782732}-{'f1_val': 0.9191581096576598, 'auprc': 0.9990448515197842, 'loss_val': 0.14776432942801554, 'psi': 0.9511128064025095}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.802637 cos_to_last_merge=0.9742 (last merge round=36)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9406771633444998, 'auprc': 0.9365802108132417, 'loss_val': 0.32855962983498915, 'psi': 0.9390383823319965}-{'f1_val': 0.9421107061887543, 'auprc': 0.9474252727101433, 'loss_val': 0.321628691284097, 'psi': 0.9442365327973099}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.667969 cos_to_last_merge=0.9683 (last merge round=42)
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.43692658691564545, 'auprc': 0.853176553951838, 'loss_val': 1.2078397340195919, 'psi': 0.6034265737301225}-{'f1_val': 0.9303808655198202, 'auprc': 0.9920686792354996, 'loss_val': 0.12157148977237694, 'psi': 0.955055991006092}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=2.452026 (no previous merge yet)
[S6] round=65 local utility u=0.037975 metrics={'f1_val': 0.7812369344681451, 'auprc': 0.7904864987634767, 'loss_val': 0.9770659877780329, 'psi': 0.7849367601862778}-{'f1_val': 0.753277736913893, 'auprc': 0.8627003439888242, 'loss_val': 1.1019032034970062, 'psi': 0.7970467797438654}
[S6] not sending this round → trigger blocked (psi=0.785)
[S7] START round=65 head_norm_before_train=2.017350 cos_to_last_merge=0.9991 (last merge round=42)
[S7] round=65 local utility u=0.362099 metrics={'f1_val': 0.6732409304408453, 'auprc': 0.8298313999949726, 'loss_val': 0.41728581771357676, 'psi': 0.7358771182624962}-{'f1_val': 0.6032843779277822, 'auprc': 0.7873419917707682, 'loss_val': 0.5942768557669972, 'psi': 0.6769074234649766}
[S7] not sending this round → trigger blocked (psi=0.736)
[S8] START round=65 head_norm_before_train=1.974409 cos_to_last_merge=0.9923 (last merge round=41)
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.907152413836038, 'auprc': 0.9988118769915391, 'loss_val': 0.16124101251790418, 'psi': 0.9438161990982384}-{'f1_val': 0.9808509939921313, 'auprc': 0.9991250101912463, 'loss_val': 0.06426249094529617, 'psi': 0.9881606004717772}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=65 head_norm_before_train=1.621293 cos_to_last_merge=0.9852 (last merge round=40)
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.996119571726269, 'loss_val': 0.023601620921925436, 'psi': 0.9967285078491426}-{'f1_val': 0.9964645815439231, 'auprc': 0.9995464895859584, 'loss_val': 0.02597547380234357, 'psi': 0.9976973447607372}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=2.180415 cos_to_last_merge=0.9786 (last merge round=35)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9979981916951474, 'loss_val': 0.025124135113043296, 'psi': 0.9963931490162972}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980249510822978, 'loss_val': 0.025103859822094565, 'psi': 0.9964038527711574}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=2.058731 cos_to_last_merge=0.9966 (last merge round=40)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9994068236263527, 'loss_val': 0.015194365856905825, 'psi': 0.9979412834262873}-{'f1_val': 0.9969642566262439, 'auprc': 0.99943365339319, 'loss_val': 0.015037527896169564, 'psi': 0.9979520153330224}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.585409 cos_to_last_merge=0.9520 (last merge round=35)
[S13] round=65 local utility u=0.356971 metrics={'f1_val': 0.7445156126070077, 'auprc': 0.8358122235793624, 'loss_val': 0.7519407987797148, 'psi': 0.7810342569959496}-{'f1_val': 0.7212773774951537, 'auprc': 0.7409052660367388, 'loss_val': 1.0417333596613305, 'psi': 0.7291285329117878}
[S13] not sending this round → trigger blocked (psi=0.781)
[S14] START round=65 head_norm_before_train=2.134097 cos_to_last_merge=0.9792 (last merge round=34)
[S14] round=65 local utility u=0.010777 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9992282966253236, 'loss_val': 0.02508063348079288, 'psi': 0.9982819894800417}-{'f1_val': 0.9972338922372435, 'auprc': 0.9971172568502809, 'loss_val': 0.03779812021077006, 'psi': 0.9971872380824585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=65 head_norm_before_train=2.079652 cos_to_last_merge=0.9872 (last merge round=40)
[S15] round=65 local utility u=0.022286 metrics={'f1_val': 0.9137986355292711, 'auprc': 0.9978208706691976, 'loss_val': 0.17091917515730148, 'psi': 0.9474075295852417}-{'f1_val': 0.9099318728459405, 'auprc': 0.997781450560016, 'loss_val': 0.19217182695338156, 'psi': 0.9450717039315707}
[S15] not sending this round → trigger blocked (psi=0.947)
[S16] START round=65 head_norm_before_train=1.753821 cos_to_last_merge=0.9872 (last merge round=35)
[S16] round=65 local utility u=0.000015 metrics={'f1_val': 0.9910280312734091, 'auprc': 0.9969168173437126, 'loss_val': 0.0444856633439571, 'psi': 0.9933835457015305}-{'f1_val': 0.9916846636119114, 'auprc': 0.9949901912179585, 'loss_val': 0.04267488000105199, 'psi': 0.9930068746543304}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=65 head_norm_before_train=2.076467 cos_to_last_merge=0.9615 (last merge round=36)
[S17] round=65 local utility u=1.000000 metrics={'f1_val': 0.9062192110153074, 'auprc': 0.9935561383161812, 'loss_val': 0.3201384025606151, 'psi': 0.9411539819356569}-{'f1_val': 0.6480151032717512, 'auprc': 0.8794984479755676, 'loss_val': 1.4078793454087277, 'psi': 0.7406084411532778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=66 head_norm_before_train=2.323424 (no previous merge yet)
[S2] round=66 local utility u=0.079032 metrics={'f1_val': 0.8274307926870709, 'auprc': 0.9891665950237225, 'loss_val': 0.4706755028662853, 'psi': 0.8921251136217315}-{'f1_val': 0.8308816644389775, 'auprc': 0.9317420300538946, 'loss_val': 0.4771716370904375, 'psi': 0.8712258106849443}
[S2] not sending this round → trigger blocked (psi=0.892)
[S3] START round=66 head_norm_before_train=2.100655 cos_to_last_merge=0.9708 (last merge round=42)
[S3] round=66 local utility u=0.649554 metrics={'f1_val': 0.9321797124017714, 'auprc': 0.998841277488115, 'loss_val': 0.12068830592597231, 'psi': 0.9588443384363089}-{'f1_val': 0.7582398907809808, 'auprc': 0.9982732442742118, 'loss_val': 0.3744536003908446, 'psi': 0.8542532321782732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=66 head_norm_before_train=1.804678 cos_to_last_merge=0.9734 (last merge round=36)
[S4] round=66 local utility u=0.059736 metrics={'f1_val': 0.9482173132065467, 'auprc': 0.956488372096329, 'loss_val': 0.3140529186326902, 'psi': 0.9515257367624597}-{'f1_val': 0.9406771633444998, 'auprc': 0.9365802108132417, 'loss_val': 0.32855962983498915, 'psi': 0.9390383823319965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=66 head_norm_before_train=1.669677 cos_to_last_merge=0.9678 (last merge round=42)
[S5] round=66 local utility u=1.000000 metrics={'f1_val': 0.9968035574397306, 'auprc': 0.9984949134327363, 'loss_val': 0.08174605063638041, 'psi': 0.9974800998369329}-{'f1_val': 0.43692658691564545, 'auprc': 0.853176553951838, 'loss_val': 1.2078397340195919, 'psi': 0.6034265737301225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=66 head_norm_before_train=2.464059 (no previous merge yet)
[S6] round=66 local utility u=0.796614 metrics={'f1_val': 0.8561067088926304, 'auprc': 0.9473721676674535, 'loss_val': 0.3037133136460871, 'psi': 0.8926128924025596}-{'f1_val': 0.7812369344681451, 'auprc': 0.7904864987634767, 'loss_val': 0.9770659877780329, 'psi': 0.7849367601862778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=66 head_norm_before_train=2.025568 cos_to_last_merge=0.9989 (last merge round=42)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.6069580947439401, 'auprc': 0.7850428293372482, 'loss_val': 0.7809182578215086, 'psi': 0.6781919885812634}-{'f1_val': 0.6732409304408453, 'auprc': 0.8298313999949726, 'loss_val': 0.41728581771357676, 'psi': 0.7358771182624962}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=1.983371 cos_to_last_merge=0.9920 (last merge round=41)
[S8] round=66 local utility u=0.315790 metrics={'f1_val': 0.9916639743166928, 'auprc': 0.9983130426508638, 'loss_val': 0.03523367731458031, 'psi': 0.9943236016503612}-{'f1_val': 0.907152413836038, 'auprc': 0.9988118769915391, 'loss_val': 0.16124101251790418, 'psi': 0.9438161990982384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=66 head_norm_before_train=1.628569 cos_to_last_merge=0.9847 (last merge round=40)
[S9] round=66 local utility u=0.002657 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.999538214359095, 'loss_val': 0.024369131557732262, 'psi': 0.9976785784704097}-{'f1_val': 0.9971344652643916, 'auprc': 0.996119571726269, 'loss_val': 0.023601620921925436, 'psi': 0.9967285078491426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=66 head_norm_before_train=2.185033 cos_to_last_merge=0.9784 (last merge round=35)
[S10] round=66 local utility u=0.000038 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980133314639065, 'loss_val': 0.025094417845845093, 'psi': 0.9963992049238009}-{'f1_val': 0.9953231205637304, 'auprc': 0.9979981916951474, 'loss_val': 0.025124135113043296, 'psi': 0.9963931490162972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=66 head_norm_before_train=2.064489 cos_to_last_merge=0.9965 (last merge round=40)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9994138678693731, 'loss_val': 0.015256777814225322, 'psi': 0.9979441011234955}-{'f1_val': 0.9969642566262439, 'auprc': 0.9994068236263527, 'loss_val': 0.015194365856905825, 'psi': 0.9979412834262873}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.592770 cos_to_last_merge=0.9510 (last merge round=35)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.7200194910644819, 'auprc': 0.8565180330700206, 'loss_val': 0.9802962327153152, 'psi': 0.7746189078666974}-{'f1_val': 0.7445156126070077, 'auprc': 0.8358122235793624, 'loss_val': 0.7519407987797148, 'psi': 0.7810342569959496}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=2.140684 cos_to_last_merge=0.9787 (last merge round=34)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9971289897753981, 'loss_val': 0.031201767394628016, 'psi': 0.9971919312525054}-{'f1_val': 0.9976511180498535, 'auprc': 0.9992282966253236, 'loss_val': 0.02508063348079288, 'psi': 0.9982819894800417}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=2.088099 cos_to_last_merge=0.9869 (last merge round=40)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9977886263356397, 'loss_val': 0.19616232032206404, 'psi': 0.9450745742418202}-{'f1_val': 0.9137986355292711, 'auprc': 0.9978208706691976, 'loss_val': 0.17091917515730148, 'psi': 0.9474075295852417}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=1.758852 cos_to_last_merge=0.9868 (last merge round=35)
[S16] round=66 local utility u=0.000000 metrics={'f1_val': 0.8806104313581151, 'auprc': 0.9945645871119684, 'loss_val': 0.5610931664158472, 'psi': 0.9261920936596565}-{'f1_val': 0.9910280312734091, 'auprc': 0.9969168173437126, 'loss_val': 0.0444856633439571, 'psi': 0.9933835457015305}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=66 head_norm_before_train=2.085477 cos_to_last_merge=0.9607 (last merge round=36)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.8185146251953004, 'auprc': 0.9729832628229877, 'loss_val': 0.6735155200692577, 'psi': 0.8803020802463754}-{'f1_val': 0.9062192110153074, 'auprc': 0.9935561383161812, 'loss_val': 0.3201384025606151, 'psi': 0.9411539819356569}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=2.327944 (no previous merge yet)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.6387043989806572, 'auprc': 0.8113858851408187, 'loss_val': 1.8109190343552102, 'psi': 0.7077769934447218}-{'f1_val': 0.8274307926870709, 'auprc': 0.9891665950237225, 'loss_val': 0.4706755028662853, 'psi': 0.8921251136217315}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.111008 cos_to_last_merge=0.9702 (last merge round=42)
[S3] round=67 local utility u=0.183082 metrics={'f1_val': 0.9805778274355272, 'auprc': 0.9997948999259204, 'loss_val': 0.047774297585657134, 'psi': 0.9882646564316845}-{'f1_val': 0.9321797124017714, 'auprc': 0.998841277488115, 'loss_val': 0.12068830592597231, 'psi': 0.9588443384363089}
[S3] not sending this round → trigger blocked (psi=0.988)
[S4] START round=67 head_norm_before_train=1.813490 cos_to_last_merge=0.9726 (last merge round=36)
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9403254013408007, 'auprc': 0.9372567616100373, 'loss_val': 0.30193211802185377, 'psi': 0.9390979454484953}-{'f1_val': 0.9482173132065467, 'auprc': 0.956488372096329, 'loss_val': 0.3140529186326902, 'psi': 0.9515257367624597}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=1.670419 cos_to_last_merge=0.9674 (last merge round=42)
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.5286856756926033, 'auprc': 0.7276255288422683, 'loss_val': 0.9124765664630967, 'psi': 0.6082616169524693}-{'f1_val': 0.9968035574397306, 'auprc': 0.9984949134327363, 'loss_val': 0.08174605063638041, 'psi': 0.9974800998369329}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=2.473238 (no previous merge yet)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.7205048035962983, 'auprc': 0.8172585750814705, 'loss_val': 0.9550206299835944, 'psi': 0.7592063121903672}-{'f1_val': 0.8561067088926304, 'auprc': 0.9473721676674535, 'loss_val': 0.3037133136460871, 'psi': 0.8926128924025596}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=2.029677 cos_to_last_merge=0.9988 (last merge round=42)
[S7] round=67 local utility u=1.000000 metrics={'f1_val': 0.8526174157741475, 'auprc': 0.9436153139588512, 'loss_val': 0.1689196259184878, 'psi': 0.889016575048029}-{'f1_val': 0.6069580947439401, 'auprc': 0.7850428293372482, 'loss_val': 0.7809182578215086, 'psi': 0.6781919885812634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=67 head_norm_before_train=1.993735 cos_to_last_merge=0.9916 (last merge round=41)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9882500123346475, 'auprc': 0.9994566294033987, 'loss_val': 0.047494475287363454, 'psi': 0.992732659162148}-{'f1_val': 0.9916639743166928, 'auprc': 0.9983130426508638, 'loss_val': 0.03523367731458031, 'psi': 0.9943236016503612}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=1.635793 cos_to_last_merge=0.9842 (last merge round=40)
[S9] round=67 local utility u=0.003519 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9989434474811056, 'loss_val': 0.022182930700787206, 'psi': 0.9981043129988285}-{'f1_val': 0.9964388212112862, 'auprc': 0.999538214359095, 'loss_val': 0.024369131557732262, 'psi': 0.9976785784704097}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=67 head_norm_before_train=2.188283 cos_to_last_merge=0.9783 (last merge round=35)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980067941718946, 'loss_val': 0.025130457690675886, 'psi': 0.996396590006996}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980133314639065, 'loss_val': 0.025094417845845093, 'psi': 0.9963992049238009}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=67 head_norm_before_train=2.067560 cos_to_last_merge=0.9962 (last merge round=40)
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989799593546534, 'loss_val': 0.01713995385485973, 'psi': 0.9975225367389198}-{'f1_val': 0.9969642566262439, 'auprc': 0.9994138678693731, 'loss_val': 0.015256777814225322, 'psi': 0.9979441011234955}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=1.605187 cos_to_last_merge=0.9495 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.950
[S13] round=67 local utility u=0.189037 metrics={'f1_val': 0.7415314037177516, 'auprc': 0.8313362999351702, 'loss_val': 0.655748759668597, 'psi': 0.7774533622047191}-{'f1_val': 0.7200194910644819, 'auprc': 0.8565180330700206, 'loss_val': 0.9802962327153152, 'psi': 0.7746189078666974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=67 head_norm_before_train=2.144957 cos_to_last_merge=0.9781 (last merge round=34)
[S14] round=67 local utility u=0.004936 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9975307585147626, 'loss_val': 0.023598367709799714, 'psi': 0.9974588999666019}-{'f1_val': 0.9972338922372435, 'auprc': 0.9971289897753981, 'loss_val': 0.031201767394628016, 'psi': 0.9971919312525054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=67 head_norm_before_train=2.096128 cos_to_last_merge=0.9866 (last merge round=40)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.9071353003099576, 'auprc': 0.9977718409514604, 'loss_val': 0.20659205617112378, 'psi': 0.9433899165665587}-{'f1_val': 0.9099318728459405, 'auprc': 0.9977886263356397, 'loss_val': 0.19616232032206404, 'psi': 0.9450745742418202}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.763954 cos_to_last_merge=0.9865 (last merge round=35)
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.850604147672545, 'auprc': 0.9722077034872678, 'loss_val': 0.9619580384901487, 'psi': 0.8992455699984341}-{'f1_val': 0.8806104313581151, 'auprc': 0.9945645871119684, 'loss_val': 0.5610931664158472, 'psi': 0.9261920936596565}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=2.093867 cos_to_last_merge=0.9599 (last merge round=36)
[S17] round=67 local utility u=0.085607 metrics={'f1_val': 0.8373605861654012, 'auprc': 0.9755404302944377, 'loss_val': 0.6230481016461678, 'psi': 0.8926325238170159}-{'f1_val': 0.8185146251953004, 'auprc': 0.9729832628229877, 'loss_val': 0.6735155200692577, 'psi': 0.8803020802463754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=68 head_norm_before_train=2.330689 (no previous merge yet)
[S2] round=68 local utility u=1.000000 metrics={'f1_val': 0.788268536547467, 'auprc': 0.8965857293404562, 'loss_val': 0.5821211613338683, 'psi': 0.8315954136646626}-{'f1_val': 0.6387043989806572, 'auprc': 0.8113858851408187, 'loss_val': 1.8109190343552102, 'psi': 0.7077769934447218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=68 head_norm_before_train=2.121424 cos_to_last_merge=0.9695 (last merge round=42)
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.999758653810377, 'loss_val': 0.1296193944573185, 'psi': 0.976548512763823}-{'f1_val': 0.9805778274355272, 'auprc': 0.9997948999259204, 'loss_val': 0.047774297585657134, 'psi': 0.9882646564316845}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.820407 cos_to_last_merge=0.9721 (last merge round=36)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9393158592869599, 'auprc': 0.9146366445814995, 'loss_val': 0.3264253447350344, 'psi': 0.9294441734047758}-{'f1_val': 0.9403254013408007, 'auprc': 0.9372567616100373, 'loss_val': 0.30193211802185377, 'psi': 0.9390979454484953}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.672505 cos_to_last_merge=0.9671 (last merge round=42)
[S5] round=68 local utility u=1.000000 metrics={'f1_val': 0.7005679112968205, 'auprc': 0.8994408898512679, 'loss_val': 0.4317824906556173, 'psi': 0.7801171027185995}-{'f1_val': 0.5286856756926033, 'auprc': 0.7276255288422683, 'loss_val': 0.9124765664630967, 'psi': 0.6082616169524693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=68 head_norm_before_train=2.480767 (no previous merge yet)
[S6] round=68 local utility u=0.185463 metrics={'f1_val': 0.7641594106708693, 'auprc': 0.8653688436650009, 'loss_val': 0.9903532831264095, 'psi': 0.804643183868522}-{'f1_val': 0.7205048035962983, 'auprc': 0.8172585750814705, 'loss_val': 0.9550206299835944, 'psi': 0.7592063121903672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=68 head_norm_before_train=2.030239 cos_to_last_merge=0.9988 (last merge round=42)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.5054366906721295, 'auprc': 0.7794798235994904, 'loss_val': 0.9366319362369593, 'psi': 0.6150539438430738}-{'f1_val': 0.8526174157741475, 'auprc': 0.9436153139588512, 'loss_val': 0.1689196259184878, 'psi': 0.889016575048029}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=1.999205 cos_to_last_merge=0.9913 (last merge round=41)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.8946198158260218, 'auprc': 0.9991292250448495, 'loss_val': 0.1881934751480717, 'psi': 0.9364235795135529}-{'f1_val': 0.9882500123346475, 'auprc': 0.9994566294033987, 'loss_val': 0.047494475287363454, 'psi': 0.992732659162148}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=1.643650 cos_to_last_merge=0.9837 (last merge round=40)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9967892373024942, 'loss_val': 0.02209551715201815, 'psi': 0.9972426289273839}-{'f1_val': 0.9975448900106438, 'auprc': 0.9989434474811056, 'loss_val': 0.022182930700787206, 'psi': 0.9981043129988285}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=2.194425 cos_to_last_merge=0.9779 (last merge round=35)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9979935407782975, 'loss_val': 0.025172475910158136, 'psi': 0.9963912886495572}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980067941718946, 'loss_val': 0.025130457690675886, 'psi': 0.996396590006996}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=2.071196 cos_to_last_merge=0.9960 (last merge round=40)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9931450485312848, 'auprc': 0.9988812312536828, 'loss_val': 0.024294724245885323, 'psi': 0.9954395216202441}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989799593546534, 'loss_val': 0.01713995385485973, 'psi': 0.9975225367389198}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.613138 cos_to_last_merge=0.9485 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6798805510631649, 'auprc': 0.8602756058798258, 'loss_val': 1.0448666559705888, 'psi': 0.7520385729898293}-{'f1_val': 0.7415314037177516, 'auprc': 0.8313362999351702, 'loss_val': 0.655748759668597, 'psi': 0.7774533622047191}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=2.150356 cos_to_last_merge=0.9775 (last merge round=34)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9975308727939328, 'loss_val': 0.024507490381024056, 'psi': 0.9974589456782701}-{'f1_val': 0.9974109942678281, 'auprc': 0.9975307585147626, 'loss_val': 0.023598367709799714, 'psi': 0.9974588999666019}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=2.103912 cos_to_last_merge=0.9863 (last merge round=40)
[S15] round=68 local utility u=0.013597 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978052630371987, 'loss_val': 0.19627737133254464, 'psi': 0.9450812289224437}-{'f1_val': 0.9071353003099576, 'auprc': 0.9977718409514604, 'loss_val': 0.20659205617112378, 'psi': 0.9433899165665587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=68 head_norm_before_train=1.767768 cos_to_last_merge=0.9862 (last merge round=35)
[S16] round=68 local utility u=0.910950 metrics={'f1_val': 0.9921499874340187, 'auprc': 0.9896483451091705, 'loss_val': 0.041654472876986724, 'psi': 0.9911493305040795}-{'f1_val': 0.850604147672545, 'auprc': 0.9722077034872678, 'loss_val': 0.9619580384901487, 'psi': 0.8992455699984341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=68 head_norm_before_train=2.102777 cos_to_last_merge=0.9590 (last merge round=36)
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.8249813721578133, 'auprc': 0.9742707149749493, 'loss_val': 0.673700719627041, 'psi': 0.8846971092846677}-{'f1_val': 0.8373605861654012, 'auprc': 0.9755404302944377, 'loss_val': 0.6230481016461678, 'psi': 0.8926325238170159}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=2.333956 (no previous merge yet)
[S2] round=69 local utility u=0.292824 metrics={'f1_val': 0.8267664077561411, 'auprc': 0.9722136978270055, 'loss_val': 0.45434407194183846, 'psi': 0.8849453237844869}-{'f1_val': 0.788268536547467, 'auprc': 0.8965857293404562, 'loss_val': 0.5821211613338683, 'psi': 0.8315954136646626}
[S2] not sending this round → trigger blocked (psi=0.885)
[S3] START round=69 head_norm_before_train=2.131354 cos_to_last_merge=0.9688 (last merge round=42)
[S3] round=69 local utility u=0.160091 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.999311527915615, 'loss_val': 0.02511641712457371, 'psi': 0.9980716345753934}-{'f1_val': 0.9610750853994537, 'auprc': 0.999758653810377, 'loss_val': 0.1296193944573185, 'psi': 0.976548512763823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=69 head_norm_before_train=1.827425 cos_to_last_merge=0.9714 (last merge round=36)
[S4] round=69 local utility u=0.039994 metrics={'f1_val': 0.9423676390691066, 'auprc': 0.9356660465367596, 'loss_val': 0.3278368542201074, 'psi': 0.9396870020561678}-{'f1_val': 0.9393158592869599, 'auprc': 0.9146366445814995, 'loss_val': 0.3264253447350344, 'psi': 0.9294441734047758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=69 head_norm_before_train=1.675597 cos_to_last_merge=0.9669 (last merge round=42)
[S5] round=69 local utility u=1.000000 metrics={'f1_val': 0.9959405060679545, 'auprc': 0.9920259008633486, 'loss_val': 0.1273470864884111, 'psi': 0.9943746639861121}-{'f1_val': 0.7005679112968205, 'auprc': 0.8994408898512679, 'loss_val': 0.4317824906556173, 'psi': 0.7801171027185995}
[S5] not sending this round → trigger blocked (psi=0.994)
[S6] START round=69 head_norm_before_train=2.488343 (no previous merge yet)
[S6] round=69 local utility u=0.421305 metrics={'f1_val': 0.8315753217638264, 'auprc': 0.9206632023542032, 'loss_val': 0.7181210285025789, 'psi': 0.8672104739999771}-{'f1_val': 0.7641594106708693, 'auprc': 0.8653688436650009, 'loss_val': 0.9903532831264095, 'psi': 0.804643183868522}
[S6] not sending this round → trigger blocked (psi=0.867)
[S7] START round=69 head_norm_before_train=2.029668 cos_to_last_merge=0.9988 (last merge round=42)
[S7] round=69 local utility u=0.755660 metrics={'f1_val': 0.6543537111613072, 'auprc': 0.8072474033734504, 'loss_val': 0.40211652103272466, 'psi': 0.7155111880461645}-{'f1_val': 0.5054366906721295, 'auprc': 0.7794798235994904, 'loss_val': 0.9366319362369593, 'psi': 0.6150539438430738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=69 head_norm_before_train=2.005411 cos_to_last_merge=0.9910 (last merge round=41)
[S8] round=69 local utility u=0.367183 metrics={'f1_val': 0.9913006508023969, 'auprc': 0.9995091886175684, 'loss_val': 0.03505315439213743, 'psi': 0.9945840659284655}-{'f1_val': 0.8946198158260218, 'auprc': 0.9991292250448495, 'loss_val': 0.1881934751480717, 'psi': 0.9364235795135529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=69 head_norm_before_train=1.651640 cos_to_last_merge=0.9831 (last merge round=40)
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9901606111321243, 'auprc': 0.9995634427459847, 'loss_val': 0.033795603898398294, 'psi': 0.9939217437776685}-{'f1_val': 0.9975448900106438, 'auprc': 0.9967892373024942, 'loss_val': 0.02209551715201815, 'psi': 0.9972426289273839}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=2.201424 cos_to_last_merge=0.9774 (last merge round=35)
[S10] round=69 local utility u=0.000032 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980040906718979, 'loss_val': 0.025139661595490685, 'psi': 0.9963955086069973}-{'f1_val': 0.9953231205637304, 'auprc': 0.9979935407782975, 'loss_val': 0.025172475910158136, 'psi': 0.9963912886495572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=69 head_norm_before_train=2.075406 cos_to_last_merge=0.9959 (last merge round=40)
[S11] round=69 local utility u=0.014020 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990339371988807, 'loss_val': 0.017148347392605744, 'psi': 0.9975441278766106}-{'f1_val': 0.9931450485312848, 'auprc': 0.9988812312536828, 'loss_val': 0.024294724245885323, 'psi': 0.9954395216202441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=69 head_norm_before_train=1.623450 cos_to_last_merge=0.9474 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.7193279974137293, 'auprc': 0.7492117415501319, 'loss_val': 1.0872605324225995, 'psi': 0.7312814950682903}-{'f1_val': 0.6798805510631649, 'auprc': 0.8602756058798258, 'loss_val': 1.0448666559705888, 'psi': 0.7520385729898293}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=2.156219 cos_to_last_merge=0.9769 (last merge round=34)
[S14] round=69 local utility u=0.001505 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9992287535591817, 'loss_val': 0.024128864742819677, 'psi': 0.9978919293522194}-{'f1_val': 0.9974109942678281, 'auprc': 0.9975308727939328, 'loss_val': 0.024507490381024056, 'psi': 0.9974589456782701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=69 head_norm_before_train=2.111607 cos_to_last_merge=0.9860 (last merge round=40)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.9093748942537687, 'auprc': 0.9977805495230136, 'loss_val': 0.20384903426905848, 'psi': 0.9447371563614666}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978052630371987, 'loss_val': 0.19627737133254464, 'psi': 0.9450812289224437}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=1.770569 cos_to_last_merge=0.9859 (last merge round=35)
[S16] round=69 local utility u=0.008372 metrics={'f1_val': 0.9919481237413861, 'auprc': 0.9948407802937204, 'loss_val': 0.03927677356592091, 'psi': 0.9931051863623198}-{'f1_val': 0.9921499874340187, 'auprc': 0.9896483451091705, 'loss_val': 0.041654472876986724, 'psi': 0.9911493305040795}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=69 head_norm_before_train=2.111579 cos_to_last_merge=0.9582 (last merge round=36)
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.7738414102725983, 'auprc': 0.9589274507898556, 'loss_val': 0.9102796913195116, 'psi': 0.8478758264795012}-{'f1_val': 0.8249813721578133, 'auprc': 0.9742707149749493, 'loss_val': 0.673700719627041, 'psi': 0.8846971092846677}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=2.341344 (no previous merge yet)
[S2] round=70 local utility u=0.039364 metrics={'f1_val': 0.8295750557151733, 'auprc': 0.9935253137749124, 'loss_val': 0.4564021129829407, 'psi': 0.8951551589390689}-{'f1_val': 0.8267664077561411, 'auprc': 0.9722136978270055, 'loss_val': 0.45434407194183846, 'psi': 0.8849453237844869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=70 head_norm_before_train=2.140389 cos_to_last_merge=0.9681 (last merge round=42)
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.8160080895968606, 'auprc': 0.9981511810745463, 'loss_val': 0.3055952979999117, 'psi': 0.8888653261879349}-{'f1_val': 0.9972450390152456, 'auprc': 0.999311527915615, 'loss_val': 0.02511641712457371, 'psi': 0.9980716345753934}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=1.834594 cos_to_last_merge=0.9707 (last merge round=36)
[S4] round=70 local utility u=0.008199 metrics={'f1_val': 0.9471090158186103, 'auprc': 0.9324167563991264, 'loss_val': 0.33013936592118304, 'psi': 0.9412321120508167}-{'f1_val': 0.9423676390691066, 'auprc': 0.9356660465367596, 'loss_val': 0.3278368542201074, 'psi': 0.9396870020561678}
[S4] not sending this round → trigger blocked (psi=0.941)
[S5] START round=70 head_norm_before_train=1.674375 cos_to_last_merge=0.9664 (last merge round=42)
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.7006549282887996, 'auprc': 0.9878447171465621, 'loss_val': 0.30224157977978505, 'psi': 0.8155308438319047}-{'f1_val': 0.9959405060679545, 'auprc': 0.9920259008633486, 'loss_val': 0.1273470864884111, 'psi': 0.9943746639861121}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=2.498311 (no previous merge yet)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.8098341046378879, 'auprc': 0.8814501364119282, 'loss_val': 0.8840484274965105, 'psi': 0.838480517347504}-{'f1_val': 0.8315753217638264, 'auprc': 0.9206632023542032, 'loss_val': 0.7181210285025789, 'psi': 0.8672104739999771}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=2.029935 cos_to_last_merge=0.9988 (last merge round=42)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.5883498327211082, 'auprc': 0.7831928373599244, 'loss_val': 0.6671400934378916, 'psi': 0.6662870345766347}-{'f1_val': 0.6543537111613072, 'auprc': 0.8072474033734504, 'loss_val': 0.40211652103272466, 'psi': 0.7155111880461645}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=2.013602 cos_to_last_merge=0.9907 (last merge round=41)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9878925987103254, 'auprc': 0.9994089325001062, 'loss_val': 0.04061254624621199, 'psi': 0.9924991322262378}-{'f1_val': 0.9913006508023969, 'auprc': 0.9995091886175684, 'loss_val': 0.03505315439213743, 'psi': 0.9945840659284655}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=1.658345 cos_to_last_merge=0.9827 (last merge round=40)
[S9] round=70 local utility u=0.025718 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9989624526732966, 'loss_val': 0.02220947170446892, 'psi': 0.9978467285766044}-{'f1_val': 0.9901606111321243, 'auprc': 0.9995634427459847, 'loss_val': 0.033795603898398294, 'psi': 0.9939217437776685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=70 head_norm_before_train=2.206782 cos_to_last_merge=0.9770 (last merge round=35)
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9979841680283156, 'loss_val': 0.025220609983831885, 'psi': 0.9963875395495645}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980040906718979, 'loss_val': 0.025139661595490685, 'psi': 0.9963955086069973}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=70 head_norm_before_train=2.079710 cos_to_last_merge=0.9958 (last merge round=40)
[S11] round=70 local utility u=0.001700 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9990030242277782, 'loss_val': 0.016135779322003423, 'psi': 0.9977797636668575}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990339371988807, 'loss_val': 0.017148347392605744, 'psi': 0.9975441278766106}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=70 head_norm_before_train=1.628582 cos_to_last_merge=0.9468 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6274738387845578, 'auprc': 0.6261569535807022, 'loss_val': 1.2969199842512769, 'psi': 0.6269470847030155}-{'f1_val': 0.7193279974137293, 'auprc': 0.7492117415501319, 'loss_val': 1.0872605324225995, 'psi': 0.7312814950682903}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=2.162757 cos_to_last_merge=0.9764 (last merge round=34)
[S14] round=70 local utility u=0.000063 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9983848030840824, 'loss_val': 0.022928835710816307, 'psi': 0.9977000582910563}-{'f1_val': 0.9970007132142444, 'auprc': 0.9992287535591817, 'loss_val': 0.024128864742819677, 'psi': 0.9978919293522194}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=70 head_norm_before_train=2.118974 cos_to_last_merge=0.9857 (last merge round=40)
[S15] round=70 local utility u=0.006040 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978072336682592, 'loss_val': 0.19519036505729837, 'psi': 0.945082017174868}-{'f1_val': 0.9093748942537687, 'auprc': 0.9977805495230136, 'loss_val': 0.20384903426905848, 'psi': 0.9447371563614666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=70 head_norm_before_train=1.775314 cos_to_last_merge=0.9856 (last merge round=35)
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.9897846103421425, 'auprc': 0.9930806472454695, 'loss_val': 0.05225320129741949, 'psi': 0.9911030251034733}-{'f1_val': 0.9919481237413861, 'auprc': 0.9948407802937204, 'loss_val': 0.03927677356592091, 'psi': 0.9931051863623198}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=70 head_norm_before_train=2.119952 cos_to_last_merge=0.9574 (last merge round=36)
[S17] round=70 local utility u=0.398794 metrics={'f1_val': 0.8419044518297815, 'auprc': 0.9821515369502704, 'loss_val': 0.5907414752796613, 'psi': 0.898003285877977}-{'f1_val': 0.7738414102725983, 'auprc': 0.9589274507898556, 'loss_val': 0.9102796913195116, 'psi': 0.8478758264795012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=71 head_norm_before_train=2.350260 (no previous merge yet)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.8294517071401857, 'auprc': 0.8707502593303198, 'loss_val': 0.4976095858543741, 'psi': 0.8459711280162393}-{'f1_val': 0.8295750557151733, 'auprc': 0.9935253137749124, 'loss_val': 0.4564021129829407, 'psi': 0.8951551589390689}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.147201 cos_to_last_merge=0.9676 (last merge round=42)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.7645306815783021, 'auprc': 0.970848046786097, 'loss_val': 0.48008099425071066, 'psi': 0.8470576276614201}-{'f1_val': 0.8160080895968606, 'auprc': 0.9981511810745463, 'loss_val': 0.3055952979999117, 'psi': 0.8888653261879349}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.843951 cos_to_last_merge=0.9702 (last merge round=36)
[S4] round=71 local utility u=0.000740 metrics={'f1_val': 0.9431243884651418, 'auprc': 0.9404059560809388, 'loss_val': 0.32871882028036614, 'psi': 0.9420370155114606}-{'f1_val': 0.9471090158186103, 'auprc': 0.9324167563991264, 'loss_val': 0.33013936592118304, 'psi': 0.9412321120508167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=71 head_norm_before_train=1.675551 cos_to_last_merge=0.9656 (last merge round=42)
[S5] round=71 local utility u=0.068633 metrics={'f1_val': 0.7975014025009962, 'auprc': 0.9278643624064327, 'loss_val': 0.5661127635978455, 'psi': 0.8496465864631708}-{'f1_val': 0.7006549282887996, 'auprc': 0.9878447171465621, 'loss_val': 0.30224157977978505, 'psi': 0.8155308438319047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=71 head_norm_before_train=2.507848 (no previous merge yet)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.7836757023054677, 'auprc': 0.7934210867429672, 'loss_val': 1.0031885884171767, 'psi': 0.7875738560804675}-{'f1_val': 0.8098341046378879, 'auprc': 0.8814501364119282, 'loss_val': 0.8840484274965105, 'psi': 0.838480517347504}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=2.030048 cos_to_last_merge=0.9988 (last merge round=42)
[S7] round=71 local utility u=0.376149 metrics={'f1_val': 0.654722591582873, 'auprc': 0.8105168069047655, 'loss_val': 0.39505005861351344, 'psi': 0.71704027771163}-{'f1_val': 0.5883498327211082, 'auprc': 0.7831928373599244, 'loss_val': 0.6671400934378916, 'psi': 0.6662870345766347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=71 head_norm_before_train=2.022931 cos_to_last_merge=0.9903 (last merge round=41)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.974711740078256, 'auprc': 0.9991501398699747, 'loss_val': 0.07100348714473255, 'psi': 0.9844870999949435}-{'f1_val': 0.9878925987103254, 'auprc': 0.9994089325001062, 'loss_val': 0.04061254624621199, 'psi': 0.9924991322262378}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=1.664129 cos_to_last_merge=0.9823 (last merge round=40)
[S9] round=71 local utility u=0.000526 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9993622627139025, 'loss_val': 0.022356505330439667, 'psi': 0.9980066525928467}-{'f1_val': 0.9971029125121428, 'auprc': 0.9989624526732966, 'loss_val': 0.02220947170446892, 'psi': 0.9978467285766044}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=71 head_norm_before_train=2.211726 cos_to_last_merge=0.9767 (last merge round=35)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.997981581110025, 'loss_val': 0.025255643426793137, 'psi': 0.9963865047822482}-{'f1_val': 0.9953231205637304, 'auprc': 0.9979841680283156, 'loss_val': 0.025220609983831885, 'psi': 0.9963875395495645}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=2.084404 cos_to_last_merge=0.9956 (last merge round=40)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987741949747075, 'loss_val': 0.015511618189773575, 'psi': 0.9976882319656293}-{'f1_val': 0.9969642566262439, 'auprc': 0.9990030242277782, 'loss_val': 0.016135779322003423, 'psi': 0.9977797636668575}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.628802 cos_to_last_merge=0.9467 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=71 local utility u=0.786663 metrics={'f1_val': 0.748362571426299, 'auprc': 0.7860366584760334, 'loss_val': 0.9285647098345826, 'psi': 0.7634322062461928}-{'f1_val': 0.6274738387845578, 'auprc': 0.6261569535807022, 'loss_val': 1.2969199842512769, 'psi': 0.6269470847030155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=71 head_norm_before_train=2.169120 cos_to_last_merge=0.9759 (last merge round=34)
[S14] round=71 local utility u=0.004310 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9992302917972131, 'loss_val': 0.019306000585378586, 'psi': 0.9982844224084588}-{'f1_val': 0.9972435617623723, 'auprc': 0.9983848030840824, 'loss_val': 0.022928835710816307, 'psi': 0.9977000582910563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=71 head_norm_before_train=2.126221 cos_to_last_merge=0.9854 (last merge round=40)
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978086265430159, 'loss_val': 0.1994732656276212, 'psi': 0.9450825743247706}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978072336682592, 'loss_val': 0.19519036505729837, 'psi': 0.945082017174868}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=1.781228 cos_to_last_merge=0.9853 (last merge round=35)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9875171877859723, 'auprc': 0.992360915624408, 'loss_val': 0.060196258598491766, 'psi': 0.9894546789213465}-{'f1_val': 0.9897846103421425, 'auprc': 0.9930806472454695, 'loss_val': 0.05225320129741949, 'psi': 0.9911030251034733}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=2.129317 cos_to_last_merge=0.9566 (last merge round=36)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.7917529835618498, 'auprc': 0.9645276429191405, 'loss_val': 0.8719785312429925, 'psi': 0.8608628473047661}-{'f1_val': 0.8419044518297815, 'auprc': 0.9821515369502704, 'loss_val': 0.5907414752796613, 'psi': 0.898003285877977}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=2.358425 (no previous merge yet)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.8308139503420674, 'auprc': 0.8426805468299496, 'loss_val': 0.49549631944017547, 'psi': 0.8355605889372203}-{'f1_val': 0.8294517071401857, 'auprc': 0.8707502593303198, 'loss_val': 0.4976095858543741, 'psi': 0.8459711280162393}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.153907 cos_to_last_merge=0.9671 (last merge round=42)
[S3] round=72 local utility u=0.328450 metrics={'f1_val': 0.8258710735999745, 'auprc': 0.9981416759353525, 'loss_val': 0.2731038715271994, 'psi': 0.8947793145341256}-{'f1_val': 0.7645306815783021, 'auprc': 0.970848046786097, 'loss_val': 0.48008099425071066, 'psi': 0.8470576276614201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=72 head_norm_before_train=1.849015 cos_to_last_merge=0.9695 (last merge round=36)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.9444231466484052, 'auprc': 0.9328531003811523, 'loss_val': 0.3301212231916001, 'psi': 0.9397951281415041}-{'f1_val': 0.9431243884651418, 'auprc': 0.9404059560809388, 'loss_val': 0.32871882028036614, 'psi': 0.9420370155114606}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=1.677153 cos_to_last_merge=0.9644 (last merge round=42)
[S5] round=72 local utility u=0.250784 metrics={'f1_val': 0.8176602409596081, 'auprc': 0.9633629289020311, 'loss_val': 0.29199299582521904, 'psi': 0.8759413161365773}-{'f1_val': 0.7975014025009962, 'auprc': 0.9278643624064327, 'loss_val': 0.5661127635978455, 'psi': 0.8496465864631708}
[S5] not sending this round → trigger blocked (psi=0.876)
[S6] START round=72 head_norm_before_train=2.517603 (no previous merge yet)
[S6] round=72 local utility u=0.838965 metrics={'f1_val': 0.8695999465704936, 'auprc': 0.9407911714025345, 'loss_val': 0.2829150988458063, 'psi': 0.8980764365033099}-{'f1_val': 0.7836757023054677, 'auprc': 0.7934210867429672, 'loss_val': 1.0031885884171767, 'psi': 0.7875738560804675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=72 head_norm_before_train=2.031041 cos_to_last_merge=0.9988 (last merge round=42)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.4766128486986186, 'auprc': 0.7805878252678374, 'loss_val': 1.067886622656703, 'psi': 0.5982028393263061}-{'f1_val': 0.654722591582873, 'auprc': 0.8105168069047655, 'loss_val': 0.39505005861351344, 'psi': 0.71704027771163}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=2.028167 cos_to_last_merge=0.9900 (last merge round=41)
[S8] round=72 local utility u=0.068776 metrics={'f1_val': 0.9913111459209346, 'auprc': 0.999500938092838, 'loss_val': 0.03410024075560273, 'psi': 0.994587062789696}-{'f1_val': 0.974711740078256, 'auprc': 0.9991501398699747, 'loss_val': 0.07100348714473255, 'psi': 0.9844870999949435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=72 head_norm_before_train=1.669666 cos_to_last_merge=0.9819 (last merge round=40)
[S9] round=72 local utility u=0.000358 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9994628033735081, 'loss_val': 0.021942881273941055, 'psi': 0.9980468688566889}-{'f1_val': 0.9971029125121428, 'auprc': 0.9993622627139025, 'loss_val': 0.022356505330439667, 'psi': 0.9980066525928467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=72 head_norm_before_train=2.218107 cos_to_last_merge=0.9762 (last merge round=35)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975731511690266, 'loss_val': 0.025274789727434653, 'psi': 0.9962231328058488}-{'f1_val': 0.9953231205637304, 'auprc': 0.997981581110025, 'loss_val': 0.025255643426793137, 'psi': 0.9963865047822482}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=2.086695 cos_to_last_merge=0.9954 (last merge round=40)
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9991447907431072, 'loss_val': 0.01520817191414417, 'psi': 0.9975861190053966}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987741949747075, 'loss_val': 0.015511618189773575, 'psi': 0.9976882319656293}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.628945 cos_to_last_merge=0.9466 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.7367010413776693, 'auprc': 0.7976055159893112, 'loss_val': 0.9680023174926847, 'psi': 0.7610628312223261}-{'f1_val': 0.748362571426299, 'auprc': 0.7860366584760334, 'loss_val': 0.9285647098345826, 'psi': 0.7634322062461928}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.175011 cos_to_last_merge=0.9753 (last merge round=34)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9401008495948229, 'auprc': 0.9981772379627332, 'loss_val': 0.10030514548056077, 'psi': 0.963331404941987}-{'f1_val': 0.9976538428159559, 'auprc': 0.9992302917972131, 'loss_val': 0.019306000585378586, 'psi': 0.9982844224084588}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=2.133353 cos_to_last_merge=0.9851 (last merge round=40)
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.906572453969457, 'auprc': 0.9977683330816551, 'loss_val': 0.22028762028355897, 'psi': 0.9430508056143363}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978086265430159, 'loss_val': 0.1994732656276212, 'psi': 0.9450825743247706}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=1.787853 cos_to_last_merge=0.9850 (last merge round=35)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9401891984040047, 'auprc': 0.9906512004474455, 'loss_val': 0.2991668272685332, 'psi': 0.960373999221381}-{'f1_val': 0.9875171877859723, 'auprc': 0.992360915624408, 'loss_val': 0.060196258598491766, 'psi': 0.9894546789213465}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=2.138530 cos_to_last_merge=0.9558 (last merge round=36)
[S17] round=72 local utility u=0.537352 metrics={'f1_val': 0.8749748661316679, 'auprc': 0.9935248869404046, 'loss_val': 0.38359671752475183, 'psi': 0.9223948744551627}-{'f1_val': 0.7917529835618498, 'auprc': 0.9645276429191405, 'loss_val': 0.8719785312429925, 'psi': 0.8608628473047661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=73 head_norm_before_train=2.363650 (no previous merge yet)
[S2] round=73 local utility u=0.043116 metrics={'f1_val': 0.8315258271881565, 'auprc': 0.8613896375231518, 'loss_val': 0.46966305141443815, 'psi': 0.8434713513221546}-{'f1_val': 0.8308139503420674, 'auprc': 0.8426805468299496, 'loss_val': 0.49549631944017547, 'psi': 0.8355605889372203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=73 head_norm_before_train=2.158667 cos_to_last_merge=0.9668 (last merge round=42)
[S3] round=73 local utility u=0.395663 metrics={'f1_val': 0.9318349264452792, 'auprc': 0.9983740604895354, 'loss_val': 0.11825732708266415, 'psi': 0.9584505800629817}-{'f1_val': 0.8258710735999745, 'auprc': 0.9981416759353525, 'loss_val': 0.2731038715271994, 'psi': 0.8947793145341256}
[S3] not sending this round → trigger blocked (psi=0.958)
[S4] START round=73 head_norm_before_train=1.854744 cos_to_last_merge=0.9688 (last merge round=36)
[S4] round=73 local utility u=0.017433 metrics={'f1_val': 0.9482529836638867, 'auprc': 0.9365325059440726, 'loss_val': 0.32927273746711494, 'psi': 0.943564792575961}-{'f1_val': 0.9444231466484052, 'auprc': 0.9328531003811523, 'loss_val': 0.3301212231916001, 'psi': 0.9397951281415041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=73 head_norm_before_train=1.683224 cos_to_last_merge=0.9636 (last merge round=42)
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.7731039568951331, 'auprc': 0.9878438858372666, 'loss_val': 0.20171754706460868, 'psi': 0.8589999284719865}-{'f1_val': 0.8176602409596081, 'auprc': 0.9633629289020311, 'loss_val': 0.29199299582521904, 'psi': 0.8759413161365773}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=2.524088 (no previous merge yet)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.8455066693158749, 'auprc': 0.940418541600355, 'loss_val': 0.34790014118129453, 'psi': 0.883471418229667}-{'f1_val': 0.8695999465704936, 'auprc': 0.9407911714025345, 'loss_val': 0.2829150988458063, 'psi': 0.8980764365033099}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=2.035987 cos_to_last_merge=0.9986 (last merge round=42)
[S7] round=73 local utility u=0.759309 metrics={'f1_val': 0.6269036693823127, 'auprc': 0.7987693802520529, 'loss_val': 0.5055575234170189, 'psi': 0.6956499537302088}-{'f1_val': 0.4766128486986186, 'auprc': 0.7805878252678374, 'loss_val': 1.067886622656703, 'psi': 0.5982028393263061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=73 head_norm_before_train=2.032749 cos_to_last_merge=0.9897 (last merge round=41)
[S8] round=73 local utility u=0.002424 metrics={'f1_val': 0.9932955872009759, 'auprc': 0.9957684659246666, 'loss_val': 0.029960610805172892, 'psi': 0.9942847386904521}-{'f1_val': 0.9913111459209346, 'auprc': 0.999500938092838, 'loss_val': 0.03410024075560273, 'psi': 0.994587062789696}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=73 head_norm_before_train=1.676161 cos_to_last_merge=0.9815 (last merge round=40)
[S9] round=73 local utility u=0.000136 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9994808200390138, 'loss_val': 0.02172411138707406, 'psi': 0.9980540755228913}-{'f1_val': 0.9971029125121428, 'auprc': 0.9994628033735081, 'loss_val': 0.021942881273941055, 'psi': 0.9980468688566889}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=73 head_norm_before_train=2.222027 cos_to_last_merge=0.9760 (last merge round=35)
[S10] round=73 local utility u=0.000752 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980286834786201, 'loss_val': 0.025138184036710424, 'psi': 0.9964053457296862}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975731511690266, 'loss_val': 0.025274789727434653, 'psi': 0.9962231328058488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=73 head_norm_before_train=2.090127 cos_to_last_merge=0.9952 (last merge round=40)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9987672783822773, 'loss_val': 0.015602555092230123, 'psi': 0.9974351140610647}-{'f1_val': 0.9965470045135896, 'auprc': 0.9991447907431072, 'loss_val': 0.01520817191414417, 'psi': 0.9975861190053966}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.632658 cos_to_last_merge=0.9460 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=73 local utility u=0.163580 metrics={'f1_val': 0.744580408867553, 'auprc': 0.8209037035389608, 'loss_val': 0.7580139949978064, 'psi': 0.7751097267361161}-{'f1_val': 0.7367010413776693, 'auprc': 0.7976055159893112, 'loss_val': 0.9680023174926847, 'psi': 0.7610628312223261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=73 head_norm_before_train=2.181261 cos_to_last_merge=0.9747 (last merge round=34)
[S14] round=73 local utility u=0.202811 metrics={'f1_val': 0.996033930748806, 'auprc': 0.9996127056893316, 'loss_val': 0.03458793225311242, 'psi': 0.9974654407250162}-{'f1_val': 0.9401008495948229, 'auprc': 0.9981772379627332, 'loss_val': 0.10030514548056077, 'psi': 0.963331404941987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=73 head_norm_before_train=2.140151 cos_to_last_merge=0.9849 (last merge round=40)
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9977573996221716, 'loss_val': 0.22660997663949545, 'psi': 0.9420290095561973}-{'f1_val': 0.906572453969457, 'auprc': 0.9977683330816551, 'loss_val': 0.22028762028355897, 'psi': 0.9430508056143363}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=1.794237 cos_to_last_merge=0.9847 (last merge round=35)
[S16] round=73 local utility u=0.060139 metrics={'f1_val': 0.9452087325655366, 'auprc': 0.989884428950615, 'loss_val': 0.20670499512954188, 'psi': 0.963079011119568}-{'f1_val': 0.9401891984040047, 'auprc': 0.9906512004474455, 'loss_val': 0.2991668272685332, 'psi': 0.960373999221381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=73 head_norm_before_train=2.144202 cos_to_last_merge=0.9551 (last merge round=36)
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.8261544977822196, 'auprc': 0.9759003694055344, 'loss_val': 0.6769125177545956, 'psi': 0.8860528464315456}-{'f1_val': 0.8749748661316679, 'auprc': 0.9935248869404046, 'loss_val': 0.38359671752475183, 'psi': 0.9223948744551627}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=2.365787 (no previous merge yet)
[S2] round=74 local utility u=0.097712 metrics={'f1_val': 0.8284077145752056, 'auprc': 0.9295978412706055, 'loss_val': 0.46015460627184973, 'psi': 0.8688837652533656}-{'f1_val': 0.8315258271881565, 'auprc': 0.8613896375231518, 'loss_val': 0.46966305141443815, 'psi': 0.8434713513221546}
[S2] not sending this round → trigger blocked (psi=0.869)
[S3] START round=74 head_norm_before_train=2.162807 cos_to_last_merge=0.9665 (last merge round=42)
[S3] round=74 local utility u=0.064011 metrics={'f1_val': 0.9600800976779673, 'auprc': 0.9993797622881687, 'loss_val': 0.16272361154487697, 'psi': 0.9757999635220478}-{'f1_val': 0.9318349264452792, 'auprc': 0.9983740604895354, 'loss_val': 0.11825732708266415, 'psi': 0.9584505800629817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=74 head_norm_before_train=1.861264 cos_to_last_merge=0.9680 (last merge round=36)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9397918785025876, 'auprc': 0.9172865281986348, 'loss_val': 0.3333015000546403, 'psi': 0.9307897383810064}-{'f1_val': 0.9482529836638867, 'auprc': 0.9365325059440726, 'loss_val': 0.32927273746711494, 'psi': 0.943564792575961}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.689717 cos_to_last_merge=0.9637 (last merge round=42)
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.9873825575003323, 'loss_val': 0.39125302682086116, 'psi': 0.8153455565119709}-{'f1_val': 0.7731039568951331, 'auprc': 0.9878438858372666, 'loss_val': 0.20171754706460868, 'psi': 0.8589999284719865}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=2.533003 (no previous merge yet)
[S6] round=74 local utility u=0.321361 metrics={'f1_val': 0.9268276397995656, 'auprc': 0.940176440990669, 'loss_val': 0.1923780127254618, 'psi': 0.932167160276007}-{'f1_val': 0.8455066693158749, 'auprc': 0.940418541600355, 'loss_val': 0.34790014118129453, 'psi': 0.883471418229667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=74 head_norm_before_train=2.039578 cos_to_last_merge=0.9985 (last merge round=42)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5681797953337552, 'auprc': 0.7849827808970068, 'loss_val': 0.6878439171945223, 'psi': 0.6549009895590558}-{'f1_val': 0.6269036693823127, 'auprc': 0.7987693802520529, 'loss_val': 0.5055575234170189, 'psi': 0.6956499537302088}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=2.037814 cos_to_last_merge=0.9895 (last merge round=41)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.7824625696535463, 'auprc': 0.9972115158819429, 'loss_val': 0.6342455849336598, 'psi': 0.8683621481449049}-{'f1_val': 0.9932955872009759, 'auprc': 0.9957684659246666, 'loss_val': 0.029960610805172892, 'psi': 0.9942847386904521}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=1.682374 cos_to_last_merge=0.9810 (last merge round=40)
[S9] round=74 local utility u=0.000220 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9994983385355409, 'loss_val': 0.021336065856499463, 'psi': 0.9980610829215021}-{'f1_val': 0.9971029125121428, 'auprc': 0.9994808200390138, 'loss_val': 0.02172411138707406, 'psi': 0.9980540755228913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=74 head_norm_before_train=2.227227 cos_to_last_merge=0.9757 (last merge round=35)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9976603920130381, 'loss_val': 0.025271848644623764, 'psi': 0.9962580291434535}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980286834786201, 'loss_val': 0.025138184036710424, 'psi': 0.9964053457296862}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=2.092020 cos_to_last_merge=0.9949 (last merge round=40)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990740794102981, 'loss_val': 0.017140389540900695, 'psi': 0.9975601847611776}-{'f1_val': 0.9965470045135896, 'auprc': 0.9987672783822773, 'loss_val': 0.015602555092230123, 'psi': 0.9974351140610647}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.644617 cos_to_last_merge=0.9447 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6682512667429462, 'auprc': 0.6765144504140312, 'loss_val': 1.1730712308332434, 'psi': 0.6715565402113802}-{'f1_val': 0.744580408867553, 'auprc': 0.8209037035389608, 'loss_val': 0.7580139949978064, 'psi': 0.7751097267361161}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=2.186011 cos_to_last_merge=0.9743 (last merge round=34)
[S14] round=74 local utility u=0.010999 metrics={'f1_val': 0.9980850197418996, 'auprc': 0.9992336012192917, 'loss_val': 0.02376001114187494, 'psi': 0.9985444523328564}-{'f1_val': 0.996033930748806, 'auprc': 0.9996127056893316, 'loss_val': 0.03458793225311242, 'psi': 0.9974654407250162}
[S14] not sending this round → trigger blocked (psi=0.999)
[S15] START round=74 head_norm_before_train=2.146836 cos_to_last_merge=0.9846 (last merge round=40)
[S15] round=74 local utility u=0.013503 metrics={'f1_val': 0.9071353003099576, 'auprc': 0.9977731879758155, 'loss_val': 0.21320304809137608, 'psi': 0.9433904553763007}-{'f1_val': 0.9048767495122143, 'auprc': 0.9977573996221716, 'loss_val': 0.22660997663949545, 'psi': 0.9420290095561973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=74 head_norm_before_train=1.798552 cos_to_last_merge=0.9844 (last merge round=35)
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.892734709812413, 'auprc': 0.9776101174047769, 'loss_val': 0.5323706109557493, 'psi': 0.9266848728493585}-{'f1_val': 0.9452087325655366, 'auprc': 0.989884428950615, 'loss_val': 0.20670499512954188, 'psi': 0.963079011119568}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=2.149945 cos_to_last_merge=0.9542 (last merge round=36)
[S17] round=74 local utility u=0.130998 metrics={'f1_val': 0.8502159919029442, 'auprc': 0.9820072503311663, 'loss_val': 0.5776060165970166, 'psi': 0.902932495274233}-{'f1_val': 0.8261544977822196, 'auprc': 0.9759003694055344, 'loss_val': 0.6769125177545956, 'psi': 0.8860528464315456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=75 head_norm_before_train=2.365064 (no previous merge yet)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.832039707985692, 'auprc': 0.8199951323188054, 'loss_val': 0.4479169304614414, 'psi': 0.8272218777189373}-{'f1_val': 0.8284077145752056, 'auprc': 0.9295978412706055, 'loss_val': 0.46015460627184973, 'psi': 0.8688837652533656}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=2.167579 cos_to_last_merge=0.9662 (last merge round=42)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.8592180254442614, 'auprc': 0.9982990054276643, 'loss_val': 0.21330041706249453, 'psi': 0.9148504174376226}-{'f1_val': 0.9600800976779673, 'auprc': 0.9993797622881687, 'loss_val': 0.16272361154487697, 'psi': 0.9757999635220478}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.870572 cos_to_last_merge=0.9674 (last merge round=36)
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.6370861367170073, 'auprc': 0.9160625478269844, 'loss_val': 0.7133699755831183, 'psi': 0.7486767011609982}-{'f1_val': 0.9397918785025876, 'auprc': 0.9172865281986348, 'loss_val': 0.3333015000546403, 'psi': 0.9307897383810064}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=1.697171 cos_to_last_merge=0.9634 (last merge round=42)
[S5] round=75 local utility u=0.345932 metrics={'f1_val': 0.7935760845283398, 'auprc': 0.9810266924531581, 'loss_val': 0.23785358127296874, 'psi': 0.8685563276982671}-{'f1_val': 0.7006542225197299, 'auprc': 0.9873825575003323, 'loss_val': 0.39125302682086116, 'psi': 0.8153455565119709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=75 head_norm_before_train=2.540592 (no previous merge yet)
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.7644457895695443, 'auprc': 0.8731493518849743, 'loss_val': 1.0744644615265055, 'psi': 0.8079272144957164}-{'f1_val': 0.9268276397995656, 'auprc': 0.940176440990669, 'loss_val': 0.1923780127254618, 'psi': 0.932167160276007}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=2.043305 cos_to_last_merge=0.9984 (last merge round=42)
[S7] round=75 local utility u=0.424828 metrics={'f1_val': 0.650948904924342, 'auprc': 0.8130062349211701, 'loss_val': 0.41887214764632347, 'psi': 0.7157718369230732}-{'f1_val': 0.5681797953337552, 'auprc': 0.7849827808970068, 'loss_val': 0.6878439171945223, 'psi': 0.6549009895590558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=75 head_norm_before_train=2.036866 cos_to_last_merge=0.9892 (last merge round=41)
[S8] round=75 local utility u=0.922582 metrics={'f1_val': 0.9898527714347872, 'auprc': 0.9993980272308451, 'loss_val': 0.039982673671975624, 'psi': 0.9936708737532103}-{'f1_val': 0.7824625696535463, 'auprc': 0.9972115158819429, 'loss_val': 0.6342455849336598, 'psi': 0.8683621481449049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=75 head_norm_before_train=1.687010 cos_to_last_merge=0.9807 (last merge round=40)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.9995236656308417, 'loss_val': 0.04430084913200707, 'psi': 0.992881802344247}-{'f1_val': 0.9971029125121428, 'auprc': 0.9994983385355409, 'loss_val': 0.021336065856499463, 'psi': 0.9980610829215021}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.230732 cos_to_last_merge=0.9755 (last merge round=35)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975975053076499, 'loss_val': 0.02529816672662986, 'psi': 0.9962328744612982}-{'f1_val': 0.9953231205637304, 'auprc': 0.9976603920130381, 'loss_val': 0.025271848644623764, 'psi': 0.9962580291434535}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=2.091918 cos_to_last_merge=0.9950 (last merge round=40)
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9980325042515632, 'loss_val': 0.02004475684084154, 'psi': 0.9969984524708464}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990740794102981, 'loss_val': 0.017140389540900695, 'psi': 0.9975601847611776}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=1.654993 cos_to_last_merge=0.9434 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=75 local utility u=0.292671 metrics={'f1_val': 0.7217608010601382, 'auprc': 0.7273789181680281, 'loss_val': 1.0613800871174734, 'psi': 0.7240080479032942}-{'f1_val': 0.6682512667429462, 'auprc': 0.6765144504140312, 'loss_val': 1.1730712308332434, 'psi': 0.6715565402113802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=75 head_norm_before_train=2.191271 cos_to_last_merge=0.9737 (last merge round=34)
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9810902640889714, 'auprc': 0.9975339714021679, 'loss_val': 0.038257598581506604, 'psi': 0.98766774701425}-{'f1_val': 0.9980850197418996, 'auprc': 0.9992336012192917, 'loss_val': 0.02376001114187494, 'psi': 0.9985444523328564}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=2.153344 cos_to_last_merge=0.9844 (last merge round=40)
[S15] round=75 local utility u=0.009651 metrics={'f1_val': 0.9093748942537687, 'auprc': 0.9978048352311294, 'loss_val': 0.207433255566008, 'psi': 0.944746870644713}-{'f1_val': 0.9071353003099576, 'auprc': 0.9977731879758155, 'loss_val': 0.21320304809137608, 'psi': 0.9433904553763007}
[S15] not sending this round → trigger blocked (psi=0.945)
[S16] START round=75 head_norm_before_train=1.801557 cos_to_last_merge=0.9841 (last merge round=35)
[S16] round=75 local utility u=0.234959 metrics={'f1_val': 0.9393121297490621, 'auprc': 0.9817121240327098, 'loss_val': 0.3542241461996977, 'psi': 0.9562721274625211}-{'f1_val': 0.892734709812413, 'auprc': 0.9776101174047769, 'loss_val': 0.5323706109557493, 'psi': 0.9266848728493585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=75 head_norm_before_train=2.155883 cos_to_last_merge=0.9534 (last merge round=36)
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.7706171389912435, 'auprc': 0.9632129791296867, 'loss_val': 0.9017282016511123, 'psi': 0.8476554750466208}-{'f1_val': 0.8502159919029442, 'auprc': 0.9820072503311663, 'loss_val': 0.5776060165970166, 'psi': 0.902932495274233}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=76 head_norm_before_train=2.366919 (no previous merge yet)
[S2] round=76 local utility u=0.235270 metrics={'f1_val': 0.8281477974068309, 'auprc': 0.9925559062961218, 'loss_val': 0.4717086286012728, 'psi': 0.8939110409625473}-{'f1_val': 0.832039707985692, 'auprc': 0.8199951323188054, 'loss_val': 0.4479169304614414, 'psi': 0.8272218777189373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=76 head_norm_before_train=2.173138 cos_to_last_merge=0.9658 (last merge round=42)
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.8130054539000509, 'auprc': 0.9982638175999197, 'loss_val': 0.28927874719873664, 'psi': 0.8871087993799984}-{'f1_val': 0.8592180254442614, 'auprc': 0.9982990054276643, 'loss_val': 0.21330041706249453, 'psi': 0.9148504174376226}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.874391 cos_to_last_merge=0.9665 (last merge round=36)
[S4] round=76 local utility u=1.000000 metrics={'f1_val': 0.9399321140940166, 'auprc': 0.9250994480720739, 'loss_val': 0.3237954360412805, 'psi': 0.9339990476852394}-{'f1_val': 0.6370861367170073, 'auprc': 0.9160625478269844, 'loss_val': 0.7133699755831183, 'psi': 0.7486767011609982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=76 head_norm_before_train=1.701125 cos_to_last_merge=0.9631 (last merge round=42)
[S5] round=76 local utility u=0.000118 metrics={'f1_val': 0.7883825073214601, 'auprc': 0.9844329440630565, 'loss_val': 0.21667585811406856, 'psi': 0.8668026820180987}-{'f1_val': 0.7935760845283398, 'auprc': 0.9810266924531581, 'loss_val': 0.23785358127296874, 'psi': 0.8685563276982671}
[S5] not sending this round → trigger blocked (psi=0.867)
[S6] START round=76 head_norm_before_train=2.550005 (no previous merge yet)
[S6] round=76 local utility u=0.236663 metrics={'f1_val': 0.7972108311563597, 'auprc': 0.8967924518708176, 'loss_val': 0.8686580642372339, 'psi': 0.8370434794421429}-{'f1_val': 0.7644457895695443, 'auprc': 0.8731493518849743, 'loss_val': 1.0744644615265055, 'psi': 0.8079272144957164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=76 head_norm_before_train=2.048383 cos_to_last_merge=0.9982 (last merge round=42)
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.4862678014559251, 'auprc': 0.7811293145442069, 'loss_val': 1.2021165630739088, 'psi': 0.6042124066912378}-{'f1_val': 0.650948904924342, 'auprc': 0.8130062349211701, 'loss_val': 0.41887214764632347, 'psi': 0.7157718369230732}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=2.042844 cos_to_last_merge=0.9889 (last merge round=41)
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9898527714347872, 'auprc': 0.9992128200980152, 'loss_val': 0.04123477250049375, 'psi': 0.9935967909000784}-{'f1_val': 0.9898527714347872, 'auprc': 0.9993980272308451, 'loss_val': 0.039982673671975624, 'psi': 0.9936708737532103}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=76 head_norm_before_train=1.692477 cos_to_last_merge=0.9803 (last merge round=40)
[S9] round=76 local utility u=0.027259 metrics={'f1_val': 0.994356655862817, 'auprc': 0.999527655804333, 'loss_val': 0.025211403821171617, 'psi': 0.9964250558394234}-{'f1_val': 0.9884538934865174, 'auprc': 0.9995236656308417, 'loss_val': 0.04430084913200707, 'psi': 0.992881802344247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=76 head_norm_before_train=2.235721 cos_to_last_merge=0.9751 (last merge round=35)
[S10] round=76 local utility u=0.000011 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9976056154471837, 'loss_val': 0.025300557041107914, 'psi': 0.9962361185171117}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975975053076499, 'loss_val': 0.02529816672662986, 'psi': 0.9962328744612982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=76 head_norm_before_train=2.094110 cos_to_last_merge=0.9951 (last merge round=40)
[S11] round=76 local utility u=0.002249 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989823039762329, 'loss_val': 0.019847441614762686, 'psi': 0.9975234745875515}-{'f1_val': 0.9963090846170353, 'auprc': 0.9980325042515632, 'loss_val': 0.02004475684084154, 'psi': 0.9969984524708464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=76 head_norm_before_train=1.661168 cos_to_last_merge=0.9425 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=76 local utility u=0.138256 metrics={'f1_val': 0.7252745422690763, 'auprc': 0.7728807389567877, 'loss_val': 0.9424568250770657, 'psi': 0.7443170209441607}-{'f1_val': 0.7217608010601382, 'auprc': 0.7273789181680281, 'loss_val': 1.0613800871174734, 'psi': 0.7240080479032942}
[S13] not sending this round → trigger blocked (psi=0.744)
[S14] START round=76 head_norm_before_train=2.194668 cos_to_last_merge=0.9730 (last merge round=34)
[S14] round=76 local utility u=0.061216 metrics={'f1_val': 0.9976015531333403, 'auprc': 0.9992312736677792, 'loss_val': 0.01998615486940729, 'psi': 0.9982534413471158}-{'f1_val': 0.9810902640889714, 'auprc': 0.9975339714021679, 'loss_val': 0.038257598581506604, 'psi': 0.98766774701425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=76 head_norm_before_train=2.159713 cos_to_last_merge=0.9841 (last merge round=40)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.906572453969457, 'auprc': 0.9977759344971266, 'loss_val': 0.22358018089349407, 'psi': 0.9430538461805249}-{'f1_val': 0.9093748942537687, 'auprc': 0.9978048352311294, 'loss_val': 0.207433255566008, 'psi': 0.944746870644713}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=1.806478 cos_to_last_merge=0.9839 (last merge round=35)
[S16] round=76 local utility u=0.317523 metrics={'f1_val': 0.9907910098739743, 'auprc': 0.9897157312969597, 'loss_val': 0.05206235866666625, 'psi': 0.9903608984431684}-{'f1_val': 0.9393121297490621, 'auprc': 0.9817121240327098, 'loss_val': 0.3542241461996977, 'psi': 0.9562721274625211}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=76 head_norm_before_train=2.162949 cos_to_last_merge=0.9527 (last merge round=36)
[S17] round=76 local utility u=0.644090 metrics={'f1_val': 0.881891981282618, 'auprc': 0.9934618555832879, 'loss_val': 0.3719433707659206, 'psi': 0.926519931002886}-{'f1_val': 0.7706171389912435, 'auprc': 0.9632129791296867, 'loss_val': 0.9017282016511123, 'psi': 0.8476554750466208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=77 head_norm_before_train=2.374940 (no previous merge yet)
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.8287704315235466, 'auprc': 0.8846395498507444, 'loss_val': 0.4645851996929296, 'psi': 0.8511180788544257}-{'f1_val': 0.8281477974068309, 'auprc': 0.9925559062961218, 'loss_val': 0.4717086286012728, 'psi': 0.8939110409625473}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.179396 cos_to_last_merge=0.9654 (last merge round=42)
[S3] round=77 local utility u=0.297238 metrics={'f1_val': 0.8994757181608034, 'auprc': 0.9976421695676563, 'loss_val': 0.21176017970172292, 'psi': 0.9387422987235445}-{'f1_val': 0.8130054539000509, 'auprc': 0.9982638175999197, 'loss_val': 0.28927874719873664, 'psi': 0.8871087993799984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=77 head_norm_before_train=1.878283 cos_to_last_merge=0.9654 (last merge round=36)
[S4] round=77 local utility u=0.049433 metrics={'f1_val': 0.9458378262283381, 'auprc': 0.9486606243838948, 'loss_val': 0.3310480007140779, 'psi': 0.9469669454905607}-{'f1_val': 0.9399321140940166, 'auprc': 0.9250994480720739, 'loss_val': 0.3237954360412805, 'psi': 0.9339990476852394}
[S4] not sending this round → trigger blocked (psi=0.947)
[S5] START round=77 head_norm_before_train=1.707115 cos_to_last_merge=0.9631 (last merge round=42)
[S5] round=77 local utility u=0.191444 metrics={'f1_val': 0.8483423913571821, 'auprc': 0.9818798774312124, 'loss_val': 0.18588831175726717, 'psi': 0.9017573857867942}-{'f1_val': 0.7883825073214601, 'auprc': 0.9844329440630565, 'loss_val': 0.21667585811406856, 'psi': 0.8668026820180987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=77 head_norm_before_train=2.558676 (no previous merge yet)
[S6] round=77 local utility u=0.654695 metrics={'f1_val': 0.9043939768374011, 'auprc': 0.9405725888968577, 'loss_val': 0.33370640982837196, 'psi': 0.9188654216611837}-{'f1_val': 0.7972108311563597, 'auprc': 0.8967924518708176, 'loss_val': 0.8686580642372339, 'psi': 0.8370434794421429}
[S6] not sending this round → trigger blocked (psi=0.919)
[S7] START round=77 head_norm_before_train=2.055589 cos_to_last_merge=0.9980 (last merge round=42)
[S7] round=77 local utility u=0.995642 metrics={'f1_val': 0.6652600702343723, 'auprc': 0.8225665979786638, 'loss_val': 0.40909751815054585, 'psi': 0.7281826813320889}-{'f1_val': 0.4862678014559251, 'auprc': 0.7811293145442069, 'loss_val': 1.2021165630739088, 'psi': 0.6042124066912378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=77 head_norm_before_train=2.049557 cos_to_last_merge=0.9885 (last merge round=41)
[S8] round=77 local utility u=0.012014 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.997868300898135, 'loss_val': 0.030600645198114326, 'psi': 0.9948016567823296}-{'f1_val': 0.9898527714347872, 'auprc': 0.9992128200980152, 'loss_val': 0.04123477250049375, 'psi': 0.9935967909000784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=77 head_norm_before_train=1.697633 cos_to_last_merge=0.9799 (last merge round=40)
[S9] round=77 local utility u=0.002951 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9949527753198926, 'loss_val': 0.022252220424729217, 'psi': 0.9962617892865919}-{'f1_val': 0.994356655862817, 'auprc': 0.999527655804333, 'loss_val': 0.025211403821171617, 'psi': 0.9964250558394234}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=77 head_norm_before_train=2.241865 cos_to_last_merge=0.9747 (last merge round=35)
[S10] round=77 local utility u=0.000660 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9980271363693007, 'loss_val': 0.025245740270907757, 'psi': 0.9964047268859585}-{'f1_val': 0.9953231205637304, 'auprc': 0.9976056154471837, 'loss_val': 0.025300557041107914, 'psi': 0.9962361185171117}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=77 head_norm_before_train=2.097497 cos_to_last_merge=0.9950 (last merge round=40)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9980188477416069, 'loss_val': 0.02011847327162276, 'psi': 0.9969929898668639}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989823039762329, 'loss_val': 0.019847441614762686, 'psi': 0.9975234745875515}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.666432 cos_to_last_merge=0.9418 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6271439647773818, 'auprc': 0.6500632608380525, 'loss_val': 1.3115683793511657, 'psi': 0.6363116832016501}-{'f1_val': 0.7252745422690763, 'auprc': 0.7728807389567877, 'loss_val': 0.9424568250770657, 'psi': 0.7443170209441607}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=2.196840 cos_to_last_merge=0.9725 (last merge round=34)
[S14] round=77 local utility u=0.000759 metrics={'f1_val': 0.997844401637113, 'auprc': 0.9992312769805709, 'loss_val': 0.019924322045070754, 'psi': 0.9983991517744961}-{'f1_val': 0.9976015531333403, 'auprc': 0.9992312736677792, 'loss_val': 0.01998615486940729, 'psi': 0.9982534413471158}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=77 head_norm_before_train=2.165938 cos_to_last_merge=0.9839 (last merge round=40)
[S15] round=77 local utility u=0.008670 metrics={'f1_val': 0.9082574443353278, 'auprc': 0.9977925058369186, 'loss_val': 0.2163994233858251, 'psi': 0.9440714689359642}-{'f1_val': 0.906572453969457, 'auprc': 0.9977759344971266, 'loss_val': 0.22358018089349407, 'psi': 0.9430538461805249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=77 head_norm_before_train=1.812355 cos_to_last_merge=0.9836 (last merge round=35)
[S16] round=77 local utility u=0.007273 metrics={'f1_val': 0.991057196098459, 'auprc': 0.9910108210378074, 'loss_val': 0.042999690566142966, 'psi': 0.9910386460741983}-{'f1_val': 0.9907910098739743, 'auprc': 0.9897157312969597, 'loss_val': 0.05206235866666625, 'psi': 0.9903608984431684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=77 head_norm_before_train=2.168567 cos_to_last_merge=0.9522 (last merge round=36)
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.8635883942086074, 'auprc': 0.9934966968109871, 'loss_val': 0.46188407186774083, 'psi': 0.9155517152495593}-{'f1_val': 0.881891981282618, 'auprc': 0.9934618555832879, 'loss_val': 0.3719433707659206, 'psi': 0.926519931002886}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.377172 (no previous merge yet)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.5798791059531097, 'auprc': 0.8122266536390653, 'loss_val': 1.9655119560767398, 'psi': 0.6728181250274919}-{'f1_val': 0.8287704315235466, 'auprc': 0.8846395498507444, 'loss_val': 0.4645851996929296, 'psi': 0.8511180788544257}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.186258 cos_to_last_merge=0.9650 (last merge round=42)
[S3] round=78 local utility u=0.225493 metrics={'f1_val': 0.9596861317232088, 'auprc': 0.9988281780395154, 'loss_val': 0.12559461596665722, 'psi': 0.9753429502497315}-{'f1_val': 0.8994757181608034, 'auprc': 0.9976421695676563, 'loss_val': 0.21176017970172292, 'psi': 0.9387422987235445}
[S3] not sending this round → trigger blocked (psi=0.975)
[S4] START round=78 head_norm_before_train=1.882122 cos_to_last_merge=0.9646 (last merge round=36)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9411857567590383, 'auprc': 0.9352135223876066, 'loss_val': 0.3276432255943622, 'psi': 0.9387968630104655}-{'f1_val': 0.9458378262283381, 'auprc': 0.9486606243838948, 'loss_val': 0.3310480007140779, 'psi': 0.9469669454905607}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.715460 cos_to_last_merge=0.9629 (last merge round=42)
[S5] round=78 local utility u=0.093405 metrics={'f1_val': 0.9113236673090894, 'auprc': 0.9653432359129281, 'loss_val': 0.3273561367953519, 'psi': 0.932931494750625}-{'f1_val': 0.8483423913571821, 'auprc': 0.9818798774312124, 'loss_val': 0.18588831175726717, 'psi': 0.9017573857867942}
[S5] not sending this round → trigger blocked (psi=0.933)
[S6] START round=78 head_norm_before_train=2.566005 (no previous merge yet)
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.7411834586349485, 'auprc': 0.8345191542891812, 'loss_val': 1.1713889372299318, 'psi': 0.7785177368966416}-{'f1_val': 0.9043939768374011, 'auprc': 0.9405725888968577, 'loss_val': 0.33370640982837196, 'psi': 0.9188654216611837}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=78 head_norm_before_train=2.060623 cos_to_last_merge=0.9979 (last merge round=42)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.5621266108126225, 'auprc': 0.7824111571533161, 'loss_val': 0.9154809327830962, 'psi': 0.6502404293488999}-{'f1_val': 0.6652600702343723, 'auprc': 0.8225665979786638, 'loss_val': 0.40909751815054585, 'psi': 0.7281826813320889}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=2.058786 cos_to_last_merge=0.9881 (last merge round=41)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.896464041342997, 'auprc': 0.9971182447425343, 'loss_val': 0.195553516108293, 'psi': 0.9367257227028118}-{'f1_val': 0.9927572273717925, 'auprc': 0.997868300898135, 'loss_val': 0.030600645198114326, 'psi': 0.9948016567823296}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=1.702667 cos_to_last_merge=0.9795 (last merge round=40)
[S9] round=78 local utility u=0.004942 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997661163059065, 'loss_val': 0.020304069316747355, 'psi': 0.9973262127309117}-{'f1_val': 0.9971344652643916, 'auprc': 0.9949527753198926, 'loss_val': 0.022252220424729217, 'psi': 0.9962617892865919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=78 head_norm_before_train=2.247788 cos_to_last_merge=0.9743 (last merge round=35)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975774797715782, 'loss_val': 0.0254355960737904, 'psi': 0.9962248642468694}-{'f1_val': 0.9953231205637304, 'auprc': 0.9980271363693007, 'loss_val': 0.025245740270907757, 'psi': 0.9964047268859585}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.101046 cos_to_last_merge=0.9950 (last merge round=40)
[S11] round=78 local utility u=0.004111 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9990694963407999, 'loss_val': 0.01649915415702666, 'psi': 0.9975583515333784}-{'f1_val': 0.9963090846170353, 'auprc': 0.9980188477416069, 'loss_val': 0.02011847327162276, 'psi': 0.9969929898668639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=78 head_norm_before_train=1.676125 cos_to_last_merge=0.9403 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6255101626812758, 'auprc': 0.6387303200655036, 'loss_val': 1.2861153136879386, 'psi': 0.6307982256349669}-{'f1_val': 0.6271439647773818, 'auprc': 0.6500632608380525, 'loss_val': 1.3115683793511657, 'psi': 0.6363116832016501}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=2.199764 cos_to_last_merge=0.9720 (last merge round=34)
[S14] round=78 local utility u=0.000193 metrics={'f1_val': 0.997844401637113, 'auprc': 0.9992299386708118, 'loss_val': 0.019533458729074017, 'psi': 0.9983986164505925}-{'f1_val': 0.997844401637113, 'auprc': 0.9992312769805709, 'loss_val': 0.019924322045070754, 'psi': 0.9983991517744961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=78 head_norm_before_train=2.172104 cos_to_last_merge=0.9836 (last merge round=40)
[S15] round=78 local utility u=0.012698 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978189759558415, 'loss_val': 0.20112922298943955, 'psi': 0.9450867140899009}-{'f1_val': 0.9082574443353278, 'auprc': 0.9977925058369186, 'loss_val': 0.2163994233858251, 'psi': 0.9440714689359642}
[S15] not sending this round → trigger blocked (psi=0.945)
[S16] START round=78 head_norm_before_train=1.816306 cos_to_last_merge=0.9832 (last merge round=35)
[S16] round=78 local utility u=0.008173 metrics={'f1_val': 0.9917148021162032, 'auprc': 0.9946489560031789, 'loss_val': 0.04151432747298366, 'psi': 0.9928884636709935}-{'f1_val': 0.991057196098459, 'auprc': 0.9910108210378074, 'loss_val': 0.042999690566142966, 'psi': 0.9910386460741983}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=78 head_norm_before_train=2.175841 cos_to_last_merge=0.9515 (last merge round=36)
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.8363703252168996, 'auprc': 0.9811432925507068, 'loss_val': 0.6481745367184708, 'psi': 0.8942795121504225}-{'f1_val': 0.8635883942086074, 'auprc': 0.9934966968109871, 'loss_val': 0.46188407186774083, 'psi': 0.9155517152495593}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=2.380607 (no previous merge yet)
[S2] round=79 local utility u=1.000000 metrics={'f1_val': 0.8128127522951428, 'auprc': 0.9839749204480518, 'loss_val': 0.4445856466819743, 'psi': 0.8812776195563065}-{'f1_val': 0.5798791059531097, 'auprc': 0.8122266536390653, 'loss_val': 1.9655119560767398, 'psi': 0.6728181250274919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S2] r=80 psi=0.881 u=1.0000 p_local=0.2664 f1=0.813 auprc=0.984 bytes=59328
[S3] START round=79 head_norm_before_train=2.193782 cos_to_last_merge=0.9645 (last merge round=42)
[S3] round=79 local utility u=0.059569 metrics={'f1_val': 0.9699617254829217, 'auprc': 0.9994025682904977, 'loss_val': 0.06983318707258433, 'psi': 0.9817380626059521}-{'f1_val': 0.9596861317232088, 'auprc': 0.9988281780395154, 'loss_val': 0.12559461596665722, 'psi': 0.9753429502497315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S3] r=80 psi=0.982 u=0.0596 p_local=0.1432 f1=0.970 auprc=0.999 bytes=61207
[S4] START round=79 head_norm_before_train=1.888012 cos_to_last_merge=0.9638 (last merge round=36)
[S4] round=79 local utility u=0.028081 metrics={'f1_val': 0.9482529836638867, 'auprc': 0.9418125553779144, 'loss_val': 0.33368229264724236, 'psi': 0.9456768123494977}-{'f1_val': 0.9411857567590383, 'auprc': 0.9352135223876066, 'loss_val': 0.3276432255943622, 'psi': 0.9387968630104655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S4] r=80 psi=0.946 u=0.0281 p_local=0.1196 f1=0.948 auprc=0.942 bytes=57588
[S5] START round=79 head_norm_before_train=1.725494 cos_to_last_merge=0.9622 (last merge round=42)
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.8716279073060196, 'auprc': 0.9681659094806696, 'loss_val': 0.2697060531815725, 'psi': 0.9102431081758796}-{'f1_val': 0.9113236673090894, 'auprc': 0.9653432359129281, 'loss_val': 0.3273561367953519, 'psi': 0.932931494750625}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.910 u=0.0000 p_local=0.1420 f1=0.872 auprc=0.968 bytes=62961
[S6] START round=79 head_norm_before_train=2.573160 (no previous merge yet)
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.7396144327610868, 'auprc': 0.7350071223120906, 'loss_val': 1.2717600960305266, 'psi': 0.7377715085814883}-{'f1_val': 0.7411834586349485, 'auprc': 0.8345191542891812, 'loss_val': 1.1713889372299318, 'psi': 0.7785177368966416}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.738 u=0.0000 p_local=0.1913 f1=0.740 auprc=0.735 bytes=55676
[S7] START round=79 head_norm_before_train=2.063307 cos_to_last_merge=0.9978 (last merge round=42)
[S7] round=79 local utility u=0.415260 metrics={'f1_val': 0.6228843888957027, 'auprc': 0.8012041370426, 'loss_val': 0.5058857585417708, 'psi': 0.6942122881544617}-{'f1_val': 0.5621266108126225, 'auprc': 0.7824111571533161, 'loss_val': 0.9154809327830962, 'psi': 0.6502404293488999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S7] r=80 psi=0.694 u=0.4153 p_local=0.3396 f1=0.623 auprc=0.801 bytes=66629
[S8] START round=79 head_norm_before_train=2.065645 cos_to_last_merge=0.9878 (last merge round=41)
[S8] round=79 local utility u=0.375965 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9990929458828222, 'loss_val': 0.031695814382652544, 'psi': 0.9957304700269294}-{'f1_val': 0.896464041342997, 'auprc': 0.9971182447425343, 'loss_val': 0.195553516108293, 'psi': 0.9367257227028118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] r=80 psi=0.996 u=0.3760 p_local=0.1677 f1=0.993 auprc=0.999 bytes=61143
[S9] START round=79 head_norm_before_train=1.707437 cos_to_last_merge=0.9792 (last merge round=40)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.9995587686840203, 'loss_val': 0.04556594477442352, 'psi': 0.9928958435655184}-{'f1_val': 0.9971029125121428, 'auprc': 0.997661163059065, 'loss_val': 0.020304069316747355, 'psi': 0.9973262127309117}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.993 u=0.0000 p_local=0.0050 f1=0.988 auprc=1.000 bytes=71948
[S10] START round=79 head_norm_before_train=2.250998 cos_to_last_merge=0.9741 (last merge round=35)
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.997580549295311, 'loss_val': 0.02546617850365111, 'psi': 0.9962260920563626}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975774797715782, 'loss_val': 0.0254355960737904, 'psi': 0.9962248642468694}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.996 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.998 bytes=59396
[S11] START round=79 head_norm_before_train=2.104307 cos_to_last_merge=0.9949 (last merge round=40)
[S11] round=79 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.999091844644856, 'loss_val': 0.0166223594690021, 'psi': 0.9975672908550007}-{'f1_val': 0.9965509216617638, 'auprc': 0.9990694963407999, 'loss_val': 0.01649915415702666, 'psi': 0.9975583515333784}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=80 psi=0.998 u=0.0000 p_local=0.0013 f1=0.997 auprc=0.999 bytes=57605
[S13] START round=79 head_norm_before_train=1.678818 cos_to_last_merge=0.9395 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=79 local utility u=0.146161 metrics={'f1_val': 0.6365054083584263, 'auprc': 0.6894689865377276, 'loss_val': 1.2119808721501326, 'psi': 0.6576908396301469}-{'f1_val': 0.6255101626812758, 'auprc': 0.6387303200655036, 'loss_val': 1.2861153136879386, 'psi': 0.6307982256349669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] r=80 psi=0.658 u=0.1462 p_local=0.1121 f1=0.637 auprc=0.689 bytes=63060
[S14] START round=79 head_norm_before_train=2.204970 cos_to_last_merge=0.9716 (last merge round=34)
[S14] round=79 local utility u=0.001812 metrics={'f1_val': 0.9983073289132482, 'auprc': 0.9992295379216463, 'loss_val': 0.018685189535175176, 'psi': 0.9986762125166075}-{'f1_val': 0.997844401637113, 'auprc': 0.9992299386708118, 'loss_val': 0.019533458729074017, 'psi': 0.9983986164505925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S14] r=80 psi=0.999 u=0.0018 p_local=0.0185 f1=0.998 auprc=0.999 bytes=73754
[S15] START round=79 head_norm_before_train=2.178079 cos_to_last_merge=0.9834 (last merge round=40)
[S15] round=79 local utility u=0.003200 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978206349919281, 'loss_val': 0.19473404954706983, 'psi': 0.9450873777043356}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978189759558415, 'loss_val': 0.20112922298943955, 'psi': 0.9450867140899009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S15] r=80 psi=0.945 u=0.0032 p_local=0.0064 f1=0.910 auprc=0.998 bytes=61042
[S16] START round=79 head_norm_before_train=1.821146 cos_to_last_merge=0.9829 (last merge round=35)
[S16] round=79 local utility u=0.001656 metrics={'f1_val': 0.9917148021162032, 'auprc': 0.9954816813042242, 'loss_val': 0.04070048037571675, 'psi': 0.9932215537914115}-{'f1_val': 0.9917148021162032, 'auprc': 0.9946489560031789, 'loss_val': 0.04151432747298366, 'psi': 0.9928884636709935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=80 psi=0.993 u=0.0017 p_local=0.0804 f1=0.992 auprc=0.995 bytes=52124
[S17] START round=79 head_norm_before_train=2.182781 cos_to_last_merge=0.9509 (last merge round=36)
[S17] round=79 local utility u=0.040029 metrics={'f1_val': 0.8418315010014046, 'auprc': 0.985088521770554, 'loss_val': 0.612720188222686, 'psi': 0.8991343093090644}-{'f1_val': 0.8363703252168996, 'auprc': 0.9811432925507068, 'loss_val': 0.6481745367184708, 'psi': 0.8942795121504225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=80 psi=0.899 u=0.0400 p_local=0.1320 f1=0.842 auprc=0.985 bytes=57624
[S2] START round=80 head_norm_before_train=2.384592 (no previous merge yet)
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.8330711564310884, 'auprc': 0.8855643740818857, 'loss_val': 0.3830905515759552, 'psi': 0.8540684434914074}-{'f1_val': 0.8128127522951428, 'auprc': 0.9839749204480518, 'loss_val': 0.4445856466819743, 'psi': 0.8812776195563065}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=80 head_norm_before_train=2.201484 cos_to_last_merge=0.9640 (last merge round=42)
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.9612927942165166, 'auprc': 0.9983324073222966, 'loss_val': 0.09248208173113395, 'psi': 0.9761086394588285}-{'f1_val': 0.9699617254829217, 'auprc': 0.9994025682904977, 'loss_val': 0.06983318707258433, 'psi': 0.9817380626059521}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.891592 cos_to_last_merge=0.9631 (last merge round=36)
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9409037488628171, 'auprc': 0.9353999096031435, 'loss_val': 0.3306887812814038, 'psi': 0.9387022131589476}-{'f1_val': 0.9482529836638867, 'auprc': 0.9418125553779144, 'loss_val': 0.33368229264724236, 'psi': 0.9456768123494977}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=1.736364 cos_to_last_merge=0.9614 (last merge round=42)
[S5] round=80 local utility u=0.470502 metrics={'f1_val': 0.9845176690264796, 'auprc': 0.9932983297920954, 'loss_val': 0.08143739710099564, 'psi': 0.9880299333327259}-{'f1_val': 0.8716279073060196, 'auprc': 0.9681659094806696, 'loss_val': 0.2697060531815725, 'psi': 0.9102431081758796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=80 head_norm_before_train=2.579978 (no previous merge yet)
[S6] round=80 local utility u=1.000000 metrics={'f1_val': 0.959660769793092, 'auprc': 0.9592144653568778, 'loss_val': 0.1836456953016319, 'psi': 0.9594822480186064}-{'f1_val': 0.7396144327610868, 'auprc': 0.7350071223120906, 'loss_val': 1.2717600960305266, 'psi': 0.7377715085814883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=80 head_norm_before_train=2.065818 cos_to_last_merge=0.9977 (last merge round=42)
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.519930335788929, 'auprc': 0.7815728129668691, 'loss_val': 0.9350593871168434, 'psi': 0.6245873266601051}-{'f1_val': 0.6228843888957027, 'auprc': 0.8012041370426, 'loss_val': 0.5058857585417708, 'psi': 0.6942122881544617}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=80 head_norm_before_train=2.072319 cos_to_last_merge=0.9874 (last merge round=41)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9805040990903584, 'auprc': 0.9991075884361648, 'loss_val': 0.0630992933708494, 'psi': 0.987945494828681}-{'f1_val': 0.9934888194563342, 'auprc': 0.9990929458828222, 'loss_val': 0.031695814382652544, 'psi': 0.9957304700269294}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=1.712814 cos_to_last_merge=0.9789 (last merge round=40)
[S9] round=80 local utility u=0.029953 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9951988896043817, 'loss_val': 0.02201183587743611, 'psi': 0.99609505060061}-{'f1_val': 0.9884538934865174, 'auprc': 0.9995587686840203, 'loss_val': 0.04556594477442352, 'psi': 0.9928958435655184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=80 head_norm_before_train=2.252895 cos_to_last_merge=0.9740 (last merge round=35)
[S10] round=80 local utility u=0.000105 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9976125719189333, 'loss_val': 0.025352168631070555, 'psi': 0.9962389011058115}-{'f1_val': 0.9953231205637304, 'auprc': 0.997580549295311, 'loss_val': 0.02546617850365111, 'psi': 0.9962260920563626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=80 head_norm_before_train=2.106575 cos_to_last_merge=0.9947 (last merge round=40)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.999115739398456, 'loss_val': 0.016909815249524934, 'psi': 0.9975768487564407}-{'f1_val': 0.9965509216617638, 'auprc': 0.999091844644856, 'loss_val': 0.0166223594690021, 'psi': 0.9975672908550007}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.682562 cos_to_last_merge=0.9390 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=80 local utility u=0.527228 metrics={'f1_val': 0.7213249489597662, 'auprc': 0.7805942634736418, 'loss_val': 0.9398172930333802, 'psi': 0.7450326747653164}-{'f1_val': 0.6365054083584263, 'auprc': 0.6894689865377276, 'loss_val': 1.2119808721501326, 'psi': 0.6576908396301469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=80 head_norm_before_train=2.209806 cos_to_last_merge=0.9713 (last merge round=34)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9365758830473693, 'auprc': 0.9968143098839578, 'loss_val': 0.14666814656796442, 'psi': 0.9606712537820046}-{'f1_val': 0.9983073289132482, 'auprc': 0.9992295379216463, 'loss_val': 0.018685189535175176, 'psi': 0.9986762125166075}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=2.183908 cos_to_last_merge=0.9832 (last merge round=40)
[S15] round=80 local utility u=0.004213 metrics={'f1_val': 0.9110423648777821, 'auprc': 0.997824764801828, 'loss_val': 0.19298241631084562, 'psi': 0.9457553248474004}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978206349919281, 'loss_val': 0.19473404954706983, 'psi': 0.9450873777043356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=80 head_norm_before_train=1.825437 cos_to_last_merge=0.9827 (last merge round=35)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.9472724298008863, 'auprc': 0.9879687358694813, 'loss_val': 0.1760740376046124, 'psi': 0.9635509522283243}-{'f1_val': 0.9917148021162032, 'auprc': 0.9954816813042242, 'loss_val': 0.04070048037571675, 'psi': 0.9932215537914115}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=2.189045 cos_to_last_merge=0.9502 (last merge round=36)
[S17] round=80 local utility u=0.070095 metrics={'f1_val': 0.8502842377924325, 'auprc': 0.9926332864777949, 'loss_val': 0.5458799275848022, 'psi': 0.9072238572665774}-{'f1_val': 0.8418315010014046, 'auprc': 0.985088521770554, 'loss_val': 0.612720188222686, 'psi': 0.8991343093090644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=81 head_norm_before_train=2.386417 (no previous merge yet)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.762505060567444, 'auprc': 0.8921550207004617, 'loss_val': 0.654717441201788, 'psi': 0.8143650446206512}-{'f1_val': 0.8330711564310884, 'auprc': 0.8855643740818857, 'loss_val': 0.3830905515759552, 'psi': 0.8540684434914074}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.209075 cos_to_last_merge=0.9635 (last merge round=42)
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.8409252194758898, 'auprc': 0.9934087092711574, 'loss_val': 0.25176892202410855, 'psi': 0.9019186153939969}-{'f1_val': 0.9612927942165166, 'auprc': 0.9983324073222966, 'loss_val': 0.09248208173113395, 'psi': 0.9761086394588285}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=1.900968 cos_to_last_merge=0.9627 (last merge round=36)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9398347348695917, 'auprc': 0.9246449894139497, 'loss_val': 0.33721101714924506, 'psi': 0.9337588366873348}-{'f1_val': 0.9409037488628171, 'auprc': 0.9353999096031435, 'loss_val': 0.3306887812814038, 'psi': 0.9387022131589476}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.744149 cos_to_last_merge=0.9606 (last merge round=42)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9754728634116382, 'auprc': 0.9947239105237533, 'loss_val': 0.10865966463519985, 'psi': 0.9831732822564843}-{'f1_val': 0.9845176690264796, 'auprc': 0.9932983297920954, 'loss_val': 0.08143739710099564, 'psi': 0.9880299333327259}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=2.585041 (no previous merge yet)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.8447062789994186, 'auprc': 0.9316301701839786, 'loss_val': 0.39238580069843043, 'psi': 0.8794758354732426}-{'f1_val': 0.959660769793092, 'auprc': 0.9592144653568778, 'loss_val': 0.1836456953016319, 'psi': 0.9594822480186064}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=2.070183 cos_to_last_merge=0.9976 (last merge round=42)
[S7] round=81 local utility u=0.797637 metrics={'f1_val': 0.6699780061333649, 'auprc': 0.8217982075266966, 'loss_val': 0.3607482295308604, 'psi': 0.7307060866906976}-{'f1_val': 0.519930335788929, 'auprc': 0.7815728129668691, 'loss_val': 0.9350593871168434, 'psi': 0.6245873266601051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=81 head_norm_before_train=2.077021 cos_to_last_merge=0.9870 (last merge round=41)
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.8210846523362104, 'auprc': 0.9949079034597808, 'loss_val': 0.4856985021546853, 'psi': 0.8906139527856385}-{'f1_val': 0.9805040990903584, 'auprc': 0.9991075884361648, 'loss_val': 0.0630992933708494, 'psi': 0.987945494828681}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=1.718162 cos_to_last_merge=0.9785 (last merge round=40)
[S9] round=81 local utility u=0.002324 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956667263472395, 'loss_val': 0.021230600673883396, 'psi': 0.9965284380461815}-{'f1_val': 0.9966924912647621, 'auprc': 0.9951988896043817, 'loss_val': 0.02201183587743611, 'psi': 0.99609505060061}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=81 head_norm_before_train=2.257908 cos_to_last_merge=0.9737 (last merge round=35)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975871598544092, 'loss_val': 0.025471527534818444, 'psi': 0.9962287362800019}-{'f1_val': 0.9953231205637304, 'auprc': 0.9976125719189333, 'loss_val': 0.025352168631070555, 'psi': 0.9962389011058115}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=2.109093 cos_to_last_merge=0.9945 (last merge round=40)
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9991156730731676, 'loss_val': 0.01719068596317831, 'psi': 0.9975768222263254}-{'f1_val': 0.9965509216617638, 'auprc': 0.999115739398456, 'loss_val': 0.016909815249524934, 'psi': 0.9975768487564407}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=1.688963 cos_to_last_merge=0.9383 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.7177172067158983, 'auprc': 0.7469850182234132, 'loss_val': 1.1537167237097015, 'psi': 0.7294243313189043}-{'f1_val': 0.7213249489597662, 'auprc': 0.7805942634736418, 'loss_val': 0.9398172930333802, 'psi': 0.7450326747653164}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=2.213743 cos_to_last_merge=0.9709 (last merge round=34)
[S14] round=81 local utility u=0.067108 metrics={'f1_val': 0.9487606551784278, 'auprc': 0.9977550258897996, 'loss_val': 0.08838320571709393, 'psi': 0.9683584034629765}-{'f1_val': 0.9365758830473693, 'auprc': 0.9968143098839578, 'loss_val': 0.14666814656796442, 'psi': 0.9606712537820046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=81 head_norm_before_train=2.189651 cos_to_last_merge=0.9829 (last merge round=40)
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9977584369639722, 'loss_val': 0.2431523464712557, 'psi': 0.9420294244929175}-{'f1_val': 0.9110423648777821, 'auprc': 0.997824764801828, 'loss_val': 0.19298241631084562, 'psi': 0.9457553248474004}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=1.830240 cos_to_last_merge=0.9825 (last merge round=35)
[S16] round=81 local utility u=0.206808 metrics={'f1_val': 0.9918895702204148, 'auprc': 0.9916783472481525, 'loss_val': 0.04129024164165015, 'psi': 0.99180508103151}-{'f1_val': 0.9472724298008863, 'auprc': 0.9879687358694813, 'loss_val': 0.1760740376046124, 'psi': 0.9635509522283243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=81 head_norm_before_train=2.197082 cos_to_last_merge=0.9495 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.949
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.8251443521365663, 'auprc': 0.9807613970603516, 'loss_val': 0.7403225164974986, 'psi': 0.8873911701060804}-{'f1_val': 0.8502842377924325, 'auprc': 0.9926332864777949, 'loss_val': 0.5458799275848022, 'psi': 0.9072238572665774}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=2.392433 (no previous merge yet)
[S2] round=82 local utility u=0.218780 metrics={'f1_val': 0.8299885601193604, 'auprc': 0.8289175299062201, 'loss_val': 0.4323461155291465, 'psi': 0.8295601480341043}-{'f1_val': 0.762505060567444, 'auprc': 0.8921550207004617, 'loss_val': 0.654717441201788, 'psi': 0.8143650446206512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=82 head_norm_before_train=2.215810 cos_to_last_merge=0.9630 (last merge round=42)
[S3] round=82 local utility u=0.059249 metrics={'f1_val': 0.8533044322724136, 'auprc': 0.9983669058605259, 'loss_val': 0.22242036015224448, 'psi': 0.9113294217076585}-{'f1_val': 0.8409252194758898, 'auprc': 0.9934087092711574, 'loss_val': 0.25176892202410855, 'psi': 0.9019186153939969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=82 head_norm_before_train=1.909406 cos_to_last_merge=0.9620 (last merge round=36)
[S4] round=82 local utility u=0.040607 metrics={'f1_val': 0.9425263675072947, 'auprc': 0.9467932062181512, 'loss_val': 0.3385916884389842, 'psi': 0.9442331029916373}-{'f1_val': 0.9398347348695917, 'auprc': 0.9246449894139497, 'loss_val': 0.33721101714924506, 'psi': 0.9337588366873348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=82 head_norm_before_train=1.751148 cos_to_last_merge=0.9596 (last merge round=42)
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.9615785892633593, 'auprc': 0.9877414841585707, 'loss_val': 0.14113044669392857, 'psi': 0.9720437472214438}-{'f1_val': 0.9754728634116382, 'auprc': 0.9947239105237533, 'loss_val': 0.10865966463519985, 'psi': 0.9831732822564843}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=2.592017 (no previous merge yet)
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.7840828523082045, 'auprc': 0.7663809351720272, 'loss_val': 0.9986099201452651, 'psi': 0.7770020854537336}-{'f1_val': 0.8447062789994186, 'auprc': 0.9316301701839786, 'loss_val': 0.39238580069843043, 'psi': 0.8794758354732426}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=2.076029 cos_to_last_merge=0.9974 (last merge round=42)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.6041568351660258, 'auprc': 0.7895883622019366, 'loss_val': 0.635971875409148, 'psi': 0.6783294459803901}-{'f1_val': 0.6699780061333649, 'auprc': 0.8217982075266966, 'loss_val': 0.3607482295308604, 'psi': 0.7307060866906976}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=2.082218 cos_to_last_merge=0.9867 (last merge round=41)
[S8] round=82 local utility u=0.332880 metrics={'f1_val': 0.8779896192176373, 'auprc': 0.986547040891026, 'loss_val': 0.13628581552404634, 'psi': 0.9214125878869928}-{'f1_val': 0.8210846523362104, 'auprc': 0.9949079034597808, 'loss_val': 0.4856985021546853, 'psi': 0.8906139527856385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=82 head_norm_before_train=1.722955 cos_to_last_merge=0.9782 (last merge round=40)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9863222816204869, 'auprc': 0.9799485222893918, 'loss_val': 0.06057292976507475, 'psi': 0.9837727778880487}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956667263472395, 'loss_val': 0.021230600673883396, 'psi': 0.9965284380461815}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.262103 cos_to_last_merge=0.9734 (last merge round=35)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975837071393628, 'loss_val': 0.025521716229759107, 'psi': 0.9962273551939833}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975871598544092, 'loss_val': 0.025471527534818444, 'psi': 0.9962287362800019}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=2.110251 cos_to_last_merge=0.9942 (last merge round=40)
[S11] round=82 local utility u=0.000001 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9991165341177626, 'loss_val': 0.017190362962133984, 'psi': 0.9975771666441634}-{'f1_val': 0.9965509216617638, 'auprc': 0.9991156730731676, 'loss_val': 0.01719068596317831, 'psi': 0.9975768222263254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=82 head_norm_before_train=1.699257 cos_to_last_merge=0.9373 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.937
[S13] round=82 local utility u=0.106278 metrics={'f1_val': 0.7315220106347865, 'auprc': 0.7498247700976699, 'loss_val': 1.0325097739872917, 'psi': 0.7388431144199399}-{'f1_val': 0.7177172067158983, 'auprc': 0.7469850182234132, 'loss_val': 1.1537167237097015, 'psi': 0.7294243313189043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=82 head_norm_before_train=2.219922 cos_to_last_merge=0.9706 (last merge round=34)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9398968702608305, 'auprc': 0.9966471697805237, 'loss_val': 0.12941589028420022, 'psi': 0.9625969900687078}-{'f1_val': 0.9487606551784278, 'auprc': 0.9977550258897996, 'loss_val': 0.08838320571709393, 'psi': 0.9683584034629765}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=2.195292 cos_to_last_merge=0.9827 (last merge round=40)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9037402512786699, 'auprc': 0.9977496996975526, 'loss_val': 0.24766763714672163, 'psi': 0.941344030646223}-{'f1_val': 0.9048767495122143, 'auprc': 0.9977584369639722, 'loss_val': 0.2431523464712557, 'psi': 0.9420294244929175}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=1.835805 cos_to_last_merge=0.9823 (last merge round=35)
[S16] round=82 local utility u=0.006052 metrics={'f1_val': 0.9917148021162032, 'auprc': 0.9954632217947482, 'loss_val': 0.03949233909437614, 'psi': 0.9932141699876211}-{'f1_val': 0.9918895702204148, 'auprc': 0.9916783472481525, 'loss_val': 0.04129024164165015, 'psi': 0.99180508103151}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=82 head_norm_before_train=2.206150 cos_to_last_merge=0.9487 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.949
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.7998732217157378, 'auprc': 0.9755203874155205, 'loss_val': 0.8385384672558981, 'psi': 0.8701320879956509}-{'f1_val': 0.8251443521365663, 'auprc': 0.9807613970603516, 'loss_val': 0.7403225164974986, 'psi': 0.8873911701060804}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=83 head_norm_before_train=2.398479 (no previous merge yet)
[S2] round=83 local utility u=0.231650 metrics={'f1_val': 0.8282042892746417, 'auprc': 0.9864892533756797, 'loss_val': 0.43105587939369827, 'psi': 0.891518274915057}-{'f1_val': 0.8299885601193604, 'auprc': 0.8289175299062201, 'loss_val': 0.4323461155291465, 'psi': 0.8295601480341043}
[S2] not sending this round → trigger blocked (psi=0.892)
[S3] START round=83 head_norm_before_train=2.222478 cos_to_last_merge=0.9626 (last merge round=42)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.8309033811651636, 'auprc': 0.9893992409948391, 'loss_val': 0.33757896848102564, 'psi': 0.8943017250970338}-{'f1_val': 0.8533044322724136, 'auprc': 0.9983669058605259, 'loss_val': 0.22242036015224448, 'psi': 0.9113294217076585}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=1.915243 cos_to_last_merge=0.9613 (last merge round=36)
[S4] round=83 local utility u=0.009269 metrics={'f1_val': 0.9435480712124118, 'auprc': 0.952424209456353, 'loss_val': 0.3430765067219216, 'psi': 0.9470985265099883}-{'f1_val': 0.9425263675072947, 'auprc': 0.9467932062181512, 'loss_val': 0.3385916884389842, 'psi': 0.9442331029916373}
[S4] not sending this round → trigger blocked (psi=0.947)
[S5] START round=83 head_norm_before_train=1.763439 cos_to_last_merge=0.9581 (last merge round=42)
[S5] round=83 local utility u=0.173047 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.999078776628223, 'loss_val': 0.04462891989431226, 'psi': 0.9981366840169245}-{'f1_val': 0.9615785892633593, 'auprc': 0.9877414841585707, 'loss_val': 0.14113044669392857, 'psi': 0.9720437472214438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=83 head_norm_before_train=2.600430 (no previous merge yet)
[S6] round=83 local utility u=1.000000 metrics={'f1_val': 0.957153053991992, 'auprc': 0.8922755436775008, 'loss_val': 0.22103189680544116, 'psi': 0.9312020498661956}-{'f1_val': 0.7840828523082045, 'auprc': 0.7663809351720272, 'loss_val': 0.9986099201452651, 'psi': 0.7770020854537336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=83 head_norm_before_train=2.079773 cos_to_last_merge=0.9972 (last merge round=42)
[S7] round=83 local utility u=0.138692 metrics={'f1_val': 0.6348892846694125, 'auprc': 0.7984155349479474, 'loss_val': 0.5694649624967086, 'psi': 0.7002997847808266}-{'f1_val': 0.6041568351660258, 'auprc': 0.7895883622019366, 'loss_val': 0.635971875409148, 'psi': 0.6783294459803901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=83 head_norm_before_train=2.084954 cos_to_last_merge=0.9864 (last merge round=41)
[S8] round=83 local utility u=0.412557 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9996999775528752, 'loss_val': 0.03486035174798678, 'psi': 0.9950966971231013}-{'f1_val': 0.8779896192176373, 'auprc': 0.986547040891026, 'loss_val': 0.13628581552404634, 'psi': 0.9214125878869928}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=83 head_norm_before_train=1.726686 cos_to_last_merge=0.9780 (last merge round=40)
[S9] round=83 local utility u=0.074100 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9945938896354849, 'loss_val': 0.020991957028391763, 'psi': 0.9960993033614797}-{'f1_val': 0.9863222816204869, 'auprc': 0.9799485222893918, 'loss_val': 0.06057292976507475, 'psi': 0.9837727778880487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=83 head_norm_before_train=2.266198 cos_to_last_merge=0.9731 (last merge round=35)
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975861253846446, 'loss_val': 0.025532759562480925, 'psi': 0.996228322492096}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975837071393628, 'loss_val': 0.025521716229759107, 'psi': 0.9962273551939833}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=2.113868 cos_to_last_merge=0.9940 (last merge round=40)
[S11] round=83 local utility u=0.000069 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.999115667186186, 'loss_val': 0.017050722508394244, 'psi': 0.9975768198715328}-{'f1_val': 0.9965509216617638, 'auprc': 0.9991165341177626, 'loss_val': 0.017190362962133984, 'psi': 0.9975771666441634}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=83 head_norm_before_train=1.704847 cos_to_last_merge=0.9365 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.937
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.6166434591746139, 'auprc': 0.6480894348723275, 'loss_val': 1.3870453414222335, 'psi': 0.6292218494536994}-{'f1_val': 0.7315220106347865, 'auprc': 0.7498247700976699, 'loss_val': 1.0325097739872917, 'psi': 0.7388431144199399}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=2.222079 cos_to_last_merge=0.9702 (last merge round=34)
[S14] round=83 local utility u=0.231775 metrics={'f1_val': 0.9980871226256064, 'auprc': 0.9991919194642944, 'loss_val': 0.022641910769770734, 'psi': 0.9985290413610817}-{'f1_val': 0.9398968702608305, 'auprc': 0.9966471697805237, 'loss_val': 0.12941589028420022, 'psi': 0.9625969900687078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=83 head_norm_before_train=2.200772 cos_to_last_merge=0.9825 (last merge round=40)
[S15] round=83 local utility u=0.010569 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9977719103263111, 'loss_val': 0.23341471585713808, 'psi': 0.942034813837853}-{'f1_val': 0.9037402512786699, 'auprc': 0.9977496996975526, 'loss_val': 0.24766763714672163, 'psi': 0.941344030646223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=83 head_norm_before_train=1.840256 cos_to_last_merge=0.9821 (last merge round=35)
[S16] round=83 local utility u=0.004419 metrics={'f1_val': 0.9919383256657482, 'auprc': 0.997751799326611, 'loss_val': 0.03886173729879135, 'psi': 0.9942637151300934}-{'f1_val': 0.9917148021162032, 'auprc': 0.9954632217947482, 'loss_val': 0.03949233909437614, 'psi': 0.9932141699876211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=83 head_norm_before_train=2.210900 cos_to_last_merge=0.9481 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=83 local utility u=0.340747 metrics={'f1_val': 0.8532572669071394, 'auprc': 0.9927462520132492, 'loss_val': 0.5290259978698877, 'psi': 0.9090528609495834}-{'f1_val': 0.7998732217157378, 'auprc': 0.9755203874155205, 'loss_val': 0.8385384672558981, 'psi': 0.8701320879956509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=84 head_norm_before_train=2.405755 (no previous merge yet)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7537891146609441, 'auprc': 0.7742997466391217, 'loss_val': 0.7733783242263723, 'psi': 0.7619933674522151}-{'f1_val': 0.8282042892746417, 'auprc': 0.9864892533756797, 'loss_val': 0.43105587939369827, 'psi': 0.891518274915057}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.228731 cos_to_last_merge=0.9622 (last merge round=42)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.7982502822004987, 'auprc': 0.9733570460739743, 'loss_val': 0.4248987526408773, 'psi': 0.8682929877498888}-{'f1_val': 0.8309033811651636, 'auprc': 0.9893992409948391, 'loss_val': 0.33757896848102564, 'psi': 0.8943017250970338}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=1.919212 cos_to_last_merge=0.9608 (last merge round=36)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9431598223916766, 'auprc': 0.9366530838764064, 'loss_val': 0.34032258506774427, 'psi': 0.9405571269855685}-{'f1_val': 0.9435480712124118, 'auprc': 0.952424209456353, 'loss_val': 0.3430765067219216, 'psi': 0.9470985265099883}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.775087 cos_to_last_merge=0.9566 (last merge round=42)
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.7964239814004047, 'auprc': 0.9896640719368219, 'loss_val': 0.2859701806308209, 'psi': 0.8737200176149715}-{'f1_val': 0.9975086222760589, 'auprc': 0.999078776628223, 'loss_val': 0.04462891989431226, 'psi': 0.9981366840169245}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=2.605647 (no previous merge yet)
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.6184590002693697, 'auprc': 0.7360976997415489, 'loss_val': 1.7001941555753244, 'psi': 0.6655144800582414}-{'f1_val': 0.957153053991992, 'auprc': 0.8922755436775008, 'loss_val': 0.22103189680544116, 'psi': 0.9312020498661956}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=2.083791 cos_to_last_merge=0.9971 (last merge round=42)
[S7] round=84 local utility u=0.058452 metrics={'f1_val': 0.6504177483792621, 'auprc': 0.8024302040551514, 'loss_val': 0.5577766495633619, 'psi': 0.7112227306496179}-{'f1_val': 0.6348892846694125, 'auprc': 0.7984155349479474, 'loss_val': 0.5694649624967086, 'psi': 0.7002997847808266}
[S7] not sending this round → trigger blocked (psi=0.711)
[S8] START round=84 head_norm_before_train=2.089449 cos_to_last_merge=0.9862 (last merge round=41)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9913111459209346, 'auprc': 0.9995826268635817, 'loss_val': 0.034384799104928976, 'psi': 0.9946197382979933}-{'f1_val': 0.992027843503252, 'auprc': 0.9996999775528752, 'loss_val': 0.03486035174798678, 'psi': 0.9950966971231013}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=1.730830 cos_to_last_merge=0.9777 (last merge round=40)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9952049748240968, 'loss_val': 0.021772388410895595, 'psi': 0.996097484688496}-{'f1_val': 0.9971029125121428, 'auprc': 0.9945938896354849, 'loss_val': 0.020991957028391763, 'psi': 0.9960993033614797}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.271885 cos_to_last_merge=0.9727 (last merge round=35)
[S10] round=84 local utility u=0.000058 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9976034752943881, 'loss_val': 0.02546831340101311, 'psi': 0.9962352624559934}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975861253846446, 'loss_val': 0.025532759562480925, 'psi': 0.996228322492096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=84 head_norm_before_train=2.118695 cos_to_last_merge=0.9939 (last merge round=40)
[S11] round=84 local utility u=0.000628 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9991163665485742, 'loss_val': 0.015796256619211538, 'psi': 0.997577099616488}-{'f1_val': 0.9965509216617638, 'auprc': 0.999115667186186, 'loss_val': 0.017050722508394244, 'psi': 0.9975768198715328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=84 head_norm_before_train=1.706650 cos_to_last_merge=0.9362 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=84 local utility u=0.599801 metrics={'f1_val': 0.7140483916648621, 'auprc': 0.7435422433552703, 'loss_val': 1.058231139608377, 'psi': 0.7258459323410253}-{'f1_val': 0.6166434591746139, 'auprc': 0.6480894348723275, 'loss_val': 1.3870453414222335, 'psi': 0.6292218494536994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=84 head_norm_before_train=2.226320 cos_to_last_merge=0.9698 (last merge round=34)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9795666176464692, 'auprc': 0.9975341777847797, 'loss_val': 0.04321993603512268, 'psi': 0.9867536417017935}-{'f1_val': 0.9980871226256064, 'auprc': 0.9991919194642944, 'loss_val': 0.022641910769770734, 'psi': 0.9985290413610817}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.206207 cos_to_last_merge=0.9823 (last merge round=40)
[S15] round=84 local utility u=0.008059 metrics={'f1_val': 0.906572453969457, 'auprc': 0.9977780940971452, 'loss_val': 0.2274892452444516, 'psi': 0.9430547100205323}-{'f1_val': 0.9048767495122143, 'auprc': 0.9977719103263111, 'loss_val': 0.23341471585713808, 'psi': 0.942034813837853}
[S15] not sending this round → trigger blocked (psi=0.943)
[S16] START round=84 head_norm_before_train=1.845189 cos_to_last_merge=0.9819 (last merge round=35)
[S16] round=84 local utility u=0.000194 metrics={'f1_val': 0.9919383256657482, 'auprc': 0.997791931364334, 'loss_val': 0.03859465286718701, 'psi': 0.9942797679451826}-{'f1_val': 0.9919383256657482, 'auprc': 0.997751799326611, 'loss_val': 0.03886173729879135, 'psi': 0.9942637151300934}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=84 head_norm_before_train=2.217991 cos_to_last_merge=0.9475 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.8294944833411302, 'auprc': 0.989898497472264, 'loss_val': 0.7269169175164688, 'psi': 0.8936560889935837}-{'f1_val': 0.8532572669071394, 'auprc': 0.9927462520132492, 'loss_val': 0.5290259978698877, 'psi': 0.9090528609495834}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=2.413022 (no previous merge yet)
[S2] round=85 local utility u=0.266343 metrics={'f1_val': 0.7732480389497544, 'auprc': 0.88122297009634, 'loss_val': 0.6782149993716434, 'psi': 0.8164380114083887}-{'f1_val': 0.7537891146609441, 'auprc': 0.7742997466391217, 'loss_val': 0.7733783242263723, 'psi': 0.7619933674522151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=85 head_norm_before_train=2.235510 cos_to_last_merge=0.9617 (last merge round=42)
[S3] round=85 local utility u=0.294488 metrics={'f1_val': 0.85281087807253, 'auprc': 0.9982741812349611, 'loss_val': 0.23803812001040578, 'psi': 0.9109961993375024}-{'f1_val': 0.7982502822004987, 'auprc': 0.9733570460739743, 'loss_val': 0.4248987526408773, 'psi': 0.8682929877498888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=85 head_norm_before_train=1.923618 cos_to_last_merge=0.9600 (last merge round=36)
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9438421950271415, 'auprc': 0.930956908443259, 'loss_val': 0.34341463930906924, 'psi': 0.9386880803935884}-{'f1_val': 0.9431598223916766, 'auprc': 0.9366530838764064, 'loss_val': 0.34032258506774427, 'psi': 0.9405571269855685}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.784377 cos_to_last_merge=0.9554 (last merge round=42)
[S5] round=85 local utility u=0.723816 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9977520516793386, 'loss_val': 0.064269907342304, 'psi': 0.99712200175881}-{'f1_val': 0.7964239814004047, 'auprc': 0.9896640719368219, 'loss_val': 0.2859701806308209, 'psi': 0.8737200176149715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=85 head_norm_before_train=2.613920 (no previous merge yet)
[S6] round=85 local utility u=1.000000 metrics={'f1_val': 0.8191030236667662, 'auprc': 0.8802644514460543, 'loss_val': 0.8671429490040097, 'psi': 0.8435675947784815}-{'f1_val': 0.6184590002693697, 'auprc': 0.7360976997415489, 'loss_val': 1.7001941555753244, 'psi': 0.6655144800582414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=85 head_norm_before_train=2.087804 cos_to_last_merge=0.9969 (last merge round=42)
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.5641147918916137, 'auprc': 0.7824356283515037, 'loss_val': 0.9579799831726685, 'psi': 0.6514431264755698}-{'f1_val': 0.6504177483792621, 'auprc': 0.8024302040551514, 'loss_val': 0.5577766495633619, 'psi': 0.7112227306496179}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=85 head_norm_before_train=2.097251 cos_to_last_merge=0.9859 (last merge round=41)
[S8] round=85 local utility u=0.008965 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9995437366130152, 'loss_val': 0.027208230006917848, 'psi': 0.9956911424347022}-{'f1_val': 0.9913111459209346, 'auprc': 0.9995826268635817, 'loss_val': 0.034384799104928976, 'psi': 0.9946197382979933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=85 head_norm_before_train=1.735508 cos_to_last_merge=0.9774 (last merge round=40)
[S9] round=85 local utility u=0.005144 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9995133785964434, 'loss_val': 0.021881725078536356, 'psi': 0.9975679688768211}-{'f1_val': 0.9966924912647621, 'auprc': 0.9952049748240968, 'loss_val': 0.021772388410895595, 'psi': 0.996097484688496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=85 head_norm_before_train=2.278037 cos_to_last_merge=0.9723 (last merge round=35)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975921979153666, 'loss_val': 0.025591539461416613, 'psi': 0.9962307515043849}-{'f1_val': 0.9953231205637304, 'auprc': 0.9976034752943881, 'loss_val': 0.02546831340101311, 'psi': 0.9962352624559934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=2.123771 cos_to_last_merge=0.9939 (last merge round=40)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.991413698321403, 'auprc': 0.9994527253001039, 'loss_val': 0.030952886199293202, 'psi': 0.9946293091128834}-{'f1_val': 0.9965509216617638, 'auprc': 0.9991163665485742, 'loss_val': 0.015796256619211538, 'psi': 0.997577099616488}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=1.711158 cos_to_last_merge=0.9357 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.7236501267403168, 'auprc': 0.742244427967796, 'loss_val': 1.1156384471585203, 'psi': 0.7310878472313085}-{'f1_val': 0.7140483916648621, 'auprc': 0.7435422433552703, 'loss_val': 1.058231139608377, 'psi': 0.7258459323410253}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.231333 cos_to_last_merge=0.9696 (last merge round=34)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9390982604983729, 'auprc': 0.9971247915878587, 'loss_val': 0.12730866794262954, 'psi': 0.9623088729341671}-{'f1_val': 0.9795666176464692, 'auprc': 0.9975341777847797, 'loss_val': 0.04321993603512268, 'psi': 0.9867536417017935}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=2.211533 cos_to_last_merge=0.9821 (last merge round=40)
[S15] round=85 local utility u=0.016207 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978115636835257, 'loss_val': 0.2153316995786495, 'psi': 0.9450837491809746}-{'f1_val': 0.906572453969457, 'auprc': 0.9977780940971452, 'loss_val': 0.2274892452444516, 'psi': 0.9430547100205323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=85 head_norm_before_train=1.849480 cos_to_last_merge=0.9816 (last merge round=35)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9915205602333813, 'auprc': 0.9979851080631137, 'loss_val': 0.038218712538242626, 'psi': 0.9941063793652742}-{'f1_val': 0.9919383256657482, 'auprc': 0.997791931364334, 'loss_val': 0.03859465286718701, 'psi': 0.9942797679451826}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.226241 cos_to_last_merge=0.9469 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.8295376965714811, 'auprc': 0.9894591536202648, 'loss_val': 0.7400769090289813, 'psi': 0.8935062793909946}-{'f1_val': 0.8294944833411302, 'auprc': 0.989898497472264, 'loss_val': 0.7269169175164688, 'psi': 0.8936560889935837}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=86 head_norm_before_train=2.419253 (no previous merge yet)
[S2] round=86 local utility u=0.306528 metrics={'f1_val': 0.8330035929183446, 'auprc': 0.886659334591298, 'loss_val': 0.4400011656642916, 'psi': 0.8544658895875259}-{'f1_val': 0.7732480389497544, 'auprc': 0.88122297009634, 'loss_val': 0.6782149993716434, 'psi': 0.8164380114083887}
[S2] not sending this round → trigger blocked (psi=0.854)
[S3] START round=86 head_norm_before_train=2.240971 cos_to_last_merge=0.9614 (last merge round=42)
[S3] round=86 local utility u=0.538041 metrics={'f1_val': 0.9965361921728806, 'auprc': 0.9992265454940101, 'loss_val': 0.02716496631426249, 'psi': 0.9976123335013324}-{'f1_val': 0.85281087807253, 'auprc': 0.9982741812349611, 'loss_val': 0.23803812001040578, 'psi': 0.9109961993375024}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=86 head_norm_before_train=1.928084 cos_to_last_merge=0.9594 (last merge round=36)
[S4] round=86 local utility u=0.013452 metrics={'f1_val': 0.9474932064483416, 'auprc': 0.9331033546606133, 'loss_val': 0.3448569855742344, 'psi': 0.9417372657332503}-{'f1_val': 0.9438421950271415, 'auprc': 0.930956908443259, 'loss_val': 0.34341463930906924, 'psi': 0.9386880803935884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=86 head_norm_before_train=1.790428 cos_to_last_merge=0.9547 (last merge round=42)
[S5] round=86 local utility u=0.015490 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9986685930183407, 'loss_val': 0.040879120224078365, 'psi': 0.9979726105729716}-{'f1_val': 0.9967019684784577, 'auprc': 0.9977520516793386, 'loss_val': 0.064269907342304, 'psi': 0.99712200175881}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=86 head_norm_before_train=2.621968 (no previous merge yet)
[S6] round=86 local utility u=0.094854 metrics={'f1_val': 0.8228426371242661, 'auprc': 0.9236518945891097, 'loss_val': 0.8300354316261326, 'psi': 0.8631663401102035}-{'f1_val': 0.8191030236667662, 'auprc': 0.8802644514460543, 'loss_val': 0.8671429490040097, 'psi': 0.8435675947784815}
[S6] not sending this round → trigger blocked (psi=0.863)
[S7] START round=86 head_norm_before_train=2.091529 cos_to_last_merge=0.9967 (last merge round=42)
[S7] round=86 local utility u=0.291138 metrics={'f1_val': 0.6163845909118605, 'auprc': 0.7935480364386842, 'loss_val': 0.7226599936068143, 'psi': 0.68724996912259}-{'f1_val': 0.5641147918916137, 'auprc': 0.7824356283515037, 'loss_val': 0.9579799831726685, 'psi': 0.6514431264755698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=86 head_norm_before_train=2.104379 cos_to_last_merge=0.9855 (last merge round=41)
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9996011498739966, 'loss_val': 0.03206636950378937, 'psi': 0.9954947963726741}-{'f1_val': 0.993122746315827, 'auprc': 0.9995437366130152, 'loss_val': 0.027208230006917848, 'psi': 0.9956911424347022}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=1.739847 cos_to_last_merge=0.9771 (last merge round=40)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9954412698609372, 'loss_val': 0.042947914218404104, 'psi': 0.9917581246612466}-{'f1_val': 0.9962710290637395, 'auprc': 0.9995133785964434, 'loss_val': 0.021881725078536356, 'psi': 0.9975679688768211}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.282568 cos_to_last_merge=0.9720 (last merge round=35)
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975715750681257, 'loss_val': 0.02564609542279402, 'psi': 0.9962225023654885}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975921979153666, 'loss_val': 0.025591539461416613, 'psi': 0.9962307515043849}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=2.128826 cos_to_last_merge=0.9938 (last merge round=40)
[S11] round=86 local utility u=0.020092 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990253863380465, 'loss_val': 0.018859038870615626, 'psi': 0.9973956053054398}-{'f1_val': 0.991413698321403, 'auprc': 0.9994527253001039, 'loss_val': 0.030952886199293202, 'psi': 0.9946293091128834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=86 head_norm_before_train=1.719951 cos_to_last_merge=0.9348 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6293202855410082, 'auprc': 0.6688716030339847, 'loss_val': 1.323008212235275, 'psi': 0.6451408125381988}-{'f1_val': 0.7236501267403168, 'auprc': 0.742244427967796, 'loss_val': 1.1156384471585203, 'psi': 0.7310878472313085}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=2.238187 cos_to_last_merge=0.9694 (last merge round=34)
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9319769092749978, 'auprc': 0.9375203948652889, 'loss_val': 0.19142997548182242, 'psi': 0.9341943035111142}-{'f1_val': 0.9390982604983729, 'auprc': 0.9971247915878587, 'loss_val': 0.12730866794262954, 'psi': 0.9623088729341671}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=2.216764 cos_to_last_merge=0.9818 (last merge round=40)
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978109318260027, 'loss_val': 0.21593503919671808, 'psi': 0.9450834964379653}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978115636835257, 'loss_val': 0.2153316995786495, 'psi': 0.9450837491809746}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=1.852953 cos_to_last_merge=0.9813 (last merge round=35)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9911445912637655, 'auprc': 0.9979100830816229, 'loss_val': 0.03809774028332512, 'psi': 0.9938507879909084}-{'f1_val': 0.9915205602333813, 'auprc': 0.9979851080631137, 'loss_val': 0.038218712538242626, 'psi': 0.9941063793652742}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=2.232223 cos_to_last_merge=0.9463 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.8038605783456664, 'auprc': 0.9772913652071076, 'loss_val': 0.8669534085987859, 'psi': 0.8732328930902429}-{'f1_val': 0.8295376965714811, 'auprc': 0.9894591536202648, 'loss_val': 0.7400769090289813, 'psi': 0.8935062793909946}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.423828 (no previous merge yet)
[S2] round=87 local utility u=0.076455 metrics={'f1_val': 0.830489832738231, 'auprc': 0.9452412269358498, 'loss_val': 0.44775423592525365, 'psi': 0.8763903904172785}-{'f1_val': 0.8330035929183446, 'auprc': 0.886659334591298, 'loss_val': 0.4400011656642916, 'psi': 0.8544658895875259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=87 head_norm_before_train=2.246320 cos_to_last_merge=0.9610 (last merge round=42)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.9428439361932929, 'auprc': 0.9984434842103799, 'loss_val': 0.09991950426917641, 'psi': 0.9650837554001277}-{'f1_val': 0.9965361921728806, 'auprc': 0.9992265454940101, 'loss_val': 0.02716496631426249, 'psi': 0.9976123335013324}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=1.933374 cos_to_last_merge=0.9588 (last merge round=36)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.941268243574167, 'auprc': 0.9274853284463183, 'loss_val': 0.3482681066374837, 'psi': 0.9357550775230276}-{'f1_val': 0.9474932064483416, 'auprc': 0.9331033546606133, 'loss_val': 0.3448569855742344, 'psi': 0.9417372657332503}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.795776 cos_to_last_merge=0.9542 (last merge round=42)
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9967473541831652, 'loss_val': 0.04526102661004979, 'psi': 0.9967201227603406}-{'f1_val': 0.9975086222760589, 'auprc': 0.9986685930183407, 'loss_val': 0.040879120224078365, 'psi': 0.9979726105729716}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=2.629228 (no previous merge yet)
[S6] round=87 local utility u=0.532427 metrics={'f1_val': 0.8934946297259145, 'auprc': 0.9419224289838152, 'loss_val': 0.24390422560546102, 'psi': 0.9128657494290747}-{'f1_val': 0.8228426371242661, 'auprc': 0.9236518945891097, 'loss_val': 0.8300354316261326, 'psi': 0.8631663401102035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=87 head_norm_before_train=2.096264 cos_to_last_merge=0.9965 (last merge round=42)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.593960083834779, 'auprc': 0.7881515288850448, 'loss_val': 0.8319285033861772, 'psi': 0.6716366618548855}-{'f1_val': 0.6163845909118605, 'auprc': 0.7935480364386842, 'loss_val': 0.7226599936068143, 'psi': 0.68724996912259}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=2.106881 cos_to_last_merge=0.9852 (last merge round=41)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.8003740692278396, 'auprc': 0.9962761905074977, 'loss_val': 0.6935164168345533, 'psi': 0.8787349177397028}-{'f1_val': 0.9927572273717925, 'auprc': 0.9996011498739966, 'loss_val': 0.03206636950378937, 'psi': 0.9954947963726741}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=1.742402 cos_to_last_merge=0.9770 (last merge round=40)
[S9] round=87 local utility u=0.041066 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9994874618448458, 'loss_val': 0.019756565707360948, 'psi': 0.9980567322452241}-{'f1_val': 0.9893026945281196, 'auprc': 0.9954412698609372, 'loss_val': 0.042947914218404104, 'psi': 0.9917581246612466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=87 head_norm_before_train=2.285917 cos_to_last_merge=0.9717 (last merge round=35)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975440860295067, 'loss_val': 0.025759371604413953, 'psi': 0.9962115067500409}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975715750681257, 'loss_val': 0.02564609542279402, 'psi': 0.9962225023654885}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=2.133708 cos_to_last_merge=0.9938 (last merge round=40)
[S11] round=87 local utility u=0.004777 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9994828998037547, 'loss_val': 0.014751053159088607, 'psi': 0.9979858707760313}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990253863380465, 'loss_val': 0.018859038870615626, 'psi': 0.9973956053054398}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=87 head_norm_before_train=1.728984 cos_to_last_merge=0.9339 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.934
[S13] round=87 local utility u=0.340420 metrics={'f1_val': 0.7025436668456784, 'auprc': 0.7255332062074586, 'loss_val': 1.251493268257745, 'psi': 0.7117394825903904}-{'f1_val': 0.6293202855410082, 'auprc': 0.6688716030339847, 'loss_val': 1.323008212235275, 'psi': 0.6451408125381988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=87 head_norm_before_train=2.243096 cos_to_last_merge=0.9690 (last merge round=34)
[S14] round=87 local utility u=0.305165 metrics={'f1_val': 0.9782693625523198, 'auprc': 0.9992371677997397, 'loss_val': 0.04400553991725359, 'psi': 0.9866564846512877}-{'f1_val': 0.9319769092749978, 'auprc': 0.9375203948652889, 'loss_val': 0.19142997548182242, 'psi': 0.9341943035111142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=87 head_norm_before_train=2.221866 cos_to_last_merge=0.9816 (last merge round=40)
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9977711369580328, 'loss_val': 0.2366740506348338, 'psi': 0.9420345044905417}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978109318260027, 'loss_val': 0.21593503919671808, 'psi': 0.9450834964379653}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=1.857493 cos_to_last_merge=0.9810 (last merge round=35)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9917745098305579, 'auprc': 0.9960819223398356, 'loss_val': 0.03781535855482264, 'psi': 0.993497474834269}-{'f1_val': 0.9911445912637655, 'auprc': 0.9979100830816229, 'loss_val': 0.03809774028332512, 'psi': 0.9938507879909084}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.237843 cos_to_last_merge=0.9458 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=87 local utility u=0.370113 metrics={'f1_val': 0.8604660797611657, 'auprc': 0.9926103841202272, 'loss_val': 0.5123169164316789, 'psi': 0.9133238015047903}-{'f1_val': 0.8038605783456664, 'auprc': 0.9772913652071076, 'loss_val': 0.8669534085987859, 'psi': 0.8732328930902429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=88 head_norm_before_train=2.424229 (no previous merge yet)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.756549229356665, 'auprc': 0.756886457723634, 'loss_val': 0.7705372712456211, 'psi': 0.7566841207034527}-{'f1_val': 0.830489832738231, 'auprc': 0.9452412269358498, 'loss_val': 0.44775423592525365, 'psi': 0.8763903904172785}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=2.251764 cos_to_last_merge=0.9607 (last merge round=42)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.8631389078254691, 'auprc': 0.9758091790838131, 'loss_val': 0.3602674989414955, 'psi': 0.9082070163288067}-{'f1_val': 0.9428439361932929, 'auprc': 0.9984434842103799, 'loss_val': 0.09991950426917641, 'psi': 0.9650837554001277}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=1.940135 cos_to_last_merge=0.9581 (last merge round=36)
[S4] round=88 local utility u=0.051076 metrics={'f1_val': 0.9440431440986565, 'auprc': 0.9503125208296903, 'loss_val': 0.33124756712170045, 'psi': 0.94655089479107}-{'f1_val': 0.941268243574167, 'auprc': 0.9274853284463183, 'loss_val': 0.3482681066374837, 'psi': 0.9357550775230276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=88 head_norm_before_train=1.804511 cos_to_last_merge=0.9533 (last merge round=42)
[S5] round=88 local utility u=0.006558 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9986318425709565, 'loss_val': 0.04043243449467228, 'psi': 0.9977373542291577}-{'f1_val': 0.9967019684784577, 'auprc': 0.9967473541831652, 'loss_val': 0.04526102661004979, 'psi': 0.9967201227603406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=88 head_norm_before_train=2.635023 (no previous merge yet)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.6085269206576045, 'auprc': 0.7330777652664461, 'loss_val': 1.944841294023774, 'psi': 0.6583472585011412}-{'f1_val': 0.8934946297259145, 'auprc': 0.9419224289838152, 'loss_val': 0.24390422560546102, 'psi': 0.9128657494290747}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=2.100198 cos_to_last_merge=0.9963 (last merge round=42)
[S7] round=88 local utility u=0.562543 metrics={'f1_val': 0.6705311170185003, 'auprc': 0.8350240589547566, 'loss_val': 0.3068862646628369, 'psi': 0.7363282937930029}-{'f1_val': 0.593960083834779, 'auprc': 0.7881515288850448, 'loss_val': 0.8319285033861772, 'psi': 0.6716366618548855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=88 head_norm_before_train=2.111964 cos_to_last_merge=0.9848 (last merge round=41)
[S8] round=88 local utility u=0.905829 metrics={'f1_val': 0.9909488931872531, 'auprc': 0.9995332171441597, 'loss_val': 0.03507938858548486, 'psi': 0.9943826227700157}-{'f1_val': 0.8003740692278396, 'auprc': 0.9962761905074977, 'loss_val': 0.6935164168345533, 'psi': 0.8787349177397028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=88 head_norm_before_train=1.746096 cos_to_last_merge=0.9768 (last merge round=40)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9969170184487985, 'loss_val': 0.020230313736900544, 'psi': 0.9967823021383767}-{'f1_val': 0.9971029125121428, 'auprc': 0.9994874618448458, 'loss_val': 0.019756565707360948, 'psi': 0.9980567322452241}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.287392 cos_to_last_merge=0.9716 (last merge round=35)
[S10] round=88 local utility u=0.000100 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975750093857765, 'loss_val': 0.02565195586530942, 'psi': 0.9962238760925488}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975440860295067, 'loss_val': 0.025759371604413953, 'psi': 0.9962115067500409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=88 head_norm_before_train=2.135042 cos_to_last_merge=0.9935 (last merge round=40)
[S11] round=88 local utility u=0.001236 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9994762283916574, 'loss_val': 0.01473978160109775, 'psi': 0.9982312057867088}-{'f1_val': 0.9969878514242156, 'auprc': 0.9994828998037547, 'loss_val': 0.014751053159088607, 'psi': 0.9979858707760313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=88 head_norm_before_train=1.736667 cos_to_last_merge=0.9328 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.933
[S13] round=88 local utility u=0.297254 metrics={'f1_val': 0.7237882008485175, 'auprc': 0.798805716219617, 'loss_val': 1.004270851765276, 'psi': 0.7537952069969573}-{'f1_val': 0.7025436668456784, 'auprc': 0.7255332062074586, 'loss_val': 1.251493268257745, 'psi': 0.7117394825903904}
[S13] not sending this round → trigger blocked (psi=0.754)
[S14] START round=88 head_norm_before_train=2.249913 cos_to_last_merge=0.9685 (last merge round=34)
[S14] round=88 local utility u=0.074162 metrics={'f1_val': 0.9984983739185656, 'auprc': 0.999235762053508, 'loss_val': 0.017050943062962676, 'psi': 0.9987933291725425}-{'f1_val': 0.9782693625523198, 'auprc': 0.9992371677997397, 'loss_val': 0.04400553991725359, 'psi': 0.9866564846512877}
[S14] not sending this round → trigger blocked (psi=0.999)
[S15] START round=88 head_norm_before_train=2.226837 cos_to_last_merge=0.9814 (last merge round=40)
[S15] round=88 local utility u=0.011650 metrics={'f1_val': 0.9071353003099576, 'auprc': 0.9977985949851733, 'loss_val': 0.22700856404820802, 'psi': 0.9434006181800438}-{'f1_val': 0.9048767495122143, 'auprc': 0.9977711369580328, 'loss_val': 0.2366740506348338, 'psi': 0.9420345044905417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=88 head_norm_before_train=1.860568 cos_to_last_merge=0.9807 (last merge round=35)
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.917624014506802, 'auprc': 0.9878517048811741, 'loss_val': 0.2317940877664545, 'psi': 0.9457150906565508}-{'f1_val': 0.9917745098305579, 'auprc': 0.9960819223398356, 'loss_val': 0.03781535855482264, 'psi': 0.993497474834269}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=2.245533 cos_to_last_merge=0.9452 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.8260162788843448, 'auprc': 0.9870462459423961, 'loss_val': 0.7361730365169747, 'psi': 0.8904282657075653}-{'f1_val': 0.8604660797611657, 'auprc': 0.9926103841202272, 'loss_val': 0.5123169164316789, 'psi': 0.9133238015047903}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=89 head_norm_before_train=2.428832 (no previous merge yet)
[S2] round=89 local utility u=0.726497 metrics={'f1_val': 0.829711463426242, 'auprc': 0.9958738394033053, 'loss_val': 0.47347804882987105, 'psi': 0.8961764138170674}-{'f1_val': 0.756549229356665, 'auprc': 0.756886457723634, 'loss_val': 0.7705372712456211, 'psi': 0.7566841207034527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=89 head_norm_before_train=2.256662 cos_to_last_merge=0.9603 (last merge round=42)
[S3] round=89 local utility u=0.224051 metrics={'f1_val': 0.8975641656158384, 'auprc': 0.9986197442894753, 'loss_val': 0.18714796871755324, 'psi': 0.9379863970852932}-{'f1_val': 0.8631389078254691, 'auprc': 0.9758091790838131, 'loss_val': 0.3602674989414955, 'psi': 0.9082070163288067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=89 head_norm_before_train=1.944941 cos_to_last_merge=0.9573 (last merge round=36)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9406504519772675, 'auprc': 0.9233645580404187, 'loss_val': 0.34658723106736405, 'psi': 0.9337360944025279}-{'f1_val': 0.9440431440986565, 'auprc': 0.9503125208296903, 'loss_val': 0.33124756712170045, 'psi': 0.94655089479107}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.816803 cos_to_last_merge=0.9519 (last merge round=42)
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9745227686076957, 'auprc': 0.9937969974561042, 'loss_val': 0.0689872180157002, 'psi': 0.9822324601470591}-{'f1_val': 0.9971410286679584, 'auprc': 0.9986318425709565, 'loss_val': 0.04043243449467228, 'psi': 0.9977373542291577}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=2.641022 (no previous merge yet)
[S6] round=89 local utility u=1.000000 metrics={'f1_val': 0.8204391670627882, 'auprc': 0.7918001506326756, 'loss_val': 0.6920699050317543, 'psi': 0.8089835604907432}-{'f1_val': 0.6085269206576045, 'auprc': 0.7330777652664461, 'loss_val': 1.944841294023774, 'psi': 0.6583472585011412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=89 head_norm_before_train=2.102418 cos_to_last_merge=0.9962 (last merge round=42)
[S7] round=89 local utility u=0.960170 metrics={'f1_val': 0.9031439564164776, 'auprc': 0.9561883789873098, 'loss_val': 0.14571720562384693, 'psi': 0.9243617254448105}-{'f1_val': 0.6705311170185003, 'auprc': 0.8350240589547566, 'loss_val': 0.3068862646628369, 'psi': 0.7363282937930029}
[S7] not sending this round → trigger blocked (psi=0.924)
[S8] START round=89 head_norm_before_train=2.118138 cos_to_last_merge=0.9845 (last merge round=41)
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.6947219501802304, 'auprc': 0.9962192161333483, 'loss_val': 1.0756786305122505, 'psi': 0.8153208565614776}-{'f1_val': 0.9909488931872531, 'auprc': 0.9995332171441597, 'loss_val': 0.03507938858548486, 'psi': 0.9943826227700157}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=89 head_norm_before_train=1.750414 cos_to_last_merge=0.9765 (last merge round=40)
[S9] round=89 local utility u=0.003852 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9994900220037577, 'loss_val': 0.02005357431899892, 'psi': 0.997792315889838}-{'f1_val': 0.9966924912647621, 'auprc': 0.9969170184487985, 'loss_val': 0.020230313736900544, 'psi': 0.9967823021383767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=89 head_norm_before_train=2.291992 cos_to_last_merge=0.9713 (last merge round=35)
[S10] round=89 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975722241467032, 'loss_val': 0.025726089574197676, 'psi': 0.9962227619969195}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975750093857765, 'loss_val': 0.02565195586530942, 'psi': 0.9962238760925488}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=89 head_norm_before_train=2.134080 cos_to_last_merge=0.9932 (last merge round=40)
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9991144072839402, 'loss_val': 0.018112037887829648, 'psi': 0.9974312136837973}-{'f1_val': 0.9974011907167429, 'auprc': 0.9994762283916574, 'loss_val': 0.01473978160109775, 'psi': 0.9982312057867088}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=1.745189 cos_to_last_merge=0.9315 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.726555675357839, 'auprc': 0.7547899280315706, 'loss_val': 1.0730337283535778, 'psi': 0.7378493764273317}-{'f1_val': 0.7237882008485175, 'auprc': 0.798805716219617, 'loss_val': 1.004270851765276, 'psi': 0.7537952069969573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=2.256420 cos_to_last_merge=0.9683 (last merge round=34)
[S14] round=89 local utility u=0.000047 metrics={'f1_val': 0.9984983739185656, 'auprc': 0.9992275279778298, 'loss_val': 0.016931646264758154, 'psi': 0.9987900355422712}-{'f1_val': 0.9984983739185656, 'auprc': 0.999235762053508, 'loss_val': 0.017050943062962676, 'psi': 0.9987933291725425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=89 head_norm_before_train=2.231830 cos_to_last_merge=0.9812 (last merge round=40)
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.906572453969457, 'auprc': 0.9977887078068853, 'loss_val': 0.23168310861759817, 'psi': 0.9430589555044283}-{'f1_val': 0.9071353003099576, 'auprc': 0.9977985949851733, 'loss_val': 0.22700856404820802, 'psi': 0.9434006181800438}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=1.862733 cos_to_last_merge=0.9804 (last merge round=35)
[S16] round=89 local utility u=0.329129 metrics={'f1_val': 0.9913640279953416, 'auprc': 0.9956768920897824, 'loss_val': 0.03945102521421654, 'psi': 0.9930891736331179}-{'f1_val': 0.917624014506802, 'auprc': 0.9878517048811741, 'loss_val': 0.2317940877664545, 'psi': 0.9457150906565508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=89 head_norm_before_train=2.249781 cos_to_last_merge=0.9446 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=89 local utility u=0.132459 metrics={'f1_val': 0.8447594953456405, 'auprc': 0.9925391304409539, 'loss_val': 0.6001926090395461, 'psi': 0.9038713493837659}-{'f1_val': 0.8260162788843448, 'auprc': 0.9870462459423961, 'loss_val': 0.7361730365169747, 'psi': 0.8904282657075653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=90 head_norm_before_train=2.436770 (no previous merge yet)
[S2] round=90 local utility u=0.001132 metrics={'f1_val': 0.8283395845044184, 'auprc': 0.9884898548126898, 'loss_val': 0.4408307440343046, 'psi': 0.8923996926277269}-{'f1_val': 0.829711463426242, 'auprc': 0.9958738394033053, 'loss_val': 0.47347804882987105, 'psi': 0.8961764138170674}
[S2] not sending this round → trigger blocked (psi=0.892)
[S3] START round=90 head_norm_before_train=2.259922 cos_to_last_merge=0.9601 (last merge round=42)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.8178639275600601, 'auprc': 0.9981118147258012, 'loss_val': 0.3012501005944748, 'psi': 0.8899630824263565}-{'f1_val': 0.8975641656158384, 'auprc': 0.9986197442894753, 'loss_val': 0.18714796871755324, 'psi': 0.9379863970852932}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=1.950165 cos_to_last_merge=0.9569 (last merge round=36)
[S4] round=90 local utility u=0.040966 metrics={'f1_val': 0.9430289723082267, 'auprc': 0.9421778538077044, 'loss_val': 0.3353652762264092, 'psi': 0.9426885249080178}-{'f1_val': 0.9406504519772675, 'auprc': 0.9233645580404187, 'loss_val': 0.34658723106736405, 'psi': 0.9337360944025279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=90 head_norm_before_train=1.822380 cos_to_last_merge=0.9514 (last merge round=42)
[S5] round=90 local utility u=0.093937 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9993396206523546, 'loss_val': 0.03522462859490643, 'psi': 0.9981977989725371}-{'f1_val': 0.9745227686076957, 'auprc': 0.9937969974561042, 'loss_val': 0.0689872180157002, 'psi': 0.9822324601470591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=90 head_norm_before_train=2.645150 (no previous merge yet)
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.7232520986341382, 'auprc': 0.8259550716268662, 'loss_val': 1.2264767137571069, 'psi': 0.7643332878312294}-{'f1_val': 0.8204391670627882, 'auprc': 0.7918001506326756, 'loss_val': 0.6920699050317543, 'psi': 0.8089835604907432}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=2.103841 cos_to_last_merge=0.9961 (last merge round=42)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.5609525269293394, 'auprc': 0.7814302610967272, 'loss_val': 1.0147760311254888, 'psi': 0.6491436205962945}-{'f1_val': 0.9031439564164776, 'auprc': 0.9561883789873098, 'loss_val': 0.14571720562384693, 'psi': 0.9243617254448105}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=2.122835 cos_to_last_merge=0.9841 (last merge round=41)
[S8] round=90 local utility u=1.000000 metrics={'f1_val': 0.9946506625800536, 'auprc': 0.9974754937228698, 'loss_val': 0.02701356514485304, 'psi': 0.9957805950371801}-{'f1_val': 0.6947219501802304, 'auprc': 0.9962192161333483, 'loss_val': 1.0756786305122505, 'psi': 0.8153208565614776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=90 head_norm_before_train=1.755069 cos_to_last_merge=0.9762 (last merge round=40)
[S9] round=90 local utility u=0.001622 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995051501798071, 'loss_val': 0.019509943233107632, 'psi': 0.9980638075792085}-{'f1_val': 0.9966605118138915, 'auprc': 0.9994900220037577, 'loss_val': 0.02005357431899892, 'psi': 0.997792315889838}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=90 head_norm_before_train=2.294424 cos_to_last_merge=0.9711 (last merge round=35)
[S10] round=90 local utility u=0.000064 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975908459979221, 'loss_val': 0.02565429649932827, 'psi': 0.996230210737407}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975722241467032, 'loss_val': 0.025726089574197676, 'psi': 0.9962227619969195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=90 head_norm_before_train=2.134047 cos_to_last_merge=0.9931 (last merge round=40)
[S11] round=90 local utility u=0.005136 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9994634405734306, 'loss_val': 0.015439741724703736, 'psi': 0.998226090659418}-{'f1_val': 0.9963090846170353, 'auprc': 0.9991144072839402, 'loss_val': 0.018112037887829648, 'psi': 0.9974312136837973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=90 head_norm_before_train=1.756166 cos_to_last_merge=0.9302 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=90 local utility u=0.220766 metrics={'f1_val': 0.7432262165861829, 'auprc': 0.8172049803797163, 'loss_val': 0.9187702577514553, 'psi': 0.7728177221035963}-{'f1_val': 0.726555675357839, 'auprc': 0.7547899280315706, 'loss_val': 1.0730337283535778, 'psi': 0.7378493764273317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=90 head_norm_before_train=2.262581 cos_to_last_merge=0.9681 (last merge round=34)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9982560961963116, 'auprc': 0.9991828024145447, 'loss_val': 0.018134385467198828, 'psi': 0.9986267786836049}-{'f1_val': 0.9984983739185656, 'auprc': 0.9992275279778298, 'loss_val': 0.016931646264758154, 'psi': 0.9987900355422712}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.236810 cos_to_last_merge=0.9810 (last merge round=40)
[S15] round=90 local utility u=0.003057 metrics={'f1_val': 0.9071353003099576, 'auprc': 0.9978056700968435, 'loss_val': 0.2289976150539453, 'psi': 0.9434034482247119}-{'f1_val': 0.906572453969457, 'auprc': 0.9977887078068853, 'loss_val': 0.23168310861759817, 'psi': 0.9430589555044283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=90 head_norm_before_train=1.865234 cos_to_last_merge=0.9801 (last merge round=35)
[S16] round=90 local utility u=0.004676 metrics={'f1_val': 0.9924156602567238, 'auprc': 0.9957373523056903, 'loss_val': 0.036590753460140374, 'psi': 0.9937443370763104}-{'f1_val': 0.9913640279953416, 'auprc': 0.9956768920897824, 'loss_val': 0.03945102521421654, 'psi': 0.9930891736331179}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=90 head_norm_before_train=2.256316 cos_to_last_merge=0.9441 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.8291951134953642, 'auprc': 0.9925317553413434, 'loss_val': 0.7309233223031915, 'psi': 0.8945297702337559}-{'f1_val': 0.8447594953456405, 'auprc': 0.9925391304409539, 'loss_val': 0.6001926090395461, 'psi': 0.9038713493837659}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.436387 (no previous merge yet)
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.8315258271881565, 'auprc': 0.9705753894016839, 'loss_val': 0.42888956157667013, 'psi': 0.8871456520735674}-{'f1_val': 0.8283395845044184, 'auprc': 0.9884898548126898, 'loss_val': 0.4408307440343046, 'psi': 0.8923996926277269}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=91 head_norm_before_train=2.263906 cos_to_last_merge=0.9599 (last merge round=42)
[S3] round=91 local utility u=0.267420 metrics={'f1_val': 0.8857461738038175, 'auprc': 0.9984404160382893, 'loss_val': 0.1746897439067181, 'psi': 0.9308238706976062}-{'f1_val': 0.8178639275600601, 'auprc': 0.9981118147258012, 'loss_val': 0.3012501005944748, 'psi': 0.8899630824263565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=91 head_norm_before_train=1.954443 cos_to_last_merge=0.9562 (last merge round=36)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9410189246574674, 'auprc': 0.9271945754185659, 'loss_val': 0.35484186474971113, 'psi': 0.9354891849619068}-{'f1_val': 0.9430289723082267, 'auprc': 0.9421778538077044, 'loss_val': 0.3353652762264092, 'psi': 0.9426885249080178}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.816849 cos_to_last_merge=0.9520 (last merge round=42)
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9993075915464239, 'loss_val': 0.037689375380695916, 'psi': 0.9982282099842048}-{'f1_val': 0.9974365845193254, 'auprc': 0.9993396206523546, 'loss_val': 0.03522462859490643, 'psi': 0.9981977989725371}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=2.648057 (no previous merge yet)
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.692087205439415, 'auprc': 0.6789977722026663, 'loss_val': 1.602523562145129, 'psi': 0.6868514321447156}-{'f1_val': 0.7232520986341382, 'auprc': 0.8259550716268662, 'loss_val': 1.2264767137571069, 'psi': 0.7643332878312294}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=2.103003 cos_to_last_merge=0.9960 (last merge round=42)
[S7] round=91 local utility u=0.787176 metrics={'f1_val': 0.6821870895288434, 'auprc': 0.8299252847342071, 'loss_val': 0.3133167009147621, 'psi': 0.741282367610989}-{'f1_val': 0.5609525269293394, 'auprc': 0.7814302610967272, 'loss_val': 1.0147760311254888, 'psi': 0.6491436205962945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=91 head_norm_before_train=2.126837 cos_to_last_merge=0.9838 (last merge round=41)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.8594437427575089, 'auprc': 0.9995213878588458, 'loss_val': 0.3196249390405282, 'psi': 0.9154748007980438}-{'f1_val': 0.9946506625800536, 'auprc': 0.9974754937228698, 'loss_val': 0.02701356514485304, 'psi': 0.9957805950371801}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=1.760318 cos_to_last_merge=0.9758 (last merge round=40)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9995357742276335, 'loss_val': 0.02719787824460778, 'psi': 0.9961779372894617}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995051501798071, 'loss_val': 0.019509943233107632, 'psi': 0.9980638075792085}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.299126 cos_to_last_merge=0.9708 (last merge round=35)
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975854168816248, 'loss_val': 0.025689762612594435, 'psi': 0.9962280390908882}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975908459979221, 'loss_val': 0.02565429649932827, 'psi': 0.996230210737407}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=2.136329 cos_to_last_merge=0.9930 (last merge round=40)
[S11] round=91 local utility u=0.001091 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9998356283212766, 'loss_val': 0.014373530374432668, 'psi': 0.9983749657585564}-{'f1_val': 0.9974011907167429, 'auprc': 0.9994634405734306, 'loss_val': 0.015439741724703736, 'psi': 0.998226090659418}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=91 head_norm_before_train=1.760551 cos_to_last_merge=0.9293 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.7327999585555923, 'auprc': 0.7460688549601131, 'loss_val': 1.1328807602493538, 'psi': 0.7381075171174006}-{'f1_val': 0.7432262165861829, 'auprc': 0.8172049803797163, 'loss_val': 0.9187702577514553, 'psi': 0.7728177221035963}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=2.267368 cos_to_last_merge=0.9681 (last merge round=34)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9935048876181786, 'auprc': 0.9975055885456847, 'loss_val': 0.025128027337558895, 'psi': 0.9951051679891809}-{'f1_val': 0.9982560961963116, 'auprc': 0.9991828024145447, 'loss_val': 0.018134385467198828, 'psi': 0.9986267786836049}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=2.241661 cos_to_last_merge=0.9809 (last merge round=40)
[S15] round=91 local utility u=0.007364 metrics={'f1_val': 0.9088167532657039, 'auprc': 0.9978093590632687, 'loss_val': 0.22436841680976294, 'psi': 0.9444137955847298}-{'f1_val': 0.9071353003099576, 'auprc': 0.9978056700968435, 'loss_val': 0.2289976150539453, 'psi': 0.9434034482247119}
[S15] not sending this round → trigger blocked (psi=0.944)
[S16] START round=91 head_norm_before_train=1.866805 cos_to_last_merge=0.9798 (last merge round=35)
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9932071006024433, 'auprc': 0.9925884389436033, 'loss_val': 0.0356920688634589, 'psi': 0.9929596359389072}-{'f1_val': 0.9924156602567238, 'auprc': 0.9957373523056903, 'loss_val': 0.036590753460140374, 'psi': 0.9937443370763104}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.260607 cos_to_last_merge=0.9437 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.791646210275578, 'auprc': 0.9889971349458238, 'loss_val': 0.9263199562091038, 'psi': 0.8705865801436763}-{'f1_val': 0.8291951134953642, 'auprc': 0.9925317553413434, 'loss_val': 0.7309233223031915, 'psi': 0.8945297702337559}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.438977 (no previous merge yet)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.8315258271881565, 'auprc': 0.8737014773077572, 'loss_val': 0.445922176786782, 'psi': 0.8483960872359968}-{'f1_val': 0.8315258271881565, 'auprc': 0.9705753894016839, 'loss_val': 0.42888956157667013, 'psi': 0.8871456520735674}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.266132 cos_to_last_merge=0.9598 (last merge round=42)
[S3] round=92 local utility u=0.288803 metrics={'f1_val': 0.9651428193912157, 'auprc': 0.9995533947100455, 'loss_val': 0.07680244768949632, 'psi': 0.9789070495187476}-{'f1_val': 0.8857461738038175, 'auprc': 0.9984404160382893, 'loss_val': 0.1746897439067181, 'psi': 0.9308238706976062}
[S3] not sending this round → trigger blocked (psi=0.979)
[S4] START round=92 head_norm_before_train=1.960438 cos_to_last_merge=0.9559 (last merge round=36)
[S4] round=92 local utility u=0.024440 metrics={'f1_val': 0.9426085685606787, 'auprc': 0.9381070021878052, 'loss_val': 0.34823746130783734, 'psi': 0.9408079420115293}-{'f1_val': 0.9410189246574674, 'auprc': 0.9271945754185659, 'loss_val': 0.35484186474971113, 'psi': 0.9354891849619068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=92 head_norm_before_train=1.816447 cos_to_last_merge=0.9519 (last merge round=42)
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.9768396820652367, 'auprc': 0.9982136283439975, 'loss_val': 0.07899647973620914, 'psi': 0.9853892605767411}-{'f1_val': 0.9975086222760589, 'auprc': 0.9993075915464239, 'loss_val': 0.037689375380695916, 'psi': 0.9982282099842048}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=2.651711 (no previous merge yet)
[S6] round=92 local utility u=0.806933 metrics={'f1_val': 0.7843013451223656, 'auprc': 0.8255458755132884, 'loss_val': 0.9815874546786538, 'psi': 0.8007991572787347}-{'f1_val': 0.692087205439415, 'auprc': 0.6789977722026663, 'loss_val': 1.602523562145129, 'psi': 0.6868514321447156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=92 head_norm_before_train=2.102836 cos_to_last_merge=0.9959 (last merge round=42)
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.5956728746399175, 'auprc': 0.7850179641712002, 'loss_val': 0.7315762583889671, 'psi': 0.6714109104524306}-{'f1_val': 0.6821870895288434, 'auprc': 0.8299252847342071, 'loss_val': 0.3133167009147621, 'psi': 0.741282367610989}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=2.135636 cos_to_last_merge=0.9835 (last merge round=41)
[S8] round=92 local utility u=0.516382 metrics={'f1_val': 0.9854051623955818, 'auprc': 0.9994953682584988, 'loss_val': 0.042550543599998526, 'psi': 0.9910412447407486}-{'f1_val': 0.8594437427575089, 'auprc': 0.9995213878588458, 'loss_val': 0.3196249390405282, 'psi': 0.9154748007980438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=92 head_norm_before_train=1.765163 cos_to_last_merge=0.9755 (last merge round=40)
[S9] round=92 local utility u=0.001857 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9995828189133654, 'loss_val': 0.026128547320131684, 'psi': 0.9964471210830363}-{'f1_val': 0.9939393793306803, 'auprc': 0.9995357742276335, 'loss_val': 0.02719787824460778, 'psi': 0.9961779372894617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=92 head_norm_before_train=2.304681 cos_to_last_merge=0.9705 (last merge round=35)
[S10] round=92 local utility u=0.000032 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975933953369707, 'loss_val': 0.02565042394477489, 'psi': 0.9962312304730265}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975854168816248, 'loss_val': 0.025689762612594435, 'psi': 0.9962280390908882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=92 head_norm_before_train=2.139673 cos_to_last_merge=0.9929 (last merge round=40)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9994633894466189, 'loss_val': 0.015820529738900968, 'psi': 0.998080967638033}-{'f1_val': 0.9974011907167429, 'auprc': 0.9998356283212766, 'loss_val': 0.014373530374432668, 'psi': 0.9983749657585564}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=1.766312 cos_to_last_merge=0.9285 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.7039099925821863, 'auprc': 0.7499064457961655, 'loss_val': 1.056078489304421, 'psi': 0.722308573867778}-{'f1_val': 0.7327999585555923, 'auprc': 0.7460688549601131, 'loss_val': 1.1328807602493538, 'psi': 0.7381075171174006}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=2.271773 cos_to_last_merge=0.9678 (last merge round=34)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9744882595833374, 'auprc': 0.9974736120924478, 'loss_val': 0.062333942748442873, 'psi': 0.9836824005869815}-{'f1_val': 0.9935048876181786, 'auprc': 0.9975055885456847, 'loss_val': 0.025128027337558895, 'psi': 0.9951051679891809}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=2.246385 cos_to_last_merge=0.9807 (last merge round=40)
[S15] round=92 local utility u=0.005031 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978126924628791, 'loss_val': 0.22100623957466997, 'psi': 0.9450842006927159}-{'f1_val': 0.9088167532657039, 'auprc': 0.9978093590632687, 'loss_val': 0.22436841680976294, 'psi': 0.9444137955847298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=92 head_norm_before_train=1.870140 cos_to_last_merge=0.9795 (last merge round=35)
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9928167437928861, 'auprc': 0.9901119290189007, 'loss_val': 0.03720621654446685, 'psi': 0.9917348178832919}-{'f1_val': 0.9932071006024433, 'auprc': 0.9925884389436033, 'loss_val': 0.0356920688634589, 'psi': 0.9929596359389072}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.263923 cos_to_last_merge=0.9431 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.943
[S17] round=92 local utility u=0.000000 metrics={'f1_val': 0.7900217527317845, 'auprc': 0.9721692560169855, 'loss_val': 0.9363641394387098, 'psi': 0.862880754045865}-{'f1_val': 0.791646210275578, 'auprc': 0.9889971349458238, 'loss_val': 0.9263199562091038, 'psi': 0.8705865801436763}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=93 head_norm_before_train=2.441458 (no previous merge yet)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.7752334524421522, 'auprc': 0.8989656717723181, 'loss_val': 0.5680833787266154, 'psi': 0.8247263401742186}-{'f1_val': 0.8315258271881565, 'auprc': 0.8737014773077572, 'loss_val': 0.445922176786782, 'psi': 0.8483960872359968}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.269042 cos_to_last_merge=0.9596 (last merge round=42)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.9614557588408671, 'auprc': 0.9990010753979487, 'loss_val': 0.09571214750197234, 'psi': 0.9764738854636998}-{'f1_val': 0.9651428193912157, 'auprc': 0.9995533947100455, 'loss_val': 0.07680244768949632, 'psi': 0.9789070495187476}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=1.960899 cos_to_last_merge=0.9552 (last merge round=36)
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.9414459742357615, 'auprc': 0.9253494635099668, 'loss_val': 0.34463802986162423, 'psi': 0.9350073699454436}-{'f1_val': 0.9426085685606787, 'auprc': 0.9381070021878052, 'loss_val': 0.34823746130783734, 'psi': 0.9408079420115293}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=93 head_norm_before_train=1.818010 cos_to_last_merge=0.9517 (last merge round=42)
[S5] round=93 local utility u=0.081478 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9976580480146411, 'loss_val': 0.03575291415662456, 'psi': 0.997304954372495}-{'f1_val': 0.9768396820652367, 'auprc': 0.9982136283439975, 'loss_val': 0.07899647973620914, 'psi': 0.9853892605767411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=93 head_norm_before_train=2.655747 (no previous merge yet)
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.7313238518143903, 'auprc': 0.7272534279729678, 'loss_val': 1.3131894907097372, 'psi': 0.7296956822778213}-{'f1_val': 0.7843013451223656, 'auprc': 0.8255458755132884, 'loss_val': 0.9815874546786538, 'psi': 0.8007991572787347}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=2.105451 cos_to_last_merge=0.9958 (last merge round=42)
[S7] round=93 local utility u=0.356317 metrics={'f1_val': 0.6608950428468681, 'auprc': 0.8054024099347232, 'loss_val': 0.4714278716523835, 'psi': 0.7186979896820102}-{'f1_val': 0.5956728746399175, 'auprc': 0.7850179641712002, 'loss_val': 0.7315762583889671, 'psi': 0.6714109104524306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=93 head_norm_before_train=2.141268 cos_to_last_merge=0.9832 (last merge round=41)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9535916648669452, 'auprc': 0.9992121631741768, 'loss_val': 0.10530850610385434, 'psi': 0.9718398641898378}-{'f1_val': 0.9854051623955818, 'auprc': 0.9994953682584988, 'loss_val': 0.042550543599998526, 'psi': 0.9910412447407486}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=1.769245 cos_to_last_merge=0.9752 (last merge round=40)
[S9] round=93 local utility u=0.006550 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9961513924246255, 'loss_val': 0.019211958844319258, 'psi': 0.9967223044771358}-{'f1_val': 0.994356655862817, 'auprc': 0.9995828189133654, 'loss_val': 0.026128547320131684, 'psi': 0.9964471210830363}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=93 head_norm_before_train=2.310586 cos_to_last_merge=0.9700 (last merge round=35)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975729476182075, 'loss_val': 0.025813479066659983, 'psi': 0.9962230513855213}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975933953369707, 'loss_val': 0.02565042394477489, 'psi': 0.9962312304730265}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.143262 cos_to_last_merge=0.9929 (last merge round=40)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9994717615529242, 'loss_val': 0.014926959063180895, 'psi': 0.9979814154756991}-{'f1_val': 0.9971593530989756, 'auprc': 0.9994633894466189, 'loss_val': 0.015820529738900968, 'psi': 0.998080967638033}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.768693 cos_to_last_merge=0.9278 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.928
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.7029791368754885, 'auprc': 0.7326935594135269, 'loss_val': 1.1348170515993066, 'psi': 0.7148649058907038}-{'f1_val': 0.7039099925821863, 'auprc': 0.7499064457961655, 'loss_val': 1.056078489304421, 'psi': 0.722308573867778}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.274798 cos_to_last_merge=0.9673 (last merge round=34)
[S14] round=93 local utility u=0.094884 metrics={'f1_val': 0.997844401637113, 'auprc': 0.999232924536323, 'loss_val': 0.017981313257842017, 'psi': 0.998399810796797}-{'f1_val': 0.9744882595833374, 'auprc': 0.9974736120924478, 'loss_val': 0.062333942748442873, 'psi': 0.9836824005869815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=93 head_norm_before_train=2.251012 cos_to_last_merge=0.9805 (last merge round=40)
[S15] round=93 local utility u=0.003851 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978205567788537, 'loss_val': 0.21332729141919646, 'psi': 0.9450873464191059}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978126924628791, 'loss_val': 0.22100623957466997, 'psi': 0.9450842006927159}
[S15] not sending this round → trigger blocked (psi=0.945)
[S16] START round=93 head_norm_before_train=1.874698 cos_to_last_merge=0.9793 (last merge round=35)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9928167437928861, 'auprc': 0.9898231383183249, 'loss_val': 0.03796512908448853, 'psi': 0.9916193016030617}-{'f1_val': 0.9928167437928861, 'auprc': 0.9901119290189007, 'loss_val': 0.03720621654446685, 'psi': 0.9917348178832919}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=2.268548 cos_to_last_merge=0.9425 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=93 local utility u=0.449359 metrics={'f1_val': 0.8702230612843223, 'auprc': 0.9774123275765486, 'loss_val': 0.5345836904256663, 'psi': 0.9130987678012128}-{'f1_val': 0.7900217527317845, 'auprc': 0.9721692560169855, 'loss_val': 0.9363641394387098, 'psi': 0.862880754045865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=94 head_norm_before_train=2.441540 (no previous merge yet)
[S2] round=94 local utility u=0.372842 metrics={'f1_val': 0.8289326750798718, 'auprc': 0.9788694867147844, 'loss_val': 0.3843055260848402, 'psi': 0.8889073997338368}-{'f1_val': 0.7752334524421522, 'auprc': 0.8989656717723181, 'loss_val': 0.5680833787266154, 'psi': 0.8247263401742186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=94 head_norm_before_train=2.272910 cos_to_last_merge=0.9593 (last merge round=42)
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.8996153340854415, 'auprc': 0.9984882675704344, 'loss_val': 0.17359991580714404, 'psi': 0.9391645074794386}-{'f1_val': 0.9614557588408671, 'auprc': 0.9990010753979487, 'loss_val': 0.09571214750197234, 'psi': 0.9764738854636998}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=1.964581 cos_to_last_merge=0.9545 (last merge round=36)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9408442453859699, 'auprc': 0.924740786076859, 'loss_val': 0.3541646810352885, 'psi': 0.9344028616623254}-{'f1_val': 0.9414459742357615, 'auprc': 0.9253494635099668, 'loss_val': 0.34463802986162423, 'psi': 0.9350073699454436}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.821711 cos_to_last_merge=0.9513 (last merge round=42)
[S5] round=94 local utility u=0.001779 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.999231748949027, 'loss_val': 0.0369159860199979, 'psi': 0.9979344347462494}-{'f1_val': 0.9970695586110643, 'auprc': 0.9976580480146411, 'loss_val': 0.03575291415662456, 'psi': 0.997304954372495}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=94 head_norm_before_train=2.655834 (no previous merge yet)
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.6581979237525306, 'auprc': 0.7038013005041471, 'loss_val': 1.5993106098323535, 'psi': 0.6764392744531772}-{'f1_val': 0.7313238518143903, 'auprc': 0.7272534279729678, 'loss_val': 1.3131894907097372, 'psi': 0.7296956822778213}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=2.109034 cos_to_last_merge=0.9956 (last merge round=42)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.580281947821534, 'auprc': 0.7852776575425935, 'loss_val': 0.9780743082470549, 'psi': 0.6622802317099578}-{'f1_val': 0.6608950428468681, 'auprc': 0.8054024099347232, 'loss_val': 0.4714278716523835, 'psi': 0.7186979896820102}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.143989 cos_to_last_merge=0.9829 (last merge round=41)
[S8] round=94 local utility u=0.160269 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9993750719218519, 'loss_val': 0.024642925361693047, 'psi': 0.9958433204425412}-{'f1_val': 0.9535916648669452, 'auprc': 0.9992121631741768, 'loss_val': 0.10530850610385434, 'psi': 0.9718398641898378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=94 head_norm_before_train=1.773555 cos_to_last_merge=0.9749 (last merge round=40)
[S9] round=94 local utility u=0.001507 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997084952841185, 'loss_val': 0.01899948688453572, 'psi': 0.9970957286437597}-{'f1_val': 0.9971029125121428, 'auprc': 0.9961513924246255, 'loss_val': 0.019211958844319258, 'psi': 0.9967223044771358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=94 head_norm_before_train=2.313586 cos_to_last_merge=0.9698 (last merge round=35)
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975704322512685, 'loss_val': 0.025871468872081263, 'psi': 0.9962220452387456}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975729476182075, 'loss_val': 0.025813479066659983, 'psi': 0.9962230513855213}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.145185 cos_to_last_merge=0.9927 (last merge round=40)
[S11] round=94 local utility u=0.000888 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9998647174690413, 'loss_val': 0.014328922710347776, 'psi': 0.998138597842146}-{'f1_val': 0.9969878514242156, 'auprc': 0.9994717615529242, 'loss_val': 0.014926959063180895, 'psi': 0.9979814154756991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=94 head_norm_before_train=1.777262 cos_to_last_merge=0.9267 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.927
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6409508847097221, 'auprc': 0.6897535190535359, 'loss_val': 1.3589734257217208, 'psi': 0.6604719384472475}-{'f1_val': 0.7029791368754885, 'auprc': 0.7326935594135269, 'loss_val': 1.1348170515993066, 'psi': 0.7148649058907038}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=2.279785 cos_to_last_merge=0.9667 (last merge round=34)
[S14] round=94 local utility u=0.000165 metrics={'f1_val': 0.9980871226256064, 'auprc': 0.9991829706754175, 'loss_val': 0.01895716000930388, 'psi': 0.9985254618455308}-{'f1_val': 0.997844401637113, 'auprc': 0.999232924536323, 'loss_val': 0.017981313257842017, 'psi': 0.998399810796797}
[S14] not sending this round → trigger blocked (psi=0.999)
[S15] START round=94 head_norm_before_train=2.255610 cos_to_last_merge=0.9803 (last merge round=40)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9093748942537687, 'auprc': 0.9978120996095827, 'loss_val': 0.22522560962028962, 'psi': 0.9447497763960944}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978205567788537, 'loss_val': 0.21332729141919646, 'psi': 0.9450873464191059}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=1.877965 cos_to_last_merge=0.9790 (last merge round=35)
[S16] round=94 local utility u=0.001868 metrics={'f1_val': 0.9928167437928861, 'auprc': 0.990878097409398, 'loss_val': 0.03739369513375724, 'psi': 0.9920412852394909}-{'f1_val': 0.9928167437928861, 'auprc': 0.9898231383183249, 'loss_val': 0.03796512908448853, 'psi': 0.9916193016030617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=94 head_norm_before_train=2.274129 cos_to_last_merge=0.9419 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.8332044073669435, 'auprc': 0.9705455919976325, 'loss_val': 0.7029416228296519, 'psi': 0.8881408812192191}-{'f1_val': 0.8702230612843223, 'auprc': 0.9774123275765486, 'loss_val': 0.5345836904256663, 'psi': 0.9130987678012128}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.442873 (no previous merge yet)
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.8168635170605684, 'auprc': 0.9070871626720703, 'loss_val': 0.4356871463207031, 'psi': 0.8529529753051692}-{'f1_val': 0.8289326750798718, 'auprc': 0.9788694867147844, 'loss_val': 0.3843055260848402, 'psi': 0.8889073997338368}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.277447 cos_to_last_merge=0.9590 (last merge round=42)
[S3] round=95 local utility u=0.028942 metrics={'f1_val': 0.907280656341188, 'auprc': 0.9984438470952001, 'loss_val': 0.161574419915139, 'psi': 0.9437459326427928}-{'f1_val': 0.8996153340854415, 'auprc': 0.9984882675704344, 'loss_val': 0.17359991580714404, 'psi': 0.9391645074794386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=95 head_norm_before_train=1.969807 cos_to_last_merge=0.9542 (last merge round=36)
[S4] round=95 local utility u=0.020513 metrics={'f1_val': 0.9434340106417962, 'auprc': 0.9322187583126447, 'loss_val': 0.35111106389549823, 'psi': 0.9389479097101356}-{'f1_val': 0.9408442453859699, 'auprc': 0.924740786076859, 'loss_val': 0.3541646810352885, 'psi': 0.9344028616623254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=95 head_norm_before_train=1.825543 cos_to_last_merge=0.9509 (last merge round=42)
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9994092974701222, 'loss_val': 0.0429456771614429, 'psi': 0.9982688923536842}-{'f1_val': 0.9970695586110643, 'auprc': 0.999231748949027, 'loss_val': 0.0369159860199979, 'psi': 0.9979344347462494}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=95 head_norm_before_train=2.653905 (no previous merge yet)
[S6] round=95 local utility u=1.000000 metrics={'f1_val': 0.9582442384423832, 'auprc': 0.9631457826571707, 'loss_val': 0.18063941187438434, 'psi': 0.9602048561282982}-{'f1_val': 0.6581979237525306, 'auprc': 0.7038013005041471, 'loss_val': 1.5993106098323535, 'psi': 0.6764392744531772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S7] START round=95 head_norm_before_train=2.113187 cos_to_last_merge=0.9955 (last merge round=42)
[S7] round=95 local utility u=0.470769 metrics={'f1_val': 0.6473154313133648, 'auprc': 0.8069511489695598, 'loss_val': 0.5037572648224277, 'psi': 0.7111697183758428}-{'f1_val': 0.580281947821534, 'auprc': 0.7852776575425935, 'loss_val': 0.9780743082470549, 'psi': 0.6622802317099578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=95 head_norm_before_train=2.151529 cos_to_last_merge=0.9825 (last merge round=41)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.8564628540704238, 'auprc': 0.9994137209167531, 'loss_val': 0.3255534934755688, 'psi': 0.9136432008089554}-{'f1_val': 0.9934888194563342, 'auprc': 0.9993750719218519, 'loss_val': 0.024642925361693047, 'psi': 0.9958433204425412}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=1.778122 cos_to_last_merge=0.9745 (last merge round=40)
[S9] round=95 local utility u=0.000864 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9976179444384984, 'loss_val': 0.01887125219565915, 'psi': 0.997308925282685}-{'f1_val': 0.9971029125121428, 'auprc': 0.997084952841185, 'loss_val': 0.01899948688453572, 'psi': 0.9970957286437597}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=95 head_norm_before_train=2.317253 cos_to_last_merge=0.9696 (last merge round=35)
[S10] round=95 local utility u=0.000034 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.997580406120349, 'loss_val': 0.025833475730853532, 'psi': 0.9962260347863778}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975704322512685, 'loss_val': 0.025871468872081263, 'psi': 0.9962220452387456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=95 head_norm_before_train=2.148749 cos_to_last_merge=0.9926 (last merge round=40)
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9998522873341253, 'loss_val': 0.014297610175377168, 'psi': 0.9981336257881795}-{'f1_val': 0.9969878514242156, 'auprc': 0.9998647174690413, 'loss_val': 0.014328922710347776, 'psi': 0.998138597842146}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.788870 cos_to_last_merge=0.9258 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.926
[S13] round=95 local utility u=0.119528 metrics={'f1_val': 0.6673964216629636, 'auprc': 0.6999840952066141, 'loss_val': 1.3092820151086717, 'psi': 0.6804314910804239}-{'f1_val': 0.6409508847097221, 'auprc': 0.6897535190535359, 'loss_val': 1.3589734257217208, 'psi': 0.6604719384472475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=95 head_norm_before_train=2.283830 cos_to_last_merge=0.9663 (last merge round=34)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.966374648115269, 'auprc': 0.9971499591815501, 'loss_val': 0.06304403364831744, 'psi': 0.9786847725417814}-{'f1_val': 0.9980871226256064, 'auprc': 0.9991829706754175, 'loss_val': 0.01895716000930388, 'psi': 0.9985254618455308}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.260130 cos_to_last_merge=0.9801 (last merge round=40)
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.9071353003099576, 'auprc': 0.9978046206460278, 'loss_val': 0.23299012871630062, 'psi': 0.9434030284443856}-{'f1_val': 0.9093748942537687, 'auprc': 0.9978120996095827, 'loss_val': 0.22522560962028962, 'psi': 0.9447497763960944}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=1.881654 cos_to_last_merge=0.9787 (last merge round=35)
[S16] round=95 local utility u=0.004038 metrics={'f1_val': 0.9931836012853241, 'auprc': 0.992232432223934, 'loss_val': 0.035581119043522756, 'psi': 0.992803133660768}-{'f1_val': 0.9928167437928861, 'auprc': 0.990878097409398, 'loss_val': 0.03739369513375724, 'psi': 0.9920412852394909}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=95 head_norm_before_train=2.279451 cos_to_last_merge=0.9415 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=95 local utility u=0.123218 metrics={'f1_val': 0.8519538769564609, 'auprc': 0.981618381687645, 'loss_val': 0.6022209087581046, 'psi': 0.9038196788489345}-{'f1_val': 0.8332044073669435, 'auprc': 0.9705455919976325, 'loss_val': 0.7029416228296519, 'psi': 0.8881408812192191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=96 head_norm_before_train=2.449830 (no previous merge yet)
[S2] round=96 local utility u=0.096080 metrics={'f1_val': 0.8151510216564919, 'auprc': 0.9858875566236733, 'loss_val': 0.4696526700376465, 'psi': 0.8834456356433644}-{'f1_val': 0.8168635170605684, 'auprc': 0.9070871626720703, 'loss_val': 0.4356871463207031, 'psi': 0.8529529753051692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] sending update (kind=head size=1790 to 1 peers)
[S3] START round=96 head_norm_before_train=2.283009 cos_to_last_merge=0.9587 (last merge round=42)
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.7895980213256462, 'auprc': 0.9957344914899502, 'loss_val': 0.3882984215109203, 'psi': 0.8720526093913678}-{'f1_val': 0.907280656341188, 'auprc': 0.9984438470952001, 'loss_val': 0.161574419915139, 'psi': 0.9437459326427928}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=1.974353 cos_to_last_merge=0.9537 (last merge round=36)
[S4] round=96 local utility u=0.006260 metrics={'f1_val': 0.9440642631317616, 'auprc': 0.9341951712369725, 'loss_val': 0.3483022999855156, 'psi': 0.940116626373846}-{'f1_val': 0.9434340106417962, 'auprc': 0.9322187583126447, 'loss_val': 0.35111106389549823, 'psi': 0.9389479097101356}
[S4] not sending this round → trigger blocked (psi=0.940)
[S5] START round=96 head_norm_before_train=1.833443 cos_to_last_merge=0.9500 (last merge round=42)
[S5] ⚠️ Model drifted since last merge! cos=0.950
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9949764250504529, 'loss_val': 0.03686922000156421, 'psi': 0.9960117511072557}-{'f1_val': 0.9975086222760589, 'auprc': 0.9994092974701222, 'loss_val': 0.0429456771614429, 'psi': 0.9982688923536842}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=2.655209 (no previous merge yet)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.960414223204695, 'auprc': 0.9471745623004924, 'loss_val': 0.15830423255486775, 'psi': 0.955118358843014}-{'f1_val': 0.9582442384423832, 'auprc': 0.9631457826571707, 'loss_val': 0.18063941187438434, 'psi': 0.9602048561282982}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=2.116160 cos_to_last_merge=0.9955 (last merge round=42)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.5709021099830383, 'auprc': 0.7887972428721164, 'loss_val': 0.7612338625787636, 'psi': 0.6580601631386696}-{'f1_val': 0.6473154313133648, 'auprc': 0.8069511489695598, 'loss_val': 0.5037572648224277, 'psi': 0.7111697183758428}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.159212 cos_to_last_merge=0.9822 (last merge round=41)
[S8] round=96 local utility u=0.508684 metrics={'f1_val': 0.9811983708069963, 'auprc': 0.9994144843673174, 'loss_val': 0.056600684359105556, 'psi': 0.9884848162311248}-{'f1_val': 0.8564628540704238, 'auprc': 0.9994137209167531, 'loss_val': 0.3255534934755688, 'psi': 0.9136432008089554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=96 head_norm_before_train=1.782285 cos_to_last_merge=0.9742 (last merge round=40)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9998898572461015, 'loss_val': 0.026611491894129893, 'psi': 0.9960688980890858}-{'f1_val': 0.9971029125121428, 'auprc': 0.9976179444384984, 'loss_val': 0.01887125219565915, 'psi': 0.997308925282685}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.322222 cos_to_last_merge=0.9693 (last merge round=35)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975854240862319, 'loss_val': 0.0258508328840015, 'psi': 0.996228041972731}-{'f1_val': 0.9953231205637304, 'auprc': 0.997580406120349, 'loss_val': 0.025833475730853532, 'psi': 0.9962260347863778}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.151772 cos_to_last_merge=0.9924 (last merge round=40)
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9994945520767784, 'loss_val': 0.015171941110117014, 'psi': 0.9979905316852408}-{'f1_val': 0.9969878514242156, 'auprc': 0.9998522873341253, 'loss_val': 0.014297610175377168, 'psi': 0.9981336257881795}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=1.800580 cos_to_last_merge=0.9249 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6052112308221231, 'auprc': 0.6441263829188294, 'loss_val': 1.5837247693377547, 'psi': 0.6207772916608056}-{'f1_val': 0.6673964216629636, 'auprc': 0.6999840952066141, 'loss_val': 1.3092820151086717, 'psi': 0.6804314910804239}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.286583 cos_to_last_merge=0.9660 (last merge round=34)
[S14] round=96 local utility u=0.110184 metrics={'f1_val': 0.9965992529308234, 'auprc': 0.9971593001670217, 'loss_val': 0.024050918955553967, 'psi': 0.9968232718253027}-{'f1_val': 0.966374648115269, 'auprc': 0.9971499591815501, 'loss_val': 0.06304403364831744, 'psi': 0.9786847725417814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=96 head_norm_before_train=2.264561 cos_to_last_merge=0.9799 (last merge round=40)
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.906572453969457, 'auprc': 0.997784898987444, 'loss_val': 0.24034334740009122, 'psi': 0.9430574319766518}-{'f1_val': 0.9071353003099576, 'auprc': 0.9978046206460278, 'loss_val': 0.23299012871630062, 'psi': 0.9434030284443856}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=1.884111 cos_to_last_merge=0.9784 (last merge round=35)
[S16] round=96 local utility u=0.002887 metrics={'f1_val': 0.9936233538143384, 'auprc': 0.9931756272880778, 'loss_val': 0.03527610966951826, 'psi': 0.9934442632038342}-{'f1_val': 0.9931836012853241, 'auprc': 0.992232432223934, 'loss_val': 0.035581119043522756, 'psi': 0.992803133660768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=96 head_norm_before_train=2.285048 cos_to_last_merge=0.9411 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.8046205337914671, 'auprc': 0.9598631324947844, 'loss_val': 0.8810564944942433, 'psi': 0.8667175732727941}-{'f1_val': 0.8519538769564609, 'auprc': 0.981618381687645, 'loss_val': 0.6022209087581046, 'psi': 0.9038196788489345}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=2.461843 (no previous merge yet)
[S2] round=97 local utility u=0.029841 metrics={'f1_val': 0.8247632305325244, 'auprc': 0.9901617806765327, 'loss_val': 0.48046705232886083, 'psi': 0.8909226505901278}-{'f1_val': 0.8151510216564919, 'auprc': 0.9858875566236733, 'loss_val': 0.4696526700376465, 'psi': 0.8834456356433644}
[S2] not sending this round → trigger blocked (psi=0.891)
[S3] START round=97 head_norm_before_train=2.288603 cos_to_last_merge=0.9583 (last merge round=42)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.7161484827918512, 'auprc': 0.9929660261071981, 'loss_val': 0.539399774895305, 'psi': 0.8268755001179899}-{'f1_val': 0.7895980213256462, 'auprc': 0.9957344914899502, 'loss_val': 0.3882984215109203, 'psi': 0.8720526093913678}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=1.979071 cos_to_last_merge=0.9530 (last merge round=36)
[S4] round=97 local utility u=0.023714 metrics={'f1_val': 0.9478990246195637, 'auprc': 0.9417606665972429, 'loss_val': 0.34657881835860654, 'psi': 0.9454436814106353}-{'f1_val': 0.9440642631317616, 'auprc': 0.9341951712369725, 'loss_val': 0.3483022999855156, 'psi': 0.940116626373846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=97 head_norm_before_train=1.836648 cos_to_last_merge=0.9495 (last merge round=42)
[S5] ⚠️ Model drifted since last merge! cos=0.950
[S5] round=97 local utility u=0.005282 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9992608528310645, 'loss_val': 0.043998412927106656, 'psi': 0.9982095144980611}-{'f1_val': 0.9967019684784577, 'auprc': 0.9949764250504529, 'loss_val': 0.03686922000156421, 'psi': 0.9960117511072557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=97 head_norm_before_train=2.652461 (no previous merge yet)
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.9205798973476829, 'auprc': 0.9573966472072879, 'loss_val': 0.3432364590985619, 'psi': 0.9353065972915249}-{'f1_val': 0.960414223204695, 'auprc': 0.9471745623004924, 'loss_val': 0.15830423255486775, 'psi': 0.955118358843014}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=2.118200 cos_to_last_merge=0.9955 (last merge round=42)
[S7] round=97 local utility u=0.391545 metrics={'f1_val': 0.6364741045885107, 'auprc': 0.8088519650543518, 'loss_val': 0.4317392011361783, 'psi': 0.7054252487748471}-{'f1_val': 0.5709021099830383, 'auprc': 0.7887972428721164, 'loss_val': 0.7612338625787636, 'psi': 0.6580601631386696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=97 head_norm_before_train=2.163349 cos_to_last_merge=0.9818 (last merge round=41)
[S8] round=97 local utility u=0.051626 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9995699121087518, 'loss_val': 0.026828402528411607, 'psi': 0.9958483511079099}-{'f1_val': 0.9811983708069963, 'auprc': 0.9994144843673174, 'loss_val': 0.056600684359105556, 'psi': 0.9884848162311248}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=97 head_norm_before_train=1.785581 cos_to_last_merge=0.9740 (last merge round=40)
[S9] round=97 local utility u=0.003614 metrics={'f1_val': 0.994356655862817, 'auprc': 0.999902705065172, 'loss_val': 0.024433110208888144, 'psi': 0.996575075543759}-{'f1_val': 0.9935215919844088, 'auprc': 0.9998898572461015, 'loss_val': 0.026611491894129893, 'psi': 0.9960688980890858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=97 head_norm_before_train=2.326928 cos_to_last_merge=0.9689 (last merge round=35)
[S10] round=97 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.99757576481551, 'loss_val': 0.025955885082501434, 'psi': 0.9962241782644422}-{'f1_val': 0.9953231205637304, 'auprc': 0.9975854240862319, 'loss_val': 0.0258508328840015, 'psi': 0.996228041972731}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=97 head_norm_before_train=2.155060 cos_to_last_merge=0.9922 (last merge round=40)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.999500720100399, 'loss_val': 0.015669534500116714, 'psi': 0.9979929988946891}-{'f1_val': 0.9969878514242156, 'auprc': 0.9994945520767784, 'loss_val': 0.015171941110117014, 'psi': 0.9979905316852408}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=1.804167 cos_to_last_merge=0.9242 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=97 local utility u=0.815048 metrics={'f1_val': 0.7322188182570878, 'auprc': 0.7832351058972934, 'loss_val': 1.133001210416225, 'psi': 0.75262533331317}-{'f1_val': 0.6052112308221231, 'auprc': 0.6441263829188294, 'loss_val': 1.5837247693377547, 'psi': 0.6207772916608056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=97 head_norm_before_train=2.291772 cos_to_last_merge=0.9659 (last merge round=34)
[S14] round=97 local utility u=0.009899 metrics={'f1_val': 0.997866992298076, 'auprc': 0.9992000574947929, 'loss_val': 0.017981784266137557, 'psi': 0.9984002183767627}-{'f1_val': 0.9965992529308234, 'auprc': 0.9971593001670217, 'loss_val': 0.024050918955553967, 'psi': 0.9968232718253027}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=97 head_norm_before_train=2.268907 cos_to_last_merge=0.9798 (last merge round=40)
[S15] round=97 local utility u=0.019076 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978139162261543, 'loss_val': 0.22243494613741163, 'psi': 0.9450846901980261}-{'f1_val': 0.906572453969457, 'auprc': 0.997784898987444, 'loss_val': 0.24034334740009122, 'psi': 0.9430574319766518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=97 head_norm_before_train=1.887784 cos_to_last_merge=0.9781 (last merge round=35)
[S16] round=97 local utility u=0.001096 metrics={'f1_val': 0.9932071006024433, 'auprc': 0.9948274871952877, 'loss_val': 0.035541299330245066, 'psi': 0.9938552552395811}-{'f1_val': 0.9936233538143384, 'auprc': 0.9931756272880778, 'loss_val': 0.03527610966951826, 'psi': 0.9934442632038342}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=97 head_norm_before_train=2.290399 cos_to_last_merge=0.9405 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=97 local utility u=0.201385 metrics={'f1_val': 0.8322058662002383, 'auprc': 0.9821065995039955, 'loss_val': 0.7105287519346097, 'psi': 0.8921661595217412}-{'f1_val': 0.8046205337914671, 'auprc': 0.9598631324947844, 'loss_val': 0.8810564944942433, 'psi': 0.8667175732727941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=98 head_norm_before_train=2.472091 (no previous merge yet)
[S2] round=98 local utility u=0.030089 metrics={'f1_val': 0.8304871216734115, 'auprc': 0.9877063437459239, 'loss_val': 0.4472651756161866, 'psi': 0.8933748105024164}-{'f1_val': 0.8247632305325244, 'auprc': 0.9901617806765327, 'loss_val': 0.48046705232886083, 'psi': 0.8909226505901278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=98 head_norm_before_train=2.294386 cos_to_last_merge=0.9580 (last merge round=42)
[S3] round=98 local utility u=1.000000 metrics={'f1_val': 0.9908356078697437, 'auprc': 0.9990787525047429, 'loss_val': 0.024488181800780516, 'psi': 0.9941328657237434}-{'f1_val': 0.7161484827918512, 'auprc': 0.9929660261071981, 'loss_val': 0.539399774895305, 'psi': 0.8268755001179899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=98 head_norm_before_train=1.983480 cos_to_last_merge=0.9523 (last merge round=36)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9434153153556286, 'auprc': 0.9319586776580446, 'loss_val': 0.3458271608864605, 'psi': 0.938832660276595}-{'f1_val': 0.9478990246195637, 'auprc': 0.9417606665972429, 'loss_val': 0.34657881835860654, 'psi': 0.9454436814106353}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=1.842882 cos_to_last_merge=0.9488 (last merge round=42)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9836607510984089, 'auprc': 0.9939770011975575, 'loss_val': 0.06534806775239847, 'psi': 0.9877872511380683}-{'f1_val': 0.9975086222760589, 'auprc': 0.9992608528310645, 'loss_val': 0.043998412927106656, 'psi': 0.9982095144980611}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.654113 (no previous merge yet)
[S6] round=98 local utility u=0.309348 metrics={'f1_val': 0.9731612073725971, 'auprc': 0.9749498604670189, 'loss_val': 0.09268815398514932, 'psi': 0.9738766686103658}-{'f1_val': 0.9205798973476829, 'auprc': 0.9573966472072879, 'loss_val': 0.3432364590985619, 'psi': 0.9353065972915249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=98 head_norm_before_train=2.120439 cos_to_last_merge=0.9954 (last merge round=42)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6185915170158849, 'auprc': 0.7985936463918714, 'loss_val': 0.5573447902929111, 'psi': 0.6905923687662794}-{'f1_val': 0.6364741045885107, 'auprc': 0.8088519650543518, 'loss_val': 0.4317392011361783, 'psi': 0.7054252487748471}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.168441 cos_to_last_merge=0.9814 (last merge round=41)
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9602347060315902, 'auprc': 0.9993123092046191, 'loss_val': 0.09387424939376389, 'psi': 0.9758657473008018}-{'f1_val': 0.9933673104406822, 'auprc': 0.9995699121087518, 'loss_val': 0.026828402528411607, 'psi': 0.9958483511079099}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=1.789862 cos_to_last_merge=0.9737 (last merge round=40)
[S9] round=98 local utility u=0.011136 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999845287189498, 'loss_val': 0.01846653775530561, 'psi': 0.9981998623830849}-{'f1_val': 0.994356655862817, 'auprc': 0.999902705065172, 'loss_val': 0.024433110208888144, 'psi': 0.996575075543759}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=98 head_norm_before_train=2.328751 cos_to_last_merge=0.9688 (last merge round=35)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.997554757002252, 'loss_val': 0.026023308293054524, 'psi': 0.996215775139139}-{'f1_val': 0.9953231205637304, 'auprc': 0.99757576481551, 'loss_val': 0.025955885082501434, 'psi': 0.9962241782644422}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=2.159329 cos_to_last_merge=0.9922 (last merge round=40)
[S11] round=98 local utility u=0.000501 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9994973301319388, 'loss_val': 0.014656864551905758, 'psi': 0.9979916429073049}-{'f1_val': 0.9969878514242156, 'auprc': 0.999500720100399, 'loss_val': 0.015669534500116714, 'psi': 0.9979929988946891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=98 head_norm_before_train=1.810145 cos_to_last_merge=0.9237 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=98 local utility u=0.240299 metrics={'f1_val': 0.7435762110094052, 'auprc': 0.8866520704164774, 'loss_val': 1.0307983655051822, 'psi': 0.8008065547722341}-{'f1_val': 0.7322188182570878, 'auprc': 0.7832351058972934, 'loss_val': 1.133001210416225, 'psi': 0.75262533331317}
[S13] not sending this round → trigger blocked (psi=0.801)
[S14] START round=98 head_norm_before_train=2.297625 cos_to_last_merge=0.9656 (last merge round=34)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9923747590457558, 'auprc': 0.999142307324445, 'loss_val': 0.03471382944036743, 'psi': 0.9950817783572314}-{'f1_val': 0.997866992298076, 'auprc': 0.9992000574947929, 'loss_val': 0.017981784266137557, 'psi': 0.9984002183767627}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.273339 cos_to_last_merge=0.9796 (last merge round=40)
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9978121657079719, 'loss_val': 0.22279051713315356, 'psi': 0.945083989990753}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978139162261543, 'loss_val': 0.22243494613741163, 'psi': 0.9450846901980261}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=1.891979 cos_to_last_merge=0.9779 (last merge round=35)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9934034397978553, 'auprc': 0.9929544910146404, 'loss_val': 0.03520860568298174, 'psi': 0.9932238602845693}-{'f1_val': 0.9932071006024433, 'auprc': 0.9948274871952877, 'loss_val': 0.035541299330245066, 'psi': 0.9938552552395811}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.295792 cos_to_last_merge=0.9400 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.940
[S17] round=98 local utility u=0.145690 metrics={'f1_val': 0.8562888914249962, 'auprc': 0.9856583914056171, 'loss_val': 0.5743023309874524, 'psi': 0.9080366914172445}-{'f1_val': 0.8322058662002383, 'auprc': 0.9821065995039955, 'loss_val': 0.7105287519346097, 'psi': 0.8921661595217412}
[S17] not sending this round → trigger blocked (psi=0.908)
[S2] START round=99 head_norm_before_train=2.475319 (no previous merge yet)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.824155521996455, 'auprc': 0.9721143588306127, 'loss_val': 0.45132024733286275, 'psi': 0.883339056730118}-{'f1_val': 0.8304871216734115, 'auprc': 0.9877063437459239, 'loss_val': 0.4472651756161866, 'psi': 0.8933748105024164}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.883 u=0.0000 p_local=0.0707 f1=0.824 auprc=0.972 bytes=71905
[S3] START round=99 head_norm_before_train=2.300355 cos_to_last_merge=0.9576 (last merge round=42)
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9970921325456971, 'loss_val': 0.1371264336498221, 'psi': 0.9754343054979805}-{'f1_val': 0.9908356078697437, 'auprc': 0.9990787525047429, 'loss_val': 0.024488181800780516, 'psi': 0.9941328657237434}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.975 u=0.0000 p_local=0.1987 f1=0.961 auprc=0.997 bytes=72005
[S4] START round=99 head_norm_before_train=1.989882 cos_to_last_merge=0.9519 (last merge round=36)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9405833839053375, 'auprc': 0.9234386454567651, 'loss_val': 0.3347168772079333, 'psi': 0.9337254885259085}-{'f1_val': 0.9434153153556286, 'auprc': 0.9319586776580446, 'loss_val': 0.3458271608864605, 'psi': 0.938832660276595}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.934 u=0.0000 p_local=0.0101 f1=0.941 auprc=0.923 bytes=70187
[S5] START round=99 head_norm_before_train=1.847412 cos_to_last_merge=0.9483 (last merge round=42)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=99 local utility u=0.053798 metrics={'f1_val': 0.9978756509554264, 'auprc': 0.9992950344485625, 'loss_val': 0.058995449817854935, 'psi': 0.9984434043526809}-{'f1_val': 0.9836607510984089, 'auprc': 0.9939770011975575, 'loss_val': 0.06534806775239847, 'psi': 0.9877872511380683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] r=100 psi=0.998 u=0.0538 p_local=0.0290 f1=0.998 auprc=0.999 bytes=77359
[S6] START round=99 head_norm_before_train=2.660100 (no previous merge yet)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.7408704801396061, 'auprc': 0.8177009425848243, 'loss_val': 1.1574738980819894, 'psi': 0.7716026651176934}-{'f1_val': 0.9731612073725971, 'auprc': 0.9749498604670189, 'loss_val': 0.09268815398514932, 'psi': 0.9738766686103658}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.772 u=0.0000 p_local=0.2146 f1=0.741 auprc=0.818 bytes=70036
[S7] START round=99 head_norm_before_train=2.122579 cos_to_last_merge=0.9953 (last merge round=42)
[S7] round=99 local utility u=0.037910 metrics={'f1_val': 0.6304809286529646, 'auprc': 0.8016249018589473, 'loss_val': 0.5619543418899061, 'psi': 0.6989385179353577}-{'f1_val': 0.6185915170158849, 'auprc': 0.7985936463918714, 'loss_val': 0.5573447902929111, 'psi': 0.6905923687662794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] r=100 psi=0.699 u=0.0379 p_local=0.1828 f1=0.630 auprc=0.802 bytes=82830
[S8] START round=99 head_norm_before_train=2.174029 cos_to_last_merge=0.9810 (last merge round=41)
[S8] round=99 local utility u=0.108759 metrics={'f1_val': 0.992959481021298, 'auprc': 0.9851131980156865, 'loss_val': 0.030107891687416486, 'psi': 0.9898209678190535}-{'f1_val': 0.9602347060315902, 'auprc': 0.9993123092046191, 'loss_val': 0.09387424939376389, 'psi': 0.9758657473008018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] r=100 psi=0.990 u=0.1088 p_local=0.1609 f1=0.993 auprc=0.985 bytes=75528
[S9] START round=99 head_norm_before_train=1.794688 cos_to_last_merge=0.9734 (last merge round=40)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9997119453724751, 'loss_val': 0.04140199680778385, 'psi': 0.9934663948658617}-{'f1_val': 0.9971029125121428, 'auprc': 0.999845287189498, 'loss_val': 0.01846653775530561, 'psi': 0.9981998623830849}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.993 u=0.0000 p_local=0.0041 f1=0.989 auprc=1.000 bytes=86359
[S10] START round=99 head_norm_before_train=2.331384 cos_to_last_merge=0.9686 (last merge round=35)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9975608145995177, 'loss_val': 0.026044445493347463, 'psi': 0.9962181981780454}-{'f1_val': 0.9953231205637304, 'auprc': 0.997554757002252, 'loss_val': 0.026023308293054524, 'psi': 0.996215775139139}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0000 f1=0.995 auprc=0.998 bytes=70183
[S11] START round=99 head_norm_before_train=2.163838 cos_to_last_merge=0.9921 (last merge round=40)
[S11] round=99 local utility u=0.000737 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.999876293735253, 'loss_val': 0.014320458625260397, 'psi': 0.9981432283486307}-{'f1_val': 0.9969878514242156, 'auprc': 0.9994973301319388, 'loss_val': 0.014656864551905758, 'psi': 0.9979916429073049}
[S11] not sending this round → trigger blocked (psi=0.998)
[S11] r=100 psi=0.998 u=0.0007 p_local=0.0008 f1=0.997 auprc=1.000 bytes=70173
[S13] START round=99 head_norm_before_train=1.816807 cos_to_last_merge=0.9232 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6978465975292693, 'auprc': 0.7542693480472187, 'loss_val': 1.156441520650483, 'psi': 0.7204156977364491}-{'f1_val': 0.7435762110094052, 'auprc': 0.8866520704164774, 'loss_val': 1.0307983655051822, 'psi': 0.8008065547722341}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.720 u=0.0000 p_local=0.1758 f1=0.698 auprc=0.754 bytes=75657
[S14] START round=99 head_norm_before_train=2.302129 cos_to_last_merge=0.9652 (last merge round=34)
[S14] round=99 local utility u=0.026639 metrics={'f1_val': 0.9982556529300721, 'auprc': 0.9992344811343623, 'loss_val': 0.016998449215338243, 'psi': 0.9986471842117882}-{'f1_val': 0.9923747590457558, 'auprc': 0.999142307324445, 'loss_val': 0.03471382944036743, 'psi': 0.9950817783572314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] r=100 psi=0.999 u=0.0266 p_local=0.0301 f1=0.998 auprc=0.999 bytes=86338
[S15] START round=99 head_norm_before_train=2.277673 cos_to_last_merge=0.9794 (last merge round=40)
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.9082574443353278, 'auprc': 0.9978079682765476, 'loss_val': 0.23180730964412116, 'psi': 0.9440776539118159}-{'f1_val': 0.9099318728459405, 'auprc': 0.9978121657079719, 'loss_val': 0.22279051713315356, 'psi': 0.945083989990753}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.944 u=0.0000 p_local=0.0037 f1=0.908 auprc=0.998 bytes=73587
[S16] START round=99 head_norm_before_train=1.895477 cos_to_last_merge=0.9777 (last merge round=35)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9928167437928861, 'auprc': 0.991873690639026, 'loss_val': 0.036535455046171415, 'psi': 0.992439522531342}-{'f1_val': 0.9934034397978553, 'auprc': 0.9929544910146404, 'loss_val': 0.03520860568298174, 'psi': 0.9932238602845693}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.992 u=0.0000 p_local=0.0098 f1=0.993 auprc=0.992 bytes=61113
[S17] START round=99 head_norm_before_train=2.299661 cos_to_last_merge=0.9395 (last merge round=36)
[S17] ⚠️ Model drifted since last merge! cos=0.939
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.8362142138772948, 'auprc': 0.9877330529060088, 'loss_val': 0.6856957418986167, 'psi': 0.8968217494887804}-{'f1_val': 0.8562888914249962, 'auprc': 0.9856583914056171, 'loss_val': 0.5743023309874524, 'psi': 0.9080366914172445}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.897 u=0.0000 p_local=0.0943 f1=0.836 auprc=0.988 bytes=70235
[runner] rounds complete.
[runner] all agents stopped.
