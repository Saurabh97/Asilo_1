[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:33903
[S3] → join 127.0.0.1:33902
[S4] → join 127.0.0.1:33902
[S5] → join 127.0.0.1:33902
[S6] → join 127.0.0.1:33902
[S7] → join 127.0.0.1:33902
[S8] → join 127.0.0.1:33902
[S9] → join 127.0.0.1:33902
[S10] → join 127.0.0.1:33902
[S11] → join 127.0.0.1:33902
[S13] → join 127.0.0.1:33902
[S14] → join 127.0.0.1:33902
[S15] → join 127.0.0.1:33902
[S16] → join 127.0.0.1:33902
[S17] → join 127.0.0.1:33902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.163031 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.131108 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.140903 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.191156 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.176208 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.143037 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.170279 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.168895 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.218596 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.143057 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.210506 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.190310 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.167794 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.176586 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.162739 (no previous merge yet)
[S9]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S9
[S3] + discovered S6
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S17
[S3] + discovered S4
[S4] + discovered S3
[S3] + discovered S11
[S4] + discovered S2
[S3] + discovered S14
[S3] + discovered S7
[S3] + discovered S13
[S3] + discovered S10
[S4] + discovered S15
[S4] + discovered S5
[S4] + discovered S7
[S5] + discovered S4
[S5] + discovered S3
[S4] + discovered S11
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S14
[S5] + discovered S2
[S4] + discovered S17
[S6] + discovered S3
[S5] + discovered S16
[S5] + discovered S10
[S5] + discovered S7
[S5] + discovered S11
[S6] + discovered S5
[S5] + discovered S14
[S5] + discovered S9
[S5] + discovered S8
[S5] + discovered S13
[S6] + discovered S2
[S5] + discovered S17
[S6] + discovered S4
[S5] + discovered S15
[S5] + discovered S6
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S14
[S7] + discovered S4
[S7] + discovered S5
[S6] + discovered S16
[S6] + discovered S9
[S7] + discovered S6
[S6] + discovered S7
[S6] + discovered S13
[S7] + discovered S2
[S6] + discovered S17
[S7] + discovered S3
[S8] + discovered S5
[S8] + discovered S6
[S7] + discovered S13
[S8] + discovered S4
[S8] + discovered S3
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S8
[S8] + discovered S2
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S14
[S7] + discovered S16
[S8] + discovered S7
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S6
[S8] + discovered S13
[S8] + discovered S15
[S9] + discovered S3
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S14
[S9] + discovered S7
[S8] + discovered S17
[S9] + discovered S2
[S9] + discovered S8
[S8] + discovered S10
[S8] + discovered S11
[S9] + discovered S16
[S10] + discovered S4
[S10] + discovered S2
[S9] + discovered S10
[S10] + discovered S8
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S6
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S15
[S9] + discovered S13
[S10] + discovered S3
[S11] + discovered S8
[S11] + discovered S4
[S10] + discovered S11
[S10] + discovered S17
[S11] + discovered S6
[S10] + discovered S14
[S10] + discovered S16
[S10] + discovered S13
[S11] + discovered S7
[S10] + discovered S15
[S11] + discovered S2
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S10
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S17
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S6
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S11
[S13] + discovered S10
[S11] + discovered S13
[S11] + discovered S16
[S13] + discovered S17
[S13] + discovered S15
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S5
[S14] + discovered S8
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S9
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S4
[S13] + discovered S14
[S15] + discovered S11
[S15] + discovered S8
[S14] + discovered S17
[S15] + discovered S5
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S3
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S4
[S15] + discovered S10
[S15] + discovered S9
[S15] + discovered S2
[S16] + discovered S10
[S16] + discovered S5
[S15] + discovered S16
[S16] + discovered S15
[S16] + discovered S4
[S16] + discovered S14
[S16] + discovered S2
[S16] + discovered S13
[S15] + discovered S17
[S16] + discovered S8
[S16] + discovered S3
[S16] + discovered S7
[S16] + discovered S9
[S16] + discovered S11
[S16] + discovered S6
[S17] + discovered S14
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S4
[S17] + discovered S5
[S17] + discovered S16
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S7
[S17] + discovered S9
[S17] + discovered S3
[S17] + discovered S13
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=1.000 → S3@127.0.0.1:33903
[S7] ⇄ pheromone p=1.000 → S2@127.0.0.1:33902
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:33904
[S9] ⇄ pheromone p=1.000 → S10@127.0.0.1:33911
[S15] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S11] ⇄ pheromone p=1.000 → S4@127.0.0.1:33904
[S13] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:33908
[S8] ⇄ pheromone p=1.000 → S2@127.0.0.1:33902
[S6] ⇄ pheromone p=1.000 → S5@127.0.0.1:33905
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:33903
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S2] START round=1 head_norm_before_train=1.164731 (no previous merge yet)
[S2] round=1 local utility u=0.295886 metrics={'f1_val': 0.16719667318982387, 'auprc': 0.7375694746250429, 'loss_val': 1.31048014340302, 'psi': 0.3953457937639115}-{'f1_val': 0.10477605118829982, 'auprc': 0.6770415725866591, 'loss_val': 1.3461448177298025, 'psi': 0.33368225974764354}
[S3] START round=1 head_norm_before_train=1.140438 (no previous merge yet)
[S3] round=1 local utility u=0.157575 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7549815853053495, 'loss_val': 1.3043529222289714, 'psi': 0.3858966734906041}-{'f1_val': 0.13984006561410703, 'auprc': 0.6601634721849623, 'loss_val': 1.3350477639508018, 'psi': 0.34796942824244914}
[S4] START round=1 head_norm_before_train=1.146883 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7708897588018859, 'loss_val': 1.3130134148748018, 'psi': 0.39249188085786485}-{'f1_val': 0.6744579469624071, 'auprc': 0.7809309404009053, 'loss_val': 1.348116229666653, 'psi': 0.7170471443378064}
[S5] START round=1 head_norm_before_train=1.198569 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7321066420561877, 'loss_val': 1.3128049620915807, 'psi': 0.3781997996796179}-{'f1_val': 0.4174279751372442, 'auprc': 0.7299684143441119, 'loss_val': 1.3501320997451112, 'psi': 0.5424441508199913}
[S6] START round=1 head_norm_before_train=1.177349 (no previous merge yet)
[S6] round=1 local utility u=0.493662 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8984596677107035, 'loss_val': 1.3453894466212024, 'psi': 0.44423963631505065}-{'f1_val': 0.08958476714842854, 'auprc': 0.6848926030399285, 'loss_val': 1.3809640905130824, 'psi': 0.32770790150502854}
[S7] START round=1 head_norm_before_train=1.157418 (no previous merge yet)
[S7] round=1 local utility u=0.016322 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7791557562230064, 'loss_val': 1.2994639897923452, 'psi': 0.39689639612665756}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774908776708325, 'loss_val': 1.32711402427425, 'psi': 0.396230444705788}
[S8] START round=1 head_norm_before_train=1.176469 (no previous merge yet)
[S8] round=1 local utility u=0.377406 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6638595911865887, 'loss_val': 1.328422298524456, 'psi': 0.3495174259104098}-{'f1_val': 0.13995598239295717, 'auprc': 0.4232349280549894, 'loss_val': 1.3613604925007246, 'psi': 0.25326756065777006}
[S9] START round=1 head_norm_before_train=1.174890 (no previous merge yet)
[S9] round=1 local utility u=0.184775 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9500662830232135, 'loss_val': 1.2998910982989944, 'psi': 0.46486528749328304}-{'f1_val': 0.141397957139996, 'auprc': 0.840365839239309, 'loss_val': 1.3403404668208931, 'psi': 0.4209851099797212}
[S10] START round=1 head_norm_before_train=1.219024 (no previous merge yet)
[S10] round=1 local utility u=0.295699 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7993728595088618, 'loss_val': 1.3337789603707069, 'psi': 0.4029221263285791}-{'f1_val': 0.13862163754172394, 'auprc': 0.6108895874381359, 'loss_val': 1.3597279697935718, 'psi': 0.3275288175002887}
[S11] START round=1 head_norm_before_train=1.141509 (no previous merge yet)
[S11] round=1 local utility u=0.041224 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.604223719970048, 'loss_val': 1.3314364729109893, 'psi': 0.32593769801188555}-{'f1_val': 0.14041368337311058, 'auprc': 0.5880106250093105, 'loss_val': 1.36524509768275, 'psi': 0.31945246002759053}
[S13] START round=1 head_norm_before_train=1.203780 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5918198681777737, 'loss_val': 1.3390601754840925, 'psi': 0.3209594048173413}-{'f1_val': 0.2942263350991561, 'auprc': 0.5932126632281028, 'loss_val': 1.367353600155765, 'psi': 0.4138208663507348}
[S14] START round=1 head_norm_before_train=1.190311 (no previous merge yet)
[S14] round=1 local utility u=0.166122 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.38798164104005356, 'loss_val': 1.3505162496931884, 'psi': 0.23940736814564367}-{'f1_val': 0.14035785288270378, 'auprc': 0.2844150239350678, 'loss_val': 1.372061241438916, 'psi': 0.19798072130364938}
[S15] START round=1 head_norm_before_train=1.179985 (no previous merge yet)
[S15] round=1 local utility u=0.069303 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7409620996608697, 'loss_val': 1.3282188630557141, 'psi': 0.3802250306812829}-{'f1_val': 0.13973365136155833, 'auprc': 0.7044608737861143, 'loss_val': 1.3573208720390113, 'psi': 0.36562454033138075}
[S16] START round=1 head_norm_before_train=1.181850 (no previous merge yet)
[S16] round=1 local utility u=0.064352 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.766663821093771, 'loss_val': 1.3237163609719538, 'psi': 0.3910479985570303}-{'f1_val': 0.14063745019920318, 'auprc': 0.7349249184011323, 'loss_val': 1.3572038119228056, 'psi': 0.3783524374799748}
[S17] START round=1 head_norm_before_train=1.161315 (no previous merge yet)
[S17] round=1 local utility u=0.185186 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5883949869474566, 'loss_val': 1.3390529432020262, 'psi': 0.3199273727694133}-{'f1_val': 0.14094896331738438, 'auprc': 0.47177367751936444, 'loss_val': 1.3595619581862355, 'psi': 0.27327884899817645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:33905
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S8] → sending delta(kind=head bytes=1786) to S15@127.0.0.1:33915
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:33912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S2] → sending delta(kind=head bytes=1785) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S6] → sending delta(kind=head bytes=1786) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:33914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:33907
[S14] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1786 to 1 peers)
[S3] sending update (kind=head size=1787 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1786 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1785 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1785) from S2
[S15] cosine check vs S2: cos=-0.0389
[S15] DROPPED delta from S2 (cos=-0.0389 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1787) from S15
[S17] cosine check vs S15: cos=-0.0520
[S17] DROPPED delta from S15 (cos=-0.0520 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1786) from S8
[S15] cosine check vs S8: cos=-0.1028
[S15] DROPPED delta from S8 (cos=-0.1028 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1790) from S9
[S3] cosine check vs S9: cos=-0.0835
[S3] DROPPED delta from S9 (cos=-0.0835 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1786) from S6
[S10] cosine check vs S6: cos=-0.0175
[S10] DROPPED delta from S6 (cos=-0.0175 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1787) from S3
[S5] cosine check vs S3: cos=0.0217
[S14] RECEIVED delta(kind=head bytes=1793) from S16
[S14] cosine check vs S16: cos=-0.1040
[S14] DROPPED delta from S16 (cos=-0.1040 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S10
[S2] cosine check vs S10: cos=-0.0566
[S2] DROPPED delta from S10 (cos=-0.0566 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S14
[S8] cosine check vs S14: cos=-0.0356
[S8] DROPPED delta from S14 (cos=-0.0356 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S11
[S6] cosine check vs S11: cos=0.0744
[S11] RECEIVED delta(kind=head bytes=1795) from S7
[S11] cosine check vs S7: cos=0.0546
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S17] → sending delta(kind=head bytes=1787) to S15@127.0.0.1:33915
[S17] sending update (kind=head size=1787 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1787) from S17
[S15] cosine check vs S17: cos=-0.0520
[S15] DROPPED delta from S17 (cos=-0.0520 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.211995
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.306859e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.848908 delta_norm=0.830686
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.151081
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.994360e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.844361 delta_norm=0.799436
[S11] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.185354
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.948493e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.856295 delta_norm=0.794849
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.175608 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7438248004892138, 'loss_val': 1.2723501895708595, 'psi': 0.38259620022882557}-{'f1_val': 0.16719667318982387, 'auprc': 0.7375694746250429, 'loss_val': 1.31048014340302, 'psi': 0.3953457937639115}
[S3] START round=2 head_norm_before_train=1.162942 (no previous merge yet)
[S3] round=2 local utility u=0.196554 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8728778879604027, 'loss_val': 1.2649341581847104, 'psi': 0.4330551945526253}-{'f1_val': 0.13984006561410703, 'auprc': 0.7549815853053495, 'loss_val': 1.3043529222289714, 'psi': 0.3858966734906041}
[S4] START round=2 head_norm_before_train=1.161878 (no previous merge yet)
[S4] round=2 local utility u=0.021446 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7716334480499616, 'loss_val': 1.2723525499544293, 'psi': 0.3927893565570951}-{'f1_val': 0.14022662889518414, 'auprc': 0.7708897588018859, 'loss_val': 1.3130134148748018, 'psi': 0.39249188085786485}
[S5] START round=2 head_norm_before_train=0.848908 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.073223 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7769437747203851, 'loss_val': 1.3008707027027315, 'psi': 0.3961346527452969}-{'f1_val': 0.14226190476190476, 'auprc': 0.7321066420561877, 'loss_val': 1.3128049620915807, 'psi': 0.3781997996796179}
[S6] START round=2 head_norm_before_train=0.856295 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.081619 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.947104698659593, 'loss_val': 1.3280870942424932, 'psi': 0.46369764869460645}-{'f1_val': 0.14142628205128205, 'auprc': 0.8984596677107035, 'loss_val': 1.3453894466212024, 'psi': 0.44423963631505065}
[S7] START round=2 head_norm_before_train=1.174351 (no previous merge yet)
[S7] round=2 local utility u=0.008699 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7770702389900878, 'loss_val': 1.275809766213188, 'psi': 0.3960621892334901}-{'f1_val': 0.14205682272909165, 'auprc': 0.7791557562230064, 'loss_val': 1.2994639897923452, 'psi': 0.39689639612665756}
[S8] START round=2 head_norm_before_train=1.189222 (no previous merge yet)
[S8] round=2 local utility u=0.015559 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6627478271320362, 'loss_val': 1.2939695220641896, 'psi': 0.3490727202885888}-{'f1_val': 0.13995598239295717, 'auprc': 0.6638595911865887, 'loss_val': 1.328422298524456, 'psi': 0.3495174259104098}
[S9] START round=2 head_norm_before_train=1.191537 (no previous merge yet)
[S9] round=2 local utility u=0.072228 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9805999606002951, 'loss_val': 1.247036910553808, 'psi': 0.4770787585241157}-{'f1_val': 0.141397957139996, 'auprc': 0.9500662830232135, 'loss_val': 1.2998910982989944, 'psi': 0.46486528749328304}
[S10] START round=2 head_norm_before_train=1.228354 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7703858225033086, 'loss_val': 1.3065097755277415, 'psi': 0.3913273115263578}-{'f1_val': 0.13862163754172394, 'auprc': 0.7993728595088618, 'loss_val': 1.3337789603707069, 'psi': 0.4029221263285791}
[S11] START round=2 head_norm_before_train=0.844361 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5910616674609408, 'loss_val': 1.3273978031830003, 'psi': 0.32067287700824265}-{'f1_val': 0.14041368337311058, 'auprc': 0.604223719970048, 'loss_val': 1.3314364729109893, 'psi': 0.32593769801188555}
[S13] START round=2 head_norm_before_train=1.205969 (no previous merge yet)
[S13] round=2 local utility u=0.056056 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6185664087793974, 'loss_val': 1.307188167899302, 'psi': 0.3316580210579908}-{'f1_val': 0.1403857625770531, 'auprc': 0.5918198681777737, 'loss_val': 1.3390601754840925, 'psi': 0.3209594048173413}
[S14] START round=2 head_norm_before_train=1.201015 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.3792250428783162, 'loss_val': 1.327744351383964, 'psi': 0.23590472888094877}-{'f1_val': 0.14035785288270378, 'auprc': 0.38798164104005356, 'loss_val': 1.3505162496931884, 'psi': 0.23940736814564367}
[S15] START round=2 head_norm_before_train=1.198520 (no previous merge yet)
[S15] round=2 local utility u=0.040954 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7577993174036405, 'loss_val': 1.2968217677149065, 'psi': 0.3869599177783912}-{'f1_val': 0.13973365136155833, 'auprc': 0.7409620996608697, 'loss_val': 1.3282188630557141, 'psi': 0.3802250306812829}
[S16] START round=2 head_norm_before_train=1.197289 (no previous merge yet)
[S16] round=2 local utility u=0.038052 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.780080768235064, 'loss_val': 1.2878626122590577, 'psi': 0.3964147774135476}-{'f1_val': 0.14063745019920318, 'auprc': 0.766663821093771, 'loss_val': 1.3237163609719538, 'psi': 0.3910479985570303}
[S17] START round=2 head_norm_before_train=1.170043 (no previous merge yet)
[S17] round=2 local utility u=0.024764 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5957950919604088, 'loss_val': 1.3117255032253936, 'psi': 0.32288741477459415}-{'f1_val': 0.14094896331738438, 'auprc': 0.5883949869474566, 'loss_val': 1.3390529432020262, 'psi': 0.3199273727694133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:33916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:33910
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:33914
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S5] → sending delta(kind=head bytes=1786) to S16@127.0.0.1:33916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:33910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:33902
[S9] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1786 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1786) from S5
[S16] cosine check vs S5: cos=0.0136
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] cosine check vs S3: cos=-0.0857
[S9] DROPPED delta from S3 (cos=-0.0857 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S4
[S7] cosine check vs S4: cos=-0.0226
[S7] DROPPED delta from S4 (cos=-0.0226 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S13
[S14] cosine check vs S13: cos=0.0652
[S2] RECEIVED delta(kind=head bytes=1790) from S15
[S2] cosine check vs S15: cos=-0.0406
[S2] DROPPED delta from S15 (cos=-0.0406 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=-0.0360
[S17] DROPPED delta from S8 (cos=-0.0360 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S7
[S16] cosine check vs S7: cos=0.0709
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=0.0532
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] cosine check vs S9: cos=0.1214
[S9] RECEIVED delta(kind=head bytes=1795) from S6
[S9] cosine check vs S6: cos=-0.0273
[S9] DROPPED delta from S6 (cos=-0.0273 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:33913
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S17
[S13] cosine check vs S17: cos=0.0273
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.1404 head_norm=1.220069
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.328974e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.889102 delta_norm=0.832897
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.218305
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.971067e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.738084 delta_norm=0.697107
[S16] aggregate: ACCEPT kept=['S5', 'S7'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.216500
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.380909e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.861259 delta_norm=0.838091
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=0.870258
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.295056e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.767222 delta_norm=0.729506
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=1.186783
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.973232e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.900762 delta_norm=0.797323
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.191790 (no previous merge yet)
[S2] round=3 local utility u=0.029532 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7480686798783192, 'loss_val': 1.2260172951312251, 'psi': 0.3842937519844677}-{'f1_val': 0.1417771333885667, 'auprc': 0.7438248004892138, 'loss_val': 1.2723501895708595, 'psi': 0.38259620022882557}
[S3] START round=3 head_norm_before_train=1.193242 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8431976201468344, 'loss_val': 1.2143514859864193, 'psi': 0.421183087427198}-{'f1_val': 0.13984006561410703, 'auprc': 0.8728778879604027, 'loss_val': 1.2649341581847104, 'psi': 0.4330551945526253}
[S4] START round=3 head_norm_before_train=1.184600 (no previous merge yet)
[S4] round=3 local utility u=0.051162 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7905929278432264, 'loss_val': 1.2269060001081789, 'psi': 0.4003731484744011}-{'f1_val': 0.14022662889518414, 'auprc': 0.7716334480499616, 'loss_val': 1.2723525499544293, 'psi': 0.3927893565570951}
[S5] START round=3 head_norm_before_train=0.866489 cos_to_last_merge=0.9967 (last merge round=1)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7551031292336854, 'loss_val': 1.2511138941734228, 'psi': 0.38739839455061703}-{'f1_val': 0.14226190476190476, 'auprc': 0.7769437747203851, 'loss_val': 1.3008707027027315, 'psi': 0.3961346527452969}
[S6] START round=3 head_norm_before_train=0.767222 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8421983319961355, 'loss_val': 1.3167829709576668, 'psi': 0.42173510202922343}-{'f1_val': 0.14142628205128205, 'auprc': 0.947104698659593, 'loss_val': 1.3280870942424932, 'psi': 0.46369764869460645}
[S7] START round=3 head_norm_before_train=1.194875 (no previous merge yet)
[S7] round=3 local utility u=0.009225 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7772059247650077, 'loss_val': 1.257767669096557, 'psi': 0.3961164635434581}-{'f1_val': 0.14205682272909165, 'auprc': 0.7770702389900878, 'loss_val': 1.275809766213188, 'psi': 0.3960621892334901}
[S8] START round=3 head_norm_before_train=1.209247 (no previous merge yet)
[S8] round=3 local utility u=0.070599 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.698111142842764, 'loss_val': 1.2588618578972282, 'psi': 0.3632180465728799}-{'f1_val': 0.13995598239295717, 'auprc': 0.6627478271320362, 'loss_val': 1.2939695220641896, 'psi': 0.3490727202885888}
[S9] START round=3 head_norm_before_train=1.218908 (no previous merge yet)
[S9] round=3 local utility u=0.012185 metrics={'f1_val': 0.141397957139996, 'auprc': 0.963120900078863, 'loss_val': 1.1702296759180901, 'psi': 0.47008713431554283}-{'f1_val': 0.141397957139996, 'auprc': 0.9805999606002951, 'loss_val': 1.247036910553808, 'psi': 0.4770787585241157}
[S10] START round=3 head_norm_before_train=1.246937 (no previous merge yet)
[S10] round=3 local utility u=0.059113 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8003886526936672, 'loss_val': 1.27829216550831, 'psi': 0.40332844360250125}-{'f1_val': 0.13862163754172394, 'auprc': 0.7703858225033086, 'loss_val': 1.3065097755277415, 'psi': 0.3913273115263578}
[S11] START round=3 head_norm_before_train=0.858025 cos_to_last_merge=0.9967 (last merge round=1)
[S11] round=3 local utility u=0.091268 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6407964276249999, 'loss_val': 1.294065166368487, 'psi': 0.3405667810738663}-{'f1_val': 0.14041368337311058, 'auprc': 0.5910616674609408, 'loss_val': 1.3273978031830003, 'psi': 0.32067287700824265}
[S13] START round=3 head_norm_before_train=0.861259 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.107983 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6916676166520094, 'loss_val': 1.3105264139939856, 'psi': 0.3608985042070356}-{'f1_val': 0.1403857625770531, 'auprc': 0.6185664087793974, 'loss_val': 1.307188167899302, 'psi': 0.3316580210579908}
[S14] START round=3 head_norm_before_train=0.889102 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.390109 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6377943544245095, 'loss_val': 1.3232337310162745, 'psi': 0.33933245349942603}-{'f1_val': 0.14035785288270378, 'auprc': 0.3792250428783162, 'loss_val': 1.327744351383964, 'psi': 0.23590472888094877}
[S15] START round=3 head_norm_before_train=1.221925 (no previous merge yet)
[S15] round=3 local utility u=0.032071 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7678027200318844, 'loss_val': 1.2626897927217762, 'psi': 0.3909612788296888}-{'f1_val': 0.13973365136155833, 'auprc': 0.7577993174036405, 'loss_val': 1.2968217677149065, 'psi': 0.3869599177783912}
[S16] START round=3 head_norm_before_train=0.738084 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.020342 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7904106297631104, 'loss_val': 1.278169178713249, 'psi': 0.40054672202476604}-{'f1_val': 0.14063745019920318, 'auprc': 0.780080768235064, 'loss_val': 1.2878626122590577, 'psi': 0.3964147774135476}
[S17] START round=3 head_norm_before_train=0.900762 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.070155 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6405082386638952, 'loss_val': 1.3055549414463068, 'psi': 0.3407726734559887}-{'f1_val': 0.14094896331738438, 'auprc': 0.5957950919604088, 'loss_val': 1.3117255032253936, 'psi': 0.32288741477459415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:33907
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:33902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1790) from S9
[S10] cosine check vs S9: cos=-0.0067
[S10] DROPPED delta from S9 (cos=-0.0067 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] cosine check vs S10: cos=-0.0137
[S6] DROPPED delta from S10 (cos=-0.0137 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1790) from S15
[S8] cosine check vs S15: cos=-0.1046
[S8] DROPPED delta from S15 (cos=-0.1046 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] cosine check vs S14: cos=0.0137
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.0170
[S3] RECEIVED delta(kind=head bytes=1795) from S2
[S3] cosine check vs S2: cos=0.0670
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] cosine check vs S16: cos=0.7089
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=0.0588
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=-0.1000
[S4] DROPPED delta from S11 (cos=-0.1000 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S13
[S6] cosine check vs S13: cos=0.0310
[S2] RECEIVED delta(kind=head bytes=1792) from S8
[S2] cosine check vs S8: cos=-0.0005
[S2] DROPPED delta from S8 (cos=-0.0005 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=-0.0014
[S8] DROPPED delta from S17 (cos=-0.0014 < 0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.785324
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.658542e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.598027 delta_norm=0.365854
[S6] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.229578
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.340907e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.891969 delta_norm=0.834091
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=1.212754
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.517693e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.866406 delta_norm=0.851769
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=1.232252
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.379243e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.2984 head_norm=0.888726 delta_norm=0.837924
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.217197
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.537217e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.763708 delta_norm=0.753722
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.866406 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.010148 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7603476815887853, 'loss_val': 1.2425580192767034, 'psi': 0.3892053526686542}-{'f1_val': 0.1417771333885667, 'auprc': 0.7480686798783192, 'loss_val': 1.2260172951312251, 'psi': 0.3842937519844677}
[S3] START round=4 head_norm_before_train=0.891969 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7979130266208881, 'loss_val': 1.2093032544712479, 'psi': 0.4030692500168195}-{'f1_val': 0.13984006561410703, 'auprc': 0.8431976201468344, 'loss_val': 1.2143514859864193, 'psi': 0.421183087427198}
[S4] START round=4 head_norm_before_train=1.210560 (no previous merge yet)
[S4] round=4 local utility u=0.032379 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7933640541723502, 'loss_val': 1.1704608250519757, 'psi': 0.40148159900605057}-{'f1_val': 0.14022662889518414, 'auprc': 0.7905929278432264, 'loss_val': 1.2269060001081789, 'psi': 0.4003731484744011}
[S5] START round=4 head_norm_before_train=0.892636 cos_to_last_merge=0.9886 (last merge round=1)
[S5] round=4 local utility u=0.042867 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7628878086103341, 'loss_val': 1.1887333198401246, 'psi': 0.3905122663012765}-{'f1_val': 0.14226190476190476, 'auprc': 0.7551031292336854, 'loss_val': 1.2511138941734228, 'psi': 0.38739839455061703}
[S6] START round=4 head_norm_before_train=0.598027 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.017332 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8504024947155889, 'loss_val': 1.3067314976507327, 'psi': 0.4250167671170048}-{'f1_val': 0.14142628205128205, 'auprc': 0.8421983319961355, 'loss_val': 1.3167829709576668, 'psi': 0.42173510202922343}
[S7] START round=4 head_norm_before_train=0.763708 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773500476305664, 'loss_val': 1.2715214577938485, 'psi': 0.39617411268968156}-{'f1_val': 0.14205682272909165, 'auprc': 0.7772059247650077, 'loss_val': 1.257767669096557, 'psi': 0.3961164635434581}
[S8] START round=4 head_norm_before_train=0.888726 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.092640 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7658775074824327, 'loss_val': 1.2768816917175803, 'psi': 0.3903245924287474}-{'f1_val': 0.13995598239295717, 'auprc': 0.698111142842764, 'loss_val': 1.2588618578972282, 'psi': 0.3632180465728799}
[S9] START round=4 head_norm_before_train=1.253862 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.15709967505669065, 'auprc': 0.7551514100594631, 'loss_val': 1.0607935434280962, 'psi': 0.3963203690577996}-{'f1_val': 0.141397957139996, 'auprc': 0.963120900078863, 'loss_val': 1.1702296759180901, 'psi': 0.47008713431554283}
[S10] START round=4 head_norm_before_train=1.268605 (no previous merge yet)
[S10] round=4 local utility u=0.068323 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8338782278267084, 'loss_val': 1.2421146147728053, 'psi': 0.41672427365571774}-{'f1_val': 0.13862163754172394, 'auprc': 0.8003886526936672, 'loss_val': 1.27829216550831, 'psi': 0.40332844360250125}
[S11] START round=4 head_norm_before_train=0.879994 cos_to_last_merge=0.9886 (last merge round=1)
[S11] round=4 local utility u=0.029083 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6427741793272717, 'loss_val': 1.241832818657697, 'psi': 0.341357881754775}-{'f1_val': 0.14041368337311058, 'auprc': 0.6407964276249999, 'loss_val': 1.294065166368487, 'psi': 0.3405667810738663}
[S13] START round=4 head_norm_before_train=0.874988 cos_to_last_merge=0.9971 (last merge round=2)
[S13] round=4 local utility u=0.035800 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7029380877369892, 'loss_val': 1.272738297786314, 'psi': 0.36540669264102754}-{'f1_val': 0.1403857625770531, 'auprc': 0.6916676166520094, 'loss_val': 1.3105264139939856, 'psi': 0.3608985042070356}
[S14] START round=4 head_norm_before_train=0.906159 cos_to_last_merge=0.9976 (last merge round=2)
[S14] round=4 local utility u=0.020900 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6427908262913892, 'loss_val': 1.296422977507534, 'psi': 0.34133104224617794}-{'f1_val': 0.14035785288270378, 'auprc': 0.6377943544245095, 'loss_val': 1.3232337310162745, 'psi': 0.33933245349942603}
[S15] START round=4 head_norm_before_train=1.249535 (no previous merge yet)
[S15] round=4 local utility u=0.036531 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7788271117807041, 'loss_val': 1.2227005758761575, 'psi': 0.39537103552921665}-{'f1_val': 0.13973365136155833, 'auprc': 0.7678027200318844, 'loss_val': 1.2626897927217762, 'psi': 0.3909612788296888}
[S16] START round=4 head_norm_before_train=0.765753 cos_to_last_merge=0.9968 (last merge round=2)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7457671377975325, 'loss_val': 1.241721412014602, 'psi': 0.38268932523853494}-{'f1_val': 0.14063745019920318, 'auprc': 0.7904106297631104, 'loss_val': 1.278169178713249, 'psi': 0.40054672202476604}
[S17] START round=4 head_norm_before_train=0.921053 cos_to_last_merge=0.9969 (last merge round=2)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5944031149079301, 'loss_val': 1.2487332662204502, 'psi': 0.3223306239536027}-{'f1_val': 0.14094896331738438, 'auprc': 0.6405082386638952, 'loss_val': 1.3055549414463068, 'psi': 0.3407726734559887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33903
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:33902
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:33903
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=-0.0523
[S6] DROPPED delta from S10 (cos=-0.0523 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=0.0340
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=-0.1041
[S4] DROPPED delta from S11 (cos=-0.1041 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.5612
[S2] RECEIVED delta(kind=head bytes=1795) from S8
[S2] cosine check vs S8: cos=0.0240
[S8] RECEIVED delta(kind=head bytes=1792) from S4
[S8] cosine check vs S4: cos=0.6989
[S3] RECEIVED delta(kind=head bytes=1790) from S5
[S3] cosine check vs S5: cos=0.5456
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] cosine check vs S6: cos=0.1166
[S7] RECEIVED delta(kind=head bytes=1787) from S14
[S7] cosine check vs S14: cos=0.5984
[S6] RECEIVED delta(kind=head bytes=1792) from S13
[S6] cosine check vs S13: cos=0.4011
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.782353
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.894425e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.766308 delta_norm=0.389443
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=0.923333
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.146732e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1398 head_norm=0.749275 delta_norm=0.314673
[S3] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.923105
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.240639e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.583895 delta_norm=0.524064
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.1418 head_norm=0.887271
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.281013e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.3234 head_norm=0.643362 delta_norm=0.628101
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.615655
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.307909e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.638275 delta_norm=0.430791
[S6] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=0.910826
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.789640e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.1400 head_norm=0.802212 delta_norm=0.478964
[S8] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.643362 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.012873 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7705430389578352, 'loss_val': 1.2473984963733546, 'psi': 0.3932834956162741}-{'f1_val': 0.1417771333885667, 'auprc': 0.7603476815887853, 'loss_val': 1.2425580192767034, 'psi': 0.3892053526686542}
[S3] START round=5 head_norm_before_train=0.749275 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.020888 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7943249090790362, 'loss_val': 1.1567635537783874, 'psi': 0.4016340030000787}-{'f1_val': 0.13984006561410703, 'auprc': 0.7979130266208881, 'loss_val': 1.2093032544712479, 'psi': 0.4030692500168195}
[S4] START round=5 head_norm_before_train=1.238904 (no previous merge yet)
[S4] round=5 local utility u=1.000000 metrics={'f1_val': 0.6804801393645303, 'auprc': 0.7937915927252709, 'loss_val': 1.0613242828067655, 'psi': 0.7258047207088265}-{'f1_val': 0.14022662889518414, 'auprc': 0.7933640541723502, 'loss_val': 1.1704608250519757, 'psi': 0.40148159900605057}
[S5] START round=5 head_norm_before_train=0.583895 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.040780 metrics={'f1_val': 0.14824888240678494, 'auprc': 0.7689602238326467, 'loss_val': 1.1613115426993075, 'psi': 0.3965334189771297}-{'f1_val': 0.14226190476190476, 'auprc': 0.7628878086103341, 'loss_val': 1.1887333198401246, 'psi': 0.3905122663012765}
[S6] START round=5 head_norm_before_train=0.638275 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.017527 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8586359847623442, 'loss_val': 1.296378285699438, 'psi': 0.4283101631357069}-{'f1_val': 0.14142628205128205, 'auprc': 0.8504024947155889, 'loss_val': 1.3067314976507327, 'psi': 0.4250167671170048}
[S7] START round=5 head_norm_before_train=0.766308 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5752853003688801, 'loss_val': 1.2784208249236297, 'psi': 0.31534821378500705}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773500476305664, 'loss_val': 1.2715214577938485, 'psi': 0.39617411268968156}
[S8] START round=5 head_norm_before_train=0.802212 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7360769405541867, 'loss_val': 1.288582004912441, 'psi': 0.378404365657449}-{'f1_val': 0.13995598239295717, 'auprc': 0.7658775074824327, 'loss_val': 1.2768816917175803, 'psi': 0.3903245924287474}
[S9] START round=5 head_norm_before_train=1.293660 (no previous merge yet)
[S9] round=5 local utility u=0.740680 metrics={'f1_val': 0.41677413407000763, 'auprc': 0.6693450368212954, 'loss_val': 0.8800615976086139, 'psi': 0.5178024951705227}-{'f1_val': 0.15709967505669065, 'auprc': 0.7551514100594631, 'loss_val': 1.0607935434280962, 'psi': 0.3963203690577996}
[S10] START round=5 head_norm_before_train=1.293920 (no previous merge yet)
[S10] round=5 local utility u=0.015459 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8259029297485021, 'loss_val': 1.1872705619837172, 'psi': 0.4135341544244352}-{'f1_val': 0.13862163754172394, 'auprc': 0.8338782278267084, 'loss_val': 1.2421146147728053, 'psi': 0.41672427365571774}
[S11] START round=5 head_norm_before_train=0.912897 cos_to_last_merge=0.9768 (last merge round=1)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5959171385590839, 'loss_val': 1.1858933071549793, 'psi': 0.3226150654474999}-{'f1_val': 0.14041368337311058, 'auprc': 0.6427741793272717, 'loss_val': 1.241832818657697, 'psi': 0.341357881754775}
[S13] START round=5 head_norm_before_train=0.898288 cos_to_last_merge=0.9890 (last merge round=2)
[S13] round=5 local utility u=0.024252 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7054305333643075, 'loss_val': 1.2317125331730665, 'psi': 0.36640367089195486}-{'f1_val': 0.1403857625770531, 'auprc': 0.7029380877369892, 'loss_val': 1.272738297786314, 'psi': 0.36540669264102754}
[S14] START round=5 head_norm_before_train=0.930435 cos_to_last_merge=0.9915 (last merge round=2)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5208705617862981, 'loss_val': 1.2801136247678029, 'psi': 0.2925629364441415}-{'f1_val': 0.14035785288270378, 'auprc': 0.6427908262913892, 'loss_val': 1.296422977507534, 'psi': 0.34133104224617794}
[S15] START round=5 head_norm_before_train=1.279613 (no previous merge yet)
[S15] round=5 local utility u=0.064896 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.8001019869101851, 'loss_val': 1.1567330835843415, 'psi': 0.40388098558100904}-{'f1_val': 0.13973365136155833, 'auprc': 0.7788271117807041, 'loss_val': 1.2227005758761575, 'psi': 0.39537103552921665}
[S16] START round=5 head_norm_before_train=0.794720 cos_to_last_merge=0.9888 (last merge round=2)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.524610460530724, 'loss_val': 1.188321295564469, 'psi': 0.2942266543318115}-{'f1_val': 0.14063745019920318, 'auprc': 0.7457671377975325, 'loss_val': 1.241721412014602, 'psi': 0.38268932523853494}
[S17] START round=5 head_norm_before_train=0.948951 cos_to_last_merge=0.9885 (last merge round=2)
[S17] round=5 local utility u=0.014483 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5755708272042099, 'loss_val': 1.1632695997607945, 'psi': 0.3147977088721146}-{'f1_val': 0.14094896331738438, 'auprc': 0.5944031149079301, 'loss_val': 1.2487332662204502, 'psi': 0.3223306239536027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:33909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:33903
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:33905
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S9
[S10] cosine check vs S9: cos=-0.0190
[S10] DROPPED delta from S9 (cos=-0.0190 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S10
[S6] cosine check vs S10: cos=-0.1087
[S6] DROPPED delta from S10 (cos=-0.1087 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.8165
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.4662
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.5634
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=0.4966
[S5] RECEIVED delta(kind=head bytes=1799) from S6
[S5] cosine check vs S6: cos=0.4500
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] cosine check vs S3: cos=0.0672
[S6] RECEIVED delta(kind=head bytes=1796) from S13
[S6] cosine check vs S13: cos=0.8772
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.0245
[S7] ⇄ pheromone p=0.331 → S2@127.0.0.1:33902
[S11] ⇄ pheromone p=0.347 → S4@127.0.0.1:33904
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.816383
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.747392e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1400 head_norm=0.722304 delta_norm=0.274739
[S8] aggregate: ACCEPT kept=['S4', 'S15', 'S17'] (k=3/3) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.384 → S2@127.0.0.1:33902
[S14] ⇄ pheromone p=0.395 → S7@127.0.0.1:33908
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1482 head_norm=0.623823
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.352791e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.544039 delta_norm=0.335279
[S5] aggregate: ROLLBACK (f1_val pre=0.148 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.350 → S3@127.0.0.1:33903
[S9] ⇄ pheromone p=0.500 → S10@127.0.0.1:33911
[S15] ⇄ pheromone p=0.360 → S8@127.0.0.1:33909
[S13] ⇄ pheromone p=0.358 → S6@127.0.0.1:33907
[S10] ⇄ pheromone p=0.373 → S6@127.0.0.1:33907
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.778966
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.777927e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.585212 delta_norm=0.277793
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.365 → S4@127.0.0.1:33904
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.653930
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.355275e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.765428 delta_norm=0.235528
[S6] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.383 → S5@127.0.0.1:33905
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.6805 head_norm=1.274527
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.241786e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.2743 head_norm=0.768875 delta_norm=0.724179
[S4] aggregate: ROLLBACK (f1_val pre=0.680 post=0.274 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.542 → S8@127.0.0.1:33909
[S2] ⇄ pheromone p=0.360 → S3@127.0.0.1:33903
[S16] ⇄ pheromone p=0.339 → S6@127.0.0.1:33907
[S17] ⇄ pheromone p=0.357 → S8@127.0.0.1:33909
[S2] START round=6 head_norm_before_train=0.663950 cos_to_last_merge=0.9935 (last merge round=4)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6112665255497579, 'loss_val': 1.1965535165114232, 'psi': 0.3295728902530432}-{'f1_val': 0.1417771333885667, 'auprc': 0.7705430389578352, 'loss_val': 1.2473984963733546, 'psi': 0.3932834956162741}
[S3] START round=6 head_norm_before_train=0.585212 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.819251 metrics={'f1_val': 0.3997309737816067, 'auprc': 0.7961481304671941, 'loss_val': 1.083077620726314, 'psi': 0.5582978364558416}-{'f1_val': 0.13984006561410703, 'auprc': 0.7943249090790362, 'loss_val': 1.1567635537783874, 'psi': 0.4016340030000787}
[S4] START round=6 head_norm_before_train=0.768875 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.41570511705214863, 'auprc': 0.7982866688593951, 'loss_val': 1.0188805902368483, 'psi': 0.5687377377750473}-{'f1_val': 0.6804801393645303, 'auprc': 0.7937915927252709, 'loss_val': 1.0613242828067655, 'psi': 0.7258047207088265}
[S5] START round=6 head_norm_before_train=0.544039 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.829732 metrics={'f1_val': 0.4167436894719335, 'auprc': 0.7746667076720368, 'loss_val': 1.1299358191472946, 'psi': 0.5599128967519749}-{'f1_val': 0.14824888240678494, 'auprc': 0.7689602238326467, 'loss_val': 1.1613115426993075, 'psi': 0.3965334189771297}
[S6] START round=6 head_norm_before_train=0.765428 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.003031 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.856333906861583, 'loss_val': 1.2834107209306074, 'psi': 0.4273893319754024}-{'f1_val': 0.14142628205128205, 'auprc': 0.8586359847623442, 'loss_val': 1.296378285699438, 'psi': 0.4283101631357069}
[S7] START round=6 head_norm_before_train=0.781999 cos_to_last_merge=0.9981 (last merge round=4)
[S7] round=6 local utility u=0.314928 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774262641389029, 'loss_val': 1.254987866735431, 'psi': 0.39620459929301616}-{'f1_val': 0.14205682272909165, 'auprc': 0.5752853003688801, 'loss_val': 1.2784208249236297, 'psi': 0.31534821378500705}
[S8] START round=6 head_norm_before_train=0.722304 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.019946 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7462636005026271, 'loss_val': 1.27924971084029, 'psi': 0.3824790296368252}-{'f1_val': 0.13995598239295717, 'auprc': 0.7360769405541867, 'loss_val': 1.288582004912441, 'psi': 0.378404365657449}
[S9] START round=6 head_norm_before_train=1.338980 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7018648842933433, 'auprc': 0.9950816035726228, 'loss_val': 0.6316319358447531, 'psi': 0.8191515720050551}-{'f1_val': 0.41677413407000763, 'auprc': 0.6693450368212954, 'loss_val': 0.8800615976086139, 'psi': 0.5178024951705227}
[S10] START round=6 head_norm_before_train=1.323807 (no previous merge yet)
[S10] round=6 local utility u=0.255574 metrics={'f1_val': 0.20619536757301107, 'auprc': 0.8283471430833137, 'loss_val': 1.0888967876119557, 'psi': 0.45505607777713214}-{'f1_val': 0.13862163754172394, 'auprc': 0.8259029297485021, 'loss_val': 1.1872705619837172, 'psi': 0.4135341544244352}
[S11] START round=6 head_norm_before_train=0.955518 cos_to_last_merge=0.9621 (last merge round=1)
[S11] round=6 local utility u=0.075157 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6078432107204155, 'loss_val': 1.071358275876311, 'psi': 0.32738549431203257}-{'f1_val': 0.14041368337311058, 'auprc': 0.5959171385590839, 'loss_val': 1.1858933071549793, 'psi': 0.3226150654474999}
[S13] START round=6 head_norm_before_train=0.924706 cos_to_last_merge=0.9785 (last merge round=2)
[S13] round=6 local utility u=0.049377 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7186934798696294, 'loss_val': 1.1727471027098535, 'psi': 0.3717088494940836}-{'f1_val': 0.1403857625770531, 'auprc': 0.7054305333643075, 'loss_val': 1.2317125331730665, 'psi': 0.36640367089195486}
[S14] START round=6 head_norm_before_train=0.959807 cos_to_last_merge=0.9829 (last merge round=2)
[S14] round=6 local utility u=0.220665 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6498215628329387, 'loss_val': 1.2256364184104909, 'psi': 0.34414333686279774}-{'f1_val': 0.14035785288270378, 'auprc': 0.5208705617862981, 'loss_val': 1.2801136247678029, 'psi': 0.2925629364441415}
[S15] START round=6 head_norm_before_train=1.311938 (no previous merge yet)
[S15] round=6 local utility u=0.892344 metrics={'f1_val': 0.4157993423538048, 'auprc': 0.8001458565744082, 'loss_val': 1.028570521366773, 'psi': 0.5695379480420462}-{'f1_val': 0.13973365136155833, 'auprc': 0.8001019869101851, 'loss_val': 1.1567330835843415, 'psi': 0.40388098558100904}
[S16] START round=6 head_norm_before_train=0.830101 cos_to_last_merge=0.9773 (last merge round=2)
[S16] round=6 local utility u=0.894876 metrics={'f1_val': 0.4166416798666154, 'auprc': 0.5394214608626462, 'loss_val': 1.0990269772125696, 'psi': 0.4657535922650277}-{'f1_val': 0.14063745019920318, 'auprc': 0.524610460530724, 'loss_val': 1.188321295564469, 'psi': 0.2942266543318115}
[S17] START round=6 head_norm_before_train=0.982642 cos_to_last_merge=0.9762 (last merge round=2)
[S17] round=6 local utility u=0.914281 metrics={'f1_val': 0.3899414038056238, 'auprc': 0.6568615091530031, 'loss_val': 1.0725334590638793, 'psi': 0.49670944594457556}-{'f1_val': 0.14094896331738438, 'auprc': 0.5755708272042099, 'loss_val': 1.1632695997607945, 'psi': 0.3147977088721146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:33902
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[S16] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1792) from S7
[S2] cosine check vs S7: cos=0.1695
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.0213
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] cosine check vs S3: cos=0.6098
[S10] RECEIVED delta(kind=head bytes=1796) from S9
[S10] cosine check vs S9: cos=-0.0261
[S10] DROPPED delta from S9 (cos=-0.0261 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=-0.1138
[S6] DROPPED delta from S10 (cos=-0.1138 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S6
[S5] cosine check vs S6: cos=0.7310
[S7] RECEIVED delta(kind=head bytes=1787) from S14
[S7] cosine check vs S14: cos=0.8821
[S6] RECEIVED delta(kind=head bytes=1789) from S16
[S6] cosine check vs S16: cos=0.2508
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=0.4441
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=0.4505
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] cosine check vs S15: cos=0.5798
[S6] RECEIVED delta(kind=head bytes=1795) from S13
[S6] cosine check vs S13: cos=0.9632
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.2604
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4157 head_norm=0.813234
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.390895e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.6833 head_norm=0.596083 delta_norm=0.439090
[S4] aggregate: ACCEPT kept=['S11', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.697784
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.463444e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.531796 delta_norm=0.346344
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.781841
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.096923e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.698285 delta_norm=0.209692
[S6] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.795083
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.347467e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.863438 delta_norm=0.234747
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.4167 head_norm=0.581777
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.668203e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.635356 delta_norm=0.266820
[S5] aggregate: ROLLBACK (f1_val pre=0.417 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.1400 head_norm=0.736974
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.490577e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.1400 head_norm=0.712749 delta_norm=0.349058
[S8] aggregate: ACCEPT kept=['S15', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.3997 head_norm=0.621025
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.175145e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.2447 head_norm=0.511129 delta_norm=0.317515
[S3] aggregate: ROLLBACK (f1_val pre=0.400 post=0.245 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=0.531796 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.236488 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7625709362769806, 'loss_val': 1.1774901956592263, 'psi': 0.3900946545439323}-{'f1_val': 0.1417771333885667, 'auprc': 0.6112665255497579, 'loss_val': 1.1965535165114232, 'psi': 0.3295728902530432}
[S3] START round=7 head_norm_before_train=0.511129 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.023679 metrics={'f1_val': 0.39638969140647473, 'auprc': 0.7961477349798228, 'loss_val': 1.0156708677359898, 'psi': 0.556292908835814}-{'f1_val': 0.3997309737816067, 'auprc': 0.7961481304671941, 'loss_val': 1.083077620726314, 'psi': 0.5582978364558416}
[S4] START round=7 head_norm_before_train=0.596083 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.168865 metrics={'f1_val': 0.4752048227684725, 'auprc': 0.7897070686142723, 'loss_val': 1.0124103017886161, 'psi': 0.6010057211067924}-{'f1_val': 0.41570511705214863, 'auprc': 0.7982866688593951, 'loss_val': 1.0188805902368483, 'psi': 0.5687377377750473}
[S5] START round=7 head_norm_before_train=0.635356 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.019482 metrics={'f1_val': 0.41770847824441854, 'auprc': 0.7771476119288129, 'loss_val': 1.104204232756717, 'psi': 0.5614841317181762}-{'f1_val': 0.4167436894719335, 'auprc': 0.7746667076720368, 'loss_val': 1.1299358191472946, 'psi': 0.5599128967519749}
[S6] START round=7 head_norm_before_train=0.698285 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8427425152898163, 'loss_val': 1.2699063347620771, 'psi': 0.42195277534669573}-{'f1_val': 0.14142628205128205, 'auprc': 0.856333906861583, 'loss_val': 1.2834107209306074, 'psi': 0.4273893319754024}
[S7] START round=7 head_norm_before_train=0.863438 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.000099 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773880204853325, 'loss_val': 1.2546748796974354, 'psi': 0.396189301831588}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774262641389029, 'loss_val': 1.254987866735431, 'psi': 0.39620459929301616}
[S8] START round=7 head_norm_before_train=0.712749 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.668867649151646, 'loss_val': 1.265536702861684, 'psi': 0.3515206490964327}-{'f1_val': 0.13995598239295717, 'auprc': 0.7462636005026271, 'loss_val': 1.27924971084029, 'psi': 0.3824790296368252}
[S9] START round=7 head_norm_before_train=1.390867 (no previous merge yet)
[S9] round=7 local utility u=0.023367 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9630608491789404, 'loss_val': 0.48733479386756756, 'psi': 0.8061932491025132}-{'f1_val': 0.7018648842933433, 'auprc': 0.9950816035726228, 'loss_val': 0.6316319358447531, 'psi': 0.8191515720050551}
[S10] START round=7 head_norm_before_train=1.355874 (no previous merge yet)
[S10] round=7 local utility u=0.806139 metrics={'f1_val': 0.43668397013998095, 'auprc': 0.8560703152977691, 'loss_val': 0.9427196788627243, 'psi': 0.6044385082030963}-{'f1_val': 0.20619536757301107, 'auprc': 0.8283471430833137, 'loss_val': 1.0888967876119557, 'psi': 0.45505607777713214}
[S11] START round=7 head_norm_before_train=0.988051 cos_to_last_merge=0.9482 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.8375308971850005, 'loss_val': 0.9395353181804252, 'psi': 0.5729234915194998}-{'f1_val': 0.14041368337311058, 'auprc': 0.6078432107204155, 'loss_val': 1.071358275876311, 'psi': 0.32738549431203257}
[S13] START round=7 head_norm_before_train=0.952012 cos_to_last_merge=0.9677 (last merge round=2)
[S13] round=7 local utility u=0.889916 metrics={'f1_val': 0.4164711099175653, 'auprc': 0.7326688335164729, 'loss_val': 1.0913535228869877, 'psi': 0.5429501993571284}-{'f1_val': 0.1403857625770531, 'auprc': 0.7186934798696294, 'loss_val': 1.1727471027098535, 'psi': 0.3717088494940836}
[S14] START round=7 head_norm_before_train=0.984432 cos_to_last_merge=0.9760 (last merge round=2)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.3964292957175209, 'auprc': 0.8140087572854426, 'loss_val': 1.1723013629012324, 'psi': 0.5634610803446896}-{'f1_val': 0.14035785288270378, 'auprc': 0.6498215628329387, 'loss_val': 1.2256364184104909, 'psi': 0.34414333686279774}
[S15] START round=7 head_norm_before_train=1.349505 (no previous merge yet)
[S15] round=7 local utility u=0.106674 metrics={'f1_val': 0.4174856868469403, 'auprc': 0.8000171624696791, 'loss_val': 0.8249537336131549, 'psi': 0.5704982770960358}-{'f1_val': 0.4157993423538048, 'auprc': 0.8001458565744082, 'loss_val': 1.028570521366773, 'psi': 0.5695379480420462}
[S16] START round=7 head_norm_before_train=0.868652 cos_to_last_merge=0.9653 (last merge round=2)
[S16] round=7 local utility u=0.025703 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.5266825470846991, 'loss_val': 1.012505346745847, 'psi': 0.460968047703053}-{'f1_val': 0.4166416798666154, 'auprc': 0.5394214608626462, 'loss_val': 1.0990269772125696, 'psi': 0.4657535922650277}
[S17] START round=7 head_norm_before_train=1.019875 cos_to_last_merge=0.9619 (last merge round=2)
[S17] round=7 local utility u=0.381813 metrics={'f1_val': 0.5087517769903996, 'auprc': 0.6472134225193806, 'loss_val': 0.992825109370443, 'psi': 0.564136435201992}-{'f1_val': 0.3899414038056238, 'auprc': 0.6568615091530031, 'loss_val': 1.0725334590638793, 'psi': 0.49670944594457556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S10] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S14] → sending delta(kind=head bytes=1784) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:33909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:33911
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33904
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1784 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1808 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S7
[S2] cosine check vs S7: cos=0.4134
[S8] RECEIVED delta(kind=head bytes=1793) from S15
[S8] cosine check vs S15: cos=0.7535
[S10] RECEIVED delta(kind=head bytes=1797) from S9
[S10] cosine check vs S9: cos=-0.0348
[S10] DROPPED delta from S9 (cos=-0.0348 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1808) from S10
[S6] cosine check vs S10: cos=-0.1032
[S6] DROPPED delta from S10 (cos=-0.1032 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.4476
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.2057
[S7] RECEIVED delta(kind=head bytes=1784) from S14
[S7] cosine check vs S14: cos=0.9650
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=0.4094
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] cosine check vs S16: cos=0.4795
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=0.6143
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=0.6202
[S6] RECEIVED delta(kind=head bytes=1798) from S13
[S6] cosine check vs S13: cos=0.8937
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=0.4845
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.1400 head_norm=0.726445
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.881870e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.1400 head_norm=0.611436 delta_norm=0.188187
[S8] aggregate: ACCEPT kept=['S15', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.712345
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.201688e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.694046 delta_norm=0.120169
[S6] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.1418 head_norm=0.563478
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.073226e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.1418 head_norm=0.606298 delta_norm=0.407323
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3964 head_norm=0.555262
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.085031e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.3965 head_norm=0.469995 delta_norm=0.208503
[S3] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.865743
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.433294e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.929989 delta_norm=0.143329
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4752 head_norm=0.640841
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.836943e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6850 head_norm=0.580746 delta_norm=0.283694
[S4] aggregate: ACCEPT kept=['S11', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.606298 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.008805 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7606884145108471, 'loss_val': 1.1542326164520502, 'psi': 0.38934164583747893}-{'f1_val': 0.1417771333885667, 'auprc': 0.7625709362769806, 'loss_val': 1.1774901956592263, 'psi': 0.3900946545439323}
[S3] START round=8 head_norm_before_train=0.469995 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.769920 metrics={'f1_val': 0.646826521841785, 'auprc': 0.7958607969904401, 'loss_val': 0.977591582066716, 'psi': 0.706440231901247}-{'f1_val': 0.39638969140647473, 'auprc': 0.7961477349798228, 'loss_val': 1.0156708677359898, 'psi': 0.556292908835814}
[S4] START round=8 head_norm_before_train=0.580746 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.402627 metrics={'f1_val': 0.683548652433617, 'auprc': 0.6438935509801501, 'loss_val': 1.0197791622009094, 'psi': 0.6676866118522302}-{'f1_val': 0.4752048227684725, 'auprc': 0.7897070686142723, 'loss_val': 1.0124103017886161, 'psi': 0.6010057211067924}
[S5] START round=8 head_norm_before_train=0.658491 cos_to_last_merge=0.9921 (last merge round=6)
[S5] round=8 local utility u=0.060803 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7725057740047243, 'loss_val': 0.9684250548041544, 'psi': 0.559602620981737}-{'f1_val': 0.41770847824441854, 'auprc': 0.7771476119288129, 'loss_val': 1.104204232756717, 'psi': 0.5614841317181762}
[S6] START round=8 head_norm_before_train=0.694046 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.004350 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8386305089872952, 'loss_val': 1.2488712425761928, 'psi': 0.4203079728256873}-{'f1_val': 0.14142628205128205, 'auprc': 0.8427425152898163, 'loss_val': 1.2699063347620771, 'psi': 0.42195277534669573}
[S7] START round=8 head_norm_before_train=0.929989 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.011267 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7772220586311116, 'loss_val': 1.2316423217134758, 'psi': 0.39612291708989966}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773880204853325, 'loss_val': 1.2546748796974354, 'psi': 0.396189301831588}
[S8] START round=8 head_norm_before_train=0.611436 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.168152 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7696386363365431, 'loss_val': 1.231545119596396, 'psi': 0.3918290439703916}-{'f1_val': 0.13995598239295717, 'auprc': 0.668867649151646, 'loss_val': 1.265536702861684, 'psi': 0.3515206490964327}
[S9] START round=8 head_norm_before_train=1.446522 (no previous merge yet)
[S9] round=8 local utility u=0.115886 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9988254587284334, 'loss_val': 0.36241124982266665, 'psi': 0.8204545820125366}-{'f1_val': 0.7016148490515617, 'auprc': 0.9630608491789404, 'loss_val': 0.48733479386756756, 'psi': 0.8061932491025132}
[S10] START round=8 head_norm_before_train=1.392230 (no previous merge yet)
[S10] round=8 local utility u=0.101709 metrics={'f1_val': 0.436640114979453, 'auprc': 0.8564300685448318, 'loss_val': 0.7401174828551357, 'psi': 0.6045560964056045}-{'f1_val': 0.43668397013998095, 'auprc': 0.8560703152977691, 'loss_val': 0.9427196788627243, 'psi': 0.6044385082030963}
[S11] START round=8 head_norm_before_train=1.028298 cos_to_last_merge=0.9316 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=8 local utility u=0.238571 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9446577338366754, 'loss_val': 0.7839766600446523, 'psi': 0.6157944350903939}-{'f1_val': 0.39651855440916606, 'auprc': 0.8375308971850005, 'loss_val': 0.9395353181804252, 'psi': 0.5729234915194998}
[S13] START round=8 head_norm_before_train=0.980725 cos_to_last_merge=0.9560 (last merge round=2)
[S13] round=8 local utility u=0.068432 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.7341207209084045, 'loss_val': 0.956041918846052, 'psi': 0.5432506081228389}-{'f1_val': 0.4164711099175653, 'auprc': 0.7326688335164729, 'loss_val': 1.0913535228869877, 'psi': 0.5429501993571284}
[S14] START round=8 head_norm_before_train=1.010611 cos_to_last_merge=0.9671 (last merge round=2)
[S14] round=8 local utility u=0.474793 metrics={'f1_val': 0.5196821597121296, 'auprc': 0.83318631133415, 'loss_val': 1.0197658968868204, 'psi': 0.6450838203609377}-{'f1_val': 0.3964292957175209, 'auprc': 0.8140087572854426, 'loss_val': 1.1723013629012324, 'psi': 0.5634610803446896}
[S15] START round=8 head_norm_before_train=1.393598 (no previous merge yet)
[S15] round=8 local utility u=0.046301 metrics={'f1_val': 0.40987522284803757, 'auprc': 0.8126595529715748, 'loss_val': 0.7246154913027951, 'psi': 0.5709889548974525}-{'f1_val': 0.4174856868469403, 'auprc': 0.8000171624696791, 'loss_val': 0.8249537336131549, 'psi': 0.5704982770960358}
[S16] START round=8 head_norm_before_train=0.907994 cos_to_last_merge=0.9534 (last merge round=2)
[S16] round=8 local utility u=0.055107 metrics={'f1_val': 0.3274179797485991, 'auprc': 0.7410786704901167, 'loss_val': 1.00703706073229, 'psi': 0.4928822560452061}-{'f1_val': 0.4171583814486223, 'auprc': 0.5266825470846991, 'loss_val': 1.012505346745847, 'psi': 0.460968047703053}
[S17] START round=8 head_norm_before_train=1.065988 cos_to_last_merge=0.9442 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=8 local utility u=0.078118 metrics={'f1_val': 0.5658599895323753, 'auprc': 0.5384363926364288, 'loss_val': 0.8529075860225453, 'psi': 0.5548905507739967}-{'f1_val': 0.5087517769903996, 'auprc': 0.6472134225193806, 'loss_val': 0.992825109370443, 'psi': 0.564136435201992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33904
[S3] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=0.2886
[S10] RECEIVED delta(kind=head bytes=1803) from S9
[S10] cosine check vs S9: cos=-0.0402
[S10] DROPPED delta from S9 (cos=-0.0402 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=0.3831
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.6881
[S6] RECEIVED delta(kind=head bytes=1792) from S16
[S6] cosine check vs S16: cos=0.5963
[S4] RECEIVED delta(kind=head bytes=1807) from S3
[S4] cosine check vs S3: cos=0.6698
[S2] RECEIVED delta(kind=head bytes=1794) from S7
[S2] cosine check vs S7: cos=0.8486
[S6] RECEIVED delta(kind=head bytes=1801) from S13
[S6] cosine check vs S13: cos=0.8287
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.6941
[S5] RECEIVED delta(kind=head bytes=1800) from S6
[S5] cosine check vs S6: cos=0.9091
[S7] RECEIVED delta(kind=head bytes=1792) from S14
[S7] cosine check vs S14: cos=0.9810
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=-0.0972
[S6] DROPPED delta from S10 (cos=-0.0972 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.5665
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.7047
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.5303
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.1418 head_norm=0.633062
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.710443e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.1418 head_norm=0.598364 delta_norm=0.171044
[S2] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.1400 head_norm=0.627712
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.428555e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.1400 head_norm=0.571425 delta_norm=0.142855
[S8] aggregate: ACCEPT kept=['S4', 'S15', 'S17'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6835 head_norm=0.616069
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.923130e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6736 head_norm=0.611063 delta_norm=0.192313
[S4] aggregate: ROLLBACK (f1_val pre=0.684 post=0.674 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.6468 head_norm=0.520186
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.826551e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.6983 head_norm=0.503964 delta_norm=0.182655
[S3] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.940714
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.115575e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.991306 delta_norm=0.111558
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.1414 head_norm=0.709819
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.425318e-02
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.1414 head_norm=0.713154 delta_norm=0.084253
[S6] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4177 head_norm=0.694764
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.499074e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4177 head_norm=0.686147 delta_norm=0.149907
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.598364 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.865070 metrics={'f1_val': 0.4158821818019893, 'auprc': 0.7706366264409064, 'loss_val': 1.098568209288971, 'psi': 0.5577839596575562}-{'f1_val': 0.1417771333885667, 'auprc': 0.7606884145108471, 'loss_val': 1.1542326164520502, 'psi': 0.38934164583747893}
[S3] START round=9 head_norm_before_train=0.503964 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.42264022473477497, 'auprc': 0.7945325198880847, 'loss_val': 0.9733719031256036, 'psi': 0.5713971427960989}-{'f1_val': 0.646826521841785, 'auprc': 0.7958607969904401, 'loss_val': 0.977591582066716, 'psi': 0.706440231901247}
[S4] START round=9 head_norm_before_train=0.611063 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6713193410963192, 'auprc': 0.6471950185212252, 'loss_val': 0.9959709896237363, 'psi': 0.6616696120662816}-{'f1_val': 0.683548652433617, 'auprc': 0.6438935509801501, 'loss_val': 1.0197791622009094, 'psi': 0.6676866118522302}
[S5] START round=9 head_norm_before_train=0.686147 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.038938 metrics={'f1_val': 0.41754551926731287, 'auprc': 0.7756652384824104, 'loss_val': 0.8992965467611163, 'psi': 0.5607934069533519}-{'f1_val': 0.4176671856330787, 'auprc': 0.7725057740047243, 'loss_val': 0.9684250548041544, 'psi': 0.559602620981737}
[S6] START round=9 head_norm_before_train=0.713154 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.025336 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8410823018494001, 'loss_val': 1.2055536395036706, 'psi': 0.42128868997052926}-{'f1_val': 0.14142628205128205, 'auprc': 0.8386305089872952, 'loss_val': 1.2488712425761928, 'psi': 0.4203079728256873}
[S7] START round=9 head_norm_before_train=0.991306 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.012065 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7772497301666716, 'loss_val': 1.2075949052280228, 'psi': 0.39613398570412367}-{'f1_val': 0.14205682272909165, 'auprc': 0.7772220586311116, 'loss_val': 1.2316423217134758, 'psi': 0.39612291708989966}
[S8] START round=9 head_norm_before_train=0.571425 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.068524 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7939694203966631, 'loss_val': 1.1674891455435779, 'psi': 0.40156135759443956}-{'f1_val': 0.13995598239295717, 'auprc': 0.7696386363365431, 'loss_val': 1.231545119596396, 'psi': 0.3918290439703916}
[S9] START round=9 head_norm_before_train=1.496071 (no previous merge yet)
[S9] round=9 local utility u=0.025987 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9977235255964285, 'loss_val': 0.3056311582416258, 'psi': 0.8198637003631095}-{'f1_val': 0.7015406642019387, 'auprc': 0.9988254587284334, 'loss_val': 0.36241124982266665, 'psi': 0.8204545820125366}
[S10] START round=9 head_norm_before_train=1.443440 (no previous merge yet)
[S10] round=9 local utility u=0.844707 metrics={'f1_val': 0.6870215762492253, 'auprc': 0.8515330542723739, 'loss_val': 0.5383010981493275, 'psi': 0.7528261674584849}-{'f1_val': 0.436640114979453, 'auprc': 0.8564300685448318, 'loss_val': 0.7401174828551357, 'psi': 0.6045560964056045}
[S11] START round=9 head_norm_before_train=1.080790 cos_to_last_merge=0.9119 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=9 local utility u=0.057731 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9419148410528471, 'loss_val': 0.660083267368733, 'psi': 0.6146770690666385}-{'f1_val': 0.39655223592620625, 'auprc': 0.9446577338366754, 'loss_val': 0.7839766600446523, 'psi': 0.6157944350903939}
[S13] START round=9 head_norm_before_train=1.016193 cos_to_last_merge=0.9415 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.37145502080491366, 'auprc': 0.7555332632301663, 'loss_val': 0.8717242809978867, 'psi': 0.5250863177750148}-{'f1_val': 0.4160038662657951, 'auprc': 0.7341207209084045, 'loss_val': 0.956041918846052, 'psi': 0.5432506081228389}
[S14] START round=9 head_norm_before_train=1.051344 cos_to_last_merge=0.9530 (last merge round=2)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.3964619511854436, 'auprc': 0.9673978240239012, 'loss_val': 0.8274716110199213, 'psi': 0.6248363003208266}-{'f1_val': 0.5196821597121296, 'auprc': 0.83318631133415, 'loss_val': 1.0197658968868204, 'psi': 0.6450838203609377}
[S15] START round=9 head_norm_before_train=1.437540 (no previous merge yet)
[S15] round=9 local utility u=0.760903 metrics={'f1_val': 0.5982893695287763, 'auprc': 0.9231542583593659, 'loss_val': 0.6647790758295035, 'psi': 0.7282353250610122}-{'f1_val': 0.40987522284803757, 'auprc': 0.8126595529715748, 'loss_val': 0.7246154913027951, 'psi': 0.5709889548974525}
[S16] START round=9 head_norm_before_train=0.957532 cos_to_last_merge=0.9374 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.937
[S16] round=9 local utility u=0.198332 metrics={'f1_val': 0.38626385700230065, 'auprc': 0.7250011745442793, 'loss_val': 0.9152151860368429, 'psi': 0.521758784019092}-{'f1_val': 0.3274179797485991, 'auprc': 0.7410786704901167, 'loss_val': 1.00703706073229, 'psi': 0.4928822560452061}
[S17] START round=9 head_norm_before_train=1.119969 cos_to_last_merge=0.9242 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.924
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3518407262774941, 'auprc': 0.47818687070149707, 'loss_val': 0.8733010737738345, 'psi': 0.4023791840470953}-{'f1_val': 0.5658599895323753, 'auprc': 0.5384363926364288, 'loss_val': 0.8529075860225453, 'psi': 0.5548905507739967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:33907
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33904
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] cosine check vs S16: cos=0.6489
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.7841
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=-0.0960
[S6] DROPPED delta from S10 (cos=-0.0960 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1807) from S15
[S8] cosine check vs S15: cos=0.6365
[S2] RECEIVED delta(kind=head bytes=1797) from S8
[S2] cosine check vs S8: cos=0.5431
[S5] RECEIVED delta(kind=head bytes=1796) from S6
[S5] cosine check vs S6: cos=0.9450
[S2] RECEIVED delta(kind=head bytes=1788) from S7
[S2] cosine check vs S7: cos=0.8409
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.7623
[S10] RECEIVED delta(kind=head bytes=1803) from S9
[S10] cosine check vs S9: cos=-0.0437
[S10] DROPPED delta from S9 (cos=-0.0437 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=0.6971
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6713 head_norm=0.643554
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.711013e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6737 head_norm=0.841410 delta_norm=0.371101
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4226 head_norm=0.552984
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.473884e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.6634 head_norm=0.543455 delta_norm=0.147388
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4175 head_norm=0.723397
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.206792e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4175 head_norm=0.717032 delta_norm=0.120679
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.4159 head_norm=0.628584
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.236846e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.3653 head_norm=0.618077 delta_norm=0.123685
[S2] aggregate: ROLLBACK (f1_val pre=0.416 post=0.365 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.1414 head_norm=0.730818
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.841588e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.1414 head_norm=0.789892 delta_norm=0.384159
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.1400 head_norm=0.594841
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.944852e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.2031 head_norm=0.955026 delta_norm=0.594485
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.618077 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.035941 metrics={'f1_val': 0.4167275806938775, 'auprc': 0.769752336918982, 'loss_val': 1.0291066881919155, 'psi': 0.5579374831839193}-{'f1_val': 0.4158821818019893, 'auprc': 0.7706366264409064, 'loss_val': 1.098568209288971, 'psi': 0.5577839596575562}
[S3] START round=10 head_norm_before_train=0.543455 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.881052 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.7958245072048395, 'loss_val': 0.8812609483768237, 'psi': 0.7385256529450641}-{'f1_val': 0.42264022473477497, 'auprc': 0.7945325198880847, 'loss_val': 0.9733719031256036, 'psi': 0.5713971427960989}
[S4] START round=10 head_norm_before_train=0.841410 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.019566 metrics={'f1_val': 0.6671497836381091, 'auprc': 0.6556962963522677, 'loss_val': 0.957324505093134, 'psi': 0.6625683887237726}-{'f1_val': 0.6713193410963192, 'auprc': 0.6471950185212252, 'loss_val': 0.9959709896237363, 'psi': 0.6616696120662816}
[S5] START round=10 head_norm_before_train=0.717032 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.41758505646266003, 'auprc': 0.6747895925927125, 'loss_val': 0.8326178722845844, 'psi': 0.5204668709146811}-{'f1_val': 0.41754551926731287, 'auprc': 0.7756652384824104, 'loss_val': 0.8992965467611163, 'psi': 0.5607934069533519}
[S6] START round=10 head_norm_before_train=0.789892 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.034020 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8405289162730817, 'loss_val': 1.1358542475881064, 'psi': 0.4210673357400019}-{'f1_val': 0.14142628205128205, 'auprc': 0.8410823018494001, 'loss_val': 1.2055536395036706, 'psi': 0.42128868997052926}
[S7] START round=10 head_norm_before_train=1.003350 cos_to_last_merge=0.9984 (last merge round=8)
[S7] round=10 local utility u=0.629663 metrics={'f1_val': 0.4166714190153544, 'auprc': 0.6318263538691313, 'loss_val': 1.159686748988229, 'psi': 0.5027333929568651}-{'f1_val': 0.14205682272909165, 'auprc': 0.7772497301666716, 'loss_val': 1.2075949052280228, 'psi': 0.39613398570412367}
[S8] START round=10 head_norm_before_train=0.955026 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.724526 metrics={'f1_val': 0.4162451106207262, 'auprc': 0.6843592062988448, 'loss_val': 1.0473413649215317, 'psi': 0.5234907488919737}-{'f1_val': 0.13995598239295717, 'auprc': 0.7939694203966631, 'loss_val': 1.1674891455435779, 'psi': 0.40156135759443956}
[S9] START round=10 head_norm_before_train=1.535735 (no previous merge yet)
[S9] round=10 local utility u=0.015493 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9970122678072368, 'loss_val': 0.2725114157848539, 'psi': 0.8195791972474328}-{'f1_val': 0.7012904835408967, 'auprc': 0.9977235255964285, 'loss_val': 0.3056311582416258, 'psi': 0.8198637003631095}
[S10] START round=10 head_norm_before_train=1.500763 (no previous merge yet)
[S10] round=10 local utility u=0.267139 metrics={'f1_val': 0.6874725339805354, 'auprc': 0.9842016408830383, 'loss_val': 0.40473505631410883, 'psi': 0.8061641767415366}-{'f1_val': 0.6870215762492253, 'auprc': 0.8515330542723739, 'loss_val': 0.5383010981493275, 'psi': 0.7528261674584849}
[S11] START round=10 head_norm_before_train=1.130138 cos_to_last_merge=0.8918 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.892
[S11] round=10 local utility u=0.349693 metrics={'f1_val': 0.5092694598088294, 'auprc': 0.9190548257866779, 'loss_val': 0.5686230998732267, 'psi': 0.6731836061999688}-{'f1_val': 0.39651855440916606, 'auprc': 0.9419148410528471, 'loss_val': 0.660083267368733, 'psi': 0.6146770690666385}
[S13] START round=10 head_norm_before_train=1.050115 cos_to_last_merge=0.9248 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.925
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.375612268641652, 'auprc': 0.673358148536254, 'loss_val': 0.8314508010072236, 'psi': 0.4947106205994928}-{'f1_val': 0.37145502080491366, 'auprc': 0.7555332632301663, 'loss_val': 0.8717242809978867, 'psi': 0.5250863177750148}
[S14] START round=10 head_norm_before_train=1.102654 cos_to_last_merge=0.9376 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=10 local utility u=0.342934 metrics={'f1_val': 0.46918529353806887, 'auprc': 0.9938468775859187, 'loss_val': 0.6572916155332528, 'psi': 0.6790499271572088}-{'f1_val': 0.3964619511854436, 'auprc': 0.9673978240239012, 'loss_val': 0.8274716110199213, 'psi': 0.6248363003208266}
[S15] START round=10 head_norm_before_train=1.475513 (no previous merge yet)
[S15] round=10 local utility u=0.284554 metrics={'f1_val': 0.6916210224896054, 'auprc': 0.8704298099183457, 'loss_val': 0.49748763736449664, 'psi': 0.7631445374611016}-{'f1_val': 0.5982893695287763, 'auprc': 0.9231542583593659, 'loss_val': 0.6647790758295035, 'psi': 0.7282353250610122}
[S16] START round=10 head_norm_before_train=1.004450 cos_to_last_merge=0.9216 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3282634252429018, 'auprc': 0.7496653692407326, 'loss_val': 0.8361878482977985, 'psi': 0.4968242028420341}-{'f1_val': 0.38626385700230065, 'auprc': 0.7250011745442793, 'loss_val': 0.9152151860368429, 'psi': 0.521758784019092}
[S17] START round=10 head_norm_before_train=1.169267 cos_to_last_merge=0.9069 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.907
[S17] round=10 local utility u=0.007504 metrics={'f1_val': 0.35140046005564834, 'auprc': 0.49854390285758987, 'loss_val': 0.91672325504928, 'psi': 0.41025783717642494}-{'f1_val': 0.3518407262774941, 'auprc': 0.47818687070149707, 'loss_val': 0.8733010737738345, 'psi': 0.4023791840470953}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33907
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33904
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.9588
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.9353
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9747
[S2] RECEIVED delta(kind=head bytes=1791) from S7
[S2] cosine check vs S7: cos=0.8403
[S2] RECEIVED delta(kind=head bytes=1790) from S8
[S2] cosine check vs S8: cos=0.5015
[S8] RECEIVED delta(kind=head bytes=1792) from S4
[S8] cosine check vs S4: cos=0.0637
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] cosine check vs S10: cos=-0.0699
[S6] DROPPED delta from S10 (cos=-0.0699 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S6
[S5] cosine check vs S6: cos=0.8488
[S10] RECEIVED delta(kind=head bytes=1802) from S9
[S10] cosine check vs S9: cos=-0.0436
[S10] DROPPED delta from S9 (cos=-0.0436 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.7530
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.3569
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.1772
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4176 head_norm=0.753643
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.169850e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4175 head_norm=0.752447 delta_norm=0.216985
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.199 → S3@127.0.0.1:33903
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.4167 head_norm=0.653363
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.977762e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.4165 head_norm=0.690345 delta_norm=0.197776
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.289 → S3@127.0.0.1:33903
[S13] ⇄ pheromone p=0.221 → S6@127.0.0.1:33907
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4167 head_norm=1.011990
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.411724e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4167 head_norm=1.076689 delta_norm=0.141172
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.264 → S2@127.0.0.1:33902
[S16] ⇄ pheromone p=0.226 → S6@127.0.0.1:33907
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6671 head_norm=0.860545
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.744395e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6668 head_norm=0.773230 delta_norm=0.174439
[S4] aggregate: ACCEPT kept=['S11', 'S3'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.250 → S8@127.0.0.1:33909
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.4162 head_norm=0.974494
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.595094e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.4162 head_norm=0.748285 delta_norm=0.359509
[S8] aggregate: ACCEPT kept=['S15', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.305 → S2@127.0.0.1:33902
[S15] ⇄ pheromone p=0.387 → S8@127.0.0.1:33909
[S6] ⇄ pheromone p=0.137 → S5@127.0.0.1:33905
[S10] ⇄ pheromone p=0.427 → S6@127.0.0.1:33907
[S14] ⇄ pheromone p=0.379 → S7@127.0.0.1:33908
[S11] ⇄ pheromone p=0.332 → S4@127.0.0.1:33904
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7003 head_norm=0.591507
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.206296e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7003 head_norm=0.582842 delta_norm=0.220630
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.464 → S4@127.0.0.1:33904
[S9] ⇄ pheromone p=0.270 → S10@127.0.0.1:33911
[S17] ⇄ pheromone p=0.243 → S8@127.0.0.1:33909
[S2] START round=11 head_norm_before_train=0.690345 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.524428 metrics={'f1_val': 0.6034155307682446, 'auprc': 0.7210028580268144, 'loss_val': 0.9541300981376966, 'psi': 0.6504504616716725}-{'f1_val': 0.4167275806938775, 'auprc': 0.769752336918982, 'loss_val': 1.0291066881919155, 'psi': 0.5579374831839193}
[S3] START round=11 head_norm_before_train=0.582842 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.011592 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.7961321519620127, 'loss_val': 0.8620321541293069, 'psi': 0.7389519018000915}-{'f1_val': 0.7003264167718803, 'auprc': 0.7958245072048395, 'loss_val': 0.8812609483768237, 'psi': 0.7385256529450641}
[S4] START round=11 head_norm_before_train=0.773230 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.385240715561281, 'auprc': 0.6717486264169998, 'loss_val': 0.9028220046096443, 'psi': 0.4998438799035685}-{'f1_val': 0.6671497836381091, 'auprc': 0.6556962963522677, 'loss_val': 0.957324505093134, 'psi': 0.6625683887237726}
[S5] START round=11 head_norm_before_train=0.752447 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=1.000000 metrics={'f1_val': 0.6623491848586378, 'auprc': 0.8582700888546416, 'loss_val': 0.7161093735069669, 'psi': 0.7407175464570394}-{'f1_val': 0.41758505646266003, 'auprc': 0.6747895925927125, 'loss_val': 0.8326178722845844, 'psi': 0.5204668709146811}
[S6] START round=11 head_norm_before_train=0.811505 cos_to_last_merge=0.9964 (last merge round=9)
[S6] round=11 local utility u=0.908972 metrics={'f1_val': 0.4156481186360783, 'auprc': 0.8438461256758074, 'loss_val': 0.9731929120343641, 'psi': 0.5869273214519699}-{'f1_val': 0.14142628205128205, 'auprc': 0.8405289162730817, 'loss_val': 1.1358542475881064, 'psi': 0.4210673357400019}
[S7] START round=11 head_norm_before_train=1.076689 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.249904 metrics={'f1_val': 0.41626420531236646, 'auprc': 0.7762841927570837, 'loss_val': 1.0908084944625294, 'psi': 0.5602722002902534}-{'f1_val': 0.4166714190153544, 'auprc': 0.6318263538691313, 'loss_val': 1.159686748988229, 'psi': 0.5027333929568651}
[S8] START round=11 head_norm_before_train=0.748285 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.703255 metrics={'f1_val': 0.6545715276123867, 'auprc': 0.6611980757545266, 'loss_val': 1.0013074610913943, 'psi': 0.6572221468692426}-{'f1_val': 0.4162451106207262, 'auprc': 0.6843592062988448, 'loss_val': 1.0473413649215317, 'psi': 0.5234907488919737}
[S9] START round=11 head_norm_before_train=1.569572 (no previous merge yet)
[S9] round=11 local utility u=0.022582 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9968722334989893, 'loss_val': 0.22648459983796687, 'psi': 0.8194788418636069}-{'f1_val': 0.7012904835408967, 'auprc': 0.9970122678072368, 'loss_val': 0.2725114157848539, 'psi': 0.8195791972474328}
[S10] START round=11 head_norm_before_train=1.555808 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6928040404962398, 'auprc': 0.8608372682584917, 'loss_val': 0.37709135732940235, 'psi': 0.7600173316011406}-{'f1_val': 0.6874725339805354, 'auprc': 0.9842016408830383, 'loss_val': 0.40473505631410883, 'psi': 0.8061641767415366}
[S11] START round=11 head_norm_before_train=1.184382 cos_to_last_merge=0.8734 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.873
[S11] round=11 local utility u=0.597704 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9089381848270471, 'loss_val': 0.49780279691980056, 'psi': 0.7846306369276976}-{'f1_val': 0.5092694598088294, 'auprc': 0.9190548257866779, 'loss_val': 0.5686230998732267, 'psi': 0.6731836061999688}
[S13] START round=11 head_norm_before_train=1.086486 cos_to_last_merge=0.9061 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.906
[S13] round=11 local utility u=1.000000 metrics={'f1_val': 0.7119057226417528, 'auprc': 0.7621035181548749, 'loss_val': 0.6504434953645425, 'psi': 0.7319848408470015}-{'f1_val': 0.375612268641652, 'auprc': 0.673358148536254, 'loss_val': 0.8314508010072236, 'psi': 0.4947106205994928}
[S14] START round=11 head_norm_before_train=1.155099 cos_to_last_merge=0.9214 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.921
[S14] round=11 local utility u=0.707852 metrics={'f1_val': 0.6793845406306666, 'auprc': 0.9970654859890873, 'loss_val': 0.512438370250069, 'psi': 0.8064569187740349}-{'f1_val': 0.46918529353806887, 'auprc': 0.9938468775859187, 'loss_val': 0.6572916155332528, 'psi': 0.6790499271572088}
[S15] START round=11 head_norm_before_train=1.512141 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6888230621317042, 'auprc': 0.8180748030230653, 'loss_val': 0.4373474459030855, 'psi': 0.7405237584882487}-{'f1_val': 0.6916210224896054, 'auprc': 0.8704298099183457, 'loss_val': 0.49748763736449664, 'psi': 0.7631445374611016}
[S16] START round=11 head_norm_before_train=1.053177 cos_to_last_merge=0.9074 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.907
[S16] round=11 local utility u=0.216026 metrics={'f1_val': 0.39684294735162257, 'auprc': 0.7454079581614171, 'loss_val': 0.8028399070625032, 'psi': 0.5362689516755403}-{'f1_val': 0.3282634252429018, 'auprc': 0.7496653692407326, 'loss_val': 0.8361878482977985, 'psi': 0.4968242028420341}
[S17] START round=11 head_norm_before_train=1.205187 cos_to_last_merge=0.8933 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.893
[S17] round=11 local utility u=0.277803 metrics={'f1_val': 0.3601049421149821, 'auprc': 0.6940259039146599, 'loss_val': 0.9997900497407726, 'psi': 0.49367332683485327}-{'f1_val': 0.35140046005564834, 'auprc': 0.49854390285758987, 'loss_val': 0.91672325504928, 'psi': 0.41025783717642494}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33911
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:33907
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9844
[S5] RECEIVED delta(kind=head bytes=1795) from S6
[S5] cosine check vs S6: cos=0.9535
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.9055
[S10] RECEIVED delta(kind=head bytes=1800) from S9
[S10] cosine check vs S9: cos=-0.0408
[S10] DROPPED delta from S9 (cos=-0.0408 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=0.8541
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] cosine check vs S3: cos=0.4436
[S2] RECEIVED delta(kind=head bytes=1795) from S7
[S2] cosine check vs S7: cos=0.8123
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] cosine check vs S5: cos=0.5828
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=0.6642
[S6] RECEIVED delta(kind=head bytes=1797) from S13
[S6] cosine check vs S13: cos=0.4281
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=0.8888
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.3882
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.3852 head_norm=0.800103
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.395915e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6667 head_norm=0.760959 delta_norm=0.139592
[S4] aggregate: ACCEPT kept=['S11', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.6034 head_norm=0.726474
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.159781e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.6781 head_norm=0.722588 delta_norm=0.115978
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.6546 head_norm=0.770616
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.871434e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.1400 head_norm=0.844950 delta_norm=0.587143
[S8] aggregate: ROLLBACK (f1_val pre=0.655 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7008 head_norm=0.632331
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.614330e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7007 head_norm=0.606425 delta_norm=0.161433
[S3] aggregate: ACCEPT kept=['S2', 'S5'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.4156 head_norm=0.847173
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.872370e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.4154 head_norm=0.809285 delta_norm=0.187237
[S6] aggregate: ACCEPT kept=['S13', 'S16'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.6623 head_norm=0.789645
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.280286e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.6232 head_norm=0.808845 delta_norm=0.128029
[S5] aggregate: ROLLBACK (f1_val pre=0.662 post=0.623 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4163 head_norm=1.093921
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.151960e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4163 head_norm=1.144447 delta_norm=0.115196
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=0.722588 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.328990 metrics={'f1_val': 0.7013719370881049, 'auprc': 0.7148186434725396, 'loss_val': 0.8653354054802364, 'psi': 0.7067506196418788}-{'f1_val': 0.6034155307682446, 'auprc': 0.7210028580268144, 'loss_val': 0.9541300981376966, 'psi': 0.6504504616716725}
[S3] START round=12 head_norm_before_train=0.606425 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.046374 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.7959080168946001, 'loss_val': 0.7677065072667092, 'psi': 0.7387717825570409}-{'f1_val': 0.7008317350254774, 'auprc': 0.7961321519620127, 'loss_val': 0.8620321541293069, 'psi': 0.7389519018000915}
[S4] START round=12 head_norm_before_train=0.760959 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.572324 metrics={'f1_val': 0.5705263199021295, 'auprc': 0.6611281179299642, 'loss_val': 0.8380263646568162, 'psi': 0.6067670391132634}-{'f1_val': 0.385240715561281, 'auprc': 0.6717486264169998, 'loss_val': 0.9028220046096443, 'psi': 0.4998438799035685}
[S5] START round=12 head_norm_before_train=0.808845 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.6090170283548385, 'auprc': 0.8098885761753899, 'loss_val': 0.6653390020310422, 'psi': 0.6893656474830591}-{'f1_val': 0.6623491848586378, 'auprc': 0.8582700888546416, 'loss_val': 0.7161093735069669, 'psi': 0.7407175464570394}
[S6] START round=12 head_norm_before_train=0.809285 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.101066 metrics={'f1_val': 0.4156481186360783, 'auprc': 0.8690824926872983, 'loss_val': 0.8467696640978727, 'psi': 0.5970218682565663}-{'f1_val': 0.4156481186360783, 'auprc': 0.8438461256758074, 'loss_val': 0.9731929120343641, 'psi': 0.5869273214519699}
[S7] START round=12 head_norm_before_train=1.144447 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.324215 metrics={'f1_val': 0.5113496916011729, 'auprc': 0.7761593893870522, 'loss_val': 1.012517617163514, 'psi': 0.6172735707155246}-{'f1_val': 0.41626420531236646, 'auprc': 0.7762841927570837, 'loss_val': 1.0908084944625294, 'psi': 0.5602722002902534}
[S8] START round=12 head_norm_before_train=0.844950 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.4160497462369297, 'auprc': 0.7927477086747796, 'loss_val': 0.9342433631909721, 'psi': 0.5667289312120697}-{'f1_val': 0.6545715276123867, 'auprc': 0.6611980757545266, 'loss_val': 1.0013074610913943, 'psi': 0.6572221468692426}
[S9] START round=12 head_norm_before_train=1.597599 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.4375743204190454, 'auprc': 0.8653723395659353, 'loss_val': 0.8701125327799535, 'psi': 0.6086935280778014}-{'f1_val': 0.7012165807733519, 'auprc': 0.9968722334989893, 'loss_val': 0.22648459983796687, 'psi': 0.8194788418636069}
[S10] START round=12 head_norm_before_train=1.609020 (no previous merge yet)
[S10] round=12 local utility u=0.125969 metrics={'f1_val': 0.6854086748237629, 'auprc': 0.9446405249328853, 'loss_val': 0.33219154894406056, 'psi': 0.7891014148674118}-{'f1_val': 0.6928040404962398, 'auprc': 0.8608372682584917, 'loss_val': 0.37709135732940235, 'psi': 0.7600173316011406}
[S11] START round=12 head_norm_before_train=1.234961 cos_to_last_merge=0.8578 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.858
[S11] round=12 local utility u=0.087162 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9402436473698451, 'loss_val': 0.4173942795820329, 'psi': 0.7971528219448168}-{'f1_val': 0.7017589383281313, 'auprc': 0.9089381848270471, 'loss_val': 0.49780279691980056, 'psi': 0.7846306369276976}
[S13] START round=12 head_norm_before_train=1.129932 cos_to_last_merge=0.8882 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.888
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6232454319073683, 'auprc': 0.8070767964950487, 'loss_val': 0.6352688933612454, 'psi': 0.6967779777424404}-{'f1_val': 0.7119057226417528, 'auprc': 0.7621035181548749, 'loss_val': 0.6504434953645425, 'psi': 0.7319848408470015}
[S14] START round=12 head_norm_before_train=1.203909 cos_to_last_merge=0.9059 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.906
[S14] round=12 local utility u=1.000000 metrics={'f1_val': 0.9972565051713169, 'auprc': 0.9971578212542422, 'loss_val': 0.39004360146214956, 'psi': 0.997217031604487}-{'f1_val': 0.6793845406306666, 'auprc': 0.9970654859890873, 'loss_val': 0.512438370250069, 'psi': 0.8064569187740349}
[S15] START round=12 head_norm_before_train=1.549694 (no previous merge yet)
[S15] round=12 local utility u=0.039347 metrics={'f1_val': 0.6953983153371612, 'auprc': 0.8136995361358883, 'loss_val': 0.38498001336210447, 'psi': 0.7427188036566521}-{'f1_val': 0.6888230621317042, 'auprc': 0.8180748030230653, 'loss_val': 0.4373474459030855, 'psi': 0.7405237584882487}
[S16] START round=12 head_norm_before_train=1.102177 cos_to_last_merge=0.8957 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.896
[S16] round=12 local utility u=0.476704 metrics={'f1_val': 0.5446653835075327, 'auprc': 0.772769412684082, 'loss_val': 0.8184513549146136, 'psi': 0.6359069951781524}-{'f1_val': 0.39684294735162257, 'auprc': 0.7454079581614171, 'loss_val': 0.8028399070625032, 'psi': 0.5362689516755403}
[S17] START round=12 head_norm_before_train=1.234304 cos_to_last_merge=0.8811 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.881
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.34559633040068416, 'auprc': 0.7240327904078463, 'loss_val': 1.0437481890556635, 'psi': 0.496970914403549}-{'f1_val': 0.3601049421149821, 'auprc': 0.6940259039146599, 'loss_val': 0.9997900497407726, 'psi': 0.49367332683485327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33907
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33902
[S10] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] cosine check vs S7: cos=0.8192
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=-0.0826
[S6] DROPPED delta from S10 (cos=-0.0826 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S6
[S5] cosine check vs S6: cos=0.9728
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.5069
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:33908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33903
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.9890
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.8845
[S3] RECEIVED delta(kind=head bytes=1798) from S2
[S3] cosine check vs S2: cos=0.8156
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.7999
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S15
[S8] cosine check vs S15: cos=0.3811
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=0.2505
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.4156 head_norm=0.853683
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.459184e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.4154 head_norm=0.950547 delta_norm=0.345918
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.5113 head_norm=1.161591
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.878712e-02
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.6845 head_norm=1.200732 delta_norm=0.098787
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7007 head_norm=0.658074
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.213432e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7008 head_norm=0.676893 delta_norm=0.221343
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.6090 head_norm=0.851297
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.951306e-02
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.6210 head_norm=0.846663 delta_norm=0.099513
[S5] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7014 head_norm=0.762425
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.462717e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7011 head_norm=0.919450 delta_norm=0.346272
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.4160 head_norm=0.865525
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.620241e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.4161 head_norm=0.749332 delta_norm=0.462024
[S8] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.5705 head_norm=0.795645
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.299147e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6612 head_norm=0.774638 delta_norm=0.129915
[S4] aggregate: ACCEPT kept=['S3', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=0.919450 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.110965 metrics={'f1_val': 0.7011133543505058, 'auprc': 0.7461806408413224, 'loss_val': 0.735939123404924, 'psi': 0.7191402689468325}-{'f1_val': 0.7013719370881049, 'auprc': 0.7148186434725396, 'loss_val': 0.8653354054802364, 'psi': 0.7067506196418788}
[S3] START round=13 head_norm_before_train=0.676893 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.009096 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.8011199712563194, 'loss_val': 0.7660557427136148, 'psi': 0.7409470295178142}-{'f1_val': 0.7006809596653347, 'auprc': 0.7959080168946001, 'loss_val': 0.7677065072667092, 'psi': 0.7387717825570409}
[S4] START round=13 head_norm_before_train=0.774638 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.300324 metrics={'f1_val': 0.6606731175089067, 'auprc': 0.6590432265778722, 'loss_val': 0.7720035898386098, 'psi': 0.6600211611364928}-{'f1_val': 0.5705263199021295, 'auprc': 0.6611281179299642, 'loss_val': 0.8380263646568162, 'psi': 0.6067670391132634}
[S5] START round=13 head_norm_before_train=0.846663 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.144469 metrics={'f1_val': 0.6270581257069614, 'auprc': 0.8561345068478772, 'loss_val': 0.6233851635944446, 'psi': 0.7186886781633277}-{'f1_val': 0.6090170283548385, 'auprc': 0.8098885761753899, 'loss_val': 0.6653390020310422, 'psi': 0.6893656474830591}
[S6] START round=13 head_norm_before_train=0.950547 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.012897 metrics={'f1_val': 0.41745618053540323, 'auprc': 0.8496834771054258, 'loss_val': 0.773627693812649, 'psi': 0.5903470991634123}-{'f1_val': 0.4156481186360783, 'auprc': 0.8690824926872983, 'loss_val': 0.8467696640978727, 'psi': 0.5970218682565663}
[S7] START round=13 head_norm_before_train=1.200732 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.230222 metrics={'f1_val': 0.6482425410991254, 'auprc': 0.6347690728519523, 'loss_val': 0.9492589907763884, 'psi': 0.6428531538002562}-{'f1_val': 0.5113496916011729, 'auprc': 0.7761593893870522, 'loss_val': 1.012517617163514, 'psi': 0.6172735707155246}
[S8] START round=13 head_norm_before_train=0.749332 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.900669 metrics={'f1_val': 0.6993887854089063, 'auprc': 0.7933752157267384, 'loss_val': 0.8348229178681389, 'psi': 0.7369833575360392}-{'f1_val': 0.4160497462369297, 'auprc': 0.7927477086747796, 'loss_val': 0.9342433631909721, 'psi': 0.5667289312120697}
[S9] START round=13 head_norm_before_train=1.626816 (no previous merge yet)
[S9] round=13 local utility u=1.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9969410732897134, 'loss_val': 0.17862154274972983, 'psi': 0.8195063777798965}-{'f1_val': 0.4375743204190454, 'auprc': 0.8653723395659353, 'loss_val': 0.8701125327799535, 'psi': 0.6086935280778014}
[S10] START round=13 head_norm_before_train=1.646829 (no previous merge yet)
[S10] round=13 local utility u=0.183896 metrics={'f1_val': 0.6974347492430856, 'auprc': 0.9980987680204895, 'loss_val': 0.19692989252215795, 'psi': 0.8177003567540471}-{'f1_val': 0.6854086748237629, 'auprc': 0.9446405249328853, 'loss_val': 0.33219154894406056, 'psi': 0.7891014148674118}
[S11] START round=13 head_norm_before_train=1.280167 cos_to_last_merge=0.8462 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.846
[S11] round=13 local utility u=0.102741 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9952113537836196, 'loss_val': 0.3797174449706918, 'psi': 0.8194300345530062}-{'f1_val': 0.7017589383281313, 'auprc': 0.9402436473698451, 'loss_val': 0.4173942795820329, 'psi': 0.7971528219448168}
[S13] START round=13 head_norm_before_train=1.179958 cos_to_last_merge=0.8728 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.873
[S13] round=13 local utility u=0.240171 metrics={'f1_val': 0.7096505197065035, 'auprc': 0.7464383773678066, 'loss_val': 0.49144250971061576, 'psi': 0.7243656627710248}-{'f1_val': 0.6232454319073683, 'auprc': 0.8070767964950487, 'loss_val': 0.6352688933612454, 'psi': 0.6967779777424404}
[S14] START round=13 head_norm_before_train=1.246491 cos_to_last_merge=0.8937 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.894
[S14] round=13 local utility u=0.041544 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9971583109225823, 'loss_val': 0.3109144115976683, 'psi': 0.9976130298515772}-{'f1_val': 0.9972565051713169, 'auprc': 0.9971578212542422, 'loss_val': 0.39004360146214956, 'psi': 0.997217031604487}
[S15] START round=13 head_norm_before_train=1.587521 (no previous merge yet)
[S15] round=13 local utility u=0.331364 metrics={'f1_val': 0.6970583194609055, 'auprc': 0.9882073904388136, 'loss_val': 0.2557351160374645, 'psi': 0.8135179478520687}-{'f1_val': 0.6953983153371612, 'auprc': 0.8136995361358883, 'loss_val': 0.38498001336210447, 'psi': 0.7427188036566521}
[S16] START round=13 head_norm_before_train=1.147878 cos_to_last_merge=0.8852 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.885
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.45068504790930797, 'auprc': 0.7819700326997285, 'loss_val': 0.7387294973708676, 'psi': 0.5831990418254762}-{'f1_val': 0.5446653835075327, 'auprc': 0.772769412684082, 'loss_val': 0.8184513549146136, 'psi': 0.6359069951781524}
[S17] START round=13 head_norm_before_train=1.259558 cos_to_last_merge=0.8714 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.871
[S17] round=13 local utility u=0.292562 metrics={'f1_val': 0.3680156588667227, 'auprc': 0.8382072581105678, 'loss_val': 0.9356631759445375, 'psi': 0.5560922985642608}-{'f1_val': 0.34559633040068416, 'auprc': 0.7240327904078463, 'loss_val': 1.0437481890556635, 'psi': 0.496970914403549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:33905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33904
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[S4] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] cosine check vs S7: cos=0.9507
[S6] RECEIVED delta(kind=head bytes=1804) from S13
[S6] cosine check vs S13: cos=0.3252
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] cosine check vs S10: cos=-0.0676
[S6] DROPPED delta from S10 (cos=-0.0676 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S9
[S10] cosine check vs S9: cos=-0.0373
[S10] DROPPED delta from S9 (cos=-0.0373 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S15
[S8] cosine check vs S15: cos=0.7474
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.5228
[S3] RECEIVED delta(kind=head bytes=1795) from S2
[S3] cosine check vs S2: cos=0.8801
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] cosine check vs S8: cos=0.4496
[S8] RECEIVED delta(kind=head bytes=1790) from S4
[S8] cosine check vs S4: cos=0.4413
[S4] RECEIVED delta(kind=head bytes=1796) from S3
[S4] cosine check vs S3: cos=0.5099
[S4] RECEIVED delta(kind=head bytes=1791) from S11
[S4] cosine check vs S11: cos=0.8791
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9908
[S5] RECEIVED delta(kind=head bytes=1792) from S6
[S5] cosine check vs S6: cos=0.9458
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=0.5318
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.6271 head_norm=0.887949
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.621461e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.5998 head_norm=0.925152 delta_norm=0.162146
[S5] aggregate: ROLLBACK (f1_val pre=0.627 post=0.600 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7008 head_norm=0.721681
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.849409e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7007 head_norm=0.711200 delta_norm=0.184941
[S3] aggregate: ACCEPT kept=['S5', 'S2'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.6482 head_norm=1.214746
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.230720e-02
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.6713 head_norm=1.248378 delta_norm=0.092307
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7011 head_norm=0.957564
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.701489e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7009 head_norm=0.865621 delta_norm=0.170149
[S2] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.4175 head_norm=0.987897
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.474746e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.4175 head_norm=0.900327 delta_norm=0.647475
[S6] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.6994 head_norm=0.777735
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.397622e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.6996 head_norm=0.720971 delta_norm=0.139762
[S8] aggregate: ACCEPT kept=['S15', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6607 head_norm=0.815156
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.251992e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6642 head_norm=0.798154 delta_norm=0.125199
[S4] aggregate: ACCEPT kept=['S3', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=0.865621 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.700852847654986, 'auprc': 0.721874875310625, 'loss_val': 0.6634977695460106, 'psi': 0.7092616587172416}-{'f1_val': 0.7011133543505058, 'auprc': 0.7461806408413224, 'loss_val': 0.735939123404924, 'psi': 0.7191402689468325}
[S3] START round=14 head_norm_before_train=0.711200 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.142015 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.8771543941838679, 'loss_val': 0.7101282713289148, 'psi': 0.7713607986888336}-{'f1_val': 0.7008317350254774, 'auprc': 0.8011199712563194, 'loss_val': 0.7660557427136148, 'psi': 0.7409470295178142}
[S4] START round=14 head_norm_before_train=0.798154 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.339084 metrics={'f1_val': 0.6636762325201991, 'auprc': 0.8553397732689423, 'loss_val': 0.7007436103878366, 'psi': 0.7403416488196963}-{'f1_val': 0.6606731175089067, 'auprc': 0.6590432265778722, 'loss_val': 0.7720035898386098, 'psi': 0.6600211611364928}
[S5] START round=14 head_norm_before_train=0.925152 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.451180 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9719096836365815, 'loss_val': 0.5094173058458877, 'psi': 0.8091053665607908}-{'f1_val': 0.6270581257069614, 'auprc': 0.8561345068478772, 'loss_val': 0.6233851635944446, 'psi': 0.7186886781633277}
[S6] START round=14 head_norm_before_train=0.900327 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.225278 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.9588573644737756, 'loss_val': 0.6481909787969579, 'psi': 0.6337763685140306}-{'f1_val': 0.41745618053540323, 'auprc': 0.8496834771054258, 'loss_val': 0.773627693812649, 'psi': 0.5903470991634123}
[S7] START round=14 head_norm_before_train=1.248378 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4882341718353259, 'auprc': 0.7586364948897526, 'loss_val': 0.89214530574278, 'psi': 0.5963951010570966}-{'f1_val': 0.6482425410991254, 'auprc': 0.6347690728519523, 'loss_val': 0.9492589907763884, 'psi': 0.6428531538002562}
[S8] START round=14 head_norm_before_train=0.720971 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.057955 metrics={'f1_val': 0.7139710799398039, 'auprc': 0.7933870713535818, 'loss_val': 0.8064420354801998, 'psi': 0.7457374765053151}-{'f1_val': 0.6993887854089063, 'auprc': 0.7933752157267384, 'loss_val': 0.8348229178681389, 'psi': 0.7369833575360392}
[S9] START round=14 head_norm_before_train=1.649894 (no previous merge yet)
[S9] round=14 local utility u=0.823999 metrics={'f1_val': 0.9716527274423237, 'auprc': 0.997088424911187, 'loss_val': 0.15368285020670744, 'psi': 0.9818270064298691}-{'f1_val': 0.7012165807733519, 'auprc': 0.9969410732897134, 'loss_val': 0.17862154274972983, 'psi': 0.8195063777798965}
[S10] START round=14 head_norm_before_train=1.677895 (no previous merge yet)
[S10] round=14 local utility u=0.793666 metrics={'f1_val': 0.9565807543677559, 'auprc': 0.9964919983188218, 'loss_val': 0.15965291465199496, 'psi': 0.9725452519481823}-{'f1_val': 0.6974347492430856, 'auprc': 0.9980987680204895, 'loss_val': 0.19692989252215795, 'psi': 0.8177003567540471}
[S11] START round=14 head_norm_before_train=1.315667 cos_to_last_merge=0.8375 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.837
[S11] round=14 local utility u=0.030203 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.996443121843763, 'loss_val': 0.3197131343103857, 'psi': 0.8195933364896602}-{'f1_val': 0.702242488399264, 'auprc': 0.9952113537836196, 'loss_val': 0.3797174449706918, 'psi': 0.8194300345530062}
[S13] START round=14 head_norm_before_train=1.218065 cos_to_last_merge=0.8620 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.862
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6636873148019142, 'auprc': 0.7452116831819752, 'loss_val': 0.568117919936993, 'psi': 0.6962970621539386}-{'f1_val': 0.7096505197065035, 'auprc': 0.7464383773678066, 'loss_val': 0.49144250971061576, 'psi': 0.7243656627710248}
[S14] START round=14 head_norm_before_train=1.287762 cos_to_last_merge=0.8838 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.884
[S14] round=14 local utility u=0.029993 metrics={'f1_val': 0.9975709549142228, 'auprc': 0.997156791554733, 'loss_val': 0.2488525810669608, 'psi': 0.9974052895704268}-{'f1_val': 0.9979161758042404, 'auprc': 0.9971583109225823, 'loss_val': 0.3109144115976683, 'psi': 0.9976130298515772}
[S15] START round=14 head_norm_before_train=1.619406 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6973191456695101, 'auprc': 0.7996918685687467, 'loss_val': 0.47236970327432953, 'psi': 0.7382682348292048}-{'f1_val': 0.6970583194609055, 'auprc': 0.9882073904388136, 'loss_val': 0.2557351160374645, 'psi': 0.8135179478520687}
[S16] START round=14 head_norm_before_train=1.187416 cos_to_last_merge=0.8760 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.876
[S16] round=14 local utility u=0.464181 metrics={'f1_val': 0.5617688925514527, 'auprc': 0.8329859843492389, 'loss_val': 0.6299190519229048, 'psi': 0.6702557292705671}-{'f1_val': 0.45068504790930797, 'auprc': 0.7819700326997285, 'loss_val': 0.7387294973708676, 'psi': 0.5831990418254762}
[S17] START round=14 head_norm_before_train=1.280319 cos_to_last_merge=0.8632 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.863
[S17] round=14 local utility u=1.000000 metrics={'f1_val': 0.663044429775828, 'auprc': 0.9008742203463421, 'loss_val': 0.728735659530537, 'psi': 0.7581763460040336}-{'f1_val': 0.3680156588667227, 'auprc': 0.8382072581105678, 'loss_val': 0.9356631759445375, 'psi': 0.5560922985642608}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:33910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S5
[S6] cosine check vs S5: cos=0.8380
[S10] RECEIVED delta(kind=head bytes=1792) from S6
[S10] cosine check vs S6: cos=-0.0817
[S10] DROPPED delta from S6 (cos=-0.0817 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] cosine check vs S3: cos=0.8700
[S3] RECEIVED delta(kind=head bytes=1799) from S4
[S3] cosine check vs S4: cos=0.5371
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=-0.0359
[S9] DROPPED delta from S10 (cos=-0.0359 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.6562
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7009 head_norm=0.911181
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.255823e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7009 head_norm=0.803984 delta_norm=0.225582
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7008 head_norm=0.751202
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.856786e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7006 head_norm=0.699296 delta_norm=0.385679
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6973 head_norm=1.651678
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.445006e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6971 head_norm=1.110625 delta_norm=0.644501
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.4171 head_norm=0.948141
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.720450e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.4167 head_norm=0.916095 delta_norm=0.272045
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=0.803984 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005925029290768, 'auprc': 0.6650447546962414, 'loss_val': 0.5924174919688096, 'psi': 0.6863734036359426}-{'f1_val': 0.700852847654986, 'auprc': 0.721874875310625, 'loss_val': 0.6634977695460106, 'psi': 0.7092616587172416}
[S3] START round=15 head_norm_before_train=0.699296 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005014381049806, 'auprc': 0.782337560346427, 'loss_val': 0.610148470989239, 'psi': 0.7332358870015592}-{'f1_val': 0.7008317350254774, 'auprc': 0.8771543941838679, 'loss_val': 0.7101282713289148, 'psi': 0.7713607986888336}
[S4] START round=15 head_norm_before_train=0.843340 cos_to_last_merge=0.9934 (last merge round=13)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6658427266979635, 'auprc': 0.8105897907898556, 'loss_val': 0.5861028262255303, 'psi': 0.7237415523347204}-{'f1_val': 0.6636762325201991, 'auprc': 0.8553397732689423, 'loss_val': 0.7007436103878366, 'psi': 0.7403416488196963}
[S5] START round=15 head_norm_before_train=0.963071 cos_to_last_merge=0.9981 (last merge round=13)
[S5] round=15 local utility u=0.053708 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9881343571031053, 'loss_val': 0.44918785266741057, 'psi': 0.8154465333015903}-{'f1_val': 0.7005691551769304, 'auprc': 0.9719096836365815, 'loss_val': 0.5094173058458877, 'psi': 0.8091053665607908}
[S6] START round=15 head_norm_before_train=0.916095 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.41552182163187856, 'auprc': 0.8322105994666057, 'loss_val': 0.6335916660233305, 'psi': 0.5821973327657695}-{'f1_val': 0.41705570454086727, 'auprc': 0.9588573644737756, 'loss_val': 0.6481909787969579, 'psi': 0.6337763685140306}
[S7] START round=15 head_norm_before_train=1.271911 cos_to_last_merge=0.9984 (last merge round=13)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7784879518454184, 'loss_val': 0.7646498322238934, 'psi': 0.5615430389996421}-{'f1_val': 0.4882341718353259, 'auprc': 0.7586364948897526, 'loss_val': 0.89214530574278, 'psi': 0.5963951010570966}
[S8] START round=15 head_norm_before_train=0.754781 cos_to_last_merge=0.9964 (last merge round=13)
[S8] round=15 local utility u=0.022306 metrics={'f1_val': 0.698685607158127, 'auprc': 0.7933717028808989, 'loss_val': 0.6700712613532428, 'psi': 0.7365600454472359}-{'f1_val': 0.7139710799398039, 'auprc': 0.7933870713535818, 'loss_val': 0.8064420354801998, 'psi': 0.7457374765053151}
[S9] START round=15 head_norm_before_train=1.674657 (no previous merge yet)
[S9] round=15 local utility u=0.075413 metrics={'f1_val': 0.9912237657809659, 'auprc': 0.9970641239487597, 'loss_val': 0.12021031173914055, 'psi': 0.9935599090480833}-{'f1_val': 0.9716527274423237, 'auprc': 0.997088424911187, 'loss_val': 0.15368285020670744, 'psi': 0.9818270064298691}
[S10] START round=15 head_norm_before_train=1.703929 (no previous merge yet)
[S10] round=15 local utility u=0.019640 metrics={'f1_val': 0.9580019646932879, 'auprc': 0.997784299857518, 'loss_val': 0.13277635206557534, 'psi': 0.97391489875898}-{'f1_val': 0.9565807543677559, 'auprc': 0.9964919983188218, 'loss_val': 0.15965291465199496, 'psi': 0.9725452519481823}
[S11] START round=15 head_norm_before_train=1.347381 cos_to_last_merge=0.8308 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.831
[S11] round=15 local utility u=0.012297 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9966546765613806, 'loss_val': 0.2972039585635556, 'psi': 0.8198230606035444}-{'f1_val': 0.7016934795869249, 'auprc': 0.996443121843763, 'loss_val': 0.3197131343103857, 'psi': 0.8195933364896602}
[S13] START round=15 head_norm_before_train=1.241698 cos_to_last_merge=0.8544 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.854
[S13] round=15 local utility u=0.147746 metrics={'f1_val': 0.6995349406465332, 'auprc': 0.745746290281218, 'loss_val': 0.4893153336494463, 'psi': 0.7180194805004071}-{'f1_val': 0.6636873148019142, 'auprc': 0.7452116831819752, 'loss_val': 0.568117919936993, 'psi': 0.6962970621539386}
[S14] START round=15 head_norm_before_train=1.330451 cos_to_last_merge=0.8755 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.876
[S14] round=15 local utility u=0.024664 metrics={'f1_val': 0.9975310084105004, 'auprc': 0.9957229074713662, 'loss_val': 0.1949835888264884, 'psi': 0.9968077680348466}-{'f1_val': 0.9975709549142228, 'auprc': 0.997156791554733, 'loss_val': 0.2488525810669608, 'psi': 0.9974052895704268}
[S15] START round=15 head_norm_before_train=1.110625 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.610145 metrics={'f1_val': 0.7723294750734911, 'auprc': 0.9913797747723571, 'loss_val': 0.2772047303016077, 'psi': 0.8599495949530376}-{'f1_val': 0.6973191456695101, 'auprc': 0.7996918685687467, 'loss_val': 0.47236970327432953, 'psi': 0.7382682348292048}
[S16] START round=15 head_norm_before_train=1.227542 cos_to_last_merge=0.8674 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.867
[S16] round=15 local utility u=0.070292 metrics={'f1_val': 0.5735271234149053, 'auprc': 0.8584179849913691, 'loss_val': 0.6361809526530745, 'psi': 0.6874834680454909}-{'f1_val': 0.5617688925514527, 'auprc': 0.8329859843492389, 'loss_val': 0.6299190519229048, 'psi': 0.6702557292705671}
[S17] START round=15 head_norm_before_train=1.303220 cos_to_last_merge=0.8558 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.856
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.38878188038346095, 'auprc': 0.9102642750229668, 'loss_val': 0.6976122668390191, 'psi': 0.5973748382392633}-{'f1_val': 0.663044429775828, 'auprc': 0.9008742203463421, 'loss_val': 0.728735659530537, 'psi': 0.7581763460040336}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:33907
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:33910
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S5
[S6] cosine check vs S5: cos=0.9515
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=-0.0343
[S9] DROPPED delta from S10 (cos=-0.0343 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] cosine check vs S8: cos=0.8140
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.4155 head_norm=0.966387
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.535303e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.4154 head_norm=0.969548 delta_norm=0.153530
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.167 → S10@127.0.0.1:33911
[S8] ⇄ pheromone p=0.287 → S15@127.0.0.1:33915
[S7] ⇄ pheromone p=0.170 → S14@127.0.0.1:33914
[S4] ⇄ pheromone p=0.233 → S3@127.0.0.1:33903
[S2] ⇄ pheromone p=0.186 → S8@127.0.0.1:33909
[S3] ⇄ pheromone p=0.182 → S2@127.0.0.1:33902
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.7723 head_norm=1.149218
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.410420e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6983 head_norm=0.927633 delta_norm=0.341042
[S15] aggregate: ROLLBACK (f1_val pre=0.772 post=0.698 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.295 → S8@127.0.0.1:33909
[S10] ⇄ pheromone p=0.307 → S9@127.0.0.1:33910
[S5] ⇄ pheromone p=0.248 → S6@127.0.0.1:33907
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S2] START round=16 head_norm_before_train=0.860608 cos_to_last_merge=0.9947 (last merge round=14)
[S2] round=16 local utility u=0.051193 metrics={'f1_val': 0.7012120585667497, 'auprc': 0.6641711312750413, 'loss_val': 0.4911270202639911, 'psi': 0.6863956876500663}-{'f1_val': 0.7005925029290768, 'auprc': 0.6650447546962414, 'loss_val': 0.5924174919688096, 'psi': 0.6863734036359426}
[S3] START round=16 head_norm_before_train=0.747096 cos_to_last_merge=0.9950 (last merge round=14)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.6164216991918, 'auprc': 0.785312141620614, 'loss_val': 0.7361295530279631, 'psi': 0.6839778761633256}-{'f1_val': 0.7005014381049806, 'auprc': 0.782337560346427, 'loss_val': 0.610148470989239, 'psi': 0.7332358870015592}
[S4] START round=16 head_norm_before_train=0.899900 cos_to_last_merge=0.9791 (last merge round=13)
[S4] round=16 local utility u=0.769391 metrics={'f1_val': 0.8511207273336634, 'auprc': 0.9399440180420859, 'loss_val': 0.5470513280242982, 'psi': 0.8866500436170324}-{'f1_val': 0.6658427266979635, 'auprc': 0.8105897907898556, 'loss_val': 0.5861028262255303, 'psi': 0.7237415523347204}
[S5] START round=16 head_norm_before_train=0.996638 cos_to_last_merge=0.9942 (last merge round=13)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.6609613984985447, 'auprc': 0.8562926847578919, 'loss_val': 0.4844116471602659, 'psi': 0.7390939130022836}-{'f1_val': 0.7003213174339138, 'auprc': 0.9881343571031053, 'loss_val': 0.44918785266741057, 'psi': 0.8154465333015903}
[S6] START round=16 head_norm_before_train=0.969548 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=1.000000 metrics={'f1_val': 0.6838144312956702, 'auprc': 0.9575140913146661, 'loss_val': 0.49885623668167406, 'psi': 0.7932942953032687}-{'f1_val': 0.41552182163187856, 'auprc': 0.8322105994666057, 'loss_val': 0.6335916660233305, 'psi': 0.5821973327657695}
[S7] START round=16 head_norm_before_train=1.300423 cos_to_last_merge=0.9941 (last merge round=13)
[S7] round=16 local utility u=0.140025 metrics={'f1_val': 0.46930441322816757, 'auprc': 0.7817011949810211, 'loss_val': 0.8085883281114107, 'psi': 0.594263125929309}-{'f1_val': 0.4169130971024577, 'auprc': 0.7784879518454184, 'loss_val': 0.7646498322238934, 'psi': 0.5615430389996421}
[S8] START round=16 head_norm_before_train=0.795565 cos_to_last_merge=0.9867 (last merge round=13)
[S8] round=16 local utility u=0.087368 metrics={'f1_val': 0.7130105920304193, 'auprc': 0.7935640148586165, 'loss_val': 0.5818620977019545, 'psi': 0.7452319611616982}-{'f1_val': 0.698685607158127, 'auprc': 0.7933717028808989, 'loss_val': 0.6700712613532428, 'psi': 0.7365600454472359}
[S9] START round=16 head_norm_before_train=1.699983 (no previous merge yet)
[S9] round=16 local utility u=0.014020 metrics={'f1_val': 0.9912134460920485, 'auprc': 0.997463205270613, 'loss_val': 0.09330550490112749, 'psi': 0.9937133497634744}-{'f1_val': 0.9912237657809659, 'auprc': 0.9970641239487597, 'loss_val': 0.12021031173914055, 'psi': 0.9935599090480833}
[S10] START round=16 head_norm_before_train=1.724983 (no previous merge yet)
[S10] round=16 local utility u=0.090651 metrics={'f1_val': 0.9935668762413106, 'auprc': 0.9871256813370135, 'loss_val': 0.13288770776438522, 'psi': 0.9909903982795918}-{'f1_val': 0.9580019646932879, 'auprc': 0.997784299857518, 'loss_val': 0.13277635206557534, 'psi': 0.97391489875898}
[S11] START round=16 head_norm_before_train=1.377564 cos_to_last_merge=0.8251 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.825
[S11] round=16 local utility u=0.009195 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9966647587169466, 'loss_val': 0.27884343478175183, 'psi': 0.8198270934657708}-{'f1_val': 0.7019353166316534, 'auprc': 0.9966546765613806, 'loss_val': 0.2972039585635556, 'psi': 0.8198230606035444}
[S13] START round=16 head_norm_before_train=1.261992 cos_to_last_merge=0.8500 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.850
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6872501211068551, 'auprc': 0.7314626109561508, 'loss_val': 0.49906997487779253, 'psi': 0.7049351170465734}-{'f1_val': 0.6995349406465332, 'auprc': 0.745746290281218, 'loss_val': 0.4893153336494463, 'psi': 0.7180194805004071}
[S14] START round=16 head_norm_before_train=1.373883 cos_to_last_merge=0.8676 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.868
[S14] round=16 local utility u=0.021734 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.997156534362435, 'loss_val': 0.1542070219410434, 'psi': 0.9972202298501045}-{'f1_val': 0.9975310084105004, 'auprc': 0.9957229074713662, 'loss_val': 0.1949835888264884, 'psi': 0.9968077680348466}
[S15] START round=16 head_norm_before_train=0.927633 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6985454261284734, 'auprc': 0.8972538111979294, 'loss_val': 0.4061361821752746, 'psi': 0.7780287801562558}-{'f1_val': 0.7723294750734911, 'auprc': 0.9913797747723571, 'loss_val': 0.2772047303016077, 'psi': 0.8599495949530376}
[S16] START round=16 head_norm_before_train=1.269114 cos_to_last_merge=0.8591 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.859
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8687383568715952, 'auprc': 0.908476497604134, 'loss_val': 0.5172869766375743, 'psi': 0.8846336131646106}-{'f1_val': 0.5735271234149053, 'auprc': 0.8584179849913691, 'loss_val': 0.6361809526530745, 'psi': 0.6874834680454909}
[S17] START round=16 head_norm_before_train=1.326155 cos_to_last_merge=0.8487 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.849
[S17] round=16 local utility u=0.706894 metrics={'f1_val': 0.5755902261085099, 'auprc': 0.9672843719542388, 'loss_val': 0.5757339118364462, 'psi': 0.7322678844468015}-{'f1_val': 0.38878188038346095, 'auprc': 0.9102642750229668, 'loss_val': 0.6976122668390191, 'psi': 0.5973748382392633}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33903
[S2] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S2
[S8] cosine check vs S2: cos=0.5693
[S4] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S4
[S3] cosine check vs S4: cos=0.8338
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.6164 head_norm=0.799407
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.636319e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.6171 head_norm=0.840281 delta_norm=0.263632
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33911
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S6
[S10] cosine check vs S6: cos=-0.0781
[S10] DROPPED delta from S6 (cos=-0.0781 < 0.0)
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:33908
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:33910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:33914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33911
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9724
[S10] RECEIVED delta(kind=head bytes=1799) from S9
[S10] cosine check vs S9: cos=-0.0331
[S10] DROPPED delta from S9 (cos=-0.0331 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S14
[S7] cosine check vs S14: cos=0.9724
[S15] RECEIVED delta(kind=head bytes=1791) from S8
[S15] cosine check vs S8: cos=0.9098
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=-0.0331
[S9] DROPPED delta from S10 (cos=-0.0331 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.4693 head_norm=1.325600
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.673421e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.3770 head_norm=1.361517 delta_norm=0.167342
[S7] aggregate: ROLLBACK (f1_val pre=0.469 post=0.377 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9973 head_norm=1.416420
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.673421e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9973 head_norm=1.361517 delta_norm=0.167342
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.7130 head_norm=0.843382
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.111709e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.7130 head_norm=0.782273 delta_norm=0.411171
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=0.922352 cos_to_last_merge=0.9840 (last merge round=14)
[S2] round=17 local utility u=0.021328 metrics={'f1_val': 0.700410363496069, 'auprc': 0.658563556565102, 'loss_val': 0.4268387281998836, 'psi': 0.6836716407236823}-{'f1_val': 0.7012120585667497, 'auprc': 0.6641711312750413, 'loss_val': 0.4911270202639911, 'psi': 0.6863956876500663}
[S3] START round=17 head_norm_before_train=0.840281 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.363803 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.7852020065783298, 'loss_val': 0.5122208767597994, 'psi': 0.7343365193841259}-{'f1_val': 0.6164216991918, 'auprc': 0.785312141620614, 'loss_val': 0.7361295530279631, 'psi': 0.6839778761633256}
[S4] START round=17 head_norm_before_train=0.955037 cos_to_last_merge=0.9645 (last merge round=13)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.7336246465051259, 'auprc': 0.940061492459656, 'loss_val': 0.5124499674810983, 'psi': 0.816199384886938}-{'f1_val': 0.8511207273336634, 'auprc': 0.9399440180420859, 'loss_val': 0.5470513280242982, 'psi': 0.8866500436170324}
[S5] START round=17 head_norm_before_train=1.025855 cos_to_last_merge=0.9899 (last merge round=13)
[S5] round=17 local utility u=0.365817 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898340489993571, 'loss_val': 0.38956033289673436, 'psi': 0.8161264100600911}-{'f1_val': 0.6609613984985447, 'auprc': 0.8562926847578919, 'loss_val': 0.4844116471602659, 'psi': 0.7390939130022836}
[S6] START round=17 head_norm_before_train=1.010737 cos_to_last_merge=0.9986 (last merge round=15)
[S6] round=17 local utility u=0.046419 metrics={'f1_val': 0.695179240583983, 'auprc': 0.9547260034706464, 'loss_val': 0.465843769694368, 'psi': 0.7989979457386484}-{'f1_val': 0.6838144312956702, 'auprc': 0.9575140913146661, 'loss_val': 0.49885623668167406, 'psi': 0.7932942953032687}
[S7] START round=17 head_norm_before_train=1.361517 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.729838 metrics={'f1_val': 0.6813071000719748, 'auprc': 0.7829366953452467, 'loss_val': 0.6246349194038737, 'psi': 0.7219589381812835}-{'f1_val': 0.46930441322816757, 'auprc': 0.7817011949810211, 'loss_val': 0.8085883281114107, 'psi': 0.594263125929309}
[S8] START round=17 head_norm_before_train=0.782273 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.6995512819485203, 'auprc': 0.793365095143052, 'loss_val': 0.572755288639011, 'psi': 0.737076807226333}-{'f1_val': 0.7130105920304193, 'auprc': 0.7935640148586165, 'loss_val': 0.5818620977019545, 'psi': 0.7452319611616982}
[S9] START round=17 head_norm_before_train=1.720292 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9976238612399758, 'loss_val': 0.08219961896578902, 'psi': 0.9919979567998587}-{'f1_val': 0.9912134460920485, 'auprc': 0.997463205270613, 'loss_val': 0.09330550490112749, 'psi': 0.9937133497634744}
[S10] START round=17 head_norm_before_train=1.743883 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9580221420144054, 'auprc': 0.997930073827629, 'loss_val': 0.11245419949353817, 'psi': 0.9739853147396949}-{'f1_val': 0.9935668762413106, 'auprc': 0.9871256813370135, 'loss_val': 0.13288770776438522, 'psi': 0.9909903982795918}
[S11] START round=17 head_norm_before_train=1.405852 cos_to_last_merge=0.8201 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.820
[S11] round=17 local utility u=0.015573 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9983680042726364, 'loss_val': 0.2528063693205378, 'psi': 0.8205083916880467}-{'f1_val': 0.7019353166316534, 'auprc': 0.9966647587169466, 'loss_val': 0.27884343478175183, 'psi': 0.8198270934657708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=17 head_norm_before_train=1.278909 cos_to_last_merge=0.8457 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5821821938867394, 'auprc': 0.5920915959383066, 'loss_val': 0.6611407645887242, 'psi': 0.5861459547073663}-{'f1_val': 0.6872501211068551, 'auprc': 0.7314626109561508, 'loss_val': 0.49906997487779253, 'psi': 0.7049351170465734}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.361517 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.99661045654233, 'auprc': 0.9971554813507965, 'loss_val': 0.15918028998324693, 'psi': 0.9968284664657167}-{'f1_val': 0.9972626935085508, 'auprc': 0.997156534362435, 'loss_val': 0.1542070219410434, 'psi': 0.9972202298501045}
[S15] START round=17 head_norm_before_train=0.981121 cos_to_last_merge=0.9972 (last merge round=15)
[S15] round=17 local utility u=0.864371 metrics={'f1_val': 0.9129905944963773, 'auprc': 0.9896434987251965, 'loss_val': 0.24123464550434187, 'psi': 0.943651756187905}-{'f1_val': 0.6985454261284734, 'auprc': 0.8972538111979294, 'loss_val': 0.4061361821752746, 'psi': 0.7780287801562558}
[S16] START round=17 head_norm_before_train=1.309935 cos_to_last_merge=0.8513 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.851
[S16] round=17 local utility u=0.276607 metrics={'f1_val': 0.9207357215305275, 'auprc': 0.9390090095272315, 'loss_val': 0.367655118721546, 'psi': 0.9280450367292091}-{'f1_val': 0.8687383568715952, 'auprc': 0.908476497604134, 'loss_val': 0.5172869766375743, 'psi': 0.8846336131646106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=17 head_norm_before_train=1.350528 cos_to_last_merge=0.8421 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.842
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3821708785405067, 'auprc': 0.7647474388788289, 'loss_val': 0.8549947200028268, 'psi': 0.5352015026758355}-{'f1_val': 0.5755902261085099, 'auprc': 0.9672843719542388, 'loss_val': 0.5757339118364462, 'psi': 0.7322678844468015}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:33909
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33914
[S15] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1803) from S5
[S6] cosine check vs S5: cos=0.9750
[S8] RECEIVED delta(kind=head bytes=1789) from S15
[S8] cosine check vs S15: cos=0.7951
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9989
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:33902
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.9130 head_norm=1.049553
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.441109e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.8206 head_norm=0.920237 delta_norm=0.244111
[S15] aggregate: ROLLBACK (f1_val pre=0.913 post=0.821 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S6
[S10] cosine check vs S6: cos=-0.0753
[S10] DROPPED delta from S6 (cos=-0.0753 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=0.6219
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=0.8704
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6952 head_norm=1.042489
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.168550e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6904 head_norm=1.038813 delta_norm=0.116855
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4]  timeout peer S3
[S4]  timeout peer S11
[S3]  timeout peer S2
[S3]  timeout peer S5
[S10]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S16
[S7]  timeout peer S14
[S2]  timeout peer S7
[S2]  timeout peer S8
[S5]  timeout peer S6
[S8]  timeout peer S4
[S8]  timeout peer S17
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7004 head_norm=0.982189
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.063410e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7004 head_norm=0.835789 delta_norm=0.406341
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.6996 head_norm=0.826616
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.326573e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.6997 head_norm=0.846079 delta_norm=0.132657
[S8] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=0.835789 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.111749 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7368863729812567, 'loss_val': 0.4437328783983445, 'psi': 0.7155430594359893}-{'f1_val': 0.700410363496069, 'auprc': 0.658563556565102, 'loss_val': 0.4268387281998836, 'psi': 0.6836716407236823}
[S3] START round=18 head_norm_before_train=0.873281 cos_to_last_merge=0.9982 (last merge round=16)
[S3] round=18 local utility u=0.000430 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.774434998625932, 'loss_val': 0.48149368667275744, 'psi': 0.7302730404656592}-{'f1_val': 0.7004261945879899, 'auprc': 0.7852020065783298, 'loss_val': 0.5122208767597994, 'psi': 0.7343365193841259}
[S4] START round=18 head_norm_before_train=1.004096 cos_to_last_merge=0.9522 (last merge round=13)
[S4] round=18 local utility u=0.215328 metrics={'f1_val': 0.7983118770311107, 'auprc': 0.9438456182582697, 'loss_val': 0.4812706524904724, 'psi': 0.8565253735219743}-{'f1_val': 0.7336246465051259, 'auprc': 0.940061492459656, 'loss_val': 0.5124499674810983, 'psi': 0.816199384886938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=18 head_norm_before_train=1.048233 cos_to_last_merge=0.9861 (last merge round=13)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.6133038489472331, 'auprc': 0.8560223319370519, 'loss_val': 0.5068124218678695, 'psi': 0.7103912421431606}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898340489993571, 'loss_val': 0.38956033289673436, 'psi': 0.8161264100600911}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=18 head_norm_before_train=1.038813 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.009272 metrics={'f1_val': 0.6953477829796952, 'auprc': 0.9551163839985821, 'loss_val': 0.44948209562391156, 'psi': 0.79925522338725}-{'f1_val': 0.695179240583983, 'auprc': 0.9547260034706464, 'loss_val': 0.465843769694368, 'psi': 0.7989979457386484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=18 head_norm_before_train=1.381503 cos_to_last_merge=0.9993 (last merge round=16)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.3928378186740163, 'auprc': 0.7590610820816966, 'loss_val': 0.9093783170203956, 'psi': 0.5393271240370885}-{'f1_val': 0.6813071000719748, 'auprc': 0.7829366953452467, 'loss_val': 0.6246349194038737, 'psi': 0.7219589381812835}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=0.846079 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.023215 metrics={'f1_val': 0.6998249505648959, 'auprc': 0.7934302566053568, 'loss_val': 0.5281626169912826, 'psi': 0.7372670729810803}-{'f1_val': 0.6995512819485203, 'auprc': 0.793365095143052, 'loss_val': 0.572755288639011, 'psi': 0.737076807226333}
[S9] START round=18 head_norm_before_train=1.742033 (no previous merge yet)
[S9] round=18 local utility u=0.030184 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9947793095099562, 'loss_val': 0.06377783492120966, 'psi': 0.9959080308923174}-{'f1_val': 0.9882473538397808, 'auprc': 0.9976238612399758, 'loss_val': 0.08219961896578902, 'psi': 0.9919979567998587}
[S10] START round=18 head_norm_before_train=1.762292 (no previous merge yet)
[S10] round=18 local utility u=0.126454 metrics={'f1_val': 0.99597747293297, 'auprc': 0.9976429754275782, 'loss_val': 0.08641625495307931, 'psi': 0.9966436739308133}-{'f1_val': 0.9580221420144054, 'auprc': 0.997930073827629, 'loss_val': 0.11245419949353817, 'psi': 0.9739853147396949}
[S11] START round=18 head_norm_before_train=1.431395 cos_to_last_merge=0.8154 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.815
[S11] round=18 local utility u=0.006154 metrics={'f1_val': 0.7021770286274283, 'auprc': 0.9984204586942178, 'loss_val': 0.24210650101977144, 'psi': 0.8206744006541441}-{'f1_val': 0.7019353166316534, 'auprc': 0.9983680042726364, 'loss_val': 0.2528063693205378, 'psi': 0.8205083916880467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=18 head_norm_before_train=1.291148 cos_to_last_merge=0.8419 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.842
[S13] round=18 local utility u=0.494191 metrics={'f1_val': 0.682703645479323, 'auprc': 0.6762797836375516, 'loss_val': 0.528452344673915, 'psi': 0.6801341007426145}-{'f1_val': 0.5821821938867394, 'auprc': 0.5920915959383066, 'loss_val': 0.6611407645887242, 'psi': 0.5861459547073663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=18 head_norm_before_train=1.395797 cos_to_last_merge=0.9996 (last merge round=16)
[S14] round=18 local utility u=0.018372 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.9971556562562529, 'loss_val': 0.12634976812982368, 'psi': 0.9972198786076316}-{'f1_val': 0.99661045654233, 'auprc': 0.9971554813507965, 'loss_val': 0.15918028998324693, 'psi': 0.9968284664657167}
[S15] START round=18 head_norm_before_train=0.920237 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7011745899932396, 'auprc': 0.96994616257425, 'loss_val': 0.3830936952984114, 'psi': 0.8086832190256437}-{'f1_val': 0.9129905944963773, 'auprc': 0.9896434987251965, 'loss_val': 0.24123464550434187, 'psi': 0.943651756187905}
[S16] START round=18 head_norm_before_train=1.350499 cos_to_last_merge=0.8443 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.844
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8835783951433899, 'auprc': 0.9442030898673087, 'loss_val': 0.3199489723110509, 'psi': 0.9078282730329574}-{'f1_val': 0.9207357215305275, 'auprc': 0.9390090095272315, 'loss_val': 0.367655118721546, 'psi': 0.9280450367292091}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=1.370121 cos_to_last_merge=0.8380 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=18 local utility u=0.946867 metrics={'f1_val': 0.6164951594715145, 'auprc': 0.8786984863275371, 'loss_val': 0.7090590083815056, 'psi': 0.7213764902139235}-{'f1_val': 0.3821708785405067, 'auprc': 0.7647474388788289, 'loss_val': 0.8549947200028268, 'psi': 0.5352015026758355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:33908
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:33915
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=-0.0760
[S6] DROPPED delta from S10 (cos=-0.0760 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1791) from S2
[S3] cosine check vs S2: cos=0.8710
[S10] RECEIVED delta(kind=head bytes=1804) from S9
[S10] cosine check vs S9: cos=-0.0317
[S10] DROPPED delta from S9 (cos=-0.0317 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9964
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.9280
[S8] sending update (kind=head size=1792 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9973 head_norm=1.430769
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.323800e-02
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9973 head_norm=1.405344 delta_norm=0.053238
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.7008 head_norm=0.909428
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.285634e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.7008 head_norm=0.869631 delta_norm=0.228563
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] cosine check vs S8: cos=0.8854
[S2] START round=19 head_norm_before_train=0.888785 cos_to_last_merge=0.9973 (last merge round=17)
[S2] round=19 local utility u=0.025886 metrics={'f1_val': 0.701055136928628, 'auprc': 0.7318948785726332, 'loss_val': 0.37543205637113997, 'psi': 0.7133910335862301}-{'f1_val': 0.7013141837391442, 'auprc': 0.7368863729812567, 'loss_val': 0.4437328783983445, 'psi': 0.7155430594359893}
[S3] START round=19 head_norm_before_train=0.869631 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.6988276379298136, 'loss_val': 0.46124295616002176, 'psi': 0.6997269052350537}-{'f1_val': 0.7008317350254774, 'auprc': 0.774434998625932, 'loss_val': 0.48149368667275744, 'psi': 0.7302730404656592}
[S4] START round=19 head_norm_before_train=1.050792 cos_to_last_merge=0.9419 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=19 local utility u=0.490109 metrics={'f1_val': 0.9450777607941101, 'auprc': 0.9483801784159284, 'loss_val': 0.39525229691219027, 'psi': 0.9463987278428374}-{'f1_val': 0.7983118770311107, 'auprc': 0.9438456182582697, 'loss_val': 0.4812706524904724, 'psi': 0.8565253735219743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9451 head_norm=1.091250
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.163242e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9452 head_norm=0.980891 delta_norm=0.216324
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.946 u=0.4901 p_local=0.3068 f1=0.945 auprc=0.948 bytes=23353
[S5] START round=19 head_norm_before_train=1.070312 cos_to_last_merge=0.9821 (last merge round=13)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.43419235267302947, 'auprc': 0.8534801303966333, 'loss_val': 0.740984057649616, 'psi': 0.6019074637624711}-{'f1_val': 0.6133038489472331, 'auprc': 0.8560223319370519, 'loss_val': 0.5068124218678695, 'psi': 0.7103912421431606}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.602 u=0.0000 p_local=0.1486 f1=0.434 auprc=0.853 bytes=21570
[S6] START round=19 head_norm_before_train=1.061450 cos_to_last_merge=0.9995 (last merge round=17)
[S6] round=19 local utility u=0.058000 metrics={'f1_val': 0.699476836473995, 'auprc': 0.962162235599893, 'loss_val': 0.3793946852661739, 'psi': 0.8045509961243542}-{'f1_val': 0.6953477829796952, 'auprc': 0.9551163839985821, 'loss_val': 0.44948209562391156, 'psi': 0.79925522338725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=20 psi=0.805 u=0.0580 p_local=0.1900 f1=0.699 auprc=0.962 bytes=28740
[S7] START round=19 head_norm_before_train=1.400316 cos_to_last_merge=0.9980 (last merge round=16)
[S7] round=19 local utility u=1.000000 metrics={'f1_val': 0.6723787494221085, 'auprc': 0.9162855986269989, 'loss_val': 0.5490202534086109, 'psi': 0.7699414891040647}-{'f1_val': 0.3928378186740163, 'auprc': 0.7590610820816966, 'loss_val': 0.9093783170203956, 'psi': 0.5393271240370885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6724 head_norm=1.415521
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.208905e-02
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6708 head_norm=1.421339 delta_norm=0.072089
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.770 u=1.0000 p_local=0.3772 f1=0.672 auprc=0.916 bytes=25132
[S8] START round=19 head_norm_before_train=0.894452 cos_to_last_merge=0.9972 (last merge round=17)
[S8] round=19 local utility u=0.040006 metrics={'f1_val': 0.7038785731978178, 'auprc': 0.79350694448359, 'loss_val': 0.4727028168101325, 'psi': 0.7397299217121267}-{'f1_val': 0.6998249505648959, 'auprc': 0.7934302566053568, 'loss_val': 0.5281626169912826, 'psi': 0.7372670729810803}
[S9] START round=19 head_norm_before_train=1.763226 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.8937941872448015, 'auprc': 0.9950890223073642, 'loss_val': 0.13756727653258238, 'psi': 0.9343121212698267}-{'f1_val': 0.9966605118138915, 'auprc': 0.9947793095099562, 'loss_val': 0.06377783492120966, 'psi': 0.9959080308923174}
[S10] START round=19 head_norm_before_train=1.778813 (no previous merge yet)
[S10] round=19 local utility u=0.000130 metrics={'f1_val': 0.99597747293297, 'auprc': 0.9965851985862364, 'loss_val': 0.08298328078062453, 'psi': 0.9962205631942765}-{'f1_val': 0.99597747293297, 'auprc': 0.9976429754275782, 'loss_val': 0.08641625495307931, 'psi': 0.9966436739308133}
[S11] START round=19 head_norm_before_train=1.456468 cos_to_last_merge=0.8107 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.811
[S11] round=19 local utility u=0.784056 metrics={'f1_val': 0.955923326508306, 'auprc': 0.998209108110438, 'loss_val': 0.19583724109965597, 'psi': 0.9728376391491588}-{'f1_val': 0.7021770286274283, 'auprc': 0.9984204586942178, 'loss_val': 0.24210650101977144, 'psi': 0.8206744006541441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=20 psi=0.973 u=0.7841 p_local=0.2374 f1=0.956 auprc=0.998 bytes=30549
[S13] START round=19 head_norm_before_train=1.307882 cos_to_last_merge=0.8391 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.839
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6399105422281682, 'auprc': 0.6127508051007706, 'loss_val': 0.5597411248346768, 'psi': 0.6290466473772092}-{'f1_val': 0.682703645479323, 'auprc': 0.6762797836375516, 'loss_val': 0.528452344673915, 'psi': 0.6801341007426145}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.629 u=0.0000 p_local=0.1670 f1=0.640 auprc=0.613 bytes=19773
[S14] START round=19 head_norm_before_train=1.405344 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.003036 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9957213244781746, 'loss_val': 0.11830452876093772, 'psi': 0.996879200621182}-{'f1_val': 0.9972626935085508, 'auprc': 0.9971556562562529, 'loss_val': 0.12634976812982368, 'psi': 0.9972198786076316}
[S15] START round=19 head_norm_before_train=0.990360 cos_to_last_merge=0.9962 (last merge round=17)
[S15] round=19 local utility u=0.523592 metrics={'f1_val': 0.8420120337581547, 'auprc': 0.9925492301096064, 'loss_val': 0.24874435508039489, 'psi': 0.9022269122987354}-{'f1_val': 0.7011745899932396, 'auprc': 0.96994616257425, 'loss_val': 0.3830936952984114, 'psi': 0.8086832190256437}
[S16] START round=19 head_norm_before_train=1.391290 cos_to_last_merge=0.8374 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.837
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8319176467218241, 'auprc': 0.9874852292832417, 'loss_val': 0.652578554016898, 'psi': 0.8941446797463911}-{'f1_val': 0.8835783951433899, 'auprc': 0.9442030898673087, 'loss_val': 0.3199489723110509, 'psi': 0.9078282730329574}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.894 u=0.0000 p_local=0.2316 f1=0.832 auprc=0.987 bytes=23334
[S17] START round=19 head_norm_before_train=1.389201 cos_to_last_merge=0.8343 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.3987406886082847, 'auprc': 0.6951917514620845, 'loss_val': 0.9746459977610319, 'psi': 0.5173211137498046}-{'f1_val': 0.6164951594715145, 'auprc': 0.8786984863275371, 'loss_val': 0.7090590083815056, 'psi': 0.7213764902139235}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.517 u=0.0000 p_local=0.3466 f1=0.399 auprc=0.695 bytes=23373
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:33908
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S2] → sending delta(kind=head bytes=1786) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S2] sending update (kind=head size=1786 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] r=20 psi=0.700 u=0.0000 p_local=0.1210 f1=0.700 auprc=0.699 bytes=23363
[S9] r=20 psi=0.934 u=0.0000 p_local=0.1559 f1=0.894 auprc=0.995 bytes=26976
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:33915
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=0.8777
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=-0.0743
[S6] DROPPED delta from S10 (cos=-0.0743 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.9993
[S3] RECEIVED delta(kind=head bytes=1786) from S2
[S3] cosine check vs S2: cos=0.9516
[S8] sending update (kind=head size=1791 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.8420 head_norm=1.070182
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.592235e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.7802 head_norm=0.951562 delta_norm=0.259224
[S15] aggregate: ROLLBACK (f1_val pre=0.842 post=0.780 tol_abs=0.005 tol_rel=0.0)
[S15] r=20 psi=0.902 u=0.5236 p_local=0.3363 f1=0.842 auprc=0.993 bytes=26941
[S10] r=20 psi=0.996 u=0.0001 p_local=0.1555 f1=0.996 auprc=0.997 bytes=28809
[S14] r=20 psi=0.997 u=0.0030 p_local=0.1285 f1=0.998 auprc=0.996 bytes=26920
[S2] r=20 psi=0.713 u=0.0259 p_local=0.1070 f1=0.701 auprc=0.732 bytes=26927
[S15] RECEIVED delta(kind=head bytes=1791) from S8
[S15] cosine check vs S8: cos=0.9627
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.7039 head_norm=0.941447
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.564555e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.7067 head_norm=0.974698 delta_norm=0.256456
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.740 u=0.0400 p_local=0.1380 f1=0.704 auprc=0.794 bytes=26905
[S2] START round=20 head_norm_before_train=0.946003 cos_to_last_merge=0.9902 (last merge round=17)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6730185708619871, 'auprc': 0.670785085356906, 'loss_val': 0.5105551302073431, 'psi': 0.6721251766599546}-{'f1_val': 0.701055136928628, 'auprc': 0.7318948785726332, 'loss_val': 0.37543205637113997, 'psi': 0.7133910335862301}
[S3] START round=20 head_norm_before_train=0.908119 cos_to_last_merge=0.9989 (last merge round=18)
[S3] round=20 local utility u=0.025389 metrics={'f1_val': 0.6881274869022438, 'auprc': 0.7401409567801729, 'loss_val': 0.46121057031971174, 'psi': 0.7089328748534154}-{'f1_val': 0.7003264167718803, 'auprc': 0.6988276379298136, 'loss_val': 0.46124295616002176, 'psi': 0.6997269052350537}
[S4] START round=20 head_norm_before_train=0.980891 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.021325 metrics={'f1_val': 0.9473706959513055, 'auprc': 0.9529675798325681, 'loss_val': 0.3801211218186099, 'psi': 0.9496094495038105}-{'f1_val': 0.9450777607941101, 'auprc': 0.9483801784159284, 'loss_val': 0.39525229691219027, 'psi': 0.9463987278428374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] sending update (kind=head size=1788 to 1 peers)
[S5] START round=20 head_norm_before_train=1.091805 cos_to_last_merge=0.9782 (last merge round=13)
[S5] round=20 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898421856868194, 'loss_val': 0.3227614472441182, 'psi': 0.816129664735076}-{'f1_val': 0.43419235267302947, 'auprc': 0.8534801303966333, 'loss_val': 0.740984057649616, 'psi': 0.6019074637624711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=20 head_norm_before_train=1.084542 cos_to_last_merge=0.9981 (last merge round=17)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6590176885917065, 'auprc': 0.7827620320694603, 'loss_val': 0.6019881967415787, 'psi': 0.708515425982808}-{'f1_val': 0.699476836473995, 'auprc': 0.962162235599893, 'loss_val': 0.3793946852661739, 'psi': 0.8045509961243542}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.421339 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.39623124575302693, 'auprc': 0.7575346628595111, 'loss_val': 0.9706230862086634, 'psi': 0.5407526125956206}-{'f1_val': 0.6723787494221085, 'auprc': 0.9162855986269989, 'loss_val': 0.5490202534086109, 'psi': 0.7699414891040647}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.3962 head_norm=1.431931
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.391810e-02
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.3952 head_norm=1.436272 delta_norm=0.033918
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] START round=20 head_norm_before_train=0.974698 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.018155 metrics={'f1_val': 0.6997274788610883, 'auprc': 0.79341048918362, 'loss_val': 0.41119769018976116, 'psi': 0.737200682990101}-{'f1_val': 0.7038785731978178, 'auprc': 0.79350694448359, 'loss_val': 0.4727028168101325, 'psi': 0.7397299217121267}
[S9] START round=20 head_norm_before_train=1.781033 (no previous merge yet)
[S9] round=20 local utility u=0.351485 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9941944574311288, 'loss_val': 0.04664827565175822, 'psi': 0.995427839840018}-{'f1_val': 0.8937941872448015, 'auprc': 0.9950890223073642, 'loss_val': 0.13756727653258238, 'psi': 0.9343121212698267}
[S10] START round=20 head_norm_before_train=1.797266 (no previous merge yet)
[S10] round=20 local utility u=0.007861 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9977597430604139, 'loss_val': 0.06854913508718163, 'psi': 0.9964667633873475}-{'f1_val': 0.99597747293297, 'auprc': 0.9965851985862364, 'loss_val': 0.08298328078062453, 'psi': 0.9962205631942765}
[S11] START round=20 head_norm_before_train=1.484318 cos_to_last_merge=0.8068 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.807
[S11] round=20 local utility u=0.019936 metrics={'f1_val': 0.9583017359231194, 'auprc': 0.9978527202743025, 'loss_val': 0.1691663926585541, 'psi': 0.9741221296635927}-{'f1_val': 0.955923326508306, 'auprc': 0.998209108110438, 'loss_val': 0.19583724109965597, 'psi': 0.9728376391491588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=20 head_norm_before_train=1.327806 cos_to_last_merge=0.8356 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.836
[S13] round=20 local utility u=0.009892 metrics={'f1_val': 0.6381044625998468, 'auprc': 0.6443676704178277, 'loss_val': 0.6239714088607062, 'psi': 0.6406097457270392}-{'f1_val': 0.6399105422281682, 'auprc': 0.6127508051007706, 'loss_val': 0.5597411248346768, 'psi': 0.6290466473772092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=20 head_norm_before_train=1.441398 cos_to_last_merge=0.9997 (last merge round=18)
[S14] round=20 local utility u=0.008932 metrics={'f1_val': 0.9968229117791292, 'auprc': 0.9957207325440378, 'loss_val': 0.09546930867084709, 'psi': 0.9963820400850927}-{'f1_val': 0.9976511180498535, 'auprc': 0.9957213244781746, 'loss_val': 0.11830452876093772, 'psi': 0.996879200621182}
[S15] START round=20 head_norm_before_train=0.951562 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6996208681506619, 'auprc': 0.9853066164142495, 'loss_val': 0.3993695385220766, 'psi': 0.813895167456097}-{'f1_val': 0.8420120337581547, 'auprc': 0.9925492301096064, 'loss_val': 0.24874435508039489, 'psi': 0.9022269122987354}
[S16] START round=20 head_norm_before_train=1.428331 cos_to_last_merge=0.8316 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=20 local utility u=0.232596 metrics={'f1_val': 0.8642221795938093, 'auprc': 0.970596229099197, 'loss_val': 0.3305459844651807, 'psi': 0.9067717993959644}-{'f1_val': 0.8319176467218241, 'auprc': 0.9874852292832417, 'loss_val': 0.652578554016898, 'psi': 0.8941446797463911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=20 head_norm_before_train=1.410308 cos_to_last_merge=0.8301 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=20 local utility u=1.000000 metrics={'f1_val': 0.6319164458591314, 'auprc': 0.8808650211853671, 'loss_val': 0.5834771678824717, 'psi': 0.7314958759896257}-{'f1_val': 0.3987406886082847, 'auprc': 0.6951917514620845, 'loss_val': 0.9746459977610319, 'psi': 0.5173211137498046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:33908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33911
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.086 → S3@127.0.0.1:33903
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6996 head_norm=1.025128
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.613520e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6996 head_norm=0.970861 delta_norm=0.161352
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.269 → S8@127.0.0.1:33909
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:33915
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9991
[S10] RECEIVED delta(kind=head bytes=1803) from S9
[S10] cosine check vs S9: cos=-0.0317
[S10] DROPPED delta from S9 (cos=-0.0317 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=-0.0721
[S6] DROPPED delta from S10 (cos=-0.0721 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] cosine check vs S3: cos=0.8980
[S9] ⇄ pheromone p=0.195 → S10@127.0.0.1:33911
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.6881 head_norm=0.945992
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.536240e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.6892 head_norm=0.933441 delta_norm=0.153624
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.102 → S4@127.0.0.1:33904
[S14] ⇄ pheromone p=0.105 → S7@127.0.0.1:33908
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] ⇄ pheromone p=0.126 → S6@127.0.0.1:33907
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.9932
[S8] ⇄ pheromone p=0.114 → S15@127.0.0.1:33915
[S2] START round=21 head_norm_before_train=0.998245 cos_to_last_merge=0.9826 (last merge round=17)
[S2] round=21 local utility u=0.176954 metrics={'f1_val': 0.700410363496069, 'auprc': 0.671399959383367, 'loss_val': 0.3228416488878512, 'psi': 0.6888062018509882}-{'f1_val': 0.6730185708619871, 'auprc': 0.670785085356906, 'loss_val': 0.5105551302073431, 'psi': 0.6721251766599546}
[S3] START round=21 head_norm_before_train=0.933441 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.4703985944377043, 'auprc': 0.9741512156691895, 'loss_val': 0.6981892521657179, 'psi': 0.6718996429302984}-{'f1_val': 0.6881274869022438, 'auprc': 0.7401409567801729, 'loss_val': 0.46121057031971174, 'psi': 0.7089328748534154}
[S4] START round=21 head_norm_before_train=1.019327 cos_to_last_merge=0.9993 (last merge round=19)
[S4] round=21 local utility u=0.005641 metrics={'f1_val': 0.9428720544935212, 'auprc': 0.9563013215114323, 'loss_val': 0.35184853765459023, 'psi': 0.9482437613006857}-{'f1_val': 0.9473706959513055, 'auprc': 0.9529675798325681, 'loss_val': 0.3801211218186099, 'psi': 0.9496094495038105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9429 head_norm=1.061191
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.432071e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9432 head_norm=0.975379 delta_norm=0.243207
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] START round=21 head_norm_before_train=1.108318 cos_to_last_merge=0.9753 (last merge round=13)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.5466670344674058, 'auprc': 0.8552277487190202, 'loss_val': 0.5889106288042608, 'psi': 0.6700913201680516}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898421856868194, 'loss_val': 0.3227614472441182, 'psi': 0.816129664735076}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.110086 cos_to_last_merge=0.9960 (last merge round=17)
[S6] round=21 local utility u=0.563993 metrics={'f1_val': 0.6992348393413128, 'auprc': 0.98238854270812, 'loss_val': 0.3141851382839449, 'psi': 0.8124963206880358}-{'f1_val': 0.6590176885917065, 'auprc': 0.7827620320694603, 'loss_val': 0.6019881967415787, 'psi': 0.708515425982808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=21 head_norm_before_train=1.436272 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=1.000000 metrics={'f1_val': 0.6824934034593011, 'auprc': 0.972882543157566, 'loss_val': 0.46490485936159615, 'psi': 0.7986490593386071}-{'f1_val': 0.39623124575302693, 'auprc': 0.7575346628595111, 'loss_val': 0.9706230862086634, 'psi': 0.5407526125956206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6825 head_norm=1.448531
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.050932e-02
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6823 head_norm=1.460756 delta_norm=0.040509
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] START round=21 head_norm_before_train=1.014866 cos_to_last_merge=0.9988 (last merge round=19)
[S8] round=21 local utility u=0.305022 metrics={'f1_val': 0.6994832319236797, 'auprc': 0.9829475318240789, 'loss_val': 0.368300308788413, 'psi': 0.8128689518838393}-{'f1_val': 0.6997274788610883, 'auprc': 0.79341048918362, 'loss_val': 0.41119769018976116, 'psi': 0.737200682990101}
[S9] START round=21 head_norm_before_train=1.795264 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9831327992893777, 'auprc': 0.9978476300906172, 'loss_val': 0.0820606537597988, 'psi': 0.9890187316098735}-{'f1_val': 0.9962500947792776, 'auprc': 0.9941944574311288, 'loss_val': 0.04664827565175822, 'psi': 0.995427839840018}
[S10] START round=21 head_norm_before_train=1.818265 (no previous merge yet)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9944491306888598, 'loss_val': 0.06766296145936103, 'psi': 0.9951425184387258}-{'f1_val': 0.9956047769386365, 'auprc': 0.9977597430604139, 'loss_val': 0.06854913508718163, 'psi': 0.9964667633873475}
[S11] START round=21 head_norm_before_train=1.514471 cos_to_last_merge=0.8030 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.803
[S11] round=21 local utility u=0.032204 metrics={'f1_val': 0.9621231157875891, 'auprc': 0.9980709842680724, 'loss_val': 0.12834048860433675, 'psi': 0.9765022631797824}-{'f1_val': 0.9583017359231194, 'auprc': 0.9978527202743025, 'loss_val': 0.1691663926585541, 'psi': 0.9741221296635927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=21 head_norm_before_train=1.345928 cos_to_last_merge=0.8324 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.832
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6201357229787787, 'auprc': 0.5736259557652369, 'loss_val': 0.6540922380184652, 'psi': 0.601531816093362}-{'f1_val': 0.6381044625998468, 'auprc': 0.6443676704178277, 'loss_val': 0.6239714088607062, 'psi': 0.6406097457270392}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.473993 cos_to_last_merge=0.9989 (last merge round=18)
[S14] round=21 local utility u=0.003502 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.995662218411578, 'loss_val': 0.08826593306685696, 'psi': 0.9963562309973235}-{'f1_val': 0.9968229117791292, 'auprc': 0.9957207325440378, 'loss_val': 0.09546930867084709, 'psi': 0.9963820400850927}
[S15] START round=21 head_norm_before_train=0.970861 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.039053 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.9872959612958166, 'loss_val': 0.3359343861812554, 'psi': 0.8155611905404823}-{'f1_val': 0.6996208681506619, 'auprc': 0.9853066164142495, 'loss_val': 0.3993695385220766, 'psi': 0.813895167456097}
[S16] START round=21 head_norm_before_train=1.462895 cos_to_last_merge=0.8263 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.826
[S16] round=21 local utility u=0.116098 metrics={'f1_val': 0.8996935508144804, 'auprc': 0.9906531338260433, 'loss_val': 0.3713482607071224, 'psi': 0.9360773840191056}-{'f1_val': 0.8642221795938093, 'auprc': 0.970596229099197, 'loss_val': 0.3305459844651807, 'psi': 0.9067717993959644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=21 head_norm_before_train=1.430186 cos_to_last_merge=0.8261 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3978625909641622, 'auprc': 0.7132809659012858, 'loss_val': 0.8756229217972606, 'psi': 0.5240299409390117}-{'f1_val': 0.6319164458591314, 'auprc': 0.8808650211853671, 'loss_val': 0.5834771678824717, 'psi': 0.7314958759896257}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:33908
[S14] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S15
[S8] cosine check vs S15: cos=0.9909
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.9990
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.9702
[S8] sending update (kind=head size=1792 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.7011 head_norm=1.025179
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.677244e-02
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.7011 head_norm=1.018455 delta_norm=0.056772
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1792) from S8
[S15] cosine check vs S8: cos=0.9965
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.6995 head_norm=1.056498
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.182212e-02
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.6995 head_norm=1.038476 delta_norm=0.071822
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.042903 cos_to_last_merge=0.9763 (last merge round=17)
[S2] round=22 local utility u=0.008746 metrics={'f1_val': 0.701132579636681, 'auprc': 0.670306367991704, 'loss_val': 0.30640200038579984, 'psi': 0.6888020949786902}-{'f1_val': 0.700410363496069, 'auprc': 0.671399959383367, 'loss_val': 0.3228416488878512, 'psi': 0.6888062018509882}
[S3] START round=22 head_norm_before_train=0.970050 cos_to_last_merge=0.9989 (last merge round=20)
[S3] round=22 local utility u=0.884626 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9878176153210361, 'loss_val': 0.3516310660885767, 'psi': 0.8155356219276153}-{'f1_val': 0.4703985944377043, 'auprc': 0.9741512156691895, 'loss_val': 0.6981892521657179, 'psi': 0.6718996429302984}
[S4] START round=22 head_norm_before_train=0.975379 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9405736062139153, 'auprc': 0.9562532219164291, 'loss_val': 0.39044195338212534, 'psi': 0.9468454524949208}-{'f1_val': 0.9428720544935212, 'auprc': 0.9563013215114323, 'loss_val': 0.35184853765459023, 'psi': 0.9482437613006857}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=1.124140 cos_to_last_merge=0.9728 (last merge round=13)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.43229601904367504, 'auprc': 0.8534843512188015, 'loss_val': 0.7341983305077774, 'psi': 0.6007713519137257}-{'f1_val': 0.5466670344674058, 'auprc': 0.8552277487190202, 'loss_val': 0.5889106288042608, 'psi': 0.6700913201680516}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.132213 cos_to_last_merge=0.9940 (last merge round=17)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.6684013459154502, 'auprc': 0.7784484620202714, 'loss_val': 0.6362004566941811, 'psi': 0.7124201923573787}-{'f1_val': 0.6992348393413128, 'auprc': 0.98238854270812, 'loss_val': 0.3141851382839449, 'psi': 0.8124963206880358}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=1.460756 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.3878747866698162, 'auprc': 0.7603842455722368, 'loss_val': 1.0851864130779623, 'psi': 0.5368785702307844}-{'f1_val': 0.6824934034593011, 'auprc': 0.972882543157566, 'loss_val': 0.46490485936159615, 'psi': 0.7986490593386071}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.3879 head_norm=1.474358
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.678040e-02
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.3875 head_norm=1.490731 delta_norm=0.046780
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] START round=22 head_norm_before_train=1.038476 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.016958 metrics={'f1_val': 0.698792678947219, 'auprc': 0.9902668541822685, 'loss_val': 0.35219835938828276, 'psi': 0.8153823490412387}-{'f1_val': 0.6994832319236797, 'auprc': 0.9829475318240789, 'loss_val': 0.368300308788413, 'psi': 0.8128689518838393}
[S9] START round=22 head_norm_before_train=1.811182 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9809641309293191, 'auprc': 0.9979588920870663, 'loss_val': 0.08160793845700495, 'psi': 0.987762035392418}-{'f1_val': 0.9831327992893777, 'auprc': 0.9978476300906172, 'loss_val': 0.0820606537597988, 'psi': 0.9890187316098735}
[S10] START round=22 head_norm_before_train=1.838149 (no previous merge yet)
[S10] round=22 local utility u=0.012935 metrics={'f1_val': 0.99597747293297, 'auprc': 0.996918176982013, 'loss_val': 0.05143643088306801, 'psi': 0.9963537545525871}-{'f1_val': 0.9956047769386365, 'auprc': 0.9944491306888598, 'loss_val': 0.06766296145936103, 'psi': 0.9951425184387258}
[S11] START round=22 head_norm_before_train=1.546479 cos_to_last_merge=0.7986 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.799
[S11] round=22 local utility u=0.115277 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9982450301486278, 'loss_val': 0.10733439633445803, 'psi': 0.9974745099062279}-{'f1_val': 0.9621231157875891, 'auprc': 0.9980709842680724, 'loss_val': 0.12834048860433675, 'psi': 0.9765022631797824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=22 head_norm_before_train=1.360627 cos_to_last_merge=0.8299 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5822822226622761, 'auprc': 0.5837839404450051, 'loss_val': 0.7088374202521892, 'psi': 0.5828829097753677}-{'f1_val': 0.6201357229787787, 'auprc': 0.5736259557652369, 'loss_val': 0.6540922380184652, 'psi': 0.601531816093362}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.508377 cos_to_last_merge=0.9977 (last merge round=18)
[S14] round=22 local utility u=0.003478 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969850021197387, 'loss_val': 0.08634980111397962, 'psi': 0.9969925057424945}-{'f1_val': 0.9968189060544872, 'auprc': 0.995662218411578, 'loss_val': 0.08826593306685696, 'psi': 0.9963562309973235}
[S15] START round=22 head_norm_before_train=1.018455 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.405558 metrics={'f1_val': 0.8259025723263045, 'auprc': 0.9874253369116318, 'loss_val': 0.27419393885747306, 'psi': 0.8905116781604354}-{'f1_val': 0.7010713433702593, 'auprc': 0.9872959612958166, 'loss_val': 0.3359343861812554, 'psi': 0.8155611905404823}
[S16] START round=22 head_norm_before_train=1.494338 cos_to_last_merge=0.8221 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.822
[S16] round=22 local utility u=0.296617 metrics={'f1_val': 0.9660814560907997, 'auprc': 0.9839995406200014, 'loss_val': 0.1564800974105232, 'psi': 0.9732486899024804}-{'f1_val': 0.8996935508144804, 'auprc': 0.9906531338260433, 'loss_val': 0.3713482607071224, 'psi': 0.9360773840191056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=22 head_norm_before_train=1.443143 cos_to_last_merge=0.8237 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=22 local utility u=1.000000 metrics={'f1_val': 0.7212324210208487, 'auprc': 0.8864729220151473, 'loss_val': 0.5360440905492754, 'psi': 0.7873286214185682}-{'f1_val': 0.3978625909641622, 'auprc': 0.7132809659012858, 'loss_val': 0.8756229217972606, 'psi': 0.5240299409390117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:33908
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:33915
[S8] RECEIVED delta(kind=head bytes=1792) from S15
[S8] cosine check vs S15: cos=0.9959
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9991
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=-0.0679
[S6] DROPPED delta from S10 (cos=-0.0679 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] cosine check vs S3: cos=0.9187
[S3] RECEIVED delta(kind=head bytes=1791) from S2
[S3] cosine check vs S2: cos=0.9590
[S8] sending update (kind=head size=1793 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.8259 head_norm=1.079101
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.140186e-02
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.8078 head_norm=1.066093 delta_norm=0.061402
[S15] aggregate: ROLLBACK (f1_val pre=0.826 post=0.808 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7007 head_norm=1.009188
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.459197e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7007 head_norm=1.025458 delta_norm=0.145920
[S3] aggregate: ACCEPT kept=['S2', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] cosine check vs S8: cos=0.9989
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.6988 head_norm=1.071982
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.860818e-02
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.6988 head_norm=1.074449 delta_norm=0.048608
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.080736 cos_to_last_merge=0.9707 (last merge round=17)
[S2] round=23 local utility u=0.003992 metrics={'f1_val': 0.7005909005108348, 'auprc': 0.6711608091553437, 'loss_val': 0.2977302798669926, 'psi': 0.6888188639686383}-{'f1_val': 0.701132579636681, 'auprc': 0.670306367991704, 'loss_val': 0.30640200038579984, 'psi': 0.6888020949786902}
[S3] START round=23 head_norm_before_train=1.025458 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.019991 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9982048522299487, 'loss_val': 0.34236082077273455, 'psi': 0.8196455423921029}-{'f1_val': 0.7006809596653347, 'auprc': 0.9878176153210361, 'loss_val': 0.3516310660885767, 'psi': 0.8155356219276153}
[S4] START round=23 head_norm_before_train=1.015606 cos_to_last_merge=0.9989 (last merge round=21)
[S4] round=23 local utility u=0.026909 metrics={'f1_val': 0.9413769542067585, 'auprc': 0.9574649174890332, 'loss_val': 0.3450790148014566, 'psi': 0.9478121395196684}-{'f1_val': 0.9405736062139153, 'auprc': 0.9562532219164291, 'loss_val': 0.39044195338212534, 'psi': 0.9468454524949208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9414 head_norm=1.055400
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.231085e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9416 head_norm=1.008161 delta_norm=0.223109
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] START round=23 head_norm_before_train=1.137410 cos_to_last_merge=0.9709 (last merge round=13)
[S5] round=23 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9913352077247387, 'loss_val': 0.2894511710931585, 'psi': 0.8167268735502438}-{'f1_val': 0.43229601904367504, 'auprc': 0.8534843512188015, 'loss_val': 0.7341983305077774, 'psi': 0.6007713519137257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=23 head_norm_before_train=1.156236 cos_to_last_merge=0.9918 (last merge round=17)
[S6] round=23 local utility u=0.506280 metrics={'f1_val': 0.6960299672988718, 'auprc': 0.9546573133414329, 'loss_val': 0.3180394627901132, 'psi': 0.7994809057158963}-{'f1_val': 0.6684013459154502, 'auprc': 0.7784484620202714, 'loss_val': 0.6362004566941811, 'psi': 0.7124201923573787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=23 head_norm_before_train=1.490731 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.6687576016622573, 'auprc': 0.8302918796389678, 'loss_val': 0.5656344675017556, 'psi': 0.7333713128529415}-{'f1_val': 0.3878747866698162, 'auprc': 0.7603842455722368, 'loss_val': 1.0851864130779623, 'psi': 0.5368785702307844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6688 head_norm=1.500552
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.477458e-02
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6656 head_norm=1.518348 delta_norm=0.044775
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] START round=23 head_norm_before_train=1.074449 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.7135821626136513, 'auprc': 0.7898630567399996, 'loss_val': 0.5850684341226542, 'psi': 0.7440945202641907}-{'f1_val': 0.698792678947219, 'auprc': 0.9902668541822685, 'loss_val': 0.35219835938828276, 'psi': 0.8153823490412387}
[S9] START round=23 head_norm_before_train=1.822999 (no previous merge yet)
[S9] round=23 local utility u=0.063637 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9941775620602624, 'loss_val': 0.034704948679796094, 'psi': 0.9954210816916715}-{'f1_val': 0.9809641309293191, 'auprc': 0.9979588920870663, 'loss_val': 0.08160793845700495, 'psi': 0.987762035392418}
[S10] START round=23 head_norm_before_train=1.856566 (no previous merge yet)
[S10] round=23 local utility u=0.001945 metrics={'f1_val': 0.99597747293297, 'auprc': 0.9969678127781256, 'loss_val': 0.04769549329353052, 'psi': 0.9963736088710322}-{'f1_val': 0.99597747293297, 'auprc': 0.996918176982013, 'loss_val': 0.05143643088306801, 'psi': 0.9963537545525871}
[S11] START round=23 head_norm_before_train=1.576389 cos_to_last_merge=0.7943 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.794
[S11] round=23 local utility u=0.010409 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982519236577487, 'loss_val': 0.08405460494145037, 'psi': 0.9972289721712533}-{'f1_val': 0.996960829744628, 'auprc': 0.9982450301486278, 'loss_val': 0.10733439633445803, 'psi': 0.9974745099062279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=23 head_norm_before_train=1.375227 cos_to_last_merge=0.8279 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.828
[S13] round=23 local utility u=0.061433 metrics={'f1_val': 0.6150090721600641, 'auprc': 0.548555845845511, 'loss_val': 0.6766479001629381, 'psi': 0.5884277816342428}-{'f1_val': 0.5822822226622761, 'auprc': 0.5837839404450051, 'loss_val': 0.7088374202521892, 'psi': 0.5828829097753677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=23 head_norm_before_train=1.537242 cos_to_last_merge=0.9965 (last merge round=18)
[S14] round=23 local utility u=0.006232 metrics={'f1_val': 0.9968305862100909, 'auprc': 0.996415783263618, 'loss_val': 0.0711759948345756, 'psi': 0.9966646650315018}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969850021197387, 'loss_val': 0.08634980111397962, 'psi': 0.9969925057424945}
[S15] START round=23 head_norm_before_train=1.066093 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.778957386620425, 'auprc': 0.9876498742087756, 'loss_val': 0.25396603414835095, 'psi': 0.8624343816557652}-{'f1_val': 0.8259025723263045, 'auprc': 0.9874253369116318, 'loss_val': 0.27419393885747306, 'psi': 0.8905116781604354}
[S16] START round=23 head_norm_before_train=1.526314 cos_to_last_merge=0.8185 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8328565660883305, 'auprc': 0.9932800601833626, 'loss_val': 0.7707431671709609, 'psi': 0.8970259637263434}-{'f1_val': 0.9660814560907997, 'auprc': 0.9839995406200014, 'loss_val': 0.1564800974105232, 'psi': 0.9732486899024804}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=1.458575 cos_to_last_merge=0.8212 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6564250574270007, 'auprc': 0.7158043181020165, 'loss_val': 0.887310121095674, 'psi': 0.6801767616970071}-{'f1_val': 0.7212324210208487, 'auprc': 0.8864729220151473, 'loss_val': 0.5360440905492754, 'psi': 0.7873286214185682}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:33903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:33904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:33908
[S3] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7790 head_norm=1.130067
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.877710e-02
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7753 head_norm=1.099838 delta_norm=0.058777
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1806) from S14
[S7] cosine check vs S14: cos=0.9992
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] cosine check vs S10: cos=-0.0661
[S6] DROPPED delta from S10 (cos=-0.0661 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1792) from S2
[S3] cosine check vs S2: cos=0.9822
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] cosine check vs S3: cos=0.9520
[S10] RECEIVED delta(kind=head bytes=1804) from S9
[S10] cosine check vs S9: cos=-0.0330
[S10] DROPPED delta from S9 (cos=-0.0330 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.7006 head_norm=1.064054
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.055190e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.7006 head_norm=1.083335 delta_norm=0.105519
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.112334 cos_to_last_merge=0.9660 (last merge round=17)
[S2] round=24 local utility u=0.012005 metrics={'f1_val': 0.7004881108700358, 'auprc': 0.6785946782453609, 'loss_val': 0.2954043961147179, 'psi': 0.6917307378201658}-{'f1_val': 0.7005909005108348, 'auprc': 0.6711608091553437, 'loss_val': 0.2977302798669926, 'psi': 0.6888188639686383}
[S3] START round=24 head_norm_before_train=1.083335 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.005979 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9987639824227885, 'loss_val': 0.3320800260642588, 'psi': 0.8198691944692388}-{'f1_val': 0.7006060025002057, 'auprc': 0.9982048522299487, 'loss_val': 0.34236082077273455, 'psi': 0.8196455423921029}
[S4] START round=24 head_norm_before_train=1.008161 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9408235248892459, 'auprc': 0.956150755546679, 'loss_val': 0.3800679799590416, 'psi': 0.9469544171522192}-{'f1_val': 0.9413769542067585, 'auprc': 0.9574649174890332, 'loss_val': 0.3450790148014566, 'psi': 0.9478121395196684}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9408 head_norm=1.049008
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.825087e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9412 head_norm=1.040675 delta_norm=0.182509
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] START round=24 head_norm_before_train=1.150925 cos_to_last_merge=0.9690 (last merge round=13)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.4208155947875312, 'auprc': 0.7814879079501401, 'loss_val': 0.9780681613380087, 'psi': 0.5650845200525748}-{'f1_val': 0.7003213174339138, 'auprc': 0.9913352077247387, 'loss_val': 0.2894511710931585, 'psi': 0.8167268735502438}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.171743 cos_to_last_merge=0.9900 (last merge round=17)
[S6] round=24 local utility u=0.740080 metrics={'f1_val': 0.9587844014676565, 'auprc': 0.9467885637272433, 'loss_val': 0.39079911186345506, 'psi': 0.9539860663714912}-{'f1_val': 0.6960299672988718, 'auprc': 0.9546573133414329, 'loss_val': 0.3180394627901132, 'psi': 0.7994809057158963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=24 head_norm_before_train=1.518348 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5653389293215548, 'auprc': 0.7905807951518766, 'loss_val': 0.7294088236048017, 'psi': 0.6554356756536837}-{'f1_val': 0.6687576016622573, 'auprc': 0.8302918796389678, 'loss_val': 0.5656344675017556, 'psi': 0.7333713128529415}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.5653 head_norm=1.529178
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.330158e-02
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.5615 head_norm=1.547608 delta_norm=0.043302
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] START round=24 head_norm_before_train=1.101597 cos_to_last_merge=0.9994 (last merge round=22)
[S8] round=24 local utility u=0.305630 metrics={'f1_val': 0.6935424395187622, 'auprc': 0.9551851607075681, 'loss_val': 0.34953737413816555, 'psi': 0.7981995279942846}-{'f1_val': 0.7135821626136513, 'auprc': 0.7898630567399996, 'loss_val': 0.5850684341226542, 'psi': 0.7440945202641907}
[S9] START round=24 head_norm_before_train=1.830490 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.985716065895656, 'auprc': 0.998610716960355, 'loss_val': 0.06406459171512464, 'psi': 0.9908739263215356}-{'f1_val': 0.9962500947792776, 'auprc': 0.9941775620602624, 'loss_val': 0.034704948679796094, 'psi': 0.9954210816916715}
[S10] START round=24 head_norm_before_train=1.874038 (no previous merge yet)
[S10] round=24 local utility u=0.002037 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9969508258958215, 'loss_val': 0.04382797533398062, 'psi': 0.9963924863113325}-{'f1_val': 0.99597747293297, 'auprc': 0.9969678127781256, 'loss_val': 0.04769549329353052, 'psi': 0.9963736088710322}
[S11] START round=24 head_norm_before_train=1.608048 cos_to_last_merge=0.7901 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.790
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9487968535934175, 'auprc': 0.9973607037687277, 'loss_val': 0.17040171773619295, 'psi': 0.9682223936635416}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982519236577487, 'loss_val': 0.08405460494145037, 'psi': 0.9972289721712533}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=1.388959 cos_to_last_merge=0.8258 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.826
[S13] round=24 local utility u=0.065884 metrics={'f1_val': 0.6133305955291246, 'auprc': 0.5910835379486484, 'loss_val': 0.6623914326067569, 'psi': 0.6044317724969341}-{'f1_val': 0.6150090721600641, 'auprc': 0.548555845845511, 'loss_val': 0.6766479001629381, 'psi': 0.5884277816342428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=24 head_norm_before_train=1.567018 cos_to_last_merge=0.9952 (last merge round=18)
[S14] round=24 local utility u=0.008056 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9971537654951025, 'loss_val': 0.061193456722514944, 'psi': 0.9973513528279336}-{'f1_val': 0.9968305862100909, 'auprc': 0.996415783263618, 'loss_val': 0.0711759948345756, 'psi': 0.9966646650315018}
[S15] START round=24 head_norm_before_train=1.099838 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.523512 metrics={'f1_val': 0.9401769013891187, 'auprc': 0.9881261290923551, 'loss_val': 0.17568728391020724, 'psi': 0.9593565924704133}-{'f1_val': 0.778957386620425, 'auprc': 0.9876498742087756, 'loss_val': 0.25396603414835095, 'psi': 0.8624343816557652}
[S16] START round=24 head_norm_before_train=1.555647 cos_to_last_merge=0.8148 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.815
[S16] round=24 local utility u=0.091260 metrics={'f1_val': 0.8458470979775041, 'auprc': 0.9944443524732968, 'loss_val': 0.6696590675077723, 'psi': 0.9052859997758211}-{'f1_val': 0.8328565660883305, 'auprc': 0.9932800601833626, 'loss_val': 0.7707431671709609, 'psi': 0.8970259637263434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=24 head_norm_before_train=1.475265 cos_to_last_merge=0.8190 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.659072119630485, 'auprc': 0.6947811958290562, 'loss_val': 0.9309138567350641, 'psi': 0.6733557501099134}-{'f1_val': 0.6564250574270007, 'auprc': 0.7158043181020165, 'loss_val': 0.887310121095674, 'psi': 0.6801767616970071}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] sending update (kind=head size=1787 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33915
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] cosine check vs S15: cos=0.9964
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.9964
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.6935 head_norm=1.128002
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.132541e-02
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.6934 head_norm=1.143574 delta_norm=0.051325
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.138383 cos_to_last_merge=0.9621 (last merge round=17)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7010542679632784, 'auprc': 0.675004310512726, 'loss_val': 0.2901490486641352, 'psi': 0.6906342849830575}-{'f1_val': 0.7004881108700358, 'auprc': 0.6785946782453609, 'loss_val': 0.2954043961147179, 'psi': 0.6917307378201658}
[S3] START round=25 head_norm_before_train=1.118653 cos_to_last_merge=0.9990 (last merge round=23)
[S3] round=25 local utility u=0.010445 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9988178626051103, 'loss_val': 0.31135229075820736, 'psi': 0.8198907465421674}-{'f1_val': 0.7006060025002057, 'auprc': 0.9987639824227885, 'loss_val': 0.3320800260642588, 'psi': 0.8198691944692388}
[S4] START round=25 head_norm_before_train=1.040675 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.001155 metrics={'f1_val': 0.9416447100043357, 'auprc': 0.9563905433457652, 'loss_val': 0.38340380196391183, 'psi': 0.9475430433409076}-{'f1_val': 0.9408235248892459, 'auprc': 0.956150755546679, 'loss_val': 0.3800679799590416, 'psi': 0.9469544171522192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=25 head_norm_before_train=1.163962 cos_to_last_merge=0.9671 (last merge round=13)
[S5] round=25 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.991277245104512, 'loss_val': 0.26551124764552636, 'psi': 0.816703688502153}-{'f1_val': 0.4208155947875312, 'auprc': 0.7814879079501401, 'loss_val': 0.9780681613380087, 'psi': 0.5650845200525748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=25 head_norm_before_train=1.187492 cos_to_last_merge=0.9879 (last merge round=17)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.708350392886498, 'auprc': 0.9095322956528016, 'loss_val': 0.38501933193198135, 'psi': 0.7888231539930195}-{'f1_val': 0.9587844014676565, 'auprc': 0.9467885637272433, 'loss_val': 0.39079911186345506, 'psi': 0.9539860663714912}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.547608 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.052221 metrics={'f1_val': 0.5726108525327955, 'auprc': 0.7966729000318657, 'loss_val': 0.6868740646654886, 'psi': 0.6622356715324236}-{'f1_val': 0.5653389293215548, 'auprc': 0.7905807951518766, 'loss_val': 0.7294088236048017, 'psi': 0.6554356756536837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=25 head_norm_before_train=1.143574 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.7129225948459229, 'auprc': 0.7931678917969962, 'loss_val': 0.3775321769722691, 'psi': 0.7450207136263522}-{'f1_val': 0.6935424395187622, 'auprc': 0.9551851607075681, 'loss_val': 0.34953737413816555, 'psi': 0.7981995279942846}
[S9] START round=25 head_norm_before_train=1.839150 (no previous merge yet)
[S9] round=25 local utility u=0.042431 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9994634862585887, 'loss_val': 0.032425445618485794, 'psi': 0.9962814545271095}-{'f1_val': 0.985716065895656, 'auprc': 0.998610716960355, 'loss_val': 0.06406459171512464, 'psi': 0.9908739263215356}
[S10] START round=25 head_norm_before_train=1.895567 (no previous merge yet)
[S10] round=25 local utility u=0.001908 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9969548846439011, 'loss_val': 0.040024277469644626, 'psi': 0.9963941098105644}-{'f1_val': 0.9960202599216732, 'auprc': 0.9969508258958215, 'loss_val': 0.04382797533398062, 'psi': 0.9963924863113325}
[S11] START round=25 head_norm_before_train=1.634753 cos_to_last_merge=0.7866 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.787
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.834068493538352, 'auprc': 0.9946122415863116, 'loss_val': 0.2136951273682386, 'psi': 0.8982859927575357}-{'f1_val': 0.9487968535934175, 'auprc': 0.9973607037687277, 'loss_val': 0.17040171773619295, 'psi': 0.9682223936635416}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.401339 cos_to_last_merge=0.8237 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.824
[S13] round=25 local utility u=0.123587 metrics={'f1_val': 0.5980144712463729, 'auprc': 0.6702402168842384, 'loss_val': 0.5607908697923548, 'psi': 0.6269047695015191}-{'f1_val': 0.6133305955291246, 'auprc': 0.5910835379486484, 'loss_val': 0.6623914326067569, 'psi': 0.6044317724969341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=25 head_norm_before_train=1.597968 cos_to_last_merge=0.9937 (last merge round=18)
[S14] round=25 local utility u=0.002248 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.997105427963086, 'loss_val': 0.05756065076778392, 'psi': 0.9974328420151466}-{'f1_val': 0.9974830777164877, 'auprc': 0.9971537654951025, 'loss_val': 0.061193456722514944, 'psi': 0.9973513528279336}
[S15] START round=25 head_norm_before_train=1.161207 cos_to_last_merge=0.9988 (last merge round=23)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.8092403470768306, 'auprc': 0.9913365740198941, 'loss_val': 0.26423562471150713, 'psi': 0.882078837854056}-{'f1_val': 0.9401769013891187, 'auprc': 0.9881261290923551, 'loss_val': 0.17568728391020724, 'psi': 0.9593565924704133}
[S16] START round=25 head_norm_before_train=1.580092 cos_to_last_merge=0.8120 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.812
[S16] round=25 local utility u=0.357001 metrics={'f1_val': 0.9115040948850226, 'auprc': 0.9927589444707221, 'loss_val': 0.3445435817615105, 'psi': 0.9440060347193024}-{'f1_val': 0.8458470979775041, 'auprc': 0.9944443524732968, 'loss_val': 0.6696590675077723, 'psi': 0.9052859997758211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=25 head_norm_before_train=1.490797 cos_to_last_merge=0.8172 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=25 local utility u=0.468592 metrics={'f1_val': 0.6876749102423606, 'auprc': 0.8740624755972282, 'loss_val': 0.7031898990327506, 'psi': 0.7622299363843077}-{'f1_val': 0.659072119630485, 'auprc': 0.6947811958290562, 'loss_val': 0.9309138567350641, 'psi': 0.6733557501099134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.8092 head_norm=1.216037
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.142909e-02
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.8021 head_norm=1.170016 delta_norm=0.081429
[S15] aggregate: ROLLBACK (f1_val pre=0.809 post=0.802 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.217 → S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.113 → S15@127.0.0.1:33915
[S2] START round=26 head_norm_before_train=1.161432 cos_to_last_merge=0.9586 (last merge round=17)
[S2] round=26 local utility u=0.164481 metrics={'f1_val': 0.7038991205820172, 'auprc': 0.7989659714996368, 'loss_val': 0.3501409855522122, 'psi': 0.7419258609490651}-{'f1_val': 0.7010542679632784, 'auprc': 0.675004310512726, 'loss_val': 0.2901490486641352, 'psi': 0.6906342849830575}
[S3] START round=26 head_norm_before_train=1.150728 cos_to_last_merge=0.9967 (last merge round=23)
[S3] round=26 local utility u=0.005886 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9991213693018354, 'loss_val': 0.2994116659069919, 'psi': 0.8199042644735282}-{'f1_val': 0.7006060025002057, 'auprc': 0.9988178626051103, 'loss_val': 0.31135229075820736, 'psi': 0.8198907465421674}
[S4] START round=26 head_norm_before_train=1.085395 cos_to_last_merge=0.9979 (last merge round=24)
[S4] round=26 local utility u=0.026698 metrics={'f1_val': 0.9424233553600609, 'auprc': 0.9568941390423689, 'loss_val': 0.3361903698746098, 'psi': 0.948211668832984}-{'f1_val': 0.9416447100043357, 'auprc': 0.9563905433457652, 'loss_val': 0.38340380196391183, 'psi': 0.9475430433409076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=26 head_norm_before_train=1.175711 cos_to_last_merge=0.9653 (last merge round=13)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8555227302592399, 'loss_val': 0.7045459402617916, 'psi': 0.6042688304069193}-{'f1_val': 0.7003213174339138, 'auprc': 0.991277245104512, 'loss_val': 0.26551124764552636, 'psi': 0.816703688502153}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.208344 cos_to_last_merge=0.9850 (last merge round=17)
[S6] round=26 local utility u=0.346624 metrics={'f1_val': 0.7957487606763038, 'auprc': 0.9560543273885643, 'loss_val': 0.3557269210258371, 'psi': 0.859870987361208}-{'f1_val': 0.708350392886498, 'auprc': 0.9095322956528016, 'loss_val': 0.38501933193198135, 'psi': 0.7888231539930195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=26 head_norm_before_train=1.562277 cos_to_last_merge=0.9998 (last merge round=24)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5233625778737139, 'auprc': 0.7850684600877758, 'loss_val': 0.8534091582814287, 'psi': 0.6280449307593386}-{'f1_val': 0.5726108525327955, 'auprc': 0.7966729000318657, 'loss_val': 0.6868740646654886, 'psi': 0.6622356715324236}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.166051 cos_to_last_merge=0.9998 (last merge round=24)
[S8] round=26 local utility u=0.277879 metrics={'f1_val': 0.69879597141206, 'auprc': 0.9778231577493268, 'loss_val': 0.2909807675833636, 'psi': 0.8104068459469667}-{'f1_val': 0.7129225948459229, 'auprc': 0.7931678917969962, 'loss_val': 0.3775321769722691, 'psi': 0.7450207136263522}
[S9] START round=26 head_norm_before_train=1.848439 (no previous merge yet)
[S9] round=26 local utility u=0.009662 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.999456545969845, 'loss_val': 0.02808284150386329, 'psi': 0.9977789254762729}-{'f1_val': 0.9941601000394567, 'auprc': 0.9994634862585887, 'loss_val': 0.032425445618485794, 'psi': 0.9962814545271095}
[S10] START round=26 head_norm_before_train=1.918520 (no previous merge yet)
[S10] round=26 local utility u=0.001669 metrics={'f1_val': 0.99597747293297, 'auprc': 0.9970140843619082, 'loss_val': 0.03660753126121167, 'psi': 0.9963921175045453}-{'f1_val': 0.9960202599216732, 'auprc': 0.9969548846439011, 'loss_val': 0.040024277469644626, 'psi': 0.9963941098105644}
[S11] START round=26 head_norm_before_train=1.651399 cos_to_last_merge=0.7845 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.784
[S11] round=26 local utility u=0.566091 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9970236123800786, 'loss_val': 0.06216810127193784, 'psi': 0.996592545433348}-{'f1_val': 0.834068493538352, 'auprc': 0.9946122415863116, 'loss_val': 0.2136951273682386, 'psi': 0.8982859927575357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=26 head_norm_before_train=1.412848 cos_to_last_merge=0.8211 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.821
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.604311090423709, 'auprc': 0.6114738814350802, 'loss_val': 0.6867180904332645, 'psi': 0.6071762068282575}-{'f1_val': 0.5980144712463729, 'auprc': 0.6702402168842384, 'loss_val': 0.5607908697923548, 'psi': 0.6269047695015191}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.626623 cos_to_last_merge=0.9923 (last merge round=18)
[S14] round=26 local utility u=0.003406 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971520146066317, 'loss_val': 0.048424505518547406, 'psi': 0.9972050198661285}-{'f1_val': 0.9976511180498535, 'auprc': 0.997105427963086, 'loss_val': 0.05756065076778392, 'psi': 0.9974328420151466}
[S15] START round=26 head_norm_before_train=1.170016 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7995867702521816, 'auprc': 0.9893054090175672, 'loss_val': 0.24485198745348266, 'psi': 0.8754742257583359}-{'f1_val': 0.8092403470768306, 'auprc': 0.9913365740198941, 'loss_val': 0.26423562471150713, 'psi': 0.882078837854056}
[S16] START round=26 head_norm_before_train=1.605025 cos_to_last_merge=0.8094 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8554426944397674, 'auprc': 0.994904210547793, 'loss_val': 0.6132609955732934, 'psi': 0.9112273008829777}-{'f1_val': 0.9115040948850226, 'auprc': 0.9927589444707221, 'loss_val': 0.3445435817615105, 'psi': 0.9440060347193024}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.508416 cos_to_last_merge=0.8155 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6443555219130861, 'auprc': 0.66079542658697, 'loss_val': 1.0748437051656354, 'psi': 0.6509314837826397}-{'f1_val': 0.6876749102423606, 'auprc': 0.8740624755972282, 'loss_val': 0.7031898990327506, 'psi': 0.7622299363843077}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.9973
[S2] START round=27 head_norm_before_train=1.181860 cos_to_last_merge=0.9557 (last merge round=17)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7008737635735156, 'auprc': 0.7552606836793565, 'loss_val': 0.2915406843554046, 'psi': 0.722628531615852}-{'f1_val': 0.7038991205820172, 'auprc': 0.7989659714996368, 'loss_val': 0.3501409855522122, 'psi': 0.7419258609490651}
[S3] START round=27 head_norm_before_train=1.179478 cos_to_last_merge=0.9940 (last merge round=23)
[S3] round=27 local utility u=0.005522 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9990711229579438, 'loss_val': 0.2897451380825194, 'psi': 0.8200370249823783}-{'f1_val': 0.7004261945879899, 'auprc': 0.9991213693018354, 'loss_val': 0.2994116659069919, 'psi': 0.8199042644735282}
[S4] START round=27 head_norm_before_train=1.136093 cos_to_last_merge=0.9924 (last merge round=24)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9404691017683148, 'auprc': 0.9526105046792739, 'loss_val': 0.328133808654191, 'psi': 0.9453256629326985}-{'f1_val': 0.9424233553600609, 'auprc': 0.9568941390423689, 'loss_val': 0.3361903698746098, 'psi': 0.948211668832984}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.189574 cos_to_last_merge=0.9629 (last merge round=13)
[S5] round=27 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9649419692019963, 'loss_val': 0.312445839929925, 'psi': 0.8061695781411468}-{'f1_val': 0.43676623050537206, 'auprc': 0.8555227302592399, 'loss_val': 0.7045459402617916, 'psi': 0.6042688304069193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=27 head_norm_before_train=1.231012 cos_to_last_merge=0.9813 (last merge round=17)
[S6] round=27 local utility u=0.640647 metrics={'f1_val': 0.9706153011948436, 'auprc': 0.9776577736253076, 'loss_val': 0.18844157591199584, 'psi': 0.9734322901670291}-{'f1_val': 0.7957487606763038, 'auprc': 0.9560543273885643, 'loss_val': 0.3557269210258371, 'psi': 0.859870987361208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=27 head_norm_before_train=1.580943 cos_to_last_merge=0.9992 (last merge round=24)
[S7] round=27 local utility u=0.524996 metrics={'f1_val': 0.6294401674551781, 'auprc': 0.8203706425737367, 'loss_val': 0.5457899052648345, 'psi': 0.7058123575026015}-{'f1_val': 0.5233625778737139, 'auprc': 0.7850684600877758, 'loss_val': 0.8534091582814287, 'psi': 0.6280449307593386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=27 head_norm_before_train=1.188336 cos_to_last_merge=0.9992 (last merge round=24)
[S8] round=27 local utility u=0.050036 metrics={'f1_val': 0.6994880015618798, 'auprc': 0.9965733667232765, 'loss_val': 0.2513123401068864, 'psi': 0.8183221476264385}-{'f1_val': 0.69879597141206, 'auprc': 0.9778231577493268, 'loss_val': 0.2909807675833636, 'psi': 0.8104068459469667}
[S9] START round=27 head_norm_before_train=1.860243 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9995671940993396, 'loss_val': 0.04539700638152739, 'psi': 0.9930305021413965}-{'f1_val': 0.9966605118138915, 'auprc': 0.999456545969845, 'loss_val': 0.02808284150386329, 'psi': 0.9977789254762729}
[S10] START round=27 head_norm_before_train=1.940301 (no previous merge yet)
[S10] round=27 local utility u=0.000902 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9969682175492476, 'loss_val': 0.034922901868818156, 'psi': 0.996399442972703}-{'f1_val': 0.99597747293297, 'auprc': 0.9970140843619082, 'loss_val': 0.03660753126121167, 'psi': 0.9963921175045453}
[S11] START round=27 head_norm_before_train=1.668553 cos_to_last_merge=0.7827 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.783
[S11] round=27 local utility u=0.000103 metrics={'f1_val': 0.9953451380193115, 'auprc': 0.9973623303480914, 'loss_val': 0.057218201083190985, 'psi': 0.9961520149508234}-{'f1_val': 0.996305167468861, 'auprc': 0.9970236123800786, 'loss_val': 0.06216810127193784, 'psi': 0.996592545433348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=27 head_norm_before_train=1.423871 cos_to_last_merge=0.8193 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=27 local utility u=0.190545 metrics={'f1_val': 0.6453687316056853, 'auprc': 0.6162685001611218, 'loss_val': 0.5663585158771813, 'psi': 0.6337286390278598}-{'f1_val': 0.604311090423709, 'auprc': 0.6114738814350802, 'loss_val': 0.6867180904332645, 'psi': 0.6071762068282575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=27 head_norm_before_train=1.650966 cos_to_last_merge=0.9909 (last merge round=18)
[S14] round=27 local utility u=0.003140 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9971639487446523, 'loss_val': 0.043637065076609305, 'psi': 0.9973554261277535}-{'f1_val': 0.997240356705793, 'auprc': 0.9971520146066317, 'loss_val': 0.048424505518547406, 'psi': 0.9972050198661285}
[S15] START round=27 head_norm_before_train=1.211966 cos_to_last_merge=0.9994 (last merge round=25)
[S15] round=27 local utility u=0.132199 metrics={'f1_val': 0.8335362642184894, 'auprc': 0.9904355996082163, 'loss_val': 0.18754232579696486, 'psi': 0.8962959983743801}-{'f1_val': 0.7995867702521816, 'auprc': 0.9893054090175672, 'loss_val': 0.24485198745348266, 'psi': 0.8754742257583359}
[S16] START round=27 head_norm_before_train=1.627688 cos_to_last_merge=0.8072 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.807
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8462441515125552, 'auprc': 0.9916990552244109, 'loss_val': 0.7426686772688442, 'psi': 0.9044261129972975}-{'f1_val': 0.8554426944397674, 'auprc': 0.994904210547793, 'loss_val': 0.6132609955732934, 'psi': 0.9112273008829777}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.524425 cos_to_last_merge=0.8138 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=27 local utility u=1.000000 metrics={'f1_val': 0.7804025595788121, 'auprc': 0.8728195709055034, 'loss_val': 0.49000306948385847, 'psi': 0.8173693641094886}-{'f1_val': 0.6443555219130861, 'auprc': 0.66079542658697, 'loss_val': 1.0748437051656354, 'psi': 0.6509314837826397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33915
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=0.9946
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.8335 head_norm=1.245997
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.331873e-02
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.8237 head_norm=1.215860 delta_norm=0.063319
[S15] aggregate: ROLLBACK (f1_val pre=0.834 post=0.824 tol_abs=0.005 tol_rel=0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.9982
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.6995 head_norm=1.207753
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.679708e-02
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.6995 head_norm=1.225204 delta_norm=0.066797
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.199568 cos_to_last_merge=0.9532 (last merge round=17)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.701230889339113, 'auprc': 0.6931200727240272, 'loss_val': 0.30851176285445264, 'psi': 0.6979865626930787}-{'f1_val': 0.7008737635735156, 'auprc': 0.7552606836793565, 'loss_val': 0.2915406843554046, 'psi': 0.722628531615852}
[S3] START round=28 head_norm_before_train=1.204221 cos_to_last_merge=0.9914 (last merge round=23)
[S3] round=28 local utility u=0.003381 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9989424676059074, 'loss_val': 0.28259710057397275, 'psi': 0.8199855628415638}-{'f1_val': 0.7006809596653347, 'auprc': 0.9990711229579438, 'loss_val': 0.2897451380825194, 'psi': 0.8200370249823783}
[S4] START round=28 head_norm_before_train=1.184100 cos_to_last_merge=0.9859 (last merge round=24)
[S4] round=28 local utility u=0.043052 metrics={'f1_val': 0.9430778504814865, 'auprc': 0.9627317107719823, 'loss_val': 0.28804679549219575, 'psi': 0.9509393945976848}-{'f1_val': 0.9404691017683148, 'auprc': 0.9526105046792739, 'loss_val': 0.328133808654191, 'psi': 0.9453256629326985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=28 head_norm_before_train=1.199747 cos_to_last_merge=0.9612 (last merge round=13)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.5507915222237241, 'auprc': 0.8559238467333048, 'loss_val': 0.5911042196583295, 'psi': 0.6728444520275564}-{'f1_val': 0.7003213174339138, 'auprc': 0.9649419692019963, 'loss_val': 0.312445839929925, 'psi': 0.8061695781411468}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.254515 cos_to_last_merge=0.9777 (last merge round=17)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.630377889120774, 'auprc': 0.7811914485316256, 'loss_val': 0.6297729180474166, 'psi': 0.6907033128851147}-{'f1_val': 0.9706153011948436, 'auprc': 0.9776577736253076, 'loss_val': 0.18844157591199584, 'psi': 0.9734322901670291}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.598236 cos_to_last_merge=0.9982 (last merge round=24)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.40176788416262954, 'auprc': 0.78037967203137, 'loss_val': 1.1903229268947522, 'psi': 0.5532125993101258}-{'f1_val': 0.6294401674551781, 'auprc': 0.8203706425737367, 'loss_val': 0.5457899052648345, 'psi': 0.7058123575026015}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.225204 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.7001581993598075, 'auprc': 0.983421030394551, 'loss_val': 0.258800891971214, 'psi': 0.8134633317737049}-{'f1_val': 0.6994880015618798, 'auprc': 0.9965733667232765, 'loss_val': 0.2513123401068864, 'psi': 0.8183221476264385}
[S9] START round=28 head_norm_before_train=1.871234 (no previous merge yet)
[S9] round=28 local utility u=0.032438 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.999561767295174, 'loss_val': 0.02594421461160365, 'psi': 0.9975723758976011}-{'f1_val': 0.9886727075027679, 'auprc': 0.9995671940993396, 'loss_val': 0.04539700638152739, 'psi': 0.9930305021413965}
[S10] START round=28 head_norm_before_train=1.957645 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959805328427302, 'loss_val': 0.03490522290967316, 'psi': 0.9955049165487169}-{'f1_val': 0.9960202599216732, 'auprc': 0.9969682175492476, 'loss_val': 0.034922901868818156, 'psi': 0.996399442972703}
[S11] START round=28 head_norm_before_train=1.684783 cos_to_last_merge=0.7808 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.781
[S11] round=28 local utility u=0.005433 metrics={'f1_val': 0.9957060066834579, 'auprc': 0.9979973101538846, 'loss_val': 0.050423347155268985, 'psi': 0.9966225280716285}-{'f1_val': 0.9953451380193115, 'auprc': 0.9973623303480914, 'loss_val': 0.057218201083190985, 'psi': 0.9961520149508234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=28 head_norm_before_train=1.433010 cos_to_last_merge=0.8183 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.818
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5598314952312066, 'auprc': 0.7236397117092435, 'loss_val': 0.8392843559828166, 'psi': 0.6253547818224213}-{'f1_val': 0.6453687316056853, 'auprc': 0.6162685001611218, 'loss_val': 0.5663585158771813, 'psi': 0.6337286390278598}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.672703 cos_to_last_merge=0.9897 (last merge round=18)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971014566434144, 'loss_val': 0.04292051606534771, 'psi': 0.9970390875519648}-{'f1_val': 0.9974830777164877, 'auprc': 0.9971639487446523, 'loss_val': 0.043637065076609305, 'psi': 0.9973554261277535}
[S15] START round=28 head_norm_before_train=1.215860 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6963634042439761, 'auprc': 0.975855556161403, 'loss_val': 0.40879320330455987, 'psi': 0.8081602650109468}-{'f1_val': 0.8335362642184894, 'auprc': 0.9904355996082163, 'loss_val': 0.18754232579696486, 'psi': 0.8962959983743801}
[S16] START round=28 head_norm_before_train=1.647560 cos_to_last_merge=0.8054 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.805
[S16] round=28 local utility u=0.552883 metrics={'f1_val': 0.9340079153556706, 'auprc': 0.9871830257367087, 'loss_val': 0.14993759275805568, 'psi': 0.9552779595080858}-{'f1_val': 0.8462441515125552, 'auprc': 0.9916990552244109, 'loss_val': 0.7426686772688442, 'psi': 0.9044261129972975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=28 head_norm_before_train=1.541913 cos_to_last_merge=0.8120 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6414787416271663, 'auprc': 0.6741224115400116, 'loss_val': 1.0168400844929277, 'psi': 0.6545362095923044}-{'f1_val': 0.7804025595788121, 'auprc': 0.8728195709055034, 'loss_val': 0.49000306948385847, 'psi': 0.8173693641094886}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.6964 head_norm=1.244522
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.038888e-02
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.6965 head_norm=1.225240 delta_norm=0.050389
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.216623 cos_to_last_merge=0.9510 (last merge round=17)
[S2] round=29 local utility u=0.043588 metrics={'f1_val': 0.7073553527837783, 'auprc': 0.7148952875294226, 'loss_val': 0.3234084441699412, 'psi': 0.710371326682036}-{'f1_val': 0.701230889339113, 'auprc': 0.6931200727240272, 'loss_val': 0.30851176285445264, 'psi': 0.6979865626930787}
[S3] START round=29 head_norm_before_train=1.226145 cos_to_last_merge=0.9888 (last merge round=23)
[S3] round=29 local utility u=0.002344 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9988432866942402, 'loss_val': 0.2776108076646006, 'psi': 0.8199458904768969}-{'f1_val': 0.7006809596653347, 'auprc': 0.9989424676059074, 'loss_val': 0.28259710057397275, 'psi': 0.8199855628415638}
[S4] START round=29 head_norm_before_train=1.225552 cos_to_last_merge=0.9798 (last merge round=24)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9398435204482654, 'auprc': 0.9532054210508347, 'loss_val': 0.3042433313407562, 'psi': 0.9451882806892931}-{'f1_val': 0.9430778504814865, 'auprc': 0.9627317107719823, 'loss_val': 0.28804679549219575, 'psi': 0.9509393945976848}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.209335 cos_to_last_merge=0.9597 (last merge round=13)
[S5] round=29 local utility u=0.396638 metrics={'f1_val': 0.653436763854155, 'auprc': 0.8568839369038517, 'loss_val': 0.41657936347660446, 'psi': 0.7348156330740336}-{'f1_val': 0.5507915222237241, 'auprc': 0.8559238467333048, 'loss_val': 0.5911042196583295, 'psi': 0.6728444520275564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=29 head_norm_before_train=1.276047 cos_to_last_merge=0.9742 (last merge round=17)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.8354090302857048, 'auprc': 0.9616675836901414, 'loss_val': 0.2732122682883106, 'psi': 0.8859124516474794}-{'f1_val': 0.630377889120774, 'auprc': 0.7811914485316256, 'loss_val': 0.6297729180474166, 'psi': 0.6907033128851147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=29 head_norm_before_train=1.612986 cos_to_last_merge=0.9973 (last merge round=24)
[S7] round=29 local utility u=0.562678 metrics={'f1_val': 0.5277423849259805, 'auprc': 0.7888088518418684, 'loss_val': 0.8461008002034632, 'psi': 0.6321689716923357}-{'f1_val': 0.40176788416262954, 'auprc': 0.78037967203137, 'loss_val': 1.1903229268947522, 'psi': 0.5532125993101258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=29 head_norm_before_train=1.246616 cos_to_last_merge=0.9998 (last merge round=27)
[S8] round=29 local utility u=0.134512 metrics={'f1_val': 0.7325049839494451, 'auprc': 0.9926313579306432, 'loss_val': 0.21148936294026632, 'psi': 0.8365555335419244}-{'f1_val': 0.7001581993598075, 'auprc': 0.983421030394551, 'loss_val': 0.258800891971214, 'psi': 0.8134633317737049}
[S9] START round=29 head_norm_before_train=1.883417 (no previous merge yet)
[S9] round=29 local utility u=0.001492 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9992851938111516, 'loss_val': 0.024617049149561608, 'psi': 0.9977103846127955}-{'f1_val': 0.9962461149658858, 'auprc': 0.999561767295174, 'loss_val': 0.02594421461160365, 'psi': 0.9975723758976011}
[S10] START round=29 head_norm_before_train=1.973592 (no previous merge yet)
[S10] round=29 local utility u=0.001114 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960668552449231, 'loss_val': 0.03293563146192287, 'psi': 0.9955394455095941}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959805328427302, 'loss_val': 0.03490522290967316, 'psi': 0.9955049165487169}
[S11] START round=29 head_norm_before_train=1.702005 cos_to_last_merge=0.7788 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.779
[S11] round=29 local utility u=0.005508 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974744219810856, 'loss_val': 0.04288472302390143, 'psi': 0.996917971500588}-{'f1_val': 0.9957060066834579, 'auprc': 0.9979973101538846, 'loss_val': 0.050423347155268985, 'psi': 0.9966225280716285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=29 head_norm_before_train=1.441551 cos_to_last_merge=0.8157 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=29 local utility u=0.117793 metrics={'f1_val': 0.5683431292733445, 'auprc': 0.7102875158593367, 'loss_val': 0.6147110715148926, 'psi': 0.6251208839077413}-{'f1_val': 0.5598314952312066, 'auprc': 0.7236397117092435, 'loss_val': 0.8392843559828166, 'psi': 0.6253547818224213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=29 head_norm_before_train=1.694168 cos_to_last_merge=0.9885 (last merge round=18)
[S14] round=29 local utility u=0.000639 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971039121192693, 'loss_val': 0.04164896332446676, 'psi': 0.9970400697423067}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971014566434144, 'loss_val': 0.04292051606534771, 'psi': 0.9970390875519648}
[S15] START round=29 head_norm_before_train=1.225240 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.509090 metrics={'f1_val': 0.8245077017121709, 'auprc': 0.9911636085292734, 'loss_val': 0.2054031537680375, 'psi': 0.8911700644390119}-{'f1_val': 0.6963634042439761, 'auprc': 0.975855556161403, 'loss_val': 0.40879320330455987, 'psi': 0.8081602650109468}
[S16] START round=29 head_norm_before_train=1.665043 cos_to_last_merge=0.8039 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.804
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8317013308688448, 'auprc': 0.9949734982511634, 'loss_val': 0.9033075207885526, 'psi': 0.8970101978217723}-{'f1_val': 0.9340079153556706, 'auprc': 0.9871830257367087, 'loss_val': 0.14993759275805568, 'psi': 0.9552779595080858}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.553910 cos_to_last_merge=0.8107 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=29 local utility u=0.436138 metrics={'f1_val': 0.649593245633401, 'auprc': 0.8760183149412011, 'loss_val': 0.7989389503887947, 'psi': 0.7401632733565211}-{'f1_val': 0.6414787416271663, 'auprc': 0.6741224115400116, 'loss_val': 1.0168400844929277, 'psi': 0.6545362095923044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2]  timeout peer S3
[S3]  timeout peer S4
[S10]  timeout peer S6
[S8]  timeout peer S2
[S9]  timeout peer S10
[S14]  timeout peer S7
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:33915
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.9993
[S8] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] cosine check vs S8: cos=0.9993
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.7325 head_norm=1.268633
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.458892e-02
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.6991 head_norm=1.261550 delta_norm=0.024589
[S8] aggregate: ROLLBACK (f1_val pre=0.733 post=0.699 tol_abs=0.005 tol_rel=0.0)
[S2] START round=30 head_norm_before_train=1.232869 cos_to_last_merge=0.9488 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=30 local utility u=0.082167 metrics={'f1_val': 0.7089525941381195, 'auprc': 0.7597133615029622, 'loss_val': 0.3031123579814761, 'psi': 0.7292569010840566}-{'f1_val': 0.7073553527837783, 'auprc': 0.7148952875294226, 'loss_val': 0.3234084441699412, 'psi': 0.710371326682036}
[S2] not sending this round → trigger blocked (psi=0.729)
[S3] START round=30 head_norm_before_train=1.245617 cos_to_last_merge=0.9870 (last merge round=23)
[S3] round=30 local utility u=0.002418 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.998503043602053, 'loss_val': 0.27130494109628817, 'psi': 0.8197648189409446}-{'f1_val': 0.7006809596653347, 'auprc': 0.9988432866942402, 'loss_val': 0.2776108076646006, 'psi': 0.8199458904768969}
[S3] not sending this round → trigger blocked (psi=0.820)
[S4] START round=30 head_norm_before_train=1.257488 cos_to_last_merge=0.9749 (last merge round=24)
[S4] round=30 local utility u=0.038302 metrics={'f1_val': 0.9431425499586437, 'auprc': 0.960861412589427, 'loss_val': 0.2704010269416566, 'psi': 0.950230095010957}-{'f1_val': 0.9398435204482654, 'auprc': 0.9532054210508347, 'loss_val': 0.3042433313407562, 'psi': 0.9451882806892931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=30 head_norm_before_train=1.218317 cos_to_last_merge=0.9583 (last merge round=13)
[S5] round=30 local utility u=0.437740 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9920346946543742, 'loss_val': 0.2278598278369975, 'psi': 0.817006668322098}-{'f1_val': 0.653436763854155, 'auprc': 0.8568839369038517, 'loss_val': 0.41657936347660446, 'psi': 0.7348156330740336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=30 head_norm_before_train=1.290677 cos_to_last_merge=0.9713 (last merge round=17)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7420647358295108, 'auprc': 0.9475437700067042, 'loss_val': 0.4262868156744633, 'psi': 0.8242563495003882}-{'f1_val': 0.8354090302857048, 'auprc': 0.9616675836901414, 'loss_val': 0.2732122682883106, 'psi': 0.8859124516474794}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.623147 cos_to_last_merge=0.9965 (last merge round=24)
[S7] round=30 local utility u=0.218222 metrics={'f1_val': 0.5720399027884608, 'auprc': 0.7950389619966665, 'loss_val': 0.6941324314144751, 'psi': 0.6612395264717431}-{'f1_val': 0.5277423849259805, 'auprc': 0.7888088518418684, 'loss_val': 0.8461008002034632, 'psi': 0.6321689716923357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=30 head_norm_before_train=1.261550 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.786078 metrics={'f1_val': 0.9919854688626717, 'auprc': 0.9915793450446366, 'loss_val': 0.19306057096184087, 'psi': 0.9918230193354577}-{'f1_val': 0.7325049839494451, 'auprc': 0.9926313579306432, 'loss_val': 0.21148936294026632, 'psi': 0.8365555335419244}
[S9] START round=30 head_norm_before_train=1.893431 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9995470631805422, 'loss_val': 0.02330485765374795, 'psi': 0.9975664942517484}-{'f1_val': 0.9966605118138915, 'auprc': 0.9992851938111516, 'loss_val': 0.024617049149561608, 'psi': 0.9977103846127955}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.990174 (no previous merge yet)
[S10] round=30 local utility u=0.004678 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9969769482438169, 'loss_val': 0.031304928939809545, 'psi': 0.9964029352505306}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960668552449231, 'loss_val': 0.03293563146192287, 'psi': 0.9955394455095941}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=30 head_norm_before_train=1.720239 cos_to_last_merge=0.7766 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.777
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9965958338992329, 'loss_val': 0.05672527355150306, 'psi': 0.9963185385076787}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974744219810856, 'loss_val': 0.04288472302390143, 'psi': 0.996917971500588}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.449543 cos_to_last_merge=0.8141 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.814
[S13] round=30 local utility u=0.049735 metrics={'f1_val': 0.6100783764875142, 'auprc': 0.666945100348793, 'loss_val': 0.6356252562853952, 'psi': 0.6328250660320256}-{'f1_val': 0.5683431292733445, 'auprc': 0.7102875158593367, 'loss_val': 0.6147110715148926, 'psi': 0.6251208839077413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S13] sending update (kind=head size=1809 to 1 peers)
[S14] START round=30 head_norm_before_train=1.713766 cos_to_last_merge=0.9874 (last merge round=18)
[S14] round=30 local utility u=0.004443 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971499005280174, 'loss_val': 0.03682250335131123, 'psi': 0.9974506310411191}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971039121192693, 'loss_val': 0.04164896332446676, 'psi': 0.9970400697423067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=30 head_norm_before_train=1.254908 cos_to_last_merge=0.9998 (last merge round=28)
[S15] round=30 local utility u=0.403597 metrics={'f1_val': 0.9461499639471528, 'auprc': 0.9895458362402454, 'loss_val': 0.1232093129134031, 'psi': 0.9635083128643898}-{'f1_val': 0.8245077017121709, 'auprc': 0.9911636085292734, 'loss_val': 0.2054031537680375, 'psi': 0.8911700644390119}
[S16] START round=30 head_norm_before_train=1.680587 cos_to_last_merge=0.8025 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.802
[S16] round=30 local utility u=0.417042 metrics={'f1_val': 0.8898025620466548, 'auprc': 0.995474791662972, 'loss_val': 0.4193355307162013, 'psi': 0.9320714538931816}-{'f1_val': 0.8317013308688448, 'auprc': 0.9949734982511634, 'loss_val': 0.9033075207885526, 'psi': 0.8970101978217723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=30 head_norm_before_train=1.563922 cos_to_last_merge=0.8100 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.645497797738058, 'auprc': 0.8600897494659766, 'loss_val': 0.8992476266499051, 'psi': 0.7313345784292254}-{'f1_val': 0.649593245633401, 'auprc': 0.8760183149412011, 'loss_val': 0.7989389503887947, 'psi': 0.7401632733565211}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.9985
[S8] RECEIVED delta(kind=head bytes=1794) from S15
[S8] cosine check vs S15: cos=0.9985
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9461 head_norm=1.287708
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.408015e-02
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9393 head_norm=1.281835 delta_norm=0.034080
[S15] aggregate: ROLLBACK (f1_val pre=0.946 post=0.939 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.247 → S8@127.0.0.1:33909
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9920 head_norm=1.285143
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.526125e-02
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9922 head_norm=1.285943 delta_norm=0.035261
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.244 → S15@127.0.0.1:33915
[S2] START round=31 head_norm_before_train=1.247047 cos_to_last_merge=0.9467 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=31 local utility u=0.105730 metrics={'f1_val': 0.7076693864710951, 'auprc': 0.8314981896118889, 'loss_val': 0.2993071709718638, 'psi': 0.7572009077274127}-{'f1_val': 0.7089525941381195, 'auprc': 0.7597133615029622, 'loss_val': 0.3031123579814761, 'psi': 0.7292569010840566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=31 head_norm_before_train=1.263802 cos_to_last_merge=0.9855 (last merge round=23)
[S3] round=31 local utility u=0.002058 metrics={'f1_val': 0.7002765683645327, 'auprc': 0.9978747938835351, 'loss_val': 0.26332787065632157, 'psi': 0.8193158585721336}-{'f1_val': 0.7006060025002057, 'auprc': 0.998503043602053, 'loss_val': 0.27130494109628817, 'psi': 0.8197648189409446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=31 head_norm_before_train=1.286226 cos_to_last_merge=0.9705 (last merge round=24)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.938119060085196, 'auprc': 0.9529217554916426, 'loss_val': 0.2933049648400866, 'psi': 0.9440401382477746}-{'f1_val': 0.9431425499586437, 'auprc': 0.960861412589427, 'loss_val': 0.2704010269416566, 'psi': 0.950230095010957}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.230881 cos_to_last_merge=0.9565 (last merge round=13)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.436667805632789, 'auprc': 0.8558136975535863, 'loss_val': 0.8183543730073429, 'psi': 0.6043261624011079}-{'f1_val': 0.7003213174339138, 'auprc': 0.9920346946543742, 'loss_val': 0.2278598278369975, 'psi': 0.817006668322098}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.304750 cos_to_last_merge=0.9687 (last merge round=17)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.788214632664244, 'auprc': 0.8131660048493085, 'loss_val': 0.45435672506096536, 'psi': 0.7981951815382697}-{'f1_val': 0.7420647358295108, 'auprc': 0.9475437700067042, 'loss_val': 0.4262868156744633, 'psi': 0.8242563495003882}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.633639 cos_to_last_merge=0.9957 (last merge round=24)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5359194415814983, 'auprc': 0.7881882497896318, 'loss_val': 0.8684803004790738, 'psi': 0.6368269648647518}-{'f1_val': 0.5720399027884608, 'auprc': 0.7950389619966665, 'loss_val': 0.6941324314144751, 'psi': 0.6612395264717431}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.285943 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9706497215647003, 'auprc': 0.9837470416195683, 'loss_val': 0.20804867731726093, 'psi': 0.9758886495866474}-{'f1_val': 0.9919854688626717, 'auprc': 0.9915793450446366, 'loss_val': 0.19306057096184087, 'psi': 0.9918230193354577}
[S9] START round=31 head_norm_before_train=1.906065 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9995609552602731, 'loss_val': 0.03911989648375006, 'psi': 0.9935561950729124}-{'f1_val': 0.9962461149658858, 'auprc': 0.9995470631805422, 'loss_val': 0.02330485765374795, 'psi': 0.9975664942517484}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=2.006174 (no previous merge yet)
[S10] round=31 local utility u=0.000729 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9969964283537467, 'loss_val': 0.029904927670624595, 'psi': 0.9964107272945026}-{'f1_val': 0.9960202599216732, 'auprc': 0.9969769482438169, 'loss_val': 0.031304928939809545, 'psi': 0.9964029352505306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=31 head_norm_before_train=1.738983 cos_to_last_merge=0.7745 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.775
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.8354759248114167, 'auprc': 0.9953364562930713, 'loss_val': 0.20871798037348976, 'psi': 0.8994201374040786}-{'f1_val': 0.9961336749133093, 'auprc': 0.9965958338992329, 'loss_val': 0.05672527355150306, 'psi': 0.9963185385076787}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.460501 cos_to_last_merge=0.8134 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.813
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5633371006048019, 'auprc': 0.5806206926179154, 'loss_val': 0.8512249189274168, 'psi': 0.5702505374100473}-{'f1_val': 0.6100783764875142, 'auprc': 0.666945100348793, 'loss_val': 0.6356252562853952, 'psi': 0.6328250660320256}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.733385 cos_to_last_merge=0.9863 (last merge round=18)
[S14] round=31 local utility u=0.000369 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971492344499504, 'loss_val': 0.03361742751809292, 'psi': 0.997203907803456}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971499005280174, 'loss_val': 0.03682250335131123, 'psi': 0.9974506310411191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=31 head_norm_before_train=1.281835 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.164181 metrics={'f1_val': 0.9905273982298197, 'auprc': 0.9982171211209221, 'loss_val': 0.0871252112935531, 'psi': 0.9936032873862606}-{'f1_val': 0.9461499639471528, 'auprc': 0.9895458362402454, 'loss_val': 0.1232093129134031, 'psi': 0.9635083128643898}
[S16] START round=31 head_norm_before_train=1.695392 cos_to_last_merge=0.8013 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.801
[S16] round=31 local utility u=0.481334 metrics={'f1_val': 0.9907355059030509, 'auprc': 0.9932845875352622, 'loss_val': 0.055694233330391946, 'psi': 0.9917551385559354}-{'f1_val': 0.8898025620466548, 'auprc': 0.995474791662972, 'loss_val': 0.4193355307162013, 'psi': 0.9320714538931816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=31 head_norm_before_train=1.580144 cos_to_last_merge=0.8089 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6446854651731609, 'auprc': 0.8483226837251939, 'loss_val': 1.0787583188492167, 'psi': 0.7261403525939741}-{'f1_val': 0.645497797738058, 'auprc': 0.8600897494659766, 'loss_val': 0.8992476266499051, 'psi': 0.7313345784292254}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.9994
[S2] START round=32 head_norm_before_train=1.261766 cos_to_last_merge=0.9441 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=32 local utility u=0.116402 metrics={'f1_val': 0.74246950102876, 'auprc': 0.8449647388607933, 'loss_val': 0.31570373560416176, 'psi': 0.7834675961615734}-{'f1_val': 0.7076693864710951, 'auprc': 0.8314981896118889, 'loss_val': 0.2993071709718638, 'psi': 0.7572009077274127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=32 head_norm_before_train=1.280884 cos_to_last_merge=0.9840 (last merge round=23)
[S3] round=32 local utility u=0.003384 metrics={'f1_val': 0.7002765683645327, 'auprc': 0.9975191710945555, 'loss_val': 0.25549297294869283, 'psi': 0.8191736094565418}-{'f1_val': 0.7002765683645327, 'auprc': 0.9978747938835351, 'loss_val': 0.26332787065632157, 'psi': 0.8193158585721336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=32 head_norm_before_train=1.310295 cos_to_last_merge=0.9668 (last merge round=24)
[S4] round=32 local utility u=0.052200 metrics={'f1_val': 0.9489570547666094, 'auprc': 0.956303574422825, 'loss_val': 0.2640788261809426, 'psi': 0.9518956626290955}-{'f1_val': 0.938119060085196, 'auprc': 0.9529217554916426, 'loss_val': 0.2933049648400866, 'psi': 0.9440401382477746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=32 head_norm_before_train=1.241477 cos_to_last_merge=0.9550 (last merge round=13)
[S5] round=32 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989328741269765, 'loss_val': 0.2390102484789741, 'psi': 0.8159242869682543}-{'f1_val': 0.436667805632789, 'auprc': 0.8558136975535863, 'loss_val': 0.8183543730073429, 'psi': 0.6043261624011079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=32 head_norm_before_train=1.321159 cos_to_last_merge=0.9661 (last merge round=17)
[S6] round=32 local utility u=0.163865 metrics={'f1_val': 0.7649694995338754, 'auprc': 0.9562535469344078, 'loss_val': 0.41641928621935087, 'psi': 0.8414831184940883}-{'f1_val': 0.788214632664244, 'auprc': 0.8131660048493085, 'loss_val': 0.45435672506096536, 'psi': 0.7981951815382697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=32 head_norm_before_train=1.646307 cos_to_last_merge=0.9948 (last merge round=24)
[S7] round=32 local utility u=1.000000 metrics={'f1_val': 0.698829362286148, 'auprc': 0.9718255197148161, 'loss_val': 0.26550764089427126, 'psi': 0.8080278252576153}-{'f1_val': 0.5359194415814983, 'auprc': 0.7881882497896318, 'loss_val': 0.8684803004790738, 'psi': 0.6368269648647518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=32 head_norm_before_train=1.307917 cos_to_last_merge=0.9997 (last merge round=30)
[S8] round=32 local utility u=0.087645 metrics={'f1_val': 0.9927318893430277, 'auprc': 0.9849811588891341, 'loss_val': 0.16895431842291883, 'psi': 0.9896315971614702}-{'f1_val': 0.9706497215647003, 'auprc': 0.9837470416195683, 'loss_val': 0.20804867731726093, 'psi': 0.9758886495866474}
[S9] START round=32 head_norm_before_train=1.919090 (no previous merge yet)
[S9] round=32 local utility u=0.030118 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995444867006003, 'loss_val': 0.021479054450723192, 'psi': 0.997814101768575}-{'f1_val': 0.9895530216146718, 'auprc': 0.9995609552602731, 'loss_val': 0.03911989648375006, 'psi': 0.9935561950729124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=32 head_norm_before_train=2.021515 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9955978191757338, 'auprc': 0.9969874647779982, 'loss_val': 0.029411165564875143, 'psi': 0.9961536774166395}-{'f1_val': 0.9960202599216732, 'auprc': 0.9969964283537467, 'loss_val': 0.029904927670624595, 'psi': 0.9964107272945026}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.756078 cos_to_last_merge=0.7725 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.772
[S11] round=32 local utility u=0.575138 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977991986620394, 'loss_val': 0.03225654747482916, 'psi': 0.9970478821729695}-{'f1_val': 0.8354759248114167, 'auprc': 0.9953364562930713, 'loss_val': 0.20871798037348976, 'psi': 0.8994201374040786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=32 head_norm_before_train=1.469319 cos_to_last_merge=0.8118 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.812
[S13] round=32 local utility u=0.404986 metrics={'f1_val': 0.612312839829384, 'auprc': 0.6727057515223539, 'loss_val': 0.6113634830441932, 'psi': 0.6364700045065719}-{'f1_val': 0.5633371006048019, 'auprc': 0.5806206926179154, 'loss_val': 0.8512249189274168, 'psi': 0.5702505374100473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=32 head_norm_before_train=1.749471 cos_to_last_merge=0.9853 (last merge round=18)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9960853279550081, 'loss_val': 0.03771694475267946, 'psi': 0.9965024356862866}-{'f1_val': 0.997240356705793, 'auprc': 0.9971492344499504, 'loss_val': 0.03361742751809292, 'psi': 0.997203907803456}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.312315 cos_to_last_merge=0.9998 (last merge round=30)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7775870137937975, 'auprc': 0.9916835948670958, 'loss_val': 0.286245805546502, 'psi': 0.8632256462231168}-{'f1_val': 0.9905273982298197, 'auprc': 0.9982171211209221, 'loss_val': 0.0871252112935531, 'psi': 0.9936032873862606}
[S16] START round=32 head_norm_before_train=1.710161 cos_to_last_merge=0.8003 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.800
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9329336485348876, 'auprc': 0.9959546506167173, 'loss_val': 0.2807170526473463, 'psi': 0.9581420493676194}-{'f1_val': 0.9907355059030509, 'auprc': 0.9932845875352622, 'loss_val': 0.055694233330391946, 'psi': 0.9917551385559354}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.595446 cos_to_last_merge=0.8080 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=32 local utility u=0.065485 metrics={'f1_val': 0.6552027325702182, 'auprc': 0.8545053071424488, 'loss_val': 1.029439137546506, 'psi': 0.7349237623991105}-{'f1_val': 0.6446854651731609, 'auprc': 0.8483226837251939, 'loss_val': 1.0787583188492167, 'psi': 0.7261403525939741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=0.9983
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9927 head_norm=1.324866
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.470552e-02
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9924 head_norm=1.318149 delta_norm=0.034706
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.277331 cos_to_last_merge=0.9413 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=33 local utility u=0.257396 metrics={'f1_val': 0.8258305069138938, 'auprc': 0.8588990845049745, 'loss_val': 0.34288071796567743, 'psi': 0.8390579379503261}-{'f1_val': 0.74246950102876, 'auprc': 0.8449647388607933, 'loss_val': 0.31570373560416176, 'psi': 0.7834675961615734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=33 head_norm_before_train=1.296879 cos_to_last_merge=0.9822 (last merge round=23)
[S3] round=33 local utility u=0.012997 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9988664274961639, 'loss_val': 0.23596677440909344, 'psi': 0.8199551467976665}-{'f1_val': 0.7002765683645327, 'auprc': 0.9975191710945555, 'loss_val': 0.25549297294869283, 'psi': 0.8191736094565418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=33 head_norm_before_train=1.328628 cos_to_last_merge=0.9637 (last merge round=24)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9419781070109543, 'auprc': 0.964569310677844, 'loss_val': 0.2746423649980764, 'psi': 0.9510145884777103}-{'f1_val': 0.9489570547666094, 'auprc': 0.956303574422825, 'loss_val': 0.2640788261809426, 'psi': 0.9518956626290955}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.252182 cos_to_last_merge=0.9534 (last merge round=13)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.5735088031422972, 'auprc': 0.8559775097448101, 'loss_val': 0.5380274703994428, 'psi': 0.6864962857833024}-{'f1_val': 0.7003213174339138, 'auprc': 0.989328741269765, 'loss_val': 0.2390102484789741, 'psi': 0.8159242869682543}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.338417 cos_to_last_merge=0.9627 (last merge round=17)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6175844238572632, 'auprc': 0.7965545537731752, 'loss_val': 0.6281031607733761, 'psi': 0.689172475823628}-{'f1_val': 0.7649694995338754, 'auprc': 0.9562535469344078, 'loss_val': 0.41641928621935087, 'psi': 0.8414831184940883}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.657288 cos_to_last_merge=0.9940 (last merge round=24)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.4732899890845944, 'auprc': 0.7814364923840329, 'loss_val': 1.038145529221653, 'psi': 0.5965485904043698}-{'f1_val': 0.698829362286148, 'auprc': 0.9718255197148161, 'loss_val': 0.26550764089427126, 'psi': 0.8080278252576153}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.318149 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9921505420845177, 'auprc': 0.9845456926872302, 'loss_val': 0.17917382915181693, 'psi': 0.9891086023256027}-{'f1_val': 0.9927318893430277, 'auprc': 0.9849811588891341, 'loss_val': 0.16895431842291883, 'psi': 0.9896315971614702}
[S9] START round=33 head_norm_before_train=1.931764 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9963885816572899, 'loss_val': 0.021560931982480266, 'psi': 0.9965517397512509}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995444867006003, 'loss_val': 0.021479054450723192, 'psi': 0.997814101768575}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=2.036105 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996395943595868, 'loss_val': 0.028989371785134624, 'psi': 0.995671080849972}-{'f1_val': 0.9955978191757338, 'auprc': 0.9969874647779982, 'loss_val': 0.029411165564875143, 'psi': 0.9961536774166395}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.774295 cos_to_last_merge=0.7705 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.771
[S11] round=33 local utility u=0.001032 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974619355139132, 'loss_val': 0.029180853293632805, 'psi': 0.996912976913719}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977991986620394, 'loss_val': 0.03225654747482916, 'psi': 0.9970478821729695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=33 head_norm_before_train=1.476392 cos_to_last_merge=0.8118 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.812
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5353290309021238, 'auprc': 0.7255205331071662, 'loss_val': 0.7882110387846004, 'psi': 0.6114056317841408}-{'f1_val': 0.612312839829384, 'auprc': 0.6727057515223539, 'loss_val': 0.6113634830441932, 'psi': 0.6364700045065719}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.765427 cos_to_last_merge=0.9843 (last merge round=18)
[S14] round=33 local utility u=0.001917 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9965253604408784, 'loss_val': 0.03404435394449849, 'psi': 0.9965624831428015}-{'f1_val': 0.9967805075071389, 'auprc': 0.9960853279550081, 'loss_val': 0.03771694475267946, 'psi': 0.9965024356862866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=33 head_norm_before_train=1.337992 cos_to_last_merge=0.9994 (last merge round=30)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7007449487928452, 'auprc': 0.9869362544767774, 'loss_val': 0.4610126651988327, 'psi': 0.8152214710664181}-{'f1_val': 0.7775870137937975, 'auprc': 0.9916835948670958, 'loss_val': 0.286245805546502, 'psi': 0.8632256462231168}
[S16] START round=33 head_norm_before_train=1.722249 cos_to_last_merge=0.7992 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.799
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8367181247670474, 'auprc': 0.9863190582078436, 'loss_val': 0.9303610909506095, 'psi': 0.8965584981433659}-{'f1_val': 0.9329336485348876, 'auprc': 0.9959546506167173, 'loss_val': 0.2807170526473463, 'psi': 0.9581420493676194}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.614384 cos_to_last_merge=0.8069 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6337453998451141, 'auprc': 0.6768477235425369, 'loss_val': 1.0951164452248592, 'psi': 0.6509863293240832}-{'f1_val': 0.6552027325702182, 'auprc': 0.8545053071424488, 'loss_val': 1.029439137546506, 'psi': 0.7349237623991105}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.7007 head_norm=1.365439
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.965959e-02
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.7009 head_norm=1.344388 delta_norm=0.049660
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.296521 cos_to_last_merge=0.9377 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.8277918961886431, 'auprc': 0.8161525622084151, 'loss_val': 0.3839352846369086, 'psi': 0.8231361625965519}-{'f1_val': 0.8258305069138938, 'auprc': 0.8588990845049745, 'loss_val': 0.34288071796567743, 'psi': 0.8390579379503261}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.310228 cos_to_last_merge=0.9809 (last merge round=23)
[S3] round=34 local utility u=0.003234 metrics={'f1_val': 0.7018768808926283, 'auprc': 0.9987730594453958, 'loss_val': 0.23639423838185544, 'psi': 0.8206353523137353}-{'f1_val': 0.7006809596653347, 'auprc': 0.9988664274961639, 'loss_val': 0.23596677440909344, 'psi': 0.8199551467976665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=34 head_norm_before_train=1.349725 cos_to_last_merge=0.9606 (last merge round=24)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9397716108771765, 'auprc': 0.9285952196499407, 'loss_val': 0.2895910719480486, 'psi': 0.9353010543862822}-{'f1_val': 0.9419781070109543, 'auprc': 0.964569310677844, 'loss_val': 0.2746423649980764, 'psi': 0.9510145884777103}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.262357 cos_to_last_merge=0.9520 (last merge round=13)
[S5] round=34 local utility u=0.712187 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9850835468823681, 'loss_val': 0.26184743678903305, 'psi': 0.8142262092132955}-{'f1_val': 0.5735088031422972, 'auprc': 0.8559775097448101, 'loss_val': 0.5380274703994428, 'psi': 0.6864962857833024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=34 head_norm_before_train=1.355906 cos_to_last_merge=0.9597 (last merge round=17)
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.9116393755616119, 'auprc': 0.9734335550136136, 'loss_val': 0.209102247695504, 'psi': 0.9363570473424125}-{'f1_val': 0.6175844238572632, 'auprc': 0.7965545537731752, 'loss_val': 0.6281031607733761, 'psi': 0.689172475823628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=34 head_norm_before_train=1.664716 cos_to_last_merge=0.9935 (last merge round=24)
[S7] round=34 local utility u=0.978469 metrics={'f1_val': 0.6729840085599856, 'auprc': 0.8280905678747319, 'loss_val': 0.41933382383194673, 'psi': 0.735026632285884}-{'f1_val': 0.4732899890845944, 'auprc': 0.7814364923840329, 'loss_val': 1.038145529221653, 'psi': 0.5965485904043698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=34 head_norm_before_train=1.333136 cos_to_last_merge=0.9999 (last merge round=32)
[S8] round=34 local utility u=0.007251 metrics={'f1_val': 0.9898230448696392, 'auprc': 0.9868866177831215, 'loss_val': 0.15773035592933696, 'psi': 0.9886484740350321}-{'f1_val': 0.9921505420845177, 'auprc': 0.9845456926872302, 'loss_val': 0.17917382915181693, 'psi': 0.9891086023256027}
[S9] START round=34 head_norm_before_train=1.942826 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9995567452812624, 'loss_val': 0.04016934592022948, 'psi': 0.9933000339584852}-{'f1_val': 0.9966605118138915, 'auprc': 0.9963885816572899, 'loss_val': 0.021560931982480266, 'psi': 0.9965517397512509}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=2.050384 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960379299395585, 'loss_val': 0.029130899202487504, 'psi': 0.9955278753874482}-{'f1_val': 0.9951878390193748, 'auprc': 0.996395943595868, 'loss_val': 0.028989371785134624, 'psi': 0.995671080849972}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.791406 cos_to_last_merge=0.7689 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.769
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975912978355495, 'loss_val': 0.029984767542684244, 'psi': 0.9969647218423735}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974619355139132, 'loss_val': 0.029180853293632805, 'psi': 0.996912976913719}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.487858 cos_to_last_merge=0.8096 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.810
[S13] round=34 local utility u=0.066026 metrics={'f1_val': 0.5885878206794893, 'auprc': 0.6463332712739662, 'loss_val': 0.7381500151321023, 'psi': 0.6116860009172801}-{'f1_val': 0.5353290309021238, 'auprc': 0.7255205331071662, 'loss_val': 0.7882110387846004, 'psi': 0.6114056317841408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=34 head_norm_before_train=1.777727 cos_to_last_merge=0.9835 (last merge round=18)
[S14] round=34 local utility u=0.001710 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9971467941489041, 'loss_val': 0.032488788261155, 'psi': 0.9968110566260118}-{'f1_val': 0.9965872316107504, 'auprc': 0.9965253604408784, 'loss_val': 0.03404435394449849, 'psi': 0.9965624831428015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=34 head_norm_before_train=1.344388 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.294038 metrics={'f1_val': 0.7738921682373624, 'auprc': 0.992470132383864, 'loss_val': 0.3284217708932252, 'psi': 0.861323353895963}-{'f1_val': 0.7007449487928452, 'auprc': 0.9869362544767774, 'loss_val': 0.4610126651988327, 'psi': 0.8152214710664181}
[S16] START round=34 head_norm_before_train=1.730451 cos_to_last_merge=0.7980 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.798
[S16] round=34 local utility u=0.163437 metrics={'f1_val': 0.8351247846578583, 'auprc': 0.9809094351161058, 'loss_val': 0.5776975972872603, 'psi': 0.8934386448411573}-{'f1_val': 0.8367181247670474, 'auprc': 0.9863190582078436, 'loss_val': 0.9303610909506095, 'psi': 0.8965584981433659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=34 head_norm_before_train=1.626752 cos_to_last_merge=0.8060 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=34 local utility u=0.508012 metrics={'f1_val': 0.6648780159409473, 'auprc': 0.8624949770918717, 'loss_val': 0.8228301133297266, 'psi': 0.743924800401317}-{'f1_val': 0.6337453998451141, 'auprc': 0.6768477235425369, 'loss_val': 1.0951164452248592, 'psi': 0.6509863293240832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:33909
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.9991
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] cosine check vs S15: cos=0.9991
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.7739 head_norm=1.368611
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.050248e-02
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.7730 head_norm=1.357198 delta_norm=0.030502
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9898 head_norm=1.346378
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.050248e-02
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9898 head_norm=1.357198 delta_norm=0.030502
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.316306 cos_to_last_merge=0.9332 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.933
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7276975999501075, 'auprc': 0.7466077100077758, 'loss_val': 0.45993748541147705, 'psi': 0.7352616439731748}-{'f1_val': 0.8277918961886431, 'auprc': 0.8161525622084151, 'loss_val': 0.3839352846369086, 'psi': 0.8231361625965519}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.320753 cos_to_last_merge=0.9794 (last merge round=23)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.6513236228725795, 'auprc': 0.8629636861292193, 'loss_val': 0.36212445098341467, 'psi': 0.7359796481752354}-{'f1_val': 0.7018768808926283, 'auprc': 0.9987730594453958, 'loss_val': 0.23639423838185544, 'psi': 0.8206353523137353}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.366848 cos_to_last_merge=0.9581 (last merge round=24)
[S4] round=35 local utility u=0.063694 metrics={'f1_val': 0.9420628807342393, 'auprc': 0.9616221113893259, 'loss_val': 0.27503212425981105, 'psi': 0.9498865729962739}-{'f1_val': 0.9397716108771765, 'auprc': 0.9285952196499407, 'loss_val': 0.2895910719480486, 'psi': 0.9353010543862822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=35 head_norm_before_train=1.272084 cos_to_last_merge=0.9507 (last merge round=13)
[S5] round=35 local utility u=0.021680 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898455760174818, 'loss_val': 0.23277407280021406, 'psi': 0.8161310208673409}-{'f1_val': 0.7003213174339138, 'auprc': 0.9850835468823681, 'loss_val': 0.26184743678903305, 'psi': 0.8142262092132955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=35 head_norm_before_train=1.368557 cos_to_last_merge=0.9574 (last merge round=17)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.8210052827608594, 'auprc': 0.9617077638798166, 'loss_val': 0.3647776993304634, 'psi': 0.8772862752084423}-{'f1_val': 0.9116393755616119, 'auprc': 0.9734335550136136, 'loss_val': 0.209102247695504, 'psi': 0.9363570473424125}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.673241 cos_to_last_merge=0.9929 (last merge round=24)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.49281342827538555, 'auprc': 0.7817313920041271, 'loss_val': 0.9974176034957227, 'psi': 0.6083806137668821}-{'f1_val': 0.6729840085599856, 'auprc': 0.8280905678747319, 'loss_val': 0.41933382383194673, 'psi': 0.735026632285884}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.357198 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.016403 metrics={'f1_val': 0.9931148882341876, 'auprc': 0.9850333307947827, 'loss_val': 0.13911648369167096, 'psi': 0.9898822652584257}-{'f1_val': 0.9898230448696392, 'auprc': 0.9868866177831215, 'loss_val': 0.15773035592933696, 'psi': 0.9886484740350321}
[S9] START round=35 head_norm_before_train=1.950613 (no previous merge yet)
[S9] round=35 local utility u=0.033740 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995348626336817, 'loss_val': 0.02046717538219759, 'psi': 0.9980756925607583}-{'f1_val': 0.9891288930766337, 'auprc': 0.9995567452812624, 'loss_val': 0.04016934592022948, 'psi': 0.9933000339584852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=35 head_norm_before_train=2.063787 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959752170579419, 'loss_val': 0.029007839810198492, 'psi': 0.9955027902348016}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960379299395585, 'loss_val': 0.029130899202487504, 'psi': 0.9955278753874482}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.805403 cos_to_last_merge=0.7676 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.768
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.8497943992630262, 'auprc': 0.9963676436762905, 'loss_val': 0.19261787707747782, 'psi': 0.9084236970283319}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975912978355495, 'loss_val': 0.029984767542684244, 'psi': 0.9969647218423735}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.501555 cos_to_last_merge=0.8077 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.808
[S13] round=35 local utility u=0.153613 metrics={'f1_val': 0.6687935098370723, 'auprc': 0.6694326835300435, 'loss_val': 0.9814569994207353, 'psi': 0.6690491793142608}-{'f1_val': 0.5885878206794893, 'auprc': 0.6463332712739662, 'loss_val': 0.7381500151321023, 'psi': 0.6116860009172801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=35 head_norm_before_train=1.789977 cos_to_last_merge=0.9827 (last merge round=18)
[S14] round=35 local utility u=0.001903 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971551806740575, 'loss_val': 0.03116913632191885, 'psi': 0.997060577164222}-{'f1_val': 0.9965872316107504, 'auprc': 0.9971467941489041, 'loss_val': 0.032488788261155, 'psi': 0.9968110566260118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=35 head_norm_before_train=1.357198 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.797141 metrics={'f1_val': 0.9959176576326709, 'auprc': 0.9934686413992309, 'loss_val': 0.0692884061700487, 'psi': 0.9949380511392949}-{'f1_val': 0.7738921682373624, 'auprc': 0.992470132383864, 'loss_val': 0.3284217708932252, 'psi': 0.861323353895963}
[S16] START round=35 head_norm_before_train=1.739141 cos_to_last_merge=0.7971 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.797
[S16] round=35 local utility u=0.754433 metrics={'f1_val': 0.9908080536053198, 'auprc': 0.995835351518929, 'loss_val': 0.0477081102702572, 'psi': 0.9928189727707635}-{'f1_val': 0.8351247846578583, 'auprc': 0.9809094351161058, 'loss_val': 0.5776975972872603, 'psi': 0.8934386448411573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=35 head_norm_before_train=1.639588 cos_to_last_merge=0.8053 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6699110520227145, 'auprc': 0.6894517834255054, 'loss_val': 1.0926752914823015, 'psi': 0.6777273445838308}-{'f1_val': 0.6648780159409473, 'auprc': 0.8624949770918717, 'loss_val': 0.8228301133297266, 'psi': 0.743924800401317}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=0.9997
[S8] RECEIVED delta(kind=head bytes=1807) from S15
[S8] cosine check vs S15: cos=0.9997
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9931 head_norm=1.372697
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.905616e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9927 head_norm=1.379515 delta_norm=0.019056
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.093 → S15@127.0.0.1:33915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.9959 head_norm=1.386561
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.905616e-02
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.9959 head_norm=1.379515 delta_norm=0.019056
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.301 → S8@127.0.0.1:33909
[S2] START round=36 head_norm_before_train=1.335102 cos_to_last_merge=0.9287 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=36 local utility u=0.282165 metrics={'f1_val': 0.7615502219413509, 'auprc': 0.8473422358489211, 'loss_val': 0.4009272653907355, 'psi': 0.795867027504379}-{'f1_val': 0.7276975999501075, 'auprc': 0.7466077100077758, 'loss_val': 0.45993748541147705, 'psi': 0.7352616439731748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=36 head_norm_before_train=1.329443 cos_to_last_merge=0.9782 (last merge round=23)
[S3] round=36 local utility u=1.000000 metrics={'f1_val': 0.9475850685972657, 'auprc': 0.9995253753309687, 'loss_val': 0.19407041601398856, 'psi': 0.9683611912907469}-{'f1_val': 0.6513236228725795, 'auprc': 0.8629636861292193, 'loss_val': 0.36212445098341467, 'psi': 0.7359796481752354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=36 head_norm_before_train=1.383119 cos_to_last_merge=0.9557 (last merge round=24)
[S4] round=36 local utility u=0.008542 metrics={'f1_val': 0.9436577587990619, 'auprc': 0.9613538466170131, 'loss_val': 0.26671333260068664, 'psi': 0.9507361939262424}-{'f1_val': 0.9420628807342393, 'auprc': 0.9616221113893259, 'loss_val': 0.27503212425981105, 'psi': 0.9498865729962739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=36 head_norm_before_train=1.279771 cos_to_last_merge=0.9497 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.950
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8557646425174448, 'loss_val': 0.7932900493594075, 'psi': 0.6043655953102012}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898455760174818, 'loss_val': 0.23277407280021406, 'psi': 0.8161310208673409}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.384180 cos_to_last_merge=0.9546 (last merge round=17)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.787471349449618, 'auprc': 0.8290191970222316, 'loss_val': 0.477133066500587, 'psi': 0.8040904884786635}-{'f1_val': 0.8210052827608594, 'auprc': 0.9617077638798166, 'loss_val': 0.3647776993304634, 'psi': 0.8772862752084423}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.682617 cos_to_last_merge=0.9923 (last merge round=24)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.6982878078416598, 'auprc': 0.9365710975953814, 'loss_val': 0.25715360086758027, 'psi': 0.7936011237431484}-{'f1_val': 0.49281342827538555, 'auprc': 0.7817313920041271, 'loss_val': 0.9974176034957227, 'psi': 0.6083806137668821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=36 head_norm_before_train=1.379515 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.005743 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9844782892200789, 'loss_val': 0.1227032760286383, 'psi': 0.9893340833613167}-{'f1_val': 0.9931148882341876, 'auprc': 0.9850333307947827, 'loss_val': 0.13911648369167096, 'psi': 0.9898822652584257}
[S9] START round=36 head_norm_before_train=1.956059 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9995322393351386, 'loss_val': 0.02148882748276426, 'psi': 0.9975755131722991}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995348626336817, 'loss_val': 0.02046717538219759, 'psi': 0.9980756925607583}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.070258 (no previous merge yet)
[S10] round=36 local utility u=0.000238 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959628469893691, 'loss_val': 0.028494865376029733, 'psi': 0.9954978422073725}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959752170579419, 'loss_val': 0.029007839810198492, 'psi': 0.9955027902348016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=36 head_norm_before_train=1.819316 cos_to_last_merge=0.7662 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.766
[S11] round=36 local utility u=0.046117 metrics={'f1_val': 0.8610042248942474, 'auprc': 0.9965987975228365, 'loss_val': 0.16833604740119576, 'psi': 0.915242053945683}-{'f1_val': 0.8497943992630262, 'auprc': 0.9963676436762905, 'loss_val': 0.19261787707747782, 'psi': 0.9084236970283319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=36 head_norm_before_train=1.517782 cos_to_last_merge=0.8057 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.806
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5987605471307053, 'auprc': 0.6405118129162181, 'loss_val': 0.8047583040609395, 'psi': 0.6154610534449103}-{'f1_val': 0.6687935098370723, 'auprc': 0.6694326835300435, 'loss_val': 0.9814569994207353, 'psi': 0.6690491793142608}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.803498 cos_to_last_merge=0.9819 (last merge round=18)
[S14] round=36 local utility u=0.000172 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971559582011886, 'loss_val': 0.03228401856282062, 'psi': 0.9972065973039512}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971551806740575, 'loss_val': 0.03116913632191885, 'psi': 0.997060577164222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=36 head_norm_before_train=1.379515 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.9622013641666746, 'auprc': 0.9930392376001768, 'loss_val': 0.0853829764995084, 'psi': 0.9745365135400754}-{'f1_val': 0.9959176576326709, 'auprc': 0.9934686413992309, 'loss_val': 0.0692884061700487, 'psi': 0.9949380511392949}
[S16] START round=36 head_norm_before_train=1.749491 cos_to_last_merge=0.7962 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.796
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8779103251630389, 'auprc': 0.9903967616642384, 'loss_val': 0.5106614147052031, 'psi': 0.9229048997635186}-{'f1_val': 0.9908080536053198, 'auprc': 0.995835351518929, 'loss_val': 0.0477081102702572, 'psi': 0.9928189727707635}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.655981 cos_to_last_merge=0.8040 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.804
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6482605219851678, 'auprc': 0.7269380385100732, 'loss_val': 1.1407179114065749, 'psi': 0.67973152859513}-{'f1_val': 0.6699110520227145, 'auprc': 0.6894517834255054, 'loss_val': 1.0926752914823015, 'psi': 0.6777273445838308}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.9995
[S2] START round=37 head_norm_before_train=1.349494 cos_to_last_merge=0.9252 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7173246420343583, 'auprc': 0.8614314946497926, 'loss_val': 0.4358807501964156, 'psi': 0.774967383080532}-{'f1_val': 0.7615502219413509, 'auprc': 0.8473422358489211, 'loss_val': 0.4009272653907355, 'psi': 0.795867027504379}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.339667 cos_to_last_merge=0.9766 (last merge round=23)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8290225259864088, 'auprc': 0.9446111307780982, 'loss_val': 0.3520750677356399, 'psi': 0.8752579679030845}-{'f1_val': 0.9475850685972657, 'auprc': 0.9995253753309687, 'loss_val': 0.19407041601398856, 'psi': 0.9683611912907469}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.395298 cos_to_last_merge=0.9539 (last merge round=24)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9410324372576924, 'auprc': 0.9590239078223977, 'loss_val': 0.2783599051995398, 'psi': 0.9482290254835745}-{'f1_val': 0.9436577587990619, 'auprc': 0.9613538466170131, 'loss_val': 0.26671333260068664, 'psi': 0.9507361939262424}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.287445 cos_to_last_merge=0.9487 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=37 local utility u=1.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9923693844200738, 'loss_val': 0.19327315598513461, 'psi': 0.8171922866999577}-{'f1_val': 0.43676623050537206, 'auprc': 0.8557646425174448, 'loss_val': 0.7932900493594075, 'psi': 0.6043655953102012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=37 head_norm_before_train=1.404054 cos_to_last_merge=0.9513 (last merge round=17)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6283930050307323, 'auprc': 0.9514987422033212, 'loss_val': 0.6614637524135106, 'psi': 0.7576352998997679}-{'f1_val': 0.787471349449618, 'auprc': 0.8290191970222316, 'loss_val': 0.477133066500587, 'psi': 0.8040904884786635}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.692104 cos_to_last_merge=0.9916 (last merge round=24)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5292473302838137, 'auprc': 0.7852381197376692, 'loss_val': 0.989682116023165, 'psi': 0.6316436460653558}-{'f1_val': 0.6982878078416598, 'auprc': 0.9365710975953814, 'loss_val': 0.25715360086758027, 'psi': 0.7936011237431484}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.399423 cos_to_last_merge=0.9997 (last merge round=35)
[S8] round=37 local utility u=0.008122 metrics={'f1_val': 0.9931148882341876, 'auprc': 0.9841457082873009, 'loss_val': 0.10872405472289097, 'psi': 0.9895272162554329}-{'f1_val': 0.9925712794554754, 'auprc': 0.9844782892200789, 'loss_val': 0.1227032760286383, 'psi': 0.9893340833613167}
[S9] START round=37 head_norm_before_train=1.960806 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9995404547114349, 'loss_val': 0.034744296643388836, 'psi': 0.9940559760673312}-{'f1_val': 0.9962710290637395, 'auprc': 0.9995322393351386, 'loss_val': 0.02148882748276426, 'psi': 0.9975755131722991}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.079343 (no previous merge yet)
[S10] round=37 local utility u=0.000618 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960808942693153, 'loss_val': 0.02761394348324579, 'psi': 0.995545061119351}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959628469893691, 'loss_val': 0.028494865376029733, 'psi': 0.9954978422073725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=37 head_norm_before_train=1.831571 cos_to_last_merge=0.7650 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.765
[S11] round=37 local utility u=0.476685 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9974056893673938, 'loss_val': 0.02816300896595863, 'psi': 0.9966424806949431}-{'f1_val': 0.8610042248942474, 'auprc': 0.9965987975228365, 'loss_val': 0.16833604740119576, 'psi': 0.915242053945683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=37 head_norm_before_train=1.533167 cos_to_last_merge=0.8048 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.805
[S13] round=37 local utility u=0.267935 metrics={'f1_val': 0.6572938613577187, 'auprc': 0.7016843919150176, 'loss_val': 0.8036050635726688, 'psi': 0.6750500735806383}-{'f1_val': 0.5987605471307053, 'auprc': 0.6405118129162181, 'loss_val': 0.8047583040609395, 'psi': 0.6154610534449103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=37 head_norm_before_train=1.818057 cos_to_last_merge=0.9811 (last merge round=18)
[S14] round=37 local utility u=0.001090 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971517738727725, 'loss_val': 0.028634005577341696, 'psi': 0.997059214443708}-{'f1_val': 0.997240356705793, 'auprc': 0.9971559582011886, 'loss_val': 0.03228401856282062, 'psi': 0.9972065973039512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=37 head_norm_before_train=1.411716 cos_to_last_merge=0.9998 (last merge round=35)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8943246235774724, 'auprc': 0.993423755953088, 'loss_val': 0.16940492535938617, 'psi': 0.9339642765277187}-{'f1_val': 0.9622013641666746, 'auprc': 0.9930392376001768, 'loss_val': 0.0853829764995084, 'psi': 0.9745365135400754}
[S16] START round=37 head_norm_before_train=1.761539 cos_to_last_merge=0.7953 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.795
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8664249200738755, 'auprc': 0.9917248352017227, 'loss_val': 0.6254977111452363, 'psi': 0.9165448861250144}-{'f1_val': 0.8779103251630389, 'auprc': 0.9903967616642384, 'loss_val': 0.5106614147052031, 'psi': 0.9229048997635186}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.669641 cos_to_last_merge=0.8032 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=37 local utility u=0.226205 metrics={'f1_val': 0.6541207838898557, 'auprc': 0.8463384702393872, 'loss_val': 1.0816702416275654, 'psi': 0.7310078584296683}-{'f1_val': 0.6482605219851678, 'auprc': 0.7269380385100732, 'loss_val': 1.1407179114065749, 'psi': 0.67973152859513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.8943 head_norm=1.439265
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.594897e-02
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.8939 head_norm=1.419028 delta_norm=0.035949
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=0.9993
[S2] START round=38 head_norm_before_train=1.364365 cos_to_last_merge=0.9221 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.922
[S2] round=38 local utility u=0.235929 metrics={'f1_val': 0.805484930577875, 'auprc': 0.8578675288509411, 'loss_val': 0.4822924299696524, 'psi': 0.8264379698871014}-{'f1_val': 0.7173246420343583, 'auprc': 0.8614314946497926, 'loss_val': 0.4358807501964156, 'psi': 0.774967383080532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] sending update (kind=head size=1790 to 1 peers)
[S3] START round=38 head_norm_before_train=1.351508 cos_to_last_merge=0.9748 (last merge round=23)
[S3] round=38 local utility u=0.010415 metrics={'f1_val': 0.8200173612158386, 'auprc': 0.9755227427381956, 'loss_val': 0.3699497588327207, 'psi': 0.8822195138247815}-{'f1_val': 0.8290225259864088, 'auprc': 0.9446111307780982, 'loss_val': 0.3520750677356399, 'psi': 0.8752579679030845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=38 head_norm_before_train=1.409475 cos_to_last_merge=0.9519 (last merge round=24)
[S4] round=38 local utility u=0.019321 metrics={'f1_val': 0.9429349393178588, 'auprc': 0.9651909052750883, 'loss_val': 0.2696343355454076, 'psi': 0.9518373257007506}-{'f1_val': 0.9410324372576924, 'auprc': 0.9590239078223977, 'loss_val': 0.2783599051995398, 'psi': 0.9482290254835745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=38 head_norm_before_train=1.297588 cos_to_last_merge=0.9473 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.6481309726694902, 'auprc': 0.8562662451597423, 'loss_val': 0.4501058079954378, 'psi': 0.731385081665591}-{'f1_val': 0.700407554886547, 'auprc': 0.9923693844200738, 'loss_val': 0.19327315598513461, 'psi': 0.8171922866999577}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.420056 cos_to_last_merge=0.9484 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.9370757572964457, 'auprc': 0.9813717124933096, 'loss_val': 0.1817882174024438, 'psi': 0.9547941393751912}-{'f1_val': 0.6283930050307323, 'auprc': 0.9514987422033212, 'loss_val': 0.6614637524135106, 'psi': 0.7576352998997679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=38 head_norm_before_train=1.699388 cos_to_last_merge=0.9912 (last merge round=24)
[S7] round=38 local utility u=1.000000 metrics={'f1_val': 0.6996569917167555, 'auprc': 0.9841889070047123, 'loss_val': 0.20435364983305981, 'psi': 0.8134697578319383}-{'f1_val': 0.5292473302838137, 'auprc': 0.7852381197376692, 'loss_val': 0.989682116023165, 'psi': 0.6316436460653558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=38 head_norm_before_train=1.422278 cos_to_last_merge=0.9989 (last merge round=35)
[S8] round=38 local utility u=0.005357 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.983755860018158, 'loss_val': 0.09357903460425274, 'psi': 0.9890451116805483}-{'f1_val': 0.9931148882341876, 'auprc': 0.9841457082873009, 'loss_val': 0.10872405472289097, 'psi': 0.9895272162554329}
[S9] START round=38 head_norm_before_train=1.967239 (no previous merge yet)
[S9] round=38 local utility u=0.017438 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9948929700219133, 'loss_val': 0.021029387927063495, 'psi': 0.9957072448763319}-{'f1_val': 0.990399656971262, 'auprc': 0.9995404547114349, 'loss_val': 0.034744296643388836, 'psi': 0.9940559760673312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=38 head_norm_before_train=2.089406 (no previous merge yet)
[S10] round=38 local utility u=0.000186 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960827079648109, 'loss_val': 0.02724796879778376, 'psi': 0.9955457865975492}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960808942693153, 'loss_val': 0.02761394348324579, 'psi': 0.995545061119351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=38 head_norm_before_train=1.842774 cos_to_last_merge=0.7641 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.764
[S11] round=38 local utility u=0.004239 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983578939888791, 'loss_val': 0.025022447876316262, 'psi': 0.9972713603037053}-{'f1_val': 0.9961336749133093, 'auprc': 0.9974056893673938, 'loss_val': 0.02816300896595863, 'psi': 0.9966424806949431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=38 head_norm_before_train=1.549639 cos_to_last_merge=0.8032 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.803
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6316581652563562, 'auprc': 0.6491214605307072, 'loss_val': 0.779193013545349, 'psi': 0.6386434833660966}-{'f1_val': 0.6572938613577187, 'auprc': 0.7016843919150176, 'loss_val': 0.8036050635726688, 'psi': 0.6750500735806383}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.829733 cos_to_last_merge=0.9805 (last merge round=18)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9971489992386667, 'loss_val': 0.029062580169141462, 'psi': 0.9969123186876855}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971517738727725, 'loss_val': 0.028634005577341696, 'psi': 0.997059214443708}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.419028 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7794121417366295, 'auprc': 0.9922533624235172, 'loss_val': 0.3386922798406664, 'psi': 0.8645486300113847}-{'f1_val': 0.8943246235774724, 'auprc': 0.993423755953088, 'loss_val': 0.16940492535938617, 'psi': 0.9339642765277187}
[S16] START round=38 head_norm_before_train=1.772441 cos_to_last_merge=0.7944 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.794
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8515987911369884, 'auprc': 0.992047968564379, 'loss_val': 0.7826832390987222, 'psi': 0.9077784621079447}-{'f1_val': 0.8664249200738755, 'auprc': 0.9917248352017227, 'loss_val': 0.6254977111452363, 'psi': 0.9165448861250144}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.682338 cos_to_last_merge=0.8024 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6593348289006562, 'auprc': 0.6273071011958867, 'loss_val': 1.5160849494519588, 'psi': 0.6465237378187485}-{'f1_val': 0.6541207838898557, 'auprc': 0.8463384702393872, 'loss_val': 1.0816702416275654, 'psi': 0.7310078584296683}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1805 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.7794 head_norm=1.443119
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.450213e-02
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.7776 head_norm=1.432321 delta_norm=0.034502
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1805) from S8
[S15] cosine check vs S8: cos=0.9991
[S2] START round=39 head_norm_before_train=1.378240 cos_to_last_merge=0.9193 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.919
[S2] round=39 local utility u=0.123331 metrics={'f1_val': 0.8327203587630144, 'auprc': 0.8617273963160232, 'loss_val': 0.4106216568504413, 'psi': 0.844323173784218}-{'f1_val': 0.805484930577875, 'auprc': 0.8578675288509411, 'loss_val': 0.4822924299696524, 'psi': 0.8264379698871014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] sending update (kind=head size=1790 to 1 peers)
[S2] r=40 psi=0.844 u=0.1233 p_local=0.1202 f1=0.833 auprc=0.862 bytes=48440
[S3] START round=39 head_norm_before_train=1.367149 cos_to_last_merge=0.9718 (last merge round=23)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.6896819432036914, 'auprc': 0.8227286095285725, 'loss_val': 0.5255909133940136, 'psi': 0.7429006097336438}-{'f1_val': 0.8200173612158386, 'auprc': 0.9755227427381956, 'loss_val': 0.3699497588327207, 'psi': 0.8822195138247815}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.743 u=0.0000 p_local=0.1112 f1=0.690 auprc=0.823 bytes=50327
[S4] START round=39 head_norm_before_train=1.417359 cos_to_last_merge=0.9504 (last merge round=24)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9372441833919076, 'auprc': 0.9244458282503963, 'loss_val': 0.3206119518429303, 'psi': 0.9321248413353032}-{'f1_val': 0.9429349393178588, 'auprc': 0.9651909052750883, 'loss_val': 0.2696343355454076, 'psi': 0.9518373257007506}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.932 u=0.0000 p_local=0.0172 f1=0.937 auprc=0.924 bytes=43134
[S5] START round=39 head_norm_before_train=1.307643 cos_to_last_merge=0.9458 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.5640236169365327, 'auprc': 0.855776638183881, 'loss_val': 0.5900889308348971, 'psi': 0.6807248254354721}-{'f1_val': 0.6481309726694902, 'auprc': 0.8562662451597423, 'loss_val': 0.4501058079954378, 'psi': 0.731385081665591}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.681 u=0.0000 p_local=0.2714 f1=0.564 auprc=0.856 bytes=39586
[S6] START round=39 head_norm_before_train=1.430529 cos_to_last_merge=0.9467 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6704007943761474, 'auprc': 0.9525449736096883, 'loss_val': 0.62597998450228, 'psi': 0.7832584660695638}-{'f1_val': 0.9370757572964457, 'auprc': 0.9813717124933096, 'loss_val': 0.1817882174024438, 'psi': 0.9547941393751912}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.783 u=0.0000 p_local=0.2788 f1=0.670 auprc=0.953 bytes=44953
[S7] START round=39 head_norm_before_train=1.704694 cos_to_last_merge=0.9908 (last merge round=24)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5430407043477564, 'auprc': 0.7847684120842681, 'loss_val': 0.9429141791739565, 'psi': 0.6397317874423611}-{'f1_val': 0.6996569917167555, 'auprc': 0.9841889070047123, 'loss_val': 0.20435364983305981, 'psi': 0.8134697578319383}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.640 u=0.0000 p_local=0.4077 f1=0.543 auprc=0.785 bytes=43150
[S8] START round=39 head_norm_before_train=1.446144 cos_to_last_merge=0.9976 (last merge round=35)
[S8] round=39 local utility u=0.004137 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9825368206276598, 'loss_val': 0.08164753616039708, 'psi': 0.988557495924349}-{'f1_val': 0.9925712794554754, 'auprc': 0.983755860018158, 'loss_val': 0.09357903460425274, 'psi': 0.9890451116805483}
[S9] START round=39 head_norm_before_train=1.974860 (no previous merge yet)
[S9] round=39 local utility u=0.006108 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9995261759026707, 'loss_val': 0.0203724297575446, 'psi': 0.9973265528868616}-{'f1_val': 0.9962500947792776, 'auprc': 0.9948929700219133, 'loss_val': 0.021029387927063495, 'psi': 0.9957072448763319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] r=40 psi=0.997 u=0.0061 p_local=0.0123 f1=0.996 auprc=1.000 bytes=44955
[S10] START round=39 head_norm_before_train=2.094510 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995974205047835, 'loss_val': 0.027399432198719126, 'psi': 0.9955023854307588}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960827079648109, 'loss_val': 0.02724796879778376, 'psi': 0.9955457865975492}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.996 u=0.0000 p_local=0.0023 f1=0.995 auprc=0.996 bytes=50394
[S11] START round=39 head_norm_before_train=1.855178 cos_to_last_merge=0.7631 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.763
[S11] round=39 local utility u=0.000872 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9986017840417033, 'loss_val': 0.024010218417139188, 'psi': 0.997368916324835}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983578939888791, 'loss_val': 0.025022447876316262, 'psi': 0.9972713603037053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] r=40 psi=0.997 u=0.0009 p_local=0.1007 f1=0.997 auprc=0.999 bytes=55712
[S13] START round=39 head_norm_before_train=1.562923 cos_to_last_merge=0.8023 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.802
[S13] round=39 local utility u=0.045539 metrics={'f1_val': 0.6587145577632175, 'auprc': 0.6509966387023914, 'loss_val': 0.8560782934017049, 'psi': 0.6556273901388872}-{'f1_val': 0.6316581652563562, 'auprc': 0.6491214605307072, 'loss_val': 0.779193013545349, 'psi': 0.6386434833660966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S13] r=40 psi=0.656 u=0.0455 p_local=0.0876 f1=0.659 auprc=0.651 bytes=41410
[S14] START round=39 head_norm_before_train=1.841731 cos_to_last_merge=0.9799 (last merge round=18)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9965375310696338, 'auprc': 0.9961760233816027, 'loss_val': 0.029386189403587587, 'psi': 0.9963929279944214}-{'f1_val': 0.996754531653698, 'auprc': 0.9971489992386667, 'loss_val': 0.029062580169141462, 'psi': 0.9969123186876855}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.996 u=0.0000 p_local=0.0024 f1=0.997 auprc=0.996 bytes=55737
[S15] START round=39 head_norm_before_train=1.432321 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.793568 metrics={'f1_val': 0.9958188988109067, 'auprc': 0.9930804975073684, 'loss_val': 0.05247801008199564, 'psi': 0.9947235382894913}-{'f1_val': 0.7794121417366295, 'auprc': 0.9922533624235172, 'loss_val': 0.3386922798406664, 'psi': 0.8645486300113847}
[S16] START round=39 head_norm_before_train=1.782521 cos_to_last_merge=0.7935 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.794
[S16] round=39 local utility u=0.155573 metrics={'f1_val': 0.867806872524058, 'auprc': 0.9963350907052242, 'loss_val': 0.5816480156651517, 'psi': 0.9192181597965244}-{'f1_val': 0.8515987911369884, 'auprc': 0.992047968564379, 'loss_val': 0.7826832390987222, 'psi': 0.9077784621079447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=40 psi=0.919 u=0.1556 p_local=0.1493 f1=0.868 auprc=0.996 bytes=43126
[S17] START round=39 head_norm_before_train=1.698090 cos_to_last_merge=0.8014 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=39 local utility u=0.509911 metrics={'f1_val': 0.6663293486471409, 'auprc': 0.8444404193276884, 'loss_val': 1.1896295624378468, 'psi': 0.7375737769193599}-{'f1_val': 0.6593348289006562, 'auprc': 0.6273071011958867, 'loss_val': 1.5160849494519588, 'psi': 0.6465237378187485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S17] r=40 psi=0.738 u=0.5099 p_local=0.2056 f1=0.666 auprc=0.844 bytes=39579
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=0.9978
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.9978
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9926 head_norm=1.470046
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.865851e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9926 head_norm=1.461479 delta_norm=0.048659
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.989 u=0.0041 p_local=0.0415 f1=0.993 auprc=0.983 bytes=53879
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9958 head_norm=1.454491
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.141640e-02
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9958 head_norm=1.455665 delta_norm=0.041416
[S15] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] r=40 psi=0.995 u=0.7936 p_local=0.2819 f1=0.996 auprc=0.993 bytes=44924
[S2] START round=40 head_norm_before_train=1.393136 cos_to_last_merge=0.9164 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.916
[S2] round=40 local utility u=0.013838 metrics={'f1_val': 0.8281676028892525, 'auprc': 0.866859572842045, 'loss_val': 0.37102538267418805, 'psi': 0.8436443908703695}-{'f1_val': 0.8327203587630144, 'auprc': 0.8617273963160232, 'loss_val': 0.4106216568504413, 'psi': 0.844323173784218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=40 head_norm_before_train=1.382624 cos_to_last_merge=0.9687 (last merge round=23)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.6495222711401712, 'auprc': 0.8124378181870413, 'loss_val': 0.6493817051964111, 'psi': 0.7146884899589192}-{'f1_val': 0.6896819432036914, 'auprc': 0.8227286095285725, 'loss_val': 0.5255909133940136, 'psi': 0.7429006097336438}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.424828 cos_to_last_merge=0.9491 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=40 local utility u=0.087853 metrics={'f1_val': 0.9397674203631332, 'auprc': 0.9652812045272325, 'loss_val': 0.28255072145996607, 'psi': 0.949972934028773}-{'f1_val': 0.9372441833919076, 'auprc': 0.9244458282503963, 'loss_val': 0.3206119518429303, 'psi': 0.9321248413353032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=40 head_norm_before_train=1.319403 cos_to_last_merge=0.9441 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=40 local utility u=0.630983 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9258007134278754, 'loss_val': 0.3559810768350594, 'psi': 0.7905130758314984}-{'f1_val': 0.5640236169365327, 'auprc': 0.855776638183881, 'loss_val': 0.5900889308348971, 'psi': 0.6807248254354721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=40 head_norm_before_train=1.444721 cos_to_last_merge=0.9442 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=40 local utility u=0.450264 metrics={'f1_val': 0.7889821083027422, 'auprc': 0.958448058845743, 'loss_val': 0.4546487755334597, 'psi': 0.8567684885199425}-{'f1_val': 0.6704007943761474, 'auprc': 0.9525449736096883, 'loss_val': 0.62597998450228, 'psi': 0.7832584660695638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=40 head_norm_before_train=1.707173 cos_to_last_merge=0.9907 (last merge round=24)
[S7] round=40 local utility u=0.369067 metrics={'f1_val': 0.6136124568613113, 'auprc': 0.796720933759991, 'loss_val': 0.6640691498092807, 'psi': 0.6868558476207831}-{'f1_val': 0.5430407043477564, 'auprc': 0.7847684120842681, 'loss_val': 0.9429141791739565, 'psi': 0.6397317874423611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=40 head_norm_before_train=1.461479 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000629 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9826481403875844, 'loss_val': 0.076414997459686, 'psi': 0.9881711852613432}-{'f1_val': 0.9925712794554754, 'auprc': 0.9825368206276598, 'loss_val': 0.08164753616039708, 'psi': 0.988557495924349}
[S9] START round=40 head_norm_before_train=1.980571 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9995441699187996, 'loss_val': 0.04013128382480822, 'psi': 0.9932950038135}-{'f1_val': 0.9958601375429889, 'auprc': 0.9995261759026707, 'loss_val': 0.0203724297575446, 'psi': 0.9973265528868616}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.101146 (no previous merge yet)
[S10] round=40 local utility u=0.000075 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959696341350098, 'loss_val': 0.02723596187105297, 'psi': 0.9955005570656288}-{'f1_val': 0.9951878390193748, 'auprc': 0.995974205047835, 'loss_val': 0.027399432198719126, 'psi': 0.9955023854307588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=40 head_norm_before_train=1.868079 cos_to_last_merge=0.7620 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.762
[S11] round=40 local utility u=0.000512 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9987065656150725, 'loss_val': 0.023301442185115057, 'psi': 0.9974108289541828}-{'f1_val': 0.9965470045135896, 'auprc': 0.9986017840417033, 'loss_val': 0.024010218417139188, 'psi': 0.997368916324835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=40 head_norm_before_train=1.574033 cos_to_last_merge=0.8014 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.801
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6289777052494061, 'auprc': 0.6485751032555975, 'loss_val': 0.8503835839024191, 'psi': 0.6368166644518827}-{'f1_val': 0.6587145577632175, 'auprc': 0.6509966387023914, 'loss_val': 0.8560782934017049, 'psi': 0.6556273901388872}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.854939 cos_to_last_merge=0.9792 (last merge round=18)
[S14] round=40 local utility u=0.002789 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9971338705211464, 'loss_val': 0.02697968033849926, 'psi': 0.9968058871749088}-{'f1_val': 0.9965375310696338, 'auprc': 0.9961760233816027, 'loss_val': 0.029386189403587587, 'psi': 0.9963929279944214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=40 head_norm_before_train=1.455665 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.003212 metrics={'f1_val': 0.9958188988109067, 'auprc': 0.9915268916861435, 'loss_val': 0.0413935792770745, 'psi': 0.9941020959610014}-{'f1_val': 0.9958188988109067, 'auprc': 0.9930804975073684, 'loss_val': 0.05247801008199564, 'psi': 0.9947235382894913}
[S16] START round=40 head_norm_before_train=1.790826 cos_to_last_merge=0.7925 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.792
[S16] round=40 local utility u=0.407512 metrics={'f1_val': 0.9404280740837583, 'auprc': 0.9979471358490442, 'loss_val': 0.20718658726540518, 'psi': 0.9634356987898727}-{'f1_val': 0.867806872524058, 'auprc': 0.9963350907052242, 'loss_val': 0.5816480156651517, 'psi': 0.9192181597965244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=40 head_norm_before_train=1.710847 cos_to_last_merge=0.8006 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6526667669335574, 'auprc': 0.8385332772939882, 'loss_val': 1.1999480402965121, 'psi': 0.7270133710777298}-{'f1_val': 0.6663293486471409, 'auprc': 0.8444404193276884, 'loss_val': 1.1896295624378468, 'psi': 0.7375737769193599}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S15
[S8] cosine check vs S15: cos=0.9995
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.9995
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=40 metric=0.9919 head_norm=1.488221
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.366267e-02
[S8] stored merged vector for next round verification (round=40)
[S8] DEBUG after merge:  round=40 metric=0.9922 head_norm=1.481750 delta_norm=0.023663
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.033 → S15@127.0.0.1:33915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.9958 head_norm=1.475631
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.366267e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.9958 head_norm=1.481750 delta_norm=0.023663
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.226 → S8@127.0.0.1:33909
[S2] START round=41 head_norm_before_train=1.410695 cos_to_last_merge=0.9129 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.913
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7978178131068633, 'auprc': 0.7609295842302269, 'loss_val': 0.48600051799338945, 'psi': 0.7830625215562088}-{'f1_val': 0.8281676028892525, 'auprc': 0.866859572842045, 'loss_val': 0.37102538267418805, 'psi': 0.8436443908703695}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.397548 cos_to_last_merge=0.9655 (last merge round=23)
[S3] round=41 local utility u=0.002049 metrics={'f1_val': 0.6536985621519292, 'auprc': 0.8096233054207732, 'loss_val': 0.6618988917215327, 'psi': 0.7160684594594668}-{'f1_val': 0.6495222711401712, 'auprc': 0.8124378181870413, 'loss_val': 0.6493817051964111, 'psi': 0.7146884899589192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=41 head_norm_before_train=1.433914 cos_to_last_merge=0.9477 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=41 local utility u=0.064063 metrics={'f1_val': 0.9504327934389036, 'auprc': 0.9756191716416996, 'loss_val': 0.2494300732052735, 'psi': 0.9605073447200221}-{'f1_val': 0.9397674203631332, 'auprc': 0.9652812045272325, 'loss_val': 0.28255072145996607, 'psi': 0.949972934028773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=41 head_norm_before_train=1.332340 cos_to_last_merge=0.9423 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.5312267989819371, 'auprc': 0.8554662948255015, 'loss_val': 0.7396241570739521, 'psi': 0.6609225973193629}-{'f1_val': 0.7003213174339138, 'auprc': 0.9258007134278754, 'loss_val': 0.3559810768350594, 'psi': 0.7905130758314984}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.461141 cos_to_last_merge=0.9413 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7665013531970944, 'auprc': 0.9488208643857093, 'loss_val': 0.5541910659367945, 'psi': 0.8394291576725403}-{'f1_val': 0.7889821083027422, 'auprc': 0.958448058845743, 'loss_val': 0.4546487755334597, 'psi': 0.8567684885199425}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.710706 cos_to_last_merge=0.9905 (last merge round=24)
[S7] round=41 local utility u=0.197624 metrics={'f1_val': 0.6515296532074457, 'auprc': 0.8049327299354713, 'loss_val': 0.5209587399106931, 'psi': 0.712890883898656}-{'f1_val': 0.6136124568613113, 'auprc': 0.796720933759991, 'loss_val': 0.6640691498092807, 'psi': 0.6868558476207831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=41 head_norm_before_train=1.481750 cos_to_last_merge=1.0000 (last merge round=40)
[S8] round=41 local utility u=0.005010 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.981485092046563, 'loss_val': 0.07159589338301896, 'psi': 0.9885750191340605}-{'f1_val': 0.9918532151771823, 'auprc': 0.9826481403875844, 'loss_val': 0.076414997459686, 'psi': 0.9881711852613432}
[S9] START round=41 head_norm_before_train=1.980268 (no previous merge yet)
[S9] round=41 local utility u=0.005404 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9997141429079026, 'loss_val': 0.03745863662908014, 'psi': 0.9941254513459182}-{'f1_val': 0.9891288930766337, 'auprc': 0.9995441699187996, 'loss_val': 0.04013128382480822, 'psi': 0.9932950038135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=41 head_norm_before_train=2.109255 (no previous merge yet)
[S10] round=41 local utility u=0.000160 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959737538548662, 'loss_val': 0.026929174920690576, 'psi': 0.9955022049535713}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959696341350098, 'loss_val': 0.02723596187105297, 'psi': 0.9955005570656288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=41 head_norm_before_train=1.877949 cos_to_last_merge=0.7607 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.761
[S11] round=41 local utility u=0.000324 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9987109733001241, 'loss_val': 0.022666672817711356, 'psi': 0.9974125920282034}-{'f1_val': 0.9965470045135896, 'auprc': 0.9987065656150725, 'loss_val': 0.023301442185115057, 'psi': 0.9974108289541828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=41 head_norm_before_train=1.584049 cos_to_last_merge=0.8009 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.801
[S13] round=41 local utility u=0.207941 metrics={'f1_val': 0.6604139729449304, 'auprc': 0.6833603449982347, 'loss_val': 0.7274754930264128, 'psi': 0.6695925217662522}-{'f1_val': 0.6289777052494061, 'auprc': 0.6485751032555975, 'loss_val': 0.8503835839024191, 'psi': 0.6368166644518827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=41 head_norm_before_train=1.863432 cos_to_last_merge=0.9787 (last merge round=18)
[S14] round=41 local utility u=0.001394 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971503116455764, 'loss_val': 0.02670313121352631, 'psi': 0.9970586295528296}-{'f1_val': 0.9965872316107504, 'auprc': 0.9971338705211464, 'loss_val': 0.02697968033849926, 'psi': 0.9968058871749088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=41 head_norm_before_train=1.481750 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.9936222327465242, 'auprc': 0.9964765737119188, 'loss_val': 0.06159476485342445, 'psi': 0.9947639691326821}-{'f1_val': 0.9958188988109067, 'auprc': 0.9915268916861435, 'loss_val': 0.0413935792770745, 'psi': 0.9941020959610014}
[S16] START round=41 head_norm_before_train=1.800572 cos_to_last_merge=0.7917 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.792
[S16] round=41 local utility u=0.092017 metrics={'f1_val': 0.9552842656008479, 'auprc': 0.9978709280370991, 'loss_val': 0.11206207055016974, 'psi': 0.9723189305753484}-{'f1_val': 0.9404280740837583, 'auprc': 0.9979471358490442, 'loss_val': 0.20718658726540518, 'psi': 0.9634356987898727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=41 head_norm_before_train=1.722763 cos_to_last_merge=0.7998 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.800
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6616907508381247, 'auprc': 0.7785756067130041, 'loss_val': 1.3953396875892932, 'psi': 0.7084446931880765}-{'f1_val': 0.6526667669335574, 'auprc': 0.8385332772939882, 'loss_val': 1.1999480402965121, 'psi': 0.7270133710777298}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.9997
[S2] START round=42 head_norm_before_train=1.426496 cos_to_last_merge=0.9097 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.910
[S2] round=42 local utility u=0.216056 metrics={'f1_val': 0.8122689939641311, 'auprc': 0.8521707240964645, 'loss_val': 0.4143180282366888, 'psi': 0.8282296860170645}-{'f1_val': 0.7978178131068633, 'auprc': 0.7609295842302269, 'loss_val': 0.48600051799338945, 'psi': 0.7830625215562088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=42 head_norm_before_train=1.410764 cos_to_last_merge=0.9627 (last merge round=23)
[S3] round=42 local utility u=1.000000 metrics={'f1_val': 0.9966787034425938, 'auprc': 0.9985125589071228, 'loss_val': 0.08925066815066686, 'psi': 0.9974122456284054}-{'f1_val': 0.6536985621519292, 'auprc': 0.8096233054207732, 'loss_val': 0.6618988917215327, 'psi': 0.7160684594594668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=42 head_norm_before_train=1.440789 cos_to_last_merge=0.9465 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9405664895832176, 'auprc': 0.9668080317407328, 'loss_val': 0.2860535872913678, 'psi': 0.9510631064462237}-{'f1_val': 0.9504327934389036, 'auprc': 0.9756191716416996, 'loss_val': 0.2494300732052735, 'psi': 0.9605073447200221}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.342066 cos_to_last_merge=0.9410 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=42 local utility u=0.868967 metrics={'f1_val': 0.6910530753525023, 'auprc': 0.9668550052001676, 'loss_val': 0.29481321559825424, 'psi': 0.8013738472915685}-{'f1_val': 0.5312267989819371, 'auprc': 0.8554662948255015, 'loss_val': 0.7396241570739521, 'psi': 0.6609225973193629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=42 head_norm_before_train=1.475680 cos_to_last_merge=0.9390 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7468537246773135, 'auprc': 0.9569878254513022, 'loss_val': 0.5435744775173469, 'psi': 0.830907364986909}-{'f1_val': 0.7665013531970944, 'auprc': 0.9488208643857093, 'loss_val': 0.5541910659367945, 'psi': 0.8394291576725403}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.714665 cos_to_last_merge=0.9902 (last merge round=24)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5525376775221765, 'auprc': 0.7845253325052639, 'loss_val': 0.8900111599110629, 'psi': 0.6453327395154115}-{'f1_val': 0.6515296532074457, 'auprc': 0.8049327299354713, 'loss_val': 0.5209587399106931, 'psi': 0.712890883898656}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.505930 cos_to_last_merge=0.9998 (last merge round=40)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.9816409389285351, 'loss_val': 0.06988285087617649, 'psi': 0.9857957935388056}-{'f1_val': 0.9933016371923923, 'auprc': 0.981485092046563, 'loss_val': 0.07159589338301896, 'psi': 0.9885750191340605}
[S9] START round=42 head_norm_before_train=1.981227 (no previous merge yet)
[S9] round=42 local utility u=0.020858 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.996255752473451, 'loss_val': 0.020470224162567646, 'psi': 0.996252357856947}-{'f1_val': 0.990399656971262, 'auprc': 0.9997141429079026, 'loss_val': 0.03745863662908014, 'psi': 0.9941254513459182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=42 head_norm_before_train=2.118071 (no previous merge yet)
[S10] round=42 local utility u=0.000007 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959618051039348, 'loss_val': 0.026880068656770627, 'psi': 0.9954974254531987}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959737538548662, 'loss_val': 0.026929174920690576, 'psi': 0.9955022049535713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=42 head_norm_before_train=1.888893 cos_to_last_merge=0.7596 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.760
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998272049470544, 'loss_val': 0.022170226486416512, 'psi': 0.9972370224963714}-{'f1_val': 0.9965470045135896, 'auprc': 0.9987109733001241, 'loss_val': 0.022666672817711356, 'psi': 0.9974125920282034}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.591062 cos_to_last_merge=0.8005 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.800
[S13] round=42 local utility u=0.103426 metrics={'f1_val': 0.7269601108464459, 'auprc': 0.658823491852702, 'loss_val': 0.8462898737837891, 'psi': 0.6997054632489483}-{'f1_val': 0.6604139729449304, 'auprc': 0.6833603449982347, 'loss_val': 0.7274754930264128, 'psi': 0.6695925217662522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1814 reason=None
[S13] sending update (kind=head size=1814 to 1 peers)
[S14] START round=42 head_norm_before_train=1.871091 cos_to_last_merge=0.9782 (last merge round=18)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971515437205817, 'loss_val': 0.026984901758520873, 'psi': 0.9970591223828318}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971503116455764, 'loss_val': 0.02670313121352631, 'psi': 0.9970586295528296}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.501204 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.698291246046771, 'auprc': 0.8998651807584923, 'loss_val': 0.5523742404376957, 'psi': 0.7789208199314595}-{'f1_val': 0.9936222327465242, 'auprc': 0.9964765737119188, 'loss_val': 0.06159476485342445, 'psi': 0.9947639691326821}
[S16] START round=42 head_norm_before_train=1.810985 cos_to_last_merge=0.7911 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.791
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8723663798787746, 'auprc': 0.9928304559253921, 'loss_val': 0.551601961862975, 'psi': 0.9205520102974216}-{'f1_val': 0.9552842656008479, 'auprc': 0.9978709280370991, 'loss_val': 0.11206207055016974, 'psi': 0.9723189305753484}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.735061 cos_to_last_merge=0.7988 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.799
[S17] round=42 local utility u=0.151459 metrics={'f1_val': 0.6564868777572377, 'auprc': 0.8357655488713245, 'loss_val': 1.232768324580408, 'psi': 0.7281983462028724}-{'f1_val': 0.6616907508381247, 'auprc': 0.7785756067130041, 'loss_val': 1.3953396875892932, 'psi': 0.7084446931880765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.6983 head_norm=1.519470
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.168204e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.6983 head_norm=1.512560 delta_norm=0.021682
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.439432 cos_to_last_merge=0.9070 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.907
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7155444185859678, 'auprc': 0.8622952409482157, 'loss_val': 0.5579268717706316, 'psi': 0.774244747530867}-{'f1_val': 0.8122689939641311, 'auprc': 0.8521707240964645, 'loss_val': 0.4143180282366888, 'psi': 0.8282296860170645}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.421456 cos_to_last_merge=0.9606 (last merge round=23)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9367414189095618, 'auprc': 0.9809675361932371, 'loss_val': 0.1404793181256521, 'psi': 0.9544318658230319}-{'f1_val': 0.9966787034425938, 'auprc': 0.9985125589071228, 'loss_val': 0.08925066815066686, 'psi': 0.9974122456284054}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.446726 cos_to_last_merge=0.9455 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=43 local utility u=0.043323 metrics={'f1_val': 0.9475282873947753, 'auprc': 0.9753410443569457, 'loss_val': 0.26677682292762467, 'psi': 0.9586533901796435}-{'f1_val': 0.9405664895832176, 'auprc': 0.9668080317407328, 'loss_val': 0.2860535872913678, 'psi': 0.9510631064462237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=43 head_norm_before_train=1.349870 cos_to_last_merge=0.9399 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.6056406337176176, 'auprc': 0.8993446582550347, 'loss_val': 0.46612125718587405, 'psi': 0.7231222435325844}-{'f1_val': 0.6910530753525023, 'auprc': 0.9668550052001676, 'loss_val': 0.29481321559825424, 'psi': 0.8013738472915685}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.486312 cos_to_last_merge=0.9371 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.937
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7231521590397414, 'auprc': 0.9555645805235999, 'loss_val': 0.5906210632557335, 'psi': 0.8161171276332848}-{'f1_val': 0.7468537246773135, 'auprc': 0.9569878254513022, 'loss_val': 0.5435744775173469, 'psi': 0.830907364986909}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.717944 cos_to_last_merge=0.9900 (last merge round=24)
[S7] round=43 local utility u=0.831426 metrics={'f1_val': 0.6880331482168344, 'auprc': 0.8713317387694299, 'loss_val': 0.30055152750087605, 'psi': 0.7613525844378726}-{'f1_val': 0.5525376775221765, 'auprc': 0.7845253325052639, 'loss_val': 0.8900111599110629, 'psi': 0.6453327395154115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=43 head_norm_before_train=1.528732 cos_to_last_merge=0.9992 (last merge round=40)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9864258722700556, 'auprc': 0.981558787169734, 'loss_val': 0.06877678729732428, 'psi': 0.984479038229927}-{'f1_val': 0.9885656966123193, 'auprc': 0.9816409389285351, 'loss_val': 0.06988285087617649, 'psi': 0.9857957935388056}
[S9] START round=43 head_norm_before_train=1.985782 (no previous merge yet)
[S9] round=43 local utility u=0.002655 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9970539164419341, 'loss_val': 0.02001652361669721, 'psi': 0.9968178736651085}-{'f1_val': 0.9962500947792776, 'auprc': 0.996255752473451, 'loss_val': 0.020470224162567646, 'psi': 0.996252357856947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=43 head_norm_before_train=2.127347 (no previous merge yet)
[S10] round=43 local utility u=0.000016 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959499158760792, 'loss_val': 0.026813223227266383, 'psi': 0.9954926697620565}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959618051039348, 'loss_val': 0.026880068656770627, 'psi': 0.9954974254531987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=43 head_norm_before_train=1.898960 cos_to_last_merge=0.7584 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.758
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9976263136453263, 'loss_val': 0.022831176638394853, 'psi': 0.9967307304061161}-{'f1_val': 0.9965470045135896, 'auprc': 0.998272049470544, 'loss_val': 0.022170226486416512, 'psi': 0.9972370224963714}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.601689 cos_to_last_merge=0.7996 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.800
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6446901741532365, 'auprc': 0.6626174010615444, 'loss_val': 0.83159953011407, 'psi': 0.6518610649165597}-{'f1_val': 0.7269601108464459, 'auprc': 0.658823491852702, 'loss_val': 0.8462898737837891, 'psi': 0.6997054632489483}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.880203 cos_to_last_merge=0.9776 (last merge round=18)
[S14] round=43 local utility u=0.000666 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971584434087012, 'loss_val': 0.025673552433561328, 'psi': 0.9970618822580795}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971515437205817, 'loss_val': 0.026984901758520873, 'psi': 0.9970591223828318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=43 head_norm_before_train=1.512560 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.534905 metrics={'f1_val': 0.7984563276787543, 'auprc': 0.9918301319366685, 'loss_val': 0.3594498378612562, 'psi': 0.87580584938192}-{'f1_val': 0.698291246046771, 'auprc': 0.8998651807584923, 'loss_val': 0.5523742404376957, 'psi': 0.7789208199314595}
[S16] START round=43 head_norm_before_train=1.818587 cos_to_last_merge=0.7902 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.790
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8683603129367973, 'auprc': 0.9903088990835454, 'loss_val': 0.616578884451208, 'psi': 0.9171397473954965}-{'f1_val': 0.8723663798787746, 'auprc': 0.9928304559253921, 'loss_val': 0.551601961862975, 'psi': 0.9205520102974216}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.746650 cos_to_last_merge=0.7979 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=43 local utility u=0.147944 metrics={'f1_val': 0.6632544033732204, 'auprc': 0.858586096853247, 'loss_val': 1.045947288965878, 'psi': 0.7413870807652311}-{'f1_val': 0.6564868777572377, 'auprc': 0.8357655488713245, 'loss_val': 1.232768324580408, 'psi': 0.7281983462028724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S15
[S8] cosine check vs S15: cos=0.9990
[S2] START round=44 head_norm_before_train=1.452064 cos_to_last_merge=0.9043 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.904
[S2] round=44 local utility u=0.149410 metrics={'f1_val': 0.7611172917722508, 'auprc': 0.8614082511510037, 'loss_val': 0.5298836721845502, 'psi': 0.801233675523752}-{'f1_val': 0.7155444185859678, 'auprc': 0.8622952409482157, 'loss_val': 0.5579268717706316, 'psi': 0.774244747530867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=44 head_norm_before_train=1.427952 cos_to_last_merge=0.9586 (last merge round=23)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.6470093272332078, 'auprc': 0.8073918916703908, 'loss_val': 0.7208808734753586, 'psi': 0.7111623530080811}-{'f1_val': 0.9367414189095618, 'auprc': 0.9809675361932371, 'loss_val': 0.1404793181256521, 'psi': 0.9544318658230319}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.453995 cos_to_last_merge=0.9445 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.8078760926913066, 'auprc': 0.9257585633488963, 'loss_val': 0.4483458770541052, 'psi': 0.8550290809543424}-{'f1_val': 0.9475282873947753, 'auprc': 0.9753410443569457, 'loss_val': 0.26677682292762467, 'psi': 0.9586533901796435}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.361879 cos_to_last_merge=0.9380 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.42543064689752996, 'auprc': 0.8208032646154184, 'loss_val': 1.090912327582326, 'psi': 0.5835796939846853}-{'f1_val': 0.6056406337176176, 'auprc': 0.8993446582550347, 'loss_val': 0.46612125718587405, 'psi': 0.7231222435325844}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.498387 cos_to_last_merge=0.9350 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.935
[S6] round=44 local utility u=0.286709 metrics={'f1_val': 0.7925619114073243, 'auprc': 0.9626554446532003, 'loss_val': 0.4549332953973081, 'psi': 0.8605993247056747}-{'f1_val': 0.7231521590397414, 'auprc': 0.9555645805235999, 'loss_val': 0.5906210632557335, 'psi': 0.8161171276332848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=44 head_norm_before_train=1.721047 cos_to_last_merge=0.9897 (last merge round=24)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5484382948279103, 'auprc': 0.7840918349694883, 'loss_val': 0.9044850202432361, 'psi': 0.6426997108845416}-{'f1_val': 0.6880331482168344, 'auprc': 0.8713317387694299, 'loss_val': 0.30055152750087605, 'psi': 0.7613525844378726}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.548312 cos_to_last_merge=0.9986 (last merge round=40)
[S8] round=44 local utility u=0.019951 metrics={'f1_val': 0.9929762634442646, 'auprc': 0.9801831993898871, 'loss_val': 0.06405101448755969, 'psi': 0.9878590378225136}-{'f1_val': 0.9864258722700556, 'auprc': 0.981558787169734, 'loss_val': 0.06877678729732428, 'psi': 0.984479038229927}
[S9] START round=44 head_norm_before_train=1.990309 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9999248386862385, 'loss_val': 0.023355770328146893, 'psi': 0.9967341252441169}-{'f1_val': 0.9966605118138915, 'auprc': 0.9970539164419341, 'loss_val': 0.02001652361669721, 'psi': 0.9968178736651085}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.132291 (no previous merge yet)
[S10] round=44 local utility u=0.000036 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959342271538663, 'loss_val': 0.02669352938878588, 'psi': 0.9954863942731713}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959499158760792, 'loss_val': 0.026813223227266383, 'psi': 0.9954926697620565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=44 head_norm_before_train=1.907693 cos_to_last_merge=0.7573 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.757
[S11] round=44 local utility u=0.000599 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9976787979240351, 'loss_val': 0.02179157761138274, 'psi': 0.9967517241175996}-{'f1_val': 0.9961336749133093, 'auprc': 0.9976263136453263, 'loss_val': 0.022831176638394853, 'psi': 0.9967307304061161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=44 head_norm_before_train=1.616067 cos_to_last_merge=0.7987 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.799
[S13] round=44 local utility u=0.300740 metrics={'f1_val': 0.7356100919061986, 'auprc': 0.6769077028386636, 'loss_val': 0.8185096166134043, 'psi': 0.7121291362791846}-{'f1_val': 0.6446901741532365, 'auprc': 0.6626174010615444, 'loss_val': 0.83159953011407, 'psi': 0.6518610649165597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=44 head_norm_before_train=1.888441 cos_to_last_merge=0.9773 (last merge round=18)
[S14] round=44 local utility u=0.000498 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9971527761209847, 'loss_val': 0.023656373686533345, 'psi': 0.9969591585437207}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971584434087012, 'loss_val': 0.025673552433561328, 'psi': 0.9970618822580795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=44 head_norm_before_train=1.526663 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=44 local utility u=0.751900 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9915134353683019, 'loss_val': 0.042215066541588006, 'psi': 0.9944306823335145}-{'f1_val': 0.7984563276787543, 'auprc': 0.9918301319366685, 'loss_val': 0.3594498378612562, 'psi': 0.87580584938192}
[S16] START round=44 head_norm_before_train=1.823028 cos_to_last_merge=0.7892 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.789
[S16] round=44 local utility u=0.666023 metrics={'f1_val': 0.9920932356398957, 'auprc': 0.994957404920249, 'loss_val': 0.04087663309080289, 'psi': 0.993238903352037}-{'f1_val': 0.8683603129367973, 'auprc': 0.9903088990835454, 'loss_val': 0.616578884451208, 'psi': 0.9171397473954965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=44 head_norm_before_train=1.760611 cos_to_last_merge=0.7969 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.797
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6645594081776267, 'auprc': 0.7077647808902789, 'loss_val': 1.4109621144344329, 'psi': 0.6818415572626877}-{'f1_val': 0.6632544033732204, 'auprc': 0.858586096853247, 'loss_val': 1.045947288965878, 'psi': 0.7413870807652311}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=0.9984
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.9984
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.9964 head_norm=1.542741
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.628594e-02
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.9964 head_norm=1.554728 delta_norm=0.046286
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9930 head_norm=1.567989
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.654065e-02
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9930 head_norm=1.550730 delta_norm=0.046541
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.465364 cos_to_last_merge=0.9016 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=45 local utility u=0.208665 metrics={'f1_val': 0.8309515971761327, 'auprc': 0.8172161035756076, 'loss_val': 0.39898216807671166, 'psi': 0.8254573997359226}-{'f1_val': 0.7611172917722508, 'auprc': 0.8614082511510037, 'loss_val': 0.5298836721845502, 'psi': 0.801233675523752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=45 head_norm_before_train=1.433729 cos_to_last_merge=0.9568 (last merge round=23)
[S3] round=45 local utility u=0.727270 metrics={'f1_val': 0.8104232158936241, 'auprc': 0.8474068828821291, 'loss_val': 0.3668686384196599, 'psi': 0.825216682689026}-{'f1_val': 0.6470093272332078, 'auprc': 0.8073918916703908, 'loss_val': 0.7208808734753586, 'psi': 0.7111623530080811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=45 head_norm_before_train=1.463358 cos_to_last_merge=0.9431 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.943
[S4] round=45 local utility u=0.508331 metrics={'f1_val': 0.9388844913055161, 'auprc': 0.9534310889121547, 'loss_val': 0.30075282036413126, 'psi': 0.9447031303481715}-{'f1_val': 0.8078760926913066, 'auprc': 0.9257585633488963, 'loss_val': 0.4483458770541052, 'psi': 0.8550290809543424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=45 head_norm_before_train=1.372847 cos_to_last_merge=0.9359 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9892678073460659, 'loss_val': 0.23615906639316572, 'psi': 0.8160552736568306}-{'f1_val': 0.42543064689752996, 'auprc': 0.8208032646154184, 'loss_val': 1.090912327582326, 'psi': 0.5835796939846853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=45 head_norm_before_train=1.509119 cos_to_last_merge=0.9332 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.780244262058952, 'auprc': 0.9653429459069013, 'loss_val': 0.5165902372279623, 'psi': 0.8542837355981316}-{'f1_val': 0.7925619114073243, 'auprc': 0.9626554446532003, 'loss_val': 0.4549332953973081, 'psi': 0.8605993247056747}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.723839 cos_to_last_merge=0.9895 (last merge round=24)
[S7] round=45 local utility u=0.373289 metrics={'f1_val': 0.6158388727653221, 'auprc': 0.7986980618861267, 'loss_val': 0.6061296807635145, 'psi': 0.6889825484136439}-{'f1_val': 0.5484382948279103, 'auprc': 0.7840918349694883, 'loss_val': 0.9044850202432361, 'psi': 0.6426997108845416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=45 head_norm_before_train=1.550730 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.001087 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9805187227316832, 'loss_val': 0.05614588626524448, 'psi': 0.9873194181989826}-{'f1_val': 0.9929762634442646, 'auprc': 0.9801831993898871, 'loss_val': 0.06405101448755969, 'psi': 0.9878590378225136}
[S9] START round=45 head_norm_before_train=1.996269 (no previous merge yet)
[S9] round=45 local utility u=0.007733 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996999228543315, 'loss_val': 0.019536025973716287, 'psi': 0.9978762762300675}-{'f1_val': 0.9946069829493691, 'auprc': 0.9999248386862385, 'loss_val': 0.023355770328146893, 'psi': 0.9967341252441169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=45 head_norm_before_train=2.137386 (no previous merge yet)
[S10] round=45 local utility u=0.000149 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959392581821094, 'loss_val': 0.026410053434986307, 'psi': 0.9954884066844686}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959342271538663, 'loss_val': 0.02669352938878588, 'psi': 0.9954863942731713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=45 head_norm_before_train=1.916057 cos_to_last_merge=0.7565 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.756
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9975993395695462, 'loss_val': 0.02492886174578362, 'psi': 0.9967199407758041}-{'f1_val': 0.9961336749133093, 'auprc': 0.9976787979240351, 'loss_val': 0.02179157761138274, 'psi': 0.9967517241175996}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.628652 cos_to_last_merge=0.7976 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.798
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6399400453421744, 'auprc': 0.6459669827806933, 'loss_val': 0.9796016363692783, 'psi': 0.6423508203175821}-{'f1_val': 0.7356100919061986, 'auprc': 0.6769077028386636, 'loss_val': 0.8185096166134043, 'psi': 0.7121291362791846}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.896910 cos_to_last_merge=0.9767 (last merge round=18)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971521691071985, 'loss_val': 0.025688091672028197, 'psi': 0.9970593725374784}-{'f1_val': 0.9968300801588782, 'auprc': 0.9971527761209847, 'loss_val': 0.023656373686533345, 'psi': 0.9969591585437207}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.554728 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.003607 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9933743351317593, 'loss_val': 0.038003306027332935, 'psi': 0.9949169069378037}-{'f1_val': 0.9963755136436562, 'auprc': 0.9915134353683019, 'loss_val': 0.042215066541588006, 'psi': 0.9944306823335145}
[S16] START round=45 head_norm_before_train=1.830283 cos_to_last_merge=0.7885 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.788
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9700711738602128, 'auprc': 0.9966152081464265, 'loss_val': 0.09298429798742533, 'psi': 0.9806887875746984}-{'f1_val': 0.9920932356398957, 'auprc': 0.994957404920249, 'loss_val': 0.04087663309080289, 'psi': 0.993238903352037}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.774272 cos_to_last_merge=0.7961 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.796
[S17] round=45 local utility u=0.051562 metrics={'f1_val': 0.6571795600580135, 'auprc': 0.7512838657337058, 'loss_val': 1.3941159004604489, 'psi': 0.6948212823282904}-{'f1_val': 0.6645594081776267, 'auprc': 0.7077647808902789, 'loss_val': 1.4109621144344329, 'psi': 0.6818415572626877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=45 metric=0.9959 head_norm=1.573535
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.319646e-02
[S15] stored merged vector for next round verification (round=45)
[S15] DEBUG after merge:  round=45 metric=0.9959 head_norm=1.571485 delta_norm=0.013196
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.264 → S8@127.0.0.1:33909
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.9919 head_norm=1.569544
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.319645e-02
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.9919 head_norm=1.571485 delta_norm=0.013196
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.015 → S15@127.0.0.1:33915
[S2] START round=46 head_norm_before_train=1.474432 cos_to_last_merge=0.8995 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.899
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7118137444247382, 'auprc': 0.902177857842329, 'loss_val': 0.5043203395686018, 'psi': 0.7879593897917745}-{'f1_val': 0.8309515971761327, 'auprc': 0.8172161035756076, 'loss_val': 0.39898216807671166, 'psi': 0.8254573997359226}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.440324 cos_to_last_merge=0.9553 (last merge round=23)
[S3] round=46 local utility u=0.932288 metrics={'f1_val': 0.9971202529699166, 'auprc': 0.9988816355929886, 'loss_val': 0.07689862596446641, 'psi': 0.9978248060191454}-{'f1_val': 0.8104232158936241, 'auprc': 0.8474068828821291, 'loss_val': 0.3668686384196599, 'psi': 0.825216682689026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=46 head_norm_before_train=1.468743 cos_to_last_merge=0.9420 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=46 local utility u=0.049688 metrics={'f1_val': 0.9414189762626136, 'auprc': 0.9748530209497976, 'loss_val': 0.280849352790973, 'psi': 0.9547925941374872}-{'f1_val': 0.9388844913055161, 'auprc': 0.9534310889121547, 'loss_val': 0.30075282036413126, 'psi': 0.9447031303481715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=46 head_norm_before_train=1.380264 cos_to_last_merge=0.9345 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.6194020018451053, 'auprc': 0.8554568498734751, 'loss_val': 0.5291818158544151, 'psi': 0.7138239410564533}-{'f1_val': 0.7005802511973405, 'auprc': 0.9892678073460659, 'loss_val': 0.23615906639316572, 'psi': 0.8160552736568306}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.518947 cos_to_last_merge=0.9319 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=46 local utility u=0.496522 metrics={'f1_val': 0.8898360581648043, 'auprc': 0.9801457191489262, 'loss_val': 0.22550585024880132, 'psi': 0.925959922558453}-{'f1_val': 0.780244262058952, 'auprc': 0.9653429459069013, 'loss_val': 0.5165902372279623, 'psi': 0.8542837355981316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=46 head_norm_before_train=1.726721 cos_to_last_merge=0.9893 (last merge round=24)
[S7] round=46 local utility u=0.080915 metrics={'f1_val': 0.6273786744818789, 'auprc': 0.8029292344669514, 'loss_val': 0.5262326959804051, 'psi': 0.6975988984759078}-{'f1_val': 0.6158388727653221, 'auprc': 0.7986980618861267, 'loss_val': 0.6061296807635145, 'psi': 0.6889825484136439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=46 head_norm_before_train=1.571485 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9579801707688914, 'auprc': 0.9814973157449486, 'loss_val': 0.1501107549103848, 'psi': 0.9673870287593143}-{'f1_val': 0.9918532151771823, 'auprc': 0.9805187227316832, 'loss_val': 0.05614588626524448, 'psi': 0.9873194181989826}
[S9] START round=46 head_norm_before_train=2.001514 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9953254113178883, 'loss_val': 0.02021852302068209, 'psi': 0.9958802213947219}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996999228543315, 'loss_val': 0.019536025973716287, 'psi': 0.9978762762300675}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.144259 (no previous merge yet)
[S10] round=46 local utility u=0.000043 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959179618483931, 'loss_val': 0.026260970690028917, 'psi': 0.9954798881509821}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959392581821094, 'loss_val': 0.026410053434986307, 'psi': 0.9954884066844686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=46 head_norm_before_train=1.923799 cos_to_last_merge=0.7557 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.756
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.865690216876443, 'auprc': 0.9969739425861396, 'loss_val': 0.154896769273263, 'psi': 0.9182037071603216}-{'f1_val': 0.9961336749133093, 'auprc': 0.9975993395695462, 'loss_val': 0.02492886174578362, 'psi': 0.9967199407758041}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.643913 cos_to_last_merge=0.7971 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.797
[S13] round=46 local utility u=0.369165 metrics={'f1_val': 0.722802567993025, 'auprc': 0.6781951296630505, 'loss_val': 0.8351312944265916, 'psi': 0.7049595926610353}-{'f1_val': 0.6399400453421744, 'auprc': 0.6459669827806933, 'loss_val': 0.9796016363692783, 'psi': 0.6423508203175821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=46 head_norm_before_train=1.904444 cos_to_last_merge=0.9762 (last merge round=18)
[S14] round=46 local utility u=0.000784 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971531141193267, 'loss_val': 0.024122334100586645, 'psi': 0.9970597505423298}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971521691071985, 'loss_val': 0.025688091672028197, 'psi': 0.9970593725374784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=46 head_norm_before_train=1.571485 cos_to_last_merge=1.0000 (last merge round=45)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9595113032114848, 'auprc': 0.993682162692608, 'loss_val': 0.07420280732328213, 'psi': 0.973179647003934}-{'f1_val': 0.9959452881418331, 'auprc': 0.9933743351317593, 'loss_val': 0.038003306027332935, 'psi': 0.9949169069378037}
[S16] START round=46 head_norm_before_train=1.839198 cos_to_last_merge=0.7878 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.788
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8480314394442764, 'auprc': 0.9919375710695908, 'loss_val': 0.907772634732128, 'psi': 0.9055938920944022}-{'f1_val': 0.9700711738602128, 'auprc': 0.9966152081464265, 'loss_val': 0.09298429798742533, 'psi': 0.9806887875746984}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.785233 cos_to_last_merge=0.7953 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.795
[S17] round=46 local utility u=0.159220 metrics={'f1_val': 0.6602122099483583, 'auprc': 0.8336741792581923, 'loss_val': 1.3410427963130709, 'psi': 0.7295969976722919}-{'f1_val': 0.6571795600580135, 'auprc': 0.7512838657337058, 'loss_val': 1.3941159004604489, 'psi': 0.6948212823282904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.484634 cos_to_last_merge=0.8974 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7956876400508467, 'auprc': 0.7369239010633994, 'loss_val': 0.5645719845886379, 'psi': 0.7721821444558679}-{'f1_val': 0.7118137444247382, 'auprc': 0.902177857842329, 'loss_val': 0.5043203395686018, 'psi': 0.7879593897917745}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.449149 cos_to_last_merge=0.9533 (last merge round=23)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9101658800008203, 'auprc': 0.9317216054570582, 'loss_val': 0.1854242150079745, 'psi': 0.9187881701833155}-{'f1_val': 0.9971202529699166, 'auprc': 0.9988816355929886, 'loss_val': 0.07689862596446641, 'psi': 0.9978248060191454}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.472923 cos_to_last_merge=0.9411 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9380259320837298, 'auprc': 0.9570674442748628, 'loss_val': 0.3023145552220386, 'psi': 0.945642536960183}-{'f1_val': 0.9414189762626136, 'auprc': 0.9748530209497976, 'loss_val': 0.280849352790973, 'psi': 0.9547925941374872}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.387186 cos_to_last_merge=0.9335 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=47 local utility u=1.000000 metrics={'f1_val': 0.8498517210389029, 'auprc': 0.9911744141661927, 'loss_val': 0.17580702679155222, 'psi': 0.9063807982898188}-{'f1_val': 0.6194020018451053, 'auprc': 0.8554568498734751, 'loss_val': 0.5291818158544151, 'psi': 0.7138239410564533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=47 head_norm_before_train=1.530647 cos_to_last_merge=0.9304 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.8038451118873272, 'auprc': 0.9698971470249679, 'loss_val': 0.45747355612811313, 'psi': 0.8702659259423835}-{'f1_val': 0.8898360581648043, 'auprc': 0.9801457191489262, 'loss_val': 0.22550585024880132, 'psi': 0.925959922558453}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.732488 cos_to_last_merge=0.9888 (last merge round=24)
[S7] round=47 local utility u=0.132773 metrics={'f1_val': 0.6589817892906908, 'auprc': 0.8069082916236604, 'loss_val': 0.46224285681263333, 'psi': 0.7181523902238787}-{'f1_val': 0.6273786744818789, 'auprc': 0.8029292344669514, 'loss_val': 0.5262326959804051, 'psi': 0.6975988984759078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=47 head_norm_before_train=1.588837 cos_to_last_merge=0.9999 (last merge round=45)
[S8] round=47 local utility u=0.149815 metrics={'f1_val': 0.9927318893430277, 'auprc': 0.9801143305005243, 'loss_val': 0.054841584616409755, 'psi': 0.9876848658060263}-{'f1_val': 0.9579801707688914, 'auprc': 0.9814973157449486, 'loss_val': 0.1501107549103848, 'psi': 0.9673870287593143}
[S9] START round=47 head_norm_before_train=2.008534 (no previous merge yet)
[S9] round=47 local utility u=0.002237 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9998936113971688, 'loss_val': 0.02209067804764434, 'psi': 0.9969716952073449}-{'f1_val': 0.9962500947792776, 'auprc': 0.9953254113178883, 'loss_val': 0.02021852302068209, 'psi': 0.9958802213947219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=47 head_norm_before_train=2.151873 (no previous merge yet)
[S10] round=47 local utility u=0.000330 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995964813819084, 'loss_val': 0.025742199194046314, 'psi': 0.9954986289392584}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959179618483931, 'loss_val': 0.026260970690028917, 'psi': 0.9954798881509821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=47 head_norm_before_train=1.931255 cos_to_last_merge=0.7550 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.755
[S11] round=47 local utility u=0.464020 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9987874736947585, 'loss_val': 0.018889018466539797, 'psi': 0.997588219383522}-{'f1_val': 0.865690216876443, 'auprc': 0.9969739425861396, 'loss_val': 0.154896769273263, 'psi': 0.9182037071603216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=47 head_norm_before_train=1.657314 cos_to_last_merge=0.7965 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.796
[S13] round=47 local utility u=0.006878 metrics={'f1_val': 0.7299829581533313, 'auprc': 0.6750885239366341, 'loss_val': 0.8551369720264659, 'psi': 0.7080251844666524}-{'f1_val': 0.722802567993025, 'auprc': 0.6781951296630505, 'loss_val': 0.8351312944265916, 'psi': 0.7049595926610353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=47 head_norm_before_train=1.911577 cos_to_last_merge=0.9756 (last merge round=18)
[S14] round=47 local utility u=0.000304 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9971508685052315, 'loss_val': 0.02250262585526422, 'psi': 0.9969583954974195}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971531141193267, 'loss_val': 0.024122334100586645, 'psi': 0.9970597505423298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=47 head_norm_before_train=1.590125 cos_to_last_merge=1.0000 (last merge round=45)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7737457879158631, 'auprc': 0.9913205869092939, 'loss_val': 0.4445425419268371, 'psi': 0.8607757075132354}-{'f1_val': 0.9595113032114848, 'auprc': 0.993682162692608, 'loss_val': 0.07420280732328213, 'psi': 0.973179647003934}
[S16] START round=47 head_norm_before_train=1.848474 cos_to_last_merge=0.7872 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.787
[S16] round=47 local utility u=0.735142 metrics={'f1_val': 0.9594701487230539, 'auprc': 0.9936065411617399, 'loss_val': 0.11112822636107653, 'psi': 0.9731247056985284}-{'f1_val': 0.8480314394442764, 'auprc': 0.9919375710695908, 'loss_val': 0.907772634732128, 'psi': 0.9055938920944022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=47 head_norm_before_train=1.796191 cos_to_last_merge=0.7941 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6661715692936581, 'auprc': 0.7295478878871294, 'loss_val': 1.4796841112121288, 'psi': 0.6915220967310467}-{'f1_val': 0.6602122099483583, 'auprc': 0.8336741792581923, 'loss_val': 1.3410427963130709, 'psi': 0.7295969976722919}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=0.9997
[S2] START round=48 head_norm_before_train=1.494583 cos_to_last_merge=0.8956 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.896
[S2] round=48 local utility u=0.032997 metrics={'f1_val': 0.7103283975968488, 'auprc': 0.914931913792008, 'loss_val': 0.5204469818279227, 'psi': 0.7921698040749126}-{'f1_val': 0.7956876400508467, 'auprc': 0.7369239010633994, 'loss_val': 0.5645719845886379, 'psi': 0.7721821444558679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=48 head_norm_before_train=1.456390 cos_to_last_merge=0.9517 (last merge round=23)
[S3] round=48 local utility u=0.420336 metrics={'f1_val': 0.9969646238426165, 'auprc': 0.9993754366900034, 'loss_val': 0.06850641433257668, 'psi': 0.9979289489815713}-{'f1_val': 0.9101658800008203, 'auprc': 0.9317216054570582, 'loss_val': 0.1854242150079745, 'psi': 0.9187881701833155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] sending update (kind=head size=1807 to 1 peers)
[S4] START round=48 head_norm_before_train=1.479074 cos_to_last_merge=0.9400 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=48 local utility u=0.064399 metrics={'f1_val': 0.9452359749287038, 'auprc': 0.9761142214657879, 'loss_val': 0.27391650128227085, 'psi': 0.9575872735435373}-{'f1_val': 0.9380259320837298, 'auprc': 0.9570674442748628, 'loss_val': 0.3023145552220386, 'psi': 0.945642536960183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=48 head_norm_before_train=1.392773 cos_to_last_merge=0.9329 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.4694313541968886, 'auprc': 0.855384616668698, 'loss_val': 0.7148096379884744, 'psi': 0.6238126591856124}-{'f1_val': 0.8498517210389029, 'auprc': 0.9911744141661927, 'loss_val': 0.17580702679155222, 'psi': 0.9063807982898188}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.540194 cos_to_last_merge=0.9288 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.8033669503944314, 'auprc': 0.9582016533835283, 'loss_val': 0.46338213815832524, 'psi': 0.8653008315900701}-{'f1_val': 0.8038451118873272, 'auprc': 0.9698971470249679, 'loss_val': 0.45747355612811313, 'psi': 0.8702659259423835}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.737514 cos_to_last_merge=0.9884 (last merge round=24)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.613249346611253, 'auprc': 0.7943033264484547, 'loss_val': 0.6628584482698208, 'psi': 0.6856709385461337}-{'f1_val': 0.6589817892906908, 'auprc': 0.8069082916236604, 'loss_val': 0.46224285681263333, 'psi': 0.7181523902238787}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.603520 cos_to_last_merge=0.9998 (last merge round=45)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9889241575992487, 'auprc': 0.9794816279506522, 'loss_val': 0.054042967999904504, 'psi': 0.98514714573981}-{'f1_val': 0.9927318893430277, 'auprc': 0.9801143305005243, 'loss_val': 0.054841584616409755, 'psi': 0.9876848658060263}
[S9] START round=48 head_norm_before_train=2.016797 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9908329001136983, 'auprc': 0.9998734586092456, 'loss_val': 0.03041310424026377, 'psi': 0.9944491235119172}-{'f1_val': 0.9950237510807955, 'auprc': 0.9998936113971688, 'loss_val': 0.02209067804764434, 'psi': 0.9969716952073449}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.159904 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957919917060404, 'loss_val': 0.026234616898079106, 'psi': 0.995429500094041}-{'f1_val': 0.9951878390193748, 'auprc': 0.995964813819084, 'loss_val': 0.025742199194046314, 'psi': 0.9954986289392584}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.939485 cos_to_last_merge=0.7544 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.754
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998758219176328, 'loss_val': 0.020700658050793533, 'psi': 0.997431490378685}-{'f1_val': 0.9967887165093644, 'auprc': 0.9987874736947585, 'loss_val': 0.018889018466539797, 'psi': 0.997588219383522}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.669078 cos_to_last_merge=0.7959 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.796
[S13] round=48 local utility u=0.079901 metrics={'f1_val': 0.7341329336890642, 'auprc': 0.6881477956113554, 'loss_val': 0.759412689399365, 'psi': 0.7157388784579807}-{'f1_val': 0.7299829581533313, 'auprc': 0.6750885239366341, 'loss_val': 0.8551369720264659, 'psi': 0.7080251844666524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=48 head_norm_before_train=1.920289 cos_to_last_merge=0.9750 (last merge round=18)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971555408082869, 'loss_val': 0.029217836275526148, 'psi': 0.9974528871532269}-{'f1_val': 0.9968300801588782, 'auprc': 0.9971508685052315, 'loss_val': 0.02250262585526422, 'psi': 0.9969583954974195}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.607858 cos_to_last_merge=0.9999 (last merge round=45)
[S15] round=48 local utility u=0.879503 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9951913727712152, 'loss_val': 0.03515345732931641, 'psi': 0.9961245501409984}-{'f1_val': 0.7737457879158631, 'auprc': 0.9913205869092939, 'loss_val': 0.4445425419268371, 'psi': 0.8607757075132354}
[S16] START round=48 head_norm_before_train=1.857147 cos_to_last_merge=0.7867 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.787
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8308670671644292, 'auprc': 0.982244176495267, 'loss_val': 0.7637702519999727, 'psi': 0.8914179108967644}-{'f1_val': 0.9594701487230539, 'auprc': 0.9936065411617399, 'loss_val': 0.11112822636107653, 'psi': 0.9731247056985284}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.806586 cos_to_last_merge=0.7933 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.793
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6572114247462881, 'auprc': 0.7032348250777499, 'loss_val': 1.650683949709175, 'psi': 0.6756207848788729}-{'f1_val': 0.6661715692936581, 'auprc': 0.7295478878871294, 'loss_val': 1.4796841112121288, 'psi': 0.6915220967310467}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=0.9994
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.9967 head_norm=1.623462
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.594757e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.9967 head_norm=1.613313 delta_norm=0.025948
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.503363 cos_to_last_merge=0.8941 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.894
[S2] round=49 local utility u=0.145736 metrics={'f1_val': 0.7820668290393831, 'auprc': 0.8672008494529445, 'loss_val': 0.5162120508831235, 'psi': 0.8161204372048076}-{'f1_val': 0.7103283975968488, 'auprc': 0.914931913792008, 'loss_val': 0.5204469818279227, 'psi': 0.7921698040749126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=49 head_norm_before_train=1.464932 cos_to_last_merge=0.9498 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9944384319709132, 'auprc': 0.9995060315368341, 'loss_val': 0.06928326218422902, 'psi': 0.9964654717972816}-{'f1_val': 0.9969646238426165, 'auprc': 0.9993754366900034, 'loss_val': 0.06850641433257668, 'psi': 0.9979289489815713}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.485630 cos_to_last_merge=0.9388 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=49 local utility u=0.003565 metrics={'f1_val': 0.9479360322282891, 'auprc': 0.9737416434332502, 'loss_val': 0.27587009848775007, 'psi': 0.9582582767102735}-{'f1_val': 0.9452359749287038, 'auprc': 0.9761142214657879, 'loss_val': 0.27391650128227085, 'psi': 0.9575872735435373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=49 head_norm_before_train=1.398715 cos_to_last_merge=0.9322 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=49 local utility u=0.331391 metrics={'f1_val': 0.5705283892244696, 'auprc': 0.8554229590244538, 'loss_val': 0.6587253717696431, 'psi': 0.6844862171444632}-{'f1_val': 0.4694313541968886, 'auprc': 0.855384616668698, 'loss_val': 0.7148096379884744, 'psi': 0.6238126591856124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=49 head_norm_before_train=1.550508 cos_to_last_merge=0.9272 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.5840957116625852, 'auprc': 0.7055121377259145, 'loss_val': 1.1721655898640841, 'psi': 0.6326622820879169}-{'f1_val': 0.8033669503944314, 'auprc': 0.9582016533835283, 'loss_val': 0.46338213815832524, 'psi': 0.8653008315900701}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.740656 cos_to_last_merge=0.9881 (last merge round=24)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5881544184345243, 'auprc': 0.7922479639243394, 'loss_val': 0.7745383369775368, 'psi': 0.6697918366304504}-{'f1_val': 0.613249346611253, 'auprc': 0.7943033264484547, 'loss_val': 0.6628584482698208, 'psi': 0.6856709385461337}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.617913 cos_to_last_merge=0.9997 (last merge round=45)
[S8] round=49 local utility u=0.016480 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9803144303767626, 'loss_val': 0.04765258500835256, 'psi': 0.9878874815157992}-{'f1_val': 0.9889241575992487, 'auprc': 0.9794816279506522, 'loss_val': 0.054042967999904504, 'psi': 0.98514714573981}
[S9] START round=49 head_norm_before_train=2.024446 (no previous merge yet)
[S9] round=49 local utility u=0.018396 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9997622161844952, 'loss_val': 0.020755690432118105, 'psi': 0.9971513792269351}-{'f1_val': 0.9908329001136983, 'auprc': 0.9998734586092456, 'loss_val': 0.03041310424026377, 'psi': 0.9944491235119172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=49 head_norm_before_train=2.161835 (no previous merge yet)
[S10] round=49 local utility u=0.000167 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995826436382159, 'loss_val': 0.026004860355161682, 'psi': 0.9954432779644884}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957919917060404, 'loss_val': 0.026234616898079106, 'psi': 0.995429500094041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=49 head_norm_before_train=1.948587 cos_to_last_merge=0.7537 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.754
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9987650921590456, 'loss_val': 0.02183381739239539, 'psi': 0.997434239571772}-{'f1_val': 0.9965470045135896, 'auprc': 0.998758219176328, 'loss_val': 0.020700658050793533, 'psi': 0.997431490378685}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.677626 cos_to_last_merge=0.7954 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.795
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6365960494873206, 'auprc': 0.6482388650173881, 'loss_val': 0.9924560652575082, 'psi': 0.6412531756993476}-{'f1_val': 0.7341329336890642, 'auprc': 0.6881477956113554, 'loss_val': 0.759412689399365, 'psi': 0.7157388784579807}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.929049 cos_to_last_merge=0.9745 (last merge round=18)
[S14] round=49 local utility u=0.002761 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971527509897675, 'loss_val': 0.021222655392265238, 'psi': 0.9972053144193829}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971555408082869, 'loss_val': 0.029217836275526148, 'psi': 0.9974528871532269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=49 head_norm_before_train=1.613313 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.976308500782475, 'auprc': 0.9931800056886508, 'loss_val': 0.058733959143330565, 'psi': 0.9830571027449453}-{'f1_val': 0.9967466683875206, 'auprc': 0.9951913727712152, 'loss_val': 0.03515345732931641, 'psi': 0.9961245501409984}
[S16] START round=49 head_norm_before_train=1.861135 cos_to_last_merge=0.7858 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.786
[S16] round=49 local utility u=0.556817 metrics={'f1_val': 0.9174362622497996, 'auprc': 0.994552300489636, 'loss_val': 0.2064753977599665, 'psi': 0.9482826775457341}-{'f1_val': 0.8308670671644292, 'auprc': 0.982244176495267, 'loss_val': 0.7637702519999727, 'psi': 0.8914179108967644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=49 head_norm_before_train=1.813551 cos_to_last_merge=0.7930 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.793
[S17] round=49 local utility u=0.332076 metrics={'f1_val': 0.6706711940412956, 'auprc': 0.8061724921948075, 'loss_val': 1.3761030542082209, 'psi': 0.7248717133027004}-{'f1_val': 0.6572114247462881, 'auprc': 0.7032348250777499, 'loss_val': 1.650683949709175, 'psi': 0.6756207848788729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.9995
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=49 metric=0.9929 head_norm=1.630907
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.318586e-02
[S8] stored merged vector for next round verification (round=49)
[S8] DEBUG after merge:  round=49 metric=0.9929 head_norm=1.626850 delta_norm=0.033186
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=50 head_norm_before_train=1.510428 cos_to_last_merge=0.8929 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.893
[S2] round=50 local utility u=0.148812 metrics={'f1_val': 0.8360341610154061, 'auprc': 0.8576274226436859, 'loss_val': 0.5136721117388233, 'psi': 0.8446714656667179}-{'f1_val': 0.7820668290393831, 'auprc': 0.8672008494529445, 'loss_val': 0.5162120508831235, 'psi': 0.8161204372048076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=50 head_norm_before_train=1.473721 cos_to_last_merge=0.9482 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.59044791484652, 'auprc': 0.8052607139465561, 'loss_val': 0.8526455047568746, 'psi': 0.6763730344865344}-{'f1_val': 0.9944384319709132, 'auprc': 0.9995060315368341, 'loss_val': 0.06928326218422902, 'psi': 0.9964654717972816}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.494022 cos_to_last_merge=0.9374 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.937
[S4] round=50 local utility u=0.004965 metrics={'f1_val': 0.9482485195545017, 'auprc': 0.9750722916675489, 'loss_val': 0.2718065544809984, 'psi': 0.9589780283997207}-{'f1_val': 0.9479360322282891, 'auprc': 0.9737416434332502, 'loss_val': 0.27587009848775007, 'psi': 0.9582582767102735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=50 head_norm_before_train=1.407175 cos_to_last_merge=0.9313 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.931
[S5] round=50 local utility u=0.740082 metrics={'f1_val': 0.6985612194195203, 'auprc': 0.9685857260149926, 'loss_val': 0.2862472306286788, 'psi': 0.8065710220577093}-{'f1_val': 0.5705283892244696, 'auprc': 0.8554229590244538, 'loss_val': 0.6587253717696431, 'psi': 0.6844862171444632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=50 head_norm_before_train=1.560585 cos_to_last_merge=0.9254 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.925
[S6] round=50 local utility u=1.000000 metrics={'f1_val': 0.9604071620302558, 'auprc': 0.9607107817268579, 'loss_val': 0.2076862513079094, 'psi': 0.9605286099088965}-{'f1_val': 0.5840957116625852, 'auprc': 0.7055121377259145, 'loss_val': 1.1721655898640841, 'psi': 0.6326622820879169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=50 head_norm_before_train=1.742876 cos_to_last_merge=0.9880 (last merge round=24)
[S7] round=50 local utility u=0.623847 metrics={'f1_val': 0.6895993570142758, 'auprc': 0.8533200666121493, 'loss_val': 0.31873026448073716, 'psi': 0.7550876408534252}-{'f1_val': 0.5881544184345243, 'auprc': 0.7922479639243394, 'loss_val': 0.7745383369775368, 'psi': 0.6697918366304504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=50 head_norm_before_train=1.626850 cos_to_last_merge=1.0000 (last merge round=49)
[S8] round=50 local utility u=0.000607 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.98010469732742, 'loss_val': 0.049037203241487824, 'psi': 0.9881263741086963}-{'f1_val': 0.9929361822751569, 'auprc': 0.9803144303767626, 'loss_val': 0.04765258500835256, 'psi': 0.9878874815157992}
[S9] START round=50 head_norm_before_train=2.032434 (no previous merge yet)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9996214829893084, 'loss_val': 0.024164534141772675, 'psi': 0.996362417046063}-{'f1_val': 0.9954108212552283, 'auprc': 0.9997622161844952, 'loss_val': 0.020755690432118105, 'psi': 0.9971513792269351}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=50 head_norm_before_train=2.166707 (no previous merge yet)
[S10] round=50 local utility u=0.000165 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958223119848262, 'loss_val': 0.025661513226540922, 'psi': 0.9954416282055554}-{'f1_val': 0.9951878390193748, 'auprc': 0.995826436382159, 'loss_val': 0.026004860355161682, 'psi': 0.9954432779644884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=50 head_norm_before_train=1.957600 cos_to_last_merge=0.7530 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.753
[S11] round=50 local utility u=0.000443 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9983261733248605, 'loss_val': 0.018725109206972866, 'psi': 0.9971679816484107}-{'f1_val': 0.9965470045135896, 'auprc': 0.9987650921590456, 'loss_val': 0.02183381739239539, 'psi': 0.997434239571772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=50 head_norm_before_train=1.686267 cos_to_last_merge=0.7948 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.795
[S13] round=50 local utility u=0.540900 metrics={'f1_val': 0.7607539089453879, 'auprc': 0.6917613434235347, 'loss_val': 0.7861702038692019, 'psi': 0.7331568827366466}-{'f1_val': 0.6365960494873206, 'auprc': 0.6482388650173881, 'loss_val': 0.9924560652575082, 'psi': 0.6412531756993476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=50 head_norm_before_train=1.937948 cos_to_last_merge=0.9739 (last merge round=18)
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971565464944178, 'loss_val': 0.021513592925057005, 'psi': 0.9970611234923661}-{'f1_val': 0.997240356705793, 'auprc': 0.9971527509897675, 'loss_val': 0.021222655392265238, 'psi': 0.9972053144193829}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=50 head_norm_before_train=1.627933 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=50 local utility u=0.072915 metrics={'f1_val': 0.9951712326766344, 'auprc': 0.9945287182999438, 'loss_val': 0.03012726199688207, 'psi': 0.9949142269259581}-{'f1_val': 0.976308500782475, 'auprc': 0.9931800056886508, 'loss_val': 0.058733959143330565, 'psi': 0.9830571027449453}
[S16] START round=50 head_norm_before_train=1.864996 cos_to_last_merge=0.7850 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.785
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.8701726659488804, 'auprc': 0.9908778344887593, 'loss_val': 0.6761215295825399, 'psi': 0.9184547333648321}-{'f1_val': 0.9174362622497996, 'auprc': 0.994552300489636, 'loss_val': 0.2064753977599665, 'psi': 0.9482826775457341}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.823568 cos_to_last_merge=0.7927 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.793
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6520247581612233, 'auprc': 0.7970317875143832, 'loss_val': 1.4569748550064685, 'psi': 0.7100275699024873}-{'f1_val': 0.6706711940412956, 'auprc': 0.8061724921948075, 'loss_val': 1.3761030542082209, 'psi': 0.7248717133027004}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1807) from S15
[S8] cosine check vs S15: cos=0.9998
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=50 metric=0.9952 head_norm=1.641747
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.227247e-02
[S15] stored merged vector for next round verification (round=50)
[S15] DEBUG after merge:  round=50 metric=0.9952 head_norm=1.638030 delta_norm=0.022272
[S15] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.214 → S8@127.0.0.1:33909
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=50 metric=0.9935 head_norm=1.638398
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.662578e-02
[S8] stored merged vector for next round verification (round=50)
[S8] DEBUG after merge:  round=50 metric=0.9935 head_norm=1.639989 delta_norm=0.016626
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.023 → S15@127.0.0.1:33915
[S2] START round=51 head_norm_before_train=1.520120 cos_to_last_merge=0.8913 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.891
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.7405164124328794, 'auprc': 0.859565442403937, 'loss_val': 0.5798154788802369, 'psi': 0.7881360244213025}-{'f1_val': 0.8360341610154061, 'auprc': 0.8576274226436859, 'loss_val': 0.5136721117388233, 'psi': 0.8446714656667179}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=1.481395 cos_to_last_merge=0.9470 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.947
[S3] round=51 local utility u=1.000000 metrics={'f1_val': 0.8822443107729565, 'auprc': 0.9832966930870151, 'loss_val': 0.23695897386501108, 'psi': 0.9226652636985799}-{'f1_val': 0.59044791484652, 'auprc': 0.8052607139465561, 'loss_val': 0.8526455047568746, 'psi': 0.6763730344865344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=51 head_norm_before_train=1.500860 cos_to_last_merge=0.9362 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9410037842504573, 'auprc': 0.973114186353364, 'loss_val': 0.29021773384756, 'psi': 0.95384794509162}-{'f1_val': 0.9482485195545017, 'auprc': 0.9750722916675489, 'loss_val': 0.2718065544809984, 'psi': 0.9589780283997207}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.414754 cos_to_last_merge=0.9303 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9787820921713442, 'loss_val': 0.34034016821143565, 'psi': 0.8117569826970987}-{'f1_val': 0.6985612194195203, 'auprc': 0.9685857260149926, 'loss_val': 0.2862472306286788, 'psi': 0.8065710220577093}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.567749 cos_to_last_merge=0.9242 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.642394418382713, 'auprc': 0.9504072071574924, 'loss_val': 0.8354516340355076, 'psi': 0.7655995338926248}-{'f1_val': 0.9604071620302558, 'auprc': 0.9607107817268579, 'loss_val': 0.2076862513079094, 'psi': 0.9605286099088965}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.744795 cos_to_last_merge=0.9879 (last merge round=24)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.44941374563391645, 'auprc': 0.7803430530305775, 'loss_val': 1.2527549271208025, 'psi': 0.581785468592581}-{'f1_val': 0.6895993570142758, 'auprc': 0.8533200666121493, 'loss_val': 0.31873026448073716, 'psi': 0.7550876408534252}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.639989 cos_to_last_merge=1.0000 (last merge round=50)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9804511693757855, 'loss_val': 0.04573449852520838, 'psi': 0.9877232354235994}-{'f1_val': 0.9934741586295472, 'auprc': 0.98010469732742, 'loss_val': 0.049037203241487824, 'psi': 0.9881263741086963}
[S9] START round=51 head_norm_before_train=2.040179 (no previous merge yet)
[S9] round=51 local utility u=0.005746 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9995385640628002, 'loss_val': 0.01975129591274061, 'psi': 0.997061918378257}-{'f1_val': 0.9941897064172326, 'auprc': 0.9996214829893084, 'loss_val': 0.024164534141772675, 'psi': 0.996362417046063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=51 head_norm_before_train=2.173051 (no previous merge yet)
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956703511081263, 'loss_val': 0.02581440683754455, 'psi': 0.9953808438548754}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958223119848262, 'loss_val': 0.025661513226540922, 'psi': 0.9954416282055554}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=1.965308 cos_to_last_merge=0.7524 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.752
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9968148065043232, 'loss_val': 0.027625911732629373, 'psi': 0.9964184074481766}-{'f1_val': 0.9963958538641108, 'auprc': 0.9983261733248605, 'loss_val': 0.018725109206972866, 'psi': 0.9971679816484107}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=51 head_norm_before_train=1.692762 cos_to_last_merge=0.7943 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.794
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.659699807878852, 'auprc': 0.663097524648751, 'loss_val': 0.9137450539878583, 'psi': 0.6610588945868117}-{'f1_val': 0.7607539089453879, 'auprc': 0.6917613434235347, 'loss_val': 0.7861702038692019, 'psi': 0.7331568827366466}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=1.946261 cos_to_last_merge=0.9735 (last merge round=18)
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9971545563913568, 'loss_val': 0.024225409990836635, 'psi': 0.9968141615229928}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971565464944178, 'loss_val': 0.021513592925057005, 'psi': 0.9970611234923661}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=51 head_norm_before_train=1.638030 cos_to_last_merge=1.0000 (last merge round=50)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.988089300778824, 'auprc': 0.9970355526973838, 'loss_val': 0.06072821322241073, 'psi': 0.9916678015462479}-{'f1_val': 0.9951712326766344, 'auprc': 0.9945287182999438, 'loss_val': 0.03012726199688207, 'psi': 0.9949142269259581}
[S16] START round=51 head_norm_before_train=1.870148 cos_to_last_merge=0.7843 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.784
[S16] round=51 local utility u=0.382957 metrics={'f1_val': 0.9342056891714524, 'auprc': 0.9948455102918062, 'loss_val': 0.3063095703536039, 'psi': 0.9584616176195939}-{'f1_val': 0.8701726659488804, 'auprc': 0.9908778344887593, 'loss_val': 0.6761215295825399, 'psi': 0.9184547333648321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=51 head_norm_before_train=1.833191 cos_to_last_merge=0.7920 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.6373646486117645, 'auprc': 0.7574409157354236, 'loss_val': 1.4090912784683352, 'psi': 0.6853951554612281}-{'f1_val': 0.6520247581612233, 'auprc': 0.7970317875143832, 'loss_val': 1.4569748550064685, 'psi': 0.7100275699024873}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=52 head_norm_before_train=1.529256 cos_to_last_merge=0.8898 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.890
[S2] round=52 local utility u=0.351020 metrics={'f1_val': 0.8343625881196205, 'auprc': 0.8766212105103006, 'loss_val': 0.49201934773834133, 'psi': 0.8512660370758924}-{'f1_val': 0.7405164124328794, 'auprc': 0.859565442403937, 'loss_val': 0.5798154788802369, 'psi': 0.7881360244213025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=52 head_norm_before_train=1.486599 cos_to_last_merge=0.9462 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.8466589639925337, 'auprc': 0.9682788394606882, 'loss_val': 0.2621297752702927, 'psi': 0.8953069141797956}-{'f1_val': 0.8822443107729565, 'auprc': 0.9832966930870151, 'loss_val': 0.23695897386501108, 'psi': 0.9226652636985799}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=1.508685 cos_to_last_merge=0.9350 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.7460604155033692, 'auprc': 0.942672813430838, 'loss_val': 0.5143070511736391, 'psi': 0.8247053746743567}-{'f1_val': 0.9410037842504573, 'auprc': 0.973114186353364, 'loss_val': 0.29021773384756, 'psi': 0.95384794509162}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.420386 cos_to_last_merge=0.9294 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.6970987544180874, 'auprc': 0.9126727227214178, 'loss_val': 0.4092284514590577, 'psi': 0.7833283417394196}-{'f1_val': 0.7004069097142683, 'auprc': 0.9787820921713442, 'loss_val': 0.34034016821143565, 'psi': 0.8117569826970987}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=52 head_norm_before_train=1.573880 cos_to_last_merge=0.9232 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.923
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.5981040804276635, 'auprc': 0.7547129722329857, 'loss_val': 1.1245607023849198, 'psi': 0.6607476371497925}-{'f1_val': 0.642394418382713, 'auprc': 0.9504072071574924, 'loss_val': 0.8354516340355076, 'psi': 0.7655995338926248}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.748127 cos_to_last_merge=0.9877 (last merge round=24)
[S7] round=52 local utility u=1.000000 metrics={'f1_val': 0.6530953432321684, 'auprc': 0.8028090387605351, 'loss_val': 0.5385626503398313, 'psi': 0.7129808214435152}-{'f1_val': 0.44941374563391645, 'auprc': 0.7803430530305775, 'loss_val': 1.2527549271208025, 'psi': 0.581785468592581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=52 head_norm_before_train=1.651454 cos_to_last_merge=1.0000 (last merge round=50)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9892104968014376, 'auprc': 0.9809782160870705, 'loss_val': 0.049018001647832064, 'psi': 0.9859175845156908}-{'f1_val': 0.9925712794554754, 'auprc': 0.9804511693757855, 'loss_val': 0.04573449852520838, 'psi': 0.9877232354235994}
[S9] START round=52 head_norm_before_train=2.046829 (no previous merge yet)
[S9] round=52 local utility u=0.004955 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996268227767122, 'loss_val': 0.017604130003121107, 'psi': 0.9978470361990197}-{'f1_val': 0.9954108212552283, 'auprc': 0.9995385640628002, 'loss_val': 0.01975129591274061, 'psi': 0.997061918378257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=52 head_norm_before_train=2.180106 (no previous merge yet)
[S10] round=52 local utility u=0.000406 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957935167407874, 'loss_val': 0.02537234997984977, 'psi': 0.9954301101079398}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956703511081263, 'loss_val': 0.02581440683754455, 'psi': 0.9953808438548754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=52 head_norm_before_train=1.971930 cos_to_last_merge=0.7519 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.752
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9967492235496975, 'loss_val': 0.05206203614427334, 'psi': 0.9963798943678646}-{'f1_val': 0.9961541414107454, 'auprc': 0.9968148065043232, 'loss_val': 0.027625911732629373, 'psi': 0.9964184074481766}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=1.697553 cos_to_last_merge=0.7941 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.794
[S13] round=52 local utility u=0.055601 metrics={'f1_val': 0.7237918686005191, 'auprc': 0.6366610668173446, 'loss_val': 1.107785299955791, 'psi': 0.6889395478872493}-{'f1_val': 0.659699807878852, 'auprc': 0.663097524648751, 'loss_val': 0.9137450539878583, 'psi': 0.6610588945868117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=52 head_norm_before_train=1.953853 cos_to_last_merge=0.9731 (last merge round=18)
[S14] round=52 local utility u=0.002007 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9971546358451151, 'loss_val': 0.02269310211597708, 'psi': 0.9970622822665927}-{'f1_val': 0.9965872316107504, 'auprc': 0.9971545563913568, 'loss_val': 0.024225409990836635, 'psi': 0.9968141615229928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=52 head_norm_before_train=1.648907 cos_to_last_merge=1.0000 (last merge round=50)
[S15] round=52 local utility u=0.000000 metrics={'f1_val': 0.700833884979711, 'auprc': 0.896032429217015, 'loss_val': 0.6273196314718295, 'psi': 0.7789133026746327}-{'f1_val': 0.988089300778824, 'auprc': 0.9970355526973838, 'loss_val': 0.06072821322241073, 'psi': 0.9916678015462479}
[S16] START round=52 head_norm_before_train=1.875198 cos_to_last_merge=0.7837 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.784
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.8574258665066833, 'auprc': 0.9934012624783625, 'loss_val': 0.8418344348364116, 'psi': 0.911816024895355}-{'f1_val': 0.9342056891714524, 'auprc': 0.9948455102918062, 'loss_val': 0.3063095703536039, 'psi': 0.9584616176195939}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.836673 cos_to_last_merge=0.7910 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.791
[S17] round=52 local utility u=0.341688 metrics={'f1_val': 0.6522332647556427, 'auprc': 0.856407879210175, 'loss_val': 1.1118273541168722, 'psi': 0.7339031105374556}-{'f1_val': 0.6373646486117645, 'auprc': 0.7574409157354236, 'loss_val': 1.4090912784683352, 'psi': 0.6853951554612281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=1.538850 cos_to_last_merge=0.8885 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=53 local utility u=0.001067 metrics={'f1_val': 0.8345657094164397, 'auprc': 0.8573035873115206, 'loss_val': 0.4331519281661293, 'psi': 0.8436608605744721}-{'f1_val': 0.8343625881196205, 'auprc': 0.8766212105103006, 'loss_val': 0.49201934773834133, 'psi': 0.8512660370758924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=53 head_norm_before_train=1.491319 cos_to_last_merge=0.9453 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.8354153243349429, 'auprc': 0.9689680872368854, 'loss_val': 0.27635394846634465, 'psi': 0.88883642949572}-{'f1_val': 0.8466589639925337, 'auprc': 0.9682788394606882, 'loss_val': 0.2621297752702927, 'psi': 0.8953069141797956}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.520426 cos_to_last_merge=0.9334 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=53 local utility u=0.720467 metrics={'f1_val': 0.9395727784673576, 'auprc': 0.9635478262040026, 'loss_val': 0.29707173338967324, 'psi': 0.9491627975620156}-{'f1_val': 0.7460604155033692, 'auprc': 0.942672813430838, 'loss_val': 0.5143070511736391, 'psi': 0.8247053746743567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=53 head_norm_before_train=1.426685 cos_to_last_merge=0.9289 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.6739596219308239, 'auprc': 0.9267397848230272, 'loss_val': 0.402222049524761, 'psi': 0.7750716870877052}-{'f1_val': 0.6970987544180874, 'auprc': 0.9126727227214178, 'loss_val': 0.4092284514590577, 'psi': 0.7833283417394196}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=1.578351 cos_to_last_merge=0.9227 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.923
[S6] round=53 local utility u=1.000000 metrics={'f1_val': 0.8458137330389788, 'auprc': 0.9848884496679586, 'loss_val': 0.27477785435560215, 'psi': 0.9014436196905706}-{'f1_val': 0.5981040804276635, 'auprc': 0.7547129722329857, 'loss_val': 1.1245607023849198, 'psi': 0.6607476371497925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=53 head_norm_before_train=1.750805 cos_to_last_merge=0.9874 (last merge round=24)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.601379821364437, 'auprc': 0.7914245318802181, 'loss_val': 0.7482135549775942, 'psi': 0.6773977055707494}-{'f1_val': 0.6530953432321684, 'auprc': 0.8028090387605351, 'loss_val': 0.5385626503398313, 'psi': 0.7129808214435152}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=1.664835 cos_to_last_merge=0.9999 (last merge round=50)
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9867122114722444, 'auprc': 0.9813684203686436, 'loss_val': 0.05372903248859535, 'psi': 0.9845746950308041}-{'f1_val': 0.9892104968014376, 'auprc': 0.9809782160870705, 'loss_val': 0.049018001647832064, 'psi': 0.9859175845156908}
[S9] START round=53 head_norm_before_train=2.051783 (no previous merge yet)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9997179286252653, 'loss_val': 0.03751003950636373, 'psi': 0.9937042762672306}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996268227767122, 'loss_val': 0.017604130003121107, 'psi': 0.9978470361990197}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=2.187438 (no previous merge yet)
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957889841538924, 'loss_val': 0.025577602726671016, 'psi': 0.9954282970731818}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957935167407874, 'loss_val': 0.02537234997984977, 'psi': 0.9954301101079398}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=1.978966 cos_to_last_merge=0.7513 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.751
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.7692363958894738, 'auprc': 0.9951040371339921, 'loss_val': 0.368175070657039, 'psi': 0.8595834523872812}-{'f1_val': 0.9961336749133093, 'auprc': 0.9967492235496975, 'loss_val': 0.05206203614427334, 'psi': 0.9963798943678646}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=1.699014 cos_to_last_merge=0.7935 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.793
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6241255747956965, 'auprc': 0.6458359395893672, 'loss_val': 1.082571236616985, 'psi': 0.6328097207131649}-{'f1_val': 0.7237918686005191, 'auprc': 0.6366610668173446, 'loss_val': 1.107785299955791, 'psi': 0.6889395478872493}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=1.962136 cos_to_last_merge=0.9727 (last merge round=18)
[S14] round=53 local utility u=0.001280 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9971521814237269, 'loss_val': 0.02158299702433532, 'psi': 0.9972070096269141}-{'f1_val': 0.9970007132142444, 'auprc': 0.9971546358451151, 'loss_val': 0.02269310211597708, 'psi': 0.9970622822665927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=53 head_norm_before_train=1.656007 cos_to_last_merge=1.0000 (last merge round=50)
[S15] round=53 local utility u=0.903784 metrics={'f1_val': 0.8885043087036938, 'auprc': 0.995842457404931, 'loss_val': 0.24520411640652942, 'psi': 0.9314395681841887}-{'f1_val': 0.700833884979711, 'auprc': 0.896032429217015, 'loss_val': 0.6273196314718295, 'psi': 0.7789133026746327}
[S16] START round=53 head_norm_before_train=1.882389 cos_to_last_merge=0.7831 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.783
[S16] round=53 local utility u=0.239450 metrics={'f1_val': 0.8885795134786372, 'auprc': 0.9834365140396082, 'loss_val': 0.5199629669845659, 'psi': 0.9265223137030256}-{'f1_val': 0.8574258665066833, 'auprc': 0.9934012624783625, 'loss_val': 0.8418344348364116, 'psi': 0.911816024895355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=53 head_norm_before_train=1.842723 cos_to_last_merge=0.7902 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.790
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.6563020383440563, 'auprc': 0.7806448722221261, 'loss_val': 1.3623604914389242, 'psi': 0.7060391718952842}-{'f1_val': 0.6522332647556427, 'auprc': 0.856407879210175, 'loss_val': 1.1118273541168722, 'psi': 0.7339031105374556}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=0.9998
[S2] START round=54 head_norm_before_train=1.549073 cos_to_last_merge=0.8873 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.887
[S2] round=54 local utility u=0.007824 metrics={'f1_val': 0.8326752678240155, 'auprc': 0.8815694912521637, 'loss_val': 0.47895858032036964, 'psi': 0.8522329571952747}-{'f1_val': 0.8345657094164397, 'auprc': 0.8573035873115206, 'loss_val': 0.4331519281661293, 'psi': 0.8436608605744721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=54 head_norm_before_train=1.498113 cos_to_last_merge=0.9440 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=54 local utility u=0.554546 metrics={'f1_val': 0.9756007752409522, 'auprc': 0.9977585907835906, 'loss_val': 0.09474597996772106, 'psi': 0.9844639014580076}-{'f1_val': 0.8354153243349429, 'auprc': 0.9689680872368854, 'loss_val': 0.27635394846634465, 'psi': 0.88883642949572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=54 head_norm_before_train=1.527302 cos_to_last_merge=0.9322 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.932
[S4] round=54 local utility u=0.020514 metrics={'f1_val': 0.941018597092791, 'auprc': 0.9711295058656843, 'loss_val': 0.2874631859707954, 'psi': 0.9530629606019483}-{'f1_val': 0.9395727784673576, 'auprc': 0.9635478262040026, 'loss_val': 0.29707173338967324, 'psi': 0.9491627975620156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=54 head_norm_before_train=1.432292 cos_to_last_merge=0.9286 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=54 local utility u=0.230833 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9778044891335639, 'loss_val': 0.2524346926424739, 'psi': 0.8113659414819866}-{'f1_val': 0.6739596219308239, 'auprc': 0.9267397848230272, 'loss_val': 0.402222049524761, 'psi': 0.7750716870877052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=54 head_norm_before_train=1.582748 cos_to_last_merge=0.9220 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.922
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.5975759502609922, 'auprc': 0.9566223297729041, 'loss_val': 0.7796934247218048, 'psi': 0.741194502065757}-{'f1_val': 0.8458137330389788, 'auprc': 0.9848884496679586, 'loss_val': 0.27477785435560215, 'psi': 0.9014436196905706}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.754217 cos_to_last_merge=0.9872 (last merge round=24)
[S7] round=54 local utility u=0.403600 metrics={'f1_val': 0.6639442061511333, 'auprc': 0.8189244480159614, 'loss_val': 0.39890034870069524, 'psi': 0.7259363028970645}-{'f1_val': 0.601379821364437, 'auprc': 0.7914245318802181, 'loss_val': 0.7482135549775942, 'psi': 0.6773977055707494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=54 head_norm_before_train=1.677125 cos_to_last_merge=0.9998 (last merge round=50)
[S8] round=54 local utility u=0.021681 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9804569598869017, 'loss_val': 0.04278784685090702, 'psi': 0.9877255516280459}-{'f1_val': 0.9867122114722444, 'auprc': 0.9813684203686436, 'loss_val': 0.05372903248859535, 'psi': 0.9845746950308041}
[S9] START round=54 head_norm_before_train=2.058019 (no previous merge yet)
[S9] round=54 local utility u=0.030470 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995703323096219, 'loss_val': 0.01791956813761296, 'psi': 0.9978244400121836}-{'f1_val': 0.9896951746952075, 'auprc': 0.9997179286252653, 'loss_val': 0.03751003950636373, 'psi': 0.9937042762672306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=54 head_norm_before_train=2.188659 (no previous merge yet)
[S10] round=54 local utility u=0.000220 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958700496995404, 'loss_val': 0.02537996264439809, 'psi': 0.995460723291441}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957889841538924, 'loss_val': 0.025577602726671016, 'psi': 0.9954282970731818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=54 head_norm_before_train=1.985119 cos_to_last_merge=0.7508 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.751
[S11] round=54 local utility u=0.298340 metrics={'f1_val': 0.8404184062792217, 'auprc': 0.9976091835797761, 'loss_val': 0.20610342913291052, 'psi': 0.9032947171994435}-{'f1_val': 0.7692363958894738, 'auprc': 0.9951040371339921, 'loss_val': 0.368175070657039, 'psi': 0.8595834523872812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=54 head_norm_before_train=1.698476 cos_to_last_merge=0.7934 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.793
[S13] round=54 local utility u=0.453487 metrics={'f1_val': 0.729391163157444, 'auprc': 0.6697181701336247, 'loss_val': 0.8788376147811116, 'psi': 0.7055219659479163}-{'f1_val': 0.6241255747956965, 'auprc': 0.6458359395893672, 'loss_val': 1.082571236616985, 'psi': 0.6328097207131649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=54 head_norm_before_train=1.969040 cos_to_last_merge=0.9722 (last merge round=18)
[S14] round=54 local utility u=0.001769 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.998850884941264, 'loss_val': 0.020660074321544975, 'psi': 0.9976384020718325}-{'f1_val': 0.9972435617623723, 'auprc': 0.9971521814237269, 'loss_val': 0.02158299702433532, 'psi': 0.9972070096269141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=54 head_norm_before_train=1.663284 cos_to_last_merge=0.9999 (last merge round=50)
[S15] round=54 local utility u=0.435688 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9966777787317113, 'loss_val': 0.025787632282437477, 'psi': 0.9967191125251968}-{'f1_val': 0.8885043087036938, 'auprc': 0.995842457404931, 'loss_val': 0.24520411640652942, 'psi': 0.9314395681841887}
[S16] START round=54 head_norm_before_train=1.885985 cos_to_last_merge=0.7823 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.782
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.8313810928355164, 'auprc': 0.9883326691454489, 'loss_val': 0.7478840556795266, 'psi': 0.8941617233594894}-{'f1_val': 0.8885795134786372, 'auprc': 0.9834365140396082, 'loss_val': 0.5199629669845659, 'psi': 0.9265223137030256}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=54 head_norm_before_train=1.851190 cos_to_last_merge=0.7895 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.790
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.6533420760893346, 'auprc': 0.6867450043612451, 'loss_val': 1.5054175231540787, 'psi': 0.6667032473980987}-{'f1_val': 0.6563020383440563, 'auprc': 0.7806448722221261, 'loss_val': 1.3623604914389242, 'psi': 0.7060391718952842}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.9996
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.9996
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=54 metric=0.9967 head_norm=1.672790
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.510276e-02
[S15] stored merged vector for next round verification (round=54)
[S15] DEBUG after merge:  round=54 metric=0.9967 head_norm=1.680612 delta_norm=0.025103
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=54 metric=0.9926 head_norm=1.688772
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.537191e-02
[S8] stored merged vector for next round verification (round=54)
[S8] DEBUG after merge:  round=54 metric=0.9926 head_norm=1.678243 delta_norm=0.025372
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=55 head_norm_before_train=1.559265 cos_to_last_merge=0.8858 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=55 local utility u=0.011234 metrics={'f1_val': 0.8312072919458355, 'auprc': 0.8814173671831743, 'loss_val': 0.4472268222792868, 'psi': 0.851291322040771}-{'f1_val': 0.8326752678240155, 'auprc': 0.8815694912521637, 'loss_val': 0.47895858032036964, 'psi': 0.8522329571952747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=55 head_norm_before_train=1.506949 cos_to_last_merge=0.9420 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9253035398687556, 'auprc': 0.9878997886089466, 'loss_val': 0.132009877427646, 'psi': 0.950342039364832}-{'f1_val': 0.9756007752409522, 'auprc': 0.9977585907835906, 'loss_val': 0.09474597996772106, 'psi': 0.9844639014580076}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.531357 cos_to_last_merge=0.9312 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.931
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9388844913055161, 'auprc': 0.9576715995233799, 'loss_val': 0.30543524241934017, 'psi': 0.9463993345926616}-{'f1_val': 0.941018597092791, 'auprc': 0.9711295058656843, 'loss_val': 0.2874631859707954, 'psi': 0.9530629606019483}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.442313 cos_to_last_merge=0.9275 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.452527202377279, 'auprc': 0.8568937110402522, 'loss_val': 0.7638458720468067, 'psi': 0.6142738058424684}-{'f1_val': 0.7004069097142683, 'auprc': 0.9778044891335639, 'loss_val': 0.2524346926424739, 'psi': 0.8113659414819866}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.588047 cos_to_last_merge=0.9212 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.921
[S6] round=55 local utility u=0.834027 metrics={'f1_val': 0.8161609766218468, 'auprc': 0.9574270805553056, 'loss_val': 0.4255641836435457, 'psi': 0.8726674181952303}-{'f1_val': 0.5975759502609922, 'auprc': 0.9566223297729041, 'loss_val': 0.7796934247218048, 'psi': 0.741194502065757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=55 head_norm_before_train=1.759237 cos_to_last_merge=0.9868 (last merge round=24)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.5600478376566285, 'auprc': 0.785808731580468, 'loss_val': 0.9473131096917076, 'psi': 0.6503521952261643}-{'f1_val': 0.6639442061511333, 'auprc': 0.8189244480159614, 'loss_val': 0.39890034870069524, 'psi': 0.7259363028970645}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=55 head_norm_before_train=1.678243 cos_to_last_merge=1.0000 (last merge round=54)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9813813757034171, 'loss_val': 0.04548760041322041, 'psi': 0.9867705218390201}-{'f1_val': 0.9925712794554754, 'auprc': 0.9804569598869017, 'loss_val': 0.04278784685090702, 'psi': 0.9877255516280459}
[S9] START round=55 head_norm_before_train=2.063762 (no previous merge yet)
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9975195918749673, 'loss_val': 0.019199399820975946, 'psi': 0.9967578936175535}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995703323096219, 'loss_val': 0.01791956813761296, 'psi': 0.9978244400121836}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=2.191552 (no previous merge yet)
[S10] round=55 local utility u=0.000244 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959721608301689, 'loss_val': 0.025197714026203036, 'psi': 0.9955015677436925}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958700496995404, 'loss_val': 0.02537996264439809, 'psi': 0.995460723291441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=55 head_norm_before_train=1.991357 cos_to_last_merge=0.7504 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.750
[S11] round=55 local utility u=0.057840 metrics={'f1_val': 0.8546467807793563, 'auprc': 0.9976371837867882, 'loss_val': 0.17587739665610616, 'psi': 0.9118429419823291}-{'f1_val': 0.8404184062792217, 'auprc': 0.9976091835797761, 'loss_val': 0.20610342913291052, 'psi': 0.9032947171994435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=55 head_norm_before_train=1.702574 cos_to_last_merge=0.7928 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.793
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.6017099964799077, 'auprc': 0.6101667555787548, 'loss_val': 1.3074246267577736, 'psi': 0.6050927001194466}-{'f1_val': 0.729391163157444, 'auprc': 0.6697181701336247, 'loss_val': 0.8788376147811116, 'psi': 0.7055219659479163}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=1.974253 cos_to_last_merge=0.9719 (last merge round=18)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971550950459708, 'loss_val': 0.02367350844040759, 'psi': 0.9970605429129873}-{'f1_val': 0.9968300801588782, 'auprc': 0.998850884941264, 'loss_val': 0.020660074321544975, 'psi': 0.9976384020718325}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.680612 cos_to_last_merge=1.0000 (last merge round=54)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.8667635102140525, 'auprc': 0.991598286356377, 'loss_val': 0.28359782801962174, 'psi': 0.9166974206709824}-{'f1_val': 0.9967466683875206, 'auprc': 0.9966777787317113, 'loss_val': 0.025787632282437477, 'psi': 0.9967191125251968}
[S16] START round=55 head_norm_before_train=1.891472 cos_to_last_merge=0.7817 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.782
[S16] round=55 local utility u=0.841096 metrics={'f1_val': 0.9920997526117697, 'auprc': 0.9902364090145547, 'loss_val': 0.035715998025268585, 'psi': 0.9913544151728837}-{'f1_val': 0.8313810928355164, 'auprc': 0.9883326691454489, 'loss_val': 0.7478840556795266, 'psi': 0.8941617233594894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=55 head_norm_before_train=1.855525 cos_to_last_merge=0.7887 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.789
[S17] round=55 local utility u=0.657153 metrics={'f1_val': 0.6937295998345506, 'auprc': 0.8658901822483919, 'loss_val': 0.9708716241273423, 'psi': 0.7625938328000872}-{'f1_val': 0.6533420760893346, 'auprc': 0.6867450043612451, 'loss_val': 1.5054175231540787, 'psi': 0.6667032473980987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.255 → S8@127.0.0.1:33909
[S8] ⇄ pheromone p=0.011 → S15@127.0.0.1:33915
[S2] START round=56 head_norm_before_train=1.568957 cos_to_last_merge=0.8842 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.884
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.8295739181274256, 'auprc': 0.8566651696326699, 'loss_val': 0.42995835345918065, 'psi': 0.8404104187295234}-{'f1_val': 0.8312072919458355, 'auprc': 0.8814173671831743, 'loss_val': 0.4472268222792868, 'psi': 0.851291322040771}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=1.517245 cos_to_last_merge=0.9397 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.8342095803705372, 'auprc': 0.9715440454937232, 'loss_val': 0.29106350658432506, 'psi': 0.8891433664198116}-{'f1_val': 0.9253035398687556, 'auprc': 0.9878997886089466, 'loss_val': 0.132009877427646, 'psi': 0.950342039364832}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.537944 cos_to_last_merge=0.9303 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=56 local utility u=0.042955 metrics={'f1_val': 0.9423142850967763, 'auprc': 0.9719070882036647, 'loss_val': 0.28280956547007113, 'psi': 0.9541514063395315}-{'f1_val': 0.9388844913055161, 'auprc': 0.9576715995233799, 'loss_val': 0.30543524241934017, 'psi': 0.9463993345926616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=56 head_norm_before_train=1.453928 cos_to_last_merge=0.9260 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=56 local utility u=0.373786 metrics={'f1_val': 0.5758899039895229, 'auprc': 0.8520281059791691, 'loss_val': 0.7418527174386779, 'psi': 0.6863451847853814}-{'f1_val': 0.452527202377279, 'auprc': 0.8568937110402522, 'loss_val': 0.7638458720468067, 'psi': 0.6142738058424684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=56 head_norm_before_train=1.594236 cos_to_last_merge=0.9205 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.921
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.5996277039128461, 'auprc': 0.9471867890581022, 'loss_val': 0.824971873231064, 'psi': 0.7386513379709485}-{'f1_val': 0.8161609766218468, 'auprc': 0.9574270805553056, 'loss_val': 0.4255641836435457, 'psi': 0.8726674181952303}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=56 head_norm_before_train=1.766018 cos_to_last_merge=0.9862 (last merge round=24)
[S7] round=56 local utility u=1.000000 metrics={'f1_val': 0.7054488933840439, 'auprc': 0.9796326078277975, 'loss_val': 0.19612350282998553, 'psi': 0.8151223791615454}-{'f1_val': 0.5600478376566285, 'auprc': 0.785808731580468, 'loss_val': 0.9473131096917076, 'psi': 0.6503521952261643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=56 head_norm_before_train=1.691140 cos_to_last_merge=1.0000 (last merge round=54)
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.9846114551120471, 'auprc': 0.9820331610105726, 'loss_val': 0.05720891565953707, 'psi': 0.9835801374714572}-{'f1_val': 0.990363285929422, 'auprc': 0.9813813757034171, 'loss_val': 0.04548760041322041, 'psi': 0.9867705218390201}
[S9] START round=56 head_norm_before_train=2.066226 (no previous merge yet)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.999906345831623, 'loss_val': 0.025415235346945227, 'psi': 0.9963084026683209}-{'f1_val': 0.9962500947792776, 'auprc': 0.9975195918749673, 'loss_val': 0.019199399820975946, 'psi': 0.9967578936175535}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=2.191983 (no previous merge yet)
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995915586325502, 'loss_val': 0.02527417868020605, 'psi': 0.9954789379418256}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959721608301689, 'loss_val': 0.025197714026203036, 'psi': 0.9955015677436925}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=1.998246 cos_to_last_merge=0.7499 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.750
[S11] round=56 local utility u=0.505434 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9990042523616928, 'loss_val': 0.01803199412754093, 'psi': 0.9972819058926627}-{'f1_val': 0.8546467807793563, 'auprc': 0.9976371837867882, 'loss_val': 0.17587739665610616, 'psi': 0.9118429419823291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=56 head_norm_before_train=1.706198 cos_to_last_merge=0.7924 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.792
[S13] round=56 local utility u=0.866950 metrics={'f1_val': 0.7677622872125829, 'auprc': 0.6838133636486206, 'loss_val': 0.790778922827341, 'psi': 0.734182717786998}-{'f1_val': 0.6017099964799077, 'auprc': 0.6101667555787548, 'loss_val': 1.3074246267577736, 'psi': 0.6050927001194466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=56 head_norm_before_train=1.978740 cos_to_last_merge=0.9714 (last merge round=18)
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9971548525465797, 'loss_val': 0.0225120527940704, 'psi': 0.9968142799850821}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971550950459708, 'loss_val': 0.02367350844040759, 'psi': 0.9970605429129873}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=56 head_norm_before_train=1.689718 cos_to_last_merge=1.0000 (last merge round=54)
[S15] round=56 local utility u=0.531808 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9981734311463202, 'loss_val': 0.022190110741275006, 'psi': 0.9975757756653001}-{'f1_val': 0.8667635102140525, 'auprc': 0.991598286356377, 'loss_val': 0.28359782801962174, 'psi': 0.9166974206709824}
[S16] START round=56 head_norm_before_train=1.896705 cos_to_last_merge=0.7812 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.781
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.8694338852864482, 'auprc': 0.9843963762125499, 'loss_val': 0.6815017061689098, 'psi': 0.9154188816568889}-{'f1_val': 0.9920997526117697, 'auprc': 0.9902364090145547, 'loss_val': 0.035715998025268585, 'psi': 0.9913544151728837}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=1.862018 cos_to_last_merge=0.7881 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.788
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.6606874371738701, 'auprc': 0.8496352129364073, 'loss_val': 1.2204977430875155, 'psi': 0.736266547478885}-{'f1_val': 0.6937295998345506, 'auprc': 0.8658901822483919, 'loss_val': 0.9708716241273423, 'psi': 0.7625938328000872}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=0.9999
[S2] START round=57 head_norm_before_train=1.578960 cos_to_last_merge=0.8827 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.883
[S2] round=57 local utility u=0.025996 metrics={'f1_val': 0.8135460938066527, 'auprc': 0.9144472519875915, 'loss_val': 0.45514476199919457, 'psi': 0.8539065570790282}-{'f1_val': 0.8295739181274256, 'auprc': 0.8566651696326699, 'loss_val': 0.42995835345918065, 'psi': 0.8404104187295234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=57 head_norm_before_train=1.529789 cos_to_last_merge=0.9367 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=57 local utility u=0.089018 metrics={'f1_val': 0.8584761054914156, 'auprc': 0.9702016636920066, 'loss_val': 0.2545993119624366, 'psi': 0.903166328771652}-{'f1_val': 0.8342095803705372, 'auprc': 0.9715440454937232, 'loss_val': 0.29106350658432506, 'psi': 0.8891433664198116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=57 head_norm_before_train=1.544616 cos_to_last_merge=0.9293 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.929
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9399647236587012, 'auprc': 0.9556728764080304, 'loss_val': 0.2985244331281419, 'psi': 0.9462479847584329}-{'f1_val': 0.9423142850967763, 'auprc': 0.9719070882036647, 'loss_val': 0.28280956547007113, 'psi': 0.9541514063395315}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.465153 cos_to_last_merge=0.9244 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.924
[S5] round=57 local utility u=0.862215 metrics={'f1_val': 0.7016888986474513, 'auprc': 0.9909368776719357, 'loss_val': 0.18894383895906147, 'psi': 0.817388090257245}-{'f1_val': 0.5758899039895229, 'auprc': 0.8520281059791691, 'loss_val': 0.7418527174386779, 'psi': 0.6863451847853814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=57 head_norm_before_train=1.599904 cos_to_last_merge=0.9192 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.919
[S6] round=57 local utility u=0.799545 metrics={'f1_val': 0.810397745839025, 'auprc': 0.956526952807005, 'loss_val': 0.5185232882375358, 'psi': 0.868849428626217}-{'f1_val': 0.5996277039128461, 'auprc': 0.9471867890581022, 'loss_val': 0.824971873231064, 'psi': 0.7386513379709485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=57 head_norm_before_train=1.770905 cos_to_last_merge=0.9858 (last merge round=24)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.5783119182944322, 'auprc': 0.7928308495307175, 'loss_val': 0.8790179640333845, 'psi': 0.6641194907889463}-{'f1_val': 0.7054488933840439, 'auprc': 0.9796326078277975, 'loss_val': 0.19612350282998553, 'psi': 0.8151223791615454}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=1.703063 cos_to_last_merge=0.9999 (last merge round=54)
[S8] round=57 local utility u=0.021278 metrics={'f1_val': 0.9921596426793389, 'auprc': 0.9803224371376442, 'loss_val': 0.0548101013998151, 'psi': 0.987424760462661}-{'f1_val': 0.9846114551120471, 'auprc': 0.9820331610105726, 'loss_val': 0.05720891565953707, 'psi': 0.9835801374714572}
[S9] START round=57 head_norm_before_train=2.069852 (no previous merge yet)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9922651407836713, 'auprc': 0.9998332991119427, 'loss_val': 0.026883066783799366, 'psi': 0.99529240411498}-{'f1_val': 0.993909773892786, 'auprc': 0.999906345831623, 'loss_val': 0.025415235346945227, 'psi': 0.9963084026683209}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=2.195613 (no previous merge yet)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958435819383872, 'loss_val': 0.02511847449796572, 'psi': 0.9954501361869796}-{'f1_val': 0.9951878390193748, 'auprc': 0.995915586325502, 'loss_val': 0.02527417868020605, 'psi': 0.9954789379418256}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=57 head_norm_before_train=2.003877 cos_to_last_merge=0.7493 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.749
[S11] round=57 local utility u=0.002378 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9989363269636354, 'loss_val': 0.017001863745505878, 'psi': 0.9976477606910727}-{'f1_val': 0.9961336749133093, 'auprc': 0.9990042523616928, 'loss_val': 0.01803199412754093, 'psi': 0.9972819058926627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=57 head_norm_before_train=1.709634 cos_to_last_merge=0.7923 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.792
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.6663247763628322, 'auprc': 0.6662227917371553, 'loss_val': 0.9034224653256532, 'psi': 0.6662839825125615}-{'f1_val': 0.7677622872125829, 'auprc': 0.6838133636486206, 'loss_val': 0.790778922827341, 'psi': 0.734182717786998}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=1.981537 cos_to_last_merge=0.9712 (last merge round=18)
[S14] round=57 local utility u=0.001290 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971780371265526, 'loss_val': 0.02246327699602597, 'psi': 0.9970697197452201}-{'f1_val': 0.9965872316107504, 'auprc': 0.9971548525465797, 'loss_val': 0.0225120527940704, 'psi': 0.9968142799850821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=57 head_norm_before_train=1.697865 cos_to_last_merge=1.0000 (last merge round=54)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.700679445504905, 'auprc': 0.9882474387337101, 'loss_val': 0.5774125224650839, 'psi': 0.815706642796427}-{'f1_val': 0.9971773386779533, 'auprc': 0.9981734311463202, 'loss_val': 0.022190110741275006, 'psi': 0.9975757756653001}
[S16] START round=57 head_norm_before_train=1.899885 cos_to_last_merge=0.7804 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.780
[S16] round=57 local utility u=0.302154 metrics={'f1_val': 0.9147886330725413, 'auprc': 0.9960363601858893, 'loss_val': 0.384242215426725, 'psi': 0.9472877239178805}-{'f1_val': 0.8694338852864482, 'auprc': 0.9843963762125499, 'loss_val': 0.6815017061689098, 'psi': 0.9154188816568889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=57 head_norm_before_train=1.870394 cos_to_last_merge=0.7876 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.788
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.6545466994704691, 'auprc': 0.84644721103475, 'loss_val': 1.1987253914836133, 'psi': 0.7313069040961815}-{'f1_val': 0.6606874371738701, 'auprc': 0.8496352129364073, 'loss_val': 1.2204977430875155, 'psi': 0.736266547478885}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.9998
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=57 metric=0.9922 head_norm=1.712673
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.612473e-02
[S8] stored merged vector for next round verification (round=57)
[S8] DEBUG after merge:  round=57 metric=0.9922 head_norm=1.705209 delta_norm=0.016125
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=58 head_norm_before_train=1.587957 cos_to_last_merge=0.8814 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.881
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.8220672507754969, 'auprc': 0.8553548717916979, 'loss_val': 0.45053336033337094, 'psi': 0.8353822991819773}-{'f1_val': 0.8135460938066527, 'auprc': 0.9144472519875915, 'loss_val': 0.45514476199919457, 'psi': 0.8539065570790282}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=1.539922 cos_to_last_merge=0.9343 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.812455453460863, 'auprc': 0.9765732541136827, 'loss_val': 0.3518573897832171, 'psi': 0.878102573721991}-{'f1_val': 0.8584761054914156, 'auprc': 0.9702016636920066, 'loss_val': 0.2545993119624366, 'psi': 0.903166328771652}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.549388 cos_to_last_merge=0.9287 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.929
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9156691992479493, 'auprc': 0.9509460997261169, 'loss_val': 0.38601699917441107, 'psi': 0.9297799594392164}-{'f1_val': 0.9399647236587012, 'auprc': 0.9556728764080304, 'loss_val': 0.2985244331281419, 'psi': 0.9462479847584329}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.473738 cos_to_last_merge=0.9233 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.923
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9892758479026784, 'loss_val': 0.3954376343495453, 'psi': 0.8159548720929997}-{'f1_val': 0.7016888986474513, 'auprc': 0.9909368776719357, 'loss_val': 0.18894383895906147, 'psi': 0.817388090257245}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.607243 cos_to_last_merge=0.9179 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.918
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.6922582436311449, 'auprc': 0.8926168290869967, 'loss_val': 0.8541870190277491, 'psi': 0.7724016778134857}-{'f1_val': 0.810397745839025, 'auprc': 0.956526952807005, 'loss_val': 0.5185232882375358, 'psi': 0.868849428626217}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.773152 cos_to_last_merge=0.9857 (last merge round=24)
[S7] round=58 local utility u=0.030776 metrics={'f1_val': 0.5806794480943667, 'auprc': 0.789056378224846, 'loss_val': 0.820347875236757, 'psi': 0.6640302201465584}-{'f1_val': 0.5783119182944322, 'auprc': 0.7928308495307175, 'loss_val': 0.8790179640333845, 'psi': 0.6641194907889463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=58 head_norm_before_train=1.705209 cos_to_last_merge=1.0000 (last merge round=57)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9752944183082185, 'auprc': 0.9820269828565519, 'loss_val': 0.07189025767696566, 'psi': 0.9779874441275519}-{'f1_val': 0.9921596426793389, 'auprc': 0.9803224371376442, 'loss_val': 0.0548101013998151, 'psi': 0.987424760462661}
[S9] START round=58 head_norm_before_train=2.076485 (no previous merge yet)
[S9] round=58 local utility u=0.010578 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9997634927367882, 'loss_val': 0.020568067632985715, 'psi': 0.9967694514912613}-{'f1_val': 0.9922651407836713, 'auprc': 0.9998332991119427, 'loss_val': 0.026883066783799366, 'psi': 0.99529240411498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=58 head_norm_before_train=2.201080 (no previous merge yet)
[S10] round=58 local utility u=0.000355 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995935603098021, 'loss_val': 0.024684930558711734, 'psi': 0.9954869446508332}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958435819383872, 'loss_val': 0.02511847449796572, 'psi': 0.9954501361869796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=58 head_norm_before_train=2.008913 cos_to_last_merge=0.7488 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.749
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9986932870577894, 'loss_val': 0.018899357578555945, 'psi': 0.9974055175312695}-{'f1_val': 0.9967887165093644, 'auprc': 0.9989363269636354, 'loss_val': 0.017001863745505878, 'psi': 0.9976477606910727}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.708222 cos_to_last_merge=0.7922 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.792
[S13] round=58 local utility u=0.139390 metrics={'f1_val': 0.7385299150606792, 'auprc': 0.6497601847136845, 'loss_val': 1.0084859987627164, 'psi': 0.7030220229218813}-{'f1_val': 0.6663247763628322, 'auprc': 0.6662227917371553, 'loss_val': 0.9034224653256532, 'psi': 0.6662839825125615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=58 head_norm_before_train=1.986515 cos_to_last_merge=0.9710 (last merge round=18)
[S14] round=58 local utility u=0.000594 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9971555461795018, 'loss_val': 0.02020386147705183, 'psi': 0.9969602665671276}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971780371265526, 'loss_val': 0.02246327699602597, 'psi': 0.9970697197452201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=58 head_norm_before_train=1.706082 cos_to_last_merge=1.0000 (last merge round=54)
[S15] round=58 local utility u=1.000000 metrics={'f1_val': 0.951967409939166, 'auprc': 0.994349640581489, 'loss_val': 0.08226571687039572, 'psi': 0.9689203021960953}-{'f1_val': 0.700679445504905, 'auprc': 0.9882474387337101, 'loss_val': 0.5774125224650839, 'psi': 0.815706642796427}
[S16] START round=58 head_norm_before_train=1.905878 cos_to_last_merge=0.7799 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.780
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.8793646183827833, 'auprc': 0.9976933230214603, 'loss_val': 0.49283637354258164, 'psi': 0.9266961002382541}-{'f1_val': 0.9147886330725413, 'auprc': 0.9960363601858893, 'loss_val': 0.384242215426725, 'psi': 0.9472877239178805}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=1.877752 cos_to_last_merge=0.7869 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.787
[S17] round=58 local utility u=0.415079 metrics={'f1_val': 0.6810886291164171, 'auprc': 0.8871136071221761, 'loss_val': 0.6498186630700645, 'psi': 0.7634986203187207}-{'f1_val': 0.6545466994704691, 'auprc': 0.84644721103475, 'loss_val': 1.1987253914836133, 'psi': 0.7313069040961815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=58 metric=0.9520 head_norm=1.714951
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.758219e-02
[S15] stored merged vector for next round verification (round=58)
[S15] DEBUG after merge:  round=58 metric=0.9520 head_norm=1.713722 delta_norm=0.017582
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=59 head_norm_before_train=1.596729 cos_to_last_merge=0.8805 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.880
[S2] round=59 local utility u=0.076863 metrics={'f1_val': 0.8280439292490189, 'auprc': 0.886001619825942, 'loss_val': 0.4246080859836313, 'psi': 0.8512270054797881}-{'f1_val': 0.8220672507754969, 'auprc': 0.8553548717916979, 'loss_val': 0.45053336033337094, 'psi': 0.8353822991819773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S2] r=60 psi=0.851 u=0.0769 p_local=0.0479 f1=0.828 auprc=0.886 bytes=71780
[S3] START round=59 head_norm_before_train=1.549175 cos_to_last_merge=0.9321 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.7931679633836848, 'auprc': 0.9756023920999766, 'loss_val': 0.38454240535984047, 'psi': 0.8661417348702015}-{'f1_val': 0.812455453460863, 'auprc': 0.9765732541136827, 'loss_val': 0.3518573897832171, 'psi': 0.878102573721991}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.866 u=0.0000 p_local=0.1110 f1=0.793 auprc=0.976 bytes=64751
[S4] START round=59 head_norm_before_train=1.555644 cos_to_last_merge=0.9279 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=59 local utility u=0.171545 metrics={'f1_val': 0.9438761249818489, 'auprc': 0.9749539365412659, 'loss_val': 0.28419209862969247, 'psi': 0.9563072496056158}-{'f1_val': 0.9156691992479493, 'auprc': 0.9509460997261169, 'loss_val': 0.38601699917441107, 'psi': 0.9297799594392164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=60 psi=0.956 u=0.1715 p_local=0.0851 f1=0.944 auprc=0.975 bytes=64750
[S5] START round=59 head_norm_before_train=1.474684 cos_to_last_merge=0.9230 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.923
[S5] round=59 local utility u=0.074673 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9907736402738871, 'loss_val': 0.2505859889404241, 'psi': 0.816553989041483}-{'f1_val': 0.700407554886547, 'auprc': 0.9892758479026784, 'loss_val': 0.3954376343495453, 'psi': 0.8159548720929997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S5] r=60 psi=0.817 u=0.0747 p_local=0.2371 f1=0.700 auprc=0.991 bytes=57597
[S6] START round=59 head_norm_before_train=1.614768 cos_to_last_merge=0.9168 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.917
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.5986025084476911, 'auprc': 0.8219984115482049, 'loss_val': 1.0149012356179972, 'psi': 0.6879608696878966}-{'f1_val': 0.6922582436311449, 'auprc': 0.8926168290869967, 'loss_val': 0.8541870190277491, 'psi': 0.7724016778134857}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.688 u=0.0000 p_local=0.2619 f1=0.599 auprc=0.822 bytes=57559
[S7] START round=59 head_norm_before_train=1.777010 cos_to_last_merge=0.9853 (last merge round=24)
[S7] round=59 local utility u=0.371022 metrics={'f1_val': 0.6350791286699182, 'auprc': 0.8078354557508017, 'loss_val': 0.4610395843681899, 'psi': 0.7041816595022716}-{'f1_val': 0.5806794480943667, 'auprc': 0.789056378224846, 'loss_val': 0.820347875236757, 'psi': 0.6640302201465584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=60 psi=0.704 u=0.3710 p_local=0.2838 f1=0.635 auprc=0.808 bytes=64775
[S8] START round=59 head_norm_before_train=1.711596 cos_to_last_merge=1.0000 (last merge round=57)
[S8] round=59 local utility u=0.004584 metrics={'f1_val': 0.9759729095732449, 'auprc': 0.9828543658884971, 'loss_val': 0.06927473973937057, 'psi': 0.9787254920993458}-{'f1_val': 0.9752944183082185, 'auprc': 0.9820269828565519, 'loss_val': 0.07189025767696566, 'psi': 0.9779874441275519}
[S9] START round=59 head_norm_before_train=2.083893 (no previous merge yet)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.9997623061284017, 'loss_val': 0.034177669734660084, 'psi': 0.9939945203821865}-{'f1_val': 0.9947734239942433, 'auprc': 0.9997634927367882, 'loss_val': 0.020568067632985715, 'psi': 0.9967694514912613}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.994 u=0.0000 p_local=0.0049 f1=0.990 auprc=1.000 bytes=62925
[S10] START round=59 head_norm_before_train=2.207255 (no previous merge yet)
[S10] round=59 local utility u=0.000069 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995949620687149, 'loss_val': 0.02458937063755042, 'psi': 0.9954925516864844}-{'f1_val': 0.9951878390193748, 'auprc': 0.995935603098021, 'loss_val': 0.024684930558711734, 'psi': 0.9954869446508332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] r=60 psi=0.995 u=0.0001 p_local=0.0002 f1=0.995 auprc=0.996 bytes=77361
[S11] START round=59 head_norm_before_train=2.015023 cos_to_last_merge=0.7482 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.748
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981939321225243, 'loss_val': 0.019356640282324474, 'psi': 0.9972057755571635}-{'f1_val': 0.9965470045135896, 'auprc': 0.9986932870577894, 'loss_val': 0.018899357578555945, 'psi': 0.9974055175312695}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.997 u=0.0000 p_local=0.0839 f1=0.997 auprc=0.998 bytes=71892
[S13] START round=59 head_norm_before_train=1.709348 cos_to_last_merge=0.7917 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.792
[S13] round=59 local utility u=0.225014 metrics={'f1_val': 0.7599735832851802, 'auprc': 0.6861044363771812, 'loss_val': 0.796153403660868, 'psi': 0.7304259245219806}-{'f1_val': 0.7385299150606792, 'auprc': 0.6497601847136845, 'loss_val': 1.0084859987627164, 'psi': 0.7030220229218813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S13] r=60 psi=0.730 u=0.2250 p_local=0.2125 f1=0.760 auprc=0.686 bytes=63059
[S14] START round=59 head_norm_before_train=1.993019 cos_to_last_merge=0.9707 (last merge round=18)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9971568231596386, 'loss_val': 0.02112732215421601, 'psi': 0.9969607773591823}-{'f1_val': 0.9968300801588782, 'auprc': 0.9971555461795018, 'loss_val': 0.02020386147705183, 'psi': 0.9969602665671276}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0006 f1=0.997 auprc=0.997 bytes=77356
[S15] START round=59 head_norm_before_train=1.713722 cos_to_last_merge=1.0000 (last merge round=58)
[S15] round=59 local utility u=0.164018 metrics={'f1_val': 0.9964553122065998, 'auprc': 0.9952690563619057, 'loss_val': 0.023915209471746128, 'psi': 0.9959808098687222}-{'f1_val': 0.951967409939166, 'auprc': 0.994349640581489, 'loss_val': 0.08226571687039572, 'psi': 0.9689203021960953}
[S16] START round=59 head_norm_before_train=1.913134 cos_to_last_merge=0.7796 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.780
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.8622606446347911, 'auprc': 0.9962830753570544, 'loss_val': 0.7672714787548103, 'psi': 0.9158696169236965}-{'f1_val': 0.8793646183827833, 'auprc': 0.9976933230214603, 'loss_val': 0.49283637354258164, 'psi': 0.9266961002382541}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.916 u=0.0000 p_local=0.1630 f1=0.862 auprc=0.996 bytes=59343
[S17] START round=59 head_norm_before_train=1.882501 cos_to_last_merge=0.7866 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.787
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6685124164592087, 'auprc': 0.8640869677110974, 'loss_val': 1.028050337517652, 'psi': 0.7467422369599641}-{'f1_val': 0.6810886291164171, 'auprc': 0.8871136071221761, 'loss_val': 0.6498186630700645, 'psi': 0.7634986203187207}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.747 u=0.0000 p_local=0.1478 f1=0.669 auprc=0.864 bytes=53986
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S15
[S8] cosine check vs S15: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=59 metric=0.9965 head_norm=1.724522
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.128449e-02
[S15] stored merged vector for next round verification (round=59)
[S15] DEBUG after merge:  round=59 metric=0.9965 head_norm=1.721329 delta_norm=0.011284
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] r=60 psi=0.996 u=0.1640 p_local=0.3519 f1=0.996 auprc=0.995 bytes=64735
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=59 metric=0.9760 head_norm=1.718204
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.349129e-02
[S8] stored merged vector for next round verification (round=59)
[S8] DEBUG after merge:  round=59 metric=0.9760 head_norm=1.718910 delta_norm=0.013491
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] r=60 psi=0.979 u=0.0046 p_local=0.0081 f1=0.976 auprc=0.983 bytes=71866
[S2] START round=60 head_norm_before_train=1.606265 cos_to_last_merge=0.8794 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.879
[S2] round=60 local utility u=0.039605 metrics={'f1_val': 0.8313470458376642, 'auprc': 0.9123704788422821, 'loss_val': 0.44432275732200555, 'psi': 0.8637564190395113}-{'f1_val': 0.8280439292490189, 'auprc': 0.886001619825942, 'loss_val': 0.4246080859836313, 'psi': 0.8512270054797881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] sending update (kind=head size=1791 to 1 peers)
[S3] START round=60 head_norm_before_train=1.559039 cos_to_last_merge=0.9298 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.7814986859314869, 'auprc': 0.9684443324010107, 'loss_val': 0.4163123911347092, 'psi': 0.8562769445192964}-{'f1_val': 0.7931679633836848, 'auprc': 0.9756023920999766, 'loss_val': 0.38454240535984047, 'psi': 0.8661417348702015}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=1.558540 cos_to_last_merge=0.9275 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9438282268500063, 'auprc': 0.974044737589298, 'loss_val': 0.28876954784658015, 'psi': 0.955914831145723}-{'f1_val': 0.9438761249818489, 'auprc': 0.9749539365412659, 'loss_val': 0.28419209862969247, 'psi': 0.9563072496056158}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.473541 cos_to_last_merge=0.9229 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.923
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.6138834859026179, 'auprc': 0.8631212984983321, 'loss_val': 0.5136693347499883, 'psi': 0.7135786109409036}-{'f1_val': 0.700407554886547, 'auprc': 0.9907736402738871, 'loss_val': 0.2505859889404241, 'psi': 0.816553989041483}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=1.621214 cos_to_last_merge=0.9160 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.916
[S6] round=60 local utility u=1.000000 metrics={'f1_val': 0.9616603731927623, 'auprc': 0.9742483030096424, 'loss_val': 0.19231765052989103, 'psi': 0.9666955451195144}-{'f1_val': 0.5986025084476911, 'auprc': 0.8219984115482049, 'loss_val': 1.0149012356179972, 'psi': 0.6879608696878966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=60 head_norm_before_train=1.780303 cos_to_last_merge=0.9850 (last merge round=24)
[S7] round=60 local utility u=0.000000 metrics={'f1_val': 0.6199735619481245, 'auprc': 0.7976950895252299, 'loss_val': 0.6330881316748538, 'psi': 0.6910621729789667}-{'f1_val': 0.6350791286699182, 'auprc': 0.8078354557508017, 'loss_val': 0.4610395843681899, 'psi': 0.7041816595022716}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=60 head_norm_before_train=1.718910 cos_to_last_merge=1.0000 (last merge round=59)
[S8] round=60 local utility u=0.066237 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9815002433997122, 'loss_val': 0.03890668917937094, 'psi': 0.9888006851710245}-{'f1_val': 0.9759729095732449, 'auprc': 0.9828543658884971, 'loss_val': 0.06927473973937057, 'psi': 0.9787254920993458}
[S9] START round=60 head_norm_before_train=2.091157 (no previous merge yet)
[S9] round=60 local utility u=0.014839 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.9996423176233205, 'loss_val': 0.023366265745147496, 'psi': 0.9958690981419053}-{'f1_val': 0.9901493298847097, 'auprc': 0.9997623061284017, 'loss_val': 0.034177669734660084, 'psi': 0.9939945203821865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=60 head_norm_before_train=2.208199 (no previous merge yet)
[S10] round=60 local utility u=0.000148 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959913919386185, 'loss_val': 0.024419422465813075, 'psi': 0.9955092601870723}-{'f1_val': 0.9951878390193748, 'auprc': 0.995949620687149, 'loss_val': 0.02458937063755042, 'psi': 0.9954925516864844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=60 head_norm_before_train=2.020878 cos_to_last_merge=0.7477 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.748
[S11] round=60 local utility u=0.000937 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9984479056172348, 'loss_val': 0.01721544323703003, 'psi': 0.9972043943923444}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981939321225243, 'loss_val': 0.019356640282324474, 'psi': 0.9972057755571635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=60 head_norm_before_train=1.713346 cos_to_last_merge=0.7915 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.791
[S13] round=60 local utility u=0.000000 metrics={'f1_val': 0.6784468859906667, 'auprc': 0.6419923470182493, 'loss_val': 1.030820884460814, 'psi': 0.6638650704016997}-{'f1_val': 0.7599735832851802, 'auprc': 0.6861044363771812, 'loss_val': 0.796153403660868, 'psi': 0.7304259245219806}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=60 head_norm_before_train=2.000669 cos_to_last_merge=0.9703 (last merge round=18)
[S14] round=60 local utility u=0.003293 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9988413289674168, 'loss_val': 0.01959554886227478, 'psi': 0.9976345796822936}-{'f1_val': 0.9968300801588782, 'auprc': 0.9971568231596386, 'loss_val': 0.02112732215421601, 'psi': 0.9969607773591823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=60 head_norm_before_train=1.721329 cos_to_last_merge=1.0000 (last merge round=59)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9951917213906134, 'loss_val': 0.02307017031585953, 'psi': 0.9958665513287981}-{'f1_val': 0.9964553122065998, 'auprc': 0.9952690563619057, 'loss_val': 0.023915209471746128, 'psi': 0.9959808098687222}
[S16] START round=60 head_norm_before_train=1.920997 cos_to_last_merge=0.7791 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.779
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.8541528220351334, 'auprc': 0.991822664773216, 'loss_val': 0.9090614070659325, 'psi': 0.9092207591303665}-{'f1_val': 0.8622606446347911, 'auprc': 0.9962830753570544, 'loss_val': 0.7672714787548103, 'psi': 0.9158696169236965}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=60 head_norm_before_train=1.888591 cos_to_last_merge=0.7862 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=60 local utility u=0.064352 metrics={'f1_val': 0.6823079995413454, 'auprc': 0.8481067055079796, 'loss_val': 0.934178113964869, 'psi': 0.748627481927999}-{'f1_val': 0.6685124164592087, 'auprc': 0.8640869677110974, 'loss_val': 1.028050337517652, 'psi': 0.7467422369599641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] ⇄ pheromone p=0.281 → S8@127.0.0.1:33909
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] ⇄ pheromone p=0.020 → S15@127.0.0.1:33915
[S2] START round=61 head_norm_before_train=1.616492 cos_to_last_merge=0.8781 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.878
[S2] round=61 local utility u=0.003775 metrics={'f1_val': 0.8319610801983761, 'auprc': 0.9173408279620062, 'loss_val': 0.45536766930452865, 'psi': 0.8661129793038281}-{'f1_val': 0.8313470458376642, 'auprc': 0.9123704788422821, 'loss_val': 0.44432275732200555, 'psi': 0.8637564190395113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=61 head_norm_before_train=1.570427 cos_to_last_merge=0.9273 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=61 local utility u=0.183861 metrics={'f1_val': 0.8205244645137995, 'auprc': 0.9741716559831537, 'loss_val': 0.2999272755764416, 'psi': 0.8819833411015412}-{'f1_val': 0.7814986859314869, 'auprc': 0.9684443324010107, 'loss_val': 0.4163123911347092, 'psi': 0.8562769445192964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=61 head_norm_before_train=1.558709 cos_to_last_merge=0.9269 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.943331537017577, 'auprc': 0.9744518992214477, 'loss_val': 0.2965147034718843, 'psi': 0.9557796818991253}-{'f1_val': 0.9438282268500063, 'auprc': 0.974044737589298, 'loss_val': 0.28876954784658015, 'psi': 0.955914831145723}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.475224 cos_to_last_merge=0.9225 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.922
[S5] round=61 local utility u=0.013069 metrics={'f1_val': 0.6206317574852291, 'auprc': 0.8605470529008427, 'loss_val': 0.5202978417255665, 'psi': 0.7165978756514746}-{'f1_val': 0.6138834859026179, 'auprc': 0.8631212984983321, 'loss_val': 0.5136693347499883, 'psi': 0.7135786109409036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=61 head_norm_before_train=1.628752 cos_to_last_merge=0.9154 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.915
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.7513426730434838, 'auprc': 0.9581492021798574, 'loss_val': 0.5605979158512581, 'psi': 0.8340652846980332}-{'f1_val': 0.9616603731927623, 'auprc': 0.9742483030096424, 'loss_val': 0.19231765052989103, 'psi': 0.9666955451195144}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.783241 cos_to_last_merge=0.9848 (last merge round=24)
[S7] round=61 local utility u=0.179446 metrics={'f1_val': 0.6487390167895286, 'auprc': 0.8061223167635208, 'loss_val': 0.47207128950792165, 'psi': 0.7116923367791255}-{'f1_val': 0.6199735619481245, 'auprc': 0.7976950895252299, 'loss_val': 0.6330881316748538, 'psi': 0.6910621729789667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=61 head_norm_before_train=1.726328 cos_to_last_merge=1.0000 (last merge round=59)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9811230833648241, 'loss_val': 0.038707497985043325, 'psi': 0.9881638047157575}-{'f1_val': 0.9936676463518993, 'auprc': 0.9815002433997122, 'loss_val': 0.03890668917937094, 'psi': 0.9888006851710245}
[S9] START round=61 head_norm_before_train=2.097710 (no previous merge yet)
[S9] round=61 local utility u=0.014742 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995234650092916, 'loss_val': 0.016022015130819477, 'psi': 0.9980711335110023}-{'f1_val': 0.9933536184876286, 'auprc': 0.9996423176233205, 'loss_val': 0.023366265745147496, 'psi': 0.9958690981419053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=61 head_norm_before_train=2.211997 (no previous merge yet)
[S10] round=61 local utility u=0.000011 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959885732070028, 'loss_val': 0.024389324819911497, 'psi': 0.995508132694426}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959913919386185, 'loss_val': 0.024419422465813075, 'psi': 0.9955092601870723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=61 head_norm_before_train=2.026534 cos_to_last_merge=0.7473 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.747
[S11] round=61 local utility u=0.001433 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9989127939227973, 'loss_val': 0.016773756102157603, 'psi': 0.9974933202772727}-{'f1_val': 0.9963753869090841, 'auprc': 0.9984479056172348, 'loss_val': 0.01721544323703003, 'psi': 0.9972043943923444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=61 head_norm_before_train=1.717254 cos_to_last_merge=0.7911 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.791
[S13] round=61 local utility u=0.050496 metrics={'f1_val': 0.6671655433153014, 'auprc': 0.6574094009321323, 'loss_val': 0.908391151661408, 'psi': 0.6632630863620337}-{'f1_val': 0.6784468859906667, 'auprc': 0.6419923470182493, 'loss_val': 1.030820884460814, 'psi': 0.6638650704016997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=61 head_norm_before_train=2.007295 cos_to_last_merge=0.9699 (last merge round=18)
[S14] round=61 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9971556275652658, 'loss_val': 0.020795146014824514, 'psi': 0.9970626789546531}-{'f1_val': 0.9968300801588782, 'auprc': 0.9988413289674168, 'loss_val': 0.01959554886227478, 'psi': 0.9976345796822936}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=61 head_norm_before_train=1.732344 cos_to_last_merge=1.0000 (last merge round=59)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9907343962938495, 'loss_val': 0.025077081984828338, 'psi': 0.9938609314026396}-{'f1_val': 0.9963164379542544, 'auprc': 0.9951917213906134, 'loss_val': 0.02307017031585953, 'psi': 0.9958665513287981}
[S16] START round=61 head_norm_before_train=1.926734 cos_to_last_merge=0.7786 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.779
[S16] round=61 local utility u=0.034625 metrics={'f1_val': 0.8583637194910511, 'auprc': 0.9901451497099969, 'loss_val': 0.8600438037989886, 'psi': 0.9110762915786293}-{'f1_val': 0.8541528220351334, 'auprc': 0.991822664773216, 'loss_val': 0.9090614070659325, 'psi': 0.9092207591303665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=61 head_norm_before_train=1.892111 cos_to_last_merge=0.7858 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=61 local utility u=0.639706 metrics={'f1_val': 0.8409866312946774, 'auprc': 0.8656343521687029, 'loss_val': 0.659421069017988, 'psi': 0.8508457196442876}-{'f1_val': 0.6823079995413454, 'auprc': 0.8481067055079796, 'loss_val': 0.934178113964869, 'psi': 0.748627481927999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=61 metric=0.9959 head_norm=1.742180
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.033134e-02
[S15] stored merged vector for next round verification (round=61)
[S15] DEBUG after merge:  round=61 metric=0.9959 head_norm=1.734241 delta_norm=0.010331
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=62 head_norm_before_train=1.627473 cos_to_last_merge=0.8767 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.877
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.8312734619678465, 'auprc': 0.8877368531340109, 'loss_val': 0.44470500257509854, 'psi': 0.8538588184343122}-{'f1_val': 0.8319610801983761, 'auprc': 0.9173408279620062, 'loss_val': 0.45536766930452865, 'psi': 0.8661129793038281}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=1.580273 cos_to_last_merge=0.9253 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=62 local utility u=0.531209 metrics={'f1_val': 0.9545428609141549, 'auprc': 0.9930646942658888, 'loss_val': 0.09829805469568599, 'psi': 0.9699515942548484}-{'f1_val': 0.8205244645137995, 'auprc': 0.9741716559831537, 'loss_val': 0.2999272755764416, 'psi': 0.8819833411015412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=62 head_norm_before_train=1.559357 cos_to_last_merge=0.9261 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9416780634590239, 'auprc': 0.9723328631541318, 'loss_val': 0.2947023548833764, 'psi': 0.953939983337067}-{'f1_val': 0.943331537017577, 'auprc': 0.9744518992214477, 'loss_val': 0.2965147034718843, 'psi': 0.9557796818991253}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=62 head_norm_before_train=1.479501 cos_to_last_merge=0.9217 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.922
[S5] round=62 local utility u=1.000000 metrics={'f1_val': 0.9961420887187077, 'auprc': 0.992902760573589, 'loss_val': 0.12055030054507668, 'psi': 0.9948463574606602}-{'f1_val': 0.6206317574852291, 'auprc': 0.8605470529008427, 'loss_val': 0.5202978417255665, 'psi': 0.7165978756514746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=62 head_norm_before_train=1.634640 cos_to_last_merge=0.9152 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.915
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.6209711022661832, 'auprc': 0.9470492855189284, 'loss_val': 0.8032104567909312, 'psi': 0.7514023755672813}-{'f1_val': 0.7513426730434838, 'auprc': 0.9581492021798574, 'loss_val': 0.5605979158512581, 'psi': 0.8340652846980332}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.788843 cos_to_last_merge=0.9843 (last merge round=24)
[S7] round=62 local utility u=0.055943 metrics={'f1_val': 0.6630092598483471, 'auprc': 0.808318762473727, 'loss_val': 0.4523965193793806, 'psi': 0.7211330608984992}-{'f1_val': 0.6487390167895286, 'auprc': 0.8061223167635208, 'loss_val': 0.47207128950792165, 'psi': 0.7116923367791255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=62 head_norm_before_train=1.733093 cos_to_last_merge=1.0000 (last merge round=59)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9929047892228047, 'auprc': 0.9809500296602561, 'loss_val': 0.05053002610840082, 'psi': 0.9881228853977853}-{'f1_val': 0.9928576189497129, 'auprc': 0.9811230833648241, 'loss_val': 0.038707497985043325, 'psi': 0.9881638047157575}
[S9] START round=62 head_norm_before_train=2.104929 (no previous merge yet)
[S9] round=62 local utility u=0.000240 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9997524416655637, 'loss_val': 0.01622966874063306, 'psi': 0.9981627241735112}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995234650092916, 'loss_val': 0.016022015130819477, 'psi': 0.9980711335110023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=62 head_norm_before_train=2.217328 (no previous merge yet)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959099005233538, 'loss_val': 0.024368993978911478, 'psi': 0.9954766636209664}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959885732070028, 'loss_val': 0.024389324819911497, 'psi': 0.995508132694426}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=2.032420 cos_to_last_merge=0.7469 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.747
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998938741892325, 'loss_val': 0.018129522986625533, 'psi': 0.9975036994650838}-{'f1_val': 0.9965470045135896, 'auprc': 0.9989127939227973, 'loss_val': 0.016773756102157603, 'psi': 0.9974933202772727}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.723005 cos_to_last_merge=0.7905 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.790
[S13] round=62 local utility u=0.025775 metrics={'f1_val': 0.6717202225095933, 'auprc': 0.6615131532819409, 'loss_val': 0.8964808837166459, 'psi': 0.6676373948185323}-{'f1_val': 0.6671655433153014, 'auprc': 0.6574094009321323, 'loss_val': 0.908391151661408, 'psi': 0.6632630863620337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=62 head_norm_before_train=2.013196 cos_to_last_merge=0.9694 (last merge round=18)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9965909138827574, 'auprc': 0.997067173983289, 'loss_val': 0.02248139857287818, 'psi': 0.9967814179229701}-{'f1_val': 0.9970007132142444, 'auprc': 0.9971556275652658, 'loss_val': 0.020795146014824514, 'psi': 0.9970626789546531}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.734241 cos_to_last_merge=1.0000 (last merge round=61)
[S15] round=62 local utility u=0.012442 metrics={'f1_val': 0.9964830448665875, 'auprc': 0.9976620973090142, 'loss_val': 0.02420267973907037, 'psi': 0.9969546658435582}-{'f1_val': 0.9959452881418331, 'auprc': 0.9907343962938495, 'loss_val': 0.025077081984828338, 'psi': 0.9938609314026396}
[S16] START round=62 head_norm_before_train=1.931906 cos_to_last_merge=0.7780 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.778
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.859797802943097, 'auprc': 0.9844922820814139, 'loss_val': 0.8692116301159799, 'psi': 0.9096755945984237}-{'f1_val': 0.8583637194910511, 'auprc': 0.9901451497099969, 'loss_val': 0.8600438037989886, 'psi': 0.9110762915786293}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=1.895600 cos_to_last_merge=0.7856 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.6426145035204243, 'auprc': 0.6837093486146266, 'loss_val': 1.6050848586543929, 'psi': 0.6590524415581052}-{'f1_val': 0.8409866312946774, 'auprc': 0.8656343521687029, 'loss_val': 0.659421069017988, 'psi': 0.8508457196442876}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.9999
[S2] START round=63 head_norm_before_train=1.638326 cos_to_last_merge=0.8752 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.875
[S2] round=63 local utility u=0.034070 metrics={'f1_val': 0.831813724006067, 'auprc': 0.9188444969139345, 'loss_val': 0.47312910168529015, 'psi': 0.866626033169214}-{'f1_val': 0.8312734619678465, 'auprc': 0.8877368531340109, 'loss_val': 0.44470500257509854, 'psi': 0.8538588184343122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=63 head_norm_before_train=1.591026 cos_to_last_merge=0.9232 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.7190486894297372, 'auprc': 0.9611042829333198, 'loss_val': 0.5652182118020169, 'psi': 0.8158709268311704}-{'f1_val': 0.9545428609141549, 'auprc': 0.9930646942658888, 'loss_val': 0.09829805469568599, 'psi': 0.9699515942548484}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.563193 cos_to_last_merge=0.9252 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=63 local utility u=0.007702 metrics={'f1_val': 0.943564222309552, 'auprc': 0.9724209564750124, 'loss_val': 0.29087962092039515, 'psi': 0.9551069159757362}-{'f1_val': 0.9416780634590239, 'auprc': 0.9723328631541318, 'loss_val': 0.2947023548833764, 'psi': 0.953939983337067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=63 head_norm_before_train=1.485588 cos_to_last_merge=0.9209 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.921
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.6536662751299047, 'auprc': 0.7867577116188009, 'loss_val': 0.5625258325277405, 'psi': 0.7069028497254632}-{'f1_val': 0.9961420887187077, 'auprc': 0.992902760573589, 'loss_val': 0.12055030054507668, 'psi': 0.9948463574606602}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=1.640389 cos_to_last_merge=0.9149 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.915
[S6] round=63 local utility u=0.981608 metrics={'f1_val': 0.8662514507295287, 'auprc': 0.9619801532047458, 'loss_val': 0.3564696431461988, 'psi': 0.9045429317196155}-{'f1_val': 0.6209711022661832, 'auprc': 0.9470492855189284, 'loss_val': 0.8032104567909312, 'psi': 0.7514023755672813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=63 head_norm_before_train=1.794238 cos_to_last_merge=0.9838 (last merge round=24)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.5805208439170073, 'auprc': 0.7917991988290335, 'loss_val': 0.8118532785014866, 'psi': 0.6650321858818178}-{'f1_val': 0.6630092598483471, 'auprc': 0.808318762473727, 'loss_val': 0.4523965193793806, 'psi': 0.7211330608984992}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.740941 cos_to_last_merge=0.9999 (last merge round=59)
[S8] round=63 local utility u=0.011077 metrics={'f1_val': 0.992815308526175, 'auprc': 0.9843348144490258, 'loss_val': 0.0379941227002725, 'psi': 0.9894231108953153}-{'f1_val': 0.9929047892228047, 'auprc': 0.9809500296602561, 'loss_val': 0.05053002610840082, 'psi': 0.9881228853977853}
[S9] START round=63 head_norm_before_train=2.109792 (no previous merge yet)
[S9] round=63 local utility u=0.000034 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998130656878813, 'loss_val': 0.01634408368078646, 'psi': 0.9981869737824383}-{'f1_val': 0.9971029125121428, 'auprc': 0.9997524416655637, 'loss_val': 0.01622966874063306, 'psi': 0.9981627241735112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=63 head_norm_before_train=2.223381 (no previous merge yet)
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958770730090414, 'loss_val': 0.024307397619495946, 'psi': 0.9954635326152415}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959099005233538, 'loss_val': 0.024368993978911478, 'psi': 0.9954766636209664}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=2.037116 cos_to_last_merge=0.7465 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.747
[S11] round=63 local utility u=0.001573 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9989856629547702, 'loss_val': 0.016574707820804273, 'psi': 0.9976674950875267}-{'f1_val': 0.9965470045135896, 'auprc': 0.998938741892325, 'loss_val': 0.018129522986625533, 'psi': 0.9975036994650838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=63 head_norm_before_train=1.728697 cos_to_last_merge=0.7899 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.790
[S13] round=63 local utility u=0.282860 metrics={'f1_val': 0.7379116698958563, 'auprc': 0.6844542470977807, 'loss_val': 0.7967328381083011, 'psi': 0.7165287007766261}-{'f1_val': 0.6717202225095933, 'auprc': 0.6615131532819409, 'loss_val': 0.8964808837166459, 'psi': 0.6676373948185323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=63 head_norm_before_train=2.016675 cos_to_last_merge=0.9693 (last merge round=18)
[S14] round=63 local utility u=0.000208 metrics={'f1_val': 0.9968337624308853, 'auprc': 0.9965048767596818, 'loss_val': 0.021836258023255783, 'psi': 0.9967022081624038}-{'f1_val': 0.9965909138827574, 'auprc': 0.997067173983289, 'loss_val': 0.02248139857287818, 'psi': 0.9967814179229701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=63 head_norm_before_train=1.741759 cos_to_last_merge=1.0000 (last merge round=61)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.7004833655157615, 'auprc': 0.8484458639863217, 'loss_val': 0.678442199333914, 'psi': 0.7596683649039857}-{'f1_val': 0.9964830448665875, 'auprc': 0.9976620973090142, 'loss_val': 0.02420267973907037, 'psi': 0.9969546658435582}
[S16] START round=63 head_norm_before_train=1.936518 cos_to_last_merge=0.7774 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.777
[S16] round=63 local utility u=0.589910 metrics={'f1_val': 0.9453438936416787, 'auprc': 0.9892574520324344, 'loss_val': 0.21696304522406412, 'psi': 0.962909316997981}-{'f1_val': 0.859797802943097, 'auprc': 0.9844922820814139, 'loss_val': 0.8692116301159799, 'psi': 0.9096755945984237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=63 head_norm_before_train=1.900131 cos_to_last_merge=0.7854 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=63 local utility u=0.730707 metrics={'f1_val': 0.6727679948523574, 'auprc': 0.879297699860257, 'loss_val': 0.9113559441739484, 'psi': 0.7553798768555172}-{'f1_val': 0.6426145035204243, 'auprc': 0.6837093486146266, 'loss_val': 1.6050848586543929, 'psi': 0.6590524415581052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.9998
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=63 metric=0.9928 head_norm=1.748387
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.459364e-02
[S8] stored merged vector for next round verification (round=63)
[S8] DEBUG after merge:  round=63 metric=0.9928 head_norm=1.745015 delta_norm=0.014594
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=64 head_norm_before_train=1.647689 cos_to_last_merge=0.8740 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.874
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.6933873431307834, 'auprc': 0.8276661000584018, 'loss_val': 0.8810310653880687, 'psi': 0.7470988459018308}-{'f1_val': 0.831813724006067, 'auprc': 0.9188444969139345, 'loss_val': 0.47312910168529015, 'psi': 0.866626033169214}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=1.601265 cos_to_last_merge=0.9212 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=64 local utility u=0.676922 metrics={'f1_val': 0.8692924320383619, 'auprc': 0.9988717826457585, 'loss_val': 0.22613970402831787, 'psi': 0.9211241722813206}-{'f1_val': 0.7190486894297372, 'auprc': 0.9611042829333198, 'loss_val': 0.5652182118020169, 'psi': 0.8158709268311704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=64 head_norm_before_train=1.568054 cos_to_last_merge=0.9245 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9381575463949602, 'auprc': 0.9614695087548724, 'loss_val': 0.31557304166803435, 'psi': 0.9474823313389251}-{'f1_val': 0.943564222309552, 'auprc': 0.9724209564750124, 'loss_val': 0.29087962092039515, 'psi': 0.9551069159757362}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.491811 cos_to_last_merge=0.9202 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.920
[S5] round=64 local utility u=0.312045 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8627351317907592, 'loss_val': 0.4462933738487706, 'psi': 0.7652864118111191}-{'f1_val': 0.6536662751299047, 'auprc': 0.7867577116188009, 'loss_val': 0.5625258325277405, 'psi': 0.7069028497254632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=64 head_norm_before_train=1.646209 cos_to_last_merge=0.9141 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.6190899680350381, 'auprc': 0.9508686867284999, 'loss_val': 0.8462612910416916, 'psi': 0.7518014555124228}-{'f1_val': 0.8662514507295287, 'auprc': 0.9619801532047458, 'loss_val': 0.3564696431461988, 'psi': 0.9045429317196155}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.798979 cos_to_last_merge=0.9835 (last merge round=24)
[S7] round=64 local utility u=0.715666 metrics={'f1_val': 0.6964354469837812, 'auprc': 0.8639104001531925, 'loss_val': 0.2923433839567574, 'psi': 0.7634254282515458}-{'f1_val': 0.5805208439170073, 'auprc': 0.7917991988290335, 'loss_val': 0.8118532785014866, 'psi': 0.6650321858818178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=64 head_norm_before_train=1.745015 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9884940992024185, 'auprc': 0.9937152530594243, 'loss_val': 0.04672491789446313, 'psi': 0.9905825607452208}-{'f1_val': 0.992815308526175, 'auprc': 0.9843348144490258, 'loss_val': 0.0379941227002725, 'psi': 0.9894231108953153}
[S9] START round=64 head_norm_before_train=2.114120 (no previous merge yet)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9998261899666603, 'loss_val': 0.03148973758037459, 'psi': 0.9944237772983304}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998130656878813, 'loss_val': 0.01634408368078646, 'psi': 0.9981869737824383}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.229642 (no previous merge yet)
[S10] round=64 local utility u=0.000121 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958938693171868, 'loss_val': 0.02411630267030963, 'psi': 0.9954702511384996}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958770730090414, 'loss_val': 0.024307397619495946, 'psi': 0.9954635326152415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=64 head_norm_before_train=2.035881 cos_to_last_merge=0.7459 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.746
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984217459247391, 'loss_val': 0.01973263770696423, 'psi': 0.9970489033178812}-{'f1_val': 0.9967887165093644, 'auprc': 0.9989856629547702, 'loss_val': 0.016574707820804273, 'psi': 0.9976674950875267}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.732736 cos_to_last_merge=0.7896 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.790
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.655027996626844, 'auprc': 0.63648982065698, 'loss_val': 1.0775506982470966, 'psi': 0.6476127262388984}-{'f1_val': 0.7379116698958563, 'auprc': 0.6844542470977807, 'loss_val': 0.7967328381083011, 'psi': 0.7165287007766261}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=2.015524 cos_to_last_merge=0.9693 (last merge round=18)
[S14] round=64 local utility u=0.003523 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9971558017112853, 'loss_val': 0.019202685700101477, 'psi': 0.9972084577419374}-{'f1_val': 0.9968337624308853, 'auprc': 0.9965048767596818, 'loss_val': 0.021836258023255783, 'psi': 0.9967022081624038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=64 head_norm_before_train=1.748648 cos_to_last_merge=1.0000 (last merge round=61)
[S15] round=64 local utility u=0.631638 metrics={'f1_val': 0.8021981483657509, 'auprc': 0.9870093270535933, 'loss_val': 0.4411453850134545, 'psi': 0.8761226198408879}-{'f1_val': 0.7004833655157615, 'auprc': 0.8484458639863217, 'loss_val': 0.678442199333914, 'psi': 0.7596683649039857}
[S16] START round=64 head_norm_before_train=1.937724 cos_to_last_merge=0.7765 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.777
[S16] round=64 local utility u=0.238384 metrics={'f1_val': 0.9931741287926712, 'auprc': 0.9913981466925199, 'loss_val': 0.03359825586159236, 'psi': 0.9924637359526107}-{'f1_val': 0.9453438936416787, 'auprc': 0.9892574520324344, 'loss_val': 0.21696304522406412, 'psi': 0.962909316997981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=64 head_norm_before_train=1.905055 cos_to_last_merge=0.7853 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=64 local utility u=0.068610 metrics={'f1_val': 0.6719914624370783, 'auprc': 0.8806369475315114, 'loss_val': 0.7734948834733467, 'psi': 0.7554496564748516}-{'f1_val': 0.6727679948523574, 'auprc': 0.879297699860257, 'loss_val': 0.9113559441739484, 'psi': 0.7553798768555172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=64 metric=0.8022 head_norm=1.756231
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.744577e-02
[S15] stored merged vector for next round verification (round=64)
[S15] DEBUG after merge:  round=64 metric=0.8030 head_norm=1.752227 delta_norm=0.017446
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=65 head_norm_before_train=1.653087 cos_to_last_merge=0.8736 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.874
[S2] round=65 local utility u=0.739240 metrics={'f1_val': 0.823777123619716, 'auprc': 0.9172511806735877, 'loss_val': 0.453644806421756, 'psi': 0.8611667464412647}-{'f1_val': 0.6933873431307834, 'auprc': 0.8276661000584018, 'loss_val': 0.8810310653880687, 'psi': 0.7470988459018308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=65 head_norm_before_train=1.609643 cos_to_last_merge=0.9196 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.775651933764759, 'auprc': 0.9672005773465784, 'loss_val': 0.42781854468476554, 'psi': 0.8522713911974868}-{'f1_val': 0.8692924320383619, 'auprc': 0.9988717826457585, 'loss_val': 0.22613970402831787, 'psi': 0.9211241722813206}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.572195 cos_to_last_merge=0.9237 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.924
[S4] round=65 local utility u=0.011971 metrics={'f1_val': 0.939550801093327, 'auprc': 0.9649715753328987, 'loss_val': 0.3104958642212704, 'psi': 0.9497191107891556}-{'f1_val': 0.9381575463949602, 'auprc': 0.9614695087548724, 'loss_val': 0.31557304166803435, 'psi': 0.9474823313389251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=65 head_norm_before_train=1.496272 cos_to_last_merge=0.9196 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.920
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.6719601868408935, 'auprc': 0.8277975876846559, 'loss_val': 0.508904668788493, 'psi': 0.7342951471783985}-{'f1_val': 0.700320598491359, 'auprc': 0.8627351317907592, 'loss_val': 0.4462933738487706, 'psi': 0.7652864118111191}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=1.649366 cos_to_last_merge=0.9126 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.913
[S6] round=65 local utility u=0.780584 metrics={'f1_val': 0.8034081218549074, 'auprc': 0.9624498859238644, 'loss_val': 0.4257463152091088, 'psi': 0.8670248274824902}-{'f1_val': 0.6190899680350381, 'auprc': 0.9508686867284999, 'loss_val': 0.8462612910416916, 'psi': 0.7518014555124228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=65 head_norm_before_train=1.802556 cos_to_last_merge=0.9832 (last merge round=24)
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.6216986225293236, 'auprc': 0.7984698464962601, 'loss_val': 0.5834322078591302, 'psi': 0.6924071121160982}-{'f1_val': 0.6964354469837812, 'auprc': 0.8639104001531925, 'loss_val': 0.2923433839567574, 'psi': 0.7634254282515458}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=1.752086 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=65 local utility u=0.002162 metrics={'f1_val': 0.9888520358145082, 'auprc': 0.9941073230622013, 'loss_val': 0.045725503672862516, 'psi': 0.9909541507135854}-{'f1_val': 0.9884940992024185, 'auprc': 0.9937152530594243, 'loss_val': 0.04672491789446313, 'psi': 0.9905825607452208}
[S9] START round=65 head_norm_before_train=2.119387 (no previous merge yet)
[S9] round=65 local utility u=0.007790 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.9998347151246718, 'loss_val': 0.02609552293826173, 'psi': 0.995443166772003}-{'f1_val': 0.9908221688527771, 'auprc': 0.9998261899666603, 'loss_val': 0.03148973758037459, 'psi': 0.9944237772983304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=65 head_norm_before_train=2.236053 (no previous merge yet)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958787567397509, 'loss_val': 0.02416021802924466, 'psi': 0.9954642061075252}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958938693171868, 'loss_val': 0.02411630267030963, 'psi': 0.9954702511384996}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=2.037178 cos_to_last_merge=0.7453 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.745
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9956530465950697, 'auprc': 0.9983753854319595, 'loss_val': 0.025293748782911112, 'psi': 0.9967419821298256}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984217459247391, 'loss_val': 0.01973263770696423, 'psi': 0.9970489033178812}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.739108 cos_to_last_merge=0.7891 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.789
[S13] round=65 local utility u=0.237826 metrics={'f1_val': 0.6896489042892211, 'auprc': 0.6758763433538965, 'loss_val': 0.9277845817411193, 'psi': 0.6841398799150913}-{'f1_val': 0.655027996626844, 'auprc': 0.63648982065698, 'loss_val': 1.0775506982470966, 'psi': 0.6476127262388984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=65 head_norm_before_train=2.019011 cos_to_last_merge=0.9691 (last merge round=18)
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971424083688889, 'loss_val': 0.030155592918063533, 'psi': 0.9974476341774677}-{'f1_val': 0.9972435617623723, 'auprc': 0.9971558017112853, 'loss_val': 0.019202685700101477, 'psi': 0.9972084577419374}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=1.752227 cos_to_last_merge=1.0000 (last merge round=64)
[S15] round=65 local utility u=0.810000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981821387736579, 'loss_val': 0.021954166815903453, 'psi': 0.9973208565419756}-{'f1_val': 0.8021981483657509, 'auprc': 0.9870093270535933, 'loss_val': 0.4411453850134545, 'psi': 0.8761226198408879}
[S16] START round=65 head_norm_before_train=1.938125 cos_to_last_merge=0.7754 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.775
[S16] round=65 local utility u=0.003393 metrics={'f1_val': 0.9934164564342678, 'auprc': 0.9921809960762991, 'loss_val': 0.030615424535627468, 'psi': 0.9929222722910802}-{'f1_val': 0.9931741287926712, 'auprc': 0.9913981466925199, 'loss_val': 0.03359825586159236, 'psi': 0.9924637359526107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=65 head_norm_before_train=1.909787 cos_to_last_merge=0.7851 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.6688805394755033, 'auprc': 0.8822531013101527, 'loss_val': 0.9394137959141834, 'psi': 0.754229564209363}-{'f1_val': 0.6719914624370783, 'auprc': 0.8806369475315114, 'loss_val': 0.7734948834733467, 'psi': 0.7554496564748516}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:33909
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=65 metric=0.9967 head_norm=1.760483
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.075094e-03
[S15] stored merged vector for next round verification (round=65)
[S15] DEBUG after merge:  round=65 metric=0.9967 head_norm=1.760480 delta_norm=0.008075
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.357 → S8@127.0.0.1:33909
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=65 metric=0.9889 head_norm=1.760514
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.127661e-02
[S8] stored merged vector for next round verification (round=65)
[S8] DEBUG after merge:  round=65 metric=0.9889 head_norm=1.759392 delta_norm=0.011277
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.008 → S15@127.0.0.1:33915
[S2] START round=66 head_norm_before_train=1.660053 cos_to_last_merge=0.8729 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.873
[S2] round=66 local utility u=0.053714 metrics={'f1_val': 0.8277023578385765, 'auprc': 0.9377172244058548, 'loss_val': 0.43116546350370916, 'psi': 0.8717083044654879}-{'f1_val': 0.823777123619716, 'auprc': 0.9172511806735877, 'loss_val': 0.453644806421756, 'psi': 0.8611667464412647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=66 head_norm_before_train=1.618032 cos_to_last_merge=0.9183 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=66 local utility u=0.900854 metrics={'f1_val': 0.9944071087262353, 'auprc': 0.9995875299640072, 'loss_val': 0.035802143005549104, 'psi': 0.996479277221344}-{'f1_val': 0.775651933764759, 'auprc': 0.9672005773465784, 'loss_val': 0.42781854468476554, 'psi': 0.8522713911974868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=66 head_norm_before_train=1.577477 cos_to_last_merge=0.9228 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=66 local utility u=0.040535 metrics={'f1_val': 0.9438699706346114, 'auprc': 0.975444020109451, 'loss_val': 0.2867582857242224, 'psi': 0.9564995904245472}-{'f1_val': 0.939550801093327, 'auprc': 0.9649715753328987, 'loss_val': 0.3104958642212704, 'psi': 0.9497191107891556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=66 head_norm_before_train=1.501490 cos_to_last_merge=0.9189 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.919
[S5] round=66 local utility u=0.509827 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9938404165620027, 'loss_val': 0.15754579007620775, 'psi': 0.8177289570851494}-{'f1_val': 0.6719601868408935, 'auprc': 0.8277975876846559, 'loss_val': 0.508904668788493, 'psi': 0.7342951471783985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=66 head_norm_before_train=1.653451 cos_to_last_merge=0.9117 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=66 local utility u=0.558981 metrics={'f1_val': 0.9462015136424294, 'auprc': 0.9724909128980854, 'loss_val': 0.19466796562407865, 'psi': 0.9567172733446918}-{'f1_val': 0.8034081218549074, 'auprc': 0.9624498859238644, 'loss_val': 0.4257463152091088, 'psi': 0.8670248274824902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=66 head_norm_before_train=1.805466 cos_to_last_merge=0.9830 (last merge round=24)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.5969177427739505, 'auprc': 0.7972306730372093, 'loss_val': 0.7154010027444603, 'psi': 0.677042914879254}-{'f1_val': 0.6216986225293236, 'auprc': 0.7984698464962601, 'loss_val': 0.5834322078591302, 'psi': 0.6924071121160982}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=1.759392 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=66 local utility u=0.001313 metrics={'f1_val': 0.9892104968014376, 'auprc': 0.9938180631369786, 'loss_val': 0.04438312094856772, 'psi': 0.991053523335654}-{'f1_val': 0.9888520358145082, 'auprc': 0.9941073230622013, 'loss_val': 0.045725503672862516, 'psi': 0.9909541507135854}
[S9] START round=66 head_norm_before_train=2.123158 (no previous merge yet)
[S9] round=66 local utility u=0.014947 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9975210385314413, 'loss_val': 0.016785190684171246, 'psi': 0.9972701629198621}-{'f1_val': 0.9925154678702236, 'auprc': 0.9998347151246718, 'loss_val': 0.02609552293826173, 'psi': 0.995443166772003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=66 head_norm_before_train=2.242537 (no previous merge yet)
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958854737581209, 'loss_val': 0.02428316221638785, 'psi': 0.9954668929148731}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958787567397509, 'loss_val': 0.02416021802924466, 'psi': 0.9954642061075252}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=2.040031 cos_to_last_merge=0.7448 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.745
[S11] round=66 local utility u=0.004458 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985553344644887, 'loss_val': 0.019802145994582094, 'psi': 0.9971023387337811}-{'f1_val': 0.9956530465950697, 'auprc': 0.9983753854319595, 'loss_val': 0.025293748782911112, 'psi': 0.9967419821298256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=66 head_norm_before_train=1.745299 cos_to_last_merge=0.7885 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.789
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6661171624707185, 'auprc': 0.6585204179798839, 'loss_val': 0.9246125698430059, 'psi': 0.6630784646743847}-{'f1_val': 0.6896489042892211, 'auprc': 0.6758763433538965, 'loss_val': 0.9277845817411193, 'psi': 0.6841398799150913}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=2.024716 cos_to_last_merge=0.9687 (last merge round=18)
[S14] round=66 local utility u=0.003464 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971573466187018, 'loss_val': 0.019351169288276092, 'psi': 0.9970614435420797}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971424083688889, 'loss_val': 0.030155592918063533, 'psi': 0.9974476341774677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=66 head_norm_before_train=1.760480 cos_to_last_merge=1.0000 (last merge round=65)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9973709509492805, 'loss_val': 0.02216374076222598, 'psi': 0.9969963814122246}-{'f1_val': 0.9967466683875206, 'auprc': 0.9981821387736579, 'loss_val': 0.021954166815903453, 'psi': 0.9973208565419756}
[S16] START round=66 head_norm_before_train=1.941837 cos_to_last_merge=0.7747 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.775
[S16] round=66 local utility u=0.001068 metrics={'f1_val': 0.9929991741310175, 'auprc': 0.9937769753978432, 'loss_val': 0.03076382219641411, 'psi': 0.9933102946377477}-{'f1_val': 0.9934164564342678, 'auprc': 0.9921809960762991, 'loss_val': 0.030615424535627468, 'psi': 0.9929222722910802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=66 head_norm_before_train=1.915056 cos_to_last_merge=0.7847 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.6606067402307634, 'auprc': 0.8146332398662286, 'loss_val': 1.2734641431506584, 'psi': 0.7222173400849494}-{'f1_val': 0.6688805394755033, 'auprc': 0.8822531013101527, 'loss_val': 0.9394137959141834, 'psi': 0.754229564209363}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=1.0000
[S2] START round=67 head_norm_before_train=1.667992 cos_to_last_merge=0.8719 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.872
[S2] round=67 local utility u=0.016083 metrics={'f1_val': 0.8277643618403098, 'auprc': 0.9462599812260777, 'loss_val': 0.4249989438961314, 'psi': 0.875162609594617}-{'f1_val': 0.8277023578385765, 'auprc': 0.9377172244058548, 'loss_val': 0.43116546350370916, 'psi': 0.8717083044654879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=67 head_norm_before_train=1.627527 cos_to_last_merge=0.9168 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.6767786630903936, 'auprc': 0.9326732194748962, 'loss_val': 0.6968518842551119, 'psi': 0.7791364856441947}-{'f1_val': 0.9944071087262353, 'auprc': 0.9995875299640072, 'loss_val': 0.035802143005549104, 'psi': 0.996479277221344}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.582865 cos_to_last_merge=0.9219 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.922
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9403745714162082, 'auprc': 0.9679531998061468, 'loss_val': 0.30585458912334934, 'psi': 0.9514060227721837}-{'f1_val': 0.9438699706346114, 'auprc': 0.975444020109451, 'loss_val': 0.2867582857242224, 'psi': 0.9564995904245472}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=1.505772 cos_to_last_merge=0.9183 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.43210851802624667, 'auprc': 0.8517068272708053, 'loss_val': 1.0496631447546625, 'psi': 0.5999478417240701}-{'f1_val': 0.7003213174339138, 'auprc': 0.9938404165620027, 'loss_val': 0.15754579007620775, 'psi': 0.8177289570851494}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.662270 cos_to_last_merge=0.9106 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.911
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.5957705232697924, 'auprc': 0.7172750051646023, 'loss_val': 1.2636131814749605, 'psi': 0.6443723160277164}-{'f1_val': 0.9462015136424294, 'auprc': 0.9724909128980854, 'loss_val': 0.19466796562407865, 'psi': 0.9567172733446918}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.809750 cos_to_last_merge=0.9826 (last merge round=24)
[S7] round=67 local utility u=0.123688 metrics={'f1_val': 0.6219721977511938, 'auprc': 0.7984294824811268, 'loss_val': 0.6219486336712807, 'psi': 0.692555111643167}-{'f1_val': 0.5969177427739505, 'auprc': 0.7972306730372093, 'loss_val': 0.7154010027444603, 'psi': 0.677042914879254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=67 head_norm_before_train=1.768996 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=67 local utility u=0.002632 metrics={'f1_val': 0.9932225217693944, 'auprc': 0.9846434918016478, 'loss_val': 0.03566802432759366, 'psi': 0.9897909097822958}-{'f1_val': 0.9892104968014376, 'auprc': 0.9938180631369786, 'loss_val': 0.04438312094856772, 'psi': 0.991053523335654}
[S9] START round=67 head_norm_before_train=2.124050 (no previous merge yet)
[S9] round=67 local utility u=0.003914 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998493523486351, 'loss_val': 0.01594128502205019, 'psi': 0.9982014884467397}-{'f1_val': 0.9971029125121428, 'auprc': 0.9975210385314413, 'loss_val': 0.016785190684171246, 'psi': 0.9972701629198621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=67 head_norm_before_train=2.248972 (no previous merge yet)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957490904183459, 'loss_val': 0.02487909129391529, 'psi': 0.9954123395789631}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958854737581209, 'loss_val': 0.02428316221638785, 'psi': 0.9954668929148731}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=67 head_norm_before_train=2.043805 cos_to_last_merge=0.7445 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.745
[S11] round=67 local utility u=0.000771 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986807153626778, 'loss_val': 0.018636726076121903, 'psi': 0.9971524910930567}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985553344644887, 'loss_val': 0.019802145994582094, 'psi': 0.9971023387337811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=67 head_norm_before_train=1.749078 cos_to_last_merge=0.7883 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.788
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.6846079358099657, 'auprc': 0.626354092603667, 'loss_val': 1.2319035705347918, 'psi': 0.6613063985274462}-{'f1_val': 0.6661171624707185, 'auprc': 0.6585204179798839, 'loss_val': 0.9246125698430059, 'psi': 0.6630784646743847}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=2.030100 cos_to_last_merge=0.9685 (last merge round=18)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971570042436798, 'loss_val': 0.019594480460815456, 'psi': 0.997061306592071}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971573466187018, 'loss_val': 0.019351169288276092, 'psi': 0.9970614435420797}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=1.770067 cos_to_last_merge=1.0000 (last merge round=65)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.9673215186055643, 'auprc': 0.9968083987642888, 'loss_val': 0.062450578216490374, 'psi': 0.9791162706690542}-{'f1_val': 0.9967466683875206, 'auprc': 0.9973709509492805, 'loss_val': 0.02216374076222598, 'psi': 0.9969963814122246}
[S16] START round=67 head_norm_before_train=1.947699 cos_to_last_merge=0.7743 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.774
[S16] round=67 local utility u=0.005271 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.9973140743333385, 'loss_val': 0.031699043194633805, 'psi': 0.9948118092233489}-{'f1_val': 0.9929991741310175, 'auprc': 0.9937769753978432, 'loss_val': 0.03076382219641411, 'psi': 0.9933102946377477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=67 head_norm_before_train=1.918772 cos_to_last_merge=0.7843 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=67 local utility u=0.306937 metrics={'f1_val': 0.7011069528495275, 'auprc': 0.8391569551295457, 'loss_val': 0.9761627182359278, 'psi': 0.7563269537615348}-{'f1_val': 0.6606067402307634, 'auprc': 0.8146332398662286, 'loss_val': 1.2734641431506584, 'psi': 0.7222173400849494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=67 metric=0.9673 head_norm=1.779956
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.479617e-03
[S15] stored merged vector for next round verification (round=67)
[S15] DEBUG after merge:  round=67 metric=0.9673 head_norm=1.774464 delta_norm=0.008480
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=1.0000
[S2] START round=68 head_norm_before_train=1.675517 cos_to_last_merge=0.8709 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.871
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.7218394241526296, 'auprc': 0.8623244587472365, 'loss_val': 0.6490907705679501, 'psi': 0.7780334379904723}-{'f1_val': 0.8277643618403098, 'auprc': 0.9462599812260777, 'loss_val': 0.4249989438961314, 'psi': 0.875162609594617}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=1.635010 cos_to_last_merge=0.9152 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=68 local utility u=1.000000 metrics={'f1_val': 0.9805228360841715, 'auprc': 0.9996801368489016, 'loss_val': 0.055825888695939935, 'psi': 0.9881857563900636}-{'f1_val': 0.6767786630903936, 'auprc': 0.9326732194748962, 'loss_val': 0.6968518842551119, 'psi': 0.7791364856441947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S3] sending update (kind=head size=1808 to 1 peers)
[S4] START round=68 head_norm_before_train=1.587055 cos_to_last_merge=0.9214 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.921
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9414013739973959, 'auprc': 0.9618651448432748, 'loss_val': 0.3039886052386408, 'psi': 0.9495868823357474}-{'f1_val': 0.9403745714162082, 'auprc': 0.9679531998061468, 'loss_val': 0.30585458912334934, 'psi': 0.9514060227721837}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.510254 cos_to_last_merge=0.9176 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=68 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9749206670626882, 'loss_val': 0.25726436717071066, 'psi': 0.8101606259198907}-{'f1_val': 0.43210851802624667, 'auprc': 0.8517068272708053, 'loss_val': 1.0496631447546625, 'psi': 0.5999478417240701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=68 head_norm_before_train=1.671397 cos_to_last_merge=0.9094 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=68 local utility u=0.014491 metrics={'f1_val': 0.5976520146227148, 'auprc': 0.7276563633642184, 'loss_val': 1.2770648758207868, 'psi': 0.6496537541193163}-{'f1_val': 0.5957705232697924, 'auprc': 0.7172750051646023, 'loss_val': 1.2636131814749605, 'psi': 0.6443723160277164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=68 head_norm_before_train=1.814269 cos_to_last_merge=0.9822 (last merge round=24)
[S7] round=68 local utility u=0.088729 metrics={'f1_val': 0.6343627720759022, 'auprc': 0.8030593291574947, 'loss_val': 0.5327245774926839, 'psi': 0.7018413949085391}-{'f1_val': 0.6219721977511938, 'auprc': 0.7984294824811268, 'loss_val': 0.6219486336712807, 'psi': 0.692555111643167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] START round=68 head_norm_before_train=1.774002 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.9854808445160033, 'loss_val': 0.03657091228952317, 'psi': 0.9898869760770157}-{'f1_val': 0.9932225217693944, 'auprc': 0.9846434918016478, 'loss_val': 0.03566802432759366, 'psi': 0.9897909097822958}
[S9] START round=68 head_norm_before_train=2.127113 (no previous merge yet)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.999834461880063, 'loss_val': 0.03724477822225958, 'psi': 0.9934111205980054}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998493523486351, 'loss_val': 0.01594128502205019, 'psi': 0.9982014884467397}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=2.250097 (no previous merge yet)
[S10] round=68 local utility u=0.000175 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958402318405872, 'loss_val': 0.024802823977739953, 'psi': 0.9954487961478597}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957490904183459, 'loss_val': 0.02487909129391529, 'psi': 0.9954123395789631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=68 head_norm_before_train=2.048616 cos_to_last_merge=0.7443 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.744
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9949511623486851, 'auprc': 0.9982841562535418, 'loss_val': 0.044622609043713665, 'psi': 0.9962843599106278}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986807153626778, 'loss_val': 0.018636726076121903, 'psi': 0.9971524910930567}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.751557 cos_to_last_merge=0.7880 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.788
[S13] round=68 local utility u=0.177045 metrics={'f1_val': 0.7130599610227893, 'auprc': 0.6375613215249873, 'loss_val': 1.0821475782588195, 'psi': 0.6828605052236686}-{'f1_val': 0.6846079358099657, 'auprc': 0.626354092603667, 'loss_val': 1.2319035705347918, 'psi': 0.6613063985274462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=68 head_norm_before_train=2.034182 cos_to_last_merge=0.9683 (last merge round=18)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9971568769277952, 'loss_val': 0.019937171986917718, 'psi': 0.9970631786996648}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971570042436798, 'loss_val': 0.019594480460815456, 'psi': 0.997061306592071}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.774464 cos_to_last_merge=1.0000 (last merge round=67)
[S15] round=68 local utility u=0.063737 metrics={'f1_val': 0.9845230985192723, 'auprc': 0.9970125016774104, 'loss_val': 0.03879853280355952, 'psi': 0.9895188597825275}-{'f1_val': 0.9673215186055643, 'auprc': 0.9968083987642888, 'loss_val': 0.062450578216490374, 'psi': 0.9791162706690542}
[S16] START round=68 head_norm_before_train=1.954588 cos_to_last_merge=0.7741 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.774
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.9934416310264214, 'auprc': 0.9912296609556466, 'loss_val': 0.03311950423033779, 'psi': 0.9925568429981115}-{'f1_val': 0.9931436324833557, 'auprc': 0.9973140743333385, 'loss_val': 0.031699043194633805, 'psi': 0.9948118092233489}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=68 head_norm_before_train=1.925470 cos_to_last_merge=0.7838 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=68 local utility u=0.349832 metrics={'f1_val': 0.7318402149711918, 'auprc': 0.9087027669784313, 'loss_val': 0.6695366283777802, 'psi': 0.8025852357740877}-{'f1_val': 0.7011069528495275, 'auprc': 0.8391569551295457, 'loss_val': 0.9761627182359278, 'psi': 0.7563269537615348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=68 metric=0.9845 head_norm=1.784465
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.866246e-03
[S15] stored merged vector for next round verification (round=68)
[S15] DEBUG after merge:  round=68 metric=0.9845 head_norm=1.779214 delta_norm=0.009866
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=69 head_norm_before_train=1.679181 cos_to_last_merge=0.8711 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.871
[S2] round=69 local utility u=0.465744 metrics={'f1_val': 0.8300753848054414, 'auprc': 0.8811838561280462, 'loss_val': 0.4235969456878039, 'psi': 0.8505187733344832}-{'f1_val': 0.7218394241526296, 'auprc': 0.8623244587472365, 'loss_val': 0.6490907705679501, 'psi': 0.7780334379904723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=69 head_norm_before_train=1.642082 cos_to_last_merge=0.9139 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.8887875148581479, 'auprc': 0.9697074967152848, 'loss_val': 0.23413451682235867, 'psi': 0.9211555076010027}-{'f1_val': 0.9805228360841715, 'auprc': 0.9996801368489016, 'loss_val': 0.055825888695939935, 'psi': 0.9881857563900636}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=1.589812 cos_to_last_merge=0.9207 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.921
[S4] round=69 local utility u=0.075474 metrics={'f1_val': 0.9578138444907834, 'auprc': 0.9726095911829454, 'loss_val': 0.2837479753598377, 'psi': 0.9637321431676482}-{'f1_val': 0.9414013739973959, 'auprc': 0.9618651448432748, 'loss_val': 0.3039886052386408, 'psi': 0.9495868823357474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=69 head_norm_before_train=1.515145 cos_to_last_merge=0.9168 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.917
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.5736351201581498, 'auprc': 0.7413702693330662, 'loss_val': 0.7575453058873405, 'psi': 0.6407291798281163}-{'f1_val': 0.700320598491359, 'auprc': 0.9749206670626882, 'loss_val': 0.25726436717071066, 'psi': 0.8101606259198907}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.677456 cos_to_last_merge=0.9085 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=69 local utility u=1.000000 metrics={'f1_val': 0.7948055795367623, 'auprc': 0.9540282842728915, 'loss_val': 0.5582123407546671, 'psi': 0.858494661431214}-{'f1_val': 0.5976520146227148, 'auprc': 0.7276563633642184, 'loss_val': 1.2770648758207868, 'psi': 0.6496537541193163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=69 head_norm_before_train=1.817968 cos_to_last_merge=0.9818 (last merge round=24)
[S7] round=69 local utility u=0.129243 metrics={'f1_val': 0.6553700955183208, 'auprc': 0.8110055752477081, 'loss_val': 0.4241219481729891, 'psi': 0.7176242874100758}-{'f1_val': 0.6343627720759022, 'auprc': 0.8030593291574947, 'loss_val': 0.5327245774926839, 'psi': 0.7018413949085391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=69 head_norm_before_train=1.778208 cos_to_last_merge=0.9999 (last merge round=65)
[S8] round=69 local utility u=0.000743 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9856956536236753, 'loss_val': 0.035928710779851505, 'psi': 0.989992832819298}-{'f1_val': 0.9928243971176908, 'auprc': 0.9854808445160033, 'loss_val': 0.03657091228952317, 'psi': 0.9898869760770157}
[S9] START round=69 head_norm_before_train=2.131511 (no previous merge yet)
[S9] round=69 local utility u=0.034694 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998151020183538, 'loss_val': 0.01564184042621028, 'psi': 0.9981877883146272}-{'f1_val': 0.9891288930766337, 'auprc': 0.999834461880063, 'loss_val': 0.03724477822225958, 'psi': 0.9934111205980054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=69 head_norm_before_train=2.252949 (no previous merge yet)
[S10] round=69 local utility u=0.000104 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958809915822235, 'loss_val': 0.024717015173442533, 'psi': 0.9954651000445143}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958402318405872, 'loss_val': 0.024802823977739953, 'psi': 0.9954487961478597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=69 head_norm_before_train=2.053447 cos_to_last_merge=0.7440 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.744
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.9807922453965994, 'auprc': 0.9980842919008303, 'loss_val': 0.06356371765652728, 'psi': 0.9877090639982917}-{'f1_val': 0.9949511623486851, 'auprc': 0.9982841562535418, 'loss_val': 0.044622609043713665, 'psi': 0.9962843599106278}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=69 head_norm_before_train=1.753450 cos_to_last_merge=0.7882 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.788
[S13] round=69 local utility u=0.139086 metrics={'f1_val': 0.7216882373563539, 'auprc': 0.660439699232961, 'loss_val': 0.9243811289737897, 'psi': 0.6971888221069967}-{'f1_val': 0.7130599610227893, 'auprc': 0.6375613215249873, 'loss_val': 1.0821475782588195, 'psi': 0.6828605052236686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=69 head_norm_before_train=2.038036 cos_to_last_merge=0.9682 (last merge round=18)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971552731338392, 'loss_val': 0.0219550732699984, 'psi': 0.9970606141481347}-{'f1_val': 0.9970007132142444, 'auprc': 0.9971568769277952, 'loss_val': 0.019937171986917718, 'psi': 0.9970631786996648}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=1.779214 cos_to_last_merge=1.0000 (last merge round=68)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.8985649723139469, 'auprc': 0.9961338819455983, 'loss_val': 0.2512918814672101, 'psi': 0.9375925361666075}-{'f1_val': 0.9845230985192723, 'auprc': 0.9970125016774104, 'loss_val': 0.03879853280355952, 'psi': 0.9895188597825275}
[S16] START round=69 head_norm_before_train=1.960835 cos_to_last_merge=0.7738 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.774
[S16] round=69 local utility u=0.001306 metrics={'f1_val': 0.9934416310264214, 'auprc': 0.9916094569115388, 'loss_val': 0.031646331261280684, 'psi': 0.9927087613804684}-{'f1_val': 0.9934416310264214, 'auprc': 0.9912296609556466, 'loss_val': 0.03311950423033779, 'psi': 0.9925568429981115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=69 head_norm_before_train=1.934574 cos_to_last_merge=0.7831 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.7245158341753076, 'auprc': 0.9012443269634176, 'loss_val': 0.9032757319583252, 'psi': 0.7952072312905516}-{'f1_val': 0.7318402149711918, 'auprc': 0.9087027669784313, 'loss_val': 0.6695366283777802, 'psi': 0.8025852357740877}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=69 metric=0.9929 head_norm=1.783094
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.357167e-02
[S8] stored merged vector for next round verification (round=69)
[S8] DEBUG after merge:  round=69 metric=0.9929 head_norm=1.783728 delta_norm=0.013572
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=70 head_norm_before_train=1.684055 cos_to_last_merge=0.8706 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.871
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.7328339292990869, 'auprc': 0.8303103383423394, 'loss_val': 0.794918262888772, 'psi': 0.7718244929163878}-{'f1_val': 0.8300753848054414, 'auprc': 0.8811838561280462, 'loss_val': 0.4235969456878039, 'psi': 0.8505187733344832}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=1.647731 cos_to_last_merge=0.9131 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=70 local utility u=0.351507 metrics={'f1_val': 0.9634071562066013, 'auprc': 0.9988070485692248, 'loss_val': 0.06613757761018385, 'psi': 0.9775671131516508}-{'f1_val': 0.8887875148581479, 'auprc': 0.9697074967152848, 'loss_val': 0.23413451682235867, 'psi': 0.9211555076010027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=70 head_norm_before_train=1.594763 cos_to_last_merge=0.9197 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=70 local utility u=0.000000 metrics={'f1_val': 0.9427612631934412, 'auprc': 0.9723478593632745, 'loss_val': 0.29858867903759695, 'psi': 0.9545959016613745}-{'f1_val': 0.9578138444907834, 'auprc': 0.9726095911829454, 'loss_val': 0.2837479753598377, 'psi': 0.9637321431676482}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=70 head_norm_before_train=1.522940 cos_to_last_merge=0.9156 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.916
[S5] round=70 local utility u=0.909410 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9669579341920155, 'loss_val': 0.3766379412642269, 'psi': 0.8070791505580976}-{'f1_val': 0.5736351201581498, 'auprc': 0.7413702693330662, 'loss_val': 0.7575453058873405, 'psi': 0.6407291798281163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=70 head_norm_before_train=1.681081 cos_to_last_merge=0.9084 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.5961088336292202, 'auprc': 0.9436966532208844, 'loss_val': 1.0058539182297637, 'psi': 0.7351439614658859}-{'f1_val': 0.7948055795367623, 'auprc': 0.9540282842728915, 'loss_val': 0.5582123407546671, 'psi': 0.858494661431214}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.820961 cos_to_last_merge=0.9816 (last merge round=24)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.6285722664816857, 'auprc': 0.8011597374204886, 'loss_val': 0.5086416787884529, 'psi': 0.697607254857207}-{'f1_val': 0.6553700955183208, 'auprc': 0.8110055752477081, 'loss_val': 0.4241219481729891, 'psi': 0.7176242874100758}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=1.783728 cos_to_last_merge=1.0000 (last merge round=69)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.985528881706182, 'loss_val': 0.03794212588201399, 'psi': 0.9894699369014919}-{'f1_val': 0.9928576189497129, 'auprc': 0.9856956536236753, 'loss_val': 0.035928710779851505, 'psi': 0.989992832819298}
[S9] START round=70 head_norm_before_train=2.135946 (no previous merge yet)
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9990044702519465, 'loss_val': 0.01662753361126129, 'psi': 0.9978635356080643}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998151020183538, 'loss_val': 0.01564184042621028, 'psi': 0.9981877883146272}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=2.256045 (no previous merge yet)
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958133138774126, 'loss_val': 0.024888412319728867, 'psi': 0.9954380289625899}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958809915822235, 'loss_val': 0.024717015173442533, 'psi': 0.9954651000445143}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=70 head_norm_before_train=2.059084 cos_to_last_merge=0.7436 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.744
[S11] round=70 local utility u=0.069517 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986743878179178, 'loss_val': 0.018471670488507334, 'psi': 0.9971622399736144}-{'f1_val': 0.9807922453965994, 'auprc': 0.9980842919008303, 'loss_val': 0.06356371765652728, 'psi': 0.9877090639982917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=70 head_norm_before_train=1.759913 cos_to_last_merge=0.7880 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.788
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6256836280986113, 'auprc': 0.6368034127643466, 'loss_val': 1.1958823404019887, 'psi': 0.6301315419649054}-{'f1_val': 0.7216882373563539, 'auprc': 0.660439699232961, 'loss_val': 0.9243811289737897, 'psi': 0.6971888221069967}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=2.042582 cos_to_last_merge=0.9680 (last merge round=18)
[S14] round=70 local utility u=0.000037 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971556415826246, 'loss_val': 0.021881457909888675, 'psi': 0.9970607615276489}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971552731338392, 'loss_val': 0.0219550732699984, 'psi': 0.9970606141481347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=70 head_norm_before_train=1.789056 cos_to_last_merge=1.0000 (last merge round=68)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.8228113097681083, 'auprc': 0.9928997398571999, 'loss_val': 0.3933483298314085, 'psi': 0.890846681803745}-{'f1_val': 0.8985649723139469, 'auprc': 0.9961338819455983, 'loss_val': 0.2512918814672101, 'psi': 0.9375925361666075}
[S16] START round=70 head_norm_before_train=1.964073 cos_to_last_merge=0.7732 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.773
[S16] round=70 local utility u=0.009411 metrics={'f1_val': 0.993148273899568, 'auprc': 0.997982596102437, 'loss_val': 0.030183852991938768, 'psi': 0.9950820027807155}-{'f1_val': 0.9934416310264214, 'auprc': 0.9916094569115388, 'loss_val': 0.031646331261280684, 'psi': 0.9927087613804684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=70 head_norm_before_train=1.942481 cos_to_last_merge=0.7826 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=70 local utility u=0.248356 metrics={'f1_val': 0.7357168020773786, 'auprc': 0.9614317123415068, 'loss_val': 0.6543318304255065, 'psi': 0.8260027661830298}-{'f1_val': 0.7245158341753076, 'auprc': 0.9012443269634176, 'loss_val': 0.9032757319583252, 'psi': 0.7952072312905516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=70 metric=0.8228 head_norm=1.798559
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.514918e-02
[S15] stored merged vector for next round verification (round=70)
[S15] DEBUG after merge:  round=70 metric=0.8228 head_norm=1.790779 delta_norm=0.015149
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.125 → S8@127.0.0.1:33909
[S8] ⇄ pheromone p=0.003 → S15@127.0.0.1:33915
[S2] START round=71 head_norm_before_train=1.690040 cos_to_last_merge=0.8695 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.870
[S2] round=71 local utility u=0.514441 metrics={'f1_val': 0.8254208929605881, 'auprc': 0.8773346716306809, 'loss_val': 0.4626316218878718, 'psi': 0.8461864044286251}-{'f1_val': 0.7328339292990869, 'auprc': 0.8303103383423394, 'loss_val': 0.794918262888772, 'psi': 0.7718244929163878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=71 head_norm_before_train=1.654334 cos_to_last_merge=0.9120 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9593554003867444, 'auprc': 0.9922881309495778, 'loss_val': 0.09851018106393772, 'psi': 0.9725284926118778}-{'f1_val': 0.9634071562066013, 'auprc': 0.9988070485692248, 'loss_val': 0.06613757761018385, 'psi': 0.9775671131516508}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.600627 cos_to_last_merge=0.9184 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=71 local utility u=0.032657 metrics={'f1_val': 0.9514449374633164, 'auprc': 0.9743937536956988, 'loss_val': 0.2915137528461633, 'psi': 0.9606244639562693}-{'f1_val': 0.9427612631934412, 'auprc': 0.9723478593632745, 'loss_val': 0.29858867903759695, 'psi': 0.9545959016613745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=71 head_norm_before_train=1.527898 cos_to_last_merge=0.9147 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.915
[S5] round=71 local utility u=0.027269 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9794844443073008, 'loss_val': 0.3596828460287354, 'psi': 0.8120900973885942}-{'f1_val': 0.7004932948021524, 'auprc': 0.9669579341920155, 'loss_val': 0.3766379412642269, 'psi': 0.8070791505580976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=71 head_norm_before_train=1.688193 cos_to_last_merge=0.9080 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=71 local utility u=1.000000 metrics={'f1_val': 0.8554085446087852, 'auprc': 0.9640867513838981, 'loss_val': 0.3654038474975905, 'psi': 0.8988798273188303}-{'f1_val': 0.5961088336292202, 'auprc': 0.9436966532208844, 'loss_val': 1.0058539182297637, 'psi': 0.7351439614658859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=71 head_norm_before_train=1.822875 cos_to_last_merge=0.9814 (last merge round=24)
[S7] round=71 local utility u=0.053770 metrics={'f1_val': 0.6336597780786402, 'auprc': 0.8055073669449873, 'loss_val': 0.4446695409204941, 'psi': 0.7023988136251791}-{'f1_val': 0.6285722664816857, 'auprc': 0.8011597374204886, 'loss_val': 0.5086416787884529, 'psi': 0.697607254857207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=71 head_norm_before_train=1.790926 cos_to_last_merge=1.0000 (last merge round=69)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9849632800667485, 'auprc': 0.9840395743187236, 'loss_val': 0.053603380967890316, 'psi': 0.9845937977675385}-{'f1_val': 0.9920973070316986, 'auprc': 0.985528881706182, 'loss_val': 0.03794212588201399, 'psi': 0.9894699369014919}
[S9] START round=71 head_norm_before_train=2.139030 (no previous merge yet)
[S9] round=71 local utility u=0.003035 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998640241767942, 'loss_val': 0.015601897645256144, 'psi': 0.9984539001247642}-{'f1_val': 0.9971029125121428, 'auprc': 0.9990044702519465, 'loss_val': 0.01662753361126129, 'psi': 0.9978635356080643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=71 head_norm_before_train=2.256084 (no previous merge yet)
[S10] round=71 local utility u=0.000151 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958348651181637, 'loss_val': 0.02465067177975242, 'psi': 0.9954466494588903}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958133138774126, 'loss_val': 0.024888412319728867, 'psi': 0.9954380289625899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=71 head_norm_before_train=2.065367 cos_to_last_merge=0.7433 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.743
[S11] round=71 local utility u=0.001334 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9994459619167277, 'loss_val': 0.018117593950526957, 'psi': 0.9974708696131384}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986743878179178, 'loss_val': 0.018471670488507334, 'psi': 0.9971622399736144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=71 head_norm_before_train=1.768525 cos_to_last_merge=0.7876 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.788
[S13] round=71 local utility u=0.471630 metrics={'f1_val': 0.7193052065689627, 'auprc': 0.6690477256269747, 'loss_val': 0.9110847356210722, 'psi': 0.6992022141921674}-{'f1_val': 0.6256836280986113, 'auprc': 0.6368034127643466, 'loss_val': 1.1958823404019887, 'psi': 0.6301315419649054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=71 head_norm_before_train=2.047848 cos_to_last_merge=0.9677 (last merge round=18)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971575423414298, 'loss_val': 0.024987104725373823, 'psi': 0.9973079786376073}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971556415826246, 'loss_val': 0.021881457909888675, 'psi': 0.9970607615276489}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=1.790779 cos_to_last_merge=1.0000 (last merge round=70)
[S15] round=71 local utility u=0.353256 metrics={'f1_val': 0.9076969618858638, 'auprc': 0.9957246966913633, 'loss_val': 0.20462435338783155, 'psi': 0.9429080558080636}-{'f1_val': 0.8228113097681083, 'auprc': 0.9928997398571999, 'loss_val': 0.3933483298314085, 'psi': 0.890846681803745}
[S16] START round=71 head_norm_before_train=1.969572 cos_to_last_merge=0.7728 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.773
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9486675006609484, 'auprc': 0.9935522354742772, 'loss_val': 0.1420980861645247, 'psi': 0.9666213945862798}-{'f1_val': 0.993148273899568, 'auprc': 0.997982596102437, 'loss_val': 0.030183852991938768, 'psi': 0.9950820027807155}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=1.945316 cos_to_last_merge=0.7826 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.7139982739951967, 'auprc': 0.9109018441751386, 'loss_val': 0.9778646400459347, 'psi': 0.7927597020671735}-{'f1_val': 0.7357168020773786, 'auprc': 0.9614317123415068, 'loss_val': 0.6543318304255065, 'psi': 0.8260027661830298}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=1.0000
[S2] START round=72 head_norm_before_train=1.696765 cos_to_last_merge=0.8686 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.869
[S2] round=72 local utility u=0.139520 metrics={'f1_val': 0.8280299589551907, 'auprc': 0.9519152962048164, 'loss_val': 0.42298852753137417, 'psi': 0.877584093855041}-{'f1_val': 0.8254208929605881, 'auprc': 0.8773346716306809, 'loss_val': 0.4626316218878718, 'psi': 0.8461864044286251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=72 head_norm_before_train=1.661900 cos_to_last_merge=0.9106 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=72 local utility u=0.115051 metrics={'f1_val': 0.9856091593955602, 'auprc': 0.9987872971573122, 'loss_val': 0.04542725658007792, 'psi': 0.990880414500261}-{'f1_val': 0.9593554003867444, 'auprc': 0.9922881309495778, 'loss_val': 0.09851018106393772, 'psi': 0.9725284926118778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=72 head_norm_before_train=1.605056 cos_to_last_merge=0.9175 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.9370835926545817, 'auprc': 0.9601715833025642, 'loss_val': 0.3593671302136104, 'psi': 0.9463187889137747}-{'f1_val': 0.9514449374633164, 'auprc': 0.9743937536956988, 'loss_val': 0.2915137528461633, 'psi': 0.9606244639562693}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=1.531158 cos_to_last_merge=0.9141 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.914
[S5] round=72 local utility u=0.034911 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.983455398886274, 'loss_val': 0.3017742671651698, 'psi': 0.8136784792201834}-{'f1_val': 0.7004938661094564, 'auprc': 0.9794844443073008, 'loss_val': 0.3596828460287354, 'psi': 0.8120900973885942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=72 head_norm_before_train=1.695727 cos_to_last_merge=0.9072 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.907
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.7021154389608725, 'auprc': 0.9490610689602645, 'loss_val': 0.6907006078243891, 'psi': 0.8008936909606293}-{'f1_val': 0.8554085446087852, 'auprc': 0.9640867513838981, 'loss_val': 0.3654038474975905, 'psi': 0.8988798273188303}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=1.826353 cos_to_last_merge=0.9811 (last merge round=24)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.632643783954997, 'auprc': 0.7975339822393851, 'loss_val': 0.5706166490683345, 'psi': 0.6985998632687522}-{'f1_val': 0.6336597780786402, 'auprc': 0.8055073669449873, 'loss_val': 0.4446695409204941, 'psi': 0.7023988136251791}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=1.798963 cos_to_last_merge=1.0000 (last merge round=69)
[S8] round=72 local utility u=0.030767 metrics={'f1_val': 0.9924932660920454, 'auprc': 0.9834603325342663, 'loss_val': 0.03551063131078741, 'psi': 0.9888800926689337}-{'f1_val': 0.9849632800667485, 'auprc': 0.9840395743187236, 'loss_val': 0.053603380967890316, 'psi': 0.9845937977675385}
[S9] START round=72 head_norm_before_train=2.141323 (no previous merge yet)
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999120168881956, 'loss_val': 0.01636076174609166, 'psi': 0.9982265542625639}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998640241767942, 'loss_val': 0.015601897645256144, 'psi': 0.9984539001247642}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.259026 (no previous merge yet)
[S10] round=72 local utility u=0.000409 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959492202020492, 'loss_val': 0.024174977316871096, 'psi': 0.9954923914924445}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958348651181637, 'loss_val': 0.02465067177975242, 'psi': 0.9954466494588903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=72 head_norm_before_train=2.069291 cos_to_last_merge=0.7428 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.743
[S11] round=72 local utility u=0.001603 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9994513398200735, 'loss_val': 0.016378066553358675, 'psi': 0.9976180482464959}-{'f1_val': 0.9961541414107454, 'auprc': 0.9994459619167277, 'loss_val': 0.018117593950526957, 'psi': 0.9974708696131384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=72 head_norm_before_train=1.775334 cos_to_last_merge=0.7871 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.787
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.7017853603977077, 'auprc': 0.6726944710356655, 'loss_val': 0.8972848964156076, 'psi': 0.6901490046528909}-{'f1_val': 0.7193052065689627, 'auprc': 0.6690477256269747, 'loss_val': 0.9110847356210722, 'psi': 0.6992022141921674}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.050622 cos_to_last_merge=0.9674 (last merge round=18)
[S14] round=72 local utility u=0.000759 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9971562964778574, 'loss_val': 0.019681241840351926, 'psi': 0.9969289831626047}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971575423414298, 'loss_val': 0.024987104725373823, 'psi': 0.9973079786376073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=72 head_norm_before_train=1.800245 cos_to_last_merge=1.0000 (last merge round=70)
[S15] round=72 local utility u=0.364087 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985424014759575, 'loss_val': 0.01920192630969281, 'psi': 0.9974649616228953}-{'f1_val': 0.9076969618858638, 'auprc': 0.9957246966913633, 'loss_val': 0.20462435338783155, 'psi': 0.9429080558080636}
[S16] START round=72 head_norm_before_train=1.975478 cos_to_last_merge=0.7725 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.773
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.8598693337276262, 'auprc': 0.9915671978611358, 'loss_val': 0.9045461864597073, 'psi': 0.9125484793810301}-{'f1_val': 0.9486675006609484, 'auprc': 0.9935522354742772, 'loss_val': 0.1420980861645247, 'psi': 0.9666213945862798}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=1.947885 cos_to_last_merge=0.7824 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=72 local utility u=1.000000 metrics={'f1_val': 0.935736878431061, 'auprc': 0.9930698343580706, 'loss_val': 0.1620628634014215, 'psi': 0.9586700608018649}-{'f1_val': 0.7139982739951967, 'auprc': 0.9109018441751386, 'loss_val': 0.9778646400459347, 'psi': 0.7927597020671735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=72 metric=0.9967 head_norm=1.809630
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.121363e-02
[S15] stored merged vector for next round verification (round=72)
[S15] DEBUG after merge:  round=72 metric=0.9967 head_norm=1.807628 delta_norm=0.011214
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=72 metric=0.9925 head_norm=1.805694
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.942892e-03
[S8] stored merged vector for next round verification (round=72)
[S8] DEBUG after merge:  round=72 metric=0.9925 head_norm=1.805287 delta_norm=0.009943
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=73 head_norm_before_train=1.702540 cos_to_last_merge=0.8684 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.868
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.8204404312941793, 'auprc': 0.9155386947557265, 'loss_val': 0.484150536895769, 'psi': 0.8584797366787982}-{'f1_val': 0.8280299589551907, 'auprc': 0.9519152962048164, 'loss_val': 0.42298852753137417, 'psi': 0.877584093855041}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=1.670658 cos_to_last_merge=0.9090 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.6990872122748254, 'auprc': 0.9653417292096003, 'loss_val': 0.5675121588359686, 'psi': 0.8055890190487354}-{'f1_val': 0.9856091593955602, 'auprc': 0.9987872971573122, 'loss_val': 0.04542725658007792, 'psi': 0.990880414500261}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.610649 cos_to_last_merge=0.9167 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.8627215275149925, 'auprc': 0.9633925253444694, 'loss_val': 0.4139058768349269, 'psi': 0.9029899266467832}-{'f1_val': 0.9370835926545817, 'auprc': 0.9601715833025642, 'loss_val': 0.3593671302136104, 'psi': 0.9463187889137747}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=1.532366 cos_to_last_merge=0.9140 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.914
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.43380995555375446, 'auprc': 0.8546478514339648, 'loss_val': 0.9153181918181335, 'psi': 0.6021451139058387}-{'f1_val': 0.7004938661094564, 'auprc': 0.983455398886274, 'loss_val': 0.3017742671651698, 'psi': 0.8136784792201834}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=1.702307 cos_to_last_merge=0.9061 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6014199346339388, 'auprc': 0.9412219865060489, 'loss_val': 0.9421052016845899, 'psi': 0.7373407553827829}-{'f1_val': 0.7021154389608725, 'auprc': 0.9490610689602645, 'loss_val': 0.6907006078243891, 'psi': 0.8008936909606293}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.829079 cos_to_last_merge=0.9808 (last merge round=24)
[S7] round=73 local utility u=0.154035 metrics={'f1_val': 0.6605233705685825, 'auprc': 0.8049537233069805, 'loss_val': 0.4520842191973078, 'psi': 0.7182955116639417}-{'f1_val': 0.632643783954997, 'auprc': 0.7975339822393851, 'loss_val': 0.5706166490683345, 'psi': 0.6985998632687522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=73 head_norm_before_train=1.805287 cos_to_last_merge=1.0000 (last merge round=72)
[S8] round=73 local utility u=0.000397 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.983375695493602, 'loss_val': 0.036448742207302987, 'psi': 0.9890449164680553}-{'f1_val': 0.9924932660920454, 'auprc': 0.9834603325342663, 'loss_val': 0.03551063131078741, 'psi': 0.9888800926689337}
[S9] START round=73 head_norm_before_train=2.142354 (no previous merge yet)
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9925069029958717, 'auprc': 0.9999189959017207, 'loss_val': 0.02512134221162332, 'psi': 0.9954717401582113}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999120168881956, 'loss_val': 0.01636076174609166, 'psi': 0.9982265542625639}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=2.263567 (no previous merge yet)
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995865437518376, 'loss_val': 0.024065612531051973, 'psi': 0.9954588784189753}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959492202020492, 'loss_val': 0.024174977316871096, 'psi': 0.9954923914924445}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=2.073298 cos_to_last_merge=0.7423 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.742
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.8515911964799918, 'auprc': 0.9978150425471286, 'loss_val': 0.19873942878067657, 'psi': 0.9100807349068465}-{'f1_val': 0.9963958538641108, 'auprc': 0.9994513398200735, 'loss_val': 0.016378066553358675, 'psi': 0.9976180482464959}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.780175 cos_to_last_merge=0.7867 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.787
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.6566929538485027, 'auprc': 0.6713643534673979, 'loss_val': 1.0023177265508225, 'psi': 0.6625615136960608}-{'f1_val': 0.7017853603977077, 'auprc': 0.6726944710356655, 'loss_val': 0.8972848964156076, 'psi': 0.6901490046528909}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=2.056154 cos_to_last_merge=0.9671 (last merge round=18)
[S14] round=73 local utility u=0.000442 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971569572579959, 'loss_val': 0.02012061096279692, 'psi': 0.9970612877977973}-{'f1_val': 0.9967774409524363, 'auprc': 0.9971562964778574, 'loss_val': 0.019681241840351926, 'psi': 0.9969289831626047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=73 head_norm_before_train=1.807628 cos_to_last_merge=1.0000 (last merge round=72)
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.7033184273321893, 'auprc': 0.990867517080559, 'loss_val': 0.6252644720639033, 'psi': 0.8183380632315371}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985424014759575, 'loss_val': 0.01920192630969281, 'psi': 0.9974649616228953}
[S16] START round=73 head_norm_before_train=1.981853 cos_to_last_merge=0.7724 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.852744182304803, 'auprc': 0.9935370861816355, 'loss_val': 1.006205137170791, 'psi': 0.909061343855536}-{'f1_val': 0.8598693337276262, 'auprc': 0.9915671978611358, 'loss_val': 0.9045461864597073, 'psi': 0.9125484793810301}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=1.951574 cos_to_last_merge=0.7820 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.8394803872951004, 'auprc': 0.9646452513264001, 'loss_val': 0.4329897706956693, 'psi': 0.8895463329076203}-{'f1_val': 0.935736878431061, 'auprc': 0.9930698343580706, 'loss_val': 0.1620628634014215, 'psi': 0.9586700608018649}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=1.0000
[S2] START round=74 head_norm_before_train=1.707701 cos_to_last_merge=0.8680 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.868
[S2] round=74 local utility u=0.058365 metrics={'f1_val': 0.8332554712498397, 'auprc': 0.9115138683305379, 'loss_val': 0.4322366079107371, 'psi': 0.864558830082119}-{'f1_val': 0.8204404312941793, 'auprc': 0.9155386947557265, 'loss_val': 0.484150536895769, 'psi': 0.8584797366787982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=74 head_norm_before_train=1.678456 cos_to_last_merge=0.9075 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=74 local utility u=0.131290 metrics={'f1_val': 0.7162395145667273, 'auprc': 0.988584743030513, 'loss_val': 0.477575114131502, 'psi': 0.8251776059522415}-{'f1_val': 0.6990872122748254, 'auprc': 0.9653417292096003, 'loss_val': 0.5675121588359686, 'psi': 0.8055890190487354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=74 head_norm_before_train=1.616620 cos_to_last_merge=0.9158 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.6280372379214135, 'auprc': 0.9548453554833978, 'loss_val': 0.6800977882728543, 'psi': 0.7587604849462073}-{'f1_val': 0.8627215275149925, 'auprc': 0.9633925253444694, 'loss_val': 0.4139058768349269, 'psi': 0.9029899266467832}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.534333 cos_to_last_merge=0.9137 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.914
[S5] round=74 local utility u=1.000000 metrics={'f1_val': 0.7831682921930131, 'auprc': 0.9938489078336761, 'loss_val': 0.14357756758559204, 'psi': 0.8674405384492783}-{'f1_val': 0.43380995555375446, 'auprc': 0.8546478514339648, 'loss_val': 0.9153181918181335, 'psi': 0.6021451139058387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=74 head_norm_before_train=1.709950 cos_to_last_merge=0.9053 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.905
[S6] round=74 local utility u=0.619212 metrics={'f1_val': 0.7582757809277065, 'auprc': 0.9463382617731085, 'loss_val': 0.6601645665841722, 'psi': 0.8335007732658674}-{'f1_val': 0.6014199346339388, 'auprc': 0.9412219865060489, 'loss_val': 0.9421052016845899, 'psi': 0.7373407553827829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=74 head_norm_before_train=1.831318 cos_to_last_merge=0.9806 (last merge round=24)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.6327298766508194, 'auprc': 0.7985185363534733, 'loss_val': 0.5411990439736378, 'psi': 0.6990453405318809}-{'f1_val': 0.6605233705685825, 'auprc': 0.8049537233069805, 'loss_val': 0.4520842191973078, 'psi': 0.7182955116639417}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=1.811230 cos_to_last_merge=1.0000 (last merge round=72)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.9811202956051033, 'auprc': 0.984804401773484, 'loss_val': 0.058048228843118214, 'psi': 0.9825939380724557}-{'f1_val': 0.9928243971176908, 'auprc': 0.983375695493602, 'loss_val': 0.036448742207302987, 'psi': 0.9890449164680553}
[S9] START round=74 head_norm_before_train=2.144272 (no previous merge yet)
[S9] round=74 local utility u=0.015197 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9998753541561965, 'loss_val': 0.01718083539387807, 'psi': 0.9977127591007223}-{'f1_val': 0.9925069029958717, 'auprc': 0.9999189959017207, 'loss_val': 0.02512134221162332, 'psi': 0.9954717401582113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=74 head_norm_before_train=2.268880 (no previous merge yet)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958416326120911, 'loss_val': 0.02426079518541343, 'psi': 0.9954493564564613}-{'f1_val': 0.9951878390193748, 'auprc': 0.995865437518376, 'loss_val': 0.024065612531051973, 'psi': 0.9954588784189753}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=2.076596 cos_to_last_merge=0.7420 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.742
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.8122944877570437, 'auprc': 0.9974379291485704, 'loss_val': 0.3330582593241827, 'psi': 0.8863518643136544}-{'f1_val': 0.8515911964799918, 'auprc': 0.9978150425471286, 'loss_val': 0.19873942878067657, 'psi': 0.9100807349068465}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.784124 cos_to_last_merge=0.7863 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.786
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6181859712678257, 'auprc': 0.655657180424635, 'loss_val': 1.1954033747106412, 'psi': 0.6331744549305495}-{'f1_val': 0.6566929538485027, 'auprc': 0.6713643534673979, 'loss_val': 1.0023177265508225, 'psi': 0.6625615136960608}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=2.062771 cos_to_last_merge=0.9667 (last merge round=18)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9890180214872789, 'auprc': 0.9957230493949069, 'loss_val': 0.041901967759463296, 'psi': 0.99170003265033}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971569572579959, 'loss_val': 0.02012061096279692, 'psi': 0.9970612877977973}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=1.816418 cos_to_last_merge=1.0000 (last merge round=72)
[S15] round=74 local utility u=0.165629 metrics={'f1_val': 0.7452703346672942, 'auprc': 0.9903999396898087, 'loss_val': 0.5443142102860802, 'psi': 0.8433221766762999}-{'f1_val': 0.7033184273321893, 'auprc': 0.990867517080559, 'loss_val': 0.6252644720639033, 'psi': 0.8183380632315371}
[S16] START round=74 head_norm_before_train=1.988595 cos_to_last_merge=0.7722 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=74 local utility u=0.008605 metrics={'f1_val': 0.8549748187910283, 'auprc': 0.9919088738780875, 'loss_val': 0.9974937226360481, 'psi': 0.909748440825852}-{'f1_val': 0.852744182304803, 'auprc': 0.9935370861816355, 'loss_val': 1.006205137170791, 'psi': 0.909061343855536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=74 head_norm_before_train=1.958955 cos_to_last_merge=0.7817 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.7306979428199586, 'auprc': 0.9099351250903178, 'loss_val': 0.798711643885177, 'psi': 0.8023928157281023}-{'f1_val': 0.8394803872951004, 'auprc': 0.9646452513264001, 'loss_val': 0.4329897706956693, 'psi': 0.8895463329076203}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=74 metric=0.7453 head_norm=1.824672
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.032013e-02
[S15] stored merged vector for next round verification (round=74)
[S15] DEBUG after merge:  round=74 metric=0.7453 head_norm=1.817934 delta_norm=0.010320
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=75 head_norm_before_train=1.712970 cos_to_last_merge=0.8679 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.868
[S2] round=75 local utility u=0.097859 metrics={'f1_val': 0.8275463308128204, 'auprc': 0.9861070612035383, 'loss_val': 0.4260438453095113, 'psi': 0.8909706229691075}-{'f1_val': 0.8332554712498397, 'auprc': 0.9115138683305379, 'loss_val': 0.4322366079107371, 'psi': 0.864558830082119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=75 head_norm_before_train=1.686188 cos_to_last_merge=0.9058 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.906
[S3] round=75 local utility u=0.158294 metrics={'f1_val': 0.7712260648744969, 'auprc': 0.9668087694998492, 'loss_val': 0.4255793402446043, 'psi': 0.8494591467246377}-{'f1_val': 0.7162395145667273, 'auprc': 0.988584743030513, 'loss_val': 0.477575114131502, 'psi': 0.8251776059522415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] sending update (kind=head size=1807 to 1 peers)
[S4] START round=75 head_norm_before_train=1.621970 cos_to_last_merge=0.9147 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=75 local utility u=1.000000 metrics={'f1_val': 0.9403831939749181, 'auprc': 0.9585442850352524, 'loss_val': 0.30787163532426975, 'psi': 0.9476476303990518}-{'f1_val': 0.6280372379214135, 'auprc': 0.9548453554833978, 'loss_val': 0.6800977882728543, 'psi': 0.7587604849462073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=75 head_norm_before_train=1.536115 cos_to_last_merge=0.9134 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.7848994430534727, 'auprc': 0.9912533568964768, 'loss_val': 0.16951001100251223, 'psi': 0.8674410085906743}-{'f1_val': 0.7831682921930131, 'auprc': 0.9938489078336761, 'loss_val': 0.14357756758559204, 'psi': 0.8674405384492783}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=1.717496 cos_to_last_merge=0.9046 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.905
[S6] round=75 local utility u=0.683341 metrics={'f1_val': 0.8902420926679729, 'auprc': 0.9828035242233364, 'loss_val': 0.1946767745533056, 'psi': 0.9272666652901183}-{'f1_val': 0.7582757809277065, 'auprc': 0.9463382617731085, 'loss_val': 0.6601645665841722, 'psi': 0.8335007732658674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=75 head_norm_before_train=1.834107 cos_to_last_merge=0.9805 (last merge round=24)
[S7] round=75 local utility u=0.403676 metrics={'f1_val': 0.6973355742761171, 'auprc': 0.8549500059584905, 'loss_val': 0.2907757574961204, 'psi': 0.7603813469490666}-{'f1_val': 0.6327298766508194, 'auprc': 0.7985185363534733, 'loss_val': 0.5411990439736378, 'psi': 0.6990453405318809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=75 head_norm_before_train=1.818322 cos_to_last_merge=1.0000 (last merge round=72)
[S8] round=75 local utility u=0.042940 metrics={'f1_val': 0.9924932660920454, 'auprc': 0.98311334941907, 'loss_val': 0.03533317774281428, 'psi': 0.9887412994228553}-{'f1_val': 0.9811202956051033, 'auprc': 0.984804401773484, 'loss_val': 0.058048228843118214, 'psi': 0.9825939380724557}
[S9] START round=75 head_norm_before_train=2.148784 (no previous merge yet)
[S9] round=75 local utility u=0.004537 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998115307021701, 'loss_val': 0.015372899316216222, 'psi': 0.9984329027349146}-{'f1_val': 0.9962710290637395, 'auprc': 0.9998753541561965, 'loss_val': 0.01718083539387807, 'psi': 0.9977127591007223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=75 head_norm_before_train=2.269685 (no previous merge yet)
[S10] round=75 local utility u=0.000027 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958503188239991, 'loss_val': 0.024232796983319798, 'psi': 0.9954528309412245}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958416326120911, 'loss_val': 0.02426079518541343, 'psi': 0.9954493564564613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=75 head_norm_before_train=2.079939 cos_to_last_merge=0.7417 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.742
[S11] round=75 local utility u=0.692553 metrics={'f1_val': 0.9927334907864783, 'auprc': 0.9989845597973679, 'loss_val': 0.03522690175044361, 'psi': 0.9952339183908341}-{'f1_val': 0.8122944877570437, 'auprc': 0.9974379291485704, 'loss_val': 0.3330582593241827, 'psi': 0.8863518643136544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=75 head_norm_before_train=1.786182 cos_to_last_merge=0.7857 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.786
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.599854453787602, 'auprc': 0.6120157153864322, 'loss_val': 1.5166830358250591, 'psi': 0.6047189584271342}-{'f1_val': 0.6181859712678257, 'auprc': 0.655657180424635, 'loss_val': 1.1954033747106412, 'psi': 0.6331744549305495}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=2.068464 cos_to_last_merge=0.9665 (last merge round=18)
[S14] round=75 local utility u=0.028082 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9971516843718491, 'loss_val': 0.030383480327818152, 'psi': 0.9963074188422432}-{'f1_val': 0.9890180214872789, 'auprc': 0.9957230493949069, 'loss_val': 0.041901967759463296, 'psi': 0.99170003265033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=75 head_norm_before_train=1.817934 cos_to_last_merge=1.0000 (last merge round=74)
[S15] round=75 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9966696588645252, 'loss_val': 0.023634314388292565, 'psi': 0.9967158645783224}-{'f1_val': 0.7452703346672942, 'auprc': 0.9903999396898087, 'loss_val': 0.5443142102860802, 'psi': 0.8433221766762999}
[S16] START round=75 head_norm_before_train=1.989678 cos_to_last_merge=0.7713 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=75 local utility u=0.118452 metrics={'f1_val': 0.8654315263071876, 'auprc': 0.9923432221433983, 'loss_val': 0.8246327522390661, 'psi': 0.9161962046416718}-{'f1_val': 0.8549748187910283, 'auprc': 0.9919088738780875, 'loss_val': 0.9974937226360481, 'psi': 0.909748440825852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=75 head_norm_before_train=1.967300 cos_to_last_merge=0.7813 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=75 local utility u=0.998300 metrics={'f1_val': 0.929086580372406, 'auprc': 0.9880896096765637, 'loss_val': 0.22690655918059133, 'psi': 0.9526877920940691}-{'f1_val': 0.7306979428199586, 'auprc': 0.9099351250903178, 'loss_val': 0.798711643885177, 'psi': 0.8023928157281023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.9999
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=75 metric=0.9925 head_norm=1.822084
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.027315e-02
[S8] stored merged vector for next round verification (round=75)
[S8] DEBUG after merge:  round=75 metric=0.9929 head_norm=1.823732 delta_norm=0.010273
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.013 → S15@127.0.0.1:33915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=75 metric=0.9967 head_norm=1.826201
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.483280e-03
[S15] stored merged vector for next round verification (round=75)
[S15] DEBUG after merge:  round=75 metric=0.9967 head_norm=1.824119 delta_norm=0.009483
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.334 → S8@127.0.0.1:33909
[S2] START round=76 head_norm_before_train=1.718728 cos_to_last_merge=0.8674 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.867
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.7234122162734773, 'auprc': 0.8343519382346513, 'loss_val': 0.8473421203559415, 'psi': 0.7677881050579469}-{'f1_val': 0.8275463308128204, 'auprc': 0.9861070612035383, 'loss_val': 0.4260438453095113, 'psi': 0.8909706229691075}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=1.692834 cos_to_last_merge=0.9047 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.905
[S3] round=76 local utility u=0.810886 metrics={'f1_val': 0.968154390921399, 'auprc': 0.9953475109603421, 'loss_val': 0.07099437996248663, 'psi': 0.9790316389369762}-{'f1_val': 0.7712260648744969, 'auprc': 0.9668087694998492, 'loss_val': 0.4255793402446043, 'psi': 0.8494591467246377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=76 head_norm_before_train=1.626945 cos_to_last_merge=0.9139 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.9410198819744935, 'auprc': 0.9553045148182635, 'loss_val': 0.30904263396202813, 'psi': 0.9467337351120015}-{'f1_val': 0.9403831939749181, 'auprc': 0.9585442850352524, 'loss_val': 0.30787163532426975, 'psi': 0.9476476303990518}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=76 head_norm_before_train=1.537554 cos_to_last_merge=0.9131 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.5179693354259166, 'auprc': 0.7816216810565444, 'loss_val': 0.8273710757144687, 'psi': 0.6234302736781677}-{'f1_val': 0.7848994430534727, 'auprc': 0.9912533568964768, 'loss_val': 0.16951001100251223, 'psi': 0.8674410085906743}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=1.725535 cos_to_last_merge=0.9038 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.904
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.8324571175749043, 'auprc': 0.962334171158863, 'loss_val': 0.41354459444078495, 'psi': 0.8844079390084878}-{'f1_val': 0.8902420926679729, 'auprc': 0.9828035242233364, 'loss_val': 0.1946767745533056, 'psi': 0.9272666652901183}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.838178 cos_to_last_merge=0.9802 (last merge round=24)
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.629459168468547, 'auprc': 0.8013766516357613, 'loss_val': 0.549404680446898, 'psi': 0.6982261617354327}-{'f1_val': 0.6973355742761171, 'auprc': 0.8549500059584905, 'loss_val': 0.2907757574961204, 'psi': 0.7603813469490666}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=1.823732 cos_to_last_merge=1.0000 (last merge round=75)
[S8] round=76 local utility u=0.003308 metrics={'f1_val': 0.9935879766866298, 'auprc': 0.9829561008478594, 'loss_val': 0.034814244105187325, 'psi': 0.9893352263511217}-{'f1_val': 0.9924932660920454, 'auprc': 0.98311334941907, 'loss_val': 0.03533317774281428, 'psi': 0.9887412994228553}
[S9] START round=76 head_norm_before_train=2.154143 (no previous merge yet)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9997644921057527, 'loss_val': 0.015226562192519916, 'psi': 0.9981658265658391}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998115307021701, 'loss_val': 0.015372899316216222, 'psi': 0.9984329027349146}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.272326 (no previous merge yet)
[S10] round=76 local utility u=0.000202 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958742797117306, 'loss_val': 0.023900308710901586, 'psi': 0.9954624152963171}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958503188239991, 'loss_val': 0.024232796983319798, 'psi': 0.9954528309412245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=76 head_norm_before_train=2.083518 cos_to_last_merge=0.7414 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.741
[S11] round=76 local utility u=0.019098 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9990660746459579, 'loss_val': 0.017799883069097234, 'psi': 0.9973189147048304}-{'f1_val': 0.9927334907864783, 'auprc': 0.9989845597973679, 'loss_val': 0.03522690175044361, 'psi': 0.9952339183908341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=76 head_norm_before_train=1.788168 cos_to_last_merge=0.7855 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.786
[S13] round=76 local utility u=0.261376 metrics={'f1_val': 0.6220667980039526, 'auprc': 0.6405543791753395, 'loss_val': 1.212821686798923, 'psi': 0.6294618304725074}-{'f1_val': 0.599854453787602, 'auprc': 0.6120157153864322, 'loss_val': 1.5166830358250591, 'psi': 0.6047189584271342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=76 head_norm_before_train=2.073105 cos_to_last_merge=0.9661 (last merge round=18)
[S14] round=76 local utility u=0.008940 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971570289403413, 'loss_val': 0.020036772990686146, 'psi': 0.9970613164707356}-{'f1_val': 0.9957445751558393, 'auprc': 0.9971516843718491, 'loss_val': 0.030383480327818152, 'psi': 0.9963074188422432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=76 head_norm_before_train=1.824119 cos_to_last_merge=1.0000 (last merge round=75)
[S15] round=76 local utility u=0.004203 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982242617771929, 'loss_val': 0.01989239409895228, 'psi': 0.9973377057433895}-{'f1_val': 0.9967466683875206, 'auprc': 0.9966696588645252, 'loss_val': 0.023634314388292565, 'psi': 0.9967158645783224}
[S16] START round=76 head_norm_before_train=1.991531 cos_to_last_merge=0.7705 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=76 local utility u=0.329149 metrics={'f1_val': 0.9063301405737123, 'auprc': 0.9957816783708248, 'loss_val': 0.4220411637119151, 'psi': 0.9421107556925573}-{'f1_val': 0.8654315263071876, 'auprc': 0.9923432221433983, 'loss_val': 0.8246327522390661, 'psi': 0.9161962046416718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=76 head_norm_before_train=1.971657 cos_to_last_merge=0.7814 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.8843671703966317, 'auprc': 0.9653511422630066, 'loss_val': 0.38105834679167283, 'psi': 0.9167607591431817}-{'f1_val': 0.929086580372406, 'auprc': 0.9880896096765637, 'loss_val': 0.22690655918059133, 'psi': 0.9526877920940691}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=76 metric=0.9967 head_norm=1.832489
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.639671e-03
[S15] stored merged vector for next round verification (round=76)
[S15] DEBUG after merge:  round=76 metric=0.9967 head_norm=1.830979 delta_norm=0.004640
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=76 metric=0.9936 head_norm=1.829480
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.639674e-03
[S8] stored merged vector for next round verification (round=76)
[S8] DEBUG after merge:  round=76 metric=0.9936 head_norm=1.830979 delta_norm=0.004640
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=77 head_norm_before_train=1.723223 cos_to_last_merge=0.8669 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.867
[S2] round=77 local utility u=0.656167 metrics={'f1_val': 0.8263912590435993, 'auprc': 0.9336586208728194, 'loss_val': 0.4508026281446184, 'psi': 0.8692982037752873}-{'f1_val': 0.7234122162734773, 'auprc': 0.8343519382346513, 'loss_val': 0.8473421203559415, 'psi': 0.7677881050579469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=77 head_norm_before_train=1.700655 cos_to_last_merge=0.9037 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.963403534455326, 'auprc': 0.998228347521188, 'loss_val': 0.06595242901412046, 'psi': 0.9773334596816708}-{'f1_val': 0.968154390921399, 'auprc': 0.9953475109603421, 'loss_val': 0.07099437996248663, 'psi': 0.9790316389369762}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=1.634518 cos_to_last_merge=0.9129 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9395001760726907, 'auprc': 0.9516041685511976, 'loss_val': 0.31754361955148414, 'psi': 0.9443417730640935}-{'f1_val': 0.9410198819744935, 'auprc': 0.9553045148182635, 'loss_val': 0.30904263396202813, 'psi': 0.9467337351120015}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.537696 cos_to_last_merge=0.9130 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=77 local utility u=1.000000 metrics={'f1_val': 0.8673098918185563, 'auprc': 0.9909963780730512, 'loss_val': 0.14056796397438737, 'psi': 0.9167844863203543}-{'f1_val': 0.5179693354259166, 'auprc': 0.7816216810565444, 'loss_val': 0.8273710757144687, 'psi': 0.6234302736781677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=77 head_norm_before_train=1.733332 cos_to_last_merge=0.9032 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.903
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.7813273525321631, 'auprc': 0.9395744468762758, 'loss_val': 0.5815103198335366, 'psi': 0.8446261902698082}-{'f1_val': 0.8324571175749043, 'auprc': 0.962334171158863, 'loss_val': 0.41354459444078495, 'psi': 0.8844079390084878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.842522 cos_to_last_merge=0.9799 (last merge round=24)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.5840759065272028, 'auprc': 0.7948572253034878, 'loss_val': 0.819681778732792, 'psi': 0.6683884340377169}-{'f1_val': 0.629459168468547, 'auprc': 0.8013766516357613, 'loss_val': 0.549404680446898, 'psi': 0.6982261617354327}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=1.830979 cos_to_last_merge=1.0000 (last merge round=76)
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9746177245222236, 'auprc': 0.9848216078593891, 'loss_val': 0.06814233544679732, 'psi': 0.9786992778570898}-{'f1_val': 0.9935879766866298, 'auprc': 0.9829561008478594, 'loss_val': 0.034814244105187325, 'psi': 0.9893352263511217}
[S9] START round=77 head_norm_before_train=2.160199 (no previous merge yet)
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9997549574930245, 'loss_val': 0.021687115287203865, 'psi': 0.9961651344397864}-{'f1_val': 0.9971000495392299, 'auprc': 0.9997644921057527, 'loss_val': 0.015226562192519916, 'psi': 0.9981658265658391}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=77 head_norm_before_train=2.276726 (no previous merge yet)
[S10] round=77 local utility u=0.000150 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959023756299159, 'loss_val': 0.023684654943453533, 'psi': 0.9954736536635912}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958742797117306, 'loss_val': 0.023900308710901586, 'psi': 0.9954624152963171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=77 head_norm_before_train=2.088411 cos_to_last_merge=0.7412 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.741
[S11] round=77 local utility u=0.000650 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9994742714062119, 'loss_val': 0.01772392826597094, 'psi': 0.997482193408932}-{'f1_val': 0.9961541414107454, 'auprc': 0.9990660746459579, 'loss_val': 0.017799883069097234, 'psi': 0.9973189147048304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=77 head_norm_before_train=1.790246 cos_to_last_merge=0.7853 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.785
[S13] round=77 local utility u=0.833226 metrics={'f1_val': 0.7876478680526728, 'auprc': 0.7185310874981046, 'loss_val': 0.7737859821962347, 'psi': 0.7600011558308455}-{'f1_val': 0.6220667980039526, 'auprc': 0.6405543791753395, 'loss_val': 1.212821686798923, 'psi': 0.6294618304725074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=77 head_norm_before_train=2.075570 cos_to_last_merge=0.9658 (last merge round=18)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.99603936271255, 'loss_val': 0.021037776506607334, 'psi': 0.9967302180451123}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971570289403413, 'loss_val': 0.020036772990686146, 'psi': 0.9970613164707356}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=1.830979 cos_to_last_merge=1.0000 (last merge round=76)
[S15] round=77 local utility u=0.002823 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9989778510756937, 'loss_val': 0.018731603971708734, 'psi': 0.9978614925471376}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982242617771929, 'loss_val': 0.01989239409895228, 'psi': 0.9973377057433895}
[S16] START round=77 head_norm_before_train=1.995712 cos_to_last_merge=0.7701 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9002056132311007, 'auprc': 0.993912589423998, 'loss_val': 0.4472900279579697, 'psi': 0.9376884037082597}-{'f1_val': 0.9063301405737123, 'auprc': 0.9957816783708248, 'loss_val': 0.4220411637119151, 'psi': 0.9421107556925573}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=1.968659 cos_to_last_merge=0.7823 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.6788904785153285, 'auprc': 0.8783181913161326, 'loss_val': 1.0656669903857052, 'psi': 0.7586615636356502}-{'f1_val': 0.8843671703966317, 'auprc': 0.9653511422630066, 'loss_val': 0.38105834679167283, 'psi': 0.9167607591431817}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=1.0000
[S2] START round=78 head_norm_before_train=1.728102 cos_to_last_merge=0.8664 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.866
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.7230919405366764, 'auprc': 0.8620857715477647, 'loss_val': 0.6813069544859562, 'psi': 0.7786894729411118}-{'f1_val': 0.8263912590435993, 'auprc': 0.9336586208728194, 'loss_val': 0.4508026281446184, 'psi': 0.8692982037752873}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=1.709462 cos_to_last_merge=0.9024 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.902
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.8082401422767764, 'auprc': 0.9635110081750996, 'loss_val': 0.47707061703628767, 'psi': 0.8703484886361057}-{'f1_val': 0.963403534455326, 'auprc': 0.998228347521188, 'loss_val': 0.06595242901412046, 'psi': 0.9773334596816708}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=1.640280 cos_to_last_merge=0.9120 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=78 local utility u=0.005025 metrics={'f1_val': 0.9400126822547274, 'auprc': 0.9531140878023786, 'loss_val': 0.3150989542921765, 'psi': 0.9452532444737879}-{'f1_val': 0.9395001760726907, 'auprc': 0.9516041685511976, 'loss_val': 0.31754361955148414, 'psi': 0.9443417730640935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=78 head_norm_before_train=1.537316 cos_to_last_merge=0.9129 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.7001587899531788, 'auprc': 0.7006079027666826, 'loss_val': 0.4937275284285143, 'psi': 0.7003384350785804}-{'f1_val': 0.8673098918185563, 'auprc': 0.9909963780730512, 'loss_val': 0.14056796397438737, 'psi': 0.9167844863203543}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=1.740072 cos_to_last_merge=0.9027 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.903
[S6] round=78 local utility u=0.182502 metrics={'f1_val': 0.8098690483048392, 'auprc': 0.9615044301946256, 'loss_val': 0.45354706518716303, 'psi': 0.8705232010607538}-{'f1_val': 0.7813273525321631, 'auprc': 0.9395744468762758, 'loss_val': 0.5815103198335366, 'psi': 0.8446261902698082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=78 head_norm_before_train=1.847071 cos_to_last_merge=0.9796 (last merge round=24)
[S7] round=78 local utility u=0.837832 metrics={'f1_val': 0.6973422211505381, 'auprc': 0.9326966477249171, 'loss_val': 0.23713327146579247, 'psi': 0.7914839917802897}-{'f1_val': 0.5840759065272028, 'auprc': 0.7948572253034878, 'loss_val': 0.819681778732792, 'psi': 0.6683884340377169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=78 head_norm_before_train=1.835684 cos_to_last_merge=1.0000 (last merge round=76)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.8519820101643187, 'auprc': 0.987123564071034, 'loss_val': 0.29310709819933667, 'psi': 0.9060386317270048}-{'f1_val': 0.9746177245222236, 'auprc': 0.9848216078593891, 'loss_val': 0.06814233544679732, 'psi': 0.9786992778570898}
[S9] START round=78 head_norm_before_train=2.165935 (no previous merge yet)
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.9997550981447993, 'loss_val': 0.031570536413659984, 'psi': 0.9939916371887456}-{'f1_val': 0.9937719190709611, 'auprc': 0.9997549574930245, 'loss_val': 0.021687115287203865, 'psi': 0.9961651344397864}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=2.281910 (no previous merge yet)
[S10] round=78 local utility u=0.000054 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995939037096401, 'loss_val': 0.023685712476263696, 'psi': 0.9954883182501852}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959023756299159, 'loss_val': 0.023684654943453533, 'psi': 0.9954736536635912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=78 head_norm_before_train=2.092463 cos_to_last_merge=0.7408 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.741
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.991361363528295, 'auprc': 0.9995656357100225, 'loss_val': 0.03396826018876885, 'psi': 0.994643072400986}-{'f1_val': 0.9961541414107454, 'auprc': 0.9994742714062119, 'loss_val': 0.01772392826597094, 'psi': 0.997482193408932}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.791623 cos_to_last_merge=0.7853 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.785
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.568518293655637, 'auprc': 0.6168999983993778, 'loss_val': 1.5700282038726008, 'psi': 0.5878709755531333}-{'f1_val': 0.7876478680526728, 'auprc': 0.7185310874981046, 'loss_val': 0.7737859821962347, 'psi': 0.7600011558308455}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=2.076153 cos_to_last_merge=0.9657 (last merge round=18)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9964797603477688, 'loss_val': 0.0207506640936618, 'psi': 0.9966583687105692}-{'f1_val': 0.9971907882668205, 'auprc': 0.99603936271255, 'loss_val': 0.021037776506607334, 'psi': 0.9967302180451123}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=1.839302 cos_to_last_merge=1.0000 (last merge round=76)
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.8752648014710477, 'auprc': 0.9949276987874938, 'loss_val': 0.3381378823516467, 'psi': 0.9231299603976262}-{'f1_val': 0.9971172535281002, 'auprc': 0.9989778510756937, 'loss_val': 0.018731603971708734, 'psi': 0.9978614925471376}
[S16] START round=78 head_norm_before_train=2.001090 cos_to_last_merge=0.7699 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.8498953362983631, 'auprc': 0.8909422480750128, 'loss_val': 1.098226867037208, 'psi': 0.866314101009023}-{'f1_val': 0.9002056132311007, 'auprc': 0.993912589423998, 'loss_val': 0.4472900279579697, 'psi': 0.9376884037082597}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=1.968346 cos_to_last_merge=0.7826 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=78 local utility u=0.824837 metrics={'f1_val': 0.8295837223520854, 'auprc': 0.9233875283228438, 'loss_val': 0.4553602251992813, 'psi': 0.8671052447403887}-{'f1_val': 0.6788904785153285, 'auprc': 0.8783181913161326, 'loss_val': 1.0656669903857052, 'psi': 0.7586615636356502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=78 metric=0.8520 head_norm=1.841123
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.308782e-03
[S8] stored merged vector for next round verification (round=78)
[S8] DEBUG after merge:  round=78 metric=0.8520 head_norm=1.840194 delta_norm=0.008309
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=79 head_norm_before_train=1.732849 cos_to_last_merge=0.8661 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.866
[S2] round=79 local utility u=0.125824 metrics={'f1_val': 0.7438108395838962, 'auprc': 0.8676252356980547, 'loss_val': 0.5705914779451852, 'psi': 0.7933365980295596}-{'f1_val': 0.7230919405366764, 'auprc': 0.8620857715477647, 'loss_val': 0.6813069544859562, 'psi': 0.7786894729411118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S2] r=80 psi=0.793 u=0.1258 p_local=0.1623 f1=0.744 auprc=0.868 bytes=95146
[S3] START round=79 head_norm_before_train=1.716870 cos_to_last_merge=0.9011 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=79 local utility u=0.595509 metrics={'f1_val': 0.9301090798986251, 'auprc': 0.9989991118699224, 'loss_val': 0.12372958459442612, 'psi': 0.957665092687144}-{'f1_val': 0.8082401422767764, 'auprc': 0.9635110081750996, 'loss_val': 0.47707061703628767, 'psi': 0.8703484886361057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S3] r=80 psi=0.958 u=0.5955 p_local=0.2742 f1=0.930 auprc=0.999 bytes=84591
[S4] START round=79 head_norm_before_train=1.644141 cos_to_last_merge=0.9114 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=79 local utility u=0.036033 metrics={'f1_val': 0.9481233846291601, 'auprc': 0.9557777183092862, 'loss_val': 0.2996880827377882, 'psi': 0.9511851181012105}-{'f1_val': 0.9400126822547274, 'auprc': 0.9531140878023786, 'loss_val': 0.3150989542921765, 'psi': 0.9452532444737879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S4] r=80 psi=0.951 u=0.0360 p_local=0.0942 f1=0.948 auprc=0.956 bytes=79132
[S5] START round=79 head_norm_before_train=1.539638 cos_to_last_merge=0.9127 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=79 local utility u=0.248846 metrics={'f1_val': 0.7003314862639722, 'auprc': 0.8536238583181729, 'loss_val': 0.45611885367712973, 'psi': 0.7616484350856525}-{'f1_val': 0.7001587899531788, 'auprc': 0.7006079027666826, 'loss_val': 0.4937275284285143, 'psi': 0.7003384350785804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S5] r=80 psi=0.762 u=0.2488 p_local=0.3024 f1=0.700 auprc=0.854 bytes=77427
[S6] START round=79 head_norm_before_train=1.745413 cos_to_last_merge=0.9016 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.902
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.72568858229904, 'auprc': 0.958151044550308, 'loss_val': 0.6062815623696642, 'psi': 0.8186735671995472}-{'f1_val': 0.8098690483048392, 'auprc': 0.9615044301946256, 'loss_val': 0.45354706518716303, 'psi': 0.8705232010607538}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.819 u=0.0000 p_local=0.2055 f1=0.726 auprc=0.958 bytes=75568
[S7] START round=79 head_norm_before_train=1.850613 cos_to_last_merge=0.9793 (last merge round=24)
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.6113006183104323, 'auprc': 0.7955177131430218, 'loss_val': 0.7373956962955557, 'psi': 0.6849874562434681}-{'f1_val': 0.6973422211505381, 'auprc': 0.9326966477249171, 'loss_val': 0.23713327146579247, 'psi': 0.7914839917802897}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.685 u=0.0000 p_local=0.1922 f1=0.611 auprc=0.796 bytes=82808
[S8] START round=79 head_norm_before_train=1.840194 cos_to_last_merge=1.0000 (last merge round=78)
[S8] round=79 local utility u=0.471660 metrics={'f1_val': 0.9761368354100979, 'auprc': 0.9818660616212875, 'loss_val': 0.0789426133064572, 'psi': 0.9784285258945737}-{'f1_val': 0.8519820101643187, 'auprc': 0.987123564071034, 'loss_val': 0.29310709819933667, 'psi': 0.9060386317270048}
[S9] START round=79 head_norm_before_train=2.170682 (no previous merge yet)
[S9] round=79 local utility u=0.027597 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998852736368177, 'loss_val': 0.01583451437605105, 'psi': 0.9979504165430619}-{'f1_val': 0.9901493298847097, 'auprc': 0.9997550981447993, 'loss_val': 0.031570536413659984, 'psi': 0.9939916371887456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S9] r=80 psi=0.998 u=0.0276 p_local=0.0082 f1=0.997 auprc=1.000 bytes=84472
[S10] START round=79 head_norm_before_train=2.287462 (no previous merge yet)
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995842942592476, 'loss_val': 0.023968450000857466, 'psi': 0.9954498804486152}-{'f1_val': 0.9951878390193748, 'auprc': 0.995939037096401, 'loss_val': 0.023685712476263696, 'psi': 0.9954883182501852}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.995 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.996 bytes=97162
[S11] START round=79 head_norm_before_train=2.095399 cos_to_last_merge=0.7404 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.740
[S11] round=79 local utility u=0.021361 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991317250150775, 'loss_val': 0.018701075499530595, 'psi': 0.9973451748524782}-{'f1_val': 0.991361363528295, 'auprc': 0.9995656357100225, 'loss_val': 0.03396826018876885, 'psi': 0.994643072400986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] r=80 psi=0.997 u=0.0214 p_local=0.0661 f1=0.996 auprc=0.999 bytes=93448
[S13] START round=79 head_norm_before_train=1.793047 cos_to_last_merge=0.7850 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.785
[S13] round=79 local utility u=0.489649 metrics={'f1_val': 0.6378751439635, 'auprc': 0.6886374830353202, 'loss_val': 1.2220830045255098, 'psi': 0.6581800795922281}-{'f1_val': 0.568518293655637, 'auprc': 0.6168999983993778, 'loss_val': 1.5700282038726008, 'psi': 0.5878709755531333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] r=80 psi=0.658 u=0.4896 p_local=0.2596 f1=0.638 auprc=0.689 bytes=81090
[S14] START round=79 head_norm_before_train=2.077389 cos_to_last_merge=0.9654 (last merge round=18)
[S14] round=79 local utility u=0.006202 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9988522559836535, 'loss_val': 0.019248977848871505, 'psi': 0.9979858640944967}-{'f1_val': 0.9967774409524363, 'auprc': 0.9964797603477688, 'loss_val': 0.0207506640936618, 'psi': 0.9966583687105692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S14] r=80 psi=0.998 u=0.0062 p_local=0.0046 f1=0.997 auprc=0.999 bytes=95371
[S15] START round=79 head_norm_before_train=1.846916 cos_to_last_merge=1.0000 (last merge round=76)
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.8740089766711727, 'auprc': 0.9949196974957202, 'loss_val': 0.33943336140167985, 'psi': 0.9223732650009917}-{'f1_val': 0.8752648014710477, 'auprc': 0.9949276987874938, 'loss_val': 0.3381378823516467, 'psi': 0.9231299603976262}
[S16] START round=79 head_norm_before_train=2.002848 cos_to_last_merge=0.7690 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.769
[S16] round=79 local utility u=1.000000 metrics={'f1_val': 0.978794861209208, 'auprc': 0.9918168880730434, 'loss_val': 0.0762416388097853, 'psi': 0.984003671954742}-{'f1_val': 0.8498953362983631, 'auprc': 0.8909422480750128, 'loss_val': 1.098226867037208, 'psi': 0.866314101009023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S16] r=80 psi=0.984 u=1.0000 p_local=0.2514 f1=0.979 auprc=0.992 bytes=80919
[S17] START round=79 head_norm_before_train=1.970273 cos_to_last_merge=0.7824 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.6990938607927704, 'auprc': 0.8664845542387656, 'loss_val': 0.9955105811193383, 'psi': 0.7660501381711684}-{'f1_val': 0.8295837223520854, 'auprc': 0.9233875283228438, 'loss_val': 0.4553602251992813, 'psi': 0.8671052447403887}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.766 u=0.0000 p_local=0.2814 f1=0.699 auprc=0.866 bytes=71999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] r=80 psi=0.922 u=0.0000 p_local=0.1375 f1=0.874 auprc=0.995 bytes=82725
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] r=80 psi=0.978 u=0.4717 p_local=0.0999 f1=0.976 auprc=0.982 bytes=91654
[S2] START round=80 head_norm_before_train=1.738862 cos_to_last_merge=0.8654 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.865
[S2] round=80 local utility u=0.357246 metrics={'f1_val': 0.7835078462538392, 'auprc': 0.9870550207725906, 'loss_val': 0.4525708090692798, 'psi': 0.8649267160613398}-{'f1_val': 0.7438108395838962, 'auprc': 0.8676252356980547, 'loss_val': 0.5705914779451852, 'psi': 0.7933365980295596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=80 head_norm_before_train=1.724285 cos_to_last_merge=0.8999 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.8906791360328434, 'auprc': 0.9665352169534279, 'loss_val': 0.29113865961841373, 'psi': 0.9210215684010773}-{'f1_val': 0.9301090798986251, 'auprc': 0.9989991118699224, 'loss_val': 0.12372958459442612, 'psi': 0.957665092687144}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.649471 cos_to_last_merge=0.9108 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9448705571097689, 'auprc': 0.9575441788683204, 'loss_val': 0.3038646285713927, 'psi': 0.9499400058131895}-{'f1_val': 0.9481233846291601, 'auprc': 0.9557777183092862, 'loss_val': 0.2996880827377882, 'psi': 0.9511851181012105}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=1.541018 cos_to_last_merge=0.9126 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=80 local utility u=0.099279 metrics={'f1_val': 0.7054028899521443, 'auprc': 0.8852559548681348, 'loss_val': 0.3828855660967139, 'psi': 0.7773441159185406}-{'f1_val': 0.7003314862639722, 'auprc': 0.8536238583181729, 'loss_val': 0.45611885367712973, 'psi': 0.7616484350856525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=80 head_norm_before_train=1.751708 cos_to_last_merge=0.9007 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.901
[S6] round=80 local utility u=0.668099 metrics={'f1_val': 0.8759323440794251, 'auprc': 0.9777835991513221, 'loss_val': 0.23044358242801566, 'psi': 0.9166728461081839}-{'f1_val': 0.72568858229904, 'auprc': 0.958151044550308, 'loss_val': 0.6062815623696642, 'psi': 0.8186735671995472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=80 head_norm_before_train=1.852664 cos_to_last_merge=0.9791 (last merge round=24)
[S7] round=80 local utility u=0.254387 metrics={'f1_val': 0.6478929997460791, 'auprc': 0.8082508301188657, 'loss_val': 0.48637548469315733, 'psi': 0.7120361318951938}-{'f1_val': 0.6113006183104323, 'auprc': 0.7955177131430218, 'loss_val': 0.7373956962955557, 'psi': 0.6849874562434681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=80 head_norm_before_train=1.845078 cos_to_last_merge=1.0000 (last merge round=78)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9548289931568757, 'auprc': 0.9949047104847953, 'loss_val': 0.12864317181483112, 'psi': 0.9708592800880436}-{'f1_val': 0.9761368354100979, 'auprc': 0.9818660616212875, 'loss_val': 0.0789426133064572, 'psi': 0.9784285258945737}
[S9] START round=80 head_norm_before_train=2.173088 (no previous merge yet)
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9978036820282121, 'loss_val': 0.017885799364798196, 'psi': 0.9971177798996197}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998852736368177, 'loss_val': 0.01583451437605105, 'psi': 0.9979504165430619}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.289278 (no previous merge yet)
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958558067732657, 'loss_val': 0.024100918043084386, 'psi': 0.9954550261209312}-{'f1_val': 0.9951878390193748, 'auprc': 0.995842942592476, 'loss_val': 0.023968450000857466, 'psi': 0.9954498804486152}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=2.099871 cos_to_last_merge=0.7400 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.740
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.6194191815229475, 'auprc': 0.9958376535533959, 'loss_val': 0.7873905786352595, 'psi': 0.7699865703351269}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991317250150775, 'loss_val': 0.018701075499530595, 'psi': 0.9973451748524782}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.791802 cos_to_last_merge=0.7846 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.785
[S13] round=80 local utility u=0.369470 metrics={'f1_val': 0.7078935583636717, 'auprc': 0.6969314411342323, 'loss_val': 0.928136249862926, 'psi': 0.703508711471896}-{'f1_val': 0.6378751439635, 'auprc': 0.6886374830353202, 'loss_val': 1.2220830045255098, 'psi': 0.6581800795922281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=80 head_norm_before_train=2.081397 cos_to_last_merge=0.9651 (last merge round=18)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9971572975645702, 'loss_val': 0.031390743183644286, 'psi': 0.9965592603007523}-{'f1_val': 0.9974082695017256, 'auprc': 0.9988522559836535, 'loss_val': 0.019248977848871505, 'psi': 0.9979858640944967}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=1.853658 cos_to_last_merge=1.0000 (last merge round=76)
[S15] round=80 local utility u=0.533420 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9984601754416598, 'loss_val': 0.019640158442519016, 'psi': 0.9974320712091762}-{'f1_val': 0.8740089766711727, 'auprc': 0.9949196974957202, 'loss_val': 0.33943336140167985, 'psi': 0.9223732650009917}
[S16] START round=80 head_norm_before_train=2.004485 cos_to_last_merge=0.7681 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=80 local utility u=0.066953 metrics={'f1_val': 0.9920248999099666, 'auprc': 0.9964115855320268, 'loss_val': 0.0354989764457589, 'psi': 0.9937795741587907}-{'f1_val': 0.978794861209208, 'auprc': 0.9918168880730434, 'loss_val': 0.0762416388097853, 'psi': 0.984003671954742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=80 head_norm_before_train=1.973817 cos_to_last_merge=0.7821 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=80 local utility u=0.369984 metrics={'f1_val': 0.8403447659030385, 'auprc': 0.8530065005935146, 'loss_val': 1.0626139803319286, 'psi': 0.845409459779229}-{'f1_val': 0.6990938607927704, 'auprc': 0.8664845542387656, 'loss_val': 0.9955105811193383, 'psi': 0.7660501381711684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.080 → S15@127.0.0.1:33915
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=80 metric=0.9967 head_norm=1.860252
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.268481e-02
[S15] stored merged vector for next round verification (round=80)
[S15] DEBUG after merge:  round=80 metric=0.9967 head_norm=1.852637 delta_norm=0.012685
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.217 → S8@127.0.0.1:33909
[S2] START round=81 head_norm_before_train=1.744606 cos_to_last_merge=0.8650 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.865
[S2] round=81 local utility u=0.072113 metrics={'f1_val': 0.82687725035911, 'auprc': 0.9471859513953412, 'loss_val': 0.44895386528414144, 'psi': 0.8750007307736025}-{'f1_val': 0.7835078462538392, 'auprc': 0.9870550207725906, 'loss_val': 0.4525708090692798, 'psi': 0.8649267160613398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=81 head_norm_before_train=1.732043 cos_to_last_merge=0.8989 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.899
[S3] round=81 local utility u=0.500217 metrics={'f1_val': 0.9963277403106257, 'auprc': 0.9996373235494065, 'loss_val': 0.023903363454332572, 'psi': 0.997651573606138}-{'f1_val': 0.8906791360328434, 'auprc': 0.9665352169534279, 'loss_val': 0.29113865961841373, 'psi': 0.9210215684010773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=81 head_norm_before_train=1.654200 cos_to_last_merge=0.9097 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.910
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.939774037126277, 'auprc': 0.9538483223893925, 'loss_val': 0.316997270307271, 'psi': 0.9454037512315232}-{'f1_val': 0.9448705571097689, 'auprc': 0.9575441788683204, 'loss_val': 0.3038646285713927, 'psi': 0.9499400058131895}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.541507 cos_to_last_merge=0.9124 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.6368747231278189, 'auprc': 0.8661947915358716, 'loss_val': 0.4466893881270676, 'psi': 0.72860275049104}-{'f1_val': 0.7054028899521443, 'auprc': 0.8852559548681348, 'loss_val': 0.3828855660967139, 'psi': 0.7773441159185406}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=1.756751 cos_to_last_merge=0.8994 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.770812597228844, 'auprc': 0.9267617439740881, 'loss_val': 0.5492483607696113, 'psi': 0.8331922559269416}-{'f1_val': 0.8759323440794251, 'auprc': 0.9777835991513221, 'loss_val': 0.23044358242801566, 'psi': 0.9166728461081839}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.855005 cos_to_last_merge=0.9789 (last merge round=24)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.5465772961146572, 'auprc': 0.7899359098268343, 'loss_val': 1.0464604568802773, 'psi': 0.6439207415995281}-{'f1_val': 0.6478929997460791, 'auprc': 0.8082508301188657, 'loss_val': 0.48637548469315733, 'psi': 0.7120361318951938}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=1.850010 cos_to_last_merge=1.0000 (last merge round=78)
[S8] round=81 local utility u=0.127915 metrics={'f1_val': 0.9846114551120471, 'auprc': 0.9950120708119871, 'loss_val': 0.051829488450256964, 'psi': 0.988771701392023}-{'f1_val': 0.9548289931568757, 'auprc': 0.9949047104847953, 'loss_val': 0.12864317181483112, 'psi': 0.9708592800880436}
[S9] START round=81 head_norm_before_train=2.177669 (no previous merge yet)
[S9] round=81 local utility u=0.003419 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9999017393540698, 'loss_val': 0.0173216754736677, 'psi': 0.9979549029212746}-{'f1_val': 0.9966605118138915, 'auprc': 0.9978036820282121, 'loss_val': 0.017885799364798196, 'psi': 0.9971177798996197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=81 head_norm_before_train=2.291598 (no previous merge yet)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9958962300201571, 'loss_val': 0.024094038885416523, 'psi': 0.9953904992731673}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958558067732657, 'loss_val': 0.024100918043084386, 'psi': 0.9954550261209312}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=2.104687 cos_to_last_merge=0.7396 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.740
[S11] round=81 local utility u=1.000000 metrics={'f1_val': 0.995672955508997, 'auprc': 0.9994931188156563, 'loss_val': 0.016244042675862286, 'psi': 0.9972010208316607}-{'f1_val': 0.6194191815229475, 'auprc': 0.9958376535533959, 'loss_val': 0.7873905786352595, 'psi': 0.7699865703351269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=81 head_norm_before_train=1.790927 cos_to_last_merge=0.7849 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.785
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.6400510541450991, 'auprc': 0.6708559664059758, 'loss_val': 1.2133507817345996, 'psi': 0.6523730190494498}-{'f1_val': 0.7078935583636717, 'auprc': 0.6969314411342323, 'loss_val': 0.928136249862926, 'psi': 0.703508711471896}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=2.086083 cos_to_last_merge=0.9648 (last merge round=18)
[S14] round=81 local utility u=0.010036 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9984985638230326, 'loss_val': 0.022828614695868655, 'psi': 0.9978443872302484}-{'f1_val': 0.9961605687915402, 'auprc': 0.9971572975645702, 'loss_val': 0.031390743183644286, 'psi': 0.9965592603007523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=81 head_norm_before_train=1.852637 cos_to_last_merge=1.0000 (last merge round=80)
[S15] round=81 local utility u=0.002343 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.998895186491223, 'loss_val': 0.018483587053948047, 'psi': 0.9978284267133493}-{'f1_val': 0.9967466683875206, 'auprc': 0.9984601754416598, 'loss_val': 0.019640158442519016, 'psi': 0.9974320712091762}
[S16] START round=81 head_norm_before_train=2.008625 cos_to_last_merge=0.7678 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.9924380610192611, 'auprc': 0.995558992159274, 'loss_val': 0.035500281504758265, 'psi': 0.9936864334752662}-{'f1_val': 0.9920248999099666, 'auprc': 0.9964115855320268, 'loss_val': 0.0354989764457589, 'psi': 0.9937795741587907}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=81 head_norm_before_train=1.979921 cos_to_last_merge=0.7817 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.66080007070452, 'auprc': 0.735011280085541, 'loss_val': 1.7165098527467986, 'psi': 0.6904845544569284}-{'f1_val': 0.8403447659030385, 'auprc': 0.8530065005935146, 'loss_val': 1.0626139803319286, 'psi': 0.845409459779229}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=1.0000
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=81 metric=0.9846 head_norm=1.854739
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.123140e-02
[S8] stored merged vector for next round verification (round=81)
[S8] DEBUG after merge:  round=81 metric=0.9846 head_norm=1.857288 delta_norm=0.011231
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=81 metric=0.9971 head_norm=1.859559
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.509657e-03
[S15] stored merged vector for next round verification (round=81)
[S15] DEBUG after merge:  round=81 metric=0.9971 head_norm=1.857127 delta_norm=0.009510
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=82 head_norm_before_train=1.748957 cos_to_last_merge=0.8648 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.865
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.78535374542656, 'auprc': 0.8153177482069386, 'loss_val': 0.6283968948875223, 'psi': 0.7973393465387114}-{'f1_val': 0.82687725035911, 'auprc': 0.9471859513953412, 'loss_val': 0.44895386528414144, 'psi': 0.8750007307736025}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=1.738253 cos_to_last_merge=0.8978 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.898
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.8769197067843021, 'auprc': 0.9657933323760335, 'loss_val': 0.3650264908756802, 'psi': 0.9124691570209946}-{'f1_val': 0.9963277403106257, 'auprc': 0.9996373235494065, 'loss_val': 0.023903363454332572, 'psi': 0.997651573606138}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=1.659919 cos_to_last_merge=0.9087 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.909
[S4] round=82 local utility u=0.002883 metrics={'f1_val': 0.940037681588385, 'auprc': 0.9557164196887158, 'loss_val': 0.31841668463275874, 'psi': 0.9463091768285172}-{'f1_val': 0.939774037126277, 'auprc': 0.9538483223893925, 'loss_val': 0.316997270307271, 'psi': 0.9454037512315232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=82 head_norm_before_train=1.541267 cos_to_last_merge=0.9124 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=82 local utility u=0.174091 metrics={'f1_val': 0.7003314862639722, 'auprc': 0.8535668554271899, 'loss_val': 0.4413634508862292, 'psi': 0.7616256339292593}-{'f1_val': 0.6368747231278189, 'auprc': 0.8661947915358716, 'loss_val': 0.4466893881270676, 'psi': 0.72860275049104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=82 head_norm_before_train=1.762253 cos_to_last_merge=0.8985 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.7561829494392218, 'auprc': 0.9404146816377542, 'loss_val': 0.5437175507006617, 'psi': 0.8298756423186348}-{'f1_val': 0.770812597228844, 'auprc': 0.9267617439740881, 'loss_val': 0.5492483607696113, 'psi': 0.8331922559269416}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.858342 cos_to_last_merge=0.9786 (last merge round=24)
[S7] round=82 local utility u=1.000000 metrics={'f1_val': 0.9505281983199403, 'auprc': 0.9946530530842611, 'loss_val': 0.12861905621224867, 'psi': 0.9681781402256686}-{'f1_val': 0.5465772961146572, 'auprc': 0.7899359098268343, 'loss_val': 1.0464604568802773, 'psi': 0.6439207415995281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=82 head_norm_before_train=1.857288 cos_to_last_merge=1.0000 (last merge round=81)
[S8] round=82 local utility u=0.017250 metrics={'f1_val': 0.9930011150596958, 'auprc': 0.9854220331829707, 'loss_val': 0.03889689806065126, 'psi': 0.9899694823090057}-{'f1_val': 0.9846114551120471, 'auprc': 0.9950120708119871, 'loss_val': 0.051829488450256964, 'psi': 0.988771701392023}
[S9] START round=82 head_norm_before_train=2.180371 (no previous merge yet)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9999107811707193, 'loss_val': 0.023103793708339277, 'psi': 0.9962096174621127}-{'f1_val': 0.9966570119660778, 'auprc': 0.9999017393540698, 'loss_val': 0.0173216754736677, 'psi': 0.9979549029212746}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.295629 (no previous merge yet)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9958958042656, 'loss_val': 0.02410917255400431, 'psi': 0.9953903289713444}-{'f1_val': 0.9950533454418405, 'auprc': 0.9958962300201571, 'loss_val': 0.024094038885416523, 'psi': 0.9953904992731673}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=2.109510 cos_to_last_merge=0.7394 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.739
[S11] round=82 local utility u=0.000660 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9994911143832714, 'loss_val': 0.017805009261368052, 'psi': 0.9974889305997559}-{'f1_val': 0.995672955508997, 'auprc': 0.9994931188156563, 'loss_val': 0.016244042675862286, 'psi': 0.9972010208316607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=82 head_norm_before_train=1.792868 cos_to_last_merge=0.7847 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.785
[S13] round=82 local utility u=0.332835 metrics={'f1_val': 0.7350453230087333, 'auprc': 0.6763664118518735, 'loss_val': 1.134177571302087, 'psi': 0.7115737585459894}-{'f1_val': 0.6400510541450991, 'auprc': 0.6708559664059758, 'loss_val': 1.2133507817345996, 'psi': 0.6523730190494498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=82 head_norm_before_train=2.092717 cos_to_last_merge=0.9646 (last merge round=18)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9587309102012667, 'auprc': 0.9971572042660218, 'loss_val': 0.05599599908466588, 'psi': 0.9741014278271687}-{'f1_val': 0.9974082695017256, 'auprc': 0.9984985638230326, 'loss_val': 0.022828614695868655, 'psi': 0.9978443872302484}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=1.857127 cos_to_last_merge=1.0000 (last merge round=81)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981893652017441, 'loss_val': 0.01944829043234817, 'psi': 0.9973237471132099}-{'f1_val': 0.9971172535281002, 'auprc': 0.998895186491223, 'loss_val': 0.018483587053948047, 'psi': 0.9978284267133493}
[S16] START round=82 head_norm_before_train=2.014007 cos_to_last_merge=0.7675 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.9920251888873803, 'auprc': 0.9950342688959621, 'loss_val': 0.03508106880330219, 'psi': 0.9932288208908131}-{'f1_val': 0.9924380610192611, 'auprc': 0.995558992159274, 'loss_val': 0.035500281504758265, 'psi': 0.9936864334752662}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=1.988197 cos_to_last_merge=0.7812 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=82 local utility u=1.000000 metrics={'f1_val': 0.8469239209755486, 'auprc': 0.8896110052704818, 'loss_val': 0.7419085529417389, 'psi': 0.8639987546935219}-{'f1_val': 0.66080007070452, 'auprc': 0.735011280085541, 'loss_val': 1.7165098527467986, 'psi': 0.6904845544569284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=1.0000
[S2] START round=83 head_norm_before_train=1.753804 cos_to_last_merge=0.8643 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.864
[S2] round=83 local utility u=0.003981 metrics={'f1_val': 0.7768654611432476, 'auprc': 0.8515622921787628, 'loss_val': 0.6782381089573839, 'psi': 0.8067441935574537}-{'f1_val': 0.78535374542656, 'auprc': 0.8153177482069386, 'loss_val': 0.6283968948875223, 'psi': 0.7973393465387114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=83 head_norm_before_train=1.743617 cos_to_last_merge=0.8970 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.897
[S3] round=83 local utility u=0.144164 metrics={'f1_val': 0.9029080839302459, 'auprc': 0.9698998718122016, 'loss_val': 0.2449493325243843, 'psi': 0.9297047990830283}-{'f1_val': 0.8769197067843021, 'auprc': 0.9657933323760335, 'loss_val': 0.3650264908756802, 'psi': 0.9124691570209946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=83 head_norm_before_train=1.665190 cos_to_last_merge=0.9080 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=83 local utility u=0.011194 metrics={'f1_val': 0.9406750718002946, 'auprc': 0.9614359649905284, 'loss_val': 0.3170115924424825, 'psi': 0.9489794290763882}-{'f1_val': 0.940037681588385, 'auprc': 0.9557164196887158, 'loss_val': 0.31841668463275874, 'psi': 0.9463091768285172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=83 head_norm_before_train=1.543125 cos_to_last_merge=0.9118 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=83 local utility u=1.000000 metrics={'f1_val': 0.995996280939491, 'auprc': 0.99111646368089, 'loss_val': 0.1052560131811049, 'psi': 0.9940443540360506}-{'f1_val': 0.7003314862639722, 'auprc': 0.8535668554271899, 'loss_val': 0.4413634508862292, 'psi': 0.7616256339292593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=83 head_norm_before_train=1.767079 cos_to_last_merge=0.8980 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.5902669863936991, 'auprc': 0.9081952059623413, 'loss_val': 0.9640589935211248, 'psi': 0.717438274221156}-{'f1_val': 0.7561829494392218, 'auprc': 0.9404146816377542, 'loss_val': 0.5437175507006617, 'psi': 0.8298756423186348}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.861083 cos_to_last_merge=0.9784 (last merge round=24)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.5464432576623355, 'auprc': 0.7902362238500897, 'loss_val': 1.0203213177699018, 'psi': 0.6439604441374371}-{'f1_val': 0.9505281983199403, 'auprc': 0.9946530530842611, 'loss_val': 0.12861905621224867, 'psi': 0.9681781402256686}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=1.861885 cos_to_last_merge=1.0000 (last merge round=81)
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9033800831586789, 'auprc': 0.9787522410212128, 'loss_val': 0.24085180199691966, 'psi': 0.9335289463036925}-{'f1_val': 0.9930011150596958, 'auprc': 0.9854220331829707, 'loss_val': 0.03889689806065126, 'psi': 0.9899694823090057}
[S9] START round=83 head_norm_before_train=2.181820 (no previous merge yet)
[S9] round=83 local utility u=0.011217 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999067423732856, 'loss_val': 0.0181668357751742, 'psi': 0.9979590040376491}-{'f1_val': 0.9937421749897083, 'auprc': 0.9999107811707193, 'loss_val': 0.023103793708339277, 'psi': 0.9962096174621127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=83 head_norm_before_train=2.300604 (no previous merge yet)
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9958391019862538, 'loss_val': 0.02404968759984258, 'psi': 0.9953676480596059}-{'f1_val': 0.9950533454418405, 'auprc': 0.9958958042656, 'loss_val': 0.02410917255400431, 'psi': 0.9953903289713444}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=2.114249 cos_to_last_merge=0.7391 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.739
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9990372703265474, 'loss_val': 0.018210403335351566, 'psi': 0.9972951130786045}-{'f1_val': 0.9961541414107454, 'auprc': 0.9994911143832714, 'loss_val': 0.017805009261368052, 'psi': 0.9974889305997559}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.795690 cos_to_last_merge=0.7840 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.784
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.619557845281064, 'auprc': 0.6378098803736113, 'loss_val': 1.369698458839806, 'psi': 0.6268586593180829}-{'f1_val': 0.7350453230087333, 'auprc': 0.6763664118518735, 'loss_val': 1.134177571302087, 'psi': 0.7115737585459894}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=2.100572 cos_to_last_merge=0.9643 (last merge round=18)
[S14] round=83 local utility u=0.118194 metrics={'f1_val': 0.9936569488964806, 'auprc': 0.9971570781465098, 'loss_val': 0.029163881165727327, 'psi': 0.9950570005964923}-{'f1_val': 0.9587309102012667, 'auprc': 0.9971572042660218, 'loss_val': 0.05599599908466588, 'psi': 0.9741014278271687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=83 head_norm_before_train=1.864135 cos_to_last_merge=1.0000 (last merge round=81)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.8821447779793863, 'auprc': 0.9958487833413164, 'loss_val': 0.32778852283980153, 'psi': 0.9276263801241583}-{'f1_val': 0.9967466683875206, 'auprc': 0.9981893652017441, 'loss_val': 0.01944829043234817, 'psi': 0.9973237471132099}
[S16] START round=83 head_norm_before_train=2.018369 cos_to_last_merge=0.7671 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.9924624549696315, 'auprc': 0.9934488647380624, 'loss_val': 0.034348833766527496, 'psi': 0.9928570188770038}-{'f1_val': 0.9920251888873803, 'auprc': 0.9950342688959621, 'loss_val': 0.03508106880330219, 'psi': 0.9932288208908131}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=1.997614 cos_to_last_merge=0.7808 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=83 local utility u=0.158257 metrics={'f1_val': 0.8538998055596376, 'auprc': 0.9066743955646186, 'loss_val': 0.5184391356162971, 'psi': 0.87500964156163}-{'f1_val': 0.8469239209755486, 'auprc': 0.8896110052704818, 'loss_val': 0.7419085529417389, 'psi': 0.8639987546935219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=83 metric=0.8821 head_norm=1.870469
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.978324e-03
[S15] stored merged vector for next round verification (round=83)
[S15] DEBUG after merge:  round=83 metric=0.8821 head_norm=1.866172 delta_norm=0.005978
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=84 head_norm_before_train=1.759945 cos_to_last_merge=0.8636 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.864
[S2] round=84 local utility u=0.331726 metrics={'f1_val': 0.8292810730367183, 'auprc': 0.8939697377526135, 'loss_val': 0.4565015593714237, 'psi': 0.8551565389230763}-{'f1_val': 0.7768654611432476, 'auprc': 0.8515622921787628, 'loss_val': 0.6782381089573839, 'psi': 0.8067441935574537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=84 head_norm_before_train=1.749231 cos_to_last_merge=0.8963 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.896
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.8002541811365067, 'auprc': 0.9887058402759925, 'loss_val': 0.40733455604670044, 'psi': 0.875634844792301}-{'f1_val': 0.9029080839302459, 'auprc': 0.9698998718122016, 'loss_val': 0.2449493325243843, 'psi': 0.9297047990830283}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=1.671144 cos_to_last_merge=0.9072 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9410462929175942, 'auprc': 0.9561140137419805, 'loss_val': 0.31564810598494963, 'psi': 0.9470733812473487}-{'f1_val': 0.9406750718002946, 'auprc': 0.9614359649905284, 'loss_val': 0.3170115924424825, 'psi': 0.9489794290763882}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.544188 cos_to_last_merge=0.9113 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.911
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.43229601904367504, 'auprc': 0.8499093800135535, 'loss_val': 0.8498441914229551, 'psi': 0.5993413634316265}-{'f1_val': 0.995996280939491, 'auprc': 0.99111646368089, 'loss_val': 0.1052560131811049, 'psi': 0.9940443540360506}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=1.770528 cos_to_last_merge=0.8980 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=84 local utility u=1.000000 metrics={'f1_val': 0.8789646208887059, 'auprc': 0.9748958636146015, 'loss_val': 0.1998776360508258, 'psi': 0.9173371179790641}-{'f1_val': 0.5902669863936991, 'auprc': 0.9081952059623413, 'loss_val': 0.9640589935211248, 'psi': 0.717438274221156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=84 head_norm_before_train=1.861584 cos_to_last_merge=0.9784 (last merge round=24)
[S7] round=84 local utility u=1.000000 metrics={'f1_val': 0.6961063254547741, 'auprc': 0.9329784036950597, 'loss_val': 0.2530661998200697, 'psi': 0.7908551567508884}-{'f1_val': 0.5464432576623355, 'auprc': 0.7902362238500897, 'loss_val': 1.0203213177699018, 'psi': 0.6439604441374371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=84 head_norm_before_train=1.866399 cos_to_last_merge=1.0000 (last merge round=81)
[S8] round=84 local utility u=0.397287 metrics={'f1_val': 0.9943205514018633, 'auprc': 0.9919885329963188, 'loss_val': 0.03163038867704128, 'psi': 0.9933877440396455}-{'f1_val': 0.9033800831586789, 'auprc': 0.9787522410212128, 'loss_val': 0.24085180199691966, 'psi': 0.9335289463036925}
[S9] START round=84 head_norm_before_train=2.186064 (no previous merge yet)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9971688375239978, 'loss_val': 0.01806091985637074, 'psi': 0.9966175918771657}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999067423732856, 'loss_val': 0.0181668357751742, 'psi': 0.9979590040376491}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.305966 (no previous merge yet)
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.99584534430045, 'loss_val': 0.024182625786830902, 'psi': 0.9953701449852843}-{'f1_val': 0.9950533454418405, 'auprc': 0.9958391019862538, 'loss_val': 0.02404968759984258, 'psi': 0.9953676480596059}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.118373 cos_to_last_merge=0.7389 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.739
[S11] round=84 local utility u=0.002914 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9994538704106926, 'loss_val': 0.01520611573596132, 'psi': 0.9976190604827435}-{'f1_val': 0.9961336749133093, 'auprc': 0.9990372703265474, 'loss_val': 0.018210403335351566, 'psi': 0.9972951130786045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=84 head_norm_before_train=1.798668 cos_to_last_merge=0.7840 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.784
[S13] round=84 local utility u=0.345994 metrics={'f1_val': 0.6690079407760109, 'auprc': 0.6590436621284854, 'loss_val': 1.0381126255706865, 'psi': 0.6650222293170007}-{'f1_val': 0.619557845281064, 'auprc': 0.6378098803736113, 'loss_val': 1.369698458839806, 'psi': 0.6268586593180829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=84 head_norm_before_train=2.106390 cos_to_last_merge=0.9639 (last merge round=18)
[S14] round=84 local utility u=0.016858 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9971571406024673, 'loss_val': 0.02042335781431858, 'psi': 0.997554567021318}-{'f1_val': 0.9936569488964806, 'auprc': 0.9971570781465098, 'loss_val': 0.029163881165727327, 'psi': 0.9950570005964923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=84 head_norm_before_train=1.866172 cos_to_last_merge=1.0000 (last merge round=83)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.8184644094952923, 'auprc': 0.9956870376882125, 'loss_val': 0.4272832327663193, 'psi': 0.8893534607724605}-{'f1_val': 0.8821447779793863, 'auprc': 0.9958487833413164, 'loss_val': 0.32778852283980153, 'psi': 0.9276263801241583}
[S16] START round=84 head_norm_before_train=2.020560 cos_to_last_merge=0.7664 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.766
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.9930786781007594, 'auprc': 0.9920095261875371, 'loss_val': 0.034160182599854295, 'psi': 0.9926510173354706}-{'f1_val': 0.9924624549696315, 'auprc': 0.9934488647380624, 'loss_val': 0.034348833766527496, 'psi': 0.9928570188770038}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=2.003176 cos_to_last_merge=0.7802 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=84 local utility u=0.424883 metrics={'f1_val': 0.9063194173467181, 'auprc': 0.981958653786424, 'loss_val': 0.20904311900171313, 'psi': 0.9365751119226005}-{'f1_val': 0.8538998055596376, 'auprc': 0.9066743955646186, 'loss_val': 0.5184391356162971, 'psi': 0.87500964156163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=1.0000
[S2] START round=85 head_norm_before_train=1.765243 cos_to_last_merge=0.8630 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.863
[S2] round=85 local utility u=0.092681 metrics={'f1_val': 0.829994610212068, 'auprc': 0.9513599340239333, 'loss_val': 0.4475904158500077, 'psi': 0.8785407397368141}-{'f1_val': 0.8292810730367183, 'auprc': 0.8939697377526135, 'loss_val': 0.4565015593714237, 'psi': 0.8551565389230763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=85 head_norm_before_train=1.754713 cos_to_last_merge=0.8956 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.896
[S3] round=85 local utility u=0.147606 metrics={'f1_val': 0.8293994016759545, 'auprc': 0.9968348274348687, 'loss_val': 0.3113807859319402, 'psi': 0.8963735719795202}-{'f1_val': 0.8002541811365067, 'auprc': 0.9887058402759925, 'loss_val': 0.40733455604670044, 'psi': 0.875634844792301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=85 head_norm_before_train=1.675680 cos_to_last_merge=0.9066 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=85 local utility u=0.039482 metrics={'f1_val': 0.9482343135767541, 'auprc': 0.963853712617757, 'loss_val': 0.30303108441599197, 'psi': 0.9544820731931553}-{'f1_val': 0.9410462929175942, 'auprc': 0.9561140137419805, 'loss_val': 0.31564810598494963, 'psi': 0.9470733812473487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=85 head_norm_before_train=1.544322 cos_to_last_merge=0.9113 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.911
[S5] round=85 local utility u=1.000000 metrics={'f1_val': 0.8686058899527497, 'auprc': 0.9889967876777114, 'loss_val': 0.14078540157767921, 'psi': 0.9167622490427344}-{'f1_val': 0.43229601904367504, 'auprc': 0.8499093800135535, 'loss_val': 0.8498441914229551, 'psi': 0.5993413634316265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=85 head_norm_before_train=1.773610 cos_to_last_merge=0.8973 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.897
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.6261667826989243, 'auprc': 0.7069265963515999, 'loss_val': 1.1194541174512997, 'psi': 0.6584707081599945}-{'f1_val': 0.8789646208887059, 'auprc': 0.9748958636146015, 'loss_val': 0.1998776360508258, 'psi': 0.9173371179790641}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=85 head_norm_before_train=1.863337 cos_to_last_merge=0.9782 (last merge round=24)
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.5908409461869999, 'auprc': 0.7931363149725806, 'loss_val': 0.8704239273605487, 'psi': 0.6717590937012321}-{'f1_val': 0.6961063254547741, 'auprc': 0.9329784036950597, 'loss_val': 0.2530661998200697, 'psi': 0.7908551567508884}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=85 head_norm_before_train=1.868219 cos_to_last_merge=1.0000 (last merge round=81)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.992603076589802, 'auprc': 0.9836605542477255, 'loss_val': 0.03537798596659754, 'psi': 0.9890260676529714}-{'f1_val': 0.9943205514018633, 'auprc': 0.9919885329963188, 'loss_val': 0.03163038867704128, 'psi': 0.9933877440396455}
[S9] START round=85 head_norm_before_train=2.191982 (no previous merge yet)
[S9] round=85 local utility u=0.003936 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985029074970824, 'loss_val': 0.016654098584217018, 'psi': 0.9973974700871678}-{'f1_val': 0.9962500947792776, 'auprc': 0.9971688375239978, 'loss_val': 0.01806091985637074, 'psi': 0.9966175918771657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=85 head_norm_before_train=2.308464 (no previous merge yet)
[S10] round=85 local utility u=0.000768 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9963890263128368, 'loss_val': 0.024277877382901172, 'psi': 0.995587617790239}-{'f1_val': 0.9950533454418405, 'auprc': 0.99584534430045, 'loss_val': 0.024182625786830902, 'psi': 0.9953701449852843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=85 head_norm_before_train=2.118792 cos_to_last_merge=0.7385 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.738
[S11] round=85 local utility u=0.000508 metrics={'f1_val': 0.9968129605654896, 'auprc': 0.9990001073832591, 'loss_val': 0.015332298957231249, 'psi': 0.9976878192925974}-{'f1_val': 0.9963958538641108, 'auprc': 0.9994538704106926, 'loss_val': 0.01520611573596132, 'psi': 0.9976190604827435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=85 head_norm_before_train=1.801326 cos_to_last_merge=0.7839 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.784
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.6512186412956598, 'auprc': 0.6482221390734149, 'loss_val': 1.1012301553199422, 'psi': 0.6500200404067618}-{'f1_val': 0.6690079407760109, 'auprc': 0.6590436621284854, 'loss_val': 1.0381126255706865, 'psi': 0.6650222293170007}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.109334 cos_to_last_merge=0.9636 (last merge round=18)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9952064071498803, 'loss_val': 0.020393001015166733, 'psi': 0.9961508673642354}-{'f1_val': 0.9978195179672185, 'auprc': 0.9971571406024673, 'loss_val': 0.02042335781431858, 'psi': 0.997554567021318}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=1.873258 cos_to_last_merge=1.0000 (last merge round=83)
[S15] round=85 local utility u=0.645736 metrics={'f1_val': 0.9700305310795656, 'auprc': 0.9977137027305556, 'loss_val': 0.05128792787779284, 'psi': 0.9811037997399616}-{'f1_val': 0.8184644094952923, 'auprc': 0.9956870376882125, 'loss_val': 0.4272832327663193, 'psi': 0.8893534607724605}
[S16] START round=85 head_norm_before_train=2.022099 cos_to_last_merge=0.7657 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.766
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9472195304500494, 'auprc': 0.9815745284235589, 'loss_val': 0.23084107837713388, 'psi': 0.9609615296394531}-{'f1_val': 0.9930786781007594, 'auprc': 0.9920095261875371, 'loss_val': 0.034160182599854295, 'psi': 0.9926510173354706}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.010003 cos_to_last_merge=0.7793 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.779
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.8270453500475947, 'auprc': 0.935724105632326, 'loss_val': 0.5314404121560269, 'psi': 0.8705168522814872}-{'f1_val': 0.9063194173467181, 'auprc': 0.981958653786424, 'loss_val': 0.20904311900171313, 'psi': 0.9365751119226005}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33909
[S8] ⇄ pheromone p=0.102 → S15@127.0.0.1:33915
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=85 metric=0.9700 head_norm=1.880327
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.798800e-03
[S15] stored merged vector for next round verification (round=85)
[S15] DEBUG after merge:  round=85 metric=0.9705 head_norm=1.874257 delta_norm=0.009799
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.200 → S8@127.0.0.1:33909
[S2] START round=86 head_norm_before_train=1.769928 cos_to_last_merge=0.8625 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.862
[S2] round=86 local utility u=0.055589 metrics={'f1_val': 0.8275125349312289, 'auprc': 0.9915289632270898, 'loss_val': 0.44202695838076744, 'psi': 0.8931191062495732}-{'f1_val': 0.829994610212068, 'auprc': 0.9513599340239333, 'loss_val': 0.4475904158500077, 'psi': 0.8785407397368141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=86 head_norm_before_train=1.761617 cos_to_last_merge=0.8947 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.895
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.8164270680811111, 'auprc': 0.9555650629752895, 'loss_val': 0.6069601449195849, 'psi': 0.8720822660387825}-{'f1_val': 0.8293994016759545, 'auprc': 0.9968348274348687, 'loss_val': 0.3113807859319402, 'psi': 0.8963735719795202}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=1.677994 cos_to_last_merge=0.9056 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.906
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.943483134569766, 'auprc': 0.9567140456350034, 'loss_val': 0.309960005498904, 'psi': 0.9487754989958609}-{'f1_val': 0.9482343135767541, 'auprc': 0.963853712617757, 'loss_val': 0.30303108441599197, 'psi': 0.9544820731931553}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=1.545289 cos_to_last_merge=0.9111 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.911
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.6785637245206578, 'auprc': 0.8927643995199097, 'loss_val': 0.44998553340502545, 'psi': 0.7642439945203585}-{'f1_val': 0.8686058899527497, 'auprc': 0.9889967876777114, 'loss_val': 0.14078540157767921, 'psi': 0.9167622490427344}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=1.775142 cos_to_last_merge=0.8966 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.897
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.5972675309430955, 'auprc': 0.6526048747594817, 'loss_val': 1.3384748477946062, 'psi': 0.61940246846965}-{'f1_val': 0.6261667826989243, 'auprc': 0.7069265963515999, 'loss_val': 1.1194541174512997, 'psi': 0.6584707081599945}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=1.867484 cos_to_last_merge=0.9780 (last merge round=24)
[S7] round=86 local utility u=0.637437 metrics={'f1_val': 0.6941444654176159, 'auprc': 0.8361308624473063, 'loss_val': 0.3443553027862891, 'psi': 0.750939024229492}-{'f1_val': 0.5908409461869999, 'auprc': 0.7931363149725806, 'loss_val': 0.8704239273605487, 'psi': 0.6717590937012321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=86 head_norm_before_train=1.870970 cos_to_last_merge=1.0000 (last merge round=81)
[S8] round=86 local utility u=0.005660 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9837368528275523, 'loss_val': 0.03214234366931904, 'psi': 0.9898421059980289}-{'f1_val': 0.992603076589802, 'auprc': 0.9836605542477255, 'loss_val': 0.03537798596659754, 'psi': 0.9890260676529714}
[S9] START round=86 head_norm_before_train=2.198394 (no previous merge yet)
[S9] round=86 local utility u=0.002741 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9998940934081, 'loss_val': 0.016497606406959613, 'psi': 0.9980691886185944}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985029074970824, 'loss_val': 0.016654098584217018, 'psi': 0.9973974700871678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=86 head_norm_before_train=2.310241 (no previous merge yet)
[S10] round=86 local utility u=0.000036 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9963937704302237, 'loss_val': 0.024219641397462067, 'psi': 0.9955895154371939}-{'f1_val': 0.9950533454418405, 'auprc': 0.9963890263128368, 'loss_val': 0.024277877382901172, 'psi': 0.995587617790239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=86 head_norm_before_train=2.121407 cos_to_last_merge=0.7381 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.738
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9988199094189092, 'loss_val': 0.016964022304684637, 'psi': 0.9974707126348384}-{'f1_val': 0.9968129605654896, 'auprc': 0.9990001073832591, 'loss_val': 0.015332298957231249, 'psi': 0.9976878192925974}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=1.806801 cos_to_last_merge=0.7834 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.783
[S13] round=86 local utility u=0.029578 metrics={'f1_val': 0.6577815313283779, 'auprc': 0.6517242594091573, 'loss_val': 1.091958150378632, 'psi': 0.6553586225606898}-{'f1_val': 0.6512186412956598, 'auprc': 0.6482221390734149, 'loss_val': 1.1012301553199422, 'psi': 0.6500200404067618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=86 head_norm_before_train=2.110717 cos_to_last_merge=0.9635 (last merge round=18)
[S14] round=86 local utility u=0.002098 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9963964210044499, 'loss_val': 0.021088888208974133, 'psi': 0.9967589963303267}-{'f1_val': 0.9967805075071389, 'auprc': 0.9952064071498803, 'loss_val': 0.020393001015166733, 'psi': 0.9961508673642354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=86 head_norm_before_train=1.874257 cos_to_last_merge=1.0000 (last merge round=85)
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.9327023952328081, 'auprc': 0.9975102692348101, 'loss_val': 0.1094484813235908, 'psi': 0.958625544833609}-{'f1_val': 0.9700305310795656, 'auprc': 0.9977137027305556, 'loss_val': 0.05128792787779284, 'psi': 0.9811037997399616}
[S16] START round=86 head_norm_before_train=2.024305 cos_to_last_merge=0.7650 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.765
[S16] round=86 local utility u=0.219524 metrics={'f1_val': 0.9882982913270448, 'auprc': 0.9874858654747547, 'loss_val': 0.05599914281755662, 'psi': 0.9879733209861288}-{'f1_val': 0.9472195304500494, 'auprc': 0.9815745284235589, 'loss_val': 0.23084107837713388, 'psi': 0.9609615296394531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=86 head_norm_before_train=2.018207 cos_to_last_merge=0.7784 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=86 local utility u=0.120994 metrics={'f1_val': 0.8662922112873839, 'auprc': 0.9386185109425587, 'loss_val': 0.5336173135098689, 'psi': 0.8952227311494538}-{'f1_val': 0.8270453500475947, 'auprc': 0.935724105632326, 'loss_val': 0.5314404121560269, 'psi': 0.8705168522814872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=86 metric=0.9939 head_norm=1.875054
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.149898e-02
[S8] stored merged vector for next round verification (round=86)
[S8] DEBUG after merge:  round=86 metric=0.9939 head_norm=1.877657 delta_norm=0.011499
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=87 head_norm_before_train=1.775636 cos_to_last_merge=0.8617 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.862
[S2] round=87 local utility u=0.000808 metrics={'f1_val': 0.8275445089016625, 'auprc': 0.9914633480392452, 'loss_val': 0.4404059795173553, 'psi': 0.8931120445566956}-{'f1_val': 0.8275125349312289, 'auprc': 0.9915289632270898, 'loss_val': 0.44202695838076744, 'psi': 0.8931191062495732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=87 head_norm_before_train=1.766909 cos_to_last_merge=0.8940 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.894
[S3] round=87 local utility u=0.891494 metrics={'f1_val': 0.9941033510040047, 'auprc': 0.9997850929741818, 'loss_val': 0.02268944642475537, 'psi': 0.9963760477920756}-{'f1_val': 0.8164270680811111, 'auprc': 0.9555650629752895, 'loss_val': 0.6069601449195849, 'psi': 0.8720822660387825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=87 head_norm_before_train=1.679322 cos_to_last_merge=0.9049 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9416152285182915, 'auprc': 0.9608371523591086, 'loss_val': 0.31556996685584016, 'psi': 0.9493039980546183}-{'f1_val': 0.943483134569766, 'auprc': 0.9567140456350034, 'loss_val': 0.309960005498904, 'psi': 0.9487754989958609}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.548622 cos_to_last_merge=0.9109 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.911
[S5] round=87 local utility u=1.000000 metrics={'f1_val': 0.9746713248612401, 'auprc': 0.9913583341579115, 'loss_val': 0.10966036774673388, 'psi': 0.9813461285799087}-{'f1_val': 0.6785637245206578, 'auprc': 0.8927643995199097, 'loss_val': 0.44998553340502545, 'psi': 0.7642439945203585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=87 head_norm_before_train=1.776408 cos_to_last_merge=0.8956 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.896
[S6] round=87 local utility u=1.000000 metrics={'f1_val': 0.9543446026374235, 'auprc': 0.9039258413168825, 'loss_val': 0.2653123359520617, 'psi': 0.934177098109207}-{'f1_val': 0.5972675309430955, 'auprc': 0.6526048747594817, 'loss_val': 1.3384748477946062, 'psi': 0.61940246846965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=87 head_norm_before_train=1.876490 cos_to_last_merge=0.9773 (last merge round=24)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.6596743269661124, 'auprc': 0.8154876880894438, 'loss_val': 0.4787940134305256, 'psi': 0.721999671415445}-{'f1_val': 0.6941444654176159, 'auprc': 0.8361308624473063, 'loss_val': 0.3443553027862891, 'psi': 0.750939024229492}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=1.877657 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=87 local utility u=0.011326 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.9941676871466186, 'loss_val': 0.03425533426430031, 'psi': 0.9933617131292619}-{'f1_val': 0.9939122747783468, 'auprc': 0.9837368528275523, 'loss_val': 0.03214234366931904, 'psi': 0.9898421059980289}
[S9] START round=87 head_norm_before_train=2.203783 (no previous merge yet)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9999214536916881, 'loss_val': 0.023667574259004242, 'psi': 0.9963322090750835}-{'f1_val': 0.9968525854255906, 'auprc': 0.9998940934081, 'loss_val': 0.016497606406959613, 'psi': 0.9980691886185944}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.313915 (no previous merge yet)
[S10] round=87 local utility u=0.000056 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9963848509089366, 'loss_val': 0.024080309728437225, 'psi': 0.995585947628679}-{'f1_val': 0.9950533454418405, 'auprc': 0.9963937704302237, 'loss_val': 0.024219641397462067, 'psi': 0.9955895154371939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=87 head_norm_before_train=2.125672 cos_to_last_merge=0.7379 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.738
[S11] round=87 local utility u=0.000008 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9989372032970292, 'loss_val': 0.017300780915009938, 'psi': 0.9975176301860864}-{'f1_val': 0.9965712481121245, 'auprc': 0.9988199094189092, 'loss_val': 0.016964022304684637, 'psi': 0.9974707126348384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=87 head_norm_before_train=1.816691 cos_to_last_merge=0.7828 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.783
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.61412881783441, 'auprc': 0.6301700136513596, 'loss_val': 1.3626021269530135, 'psi': 0.6205452961611899}-{'f1_val': 0.6577815313283779, 'auprc': 0.6517242594091573, 'loss_val': 1.091958150378632, 'psi': 0.6553586225606898}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=2.107434 cos_to_last_merge=0.9635 (last merge round=18)
[S14] round=87 local utility u=0.003822 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9988529458668798, 'loss_val': 0.020662239918258454, 'psi': 0.9977264783970178}-{'f1_val': 0.9970007132142444, 'auprc': 0.9963964210044499, 'loss_val': 0.021088888208974133, 'psi': 0.9967589963303267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=87 head_norm_before_train=1.880706 cos_to_last_merge=1.0000 (last merge round=85)
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.8133613404692709, 'auprc': 0.9916012054063126, 'loss_val': 0.35389006045242116, 'psi': 0.8846572864440876}-{'f1_val': 0.9327023952328081, 'auprc': 0.9975102692348101, 'loss_val': 0.1094484813235908, 'psi': 0.958625544833609}
[S16] START round=87 head_norm_before_train=2.027149 cos_to_last_merge=0.7644 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.764
[S16] round=87 local utility u=0.031223 metrics={'f1_val': 0.9924904121990616, 'auprc': 0.9928603236115463, 'loss_val': 0.034829816698741446, 'psi': 0.9926383767640555}-{'f1_val': 0.9882982913270448, 'auprc': 0.9874858654747547, 'loss_val': 0.05599914281755662, 'psi': 0.9879733209861288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=87 head_norm_before_train=2.025559 cos_to_last_merge=0.7776 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.8177523921787886, 'auprc': 0.8790240388268231, 'loss_val': 1.0028165950070036, 'psi': 0.8422610508380024}-{'f1_val': 0.8662922112873839, 'auprc': 0.9386185109425587, 'loss_val': 0.5336173135098689, 'psi': 0.8952227311494538}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:33915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=87 metric=0.8134 head_norm=1.886734
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.176286e-02
[S15] stored merged vector for next round verification (round=87)
[S15] DEBUG after merge:  round=87 metric=0.8142 head_norm=1.880867 delta_norm=0.011763
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1805) from S8
[S15] cosine check vs S8: cos=1.0000
[S2] START round=88 head_norm_before_train=1.781616 cos_to_last_merge=0.8610 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=88 local utility u=0.003935 metrics={'f1_val': 0.8275305527079129, 'auprc': 0.9908724072182247, 'loss_val': 0.4306800798537218, 'psi': 0.8928672945120375}-{'f1_val': 0.8275445089016625, 'auprc': 0.9914633480392452, 'loss_val': 0.4404059795173553, 'psi': 0.8931120445566956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=88 head_norm_before_train=1.773269 cos_to_last_merge=0.8930 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.893
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9794772000790726, 'auprc': 0.998805337889604, 'loss_val': 0.0539147849926863, 'psi': 0.9872084552032852}-{'f1_val': 0.9941033510040047, 'auprc': 0.9997850929741818, 'loss_val': 0.02268944642475537, 'psi': 0.9963760477920756}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=1.683068 cos_to_last_merge=0.9042 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.904
[S4] round=88 local utility u=0.019524 metrics={'f1_val': 0.9421203986392641, 'auprc': 0.9713909395401292, 'loss_val': 0.3112153309522093, 'psi': 0.9538286149996101}-{'f1_val': 0.9416152285182915, 'auprc': 0.9608371523591086, 'loss_val': 0.31556996685584016, 'psi': 0.9493039980546183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=88 head_norm_before_train=1.551322 cos_to_last_merge=0.9106 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.911
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9579864804576768, 'loss_val': 0.38522371993066995, 'psi': 0.803542444492994}-{'f1_val': 0.9746713248612401, 'auprc': 0.9913583341579115, 'loss_val': 0.10966036774673388, 'psi': 0.9813461285799087}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=1.777846 cos_to_last_merge=0.8952 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.895
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.7084819561252929, 'auprc': 0.8988986159010748, 'loss_val': 0.8083582370850949, 'psi': 0.7846486200356055}-{'f1_val': 0.9543446026374235, 'auprc': 0.9039258413168825, 'loss_val': 0.2653123359520617, 'psi': 0.934177098109207}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.883288 cos_to_last_merge=0.9768 (last merge round=24)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.5551130051202913, 'auprc': 0.7892614568011822, 'loss_val': 1.1199598427316344, 'psi': 0.6487723857926477}-{'f1_val': 0.6596743269661124, 'auprc': 0.8154876880894438, 'loss_val': 0.4787940134305256, 'psi': 0.721999671415445}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=1.881987 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.8860021065751852, 'auprc': 0.9854326032401342, 'loss_val': 0.26719329943424663, 'psi': 0.9257743052411648}-{'f1_val': 0.9928243971176908, 'auprc': 0.9941676871466186, 'loss_val': 0.03425533426430031, 'psi': 0.9933617131292619}
[S9] START round=88 head_norm_before_train=2.205999 (no previous merge yet)
[S9] round=88 local utility u=0.011284 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9997039426800268, 'loss_val': 0.016772989839443926, 'psi': 0.9978778841603456}-{'f1_val': 0.9939393793306803, 'auprc': 0.9999214536916881, 'loss_val': 0.023667574259004242, 'psi': 0.9963322090750835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=88 head_norm_before_train=2.318630 (no previous merge yet)
[S10] round=88 local utility u=0.000040 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9963883964161545, 'loss_val': 0.02401126966292001, 'psi': 0.9955873658315662}-{'f1_val': 0.9950533454418405, 'auprc': 0.9963848509089366, 'loss_val': 0.024080309728437225, 'psi': 0.995585947628679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=88 head_norm_before_train=2.130791 cos_to_last_merge=0.7376 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.738
[S11] round=88 local utility u=0.000612 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.999140713207789, 'loss_val': 0.01668671337597263, 'psi': 0.9975990341503903}-{'f1_val': 0.9965712481121245, 'auprc': 0.9989372032970292, 'loss_val': 0.017300780915009938, 'psi': 0.9975176301860864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=88 head_norm_before_train=1.826060 cos_to_last_merge=0.7820 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.782
[S13] round=88 local utility u=0.769693 metrics={'f1_val': 0.7021734832058257, 'auprc': 0.7844931826401185, 'loss_val': 0.8144526712304535, 'psi': 0.7351013629795429}-{'f1_val': 0.61412881783441, 'auprc': 0.6301700136513596, 'loss_val': 1.3626021269530135, 'psi': 0.6205452961611899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=88 head_norm_before_train=2.107683 cos_to_last_merge=0.9634 (last merge round=18)
[S14] round=88 local utility u=0.000000 metrics={'f1_val': 0.9944935406943898, 'auprc': 0.996119447892651, 'loss_val': 0.03428420698665704, 'psi': 0.9951439035736943}-{'f1_val': 0.9969755000837764, 'auprc': 0.9988529458668798, 'loss_val': 0.020662239918258454, 'psi': 0.9977264783970178}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=88 head_norm_before_train=1.880867 cos_to_last_merge=1.0000 (last merge round=87)
[S15] round=88 local utility u=0.160451 metrics={'f1_val': 0.8697621527487749, 'auprc': 0.9898645830241648, 'loss_val': 0.3661826737921878, 'psi': 0.9178031248589308}-{'f1_val': 0.8133613404692709, 'auprc': 0.9916012054063126, 'loss_val': 0.35389006045242116, 'psi': 0.8846572864440876}
[S16] START round=88 head_norm_before_train=2.030513 cos_to_last_merge=0.7640 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.764
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.9924904121990616, 'auprc': 0.9921044716249607, 'loss_val': 0.03481612719862531, 'psi': 0.9923360359694213}-{'f1_val': 0.9924904121990616, 'auprc': 0.9928603236115463, 'loss_val': 0.034829816698741446, 'psi': 0.9926383767640555}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=2.032757 cos_to_last_merge=0.7766 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=88 local utility u=0.079254 metrics={'f1_val': 0.8315745243330039, 'auprc': 0.8710434137403205, 'loss_val': 0.9032998042738042, 'psi': 0.8473620800959305}-{'f1_val': 0.8177523921787886, 'auprc': 0.8790240388268231, 'loss_val': 1.0028165950070036, 'psi': 0.8422610508380024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=88 metric=0.8698 head_norm=1.886198
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.478534e-03
[S15] stored merged vector for next round verification (round=88)
[S15] DEBUG after merge:  round=88 metric=0.8698 head_norm=1.884090 delta_norm=0.003479
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=89 head_norm_before_train=1.784167 cos_to_last_merge=0.8611 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.8297689209527751, 'auprc': 0.9471319495099264, 'loss_val': 0.4550148466237103, 'psi': 0.8767141323756356}-{'f1_val': 0.8275305527079129, 'auprc': 0.9908724072182247, 'loss_val': 0.4306800798537218, 'psi': 0.8928672945120375}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=1.778340 cos_to_last_merge=0.8920 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.892
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.8929525119465711, 'auprc': 0.9674228897899313, 'loss_val': 0.3123433103185517, 'psi': 0.9227406630839152}-{'f1_val': 0.9794772000790726, 'auprc': 0.998805337889604, 'loss_val': 0.0539147849926863, 'psi': 0.9872084552032852}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=1.687503 cos_to_last_merge=0.9037 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.904
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9393841730078387, 'auprc': 0.9566209887890992, 'loss_val': 0.32684358607522973, 'psi': 0.9462788993203429}-{'f1_val': 0.9421203986392641, 'auprc': 0.9713909395401292, 'loss_val': 0.3112153309522093, 'psi': 0.9538286149996101}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.555644 cos_to_last_merge=0.9099 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.910
[S5] round=89 local utility u=0.643671 metrics={'f1_val': 0.8620757087055153, 'auprc': 0.9900448441867566, 'loss_val': 0.16303235111029935, 'psi': 0.9132633628980118}-{'f1_val': 0.7005797538498719, 'auprc': 0.9579864804576768, 'loss_val': 0.38522371993066995, 'psi': 0.803542444492994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=89 head_norm_before_train=1.781183 cos_to_last_merge=0.8949 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.895
[S6] round=89 local utility u=0.715326 metrics={'f1_val': 0.8528114095926429, 'auprc': 0.9396427557412562, 'loss_val': 0.365914884116234, 'psi': 0.8875439480520882}-{'f1_val': 0.7084819561252929, 'auprc': 0.8988986159010748, 'loss_val': 0.8083582370850949, 'psi': 0.7846486200356055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=89 head_norm_before_train=1.887483 cos_to_last_merge=0.9765 (last merge round=24)
[S7] round=89 local utility u=1.000000 metrics={'f1_val': 0.7497806909861291, 'auprc': 0.9725952759171738, 'loss_val': 0.19150769501989576, 'psi': 0.838906524958547}-{'f1_val': 0.5551130051202913, 'auprc': 0.7892614568011822, 'loss_val': 1.1199598427316344, 'psi': 0.6487723857926477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=89 head_norm_before_train=1.887687 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=89 local utility u=0.450289 metrics={'f1_val': 0.9928666440433099, 'auprc': 0.9945214827457828, 'loss_val': 0.03506941594439622, 'psi': 0.993528579524299}-{'f1_val': 0.8860021065751852, 'auprc': 0.9854326032401342, 'loss_val': 0.26719329943424663, 'psi': 0.9257743052411648}
[S9] START round=89 head_norm_before_train=2.208068 (no previous merge yet)
[S9] round=89 local utility u=0.000663 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.999875753764906, 'loss_val': 0.015961493366456483, 'psi': 0.9979466085942973}-{'f1_val': 0.9966605118138915, 'auprc': 0.9997039426800268, 'loss_val': 0.016772989839443926, 'psi': 0.9978778841603456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=89 head_norm_before_train=2.322720 (no previous merge yet)
[S10] round=89 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9964308481935774, 'loss_val': 0.024255520869693344, 'psi': 0.9956043465425353}-{'f1_val': 0.9950533454418405, 'auprc': 0.9963883964161545, 'loss_val': 0.02401126966292001, 'psi': 0.9955873658315662}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=89 head_norm_before_train=2.133499 cos_to_last_merge=0.7372 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.737
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9994669439260079, 'loss_val': 0.01566413809790248, 'psi': 0.9974792624168504}-{'f1_val': 0.9965712481121245, 'auprc': 0.999140713207789, 'loss_val': 0.01668671337597263, 'psi': 0.9975990341503903}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=1.830066 cos_to_last_merge=0.7818 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.782
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6198339194916711, 'auprc': 0.6373782551530034, 'loss_val': 1.3132479303578768, 'psi': 0.626851653756204}-{'f1_val': 0.7021734832058257, 'auprc': 0.7844931826401185, 'loss_val': 0.8144526712304535, 'psi': 0.7351013629795429}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=2.110869 cos_to_last_merge=0.9633 (last merge round=18)
[S14] round=89 local utility u=0.016477 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9971567345788535, 'loss_val': 0.024398028403336932, 'psi': 0.9975544046118724}-{'f1_val': 0.9944935406943898, 'auprc': 0.996119447892651, 'loss_val': 0.03428420698665704, 'psi': 0.9951439035736943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=89 head_norm_before_train=1.884090 cos_to_last_merge=1.0000 (last merge round=88)
[S15] round=89 local utility u=0.498702 metrics={'f1_val': 0.9887702315776579, 'auprc': 0.9871368140194545, 'loss_val': 0.07464462314651175, 'psi': 0.9881168645543765}-{'f1_val': 0.8697621527487749, 'auprc': 0.9898645830241648, 'loss_val': 0.3661826737921878, 'psi': 0.9178031248589308}
[S16] START round=89 head_norm_before_train=2.032943 cos_to_last_merge=0.7635 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.763
[S16] round=89 local utility u=0.002411 metrics={'f1_val': 0.9924904121990616, 'auprc': 0.9936698413454442, 'loss_val': 0.03469033768943822, 'psi': 0.9929621838576147}-{'f1_val': 0.9924904121990616, 'auprc': 0.9921044716249607, 'loss_val': 0.03481612719862531, 'psi': 0.9923360359694213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=89 head_norm_before_train=2.040956 cos_to_last_merge=0.7759 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=89 local utility u=0.595084 metrics={'f1_val': 0.9079211794771217, 'auprc': 0.9625715750726775, 'loss_val': 0.44579634685391184, 'psi': 0.9297813377153441}-{'f1_val': 0.8315745243330039, 'auprc': 0.8710434137403205, 'loss_val': 0.9032998042738042, 'psi': 0.8473620800959305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=89 metric=0.9888 head_norm=1.889554
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.282822e-03
[S15] stored merged vector for next round verification (round=89)
[S15] DEBUG after merge:  round=89 metric=0.9888 head_norm=1.890591 delta_norm=0.006283
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=89 metric=0.9929 head_norm=1.891649
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.359197e-03
[S8] stored merged vector for next round verification (round=89)
[S8] DEBUG after merge:  round=89 metric=0.9929 head_norm=1.889752 delta_norm=0.006359
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=90 head_norm_before_train=1.787222 cos_to_last_merge=0.8610 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.6922211511691264, 'auprc': 0.832194309602357, 'loss_val': 1.119316974368708, 'psi': 0.7482104145424187}-{'f1_val': 0.8297689209527751, 'auprc': 0.9471319495099264, 'loss_val': 0.4550148466237103, 'psi': 0.8767141323756356}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=1.783960 cos_to_last_merge=0.8912 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.891
[S3] round=90 local utility u=0.192334 metrics={'f1_val': 0.9270393891242856, 'auprc': 0.9837554223464616, 'loss_val': 0.18119339466831202, 'psi': 0.9497258024131561}-{'f1_val': 0.8929525119465711, 'auprc': 0.9674228897899313, 'loss_val': 0.3123433103185517, 'psi': 0.9227406630839152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=90 head_norm_before_train=1.690346 cos_to_last_merge=0.9034 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=90 local utility u=0.010414 metrics={'f1_val': 0.9410932497004395, 'auprc': 0.9571369398475946, 'loss_val': 0.3178172783986202, 'psi': 0.9475107257593016}-{'f1_val': 0.9393841730078387, 'auprc': 0.9566209887890992, 'loss_val': 0.32684358607522973, 'psi': 0.9462788993203429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=90 head_norm_before_train=1.559563 cos_to_last_merge=0.9092 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.909
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.7064956179578774, 'auprc': 0.9532221878627225, 'loss_val': 0.3310940145288224, 'psi': 0.8051862459198155}-{'f1_val': 0.8620757087055153, 'auprc': 0.9900448441867566, 'loss_val': 0.16303235111029935, 'psi': 0.9132633628980118}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=1.784368 cos_to_last_merge=0.8945 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.895
[S6] round=90 local utility u=0.115287 metrics={'f1_val': 0.8685295035954641, 'auprc': 0.9642956330355604, 'loss_val': 0.30360779325168724, 'psi': 0.9068359553715026}-{'f1_val': 0.8528114095926429, 'auprc': 0.9396427557412562, 'loss_val': 0.365914884116234, 'psi': 0.8875439480520882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=90 head_norm_before_train=1.890029 cos_to_last_merge=0.9761 (last merge round=24)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.5874048716986802, 'auprc': 0.7982899152922884, 'loss_val': 0.7332554350013686, 'psi': 0.6717588891361235}-{'f1_val': 0.7497806909861291, 'auprc': 0.9725952759171738, 'loss_val': 0.19150769501989576, 'psi': 0.838906524958547}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=1.889752 cos_to_last_merge=1.0000 (last merge round=89)
[S8] round=90 local utility u=0.003261 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9942501242471137, 'loss_val': 0.032538833214097417, 'psi': 0.993900637509985}-{'f1_val': 0.9928666440433099, 'auprc': 0.9945214827457828, 'loss_val': 0.03506941594439622, 'psi': 0.993528579524299}
[S9] START round=90 head_norm_before_train=2.211794 (no previous merge yet)
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9998551671350973, 'loss_val': 0.019058077946842295, 'psi': 0.9966885755496058}-{'f1_val': 0.9966605118138915, 'auprc': 0.999875753764906, 'loss_val': 0.015961493366456483, 'psi': 0.9979466085942973}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.323573 (no previous merge yet)
[S10] round=90 local utility u=0.000029 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9964453006143711, 'loss_val': 0.024240399640368223, 'psi': 0.9956101275108528}-{'f1_val': 0.9950533454418405, 'auprc': 0.9964308481935774, 'loss_val': 0.024255520869693344, 'psi': 0.9956043465425353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=90 head_norm_before_train=2.136540 cos_to_last_merge=0.7368 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.737
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9994713214246636, 'loss_val': 0.015869301985255876, 'psi': 0.9974810134163127}-{'f1_val': 0.9961541414107454, 'auprc': 0.9994669439260079, 'loss_val': 0.01566413809790248, 'psi': 0.9974792624168504}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=1.832729 cos_to_last_merge=0.7815 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.782
[S13] round=90 local utility u=0.335604 metrics={'f1_val': 0.6147642629308866, 'auprc': 0.8315795621552822, 'loss_val': 1.194225675203366, 'psi': 0.7014903826206449}-{'f1_val': 0.6198339194916711, 'auprc': 0.6373782551530034, 'loss_val': 1.3132479303578768, 'psi': 0.626851653756204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=90 head_norm_before_train=2.116843 cos_to_last_merge=0.9631 (last merge round=18)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9953280742010686, 'auprc': 0.9971568056546151, 'loss_val': 0.028509603097455417, 'psi': 0.9960595667824872}-{'f1_val': 0.9978195179672185, 'auprc': 0.9971567345788535, 'loss_val': 0.024398028403336932, 'psi': 0.9975544046118724}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=1.890591 cos_to_last_merge=1.0000 (last merge round=89)
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9087597892713959, 'auprc': 0.9972890722044334, 'loss_val': 0.19167471618116538, 'psi': 0.9441715024446109}-{'f1_val': 0.9887702315776579, 'auprc': 0.9871368140194545, 'loss_val': 0.07464462314651175, 'psi': 0.9881168645543765}
[S16] START round=90 head_norm_before_train=2.037450 cos_to_last_merge=0.7632 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.763
[S16] round=90 local utility u=0.001337 metrics={'f1_val': 0.9924904121990616, 'auprc': 0.9944946331042952, 'loss_val': 0.03449082706685939, 'psi': 0.9932921005611551}-{'f1_val': 0.9924904121990616, 'auprc': 0.9936698413454442, 'loss_val': 0.03469033768943822, 'psi': 0.9929621838576147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=90 head_norm_before_train=2.049602 cos_to_last_merge=0.7754 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.8522923551136967, 'auprc': 0.9185058049147042, 'loss_val': 0.5831869582062829, 'psi': 0.8787777350340997}-{'f1_val': 0.9079211794771217, 'auprc': 0.9625715750726775, 'loss_val': 0.44579634685391184, 'psi': 0.9297813377153441}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:33915
[S15] ⇄ pheromone p=0.166 → S8@127.0.0.1:33909
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] ⇄ pheromone p=0.108 → S15@127.0.0.1:33915
[S2] START round=91 head_norm_before_train=1.790167 cos_to_last_merge=0.8609 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=91 local utility u=0.875552 metrics={'f1_val': 0.8254069973743181, 'auprc': 0.9313964917015842, 'loss_val': 0.4649345792590137, 'psi': 0.8678027951052245}-{'f1_val': 0.6922211511691264, 'auprc': 0.832194309602357, 'loss_val': 1.119316974368708, 'psi': 0.7482104145424187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=91 head_norm_before_train=1.788883 cos_to_last_merge=0.8904 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.890
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.8521762137156624, 'auprc': 0.9895740199608808, 'loss_val': 0.31502845379428807, 'psi': 0.9071353362137498}-{'f1_val': 0.9270393891242856, 'auprc': 0.9837554223464616, 'loss_val': 0.18119339466831202, 'psi': 0.9497258024131561}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=1.690275 cos_to_last_merge=0.9028 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=91 local utility u=0.052490 metrics={'f1_val': 0.9521725220853418, 'auprc': 0.9649351978734767, 'loss_val': 0.30270766763853635, 'psi': 0.9572775924005956}-{'f1_val': 0.9410932497004395, 'auprc': 0.9571369398475946, 'loss_val': 0.3178172783986202, 'psi': 0.9475107257593016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=91 head_norm_before_train=1.563856 cos_to_last_merge=0.9082 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.908
[S5] round=91 local utility u=0.196366 metrics={'f1_val': 0.775839176707997, 'auprc': 0.9451213818607695, 'loss_val': 0.3301216283849778, 'psi': 0.843552058769106}-{'f1_val': 0.7064956179578774, 'auprc': 0.9532221878627225, 'loss_val': 0.3310940145288224, 'psi': 0.8051862459198155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=91 head_norm_before_train=1.787783 cos_to_last_merge=0.8941 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.6495264735299854, 'auprc': 0.9213807433760994, 'loss_val': 0.827970307468643, 'psi': 0.7582681814684311}-{'f1_val': 0.8685295035954641, 'auprc': 0.9642956330355604, 'loss_val': 0.30360779325168724, 'psi': 0.9068359553715026}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=1.891661 cos_to_last_merge=0.9759 (last merge round=24)
[S7] round=91 local utility u=1.000000 metrics={'f1_val': 0.8177517034975779, 'auprc': 0.9476464720794926, 'loss_val': 0.2545168835157241, 'psi': 0.8697096109303437}-{'f1_val': 0.5874048716986802, 'auprc': 0.7982899152922884, 'loss_val': 0.7332554350013686, 'psi': 0.6717588891361235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=91 head_norm_before_train=1.892614 cos_to_last_merge=1.0000 (last merge round=89)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9846114551120471, 'auprc': 0.9911656492172072, 'loss_val': 0.055170584146347415, 'psi': 0.9872331327541111}-{'f1_val': 0.9936676463518993, 'auprc': 0.9942501242471137, 'loss_val': 0.032538833214097417, 'psi': 0.993900637509985}
[S9] START round=91 head_norm_before_train=2.215945 (no previous merge yet)
[S9] round=91 local utility u=0.000457 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9998582428432229, 'loss_val': 0.01815274373604446, 'psi': 0.9966898058328559}-{'f1_val': 0.9945775144926113, 'auprc': 0.9998551671350973, 'loss_val': 0.019058077946842295, 'psi': 0.9966885755496058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=91 head_norm_before_train=2.326807 (no previous merge yet)
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9964601951104857, 'loss_val': 0.024290232129226413, 'psi': 0.9956160853092986}-{'f1_val': 0.9950533454418405, 'auprc': 0.9964453006143711, 'loss_val': 0.024240399640368223, 'psi': 0.9956101275108528}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=2.140805 cos_to_last_merge=0.7365 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.737
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9994778540273681, 'loss_val': 0.016133152098836673, 'psi': 0.9974836264573945}-{'f1_val': 0.9961541414107454, 'auprc': 0.9994713214246636, 'loss_val': 0.015869301985255876, 'psi': 0.9974810134163127}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=1.835678 cos_to_last_merge=0.7810 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.781
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6233461403881998, 'auprc': 0.6317511986081289, 'loss_val': 1.2442437125212604, 'psi': 0.6267081636761714}-{'f1_val': 0.6147642629308866, 'auprc': 0.8315795621552822, 'loss_val': 1.194225675203366, 'psi': 0.7014903826206449}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=2.118326 cos_to_last_merge=0.9630 (last merge round=18)
[S14] round=91 local utility u=0.010110 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.997157023105721, 'loss_val': 0.02323881999742262, 'psi': 0.9975545200226195}-{'f1_val': 0.9953280742010686, 'auprc': 0.9971568056546151, 'loss_val': 0.028509603097455417, 'psi': 0.9960595667824872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=91 head_norm_before_train=1.896414 cos_to_last_merge=1.0000 (last merge round=89)
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.8382265938494534, 'auprc': 0.9958440923920167, 'loss_val': 0.3756105449287672, 'psi': 0.9012735932664787}-{'f1_val': 0.9087597892713959, 'auprc': 0.9972890722044334, 'loss_val': 0.19167471618116538, 'psi': 0.9441715024446109}
[S16] START round=91 head_norm_before_train=2.040112 cos_to_last_merge=0.7626 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.763
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9924686739525787, 'auprc': 0.9935308678363074, 'loss_val': 0.035423550989361355, 'psi': 0.9928935515060702}-{'f1_val': 0.9924904121990616, 'auprc': 0.9944946331042952, 'loss_val': 0.03449082706685939, 'psi': 0.9932921005611551}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.058068 cos_to_last_merge=0.7750 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.7241997039206964, 'auprc': 0.88033148400729, 'loss_val': 0.9311707633525229, 'psi': 0.7866524159553339}-{'f1_val': 0.8522923551136967, 'auprc': 0.9185058049147042, 'loss_val': 0.5831869582062829, 'psi': 0.8787777350340997}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=91 metric=0.8382 head_norm=1.901852
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.369399e-03
[S15] stored merged vector for next round verification (round=91)
[S15] DEBUG after merge:  round=91 metric=0.8375 head_norm=1.897220 delta_norm=0.008369
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=92 head_norm_before_train=1.793194 cos_to_last_merge=0.8609 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.8323353096909538, 'auprc': 0.8962425040940897, 'loss_val': 0.4064754869259599, 'psi': 0.8578981874522081}-{'f1_val': 0.8254069973743181, 'auprc': 0.9313964917015842, 'loss_val': 0.4649345792590137, 'psi': 0.8678027951052245}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=1.794292 cos_to_last_merge=0.8896 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.890
[S3] round=92 local utility u=0.106103 metrics={'f1_val': 0.873740016770782, 'auprc': 0.994169665761401, 'loss_val': 0.24599210137325525, 'psi': 0.9219118763670295}-{'f1_val': 0.8521762137156624, 'auprc': 0.9895740199608808, 'loss_val': 0.31502845379428807, 'psi': 0.9071353362137498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=92 head_norm_before_train=1.690917 cos_to_last_merge=0.9021 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.902
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9475789215757643, 'auprc': 0.9566766181585913, 'loss_val': 0.31058906845080575, 'psi': 0.951218000208895}-{'f1_val': 0.9521725220853418, 'auprc': 0.9649351978734767, 'loss_val': 0.30270766763853635, 'psi': 0.9572775924005956}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=1.569145 cos_to_last_merge=0.9071 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.907
[S5] round=92 local utility u=0.845409 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.991455745942658, 'loss_val': 0.0995174428217645, 'psi': 0.9942069648813863}-{'f1_val': 0.775839176707997, 'auprc': 0.9451213818607695, 'loss_val': 0.3301216283849778, 'psi': 0.843552058769106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=92 head_norm_before_train=1.793008 cos_to_last_merge=0.8936 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=92 local utility u=1.000000 metrics={'f1_val': 0.8837573868755582, 'auprc': 0.9833296580721784, 'loss_val': 0.23891895523212353, 'psi': 0.9235862953542062}-{'f1_val': 0.6495264735299854, 'auprc': 0.9213807433760994, 'loss_val': 0.827970307468643, 'psi': 0.7582681814684311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=92 head_norm_before_train=1.894558 cos_to_last_merge=0.9756 (last merge round=24)
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.5450202354342003, 'auprc': 0.7849077780827209, 'loss_val': 1.0959787710849775, 'psi': 0.6409752524936085}-{'f1_val': 0.8177517034975779, 'auprc': 0.9476464720794926, 'loss_val': 0.2545168835157241, 'psi': 0.8697096109303437}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=1.896651 cos_to_last_merge=1.0000 (last merge round=89)
[S8] round=92 local utility u=0.040971 metrics={'f1_val': 0.9928243971176908, 'auprc': 0.995563782940232, 'loss_val': 0.0356998402514973, 'psi': 0.9939201514467072}-{'f1_val': 0.9846114551120471, 'auprc': 0.9911656492172072, 'loss_val': 0.055170584146347415, 'psi': 0.9872331327541111}
[S9] START round=92 head_norm_before_train=2.219782 (no previous merge yet)
[S9] round=92 local utility u=0.007717 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9998530668030221, 'loss_val': 0.015200380514916345, 'psi': 0.9979375338095438}-{'f1_val': 0.9945775144926113, 'auprc': 0.9998582428432229, 'loss_val': 0.01815274373604446, 'psi': 0.9966898058328559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=92 head_norm_before_train=2.330205 (no previous merge yet)
[S10] round=92 local utility u=0.000030 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9965285433697545, 'loss_val': 0.024434423128383353, 'psi': 0.9956434246130061}-{'f1_val': 0.9950533454418405, 'auprc': 0.9964601951104857, 'loss_val': 0.024290232129226413, 'psi': 0.9956160853092986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=92 head_norm_before_train=2.145564 cos_to_last_merge=0.7363 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.736
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9994866529351061, 'loss_val': 0.016413916354941032, 'psi': 0.9974871460204897}-{'f1_val': 0.9961541414107454, 'auprc': 0.9994778540273681, 'loss_val': 0.016133152098836673, 'psi': 0.9974836264573945}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=1.838618 cos_to_last_merge=0.7808 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.781
[S13] round=92 local utility u=0.644591 metrics={'f1_val': 0.7406749475880963, 'auprc': 0.7124584028377254, 'loss_val': 0.9011557456804935, 'psi': 0.729388329687948}-{'f1_val': 0.6233461403881998, 'auprc': 0.6317511986081289, 'loss_val': 1.2442437125212604, 'psi': 0.6267081636761714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=92 head_norm_before_train=2.121241 cos_to_last_merge=0.9627 (last merge round=18)
[S14] round=92 local utility u=0.000151 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971628467548463, 'loss_val': 0.018022517684381296, 'psi': 0.9970636435965377}-{'f1_val': 0.9978195179672185, 'auprc': 0.997157023105721, 'loss_val': 0.02323881999742262, 'psi': 0.9975545200226195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=92 head_norm_before_train=1.897220 cos_to_last_merge=1.0000 (last merge round=91)
[S15] round=92 local utility u=0.255295 metrics={'f1_val': 0.9020457798732815, 'auprc': 0.9963349865879297, 'loss_val': 0.24940858215158362, 'psi': 0.9397614625591408}-{'f1_val': 0.8382265938494534, 'auprc': 0.9958440923920167, 'loss_val': 0.3756105449287672, 'psi': 0.9012735932664787}
[S16] START round=92 head_norm_before_train=2.044277 cos_to_last_merge=0.7622 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.762
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9672307860309703, 'auprc': 0.9888592263683782, 'loss_val': 0.10231192675266844, 'psi': 0.9758821621659335}-{'f1_val': 0.9924686739525787, 'auprc': 0.9935308678363074, 'loss_val': 0.035423550989361355, 'psi': 0.9928935515060702}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.063207 cos_to_last_merge=0.7748 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=92 local utility u=0.930911 metrics={'f1_val': 0.9003208936095254, 'auprc': 0.9806510255606155, 'loss_val': 0.4270337294373334, 'psi': 0.9324529463899613}-{'f1_val': 0.7241997039206964, 'auprc': 0.88033148400729, 'loss_val': 0.9311707633525229, 'psi': 0.7866524159553339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=92 metric=0.9928 head_norm=1.897372
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.790178e-03
[S8] stored merged vector for next round verification (round=92)
[S8] DEBUG after merge:  round=92 metric=0.9928 head_norm=1.900410 delta_norm=0.007790
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=92 metric=0.9020 head_norm=1.903475
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.790193e-03
[S15] stored merged vector for next round verification (round=92)
[S15] DEBUG after merge:  round=92 metric=0.9015 head_norm=1.900410 delta_norm=0.007790
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=93 head_norm_before_train=1.795882 cos_to_last_merge=0.8607 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.719395822010896, 'auprc': 0.8676472149124179, 'loss_val': 0.6296796241893688, 'psi': 0.7786963791715048}-{'f1_val': 0.8323353096909538, 'auprc': 0.8962425040940897, 'loss_val': 0.4064754869259599, 'psi': 0.8578981874522081}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=1.800219 cos_to_last_merge=0.8888 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.889
[S3] round=93 local utility u=0.208070 metrics={'f1_val': 0.9259409095961213, 'auprc': 0.9958357588584485, 'loss_val': 0.14805673146554635, 'psi': 0.9538988493010523}-{'f1_val': 0.873740016770782, 'auprc': 0.994169665761401, 'loss_val': 0.24599210137325525, 'psi': 0.9219118763670295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=93 head_norm_before_train=1.693228 cos_to_last_merge=0.9012 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=93 local utility u=0.053322 metrics={'f1_val': 0.9584676965486636, 'auprc': 0.9675208654813398, 'loss_val': 0.3018104182739008, 'psi': 0.9620889641217341}-{'f1_val': 0.9475789215757643, 'auprc': 0.9566766181585913, 'loss_val': 0.31058906845080575, 'psi': 0.951218000208895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=93 head_norm_before_train=1.576642 cos_to_last_merge=0.9057 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=93 local utility u=0.010888 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9917235933108195, 'loss_val': 0.07854435132658441, 'psi': 0.9943141038286509}-{'f1_val': 0.9960411108405385, 'auprc': 0.991455745942658, 'loss_val': 0.0995174428217645, 'psi': 0.9942069648813863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=93 head_norm_before_train=1.799626 cos_to_last_merge=0.8931 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.893
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.8523410054776788, 'auprc': 0.9718175566047418, 'loss_val': 0.3143180397706914, 'psi': 0.9001316259285039}-{'f1_val': 0.8837573868755582, 'auprc': 0.9833296580721784, 'loss_val': 0.23891895523212353, 'psi': 0.9235862953542062}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=1.897160 cos_to_last_merge=0.9754 (last merge round=24)
[S7] round=93 local utility u=0.998534 metrics={'f1_val': 0.7232315186178608, 'auprc': 0.8580618552722465, 'loss_val': 0.387640055190554, 'psi': 0.7771636532796151}-{'f1_val': 0.5450202354342003, 'auprc': 0.7849077780827209, 'loss_val': 1.0959787710849775, 'psi': 0.6409752524936085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=93 head_norm_before_train=1.900410 cos_to_last_merge=1.0000 (last merge round=92)
[S8] round=93 local utility u=0.002459 metrics={'f1_val': 0.9932225217693944, 'auprc': 0.9953449342322238, 'loss_val': 0.03251452299282881, 'psi': 0.9940714867545262}-{'f1_val': 0.9928243971176908, 'auprc': 0.995563782940232, 'loss_val': 0.0356998402514973, 'psi': 0.9939201514467072}
[S9] START round=93 head_norm_before_train=2.224437 (no previous merge yet)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9924766112057334, 'auprc': 0.9998233369982433, 'loss_val': 0.023526812409847553, 'psi': 0.9954153015227374}-{'f1_val': 0.9966605118138915, 'auprc': 0.9998530668030221, 'loss_val': 0.015200380514916345, 'psi': 0.9979375338095438}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.331048 (no previous merge yet)
[S10] round=93 local utility u=0.000110 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9965585106679347, 'loss_val': 0.02430497966934192, 'psi': 0.9956554115322782}-{'f1_val': 0.9950533454418405, 'auprc': 0.9965285433697545, 'loss_val': 0.024434423128383353, 'psi': 0.9956434246130061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=93 head_norm_before_train=2.150685 cos_to_last_merge=0.7361 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.736
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9949523906435326, 'auprc': 0.9994926483463031, 'loss_val': 0.019553177307380588, 'psi': 0.9967684937246408}-{'f1_val': 0.9961541414107454, 'auprc': 0.9994866529351061, 'loss_val': 0.016413916354941032, 'psi': 0.9974871460204897}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.843227 cos_to_last_merge=0.7804 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.780
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.6546644278024318, 'auprc': 0.6533229894202274, 'loss_val': 1.1170055031324302, 'psi': 0.65412785244955}-{'f1_val': 0.7406749475880963, 'auprc': 0.7124584028377254, 'loss_val': 0.9011557456804935, 'psi': 0.729388329687948}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.125952 cos_to_last_merge=0.9625 (last merge round=18)
[S14] round=93 local utility u=0.001095 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971580871405916, 'loss_val': 0.01828361123080799, 'psi': 0.997308196557272}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971628467548463, 'loss_val': 0.018022517684381296, 'psi': 0.9970636435965377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=93 head_norm_before_train=1.900410 cos_to_last_merge=1.0000 (last merge round=92)
[S15] round=93 local utility u=0.130283 metrics={'f1_val': 0.9259982362735998, 'auprc': 0.9969474079184841, 'loss_val': 0.13439379717784947, 'psi': 0.9543779049315535}-{'f1_val': 0.9020457798732815, 'auprc': 0.9963349865879297, 'loss_val': 0.24940858215158362, 'psi': 0.9397614625591408}
[S16] START round=93 head_norm_before_train=2.047891 cos_to_last_merge=0.7618 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.762
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9585513375513269, 'auprc': 0.987485248254824, 'loss_val': 0.12379638485696925, 'psi': 0.9701249018327258}-{'f1_val': 0.9672307860309703, 'auprc': 0.9888592263683782, 'loss_val': 0.10231192675266844, 'psi': 0.9758821621659335}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=2.068687 cos_to_last_merge=0.7745 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=93 local utility u=0.120119 metrics={'f1_val': 0.9141450597880634, 'auprc': 0.9901870546446625, 'loss_val': 0.2983492033440257, 'psi': 0.944561857730703}-{'f1_val': 0.9003208936095254, 'auprc': 0.9806510255606155, 'loss_val': 0.4270337294373334, 'psi': 0.9324529463899613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:33915
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=93 metric=0.9932 head_norm=1.904560
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.602887e-03
[S8] stored merged vector for next round verification (round=93)
[S8] DEBUG after merge:  round=93 metric=0.9932 head_norm=1.905776 delta_norm=0.004603
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=93 metric=0.9260 head_norm=1.907001
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.602874e-03
[S15] stored merged vector for next round verification (round=93)
[S15] DEBUG after merge:  round=93 metric=0.9260 head_norm=1.905776 delta_norm=0.004603
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=94 head_norm_before_train=1.799584 cos_to_last_merge=0.8602 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.860
[S2] round=94 local utility u=0.567468 metrics={'f1_val': 0.8254459408926587, 'auprc': 0.9692220951875256, 'loss_val': 0.43576988899313945, 'psi': 0.8829564026106054}-{'f1_val': 0.719395822010896, 'auprc': 0.8676472149124179, 'loss_val': 0.6296796241893688, 'psi': 0.7786963791715048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] sending update (kind=head size=1790 to 1 peers)
[S3] START round=94 head_norm_before_train=1.805704 cos_to_last_merge=0.8880 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.888
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.9205926146228721, 'auprc': 0.9839624437789055, 'loss_val': 0.17925822036516742, 'psi': 0.9459405462852855}-{'f1_val': 0.9259409095961213, 'auprc': 0.9958357588584485, 'loss_val': 0.14805673146554635, 'psi': 0.9538988493010523}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=1.695872 cos_to_last_merge=0.9005 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9411777147825017, 'auprc': 0.95535805901362, 'loss_val': 0.32123631685061893, 'psi': 0.946849852474949}-{'f1_val': 0.9584676965486636, 'auprc': 0.9675208654813398, 'loss_val': 0.3018104182739008, 'psi': 0.9620889641217341}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.590878 cos_to_last_merge=0.9030 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.903
[S5] round=94 local utility u=0.010339 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9920500996681101, 'loss_val': 0.06281130339642664, 'psi': 0.9948412209543187}-{'f1_val': 0.9960411108405385, 'auprc': 0.9917235933108195, 'loss_val': 0.07854435132658441, 'psi': 0.9943141038286509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=94 head_norm_before_train=1.805019 cos_to_last_merge=0.8924 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.892
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.6142219804266004, 'auprc': 0.8908053312694295, 'loss_val': 0.8856875094518417, 'psi': 0.724855320763732}-{'f1_val': 0.8523410054776788, 'auprc': 0.9718175566047418, 'loss_val': 0.3143180397706914, 'psi': 0.9001316259285039}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.900133 cos_to_last_merge=0.9752 (last merge round=24)
[S7] round=94 local utility u=0.034575 metrics={'f1_val': 0.6911173921594704, 'auprc': 0.919491388985409, 'loss_val': 0.3100937633688474, 'psi': 0.7824669908898458}-{'f1_val': 0.7232315186178608, 'auprc': 0.8580618552722465, 'loss_val': 0.387640055190554, 'psi': 0.7771636532796151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=94 head_norm_before_train=1.905776 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.9940342119076258, 'auprc': 0.9912334384506131, 'loss_val': 0.031555748704936076, 'psi': 0.9929139025248206}-{'f1_val': 0.9932225217693944, 'auprc': 0.9953449342322238, 'loss_val': 0.03251452299282881, 'psi': 0.9940714867545262}
[S9] START round=94 head_norm_before_train=2.229289 (no previous merge yet)
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9920560831330487, 'auprc': 0.9998968511930044, 'loss_val': 0.02509216070823478, 'psi': 0.995192390357031}-{'f1_val': 0.9924766112057334, 'auprc': 0.9998233369982433, 'loss_val': 0.023526812409847553, 'psi': 0.9954153015227374}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.334326 (no previous merge yet)
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9960468684978132, 'loss_val': 0.02391266031929956, 'psi': 0.9954507546642296}-{'f1_val': 0.9950533454418405, 'auprc': 0.9965585106679347, 'loss_val': 0.02430497966934192, 'psi': 0.9956554115322782}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.154294 cos_to_last_merge=0.7358 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.736
[S11] round=94 local utility u=0.005162 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9995041711068025, 'loss_val': 0.016473975821183456, 'psi': 0.9974941532891682}-{'f1_val': 0.9949523906435326, 'auprc': 0.9994926483463031, 'loss_val': 0.019553177307380588, 'psi': 0.9967684937246408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=94 head_norm_before_train=1.849980 cos_to_last_merge=0.7799 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.780
[S13] round=94 local utility u=0.378066 metrics={'f1_val': 0.7216522683791085, 'auprc': 0.7023947200972545, 'loss_val': 0.9100157426934018, 'psi': 0.7139492490663668}-{'f1_val': 0.6546644278024318, 'auprc': 0.6533229894202274, 'loss_val': 1.1170055031324302, 'psi': 0.65412785244955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=94 head_norm_before_train=2.130984 cos_to_last_merge=0.9624 (last merge round=18)
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9838817521735587, 'auprc': 0.9970526490358315, 'loss_val': 0.041149540501446126, 'psi': 0.9891501109184677}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971580871405916, 'loss_val': 0.01828361123080799, 'psi': 0.997308196557272}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=1.905776 cos_to_last_merge=1.0000 (last merge round=93)
[S15] round=94 local utility u=0.110574 metrics={'f1_val': 0.9543458644573428, 'auprc': 0.9975881057791789, 'loss_val': 0.08525336971523854, 'psi': 0.9716427609860772}-{'f1_val': 0.9259982362735998, 'auprc': 0.9969474079184841, 'loss_val': 0.13439379717784947, 'psi': 0.9543779049315535}
[S16] START round=94 head_norm_before_train=2.050653 cos_to_last_merge=0.7613 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.761
[S16] round=94 local utility u=0.164554 metrics={'f1_val': 0.9931436324833557, 'auprc': 0.9981092452754767, 'loss_val': 0.03411488123739879, 'psi': 0.9951298776002042}-{'f1_val': 0.9585513375513269, 'auprc': 0.987485248254824, 'loss_val': 0.12379638485696925, 'psi': 0.9701249018327258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=94 head_norm_before_train=2.076136 cos_to_last_merge=0.7734 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.8643687015214119, 'auprc': 0.9762180100690839, 'loss_val': 0.3979069748849872, 'psi': 0.9091084249404807}-{'f1_val': 0.9141450597880634, 'auprc': 0.9901870546446625, 'loss_val': 0.2983492033440257, 'psi': 0.944561857730703}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] cosine check vs S15: cos=1.0000
[S2] START round=95 head_norm_before_train=1.802599 cos_to_last_merge=0.8603 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.860
[S2] round=95 local utility u=0.048884 metrics={'f1_val': 0.8282896717483099, 'auprc': 0.9839307821828599, 'loss_val': 0.3991894562864063, 'psi': 0.89054611592213}-{'f1_val': 0.8254459408926587, 'auprc': 0.9692220951875256, 'loss_val': 0.43576988899313945, 'psi': 0.8829564026106054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=95 head_norm_before_train=1.811772 cos_to_last_merge=0.8872 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=95 local utility u=0.109427 metrics={'f1_val': 0.9460841720649789, 'auprc': 0.9893030919286285, 'loss_val': 0.12937543386858238, 'psi': 0.9633717400104387}-{'f1_val': 0.9205926146228721, 'auprc': 0.9839624437789055, 'loss_val': 0.17925822036516742, 'psi': 0.9459405462852855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=95 head_norm_before_train=1.698260 cos_to_last_merge=0.8999 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.900
[S4] round=95 local utility u=0.007273 metrics={'f1_val': 0.940174870873346, 'auprc': 0.9635953521841113, 'loss_val': 0.3253841519812353, 'psi': 0.949543063397652}-{'f1_val': 0.9411777147825017, 'auprc': 0.95535805901362, 'loss_val': 0.32123631685061893, 'psi': 0.946849852474949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=95 head_norm_before_train=1.604192 cos_to_last_merge=0.9003 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.900
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.992746156169531, 'loss_val': 0.06960152847933308, 'psi': 0.9948987496459465}-{'f1_val': 0.9967019684784577, 'auprc': 0.9920500996681101, 'loss_val': 0.06281130339642664, 'psi': 0.9948412209543187}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=95 head_norm_before_train=1.812955 cos_to_last_merge=0.8914 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=95 local utility u=1.000000 metrics={'f1_val': 0.8460050581621336, 'auprc': 0.9365482131731181, 'loss_val': 0.4121365890029115, 'psi': 0.8822223201665274}-{'f1_val': 0.6142219804266004, 'auprc': 0.8908053312694295, 'loss_val': 0.8856875094518417, 'psi': 0.724855320763732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=95 head_norm_before_train=1.903741 cos_to_last_merge=0.9748 (last merge round=24)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.5971598802919192, 'auprc': 0.7956694982800165, 'loss_val': 0.6931225366962533, 'psi': 0.6765637274871582}-{'f1_val': 0.6911173921594704, 'auprc': 0.919491388985409, 'loss_val': 0.3100937633688474, 'psi': 0.7824669908898458}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=1.911851 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9930597356591666, 'loss_val': 0.031701808356725085, 'psi': 0.9929856036287608}-{'f1_val': 0.9940342119076258, 'auprc': 0.9912334384506131, 'loss_val': 0.031555748704936076, 'psi': 0.9929139025248206}
[S9] START round=95 head_norm_before_train=2.230813 (no previous merge yet)
[S9] round=95 local utility u=0.015401 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999275411623785, 'loss_val': 0.017006044377685832, 'psi': 0.9974670474834626}-{'f1_val': 0.9920560831330487, 'auprc': 0.9998968511930044, 'loss_val': 0.02509216070823478, 'psi': 0.995192390357031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=95 head_norm_before_train=2.339039 (no previous merge yet)
[S10] round=95 local utility u=0.000094 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.996121833637393, 'loss_val': 0.0239491602088747, 'psi': 0.9954807407200615}-{'f1_val': 0.9950533454418405, 'auprc': 0.9960468684978132, 'loss_val': 0.02391266031929956, 'psi': 0.9954507546642296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=95 head_norm_before_train=2.158158 cos_to_last_merge=0.7355 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.735
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9991228647809509, 'loss_val': 0.017357606865659892, 'psi': 0.9973416307588276}-{'f1_val': 0.9961541414107454, 'auprc': 0.9995041711068025, 'loss_val': 0.016473975821183456, 'psi': 0.9974941532891682}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.858013 cos_to_last_merge=0.7792 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.779
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.7298373418364095, 'auprc': 0.6924451219188078, 'loss_val': 0.9901562684862606, 'psi': 0.7148804538693688}-{'f1_val': 0.7216522683791085, 'auprc': 0.7023947200972545, 'loss_val': 0.9100157426934018, 'psi': 0.7139492490663668}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.134863 cos_to_last_merge=0.9622 (last merge round=18)
[S14] round=95 local utility u=0.052175 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971585773755973, 'loss_val': 0.01827734061955793, 'psi': 0.9973083926512742}-{'f1_val': 0.9838817521735587, 'auprc': 0.9970526490358315, 'loss_val': 0.041149540501446126, 'psi': 0.9891501109184677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=95 head_norm_before_train=1.912363 cos_to_last_merge=1.0000 (last merge round=93)
[S15] round=95 local utility u=0.041073 metrics={'f1_val': 0.9650454121553215, 'auprc': 0.9976082999969496, 'loss_val': 0.06736473492638222, 'psi': 0.9780705672919727}-{'f1_val': 0.9543458644573428, 'auprc': 0.9975881057791789, 'loss_val': 0.08525336971523854, 'psi': 0.9716427609860772}
[S16] START round=95 head_norm_before_train=2.055608 cos_to_last_merge=0.7613 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.761
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.9924904121990616, 'auprc': 0.9939172990672476, 'loss_val': 0.035198191274968, 'psi': 0.9930611669463361}-{'f1_val': 0.9931436324833557, 'auprc': 0.9981092452754767, 'loss_val': 0.03411488123739879, 'psi': 0.9951298776002042}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.084248 cos_to_last_merge=0.7725 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.7979645528468136, 'auprc': 0.9096604528892006, 'loss_val': 0.9168308926806965, 'psi': 0.8426429128637684}-{'f1_val': 0.8643687015214119, 'auprc': 0.9762180100690839, 'loss_val': 0.3979069748849872, 'psi': 0.9091084249404807}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=95 metric=0.9929 head_norm=1.919070
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.009384e-03
[S8] stored merged vector for next round verification (round=95)
[S8] DEBUG after merge:  round=95 metric=0.9929 head_norm=1.915698 delta_norm=0.009009
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.040 → S15@127.0.0.1:33915
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] ⇄ pheromone p=0.123 → S8@127.0.0.1:33909
[S2] START round=96 head_norm_before_train=1.804144 cos_to_last_merge=0.8606 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.8268681594445086, 'auprc': 0.9920109271730639, 'loss_val': 0.4152065196786098, 'psi': 0.8929252665359307}-{'f1_val': 0.8282896717483099, 'auprc': 0.9839307821828599, 'loss_val': 0.3991894562864063, 'psi': 0.89054611592213}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=1.817642 cos_to_last_merge=0.8865 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.886
[S3] round=96 local utility u=0.134781 metrics={'f1_val': 0.9751128629556551, 'auprc': 0.9988379968020684, 'loss_val': 0.06258941970741037, 'psi': 0.9846029164942205}-{'f1_val': 0.9460841720649789, 'auprc': 0.9893030919286285, 'loss_val': 0.12937543386858238, 'psi': 0.9633717400104387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=96 head_norm_before_train=1.702331 cos_to_last_merge=0.8995 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.900
[S4] round=96 local utility u=0.016523 metrics={'f1_val': 0.9408150758647016, 'auprc': 0.9726032854384676, 'loss_val': 0.3232041255325102, 'psi': 0.953530359694208}-{'f1_val': 0.940174870873346, 'auprc': 0.9635953521841113, 'loss_val': 0.3253841519812353, 'psi': 0.949543063397652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=96 head_norm_before_train=1.613836 cos_to_last_merge=0.8985 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.899
[S5] round=96 local utility u=0.005947 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.991992028805841, 'loss_val': 0.05765388008600204, 'psi': 0.994817992609411}-{'f1_val': 0.9963338119635569, 'auprc': 0.992746156169531, 'loss_val': 0.06960152847933308, 'psi': 0.9948987496459465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=96 head_norm_before_train=1.821644 cos_to_last_merge=0.8903 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.890
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.567247099469158, 'auprc': 0.5712516600984285, 'loss_val': 1.460862568080734, 'psi': 0.5688489237208663}-{'f1_val': 0.8460050581621336, 'auprc': 0.9365482131731181, 'loss_val': 0.4121365890029115, 'psi': 0.8822223201665274}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=1.905643 cos_to_last_merge=0.9747 (last merge round=24)
[S7] round=96 local utility u=0.001160 metrics={'f1_val': 0.587824480084313, 'auprc': 0.8026353412407701, 'loss_val': 0.6556872758395622, 'psi': 0.6737488245468959}-{'f1_val': 0.5971598802919192, 'auprc': 0.7956694982800165, 'loss_val': 0.6931225366962533, 'psi': 0.6765637274871582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=96 head_norm_before_train=1.915698 cos_to_last_merge=1.0000 (last merge round=95)
[S8] round=96 local utility u=0.003457 metrics={'f1_val': 0.993467150337892, 'auprc': 0.9944263285612207, 'loss_val': 0.03207391040317319, 'psi': 0.9938508216272235}-{'f1_val': 0.9929361822751569, 'auprc': 0.9930597356591666, 'loss_val': 0.031701808356725085, 'psi': 0.9929856036287608}
[S9] START round=96 head_norm_before_train=2.234126 (no previous merge yet)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9971252488655016, 'loss_val': 0.017413935751021268, 'psi': 0.9968464066345355}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999275411623785, 'loss_val': 0.017006044377685832, 'psi': 0.9974670474834626}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.341040 (no previous merge yet)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9961206801220734, 'loss_val': 0.02396382460933182, 'psi': 0.9954802793139337}-{'f1_val': 0.9950533454418405, 'auprc': 0.996121833637393, 'loss_val': 0.0239491602088747, 'psi': 0.9954807407200615}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.162608 cos_to_last_merge=0.7352 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.735
[S11] round=96 local utility u=0.000231 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9992236251065292, 'loss_val': 0.01719766859411314, 'psi': 0.9973819348890589}-{'f1_val': 0.9961541414107454, 'auprc': 0.9991228647809509, 'loss_val': 0.017357606865659892, 'psi': 0.9973416307588276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=96 head_norm_before_train=1.866357 cos_to_last_merge=0.7785 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.778
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6411315537526093, 'auprc': 0.6515271528343188, 'loss_val': 1.1641087638981562, 'psi': 0.6452897933852931}-{'f1_val': 0.7298373418364095, 'auprc': 0.6924451219188078, 'loss_val': 0.9901562684862606, 'psi': 0.7148804538693688}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.140137 cos_to_last_merge=0.9620 (last merge round=18)
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.99715842924784, 'loss_val': 0.01983392390159021, 'psi': 0.9971625474977912}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971585773755973, 'loss_val': 0.01827734061955793, 'psi': 0.9973083926512742}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=1.918818 cos_to_last_merge=1.0000 (last merge round=93)
[S15] round=96 local utility u=0.019628 metrics={'f1_val': 0.9695806937748813, 'auprc': 0.9976285544617755, 'loss_val': 0.05538060992532418, 'psi': 0.980799838049639}-{'f1_val': 0.9650454121553215, 'auprc': 0.9976082999969496, 'loss_val': 0.06736473492638222, 'psi': 0.9780705672919727}
[S16] START round=96 head_norm_before_train=2.057335 cos_to_last_merge=0.7606 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.761
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9482844504824184, 'auprc': 0.9888994253629302, 'loss_val': 0.15392437586325994, 'psi': 0.9645304404346231}-{'f1_val': 0.9924904121990616, 'auprc': 0.9939172990672476, 'loss_val': 0.035198191274968, 'psi': 0.9930611669463361}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.090678 cos_to_last_merge=0.7719 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=96 local utility u=0.639638 metrics={'f1_val': 0.907229872855468, 'auprc': 0.9939838680692129, 'loss_val': 0.5461177172551243, 'psi': 0.9419314709409659}-{'f1_val': 0.7979645528468136, 'auprc': 0.9096604528892006, 'loss_val': 0.9168308926806965, 'psi': 0.8426429128637684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33915
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=96 metric=0.9696 head_norm=1.925122
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.674038e-03
[S15] stored merged vector for next round verification (round=96)
[S15] DEBUG after merge:  round=96 metric=0.9696 head_norm=1.922980 delta_norm=0.009674
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=96 metric=0.9935 head_norm=1.920884
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.010783e-03
[S8] stored merged vector for next round verification (round=96)
[S8] DEBUG after merge:  round=96 metric=0.9935 head_norm=1.921406 delta_norm=0.009011
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=97 head_norm_before_train=1.805211 cos_to_last_merge=0.8609 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.8166679034384032, 'auprc': 0.9086924431625931, 'loss_val': 0.4715984481859624, 'psi': 0.8534777193280791}-{'f1_val': 0.8268681594445086, 'auprc': 0.9920109271730639, 'loss_val': 0.4152065196786098, 'psi': 0.8929252665359307}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=1.823262 cos_to_last_merge=0.8857 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.886
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.841556832276243, 'auprc': 0.9608824435793131, 'loss_val': 0.5409878098567846, 'psi': 0.889287076797471}-{'f1_val': 0.9751128629556551, 'auprc': 0.9988379968020684, 'loss_val': 0.06258941970741037, 'psi': 0.9846029164942205}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=1.706401 cos_to_last_merge=0.8992 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.899
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.6289862040842414, 'auprc': 0.9200911552861702, 'loss_val': 0.7378047912584047, 'psi': 0.745428184565013}-{'f1_val': 0.9408150758647016, 'auprc': 0.9726032854384676, 'loss_val': 0.3232041255325102, 'psi': 0.953530359694208}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=1.623666 cos_to_last_merge=0.8968 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.897
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9950756500858429, 'loss_val': 0.06638984739894062, 'psi': 0.9958305472124712}-{'f1_val': 0.9967019684784577, 'auprc': 0.991992028805841, 'loss_val': 0.05765388008600204, 'psi': 0.994817992609411}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=1.828041 cos_to_last_merge=0.8895 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.889
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.584628743725499, 'auprc': 0.5684978332665578, 'loss_val': 1.5908812240846624, 'psi': 0.5781763795419225}-{'f1_val': 0.567247099469158, 'auprc': 0.5712516600984285, 'loss_val': 1.460862568080734, 'psi': 0.5688489237208663}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=1.907936 cos_to_last_merge=0.9745 (last merge round=24)
[S7] round=97 local utility u=1.000000 metrics={'f1_val': 0.9194817563869713, 'auprc': 0.9679919685154583, 'loss_val': 0.2440978529861904, 'psi': 0.938885841238366}-{'f1_val': 0.587824480084313, 'auprc': 0.8026353412407701, 'loss_val': 0.6556872758395622, 'psi': 0.6737488245468959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=97 head_norm_before_train=1.921406 cos_to_last_merge=1.0000 (last merge round=96)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.974280047414472, 'auprc': 0.9961797334739286, 'loss_val': 0.07564945761868656, 'psi': 0.9830399218382546}-{'f1_val': 0.993467150337892, 'auprc': 0.9944263285612207, 'loss_val': 0.03207391040317319, 'psi': 0.9938508216272235}
[S9] START round=97 head_norm_before_train=2.238436 (no previous merge yet)
[S9] round=97 local utility u=0.006296 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999311778027639, 'loss_val': 0.015894148868073187, 'psi': 0.9982342186283912}-{'f1_val': 0.9966605118138915, 'auprc': 0.9971252488655016, 'loss_val': 0.017413935751021268, 'psi': 0.9968464066345355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=97 head_norm_before_train=2.343788 (no previous merge yet)
[S10] round=97 local utility u=0.000000 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9957445446776266, 'loss_val': 0.023957313766060046, 'psi': 0.995329825136155}-{'f1_val': 0.9950533454418405, 'auprc': 0.9961206801220734, 'loss_val': 0.02396382460933182, 'psi': 0.9954802793139337}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=97 head_norm_before_train=2.167292 cos_to_last_merge=0.7350 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.735
[S11] round=97 local utility u=0.000148 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9993093135442062, 'loss_val': 0.017159558184588863, 'psi': 0.9974162102641297}-{'f1_val': 0.9961541414107454, 'auprc': 0.9992236251065292, 'loss_val': 0.01719766859411314, 'psi': 0.9973819348890589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=97 head_norm_before_train=1.873377 cos_to_last_merge=0.7777 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.778
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.6303452896485, 'auprc': 0.6419719118571401, 'loss_val': 1.2105758385117746, 'psi': 0.6349959385319561}-{'f1_val': 0.6411315537526093, 'auprc': 0.6515271528343188, 'loss_val': 1.1641087638981562, 'psi': 0.6452897933852931}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=2.145582 cos_to_last_merge=0.9618 (last merge round=18)
[S14] round=97 local utility u=0.001384 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9971585979030981, 'loss_val': 0.018540549915265696, 'psi': 0.9973100357219362}-{'f1_val': 0.9971652929977585, 'auprc': 0.99715842924784, 'loss_val': 0.01983392390159021, 'psi': 0.9971625474977912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=97 head_norm_before_train=1.922980 cos_to_last_merge=1.0000 (last merge round=96)
[S15] round=97 local utility u=0.003590 metrics={'f1_val': 0.9704797095968619, 'auprc': 0.997628054901802, 'loss_val': 0.053593735120081934, 'psi': 0.981339047718838}-{'f1_val': 0.9695806937748813, 'auprc': 0.9976285544617755, 'loss_val': 0.05538060992532418, 'psi': 0.980799838049639}
[S16] START round=97 head_norm_before_train=2.061128 cos_to_last_merge=0.7603 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.760
[S16] round=97 local utility u=0.195371 metrics={'f1_val': 0.9934416310264214, 'auprc': 0.9889721213916441, 'loss_val': 0.034344283351496946, 'psi': 0.9916538271725105}-{'f1_val': 0.9482844504824184, 'auprc': 0.9888994253629302, 'loss_val': 0.15392437586325994, 'psi': 0.9645304404346231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=97 head_norm_before_train=2.095036 cos_to_last_merge=0.7716 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.8126403546331427, 'auprc': 0.9501007904619219, 'loss_val': 0.9385753416771142, 'psi': 0.8676245289646543}-{'f1_val': 0.907229872855468, 'auprc': 0.9939838680692129, 'loss_val': 0.5461177172551243, 'psi': 0.9419314709409659}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S15
[S8] cosine check vs S15: cos=1.0000
[S2] START round=98 head_norm_before_train=1.807436 cos_to_last_merge=0.8608 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7303087289778486, 'auprc': 0.8394428366946742, 'loss_val': 0.8764093747939686, 'psi': 0.773962372064579}-{'f1_val': 0.8166679034384032, 'auprc': 0.9086924431625931, 'loss_val': 0.4715984481859624, 'psi': 0.8534777193280791}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=1.828741 cos_to_last_merge=0.8849 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.885
[S3] round=98 local utility u=0.575686 metrics={'f1_val': 0.945172763307383, 'auprc': 0.9958791386335276, 'loss_val': 0.11630072554226721, 'psi': 0.9654553134378407}-{'f1_val': 0.841556832276243, 'auprc': 0.9608824435793131, 'loss_val': 0.5409878098567846, 'psi': 0.889287076797471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=98 head_norm_before_train=1.709529 cos_to_last_merge=0.8988 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.899
[S4] round=98 local utility u=1.000000 metrics={'f1_val': 0.9425403522484948, 'auprc': 0.9742414816728071, 'loss_val': 0.31659563459245416, 'psi': 0.9552208040182197}-{'f1_val': 0.6289862040842414, 'auprc': 0.9200911552861702, 'loss_val': 0.7378047912584047, 'psi': 0.745428184565013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=98 head_norm_before_train=1.631702 cos_to_last_merge=0.8954 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.895
[S5] round=98 local utility u=0.014341 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9965296227833117, 'loss_val': 0.04427953650867482, 'psi': 0.9966330302003993}-{'f1_val': 0.9963338119635569, 'auprc': 0.9950756500858429, 'loss_val': 0.06638984739894062, 'psi': 0.9958305472124712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=98 head_norm_before_train=1.830900 cos_to_last_merge=0.8891 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.889
[S6] round=98 local utility u=1.000000 metrics={'f1_val': 0.8139596887096396, 'auprc': 0.857519304725477, 'loss_val': 0.6963643346647221, 'psi': 0.8313835351159746}-{'f1_val': 0.584628743725499, 'auprc': 0.5684978332665578, 'loss_val': 1.5908812240846624, 'psi': 0.5781763795419225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=98 head_norm_before_train=1.914570 cos_to_last_merge=0.9740 (last merge round=24)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6044701091343831, 'auprc': 0.7968749659732424, 'loss_val': 0.7661099683105222, 'psi': 0.6814320518699268}-{'f1_val': 0.9194817563869713, 'auprc': 0.9679919685154583, 'loss_val': 0.2440978529861904, 'psi': 0.938885841238366}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=1.925001 cos_to_last_merge=1.0000 (last merge round=96)
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.8308707103879038, 'auprc': 0.9804017676429104, 'loss_val': 0.4318461446842747, 'psi': 0.8906831332899066}-{'f1_val': 0.974280047414472, 'auprc': 0.9961797334739286, 'loss_val': 0.07564945761868656, 'psi': 0.9830399218382546}
[S9] START round=98 head_norm_before_train=2.239241 (no previous merge yet)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9999327323759991, 'loss_val': 0.045384625750285235, 'psi': 0.992534836756676}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999311778027639, 'loss_val': 0.015894148868073187, 'psi': 0.9982342186283912}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.348221 (no previous merge yet)
[S10] round=98 local utility u=0.000497 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.9960585598268107, 'loss_val': 0.023906175999350455, 'psi': 0.9954554311958286}-{'f1_val': 0.9950533454418405, 'auprc': 0.9957445446776266, 'loss_val': 0.023957313766060046, 'psi': 0.995329825136155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=98 head_norm_before_train=2.172044 cos_to_last_merge=0.7348 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.735
[S11] round=98 local utility u=0.002034 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9995423332714182, 'loss_val': 0.015240969925067816, 'psi': 0.9976544456270338}-{'f1_val': 0.9961541414107454, 'auprc': 0.9993093135442062, 'loss_val': 0.017159558184588863, 'psi': 0.9974162102641297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] sending update (kind=head size=1789 to 1 peers)
[S13] START round=98 head_norm_before_train=1.876431 cos_to_last_merge=0.7766 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.777
[S13] round=98 local utility u=0.317264 metrics={'f1_val': 0.7148002689823517, 'auprc': 0.6606613126798009, 'loss_val': 1.1388451053363007, 'psi': 0.6931446864613314}-{'f1_val': 0.6303452896485, 'auprc': 0.6419719118571401, 'loss_val': 1.2105758385117746, 'psi': 0.6349959385319561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=98 head_norm_before_train=2.149964 cos_to_last_merge=0.9617 (last merge round=18)
[S14] round=98 local utility u=0.002778 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9988534363069814, 'loss_val': 0.01806818822100365, 'psi': 0.9979879710834895}-{'f1_val': 0.9974109942678281, 'auprc': 0.9971585979030981, 'loss_val': 0.018540549915265696, 'psi': 0.9973100357219362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=98 head_norm_before_train=1.929228 cos_to_last_merge=1.0000 (last merge round=96)
[S15] round=98 local utility u=0.014241 metrics={'f1_val': 0.9740497817263074, 'auprc': 0.9976458121771382, 'loss_val': 0.046586074304153444, 'psi': 0.9834881939066398}-{'f1_val': 0.9704797095968619, 'auprc': 0.997628054901802, 'loss_val': 0.053593735120081934, 'psi': 0.981339047718838}
[S16] START round=98 head_norm_before_train=2.062752 cos_to_last_merge=0.7596 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.760
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9837942762609069, 'auprc': 0.9934693700734981, 'loss_val': 0.07017208273501772, 'psi': 0.9876643137859433}-{'f1_val': 0.9934416310264214, 'auprc': 0.9889721213916441, 'loss_val': 0.034344283351496946, 'psi': 0.9916538271725105}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.100028 cos_to_last_merge=0.7712 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.6495510919281762, 'auprc': 0.7983562400182717, 'loss_val': 1.9732497605953092, 'psi': 0.7090731511642143}-{'f1_val': 0.8126403546331427, 'auprc': 0.9501007904619219, 'loss_val': 0.9385753416771142, 'psi': 0.8676245289646543}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=98 metric=0.8309 head_norm=1.929883
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.556112e-03
[S8] stored merged vector for next round verification (round=98)
[S8] DEBUG after merge:  round=98 metric=0.8301 head_norm=1.929547 delta_norm=0.005556
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=1.0000
[S2] START round=99 head_norm_before_train=1.810132 cos_to_last_merge=0.8605 (last merge round=17)
[S2] ⚠️ Model drifted since last merge! cos=0.860
[S2] round=99 local utility u=0.742636 metrics={'f1_val': 0.8268681594445086, 'auprc': 0.991584612715217, 'loss_val': 0.42691974925812254, 'psi': 0.892754740752792}-{'f1_val': 0.7303087289778486, 'auprc': 0.8394428366946742, 'loss_val': 0.8764093747939686, 'psi': 0.773962372064579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] r=100 psi=0.893 u=0.7426 p_local=0.2261 f1=0.827 auprc=0.992 bytes=116706
[S3] START round=99 head_norm_before_train=1.832773 cos_to_last_merge=0.8844 (last merge round=23)
[S3] ⚠️ Model drifted since last merge! cos=0.884
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.8548079585947995, 'auprc': 0.9957166869199878, 'loss_val': 0.2657737912263995, 'psi': 0.9111714499248749}-{'f1_val': 0.945172763307383, 'auprc': 0.9958791386335276, 'loss_val': 0.11630072554226721, 'psi': 0.9654553134378407}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.911 u=0.0000 p_local=0.1547 f1=0.855 auprc=0.996 bytes=102599
[S4] START round=99 head_norm_before_train=1.709943 cos_to_last_merge=0.8978 (last merge round=24)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=99 local utility u=0.022247 metrics={'f1_val': 0.9497531680188258, 'auprc': 0.9717660440102162, 'loss_val': 0.3079519344510445, 'psi': 0.9585583184153819}-{'f1_val': 0.9425403522484948, 'auprc': 0.9742414816728071, 'loss_val': 0.31659563459245416, 'psi': 0.9552208040182197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] r=100 psi=0.959 u=0.0222 p_local=0.1734 f1=0.950 auprc=0.972 bytes=98912
[S5] START round=99 head_norm_before_train=1.637589 cos_to_last_merge=0.8940 (last merge round=13)
[S5] ⚠️ Model drifted since last merge! cos=0.894
[S5] round=99 local utility u=0.003153 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9976874390643359, 'loss_val': 0.04144647723008636, 'psi': 0.9970961567128089}-{'f1_val': 0.9967019684784577, 'auprc': 0.9965296227833117, 'loss_val': 0.04427953650867482, 'psi': 0.9966330302003993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] r=100 psi=0.997 u=0.0032 p_local=0.0934 f1=0.997 auprc=0.998 bytes=100843
[S6] START round=99 head_norm_before_train=1.833621 cos_to_last_merge=0.8891 (last merge round=17)
[S6] ⚠️ Model drifted since last merge! cos=0.889
[S6] round=99 local utility u=0.195333 metrics={'f1_val': 0.8230144352140372, 'auprc': 0.9270842953345014, 'loss_val': 0.5687208491407024, 'psi': 0.8646423792622229}-{'f1_val': 0.8139596887096396, 'auprc': 0.857519304725477, 'loss_val': 0.6963643346647221, 'psi': 0.8313835351159746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S6] r=100 psi=0.865 u=0.1953 p_local=0.3665 f1=0.823 auprc=0.927 bytes=91789
[S7] START round=99 head_norm_before_train=1.921850 cos_to_last_merge=0.9733 (last merge round=24)
[S7] round=99 local utility u=0.725844 metrics={'f1_val': 0.7108814597111515, 'auprc': 0.9092152313023387, 'loss_val': 0.2899113902316832, 'psi': 0.7902149683476264}-{'f1_val': 0.6044701091343831, 'auprc': 0.7968749659732424, 'loss_val': 0.7661099683105222, 'psi': 0.6814320518699268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] r=100 psi=0.790 u=0.7258 p_local=0.4044 f1=0.711 auprc=0.909 bytes=102633
[S8] START round=99 head_norm_before_train=1.929547 cos_to_last_merge=1.0000 (last merge round=98)
[S8] round=99 local utility u=0.705683 metrics={'f1_val': 0.9925028268365944, 'auprc': 0.9955315670246728, 'loss_val': 0.035662881592599394, 'psi': 0.9937143229118257}-{'f1_val': 0.8308707103879038, 'auprc': 0.9804017676429104, 'loss_val': 0.4318461446842747, 'psi': 0.8906831332899066}
[S9] START round=99 head_norm_before_train=2.237339 (no previous merge yet)
[S9] round=99 local utility u=0.007380 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.999952618605979, 'loss_val': 0.03983945926851689, 'psi': 0.9934583832883718}-{'f1_val': 0.9876029063437939, 'auprc': 0.9999327323759991, 'loss_val': 0.045384625750285235, 'psi': 0.992534836756676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=100 psi=0.993 u=0.0074 p_local=0.0043 f1=0.989 auprc=1.000 bytes=104240
[S10] START round=99 head_norm_before_train=2.353576 (no previous merge yet)
[S10] round=99 local utility u=0.000049 metrics={'f1_val': 0.9950533454418405, 'auprc': 0.996069126650747, 'loss_val': 0.023838883819173217, 'psi': 0.9954596579254031}-{'f1_val': 0.9950533454418405, 'auprc': 0.9960585598268107, 'loss_val': 0.023906175999350455, 'psi': 0.9954554311958286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S10] r=100 psi=0.995 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.996 bytes=115122
[S11] START round=99 head_norm_before_train=2.175199 cos_to_last_merge=0.7345 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.734
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9995359196100045, 'loss_val': 0.015604511655530331, 'psi': 0.9976518801624683}-{'f1_val': 0.9963958538641108, 'auprc': 0.9995423332714182, 'loss_val': 0.015240969925067816, 'psi': 0.9976544456270338}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.998 u=0.0000 p_local=0.0051 f1=0.996 auprc=1.000 bytes=111390
[S13] START round=99 head_norm_before_train=1.878627 cos_to_last_merge=0.7756 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.776
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6499282236422682, 'auprc': 0.6561959490713998, 'loss_val': 1.1326515629703167, 'psi': 0.6524353138139208}-{'f1_val': 0.7148002689823517, 'auprc': 0.6606613126798009, 'loss_val': 1.1388451053363007, 'psi': 0.6931446864613314}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.652 u=0.0000 p_local=0.1331 f1=0.650 auprc=0.656 bytes=97323
[S14] START round=99 head_norm_before_train=2.150436 cos_to_last_merge=0.9615 (last merge round=18)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.998855155423306, 'loss_val': 0.01915868233189124, 'psi': 0.9979738191580713}-{'f1_val': 0.9974109942678281, 'auprc': 0.9988534363069814, 'loss_val': 0.01806818822100365, 'psi': 0.9979879710834895}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.998 u=0.0000 p_local=0.0066 f1=0.997 auprc=0.999 bytes=116960
[S15] START round=99 head_norm_before_train=1.935251 cos_to_last_merge=1.0000 (last merge round=96)
[S15] round=99 local utility u=0.018335 metrics={'f1_val': 0.9793294998056954, 'auprc': 0.99764855596117, 'loss_val': 0.041601790920407736, 'psi': 0.9866571222678853}-{'f1_val': 0.9740497817263074, 'auprc': 0.9976458121771382, 'loss_val': 0.046586074304153444, 'psi': 0.9834881939066398}
[S16] START round=99 head_norm_before_train=2.066616 cos_to_last_merge=0.7594 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.759
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.7750916340920996, 'auprc': 0.9493577726672242, 'loss_val': 1.186738673732903, 'psi': 0.8447980895221494}-{'f1_val': 0.9837942762609069, 'auprc': 0.9934693700734981, 'loss_val': 0.07017208273501772, 'psi': 0.9876643137859433}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.845 u=0.0000 p_local=0.0418 f1=0.775 auprc=0.949 bytes=93515
[S17] START round=99 head_norm_before_train=2.105113 cos_to_last_merge=0.7709 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=99 local utility u=1.000000 metrics={'f1_val': 0.8599709515423171, 'auprc': 0.9753505677163191, 'loss_val': 0.40866811979109846, 'psi': 0.906122798011918}-{'f1_val': 0.6495510919281762, 'auprc': 0.7983562400182717, 'loss_val': 1.9732497605953092, 'psi': 0.7090731511642143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S17] r=100 psi=0.906 u=1.0000 p_local=0.3390 f1=0.860 auprc=0.975 bytes=91810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:33909
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1798) from S15
[S8] cosine check vs S15: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=99 metric=0.9793 head_norm=1.941247
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.130461e-03
[S15] stored merged vector for next round verification (round=99)
[S15] DEBUG after merge:  round=99 metric=0.9798 head_norm=1.937759 delta_norm=0.007130
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] r=100 psi=0.987 u=0.0183 p_local=0.0588 f1=0.979 auprc=0.998 bytes=106120
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=99 metric=0.9925 head_norm=1.934291
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.856114e-03
[S8] stored merged vector for next round verification (round=99)
[S8] DEBUG after merge:  round=99 metric=0.9925 head_norm=1.936262 delta_norm=0.005856
[S8] aggregate: ACCEPT kept=['S15', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] r=100 psi=0.994 u=0.7057 p_local=0.1578 f1=0.993 auprc=0.996 bytes=111461
[runner] rounds complete.
[runner] all agents stopped.
