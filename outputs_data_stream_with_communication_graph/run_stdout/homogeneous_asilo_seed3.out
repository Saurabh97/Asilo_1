[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:63503
[S3] → join 127.0.0.1:63502
[S4] → join 127.0.0.1:63502
[S5] → join 127.0.0.1:63502
[S6] → join 127.0.0.1:63502
[S7] → join 127.0.0.1:63502
[S8] → join 127.0.0.1:63502
[S9] → join 127.0.0.1:63502
[S10] → join 127.0.0.1:63502
[S11] → join 127.0.0.1:63502
[S13] → join 127.0.0.1:63502
[S14] → join 127.0.0.1:63502
[S15] → join 127.0.0.1:63502
[S16] → join 127.0.0.1:63502
[S17] → join 127.0.0.1:63502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.200650 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.121343 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.134770 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.181066 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.123863 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.233421 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.199036 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.219434 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.159554 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.173196 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.120331 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.118968 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.153355 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.126188 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.160178 (no previous merge yet)
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S7
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S14
[S3] + discovered S8
[S4] + discovered S3
[S3] + discovered S6
[S3] + discovered S4
[S3] + discovered S17
[S3] + discovered S15
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S5
[S3] + discovered S13
[S4] + discovered S11
[S4] + discovered S14
[S4] + discovered S15
[S4] + discovered S5
[S5] + discovered S2
[S4] + discovered S10
[S5] + discovered S4
[S4] + discovered S17
[S4] + discovered S7
[S5] + discovered S3
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S6
[S4] + discovered S9
[S4] + discovered S8
[S5] + discovered S11
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S13
[S5] + discovered S7
[S6] + discovered S5
[S5] + discovered S8
[S6] + discovered S3
[S5] + discovered S15
[S6] + discovered S4
[S5] + discovered S6
[S5] + discovered S14
[S6] + discovered S2
[S5] + discovered S10
[S5] + discovered S9
[S6] + discovered S16
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S5
[S6] + discovered S13
[S6] + discovered S9
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S7
[S7] + discovered S17
[S7] + discovered S11
[S7] + discovered S16
[S8] + discovered S7
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S4
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S8
[S8] + discovered S5
[S8] + discovered S3
[S7] + discovered S14
[S7] + discovered S10
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S3
[S8] + discovered S17
[S8] + discovered S10
[S9] + discovered S8
[S8] + discovered S13
[S8] + discovered S11
[S8] + discovered S14
[S9] + discovered S4
[S8] + discovered S15
[S9] + discovered S6
[S8] + discovered S16
[S8] + discovered S9
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S16
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S8
[S9] + discovered S10
[S10] + discovered S6
[S9] + discovered S15
[S9] + discovered S11
[S10] + discovered S4
[S9] + discovered S13
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S11
[S10] + discovered S13
[S11] + discovered S7
[S11] + discovered S2
[S10] + discovered S16
[S11] + discovered S10
[S10] + discovered S17
[S10] + discovered S15
[S11] + discovered S8
[S11] + discovered S4
[S10] + discovered S14
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S9
[S11] + discovered S5
[S13] + discovered S6
[S13] + discovered S10
[S13] + discovered S7
[S13] + discovered S11
[S11] + discovered S17
[S13] + discovered S2
[S13] + discovered S5
[S11] + discovered S13
[S11] + discovered S16
[S13] + discovered S3
[S11] + discovered S15
[S11] + discovered S14
[S13] + discovered S4
[S13] + discovered S9
[S13] + discovered S8
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S3
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S8
[S14] + discovered S10
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S5
[S13] + discovered S17
[S14] + discovered S6
[S13] + discovered S15
[S14] + discovered S7
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S4
[S15] + discovered S13
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S5
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S3
[S16] + discovered S8
[S16] + discovered S13
[S16] + discovered S6
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S7
[S16] + discovered S2
[S16] + discovered S10
[S16] + discovered S5
[S16] + discovered S14
[S16] + discovered S3
[S16] + discovered S11
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S9
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S8
[S16] + discovered S17
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S10
[S17] + discovered S3
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S9
[S17] + discovered S16
[S17] + discovered S7
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S5] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:63505
[S2] ⇄ pheromone p=1.000 → S14@127.0.0.1:63514
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:63508
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:63507
[S10] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S4] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S15] ⇄ pheromone p=1.000 → S4@127.0.0.1:63504
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:63513
[S2] START round=1 head_norm_before_train=1.204993 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7986435934432585, 'loss_val': 1.3103680380486777, 'psi': 0.40452371741044346}-{'f1_val': 0.1417771333885667, 'auprc': 0.8458252840115257, 'loss_val': 1.3449699337308187, 'psi': 0.42339639363775033}
[S3] START round=1 head_norm_before_train=1.117712 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6131300972643849, 'loss_val': 1.33597186421153, 'psi': 0.3291560782742182}-{'f1_val': 0.2446002195709555, 'auprc': 0.5703783830931832, 'loss_val': 1.3736346424903265, 'psi': 0.3749114849798466}
[S4] START round=1 head_norm_before_train=1.142817 (no previous merge yet)
[S4] round=1 local utility u=0.214549 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.604592547772012, 'loss_val': 1.3357512352064762, 'psi': 0.32597299644591526}-{'f1_val': 0.1715773431546863, 'auprc': 0.4119657983261769, 'loss_val': 1.375072432770892, 'psi': 0.26773272522328256}
[S5] START round=1 head_norm_before_train=1.184653 (no previous merge yet)
[S5] round=1 local utility u=0.365334 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.754432368914617, 'loss_val': 1.3162961460132887, 'psi': 0.3871300904229897}-{'f1_val': 0.0885440438156093, 'auprc': 0.6303174787697041, 'loss_val': 1.3523116345885902, 'psi': 0.30525341779724724}
[S6] START round=1 head_norm_before_train=1.117757 (no previous merge yet)
[S6] round=1 local utility u=0.406375 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8581682627369913, 'loss_val': 1.3282590852643243, 'psi': 0.42812307432556573}-{'f1_val': 0.08954368264159597, 'auprc': 0.7036812722961638, 'loss_val': 1.3662520222925145, 'psi': 0.3351987185034231}
[S7] START round=1 head_norm_before_train=1.233608 (no previous merge yet)
[S7] round=1 local utility u=1.000000 metrics={'f1_val': 0.7147905093846819, 'auprc': 0.8027217928721418, 'loss_val': 1.3526909303743198, 'psi': 0.7499630227796659}-{'f1_val': 0.08845180584311019, 'auprc': 0.8028638882553872, 'loss_val': 1.386702931398116, 'psi': 0.37421663880802103}
[S8] START round=1 head_norm_before_train=1.208707 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.3962183103231274, 'auprc': 0.7690668271321869, 'loss_val': 1.3162062105699663, 'psi': 0.5453577170467512}-{'f1_val': 0.10450549450549451, 'auprc': 0.6145985276644168, 'loss_val': 1.3558309008035148, 'psi': 0.30854270776906345}
[S9] START round=1 head_norm_before_train=1.217067 (no previous merge yet)
[S9] round=1 local utility u=0.044379 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8088551267691705, 'loss_val': 1.3154199594923452, 'psi': 0.40838082499166584}-{'f1_val': 0.141397957139996, 'auprc': 0.7922871784371239, 'loss_val': 1.3544734389282993, 'psi': 0.4017536456588472}
[S10] START round=1 head_norm_before_train=1.160901 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6017069032846145, 'loss_val': 1.3314701020248472, 'psi': 0.32385574383888016}-{'f1_val': 0.2970322621182868, 'auprc': 0.43652257248234705, 'loss_val': 1.363222757749642, 'psi': 0.3528283862639109}
[S11] START round=1 head_norm_before_train=1.179242 (no previous merge yet)
[S11] round=1 local utility u=0.989967 metrics={'f1_val': 0.4148404227119303, 'auprc': 0.6519636629657597, 'loss_val': 1.316298740276445, 'psi': 0.509689718813462}-{'f1_val': 0.10359570269677702, 'auprc': 0.6272962553473271, 'loss_val': 1.354761297217544, 'psi': 0.31307592375699705}
[S13] START round=1 head_norm_before_train=1.130980 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1519194536725087, 'auprc': 0.6951656260171452, 'loss_val': 1.321497870223356, 'psi': 0.3692179226103633}-{'f1_val': 0.3719029521865752, 'auprc': 0.7163201252180456, 'loss_val': 1.3500043809881797, 'psi': 0.5096698213991633}
[S14] START round=1 head_norm_before_train=1.125576 (no previous merge yet)
[S14] round=1 local utility u=0.215339 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5882459318363797, 'loss_val': 1.3389912872564085, 'psi': 0.31951308446417415}-{'f1_val': 0.14035785288270378, 'auprc': 0.4533659001500553, 'loss_val': 1.365029183264206, 'psi': 0.2655610717896444}
[S15] START round=1 head_norm_before_train=1.158355 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7856421323944772, 'loss_val': 1.3124080941970495, 'psi': 0.39809704377472593}-{'f1_val': 0.3887777441863768, 'auprc': 0.7834216216967987, 'loss_val': 1.3459798012354611, 'psi': 0.5466352951905455}
[S16] START round=1 head_norm_before_train=1.131790 (no previous merge yet)
[S16] round=1 local utility u=0.297823 metrics={'f1_val': 0.18588730911005794, 'auprc': 0.8286806865155615, 'loss_val': 1.3218770164603852, 'psi': 0.4430046600722594}-{'f1_val': 0.10386473429951691, 'auprc': 0.8067155881876782, 'loss_val': 1.3594913793057344, 'psi': 0.38500507585478144}
[S17] START round=1 head_norm_before_train=1.161074 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.2452263801133961, 'auprc': 0.6501386965464253, 'loss_val': 1.340690947411863, 'psi': 0.4071913066866078}-{'f1_val': 0.3826487428429176, 'auprc': 0.6492326469135036, 'loss_val': 1.363810257401589, 'psi': 0.489282304471152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:63510
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63503
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:63502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:63514
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:63511
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1789) from S6
[S2] cosine check vs S6: cos=0.0058
[S3] RECEIVED delta(kind=head bytes=1796) from S16
[S3] cosine check vs S16: cos=-0.0384
[S3] DROPPED delta from S16 (cos=-0.0384 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1789) from S7
[S10] cosine check vs S7: cos=0.0678
[S13] RECEIVED delta(kind=head bytes=1801) from S4
[S13] cosine check vs S4: cos=-0.0156
[S13] DROPPED delta from S4 (cos=-0.0156 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1789) from S14
[S17] cosine check vs S14: cos=0.0169
[S13] RECEIVED delta(kind=head bytes=1791) from S8
[S13] cosine check vs S8: cos=-0.0517
[S13] DROPPED delta from S8 (cos=-0.0517 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S5
[S9] cosine check vs S5: cos=-0.1122
[S9] DROPPED delta from S5 (cos=-0.1122 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1788) from S9
[S14] cosine check vs S9: cos=0.0711
[S14] RECEIVED delta(kind=head bytes=1791) from S11
[S14] cosine check vs S11: cos=-0.0437
[S14] DROPPED delta from S11 (cos=-0.0437 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.171880
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.245648e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1422 head_norm=0.882384 delta_norm=0.824565
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.219938
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.265659e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.831339 delta_norm=0.826566
[S2] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.141332
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.070714e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.866521 delta_norm=0.807071
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.2452 head_norm=1.173583
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.115728e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.825419 delta_norm=0.811573
[S17] aggregate: ROLLBACK (f1_val pre=0.245 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=0.831339 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.785542621975196, 'loss_val': 1.311236115628001, 'psi': 0.39928332882321843}-{'f1_val': 0.1417771333885667, 'auprc': 0.7986435934432585, 'loss_val': 1.3103680380486777, 'psi': 0.40452371741044346}
[S3] START round=2 head_norm_before_train=1.127381 (no previous merge yet)
[S3] round=2 local utility u=0.115597 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6757482193249364, 'loss_val': 1.2926326757822935, 'psi': 0.3542033270984388}-{'f1_val': 0.13984006561410703, 'auprc': 0.6131300972643849, 'loss_val': 1.33597186421153, 'psi': 0.3291560782742182}
[S4] START round=2 head_norm_before_train=1.162525 (no previous merge yet)
[S4] round=2 local utility u=0.100557 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.654807092952771, 'loss_val': 1.2852811985818777, 'psi': 0.34605881451821885}-{'f1_val': 0.14022662889518414, 'auprc': 0.604592547772012, 'loss_val': 1.3357512352064762, 'psi': 0.32597299644591526}
[S5] START round=2 head_norm_before_train=1.199569 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7288593911490349, 'loss_val': 1.274827277754675, 'psi': 0.3769008993167568}-{'f1_val': 0.14226190476190476, 'auprc': 0.754432368914617, 'loss_val': 1.3162961460132887, 'psi': 0.3871300904229897}
[S6] START round=2 head_norm_before_train=1.122685 (no previous merge yet)
[S6] round=2 local utility u=0.052081 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8792447164774672, 'loss_val': 1.2873257540703782, 'psi': 0.4365536558217561}-{'f1_val': 0.14142628205128205, 'auprc': 0.8581682627369913, 'loss_val': 1.3282590852643243, 'psi': 0.42812307432556573}
[S7] START round=2 head_norm_before_train=1.242464 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.780353066467834, 'loss_val': 1.317217216787496, 'psi': 0.3973753202245886}-{'f1_val': 0.7147905093846819, 'auprc': 0.8027217928721418, 'loss_val': 1.3526909303743198, 'psi': 0.7499630227796659}
[S8] START round=2 head_norm_before_train=1.226038 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.39952357775973213, 'auprc': 0.7401671146381917, 'loss_val': 1.2697484341917622, 'psi': 0.535780992511116}-{'f1_val': 0.3962183103231274, 'auprc': 0.7690668271321869, 'loss_val': 1.3162062105699663, 'psi': 0.5453577170467512}
[S9] START round=2 head_norm_before_train=1.225483 (no previous merge yet)
[S9] round=2 local utility u=0.309750 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9994363554296948, 'loss_val': 1.2676635854252132, 'psi': 0.4846133164558755}-{'f1_val': 0.141397957139996, 'auprc': 0.8088551267691705, 'loss_val': 1.3154199594923452, 'psi': 0.40838082499166584}
[S10] START round=2 head_norm_before_train=0.882384 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.037719 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6302755180086597, 'loss_val': 1.3417377382519509, 'psi': 0.33528318972849824}-{'f1_val': 0.13862163754172394, 'auprc': 0.6017069032846145, 'loss_val': 1.3314701020248472, 'psi': 0.32385574383888016}
[S11] START round=2 head_norm_before_train=1.196199 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6545677805867285, 'loss_val': 1.2653162513021134, 'psi': 0.34607532225855775}-{'f1_val': 0.4148404227119303, 'auprc': 0.6519636629657597, 'loss_val': 1.316298740276445, 'psi': 0.509689718813462}
[S13] START round=2 head_norm_before_train=1.147403 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5977772599209065, 'loss_val': 1.2911551412113542, 'psi': 0.32334236151459445}-{'f1_val': 0.1519194536725087, 'auprc': 0.6951656260171452, 'loss_val': 1.321497870223356, 'psi': 0.3692179226103633}
[S14] START round=2 head_norm_before_train=0.866521 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.220642 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7352755241720803, 'loss_val': 1.3387954059972502, 'psi': 0.37832492139845436}-{'f1_val': 0.14035785288270378, 'auprc': 0.5882459318363797, 'loss_val': 1.3389912872564085, 'psi': 0.31951308446417415}
[S15] START round=2 head_norm_before_train=1.173237 (no previous merge yet)
[S15] round=2 local utility u=0.022208 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7879966202177707, 'loss_val': 1.2750560498603598, 'psi': 0.3990388389040433}-{'f1_val': 0.13973365136155833, 'auprc': 0.7856421323944772, 'loss_val': 1.3124080941970495, 'psi': 0.39809704377472593}
[S16] START round=2 head_norm_before_train=1.145174 (no previous merge yet)
[S16] round=2 local utility u=0.122361 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9866858576413063, 'loss_val': 1.2796703875492634, 'psi': 0.4790568131760444}-{'f1_val': 0.18588730911005794, 'auprc': 0.8286806865155615, 'loss_val': 1.3218770164603852, 'psi': 0.4430046600722594}
[S17] START round=2 head_norm_before_train=0.825419 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5994582271983765, 'loss_val': 1.3419572017484902, 'psi': 0.3243526688697812}-{'f1_val': 0.2452263801133961, 'auprc': 0.6501386965464253, 'loss_val': 1.340690947411863, 'psi': 0.4071913066866078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:63510
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:63513
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:63517
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:63502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:63511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:63502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:63510
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=-0.1095
[S5] DROPPED delta from S9 (cos=-0.1095 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S6
[S2] cosine check vs S6: cos=0.6629
[S17] RECEIVED delta(kind=head bytes=1793) from S14
[S17] cosine check vs S14: cos=0.5160
[S13] RECEIVED delta(kind=head bytes=1793) from S15
[S13] cosine check vs S15: cos=-0.0112
[S13] DROPPED delta from S15 (cos=-0.0112 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] cosine check vs S4: cos=-0.1542
[S9] DROPPED delta from S4 (cos=-0.1542 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S3
[S2] cosine check vs S3: cos=0.0188
[S9] RECEIVED delta(kind=head bytes=1788) from S10
[S9] cosine check vs S10: cos=0.0463
[S10] RECEIVED delta(kind=head bytes=1793) from S16
[S10] cosine check vs S16: cos=-0.0604
[S10] DROPPED delta from S16 (cos=-0.0604 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.854962
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.428428e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.726559 delta_norm=0.442843
[S2] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.244643
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.509453e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.784758 delta_norm=0.750945
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=0.846969
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.265677e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.754445 delta_norm=0.426568
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.726559 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6317248072902001, 'loss_val': 1.2982454159719568, 'psi': 0.3377562029492201}-{'f1_val': 0.1417771333885667, 'auprc': 0.785542621975196, 'loss_val': 1.311236115628001, 'psi': 0.39928332882321843}
[S3] START round=3 head_norm_before_train=1.149607 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.574472885405725, 'loss_val': 1.2482007656855076, 'psi': 0.31369319353075426}-{'f1_val': 0.13984006561410703, 'auprc': 0.6757482193249364, 'loss_val': 1.2926326757822935, 'psi': 0.3542033270984388}
[S4] START round=3 head_norm_before_train=1.193487 (no previous merge yet)
[S4] round=3 local utility u=0.220823 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7811517059579745, 'loss_val': 1.2226691387377326, 'psi': 0.3965966597203003}-{'f1_val': 0.14022662889518414, 'auprc': 0.654807092952771, 'loss_val': 1.2852811985818777, 'psi': 0.34605881451821885}
[S5] START round=3 head_norm_before_train=1.224373 (no previous merge yet)
[S5] round=3 local utility u=0.026686 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7334362438236118, 'loss_val': 1.2351863531121126, 'psi': 0.3787316403865876}-{'f1_val': 0.14226190476190476, 'auprc': 0.7288593911490349, 'loss_val': 1.274827277754675, 'psi': 0.3769008993167568}
[S6] START round=3 head_norm_before_train=1.138115 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6882895730197659, 'loss_val': 1.2414784141178368, 'psi': 0.3601715984386756}-{'f1_val': 0.14142628205128205, 'auprc': 0.8792447164774672, 'loss_val': 1.2873257540703782, 'psi': 0.4365536558217561}
[S7] START round=3 head_norm_before_train=1.259130 (no previous merge yet)
[S7] round=3 local utility u=0.023973 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7817323610758891, 'loss_val': 1.273409461898588, 'psi': 0.39792703806781066}-{'f1_val': 0.14205682272909165, 'auprc': 0.780353066467834, 'loss_val': 1.317217216787496, 'psi': 0.3973753202245886}
[S8] START round=3 head_norm_before_train=1.251943 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7292889647749833, 'loss_val': 1.2112673642214429, 'psi': 0.3756891753457676}-{'f1_val': 0.39952357775973213, 'auprc': 0.7401671146381917, 'loss_val': 1.2697484341917622, 'psi': 0.535780992511116}
[S9] START round=3 head_norm_before_train=0.784758 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9983048645502356, 'loss_val': 1.2713042610729013, 'psi': 0.4841607201040919}-{'f1_val': 0.141397957139996, 'auprc': 0.9994363554296948, 'loss_val': 1.2676635854252132, 'psi': 0.4846133164558755}
[S10] START round=3 head_norm_before_train=0.900218 cos_to_last_merge=0.9970 (last merge round=1)
[S10] round=3 local utility u=0.024188 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.634259801423998, 'loss_val': 1.3053149555196384, 'psi': 0.33687690309463353}-{'f1_val': 0.13862163754172394, 'auprc': 0.6302755180086597, 'loss_val': 1.3417377382519509, 'psi': 0.33528318972849824}
[S11] START round=3 head_norm_before_train=1.223603 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5965457251587506, 'loss_val': 1.1997365315501645, 'psi': 0.3228665000873666}-{'f1_val': 0.14041368337311058, 'auprc': 0.6545677805867285, 'loss_val': 1.2653162513021134, 'psi': 0.34607532225855775}
[S13] START round=3 head_norm_before_train=1.167891 (no previous merge yet)
[S13] round=3 local utility u=0.046189 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6134360267295107, 'loss_val': 1.2457531181618844, 'psi': 0.32960586823803617}-{'f1_val': 0.1403857625770531, 'auprc': 0.5977772599209065, 'loss_val': 1.2911551412113542, 'psi': 0.32334236151459445}
[S14] START round=3 head_norm_before_train=0.885967 cos_to_last_merge=0.9972 (last merge round=1)
[S14] round=3 local utility u=0.011878 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7320964017610513, 'loss_val': 1.3055019499653535, 'psi': 0.3770532724340428}-{'f1_val': 0.14035785288270378, 'auprc': 0.7352755241720803, 'loss_val': 1.3387954059972502, 'psi': 0.37832492139845436}
[S15] START round=3 head_norm_before_train=1.195991 (no previous merge yet)
[S15] round=3 local utility u=0.004625 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7754872941343381, 'loss_val': 1.2282786949509117, 'psi': 0.3940351084706703}-{'f1_val': 0.13973365136155833, 'auprc': 0.7879966202177707, 'loss_val': 1.2750560498603598, 'psi': 0.3990388389040433}
[S16] START round=3 head_norm_before_train=1.167327 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8629932437111982, 'loss_val': 1.239107626912988, 'psi': 0.4295797676040012}-{'f1_val': 0.14063745019920318, 'auprc': 0.9866858576413063, 'loss_val': 1.2796703875492634, 'psi': 0.4790568131760444}
[S17] START round=3 head_norm_before_train=0.754445 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5532465472794579, 'loss_val': 1.3361371236990407, 'psi': 0.3058679969022138}-{'f1_val': 0.14094896331738438, 'auprc': 0.5994582271983765, 'loss_val': 1.3419572017484902, 'psi': 0.3243526688697812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S7] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:63517
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:63516
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63509
[S7] sending update (kind=head size=1787 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.1357
[S16] RECEIVED delta(kind=head bytes=1795) from S4
[S16] cosine check vs S4: cos=-0.0571
[S16] DROPPED delta from S4 (cos=-0.0571 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S13
[S8] cosine check vs S13: cos=-0.0529
[S8] DROPPED delta from S13 (cos=-0.0529 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S15
[S4] cosine check vs S15: cos=0.0127
[S15] RECEIVED delta(kind=head bytes=1791) from S5
[S15] cosine check vs S5: cos=-0.0564
[S15] DROPPED delta from S5 (cos=-0.0564 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S10
[S17] cosine check vs S10: cos=-0.1038
[S17] DROPPED delta from S10 (cos=-0.1038 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1787) from S7
[S17] cosine check vs S7: cos=-0.0024
[S17] DROPPED delta from S7 (cos=-0.0024 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=1.284057
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.361066e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.837485 delta_norm=0.736107
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=1.228341
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.628802e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.873876 delta_norm=0.862880
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.751329 cos_to_last_merge=0.9950 (last merge round=2)
[S2] round=4 local utility u=0.003823 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6187361871240917, 'loss_val': 1.251633260760926, 'psi': 0.33256075488277675}-{'f1_val': 0.1417771333885667, 'auprc': 0.6317248072902001, 'loss_val': 1.2982454159719568, 'psi': 0.3377562029492201}
[S3] START round=4 head_norm_before_train=1.173568 (no previous merge yet)
[S3] round=4 local utility u=0.082388 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.611876468424496, 'loss_val': 1.1956352767982092, 'psi': 0.3286546267382626}-{'f1_val': 0.13984006561410703, 'auprc': 0.574472885405725, 'loss_val': 1.2482007656855076, 'psi': 0.31369319353075426}
[S4] START round=4 head_norm_before_train=0.873876 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.012183 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7869132310793718, 'loss_val': 1.215588551106222, 'psi': 0.39890126976885926}-{'f1_val': 0.14022662889518414, 'auprc': 0.7811517059579745, 'loss_val': 1.2226691387377326, 'psi': 0.3965966597203003}
[S5] START round=4 head_norm_before_train=1.251722 (no previous merge yet)
[S5] round=4 local utility u=0.024982 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7389391212854534, 'loss_val': 1.2017306692738297, 'psi': 0.3809327913713242}-{'f1_val': 0.14226190476190476, 'auprc': 0.7334362438236118, 'loss_val': 1.2351863531121126, 'psi': 0.3787316403865876}
[S6] START round=4 head_norm_before_train=1.161945 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6137454430870917, 'loss_val': 1.2104465141166632, 'psi': 0.3303539464656059}-{'f1_val': 0.14142628205128205, 'auprc': 0.6882895730197659, 'loss_val': 1.2414784141178368, 'psi': 0.3601715984386756}
[S7] START round=4 head_norm_before_train=1.285738 (no previous merge yet)
[S7] round=4 local utility u=0.002477 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7747817792140335, 'loss_val': 1.2476029900738828, 'psi': 0.3951468053230684}-{'f1_val': 0.14205682272909165, 'auprc': 0.7817323610758891, 'loss_val': 1.273409461898588, 'psi': 0.39792703806781066}
[S8] START round=4 head_norm_before_train=0.837485 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7144696844751641, 'loss_val': 1.2013904304997056, 'psi': 0.36976146322583997}-{'f1_val': 0.13995598239295717, 'auprc': 0.7292889647749833, 'loss_val': 1.2112673642214429, 'psi': 0.3756891753457676}
[S9] START round=4 head_norm_before_train=0.810440 cos_to_last_merge=0.9971 (last merge round=2)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9729732844805618, 'loss_val': 1.2250961972530876, 'psi': 0.4740280880762223}-{'f1_val': 0.141397957139996, 'auprc': 0.9983048645502356, 'loss_val': 1.2713042610729013, 'psi': 0.4841607201040919}
[S10] START round=4 head_norm_before_train=0.925226 cos_to_last_merge=0.9893 (last merge round=1)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6132514057635632, 'loss_val': 1.2513604858058884, 'psi': 0.32847354483045965}-{'f1_val': 0.13862163754172394, 'auprc': 0.634259801423998, 'loss_val': 1.3053149555196384, 'psi': 0.33687690309463353}
[S11] START round=4 head_norm_before_train=1.261503 (no previous merge yet)
[S11] round=4 local utility u=0.171021 metrics={'f1_val': 0.18074942978168784, 'auprc': 0.5984793169802557, 'loss_val': 1.105509691976135, 'psi': 0.347841384661115}-{'f1_val': 0.14041368337311058, 'auprc': 0.5965457251587506, 'loss_val': 1.1997365315501645, 'psi': 0.3228665000873666}
[S13] START round=4 head_norm_before_train=1.192966 (no previous merge yet)
[S13] round=4 local utility u=0.201814 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7291349381123774, 'loss_val': 1.1892216864542533, 'psi': 0.3758854327911828}-{'f1_val': 0.1403857625770531, 'auprc': 0.6134360267295107, 'loss_val': 1.2457531181618844, 'psi': 0.32960586823803617}
[S14] START round=4 head_norm_before_train=0.915241 cos_to_last_merge=0.9899 (last merge round=1)
[S14] round=4 local utility u=0.023170 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7326651816612187, 'loss_val': 1.2608673939949873, 'psi': 0.3772807843941098}-{'f1_val': 0.14035785288270378, 'auprc': 0.7320964017610513, 'loss_val': 1.3055019499653535, 'psi': 0.3770532724340428}
[S15] START round=4 head_norm_before_train=1.227852 (no previous merge yet)
[S15] round=4 local utility u=0.024699 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7764127751385945, 'loss_val': 1.1816578586244106, 'psi': 0.39440530087237285}-{'f1_val': 0.13973365136155833, 'auprc': 0.7754872941343381, 'loss_val': 1.2282786949509117, 'psi': 0.3940351084706703}
[S16] START round=4 head_norm_before_train=1.194700 (no previous merge yet)
[S16] round=4 local utility u=0.001114 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8524888152913553, 'loss_val': 1.2053656316063583, 'psi': 0.4253779962360641}-{'f1_val': 0.14063745019920318, 'auprc': 0.8629932437111982, 'loss_val': 1.239107626912988, 'psi': 0.4295797676040012}
[S17] START round=4 head_norm_before_train=0.774969 cos_to_last_merge=0.9950 (last merge round=2)
[S17] round=4 local utility u=0.034337 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5596903256904899, 'loss_val': 1.2867938918610489, 'psi': 0.30844550826662664}-{'f1_val': 0.14094896331738438, 'auprc': 0.5532465472794579, 'loss_val': 1.3361371236990407, 'psi': 0.3058679969022138}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63514
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:63508
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S13
[S8] cosine check vs S13: cos=-0.0386
[S8] DROPPED delta from S13 (cos=-0.0386 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] cosine check vs S4: cos=-0.0545
[S16] DROPPED delta from S4 (cos=-0.0545 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=-0.0573
[S7] DROPPED delta from S16 (cos=-0.0573 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S5
[S15] cosine check vs S5: cos=-0.0577
[S15] DROPPED delta from S5 (cos=-0.0577 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] cosine check vs S14: cos=0.6381
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] cosine check vs S15: cos=0.6846
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=0.1044
[S14] RECEIVED delta(kind=head bytes=1798) from S2
[S14] cosine check vs S2: cos=-0.0368
[S14] DROPPED delta from S2 (cos=-0.0368 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] cosine check vs S11: cos=-0.0303
[S5] DROPPED delta from S11 (cos=-0.0303 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1789) from S7
[S17] cosine check vs S7: cos=0.0102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S17
[S13] cosine check vs S17: cos=-0.0091
[S13] DROPPED delta from S17 (cos=-0.0091 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=1.186530
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.965324e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.884509 delta_norm=0.796532
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=0.871127
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.893517e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.1400 head_norm=0.824903 delta_norm=0.389352
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.905754
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.583839e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1402 head_norm=0.994511 delta_norm=0.458384
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.807569
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.689547e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.775967 delta_norm=0.768955
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.777972 cos_to_last_merge=0.9846 (last merge round=2)
[S2] round=5 local utility u=0.018100 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6152433397137156, 'loss_val': 1.2049545955441918, 'psi': 0.33116361591862625}-{'f1_val': 0.1417771333885667, 'auprc': 0.6187361871240917, 'loss_val': 1.251633260760926, 'psi': 0.33256075488277675}
[S3] START round=5 head_norm_before_train=1.194064 (no previous merge yet)
[S3] round=5 local utility u=0.062991 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6243714002115386, 'loss_val': 1.1071372912974387, 'psi': 0.3336525994530797}-{'f1_val': 0.13984006561410703, 'auprc': 0.611876468424496, 'loss_val': 1.1956352767982092, 'psi': 0.3286546267382626}
[S4] START round=5 head_norm_before_train=0.994511 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.013167 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.783789800346632, 'loss_val': 1.1798851417480478, 'psi': 0.3976518974757633}-{'f1_val': 0.14022662889518414, 'auprc': 0.7869132310793718, 'loss_val': 1.215588551106222, 'psi': 0.39890126976885926}
[S5] START round=5 head_norm_before_train=1.271795 (no previous merge yet)
[S5] round=5 local utility u=0.069167 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7701010246366488, 'loss_val': 1.15688238885871, 'psi': 0.3933975527118024}-{'f1_val': 0.14226190476190476, 'auprc': 0.7389391212854534, 'loss_val': 1.2017306692738297, 'psi': 0.3809327913713242}
[S6] START round=5 head_norm_before_train=0.884509 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.013541 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6197168289423363, 'loss_val': 1.20127774603479, 'psi': 0.33274250080770373}-{'f1_val': 0.14142628205128205, 'auprc': 0.6137454430870917, 'loss_val': 1.2104465141166632, 'psi': 0.3303539464656059}
[S7] START round=5 head_norm_before_train=1.317066 (no previous merge yet)
[S7] round=5 local utility u=0.018294 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774822536834994, 'loss_val': 1.2191173964448185, 'psi': 0.3962269951108548}-{'f1_val': 0.14205682272909165, 'auprc': 0.7747817792140335, 'loss_val': 1.2476029900738828, 'psi': 0.3951468053230684}
[S8] START round=5 head_norm_before_train=0.824903 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.250484 metrics={'f1_val': 0.20212799756570143, 'auprc': 0.7450064314305951, 'loss_val': 1.1650649590862623, 'psi': 0.4192793711116589}-{'f1_val': 0.13995598239295717, 'auprc': 0.7144696844751641, 'loss_val': 1.2013904304997056, 'psi': 0.36976146322583997}
[S9] START round=5 head_norm_before_train=0.846069 cos_to_last_merge=0.9889 (last merge round=2)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8859147522827766, 'loss_val': 1.1694654173692345, 'psi': 0.43920467519710826}-{'f1_val': 0.141397957139996, 'auprc': 0.9729732844805618, 'loss_val': 1.2250961972530876, 'psi': 0.4740280880762223}
[S10] START round=5 head_norm_before_train=0.957231 cos_to_last_merge=0.9776 (last merge round=1)
[S10] round=5 local utility u=0.004299 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6067609181331105, 'loss_val': 1.2232901360534516, 'psi': 0.32587734977827854}-{'f1_val': 0.13862163754172394, 'auprc': 0.6132514057635632, 'loss_val': 1.2513604858058884, 'psi': 0.32847354483045965}
[S11] START round=5 head_norm_before_train=1.298692 (no previous merge yet)
[S11] round=5 local utility u=1.000000 metrics={'f1_val': 0.41160296728347745, 'auprc': 0.7938286416830885, 'loss_val': 0.9524040047832689, 'psi': 0.5644932370433219}-{'f1_val': 0.18074942978168784, 'auprc': 0.5984793169802557, 'loss_val': 1.105509691976135, 'psi': 0.347841384661115}
[S13] START round=5 head_norm_before_train=1.222211 (no previous merge yet)
[S13] round=5 local utility u=0.834826 metrics={'f1_val': 0.4035163611639676, 'auprc': 0.736151322959981, 'loss_val': 1.1194015025652155, 'psi': 0.536570345882373}-{'f1_val': 0.1403857625770531, 'auprc': 0.7291349381123774, 'loss_val': 1.1892216864542533, 'psi': 0.3758854327911828}
[S14] START round=5 head_norm_before_train=0.951450 cos_to_last_merge=0.9794 (last merge round=1)
[S14] round=5 local utility u=0.044811 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7392575292288369, 'loss_val': 1.191022871682477, 'psi': 0.37991772342115704}-{'f1_val': 0.14035785288270378, 'auprc': 0.7326651816612187, 'loss_val': 1.2608673939949873, 'psi': 0.3772807843941098}
[S15] START round=5 head_norm_before_train=1.256164 (no previous merge yet)
[S15] round=5 local utility u=0.883501 metrics={'f1_val': 0.4157993423538048, 'auprc': 0.7912698883619397, 'loss_val': 1.1156213841096916, 'psi': 0.5659875607570588}-{'f1_val': 0.13973365136155833, 'auprc': 0.7764127751385945, 'loss_val': 1.1816578586244106, 'psi': 0.39440530087237285}
[S16] START round=5 head_norm_before_train=1.225157 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6398540499975497, 'loss_val': 1.1477275496182624, 'psi': 0.3403240901185418}-{'f1_val': 0.14063745019920318, 'auprc': 0.8524888152913553, 'loss_val': 1.2053656316063583, 'psi': 0.4253779962360641}
[S17] START round=5 head_norm_before_train=0.775967 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.002850 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5453859120168149, 'loss_val': 1.2381812131209864, 'psi': 0.3027237427971566}-{'f1_val': 0.14094896331738438, 'auprc': 0.5596903256904899, 'loss_val': 1.2867938918610489, 'psi': 0.30844550826662664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63515
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:63517
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:63513
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] cosine check vs S7: cos=0.8271
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] cosine check vs S6: cos=0.0110
[S4] RECEIVED delta(kind=head bytes=1792) from S15
[S4] cosine check vs S15: cos=0.9210
[S17] RECEIVED delta(kind=head bytes=1799) from S10
[S17] cosine check vs S10: cos=0.4995
[S8] RECEIVED delta(kind=head bytes=1798) from S13
[S8] cosine check vs S13: cos=-0.0254
[S8] DROPPED delta from S13 (cos=-0.0254 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S2
[S14] cosine check vs S2: cos=-0.0458
[S14] DROPPED delta from S2 (cos=-0.0458 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] cosine check vs S4: cos=-0.0364
[S16] DROPPED delta from S4 (cos=-0.0364 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=-0.0282
[S5] DROPPED delta from S11 (cos=-0.0282 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.0645
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] cosine check vs S14: cos=0.8935
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=0.7320
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] cosine check vs S5: cos=-0.0602
[S15] DROPPED delta from S5 (cos=-0.0602 < 0.0)
[S17] sending update (kind=head size=1791 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1791) from S17
[S13] cosine check vs S17: cos=-0.0318
[S13] DROPPED delta from S17 (cos=-0.0318 < 0.0)
[S9] ⇄ pheromone p=0.363 → S16@127.0.0.1:63516
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.2021 head_norm=0.852115
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.231315e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1641 head_norm=0.896827 delta_norm=0.223131
[S8] aggregate: ROLLBACK (f1_val pre=0.202 post=0.164 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.460 → S15@127.0.0.1:63515
[S14] ⇄ pheromone p=0.382 → S8@127.0.0.1:63509
[S13] ⇄ pheromone p=0.533 → S8@127.0.0.1:63509
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.905490
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.159887e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.991164 delta_norm=0.415989
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.369 → S15@127.0.0.1:63515
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.4158 head_norm=1.282483
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.957644e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.4013 head_norm=0.725067 delta_norm=0.695764
[S15] aggregate: ROLLBACK (f1_val pre=0.416 post=0.401 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.511 → S4@127.0.0.1:63504
[S11] ⇄ pheromone p=0.636 → S5@127.0.0.1:63505
[S3] ⇄ pheromone p=0.365 → S6@127.0.0.1:63507
[S2] ⇄ pheromone p=0.332 → S14@127.0.0.1:63514
[S10] ⇄ pheromone p=0.335 → S17@127.0.0.1:63517
[S7] ⇄ pheromone p=0.417 → S17@127.0.0.1:63517
[S5] ⇄ pheromone p=0.379 → S15@127.0.0.1:63515
[S16] ⇄ pheromone p=0.365 → S7@127.0.0.1:63508
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=1.018302
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.627361e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1402 head_norm=1.127750 delta_norm=0.262736
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.388 → S16@127.0.0.1:63516
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.811675
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.519674e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.878903 delta_norm=0.351967
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.334 → S13@127.0.0.1:63513
[S2] START round=6 head_norm_before_train=0.814193 cos_to_last_merge=0.9689 (last merge round=2)
[S2] round=6 local utility u=0.218382 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7293024211264052, 'loss_val': 1.11036703117458, 'psi': 0.37678724848370215}-{'f1_val': 0.1417771333885667, 'auprc': 0.6152433397137156, 'loss_val': 1.2049545955441918, 'psi': 0.33116361591862625}
[S3] START round=6 head_norm_before_train=1.221062 (no previous merge yet)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.4224768768179887, 'auprc': 0.7954164926516871, 'loss_val': 0.95957819464088, 'psi': 0.5716527231514681}-{'f1_val': 0.13984006561410703, 'auprc': 0.6243714002115386, 'loss_val': 1.1071372912974387, 'psi': 0.3336525994530797}
[S4] START round=6 head_norm_before_train=1.127750 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.025218 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.780756163487189, 'loss_val': 1.1203483117436503, 'psi': 0.3964384427319861}-{'f1_val': 0.14022662889518414, 'auprc': 0.783789800346632, 'loss_val': 1.1798851417480478, 'psi': 0.3976518974757633}
[S5] START round=6 head_norm_before_train=1.284998 (no previous merge yet)
[S5] round=6 local utility u=0.850914 metrics={'f1_val': 0.41410323920690995, 'auprc': 0.7710024353506638, 'loss_val': 1.0888075237213346, 'psi': 0.5568629176644115}-{'f1_val': 0.14226190476190476, 'auprc': 0.7701010246366488, 'loss_val': 1.15688238885871, 'psi': 0.3933975527118024}
[S6] START round=6 head_norm_before_train=0.991164 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.177934 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7280993993047002, 'loss_val': 1.1705566563237804, 'psi': 0.3760955289526493}-{'f1_val': 0.14142628205128205, 'auprc': 0.6197168289423363, 'loss_val': 1.20127774603479, 'psi': 0.33274250080770373}
[S7] START round=6 head_norm_before_train=1.334455 (no previous merge yet)
[S7] round=6 local utility u=0.023867 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774870425299594, 'loss_val': 1.1713980706959075, 'psi': 0.39622891064943877}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774822536834994, 'loss_val': 1.2191173964448185, 'psi': 0.3962269951108548}
[S8] START round=6 head_norm_before_train=0.896827 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.706811 metrics={'f1_val': 0.41644030110281194, 'auprc': 0.7770810654878244, 'loss_val': 1.1335406201574967, 'psi': 0.5606966068568169}-{'f1_val': 0.20212799756570143, 'auprc': 0.7450064314305951, 'loss_val': 1.1650649590862623, 'psi': 0.4192793711116589}
[S9] START round=6 head_norm_before_train=0.872445 cos_to_last_merge=0.9818 (last merge round=2)
[S9] round=6 local utility u=0.396094 metrics={'f1_val': 0.20089443104572074, 'auprc': 0.999881904535822, 'loss_val': 1.0761585474990065, 'psi': 0.5204894204417613}-{'f1_val': 0.141397957139996, 'auprc': 0.8859147522827766, 'loss_val': 1.1694654173692345, 'psi': 0.43920467519710826}
[S10] START round=6 head_norm_before_train=0.989930 cos_to_last_merge=0.9649 (last merge round=1)
[S10] round=6 local utility u=0.063814 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6313111303682998, 'loss_val': 1.1693130909757627, 'psi': 0.3356974346723543}-{'f1_val': 0.13862163754172394, 'auprc': 0.6067609181331105, 'loss_val': 1.2232901360534516, 'psi': 0.32587734977827854}
[S11] START round=6 head_norm_before_train=1.339518 (no previous merge yet)
[S11] round=6 local utility u=0.354328 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9985224097501455, 'loss_val': 0.7671207680222987, 'psi': 0.6372999498964877}-{'f1_val': 0.41160296728347745, 'auprc': 0.7938286416830885, 'loss_val': 0.9524040047832689, 'psi': 0.5644932370433219}
[S13] START round=6 head_norm_before_train=1.243810 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.41662964849357986, 'auprc': 0.5974233614460449, 'loss_val': 1.0576587293076607, 'psi': 0.4889471336745659}-{'f1_val': 0.4035163611639676, 'auprc': 0.736151322959981, 'loss_val': 1.1194015025652155, 'psi': 0.536570345882373}
[S14] START round=6 head_norm_before_train=0.990995 cos_to_last_merge=0.9680 (last merge round=1)
[S14] round=6 local utility u=0.468947 metrics={'f1_val': 0.2605729843686849, 'auprc': 0.7679651178589338, 'loss_val': 1.0605423400500915, 'psi': 0.4635298377647845}-{'f1_val': 0.14035785288270378, 'auprc': 0.7392575292288369, 'loss_val': 1.191022871682477, 'psi': 0.37991772342115704}
[S15] START round=6 head_norm_before_train=0.725067 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.41599167481162613, 'auprc': 0.7345146565106291, 'loss_val': 1.086696194800012, 'psi': 0.5434008674912273}-{'f1_val': 0.4157993423538048, 'auprc': 0.7912698883619397, 'loss_val': 1.1156213841096916, 'psi': 0.5659875607570588}
[S16] START round=6 head_norm_before_train=1.252541 (no previous merge yet)
[S16] round=6 local utility u=0.749460 metrics={'f1_val': 0.41742175001598325, 'auprc': 0.5510573648093964, 'loss_val': 1.0431226007815322, 'psi': 0.4708759959333485}-{'f1_val': 0.14063745019920318, 'auprc': 0.6398540499975497, 'loss_val': 1.1477275496182624, 'psi': 0.3403240901185418}
[S17] START round=6 head_norm_before_train=0.878903 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.014707 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5305429484296234, 'loss_val': 1.1642379266887315, 'psi': 0.29678655736228}-{'f1_val': 0.14094896331738438, 'auprc': 0.5453859120168149, 'loss_val': 1.2381812131209864, 'psi': 0.3027237427971566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S6] → sending delta(kind=head bytes=1786) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:63507
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:63513
[S6] sending update (kind=head size=1786 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1786) from S6
[S15] cosine check vs S6: cos=0.2786
[S15] RECEIVED delta(kind=head bytes=1789) from S5
[S15] cosine check vs S5: cos=-0.0452
[S15] DROPPED delta from S5 (cos=-0.0452 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=0.9376
[S15] RECEIVED delta(kind=head bytes=1793) from S8
[S15] cosine check vs S8: cos=0.3413
[S14] RECEIVED delta(kind=head bytes=1800) from S2
[S14] cosine check vs S2: cos=-0.0518
[S14] DROPPED delta from S2 (cos=-0.0518 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.0614
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=-0.0438
[S7] DROPPED delta from S16 (cos=-0.0438 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1788) from S4
[S16] cosine check vs S4: cos=-0.0267
[S16] DROPPED delta from S4 (cos=-0.0267 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.9630
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=-0.0277
[S5] DROPPED delta from S11 (cos=-0.0277 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S10
[S17] cosine check vs S10: cos=0.7373
[S17] RECEIVED delta(kind=head bytes=1795) from S7
[S17] cosine check vs S7: cos=0.9296
[S17] sending update (kind=head size=1788 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1788) from S17
[S13] cosine check vs S17: cos=-0.0360
[S13] DROPPED delta from S17 (cos=-0.0360 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=1.008969
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.351387e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=1.116410 delta_norm=0.235139
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.4160 head_norm=0.769340
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.849428e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.4119 head_norm=0.613270 delta_norm=0.384943
[S15] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4174 head_norm=1.278949
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.586928e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4174 head_norm=0.803886 delta_norm=0.758693
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.4164 head_norm=0.912287
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.459444e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.4166 head_norm=0.965000 delta_norm=0.145944
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.1409 head_norm=0.909689
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.064271e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.1409 head_norm=0.975506 delta_norm=0.206427
[S17] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.851700 cos_to_last_merge=0.9511 (last merge round=2)
[S2] round=7 local utility u=0.859358 metrics={'f1_val': 0.39382506725894195, 'auprc': 0.7758617113348663, 'loss_val': 1.043616329092624, 'psi': 0.5466397248893117}-{'f1_val': 0.1417771333885667, 'auprc': 0.7293024211264052, 'loss_val': 1.11036703117458, 'psi': 0.37678724848370215}
[S3] START round=7 head_norm_before_train=1.259089 (no previous merge yet)
[S3] round=7 local utility u=0.675567 metrics={'f1_val': 0.6262628560238823, 'auprc': 0.796163887638416, 'loss_val': 0.8334020334877934, 'psi': 0.6942232686696957}-{'f1_val': 0.4224768768179887, 'auprc': 0.7954164926516871, 'loss_val': 0.95957819464088, 'psi': 0.5716527231514681}
[S4] START round=7 head_norm_before_train=1.143704 cos_to_last_merge=0.9971 (last merge round=5)
[S4] round=7 local utility u=1.000000 metrics={'f1_val': 0.6759415377614806, 'auprc': 0.7683116729026157, 'loss_val': 1.0225145417837915, 'psi': 0.7128895918179345}-{'f1_val': 0.14022662889518414, 'auprc': 0.780756163487189, 'loss_val': 1.1203483117436503, 'psi': 0.3964384427319861}
[S5] START round=7 head_norm_before_train=1.305220 (no previous merge yet)
[S5] round=7 local utility u=0.072629 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.777790264552747, 'loss_val': 0.9833833132757146, 'psi': 0.561525134976232}-{'f1_val': 0.41410323920690995, 'auprc': 0.7710024353506638, 'loss_val': 1.0888075237213346, 'psi': 0.5568629176644115}
[S6] START round=7 head_norm_before_train=1.116410 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.818783 metrics={'f1_val': 0.39016757728461127, 'auprc': 0.7502532412345065, 'loss_val': 1.0918999700767182, 'psi': 0.5342018428645694}-{'f1_val': 0.14142628205128205, 'auprc': 0.7280993993047002, 'loss_val': 1.1705566563237804, 'psi': 0.3760955289526493}
[S7] START round=7 head_norm_before_train=1.348389 (no previous merge yet)
[S7] round=7 local utility u=0.866582 metrics={'f1_val': 0.4166714190153544, 'auprc': 0.7773067688498811, 'loss_val': 1.0853810459918873, 'psi': 0.5609255589491651}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774870425299594, 'loss_val': 1.1713980706959075, 'psi': 0.39622891064943877}
[S8] START round=7 head_norm_before_train=0.965000 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7723141297612162, 'loss_val': 1.047096256627775, 'psi': 0.5326450722177924}-{'f1_val': 0.41644030110281194, 'auprc': 0.7770810654878244, 'loss_val': 1.1335406201574967, 'psi': 0.5606966068568169}
[S9] START round=7 head_norm_before_train=0.898880 cos_to_last_merge=0.9744 (last merge round=2)
[S9] round=7 local utility u=0.712458 metrics={'f1_val': 0.4171768373604544, 'auprc': 0.990277373940351, 'loss_val': 0.9201233745426535, 'psi': 0.6464170519924131}-{'f1_val': 0.20089443104572074, 'auprc': 0.999881904535822, 'loss_val': 1.0761585474990065, 'psi': 0.5204894204417613}
[S10] START round=7 head_norm_before_train=1.010570 cos_to_last_merge=0.9579 (last merge round=1)
[S10] round=7 local utility u=0.979711 metrics={'f1_val': 0.41652587907229816, 'auprc': 0.7049960641852542, 'loss_val': 1.0983712732211772, 'psi': 0.5319139531174806}-{'f1_val': 0.13862163754172394, 'auprc': 0.6313111303682998, 'loss_val': 1.1693130909757627, 'psi': 0.3356974346723543}
[S11] START round=7 head_norm_before_train=1.390501 (no previous merge yet)
[S11] round=7 local utility u=0.015043 metrics={'f1_val': 0.3946484430183044, 'auprc': 0.9883410728782044, 'loss_val': 0.6954720761994841, 'psi': 0.6321254949622643}-{'f1_val': 0.396484976660716, 'auprc': 0.9985224097501455, 'loss_val': 0.7671207680222987, 'psi': 0.6372999498964877}
[S13] START round=7 head_norm_before_train=1.264957 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.37180707378505273, 'auprc': 0.5853202736820127, 'loss_val': 0.9637839866452352, 'psi': 0.45721235374383673}-{'f1_val': 0.41662964849357986, 'auprc': 0.5974233614460449, 'loss_val': 1.0576587293076607, 'psi': 0.4889471336745659}
[S14] START round=7 head_norm_before_train=1.035753 cos_to_last_merge=0.9560 (last merge round=1)
[S14] round=7 local utility u=0.711149 metrics={'f1_val': 0.3964292957175209, 'auprc': 0.9178707605865254, 'loss_val': 0.9030985238264396, 'psi': 0.6050058816651227}-{'f1_val': 0.2605729843686849, 'auprc': 0.7679651178589338, 'loss_val': 1.0605423400500915, 'psi': 0.4635298377647845}
[S15] START round=7 head_norm_before_train=0.613270 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.416839147538149, 'auprc': 0.6299076092621663, 'loss_val': 1.041070975686445, 'psi': 0.5020665322277559}-{'f1_val': 0.41599167481162613, 'auprc': 0.7345146565106291, 'loss_val': 1.086696194800012, 'psi': 0.5434008674912273}
[S16] START round=7 head_norm_before_train=0.803886 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.011404 metrics={'f1_val': 0.41719231679200464, 'auprc': 0.544786131423499, 'loss_val': 1.0001251149670574, 'psi': 0.4682298426446023}-{'f1_val': 0.41742175001598325, 'auprc': 0.5510573648093964, 'loss_val': 1.0431226007815322, 'psi': 0.4708759959333485}
[S17] START round=7 head_norm_before_train=0.975506 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.747114 metrics={'f1_val': 0.38161576354679805, 'auprc': 0.5145840910115852, 'loss_val': 1.0661333775593866, 'psi': 0.43480309453271293}-{'f1_val': 0.14094896331738438, 'auprc': 0.5305429484296234, 'loss_val': 1.1642379266887315, 'psi': 0.29678655736228}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:63517
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:63517
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1793) from S5
[S15] cosine check vs S5: cos=-0.0237
[S15] DROPPED delta from S5 (cos=-0.0237 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S2
[S14] cosine check vs S2: cos=-0.0601
[S14] DROPPED delta from S2 (cos=-0.0601 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.5900
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=-0.0472
[S16] DROPPED delta from S4 (cos=-0.0472 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=0.9767
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.9791
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:63508
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] cosine check vs S17: cos=-0.0393
[S13] DROPPED delta from S17 (cos=-0.0393 < 0.0)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=0.9354
[S17] RECEIVED delta(kind=head bytes=1801) from S10
[S17] cosine check vs S10: cos=0.8034
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] cosine check vs S11: cos=-0.0277
[S5] DROPPED delta from S11 (cos=-0.0277 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.2070
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:63515
[S6] sending update (kind=head size=1791 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1791) from S6
[S15] cosine check vs S6: cos=0.5312
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.3729 head_norm=0.984633
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.178451e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3729 head_norm=1.030912 delta_norm=0.117845
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4172 head_norm=0.847509
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.066158e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4173 head_norm=0.796946 delta_norm=0.406616
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4167 head_norm=1.371518
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.276961e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4163 head_norm=0.877568 delta_norm=0.727696
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4168 head_norm=0.657341
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.816944e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4170 head_norm=0.792762 delta_norm=0.481694
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3816 head_norm=1.006204
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.467767e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.2598 head_norm=1.043472 delta_norm=0.146777
[S17] aggregate: ROLLBACK (f1_val pre=0.382 post=0.260 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.3902 head_norm=1.135299
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.553617e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.3382 head_norm=1.211459 delta_norm=0.155362
[S6] aggregate: ROLLBACK (f1_val pre=0.390 post=0.338 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=0.893383 cos_to_last_merge=0.9324 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.932
[S2] round=8 local utility u=0.789944 metrics={'f1_val': 0.6340030077081563, 'auprc': 0.7776712259687798, 'loss_val': 0.9102242619696709, 'psi': 0.6914702950124056}-{'f1_val': 0.39382506725894195, 'auprc': 0.7758617113348663, 'loss_val': 1.043616329092624, 'psi': 0.5466397248893117}
[S3] START round=8 head_norm_before_train=1.301781 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.4045316402820668, 'auprc': 0.8268170021820631, 'loss_val': 0.7475708101238754, 'psi': 0.5734457850420653}-{'f1_val': 0.6262628560238823, 'auprc': 0.796163887638416, 'loss_val': 0.8334020334877934, 'psi': 0.6942232686696957}
[S4] START round=8 head_norm_before_train=1.160996 cos_to_last_merge=0.9904 (last merge round=5)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6733369876728854, 'auprc': 0.6612918445198674, 'loss_val': 0.8725030607242354, 'psi': 0.6685189304116782}-{'f1_val': 0.6759415377614806, 'auprc': 0.7683116729026157, 'loss_val': 1.0225145417837915, 'psi': 0.7128895918179345}
[S5] START round=8 head_norm_before_train=1.333730 (no previous merge yet)
[S5] round=8 local utility u=0.051562 metrics={'f1_val': 0.41803043574602833, 'auprc': 0.7806069688637598, 'loss_val': 0.892802073608479, 'psi': 0.5630610489931209}-{'f1_val': 0.41734838192522206, 'auprc': 0.777790264552747, 'loss_val': 0.9833833132757146, 'psi': 0.561525134976232}
[S6] START round=8 head_norm_before_train=1.211459 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.154285 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.7672276115028567, 'loss_val': 0.9955822752623201, 'psi': 0.557124467325663}-{'f1_val': 0.39016757728461127, 'auprc': 0.7502532412345065, 'loss_val': 1.0918999700767182, 'psi': 0.5342018428645694}
[S7] START round=8 head_norm_before_train=0.877568 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.024357 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.7767926012810991, 'loss_val': 1.0375629498364924, 'psi': 0.5609637517226459}-{'f1_val': 0.4166714190153544, 'auprc': 0.7773067688498811, 'loss_val': 1.0853810459918873, 'psi': 0.5609255589491651}
[S8] START round=8 head_norm_before_train=1.030912 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.053648 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.7735653514217816, 'loss_val': 0.9423517902961915, 'psi': 0.5330253070309923}-{'f1_val': 0.3728657005221765, 'auprc': 0.7723141297612162, 'loss_val': 1.047096256627775, 'psi': 0.5326450722177924}
[S9] START round=8 head_norm_before_train=0.939493 cos_to_last_merge=0.9636 (last merge round=2)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.41685404846439245, 'auprc': 0.8662372089081332, 'loss_val': 0.7783586342800555, 'psi': 0.5966073126418887}-{'f1_val': 0.4171768373604544, 'auprc': 0.990277373940351, 'loss_val': 0.9201233745426535, 'psi': 0.6464170519924131}
[S10] START round=8 head_norm_before_train=1.043674 cos_to_last_merge=0.9488 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=8 local utility u=0.147575 metrics={'f1_val': 0.41689270364329833, 'auprc': 0.7475331989518968, 'loss_val': 0.9330339762081514, 'psi': 0.5491489017667377}-{'f1_val': 0.41652587907229816, 'auprc': 0.7049960641852542, 'loss_val': 1.0983712732211772, 'psi': 0.5319139531174806}
[S11] START round=8 head_norm_before_train=1.441899 (no previous merge yet)
[S11] round=8 local utility u=0.255889 metrics={'f1_val': 0.4581679508016735, 'auprc': 0.998457535295592, 'loss_val': 0.5951597756115758, 'psi': 0.6742837845992409}-{'f1_val': 0.3946484430183044, 'auprc': 0.9883410728782044, 'loss_val': 0.6954720761994841, 'psi': 0.6321254949622643}
[S13] START round=8 head_norm_before_train=1.303210 (no previous merge yet)
[S13] round=8 local utility u=0.410692 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.7331036160292639, 'loss_val': 0.8509304222294582, 'psi': 0.5428437661711827}-{'f1_val': 0.37180707378505273, 'auprc': 0.5853202736820127, 'loss_val': 0.9637839866452352, 'psi': 0.45721235374383673}
[S14] START round=8 head_norm_before_train=1.088040 cos_to_last_merge=0.9434 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=8 local utility u=0.223916 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9957220903329688, 'loss_val': 0.6894103476175817, 'psi': 0.6362053787803421}-{'f1_val': 0.3964292957175209, 'auprc': 0.9178707605865254, 'loss_val': 0.9030985238264396, 'psi': 0.6050058816651227}
[S15] START round=8 head_norm_before_train=0.792762 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.168766 metrics={'f1_val': 0.38372740901093455, 'auprc': 0.7997482976626721, 'loss_val': 1.0143914316212275, 'psi': 0.5501357644716296}-{'f1_val': 0.416839147538149, 'auprc': 0.6299076092621663, 'loss_val': 1.041070975686445, 'psi': 0.5020665322277559}
[S16] START round=8 head_norm_before_train=0.796946 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.4070057484252676, 'auprc': 0.5418686490317741, 'loss_val': 1.0340798380526999, 'psi': 0.46095090866787025}-{'f1_val': 0.41719231679200464, 'auprc': 0.544786131423499, 'loss_val': 1.0001251149670574, 'psi': 0.4682298426446023}
[S17] START round=8 head_norm_before_train=1.043472 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.004093 metrics={'f1_val': 0.3817428300479532, 'auprc': 0.5127039548151398, 'loss_val': 1.0530684776814097, 'psi': 0.4341272799548278}-{'f1_val': 0.38161576354679805, 'auprc': 0.5145840910115852, 'loss_val': 1.0661333775593866, 'psi': 0.43480309453271293}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63515
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63515
[S6] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1791) from S7
[S17] cosine check vs S7: cos=0.8585
[S17] RECEIVED delta(kind=head bytes=1800) from S10
[S17] cosine check vs S10: cos=0.8218
[S8] RECEIVED delta(kind=head bytes=1802) from S13
[S8] cosine check vs S13: cos=-0.0269
[S8] DROPPED delta from S13 (cos=-0.0269 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=0.2239
[S15] RECEIVED delta(kind=head bytes=1792) from S6
[S15] cosine check vs S6: cos=0.8972
[S14] RECEIVED delta(kind=head bytes=1794) from S2
[S14] cosine check vs S2: cos=-0.0651
[S14] DROPPED delta from S2 (cos=-0.0651 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S5
[S15] cosine check vs S5: cos=-0.0099
[S15] DROPPED delta from S5 (cos=-0.0099 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:63509
[S14] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S14
[S8] cosine check vs S14: cos=0.9818
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:63504
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:63505
[S15] sending update (kind=head size=1791 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S15
[S4] cosine check vs S15: cos=0.3522
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] cosine check vs S11: cos=-0.0301
[S5] DROPPED delta from S11 (cos=-0.0301 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1789 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1789) from S17
[S13] cosine check vs S17: cos=-0.0454
[S13] DROPPED delta from S17 (cos=-0.0454 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6733 head_norm=1.189693
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.921333e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6732 head_norm=0.833825 delta_norm=0.592133
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3727 head_norm=1.056971
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.131682e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3727 head_norm=1.094883 delta_norm=0.113168
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3817 head_norm=1.077947
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.051319e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3790 head_norm=0.971771 delta_norm=0.205132
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.3837 head_norm=0.822436
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.395831e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.3838 head_norm=0.781109 delta_norm=0.239583
[S15] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.941271 cos_to_last_merge=0.9136 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.914
[S2] round=9 local utility u=0.061571 metrics={'f1_val': 0.6925505655646086, 'auprc': 0.649340660964662, 'loss_val': 0.7533759365972248, 'psi': 0.67526660372463}-{'f1_val': 0.6340030077081563, 'auprc': 0.7776712259687798, 'loss_val': 0.9102242619696709, 'psi': 0.6914702950124056}
[S3] START round=9 head_norm_before_train=1.353088 (no previous merge yet)
[S3] round=9 local utility u=0.664140 metrics={'f1_val': 0.5367815047654385, 'auprc': 0.9708728772557804, 'loss_val': 0.6449575179233958, 'psi': 0.7104180537615753}-{'f1_val': 0.4045316402820668, 'auprc': 0.8268170021820631, 'loss_val': 0.7475708101238754, 'psi': 0.5734457850420653}
[S4] START round=9 head_norm_before_train=0.833825 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6620840604420879, 'auprc': 0.6652712301588083, 'loss_val': 0.8494670495467511, 'psi': 0.6633589283287761}-{'f1_val': 0.6733369876728854, 'auprc': 0.6612918445198674, 'loss_val': 0.8725030607242354, 'psi': 0.6685189304116782}
[S5] START round=9 head_norm_before_train=1.366300 (no previous merge yet)
[S5] round=9 local utility u=0.357808 metrics={'f1_val': 0.41823357465624633, 'auprc': 0.9819126302240806, 'loss_val': 0.782321094744462, 'psi': 0.64370519688338}-{'f1_val': 0.41803043574602833, 'auprc': 0.7806069688637598, 'loss_val': 0.892802073608479, 'psi': 0.5630610489931209}
[S6] START round=9 head_norm_before_train=1.234329 cos_to_last_merge=0.9980 (last merge round=7)
[S6] round=9 local utility u=0.480655 metrics={'f1_val': 0.5841380929760455, 'auprc': 0.7048271836377069, 'loss_val': 0.8495645639410371, 'psi': 0.63241372924071}-{'f1_val': 0.41705570454086727, 'auprc': 0.7672276115028567, 'loss_val': 0.9955822752623201, 'psi': 0.557124467325663}
[S7] START round=9 head_norm_before_train=0.913967 cos_to_last_merge=0.9978 (last merge round=7)
[S7] round=9 local utility u=0.051658 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7768553843199192, 'loss_val': 0.934180419737864, 'psi': 0.5609634100207366}-{'f1_val': 0.4170778520170104, 'auprc': 0.7767926012810991, 'loss_val': 1.0375629498364924, 'psi': 0.5609637517226459}
[S8] START round=9 head_norm_before_train=1.094883 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.176260 metrics={'f1_val': 0.3728649953480749, 'auprc': 0.8664717599790456, 'loss_val': 0.8697497920312447, 'psi': 0.5703077012004631}-{'f1_val': 0.3726652774371328, 'auprc': 0.7735653514217816, 'loss_val': 0.9423517902961915, 'psi': 0.5330253070309923}
[S9] START round=9 head_norm_before_train=0.988850 cos_to_last_merge=0.9507 (last merge round=2)
[S9] round=9 local utility u=0.351242 metrics={'f1_val': 0.43663606719311937, 'auprc': 0.9988565817196725, 'loss_val': 0.5924241770851059, 'psi': 0.6615242730037407}-{'f1_val': 0.41685404846439245, 'auprc': 0.8662372089081332, 'loss_val': 0.7783586342800555, 'psi': 0.5966073126418887}
[S10] START round=9 head_norm_before_train=1.082236 cos_to_last_merge=0.9367 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=9 local utility u=0.146125 metrics={'f1_val': 0.38606531465016714, 'auprc': 0.8581548241925905, 'loss_val': 0.7876848697608182, 'psi': 0.5749011184671364}-{'f1_val': 0.41689270364329833, 'auprc': 0.7475331989518968, 'loss_val': 0.9330339762081514, 'psi': 0.5491489017667377}
[S11] START round=9 head_norm_before_train=1.475906 (no previous merge yet)
[S11] round=9 local utility u=0.531834 metrics={'f1_val': 0.6238334229392883, 'auprc': 0.9989683967823824, 'loss_val': 0.5270174701474948, 'psi': 0.773887412476526}-{'f1_val': 0.4581679508016735, 'auprc': 0.998457535295592, 'loss_val': 0.5951597756115758, 'psi': 0.6742837845992409}
[S13] START round=9 head_norm_before_train=1.337409 (no previous merge yet)
[S13] round=9 local utility u=0.881815 metrics={'f1_val': 0.7108692824582878, 'auprc': 0.7141459045142569, 'loss_val': 0.7996193467579696, 'psi': 0.7121799312806755}-{'f1_val': 0.4160038662657951, 'auprc': 0.7331036160292639, 'loss_val': 0.8509304222294582, 'psi': 0.5428437661711827}
[S14] START round=9 head_norm_before_train=1.142787 cos_to_last_merge=0.9298 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=9 local utility u=0.411097 metrics={'f1_val': 0.5192716285819047, 'auprc': 0.9957329930076249, 'loss_val': 0.6037139071212201, 'psi': 0.7098561743521927}-{'f1_val': 0.39652757107859105, 'auprc': 0.9957220903329688, 'loss_val': 0.6894103476175817, 'psi': 0.6362053787803421}
[S15] START round=9 head_norm_before_train=0.781109 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.3837715202208868, 'auprc': 0.7032402064050993, 'loss_val': 0.9171861342124022, 'psi': 0.5115589946945718}-{'f1_val': 0.38372740901093455, 'auprc': 0.7997482976626721, 'loss_val': 1.0143914316212275, 'psi': 0.5501357644716296}
[S16] START round=9 head_norm_before_train=0.840053 cos_to_last_merge=0.9946 (last merge round=7)
[S16] round=9 local utility u=0.299983 metrics={'f1_val': 0.40389010231945366, 'auprc': 0.7167295771862099, 'loss_val': 0.9400036737789376, 'psi': 0.5290258922661562}-{'f1_val': 0.4070057484252676, 'auprc': 0.5418686490317741, 'loss_val': 1.0340798380526999, 'psi': 0.46095090866787025}
[S17] START round=9 head_norm_before_train=0.971771 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.054110 metrics={'f1_val': 0.37796817572720576, 'auprc': 0.5227974959517468, 'loss_val': 0.9524821483698472, 'psi': 0.4358999038170222}-{'f1_val': 0.3817428300479532, 'auprc': 0.5127039548151398, 'loss_val': 1.0530684776814097, 'psi': 0.4341272799548278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:63517
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63515
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] cosine check vs S16: cos=0.6704
[S15] RECEIVED delta(kind=head bytes=1792) from S5
[S15] cosine check vs S5: cos=-0.0096
[S15] DROPPED delta from S5 (cos=-0.0096 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] cosine check vs S3: cos=0.9726
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=0.9840
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=0.4477
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=0.8358
[S17] RECEIVED delta(kind=head bytes=1804) from S10
[S17] cosine check vs S10: cos=0.8481
[S17] RECEIVED delta(kind=head bytes=1791) from S7
[S17] cosine check vs S7: cos=0.8725
[S14] RECEIVED delta(kind=head bytes=1790) from S2
[S14] cosine check vs S2: cos=-0.0701
[S14] DROPPED delta from S2 (cos=-0.0701 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S9
[S16] cosine check vs S9: cos=0.8358
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] cosine check vs S11: cos=-0.0316
[S5] DROPPED delta from S11 (cos=-0.0316 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S13
[S8] cosine check vs S13: cos=-0.0298
[S8] DROPPED delta from S13 (cos=-0.0298 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] cosine check vs S17: cos=-0.0575
[S13] DROPPED delta from S17 (cos=-0.0575 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3729 head_norm=1.123424
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.095522e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3729 head_norm=1.154592 delta_norm=0.109552
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4170 head_norm=0.965451
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.788308e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4172 head_norm=0.849863 delta_norm=0.378831
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4039 head_norm=0.894127
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.861117e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4361 head_norm=0.927335 delta_norm=0.286112
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.5841 head_norm=1.259855
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.720489e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.6145 head_norm=1.323510 delta_norm=0.172049
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.3838 head_norm=0.814617
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.621890e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.3841 head_norm=0.812451 delta_norm=0.162189
[S15] aggregate: ACCEPT kept=['S8', 'S6'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3780 head_norm=1.012320
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.478699e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3783 head_norm=0.965497 delta_norm=0.147870
[S17] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.991776 cos_to_last_merge=0.8955 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.895
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.4019092272494149, 'auprc': 0.6444947077578066, 'loss_val': 0.685488239238982, 'psi': 0.49894341945277154}-{'f1_val': 0.6925505655646086, 'auprc': 0.649340660964662, 'loss_val': 0.7533759365972248, 'psi': 0.67526660372463}
[S3] START round=10 head_norm_before_train=1.405462 (no previous merge yet)
[S3] round=10 local utility u=0.587676 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9728311955435058, 'loss_val': 0.45827993517799975, 'psi': 0.8094813158126554}-{'f1_val': 0.5367815047654385, 'auprc': 0.9708728772557804, 'loss_val': 0.6449575179233958, 'psi': 0.7104180537615753}
[S4] START round=10 head_norm_before_train=0.874173 cos_to_last_merge=0.9955 (last merge round=8)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.39591564917910854, 'auprc': 0.82587212061798, 'loss_val': 0.7567686393823556, 'psi': 0.5678982377546571}-{'f1_val': 0.6620840604420879, 'auprc': 0.6652712301588083, 'loss_val': 0.8494670495467511, 'psi': 0.6633589283287761}
[S5] START round=10 head_norm_before_train=1.396374 (no previous merge yet)
[S5] round=10 local utility u=0.053250 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.9938294284866264, 'loss_val': 0.7074499618311413, 'psi': 0.6480597024991777}-{'f1_val': 0.41823357465624633, 'auprc': 0.9819126302240806, 'loss_val': 0.782321094744462, 'psi': 0.64370519688338}
[S6] START round=10 head_norm_before_train=1.323510 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.526286 metrics={'f1_val': 0.6953639365033542, 'auprc': 0.7951525686213421, 'loss_val': 0.7353240432019571, 'psi': 0.7352793893505494}-{'f1_val': 0.5841380929760455, 'auprc': 0.7048271836377069, 'loss_val': 0.8495645639410371, 'psi': 0.63241372924071}
[S7] START round=10 head_norm_before_train=0.849863 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7690287036600236, 'loss_val': 0.920241040990439, 'psi': 0.5577593397254841}-{'f1_val': 0.41703542715461484, 'auprc': 0.7768553843199192, 'loss_val': 0.934180419737864, 'psi': 0.5609634100207366}
[S8] START round=10 head_norm_before_train=1.154592 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.256760 metrics={'f1_val': 0.3728649953480749, 'auprc': 0.9921657409435896, 'loss_val': 0.7333109586154383, 'psi': 0.6205852935862808}-{'f1_val': 0.3728649953480749, 'auprc': 0.8664717599790456, 'loss_val': 0.8697497920312447, 'psi': 0.5703077012004631}
[S9] START round=10 head_norm_before_train=1.041228 cos_to_last_merge=0.9360 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.936
[S9] round=10 local utility u=0.854987 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9987384450356607, 'loss_val': 0.4715225672259794, 'psi': 0.8204197765354275}-{'f1_val': 0.43663606719311937, 'auprc': 0.9988565817196725, 'loss_val': 0.5924241770851059, 'psi': 0.6615242730037407}
[S10] START round=10 head_norm_before_train=1.127339 cos_to_last_merge=0.9225 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=10 local utility u=0.223401 metrics={'f1_val': 0.43685602004106616, 'auprc': 0.8647111547337473, 'loss_val': 0.6652960498679498, 'psi': 0.6079980739181385}-{'f1_val': 0.38606531465016714, 'auprc': 0.8581548241925905, 'loss_val': 0.7876848697608182, 'psi': 0.5749011184671364}
[S11] START round=10 head_norm_before_train=1.499938 (no previous merge yet)
[S11] round=10 local utility u=0.255276 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9989920322456546, 'loss_val': 0.48408885357979436, 'psi': 0.8206521758951406}-{'f1_val': 0.6238334229392883, 'auprc': 0.9989683967823824, 'loss_val': 0.5270174701474948, 'psi': 0.773887412476526}
[S13] START round=10 head_norm_before_train=1.365916 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5827758051848123, 'auprc': 0.6951106223337096, 'loss_val': 0.7829751560278608, 'psi': 0.6277097320443712}-{'f1_val': 0.7108692824582878, 'auprc': 0.7141459045142569, 'loss_val': 0.7996193467579696, 'psi': 0.7121799312806755}
[S14] START round=10 head_norm_before_train=1.195026 cos_to_last_merge=0.9164 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.916
[S14] round=10 local utility u=1.000000 metrics={'f1_val': 0.9921191644093458, 'auprc': 0.9957261886344626, 'loss_val': 0.5268363496414352, 'psi': 0.9935619740993925}-{'f1_val': 0.5192716285819047, 'auprc': 0.9957329930076249, 'loss_val': 0.6037139071212201, 'psi': 0.7098561743521927}
[S15] START round=10 head_norm_before_train=0.812451 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.264334 metrics={'f1_val': 0.3796937857464553, 'auprc': 0.8855287822373109, 'loss_val': 0.9109174460962375, 'psi': 0.5820277843427976}-{'f1_val': 0.3837715202208868, 'auprc': 0.7032402064050993, 'loss_val': 0.9171861342124022, 'psi': 0.5115589946945718}
[S16] START round=10 head_norm_before_train=0.927335 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3949345461905243, 'auprc': 0.7223690881833522, 'loss_val': 0.9306149822496075, 'psi': 0.5259083629876555}-{'f1_val': 0.40389010231945366, 'auprc': 0.7167295771862099, 'loss_val': 0.9400036737789376, 'psi': 0.5290258922661562}
[S17] START round=10 head_norm_before_train=0.965497 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.298858 metrics={'f1_val': 0.3812553087552733, 'auprc': 0.6967449771011283, 'loss_val': 0.8963321260221623, 'psi': 0.5074511760936153}-{'f1_val': 0.37796817572720576, 'auprc': 0.5227974959517468, 'loss_val': 0.9524821483698472, 'psi': 0.4358999038170222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:63507
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:63509
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] cosine check vs S11: cos=-0.0322
[S5] DROPPED delta from S11 (cos=-0.0322 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=0.7729
[S17] RECEIVED delta(kind=head bytes=1806) from S10
[S17] cosine check vs S10: cos=0.8568
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.9385
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.9858
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=0.9864
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:63504
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63515
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:63515
[S4] RECEIVED delta(kind=head bytes=1799) from S15
[S4] cosine check vs S15: cos=0.5989
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=-0.0132
[S15] DROPPED delta from S5 (cos=-0.0132 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=-0.0639
[S13] DROPPED delta from S17 (cos=-0.0639 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.5561
[S2] ⇄ pheromone p=0.326 → S14@127.0.0.1:63514
[S13] ⇄ pheromone p=0.368 → S8@127.0.0.1:63509
[S14] ⇄ pheromone p=0.531 → S8@127.0.0.1:63509
[S9] ⇄ pheromone p=0.452 → S16@127.0.0.1:63516
[S11] ⇄ pheromone p=0.408 → S5@127.0.0.1:63505
[S10] ⇄ pheromone p=0.302 → S17@127.0.0.1:63517
[S3] ⇄ pheromone p=0.495 → S6@127.0.0.1:63507
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.6954 head_norm=1.350204
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.273095e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.7106 head_norm=1.398710 delta_norm=0.127310
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.421 → S15@127.0.0.1:63515
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.3959 head_norm=0.925725
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.987902e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.3745 head_norm=0.793457 delta_norm=0.398790
[S4] aggregate: ROLLBACK (f1_val pre=0.396 post=0.375 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.232 → S16@127.0.0.1:63516
[S7] ⇄ pheromone p=0.239 → S17@127.0.0.1:63517
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.3797 head_norm=0.848675
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.399737e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.3797 head_norm=0.862055 delta_norm=0.139974
[S15] aggregate: ACCEPT kept=['S6', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.242 → S4@127.0.0.1:63504
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3949 head_norm=0.970777
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.918554e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.6627 head_norm=1.018289 delta_norm=0.191855
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.230 → S7@127.0.0.1:63508
[S5] ⇄ pheromone p=0.276 → S15@127.0.0.1:63515
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3729 head_norm=1.189489
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.060076e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3729 head_norm=1.211847 delta_norm=0.106008
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.295 → S15@127.0.0.1:63515
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3813 head_norm=1.008638
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.030483e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3777 head_norm=1.052461 delta_norm=0.303048
[S17] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.256 → S13@127.0.0.1:63513
[S2] START round=11 head_norm_before_train=1.042581 cos_to_last_merge=0.8793 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.879
[S2] round=11 local utility u=0.023486 metrics={'f1_val': 0.40221407143811405, 'auprc': 0.6450284344853688, 'loss_val': 0.641945742232075, 'psi': 0.499339816657016}-{'f1_val': 0.4019092272494149, 'auprc': 0.6444947077578066, 'loss_val': 0.685488239238982, 'psi': 0.49894341945277154}
[S3] START round=11 head_norm_before_train=1.456759 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.645256084561555, 'auprc': 0.9923160695367198, 'loss_val': 0.48354704731902187, 'psi': 0.784080078551621}-{'f1_val': 0.7005813959920884, 'auprc': 0.9728311955435058, 'loss_val': 0.45827993517799975, 'psi': 0.8094813158126554}
[S4] START round=11 head_norm_before_train=0.793457 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.033834 metrics={'f1_val': 0.4068071262146117, 'auprc': 0.8285518638628937, 'loss_val': 0.762488273750748, 'psi': 0.5755050212739246}-{'f1_val': 0.39591564917910854, 'auprc': 0.82587212061798, 'loss_val': 0.7567686393823556, 'psi': 0.5678982377546571}
[S5] START round=11 head_norm_before_train=1.428150 (no previous merge yet)
[S5] round=11 local utility u=0.004285 metrics={'f1_val': 0.41774624146170947, 'auprc': 0.9821047797215618, 'loss_val': 0.6649037844894043, 'psi': 0.6434896567656505}-{'f1_val': 0.4175465518408786, 'auprc': 0.9938294284866264, 'loss_val': 0.7074499618311413, 'psi': 0.6480597024991777}
[S6] START round=11 head_norm_before_train=1.398710 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.5474221922152702, 'auprc': 0.7882146171409413, 'loss_val': 0.7133469703960127, 'psi': 0.6437391621855386}-{'f1_val': 0.6953639365033542, 'auprc': 0.7951525686213421, 'loss_val': 0.7353240432019571, 'psi': 0.7352793893505494}
[S7] START round=11 head_norm_before_train=0.880090 cos_to_last_merge=0.9960 (last merge round=9)
[S7] round=11 local utility u=0.047979 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.785885872448701, 'loss_val': 0.8736360274851688, 'psi': 0.5643804198460944}-{'f1_val': 0.4169130971024577, 'auprc': 0.7690287036600236, 'loss_val': 0.920241040990439, 'psi': 0.5577593397254841}
[S8] START round=11 head_norm_before_train=1.211847 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.058436 metrics={'f1_val': 0.37273099922839503, 'auprc': 0.9928303588506497, 'loss_val': 0.6176297173392671, 'psi': 0.620770743077297}-{'f1_val': 0.3728649953480749, 'auprc': 0.9921657409435896, 'loss_val': 0.7333109586154383, 'psi': 0.6205852935862808}
[S9] START round=11 head_norm_before_train=1.097741 cos_to_last_merge=0.9205 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.921
[S9] round=11 local utility u=0.043079 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.99853443183441, 'loss_val': 0.38475340608260933, 'psi': 0.8203381712549273}-{'f1_val': 0.7015406642019387, 'auprc': 0.9987384450356607, 'loss_val': 0.4715225672259794, 'psi': 0.8204197765354275}
[S10] START round=11 head_norm_before_train=1.175447 cos_to_last_merge=0.9059 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=11 local utility u=1.000000 metrics={'f1_val': 0.6988069632417158, 'auprc': 0.9929974469178432, 'loss_val': 0.4920037098332431, 'psi': 0.8164831567121666}-{'f1_val': 0.43685602004106616, 'auprc': 0.8647111547337473, 'loss_val': 0.6652960498679498, 'psi': 0.6079980739181385}
[S11] START round=11 head_norm_before_train=1.532440 (no previous merge yet)
[S11] round=11 local utility u=0.008993 metrics={'f1_val': 0.6927191320906625, 'auprc': 0.9981057035246959, 'loss_val': 0.4092054969484328, 'psi': 0.8148737606642759}-{'f1_val': 0.7017589383281313, 'auprc': 0.9989920322456546, 'loss_val': 0.48408885357979436, 'psi': 0.8206521758951406}
[S13] START round=11 head_norm_before_train=1.400085 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.42418131275481263, 'auprc': 0.7401324072313454, 'loss_val': 0.6960767126041955, 'psi': 0.5505617505454258}-{'f1_val': 0.5827758051848123, 'auprc': 0.6951106223337096, 'loss_val': 0.7829751560278608, 'psi': 0.6277097320443712}
[S14] START round=11 head_norm_before_train=1.242876 cos_to_last_merge=0.9040 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.904
[S14] round=11 local utility u=0.092970 metrics={'f1_val': 0.998150305479212, 'auprc': 0.9971587860674053, 'loss_val': 0.3813800822292154, 'psi': 0.9977536977144893}-{'f1_val': 0.9921191644093458, 'auprc': 0.9957261886344626, 'loss_val': 0.5268363496414352, 'psi': 0.9935619740993925}
[S15] START round=11 head_norm_before_train=0.862055 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.170629 metrics={'f1_val': 0.4739285406508202, 'auprc': 0.7781744909948936, 'loss_val': 0.8130059415127145, 'psi': 0.5956269207884495}-{'f1_val': 0.3796937857464553, 'auprc': 0.8855287822373109, 'loss_val': 0.9109174460962375, 'psi': 0.5820277843427976}
[S16] START round=11 head_norm_before_train=1.018289 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.153365 metrics={'f1_val': 0.42874848983365604, 'auprc': 0.7366516168055022, 'loss_val': 0.8696161747225941, 'psi': 0.5519097406223945}-{'f1_val': 0.3949345461905243, 'auprc': 0.7223690881833522, 'loss_val': 0.9306149822496075, 'psi': 0.5259083629876555}
[S17] START round=11 head_norm_before_train=1.052461 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3584581011235245, 'auprc': 0.7040061829936897, 'loss_val': 0.9029849522352286, 'psi': 0.4966773338715906}-{'f1_val': 0.3812553087552733, 'auprc': 0.6967449771011283, 'loss_val': 0.8963321260221623, 'psi': 0.5074511760936153}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:63516
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:63508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:63504
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=-0.0169
[S15] DROPPED delta from S5 (cos=-0.0169 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=0.6867
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.1118
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.6080
[S17] RECEIVED delta(kind=head bytes=1799) from S10
[S17] cosine check vs S10: cos=0.9448
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.9678
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.9876
[S14] RECEIVED delta(kind=head bytes=1792) from S2
[S14] cosine check vs S2: cos=-0.0779
[S14] DROPPED delta from S2 (cos=-0.0779 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S15
[S4] cosine check vs S15: cos=0.8265
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.8037
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=-0.0326
[S5] DROPPED delta from S11 (cos=-0.0326 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=0.911093
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.165559e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=0.935930 delta_norm=0.316556
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.4739 head_norm=0.900665
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.021520e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.3845 head_norm=0.968605 delta_norm=0.502152
[S15] aggregate: ROLLBACK (f1_val pre=0.474 post=0.384 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4287 head_norm=1.059365
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.173772e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4261 head_norm=0.861977 delta_norm=0.317377
[S16] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3727 head_norm=1.252800
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.011323e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3728 head_norm=1.265032 delta_norm=0.101132
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.4068 head_norm=0.842646
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.582173e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.4056 head_norm=0.833036 delta_norm=0.258217
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3585 head_norm=1.092171
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.848952e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3579 head_norm=1.005371 delta_norm=0.184895
[S17] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.087481 cos_to_last_merge=0.8657 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.866
[S2] round=12 local utility u=1.000000 metrics={'f1_val': 0.699971547063833, 'auprc': 0.7240780924437928, 'loss_val': 0.6260429091062945, 'psi': 0.709614165215817}-{'f1_val': 0.40221407143811405, 'auprc': 0.6450284344853688, 'loss_val': 0.641945742232075, 'psi': 0.499339816657016}
[S3] START round=12 head_norm_before_train=1.508023 (no previous merge yet)
[S3] round=12 local utility u=0.137995 metrics={'f1_val': 0.6787435797345068, 'auprc': 0.9922408212539442, 'loss_val': 0.40825698585046316, 'psi': 0.8041424763422818}-{'f1_val': 0.645256084561555, 'auprc': 0.9923160695367198, 'loss_val': 0.48354704731902187, 'psi': 0.784080078551621}
[S4] START round=12 head_norm_before_train=0.833036 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.828169 metrics={'f1_val': 0.667706395602886, 'auprc': 0.8532527877593119, 'loss_val': 0.7456482581192228, 'psi': 0.7419249524654564}-{'f1_val': 0.4068071262146117, 'auprc': 0.8285518638628937, 'loss_val': 0.762488273750748, 'psi': 0.5755050212739246}
[S5] START round=12 head_norm_before_train=1.458033 (no previous merge yet)
[S5] round=12 local utility u=0.898826 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.986860245246852, 'loss_val': 0.5814271289437777, 'psi': 0.8153827554574151}-{'f1_val': 0.41774624146170947, 'auprc': 0.9821047797215618, 'loss_val': 0.6649037844894043, 'psi': 0.6434896567656505}
[S6] START round=12 head_norm_before_train=1.429237 cos_to_last_merge=0.9989 (last merge round=10)
[S6] round=12 local utility u=0.879068 metrics={'f1_val': 0.7009160622736137, 'auprc': 0.9710104330959041, 'loss_val': 0.4245613508612426, 'psi': 0.8089538106025298}-{'f1_val': 0.5474221922152702, 'auprc': 0.7882146171409413, 'loss_val': 0.7133469703960127, 'psi': 0.6437391621855386}
[S7] START round=12 head_norm_before_train=0.935930 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.779194159038344, 'loss_val': 0.8630219712399467, 'psi': 0.5617037344819517}-{'f1_val': 0.41671011811102343, 'auprc': 0.785885872448701, 'loss_val': 0.8736360274851688, 'psi': 0.5643804198460944}
[S8] START round=12 head_norm_before_train=1.265032 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=1.000000 metrics={'f1_val': 0.7136944380073925, 'auprc': 0.9935816362924039, 'loss_val': 0.45755192379525655, 'psi': 0.825649317321397}-{'f1_val': 0.37273099922839503, 'auprc': 0.9928303588506497, 'loss_val': 0.6176297173392671, 'psi': 0.620770743077297}
[S9] START round=12 head_norm_before_train=1.155541 cos_to_last_merge=0.9055 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.905
[S9] round=12 local utility u=0.027877 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9980302014161658, 'loss_val': 0.32598525450659127, 'psi': 0.8199863706910044}-{'f1_val': 0.7015406642019387, 'auprc': 0.99853443183441, 'loss_val': 0.38475340608260933, 'psi': 0.8203381712549273}
[S10] START round=12 head_norm_before_train=1.230649 cos_to_last_merge=0.8900 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.890
[S10] round=12 local utility u=0.062042 metrics={'f1_val': 0.6998414774877435, 'auprc': 0.9980072654146309, 'loss_val': 0.38915665380812764, 'psi': 0.8191077926584984}-{'f1_val': 0.6988069632417158, 'auprc': 0.9929974469178432, 'loss_val': 0.4920037098332431, 'psi': 0.8164831567121666}
[S11] START round=12 head_norm_before_train=1.571275 (no previous merge yet)
[S11] round=12 local utility u=0.064132 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9984789377124845, 'loss_val': 0.33630102867641454, 'psi': 0.8204469380818726}-{'f1_val': 0.6927191320906625, 'auprc': 0.9981057035246959, 'loss_val': 0.4092054969484328, 'psi': 0.8148737606642759}
[S13] START round=12 head_norm_before_train=1.433196 (no previous merge yet)
[S13] round=12 local utility u=0.693000 metrics={'f1_val': 0.6668412847587972, 'auprc': 0.72288567130604, 'loss_val': 0.714295817199825, 'psi': 0.6892590393776943}-{'f1_val': 0.42418131275481263, 'auprc': 0.7401324072313454, 'loss_val': 0.6960767126041955, 'psi': 0.5505617505454258}
[S14] START round=12 head_norm_before_train=1.285130 cos_to_last_merge=0.8937 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.894
[S14] round=12 local utility u=0.048380 metrics={'f1_val': 0.9964919087188726, 'auprc': 0.9971583999023065, 'loss_val': 0.2746687289489534, 'psi': 0.9967585051922462}-{'f1_val': 0.998150305479212, 'auprc': 0.9971587860674053, 'loss_val': 0.3813800822292154, 'psi': 0.9977536977144893}
[S15] START round=12 head_norm_before_train=0.968605 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.489140 metrics={'f1_val': 0.6695651813400453, 'auprc': 0.7038660631621446, 'loss_val': 0.7856204671156803, 'psi': 0.683285534068885}-{'f1_val': 0.4739285406508202, 'auprc': 0.7781744909948936, 'loss_val': 0.8130059415127145, 'psi': 0.5956269207884495}
[S16] START round=12 head_norm_before_train=0.861977 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.40614469564908673, 'auprc': 0.7368178919185518, 'loss_val': 0.8685222901268866, 'psi': 0.5384139741568728}-{'f1_val': 0.42874848983365604, 'auprc': 0.7366516168055022, 'loss_val': 0.8696161747225941, 'psi': 0.5519097406223945}
[S17] START round=12 head_norm_before_train=1.005371 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.35270969261391233, 'auprc': 0.7118403895758129, 'loss_val': 0.918433590043775, 'psi': 0.49636197139867255}-{'f1_val': 0.3584581011235245, 'auprc': 0.7040061829936897, 'loss_val': 0.9029849522352286, 'psi': 0.4966773338715906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63515
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:63514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:63516
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S2
[S14] cosine check vs S2: cos=-0.0804
[S14] DROPPED delta from S2 (cos=-0.0804 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=0.9851
[S4] RECEIVED delta(kind=head bytes=1796) from S15
[S4] cosine check vs S15: cos=0.7725
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] cosine check vs S4: cos=0.3931
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.9382
[S5] RECEIVED delta(kind=head bytes=1793) from S11
[S5] cosine check vs S11: cos=-0.0347
[S5] DROPPED delta from S11 (cos=-0.0347 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S13
[S8] cosine check vs S13: cos=-0.0375
[S8] DROPPED delta from S13 (cos=-0.0375 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=-0.0113
[S15] DROPPED delta from S5 (cos=-0.0113 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.9899
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.9113
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=0.3429
[S17] RECEIVED delta(kind=head bytes=1800) from S10
[S17] cosine check vs S10: cos=0.9204
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4061 head_norm=0.912537
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.822860e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4033 head_norm=0.842399 delta_norm=0.182286
[S16] aggregate: ACCEPT kept=['S4', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7137 head_norm=1.311039
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.408269e-02
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7117 head_norm=1.316053 delta_norm=0.094083
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6696 head_norm=1.005463
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.595093e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.5129 head_norm=0.959093 delta_norm=0.259509
[S15] aggregate: ROLLBACK (f1_val pre=0.670 post=0.513 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6677 head_norm=0.880290
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.234398e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6705 head_norm=0.887874 delta_norm=0.323440
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7009 head_norm=1.461025
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.381374e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7003 head_norm=1.502166 delta_norm=0.138137
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3527 head_norm=1.046913
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.605202e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3528 head_norm=1.143349 delta_norm=0.260520
[S17] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.121652 cos_to_last_merge=0.8551 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.855
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7136291294765865, 'auprc': 0.7760799290243952, 'loss_val': 1.0440598815072921, 'psi': 0.73860944929571}-{'f1_val': 0.699971547063833, 'auprc': 0.7240780924437928, 'loss_val': 0.6260429091062945, 'psi': 0.709614165215817}
[S3] START round=13 head_norm_before_train=1.554533 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6446544778919623, 'auprc': 0.9903826572965838, 'loss_val': 0.4145980299348487, 'psi': 0.7829457496538109}-{'f1_val': 0.6787435797345068, 'auprc': 0.9922408212539442, 'loss_val': 0.40825698585046316, 'psi': 0.8041424763422818}
[S4] START round=13 head_norm_before_train=0.887874 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6656107614087848, 'auprc': 0.8516705400948599, 'loss_val': 0.7283692237449025, 'psi': 0.7400346728832148}-{'f1_val': 0.667706395602886, 'auprc': 0.8532527877593119, 'loss_val': 0.7456482581192228, 'psi': 0.7419249524654564}
[S5] START round=13 head_norm_before_train=1.488155 (no previous merge yet)
[S5] round=13 local utility u=0.034822 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.9865327088420606, 'loss_val': 0.5110413884756417, 'psi': 0.815275886776178}-{'f1_val': 0.7010644289311239, 'auprc': 0.986860245246852, 'loss_val': 0.5814271289437777, 'psi': 0.8153827554574151}
[S6] START round=13 head_norm_before_train=1.502166 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6184579054292489, 'auprc': 0.7831337323690168, 'loss_val': 0.6052678388566265, 'psi': 0.6843282362051561}-{'f1_val': 0.7009160622736137, 'auprc': 0.9710104330959041, 'loss_val': 0.4245613508612426, 'psi': 0.8089538106025298}
[S7] START round=13 head_norm_before_train=0.970546 cos_to_last_merge=0.9964 (last merge round=11)
[S7] round=13 local utility u=0.021928 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7770537559599912, 'loss_val': 0.8127457203573053, 'psi': 0.5608475732506105}-{'f1_val': 0.41671011811102343, 'auprc': 0.779194159038344, 'loss_val': 0.8630219712399467, 'psi': 0.5617037344819517}
[S8] START round=13 head_norm_before_train=1.316053 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.909483 metrics={'f1_val': 0.9956240294577007, 'auprc': 0.9947757904343344, 'loss_val': 0.3337461394850909, 'psi': 0.9952847338483541}-{'f1_val': 0.7136944380073925, 'auprc': 0.9935816362924039, 'loss_val': 0.45755192379525655, 'psi': 0.825649317321397}
[S9] START round=13 head_norm_before_train=1.211354 cos_to_last_merge=0.8916 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.892
[S9] round=13 local utility u=0.019153 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9978599261963981, 'loss_val': 0.2867256287605136, 'psi': 0.8198739189425703}-{'f1_val': 0.7012904835408967, 'auprc': 0.9980302014161658, 'loss_val': 0.32598525450659127, 'psi': 0.8199863706910044}
[S10] START round=13 head_norm_before_train=1.286160 cos_to_last_merge=0.8757 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.876
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.6873624602104176, 'auprc': 0.9673217855834209, 'loss_val': 0.31794909223118945, 'psi': 0.7993461903596188}-{'f1_val': 0.6998414774877435, 'auprc': 0.9980072654146309, 'loss_val': 0.38915665380812764, 'psi': 0.8191077926584984}
[S11] START round=13 head_norm_before_train=1.608451 (no previous merge yet)
[S11] round=13 local utility u=0.019412 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.99861214480515, 'loss_val': 0.2978760182790576, 'psi': 0.8205002209189388}-{'f1_val': 0.7017589383281313, 'auprc': 0.9984789377124845, 'loss_val': 0.33630102867641454, 'psi': 0.8204469380818726}
[S13] START round=13 head_norm_before_train=1.460924 (no previous merge yet)
[S13] round=13 local utility u=0.052267 metrics={'f1_val': 0.6757021418269078, 'auprc': 0.7163233382534673, 'loss_val': 0.6432404460182677, 'psi': 0.6919506203975316}-{'f1_val': 0.6668412847587972, 'auprc': 0.72288567130604, 'loss_val': 0.714295817199825, 'psi': 0.6892590393776943}
[S14] START round=13 head_norm_before_train=1.327731 cos_to_last_merge=0.8860 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.886
[S14] round=13 local utility u=0.040957 metrics={'f1_val': 0.9974737445708615, 'auprc': 0.9971581306933883, 'loss_val': 0.1986448292659961, 'psi': 0.9973474990198723}-{'f1_val': 0.9964919087188726, 'auprc': 0.9971583999023065, 'loss_val': 0.2746687289489534, 'psi': 0.9967585051922462}
[S15] START round=13 head_norm_before_train=0.959093 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.038956 metrics={'f1_val': 0.7010722616442422, 'auprc': 0.6434906215107228, 'loss_val': 0.7156246535858755, 'psi': 0.6780396055908344}-{'f1_val': 0.6695651813400453, 'auprc': 0.7038660631621446, 'loss_val': 0.7856204671156803, 'psi': 0.683285534068885}
[S16] START round=13 head_norm_before_train=0.842399 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.38078455954422524, 'auprc': 0.7462964230736201, 'loss_val': 0.8704011554051401, 'psi': 0.5269893049559832}-{'f1_val': 0.40614469564908673, 'auprc': 0.7368178919185518, 'loss_val': 0.8685222901268866, 'psi': 0.5384139741568728}
[S17] START round=13 head_norm_before_train=1.143349 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.003142 metrics={'f1_val': 0.3521358289898579, 'auprc': 0.7180322801148017, 'loss_val': 0.9272818044233958, 'psi': 0.4984944094398355}-{'f1_val': 0.35270969261391233, 'auprc': 0.7118403895758129, 'loss_val': 0.918433590043775, 'psi': 0.49636197139867255}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63509
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:63509
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:63517
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:63513
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S8
[S15] cosine check vs S8: cos=0.8065
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.9496
[S8] RECEIVED delta(kind=head bytes=1799) from S13
[S8] cosine check vs S13: cos=-0.0393
[S8] DROPPED delta from S13 (cos=-0.0393 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=0.6191
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.9916
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.8981
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=-0.0197
[S15] DROPPED delta from S5 (cos=-0.0197 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] cosine check vs S11: cos=-0.0373
[S5] DROPPED delta from S11 (cos=-0.0373 < 0.0)
[S17] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S17
[S13] cosine check vs S17: cos=-0.0478
[S13] DROPPED delta from S17 (cos=-0.0478 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6656 head_norm=0.930533
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.564738e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6669 head_norm=0.951394 delta_norm=0.156474
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9956 head_norm=1.360006
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.897048e-02
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9960 head_norm=1.364122 delta_norm=0.088970
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.7011 head_norm=0.996684
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.051491e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.7014 head_norm=1.121317 delta_norm=0.405149
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3521 head_norm=1.180280
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.841802e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3522 head_norm=0.986493 delta_norm=0.484180
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.3808 head_norm=0.898137
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.011341e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4169 head_norm=1.052655 delta_norm=0.301134
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.154630 cos_to_last_merge=0.8451 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.845
[S2] round=14 local utility u=0.216169 metrics={'f1_val': 0.7103000447843117, 'auprc': 0.7750642988970198, 'loss_val': 0.5887013313237192, 'psi': 0.736205746429395}-{'f1_val': 0.7136291294765865, 'auprc': 0.7760799290243952, 'loss_val': 1.0440598815072921, 'psi': 0.73860944929571}
[S3] START round=14 head_norm_before_train=1.593078 (no previous merge yet)
[S3] round=14 local utility u=0.219771 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9927516519608278, 'loss_val': 0.31471859397278557, 'psi': 0.8171488429404821}-{'f1_val': 0.6446544778919623, 'auprc': 0.9903826572965838, 'loss_val': 0.4145980299348487, 'psi': 0.7829457496538109}
[S4] START round=14 head_norm_before_train=0.951394 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.029160 metrics={'f1_val': 0.6665881116527357, 'auprc': 0.8517140337090198, 'loss_val': 0.6760433418401739, 'psi': 0.7406384804752493}-{'f1_val': 0.6656107614087848, 'auprc': 0.8516705400948599, 'loss_val': 0.7283692237449025, 'psi': 0.7400346728832148}
[S5] START round=14 head_norm_before_train=1.515402 (no previous merge yet)
[S5] round=14 local utility u=0.048532 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.9893056473837691, 'loss_val': 0.42229714625984976, 'psi': 0.8163850621928614}-{'f1_val': 0.7011046720655897, 'auprc': 0.9865327088420606, 'loss_val': 0.5110413884756417, 'psi': 0.815275886776178}
[S6] START round=14 head_norm_before_train=1.525078 cos_to_last_merge=0.9996 (last merge round=12)
[S6] round=14 local utility u=0.652150 metrics={'f1_val': 0.6994181421406396, 'auprc': 0.9692273017130644, 'loss_val': 0.34500985305322185, 'psi': 0.8073418059696095}-{'f1_val': 0.6184579054292489, 'auprc': 0.7831337323690168, 'loss_val': 0.6052678388566265, 'psi': 0.6843282362051561}
[S7] START round=14 head_norm_before_train=1.011009 cos_to_last_merge=0.9889 (last merge round=11)
[S7] round=14 local utility u=0.909486 metrics={'f1_val': 0.7120590315224361, 'auprc': 0.7867956577923417, 'loss_val': 0.7950924089548423, 'psi': 0.7419536820303985}-{'f1_val': 0.41671011811102343, 'auprc': 0.7770537559599912, 'loss_val': 0.8127457203573053, 'psi': 0.5608475732506105}
[S8] START round=14 head_norm_before_train=1.364122 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7749903688497743, 'auprc': 0.9943082817391058, 'loss_val': 0.2825529607284779, 'psi': 0.8627175340055069}-{'f1_val': 0.9956240294577007, 'auprc': 0.9947757904343344, 'loss_val': 0.3337461394850909, 'psi': 0.9952847338483541}
[S9] START round=14 head_norm_before_train=1.261300 cos_to_last_merge=0.8796 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.880
[S9] round=14 local utility u=0.027449 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981423364660971, 'loss_val': 0.2326756573796819, 'psi': 0.81998688305045}-{'f1_val': 0.7012165807733519, 'auprc': 0.9978599261963981, 'loss_val': 0.2867256287605136, 'psi': 0.8198739189425703}
[S10] START round=14 head_norm_before_train=1.338912 cos_to_last_merge=0.8634 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.863
[S10] round=14 local utility u=0.073408 metrics={'f1_val': 0.6875807354995039, 'auprc': 0.996001228754181, 'loss_val': 0.25848045984884205, 'psi': 0.8109489328013748}-{'f1_val': 0.6873624602104176, 'auprc': 0.9673217855834209, 'loss_val': 0.31794909223118945, 'psi': 0.7993461903596188}
[S11] START round=14 head_norm_before_train=1.641673 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.6595614214700347, 'auprc': 0.998574086166907, 'loss_val': 0.34584944042054155, 'psi': 0.7951664873487836}-{'f1_val': 0.7017589383281313, 'auprc': 0.99861214480515, 'loss_val': 0.2978760182790576, 'psi': 0.8205002209189388}
[S13] START round=14 head_norm_before_train=1.488005 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6091167028138627, 'auprc': 0.6837622707855677, 'loss_val': 0.6572183634874843, 'psi': 0.6389749300025447}-{'f1_val': 0.6757021418269078, 'auprc': 0.7163233382534673, 'loss_val': 0.6432404460182677, 'psi': 0.6919506203975316}
[S14] START round=14 head_norm_before_train=1.373998 cos_to_last_merge=0.8787 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.879
[S14] round=14 local utility u=0.020677 metrics={'f1_val': 0.9973060238921251, 'auprc': 0.9971549803140578, 'loss_val': 0.15627408847315905, 'psi': 0.9972456064608981}-{'f1_val': 0.9974737445708615, 'auprc': 0.9971581306933883, 'loss_val': 0.1986448292659961, 'psi': 0.9973474990198723}
[S15] START round=14 head_norm_before_train=1.121317 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.003800 metrics={'f1_val': 0.6970872264579475, 'auprc': 0.6411465418821598, 'loss_val': 0.6770826579692556, 'psi': 0.6747109526276325}-{'f1_val': 0.7010722616442422, 'auprc': 0.6434906215107228, 'loss_val': 0.7156246535858755, 'psi': 0.6780396055908344}
[S16] START round=14 head_norm_before_train=1.052655 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=1.000000 metrics={'f1_val': 0.7979337305005479, 'auprc': 0.7607253125221601, 'loss_val': 0.8210161647171296, 'psi': 0.7830503633091929}-{'f1_val': 0.38078455954422524, 'auprc': 0.7462964230736201, 'loss_val': 0.8704011554051401, 'psi': 0.5269893049559832}
[S17] START round=14 head_norm_before_train=0.986493 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.006039 metrics={'f1_val': 0.35216234429098303, 'auprc': 0.724593678265237, 'loss_val': 0.935046193415817, 'psi': 0.5011348778806847}-{'f1_val': 0.3521358289898579, 'auprc': 0.7180322801148017, 'loss_val': 0.9272818044233958, 'psi': 0.4984944094398355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:63503
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S6
[S3] cosine check vs S6: cos=0.9897
[S15] RECEIVED delta(kind=head bytes=1797) from S4
[S15] cosine check vs S4: cos=0.8978
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S15
[S6] cosine check vs S15: cos=0.2510
[S2] RECEIVED delta(kind=head bytes=1797) from S14
[S2] cosine check vs S14: cos=-0.0819
[S2] DROPPED delta from S14 (cos=-0.0819 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:63510
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:63512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:63516
[S16] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S16
[S9] cosine check vs S16: cos=0.9695
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S10@127.0.0.1:63511
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=-0.0390
[S11] DROPPED delta from S5 (cos=-0.0390 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S7
[S16] cosine check vs S7: cos=0.8596
[S17] sending update (kind=head size=1808 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1808) from S17
[S10] cosine check vs S17: cos=0.8304
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.6994 head_norm=1.544498
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.399138e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.073585 delta_norm=0.839914
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7001 head_norm=1.627655
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.209820e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7001 head_norm=1.582002 delta_norm=0.120982
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=1.305292
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.785583e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.196997 delta_norm=0.178558
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6971 head_norm=1.153519
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.547907e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6970 head_norm=1.046385 delta_norm=0.254791
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.7979 head_norm=1.107061
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.868699e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.7023 head_norm=1.038612 delta_norm=0.286870
[S16] aggregate: ROLLBACK (f1_val pre=0.798 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.6876 head_norm=1.387067
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.916212e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.6876 head_norm=1.154768 delta_norm=0.391621
[S10] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.185590 cos_to_last_merge=0.8360 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.836
[S2] round=15 local utility u=0.022419 metrics={'f1_val': 0.701470877213225, 'auprc': 0.7750332126349717, 'loss_val': 0.49079524705979444, 'psi': 0.7308958113819237}-{'f1_val': 0.7103000447843117, 'auprc': 0.7750642988970198, 'loss_val': 0.5887013313237192, 'psi': 0.736205746429395}
[S3] START round=15 head_norm_before_train=1.582002 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.019501 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9950986971195566, 'loss_val': 0.28726547058329766, 'psi': 0.818538519863109}-{'f1_val': 0.7000803035935849, 'auprc': 0.9927516519608278, 'loss_val': 0.31471859397278557, 'psi': 0.8171488429404821}
[S4] START round=15 head_norm_before_train=0.994521 cos_to_last_merge=0.9942 (last merge round=13)
[S4] round=15 local utility u=0.029649 metrics={'f1_val': 0.6642204347173182, 'auprc': 0.8486621641751813, 'loss_val': 0.5933834877228784, 'psi': 0.7379971265004635}-{'f1_val': 0.6665881116527357, 'auprc': 0.8517140337090198, 'loss_val': 0.6760433418401739, 'psi': 0.7406384804752493}
[S5] START round=15 head_norm_before_train=1.548989 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7008558293524949, 'auprc': 0.9629878335837014, 'loss_val': 0.3738729673829388, 'psi': 0.8057086310449775}-{'f1_val': 0.7011046720655897, 'auprc': 0.9893056473837691, 'loss_val': 0.42229714625984976, 'psi': 0.8163850621928614}
[S6] START round=15 head_norm_before_train=1.073585 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6885711454646142, 'auprc': 0.7860679642225294, 'loss_val': 0.630821531467332, 'psi': 0.7275698729677803}-{'f1_val': 0.6994181421406396, 'auprc': 0.9692273017130644, 'loss_val': 0.34500985305322185, 'psi': 0.8073418059696095}
[S7] START round=15 head_norm_before_train=1.047107 cos_to_last_merge=0.9793 (last merge round=11)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6714819788600732, 'auprc': 0.7857179302101843, 'loss_val': 0.758063538640027, 'psi': 0.7171763594001177}-{'f1_val': 0.7120590315224361, 'auprc': 0.7867956577923417, 'loss_val': 0.7950924089548423, 'psi': 0.7419536820303985}
[S8] START round=15 head_norm_before_train=1.410242 cos_to_last_merge=0.9988 (last merge round=13)
[S8] round=15 local utility u=0.722852 metrics={'f1_val': 0.9967901605898053, 'auprc': 0.9980969744069084, 'loss_val': 0.17901295871029413, 'psi': 0.9973128861166466}-{'f1_val': 0.7749903688497743, 'auprc': 0.9943082817391058, 'loss_val': 0.2825529607284779, 'psi': 0.8627175340055069}
[S9] START round=15 head_norm_before_train=1.196997 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000489 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9967785368367859, 'loss_val': 0.22760678530298425, 'psi': 0.8194413631987255}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981423364660971, 'loss_val': 0.2326756573796819, 'psi': 0.81998688305045}
[S10] START round=15 head_norm_before_train=1.154768 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.026242 metrics={'f1_val': 0.6993551791672501, 'auprc': 0.9955520457854108, 'loss_val': 0.2752946031813187, 'psi': 0.8178339258145144}-{'f1_val': 0.6875807354995039, 'auprc': 0.996001228754181, 'loss_val': 0.25848045984884205, 'psi': 0.8109489328013748}
[S11] START round=15 head_norm_before_train=1.671563 (no previous merge yet)
[S11] round=15 local utility u=0.167112 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9979468445299641, 'loss_val': 0.2625367727569506, 'psi': 0.8201948255641405}-{'f1_val': 0.6595614214700347, 'auprc': 0.998574086166907, 'loss_val': 0.34584944042054155, 'psi': 0.7951664873487836}
[S13] START round=15 head_norm_before_train=1.516098 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5699564085763426, 'auprc': 0.672326177242272, 'loss_val': 0.7051041375400925, 'psi': 0.6109043160427143}-{'f1_val': 0.6091167028138627, 'auprc': 0.6837622707855677, 'loss_val': 0.6572183634874843, 'psi': 0.6389749300025447}
[S14] START round=15 head_norm_before_train=1.417178 cos_to_last_merge=0.8711 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.871
[S14] round=15 local utility u=0.019225 metrics={'f1_val': 0.9977167852361856, 'auprc': 0.9971485980333692, 'loss_val': 0.12026990197341764, 'psi': 0.997489510355059}-{'f1_val': 0.9973060238921251, 'auprc': 0.9971549803140578, 'loss_val': 0.15627408847315905, 'psi': 0.9972456064608981}
[S15] START round=15 head_norm_before_train=1.046385 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.063496 metrics={'f1_val': 0.6990816891019731, 'auprc': 0.6431860927749452, 'loss_val': 0.568175287369447, 'psi': 0.6767234505711619}-{'f1_val': 0.6970872264579475, 'auprc': 0.6411465418821598, 'loss_val': 0.6770826579692556, 'psi': 0.6747109526276325}
[S16] START round=15 head_norm_before_train=1.038612 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.6029813346672914, 'auprc': 0.7456837121193545, 'loss_val': 0.8346205304940788, 'psi': 0.6600622856481166}-{'f1_val': 0.7979337305005479, 'auprc': 0.7607253125221601, 'loss_val': 0.8210161647171296, 'psi': 0.7830503633091929}
[S17] START round=15 head_norm_before_train=1.024577 cos_to_last_merge=0.9951 (last merge round=13)
[S17] round=15 local utility u=0.025309 metrics={'f1_val': 0.35238477224778597, 'auprc': 0.7372113735285266, 'loss_val': 0.9236156741806123, 'psi': 0.5063154127600823}-{'f1_val': 0.35216234429098303, 'auprc': 0.724593678265237, 'loss_val': 0.935046193415817, 'psi': 0.5011348778806847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63514
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63515
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S4
[S15] cosine check vs S4: cos=0.9581
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] cosine check vs S15: cos=0.8012
[S14] RECEIVED delta(kind=head bytes=1798) from S8
[S14] cosine check vs S8: cos=0.9857
[S2] RECEIVED delta(kind=head bytes=1800) from S14
[S2] cosine check vs S14: cos=-0.0777
[S2] DROPPED delta from S14 (cos=-0.0777 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63511
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1800) from S17
[S10] cosine check vs S17: cos=0.9239
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S16
[S4]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S5] ⇄ pheromone p=0.195 → S11@127.0.0.1:63512
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.6886 head_norm=1.100854
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.448723e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.6501 head_norm=1.037821 delta_norm=0.344872
[S6] aggregate: ROLLBACK (f1_val pre=0.689 post=0.650 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.332 → S3@127.0.0.1:63503
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.6994 head_norm=1.201052
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.307200e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.6995 head_norm=1.112565 delta_norm=0.230720
[S10] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.174 → S15@127.0.0.1:63515
[S8] ⇄ pheromone p=0.465 → S14@127.0.0.1:63514
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9977 head_norm=1.460447
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.230593e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9977 head_norm=1.449833 delta_norm=0.123059
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.199 → S2@127.0.0.1:63502
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6991 head_norm=1.086342
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.556116e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6991 head_norm=1.053942 delta_norm=0.155612
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.162 → S6@127.0.0.1:63507
[S16] ⇄ pheromone p=0.248 → S9@127.0.0.1:63510
[S13] ⇄ pheromone p=0.198 → S17@127.0.0.1:63517
[S17] ⇄ pheromone p=0.090 → S10@127.0.0.1:63511
[S7] ⇄ pheromone p=0.230 → S16@127.0.0.1:63516
[S2] START round=16 head_norm_before_train=1.217474 cos_to_last_merge=0.8270 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=16 local utility u=0.031470 metrics={'f1_val': 0.7009346645617021, 'auprc': 0.7769531152859936, 'loss_val': 0.43039731729505953, 'psi': 0.7313420448514187}-{'f1_val': 0.701470877213225, 'auprc': 0.7750332126349717, 'loss_val': 0.49079524705979444, 'psi': 0.7308958113819237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=16 head_norm_before_train=1.616725 cos_to_last_merge=0.9998 (last merge round=14)
[S3] round=16 local utility u=0.007700 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9952768502946872, 'loss_val': 0.2723997369588015, 'psi': 0.8186097811331613}-{'f1_val': 0.7008317350254774, 'auprc': 0.9950986971195566, 'loss_val': 0.28726547058329766, 'psi': 0.818538519863109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=16 head_norm_before_train=1.043972 cos_to_last_merge=0.9825 (last merge round=13)
[S4] round=16 local utility u=0.014906 metrics={'f1_val': 0.6647019910339045, 'auprc': 0.8380331522188, 'loss_val': 0.5345734680665273, 'psi': 0.7340344555078626}-{'f1_val': 0.6642204347173182, 'auprc': 0.8486621641751813, 'loss_val': 0.5933834877228784, 'psi': 0.7379971265004635}
[S5] START round=16 head_norm_before_train=1.582079 (no previous merge yet)
[S5] round=16 local utility u=0.085293 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9984534722750587, 'loss_val': 0.30969154392157744, 'psi': 0.8198955589995427}-{'f1_val': 0.7008558293524949, 'auprc': 0.9629878335837014, 'loss_val': 0.3738729673829388, 'psi': 0.8057086310449775}
[S6] START round=16 head_norm_before_train=1.037821 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.367005 metrics={'f1_val': 0.6992271657366035, 'auprc': 0.9708024525870861, 'loss_val': 0.5149512772743685, 'psi': 0.8078572804767965}-{'f1_val': 0.6885711454646142, 'auprc': 0.7860679642225294, 'loss_val': 0.630821531467332, 'psi': 0.7275698729677803}
[S7] START round=16 head_norm_before_train=1.081365 cos_to_last_merge=0.9709 (last merge round=11)
[S7] round=16 local utility u=0.161685 metrics={'f1_val': 0.7133667939633525, 'auprc': 0.7838295251479002, 'loss_val': 0.6803381191226731, 'psi': 0.7415518864371715}-{'f1_val': 0.6714819788600732, 'auprc': 0.7857179302101843, 'loss_val': 0.758063538640027, 'psi': 0.7171763594001177}
[S8] START round=16 head_norm_before_train=1.449625 cos_to_last_merge=0.9964 (last merge round=13)
[S8] round=16 local utility u=0.016377 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9979489521662098, 'loss_val': 0.14319213817811158, 'psi': 0.9969914258278587}-{'f1_val': 0.9967901605898053, 'auprc': 0.9980969744069084, 'loss_val': 0.17901295871029413, 'psi': 0.9973128861166466}
[S9] START round=16 head_norm_before_train=1.239634 cos_to_last_merge=0.9994 (last merge round=14)
[S9] round=16 local utility u=0.882230 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.9958713555614029, 'loss_val': 0.19279892274240043, 'psi': 0.9923158427296881}-{'f1_val': 0.7012165807733519, 'auprc': 0.9967785368367859, 'loss_val': 0.22760678530298425, 'psi': 0.8194413631987255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=16 head_norm_before_train=1.112565 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.623086 metrics={'f1_val': 0.9084769267420849, 'auprc': 0.994433060663884, 'loss_val': 0.2804969888382067, 'psi': 0.9428593803108045}-{'f1_val': 0.6993551791672501, 'auprc': 0.9955520457854108, 'loss_val': 0.2752946031813187, 'psi': 0.8178339258145144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=16 head_norm_before_train=1.694992 (no previous merge yet)
[S11] round=16 local utility u=0.000487 metrics={'f1_val': 0.701211799382778, 'auprc': 0.9985353801557881, 'loss_val': 0.2604373829963207, 'psi': 0.820141231691982}-{'f1_val': 0.7016934795869249, 'auprc': 0.9979468445299641, 'loss_val': 0.2625367727569506, 'psi': 0.8201948255641405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=16 head_norm_before_train=1.541303 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5583553770630363, 'auprc': 0.5800580709037656, 'loss_val': 0.693563001306205, 'psi': 0.567036454599328}-{'f1_val': 0.5699564085763426, 'auprc': 0.672326177242272, 'loss_val': 0.7051041375400925, 'psi': 0.6109043160427143}
[S14] START round=16 head_norm_before_train=1.449833 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.948789339090883, 'auprc': 0.995686431673599, 'loss_val': 0.13314476397775238, 'psi': 0.9675481761239695}-{'f1_val': 0.9977167852361856, 'auprc': 0.9971485980333692, 'loss_val': 0.12026990197341764, 'psi': 0.997489510355059}
[S15] START round=16 head_norm_before_train=1.053942 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.052551 metrics={'f1_val': 0.700833884979711, 'auprc': 0.6476137277442413, 'loss_val': 0.4868693568667773, 'psi': 0.679545822085523}-{'f1_val': 0.6990816891019731, 'auprc': 0.6431860927749452, 'loss_val': 0.568175287369447, 'psi': 0.6767234505711619}
[S16] START round=16 head_norm_before_train=1.096152 cos_to_last_merge=0.9979 (last merge round=14)
[S16] round=16 local utility u=0.725508 metrics={'f1_val': 0.8101723301836177, 'auprc': 0.7736031430919044, 'loss_val': 0.7105090909680194, 'psi': 0.7955446553469323}-{'f1_val': 0.6029813346672914, 'auprc': 0.7456837121193545, 'loss_val': 0.8346205304940788, 'psi': 0.6600622856481166}
[S17] START round=16 head_norm_before_train=1.067491 cos_to_last_merge=0.9850 (last merge round=13)
[S17] round=16 local utility u=0.040437 metrics={'f1_val': 0.3522371298123252, 'auprc': 0.7661990718175578, 'loss_val': 0.9288179395645358, 'psi': 0.5178219066144182}-{'f1_val': 0.35238477224778597, 'auprc': 0.7372113735285266, 'loss_val': 0.9236156741806123, 'psi': 0.5063154127600823}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:63512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63503
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63511
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:63510
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S6
[S3] cosine check vs S6: cos=0.6697
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.9416
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=-0.0425
[S11] DROPPED delta from S5 (cos=-0.0425 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S4
[S15] cosine check vs S4: cos=0.9790
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S17
[S10] cosine check vs S17: cos=0.9634
[S9] RECEIVED delta(kind=head bytes=1801) from S16
[S9] cosine check vs S16: cos=0.9339
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:63514
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8102 head_norm=1.144833
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.934862e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8087 head_norm=1.111941 delta_norm=0.193486
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S8
[S14] cosine check vs S8: cos=0.9922
[S15] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S5]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S13]  timeout peer S17
[S17]  timeout peer S7
[S17]  timeout peer S10
[S4]  timeout peer S15
[S6]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S9
[S14]  timeout peer S2
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S7]  timeout peer S16
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.7008 head_norm=1.091034
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.121976e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.7008 head_norm=1.088616 delta_norm=0.112198
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.251832 cos_to_last_merge=0.8170 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006749165450155, 'auprc': 0.72540913304674, 'loss_val': 0.4108160270929181, 'psi': 0.7105686031457052}-{'f1_val': 0.7009346645617021, 'auprc': 0.7769531152859936, 'loss_val': 0.43039731729505953, 'psi': 0.7313420448514187}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=1.650909 cos_to_last_merge=0.9993 (last merge round=14)
[S3] round=17 local utility u=0.003483 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9940507589180156, 'loss_val': 0.26175475465942477, 'psi': 0.8181193445824927}-{'f1_val': 0.7008317350254774, 'auprc': 0.9952768502946872, 'loss_val': 0.2723997369588015, 'psi': 0.8186097811331613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7008 head_norm=1.677685
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.254125e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7006 head_norm=1.260211 delta_norm=0.625412
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] START round=17 head_norm_before_train=1.097722 cos_to_last_merge=0.9689 (last merge round=13)
[S4] round=17 local utility u=0.028222 metrics={'f1_val': 0.6637949253770187, 'auprc': 0.8481466331102215, 'loss_val': 0.5030276522696004, 'psi': 0.7375356084702999}-{'f1_val': 0.6647019910339045, 'auprc': 0.8380331522188, 'loss_val': 0.5345734680665273, 'psi': 0.7340344555078626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=17 head_norm_before_train=1.609531 (no previous merge yet)
[S5] round=17 local utility u=0.010992 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9980922734780917, 'loss_val': 0.2851326972173254, 'psi': 0.8196019449888412}-{'f1_val': 0.7008569501491988, 'auprc': 0.9984534722750587, 'loss_val': 0.30969154392157744, 'psi': 0.8198955589995427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=17 head_norm_before_train=1.069540 cos_to_last_merge=0.9981 (last merge round=15)
[S6] round=17 local utility u=0.035447 metrics={'f1_val': 0.7082494834376265, 'auprc': 0.9589339461852286, 'loss_val': 0.462584842505735, 'psi': 0.8085232685366673}-{'f1_val': 0.6992271657366035, 'auprc': 0.9708024525870861, 'loss_val': 0.5149512772743685, 'psi': 0.8078572804767965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=17 head_norm_before_train=1.112231 cos_to_last_merge=0.9644 (last merge round=11)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5821439871014362, 'auprc': 0.7906719862145685, 'loss_val': 0.7483604446684411, 'psi': 0.6655551867466891}-{'f1_val': 0.7133667939633525, 'auprc': 0.7838295251479002, 'loss_val': 0.6803381191226731, 'psi': 0.7415518864371715}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=1.484285 cos_to_last_merge=0.9935 (last merge round=13)
[S8] round=17 local utility u=0.013646 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9986970433314709, 'loss_val': 0.11814401870753712, 'psi': 0.9972906622939631}-{'f1_val': 0.9963530749356245, 'auprc': 0.9979489521662098, 'loss_val': 0.14319213817811158, 'psi': 0.9969914258278587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=17 head_norm_before_train=1.283528 cos_to_last_merge=0.9977 (last merge round=14)
[S9] round=17 local utility u=0.029370 metrics={'f1_val': 0.9916350289240425, 'auprc': 0.9968743839594691, 'loss_val': 0.14720541205253623, 'psi': 0.9937307709382133}-{'f1_val': 0.9899455008418782, 'auprc': 0.9958713555614029, 'loss_val': 0.19279892274240043, 'psi': 0.9923158427296881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9916 head_norm=1.323007
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.483305e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9937 head_norm=1.211952 delta_norm=0.248331
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] START round=17 head_norm_before_train=1.160186 cos_to_last_merge=0.9986 (last merge round=15)
[S10] round=17 local utility u=0.226532 metrics={'f1_val': 0.980287576089018, 'auprc': 0.9863697849414368, 'loss_val': 0.2341064209233024, 'psi': 0.9827204596299854}-{'f1_val': 0.9084769267420849, 'auprc': 0.994433060663884, 'loss_val': 0.2804969888382067, 'psi': 0.9428593803108045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9803 head_norm=1.203361
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.805510e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9803 head_norm=1.141693 delta_norm=0.180551
[S10] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] START round=17 head_norm_before_train=1.713072 (no previous merge yet)
[S11] round=17 local utility u=0.014623 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9984246777582573, 'loss_val': 0.23374910290305526, 'psi': 0.8203859588554578}-{'f1_val': 0.701211799382778, 'auprc': 0.9985353801557881, 'loss_val': 0.2604373829963207, 'psi': 0.820141231691982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=17 head_norm_before_train=1.562964 (no previous merge yet)
[S13] round=17 local utility u=0.231261 metrics={'f1_val': 0.5867493541147113, 'auprc': 0.6730069674252813, 'loss_val': 0.680251693893248, 'psi': 0.6212523994389393}-{'f1_val': 0.5583553770630363, 'auprc': 0.5800580709037656, 'loss_val': 0.693563001306205, 'psi': 0.567036454599328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=17 head_norm_before_train=1.492954 cos_to_last_merge=0.9996 (last merge round=15)
[S14] round=17 local utility u=0.176121 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.997426536448488, 'loss_val': 0.07929301494711835, 'psi': 0.9975612854093073}-{'f1_val': 0.948789339090883, 'auprc': 0.995686431673599, 'loss_val': 0.13314476397775238, 'psi': 0.9675481761239695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9977 head_norm=1.527570
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.075708e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9977 head_norm=1.502236 delta_norm=0.107571
[S14] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] START round=17 head_norm_before_train=1.088616 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.424419 metrics={'f1_val': 0.6903601769800566, 'auprc': 0.9430285291851448, 'loss_val': 0.46143316567974874, 'psi': 0.7914275178620919}-{'f1_val': 0.700833884979711, 'auprc': 0.6476137277442413, 'loss_val': 0.4868693568667773, 'psi': 0.679545822085523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=17 head_norm_before_train=1.111941 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.031703 metrics={'f1_val': 0.8008594958513127, 'auprc': 0.7907667498416682, 'loss_val': 0.6427177126745853, 'psi': 0.7968223974474549}-{'f1_val': 0.8101723301836177, 'auprc': 0.7736031430919044, 'loss_val': 0.7105090909680194, 'psi': 0.7955446553469323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=17 head_norm_before_train=1.106365 cos_to_last_merge=0.9746 (last merge round=13)
[S17] round=17 local utility u=0.037678 metrics={'f1_val': 0.3570412906265391, 'auprc': 0.7865012019477702, 'loss_val': 0.9431931208041127, 'psi': 0.5288252551550315}-{'f1_val': 0.3522371298123252, 'auprc': 0.7661990718175578, 'loss_val': 0.9288179395645358, 'psi': 0.5178219066144182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=18 head_norm_before_train=1.287387 cos_to_last_merge=0.8074 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7136331455310448, 'auprc': 0.7777052335302633, 'loss_val': 0.8104878170961599, 'psi': 0.7392619807307322}-{'f1_val': 0.7006749165450155, 'auprc': 0.72540913304674, 'loss_val': 0.4108160270929181, 'psi': 0.7105686031457052}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=18 head_norm_before_train=1.260211 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9968191656701475, 'loss_val': 0.3094630998669491, 'psi': 0.8191813885092387}-{'f1_val': 0.7008317350254774, 'auprc': 0.9940507589180156, 'loss_val': 0.26175475465942477, 'psi': 0.8181193445824927}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=18 head_norm_before_train=1.151248 cos_to_last_merge=0.9557 (last merge round=13)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6666652433812391, 'auprc': 0.686518526383442, 'loss_val': 0.47799376377762887, 'psi': 0.6746065565821203}-{'f1_val': 0.6637949253770187, 'auprc': 0.8481466331102215, 'loss_val': 0.5030276522696004, 'psi': 0.7375356084702999}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=18 head_norm_before_train=1.634290 (no previous merge yet)
[S5] round=18 local utility u=0.005243 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9980927060824382, 'loss_val': 0.27464756511606847, 'psi': 0.8196021180305799}-{'f1_val': 0.7006083926626743, 'auprc': 0.9980922734780917, 'loss_val': 0.2851326972173254, 'psi': 0.8196019449888412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=18 head_norm_before_train=1.115280 cos_to_last_merge=0.9914 (last merge round=15)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7077380463841179, 'auprc': 0.8161002138776688, 'loss_val': 0.46270203427358214, 'psi': 0.7510829133815382}-{'f1_val': 0.7082494834376265, 'auprc': 0.9589339461852286, 'loss_val': 0.462584842505735, 'psi': 0.8085232685366673}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=1.137952 cos_to_last_merge=0.9585 (last merge round=11)
[S7] round=18 local utility u=0.580666 metrics={'f1_val': 0.6844094631835728, 'auprc': 0.9243959282333574, 'loss_val': 0.6017923705835644, 'psi': 0.7804040492034867}-{'f1_val': 0.5821439871014362, 'auprc': 0.7906719862145685, 'loss_val': 0.7483604446684411, 'psi': 0.6655551867466891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=18 head_norm_before_train=1.513218 cos_to_last_merge=0.9905 (last merge round=13)
[S8] round=18 local utility u=0.000083 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9958303534762273, 'loss_val': 0.1101954042454784, 'psi': 0.9962258069518959}-{'f1_val': 0.9963530749356245, 'auprc': 0.9986970433314709, 'loss_val': 0.11814401870753712, 'psi': 0.9972906622939631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=18 head_norm_before_train=1.211952 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9916350289240425, 'auprc': 0.9958798219756861, 'loss_val': 0.15546447246363151, 'psi': 0.9933329461447}-{'f1_val': 0.9916350289240425, 'auprc': 0.9968743839594691, 'loss_val': 0.14720541205253623, 'psi': 0.9937307709382133}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=18 head_norm_before_train=1.141693 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9570505690794957, 'auprc': 0.994102810572164, 'loss_val': 0.23714466865650358, 'psi': 0.971871465676563}-{'f1_val': 0.980287576089018, 'auprc': 0.9863697849414368, 'loss_val': 0.2341064209233024, 'psi': 0.9827204596299854}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=18 head_norm_before_train=1.732462 (no previous merge yet)
[S11] round=18 local utility u=0.010994 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9988999986147981, 'loss_val': 0.21357914168746037, 'psi': 0.8206153624427981}-{'f1_val': 0.7016934795869249, 'auprc': 0.9984246777582573, 'loss_val': 0.23374910290305526, 'psi': 0.8203859588554578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=18 head_norm_before_train=1.579863 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5895479527871523, 'auprc': 0.5674772674727478, 'loss_val': 0.6722640099762589, 'psi': 0.5807196786613905}-{'f1_val': 0.5867493541147113, 'auprc': 0.6730069674252813, 'loss_val': 0.680251693893248, 'psi': 0.6212523994389393}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=18 head_norm_before_train=1.502236 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.003525 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9974914578749583, 'loss_val': 0.07389422393428097, 'psi': 0.9977328865863122}-{'f1_val': 0.9976511180498535, 'auprc': 0.997426536448488, 'loss_val': 0.07929301494711835, 'psi': 0.9975612854093073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=18 head_norm_before_train=1.124888 cos_to_last_merge=0.9990 (last merge round=16)
[S15] round=18 local utility u=0.031031 metrics={'f1_val': 0.700135599555243, 'auprc': 0.9197408764433297, 'loss_val': 0.3881600152580351, 'psi': 0.7879777103104777}-{'f1_val': 0.6903601769800566, 'auprc': 0.9430285291851448, 'loss_val': 0.46143316567974874, 'psi': 0.7914275178620919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=18 head_norm_before_train=1.152915 cos_to_last_merge=0.9992 (last merge round=16)
[S16] round=18 local utility u=0.224958 metrics={'f1_val': 0.845874443552693, 'auprc': 0.8284994158158714, 'loss_val': 0.5760901426148033, 'psi': 0.8389244324579644}-{'f1_val': 0.8008594958513127, 'auprc': 0.7907667498416682, 'loss_val': 0.6427177126745853, 'psi': 0.7968223974474549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=18 head_norm_before_train=1.137580 cos_to_last_merge=0.9657 (last merge round=13)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3533986421506739, 'auprc': 0.7777341399379161, 'loss_val': 0.9635401676051206, 'psi': 0.5231328412655708}-{'f1_val': 0.3570412906265391, 'auprc': 0.7865012019477702, 'loss_val': 0.9431931208041127, 'psi': 0.5288252551550315}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=1.322435 cos_to_last_merge=0.7996 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.800
[S2] round=19 local utility u=0.096320 metrics={'f1_val': 0.7136413432754897, 'auprc': 0.7784063530345634, 'loss_val': 0.6199998856935357, 'psi': 0.7395473471791192}-{'f1_val': 0.7136331455310448, 'auprc': 0.7777052335302633, 'loss_val': 0.8104878170961599, 'psi': 0.7392619807307322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] sending update (kind=head size=1791 to 1 peers)
[S2] r=20 psi=0.740 u=0.0963 p_local=0.1249 f1=0.714 auprc=0.778 bytes=21560
[S3] START round=19 head_norm_before_train=1.293200 cos_to_last_merge=0.9995 (last merge round=17)
[S3] round=19 local utility u=0.006292 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9951126113128855, 'loss_val': 0.29130769987466354, 'psi': 0.8184536203243551}-{'f1_val': 0.7007562037352997, 'auprc': 0.9968191656701475, 'loss_val': 0.3094630998669491, 'psi': 0.8191813885092387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=20 psi=0.818 u=0.0063 p_local=0.0907 f1=0.701 auprc=0.995 bytes=23355
[S4] START round=19 head_norm_before_train=1.196930 cos_to_last_merge=0.9453 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=19 local utility u=0.365903 metrics={'f1_val': 0.6672003477897331, 'auprc': 0.9333928680577318, 'loss_val': 0.49002233320216804, 'psi': 0.7736773558969327}-{'f1_val': 0.6666652433812391, 'auprc': 0.686518526383442, 'loss_val': 0.47799376377762887, 'psi': 0.6746065565821203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S4] r=20 psi=0.774 u=0.3659 p_local=0.1496 f1=0.667 auprc=0.933 bytes=25139
[S5] START round=19 head_norm_before_train=1.653361 (no previous merge yet)
[S5] round=19 local utility u=0.001994 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9980641823815919, 'loss_val': 0.2705777513173581, 'psi': 0.8195911293561052}-{'f1_val': 0.7006083926626743, 'auprc': 0.9980927060824382, 'loss_val': 0.27464756511606847, 'psi': 0.8196021180305799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] r=20 psi=0.820 u=0.0020 p_local=0.0912 f1=0.701 auprc=0.998 bytes=30528
[S6] START round=19 head_norm_before_train=1.165329 cos_to_last_merge=0.9821 (last merge round=15)
[S6] round=19 local utility u=0.940200 metrics={'f1_val': 0.9298518019890526, 'auprc': 0.9609794484031585, 'loss_val': 0.34962286839182544, 'psi': 0.942302860554695}-{'f1_val': 0.7077380463841179, 'auprc': 0.8161002138776688, 'loss_val': 0.46270203427358214, 'psi': 0.7510829133815382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S6] r=20 psi=0.942 u=0.9402 p_local=0.3663 f1=0.930 auprc=0.961 bytes=23334
[S7] START round=19 head_norm_before_train=1.159427 cos_to_last_merge=0.9522 (last merge round=11)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.6765776378514403, 'auprc': 0.9042570998572906, 'loss_val': 0.5843775007390877, 'psi': 0.7676494226537804}-{'f1_val': 0.6844094631835728, 'auprc': 0.9243959282333574, 'loss_val': 0.6017923705835644, 'psi': 0.7804040492034867}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=20 psi=0.768 u=0.0000 p_local=0.2039 f1=0.677 auprc=0.904 bytes=23312
[S8] START round=19 head_norm_before_train=1.536832 cos_to_last_merge=0.9873 (last merge round=13)
[S8] round=19 local utility u=0.011114 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9994499321794643, 'loss_val': 0.09800696668522514, 'psi': 0.9975918178331604}-{'f1_val': 0.9964894426023416, 'auprc': 0.9958303534762273, 'loss_val': 0.1101954042454784, 'psi': 0.9962258069518959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] r=20 psi=0.998 u=0.0111 p_local=0.1961 f1=0.996 auprc=0.999 bytes=25164
[S9] START round=19 head_norm_before_train=1.251351 cos_to_last_merge=0.9990 (last merge round=17)
[S9] round=19 local utility u=0.032853 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9974210538584092, 'loss_val': 0.11953305189516954, 'psi': 0.9964644525618749}-{'f1_val': 0.9916350289240425, 'auprc': 0.9958798219756861, 'loss_val': 0.15546447246363151, 'psi': 0.9933329461447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] r=20 psi=0.996 u=0.0329 p_local=0.1667 f1=0.996 auprc=0.997 bytes=25174
[S10] START round=19 head_norm_before_train=1.180009 cos_to_last_merge=0.9991 (last merge round=17)
[S10] round=19 local utility u=0.107736 metrics={'f1_val': 0.9866133121704472, 'auprc': 0.9964307614556296, 'loss_val': 0.20603209929360217, 'psi': 0.9905402918845201}-{'f1_val': 0.9570505690794957, 'auprc': 0.994102810572164, 'loss_val': 0.23714466865650358, 'psi': 0.971871465676563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S10] r=20 psi=0.991 u=0.1077 p_local=0.1981 f1=0.987 auprc=0.996 bytes=27000
[S11] START round=19 head_norm_before_train=1.754821 (no previous merge yet)
[S11] round=19 local utility u=0.237865 metrics={'f1_val': 0.7908584564742913, 'auprc': 0.9989377643306636, 'loss_val': 0.2725596796393923, 'psi': 0.8740901796168402}-{'f1_val': 0.7017589383281313, 'auprc': 0.9988999986147981, 'loss_val': 0.21357914168746037, 'psi': 0.8206153624427981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] r=20 psi=0.874 u=0.2379 p_local=0.1237 f1=0.791 auprc=0.999 bytes=28798
[S13] START round=19 head_norm_before_train=1.597181 (no previous merge yet)
[S13] round=19 local utility u=0.153443 metrics={'f1_val': 0.5918444723435151, 'auprc': 0.6780536604935378, 'loss_val': 0.710886276073984, 'psi': 0.6263281476035242}-{'f1_val': 0.5895479527871523, 'auprc': 0.5674772674727478, 'loss_val': 0.6722640099762589, 'psi': 0.5807196786613905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S13] r=20 psi=0.626 u=0.1534 p_local=0.1415 f1=0.592 auprc=0.678 bytes=16194
[S14] START round=19 head_norm_before_train=1.537070 cos_to_last_merge=0.9997 (last merge round=17)
[S14] round=19 local utility u=0.006533 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9992289043752557, 'loss_val': 0.062119494054539884, 'psi': 0.998035775773578}-{'f1_val': 0.9978938390605482, 'auprc': 0.9974914578749583, 'loss_val': 0.07389422393428097, 'psi': 0.9977328865863122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=20 psi=0.998 u=0.0065 p_local=0.1059 f1=0.997 auprc=0.999 bytes=32337
[S15] START round=19 head_norm_before_train=1.161123 cos_to_last_merge=0.9967 (last merge round=16)
[S15] round=19 local utility u=0.002087 metrics={'f1_val': 0.6833615634943069, 'auprc': 0.9574024874344111, 'loss_val': 0.3963273747721463, 'psi': 0.7929779330703486}-{'f1_val': 0.700135599555243, 'auprc': 0.9197408764433297, 'loss_val': 0.3881600152580351, 'psi': 0.7879777103104777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=20 psi=0.793 u=0.0021 p_local=0.1313 f1=0.683 auprc=0.957 bytes=26928
[S16] START round=19 head_norm_before_train=1.198200 cos_to_last_merge=0.9969 (last merge round=16)
[S16] round=19 local utility u=0.135146 metrics={'f1_val': 0.8517800989694362, 'auprc': 0.8896626285409736, 'loss_val': 0.5247218237525074, 'psi': 0.8669331107980511}-{'f1_val': 0.845874443552693, 'auprc': 0.8284994158158714, 'loss_val': 0.5760901426148033, 'psi': 0.8389244324579644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S16] r=20 psi=0.867 u=0.1351 p_local=0.2429 f1=0.852 auprc=0.890 bytes=21581
[S17] START round=19 head_norm_before_train=1.163981 cos_to_last_merge=0.9581 (last merge round=13)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.3526314172644758, 'auprc': 0.7795487773945499, 'loss_val': 0.9778014527221746, 'psi': 0.5233983613165054}-{'f1_val': 0.3533986421506739, 'auprc': 0.7777341399379161, 'loss_val': 0.9635401676051206, 'psi': 0.5231328412655708}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.523 u=0.0000 p_local=0.0460 f1=0.353 auprc=0.780 bytes=21569
[S2] START round=20 head_norm_before_train=1.356842 cos_to_last_merge=0.7925 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6920398736077251, 'auprc': 0.6633730152409957, 'loss_val': 0.3371771938609227, 'psi': 0.6805731302610334}-{'f1_val': 0.7136413432754897, 'auprc': 0.7784063530345634, 'loss_val': 0.6199998856935357, 'psi': 0.7395473471791192}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.339162 cos_to_last_merge=0.9979 (last merge round=17)
[S3] round=20 local utility u=0.005981 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9963591713017517, 'loss_val': 0.28263540031868484, 'psi': 0.818907270020824}-{'f1_val': 0.7006809596653347, 'auprc': 0.9951126113128855, 'loss_val': 0.29130769987466354, 'psi': 0.8184536203243551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=20 head_norm_before_train=1.227459 cos_to_last_merge=0.9390 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=20 local utility u=0.338883 metrics={'f1_val': 0.7744907470429866, 'auprc': 0.9401060484063294, 'loss_val': 0.4761383956617959, 'psi': 0.8407368675883238}-{'f1_val': 0.6672003477897331, 'auprc': 0.9333928680577318, 'loss_val': 0.49002233320216804, 'psi': 0.7736773558969327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=20 head_norm_before_train=1.669797 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7945863942788346, 'loss_val': 0.5726835167793917, 'psi': 0.7465145972841389}-{'f1_val': 0.7006090940057808, 'auprc': 0.9980641823815919, 'loss_val': 0.2705777513173581, 'psi': 0.8195911293561052}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=20 head_norm_before_train=1.207439 cos_to_last_merge=0.9742 (last merge round=15)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8230803235125929, 'auprc': 0.9347432017143815, 'loss_val': 0.3921440095791428, 'psi': 0.8677454747933083}-{'f1_val': 0.9298518019890526, 'auprc': 0.9609794484031585, 'loss_val': 0.34962286839182544, 'psi': 0.942302860554695}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.184214 cos_to_last_merge=0.9464 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.946
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.4578695417954128, 'auprc': 0.8052047402548883, 'loss_val': 0.8295074071414499, 'psi': 0.596803621179203}-{'f1_val': 0.6765776378514403, 'auprc': 0.9042570998572906, 'loss_val': 0.5843775007390877, 'psi': 0.7676494226537804}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.562084 cos_to_last_merge=0.9845 (last merge round=13)
[S8] round=20 local utility u=0.003711 metrics={'f1_val': 0.9953865591243178, 'auprc': 0.9989814881899418, 'loss_val': 0.08337976763825379, 'psi': 0.9968245307505674}-{'f1_val': 0.9963530749356245, 'auprc': 0.9994499321794643, 'loss_val': 0.09800696668522514, 'psi': 0.9975918178331604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=20 head_norm_before_train=1.293945 cos_to_last_merge=0.9964 (last merge round=17)
[S9] round=20 local utility u=0.015385 metrics={'f1_val': 0.9964066858194072, 'auprc': 0.9979267389341946, 'loss_val': 0.09376075140194996, 'psi': 0.9970147070653221}-{'f1_val': 0.9958267183641853, 'auprc': 0.9974210538584092, 'loss_val': 0.11953305189516954, 'psi': 0.9964644525618749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=20 head_norm_before_train=1.214072 cos_to_last_merge=0.9972 (last merge round=17)
[S10] round=20 local utility u=0.034601 metrics={'f1_val': 0.9931444354953712, 'auprc': 0.9960910774979245, 'loss_val': 0.17499855656589888, 'psi': 0.9943230922963925}-{'f1_val': 0.9866133121704472, 'auprc': 0.9964307614556296, 'loss_val': 0.20603209929360217, 'psi': 0.9905402918845201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=20 head_norm_before_train=1.778092 (no previous merge yet)
[S11] round=20 local utility u=0.548420 metrics={'f1_val': 0.9568770330867039, 'auprc': 0.9985135189122819, 'loss_val': 0.17055904400792576, 'psi': 0.973531627416935}-{'f1_val': 0.7908584564742913, 'auprc': 0.9989377643306636, 'loss_val': 0.2725596796393923, 'psi': 0.8740901796168402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=20 head_norm_before_train=1.610325 (no previous merge yet)
[S13] round=20 local utility u=0.190952 metrics={'f1_val': 0.6372072719666323, 'auprc': 0.6566572823139281, 'loss_val': 0.536969867799153, 'psi': 0.6449872761055506}-{'f1_val': 0.5918444723435151, 'auprc': 0.6780536604935378, 'loss_val': 0.710886276073984, 'psi': 0.6263281476035242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=20 head_norm_before_train=1.571563 cos_to_last_merge=0.9991 (last merge round=17)
[S14] round=20 local utility u=0.000328 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9975346827233182, 'loss_val': 0.05985502297923748, 'psi': 0.9977055838696584}-{'f1_val': 0.997240356705793, 'auprc': 0.9992289043752557, 'loss_val': 0.062119494054539884, 'psi': 0.998035775773578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=20 head_norm_before_train=1.197445 cos_to_last_merge=0.9934 (last merge round=16)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6444397568255045, 'auprc': 0.9554573681076706, 'loss_val': 0.41049692368117086, 'psi': 0.7688468013383709}-{'f1_val': 0.6833615634943069, 'auprc': 0.9574024874344111, 'loss_val': 0.3963273747721463, 'psi': 0.7929779330703486}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.243315 cos_to_last_merge=0.9933 (last merge round=16)
[S16] round=20 local utility u=0.262268 metrics={'f1_val': 0.9027349270622469, 'auprc': 0.9221948938276678, 'loss_val': 0.40351165383984966, 'psi': 0.9105189137684153}-{'f1_val': 0.8517800989694362, 'auprc': 0.8896626285409736, 'loss_val': 0.5247218237525074, 'psi': 0.8669331107980511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=20 head_norm_before_train=1.181738 cos_to_last_merge=0.9529 (last merge round=13)
[S17] round=20 local utility u=0.100305 metrics={'f1_val': 0.3682311448883867, 'auprc': 0.8107396803805109, 'loss_val': 0.9643633801546241, 'psi': 0.5452345590852364}-{'f1_val': 0.3526314172644758, 'auprc': 0.7795487773945499, 'loss_val': 0.9778014527221746, 'psi': 0.5233983613165054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=21 head_norm_before_train=1.385875 cos_to_last_merge=0.7860 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.786
[S2] round=21 local utility u=0.010921 metrics={'f1_val': 0.6941968126181124, 'auprc': 0.6634619801791426, 'loss_val': 0.32854289690487154, 'psi': 0.6819028796425245}-{'f1_val': 0.6920398736077251, 'auprc': 0.6633730152409957, 'loss_val': 0.3371771938609227, 'psi': 0.6805731302610334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=21 head_norm_before_train=1.378722 cos_to_last_merge=0.9962 (last merge round=17)
[S3] round=21 local utility u=0.017871 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.998239460413609, 'loss_val': 0.25298481847320675, 'psi': 0.8197043599646445}-{'f1_val': 0.7006060025002057, 'auprc': 0.9963591713017517, 'loss_val': 0.28263540031868484, 'psi': 0.818907270020824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=21 head_norm_before_train=1.255093 cos_to_last_merge=0.9342 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.6281617434723701, 'auprc': 0.9392284730443188, 'loss_val': 0.47952700190550246, 'psi': 0.7525884353011496}-{'f1_val': 0.7744907470429866, 'auprc': 0.9401060484063294, 'loss_val': 0.4761383956617959, 'psi': 0.8407368675883238}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=21 head_norm_before_train=1.683768 (no previous merge yet)
[S5] round=21 local utility u=0.419904 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9983415711137542, 'loss_val': 0.260995064599975, 'psi': 0.8197020848489702}-{'f1_val': 0.7144667326210086, 'auprc': 0.7945863942788346, 'loss_val': 0.5726835167793917, 'psi': 0.7465145972841389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=21 head_norm_before_train=1.240078 cos_to_last_merge=0.9683 (last merge round=15)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.7059245082999276, 'auprc': 0.8200597294009875, 'loss_val': 0.4071686195422184, 'psi': 0.7515785967403517}-{'f1_val': 0.8230803235125929, 'auprc': 0.9347432017143815, 'loss_val': 0.3921440095791428, 'psi': 0.8677454747933083}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=1.202090 cos_to_last_merge=0.9419 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.942
[S7] round=21 local utility u=0.773852 metrics={'f1_val': 0.6323266171120907, 'auprc': 0.8954772214307297, 'loss_val': 0.5993636768044664, 'psi': 0.7375868588395463}-{'f1_val': 0.4578695417954128, 'auprc': 0.8052047402548883, 'loss_val': 0.8295074071414499, 'psi': 0.596803621179203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=21 head_norm_before_train=1.585488 cos_to_last_merge=0.9819 (last merge round=13)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9167797988875643, 'auprc': 0.9968012222734347, 'loss_val': 0.1413291499151945, 'psi': 0.9487883682419125}-{'f1_val': 0.9953865591243178, 'auprc': 0.9989814881899418, 'loss_val': 0.08337976763825379, 'psi': 0.9968245307505674}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=21 head_norm_before_train=1.339543 cos_to_last_merge=0.9927 (last merge round=17)
[S9] round=21 local utility u=0.007256 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.997899931215123, 'loss_val': 0.07568801410450715, 'psi': 0.9966560035045604}-{'f1_val': 0.9964066858194072, 'auprc': 0.9979267389341946, 'loss_val': 0.09376075140194996, 'psi': 0.9970147070653221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=21 head_norm_before_train=1.246298 cos_to_last_merge=0.9948 (last merge round=17)
[S10] round=21 local utility u=0.013260 metrics={'f1_val': 0.9936056073858861, 'auprc': 0.996018275474294, 'loss_val': 0.15102684954868342, 'psi': 0.9945706746212493}-{'f1_val': 0.9931444354953712, 'auprc': 0.9960910774979245, 'loss_val': 0.17499855656589888, 'psi': 0.9943230922963925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=21 head_norm_before_train=1.798711 (no previous merge yet)
[S11] round=21 local utility u=0.122298 metrics={'f1_val': 0.9979663375238416, 'auprc': 0.9984983295914266, 'loss_val': 0.17245399988171628, 'psi': 0.9981791343508757}-{'f1_val': 0.9568770330867039, 'auprc': 0.9985135189122819, 'loss_val': 0.17055904400792576, 'psi': 0.973531627416935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=21 head_norm_before_train=1.621075 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6062878589062198, 'auprc': 0.6813767823019014, 'loss_val': 0.6787129687582765, 'psi': 0.6363234282644925}-{'f1_val': 0.6372072719666323, 'auprc': 0.6566572823139281, 'loss_val': 0.536969867799153, 'psi': 0.6449872761055506}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.604433 cos_to_last_merge=0.9981 (last merge round=17)
[S14] round=21 local utility u=0.005462 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9975367739231074, 'loss_val': 0.05039360471371155, 'psi': 0.9978521294784508}-{'f1_val': 0.9978195179672185, 'auprc': 0.9975346827233182, 'loss_val': 0.05985502297923748, 'psi': 0.9977055838696584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=21 head_norm_before_train=1.236091 cos_to_last_merge=0.9892 (last merge round=16)
[S15] round=21 local utility u=0.119798 metrics={'f1_val': 0.6721299839446018, 'auprc': 0.9698776394458068, 'loss_val': 0.3803040216050608, 'psi': 0.7912290461450838}-{'f1_val': 0.6444397568255045, 'auprc': 0.9554573681076706, 'loss_val': 0.41049692368117086, 'psi': 0.7688468013383709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=21 head_norm_before_train=1.289543 cos_to_last_merge=0.9888 (last merge round=16)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8356519434688507, 'auprc': 0.9327187021697956, 'loss_val': 0.3668898264260928, 'psi': 0.8744786469492287}-{'f1_val': 0.9027349270622469, 'auprc': 0.9221948938276678, 'loss_val': 0.40351165383984966, 'psi': 0.9105189137684153}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.193015 cos_to_last_merge=0.9497 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.950
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.352526917700439, 'auprc': 0.8229113381627076, 'loss_val': 0.955892639494893, 'psi': 0.5406806858853465}-{'f1_val': 0.3682311448883867, 'auprc': 0.8107396803805109, 'loss_val': 0.9643633801546241, 'psi': 0.5452345590852364}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=22 head_norm_before_train=1.409291 cos_to_last_merge=0.7819 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=22 local utility u=0.022358 metrics={'f1_val': 0.6998782706034998, 'auprc': 0.6654855286205726, 'loss_val': 0.3239860134245689, 'psi': 0.686121173810329}-{'f1_val': 0.6941968126181124, 'auprc': 0.6634619801791426, 'loss_val': 0.32854289690487154, 'psi': 0.6819028796425245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=22 head_norm_before_train=1.412488 cos_to_last_merge=0.9944 (last merge round=17)
[S3] round=22 local utility u=0.013458 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984159778267429, 'loss_val': 0.22659762544994327, 'psi': 0.8197749669298979}-{'f1_val': 0.7006809596653347, 'auprc': 0.998239460413609, 'loss_val': 0.25298481847320675, 'psi': 0.8197043599646445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=22 head_norm_before_train=1.279996 cos_to_last_merge=0.9301 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=22 local utility u=0.925636 metrics={'f1_val': 0.9277475179053499, 'auprc': 0.9464429167386166, 'loss_val': 0.44741369118682506, 'psi': 0.9352256774386567}-{'f1_val': 0.6281617434723701, 'auprc': 0.9392284730443188, 'loss_val': 0.47952700190550246, 'psi': 0.7525884353011496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=22 head_norm_before_train=1.693642 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7072543525995334, 'auprc': 0.844733476145555, 'loss_val': 0.35441338238848646, 'psi': 0.762246002017942}-{'f1_val': 0.7006090940057808, 'auprc': 0.9983415711137542, 'loss_val': 0.260995064599975, 'psi': 0.8197020848489702}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.266234 cos_to_last_merge=0.9634 (last merge round=15)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.9584793713228956, 'auprc': 0.9705273667391343, 'loss_val': 0.24936318205298863, 'psi': 0.9632985694893912}-{'f1_val': 0.7059245082999276, 'auprc': 0.8200597294009875, 'loss_val': 0.4071686195422184, 'psi': 0.7515785967403517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=22 head_norm_before_train=1.214302 cos_to_last_merge=0.9386 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.634500631637207, 'auprc': 0.8707518998585545, 'loss_val': 0.583984153914332, 'psi': 0.729001138925746}-{'f1_val': 0.6323266171120907, 'auprc': 0.8954772214307297, 'loss_val': 0.5993636768044664, 'psi': 0.7375868588395463}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=1.610052 cos_to_last_merge=0.9799 (last merge round=13)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9951311171908842, 'loss_val': 0.28399628808343713, 'psi': 0.8265570065821075}-{'f1_val': 0.9167797988875643, 'auprc': 0.9968012222734347, 'loss_val': 0.1413291499151945, 'psi': 0.9487883682419125}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=22 head_norm_before_train=1.379141 cos_to_last_merge=0.9883 (last merge round=17)
[S9] round=22 local utility u=0.005179 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9973908724368776, 'loss_val': 0.06380193298424604, 'psi': 0.9964523799932623}-{'f1_val': 0.9958267183641853, 'auprc': 0.997899931215123, 'loss_val': 0.07568801410450715, 'psi': 0.9966560035045604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=22 head_norm_before_train=1.278601 cos_to_last_merge=0.9918 (last merge round=17)
[S10] round=22 local utility u=0.011551 metrics={'f1_val': 0.9940199877788888, 'auprc': 0.9958744698805603, 'loss_val': 0.12997880098079434, 'psi': 0.9947617806195574}-{'f1_val': 0.9936056073858861, 'auprc': 0.996018275474294, 'loss_val': 0.15102684954868342, 'psi': 0.9945706746212493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=22 head_norm_before_train=1.821490 (no previous merge yet)
[S11] round=22 local utility u=0.029340 metrics={'f1_val': 0.9971333159512151, 'auprc': 0.9988684201747298, 'loss_val': 0.10988638248390536, 'psi': 0.9978273576406209}-{'f1_val': 0.9979663375238416, 'auprc': 0.9984983295914266, 'loss_val': 0.17245399988171628, 'psi': 0.9981791343508757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=22 head_norm_before_train=1.627949 (no previous merge yet)
[S13] round=22 local utility u=0.005049 metrics={'f1_val': 0.6145215455885501, 'auprc': 0.6678442594641125, 'loss_val': 0.6774190980003453, 'psi': 0.635850631138775}-{'f1_val': 0.6062878589062198, 'auprc': 0.6813767823019014, 'loss_val': 0.6787129687582765, 'psi': 0.6363234282644925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=22 head_norm_before_train=1.633253 cos_to_last_merge=0.9969 (last merge round=17)
[S14] round=22 local utility u=0.006482 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9991342436149615, 'loss_val': 0.04367775286826552, 'psi': 0.9986367499616093}-{'f1_val': 0.9980623665153463, 'auprc': 0.9975367739231074, 'loss_val': 0.05039360471371155, 'psi': 0.9978521294784508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=22 head_norm_before_train=1.269276 cos_to_last_merge=0.9851 (last merge round=16)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6767899384543911, 'auprc': 0.9707117216968415, 'loss_val': 0.4215543581864178, 'psi': 0.7943586517513712}-{'f1_val': 0.6721299839446018, 'auprc': 0.9698776394458068, 'loss_val': 0.3803040216050608, 'psi': 0.7912290461450838}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=22 head_norm_before_train=1.334401 cos_to_last_merge=0.9842 (last merge round=16)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8367941098116765, 'auprc': 0.9386295674193442, 'loss_val': 0.6402503352838274, 'psi': 0.8775282928547435}-{'f1_val': 0.8356519434688507, 'auprc': 0.9327187021697956, 'loss_val': 0.3668898264260928, 'psi': 0.8744786469492287}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.205055 cos_to_last_merge=0.9467 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=22 local utility u=0.069474 metrics={'f1_val': 0.35874745624364646, 'auprc': 0.8281357792219908, 'loss_val': 0.8699420133463147, 'psi': 0.5465027854349842}-{'f1_val': 0.352526917700439, 'auprc': 0.8229113381627076, 'loss_val': 0.955892639494893, 'psi': 0.5406806858853465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=23 head_norm_before_train=1.430133 cos_to_last_merge=0.7783 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7136331455310448, 'auprc': 0.7789053880595179, 'loss_val': 0.7833258012144191, 'psi': 0.7397420425424341}-{'f1_val': 0.6998782706034998, 'auprc': 0.6654855286205726, 'loss_val': 0.3239860134245689, 'psi': 0.686121173810329}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.445840 cos_to_last_merge=0.9924 (last merge round=17)
[S3] round=23 local utility u=0.005753 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986616758061668, 'loss_val': 0.21582898528255154, 'psi': 0.8198732461216676}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984159778267429, 'loss_val': 0.22659762544994327, 'psi': 0.8197749669298979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=23 head_norm_before_train=1.304455 cos_to_last_merge=0.9264 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=23 local utility u=0.067862 metrics={'f1_val': 0.9410949197977002, 'auprc': 0.9544353113162608, 'loss_val': 0.41575161557017326, 'psi': 0.9464310764051245}-{'f1_val': 0.9277475179053499, 'auprc': 0.9464429167386166, 'loss_val': 0.44741369118682506, 'psi': 0.9352256774386567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=23 head_norm_before_train=1.705703 (no previous merge yet)
[S5] round=23 local utility u=0.268864 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9980663092224648, 'loss_val': 0.23680773441340192, 'psi': 0.8195915592865906}-{'f1_val': 0.7072543525995334, 'auprc': 0.844733476145555, 'loss_val': 0.35441338238848646, 'psi': 0.762246002017942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=23 head_norm_before_train=1.292376 cos_to_last_merge=0.9590 (last merge round=15)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6561994381560834, 'auprc': 0.775098628298474, 'loss_val': 0.5159219482801372, 'psi': 0.7037591142130396}-{'f1_val': 0.9584793713228956, 'auprc': 0.9705273667391343, 'loss_val': 0.24936318205298863, 'psi': 0.9632985694893912}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.226492 cos_to_last_merge=0.9356 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.434135337763738, 'auprc': 0.7818837480571079, 'loss_val': 0.9066632526408956, 'psi': 0.5732347018810859}-{'f1_val': 0.634500631637207, 'auprc': 0.8707518998585545, 'loss_val': 0.583984153914332, 'psi': 0.729001138925746}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=1.632823 cos_to_last_merge=0.9783 (last merge round=13)
[S8] round=23 local utility u=0.943677 metrics={'f1_val': 0.9926890924467884, 'auprc': 0.9973164035863584, 'loss_val': 0.07428638801814551, 'psi': 0.9945400169026164}-{'f1_val': 0.7141742661762565, 'auprc': 0.9951311171908842, 'loss_val': 0.28399628808343713, 'psi': 0.8265570065821075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=23 head_norm_before_train=1.416087 cos_to_last_merge=0.9837 (last merge round=17)
[S9] round=23 local utility u=0.004381 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.997358949940303, 'loss_val': 0.05494373824675937, 'psi': 0.9964396109946325}-{'f1_val': 0.9958267183641853, 'auprc': 0.9973908724368776, 'loss_val': 0.06380193298424604, 'psi': 0.9964523799932623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=23 head_norm_before_train=1.320638 cos_to_last_merge=0.9871 (last merge round=17)
[S10] round=23 local utility u=0.009898 metrics={'f1_val': 0.994048225356002, 'auprc': 0.995467244879298, 'loss_val': 0.10913142149593973, 'psi': 0.9946158331653204}-{'f1_val': 0.9940199877788888, 'auprc': 0.9958744698805603, 'loss_val': 0.12997880098079434, 'psi': 0.9947617806195574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=23 head_norm_before_train=1.847993 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9936171615678332, 'auprc': 0.9992470979241131, 'loss_val': 0.10229216679696454, 'psi': 0.9958691361103451}-{'f1_val': 0.9971333159512151, 'auprc': 0.9988684201747298, 'loss_val': 0.10988638248390536, 'psi': 0.9978273576406209}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=1.635432 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6102764204113874, 'auprc': 0.6666536134430942, 'loss_val': 0.6988499451565904, 'psi': 0.6328272976240701}-{'f1_val': 0.6145215455885501, 'auprc': 0.6678442594641125, 'loss_val': 0.6774190980003453, 'psi': 0.635850631138775}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.657161 cos_to_last_merge=0.9957 (last merge round=17)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9975363392547621, 'loss_val': 0.04083448349916644, 'psi': 0.9978519556111127}-{'f1_val': 0.9983050875260411, 'auprc': 0.9991342436149615, 'loss_val': 0.04367775286826552, 'psi': 0.9986367499616093}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=1.296734 cos_to_last_merge=0.9815 (last merge round=16)
[S15] round=23 local utility u=0.076440 metrics={'f1_val': 0.7126171037808289, 'auprc': 0.9564307508395515, 'loss_val': 0.44079473571123357, 'psi': 0.8101425626043179}-{'f1_val': 0.6767899384543911, 'auprc': 0.9707117216968415, 'loss_val': 0.4215543581864178, 'psi': 0.7943586517513712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=23 head_norm_before_train=1.375462 cos_to_last_merge=0.9799 (last merge round=16)
[S16] round=23 local utility u=0.320400 metrics={'f1_val': 0.8900437345726785, 'auprc': 0.9657503215124216, 'loss_val': 0.40031115861771777, 'psi': 0.9203263693485757}-{'f1_val': 0.8367941098116765, 'auprc': 0.9386295674193442, 'loss_val': 0.6402503352838274, 'psi': 0.8775282928547435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=23 head_norm_before_train=1.216331 cos_to_last_merge=0.9444 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=23 local utility u=0.315003 metrics={'f1_val': 0.4613149193005657, 'auprc': 0.826230749369571, 'loss_val': 0.849625312940722, 'psi': 0.6072812513281678}-{'f1_val': 0.35874745624364646, 'auprc': 0.8281357792219908, 'loss_val': 0.8699420133463147, 'psi': 0.5465027854349842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=24 head_norm_before_train=1.450262 cos_to_last_merge=0.7753 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.775
[S2] round=24 local utility u=0.002607 metrics={'f1_val': 0.7136331455310448, 'auprc': 0.778553949850567, 'loss_val': 0.7770583393196274, 'psi': 0.7396014672588538}-{'f1_val': 0.7136331455310448, 'auprc': 0.7789053880595179, 'loss_val': 0.7833258012144191, 'psi': 0.7397420425424341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=24 head_norm_before_train=1.478871 cos_to_last_merge=0.9902 (last merge round=17)
[S3] round=24 local utility u=0.008744 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9980814999663894, 'loss_val': 0.19615148378942038, 'psi': 0.8195962014866791}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986616758061668, 'loss_val': 0.21582898528255154, 'psi': 0.8198732461216676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=24 head_norm_before_train=1.326100 cos_to_last_merge=0.9234 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=24 local utility u=0.095038 metrics={'f1_val': 0.954557591593895, 'auprc': 0.9555449396246347, 'loss_val': 0.3097813590254446, 'psi': 0.9549525308061908}-{'f1_val': 0.9410949197977002, 'auprc': 0.9544353113162608, 'loss_val': 0.41575161557017326, 'psi': 0.9464310764051245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=24 head_norm_before_train=1.718627 (no previous merge yet)
[S5] round=24 local utility u=0.004490 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9975552018781606, 'loss_val': 0.22629377297036649, 'psi': 0.8193871163488688}-{'f1_val': 0.7006083926626743, 'auprc': 0.9980663092224648, 'loss_val': 0.23680773441340192, 'psi': 0.8195915592865906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=24 head_norm_before_train=1.317021 cos_to_last_merge=0.9550 (last merge round=15)
[S6] round=24 local utility u=0.045677 metrics={'f1_val': 0.6423464279941369, 'auprc': 0.8140595907657142, 'loss_val': 0.4583321001854633, 'psi': 0.7110316931027678}-{'f1_val': 0.6561994381560834, 'auprc': 0.775098628298474, 'loss_val': 0.5159219482801372, 'psi': 0.7037591142130396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=24 head_norm_before_train=1.237213 cos_to_last_merge=0.9330 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=24 local utility u=1.000000 metrics={'f1_val': 0.6847650592845993, 'auprc': 0.9013673285901469, 'loss_val': 0.4506617584589112, 'psi': 0.7714059670068183}-{'f1_val': 0.434135337763738, 'auprc': 0.7818837480571079, 'loss_val': 0.9066632526408956, 'psi': 0.5732347018810859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=24 head_norm_before_train=1.650813 cos_to_last_merge=0.9771 (last merge round=13)
[S8] round=24 local utility u=0.001223 metrics={'f1_val': 0.9947260579304857, 'auprc': 0.9932869359566303, 'loss_val': 0.07197321781630181, 'psi': 0.9941504091409435}-{'f1_val': 0.9926890924467884, 'auprc': 0.9973164035863584, 'loss_val': 0.07428638801814551, 'psi': 0.9945400169026164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=24 head_norm_before_train=1.449718 cos_to_last_merge=0.9796 (last merge round=17)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9971492428293158, 'loss_val': 0.05407492407869671, 'psi': 0.9940988892597624}-{'f1_val': 0.9958267183641853, 'auprc': 0.997358949940303, 'loss_val': 0.05494373824675937, 'psi': 0.9964396109946325}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.369172 cos_to_last_merge=0.9810 (last merge round=17)
[S10] round=24 local utility u=0.009359 metrics={'f1_val': 0.9940199877788888, 'auprc': 0.9956104023115404, 'loss_val': 0.09067378003183567, 'psi': 0.9946561535919494}-{'f1_val': 0.994048225356002, 'auprc': 0.995467244879298, 'loss_val': 0.10913142149593973, 'psi': 0.9946158331653204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=24 head_norm_before_train=1.877353 (no previous merge yet)
[S11] round=24 local utility u=0.031384 metrics={'f1_val': 0.9971565747497426, 'auprc': 0.9988836076636076, 'loss_val': 0.059669370044254356, 'psi': 0.9978473879152886}-{'f1_val': 0.9936171615678332, 'auprc': 0.9992470979241131, 'loss_val': 0.10229216679696454, 'psi': 0.9958691361103451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=24 head_norm_before_train=1.643105 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5966177113384612, 'auprc': 0.6748060826883944, 'loss_val': 0.7282479145508783, 'psi': 0.6278930598784345}-{'f1_val': 0.6102764204113874, 'auprc': 0.6666536134430942, 'loss_val': 0.6988499451565904, 'psi': 0.6328272976240701}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.681483 cos_to_last_merge=0.9946 (last merge round=17)
[S14] round=24 local utility u=0.000647 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9975357240138774, 'loss_val': 0.03808249538000015, 'psi': 0.997706000385882}-{'f1_val': 0.9980623665153463, 'auprc': 0.9975363392547621, 'loss_val': 0.04083448349916644, 'psi': 0.9978519556111127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=24 head_norm_before_train=1.320164 cos_to_last_merge=0.9783 (last merge round=16)
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.9857395319878801, 'auprc': 0.9913644067586584, 'loss_val': 0.16536311231335685, 'psi': 0.9879894818961915}-{'f1_val': 0.7126171037808289, 'auprc': 0.9564307508395515, 'loss_val': 0.44079473571123357, 'psi': 0.8101425626043179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=24 head_norm_before_train=1.412187 cos_to_last_merge=0.9758 (last merge round=16)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8703033214459454, 'auprc': 0.956197683161197, 'loss_val': 0.49605983110611385, 'psi': 0.904661066132046}-{'f1_val': 0.8900437345726785, 'auprc': 0.9657503215124216, 'loss_val': 0.40031115861771777, 'psi': 0.9203263693485757}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.225176 cos_to_last_merge=0.9424 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.3841530315896342, 'auprc': 0.832158007753239, 'loss_val': 0.7756314414199006, 'psi': 0.5633550220550761}-{'f1_val': 0.4613149193005657, 'auprc': 0.826230749369571, 'loss_val': 0.849625312940722, 'psi': 0.6072812513281678}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.468208 cos_to_last_merge=0.7725 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=25 local utility u=0.029898 metrics={'f1_val': 0.7115679450241474, 'auprc': 0.7753119989731504, 'loss_val': 0.695145011257006, 'psi': 0.7370655666037487}-{'f1_val': 0.7136331455310448, 'auprc': 0.778553949850567, 'loss_val': 0.7770583393196274, 'psi': 0.7396014672588538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=25 head_norm_before_train=1.514386 cos_to_last_merge=0.9875 (last merge round=17)
[S3] round=25 local utility u=0.806765 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9986620963672179, 'loss_val': 0.14415258937956138, 'psi': 0.9758074229682626}-{'f1_val': 0.7006060025002057, 'auprc': 0.9980814999663894, 'loss_val': 0.19615148378942038, 'psi': 0.8195962014866791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=25 head_norm_before_train=1.346280 cos_to_last_merge=0.9204 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9421447411965165, 'auprc': 0.9591846497942241, 'loss_val': 0.31747451700061263, 'psi': 0.9489607046355996}-{'f1_val': 0.954557591593895, 'auprc': 0.9555449396246347, 'loss_val': 0.3097813590254446, 'psi': 0.9549525308061908}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=25 head_norm_before_train=1.730998 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7017989039197601, 'auprc': 0.9544111072368116, 'loss_val': 0.30539977684869174, 'psi': 0.8028437852465806}-{'f1_val': 0.7006083926626743, 'auprc': 0.9975552018781606, 'loss_val': 0.22629377297036649, 'psi': 0.8193871163488688}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.338268 cos_to_last_merge=0.9513 (last merge round=15)
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.9441382964495896, 'auprc': 0.9789196642609721, 'loss_val': 0.21474144868428272, 'psi': 0.9580508435741426}-{'f1_val': 0.6423464279941369, 'auprc': 0.8140595907657142, 'loss_val': 0.4583321001854633, 'psi': 0.7110316931027678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=25 head_norm_before_train=1.246556 cos_to_last_merge=0.9309 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5097079809092269, 'auprc': 0.7839826364628504, 'loss_val': 0.8320807390454545, 'psi': 0.6194178431306763}-{'f1_val': 0.6847650592845993, 'auprc': 0.9013673285901469, 'loss_val': 0.4506617584589112, 'psi': 0.7714059670068183}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=1.663049 cos_to_last_merge=0.9761 (last merge round=13)
[S8] round=25 local utility u=0.018203 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9992305040605817, 'loss_val': 0.0631600290279474, 'psi': 0.9975040465856074}-{'f1_val': 0.9947260579304857, 'auprc': 0.9932869359566303, 'loss_val': 0.07197321781630181, 'psi': 0.9941504091409435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=25 head_norm_before_train=1.476483 cos_to_last_merge=0.9759 (last merge round=17)
[S9] round=25 local utility u=0.015020 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.995042562554926, 'loss_val': 0.04528530010079998, 'psi': 0.9960133321103053}-{'f1_val': 0.9920653202133933, 'auprc': 0.9971492428293158, 'loss_val': 0.05407492407869671, 'psi': 0.9940988892597624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=25 head_norm_before_train=1.417983 cos_to_last_merge=0.9747 (last merge round=17)
[S10] round=25 local utility u=0.003419 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9946337905105458, 'loss_val': 0.07713166248659224, 'psi': 0.9938881264051129}-{'f1_val': 0.9940199877788888, 'auprc': 0.9956104023115404, 'loss_val': 0.09067378003183567, 'psi': 0.9946561535919494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=25 head_norm_before_train=1.906882 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.959047003993242, 'auprc': 0.9987858351129952, 'loss_val': 0.1175763424884186, 'psi': 0.9749425364411433}-{'f1_val': 0.9971565747497426, 'auprc': 0.9988836076636076, 'loss_val': 0.059669370044254356, 'psi': 0.9978473879152886}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.650362 (no previous merge yet)
[S13] round=25 local utility u=0.046395 metrics={'f1_val': 0.6113433323839089, 'auprc': 0.6415156536622277, 'loss_val': 0.6239398240828137, 'psi': 0.6234122608952365}-{'f1_val': 0.5966177113384612, 'auprc': 0.6748060826883944, 'loss_val': 0.7282479145508783, 'psi': 0.6278930598784345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=25 head_norm_before_train=1.704454 cos_to_last_merge=0.9934 (last merge round=17)
[S14] round=25 local utility u=0.005727 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9992307133215743, 'loss_val': 0.03317148837595409, 'psi': 0.9985297052378376}-{'f1_val': 0.9978195179672185, 'auprc': 0.9975357240138774, 'loss_val': 0.03808249538000015, 'psi': 0.997706000385882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=25 head_norm_before_train=1.343789 cos_to_last_merge=0.9750 (last merge round=16)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7009215285406828, 'auprc': 0.9785346492132789, 'loss_val': 0.37285867598489464, 'psi': 0.8119667768097213}-{'f1_val': 0.9857395319878801, 'auprc': 0.9913644067586584, 'loss_val': 0.16536311231335685, 'psi': 0.9879894818961915}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.445856 cos_to_last_merge=0.9722 (last merge round=16)
[S16] round=25 local utility u=0.084507 metrics={'f1_val': 0.8819310767930498, 'auprc': 0.9735889868106138, 'loss_val': 0.4489857441496667, 'psi': 0.9185942408000753}-{'f1_val': 0.8703033214459454, 'auprc': 0.956197683161197, 'loss_val': 0.49605983110611385, 'psi': 0.904661066132046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=25 head_norm_before_train=1.236751 cos_to_last_merge=0.9408 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=25 local utility u=0.107022 metrics={'f1_val': 0.3955756086194413, 'auprc': 0.8450759229640279, 'loss_val': 0.668876112054592, 'psi': 0.575375734357276}-{'f1_val': 0.3841530315896342, 'auprc': 0.832158007753239, 'loss_val': 0.7756314414199006, 'psi': 0.5633550220550761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=26 head_norm_before_train=1.482929 cos_to_last_merge=0.7699 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7134602096539423, 'auprc': 0.776884854007508, 'loss_val': 0.9152713753969051, 'psi': 0.7388300673953685}-{'f1_val': 0.7115679450241474, 'auprc': 0.7753119989731504, 'loss_val': 0.695145011257006, 'psi': 0.7370655666037487}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.547746 cos_to_last_merge=0.9847 (last merge round=17)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.7638492440928308, 'auprc': 0.9980609741377428, 'loss_val': 0.18541174142899583, 'psi': 0.8575339361107956}-{'f1_val': 0.9605709740356257, 'auprc': 0.9986620963672179, 'loss_val': 0.14415258937956138, 'psi': 0.9758074229682626}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.360594 cos_to_last_merge=0.9183 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=26 local utility u=0.002781 metrics={'f1_val': 0.9412606893283423, 'auprc': 0.9640999773319667, 'loss_val': 0.3213538816798123, 'psi': 0.9503964045297921}-{'f1_val': 0.9421447411965165, 'auprc': 0.9591846497942241, 'loss_val': 0.31747451700061263, 'psi': 0.9489607046355996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=26 head_norm_before_train=1.743587 (no previous merge yet)
[S5] round=26 local utility u=0.098723 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9940050608765516, 'loss_val': 0.21959600521690564, 'psi': 0.8179674807540891}-{'f1_val': 0.7017989039197601, 'auprc': 0.9544111072368116, 'loss_val': 0.30539977684869174, 'psi': 0.8028437852465806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=26 head_norm_before_train=1.360581 cos_to_last_merge=0.9477 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.46282471779021606, 'auprc': 0.7807285215844028, 'loss_val': 0.767739702267965, 'psi': 0.5899862393078907}-{'f1_val': 0.9441382964495896, 'auprc': 0.9789196642609721, 'loss_val': 0.21474144868428272, 'psi': 0.9580508435741426}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.258347 cos_to_last_merge=0.9280 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.928
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.6988766735852125, 'auprc': 0.9854671198136286, 'loss_val': 0.36750424467458315, 'psi': 0.813512852076579}-{'f1_val': 0.5097079809092269, 'auprc': 0.7839826364628504, 'loss_val': 0.8320807390454545, 'psi': 0.6194178431306763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=26 head_norm_before_train=1.673707 cos_to_last_merge=0.9754 (last merge round=13)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9943653952188958, 'auprc': 0.995717799282153, 'loss_val': 0.07155763289231452, 'psi': 0.9949063568441987}-{'f1_val': 0.9963530749356245, 'auprc': 0.9992305040605817, 'loss_val': 0.0631600290279474, 'psi': 0.9975040465856074}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=1.501304 cos_to_last_merge=0.9729 (last merge round=17)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.981983256321335, 'auprc': 0.9944103697130467, 'loss_val': 0.08533983440510372, 'psi': 0.9869541016780197}-{'f1_val': 0.9966605118138915, 'auprc': 0.995042562554926, 'loss_val': 0.04528530010079998, 'psi': 0.9960133321103053}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=1.462379 cos_to_last_merge=0.9690 (last merge round=17)
[S10] round=26 local utility u=0.001682 metrics={'f1_val': 0.9942179850461464, 'auprc': 0.9918948904657812, 'loss_val': 0.07051293304330868, 'psi': 0.9932887472140003}-{'f1_val': 0.993391017001491, 'auprc': 0.9946337905105458, 'loss_val': 0.07713166248659224, 'psi': 0.9938881264051129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=26 head_norm_before_train=1.933863 (no previous merge yet)
[S11] round=26 local utility u=0.151305 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9987983765573785, 'loss_val': 0.03855330727091358, 'psi': 0.997302451104268}-{'f1_val': 0.959047003993242, 'auprc': 0.9987858351129952, 'loss_val': 0.1175763424884186, 'psi': 0.9749425364411433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=26 head_norm_before_train=1.658380 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5881854691268531, 'auprc': 0.6862847858783443, 'loss_val': 0.8245918640008897, 'psi': 0.6274251958274495}-{'f1_val': 0.6113433323839089, 'auprc': 0.6415156536622277, 'loss_val': 0.6239398240828137, 'psi': 0.6234122608952365}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.723920 cos_to_last_merge=0.9923 (last merge round=17)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9992315744251914, 'loss_val': 0.032778324269468744, 'psi': 0.9982849354596501}-{'f1_val': 0.9980623665153463, 'auprc': 0.9992307133215743, 'loss_val': 0.03317148837595409, 'psi': 0.9985297052378376}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.365422 cos_to_last_merge=0.9717 (last merge round=16)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8305617866852121, 'auprc': 0.8413860564611615, 'loss_val': 0.9256818265325953, 'psi': 0.8348914945955919}-{'f1_val': 0.7009215285406828, 'auprc': 0.9785346492132789, 'loss_val': 0.37285867598489464, 'psi': 0.8119667768097213}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.477577 cos_to_last_merge=0.9687 (last merge round=16)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8333680383482603, 'auprc': 0.9308416514822823, 'loss_val': 0.805882283049053, 'psi': 0.8723574836018692}-{'f1_val': 0.8819310767930498, 'auprc': 0.9735889868106138, 'loss_val': 0.4489857441496667, 'psi': 0.9185942408000753}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.247680 cos_to_last_merge=0.9398 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.940
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.3937167209882674, 'auprc': 0.8473065298050406, 'loss_val': 0.6844120079407452, 'psi': 0.5751526445149767}-{'f1_val': 0.3955756086194413, 'auprc': 0.8450759229640279, 'loss_val': 0.668876112054592, 'psi': 0.575375734357276}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.495040 cos_to_last_merge=0.7684 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.768
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6711193459194583, 'auprc': 0.6502840258683252, 'loss_val': 0.4844213352865628, 'psi': 0.662785217899005}-{'f1_val': 0.7134602096539423, 'auprc': 0.776884854007508, 'loss_val': 0.9152713753969051, 'psi': 0.7388300673953685}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.578943 cos_to_last_merge=0.9819 (last merge round=17)
[S3] round=27 local utility u=0.745675 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9984246442747271, 'loss_val': 0.09874695083603156, 'psi': 0.9980387555368494}-{'f1_val': 0.7638492440928308, 'auprc': 0.9980609741377428, 'loss_val': 0.18541174142899583, 'psi': 0.8575339361107956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=27 head_norm_before_train=1.373646 cos_to_last_merge=0.9163 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9237398992934696, 'auprc': 0.9635722897425906, 'loss_val': 0.38315729330253573, 'psi': 0.939672855473118}-{'f1_val': 0.9412606893283423, 'auprc': 0.9640999773319667, 'loss_val': 0.3213538816798123, 'psi': 0.9503964045297921}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.754262 (no previous merge yet)
[S5] round=27 local utility u=0.640127 metrics={'f1_val': 0.917217508967907, 'auprc': 0.9950969095876673, 'loss_val': 0.24226822003008364, 'psi': 0.948369269215811}-{'f1_val': 0.7006090940057808, 'auprc': 0.9940050608765516, 'loss_val': 0.21959600521690564, 'psi': 0.8179674807540891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=27 head_norm_before_train=1.380307 cos_to_last_merge=0.9446 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.8223657619724346, 'auprc': 0.9480549555194182, 'loss_val': 0.3240977793878913, 'psi': 0.8726414393912281}-{'f1_val': 0.46282471779021606, 'auprc': 0.7807285215844028, 'loss_val': 0.767739702267965, 'psi': 0.5899862393078907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=27 head_norm_before_train=1.269054 cos_to_last_merge=0.9254 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.925
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5485937181065218, 'auprc': 0.786074166359862, 'loss_val': 0.7690755295004523, 'psi': 0.6435858974078579}-{'f1_val': 0.6988766735852125, 'auprc': 0.9854671198136286, 'loss_val': 0.36750424467458315, 'psi': 0.813512852076579}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=1.685227 cos_to_last_merge=0.9747 (last merge round=13)
[S8] round=27 local utility u=0.008292 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9990994130068949, 'loss_val': 0.060722905129827996, 'psi': 0.9958194463159344}-{'f1_val': 0.9943653952188958, 'auprc': 0.995717799282153, 'loss_val': 0.07155763289231452, 'psi': 0.9949063568441987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=27 head_norm_before_train=1.523420 cos_to_last_merge=0.9706 (last merge round=17)
[S9] round=27 local utility u=0.061700 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9924488608038529, 'loss_val': 0.04165694109277379, 'psi': 0.9947296011891077}-{'f1_val': 0.981983256321335, 'auprc': 0.9944103697130467, 'loss_val': 0.08533983440510372, 'psi': 0.9869541016780197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=27 head_norm_before_train=1.500426 cos_to_last_merge=0.9642 (last merge round=17)
[S10] round=27 local utility u=0.008891 metrics={'f1_val': 0.9938290824763921, 'auprc': 0.99450028669012, 'loss_val': 0.0582131178968709, 'psi': 0.9940975641618833}-{'f1_val': 0.9942179850461464, 'auprc': 0.9918948904657812, 'loss_val': 0.07051293304330868, 'psi': 0.9932887472140003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=27 head_norm_before_train=1.956095 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9792089223559028, 'auprc': 0.9985847664746869, 'loss_val': 0.07425921350746356, 'psi': 0.9869592600034165}-{'f1_val': 0.996305167468861, 'auprc': 0.9987983765573785, 'loss_val': 0.03855330727091358, 'psi': 0.997302451104268}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.665656 (no previous merge yet)
[S13] round=27 local utility u=0.166246 metrics={'f1_val': 0.6269264350231027, 'auprc': 0.666571538974559, 'loss_val': 0.6654051378794201, 'psi': 0.6427844766036852}-{'f1_val': 0.5881854691268531, 'auprc': 0.6862847858783443, 'loss_val': 0.8245918640008897, 'psi': 0.6274251958274495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=27 head_norm_before_train=1.735366 cos_to_last_merge=0.9914 (last merge round=17)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9975352917491209, 'loss_val': 0.04355822610591815, 'psi': 0.9977058274799794}-{'f1_val': 0.9976538428159559, 'auprc': 0.9992315744251914, 'loss_val': 0.032778324269468744, 'psi': 0.9982849354596501}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.382261 cos_to_last_merge=0.9693 (last merge round=16)
[S15] round=27 local utility u=0.127583 metrics={'f1_val': 0.7010090344606388, 'auprc': 0.9874863830758648, 'loss_val': 0.33150076408116247, 'psi': 0.8155999739067292}-{'f1_val': 0.8305617866852121, 'auprc': 0.8413860564611615, 'loss_val': 0.9256818265325953, 'psi': 0.8348914945955919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=27 head_norm_before_train=1.505535 cos_to_last_merge=0.9655 (last merge round=16)
[S16] round=27 local utility u=0.204789 metrics={'f1_val': 0.8514806527061989, 'auprc': 0.9783024816188405, 'loss_val': 0.6473629541872686, 'psi': 0.9022093842712555}-{'f1_val': 0.8333680383482603, 'auprc': 0.9308416514822823, 'loss_val': 0.805882283049053, 'psi': 0.8723574836018692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=27 head_norm_before_train=1.262376 cos_to_last_merge=0.9384 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.938
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.3930376510019027, 'auprc': 0.8390565458199783, 'loss_val': 0.7280525054488001, 'psi': 0.571445208929133}-{'f1_val': 0.3937167209882674, 'auprc': 0.8473065298050406, 'loss_val': 0.6844120079407452, 'psi': 0.5751526445149767}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=28 head_norm_before_train=1.506822 cos_to_last_merge=0.7669 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.767
[S2] round=28 local utility u=0.217737 metrics={'f1_val': 0.7130826879912766, 'auprc': 0.7804427028304909, 'loss_val': 0.6912043015173023, 'psi': 0.7400266939269624}-{'f1_val': 0.6711193459194583, 'auprc': 0.6502840258683252, 'loss_val': 0.4844213352865628, 'psi': 0.662785217899005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=28 head_norm_before_train=1.611821 cos_to_last_merge=0.9785 (last merge round=17)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9354030452387625, 'auprc': 0.9984942760819637, 'loss_val': 0.14469638640802845, 'psi': 0.9606395375760429}-{'f1_val': 0.9977814963782642, 'auprc': 0.9984246442747271, 'loss_val': 0.09874695083603156, 'psi': 0.9980387555368494}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.388678 cos_to_last_merge=0.9140 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=28 local utility u=0.063045 metrics={'f1_val': 0.9390897662044689, 'auprc': 0.9621058205653128, 'loss_val': 0.3447677416742988, 'psi': 0.9482961879488065}-{'f1_val': 0.9237398992934696, 'auprc': 0.9635722897425906, 'loss_val': 0.38315729330253573, 'psi': 0.939672855473118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] sending update (kind=head size=1790 to 1 peers)
[S5] START round=28 head_norm_before_train=1.765182 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7020568647011682, 'auprc': 0.9982172041064301, 'loss_val': 0.18752150937516615, 'psi': 0.820521000463273}-{'f1_val': 0.917217508967907, 'auprc': 0.9950969095876673, 'loss_val': 0.24226822003008364, 'psi': 0.948369269215811}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.396360 cos_to_last_merge=0.9421 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.5949379379042951, 'auprc': 0.7604438154253352, 'loss_val': 0.7572972348450362, 'psi': 0.6611402889127111}-{'f1_val': 0.8223657619724346, 'auprc': 0.9480549555194182, 'loss_val': 0.3240977793878913, 'psi': 0.8726414393912281}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.278664 cos_to_last_merge=0.9225 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=28 local utility u=0.657773 metrics={'f1_val': 0.6812824037887382, 'auprc': 0.8540383627691203, 'loss_val': 0.45355382471000244, 'psi': 0.7503847873808911}-{'f1_val': 0.5485937181065218, 'auprc': 0.786074166359862, 'loss_val': 0.7690755295004523, 'psi': 0.6435858974078579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=28 head_norm_before_train=1.699920 cos_to_last_merge=0.9736 (last merge round=13)
[S8] round=28 local utility u=0.001516 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9991853009910048, 'loss_val': 0.05356546349616688, 'psi': 0.9954155739555876}-{'f1_val': 0.993632801855294, 'auprc': 0.9990994130068949, 'loss_val': 0.060722905129827996, 'psi': 0.9958194463159344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=28 head_norm_before_train=1.540737 cos_to_last_merge=0.9689 (last merge round=17)
[S9] round=28 local utility u=0.000357 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9982409439687656, 'loss_val': 0.0444553843944763, 'psi': 0.9956600051859145}-{'f1_val': 0.9962500947792776, 'auprc': 0.9924488608038529, 'loss_val': 0.04165694109277379, 'psi': 0.9947296011891077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=28 head_norm_before_train=1.534601 cos_to_last_merge=0.9601 (last merge round=17)
[S10] round=28 local utility u=0.005313 metrics={'f1_val': 0.994048225356002, 'auprc': 0.9955897082276264, 'loss_val': 0.052169812614992615, 'psi': 0.9946648185046518}-{'f1_val': 0.9938290824763921, 'auprc': 0.99450028669012, 'loss_val': 0.0582131178968709, 'psi': 0.9940975641618833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=28 head_norm_before_train=1.975407 (no previous merge yet)
[S11] round=28 local utility u=0.075506 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.998809597125359, 'loss_val': 0.029002997544310332, 'psi': 0.9975572905990528}-{'f1_val': 0.9792089223559028, 'auprc': 0.9985847664746869, 'loss_val': 0.07425921350746356, 'psi': 0.9869592600034165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=28 head_norm_before_train=1.673442 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6126723792385512, 'auprc': 0.6788456351455013, 'loss_val': 0.7244912358537544, 'psi': 0.6391416816013313}-{'f1_val': 0.6269264350231027, 'auprc': 0.666571538974559, 'loss_val': 0.6654051378794201, 'psi': 0.6427844766036852}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.747938 cos_to_last_merge=0.9906 (last merge round=17)
[S14] round=28 local utility u=0.006589 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9992304150345221, 'loss_val': 0.03301385797615338, 'psi': 0.9981387625745057}-{'f1_val': 0.9978195179672185, 'auprc': 0.9975352917491209, 'loss_val': 0.04355822610591815, 'psi': 0.9977058274799794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=28 head_norm_before_train=1.395248 cos_to_last_merge=0.9677 (last merge round=16)
[S15] round=28 local utility u=0.138584 metrics={'f1_val': 0.7360837509300593, 'auprc': 0.9894053317724475, 'loss_val': 0.2705382588650439, 'psi': 0.8374123832670146}-{'f1_val': 0.7010090344606388, 'auprc': 0.9874863830758648, 'loss_val': 0.33150076408116247, 'psi': 0.8155999739067292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=28 head_norm_before_train=1.530562 cos_to_last_merge=0.9628 (last merge round=16)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8532753545059943, 'auprc': 0.961311923017564, 'loss_val': 0.6590928898162278, 'psi': 0.8964899819106222}-{'f1_val': 0.8514806527061989, 'auprc': 0.9783024816188405, 'loss_val': 0.6473629541872686, 'psi': 0.9022093842712555}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.275282 cos_to_last_merge=0.9375 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.937
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.36885147340249935, 'auprc': 0.8066240241435525, 'loss_val': 1.0349625678774628, 'psi': 0.5439604936989206}-{'f1_val': 0.3930376510019027, 'auprc': 0.8390565458199783, 'loss_val': 0.7280525054488001, 'psi': 0.571445208929133}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.517415 cos_to_last_merge=0.7659 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.766
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6792121762507998, 'auprc': 0.7775550883365028, 'loss_val': 0.9479411725533087, 'psi': 0.718549341085081}-{'f1_val': 0.7130826879912766, 'auprc': 0.7804427028304909, 'loss_val': 0.6912043015173023, 'psi': 0.7400266939269624}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.643699 cos_to_last_merge=0.9751 (last merge round=17)
[S3] round=29 local utility u=0.112797 metrics={'f1_val': 0.9652597079035431, 'auprc': 0.9986495684475374, 'loss_val': 0.09870829734149396, 'psi': 0.9786156521211408}-{'f1_val': 0.9354030452387625, 'auprc': 0.9984942760819637, 'loss_val': 0.14469638640802845, 'psi': 0.9606395375760429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=29 head_norm_before_train=1.409542 cos_to_last_merge=0.9109 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9388976051983369, 'auprc': 0.9558812697222663, 'loss_val': 0.3541729756955227, 'psi': 0.9456910710079086}-{'f1_val': 0.9390897662044689, 'auprc': 0.9621058205653128, 'loss_val': 0.3447677416742988, 'psi': 0.9482961879488065}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.776263 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.6429156428299123, 'auprc': 0.7960252831313163, 'loss_val': 0.7263649334379341, 'psi': 0.7041594989504739}-{'f1_val': 0.7020568647011682, 'auprc': 0.9982172041064301, 'loss_val': 0.18752150937516615, 'psi': 0.820521000463273}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.410286 cos_to_last_merge=0.9387 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.8339135507480171, 'auprc': 0.9605140274117313, 'loss_val': 0.2659625744236613, 'psi': 0.8845537414135027}-{'f1_val': 0.5949379379042951, 'auprc': 0.7604438154253352, 'loss_val': 0.7572972348450362, 'psi': 0.6611402889127111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=29 head_norm_before_train=1.288583 cos_to_last_merge=0.9199 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.40350596178179987, 'auprc': 0.7765389348505782, 'loss_val': 1.0640325771145243, 'psi': 0.5527191510093112}-{'f1_val': 0.6812824037887382, 'auprc': 0.8540383627691203, 'loss_val': 0.45355382471000244, 'psi': 0.7503847873808911}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.716712 cos_to_last_merge=0.9723 (last merge round=13)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9918210737370572, 'auprc': 0.9993006087890702, 'loss_val': 0.05359134163279787, 'psi': 0.9948128877578624}-{'f1_val': 0.9929024225986427, 'auprc': 0.9991853009910048, 'loss_val': 0.05356546349616688, 'psi': 0.9954155739555876}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.556046 cos_to_last_merge=0.9677 (last merge round=17)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9966703012216334, 'loss_val': 0.05506165043037838, 'psi': 0.9909549231785304}-{'f1_val': 0.9939393793306803, 'auprc': 0.9982409439687656, 'loss_val': 0.0444553843944763, 'psi': 0.9956600051859145}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.564937 cos_to_last_merge=0.9566 (last merge round=17)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9938290824763921, 'auprc': 0.9933531153298458, 'loss_val': 0.049411173991209, 'psi': 0.9936386956177736}-{'f1_val': 0.994048225356002, 'auprc': 0.9955897082276264, 'loss_val': 0.052169812614992615, 'psi': 0.9946648185046518}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=1.993943 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9890774354157208, 'auprc': 0.9988534146404274, 'loss_val': 0.04710851525846312, 'psi': 0.9929878271056034}-{'f1_val': 0.9967224195815153, 'auprc': 0.998809597125359, 'loss_val': 0.029002997544310332, 'psi': 0.9975572905990528}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=1.676661 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6093145665836376, 'auprc': 0.678333526752629, 'loss_val': 0.7493076959573806, 'psi': 0.6369221506512341}-{'f1_val': 0.6126723792385512, 'auprc': 0.6788456351455013, 'loss_val': 0.7244912358537544, 'psi': 0.6391416816013313}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.759120 cos_to_last_merge=0.9899 (last merge round=17)
[S14] round=29 local utility u=0.002567 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9992318252985128, 'loss_val': 0.029341393908535796, 'psi': 0.9982850358089788}-{'f1_val': 0.9974109942678281, 'auprc': 0.9992304150345221, 'loss_val': 0.03301385797615338, 'psi': 0.9981387625745057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=29 head_norm_before_train=1.406234 cos_to_last_merge=0.9660 (last merge round=16)
[S15] round=29 local utility u=0.627266 metrics={'f1_val': 0.9218967558990186, 'auprc': 0.990948427087684, 'loss_val': 0.1355139256867478, 'psi': 0.9495174243744848}-{'f1_val': 0.7360837509300593, 'auprc': 0.9894053317724475, 'loss_val': 0.2705382588650439, 'psi': 0.8374123832670146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=29 head_norm_before_train=1.553165 cos_to_last_merge=0.9603 (last merge round=16)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8464205375327924, 'auprc': 0.9658119990030557, 'loss_val': 0.720326763692827, 'psi': 0.8941771221208978}-{'f1_val': 0.8532753545059943, 'auprc': 0.961311923017564, 'loss_val': 0.6590928898162278, 'psi': 0.8964899819106222}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.287587 cos_to_last_merge=0.9365 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.937
[S17] round=29 local utility u=0.083757 metrics={'f1_val': 0.4901306648307555, 'auprc': 0.5866768558141099, 'loss_val': 0.9352826234245561, 'psi': 0.5287491412240972}-{'f1_val': 0.36885147340249935, 'auprc': 0.8066240241435525, 'loss_val': 1.0349625678774628, 'psi': 0.5439604936989206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=30 head_norm_before_train=1.528937 cos_to_last_merge=0.7648 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.765
[S2] round=30 local utility u=0.261140 metrics={'f1_val': 0.710922719296222, 'auprc': 0.7828002536554485, 'loss_val': 0.6316595148191392, 'psi': 0.7396737330399126}-{'f1_val': 0.6792121762507998, 'auprc': 0.7775550883365028, 'loss_val': 0.9479411725533087, 'psi': 0.718549341085081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=30 head_norm_before_train=1.672711 cos_to_last_merge=0.9717 (last merge round=17)
[S3] round=30 local utility u=0.108828 metrics={'f1_val': 0.9965655661594752, 'auprc': 0.9983997507292186, 'loss_val': 0.06813809810843816, 'psi': 0.9972992399873726}-{'f1_val': 0.9652597079035431, 'auprc': 0.9986495684475374, 'loss_val': 0.09870829734149396, 'psi': 0.9786156521211408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=30 head_norm_before_train=1.429499 cos_to_last_merge=0.9079 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=30 local utility u=0.043095 metrics={'f1_val': 0.9419359448757729, 'auprc': 0.9570904030072985, 'loss_val': 0.289840381105143, 'psi': 0.9479977281283831}-{'f1_val': 0.9388976051983369, 'auprc': 0.9558812697222663, 'loss_val': 0.3541729756955227, 'psi': 0.9456910710079086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=30 head_norm_before_train=1.783742 (no previous merge yet)
[S5] round=30 local utility u=0.761442 metrics={'f1_val': 0.7020568647011682, 'auprc': 0.9981976244086216, 'loss_val': 0.1648449625588049, 'psi': 0.8205131685841496}-{'f1_val': 0.6429156428299123, 'auprc': 0.7960252831313163, 'loss_val': 0.7263649334379341, 'psi': 0.7041594989504739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=30 head_norm_before_train=1.420375 cos_to_last_merge=0.9364 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.8221166105661913, 'auprc': 0.9416876010425811, 'loss_val': 0.3802009966389356, 'psi': 0.8699450067567472}-{'f1_val': 0.8339135507480171, 'auprc': 0.9605140274117313, 'loss_val': 0.2659625744236613, 'psi': 0.8845537414135027}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.299864 cos_to_last_merge=0.9174 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.917
[S7] round=30 local utility u=1.000000 metrics={'f1_val': 0.69103314797874, 'auprc': 0.9093737263203131, 'loss_val': 0.37503016275944323, 'psi': 0.7783693793153693}-{'f1_val': 0.40350596178179987, 'auprc': 0.7765389348505782, 'loss_val': 1.0640325771145243, 'psi': 0.5527191510093112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=30 head_norm_before_train=1.734602 cos_to_last_merge=0.9707 (last merge round=13)
[S8] round=30 local utility u=0.002200 metrics={'f1_val': 0.9935219944084961, 'auprc': 0.9979501123245685, 'loss_val': 0.05534620939368896, 'psi': 0.9952932415749252}-{'f1_val': 0.9918210737370572, 'auprc': 0.9993006087890702, 'loss_val': 0.05359134163279787, 'psi': 0.9948128877578624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=30 head_norm_before_train=1.570904 cos_to_last_merge=0.9662 (last merge round=17)
[S9] round=30 local utility u=0.031910 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9934665410323453, 'loss_val': 0.0362635480818839, 'psi': 0.9951366732805047}-{'f1_val': 0.9871446711497952, 'auprc': 0.9966703012216334, 'loss_val': 0.05506165043037838, 'psi': 0.9909549231785304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=30 head_norm_before_train=1.593678 cos_to_last_merge=0.9533 (last merge round=17)
[S10] round=30 local utility u=0.008567 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9951016025484596, 'loss_val': 0.04410224219227132, 'psi': 0.9949959636635338}-{'f1_val': 0.9938290824763921, 'auprc': 0.9933531153298458, 'loss_val': 0.049411173991209, 'psi': 0.9936386956177736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=30 head_norm_before_train=2.010499 (no previous merge yet)
[S11] round=30 local utility u=0.034090 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987592055416896, 'loss_val': 0.024516402021492682, 'psi': 0.9975371339655851}-{'f1_val': 0.9890774354157208, 'auprc': 0.9988534146404274, 'loss_val': 0.04710851525846312, 'psi': 0.9929878271056034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=30 head_norm_before_train=1.681666 (no previous merge yet)
[S13] round=30 local utility u=0.148697 metrics={'f1_val': 0.6404116061576423, 'auprc': 0.6420664192937399, 'loss_val': 0.5296952813166159, 'psi': 0.6410735314120812}-{'f1_val': 0.6093145665836376, 'auprc': 0.678333526752629, 'loss_val': 0.7493076959573806, 'psi': 0.6369221506512341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=30 head_norm_before_train=1.773299 cos_to_last_merge=0.9892 (last merge round=17)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9992315744251914, 'loss_val': 0.028840934132864846, 'psi': 0.9981375914711119}-{'f1_val': 0.9976538428159559, 'auprc': 0.9992318252985128, 'loss_val': 0.029341393908535796, 'psi': 0.9982850358089788}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.420328 cos_to_last_merge=0.9638 (last merge round=16)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.9855914164867794, 'loss_val': 0.38492879615652387, 'psi': 0.8146974441753877}-{'f1_val': 0.9218967558990186, 'auprc': 0.990948427087684, 'loss_val': 0.1355139256867478, 'psi': 0.9495174243744848}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.572897 cos_to_last_merge=0.9580 (last merge round=16)
[S16] round=30 local utility u=0.251067 metrics={'f1_val': 0.8802184434014215, 'auprc': 0.9883225020015604, 'loss_val': 0.48851246850911345, 'psi': 0.9234600668414771}-{'f1_val': 0.8464205375327924, 'auprc': 0.9658119990030557, 'loss_val': 0.720326763692827, 'psi': 0.8941771221208978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=30 head_norm_before_train=1.301852 cos_to_last_merge=0.9354 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.3688227670975341, 'auprc': 0.7780020205382043, 'loss_val': 1.1139335456031045, 'psi': 0.5324944684738022}-{'f1_val': 0.4901306648307555, 'auprc': 0.5866768558141099, 'loss_val': 0.9352826234245561, 'psi': 0.5287491412240972}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.540511 cos_to_last_merge=0.7634 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.763
[S2] round=31 local utility u=0.030114 metrics={'f1_val': 0.700494852258952, 'auprc': 0.7388712864853515, 'loss_val': 0.3770774186257451, 'psi': 0.7158454259495118}-{'f1_val': 0.710922719296222, 'auprc': 0.7828002536554485, 'loss_val': 0.6316595148191392, 'psi': 0.7396737330399126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=31 head_norm_before_train=1.698311 cos_to_last_merge=0.9687 (last merge round=17)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9354030452387625, 'auprc': 0.9984162599904159, 'loss_val': 0.14137022500923396, 'psi': 0.9606083311394238}-{'f1_val': 0.9965655661594752, 'auprc': 0.9983997507292186, 'loss_val': 0.06813809810843816, 'psi': 0.9972992399873726}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.450250 cos_to_last_merge=0.9050 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=31 local utility u=0.003164 metrics={'f1_val': 0.9424855043434989, 'auprc': 0.9569871873789042, 'loss_val': 0.2865002506398053, 'psi': 0.948286177557661}-{'f1_val': 0.9419359448757729, 'auprc': 0.9570904030072985, 'loss_val': 0.289840381105143, 'psi': 0.9479977281283831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=31 head_norm_before_train=1.789147 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7129089666832122, 'auprc': 0.8934650926233572, 'loss_val': 0.38424694572675083, 'psi': 0.7851314170592703}-{'f1_val': 0.7020568647011682, 'auprc': 0.9981976244086216, 'loss_val': 0.1648449625588049, 'psi': 0.8205131685841496}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.434683 cos_to_last_merge=0.9341 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=31 local utility u=0.172846 metrics={'f1_val': 0.847158682490315, 'auprc': 0.973824458709136, 'loss_val': 0.281172864123528, 'psi': 0.8978249929778434}-{'f1_val': 0.8221166105661913, 'auprc': 0.9416876010425811, 'loss_val': 0.3802009966389356, 'psi': 0.8699450067567472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=31 head_norm_before_train=1.308820 cos_to_last_merge=0.9157 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5728165891294352, 'auprc': 0.790941643317238, 'loss_val': 0.6975642852360353, 'psi': 0.6600666108045563}-{'f1_val': 0.69103314797874, 'auprc': 0.9093737263203131, 'loss_val': 0.37503016275944323, 'psi': 0.7783693793153693}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.748085 cos_to_last_merge=0.9696 (last merge round=13)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9875097078386601, 'auprc': 0.9990316204100134, 'loss_val': 0.06291656091153193, 'psi': 0.9921184728672015}-{'f1_val': 0.9935219944084961, 'auprc': 0.9979501123245685, 'loss_val': 0.05534620939368896, 'psi': 0.9952932415749252}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.584497 cos_to_last_merge=0.9644 (last merge round=17)
[S9] round=31 local utility u=0.011801 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9991885495689203, 'loss_val': 0.03228918971712213, 'psi': 0.997671726915903}-{'f1_val': 0.9962500947792776, 'auprc': 0.9934665410323453, 'loss_val': 0.0362635480818839, 'psi': 0.9951366732805047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=31 head_norm_before_train=1.620276 cos_to_last_merge=0.9504 (last merge round=17)
[S10] round=31 local utility u=0.000144 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9948529284781731, 'loss_val': 0.04175197099121202, 'psi': 0.9947648301605713}-{'f1_val': 0.9949255377402499, 'auprc': 0.9951016025484596, 'loss_val': 0.04410224219227132, 'psi': 0.9949959636635338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=31 head_norm_before_train=2.023841 (no previous merge yet)
[S11] round=31 local utility u=0.001638 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988373574948584, 'loss_val': 0.022925299829284068, 'psi': 0.9977134969736896}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987592055416896, 'loss_val': 0.024516402021492682, 'psi': 0.9975371339655851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=31 head_norm_before_train=1.685866 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5805231305506855, 'auprc': 0.6887098367488859, 'loss_val': 0.8454089481324484, 'psi': 0.6237978130299656}-{'f1_val': 0.6404116061576423, 'auprc': 0.6420664192937399, 'loss_val': 0.5296952813166159, 'psi': 0.6410735314120812}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.786890 cos_to_last_merge=0.9885 (last merge round=17)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9975343573088462, 'loss_val': 0.034571984396368605, 'psi': 0.9975596678014893}-{'f1_val': 0.9974082695017256, 'auprc': 0.9992315744251914, 'loss_val': 0.028840934132864846, 'psi': 0.9981375914711119}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=1.437084 cos_to_last_merge=0.9616 (last merge round=16)
[S15] round=31 local utility u=0.873946 metrics={'f1_val': 0.9470045049508995, 'auprc': 0.9913493972461979, 'loss_val': 0.13172931955991843, 'psi': 0.9647424618690188}-{'f1_val': 0.7007681293011265, 'auprc': 0.9855914164867794, 'loss_val': 0.38492879615652387, 'psi': 0.8146974441753877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=31 head_norm_before_train=1.589006 cos_to_last_merge=0.9561 (last merge round=16)
[S16] round=31 local utility u=0.385758 metrics={'f1_val': 0.9515841950607252, 'auprc': 0.9883571714308377, 'loss_val': 0.1452950699232756, 'psi': 0.9662933856087701}-{'f1_val': 0.8802184434014215, 'auprc': 0.9883225020015604, 'loss_val': 0.48851246850911345, 'psi': 0.9234600668414771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=31 head_norm_before_train=1.311546 cos_to_last_merge=0.9342 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.934
[S17] round=31 local utility u=0.487639 metrics={'f1_val': 0.4309256801264995, 'auprc': 0.8387715621474834, 'loss_val': 0.6935817975193859, 'psi': 0.5940640329348931}-{'f1_val': 0.3688227670975341, 'auprc': 0.7780020205382043, 'loss_val': 1.1139335456031045, 'psi': 0.5324944684738022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=32 head_norm_before_train=1.552495 cos_to_last_merge=0.7620 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.6178224046321474, 'auprc': 0.781453971504226, 'loss_val': 0.6366648164033459, 'psi': 0.6832750313809789}-{'f1_val': 0.700494852258952, 'auprc': 0.7388712864853515, 'loss_val': 0.3770774186257451, 'psi': 0.7158454259495118}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.722531 cos_to_last_merge=0.9659 (last merge round=17)
[S3] round=32 local utility u=0.214908 metrics={'f1_val': 0.997203248821197, 'auprc': 0.9986270182576288, 'loss_val': 0.08298718278161028, 'psi': 0.9977727565957697}-{'f1_val': 0.9354030452387625, 'auprc': 0.9984162599904159, 'loss_val': 0.14137022500923396, 'psi': 0.9606083311394238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=32 head_norm_before_train=1.467679 cos_to_last_merge=0.9025 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=32 local utility u=0.048912 metrics={'f1_val': 0.9532425227899373, 'auprc': 0.9640280100414224, 'loss_val': 0.27434048929849564, 'psi': 0.9575567176905313}-{'f1_val': 0.9424855043434989, 'auprc': 0.9569871873789042, 'loss_val': 0.2865002506398053, 'psi': 0.948286177557661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=32 head_norm_before_train=1.795738 (no previous merge yet)
[S5] round=32 local utility u=0.232199 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.995554702512492, 'loss_val': 0.15380096293970455, 'psi': 0.8187356745409234}-{'f1_val': 0.7129089666832122, 'auprc': 0.8934650926233572, 'loss_val': 0.38424694572675083, 'psi': 0.7851314170592703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=32 head_norm_before_train=1.447634 cos_to_last_merge=0.9314 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8220887294256581, 'auprc': 0.9514656503247114, 'loss_val': 0.3189338361529637, 'psi': 0.8738394977852795}-{'f1_val': 0.847158682490315, 'auprc': 0.973824458709136, 'loss_val': 0.281172864123528, 'psi': 0.8978249929778434}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.316826 cos_to_last_merge=0.9139 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=32 local utility u=0.673341 metrics={'f1_val': 0.6912073040701402, 'auprc': 0.8955173939302165, 'loss_val': 0.37495481742662756, 'psi': 0.7729313400141706}-{'f1_val': 0.5728165891294352, 'auprc': 0.790941643317238, 'loss_val': 0.6975642852360353, 'psi': 0.6600666108045563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=32 head_norm_before_train=1.757828 cos_to_last_merge=0.9694 (last merge round=13)
[S8] round=32 local utility u=0.028606 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9992891107730894, 'loss_val': 0.043171745959040775, 'psi': 0.9958908465779337}-{'f1_val': 0.9875097078386601, 'auprc': 0.9990316204100134, 'loss_val': 0.06291656091153193, 'psi': 0.9921184728672015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=32 head_norm_before_train=1.600238 cos_to_last_merge=0.9626 (last merge round=17)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9982324448748533, 'loss_val': 0.03779152348782867, 'psi': 0.9950358479883448}-{'f1_val': 0.9966605118138915, 'auprc': 0.9991885495689203, 'loss_val': 0.03228918971712213, 'psi': 0.997671726915903}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.641131 cos_to_last_merge=0.9481 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=32 local utility u=0.003340 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9960297515690149, 'loss_val': 0.03860229562570676, 'psi': 0.995235559396908}-{'f1_val': 0.9947060979488367, 'auprc': 0.9948529284781731, 'loss_val': 0.04175197099121202, 'psi': 0.9947648301605713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=32 head_norm_before_train=2.036515 (no previous merge yet)
[S11] round=32 local utility u=0.000618 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988660251115046, 'loss_val': 0.021775637881080334, 'psi': 0.997724964020348}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988373574948584, 'loss_val': 0.022925299829284068, 'psi': 0.9977134969736896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=32 head_norm_before_train=1.690348 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5775133030103351, 'auprc': 0.6894269496364869, 'loss_val': 0.8838169015457844, 'psi': 0.6222787616607959}-{'f1_val': 0.5805231305506855, 'auprc': 0.6887098367488859, 'loss_val': 0.8454089481324484, 'psi': 0.6237978130299656}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.799076 cos_to_last_merge=0.9878 (last merge round=17)
[S14] round=32 local utility u=0.001970 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9975349179453072, 'loss_val': 0.03209088580774595, 'psi': 0.9977056779584539}-{'f1_val': 0.9975765414632514, 'auprc': 0.9975343573088462, 'loss_val': 0.034571984396368605, 'psi': 0.9975596678014893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=32 head_norm_before_train=1.455488 cos_to_last_merge=0.9592 (last merge round=16)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7019897455306504, 'auprc': 0.9867670213047691, 'loss_val': 0.3389234269270269, 'psi': 0.8159006558402979}-{'f1_val': 0.9470045049508995, 'auprc': 0.9913493972461979, 'loss_val': 0.13172931955991843, 'psi': 0.9647424618690188}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.603437 cos_to_last_merge=0.9545 (last merge round=16)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.83598431080222, 'auprc': 0.957308239803139, 'loss_val': 0.8748248134237537, 'psi': 0.8845138824025877}-{'f1_val': 0.9515841950607252, 'auprc': 0.9883571714308377, 'loss_val': 0.1452950699232756, 'psi': 0.9662933856087701}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.323702 cos_to_last_merge=0.9331 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.3993314569762779, 'auprc': 0.8464260799069848, 'loss_val': 0.7813420632537185, 'psi': 0.5781693061485607}-{'f1_val': 0.4309256801264995, 'auprc': 0.8387715621474834, 'loss_val': 0.6935817975193859, 'psi': 0.5940640329348931}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.562362 cos_to_last_merge=0.7610 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.761
[S2] round=33 local utility u=0.518880 metrics={'f1_val': 0.7015728539790018, 'auprc': 0.8836529131757425, 'loss_val': 0.4080038093787557, 'psi': 0.7744048776576982}-{'f1_val': 0.6178224046321474, 'auprc': 0.781453971504226, 'loss_val': 0.6366648164033459, 'psi': 0.6832750313809789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=33 head_norm_before_train=1.742089 cos_to_last_merge=0.9635 (last merge round=17)
[S3] round=33 local utility u=0.015766 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9983898899658115, 'loss_val': 0.05208636235327564, 'psi': 0.9978122335582591}-{'f1_val': 0.997203248821197, 'auprc': 0.9986270182576288, 'loss_val': 0.08298718278161028, 'psi': 0.9977727565957697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=33 head_norm_before_train=1.480104 cos_to_last_merge=0.9007 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9501313037398345, 'auprc': 0.9561758283175549, 'loss_val': 0.2807676132487215, 'psi': 0.9525491135709225}-{'f1_val': 0.9532425227899373, 'auprc': 0.9640280100414224, 'loss_val': 0.27434048929849564, 'psi': 0.9575567176905313}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.804496 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9916408159866372, 'loss_val': 0.19583633582460327, 'psi': 0.8170213619922595}-{'f1_val': 0.7008563225598777, 'auprc': 0.995554702512492, 'loss_val': 0.15380096293970455, 'psi': 0.8187356745409234}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.460472 cos_to_last_merge=0.9290 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7912217695484172, 'auprc': 0.938343261548116, 'loss_val': 0.40636746702437326, 'psi': 0.8500703663482967}-{'f1_val': 0.8220887294256581, 'auprc': 0.9514656503247114, 'loss_val': 0.3189338361529637, 'psi': 0.8738394977852795}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.327910 cos_to_last_merge=0.9116 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5208882878605043, 'auprc': 0.7813844288665432, 'loss_val': 0.8716385714667786, 'psi': 0.62508674426292}-{'f1_val': 0.6912073040701402, 'auprc': 0.8955173939302165, 'loss_val': 0.37495481742662756, 'psi': 0.7729313400141706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.764195 cos_to_last_merge=0.9694 (last merge round=13)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9730527238546915, 'auprc': 0.998994424158713, 'loss_val': 0.10014842677257194, 'psi': 0.9834294039763001}-{'f1_val': 0.9936253371144965, 'auprc': 0.9992891107730894, 'loss_val': 0.043171745959040775, 'psi': 0.9958908465779337}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.614955 cos_to_last_merge=0.9609 (last merge round=17)
[S9] round=33 local utility u=0.014373 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9984623625580046, 'loss_val': 0.02978405808869715, 'psi': 0.9971326140027333}-{'f1_val': 0.992904783397339, 'auprc': 0.9982324448748533, 'loss_val': 0.03779152348782867, 'psi': 0.9950358479883448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=33 head_norm_before_train=1.661858 cos_to_last_merge=0.9459 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=33 local utility u=0.001569 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955490483748706, 'loss_val': 0.03691243617127984, 'psi': 0.9953323227615731}-{'f1_val': 0.9947060979488367, 'auprc': 0.9960297515690149, 'loss_val': 0.03860229562570676, 'psi': 0.995235559396908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=33 head_norm_before_train=2.049519 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.995107348883878, 'auprc': 0.9992580364021714, 'loss_val': 0.02734039416251953, 'psi': 0.9967676238911953}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988660251115046, 'loss_val': 0.021775637881080334, 'psi': 0.997724964020348}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.697076 (no previous merge yet)
[S13] round=33 local utility u=0.141851 metrics={'f1_val': 0.6095070083007328, 'auprc': 0.648611338267202, 'loss_val': 0.6696300763943333, 'psi': 0.6251487402873204}-{'f1_val': 0.5775133030103351, 'auprc': 0.6894269496364869, 'loss_val': 0.8838169015457844, 'psi': 0.6222787616607959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=33 head_norm_before_train=1.810788 cos_to_last_merge=0.9871 (last merge round=17)
[S14] round=33 local utility u=0.002613 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.999236811858264, 'loss_val': 0.030943638582834377, 'psi': 0.9982837517037728}-{'f1_val': 0.9978195179672185, 'auprc': 0.9975349179453072, 'loss_val': 0.03209088580774595, 'psi': 0.9977056779584539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=33 head_norm_before_train=1.476068 cos_to_last_merge=0.9565 (last merge round=16)
[S15] round=33 local utility u=0.865949 metrics={'f1_val': 0.9510643629699257, 'auprc': 0.990349666374897, 'loss_val': 0.11222147383899818, 'psi': 0.9667784843319142}-{'f1_val': 0.7019897455306504, 'auprc': 0.9867670213047691, 'loss_val': 0.3389234269270269, 'psi': 0.8159006558402979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=33 head_norm_before_train=1.618624 cos_to_last_merge=0.9529 (last merge round=16)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.83322527350587, 'auprc': 0.9284146816250967, 'loss_val': 0.9295433177753932, 'psi': 0.8713010367535606}-{'f1_val': 0.83598431080222, 'auprc': 0.957308239803139, 'loss_val': 0.8748248134237537, 'psi': 0.8845138824025877}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.336147 cos_to_last_merge=0.9313 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.931
[S17] round=33 local utility u=0.076732 metrics={'f1_val': 0.41820724590494485, 'auprc': 0.8512286491334489, 'loss_val': 0.7555404404294432, 'psi': 0.5914158071963465}-{'f1_val': 0.3993314569762779, 'auprc': 0.8464260799069848, 'loss_val': 0.7813420632537185, 'psi': 0.5781693061485607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=34 head_norm_before_train=1.573772 cos_to_last_merge=0.7600 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.708896876115061, 'auprc': 0.8361303269198203, 'loss_val': 0.47397834731178323, 'psi': 0.7597902564369647}-{'f1_val': 0.7015728539790018, 'auprc': 0.8836529131757425, 'loss_val': 0.4080038093787557, 'psi': 0.7744048776576982}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.762432 cos_to_last_merge=0.9610 (last merge round=17)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9983157183914071, 'loss_val': 0.12210880394180304, 'psi': 0.975947438019829}-{'f1_val': 0.9974271292865575, 'auprc': 0.9983898899658115, 'loss_val': 0.05208636235327564, 'psi': 0.9978122335582591}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.489053 cos_to_last_merge=0.8994 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.899
[S4] round=34 local utility u=0.023355 metrics={'f1_val': 0.9542385869188773, 'auprc': 0.9617918704678499, 'loss_val': 0.2755501275890176, 'psi': 0.9572599003384663}-{'f1_val': 0.9501313037398345, 'auprc': 0.9561758283175549, 'loss_val': 0.2807676132487215, 'psi': 0.9525491135709225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=34 head_norm_before_train=1.812422 (no previous merge yet)
[S5] round=34 local utility u=0.881712 metrics={'f1_val': 0.9839019043386925, 'auprc': 0.9953352147971839, 'loss_val': 0.14325643105495742, 'psi': 0.988475228522089}-{'f1_val': 0.7006083926626743, 'auprc': 0.9916408159866372, 'loss_val': 0.19583633582460327, 'psi': 0.8170213619922595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=34 head_norm_before_train=1.474999 cos_to_last_merge=0.9268 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6927325618146062, 'auprc': 0.7852449273502506, 'loss_val': 0.6148300891416086, 'psi': 0.729737508028864}-{'f1_val': 0.7912217695484172, 'auprc': 0.938343261548116, 'loss_val': 0.40636746702437326, 'psi': 0.8500703663482967}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.340545 cos_to_last_merge=0.9086 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=34 local utility u=0.513576 metrics={'f1_val': 0.6310792194937519, 'auprc': 0.8020856064707059, 'loss_val': 0.5677354746076637, 'psi': 0.6994817742845336}-{'f1_val': 0.5208882878605043, 'auprc': 0.7813844288665432, 'loss_val': 0.8716385714667786, 'psi': 0.62508674426292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=34 head_norm_before_train=1.771723 cos_to_last_merge=0.9691 (last merge round=13)
[S8] round=34 local utility u=0.092229 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9992412249269857, 'loss_val': 0.04210645281783218, 'psi': 0.9960957823908859}-{'f1_val': 0.9730527238546915, 'auprc': 0.998994424158713, 'loss_val': 0.10014842677257194, 'psi': 0.9834294039763001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=34 head_norm_before_train=1.626502 cos_to_last_merge=0.9591 (last merge round=17)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9982174805265014, 'loss_val': 0.044584893637813525, 'psi': 0.9930000592814267}-{'f1_val': 0.9962461149658858, 'auprc': 0.9984623625580046, 'loss_val': 0.02978405808869715, 'psi': 0.9971326140027333}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.682365 cos_to_last_merge=0.9438 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9949011505906475, 'auprc': 0.9945394380217625, 'loss_val': 0.03650774951772436, 'psi': 0.9947564655630935}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955490483748706, 'loss_val': 0.03691243617127984, 'psi': 0.9953323227615731}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=2.061223 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9670431364768596, 'auprc': 0.999330156604764, 'loss_val': 0.08462555758578423, 'psi': 0.9799579445280213}-{'f1_val': 0.995107348883878, 'auprc': 0.9992580364021714, 'loss_val': 0.02734039416251953, 'psi': 0.9967676238911953}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.703102 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5971554460131981, 'auprc': 0.6842652888539522, 'loss_val': 0.8217927171688343, 'psi': 0.6319993831494998}-{'f1_val': 0.6095070083007328, 'auprc': 0.648611338267202, 'loss_val': 0.6696300763943333, 'psi': 0.6251487402873204}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.823107 cos_to_last_merge=0.9864 (last merge round=17)
[S14] round=34 local utility u=0.004797 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9992329415142527, 'loss_val': 0.02383589694202422, 'psi': 0.9985319413472333}-{'f1_val': 0.9976483782674455, 'auprc': 0.999236811858264, 'loss_val': 0.030943638582834377, 'psi': 0.9982837517037728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=34 head_norm_before_train=1.495354 cos_to_last_merge=0.9540 (last merge round=16)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8603946448204276, 'auprc': 0.9913618685057801, 'loss_val': 0.14978595132061726, 'psi': 0.9127815342945685}-{'f1_val': 0.9510643629699257, 'auprc': 0.990349666374897, 'loss_val': 0.11222147383899818, 'psi': 0.9667784843319142}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.633629 cos_to_last_merge=0.9513 (last merge round=16)
[S16] round=34 local utility u=0.342074 metrics={'f1_val': 0.8676960389434261, 'auprc': 0.9889873057896228, 'loss_val': 0.6339369388993759, 'psi': 0.9162125456819048}-{'f1_val': 0.83322527350587, 'auprc': 0.9284146816250967, 'loss_val': 0.9295433177753932, 'psi': 0.8713010367535606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=34 head_norm_before_train=1.348905 cos_to_last_merge=0.9297 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.930
[S17] round=34 local utility u=0.225514 metrics={'f1_val': 0.501058171145109, 'auprc': 0.8467205139697205, 'loss_val': 0.7880929861484077, 'psi': 0.6393231082749535}-{'f1_val': 0.41820724590494485, 'auprc': 0.8512286491334489, 'loss_val': 0.7555404404294432, 'psi': 0.5914158071963465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=35 head_norm_before_train=1.583872 cos_to_last_merge=0.7588 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7050220188548187, 'auprc': 0.841017365505081, 'loss_val': 0.5109269942035126, 'psi': 0.7594201575149236}-{'f1_val': 0.708896876115061, 'auprc': 0.8361303269198203, 'loss_val': 0.47397834731178323, 'psi': 0.7597902564369647}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.784220 cos_to_last_merge=0.9584 (last merge round=17)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9984285379320628, 'loss_val': 0.12412258750957876, 'psi': 0.9760164664124974}-{'f1_val': 0.9610352511054436, 'auprc': 0.9983157183914071, 'loss_val': 0.12210880394180304, 'psi': 0.975947438019829}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.496737 cos_to_last_merge=0.8982 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9418461825818879, 'auprc': 0.9502342679867323, 'loss_val': 0.29525551932839866, 'psi': 0.9452014167438256}-{'f1_val': 0.9542385869188773, 'auprc': 0.9617918704678499, 'loss_val': 0.2755501275890176, 'psi': 0.9572599003384663}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.821630 (no previous merge yet)
[S5] round=35 local utility u=0.059236 metrics={'f1_val': 0.9972873218889189, 'auprc': 0.9981569325300972, 'loss_val': 0.11356157272255064, 'psi': 0.9976351661453902}-{'f1_val': 0.9839019043386925, 'auprc': 0.9953352147971839, 'loss_val': 0.14325643105495742, 'psi': 0.988475228522089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] START round=35 head_norm_before_train=1.489795 cos_to_last_merge=0.9245 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=35 local utility u=0.757104 metrics={'f1_val': 0.8220887294256581, 'auprc': 0.938614796760905, 'loss_val': 0.33686926928698135, 'psi': 0.8686991563597568}-{'f1_val': 0.6927325618146062, 'auprc': 0.7852449273502506, 'loss_val': 0.6148300891416086, 'psi': 0.729737508028864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=35 head_norm_before_train=1.355374 cos_to_last_merge=0.9053 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5245598371237228, 'auprc': 0.7834392245195323, 'loss_val': 0.8653224202973521, 'psi': 0.6281115920820466}-{'f1_val': 0.6310792194937519, 'auprc': 0.8020856064707059, 'loss_val': 0.5677354746076637, 'psi': 0.6994817742845336}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.781052 cos_to_last_merge=0.9685 (last merge round=13)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9882230176651405, 'auprc': 0.9992579516161048, 'loss_val': 0.055374455843004884, 'psi': 0.9926369912455263}-{'f1_val': 0.9939988207001527, 'auprc': 0.9992412249269857, 'loss_val': 0.04210645281783218, 'psi': 0.9960957823908859}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.637189 cos_to_last_merge=0.9576 (last merge round=17)
[S9] round=35 local utility u=0.024681 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950302463510103, 'loss_val': 0.028492861970152637, 'psi': 0.996008405628739}-{'f1_val': 0.9895217784513768, 'auprc': 0.9982174805265014, 'loss_val': 0.044584893637813525, 'psi': 0.9930000592814267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=35 head_norm_before_train=1.702093 cos_to_last_merge=0.9417 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=35 local utility u=0.003102 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954967359883118, 'loss_val': 0.03489672745984411, 'psi': 0.9953113978069495}-{'f1_val': 0.9949011505906475, 'auprc': 0.9945394380217625, 'loss_val': 0.03650774951772436, 'psi': 0.9947564655630935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=35 head_norm_before_train=2.072864 (no previous merge yet)
[S11] round=35 local utility u=0.119674 metrics={'f1_val': 0.9962419185632914, 'auprc': 0.9993505199370256, 'loss_val': 0.020532231777190643, 'psi': 0.997485359112785}-{'f1_val': 0.9670431364768596, 'auprc': 0.999330156604764, 'loss_val': 0.08462555758578423, 'psi': 0.9799579445280213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=35 head_norm_before_train=1.708160 (no previous merge yet)
[S13] round=35 local utility u=0.054382 metrics={'f1_val': 0.6043348497296757, 'auprc': 0.6822499767326761, 'loss_val': 0.7500584108710141, 'psi': 0.6355009005308758}-{'f1_val': 0.5971554460131981, 'auprc': 0.6842652888539522, 'loss_val': 0.8217927171688343, 'psi': 0.6319993831494998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=35 head_norm_before_train=1.833415 cos_to_last_merge=0.9858 (last merge round=17)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9975345686470143, 'loss_val': 0.03024319220303762, 'psi': 0.9977055382391368}-{'f1_val': 0.9980646079025537, 'auprc': 0.9992329415142527, 'loss_val': 0.02383589694202422, 'psi': 0.9985319413472333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.511702 cos_to_last_merge=0.9520 (last merge round=16)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7775800791744805, 'auprc': 0.9930085182297564, 'loss_val': 0.30030334845551543, 'psi': 0.8637514547965909}-{'f1_val': 0.8603946448204276, 'auprc': 0.9913618685057801, 'loss_val': 0.14978595132061726, 'psi': 0.9127815342945685}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.648142 cos_to_last_merge=0.9497 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=35 local utility u=0.228462 metrics={'f1_val': 0.9094014978714772, 'auprc': 0.9890149879092259, 'loss_val': 0.4273285157084711, 'psi': 0.9412468938865766}-{'f1_val': 0.8676960389434261, 'auprc': 0.9889873057896228, 'loss_val': 0.6339369388993759, 'psi': 0.9162125456819048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=35 head_norm_before_train=1.361066 cos_to_last_merge=0.9283 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.928
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.43166921142487696, 'auprc': 0.82835218599336, 'loss_val': 1.019597225759994, 'psi': 0.5903424012522702}-{'f1_val': 0.501058171145109, 'auprc': 0.8467205139697205, 'loss_val': 0.7880929861484077, 'psi': 0.6393231082749535}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.594867 cos_to_last_merge=0.7576 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.657911282324529, 'auprc': 0.801555138157015, 'loss_val': 0.5701832935263356, 'psi': 0.7153688246575234}-{'f1_val': 0.7050220188548187, 'auprc': 0.841017365505081, 'loss_val': 0.5109269942035126, 'psi': 0.7594201575149236}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.806005 cos_to_last_merge=0.9560 (last merge round=17)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.8943970497161853, 'auprc': 0.9982945342962184, 'loss_val': 0.1739769160159235, 'psi': 0.9359560435481985}-{'f1_val': 0.9610750853994537, 'auprc': 0.9984285379320628, 'loss_val': 0.12412258750957876, 'psi': 0.9760164664124974}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.500086 cos_to_last_merge=0.8973 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.897
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9370070554858588, 'auprc': 0.9499035905847685, 'loss_val': 0.36641643128143214, 'psi': 0.9421656695254227}-{'f1_val': 0.9418461825818879, 'auprc': 0.9502342679867323, 'loss_val': 0.29525551932839866, 'psi': 0.9452014167438256}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.827742 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.8608812148702483, 'loss_val': 0.452417539849903, 'psi': 0.7730325255207044}-{'f1_val': 0.9972873218889189, 'auprc': 0.9981569325300972, 'loss_val': 0.11356157272255064, 'psi': 0.9976351661453902}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.504048 cos_to_last_merge=0.9217 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.922
[S6] round=36 local utility u=0.055523 metrics={'f1_val': 0.8361147945357466, 'auprc': 0.9446210896975638, 'loss_val': 0.3279977669505544, 'psi': 0.8795173126004734}-{'f1_val': 0.8220887294256581, 'auprc': 0.938614796760905, 'loss_val': 0.33686926928698135, 'psi': 0.8686991563597568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=36 head_norm_before_train=1.369453 cos_to_last_merge=0.9021 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.902
[S7] round=36 local utility u=0.702310 metrics={'f1_val': 0.6637689935228102, 'auprc': 0.8293461067141417, 'loss_val': 0.4336774868305982, 'psi': 0.7299998387993427}-{'f1_val': 0.5245598371237228, 'auprc': 0.7834392245195323, 'loss_val': 0.8653224202973521, 'psi': 0.6281115920820466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=36 head_norm_before_train=1.792425 cos_to_last_merge=0.9676 (last merge round=13)
[S8] round=36 local utility u=0.022851 metrics={'f1_val': 0.9931893602624928, 'auprc': 0.9993370581579621, 'loss_val': 0.03970737287861117, 'psi': 0.9956484394206806}-{'f1_val': 0.9882230176651405, 'auprc': 0.9992579516161048, 'loss_val': 0.055374455843004884, 'psi': 0.9926369912455263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=36 head_norm_before_train=1.649376 cos_to_last_merge=0.9562 (last merge round=17)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9926056369247587, 'loss_val': 0.027992631749009848, 'psi': 0.9950385618582384}-{'f1_val': 0.9966605118138915, 'auprc': 0.9950302463510103, 'loss_val': 0.028492861970152637, 'psi': 0.996008405628739}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.718070 cos_to_last_merge=0.9400 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.9946680899609439, 'loss_val': 0.03343231138833124, 'psi': 0.9946908947536796}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954967359883118, 'loss_val': 0.03489672745984411, 'psi': 0.9953113978069495}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=2.083025 (no previous merge yet)
[S11] round=36 local utility u=0.002446 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9992818069125735, 'loss_val': 0.018317775147529716, 'psi': 0.9977461745139387}-{'f1_val': 0.9962419185632914, 'auprc': 0.9993505199370256, 'loss_val': 0.020532231777190643, 'psi': 0.997485359112785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=36 head_norm_before_train=1.712063 (no previous merge yet)
[S13] round=36 local utility u=0.051719 metrics={'f1_val': 0.6137368458632178, 'auprc': 0.6733100004159469, 'loss_val': 0.6762125002959978, 'psi': 0.6375661076843093}-{'f1_val': 0.6043348497296757, 'auprc': 0.6822499767326761, 'loss_val': 0.7500584108710141, 'psi': 0.6355009005308758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=36 head_norm_before_train=1.844243 cos_to_last_merge=0.9853 (last merge round=17)
[S14] round=36 local utility u=0.001358 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9975360018259571, 'loss_val': 0.02508037574645675, 'psi': 0.9974609972910797}-{'f1_val': 0.9978195179672185, 'auprc': 0.9975345686470143, 'loss_val': 0.03024319220303762, 'psi': 0.9977055382391368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=36 head_norm_before_train=1.528333 cos_to_last_merge=0.9498 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.9843327023641998, 'loss_val': 0.4585379820947365, 'psi': 0.8141939585263558}-{'f1_val': 0.7775800791744805, 'auprc': 0.9930085182297564, 'loss_val': 0.30030334845551543, 'psi': 0.8637514547965909}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.660019 cos_to_last_merge=0.9484 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8725703991052335, 'auprc': 0.9409637288487471, 'loss_val': 0.6082041963499142, 'psi': 0.8999277310026389}-{'f1_val': 0.9094014978714772, 'auprc': 0.9890149879092259, 'loss_val': 0.4273285157084711, 'psi': 0.9412468938865766}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.374620 cos_to_last_merge=0.9269 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.927
[S17] round=36 local utility u=0.728570 metrics={'f1_val': 0.6665905645359672, 'auprc': 0.8343012999159155, 'loss_val': 0.9898325430648995, 'psi': 0.7336748586879465}-{'f1_val': 0.43166921142487696, 'auprc': 0.82835218599336, 'loss_val': 1.019597225759994, 'psi': 0.5903424012522702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=37 head_norm_before_train=1.608279 cos_to_last_merge=0.7560 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.756
[S2] round=37 local utility u=0.115559 metrics={'f1_val': 0.6949572707125489, 'auprc': 0.8099529929110291, 'loss_val': 0.5865349692629557, 'psi': 0.740955559591941}-{'f1_val': 0.657911282324529, 'auprc': 0.801555138157015, 'loss_val': 0.5701832935263356, 'psi': 0.7153688246575234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=37 head_norm_before_train=1.826041 cos_to_last_merge=0.9534 (last merge round=17)
[S3] round=37 local utility u=0.111027 metrics={'f1_val': 0.9276536824480817, 'auprc': 0.9983967079528682, 'loss_val': 0.15176947731182705, 'psi': 0.9559508926499963}-{'f1_val': 0.8943970497161853, 'auprc': 0.9982945342962184, 'loss_val': 0.1739769160159235, 'psi': 0.9359560435481985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=37 head_norm_before_train=1.507001 cos_to_last_merge=0.8960 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.896
[S4] round=37 local utility u=0.119275 metrics={'f1_val': 0.9539679027347988, 'auprc': 0.9647122217167492, 'loss_val': 0.27405764095018187, 'psi': 0.9582656303275789}-{'f1_val': 0.9370070554858588, 'auprc': 0.9499035905847685, 'loss_val': 0.36641643128143214, 'psi': 0.9421656695254227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=37 head_norm_before_train=1.836627 (no previous merge yet)
[S5] round=37 local utility u=0.304490 metrics={'f1_val': 0.7034962176251645, 'auprc': 0.9915895637103862, 'loss_val': 0.16973968347951907, 'psi': 0.8187335560592531}-{'f1_val': 0.7144667326210086, 'auprc': 0.8608812148702483, 'loss_val': 0.452417539849903, 'psi': 0.7730325255207044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=37 head_norm_before_train=1.518668 cos_to_last_merge=0.9188 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.919
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7973896581280961, 'auprc': 0.812947340818807, 'loss_val': 0.508832861022552, 'psi': 0.8036127312043805}-{'f1_val': 0.8361147945357466, 'auprc': 0.9446210896975638, 'loss_val': 0.3279977669505544, 'psi': 0.8795173126004734}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.380485 cos_to_last_merge=0.9000 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.900
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5134836634129537, 'auprc': 0.7798458928623411, 'loss_val': 0.9605842727960554, 'psi': 0.6200285551927087}-{'f1_val': 0.6637689935228102, 'auprc': 0.8293461067141417, 'loss_val': 0.4336774868305982, 'psi': 0.7299998387993427}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.804985 cos_to_last_merge=0.9665 (last merge round=13)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9857540367148059, 'auprc': 0.9990193729805661, 'loss_val': 0.06087310118518027, 'psi': 0.99106017122111}-{'f1_val': 0.9931893602624928, 'auprc': 0.9993370581579621, 'loss_val': 0.03970737287861117, 'psi': 0.9956484394206806}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.662405 cos_to_last_merge=0.9549 (last merge round=17)
[S9] round=37 local utility u=0.009330 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982387188521062, 'loss_val': 0.02623248804641324, 'psi': 0.9972917946291774}-{'f1_val': 0.9966605118138915, 'auprc': 0.9926056369247587, 'loss_val': 0.027992631749009848, 'psi': 0.9950385618582384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=37 head_norm_before_train=1.732531 cos_to_last_merge=0.9384 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=37 local utility u=0.001929 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.995115736020135, 'loss_val': 0.03223448977800807, 'psi': 0.995001617052204}-{'f1_val': 0.9947060979488367, 'auprc': 0.9946680899609439, 'loss_val': 0.03343231138833124, 'psi': 0.9946908947536796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=37 head_norm_before_train=2.093426 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9967233539996936, 'auprc': 0.9992948963734348, 'loss_val': 0.018392951171387426, 'psi': 0.9977519709491901}-{'f1_val': 0.9967224195815153, 'auprc': 0.9992818069125735, 'loss_val': 0.018317775147529716, 'psi': 0.9977461745139387}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.716941 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5735392804906598, 'auprc': 0.6915677319058793, 'loss_val': 0.9458330617939014, 'psi': 0.6207506610567476}-{'f1_val': 0.6137368458632178, 'auprc': 0.6733100004159469, 'loss_val': 0.6762125002959978, 'psi': 0.6375661076843093}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.854782 cos_to_last_merge=0.9847 (last merge round=17)
[S14] round=37 local utility u=0.001362 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9984361333966095, 'loss_val': 0.02405250199923037, 'psi': 0.9977205904160672}-{'f1_val': 0.9974109942678281, 'auprc': 0.9975360018259571, 'loss_val': 0.02508037574645675, 'psi': 0.9974609972910797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=37 head_norm_before_train=1.543512 cos_to_last_merge=0.9479 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9962895101731264, 'auprc': 0.9969781803366242, 'loss_val': 0.04645380836355657, 'psi': 0.9965649782385255}-{'f1_val': 0.7007681293011265, 'auprc': 0.9843327023641998, 'loss_val': 0.4585379820947365, 'psi': 0.8141939585263558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=37 head_norm_before_train=1.670093 cos_to_last_merge=0.9472 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=37 local utility u=0.208685 metrics={'f1_val': 0.9034526373806244, 'auprc': 0.9654839646196561, 'loss_val': 0.44968778426446937, 'psi': 0.9282651682762371}-{'f1_val': 0.8725703991052335, 'auprc': 0.9409637288487471, 'loss_val': 0.6082041963499142, 'psi': 0.8999277310026389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=37 head_norm_before_train=1.387780 cos_to_last_merge=0.9253 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.925
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5376179552924849, 'auprc': 0.831281340190235, 'loss_val': 1.1119565042885962, 'psi': 0.655083309251585}-{'f1_val': 0.6665905645359672, 'auprc': 0.8343012999159155, 'loss_val': 0.9898325430648995, 'psi': 0.7336748586879465}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.625164 cos_to_last_merge=0.7540 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=38 local utility u=0.002787 metrics={'f1_val': 0.7106847583032053, 'auprc': 0.8166148157158033, 'loss_val': 0.695311995132016, 'psi': 0.7530567812682445}-{'f1_val': 0.6949572707125489, 'auprc': 0.8099529929110291, 'loss_val': 0.5865349692629557, 'psi': 0.740955559591941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=38 head_norm_before_train=1.840801 cos_to_last_merge=0.9516 (last merge round=17)
[S3] round=38 local utility u=0.097929 metrics={'f1_val': 0.960110729356964, 'auprc': 0.9983946780499631, 'loss_val': 0.1506468600098818, 'psi': 0.9754243088341635}-{'f1_val': 0.9276536824480817, 'auprc': 0.9983967079528682, 'loss_val': 0.15176947731182705, 'psi': 0.9559508926499963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=38 head_norm_before_train=1.513030 cos_to_last_merge=0.8948 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.895
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9532359679314993, 'auprc': 0.9553662005070854, 'loss_val': 0.2760896298731236, 'psi': 0.9540880609617337}-{'f1_val': 0.9539679027347988, 'auprc': 0.9647122217167492, 'loss_val': 0.27405764095018187, 'psi': 0.9582656303275789}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.842076 (no previous merge yet)
[S5] round=38 local utility u=0.937299 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9982973565047795, 'loss_val': 0.077132982947704, 'psi': 0.9976035598026868}-{'f1_val': 0.7034962176251645, 'auprc': 0.9915895637103862, 'loss_val': 0.16973968347951907, 'psi': 0.8187335560592531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=38 head_norm_before_train=1.536338 cos_to_last_merge=0.9157 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.916
[S6] round=38 local utility u=0.276515 metrics={'f1_val': 0.8098608323418423, 'auprc': 0.9416096233116156, 'loss_val': 0.41661646449072237, 'psi': 0.8625603487297515}-{'f1_val': 0.7973896581280961, 'auprc': 0.812947340818807, 'loss_val': 0.508832861022552, 'psi': 0.8036127312043805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=38 head_norm_before_train=1.389419 cos_to_last_merge=0.8983 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.898
[S7] round=38 local utility u=0.560622 metrics={'f1_val': 0.6259317340449935, 'auprc': 0.8016114133686609, 'loss_val': 0.5793252735849205, 'psi': 0.6962036057744605}-{'f1_val': 0.5134836634129537, 'auprc': 0.7798458928623411, 'loss_val': 0.9605842727960554, 'psi': 0.6200285551927087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=38 head_norm_before_train=1.813588 cos_to_last_merge=0.9657 (last merge round=13)
[S8] round=38 local utility u=0.022374 metrics={'f1_val': 0.9903754849676576, 'auprc': 0.9991239184236039, 'loss_val': 0.044167633797967225, 'psi': 0.9938748583500361}-{'f1_val': 0.9857540367148059, 'auprc': 0.9990193729805661, 'loss_val': 0.06087310118518027, 'psi': 0.99106017122111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=38 head_norm_before_train=1.675606 cos_to_last_merge=0.9537 (last merge round=17)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9871765865591023, 'auprc': 0.997682894863045, 'loss_val': 0.05446672515741197, 'psi': 0.9913791098806795}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982387188521062, 'loss_val': 0.02623248804641324, 'psi': 0.9972917946291774}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.747411 cos_to_last_merge=0.9368 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=38 local utility u=0.001683 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959245061940771, 'loss_val': 0.03155144692785818, 'psi': 0.9953507143966766}-{'f1_val': 0.9949255377402499, 'auprc': 0.995115736020135, 'loss_val': 0.03223448977800807, 'psi': 0.995001617052204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=38 head_norm_before_train=2.103748 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9938420322783046, 'auprc': 0.999228041462032, 'loss_val': 0.027141837021752522, 'psi': 0.9959964359517957}-{'f1_val': 0.9967233539996936, 'auprc': 0.9992948963734348, 'loss_val': 0.018392951171387426, 'psi': 0.9977519709491901}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.723913 (no previous merge yet)
[S13] round=38 local utility u=0.220991 metrics={'f1_val': 0.6139233792006935, 'auprc': 0.668540149843725, 'loss_val': 0.6770726408297756, 'psi': 0.6357700874579061}-{'f1_val': 0.5735392804906598, 'auprc': 0.6915677319058793, 'loss_val': 0.9458330617939014, 'psi': 0.6207506610567476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=38 head_norm_before_train=1.866802 cos_to_last_merge=0.9840 (last merge round=17)
[S14] round=38 local utility u=0.003005 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.999231726002709, 'loss_val': 0.023884574368986923, 'psi': 0.9983844011814147}-{'f1_val': 0.9972435617623723, 'auprc': 0.9984361333966095, 'loss_val': 0.02405250199923037, 'psi': 0.9977205904160672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=38 head_norm_before_train=1.558550 cos_to_last_merge=0.9461 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7772971059929645, 'auprc': 0.9895303620909218, 'loss_val': 0.3168709347478652, 'psi': 0.8621904084321474}-{'f1_val': 0.9962895101731264, 'auprc': 0.9969781803366242, 'loss_val': 0.04645380836355657, 'psi': 0.9965649782385255}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.680419 cos_to_last_merge=0.9461 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=38 local utility u=0.213165 metrics={'f1_val': 0.9352528861268273, 'auprc': 0.9907341704937737, 'loss_val': 0.289909699365443, 'psi': 0.9574453998736059}-{'f1_val': 0.9034526373806244, 'auprc': 0.9654839646196561, 'loss_val': 0.44968778426446937, 'psi': 0.9282651682762371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=38 head_norm_before_train=1.398592 cos_to_last_merge=0.9239 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.924
[S17] round=38 local utility u=0.515865 metrics={'f1_val': 0.6744530526462538, 'auprc': 0.83612667348524, 'loss_val': 0.915773948568521, 'psi': 0.7391225009818483}-{'f1_val': 0.5376179552924849, 'auprc': 0.831281340190235, 'loss_val': 1.1119565042885962, 'psi': 0.655083309251585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=39 head_norm_before_train=1.643737 cos_to_last_merge=0.7518 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6990884461824883, 'auprc': 0.7980233302034216, 'loss_val': 0.6916706251904009, 'psi': 0.7386623997908617}-{'f1_val': 0.7106847583032053, 'auprc': 0.8166148157158033, 'loss_val': 0.695311995132016, 'psi': 0.7530567812682445}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.739 u=0.0000 p_local=0.0561 f1=0.699 auprc=0.798 bytes=39581
[S3] START round=39 head_norm_before_train=1.855063 cos_to_last_merge=0.9502 (last merge round=17)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9438037858834424, 'auprc': 0.9983198870894413, 'loss_val': 0.11920322524344465, 'psi': 0.9656102263658419}-{'f1_val': 0.960110729356964, 'auprc': 0.9983946780499631, 'loss_val': 0.1506468600098818, 'psi': 0.9754243088341635}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.966 u=0.0000 p_local=0.0637 f1=0.944 auprc=0.998 bytes=46736
[S4] START round=39 head_norm_before_train=1.517836 cos_to_last_merge=0.8940 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9380832096299789, 'auprc': 0.9527375211648618, 'loss_val': 0.3210840636681301, 'psi': 0.9439449342439321}-{'f1_val': 0.9532359679314993, 'auprc': 0.9553662005070854, 'loss_val': 0.2760896298731236, 'psi': 0.9540880609617337}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.944 u=0.0000 p_local=0.0291 f1=0.938 auprc=0.953 bytes=44899
[S5] START round=39 head_norm_before_train=1.847842 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.8115157668320295, 'auprc': 0.991137283593035, 'loss_val': 0.18972523173601155, 'psi': 0.8833643735364317}-{'f1_val': 0.9971410286679584, 'auprc': 0.9982973565047795, 'loss_val': 0.077132982947704, 'psi': 0.9976035598026868}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.883 u=0.0000 p_local=0.2958 f1=0.812 auprc=0.991 bytes=50306
[S6] START round=39 head_norm_before_train=1.553393 cos_to_last_merge=0.9126 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.913
[S6] round=39 local utility u=0.104785 metrics={'f1_val': 0.8339931612667973, 'auprc': 0.9428976601530097, 'loss_val': 0.3557038222553957, 'psi': 0.8775549608212823}-{'f1_val': 0.8098608323418423, 'auprc': 0.9416096233116156, 'loss_val': 0.41661646449072237, 'psi': 0.8625603487297515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=40 psi=0.878 u=0.1048 p_local=0.1918 f1=0.834 auprc=0.943 bytes=41344
[S7] START round=39 head_norm_before_train=1.398744 cos_to_last_merge=0.8965 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.897
[S7] round=39 local utility u=0.288054 metrics={'f1_val': 0.6747599691128625, 'auprc': 0.8350669591048648, 'loss_val': 0.39655423225069736, 'psi': 0.7388827651096634}-{'f1_val': 0.6259317340449935, 'auprc': 0.8016114133686609, 'loss_val': 0.5793252735849205, 'psi': 0.6962036057744605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S7] r=40 psi=0.739 u=0.2881 p_local=0.3424 f1=0.675 auprc=0.835 bytes=41341
[S8] START round=39 head_norm_before_train=1.823160 cos_to_last_merge=0.9650 (last merge round=13)
[S8] round=39 local utility u=0.004679 metrics={'f1_val': 0.9937924949465919, 'auprc': 0.9978170236191946, 'loss_val': 0.05139151756737403, 'psi': 0.995402306415633}-{'f1_val': 0.9903754849676576, 'auprc': 0.9991239184236039, 'loss_val': 0.044167633797967225, 'psi': 0.9938748583500361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] r=40 psi=0.995 u=0.0047 p_local=0.0221 f1=0.994 auprc=0.998 bytes=46754
[S9] START round=39 head_norm_before_train=1.688220 cos_to_last_merge=0.9525 (last merge round=17)
[S9] round=39 local utility u=0.040134 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9982697625607542, 'loss_val': 0.026358901571505302, 'psi': 0.9966537403548105}-{'f1_val': 0.9871765865591023, 'auprc': 0.997682894863045, 'loss_val': 0.05446672515741197, 'psi': 0.9913791098806795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S9] r=40 psi=0.997 u=0.0401 p_local=0.0163 f1=0.996 auprc=0.998 bytes=48590
[S10] START round=39 head_norm_before_train=1.761849 cos_to_last_merge=0.9354 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9949011505906475, 'auprc': 0.9947038063388591, 'loss_val': 0.031765578579983224, 'psi': 0.9948222128899321}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959245061940771, 'loss_val': 0.03155144692785818, 'psi': 0.9953507143966766}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0041 f1=0.995 auprc=0.995 bytes=55787
[S11] START round=39 head_norm_before_train=2.112833 (no previous merge yet)
[S11] round=39 local utility u=0.014222 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992476458654691, 'loss_val': 0.01748982742093314, 'psi': 0.997877612321934}-{'f1_val': 0.9938420322783046, 'auprc': 0.999228041462032, 'loss_val': 0.027141837021752522, 'psi': 0.9959964359517957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S11] r=40 psi=0.998 u=0.0142 p_local=0.0207 f1=0.997 auprc=0.999 bytes=50396
[S13] START round=39 head_norm_before_train=1.729922 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5832126184351709, 'auprc': 0.6904938698771218, 'loss_val': 0.8221533806322544, 'psi': 0.6261251190119512}-{'f1_val': 0.6139233792006935, 'auprc': 0.668540149843725, 'loss_val': 0.6770726408297756, 'psi': 0.6357700874579061}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.626 u=0.0000 p_local=0.0614 f1=0.583 auprc=0.690 bytes=32421
[S14] START round=39 head_norm_before_train=1.876610 cos_to_last_merge=0.9836 (last merge round=17)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.986217037122954, 'auprc': 0.997159488035923, 'loss_val': 0.04543955852248228, 'psi': 0.9905940174881416}-{'f1_val': 0.9978195179672185, 'auprc': 0.999231726002709, 'loss_val': 0.023884574368986923, 'psi': 0.9983844011814147}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.991 u=0.0000 p_local=0.0028 f1=0.986 auprc=0.997 bytes=55693
[S15] START round=39 head_norm_before_train=1.575425 cos_to_last_merge=0.9441 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=39 local utility u=0.799877 metrics={'f1_val': 0.9951880368117962, 'auprc': 0.9976785496165869, 'loss_val': 0.04890692425549058, 'psi': 0.9961842419337125}-{'f1_val': 0.7772971059929645, 'auprc': 0.9895303620909218, 'loss_val': 0.3168709347478652, 'psi': 0.8621904084321474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] r=40 psi=0.996 u=0.7999 p_local=0.3897 f1=0.995 auprc=0.998 bytes=44931
[S16] START round=39 head_norm_before_train=1.691095 cos_to_last_merge=0.9451 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9361158937175308, 'auprc': 0.991345675060043, 'loss_val': 0.29703815168283065, 'psi': 0.9582078062545356}-{'f1_val': 0.9352528861268273, 'auprc': 0.9907341704937737, 'loss_val': 0.289909699365443, 'psi': 0.9574453998736059}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.958 u=0.0000 p_local=0.1306 f1=0.936 auprc=0.991 bytes=39571
[S17] START round=39 head_norm_before_train=1.406084 cos_to_last_merge=0.9229 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.923
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.3805176122462294, 'auprc': 0.6604789553233607, 'loss_val': 1.3027047283743733, 'psi': 0.49250214947708193}-{'f1_val': 0.6744530526462538, 'auprc': 0.83612667348524, 'loss_val': 0.915773948568521, 'psi': 0.7391225009818483}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.493 u=0.0000 p_local=0.1980 f1=0.381 auprc=0.660 bytes=39587
[S2] START round=40 head_norm_before_train=1.664134 cos_to_last_merge=0.7493 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.749
[S2] round=40 local utility u=0.018694 metrics={'f1_val': 0.7094946761334707, 'auprc': 0.8168546503542045, 'loss_val': 0.7732135377014581, 'psi': 0.7524386658217643}-{'f1_val': 0.6990884461824883, 'auprc': 0.7980233302034216, 'loss_val': 0.6916706251904009, 'psi': 0.7386623997908617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=40 head_norm_before_train=1.868696 cos_to_last_merge=0.9487 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.6176075235705007, 'auprc': 0.9917766779436696, 'loss_val': 0.6886244878335279, 'psi': 0.7672751853197683}-{'f1_val': 0.9438037858834424, 'auprc': 0.9983198870894413, 'loss_val': 0.11920322524344465, 'psi': 0.9656102263658419}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.521007 cos_to_last_merge=0.8937 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=40 local utility u=0.047487 metrics={'f1_val': 0.9420853821202501, 'auprc': 0.965700141023138, 'loss_val': 0.289011214902626, 'psi': 0.9515312856814052}-{'f1_val': 0.9380832096299789, 'auprc': 0.9527375211648618, 'loss_val': 0.3210840636681301, 'psi': 0.9439449342439321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=40 head_norm_before_train=1.856146 (no previous merge yet)
[S5] round=40 local utility u=0.601618 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9922694755408733, 'loss_val': 0.09966721497857355, 'psi': 0.9947954783879874}-{'f1_val': 0.8115157668320295, 'auprc': 0.991137283593035, 'loss_val': 0.18972523173601155, 'psi': 0.8833643735364317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=40 head_norm_before_train=1.572518 cos_to_last_merge=0.9097 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.910
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6823705219036056, 'auprc': 0.8063780698372022, 'loss_val': 0.6892211059510323, 'psi': 0.7319735410770443}-{'f1_val': 0.8339931612667973, 'auprc': 0.9428976601530097, 'loss_val': 0.3557038222553957, 'psi': 0.8775549608212823}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.409881 cos_to_last_merge=0.8941 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.894
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5997100877120017, 'auprc': 0.7946945747705152, 'loss_val': 0.6763687419410638, 'psi': 0.6777038825354071}-{'f1_val': 0.6747599691128625, 'auprc': 0.8350669591048648, 'loss_val': 0.39655423225069736, 'psi': 0.7388827651096634}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.831871 cos_to_last_merge=0.9644 (last merge round=13)
[S8] round=40 local utility u=0.007350 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9993992217832447, 'loss_val': 0.03609853948543601, 'psi': 0.9955011422724835}-{'f1_val': 0.9937924949465919, 'auprc': 0.9978170236191946, 'loss_val': 0.05139151756737403, 'psi': 0.995402306415633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=40 head_norm_before_train=1.699365 cos_to_last_merge=0.9515 (last merge round=17)
[S9] round=40 local utility u=0.004294 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982389349990977, 'loss_val': 0.02418345845476851, 'psi': 0.997291881087974}-{'f1_val': 0.9955763922175147, 'auprc': 0.9982697625607542, 'loss_val': 0.026358901571505302, 'psi': 0.9966537403548105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] sending update (kind=head size=1807 to 1 peers)
[S10] START round=40 head_norm_before_train=1.776013 cos_to_last_merge=0.9340 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=40 local utility u=0.002116 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952735257574523, 'loss_val': 0.030962038599410886, 'psi': 0.9952221137146058}-{'f1_val': 0.9949011505906475, 'auprc': 0.9947038063388591, 'loss_val': 0.031765578579983224, 'psi': 0.9948222128899321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=40 head_norm_before_train=2.121096 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9948671806073948, 'auprc': 0.9993745065316353, 'loss_val': 0.02281922163198757, 'psi': 0.996670110977091}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992476458654691, 'loss_val': 0.01748982742093314, 'psi': 0.997877612321934}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.734378 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5616522355319289, 'auprc': 0.6956129311365454, 'loss_val': 0.9549203695764491, 'psi': 0.6152365137737754}-{'f1_val': 0.5832126184351709, 'auprc': 0.6904938698771218, 'loss_val': 0.8221533806322544, 'psi': 0.6261251190119512}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.885879 cos_to_last_merge=0.9831 (last merge round=17)
[S14] round=40 local utility u=0.042782 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.997158285432018, 'loss_val': 0.02700357182229131, 'psi': 0.9973066320043977}-{'f1_val': 0.986217037122954, 'auprc': 0.997159488035923, 'loss_val': 0.04543955852248228, 'psi': 0.9905940174881416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=40 head_norm_before_train=1.592290 cos_to_last_merge=0.9422 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7772971059929645, 'auprc': 0.9917216823526058, 'loss_val': 0.33996110912946353, 'psi': 0.8630669365368211}-{'f1_val': 0.9951880368117962, 'auprc': 0.9976785496165869, 'loss_val': 0.04890692425549058, 'psi': 0.9961842419337125}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.701076 cos_to_last_merge=0.9438 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8215307758245082, 'auprc': 0.8242201554922085, 'loss_val': 1.1496363658551263, 'psi': 0.8226065276915883}-{'f1_val': 0.9361158937175308, 'auprc': 0.991345675060043, 'loss_val': 0.29703815168283065, 'psi': 0.9582078062545356}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.413682 cos_to_last_merge=0.9219 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.922
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.6416146095353068, 'auprc': 0.768655822615903, 'loss_val': 0.7096697296347717, 'psi': 0.6924310947675453}-{'f1_val': 0.3805176122462294, 'auprc': 0.6604789553233607, 'loss_val': 1.3027047283743733, 'psi': 0.49250214947708193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=41 head_norm_before_train=1.683035 cos_to_last_merge=0.7468 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.747
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7122489857239505, 'auprc': 0.8197997956088338, 'loss_val': 0.8142696548919418, 'psi': 0.7552693096779037}-{'f1_val': 0.7094946761334707, 'auprc': 0.8168546503542045, 'loss_val': 0.7732135377014581, 'psi': 0.7524386658217643}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.879942 cos_to_last_merge=0.9475 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=41 local utility u=1.000000 metrics={'f1_val': 0.995449460959571, 'auprc': 0.998202198393406, 'loss_val': 0.030284269952254566, 'psi': 0.9965505559331049}-{'f1_val': 0.6176075235705007, 'auprc': 0.9917766779436696, 'loss_val': 0.6886244878335279, 'psi': 0.7672751853197683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=41 head_norm_before_train=1.525546 cos_to_last_merge=0.8930 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.893
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.8328370921257052, 'auprc': 0.9605754451356978, 'loss_val': 0.43740709584639803, 'psi': 0.8839324333297023}-{'f1_val': 0.9420853821202501, 'auprc': 0.965700141023138, 'loss_val': 0.289011214902626, 'psi': 0.9515312856814052}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.863973 (no previous merge yet)
[S5] round=41 local utility u=0.020929 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9954489726869037, 'loss_val': 0.06647354179710473, 'psi': 0.9959798762528955}-{'f1_val': 0.9964794802860635, 'auprc': 0.9922694755408733, 'loss_val': 0.09966721497857355, 'psi': 0.9947954783879874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=41 head_norm_before_train=1.596185 cos_to_last_merge=0.9072 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.907
[S6] round=41 local utility u=0.638851 metrics={'f1_val': 0.7907410767370466, 'auprc': 0.9433072944642167, 'loss_val': 0.4725294355029087, 'psi': 0.8517675638279147}-{'f1_val': 0.6823705219036056, 'auprc': 0.8063780698372022, 'loss_val': 0.6892211059510323, 'psi': 0.7319735410770443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=41 head_norm_before_train=1.420849 cos_to_last_merge=0.8916 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.892
[S7] round=41 local utility u=0.280455 metrics={'f1_val': 0.6568886197556637, 'auprc': 0.8072150713082811, 'loss_val': 0.49609058428856384, 'psi': 0.7170192003767106}-{'f1_val': 0.5997100877120017, 'auprc': 0.7946945747705152, 'loss_val': 0.6763687419410638, 'psi': 0.6777038825354071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=41 head_norm_before_train=1.837792 cos_to_last_merge=0.9639 (last merge round=13)
[S8] round=41 local utility u=0.000015 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9993957780009275, 'loss_val': 0.03605763364598276, 'psi': 0.9954997647595567}-{'f1_val': 0.9929024225986427, 'auprc': 0.9993992217832447, 'loss_val': 0.03609853948543601, 'psi': 0.9955011422724835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=41 head_norm_before_train=1.707007 cos_to_last_merge=0.9501 (last merge round=17)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9964066858194072, 'auprc': 0.9981995581156854, 'loss_val': 0.023961265860188468, 'psi': 0.9971238347379184}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982389349990977, 'loss_val': 0.02418345845476851, 'psi': 0.997291881087974}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.786424 cos_to_last_merge=0.9329 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9953150696065944, 'auprc': 0.9937935871123574, 'loss_val': 0.03047937462396123, 'psi': 0.9947064766088995}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952735257574523, 'loss_val': 0.030962038599410886, 'psi': 0.9952221137146058}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=2.126386 (no previous merge yet)
[S11] round=41 local utility u=0.005979 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9988833925480844, 'loss_val': 0.01803959675297408, 'psi': 0.9973388077894549}-{'f1_val': 0.9948671806073948, 'auprc': 0.9993745065316353, 'loss_val': 0.02281922163198757, 'psi': 0.996670110977091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=41 head_norm_before_train=1.738246 (no previous merge yet)
[S13] round=41 local utility u=0.244143 metrics={'f1_val': 0.6072331589977139, 'auprc': 0.6722346613779253, 'loss_val': 0.6699853134699648, 'psi': 0.6332337599497985}-{'f1_val': 0.5616522355319289, 'auprc': 0.6956129311365454, 'loss_val': 0.9549203695764491, 'psi': 0.6152365137737754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=41 head_norm_before_train=1.894587 cos_to_last_merge=0.9826 (last merge round=17)
[S14] round=41 local utility u=0.006168 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9992336496011078, 'loss_val': 0.024834767668212278, 'psi': 0.9985308797496509}-{'f1_val': 0.9974055297193176, 'auprc': 0.997158285432018, 'loss_val': 0.02700357182229131, 'psi': 0.9973066320043977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=41 head_norm_before_train=1.607879 cos_to_last_merge=0.9405 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=41 local utility u=0.133426 metrics={'f1_val': 0.8108536183602613, 'auprc': 0.9920402393941401, 'loss_val': 0.27540368068707227, 'psi': 0.8833282667738128}-{'f1_val': 0.7772971059929645, 'auprc': 0.9917216823526058, 'loss_val': 0.33996110912946353, 'psi': 0.8630669365368211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=41 head_norm_before_train=1.710068 cos_to_last_merge=0.9426 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=41 local utility u=1.000000 metrics={'f1_val': 0.9909115130522451, 'auprc': 0.9883389910107828, 'loss_val': 0.05452869467291677, 'psi': 0.9898825042356602}-{'f1_val': 0.8215307758245082, 'auprc': 0.8242201554922085, 'loss_val': 1.1496363658551263, 'psi': 0.8226065276915883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=41 head_norm_before_train=1.422958 cos_to_last_merge=0.9210 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.921
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6541729274481242, 'auprc': 0.827851487509438, 'loss_val': 1.092379401564069, 'psi': 0.7236443514726497}-{'f1_val': 0.6416146095353068, 'auprc': 0.768655822615903, 'loss_val': 0.7096697296347717, 'psi': 0.6924310947675453}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.699044 cos_to_last_merge=0.7448 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.745
[S2] round=42 local utility u=0.005517 metrics={'f1_val': 0.7108241921135072, 'auprc': 0.8146707785592683, 'loss_val': 0.7792994992623103, 'psi': 0.7523628266918116}-{'f1_val': 0.7122489857239505, 'auprc': 0.8197997956088338, 'loss_val': 0.8142696548919418, 'psi': 0.7552693096779037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=42 head_norm_before_train=1.890451 cos_to_last_merge=0.9467 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.947
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9602765867299603, 'auprc': 0.9687206407486075, 'loss_val': 0.14309610906821865, 'psi': 0.9636542083374192}-{'f1_val': 0.995449460959571, 'auprc': 0.998202198393406, 'loss_val': 0.030284269952254566, 'psi': 0.9965505559331049}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.530264 cos_to_last_merge=0.8921 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.892
[S4] round=42 local utility u=0.393954 metrics={'f1_val': 0.9399755193941912, 'auprc': 0.9667822014607829, 'loss_val': 0.31095025408756194, 'psi': 0.9506981922208279}-{'f1_val': 0.8328370921257052, 'auprc': 0.9605754451356978, 'loss_val': 0.43740709584639803, 'psi': 0.8839324333297023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=42 head_norm_before_train=1.870777 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9939798301529816, 'loss_val': 0.07371882981503863, 'psi': 0.9953922192393267}-{'f1_val': 0.9963338119635569, 'auprc': 0.9954489726869037, 'loss_val': 0.06647354179710473, 'psi': 0.9959798762528955}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.615402 cos_to_last_merge=0.9052 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.905
[S6] round=42 local utility u=0.293364 metrics={'f1_val': 0.8475064281013017, 'auprc': 0.965041720474458, 'loss_val': 0.29159635840348197, 'psi': 0.8945205450505642}-{'f1_val': 0.7907410767370466, 'auprc': 0.9433072944642167, 'loss_val': 0.4725294355029087, 'psi': 0.8517675638279147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=42 head_norm_before_train=1.429979 cos_to_last_merge=0.8897 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.890
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6148177390129055, 'auprc': 0.7954758245841616, 'loss_val': 0.6183853981770324, 'psi': 0.6870809732414079}-{'f1_val': 0.6568886197556637, 'auprc': 0.8072150713082811, 'loss_val': 0.49609058428856384, 'psi': 0.7170192003767106}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.845771 cos_to_last_merge=0.9633 (last merge round=13)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9991754121089041, 'loss_val': 0.03558194156251222, 'psi': 0.9954116184027473}-{'f1_val': 0.9929024225986427, 'auprc': 0.9993957780009275, 'loss_val': 0.03605763364598276, 'psi': 0.9954997647595567}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.715599 cos_to_last_merge=0.9488 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=42 local utility u=0.000485 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9982492743513721, 'loss_val': 0.023161561954528953, 'psi': 0.9971458211408813}-{'f1_val': 0.9964066858194072, 'auprc': 0.9981995581156854, 'loss_val': 0.023961265860188468, 'psi': 0.9971238347379184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=42 head_norm_before_train=1.792984 cos_to_last_merge=0.9320 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=42 local utility u=0.002451 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954944843629586, 'loss_val': 0.029916395023596817, 'psi': 0.9953104971568083}-{'f1_val': 0.9953150696065944, 'auprc': 0.9937935871123574, 'loss_val': 0.03047937462396123, 'psi': 0.9947064766088995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=42 head_norm_before_train=2.132770 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9881299301764846, 'auprc': 0.9993023527788047, 'loss_val': 0.05493306109032901, 'psi': 0.9925988992174126}-{'f1_val': 0.9963090846170353, 'auprc': 0.9988833925480844, 'loss_val': 0.01803959675297408, 'psi': 0.9973388077894549}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.740584 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5700345144275114, 'auprc': 0.6918123394135367, 'loss_val': 0.7998474234503982, 'psi': 0.6187456444219215}-{'f1_val': 0.6072331589977139, 'auprc': 0.6722346613779253, 'loss_val': 0.6699853134699648, 'psi': 0.6332337599497985}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.901800 cos_to_last_merge=0.9822 (last merge round=17)
[S14] round=42 local utility u=0.001243 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.9992336496011077, 'loss_val': 0.022216046894269773, 'psi': 0.9985176748445672}-{'f1_val': 0.9980623665153463, 'auprc': 0.9992336496011078, 'loss_val': 0.024834767668212278, 'psi': 0.9985308797496509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=42 head_norm_before_train=1.622685 cos_to_last_merge=0.9388 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=42 local utility u=0.645654 metrics={'f1_val': 0.9889941244589165, 'auprc': 0.9970630864727953, 'loss_val': 0.06800633501231537, 'psi': 0.9922217092644681}-{'f1_val': 0.8108536183602613, 'auprc': 0.9920402393941401, 'loss_val': 0.27540368068707227, 'psi': 0.8833282667738128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=42 head_norm_before_train=1.716507 cos_to_last_merge=0.9418 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.942
[S16] round=42 local utility u=0.007260 metrics={'f1_val': 0.991732506425948, 'auprc': 0.9907657956113392, 'loss_val': 0.0522146901658341, 'psi': 0.9913458221001045}-{'f1_val': 0.9909115130522451, 'auprc': 0.9883389910107828, 'loss_val': 0.05452869467291677, 'psi': 0.9898825042356602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=42 head_norm_before_train=1.431000 cos_to_last_merge=0.9199 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.3918347317255265, 'auprc': 0.5909186394956013, 'loss_val': 1.2901982252755733, 'psi': 0.47146829483355646}-{'f1_val': 0.6541729274481242, 'auprc': 0.827851487509438, 'loss_val': 1.092379401564069, 'psi': 0.7236443514726497}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.715613 cos_to_last_merge=0.7427 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.743
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7097022537724982, 'auprc': 0.8169865552371183, 'loss_val': 0.8168994378890253, 'psi': 0.7526159743583463}-{'f1_val': 0.7108241921135072, 'auprc': 0.8146707785592683, 'loss_val': 0.7792994992623103, 'psi': 0.7523628266918116}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.901429 cos_to_last_merge=0.9457 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=43 local utility u=0.157980 metrics={'f1_val': 0.9836577126072661, 'auprc': 0.997549137049601, 'loss_val': 0.05390905187152789, 'psi': 0.9892142823842001}-{'f1_val': 0.9602765867299603, 'auprc': 0.9687206407486075, 'loss_val': 0.14309610906821865, 'psi': 0.9636542083374192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=43 head_norm_before_train=1.534189 cos_to_last_merge=0.8914 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.891
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9393665007050311, 'auprc': 0.9640293736460087, 'loss_val': 0.3283747708985173, 'psi': 0.9492316498814222}-{'f1_val': 0.9399755193941912, 'auprc': 0.9667822014607829, 'loss_val': 0.31095025408756194, 'psi': 0.9506981922208279}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.879173 (no previous merge yet)
[S5] round=43 local utility u=0.003291 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9926068063800085, 'loss_val': 0.06565269852611537, 'psi': 0.9951064433330853}-{'f1_val': 0.9963338119635569, 'auprc': 0.9939798301529816, 'loss_val': 0.07371882981503863, 'psi': 0.9953922192393267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=43 head_norm_before_train=1.631147 cos_to_last_merge=0.9033 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.903
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6302600204368489, 'auprc': 0.7841737472326481, 'loss_val': 0.7323131100151543, 'psi': 0.6918255111551685}-{'f1_val': 0.8475064281013017, 'auprc': 0.965041720474458, 'loss_val': 0.29159635840348197, 'psi': 0.8945205450505642}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.438222 cos_to_last_merge=0.8880 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=43 local utility u=0.127279 metrics={'f1_val': 0.6411082686201364, 'auprc': 0.8040068512690355, 'loss_val': 0.5471645481239555, 'psi': 0.7062677016796961}-{'f1_val': 0.6148177390129055, 'auprc': 0.7954758245841616, 'loss_val': 0.6183853981770324, 'psi': 0.6870809732414079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=43 head_norm_before_train=1.853625 cos_to_last_merge=0.9628 (last merge round=13)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.991097207355627, 'auprc': 0.9990757416853876, 'loss_val': 0.040725488938943386, 'psi': 0.9942886210875312}-{'f1_val': 0.9929024225986427, 'auprc': 0.9991754121089041, 'loss_val': 0.03558194156251222, 'psi': 0.9954116184027473}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.724264 cos_to_last_merge=0.9477 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9951713720575582, 'loss_val': 0.02310943611686348, 'psi': 0.996330296330309}-{'f1_val': 0.9964101856672208, 'auprc': 0.9982492743513721, 'loss_val': 0.023161561954528953, 'psi': 0.9971458211408813}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.801899 cos_to_last_merge=0.9310 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9953150696065944, 'auprc': 0.9946422892056253, 'loss_val': 0.029211951636771434, 'psi': 0.9950459574462067}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954944843629586, 'loss_val': 0.029916395023596817, 'psi': 0.9953104971568083}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=2.136453 (no previous merge yet)
[S11] round=43 local utility u=0.042345 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990131572599399, 'loss_val': 0.01845128976815639, 'psi': 0.9973907136741971}-{'f1_val': 0.9881299301764846, 'auprc': 0.9993023527788047, 'loss_val': 0.05493306109032901, 'psi': 0.9925988992174126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=43 head_norm_before_train=1.744203 (no previous merge yet)
[S13] round=43 local utility u=0.070513 metrics={'f1_val': 0.5954963344111525, 'auprc': 0.6836797465561423, 'loss_val': 0.7871954590859501, 'psi': 0.6307696992691484}-{'f1_val': 0.5700345144275114, 'auprc': 0.6918123394135367, 'loss_val': 0.7998474234503982, 'psi': 0.6187456444219215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=43 head_norm_before_train=1.907887 cos_to_last_merge=0.9818 (last merge round=17)
[S14] round=43 local utility u=0.000326 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.999233094122548, 'loss_val': 0.021707945874972955, 'psi': 0.9985320023905514}-{'f1_val': 0.9980403583402068, 'auprc': 0.9992336496011077, 'loss_val': 0.022216046894269773, 'psi': 0.9985176748445672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=43 head_norm_before_train=1.638278 cos_to_last_merge=0.9370 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9670489550133599, 'auprc': 0.9983457244444867, 'loss_val': 0.12192692982377719, 'psi': 0.9795676627858105}-{'f1_val': 0.9889941244589165, 'auprc': 0.9970630864727953, 'loss_val': 0.06800633501231537, 'psi': 0.9922217092644681}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.722815 cos_to_last_merge=0.9408 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.941
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8327639790927447, 'auprc': 0.8922676011663937, 'loss_val': 1.0667224501532317, 'psi': 0.8565654279222044}-{'f1_val': 0.991732506425948, 'auprc': 0.9907657956113392, 'loss_val': 0.0522146901658341, 'psi': 0.9913458221001045}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.439416 cos_to_last_merge=0.9188 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.919
[S17] round=43 local utility u=1.000000 metrics={'f1_val': 0.6507817924362089, 'auprc': 0.8416384790161465, 'loss_val': 0.77960386754398, 'psi': 0.727124467068184}-{'f1_val': 0.3918347317255265, 'auprc': 0.5909186394956013, 'loss_val': 1.2901982252755733, 'psi': 0.47146829483355646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=44 head_norm_before_train=1.729667 cos_to_last_merge=0.7410 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.741
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6972766431105389, 'auprc': 0.7975108069257743, 'loss_val': 0.743478818761361, 'psi': 0.737370308636633}-{'f1_val': 0.7097022537724982, 'auprc': 0.8169865552371183, 'loss_val': 0.8168994378890253, 'psi': 0.7526159743583463}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.910512 cos_to_last_merge=0.9447 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=44 local utility u=0.057180 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9983622933183991, 'loss_val': 0.024261366968816554, 'psi': 0.9977667359224119}-{'f1_val': 0.9836577126072661, 'auprc': 0.997549137049601, 'loss_val': 0.05390905187152789, 'psi': 0.9892142823842001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=44 head_norm_before_train=1.539485 cos_to_last_merge=0.8909 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.891
[S4] round=44 local utility u=0.000180 metrics={'f1_val': 0.9392305489195935, 'auprc': 0.9602839861982246, 'loss_val': 0.31596352590406135, 'psi': 0.9476519238310459}-{'f1_val': 0.9393665007050311, 'auprc': 0.9640293736460087, 'loss_val': 0.3283747708985173, 'psi': 0.9492316498814222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=44 head_norm_before_train=1.885830 (no previous merge yet)
[S5] round=44 local utility u=0.016326 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.997450196372059, 'loss_val': 0.04753179896984695, 'psi': 0.9970437993299055}-{'f1_val': 0.9967728679684698, 'auprc': 0.9926068063800085, 'loss_val': 0.06565269852611537, 'psi': 0.9951064433330853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=44 head_norm_before_train=1.641388 cos_to_last_merge=0.9010 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.901
[S6] round=44 local utility u=0.931105 metrics={'f1_val': 0.8030667882508455, 'auprc': 0.9605311817819512, 'loss_val': 0.4360154680886843, 'psi': 0.8660525456632877}-{'f1_val': 0.6302600204368489, 'auprc': 0.7841737472326481, 'loss_val': 0.7323131100151543, 'psi': 0.6918255111551685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=44 head_norm_before_train=1.451371 cos_to_last_merge=0.8853 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.885
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6081698361824, 'auprc': 0.7957808304347055, 'loss_val': 0.6703285803076792, 'psi': 0.6832142338833223}-{'f1_val': 0.6411082686201364, 'auprc': 0.8040068512690355, 'loss_val': 0.5471645481239555, 'psi': 0.7062677016796961}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.862574 cos_to_last_merge=0.9622 (last merge round=13)
[S8] round=44 local utility u=0.007112 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9993019382096924, 'loss_val': 0.03582447207009446, 'psi': 0.9952436100331781}-{'f1_val': 0.991097207355627, 'auprc': 0.9990757416853876, 'loss_val': 0.040725488938943386, 'psi': 0.9942886210875312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=44 head_norm_before_train=1.734010 cos_to_last_merge=0.9466 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9954204731574638, 'loss_val': 0.02282663715207854, 'psi': 0.9961644963513204}-{'f1_val': 0.9971029125121428, 'auprc': 0.9951713720575582, 'loss_val': 0.02310943611686348, 'psi': 0.996330296330309}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.812352 cos_to_last_merge=0.9299 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9943455189707798, 'loss_val': 0.029008158019325842, 'psi': 0.9948509109999368}-{'f1_val': 0.9953150696065944, 'auprc': 0.9946422892056253, 'loss_val': 0.029211951636771434, 'psi': 0.9950459574462067}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.141344 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9568391236785743, 'auprc': 0.999377720042373, 'loss_val': 0.1319414653371263, 'psi': 0.9738545622240938}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990131572599399, 'loss_val': 0.01845128976815639, 'psi': 0.9973907136741971}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.744759 (no previous merge yet)
[S13] round=44 local utility u=0.035152 metrics={'f1_val': 0.592843814028617, 'auprc': 0.688222865994421, 'loss_val': 0.7146066620990938, 'psi': 0.6309954348149386}-{'f1_val': 0.5954963344111525, 'auprc': 0.6836797465561423, 'loss_val': 0.7871954590859501, 'psi': 0.6307696992691484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=44 head_norm_before_train=1.914135 cos_to_last_merge=0.9814 (last merge round=17)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9992318513061941, 'loss_val': 0.020874023524353625, 'psi': 0.9982850462120512}-{'f1_val': 0.9980646079025537, 'auprc': 0.999233094122548, 'loss_val': 0.021707945874972955, 'psi': 0.9985320023905514}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.650674 cos_to_last_merge=0.9357 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.700681726646837, 'auprc': 0.8000371654754783, 'loss_val': 0.5513661741333918, 'psi': 0.7404239021782936}-{'f1_val': 0.9670489550133599, 'auprc': 0.9983457244444867, 'loss_val': 0.12192692982377719, 'psi': 0.9795676627858105}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.730894 cos_to_last_merge=0.9398 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=44 local utility u=0.391518 metrics={'f1_val': 0.8616365823149693, 'auprc': 0.9938459543833985, 'loss_val': 0.7616562897953367, 'psi': 0.914520331142341}-{'f1_val': 0.8327639790927447, 'auprc': 0.8922676011663937, 'loss_val': 1.0667224501532317, 'psi': 0.8565654279222044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=44 head_norm_before_train=1.445857 cos_to_last_merge=0.9185 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.919
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.42137471177596464, 'auprc': 0.8209992934951993, 'loss_val': 1.1183202870420046, 'psi': 0.5812245444636586}-{'f1_val': 0.6507817924362089, 'auprc': 0.8416384790161465, 'loss_val': 0.77960386754398, 'psi': 0.727124467068184}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.743314 cos_to_last_merge=0.7395 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.740
[S2] round=45 local utility u=0.011995 metrics={'f1_val': 0.708298828138041, 'auprc': 0.8004909747860992, 'loss_val': 0.7945622291053611, 'psi': 0.7451756867972643}-{'f1_val': 0.6972766431105389, 'auprc': 0.7975108069257743, 'loss_val': 0.743478818761361, 'psi': 0.737370308636633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=45 head_norm_before_train=1.920323 cos_to_last_merge=0.9436 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9771808579818404, 'auprc': 0.9983850391578619, 'loss_val': 0.06212350667547036, 'psi': 0.9856625304522489}-{'f1_val': 0.9973696976584205, 'auprc': 0.9983622933183991, 'loss_val': 0.024261366968816554, 'psi': 0.9977667359224119}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.548435 cos_to_last_merge=0.8899 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.890
[S4] round=45 local utility u=0.030834 metrics={'f1_val': 0.9441122085775551, 'auprc': 0.9625086576040154, 'loss_val': 0.29025941627522445, 'psi': 0.9514707881881391}-{'f1_val': 0.9392305489195935, 'auprc': 0.9602839861982246, 'loss_val': 0.31596352590406135, 'psi': 0.9476519238310459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=45 head_norm_before_train=1.891129 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9941812515165688, 'loss_val': 0.049881463042456914, 'psi': 0.9957362213877093}-{'f1_val': 0.9967728679684698, 'auprc': 0.997450196372059, 'loss_val': 0.04753179896984695, 'psi': 0.9970437993299055}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.651551 cos_to_last_merge=0.8995 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.900
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7890125222848104, 'auprc': 0.8079213058983938, 'loss_val': 0.5724140157075139, 'psi': 0.7965760357302438}-{'f1_val': 0.8030667882508455, 'auprc': 0.9605311817819512, 'loss_val': 0.4360154680886843, 'psi': 0.8660525456632877}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.465059 cos_to_last_merge=0.8828 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.883
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.582541091891736, 'auprc': 0.7926635567600115, 'loss_val': 0.7904893081593435, 'psi': 0.6665900778390461}-{'f1_val': 0.6081698361824, 'auprc': 0.7957808304347055, 'loss_val': 0.6703285803076792, 'psi': 0.6832142338833223}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.869283 cos_to_last_merge=0.9616 (last merge round=13)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9903754849676576, 'auprc': 0.9993872744829881, 'loss_val': 0.04112659728558578, 'psi': 0.9939802007737898}-{'f1_val': 0.9925380579155019, 'auprc': 0.9993019382096924, 'loss_val': 0.03582447207009446, 'psi': 0.9952436100331781}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.744127 cos_to_last_merge=0.9456 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=45 local utility u=0.002316 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.998760664809189, 'loss_val': 0.023213192662180075, 'psi': 0.9970002969421868}-{'f1_val': 0.9966605118138915, 'auprc': 0.9954204731574638, 'loss_val': 0.02282663715207854, 'psi': 0.9961644963513204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=45 head_norm_before_train=1.823141 cos_to_last_merge=0.9288 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935184476042341, 'loss_val': 0.029978837577413413, 'psi': 0.9945200824533185}-{'f1_val': 0.9951878390193748, 'auprc': 0.9943455189707798, 'loss_val': 0.029008158019325842, 'psi': 0.9948509109999368}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.147366 (no previous merge yet)
[S11] round=45 local utility u=0.175016 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990260519669846, 'loss_val': 0.017674690427456747, 'psi': 0.997395871557015}-{'f1_val': 0.9568391236785743, 'auprc': 0.999377720042373, 'loss_val': 0.1319414653371263, 'psi': 0.9738545622240938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=45 head_norm_before_train=1.749002 (no previous merge yet)
[S13] round=45 local utility u=0.030834 metrics={'f1_val': 0.6051580731938537, 'auprc': 0.684764526738763, 'loss_val': 0.7164487281568521, 'psi': 0.6370006546118174}-{'f1_val': 0.592843814028617, 'auprc': 0.688222865994421, 'loss_val': 0.7146066620990938, 'psi': 0.6309954348149386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=45 head_norm_before_train=1.923597 cos_to_last_merge=0.9808 (last merge round=17)
[S14] round=45 local utility u=0.001590 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.9992321294845486, 'loss_val': 0.02002900375994113, 'psi': 0.9985184949078743}-{'f1_val': 0.9976538428159559, 'auprc': 0.9992318513061941, 'loss_val': 0.020874023524353625, 'psi': 0.9982850462120512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=45 head_norm_before_train=1.659710 cos_to_last_merge=0.9348 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.9917320448074488, 'auprc': 0.9938985390552109, 'loss_val': 0.04777830048454538, 'psi': 0.9925986425065536}-{'f1_val': 0.700681726646837, 'auprc': 0.8000371654754783, 'loss_val': 0.5513661741333918, 'psi': 0.7404239021782936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=45 head_norm_before_train=1.739854 cos_to_last_merge=0.9388 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.939
[S16] round=45 local utility u=0.468803 metrics={'f1_val': 0.9377841532890213, 'auprc': 0.9952465065994249, 'loss_val': 0.285137114385962, 'psi': 0.9607690946131828}-{'f1_val': 0.8616365823149693, 'auprc': 0.9938459543833985, 'loss_val': 0.7616562897953367, 'psi': 0.914520331142341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=45 head_norm_before_train=1.451681 cos_to_last_merge=0.9183 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.918
[S17] round=45 local utility u=0.519730 metrics={'f1_val': 0.6008330525094823, 'auprc': 0.79991938482824, 'loss_val': 1.0923711929412983, 'psi': 0.6804675854369854}-{'f1_val': 0.42137471177596464, 'auprc': 0.8209992934951993, 'loss_val': 1.1183202870420046, 'psi': 0.5812245444636586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=46 head_norm_before_train=1.756517 cos_to_last_merge=0.7381 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.738
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7060550902601179, 'auprc': 0.7974251680640342, 'loss_val': 0.8125291330933273, 'psi': 0.7426031213816844}-{'f1_val': 0.708298828138041, 'auprc': 0.8004909747860992, 'loss_val': 0.7945622291053611, 'psi': 0.7451756867972643}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.928969 cos_to_last_merge=0.9426 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9636186994990352, 'auprc': 0.9945009846951407, 'loss_val': 0.08383613128354492, 'psi': 0.9759716135774774}-{'f1_val': 0.9771808579818404, 'auprc': 0.9983850391578619, 'loss_val': 0.06212350667547036, 'psi': 0.9856625304522489}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.558076 cos_to_last_merge=0.8887 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.889
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9420963986099459, 'auprc': 0.9632072138481904, 'loss_val': 0.296398041138304, 'psi': 0.9505407247052438}-{'f1_val': 0.9441122085775551, 'auprc': 0.9625086576040154, 'loss_val': 0.29025941627522445, 'psi': 0.9514707881881391}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.901152 (no previous merge yet)
[S5] round=46 local utility u=0.001300 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9947145461861622, 'loss_val': 0.046246822855092226, 'psi': 0.995686105652599}-{'f1_val': 0.9967728679684698, 'auprc': 0.9941812515165688, 'loss_val': 0.049881463042456914, 'psi': 0.9957362213877093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=46 head_norm_before_train=1.662848 cos_to_last_merge=0.8982 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6500468934352094, 'auprc': 0.8592309369616546, 'loss_val': 0.8015906401953834, 'psi': 0.7337205108457875}-{'f1_val': 0.7890125222848104, 'auprc': 0.8079213058983938, 'loss_val': 0.5724140157075139, 'psi': 0.7965760357302438}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.476125 cos_to_last_merge=0.8808 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.881
[S7] round=46 local utility u=0.518963 metrics={'f1_val': 0.6739198790724408, 'auprc': 0.8327878065066967, 'loss_val': 0.4212095183804291, 'psi': 0.7374670500461431}-{'f1_val': 0.582541091891736, 'auprc': 0.7926635567600115, 'loss_val': 0.7904893081593435, 'psi': 0.6665900778390461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=46 head_norm_before_train=1.874685 cos_to_last_merge=0.9610 (last merge round=13)
[S8] round=46 local utility u=0.012113 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9993777840660389, 'loss_val': 0.03422340907306145, 'psi': 0.9957115155473395}-{'f1_val': 0.9903754849676576, 'auprc': 0.9993872744829881, 'loss_val': 0.04112659728558578, 'psi': 0.9939802007737898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=46 head_norm_before_train=1.753496 cos_to_last_merge=0.9445 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=46 local utility u=0.004646 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9989793430357076, 'loss_val': 0.02204515371183004, 'psi': 0.9978345851359032}-{'f1_val': 0.9958267183641853, 'auprc': 0.998760664809189, 'loss_val': 0.023213192662180075, 'psi': 0.9970002969421868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=46 head_norm_before_train=1.834024 cos_to_last_merge=0.9277 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9948760133586004, 'auprc': 0.9935392220242802, 'loss_val': 0.029547004212015855, 'psi': 0.9943412968248724}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935184476042341, 'loss_val': 0.029978837577413413, 'psi': 0.9945200824533185}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.153584 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9288904818961881, 'auprc': 0.9903967330084014, 'loss_val': 0.36054636856921324, 'psi': 0.9534929823410734}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990260519669846, 'loss_val': 0.017674690427456747, 'psi': 0.997395871557015}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.755290 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5387316300819085, 'auprc': 0.6958746059605421, 'loss_val': 0.9163180109269758, 'psi': 0.6015888204333619}-{'f1_val': 0.6051580731938537, 'auprc': 0.684764526738763, 'loss_val': 0.7164487281568521, 'psi': 0.6370006546118174}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.934346 cos_to_last_merge=0.9803 (last merge round=17)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9342591273140564, 'auprc': 0.9964087138227291, 'loss_val': 0.13276788028293438, 'psi': 0.9591189619175255}-{'f1_val': 0.9980427385234248, 'auprc': 0.9992321294845486, 'loss_val': 0.02002900375994113, 'psi': 0.9985184949078743}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.666882 cos_to_last_merge=0.9341 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=46 local utility u=0.012236 metrics={'f1_val': 0.9942125016969205, 'auprc': 0.9983050462865596, 'loss_val': 0.05140934210826525, 'psi': 0.9958495195327761}-{'f1_val': 0.9917320448074488, 'auprc': 0.9938985390552109, 'loss_val': 0.04777830048454538, 'psi': 0.9925986425065536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=46 head_norm_before_train=1.747831 cos_to_last_merge=0.9378 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8309045139542499, 'auprc': 0.8612002871681274, 'loss_val': 1.1363016568130677, 'psi': 0.8430228232398009}-{'f1_val': 0.9377841532890213, 'auprc': 0.9952465065994249, 'loss_val': 0.285137114385962, 'psi': 0.9607690946131828}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.460365 cos_to_last_merge=0.9168 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.917
[S17] round=46 local utility u=0.204797 metrics={'f1_val': 0.6508349754583969, 'auprc': 0.826010068542902, 'loss_val': 1.0610601170291494, 'psi': 0.720905012692199}-{'f1_val': 0.6008330525094823, 'auprc': 0.79991938482824, 'loss_val': 1.0923711929412983, 'psi': 0.6804675854369854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=47 head_norm_before_train=1.767722 cos_to_last_merge=0.7369 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.737
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6822612429479187, 'auprc': 0.7904929333504968, 'loss_val': 0.8052082392251165, 'psi': 0.72555391910895}-{'f1_val': 0.7060550902601179, 'auprc': 0.7974251680640342, 'loss_val': 0.8125291330933273, 'psi': 0.7426031213816844}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.933912 cos_to_last_merge=0.9419 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9980149973322502, 'loss_val': 0.1031729894697282, 'psi': 0.9758271495961662}-{'f1_val': 0.9636186994990352, 'auprc': 0.9945009846951407, 'loss_val': 0.08383613128354492, 'psi': 0.9759716135774774}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.566975 cos_to_last_merge=0.8874 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.887
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9404780107979094, 'auprc': 0.961809485762476, 'loss_val': 0.30850722197223585, 'psi': 0.949010600783736}-{'f1_val': 0.9420963986099459, 'auprc': 0.9632072138481904, 'loss_val': 0.296398041138304, 'psi': 0.9505407247052438}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.910286 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9931669035598794, 'loss_val': 0.05086567565644678, 'psi': 0.9950670486020858}-{'f1_val': 0.9963338119635569, 'auprc': 0.9947145461861622, 'loss_val': 0.046246822855092226, 'psi': 0.995686105652599}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.670695 cos_to_last_merge=0.8969 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.897
[S6] round=47 local utility u=0.944568 metrics={'f1_val': 0.8468756734733317, 'auprc': 0.9603043904749285, 'loss_val': 0.39664783711835366, 'psi': 0.8922471602739704}-{'f1_val': 0.6500468934352094, 'auprc': 0.8592309369616546, 'loss_val': 0.8015906401953834, 'psi': 0.7337205108457875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=47 head_norm_before_train=1.486463 cos_to_last_merge=0.8790 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.879
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5604857927839443, 'auprc': 0.7879838896565252, 'loss_val': 0.8732756818924925, 'psi': 0.6514850315329767}-{'f1_val': 0.6739198790724408, 'auprc': 0.8327878065066967, 'loss_val': 0.4212095183804291, 'psi': 0.7374670500461431}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.881130 cos_to_last_merge=0.9604 (last merge round=13)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9896558900940475, 'auprc': 0.9993852635348252, 'loss_val': 0.041380807737900684, 'psi': 0.9935476394703586}-{'f1_val': 0.9932673365348732, 'auprc': 0.9993777840660389, 'loss_val': 0.03422340907306145, 'psi': 0.9957115155473395}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.761234 cos_to_last_merge=0.9434 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.943
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9926427111556573, 'loss_val': 0.02327076098482535, 'psi': 0.9948071413298295}-{'f1_val': 0.9970714132027002, 'auprc': 0.9989793430357076, 'loss_val': 0.02204515371183004, 'psi': 0.9978345851359032}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.845079 cos_to_last_merge=0.9265 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=47 local utility u=0.001057 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935564237004872, 'loss_val': 0.029354894744658775, 'psi': 0.9945352728918198}-{'f1_val': 0.9948760133586004, 'auprc': 0.9935392220242802, 'loss_val': 0.029547004212015855, 'psi': 0.9943412968248724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=47 head_norm_before_train=2.158218 (no previous merge yet)
[S11] round=47 local utility u=0.386145 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990312563403959, 'loss_val': 0.018671500665889598, 'psi': 0.9973979533063795}-{'f1_val': 0.9288904818961881, 'auprc': 0.9903967330084014, 'loss_val': 0.36054636856921324, 'psi': 0.9534929823410734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=47 head_norm_before_train=1.760241 (no previous merge yet)
[S13] round=47 local utility u=0.277568 metrics={'f1_val': 0.5931106954157397, 'auprc': 0.68825339009794, 'loss_val': 0.6645922230383545, 'psi': 0.6311677732886198}-{'f1_val': 0.5387316300819085, 'auprc': 0.6958746059605421, 'loss_val': 0.9163180109269758, 'psi': 0.6015888204333619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=47 head_norm_before_train=1.942888 cos_to_last_merge=0.9797 (last merge round=17)
[S14] round=47 local utility u=0.251401 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.99923243947364, 'loss_val': 0.01981375419678462, 'psi': 0.9983860314021115}-{'f1_val': 0.9342591273140564, 'auprc': 0.9964087138227291, 'loss_val': 0.13276788028293438, 'psi': 0.9591189619175255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=47 head_norm_before_train=1.675785 cos_to_last_merge=0.9331 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8946363857611099, 'auprc': 0.9947878162592261, 'loss_val': 0.17180712767364037, 'psi': 0.9346969579603563}-{'f1_val': 0.9942125016969205, 'auprc': 0.9983050462865596, 'loss_val': 0.05140934210826525, 'psi': 0.9958495195327761}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.755011 cos_to_last_merge=0.9368 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.937
[S16] round=47 local utility u=0.545431 metrics={'f1_val': 0.8740858695357812, 'auprc': 0.984952549683414, 'loss_val': 0.675784104353016, 'psi': 0.9184325415948342}-{'f1_val': 0.8309045139542499, 'auprc': 0.8612002871681274, 'loss_val': 1.1363016568130677, 'psi': 0.8430228232398009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=47 head_norm_before_train=1.474930 cos_to_last_merge=0.9148 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.915
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.556671974422966, 'auprc': 0.7963676031284957, 'loss_val': 1.0712187096591028, 'psi': 0.6525502259051779}-{'f1_val': 0.6508349754583969, 'auprc': 0.826010068542902, 'loss_val': 1.0610601170291494, 'psi': 0.720905012692199}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.778429 cos_to_last_merge=0.7358 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.736
[S2] round=48 local utility u=0.033282 metrics={'f1_val': 0.695863961267158, 'auprc': 0.7906908402687719, 'loss_val': 0.820855160439722, 'psi': 0.7337947128678035}-{'f1_val': 0.6822612429479187, 'auprc': 0.7904929333504968, 'loss_val': 0.8052082392251165, 'psi': 0.72555391910895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=48 head_norm_before_train=1.942717 cos_to_last_merge=0.9410 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9567243142638624, 'auprc': 0.9933611011131962, 'loss_val': 0.12534478855496312, 'psi': 0.971379029003596}-{'f1_val': 0.9610352511054436, 'auprc': 0.9980149973322502, 'loss_val': 0.1031729894697282, 'psi': 0.9758271495961662}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.571536 cos_to_last_merge=0.8863 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.886
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9396344340652866, 'auprc': 0.962831768053932, 'loss_val': 0.31953472911542913, 'psi': 0.9489133676607449}-{'f1_val': 0.9404780107979094, 'auprc': 0.961809485762476, 'loss_val': 0.30850722197223585, 'psi': 0.949010600783736}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.917584 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.7148616753480442, 'auprc': 0.9891891624726125, 'loss_val': 0.467674040448528, 'psi': 0.8245926701978715}-{'f1_val': 0.9963338119635569, 'auprc': 0.9931669035598794, 'loss_val': 0.05086567565644678, 'psi': 0.9950670486020858}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.678255 cos_to_last_merge=0.8949 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.895
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.815335047339963, 'auprc': 0.816422085434205, 'loss_val': 0.5252067423742203, 'psi': 0.8157698625776598}-{'f1_val': 0.8468756734733317, 'auprc': 0.9603043904749285, 'loss_val': 0.39664783711835366, 'psi': 0.8922471602739704}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.492495 cos_to_last_merge=0.8779 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.878
[S7] round=48 local utility u=0.617993 metrics={'f1_val': 0.6714591632225119, 'auprc': 0.8261277184742639, 'loss_val': 0.41756114172537506, 'psi': 0.7333265853232127}-{'f1_val': 0.5604857927839443, 'auprc': 0.7879838896565252, 'loss_val': 0.8732756818924925, 'psi': 0.6514850315329767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=48 head_norm_before_train=1.889103 cos_to_last_merge=0.9598 (last merge round=13)
[S8] round=48 local utility u=0.015740 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9993244046099757, 'loss_val': 0.0335340458331507, 'psi': 0.9959049641126883}-{'f1_val': 0.9896558900940475, 'auprc': 0.9993852635348252, 'loss_val': 0.041380807737900684, 'psi': 0.9935476394703586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=48 head_norm_before_train=1.769457 cos_to_last_merge=0.9424 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=48 local utility u=0.007567 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9982351428507635, 'loss_val': 0.022373722273709637, 'psi': 0.9967900881588166}-{'f1_val': 0.9962500947792776, 'auprc': 0.9926427111556573, 'loss_val': 0.02327076098482535, 'psi': 0.9948071413298295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=48 head_norm_before_train=1.852358 cos_to_last_merge=0.9257 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=48 local utility u=0.001200 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9934952437493008, 'loss_val': 0.02662467656096924, 'psi': 0.994496078727893}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935564237004872, 'loss_val': 0.029354894744658775, 'psi': 0.9945352728918198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=48 head_norm_before_train=2.161186 (no previous merge yet)
[S11] round=48 local utility u=0.001388 metrics={'f1_val': 0.9963100190352135, 'auprc': 0.9994047269163229, 'loss_val': 0.01702108155226074, 'psi': 0.9975479021876572}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990312563403959, 'loss_val': 0.018671500665889598, 'psi': 0.9973979533063795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=48 head_norm_before_train=1.764354 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5757502461673181, 'auprc': 0.6985004990052764, 'loss_val': 0.7794592835421186, 'psi': 0.6248503473025014}-{'f1_val': 0.5931106954157397, 'auprc': 0.68825339009794, 'loss_val': 0.6645922230383545, 'psi': 0.6311677732886198}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.951532 cos_to_last_merge=0.9792 (last merge round=17)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9956580293369102, 'loss_val': 0.02217138811880632, 'psi': 0.9964636396633108}-{'f1_val': 0.9978217593544257, 'auprc': 0.99923243947364, 'loss_val': 0.01981375419678462, 'psi': 0.9983860314021115}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.686390 cos_to_last_merge=0.9321 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7634849572531532, 'auprc': 0.9917885442380455, 'loss_val': 0.43941309280777713, 'psi': 0.8548063920471102}-{'f1_val': 0.8946363857611099, 'auprc': 0.9947878162592261, 'loss_val': 0.17180712767364037, 'psi': 0.9346969579603563}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.763582 cos_to_last_merge=0.9358 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.936
[S16] round=48 local utility u=0.567832 metrics={'f1_val': 0.9663166252932958, 'auprc': 0.9911803056478318, 'loss_val': 0.11218876457607763, 'psi': 0.9762620974351102}-{'f1_val': 0.8740858695357812, 'auprc': 0.984952549683414, 'loss_val': 0.675784104353016, 'psi': 0.9184325415948342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=48 head_norm_before_train=1.490746 cos_to_last_merge=0.9123 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.912
[S17] round=48 local utility u=0.230752 metrics={'f1_val': 0.6187977693597797, 'auprc': 0.8159897025355706, 'loss_val': 1.0413358311025973, 'psi': 0.6976745426300961}-{'f1_val': 0.556671974422966, 'auprc': 0.7963676031284957, 'loss_val': 1.0712187096591028, 'psi': 0.6525502259051779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=49 head_norm_before_train=1.789404 cos_to_last_merge=0.7347 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.735
[S2] round=49 local utility u=0.057009 metrics={'f1_val': 0.7133945824912833, 'auprc': 0.8177255348016924, 'loss_val': 0.8931253493120688, 'psi': 0.7551269634154469}-{'f1_val': 0.695863961267158, 'auprc': 0.7906908402687719, 'loss_val': 0.820855160439722, 'psi': 0.7337947128678035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=49 head_norm_before_train=1.953430 cos_to_last_merge=0.9399 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.911679217920975, 'auprc': 0.9867696846265464, 'loss_val': 0.22013356248050361, 'psi': 0.9417154046032035}-{'f1_val': 0.9567243142638624, 'auprc': 0.9933611011131962, 'loss_val': 0.12534478855496312, 'psi': 0.971379029003596}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.573881 cos_to_last_merge=0.8858 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.886
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9386954287208211, 'auprc': 0.959065231670566, 'loss_val': 0.34608791116689125, 'psi': 0.9468433499007191}-{'f1_val': 0.9396344340652866, 'auprc': 0.962831768053932, 'loss_val': 0.31953472911542913, 'psi': 0.9489133676607449}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.924839 (no previous merge yet)
[S5] round=49 local utility u=1.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9989140926626465, 'loss_val': 0.04427712815657141, 'psi': 0.9978502542658336}-{'f1_val': 0.7148616753480442, 'auprc': 0.9891891624726125, 'loss_val': 0.467674040448528, 'psi': 0.8245926701978715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=49 head_norm_before_train=1.685994 cos_to_last_merge=0.8933 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.893
[S6] round=49 local utility u=0.891700 metrics={'f1_val': 0.9683947639423267, 'auprc': 0.9785522520460249, 'loss_val': 0.1465556861727221, 'psi': 0.972457759183806}-{'f1_val': 0.815335047339963, 'auprc': 0.816422085434205, 'loss_val': 0.5252067423742203, 'psi': 0.8157698625776598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=49 head_norm_before_train=1.496216 cos_to_last_merge=0.8775 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=49 local utility u=1.000000 metrics={'f1_val': 0.9895151781943305, 'auprc': 0.982963313628207, 'loss_val': 0.19471930205998136, 'psi': 0.9868944323678811}-{'f1_val': 0.6714591632225119, 'auprc': 0.8261277184742639, 'loss_val': 0.41756114172537506, 'psi': 0.7333265853232127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=49 head_norm_before_train=1.896654 cos_to_last_merge=0.9594 (last merge round=13)
[S8] round=49 local utility u=0.002591 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9994000748012082, 'loss_val': 0.030819565729133556, 'psi': 0.9961593223405749}-{'f1_val': 0.9936253371144965, 'auprc': 0.9993244046099757, 'loss_val': 0.0335340458331507, 'psi': 0.9959049641126883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=49 head_norm_before_train=1.776606 cos_to_last_merge=0.9419 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9811149427031223, 'auprc': 0.9982083990121186, 'loss_val': 0.06319405629129869, 'psi': 0.9879523252267208}-{'f1_val': 0.9958267183641853, 'auprc': 0.9982351428507635, 'loss_val': 0.022373722273709637, 'psi': 0.9967900881588166}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.860532 cos_to_last_merge=0.9248 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=49 local utility u=0.000701 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9943545985861506, 'loss_val': 0.027947537187829025, 'psi': 0.9948545428460851}-{'f1_val': 0.9951633020469546, 'auprc': 0.9934952437493008, 'loss_val': 0.02662467656096924, 'psi': 0.994496078727893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=49 head_norm_before_train=2.164795 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9957836393690515, 'auprc': 0.9994110735896936, 'loss_val': 0.020147880199416157, 'psi': 0.9972346130573084}-{'f1_val': 0.9963100190352135, 'auprc': 0.9994047269163229, 'loss_val': 0.01702108155226074, 'psi': 0.9975479021876572}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.771696 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5822822106249036, 'auprc': 0.6910319207643847, 'loss_val': 0.8428143206109314, 'psi': 0.625782094680696}-{'f1_val': 0.5757502461673181, 'auprc': 0.6985004990052764, 'loss_val': 0.7794592835421186, 'psi': 0.6248503473025014}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.957916 cos_to_last_merge=0.9787 (last merge round=17)
[S14] round=49 local utility u=0.006113 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9988551554233062, 'loss_val': 0.021850046116068503, 'psi': 0.9979738191580714}-{'f1_val': 0.9970007132142444, 'auprc': 0.9956580293369102, 'loss_val': 0.02217138811880632, 'psi': 0.9964636396633108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=49 head_norm_before_train=1.698397 cos_to_last_merge=0.9310 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7033226825503546, 'auprc': 0.9912037383080649, 'loss_val': 0.49234487229003815, 'psi': 0.8184751048534387}-{'f1_val': 0.7634849572531532, 'auprc': 0.9917885442380455, 'loss_val': 0.43941309280777713, 'psi': 0.8548063920471102}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.772608 cos_to_last_merge=0.9348 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.935
[S16] round=49 local utility u=0.112660 metrics={'f1_val': 0.991732506425948, 'auprc': 0.9915811705026483, 'loss_val': 0.04056605410202737, 'psi': 0.9916719720566282}-{'f1_val': 0.9663166252932958, 'auprc': 0.9911803056478318, 'loss_val': 0.11218876457607763, 'psi': 0.9762620974351102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=49 head_norm_before_train=1.504893 cos_to_last_merge=0.9101 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.910
[S17] round=49 local utility u=0.081677 metrics={'f1_val': 0.6303530635998378, 'auprc': 0.8105829089201434, 'loss_val': 0.9310934795883116, 'psi': 0.70244500172796}-{'f1_val': 0.6187977693597797, 'auprc': 0.8159897025355706, 'loss_val': 1.0413358311025973, 'psi': 0.6976745426300961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=50 head_norm_before_train=1.799010 cos_to_last_merge=0.7337 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.734
[S2] round=50 local utility u=0.000452 metrics={'f1_val': 0.7130394772255445, 'auprc': 0.8057321236274196, 'loss_val': 0.8541104009657676, 'psi': 0.7501165357862946}-{'f1_val': 0.7133945824912833, 'auprc': 0.8177255348016924, 'loss_val': 0.8931253493120688, 'psi': 0.7551269634154469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=50 head_norm_before_train=1.963564 cos_to_last_merge=0.9387 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.8972665059793136, 'auprc': 0.9893203229478864, 'loss_val': 0.2565156626191871, 'psi': 0.9340880327667427}-{'f1_val': 0.911679217920975, 'auprc': 0.9867696846265464, 'loss_val': 0.22013356248050361, 'psi': 0.9417154046032035}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.577330 cos_to_last_merge=0.8850 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.885
[S4] round=50 local utility u=0.022198 metrics={'f1_val': 0.9400648738153536, 'auprc': 0.959275270876103, 'loss_val': 0.3105391800011598, 'psi': 0.9477490326396534}-{'f1_val': 0.9386954287208211, 'auprc': 0.959065231670566, 'loss_val': 0.34608791116689125, 'psi': 0.9468433499007191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=50 head_norm_before_train=1.929231 (no previous merge yet)
[S5] round=50 local utility u=0.006952 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.999559740960455, 'loss_val': 0.03231005830994264, 'psi': 0.998108513584957}-{'f1_val': 0.9971410286679584, 'auprc': 0.9989140926626465, 'loss_val': 0.04427712815657141, 'psi': 0.9978502542658336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=50 head_norm_before_train=1.695613 cos_to_last_merge=0.8923 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.892
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.7450939338075349, 'auprc': 0.8253527871705029, 'loss_val': 0.6861130868794555, 'psi': 0.7771974751527221}-{'f1_val': 0.9683947639423267, 'auprc': 0.9785522520460249, 'loss_val': 0.1465556861727221, 'psi': 0.972457759183806}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=50 head_norm_before_train=1.499975 cos_to_last_merge=0.8770 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.4605593869336225, 'auprc': 0.7806039805357117, 'loss_val': 1.0377535387630958, 'psi': 0.5885772243744583}-{'f1_val': 0.9895151781943305, 'auprc': 0.982963313628207, 'loss_val': 0.19471930205998136, 'psi': 0.9868944323678811}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=1.904075 cos_to_last_merge=0.9589 (last merge round=13)
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9993994873655045, 'loss_val': 0.032750541827987784, 'psi': 0.9955012485053875}-{'f1_val': 0.9939988207001527, 'auprc': 0.9994000748012082, 'loss_val': 0.030819565729133556, 'psi': 0.9961593223405749}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=50 head_norm_before_train=1.784667 cos_to_last_merge=0.9413 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.941
[S9] round=50 local utility u=0.057031 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9925016373244058, 'loss_val': 0.02282318487529597, 'psi': 0.9947507117973289}-{'f1_val': 0.9811149427031223, 'auprc': 0.9982083990121186, 'loss_val': 0.06319405629129869, 'psi': 0.9879523252267208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=50 head_norm_before_train=1.869357 cos_to_last_merge=0.9239 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=50 local utility u=0.002247 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995410951363927, 'loss_val': 0.02662193857100361, 'psi': 0.9952770839571956}-{'f1_val': 0.9951878390193748, 'auprc': 0.9943545985861506, 'loss_val': 0.027947537187829025, 'psi': 0.9948545428460851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=50 head_norm_before_train=2.170475 (no previous merge yet)
[S11] round=50 local utility u=0.005532 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.999411868141094, 'loss_val': 0.016311917964890867, 'psi': 0.997957458110967}-{'f1_val': 0.9957836393690515, 'auprc': 0.9994110735896936, 'loss_val': 0.020147880199416157, 'psi': 0.9972346130573084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=50 head_norm_before_train=1.779017 (no previous merge yet)
[S13] round=50 local utility u=0.195618 metrics={'f1_val': 0.609956585780725, 'auprc': 0.700740108298056, 'loss_val': 0.6467484538846396, 'psi': 0.6462699947876573}-{'f1_val': 0.5822822106249036, 'auprc': 0.6910319207643847, 'loss_val': 0.8428143206109314, 'psi': 0.625782094680696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=50 head_norm_before_train=1.963157 cos_to_last_merge=0.9784 (last merge round=17)
[S14] round=50 local utility u=0.002320 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992344028844458, 'loss_val': 0.020946993746620412, 'psi': 0.9983854719341093}-{'f1_val': 0.9973862616479148, 'auprc': 0.9988551554233062, 'loss_val': 0.021850046116068503, 'psi': 0.9979738191580714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=50 head_norm_before_train=1.710283 cos_to_last_merge=0.9298 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=50 local utility u=0.262419 metrics={'f1_val': 0.7757793779435571, 'auprc': 0.9932412128687998, 'loss_val': 0.40835860103007804, 'psi': 0.8627641119136542}-{'f1_val': 0.7033226825503546, 'auprc': 0.9912037383080649, 'loss_val': 0.49234487229003815, 'psi': 0.8184751048534387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=50 head_norm_before_train=1.779985 cos_to_last_merge=0.9342 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.934
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.9464975824046484, 'auprc': 0.9882978191904879, 'loss_val': 0.129226115849112, 'psi': 0.9632176771189842}-{'f1_val': 0.991732506425948, 'auprc': 0.9915811705026483, 'loss_val': 0.04056605410202737, 'psi': 0.9916719720566282}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.523054 cos_to_last_merge=0.9077 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.908
[S17] round=50 local utility u=0.028075 metrics={'f1_val': 0.6310835638637001, 'auprc': 0.8137287058211432, 'loss_val': 0.8887635535787592, 'psi': 0.7041416206466774}-{'f1_val': 0.6303530635998378, 'auprc': 0.8105829089201434, 'loss_val': 0.9310934795883116, 'psi': 0.70244500172796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=51 head_norm_before_train=1.807448 cos_to_last_merge=0.7327 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.733
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.719699850108627, 'auprc': 0.7668585751384781, 'loss_val': 0.9734257919553282, 'psi': 0.7385633401205676}-{'f1_val': 0.7130394772255445, 'auprc': 0.8057321236274196, 'loss_val': 0.8541104009657676, 'psi': 0.7501165357862946}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=1.975427 cos_to_last_merge=0.9374 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=51 local utility u=0.308952 metrics={'f1_val': 0.9674577707547323, 'auprc': 0.9961595032560515, 'loss_val': 0.08027690894963863, 'psi': 0.97893846375526}-{'f1_val': 0.8972665059793136, 'auprc': 0.9893203229478864, 'loss_val': 0.2565156626191871, 'psi': 0.9340880327667427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=51 head_norm_before_train=1.582774 cos_to_last_merge=0.8842 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.884
[S4] round=51 local utility u=0.010017 metrics={'f1_val': 0.9418725912695012, 'auprc': 0.9590430322127821, 'loss_val': 0.30065484149777805, 'psi': 0.9487407676468136}-{'f1_val': 0.9400648738153536, 'auprc': 0.959275270876103, 'loss_val': 0.3105391800011598, 'psi': 0.9477490326396534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=51 head_norm_before_train=1.933068 (no previous merge yet)
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9952140428073086, 'loss_val': 0.03751894047164358, 'psi': 0.9958859043010575}-{'f1_val': 0.9971410286679584, 'auprc': 0.999559740960455, 'loss_val': 0.03231005830994264, 'psi': 0.998108513584957}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.704910 cos_to_last_merge=0.8913 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=51 local utility u=0.644496 metrics={'f1_val': 0.8373040133742948, 'auprc': 0.95173634446568, 'loss_val': 0.32953180406464005, 'psi': 0.883076945810849}-{'f1_val': 0.7450939338075349, 'auprc': 0.8253527871705029, 'loss_val': 0.6861130868794555, 'psi': 0.7771974751527221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=51 head_norm_before_train=1.501792 cos_to_last_merge=0.8768 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=51 local utility u=1.000000 metrics={'f1_val': 0.6945421644500919, 'auprc': 0.8488531616158481, 'loss_val': 0.3135709568331118, 'psi': 0.7562665633163943}-{'f1_val': 0.4605593869336225, 'auprc': 0.7806039805357117, 'loss_val': 1.0377535387630958, 'psi': 0.5885772243744583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=51 head_norm_before_train=1.910072 cos_to_last_merge=0.9583 (last merge round=13)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9991528468337433, 'loss_val': 0.0350356218039742, 'psi': 0.9945300816593334}-{'f1_val': 0.9929024225986427, 'auprc': 0.9993994873655045, 'loss_val': 0.032750541827987784, 'psi': 0.9955012485053875}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=1.791574 cos_to_last_merge=0.9408 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.941
[S9] round=51 local utility u=0.007526 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9982548065734252, 'loss_val': 0.022491248879315355, 'psi': 0.9967979536478814}-{'f1_val': 0.9962500947792776, 'auprc': 0.9925016373244058, 'loss_val': 0.02282318487529597, 'psi': 0.9947507117973289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=51 head_norm_before_train=1.878466 cos_to_last_merge=0.9231 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9958501918595417, 'loss_val': 0.02572838582056784, 'psi': 0.9951892422754403}-{'f1_val': 0.9951878390193748, 'auprc': 0.995410951363927, 'loss_val': 0.02662193857100361, 'psi': 0.9952770839571956}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=2.176934 (no previous merge yet)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.999411546085044, 'loss_val': 0.01643612146602176, 'psi': 0.9979573292885471}-{'f1_val': 0.9969878514242156, 'auprc': 0.999411868141094, 'loss_val': 0.016311917964890867, 'psi': 0.997957458110967}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=51 head_norm_before_train=1.786846 (no previous merge yet)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.5975970672908077, 'auprc': 0.7133030610495711, 'loss_val': 0.8366476422272103, 'psi': 0.6438794647943131}-{'f1_val': 0.609956585780725, 'auprc': 0.700740108298056, 'loss_val': 0.6467484538846396, 'psi': 0.6462699947876573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=1.968567 cos_to_last_merge=0.9782 (last merge round=17)
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9975385394847059, 'loss_val': 0.021727458766460882, 'psi': 0.997458733625473}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992344028844458, 'loss_val': 0.020946993746620412, 'psi': 0.9983854719341093}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=51 head_norm_before_train=1.722453 cos_to_last_merge=0.9287 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=51 local utility u=0.483431 metrics={'f1_val': 0.8962137641336145, 'auprc': 0.99632270422549, 'loss_val': 0.17334789355044955, 'psi': 0.9362573401703647}-{'f1_val': 0.7757793779435571, 'auprc': 0.9932412128687998, 'loss_val': 0.40835860103007804, 'psi': 0.8627641119136542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=51 head_norm_before_train=1.785877 cos_to_last_merge=0.9336 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.934
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.8816191046937929, 'auprc': 0.8857736168356162, 'loss_val': 0.6393762055259837, 'psi': 0.8832809095505222}-{'f1_val': 0.9464975824046484, 'auprc': 0.9882978191904879, 'loss_val': 0.129226115849112, 'psi': 0.9632176771189842}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=1.543955 cos_to_last_merge=0.9046 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.905
[S17] round=51 local utility u=0.287777 metrics={'f1_val': 0.6738535292275717, 'auprc': 0.8649071394692814, 'loss_val': 0.7233650155764471, 'psi': 0.7502749733242555}-{'f1_val': 0.6310835638637001, 'auprc': 0.8137287058211432, 'loss_val': 0.8887635535787592, 'psi': 0.7041416206466774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=52 head_norm_before_train=1.815200 cos_to_last_merge=0.7319 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.732
[S2] round=52 local utility u=0.108688 metrics={'f1_val': 0.7108983033129959, 'auprc': 0.803397496504384, 'loss_val': 0.8128579943614245, 'psi': 0.7478979805895511}-{'f1_val': 0.719699850108627, 'auprc': 0.7668585751384781, 'loss_val': 0.9734257919553282, 'psi': 0.7385633401205676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=52 head_norm_before_train=1.988121 cos_to_last_merge=0.9363 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=52 local utility u=0.065587 metrics={'f1_val': 0.983004208656469, 'auprc': 0.9983844275018248, 'loss_val': 0.04905599545797317, 'psi': 0.9891562961946112}-{'f1_val': 0.9674577707547323, 'auprc': 0.9961595032560515, 'loss_val': 0.08027690894963863, 'psi': 0.97893846375526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=52 head_norm_before_train=1.587153 cos_to_last_merge=0.8833 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.883
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9399403836301938, 'auprc': 0.9489645758142097, 'loss_val': 0.3123570225145365, 'psi': 0.9435500605038001}-{'f1_val': 0.9418725912695012, 'auprc': 0.9590430322127821, 'loss_val': 0.30065484149777805, 'psi': 0.9487407676468136}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.937531 (no previous merge yet)
[S5] round=52 local utility u=0.009437 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.998704461575823, 'loss_val': 0.03175045914310606, 'psi': 0.9975455054114111}-{'f1_val': 0.9963338119635569, 'auprc': 0.9952140428073086, 'loss_val': 0.03751894047164358, 'psi': 0.9958859043010575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=52 head_norm_before_train=1.715444 cos_to_last_merge=0.8905 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.8121097078306709, 'auprc': 0.9712484225990964, 'loss_val': 0.4544383989087177, 'psi': 0.8757651937380411}-{'f1_val': 0.8373040133742948, 'auprc': 0.95173634446568, 'loss_val': 0.32953180406464005, 'psi': 0.883076945810849}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.504133 cos_to_last_merge=0.8769 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.5158670204560303, 'auprc': 0.7811003128894044, 'loss_val': 0.9667880230036839, 'psi': 0.62196033742938}-{'f1_val': 0.6945421644500919, 'auprc': 0.8488531616158481, 'loss_val': 0.3135709568331118, 'psi': 0.7562665633163943}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=52 head_norm_before_train=1.915745 cos_to_last_merge=0.9581 (last merge round=13)
[S8] round=52 local utility u=0.007411 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9991718888195937, 'loss_val': 0.031185918894917272, 'psi': 0.9956291574487615}-{'f1_val': 0.9914482382097267, 'auprc': 0.9991528468337433, 'loss_val': 0.0350356218039742, 'psi': 0.9945300816593334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=52 head_norm_before_train=1.794181 cos_to_last_merge=0.9400 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.9989609171688807, 'loss_val': 0.03283187208160238, 'psi': 0.9938055776051284}-{'f1_val': 0.9958267183641853, 'auprc': 0.9982548065734252, 'loss_val': 0.022491248879315355, 'psi': 0.9967979536478814}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=1.887675 cos_to_last_merge=0.9223 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=52 local utility u=0.000516 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959090363656051, 'loss_val': 0.026190273150341906, 'psi': 0.9953445264652878}-{'f1_val': 0.9947486092193725, 'auprc': 0.9958501918595417, 'loss_val': 0.02572838582056784, 'psi': 0.9951892422754403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=52 head_norm_before_train=2.180958 (no previous merge yet)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9948224703548484, 'auprc': 0.9994108205140524, 'loss_val': 0.02368815467175582, 'psi': 0.99665781041853}-{'f1_val': 0.9969878514242156, 'auprc': 0.999411546085044, 'loss_val': 0.01643612146602176, 'psi': 0.9979573292885471}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=1.795261 (no previous merge yet)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.5658189671888052, 'auprc': 0.717258590716598, 'loss_val': 0.9485123418847364, 'psi': 0.6263948165999224}-{'f1_val': 0.5975970672908077, 'auprc': 0.7133030610495711, 'loss_val': 0.8366476422272103, 'psi': 0.6438794647943131}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=1.974657 cos_to_last_merge=0.9779 (last merge round=17)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9975390034162867, 'loss_val': 0.02460312331338284, 'psi': 0.9974589191981053}-{'f1_val': 0.9974055297193176, 'auprc': 0.9975385394847059, 'loss_val': 0.021727458766460882, 'psi': 0.997458733625473}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=1.733751 cos_to_last_merge=0.9275 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=52 local utility u=0.377935 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9981660173078114, 'loss_val': 0.025947784771888673, 'psi': 0.9972885840969778}-{'f1_val': 0.8962137641336145, 'auprc': 0.99632270422549, 'loss_val': 0.17334789355044955, 'psi': 0.9362573401703647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=52 head_norm_before_train=1.792130 cos_to_last_merge=0.9328 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.832029425696474, 'auprc': 0.8905118350517682, 'loss_val': 1.1492377034237828, 'psi': 0.8554223894385917}-{'f1_val': 0.8816191046937929, 'auprc': 0.8857736168356162, 'loss_val': 0.6393762055259837, 'psi': 0.8832809095505222}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.564123 cos_to_last_merge=0.9021 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.902
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.6242257691475314, 'auprc': 0.8269087230341372, 'loss_val': 1.0705341882898716, 'psi': 0.7052989507021736}-{'f1_val': 0.6738535292275717, 'auprc': 0.8649071394692814, 'loss_val': 0.7233650155764471, 'psi': 0.7502749733242555}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=1.823141 cos_to_last_merge=0.7311 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.731
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.6569870210954363, 'auprc': 0.7796193708843097, 'loss_val': 0.9303177690395678, 'psi': 0.7060399610109855}-{'f1_val': 0.7108983033129959, 'auprc': 0.803397496504384, 'loss_val': 0.8128579943614245, 'psi': 0.7478979805895511}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=53 head_norm_before_train=2.000098 cos_to_last_merge=0.9354 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998744975048445, 'loss_val': 0.12161361939605984, 'psi': 0.9761191406826442}-{'f1_val': 0.983004208656469, 'auprc': 0.9983844275018248, 'loss_val': 0.04905599545797317, 'psi': 0.9891562961946112}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.592790 cos_to_last_merge=0.8824 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.882
[S4] round=53 local utility u=0.057182 metrics={'f1_val': 0.9517327346880214, 'auprc': 0.9553193664590176, 'loss_val': 0.2878110118309447, 'psi': 0.9531673873964199}-{'f1_val': 0.9399403836301938, 'auprc': 0.9489645758142097, 'loss_val': 0.3123570225145365, 'psi': 0.9435500605038001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=53 head_norm_before_train=1.945141 (no previous merge yet)
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9958748354827985, 'loss_val': 0.034297615040129646, 'psi': 0.9961502213712534}-{'f1_val': 0.9967728679684698, 'auprc': 0.998704461575823, 'loss_val': 0.03175045914310606, 'psi': 0.9975455054114111}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=1.726203 cos_to_last_merge=0.8895 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.890
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.8041706525756964, 'auprc': 0.966625635168398, 'loss_val': 0.45470187438936155, 'psi': 0.869152645612777}-{'f1_val': 0.8121097078306709, 'auprc': 0.9712484225990964, 'loss_val': 0.4544383989087177, 'psi': 0.8757651937380411}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.506414 cos_to_last_merge=0.8766 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=53 local utility u=1.000000 metrics={'f1_val': 0.7265958285060703, 'auprc': 0.9725092842028409, 'loss_val': 0.2178020156891081, 'psi': 0.8249612107847786}-{'f1_val': 0.5158670204560303, 'auprc': 0.7811003128894044, 'loss_val': 0.9667880230036839, 'psi': 0.62196033742938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=53 head_norm_before_train=1.922557 cos_to_last_merge=0.9578 (last merge round=13)
[S8] round=53 local utility u=0.002659 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9991736230079561, 'loss_val': 0.03026299038866077, 'psi': 0.9960687416232741}-{'f1_val': 0.9932673365348732, 'auprc': 0.9991718888195937, 'loss_val': 0.031185918894917272, 'psi': 0.9956291574487615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=53 head_norm_before_train=1.797615 cos_to_last_merge=0.9391 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.939
[S9] round=53 local utility u=0.022699 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9994254182795814, 'loss_val': 0.021575780319695224, 'psi': 0.9972661983303438}-{'f1_val': 0.9903686845626269, 'auprc': 0.9989609171688807, 'loss_val': 0.03283187208160238, 'psi': 0.9938055776051284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=53 head_norm_before_train=1.896899 cos_to_last_merge=0.9214 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956093290158539, 'loss_val': 0.02626284994966096, 'psi': 0.9952246435253873}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959090363656051, 'loss_val': 0.026190273150341906, 'psi': 0.9953445264652878}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=2.185516 (no previous merge yet)
[S11] round=53 local utility u=0.009316 metrics={'f1_val': 0.9967467623295848, 'auprc': 0.9994103963989334, 'loss_val': 0.01660010247775812, 'psi': 0.9978122159573243}-{'f1_val': 0.9948224703548484, 'auprc': 0.9994108205140524, 'loss_val': 0.02368815467175582, 'psi': 0.99665781041853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=53 head_norm_before_train=1.801035 (no previous merge yet)
[S13] round=53 local utility u=0.117841 metrics={'f1_val': 0.5925085708355646, 'auprc': 0.7157761538991634, 'loss_val': 0.8685200007010351, 'psi': 0.6418156040610041}-{'f1_val': 0.5658189671888052, 'auprc': 0.717258590716598, 'loss_val': 0.9485123418847364, 'psi': 0.6263948165999224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=53 head_norm_before_train=1.977118 cos_to_last_merge=0.9777 (last merge round=17)
[S14] round=53 local utility u=0.004421 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9992310715310337, 'loss_val': 0.02087024351931881, 'psi': 0.9981390251731104}-{'f1_val': 0.9974055297193176, 'auprc': 0.9975390034162867, 'loss_val': 0.02460312331338284, 'psi': 0.9974589191981053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=53 head_norm_before_train=1.744089 cos_to_last_merge=0.9266 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.8075987219656131, 'auprc': 0.9907832880815272, 'loss_val': 0.3169753257861622, 'psi': 0.8808725484119787}-{'f1_val': 0.9967036286230888, 'auprc': 0.9981660173078114, 'loss_val': 0.025947784771888673, 'psi': 0.9972885840969778}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.799702 cos_to_last_merge=0.9320 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.932
[S16] round=53 local utility u=0.248645 metrics={'f1_val': 0.8432862733421438, 'auprc': 0.9939237138106642, 'loss_val': 1.0297236308422928, 'psi': 0.903541249529552}-{'f1_val': 0.832029425696474, 'auprc': 0.8905118350517682, 'loss_val': 1.1492377034237828, 'psi': 0.8554223894385917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=53 head_norm_before_train=1.583678 cos_to_last_merge=0.8997 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.900
[S17] round=53 local utility u=0.040440 metrics={'f1_val': 0.6386103605176779, 'auprc': 0.8199724237843287, 'loss_val': 1.055152926135425, 'psi': 0.7111551858243382}-{'f1_val': 0.6242257691475314, 'auprc': 0.8269087230341372, 'loss_val': 1.0705341882898716, 'psi': 0.7052989507021736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=54 head_norm_before_train=1.829550 cos_to_last_merge=0.7304 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.730
[S2] round=54 local utility u=0.212194 metrics={'f1_val': 0.7033911057673453, 'auprc': 0.7962921385293957, 'loss_val': 0.834372973462765, 'psi': 0.7405515188721655}-{'f1_val': 0.6569870210954363, 'auprc': 0.7796193708843097, 'loss_val': 0.9303177690395678, 'psi': 0.7060399610109855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=54 head_norm_before_train=2.011389 cos_to_last_merge=0.9345 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.9411311540784276, 'auprc': 0.9893714949013566, 'loss_val': 0.19385646636287868, 'psi': 0.9604272904075992}-{'f1_val': 0.9610352511054436, 'auprc': 0.998744975048445, 'loss_val': 0.12161361939605984, 'psi': 0.9761191406826442}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=1.597478 cos_to_last_merge=0.8817 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.882
[S4] round=54 local utility u=0.000391 metrics={'f1_val': 0.9536697428778048, 'auprc': 0.9531996479889486, 'loss_val': 0.2922923785155852, 'psi': 0.9534817049222624}-{'f1_val': 0.9517327346880214, 'auprc': 0.9553193664590176, 'loss_val': 0.2878110118309447, 'psi': 0.9531673873964199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=54 head_norm_before_train=1.957435 (no previous merge yet)
[S5] round=54 local utility u=0.011383 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9995570664643246, 'loss_val': 0.027421023580360308, 'psi': 0.9981074437865048}-{'f1_val': 0.9963338119635569, 'auprc': 0.9958748354827985, 'loss_val': 0.034297615040129646, 'psi': 0.9961502213712534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=54 head_norm_before_train=1.736167 cos_to_last_merge=0.8871 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.6890584953627392, 'auprc': 0.9387213612690857, 'loss_val': 0.6803676401687614, 'psi': 0.7889236417252778}-{'f1_val': 0.8041706525756964, 'auprc': 0.966625635168398, 'loss_val': 0.45470187438936155, 'psi': 0.869152645612777}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.510161 cos_to_last_merge=0.8762 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.876
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.6482422919573583, 'auprc': 0.7963815135433185, 'loss_val': 0.5711765495013007, 'psi': 0.7074979805917424}-{'f1_val': 0.7265958285060703, 'auprc': 0.9725092842028409, 'loss_val': 0.2178020156891081, 'psi': 0.8249612107847786}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.929125 cos_to_last_merge=0.9573 (last merge round=13)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9903754849676576, 'auprc': 0.999145516977054, 'loss_val': 0.038599927638931254, 'psi': 0.9938834977714162}-{'f1_val': 0.9939988207001527, 'auprc': 0.9991736230079561, 'loss_val': 0.03026299038866077, 'psi': 0.9960687416232741}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=1.803598 cos_to_last_merge=0.9384 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9912237657809659, 'auprc': 0.9992190491088027, 'loss_val': 0.028758617378767868, 'psi': 0.9944218791121006}-{'f1_val': 0.9958267183641853, 'auprc': 0.9994254182795814, 'loss_val': 0.021575780319695224, 'psi': 0.9972661983303438}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=1.904197 cos_to_last_merge=0.9207 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9948304333429507, 'loss_val': 0.02590320461720913, 'psi': 0.994913085256226}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956093290158539, 'loss_val': 0.02626284994966096, 'psi': 0.9952246435253873}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=2.191531 (no previous merge yet)
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.9955431649470738, 'auprc': 0.9994128601031778, 'loss_val': 0.01955768716460167, 'psi': 0.9970910430095155}-{'f1_val': 0.9967467623295848, 'auprc': 0.9994103963989334, 'loss_val': 0.01660010247775812, 'psi': 0.9978122159573243}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=54 head_norm_before_train=1.803109 (no previous merge yet)
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.5891510615666983, 'auprc': 0.7086726945393481, 'loss_val': 0.8426328814206864, 'psi': 0.6369597147557582}-{'f1_val': 0.5925085708355646, 'auprc': 0.7157761538991634, 'loss_val': 0.8685200007010351, 'psi': 0.6418156040610041}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=1.982319 cos_to_last_merge=0.9774 (last merge round=17)
[S14] round=54 local utility u=0.001362 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992340990731786, 'loss_val': 0.020619330292908182, 'psi': 0.9983866952419269}-{'f1_val': 0.9974109942678281, 'auprc': 0.9992310715310337, 'loss_val': 0.02087024351931881, 'psi': 0.9981390251731104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=54 head_norm_before_train=1.753278 cos_to_last_merge=0.9257 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=54 local utility u=0.544501 metrics={'f1_val': 0.9551682592648447, 'auprc': 0.9974795198506823, 'loss_val': 0.133478389424205, 'psi': 0.9720927634991798}-{'f1_val': 0.8075987219656131, 'auprc': 0.9907832880815272, 'loss_val': 0.3169753257861622, 'psi': 0.8808725484119787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=54 head_norm_before_train=1.807463 cos_to_last_merge=0.9312 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.931
[S16] round=54 local utility u=0.937609 metrics={'f1_val': 0.9921206581453264, 'auprc': 0.9912597130954104, 'loss_val': 0.03952043744536267, 'psi': 0.9917762801253599}-{'f1_val': 0.8432862733421438, 'auprc': 0.9939237138106642, 'loss_val': 1.0297236308422928, 'psi': 0.903541249529552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=54 head_norm_before_train=1.604081 cos_to_last_merge=0.8973 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.897
[S17] round=54 local utility u=0.002592 metrics={'f1_val': 0.6351709696572608, 'auprc': 0.8463070307750385, 'loss_val': 1.108337381671135, 'psi': 0.719625394104372}-{'f1_val': 0.6386103605176779, 'auprc': 0.8199724237843287, 'loss_val': 1.055152926135425, 'psi': 0.7111551858243382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=55 head_norm_before_train=1.836634 cos_to_last_merge=0.7298 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.730
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.6849330012285966, 'auprc': 0.7351091457006479, 'loss_val': 1.2045430122918224, 'psi': 0.7050034590174171}-{'f1_val': 0.7033911057673453, 'auprc': 0.7962921385293957, 'loss_val': 0.834372973462765, 'psi': 0.7405515188721655}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=55 head_norm_before_train=2.018966 cos_to_last_merge=0.9335 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=55 local utility u=0.057727 metrics={'f1_val': 0.9454799930611673, 'auprc': 0.9969698920307118, 'loss_val': 0.1272900186092027, 'psi': 0.966075952648985}-{'f1_val': 0.9411311540784276, 'auprc': 0.9893714949013566, 'loss_val': 0.19385646636287868, 'psi': 0.9604272904075992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=55 head_norm_before_train=1.603012 cos_to_last_merge=0.8811 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.881
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9401112312561177, 'auprc': 0.9476338993922374, 'loss_val': 0.3274889325195312, 'psi': 0.9431202985105656}-{'f1_val': 0.9536697428778048, 'auprc': 0.9531996479889486, 'loss_val': 0.2922923785155852, 'psi': 0.9534817049222624}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.967898 (no previous merge yet)
[S5] round=55 local utility u=0.001452 metrics={'f1_val': 0.9975086222760589, 'auprc': 0.9997311260677774, 'loss_val': 0.02724511789720304, 'psi': 0.9983976237927462}-{'f1_val': 0.9971410286679584, 'auprc': 0.9995570664643246, 'loss_val': 0.027421023580360308, 'psi': 0.9981074437865048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=55 head_norm_before_train=1.745276 cos_to_last_merge=0.8849 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.885
[S6] round=55 local utility u=0.406210 metrics={'f1_val': 0.7834113127260297, 'auprc': 0.9597884955691961, 'loss_val': 0.4972659156434309, 'psi': 0.8539621858632962}-{'f1_val': 0.6890584953627392, 'auprc': 0.9387213612690857, 'loss_val': 0.6803676401687614, 'psi': 0.7889236417252778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=55 head_norm_before_train=1.513534 cos_to_last_merge=0.8757 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.876
[S7] round=55 local utility u=0.184622 metrics={'f1_val': 0.6751164865229927, 'auprc': 0.8137518057487406, 'loss_val': 0.4152889465456253, 'psi': 0.730570614213292}-{'f1_val': 0.6482422919573583, 'auprc': 0.7963815135433185, 'loss_val': 0.5711765495013007, 'psi': 0.7074979805917424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=55 head_norm_before_train=1.936577 cos_to_last_merge=0.9568 (last merge round=13)
[S8] round=55 local utility u=0.009968 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9992544647289366, 'loss_val': 0.03196537085804296, 'psi': 0.9952246206408758}-{'f1_val': 0.9903754849676576, 'auprc': 0.999145516977054, 'loss_val': 0.038599927638931254, 'psi': 0.9938834977714162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=55 head_norm_before_train=1.810782 cos_to_last_merge=0.9377 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.9989359951655913, 'loss_val': 0.03299913799782953, 'psi': 0.9937956088038127}-{'f1_val': 0.9912237657809659, 'auprc': 0.9992190491088027, 'loss_val': 0.028758617378767868, 'psi': 0.9944218791121006}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=1.908366 cos_to_last_merge=0.9200 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=55 local utility u=0.000308 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9950611988375105, 'loss_val': 0.025978749454382312, 'psi': 0.99500539145405}-{'f1_val': 0.9949681865317428, 'auprc': 0.9948304333429507, 'loss_val': 0.02590320461720913, 'psi': 0.994913085256226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=55 head_norm_before_train=2.196863 (no previous merge yet)
[S11] round=55 local utility u=0.003127 metrics={'f1_val': 0.9962649549813628, 'auprc': 0.999414504265004, 'loss_val': 0.017639091421882712, 'psi': 0.9975247746948193}-{'f1_val': 0.9955431649470738, 'auprc': 0.9994128601031778, 'loss_val': 0.01955768716460167, 'psi': 0.9970910430095155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=55 head_norm_before_train=1.808719 (no previous merge yet)
[S13] round=55 local utility u=0.166348 metrics={'f1_val': 0.6197210615825781, 'auprc': 0.7207887128318975, 'loss_val': 0.7297041690556204, 'psi': 0.6601481220823059}-{'f1_val': 0.5891510615666983, 'auprc': 0.7086726945393481, 'loss_val': 0.8426328814206864, 'psi': 0.6369597147557582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=55 head_norm_before_train=1.988797 cos_to_last_merge=0.9770 (last merge round=17)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9963808558762648, 'auprc': 0.9988566901267719, 'loss_val': 0.036013757631827084, 'psi': 0.9973711895764676}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992340990731786, 'loss_val': 0.020619330292908182, 'psi': 0.9983866952419269}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.760229 cos_to_last_merge=0.9250 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=55 local utility u=0.179640 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9981482265962607, 'loss_val': 0.025417328082346768, 'psi': 0.9972814678123576}-{'f1_val': 0.9551682592648447, 'auprc': 0.9974795198506823, 'loss_val': 0.133478389424205, 'psi': 0.9720927634991798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=55 head_norm_before_train=1.814812 cos_to_last_merge=0.9304 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.9440060750418791, 'auprc': 0.995148680533498, 'loss_val': 0.18376897801606493, 'psi': 0.9644631172385266}-{'f1_val': 0.9921206581453264, 'auprc': 0.9912597130954104, 'loss_val': 0.03952043744536267, 'psi': 0.9917762801253599}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=1.623408 cos_to_last_merge=0.8951 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.895
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.5983945222611964, 'auprc': 0.800861023595758, 'loss_val': 1.0899973517876793, 'psi': 0.679381122795021}-{'f1_val': 0.6351709696572608, 'auprc': 0.8463070307750385, 'loss_val': 1.108337381671135, 'psi': 0.719625394104372}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=56 head_norm_before_train=1.844866 cos_to_last_merge=0.7291 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.729
[S2] round=56 local utility u=0.173484 metrics={'f1_val': 0.7236045647145072, 'auprc': 0.7370081828036663, 'loss_val': 1.0953011356638758, 'psi': 0.7289660119501709}-{'f1_val': 0.6849330012285966, 'auprc': 0.7351091457006479, 'loss_val': 1.2045430122918224, 'psi': 0.7050034590174171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=56 head_norm_before_train=2.026680 cos_to_last_merge=0.9325 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=56 local utility u=0.055416 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9991318945172396, 'loss_val': 0.11332635362442876, 'psi': 0.975979081546364}-{'f1_val': 0.9454799930611673, 'auprc': 0.9969698920307118, 'loss_val': 0.1272900186092027, 'psi': 0.966075952648985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=56 head_norm_before_train=1.608432 cos_to_last_merge=0.8803 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.880
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9395154031798527, 'auprc': 0.9484863294315422, 'loss_val': 0.3344252988458222, 'psi': 0.9431037736805286}-{'f1_val': 0.9401112312561177, 'auprc': 0.9476338993922374, 'loss_val': 0.3274889325195312, 'psi': 0.9431202985105656}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.980252 (no previous merge yet)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.995240984984437, 'loss_val': 0.027938129165864918, 'psi': 0.9958966811719089}-{'f1_val': 0.9975086222760589, 'auprc': 0.9997311260677774, 'loss_val': 0.02724511789720304, 'psi': 0.9983976237927462}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.757105 cos_to_last_merge=0.8831 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.883
[S6] round=56 local utility u=0.240712 metrics={'f1_val': 0.8400493919777619, 'auprc': 0.9614005915475402, 'loss_val': 0.360507347487137, 'psi': 0.8885898718056733}-{'f1_val': 0.7834113127260297, 'auprc': 0.9597884955691961, 'loss_val': 0.4972659156434309, 'psi': 0.8539621858632962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=56 head_norm_before_train=1.516292 cos_to_last_merge=0.8753 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.875
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.5824675514997288, 'auprc': 0.7827814135058294, 'loss_val': 0.7590065200257309, 'psi': 0.6625930963021691}-{'f1_val': 0.6751164865229927, 'auprc': 0.8137518057487406, 'loss_val': 0.4152889465456253, 'psi': 0.730570614213292}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=1.943172 cos_to_last_merge=0.9566 (last merge round=13)
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9993958872701538, 'loss_val': 0.03238283694220797, 'psi': 0.9950628991261286}-{'f1_val': 0.9925380579155019, 'auprc': 0.9992544647289366, 'loss_val': 0.03196537085804296, 'psi': 0.9952246206408758}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=56 head_norm_before_train=1.817302 cos_to_last_merge=0.9373 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=56 local utility u=0.017726 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9990299710968273, 'loss_val': 0.023081765955813432, 'psi': 0.9963584971342978}-{'f1_val': 0.9903686845626269, 'auprc': 0.9989359951655913, 'loss_val': 0.03299913799782953, 'psi': 0.9937956088038127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=56 head_norm_before_train=1.911173 cos_to_last_merge=0.9194 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=56 local utility u=0.001369 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9957952588002793, 'loss_val': 0.025443800146866036, 'psi': 0.9952990154391574}-{'f1_val': 0.9949681865317428, 'auprc': 0.9950611988375105, 'loss_val': 0.025978749454382312, 'psi': 0.99500539145405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=56 head_norm_before_train=2.202606 (no previous merge yet)
[S11] round=56 local utility u=0.002959 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9994152736146219, 'loss_val': 0.01606149718908661, 'psi': 0.9979588203003782}-{'f1_val': 0.9962649549813628, 'auprc': 0.999414504265004, 'loss_val': 0.017639091421882712, 'psi': 0.9975247746948193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=56 head_norm_before_train=1.812246 (no previous merge yet)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.5993388651266384, 'auprc': 0.6544563502437599, 'loss_val': 0.8775061119021184, 'psi': 0.621385859173487}-{'f1_val': 0.6197210615825781, 'auprc': 0.7207887128318975, 'loss_val': 0.7297041690556204, 'psi': 0.6601481220823059}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=1.993550 cos_to_last_merge=0.9767 (last merge round=17)
[S14] round=56 local utility u=0.014245 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.9992346557236347, 'loss_val': 0.01862821337387306, 'psi': 0.9985195054035088}-{'f1_val': 0.9963808558762648, 'auprc': 0.9988566901267719, 'loss_val': 0.036013757631827084, 'psi': 0.9973711895764676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=56 head_norm_before_train=1.764386 cos_to_last_merge=0.9246 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.9959176576326709, 'auprc': 0.9967361611305768, 'loss_val': 0.033437506603703114, 'psi': 0.9962450590318334}-{'f1_val': 0.9967036286230888, 'auprc': 0.9981482265962607, 'loss_val': 0.025417328082346768, 'psi': 0.9972814678123576}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=1.821637 cos_to_last_merge=0.9297 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.8425072630205352, 'auprc': 0.8924397376590897, 'loss_val': 1.0973705812999068, 'psi': 0.8624802528759571}-{'f1_val': 0.9440060750418791, 'auprc': 0.995148680533498, 'loss_val': 0.18376897801606493, 'psi': 0.9644631172385266}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=1.641052 cos_to_last_merge=0.8931 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.893
[S17] round=56 local utility u=0.014741 metrics={'f1_val': 0.6112155029377857, 'auprc': 0.8101367155262393, 'loss_val': 1.1652683198496696, 'psi': 0.6907839879731672}-{'f1_val': 0.5983945222611964, 'auprc': 0.800861023595758, 'loss_val': 1.0899973517876793, 'psi': 0.679381122795021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=57 head_norm_before_train=1.854918 cos_to_last_merge=0.7281 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.728
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.7210066610293682, 'auprc': 0.7428306287265478, 'loss_val': 1.1025708680622013, 'psi': 0.72973624810824}-{'f1_val': 0.7236045647145072, 'auprc': 0.7370081828036663, 'loss_val': 1.0953011356638758, 'psi': 0.7289660119501709}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=2.035827 cos_to_last_merge=0.9316 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9991460023626019, 'loss_val': 0.14860251628212165, 'psi': 0.9761561663277789}-{'f1_val': 0.9605438728991138, 'auprc': 0.9991318945172396, 'loss_val': 0.11332635362442876, 'psi': 0.975979081546364}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.615632 cos_to_last_merge=0.8793 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=57 local utility u=0.081915 metrics={'f1_val': 0.952295575213512, 'auprc': 0.9642618779706924, 'loss_val': 0.29460361352489334, 'psi': 0.9570820963163842}-{'f1_val': 0.9395154031798527, 'auprc': 0.9484863294315422, 'loss_val': 0.3344252988458222, 'psi': 0.9431037736805286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=57 head_norm_before_train=1.993809 (no previous merge yet)
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9939523725645949, 'loss_val': 0.026649332554218957, 'psi': 0.995381236203972}-{'f1_val': 0.9963338119635569, 'auprc': 0.995240984984437, 'loss_val': 0.027938129165864918, 'psi': 0.9958966811719089}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=1.768030 cos_to_last_merge=0.8815 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.881
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.7784826013300582, 'auprc': 0.951089468538574, 'loss_val': 0.5800996304692114, 'psi': 0.8475253482134645}-{'f1_val': 0.8400493919777619, 'auprc': 0.9614005915475402, 'loss_val': 0.360507347487137, 'psi': 0.8885898718056733}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.519545 cos_to_last_merge=0.8747 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.875
[S7] round=57 local utility u=0.530967 metrics={'f1_val': 0.6737286660099249, 'auprc': 0.8260488374526337, 'loss_val': 0.3744424538888991, 'psi': 0.7346567345870083}-{'f1_val': 0.5824675514997288, 'auprc': 0.7827814135058294, 'loss_val': 0.7590065200257309, 'psi': 0.6625930963021691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=57 head_norm_before_train=1.949451 cos_to_last_merge=0.9561 (last merge round=13)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.8187933248597837, 'auprc': 0.9991967950039692, 'loss_val': 0.3103622651193025, 'psi': 0.890954712917458}-{'f1_val': 0.992174240363445, 'auprc': 0.9993958872701538, 'loss_val': 0.03238283694220797, 'psi': 0.9950628991261286}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=1.824736 cos_to_last_merge=0.9367 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=57 local utility u=0.007606 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9990409190591976, 'loss_val': 0.02040053250130965, 'psi': 0.9976126747120139}-{'f1_val': 0.9945775144926113, 'auprc': 0.9990299710968273, 'loss_val': 0.023081765955813432, 'psi': 0.9963584971342978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=57 head_norm_before_train=1.916792 cos_to_last_merge=0.9187 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=57 local utility u=0.000545 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9960851285881088, 'loss_val': 0.025224336619826992, 'psi': 0.9954149633542893}-{'f1_val': 0.9949681865317428, 'auprc': 0.9957952588002793, 'loss_val': 0.025443800146866036, 'psi': 0.9952990154391574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=57 head_norm_before_train=2.208438 (no previous merge yet)
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9945824803687519, 'auprc': 0.999411496178672, 'loss_val': 0.024318191704797334, 'psi': 0.9965140866927199}-{'f1_val': 0.9969878514242156, 'auprc': 0.9994152736146219, 'loss_val': 0.01606149718908661, 'psi': 0.9979588203003782}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.814815 (no previous merge yet)
[S13] round=57 local utility u=0.017879 metrics={'f1_val': 0.5881225365743835, 'auprc': 0.7206088164199705, 'loss_val': 0.9729080367525417, 'psi': 0.6411170485126183}-{'f1_val': 0.5993388651266384, 'auprc': 0.6544563502437599, 'loss_val': 0.8775061119021184, 'psi': 0.621385859173487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=57 head_norm_before_train=2.000199 cos_to_last_merge=0.9763 (last merge round=17)
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9992332874261863, 'loss_val': 0.018812248125385365, 'psi': 0.9982724989444003}-{'f1_val': 0.9980427385234248, 'auprc': 0.9992346557236347, 'loss_val': 0.01862821337387306, 'psi': 0.9985195054035088}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=57 head_norm_before_train=1.770881 cos_to_last_merge=0.9240 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.9836632781139562, 'auprc': 0.9968388146693492, 'loss_val': 0.04389578316988539, 'psi': 0.9889334927361133}-{'f1_val': 0.9959176576326709, 'auprc': 0.9967361611305768, 'loss_val': 0.033437506603703114, 'psi': 0.9962450590318334}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.826362 cos_to_last_merge=0.9289 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.929
[S16] round=57 local utility u=0.758495 metrics={'f1_val': 0.9302535987659655, 'auprc': 0.9943358591174694, 'loss_val': 0.41254686651981465, 'psi': 0.9558865029065671}-{'f1_val': 0.8425072630205352, 'auprc': 0.8924397376590897, 'loss_val': 1.0973705812999068, 'psi': 0.8624802528759571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=57 head_norm_before_train=1.655907 cos_to_last_merge=0.8910 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.891
[S17] round=57 local utility u=0.163813 metrics={'f1_val': 0.6354369525396639, 'auprc': 0.8570229442452336, 'loss_val': 1.123629332975652, 'psi': 0.7240713492218918}-{'f1_val': 0.6112155029377857, 'auprc': 0.8101367155262393, 'loss_val': 1.1652683198496696, 'psi': 0.6907839879731672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=58 head_norm_before_train=1.865555 cos_to_last_merge=0.7270 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.727
[S2] round=58 local utility u=0.045564 metrics={'f1_val': 0.7212982403767496, 'auprc': 0.7508446611813004, 'loss_val': 1.0372349957575309, 'psi': 0.73311680869857}-{'f1_val': 0.7210066610293682, 'auprc': 0.7428306287265478, 'loss_val': 1.1025708680622013, 'psi': 0.72973624810824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=58 head_norm_before_train=2.044756 cos_to_last_merge=0.9309 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.7707147737220631, 'auprc': 0.9940809074436988, 'loss_val': 0.3606600529260408, 'psi': 0.8600612272107173}-{'f1_val': 0.9608296089712303, 'auprc': 0.9991460023626019, 'loss_val': 0.14860251628212165, 'psi': 0.9761561663277789}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.620951 cos_to_last_merge=0.8788 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9403006306575483, 'auprc': 0.9573018610187859, 'loss_val': 0.32835681747028833, 'psi': 0.9471011228020434}-{'f1_val': 0.952295575213512, 'auprc': 0.9642618779706924, 'loss_val': 0.29460361352489334, 'psi': 0.9570820963163842}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=2.007001 (no previous merge yet)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.8009859888350579, 'auprc': 0.99072880127196, 'loss_val': 0.23345903492502385, 'psi': 0.8768831138098188}-{'f1_val': 0.9963338119635569, 'auprc': 0.9939523725645949, 'loss_val': 0.026649332554218957, 'psi': 0.995381236203972}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.779817 cos_to_last_merge=0.8805 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.880
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.7070343963578322, 'auprc': 0.9653331154638258, 'loss_val': 0.6134474536978197, 'psi': 0.8103538840002296}-{'f1_val': 0.7784826013300582, 'auprc': 0.951089468538574, 'loss_val': 0.5800996304692114, 'psi': 0.8475253482134645}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.528037 cos_to_last_merge=0.8732 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.873
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.5441818484581255, 'auprc': 0.7826661462804569, 'loss_val': 0.9381306611816337, 'psi': 0.639575567587058}-{'f1_val': 0.6737286660099249, 'auprc': 0.8260488374526337, 'loss_val': 0.3744424538888991, 'psi': 0.7346567345870083}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.955475 cos_to_last_merge=0.9554 (last merge round=13)
[S8] round=58 local utility u=0.665844 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.999463383310956, 'loss_val': 0.028465106812245927, 'psi': 0.9959605555930804}-{'f1_val': 0.8187933248597837, 'auprc': 0.9991967950039692, 'loss_val': 0.3103622651193025, 'psi': 0.890954712917458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=58 head_norm_before_train=1.829310 cos_to_last_merge=0.9356 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.936
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9982550723756103, 'loss_val': 0.02040945074851797, 'psi': 0.9972962361298908}-{'f1_val': 0.9966605118138915, 'auprc': 0.9990409190591976, 'loss_val': 0.02040053250130965, 'psi': 0.9976126747120139}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=1.923516 cos_to_last_merge=0.9180 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9958764151349524, 'loss_val': 0.02501796489878097, 'psi': 0.9951997315856045}-{'f1_val': 0.9949681865317428, 'auprc': 0.9960851285881088, 'loss_val': 0.025224336619826992, 'psi': 0.9954149633542893}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=2.214388 (no previous merge yet)
[S11] round=58 local utility u=0.004104 metrics={'f1_val': 0.995302812240395, 'auprc': 0.999409716437222, 'loss_val': 0.02042631261490324, 'psi': 0.9969455739191257}-{'f1_val': 0.9945824803687519, 'auprc': 0.999411496178672, 'loss_val': 0.024318191704797334, 'psi': 0.9965140866927199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=58 head_norm_before_train=1.817430 (no previous merge yet)
[S13] round=58 local utility u=0.350982 metrics={'f1_val': 0.6410193785681275, 'auprc': 0.7330723548929663, 'loss_val': 0.6257165748096761, 'psi': 0.677840569098063}-{'f1_val': 0.5881225365743835, 'auprc': 0.7206088164199705, 'loss_val': 0.9729080367525417, 'psi': 0.6411170485126183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=58 head_norm_before_train=2.003858 cos_to_last_merge=0.9760 (last merge round=17)
[S14] round=58 local utility u=0.001252 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.9992338161847345, 'loss_val': 0.01877402613325627, 'psi': 0.9985191695879487}-{'f1_val': 0.9976319732898762, 'auprc': 0.9992332874261863, 'loss_val': 0.018812248125385365, 'psi': 0.9982724989444003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=58 head_norm_before_train=1.779063 cos_to_last_merge=0.9232 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.923
[S15] round=58 local utility u=0.050040 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981540194917222, 'loss_val': 0.026262037375684406, 'psi': 0.9973096088292013}-{'f1_val': 0.9836632781139562, 'auprc': 0.9968388146693492, 'loss_val': 0.04389578316988539, 'psi': 0.9889334927361133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=58 head_norm_before_train=1.831568 cos_to_last_merge=0.9282 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=58 local utility u=0.127248 metrics={'f1_val': 0.9421340019518183, 'auprc': 0.9929168668502973, 'loss_val': 0.22507695483340168, 'psi': 0.9624471479112099}-{'f1_val': 0.9302535987659655, 'auprc': 0.9943358591174694, 'loss_val': 0.41254686651981465, 'psi': 0.9558865029065671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=58 head_norm_before_train=1.669970 cos_to_last_merge=0.8894 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.889
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6295783677415252, 'auprc': 0.8212485391324106, 'loss_val': 1.2087683932412028, 'psi': 0.7062464362978793}-{'f1_val': 0.6354369525396639, 'auprc': 0.8570229442452336, 'loss_val': 1.123629332975652, 'psi': 0.7240713492218918}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=1.872004 cos_to_last_merge=0.7264 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.726
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.7203317942224237, 'auprc': 0.7509138643923008, 'loss_val': 1.0885172802790521, 'psi': 0.7325646222903746}-{'f1_val': 0.7212982403767496, 'auprc': 0.7508446611813004, 'loss_val': 1.0372349957575309, 'psi': 0.73311680869857}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.733 u=0.0000 p_local=0.0462 f1=0.720 auprc=0.751 bytes=57580
[S3] START round=59 head_norm_before_train=2.052949 cos_to_last_merge=0.9301 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=59 local utility u=0.804074 metrics={'f1_val': 0.9846070322993064, 'auprc': 0.998993898646471, 'loss_val': 0.05060445622380048, 'psi': 0.9903617788381722}-{'f1_val': 0.7707147737220631, 'auprc': 0.9940809074436988, 'loss_val': 0.3606600529260408, 'psi': 0.8600612272107173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] r=60 psi=0.990 u=0.8041 p_local=0.1900 f1=0.985 auprc=0.999 bytes=61112
[S4] START round=59 head_norm_before_train=1.628966 cos_to_last_merge=0.8779 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9337086055747925, 'auprc': 0.9650302851388705, 'loss_val': 0.36345658481842075, 'psi': 0.9462372774004237}-{'f1_val': 0.9403006306575483, 'auprc': 0.9573018610187859, 'loss_val': 0.32835681747028833, 'psi': 0.9471011228020434}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.946 u=0.0000 p_local=0.0170 f1=0.934 auprc=0.965 bytes=61075
[S5] START round=59 head_norm_before_train=2.013970 (no previous merge yet)
[S5] round=59 local utility u=0.705732 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9998157169878752, 'loss_val': 0.02575772383357628, 'psi': 0.9981680219617887}-{'f1_val': 0.8009859888350579, 'auprc': 0.99072880127196, 'loss_val': 0.23345903492502385, 'psi': 0.8768831138098188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] r=60 psi=0.998 u=0.7057 p_local=0.1694 f1=0.997 auprc=1.000 bytes=70090
[S6] START round=59 head_norm_before_train=1.790433 cos_to_last_merge=0.8793 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.879
[S6] round=59 local utility u=1.000000 metrics={'f1_val': 0.9790150949504064, 'auprc': 0.9837349061608147, 'loss_val': 0.12494774495633353, 'psi': 0.9809030194345697}-{'f1_val': 0.7070343963578322, 'auprc': 0.9653331154638258, 'loss_val': 0.6134474536978197, 'psi': 0.8103538840002296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S6] r=60 psi=0.981 u=1.0000 p_local=0.3241 f1=0.979 auprc=0.984 bytes=57566
[S7] START round=59 head_norm_before_train=1.536388 cos_to_last_merge=0.8717 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.872
[S7] round=59 local utility u=0.438388 metrics={'f1_val': 0.6251972580254638, 'auprc': 0.7988180797091862, 'loss_val': 0.5959022220180177, 'psi': 0.6946455866989527}-{'f1_val': 0.5441818484581255, 'auprc': 0.7826661462804569, 'loss_val': 0.9381306611816337, 'psi': 0.639575567587058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] r=60 psi=0.695 u=0.4384 p_local=0.3002 f1=0.625 auprc=0.799 bytes=59367
[S8] START round=59 head_norm_before_train=1.960020 cos_to_last_merge=0.9551 (last merge round=13)
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9994132074347435, 'loss_val': 0.0286962999311147, 'psi': 0.9957256848948213}-{'f1_val': 0.9936253371144965, 'auprc': 0.999463383310956, 'loss_val': 0.028465106812245927, 'psi': 0.9959605555930804}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=60 psi=0.996 u=0.0000 p_local=0.1086 f1=0.993 auprc=0.999 bytes=64743
[S9] START round=59 head_norm_before_train=1.834580 cos_to_last_merge=0.9345 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.935
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950557242615659, 'loss_val': 0.02071106290939101, 'psi': 0.9960185967929612}-{'f1_val': 0.9966570119660778, 'auprc': 0.9982550723756103, 'loss_val': 0.02040945074851797, 'psi': 0.9972962361298908}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.996 u=0.0000 p_local=0.0062 f1=0.997 auprc=0.995 bytes=66599
[S10] START round=59 head_norm_before_train=1.930982 cos_to_last_merge=0.9173 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.994858660431882, 'loss_val': 0.024990632643754656, 'psi': 0.9947926297043763}-{'f1_val': 0.9947486092193725, 'auprc': 0.9958764151349524, 'loss_val': 0.02501796489878097, 'psi': 0.9951997315856045}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=60 psi=0.995 u=0.0000 p_local=0.0004 f1=0.995 auprc=0.995 bytes=73799
[S11] START round=59 head_norm_before_train=2.220613 (no previous merge yet)
[S11] round=59 local utility u=0.003819 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9990498684908079, 'loss_val': 0.017746497697181143, 'psi': 0.9974053981665443}-{'f1_val': 0.995302812240395, 'auprc': 0.999409716437222, 'loss_val': 0.02042631261490324, 'psi': 0.9969455739191257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] r=60 psi=0.997 u=0.0038 p_local=0.0100 f1=0.996 auprc=0.999 bytes=70162
[S13] START round=59 head_norm_before_train=1.820261 (no previous merge yet)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6011754937743075, 'auprc': 0.7382075016572859, 'loss_val': 0.9577899089942845, 'psi': 0.6559882969274988}-{'f1_val': 0.6410193785681275, 'auprc': 0.7330723548929663, 'loss_val': 0.6257165748096761, 'psi': 0.677840569098063}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.656 u=0.0000 p_local=0.0898 f1=0.601 auprc=0.738 bytes=50454
[S14] START round=59 head_norm_before_train=2.010005 cos_to_last_merge=0.9757 (last merge round=17)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9355213399565925, 'auprc': 0.9988566901267718, 'loss_val': 0.12334358721977005, 'psi': 0.9608554800246643}-{'f1_val': 0.9980427385234248, 'auprc': 0.9992338161847345, 'loss_val': 0.01877402613325627, 'psi': 0.9985191695879487}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.961 u=0.0000 p_local=0.0058 f1=0.936 auprc=0.999 bytes=77261
[S15] START round=59 head_norm_before_train=1.787816 cos_to_last_merge=0.9224 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.9909010870725673, 'auprc': 0.9979123016731366, 'loss_val': 0.03493234720984863, 'psi': 0.993705572912795}-{'f1_val': 0.9967466683875206, 'auprc': 0.9981540194917222, 'loss_val': 0.026262037375684406, 'psi': 0.9973096088292013}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.994 u=0.0000 p_local=0.1143 f1=0.991 auprc=0.998 bytes=62937
[S16] START round=59 head_norm_before_train=1.836235 cos_to_last_merge=0.9278 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.8519731537342053, 'auprc': 0.8849263685283637, 'loss_val': 0.9701180014973273, 'psi': 0.8651544396518687}-{'f1_val': 0.9421340019518183, 'auprc': 0.9929168668502973, 'loss_val': 0.22507695483340168, 'psi': 0.9624471479112099}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.865 u=0.0000 p_local=0.2236 f1=0.852 auprc=0.885 bytes=59348
[S17] START round=59 head_norm_before_train=1.686238 cos_to_last_merge=0.8879 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.888
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.600989108944821, 'auprc': 0.7777164556746489, 'loss_val': 1.2113480170724782, 'psi': 0.6716800476367522}-{'f1_val': 0.6295783677415252, 'auprc': 0.8212485391324106, 'loss_val': 1.2087683932412028, 'psi': 0.7062464362978793}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.672 u=0.0000 p_local=0.0585 f1=0.601 auprc=0.778 bytes=61205
[S2] START round=60 head_norm_before_train=1.874289 cos_to_last_merge=0.7262 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.726
[S2] round=60 local utility u=0.006790 metrics={'f1_val': 0.7202457417692013, 'auprc': 0.7468647485696411, 'loss_val': 1.062272885748448, 'psi': 0.7308933444893773}-{'f1_val': 0.7203317942224237, 'auprc': 0.7509138643923008, 'loss_val': 1.0885172802790521, 'psi': 0.7325646222903746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=60 head_norm_before_train=2.062816 cos_to_last_merge=0.9293 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.9726102525776552, 'auprc': 0.9987498122736644, 'loss_val': 0.07118123317118934, 'psi': 0.9830660764560588}-{'f1_val': 0.9846070322993064, 'auprc': 0.998993898646471, 'loss_val': 0.05060445622380048, 'psi': 0.9903617788381722}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=1.633644 cos_to_last_merge=0.8771 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.6206830174568175, 'auprc': 0.9561388702930242, 'loss_val': 0.7889370158562048, 'psi': 0.7548653585913002}-{'f1_val': 0.9337086055747925, 'auprc': 0.9650302851388705, 'loss_val': 0.36345658481842075, 'psi': 0.9462372774004237}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=2.019016 (no previous merge yet)
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.9937256156669415, 'loss_val': 0.02523758653739614, 'psi': 0.9956870882435906}-{'f1_val': 0.9970695586110643, 'auprc': 0.9998157169878752, 'loss_val': 0.02575772383357628, 'psi': 0.9981680219617887}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=1.802640 cos_to_last_merge=0.8781 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.6158157472792252, 'auprc': 0.7631855656735652, 'loss_val': 1.0446364683185745, 'psi': 0.6747636746369612}-{'f1_val': 0.9790150949504064, 'auprc': 0.9837349061608147, 'loss_val': 0.12494774495633353, 'psi': 0.9809030194345697}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.541806 cos_to_last_merge=0.8710 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.871
[S7] round=60 local utility u=0.428244 metrics={'f1_val': 0.6849036502140256, 'auprc': 0.8582850590397902, 'loss_val': 0.27605269021422396, 'psi': 0.7542562137443314}-{'f1_val': 0.6251972580254638, 'auprc': 0.7988180797091862, 'loss_val': 0.5959022220180177, 'psi': 0.6946455866989527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=60 head_norm_before_train=1.964980 cos_to_last_merge=0.9548 (last merge round=13)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9882230176651405, 'auprc': 0.9992710982154145, 'loss_val': 0.04130317535315498, 'psi': 0.9926422498852502}-{'f1_val': 0.9932673365348732, 'auprc': 0.9994132074347435, 'loss_val': 0.0286962999311147, 'psi': 0.9957256848948213}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=1.840895 cos_to_last_merge=0.9337 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.934
[S9] round=60 local utility u=0.006523 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9991516058892591, 'loss_val': 0.01995317925605132, 'psi': 0.9976569494440385}-{'f1_val': 0.9966605118138915, 'auprc': 0.9950557242615659, 'loss_val': 0.02071106290939101, 'psi': 0.9960185967929612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=60 head_norm_before_train=1.938725 cos_to_last_merge=0.9166 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=60 local utility u=0.001821 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956923667547739, 'loss_val': 0.025166234490545506, 'psi': 0.9952578586209553}-{'f1_val': 0.9947486092193725, 'auprc': 0.994858660431882, 'loss_val': 0.024990632643754656, 'psi': 0.9947926297043763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=60 head_norm_before_train=2.226790 (no previous merge yet)
[S11] round=60 local utility u=0.000000 metrics={'f1_val': 0.9839012491389132, 'auprc': 0.999394958328085, 'loss_val': 0.050627493467360334, 'psi': 0.9900987328145819}-{'f1_val': 0.9963090846170353, 'auprc': 0.9990498684908079, 'loss_val': 0.017746497697181143, 'psi': 0.9974053981665443}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=60 head_norm_before_train=1.823615 (no previous merge yet)
[S13] round=60 local utility u=0.053023 metrics={'f1_val': 0.6169273723541951, 'auprc': 0.7409360937460407, 'loss_val': 0.9544406849548043, 'psi': 0.6665308609109334}-{'f1_val': 0.6011754937743075, 'auprc': 0.7382075016572859, 'loss_val': 0.9577899089942845, 'psi': 0.6559882969274988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=60 head_norm_before_train=2.016315 cos_to_last_merge=0.9753 (last merge round=17)
[S14] round=60 local utility u=0.241345 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9992358037669671, 'loss_val': 0.018060652349055215, 'psi': 0.9986341279831098}-{'f1_val': 0.9355213399565925, 'auprc': 0.9988566901267718, 'loss_val': 0.12334358721977005, 'psi': 0.9608554800246643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=60 head_norm_before_train=1.797397 cos_to_last_merge=0.9216 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.8336828109605279, 'auprc': 0.9954386056203731, 'loss_val': 0.2996855905305374, 'psi': 0.898385128824466}-{'f1_val': 0.9909010870725673, 'auprc': 0.9979123016731366, 'loss_val': 0.03493234720984863, 'psi': 0.993705572912795}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=1.840045 cos_to_last_merge=0.9277 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=60 local utility u=0.250343 metrics={'f1_val': 0.8827681368015942, 'auprc': 0.8896791919212637, 'loss_val': 0.6684607418789231, 'psi': 0.885532558849462}-{'f1_val': 0.8519731537342053, 'auprc': 0.8849263685283637, 'loss_val': 0.9701180014973273, 'psi': 0.8651544396518687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=60 head_norm_before_train=1.699262 cos_to_last_merge=0.8865 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.887
[S17] round=60 local utility u=0.083447 metrics={'f1_val': 0.623257978421017, 'auprc': 0.8115890417063616, 'loss_val': 1.2796848152143014, 'psi': 0.6985904037351549}-{'f1_val': 0.600989108944821, 'auprc': 0.7777164556746489, 'loss_val': 1.2113480170724782, 'psi': 0.6716800476367522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=61 head_norm_before_train=1.878115 cos_to_last_merge=0.7259 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.726
[S2] round=61 local utility u=0.012471 metrics={'f1_val': 0.7212982403767496, 'auprc': 0.7444420702046304, 'loss_val': 1.0363773624390145, 'psi': 0.7305557723079019}-{'f1_val': 0.7202457417692013, 'auprc': 0.7468647485696411, 'loss_val': 1.062272885748448, 'psi': 0.7308933444893773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=61 head_norm_before_train=2.072543 cos_to_last_merge=0.9286 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9987609850225846, 'loss_val': 0.10261408217918372, 'psi': 0.9761255446723001}-{'f1_val': 0.9726102525776552, 'auprc': 0.9987498122736644, 'loss_val': 0.07118123317118934, 'psi': 0.9830660764560588}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.638084 cos_to_last_merge=0.8764 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=61 local utility u=1.000000 metrics={'f1_val': 0.9423749150797885, 'auprc': 0.958454969672577, 'loss_val': 0.30990982918882504, 'psi': 0.9488069369169039}-{'f1_val': 0.6206830174568175, 'auprc': 0.9561388702930242, 'loss_val': 0.7889370158562048, 'psi': 0.7548653585913002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=61 head_norm_before_train=2.024612 (no previous merge yet)
[S5] round=61 local utility u=0.009091 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9993316351332262, 'loss_val': 0.02211749416590042, 'psi': 0.9977538351403651}-{'f1_val': 0.9969947366280233, 'auprc': 0.9937256156669415, 'loss_val': 0.02523758653739614, 'psi': 0.9956870882435906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=61 head_norm_before_train=1.810777 cos_to_last_merge=0.8765 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.876
[S6] round=61 local utility u=1.000000 metrics={'f1_val': 0.7882097212285266, 'auprc': 0.9543714352101346, 'loss_val': 0.45725836468647035, 'psi': 0.8546744068211698}-{'f1_val': 0.6158157472792252, 'auprc': 0.7631855656735652, 'loss_val': 1.0446364683185745, 'psi': 0.6747636746369612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=61 head_norm_before_train=1.546821 cos_to_last_merge=0.8702 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.870
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.5773423804250266, 'auprc': 0.7860915254277059, 'loss_val': 0.7398421461950337, 'psi': 0.6608420384260983}-{'f1_val': 0.6849036502140256, 'auprc': 0.8582850590397902, 'loss_val': 0.27605269021422396, 'psi': 0.7542562137443314}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.970020 cos_to_last_merge=0.9546 (last merge round=13)
[S8] round=61 local utility u=0.022924 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9994106929948676, 'loss_val': 0.028287580336465327, 'psi': 0.995939479466645}-{'f1_val': 0.9882230176651405, 'auprc': 0.9992710982154145, 'loss_val': 0.04130317535315498, 'psi': 0.9926422498852502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=61 head_norm_before_train=1.846779 cos_to_last_merge=0.9330 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.933
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9990275803701498, 'loss_val': 0.020647574146774345, 'psi': 0.9971070631665712}-{'f1_val': 0.9966605118138915, 'auprc': 0.9991516058892591, 'loss_val': 0.01995317925605132, 'psi': 0.9976569494440385}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=1.946440 cos_to_last_merge=0.9159 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=61 local utility u=0.001147 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960935430317626, 'loss_val': 0.02539413955365224, 'psi': 0.9955501206243298}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956923667547739, 'loss_val': 0.025166234490545506, 'psi': 0.9952578586209553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=61 head_norm_before_train=2.231481 (no previous merge yet)
[S11] round=61 local utility u=0.055614 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9994156949232452, 'loss_val': 0.015359908148651295, 'psi': 0.9976968309663564}-{'f1_val': 0.9839012491389132, 'auprc': 0.999394958328085, 'loss_val': 0.050627493467360334, 'psi': 0.9900987328145819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=61 head_norm_before_train=1.827946 (no previous merge yet)
[S13] round=61 local utility u=0.152499 metrics={'f1_val': 0.6406177023577628, 'auprc': 0.6980401763100856, 'loss_val': 0.6628976141014544, 'psi': 0.6635866919386919}-{'f1_val': 0.6169273723541951, 'auprc': 0.7409360937460407, 'loss_val': 0.9544406849548043, 'psi': 0.6665308609109334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=61 head_norm_before_train=2.023257 cos_to_last_merge=0.9750 (last merge round=17)
[S14] round=61 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992341520111244, 'loss_val': 0.01767188301570391, 'psi': 0.9983867164171052}-{'f1_val': 0.9982330107938716, 'auprc': 0.9992358037669671, 'loss_val': 0.018060652349055215, 'psi': 0.9986341279831098}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=61 head_norm_before_train=1.807274 cos_to_last_merge=0.9206 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.921
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.8059562520924562, 'auprc': 0.9927627490945456, 'loss_val': 0.3680256190689012, 'psi': 0.880678850893292}-{'f1_val': 0.8336828109605279, 'auprc': 0.9954386056203731, 'loss_val': 0.2996855905305374, 'psi': 0.898385128824466}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.844816 cos_to_last_merge=0.9274 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.927
[S16] round=61 local utility u=0.789327 metrics={'f1_val': 0.992079754585487, 'auprc': 0.9882215902211877, 'loss_val': 0.041304174149844386, 'psi': 0.9905364888397673}-{'f1_val': 0.8827681368015942, 'auprc': 0.8896791919212637, 'loss_val': 0.6684607418789231, 'psi': 0.885532558849462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=61 head_norm_before_train=1.713845 cos_to_last_merge=0.8853 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.885
[S17] round=61 local utility u=0.282478 metrics={'f1_val': 0.6482477465246324, 'auprc': 0.8875733900443218, 'loss_val': 1.0926211073109924, 'psi': 0.7439780039325081}-{'f1_val': 0.623257978421017, 'auprc': 0.8115890417063616, 'loss_val': 1.2796848152143014, 'psi': 0.6985904037351549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=62 head_norm_before_train=1.880937 cos_to_last_merge=0.7257 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.726
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.7210066610293682, 'auprc': 0.7390452858634451, 'loss_val': 1.0987078587024723, 'psi': 0.7282221109629989}-{'f1_val': 0.7212982403767496, 'auprc': 0.7444420702046304, 'loss_val': 1.0363773624390145, 'psi': 0.7305557723079019}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=2.081011 cos_to_last_merge=0.9280 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.9103538007983669, 'auprc': 0.9873971367090688, 'loss_val': 0.2012165945789916, 'psi': 0.9411711351626477}-{'f1_val': 0.9610352511054436, 'auprc': 0.9987609850225846, 'loss_val': 0.10261408217918372, 'psi': 0.9761255446723001}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.642846 cos_to_last_merge=0.8759 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=62 local utility u=0.016317 metrics={'f1_val': 0.9497330433667946, 'auprc': 0.9514849104586081, 'loss_val': 0.30051507863230437, 'psi': 0.95043379020352}-{'f1_val': 0.9423749150797885, 'auprc': 0.958454969672577, 'loss_val': 0.30990982918882504, 'psi': 0.9488069369169039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=62 head_norm_before_train=2.031863 (no previous merge yet)
[S5] round=62 local utility u=0.001053 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.999812641517495, 'loss_val': 0.021453687045751485, 'psi': 0.9979462376940726}-{'f1_val': 0.9967019684784577, 'auprc': 0.9993316351332262, 'loss_val': 0.02211749416590042, 'psi': 0.9977538351403651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=62 head_norm_before_train=1.817874 cos_to_last_merge=0.8754 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=62 local utility u=0.124444 metrics={'f1_val': 0.8171917817066234, 'auprc': 0.9660999140369031, 'loss_val': 0.4174484117687228, 'psi': 0.8767550346387353}-{'f1_val': 0.7882097212285266, 'auprc': 0.9543714352101346, 'loss_val': 0.45725836468647035, 'psi': 0.8546744068211698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=62 head_norm_before_train=1.550253 cos_to_last_merge=0.8696 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.870
[S7] round=62 local utility u=0.433273 metrics={'f1_val': 0.6556440026887945, 'auprc': 0.8111968215793256, 'loss_val': 0.4184224840320935, 'psi': 0.717865130245007}-{'f1_val': 0.5773423804250266, 'auprc': 0.7860915254277059, 'loss_val': 0.7398421461950337, 'psi': 0.6608420384260983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=62 head_norm_before_train=1.976291 cos_to_last_merge=0.9542 (last merge round=13)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9991698945271255, 'loss_val': 0.030024869382273285, 'psi': 0.9954094113700358}-{'f1_val': 0.9936253371144965, 'auprc': 0.9994106929948676, 'loss_val': 0.028287580336465327, 'psi': 0.995939479466645}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=1.852672 cos_to_last_merge=0.9324 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.932
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9924099548771206, 'loss_val': 0.020933751762552494, 'psi': 0.9947140388184148}-{'f1_val': 0.9958267183641853, 'auprc': 0.9990275803701498, 'loss_val': 0.020647574146774345, 'psi': 0.9971070631665712}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=1.952238 cos_to_last_merge=0.9152 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9960352184059491, 'loss_val': 0.02478827174674747, 'psi': 0.9953949992814253}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960935430317626, 'loss_val': 0.02539413955365224, 'psi': 0.9955501206243298}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=2.235734 (no previous merge yet)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9938632294089428, 'auprc': 0.9994150117720235, 'loss_val': 0.026026282059254086, 'psi': 0.9960839423541751}-{'f1_val': 0.9965509216617638, 'auprc': 0.9994156949232452, 'loss_val': 0.015359908148651295, 'psi': 0.9976968309663564}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.832083 (no previous merge yet)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.622776299086857, 'auprc': 0.7431499431718219, 'loss_val': 0.832776341279844, 'psi': 0.670925756720843}-{'f1_val': 0.6406177023577628, 'auprc': 0.6980401763100856, 'loss_val': 0.6628976141014544, 'psi': 0.6635866919386919}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=2.029445 cos_to_last_merge=0.9745 (last merge round=17)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9992344028844458, 'loss_val': 0.018519316672239446, 'psi': 0.9983736954196457}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992341520111244, 'loss_val': 0.01767188301570391, 'psi': 0.9983867164171052}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.816875 cos_to_last_merge=0.9197 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.920
[S15] round=62 local utility u=0.705536 metrics={'f1_val': 0.9840545113927044, 'auprc': 0.9977417241643609, 'loss_val': 0.04048020090843597, 'psi': 0.9895293965013671}-{'f1_val': 0.8059562520924562, 'auprc': 0.9927627490945456, 'loss_val': 0.3680256190689012, 'psi': 0.880678850893292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=62 head_norm_before_train=1.850821 cos_to_last_merge=0.9269 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.927
[S16] round=62 local utility u=0.006357 metrics={'f1_val': 0.9922702894642583, 'auprc': 0.991341269790173, 'loss_val': 0.039091627521435024, 'psi': 0.9918986815946241}-{'f1_val': 0.992079754585487, 'auprc': 0.9882215902211877, 'loss_val': 0.041304174149844386, 'psi': 0.9905364888397673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=62 head_norm_before_train=1.728427 cos_to_last_merge=0.8841 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.884
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.6309814245675487, 'auprc': 0.8391201562981511, 'loss_val': 1.2840705338822032, 'psi': 0.7142369172597897}-{'f1_val': 0.6482477465246324, 'auprc': 0.8875733900443218, 'loss_val': 1.0926211073109924, 'psi': 0.7439780039325081}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=1.882118 cos_to_last_merge=0.7256 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.726
[S2] round=63 local utility u=0.038669 metrics={'f1_val': 0.7211589665456257, 'auprc': 0.7408693953910402, 'loss_val': 1.0277560500979925, 'psi': 0.7290431380837916}-{'f1_val': 0.7210066610293682, 'auprc': 0.7390452858634451, 'loss_val': 1.0987078587024723, 'psi': 0.7282221109629989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=63 head_norm_before_train=2.088299 cos_to_last_merge=0.9274 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=63 local utility u=0.230576 metrics={'f1_val': 0.964063258313025, 'auprc': 0.9955320718357248, 'loss_val': 0.08672613455753449, 'psi': 0.9766507837221048}-{'f1_val': 0.9103538007983669, 'auprc': 0.9873971367090688, 'loss_val': 0.2012165945789916, 'psi': 0.9411711351626477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=63 head_norm_before_train=1.649430 cos_to_last_merge=0.8750 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.875
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.9514595103157636, 'auprc': 0.9481427898346184, 'loss_val': 0.3011313201475118, 'psi': 0.9501328221233055}-{'f1_val': 0.9497330433667946, 'auprc': 0.9514849104586081, 'loss_val': 0.30051507863230437, 'psi': 0.95043379020352}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=2.041506 (no previous merge yet)
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9984245552439339, 'loss_val': 0.021112442540227372, 'psi': 0.9973910031846482}-{'f1_val': 0.9967019684784577, 'auprc': 0.999812641517495, 'loss_val': 0.021453687045751485, 'psi': 0.9979462376940726}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=1.826746 cos_to_last_merge=0.8742 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.874
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.5462813947607166, 'auprc': 0.7975949508432312, 'loss_val': 0.8290027240351557, 'psi': 0.6468068171937225}-{'f1_val': 0.8171917817066234, 'auprc': 0.9660999140369031, 'loss_val': 0.4174484117687228, 'psi': 0.8767550346387353}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=1.554296 cos_to_last_merge=0.8690 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.869
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.6120001044788169, 'auprc': 0.7950737622274676, 'loss_val': 0.6716438023038659, 'psi': 0.6852295675782772}-{'f1_val': 0.6556440026887945, 'auprc': 0.8111968215793256, 'loss_val': 0.4184224840320935, 'psi': 0.717865130245007}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.982016 cos_to_last_merge=0.9539 (last merge round=13)
[S8] round=63 local utility u=0.000000 metrics={'f1_val': 0.990736079195671, 'auprc': 0.9991054323309649, 'loss_val': 0.03616840097062767, 'psi': 0.9940838204497886}-{'f1_val': 0.9929024225986427, 'auprc': 0.9991698945271255, 'loss_val': 0.030024869382273285, 'psi': 0.9954094113700358}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=63 head_norm_before_train=1.859351 cos_to_last_merge=0.9318 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.932
[S9] round=63 local utility u=0.009592 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9983487305780211, 'loss_val': 0.019541879744803203, 'psi': 0.9970871612107399}-{'f1_val': 0.9962500947792776, 'auprc': 0.9924099548771206, 'loss_val': 0.020933751762552494, 'psi': 0.9947140388184148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=63 head_norm_before_train=1.956117 cos_to_last_merge=0.9146 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9961397845982184, 'loss_val': 0.024364641036637383, 'psi': 0.9953050793709108}-{'f1_val': 0.9949681865317428, 'auprc': 0.9960352184059491, 'loss_val': 0.02478827174674747, 'psi': 0.9953949992814253}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=2.238109 (no previous merge yet)
[S11] round=63 local utility u=0.000064 metrics={'f1_val': 0.9938632294089428, 'auprc': 0.9994130100464215, 'loss_val': 0.025892957675077096, 'psi': 0.9960831416639343}-{'f1_val': 0.9938632294089428, 'auprc': 0.9994150117720235, 'loss_val': 0.026026282059254086, 'psi': 0.9960839423541751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=63 head_norm_before_train=1.835863 (no previous merge yet)
[S13] round=63 local utility u=0.062463 metrics={'f1_val': 0.6311373737882715, 'auprc': 0.7555022317821923, 'loss_val': 0.7950739438391151, 'psi': 0.6808833169858399}-{'f1_val': 0.622776299086857, 'auprc': 0.7431499431718219, 'loss_val': 0.832776341279844, 'psi': 0.670925756720843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=63 head_norm_before_train=2.032636 cos_to_last_merge=0.9743 (last merge round=17)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988566901267719, 'loss_val': 0.019250369226714043, 'psi': 0.9982211822066455}-{'f1_val': 0.9977998904431125, 'auprc': 0.9992344028844458, 'loss_val': 0.018519316672239446, 'psi': 0.9983736954196457}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=1.824913 cos_to_last_merge=0.9191 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.919
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.7033204863594102, 'auprc': 0.9613636866617855, 'loss_val': 0.5775689154413475, 'psi': 0.8065377664803604}-{'f1_val': 0.9840545113927044, 'auprc': 0.9977417241643609, 'loss_val': 0.04048020090843597, 'psi': 0.9895293965013671}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.855697 cos_to_last_merge=0.9262 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.8439675024418548, 'auprc': 0.9856891941056515, 'loss_val': 0.5088332654462489, 'psi': 0.9006561791073735}-{'f1_val': 0.9922702894642583, 'auprc': 0.991341269790173, 'loss_val': 0.039091627521435024, 'psi': 0.9918986815946241}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=1.741857 cos_to_last_merge=0.8829 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.883
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.61620791727264, 'auprc': 0.7985210475623172, 'loss_val': 1.378950996380286, 'psi': 0.6891331693885109}-{'f1_val': 0.6309814245675487, 'auprc': 0.8391201562981511, 'loss_val': 1.2840705338822032, 'psi': 0.7142369172597897}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=1.882106 cos_to_last_merge=0.7256 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.726
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.7205566596674691, 'auprc': 0.7374475033586756, 'loss_val': 1.0833655562173843, 'psi': 0.7273129971439517}-{'f1_val': 0.7211589665456257, 'auprc': 0.7408693953910402, 'loss_val': 1.0277560500979925, 'psi': 0.7290431380837916}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=2.090437 cos_to_last_merge=0.9268 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=64 local utility u=0.101291 metrics={'f1_val': 0.9892955302200809, 'auprc': 0.9987437936164658, 'loss_val': 0.045173610460879116, 'psi': 0.9930748355786349}-{'f1_val': 0.964063258313025, 'auprc': 0.9955320718357248, 'loss_val': 0.08672613455753449, 'psi': 0.9766507837221048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=64 head_norm_before_train=1.657644 cos_to_last_merge=0.8740 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.874
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9469109845853833, 'auprc': 0.9501651768311695, 'loss_val': 0.30817569235358977, 'psi': 0.9482126614836979}-{'f1_val': 0.9514595103157636, 'auprc': 0.9481427898346184, 'loss_val': 0.3011313201475118, 'psi': 0.9501328221233055}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=2.051292 (no previous merge yet)
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.948671108667142, 'auprc': 0.9920581451531096, 'loss_val': 0.08167038081772338, 'psi': 0.966025923261529}-{'f1_val': 0.9967019684784577, 'auprc': 0.9984245552439339, 'loss_val': 0.021112442540227372, 'psi': 0.9973910031846482}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=1.833339 cos_to_last_merge=0.8733 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=64 local utility u=1.000000 metrics={'f1_val': 0.8376696906807711, 'auprc': 0.9791578501535365, 'loss_val': 0.348979634244313, 'psi': 0.8942649544698773}-{'f1_val': 0.5462813947607166, 'auprc': 0.7975949508432312, 'loss_val': 0.8290027240351557, 'psi': 0.6468068171937225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=64 head_norm_before_train=1.560588 cos_to_last_merge=0.8679 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.868
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.5969516513731558, 'auprc': 0.7938991226309243, 'loss_val': 0.7523228227887797, 'psi': 0.6757306398762633}-{'f1_val': 0.6120001044788169, 'auprc': 0.7950737622274676, 'loss_val': 0.6716438023038659, 'psi': 0.6852295675782772}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=64 head_norm_before_train=1.987051 cos_to_last_merge=0.9537 (last merge round=13)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9674134413062678, 'auprc': 0.9987418244849398, 'loss_val': 0.10224610902312517, 'psi': 0.9799447945777366}-{'f1_val': 0.990736079195671, 'auprc': 0.9991054323309649, 'loss_val': 0.03616840097062767, 'psi': 0.9940838204497886}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=1.866547 cos_to_last_merge=0.9312 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.931
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9852543644376418, 'auprc': 0.9982627957289184, 'loss_val': 0.05369893444849761, 'psi': 0.9904577369541525}-{'f1_val': 0.9962461149658858, 'auprc': 0.9983487305780211, 'loss_val': 0.019541879744803203, 'psi': 0.9970871612107399}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=1.961585 cos_to_last_merge=0.9141 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=64 local utility u=0.000691 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9961915699093655, 'loss_val': 0.02445633449220183, 'psi': 0.9954575398827918}-{'f1_val': 0.9947486092193725, 'auprc': 0.9961397845982184, 'loss_val': 0.024364641036637383, 'psi': 0.9953050793709108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=64 head_norm_before_train=2.242075 (no previous merge yet)
[S11] round=64 local utility u=0.013540 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9994171488992576, 'loss_val': 0.014951452541632665, 'psi': 0.9976974125567614}-{'f1_val': 0.9938632294089428, 'auprc': 0.9994130100464215, 'loss_val': 0.025892957675077096, 'psi': 0.9960831416639343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=64 head_norm_before_train=1.839872 (no previous merge yet)
[S13] round=64 local utility u=0.125049 metrics={'f1_val': 0.6630286046296124, 'auprc': 0.775532303017667, 'loss_val': 0.7964136339911694, 'psi': 0.7080300839848342}-{'f1_val': 0.6311373737882715, 'auprc': 0.7555022317821923, 'loss_val': 0.7950739438391151, 'psi': 0.6808833169858399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=64 head_norm_before_train=2.037374 cos_to_last_merge=0.9740 (last merge round=17)
[S14] round=64 local utility u=0.000534 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9988566901267719, 'loss_val': 0.01819576638351944, 'psi': 0.9982226103165762}-{'f1_val': 0.9977975102598944, 'auprc': 0.9988566901267719, 'loss_val': 0.019250369226714043, 'psi': 0.9982211822066455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=64 head_norm_before_train=1.832603 cos_to_last_merge=0.9185 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.918
[S15] round=64 local utility u=0.197273 metrics={'f1_val': 0.7485843832123515, 'auprc': 0.9867371693463596, 'loss_val': 0.5307275891021126, 'psi': 0.8438454976659547}-{'f1_val': 0.7033204863594102, 'auprc': 0.9613636866617855, 'loss_val': 0.5775689154413475, 'psi': 0.8065377664803604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=64 head_norm_before_train=1.859080 cos_to_last_merge=0.9258 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=64 local utility u=0.316994 metrics={'f1_val': 0.9329078104586417, 'auprc': 0.9787584428786411, 'loss_val': 0.3876944426482127, 'psi': 0.9512480634266415}-{'f1_val': 0.8439675024418548, 'auprc': 0.9856891941056515, 'loss_val': 0.5088332654462489, 'psi': 0.9006561791073735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=64 head_norm_before_train=1.751305 cos_to_last_merge=0.8817 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.882
[S17] round=64 local utility u=0.145117 metrics={'f1_val': 0.6331796283895521, 'auprc': 0.8261527994919453, 'loss_val': 1.2734421998281829, 'psi': 0.7103688968305094}-{'f1_val': 0.61620791727264, 'auprc': 0.7985210475623172, 'loss_val': 1.378950996380286, 'psi': 0.6891331693885109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=65 head_norm_before_train=1.885903 cos_to_last_merge=0.7254 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.725
[S2] round=65 local utility u=0.032897 metrics={'f1_val': 0.7208688053411045, 'auprc': 0.740060591947056, 'loss_val': 1.0272840675093067, 'psi': 0.7285455199834852}-{'f1_val': 0.7205566596674691, 'auprc': 0.7374475033586756, 'loss_val': 1.0833655562173843, 'psi': 0.7273129971439517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=65 head_norm_before_train=2.094659 cos_to_last_merge=0.9261 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.900581410921752, 'auprc': 0.9956825062296865, 'loss_val': 0.18434811607470877, 'psi': 0.9386218490449257}-{'f1_val': 0.9892955302200809, 'auprc': 0.9987437936164658, 'loss_val': 0.045173610460879116, 'psi': 0.9930748355786349}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.663454 cos_to_last_merge=0.8733 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=65 local utility u=0.010343 metrics={'f1_val': 0.9512284356056111, 'auprc': 0.9479542382211654, 'loss_val': 0.3067615125787048, 'psi': 0.9499187566518328}-{'f1_val': 0.9469109845853833, 'auprc': 0.9501651768311695, 'loss_val': 0.30817569235358977, 'psi': 0.9482126614836979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=65 head_norm_before_train=2.059393 (no previous merge yet)
[S5] round=65 local utility u=0.186564 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9998108394982154, 'loss_val': 0.019986295687943013, 'psi': 0.9979455168863607}-{'f1_val': 0.948671108667142, 'auprc': 0.9920581451531096, 'loss_val': 0.08167038081772338, 'psi': 0.966025923261529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=65 head_norm_before_train=1.838311 cos_to_last_merge=0.8731 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.7714846382800491, 'auprc': 0.9680478203102415, 'loss_val': 0.5021736675460172, 'psi': 0.8501099110921261}-{'f1_val': 0.8376696906807711, 'auprc': 0.9791578501535365, 'loss_val': 0.348979634244313, 'psi': 0.8942649544698773}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=1.568566 cos_to_last_merge=0.8664 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.866
[S7] round=65 local utility u=0.160167 metrics={'f1_val': 0.623686369621977, 'auprc': 0.8013965202298767, 'loss_val': 0.6148899904091238, 'psi': 0.6947704298651369}-{'f1_val': 0.5969516513731558, 'auprc': 0.7938991226309243, 'loss_val': 0.7523228227887797, 'psi': 0.6757306398762633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=65 head_norm_before_train=1.990448 cos_to_last_merge=0.9532 (last merge round=13)
[S8] round=65 local utility u=0.114577 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9993249958952303, 'loss_val': 0.02996574080907699, 'psi': 0.9956904002790161}-{'f1_val': 0.9674134413062678, 'auprc': 0.9987418244849398, 'loss_val': 0.10224610902312517, 'psi': 0.9799447945777366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=65 head_norm_before_train=1.872439 cos_to_last_merge=0.9307 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.931
[S9] round=65 local utility u=0.046324 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9951454508688302, 'loss_val': 0.020136433271010234, 'psi': 0.996054487435867}-{'f1_val': 0.9852543644376418, 'auprc': 0.9982627957289184, 'loss_val': 0.05369893444849761, 'psi': 0.9904577369541525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=65 head_norm_before_train=1.967862 cos_to_last_merge=0.9135 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9961811340672478, 'loss_val': 0.024426791322843023, 'psi': 0.9954533655459448}-{'f1_val': 0.9949681865317428, 'auprc': 0.9961915699093655, 'loss_val': 0.02445633449220183, 'psi': 0.9954575398827918}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=2.246908 (no previous merge yet)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9994309789389285, 'loss_val': 0.015328168610658334, 'psi': 0.9977029445726298}-{'f1_val': 0.9965509216617638, 'auprc': 0.9994171488992576, 'loss_val': 0.014951452541632665, 'psi': 0.9976974125567614}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.847404 (no previous merge yet)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.63892916384231, 'auprc': 0.7458140057343867, 'loss_val': 0.9037454577384273, 'psi': 0.6816831005991407}-{'f1_val': 0.6630286046296124, 'auprc': 0.775532303017667, 'loss_val': 0.7964136339911694, 'psi': 0.7080300839848342}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=2.044533 cos_to_last_merge=0.9736 (last merge round=17)
[S14] round=65 local utility u=0.001069 metrics={'f1_val': 0.9982111419559175, 'auprc': 0.9988566901267719, 'loss_val': 0.018525603807002904, 'psi': 0.9984693612242593}-{'f1_val': 0.9977998904431125, 'auprc': 0.9988566901267719, 'loss_val': 0.01819576638351944, 'psi': 0.9982226103165762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=65 head_norm_before_train=1.840354 cos_to_last_merge=0.9178 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.918
[S15] round=65 local utility u=1.000000 metrics={'f1_val': 0.994670400252284, 'auprc': 0.9977085197346545, 'loss_val': 0.030519941021510583, 'psi': 0.9958856480452323}-{'f1_val': 0.7485843832123515, 'auprc': 0.9867371693463596, 'loss_val': 0.5307275891021126, 'psi': 0.8438454976659547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=65 head_norm_before_train=1.863975 cos_to_last_merge=0.9253 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.8454069308789274, 'auprc': 0.8809975032560714, 'loss_val': 1.0790732919158377, 'psi': 0.8596431598297849}-{'f1_val': 0.9329078104586417, 'auprc': 0.9787584428786411, 'loss_val': 0.3876944426482127, 'psi': 0.9512480634266415}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.759281 cos_to_last_merge=0.8806 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.881
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.615970728687834, 'auprc': 0.8079920621083415, 'loss_val': 1.279878026718548, 'psi': 0.692779262056037}-{'f1_val': 0.6331796283895521, 'auprc': 0.8261527994919453, 'loss_val': 1.2734421998281829, 'psi': 0.7103688968305094}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=66 head_norm_before_train=1.891078 cos_to_last_merge=0.7250 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.725
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.7212250415731518, 'auprc': 0.7393997805960346, 'loss_val': 1.0458601519937556, 'psi': 0.728494937182305}-{'f1_val': 0.7208688053411045, 'auprc': 0.740060591947056, 'loss_val': 1.0272840675093067, 'psi': 0.7285455199834852}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=66 head_norm_before_train=2.100564 cos_to_last_merge=0.9254 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=66 local utility u=0.055201 metrics={'f1_val': 0.9287456718982579, 'auprc': 0.9922532503629135, 'loss_val': 0.23264487114574312, 'psi': 0.95414870328412}-{'f1_val': 0.900581410921752, 'auprc': 0.9956825062296865, 'loss_val': 0.18434811607470877, 'psi': 0.9386218490449257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=66 head_norm_before_train=1.667416 cos_to_last_merge=0.8731 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=66 local utility u=0.001717 metrics={'f1_val': 0.953089579268041, 'auprc': 0.9460605036127565, 'loss_val': 0.3088122147808481, 'psi': 0.9502779490059272}-{'f1_val': 0.9512284356056111, 'auprc': 0.9479542382211654, 'loss_val': 0.3067615125787048, 'psi': 0.9499187566518328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=66 head_norm_before_train=2.064995 (no previous merge yet)
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.99981318599084, 'loss_val': 0.02022908155550466, 'psi': 0.9979464554834105}-{'f1_val': 0.9967019684784577, 'auprc': 0.9998108394982154, 'loss_val': 0.019986295687943013, 'psi': 0.9979455168863607}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=66 head_norm_before_train=1.843940 cos_to_last_merge=0.8728 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.6836007945886817, 'auprc': 0.7844363770768914, 'loss_val': 0.9497159907491928, 'psi': 0.7239350275839656}-{'f1_val': 0.7714846382800491, 'auprc': 0.9680478203102415, 'loss_val': 0.5021736675460172, 'psi': 0.8501099110921261}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.575437 cos_to_last_merge=0.8652 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.865
[S7] round=66 local utility u=0.125887 metrics={'f1_val': 0.6468651574088174, 'auprc': 0.805096439595042, 'loss_val': 0.513288505898127, 'psi': 0.7101576702833072}-{'f1_val': 0.623686369621977, 'auprc': 0.8013965202298767, 'loss_val': 0.6148899904091238, 'psi': 0.6947704298651369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=66 head_norm_before_train=1.993992 cos_to_last_merge=0.9530 (last merge round=13)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9896558900940475, 'auprc': 0.9991372194033025, 'loss_val': 0.038909927489198616, 'psi': 0.9934484218177495}-{'f1_val': 0.9932673365348732, 'auprc': 0.9993249958952303, 'loss_val': 0.02996574080907699, 'psi': 0.9956904002790161}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=1.876977 cos_to_last_merge=0.9305 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=66 local utility u=0.005423 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985823639168669, 'loss_val': 0.019602100053084028, 'psi': 0.9974292526550816}-{'f1_val': 0.9966605118138915, 'auprc': 0.9951454508688302, 'loss_val': 0.020136433271010234, 'psi': 0.996054487435867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=66 head_norm_before_train=1.974593 cos_to_last_merge=0.9129 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956519305246734, 'loss_val': 0.02436130629492015, 'psi': 0.9952416841289151}-{'f1_val': 0.9949681865317428, 'auprc': 0.9961811340672478, 'loss_val': 0.024426791322843023, 'psi': 0.9954533655459448}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=2.251249 (no previous merge yet)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9912350492957716, 'auprc': 0.9994854972321855, 'loss_val': 0.03458290929555582, 'psi': 0.994535228470337}-{'f1_val': 0.9965509216617638, 'auprc': 0.9994309789389285, 'loss_val': 0.015328168610658334, 'psi': 0.9977029445726298}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.853509 (no previous merge yet)
[S13] round=66 local utility u=0.093724 metrics={'f1_val': 0.634825811100471, 'auprc': 0.7743347769314639, 'loss_val': 0.7772393030322299, 'psi': 0.6906293974328681}-{'f1_val': 0.63892916384231, 'auprc': 0.7458140057343867, 'loss_val': 0.9037454577384273, 'psi': 0.6816831005991407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=66 head_norm_before_train=2.050045 cos_to_last_merge=0.9732 (last merge round=17)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9988566901267719, 'loss_val': 0.02309146315350674, 'psi': 0.9979727060679127}-{'f1_val': 0.9982111419559175, 'auprc': 0.9988566901267719, 'loss_val': 0.018525603807002904, 'psi': 0.9984693612242593}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=1.847733 cos_to_last_merge=0.9172 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.917
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.8932865463932466, 'auprc': 0.995773253354527, 'loss_val': 0.20347896367324433, 'psi': 0.9342812291777588}-{'f1_val': 0.994670400252284, 'auprc': 0.9977085197346545, 'loss_val': 0.030519941021510583, 'psi': 0.9958856480452323}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=1.868211 cos_to_last_merge=0.9245 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=66 local utility u=0.059647 metrics={'f1_val': 0.8503584072578229, 'auprc': 0.8908334100148685, 'loss_val': 1.0189949466464738, 'psi': 0.8665484083606411}-{'f1_val': 0.8454069308789274, 'auprc': 0.8809975032560714, 'loss_val': 1.0790732919158377, 'psi': 0.8596431598297849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=66 head_norm_before_train=1.769496 cos_to_last_merge=0.8800 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.611207491981869, 'auprc': 0.7226937229217061, 'loss_val': 1.464491260630594, 'psi': 0.6558019843578038}-{'f1_val': 0.615970728687834, 'auprc': 0.8079920621083415, 'loss_val': 1.279878026718548, 'psi': 0.692779262056037}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=1.896051 cos_to_last_merge=0.7246 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.725
[S2] round=67 local utility u=0.076748 metrics={'f1_val': 0.7205757634405687, 'auprc': 0.7673604577987205, 'loss_val': 0.9723502967381122, 'psi': 0.7392896411838294}-{'f1_val': 0.7212250415731518, 'auprc': 0.7393997805960346, 'loss_val': 1.0458601519937556, 'psi': 0.728494937182305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=67 head_norm_before_train=2.107743 cos_to_last_merge=0.9249 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.7702104313758955, 'auprc': 0.987918411193536, 'loss_val': 0.4236575955233429, 'psi': 0.8572936233029517}-{'f1_val': 0.9287456718982579, 'auprc': 0.9922532503629135, 'loss_val': 0.23264487114574312, 'psi': 0.95414870328412}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.674004 cos_to_last_merge=0.8726 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9512083093658943, 'auprc': 0.9479006222673011, 'loss_val': 0.308419905445567, 'psi': 0.949885234526457}-{'f1_val': 0.953089579268041, 'auprc': 0.9460605036127565, 'loss_val': 0.3088122147808481, 'psi': 0.9502779490059272}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=2.069586 (no previous merge yet)
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9934602425499202, 'loss_val': 0.026261039095081526, 'psi': 0.9951843841981021}-{'f1_val': 0.9967019684784577, 'auprc': 0.99981318599084, 'loss_val': 0.02022908155550466, 'psi': 0.9979464554834105}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.850024 cos_to_last_merge=0.8720 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=67 local utility u=0.618594 metrics={'f1_val': 0.7704365566950456, 'auprc': 0.9434673599657154, 'loss_val': 0.710635596308058, 'psi': 0.8396488780033136}-{'f1_val': 0.6836007945886817, 'auprc': 0.7844363770768914, 'loss_val': 0.9497159907491928, 'psi': 0.7239350275839656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=67 head_norm_before_train=1.581884 cos_to_last_merge=0.8642 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.864
[S7] round=67 local utility u=0.397178 metrics={'f1_val': 0.7235100428193467, 'auprc': 0.8453419413911654, 'loss_val': 0.2995392560888782, 'psi': 0.7722428022480742}-{'f1_val': 0.6468651574088174, 'auprc': 0.805096439595042, 'loss_val': 0.513288505898127, 'psi': 0.7101576702833072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=67 head_norm_before_train=1.998415 cos_to_last_merge=0.9529 (last merge round=13)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9733882828048239, 'auprc': 0.9992800798555952, 'loss_val': 0.07502630869338045, 'psi': 0.9837450016251323}-{'f1_val': 0.9896558900940475, 'auprc': 0.9991372194033025, 'loss_val': 0.038909927489198616, 'psi': 0.9934484218177495}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=1.882370 cos_to_last_merge=0.9302 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9989287274342766, 'loss_val': 0.022820048159098553, 'psi': 0.9960675509973846}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985823639168669, 'loss_val': 0.019602100053084028, 'psi': 0.9974292526550816}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=1.981544 cos_to_last_merge=0.9122 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=67 local utility u=0.000787 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9962383506267753, 'loss_val': 0.024546729815762818, 'psi': 0.9954762521697558}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956519305246734, 'loss_val': 0.02436130629492015, 'psi': 0.9952416841289151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=67 head_norm_before_train=2.252897 (no previous merge yet)
[S11] round=67 local utility u=0.022829 metrics={'f1_val': 0.9960242359117597, 'auprc': 0.9994943768865592, 'loss_val': 0.017687436968859778, 'psi': 0.9974122923016795}-{'f1_val': 0.9912350492957716, 'auprc': 0.9994854972321855, 'loss_val': 0.03458290929555582, 'psi': 0.994535228470337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=67 head_norm_before_train=1.857322 (no previous merge yet)
[S13] round=67 local utility u=0.127471 metrics={'f1_val': 0.6639654608120966, 'auprc': 0.7834058011339374, 'loss_val': 0.7243476691257638, 'psi': 0.7117415969408329}-{'f1_val': 0.634825811100471, 'auprc': 0.7743347769314639, 'loss_val': 0.7772393030322299, 'psi': 0.6906293974328681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=67 head_norm_before_train=2.052339 cos_to_last_merge=0.9728 (last merge round=17)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9781951167977854, 'auprc': 0.9988566901267719, 'loss_val': 0.04551714436788943, 'psi': 0.98645974612938}-{'f1_val': 0.9973833833620065, 'auprc': 0.9988566901267719, 'loss_val': 0.02309146315350674, 'psi': 0.9979727060679127}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=1.854711 cos_to_last_merge=0.9167 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.917
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.8097039897704352, 'auprc': 0.9934183769945435, 'loss_val': 0.381751841781946, 'psi': 0.8831897446600785}-{'f1_val': 0.8932865463932466, 'auprc': 0.995773253354527, 'loss_val': 0.20347896367324433, 'psi': 0.9342812291777588}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.873221 cos_to_last_merge=0.9238 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=67 local utility u=0.095012 metrics={'f1_val': 0.8671720549452776, 'auprc': 0.8525873620714519, 'loss_val': 0.8151146084649533, 'psi': 0.8613381777957473}-{'f1_val': 0.8503584072578229, 'auprc': 0.8908334100148685, 'loss_val': 1.0189949466464738, 'psi': 0.8665484083606411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=67 head_norm_before_train=1.778980 cos_to_last_merge=0.8794 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.879
[S17] round=67 local utility u=0.283008 metrics={'f1_val': 0.631490624626122, 'auprc': 0.8362948999896401, 'loss_val': 1.360978000754167, 'psi': 0.7134123347715293}-{'f1_val': 0.611207491981869, 'auprc': 0.7226937229217061, 'loss_val': 1.464491260630594, 'psi': 0.6558019843578038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=68 head_norm_before_train=1.902653 cos_to_last_merge=0.7242 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.724
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.7212250415731518, 'auprc': 0.7393885686074197, 'loss_val': 1.05691520531375, 'psi': 0.7284904523868589}-{'f1_val': 0.7205757634405687, 'auprc': 0.7673604577987205, 'loss_val': 0.9723502967381122, 'psi': 0.7392896411838294}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.114663 cos_to_last_merge=0.9244 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=68 local utility u=0.864245 metrics={'f1_val': 0.9872687231472141, 'auprc': 0.9987256429007801, 'loss_val': 0.029938403247503992, 'psi': 0.9918514910486406}-{'f1_val': 0.7702104313758955, 'auprc': 0.987918411193536, 'loss_val': 0.4236575955233429, 'psi': 0.8572936233029517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] sending update (kind=head size=1790 to 1 peers)
[S4] START round=68 head_norm_before_train=1.677689 cos_to_last_merge=0.8724 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.872
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9485637263805884, 'auprc': 0.9472509603667378, 'loss_val': 0.3125451864764516, 'psi': 0.9480386199750481}-{'f1_val': 0.9512083093658943, 'auprc': 0.9479006222673011, 'loss_val': 0.308419905445567, 'psi': 0.949885234526457}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=2.073653 (no previous merge yet)
[S5] round=68 local utility u=0.005280 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9953142711690716, 'loss_val': 0.02126326524798286, 'psi': 0.9959259956457627}-{'f1_val': 0.9963338119635569, 'auprc': 0.9934602425499202, 'loss_val': 0.026261039095081526, 'psi': 0.9951843841981021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=68 head_norm_before_train=1.855580 cos_to_last_merge=0.8706 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.871
[S6] round=68 local utility u=0.580844 metrics={'f1_val': 0.8732877508114056, 'auprc': 0.9755777278546749, 'loss_val': 0.2623867804554691, 'psi': 0.9142037416287134}-{'f1_val': 0.7704365566950456, 'auprc': 0.9434673599657154, 'loss_val': 0.710635596308058, 'psi': 0.8396488780033136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=68 head_norm_before_train=1.587997 cos_to_last_merge=0.8633 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.863
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.612150173491526, 'auprc': 0.7964174120516361, 'loss_val': 0.5473325957906243, 'psi': 0.6858570689155701}-{'f1_val': 0.7235100428193467, 'auprc': 0.8453419413911654, 'loss_val': 0.2995392560888782, 'psi': 0.7722428022480742}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=2.004515 cos_to_last_merge=0.9526 (last merge round=13)
[S8] round=68 local utility u=0.074101 metrics={'f1_val': 0.991097207355627, 'auprc': 0.9993907822490506, 'loss_val': 0.033410848334991416, 'psi': 0.9944146373129965}-{'f1_val': 0.9733882828048239, 'auprc': 0.9992800798555952, 'loss_val': 0.07502630869338045, 'psi': 0.9837450016251323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=68 head_norm_before_train=1.888178 cos_to_last_merge=0.9298 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=68 local utility u=0.008285 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9982288139960412, 'loss_val': 0.01913243624433731, 'psi': 0.9972857327780632}-{'f1_val': 0.9941601000394567, 'auprc': 0.9989287274342766, 'loss_val': 0.022820048159098553, 'psi': 0.9960675509973846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=68 head_norm_before_train=1.984658 cos_to_last_merge=0.9117 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=68 local utility u=0.000058 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9962693806211997, 'loss_val': 0.02452450781287842, 'psi': 0.9954886641675256}-{'f1_val': 0.9949681865317428, 'auprc': 0.9962383506267753, 'loss_val': 0.024546729815762818, 'psi': 0.9954762521697558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=68 head_norm_before_train=2.255716 (no previous merge yet)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9948224703548484, 'auprc': 0.9995329964468347, 'loss_val': 0.02190559808788205, 'psi': 0.9967066807916429}-{'f1_val': 0.9960242359117597, 'auprc': 0.9994943768865592, 'loss_val': 0.017687436968859778, 'psi': 0.9974122923016795}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.859894 (no previous merge yet)
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6135406965604411, 'auprc': 0.7000410930835246, 'loss_val': 1.0373472289787586, 'psi': 0.6481408551696746}-{'f1_val': 0.6639654608120966, 'auprc': 0.7834058011339374, 'loss_val': 0.7243476691257638, 'psi': 0.7117415969408329}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=2.054354 cos_to_last_merge=0.9726 (last merge round=17)
[S14] round=68 local utility u=0.073210 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9992360565172884, 'loss_val': 0.020461894134714245, 'psi': 0.9986342290832384}-{'f1_val': 0.9781951167977854, 'auprc': 0.9988566901267719, 'loss_val': 0.04551714436788943, 'psi': 0.98645974612938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=68 head_norm_before_train=1.860964 cos_to_last_merge=0.9161 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.7033204863594102, 'auprc': 0.9771391619843208, 'loss_val': 0.5893914064352768, 'psi': 0.8128479566093745}-{'f1_val': 0.8097039897704352, 'auprc': 0.9934183769945435, 'loss_val': 0.381751841781946, 'psi': 0.8831897446600785}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=1.878581 cos_to_last_merge=0.9232 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=68 local utility u=0.964079 metrics={'f1_val': 0.9928136050251588, 'auprc': 0.9851062772506747, 'loss_val': 0.03836299279748144, 'psi': 0.9897306739153652}-{'f1_val': 0.8671720549452776, 'auprc': 0.8525873620714519, 'loss_val': 0.8151146084649533, 'psi': 0.8613381777957473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=68 head_norm_before_train=1.786948 cos_to_last_merge=0.8786 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.879
[S17] round=68 local utility u=1.000000 metrics={'f1_val': 0.8007240653444998, 'auprc': 0.9685524660012097, 'loss_val': 0.6828146442421286, 'psi': 0.8678554256071838}-{'f1_val': 0.631490624626122, 'auprc': 0.8362948999896401, 'loss_val': 1.360978000754167, 'psi': 0.7134123347715293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=69 head_norm_before_train=1.908810 cos_to_last_merge=0.7237 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.724
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.7203317942224237, 'auprc': 0.7346015261381554, 'loss_val': 1.076373398401793, 'psi': 0.7260396869887163}-{'f1_val': 0.7212250415731518, 'auprc': 0.7393885686074197, 'loss_val': 1.05691520531375, 'psi': 0.7284904523868589}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.122422 cos_to_last_merge=0.9239 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=69 local utility u=0.035201 metrics={'f1_val': 0.9973415147416245, 'auprc': 0.9981978186818692, 'loss_val': 0.018389199000388573, 'psi': 0.9976840363177224}-{'f1_val': 0.9872687231472141, 'auprc': 0.9987256429007801, 'loss_val': 0.029938403247503992, 'psi': 0.9918514910486406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=69 head_norm_before_train=1.678626 cos_to_last_merge=0.8719 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.872
[S4] round=69 local utility u=0.014682 metrics={'f1_val': 0.9489989524107962, 'auprc': 0.9543618612075324, 'loss_val': 0.30712440887349907, 'psi': 0.9511441159294907}-{'f1_val': 0.9485637263805884, 'auprc': 0.9472509603667378, 'loss_val': 0.3125451864764516, 'psi': 0.9480386199750481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=69 head_norm_before_train=2.077542 (no previous merge yet)
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9932659327811821, 'loss_val': 0.02854176698808879, 'psi': 0.9951066602906069}-{'f1_val': 0.9963338119635569, 'auprc': 0.9953142711690716, 'loss_val': 0.02126326524798286, 'psi': 0.9959259956457627}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.862819 cos_to_last_merge=0.8695 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.870
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.5966907518691172, 'auprc': 0.7420655261902789, 'loss_val': 1.1492076666976705, 'psi': 0.6548406615975819}-{'f1_val': 0.8732877508114056, 'auprc': 0.9755777278546749, 'loss_val': 0.2623867804554691, 'psi': 0.9142037416287134}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=69 head_norm_before_train=1.591410 cos_to_last_merge=0.8629 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.863
[S7] round=69 local utility u=0.203342 metrics={'f1_val': 0.6522810960135152, 'auprc': 0.8097313585242847, 'loss_val': 0.42137633457360973, 'psi': 0.715261201017823}-{'f1_val': 0.612150173491526, 'auprc': 0.7964174120516361, 'loss_val': 0.5473325957906243, 'psi': 0.6858570689155701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=69 head_norm_before_train=2.010480 cos_to_last_merge=0.9522 (last merge round=13)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9717148210529372, 'auprc': 0.9990657326993371, 'loss_val': 0.08328230929625417, 'psi': 0.9826551857114971}-{'f1_val': 0.991097207355627, 'auprc': 0.9993907822490506, 'loss_val': 0.033410848334991416, 'psi': 0.9944146373129965}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=1.893718 cos_to_last_merge=0.9294 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9951289493965654, 'loss_val': 0.019871484410032576, 'psi': 0.996047886846961}-{'f1_val': 0.9966570119660778, 'auprc': 0.9982288139960412, 'loss_val': 0.01913243624433731, 'psi': 0.9972857327780632}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=1.987143 cos_to_last_merge=0.9111 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.911
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956527091402145, 'loss_val': 0.02411995487218316, 'psi': 0.9952419955751315}-{'f1_val': 0.9949681865317428, 'auprc': 0.9962693806211997, 'loss_val': 0.02452450781287842, 'psi': 0.9954886641675256}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=2.259316 (no previous merge yet)
[S11] round=69 local utility u=0.004928 metrics={'f1_val': 0.9957836393690515, 'auprc': 0.9995362827766545, 'loss_val': 0.017825711119581405, 'psi': 0.9972846967320927}-{'f1_val': 0.9948224703548484, 'auprc': 0.9995329964468347, 'loss_val': 0.02190559808788205, 'psi': 0.9967066807916429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=69 head_norm_before_train=1.863183 (no previous merge yet)
[S13] round=69 local utility u=0.253351 metrics={'f1_val': 0.6848491619851192, 'auprc': 0.7177968420918223, 'loss_val': 1.0117623604240096, 'psi': 0.6980282340278005}-{'f1_val': 0.6135406965604411, 'auprc': 0.7000410930835246, 'loss_val': 1.0373472289787586, 'psi': 0.6481408551696746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=69 head_norm_before_train=2.055004 cos_to_last_merge=0.9722 (last merge round=17)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.999234273596006, 'loss_val': 0.01950416482334878, 'psi': 0.9985324741799346}-{'f1_val': 0.9982330107938716, 'auprc': 0.9992360565172884, 'loss_val': 0.020461894134714245, 'psi': 0.9986342290832384}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=1.866637 cos_to_last_merge=0.9156 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=69 local utility u=0.296107 metrics={'f1_val': 0.7748560717717212, 'auprc': 0.9931583641237027, 'loss_val': 0.4744492691518442, 'psi': 0.8621769887125139}-{'f1_val': 0.7033204863594102, 'auprc': 0.9771391619843208, 'loss_val': 0.5893914064352768, 'psi': 0.8128479566093745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=69 head_norm_before_train=1.884431 cos_to_last_merge=0.9227 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=69 local utility u=0.002846 metrics={'f1_val': 0.9921535770629564, 'auprc': 0.9869244157909467, 'loss_val': 0.03416532551619065, 'psi': 0.9900619125541525}-{'f1_val': 0.9928136050251588, 'auprc': 0.9851062772506747, 'loss_val': 0.03836299279748144, 'psi': 0.9897306739153652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=69 head_norm_before_train=1.793456 cos_to_last_merge=0.8781 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.878
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.6532108721169861, 'auprc': 0.9338765546570548, 'loss_val': 1.157831800996213, 'psi': 0.7654771451330136}-{'f1_val': 0.8007240653444998, 'auprc': 0.9685524660012097, 'loss_val': 0.6828146442421286, 'psi': 0.8678554256071838}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=1.908972 cos_to_last_merge=0.7237 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.724
[S2] round=70 local utility u=0.024897 metrics={'f1_val': 0.7208688053411045, 'auprc': 0.7351704676462267, 'loss_val': 1.0315076339968543, 'psi': 0.7265894702631535}-{'f1_val': 0.7203317942224237, 'auprc': 0.7346015261381554, 'loss_val': 1.076373398401793, 'psi': 0.7260396869887163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=70 head_norm_before_train=2.130183 cos_to_last_merge=0.9234 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.9833701494118764, 'auprc': 0.9981301269311483, 'loss_val': 0.05272138681624176, 'psi': 0.9892741404195851}-{'f1_val': 0.9973415147416245, 'auprc': 0.9981978186818692, 'loss_val': 0.018389199000388573, 'psi': 0.9976840363177224}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=1.680505 cos_to_last_merge=0.8714 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.871
[S4] round=70 local utility u=0.000000 metrics={'f1_val': 0.9153863967807088, 'auprc': 0.9513575847585509, 'loss_val': 0.4002724966243499, 'psi': 0.9297748719718456}-{'f1_val': 0.9489989524107962, 'auprc': 0.9543618612075324, 'loss_val': 0.30712440887349907, 'psi': 0.9511441159294907}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=70 head_norm_before_train=2.080853 (no previous merge yet)
[S5] round=70 local utility u=0.014978 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.99968482873268, 'loss_val': 0.020050776654262043, 'psi': 0.9978951125801466}-{'f1_val': 0.9963338119635569, 'auprc': 0.9932659327811821, 'loss_val': 0.02854176698808879, 'psi': 0.9951066602906069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=70 head_norm_before_train=1.870065 cos_to_last_merge=0.8687 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=70 local utility u=0.242732 metrics={'f1_val': 0.6173310289218428, 'auprc': 0.8131981870015189, 'loss_val': 1.000983225112848, 'psi': 0.6956778921537132}-{'f1_val': 0.5966907518691172, 'auprc': 0.7420655261902789, 'loss_val': 1.1492076666976705, 'psi': 0.6548406615975819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=70 head_norm_before_train=1.595826 cos_to_last_merge=0.8622 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.862
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.5887539206815228, 'auprc': 0.791627570266999, 'loss_val': 0.8429697559148865, 'psi': 0.6699033805157133}-{'f1_val': 0.6522810960135152, 'auprc': 0.8097313585242847, 'loss_val': 0.42137633457360973, 'psi': 0.715261201017823}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=2.014520 cos_to_last_merge=0.9517 (last merge round=13)
[S8] round=70 local utility u=0.082475 metrics={'f1_val': 0.991097207355627, 'auprc': 0.9993034758845658, 'loss_val': 0.035340689834659586, 'psi': 0.9943797147672025}-{'f1_val': 0.9717148210529372, 'auprc': 0.9990657326993371, 'loss_val': 0.08328230929625417, 'psi': 0.9826551857114971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=70 head_norm_before_train=1.899702 cos_to_last_merge=0.9290 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=70 local utility u=0.000396 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9951956243889926, 'loss_val': 0.019280122841733586, 'psi': 0.9960745568439319}-{'f1_val': 0.9966605118138915, 'auprc': 0.9951289493965654, 'loss_val': 0.019871484410032576, 'psi': 0.996047886846961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=70 head_norm_before_train=1.988201 cos_to_last_merge=0.9105 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.910
[S10] round=70 local utility u=0.000174 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956646452793051, 'loss_val': 0.023807802937028208, 'psi': 0.9952467700307677}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956527091402145, 'loss_val': 0.02411995487218316, 'psi': 0.9952419955751315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=70 head_norm_before_train=2.263841 (no previous merge yet)
[S11] round=70 local utility u=0.003859 metrics={'f1_val': 0.9967467623295848, 'auprc': 0.9995357734707929, 'loss_val': 0.015884029137648165, 'psi': 0.9978623667860681}-{'f1_val': 0.9957836393690515, 'auprc': 0.9995362827766545, 'loss_val': 0.017825711119581405, 'psi': 0.9972846967320927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=70 head_norm_before_train=1.866228 (no previous merge yet)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6234484462681009, 'auprc': 0.6593968352528162, 'loss_val': 1.0632183580973278, 'psi': 0.637827801861987}-{'f1_val': 0.6848491619851192, 'auprc': 0.7177968420918223, 'loss_val': 1.0117623604240096, 'psi': 0.6980282340278005}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=2.058487 cos_to_last_merge=0.9720 (last merge round=17)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9755480907512115, 'auprc': 0.9988566901267719, 'loss_val': 0.05061406060549012, 'psi': 0.9848715305014357}-{'f1_val': 0.9980646079025537, 'auprc': 0.999234273596006, 'loss_val': 0.01950416482334878, 'psi': 0.9985324741799346}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=1.872568 cos_to_last_merge=0.9151 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.915
[S15] round=70 local utility u=0.886899 metrics={'f1_val': 0.9940203634900837, 'auprc': 0.9988056398127774, 'loss_val': 0.032578746494787904, 'psi': 0.9959344740191611}-{'f1_val': 0.7748560717717212, 'auprc': 0.9931583641237027, 'loss_val': 0.4744492691518442, 'psi': 0.8621769887125139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=70 head_norm_before_train=1.891132 cos_to_last_merge=0.9220 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=70 local utility u=0.001254 metrics={'f1_val': 0.9930314996196093, 'auprc': 0.9869316687805562, 'loss_val': 0.036946400220633085, 'psi': 0.9905915672839881}-{'f1_val': 0.9921535770629564, 'auprc': 0.9869244157909467, 'loss_val': 0.03416532551619065, 'psi': 0.9900619125541525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=70 head_norm_before_train=1.799387 cos_to_last_merge=0.8778 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.878
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.6301135441781465, 'auprc': 0.8499418441173813, 'loss_val': 1.2401189699004331, 'psi': 0.7180448641538404}-{'f1_val': 0.6532108721169861, 'auprc': 0.9338765546570548, 'loss_val': 1.157831800996213, 'psi': 0.7654771451330136}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=71 head_norm_before_train=1.912249 cos_to_last_merge=0.7234 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.723
[S2] round=71 local utility u=0.059481 metrics={'f1_val': 0.7207992758436184, 'auprc': 0.7567598544080725, 'loss_val': 0.9768957673027516, 'psi': 0.7351835072694}-{'f1_val': 0.7208688053411045, 'auprc': 0.7351704676462267, 'loss_val': 1.0315076339968543, 'psi': 0.7265894702631535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=71 head_norm_before_train=2.136867 cos_to_last_merge=0.9230 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9572051499082004, 'auprc': 0.9901917424513046, 'loss_val': 0.1602776839247942, 'psi': 0.970399786925442}-{'f1_val': 0.9833701494118764, 'auprc': 0.9981301269311483, 'loss_val': 0.05272138681624176, 'psi': 0.9892741404195851}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.683571 cos_to_last_merge=0.8706 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.871
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9061165466684644, 'auprc': 0.9507242756961112, 'loss_val': 0.4185254422870058, 'psi': 0.9239596382795231}-{'f1_val': 0.9153863967807088, 'auprc': 0.9513575847585509, 'loss_val': 0.4002724966243499, 'psi': 0.9297748719718456}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=2.086716 (no previous merge yet)
[S5] round=71 local utility u=0.001157 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9998039452275019, 'loss_val': 0.020299458164540703, 'psi': 0.9981633132576394}-{'f1_val': 0.9967019684784577, 'auprc': 0.99968482873268, 'loss_val': 0.020050776654262043, 'psi': 0.9978951125801466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=71 head_norm_before_train=1.874609 cos_to_last_merge=0.8680 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.868
[S6] round=71 local utility u=1.000000 metrics={'f1_val': 0.7985090217463131, 'auprc': 0.969208055764934, 'loss_val': 0.488114489282368, 'psi': 0.8667886353537615}-{'f1_val': 0.6173310289218428, 'auprc': 0.8131981870015189, 'loss_val': 1.000983225112848, 'psi': 0.6956778921537132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=71 head_norm_before_train=1.600482 cos_to_last_merge=0.8614 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.861
[S7] round=71 local utility u=0.339997 metrics={'f1_val': 0.6543144880050452, 'auprc': 0.8044981553848203, 'loss_val': 0.5949502535680419, 'psi': 0.7143879549569552}-{'f1_val': 0.5887539206815228, 'auprc': 0.791627570266999, 'loss_val': 0.8429697559148865, 'psi': 0.6699033805157133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=71 head_norm_before_train=2.018207 cos_to_last_merge=0.9513 (last merge round=13)
[S8] round=71 local utility u=0.004497 metrics={'f1_val': 0.9918210737370572, 'auprc': 0.9994027329469235, 'loss_val': 0.030987334652010354, 'psi': 0.9948537374210037}-{'f1_val': 0.991097207355627, 'auprc': 0.9993034758845658, 'loss_val': 0.035340689834659586, 'psi': 0.9943797147672025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=71 head_norm_before_train=1.906224 cos_to_last_merge=0.9285 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=71 local utility u=0.001807 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9961615073664557, 'loss_val': 0.018564037125829453, 'psi': 0.9964609100349171}-{'f1_val': 0.9966605118138915, 'auprc': 0.9951956243889926, 'loss_val': 0.019280122841733586, 'psi': 0.9960745568439319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=71 head_norm_before_train=1.992063 cos_to_last_merge=0.9099 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.910
[S10] round=71 local utility u=0.000899 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.996358886983598, 'loss_val': 0.024093034992280927, 'psi': 0.995524466712485}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956646452793051, 'loss_val': 0.023807802937028208, 'psi': 0.9952467700307677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=71 head_norm_before_train=2.268805 (no previous merge yet)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9893323808275926, 'auprc': 0.9995164391592313, 'loss_val': 0.05265100627709748, 'psi': 0.9934060041602482}-{'f1_val': 0.9967467623295848, 'auprc': 0.9995357734707929, 'loss_val': 0.015884029137648165, 'psi': 0.9978623667860681}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.873029 (no previous merge yet)
[S13] round=71 local utility u=0.269666 metrics={'f1_val': 0.6311837955334575, 'auprc': 0.7862985946446002, 'loss_val': 0.951003229863584, 'psi': 0.6932297151779145}-{'f1_val': 0.6234484462681009, 'auprc': 0.6593968352528162, 'loss_val': 1.0632183580973278, 'psi': 0.637827801861987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=71 head_norm_before_train=2.061358 cos_to_last_merge=0.9719 (last merge round=17)
[S14] round=71 local utility u=0.080303 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9992360544626789, 'loss_val': 0.022290756311980253, 'psi': 0.9981377396166622}-{'f1_val': 0.9755480907512115, 'auprc': 0.9988566901267719, 'loss_val': 0.05061406060549012, 'psi': 0.9848715305014357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=71 head_norm_before_train=1.878521 cos_to_last_merge=0.9146 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.915
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.9887702315776579, 'auprc': 0.9983976577207649, 'loss_val': 0.05683543870207146, 'psi': 0.9926212020349008}-{'f1_val': 0.9940203634900837, 'auprc': 0.9988056398127774, 'loss_val': 0.032578746494787904, 'psi': 0.9959344740191611}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=1.897910 cos_to_last_merge=0.9214 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9921529403166653, 'auprc': 0.9887550920312989, 'loss_val': 0.04205576845319815, 'psi': 0.9907938010025188}-{'f1_val': 0.9930314996196093, 'auprc': 0.9869316687805562, 'loss_val': 0.036946400220633085, 'psi': 0.9905915672839881}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=1.807233 cos_to_last_merge=0.8774 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.614829192241631, 'auprc': 0.7715595944346461, 'loss_val': 1.1776363677685253, 'psi': 0.6775213531188371}-{'f1_val': 0.6301135441781465, 'auprc': 0.8499418441173813, 'loss_val': 1.2401189699004331, 'psi': 0.7180448641538404}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=1.916571 cos_to_last_merge=0.7231 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.723
[S2] round=72 local utility u=0.068267 metrics={'f1_val': 0.7170389354596602, 'auprc': 0.7900966006693552, 'loss_val': 0.9178104671479366, 'psi': 0.7462620015435382}-{'f1_val': 0.7207992758436184, 'auprc': 0.7567598544080725, 'loss_val': 0.9768957673027516, 'psi': 0.7351835072694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=72 head_norm_before_train=2.143235 cos_to_last_merge=0.9225 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=72 local utility u=0.029997 metrics={'f1_val': 0.9604885059957138, 'auprc': 0.9976555380947754, 'loss_val': 0.14237511048451953, 'psi': 0.9753553188353384}-{'f1_val': 0.9572051499082004, 'auprc': 0.9901917424513046, 'loss_val': 0.1602776839247942, 'psi': 0.970399786925442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=72 head_norm_before_train=1.685882 cos_to_last_merge=0.8696 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.870
[S4] round=72 local utility u=0.163199 metrics={'f1_val': 0.9429438609860321, 'auprc': 0.9527171646760338, 'loss_val': 0.31907049629100953, 'psi': 0.9468531824620328}-{'f1_val': 0.9061165466684644, 'auprc': 0.9507242756961112, 'loss_val': 0.4185254422870058, 'psi': 0.9239596382795231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=72 head_norm_before_train=2.093081 (no previous merge yet)
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9997651260434289, 'loss_val': 0.020447543573344377, 'psi': 0.9979272315044462}-{'f1_val': 0.9970695586110643, 'auprc': 0.9998039452275019, 'loss_val': 0.020299458164540703, 'psi': 0.9981633132576394}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.880649 cos_to_last_merge=0.8672 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=72 local utility u=0.257696 metrics={'f1_val': 0.8488711890945905, 'auprc': 0.9773543495188101, 'loss_val': 0.29933365777151616, 'psi': 0.9002644532642783}-{'f1_val': 0.7985090217463131, 'auprc': 0.969208055764934, 'loss_val': 0.488114489282368, 'psi': 0.8667886353537615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=72 head_norm_before_train=1.604253 cos_to_last_merge=0.8607 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.861
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.6025247739158756, 'auprc': 0.7939609073589647, 'loss_val': 0.7559264809720749, 'psi': 0.6790992272931113}-{'f1_val': 0.6543144880050452, 'auprc': 0.8044981553848203, 'loss_val': 0.5949502535680419, 'psi': 0.7143879549569552}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=2.023407 cos_to_last_merge=0.9509 (last merge round=13)
[S8] round=72 local utility u=0.004447 metrics={'f1_val': 0.9926811669910671, 'auprc': 0.9995117401916508, 'loss_val': 0.027581347021811618, 'psi': 0.9954133962713007}-{'f1_val': 0.9918210737370572, 'auprc': 0.9994027329469235, 'loss_val': 0.030987334652010354, 'psi': 0.9948537374210037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=72 head_norm_before_train=1.910901 cos_to_last_merge=0.9277 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.928
[S9] round=72 local utility u=0.004644 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9983008644308271, 'loss_val': 0.01815876763045992, 'psi': 0.997563193693951}-{'f1_val': 0.9966605118138915, 'auprc': 0.9961615073664557, 'loss_val': 0.018564037125829453, 'psi': 0.9964609100349171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=72 head_norm_before_train=1.997378 cos_to_last_merge=0.9093 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.909
[S10] round=72 local utility u=0.000072 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963453724609039, 'loss_val': 0.023908968846276225, 'psi': 0.9955190609034072}-{'f1_val': 0.9949681865317428, 'auprc': 0.996358886983598, 'loss_val': 0.024093034992280927, 'psi': 0.995524466712485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=72 head_norm_before_train=2.273746 (no previous merge yet)
[S11] round=72 local utility u=0.039141 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9994663803185304, 'loss_val': 0.01607811512621799, 'psi': 0.9975720028976334}-{'f1_val': 0.9893323808275926, 'auprc': 0.9995164391592313, 'loss_val': 0.05265100627709748, 'psi': 0.9934060041602482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=72 head_norm_before_train=1.877438 (no previous merge yet)
[S13] round=72 local utility u=0.270856 metrics={'f1_val': 0.7150232056306288, 'auprc': 0.7862973725258453, 'loss_val': 0.9123230951104288, 'psi': 0.7435328723887155}-{'f1_val': 0.6311837955334575, 'auprc': 0.7862985946446002, 'loss_val': 0.951003229863584, 'psi': 0.6932297151779145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S13] sending update (kind=head size=1810 to 1 peers)
[S14] START round=72 head_norm_before_train=2.066207 cos_to_last_merge=0.9718 (last merge round=17)
[S14] round=72 local utility u=0.004159 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9992344028844458, 'loss_val': 0.01893237916830193, 'psi': 0.9986335676301012}-{'f1_val': 0.9974055297193176, 'auprc': 0.9992360544626789, 'loss_val': 0.022290756311980253, 'psi': 0.9981377396166622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=72 head_norm_before_train=1.884872 cos_to_last_merge=0.9141 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.914
[S15] round=72 local utility u=0.041205 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979508105653809, 'loss_val': 0.02094275034506854, 'psi': 0.9972283252586647}-{'f1_val': 0.9887702315776579, 'auprc': 0.9983976577207649, 'loss_val': 0.05683543870207146, 'psi': 0.9926212020349008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=72 head_norm_before_train=1.903219 cos_to_last_merge=0.9207 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=72 local utility u=0.001581 metrics={'f1_val': 0.9921814050845084, 'auprc': 0.9887313319955847, 'loss_val': 0.03899293569451312, 'psi': 0.9908013758489389}-{'f1_val': 0.9921529403166653, 'auprc': 0.9887550920312989, 'loss_val': 0.04205576845319815, 'psi': 0.9907938010025188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=72 head_norm_before_train=1.816281 cos_to_last_merge=0.8770 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.6254716663292954, 'auprc': 0.8130816196286685, 'loss_val': 1.4182419512674782, 'psi': 0.7005156476490446}-{'f1_val': 0.614829192241631, 'auprc': 0.7715595944346461, 'loss_val': 1.1776363677685253, 'psi': 0.6775213531188371}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=1.921643 cos_to_last_merge=0.7227 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.723
[S2] round=73 local utility u=0.023198 metrics={'f1_val': 0.7134839000610599, 'auprc': 0.7963460434716243, 'loss_val': 0.8688324195575, 'psi': 0.7466287574252857}-{'f1_val': 0.7170389354596602, 'auprc': 0.7900966006693552, 'loss_val': 0.9178104671479366, 'psi': 0.7462620015435382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S2] sending update (kind=head size=1809 to 1 peers)
[S3] START round=73 head_norm_before_train=2.149806 cos_to_last_merge=0.9219 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=73 local utility u=0.071360 metrics={'f1_val': 0.9727678452606576, 'auprc': 0.9979025331885858, 'loss_val': 0.07407174538505679, 'psi': 0.9828217204318288}-{'f1_val': 0.9604885059957138, 'auprc': 0.9976555380947754, 'loss_val': 0.14237511048451953, 'psi': 0.9753553188353384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=73 head_norm_before_train=1.687909 cos_to_last_merge=0.8690 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.869
[S4] round=73 local utility u=0.016328 metrics={'f1_val': 0.9501667442750618, 'auprc': 0.9471692191365867, 'loss_val': 0.3131085629686528, 'psi': 0.9489677342196716}-{'f1_val': 0.9429438609860321, 'auprc': 0.9527171646760338, 'loss_val': 0.31907049629100953, 'psi': 0.9468531824620328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=73 head_norm_before_train=2.096952 (no previous merge yet)
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.993320035574974, 'loss_val': 0.02599468640450536, 'psi': 0.9951283014081236}-{'f1_val': 0.9967019684784577, 'auprc': 0.9997651260434289, 'loss_val': 0.020447543573344377, 'psi': 0.9979272315044462}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=1.886687 cos_to_last_merge=0.8666 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6180958506591328, 'auprc': 0.7882548449585076, 'loss_val': 1.092703290964492, 'psi': 0.6861594483788827}-{'f1_val': 0.8488711890945905, 'auprc': 0.9773543495188101, 'loss_val': 0.29933365777151616, 'psi': 0.9002644532642783}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.606788 cos_to_last_merge=0.8605 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.861
[S7] round=73 local utility u=1.000000 metrics={'f1_val': 0.8190453420810084, 'auprc': 0.8851442694029678, 'loss_val': 0.24664599338960688, 'psi': 0.8454849130097921}-{'f1_val': 0.6025247739158756, 'auprc': 0.7939609073589647, 'loss_val': 0.7559264809720749, 'psi': 0.6790992272931113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=73 head_norm_before_train=2.027815 cos_to_last_merge=0.9504 (last merge round=13)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9961322313504856, 'loss_val': 0.0326524478047795, 'psi': 0.9947407381559631}-{'f1_val': 0.9926811669910671, 'auprc': 0.9995117401916508, 'loss_val': 0.027581347021811618, 'psi': 0.9954133962713007}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=1.909950 cos_to_last_merge=0.9260 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.926
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9982710242108059, 'loss_val': 0.018672144172346628, 'psi': 0.9968044407028336}-{'f1_val': 0.9970714132027002, 'auprc': 0.9983008644308271, 'loss_val': 0.01815876763045992, 'psi': 0.997563193693951}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=2.002532 cos_to_last_merge=0.9087 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.909
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9951361938546867, 'loss_val': 0.023596788609762796, 'psi': 0.9950353894609203}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963453724609039, 'loss_val': 0.023908968846276225, 'psi': 0.9955190609034072}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=2.278262 (no previous merge yet)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9917118539908788, 'auprc': 0.9994363315154653, 'loss_val': 0.03343212264969768, 'psi': 0.9948016450007133}-{'f1_val': 0.9963090846170353, 'auprc': 0.9994663803185304, 'loss_val': 0.01607811512621799, 'psi': 0.9975720028976334}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.881716 (no previous merge yet)
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.7033935902697905, 'auprc': 0.7075954099194415, 'loss_val': 0.7907777122727174, 'psi': 0.7050743181296508}-{'f1_val': 0.7150232056306288, 'auprc': 0.7862973725258453, 'loss_val': 0.9123230951104288, 'psi': 0.7435328723887155}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=2.071481 cos_to_last_merge=0.9716 (last merge round=17)
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9992359291591939, 'loss_val': 0.019074754833665216, 'psi': 0.9986341781400006}-{'f1_val': 0.9982330107938716, 'auprc': 0.9992344028844458, 'loss_val': 0.01893237916830193, 'psi': 0.9986335676301012}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=1.889945 cos_to_last_merge=0.9137 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.914
[S15] round=73 local utility u=0.000770 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9983786910194183, 'loss_val': 0.020687172964830504, 'psi': 0.9973994774402797}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979508105653809, 'loss_val': 0.02094275034506854, 'psi': 0.9972283252586647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=73 head_norm_before_train=1.906822 cos_to_last_merge=0.9202 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=73 local utility u=0.003743 metrics={'f1_val': 0.9932513258991602, 'auprc': 0.9876308842017435, 'loss_val': 0.03462548039173154, 'psi': 0.9910031492201936}-{'f1_val': 0.9921814050845084, 'auprc': 0.9887313319955847, 'loss_val': 0.03899293569451312, 'psi': 0.9908013758489389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=73 head_norm_before_train=1.826499 cos_to_last_merge=0.8765 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.876
[S17] round=73 local utility u=0.262744 metrics={'f1_val': 0.6486963772259096, 'auprc': 0.8846768898178403, 'loss_val': 1.246888952471986, 'psi': 0.7430885822626818}-{'f1_val': 0.6254716663292954, 'auprc': 0.8130816196286685, 'loss_val': 1.4182419512674782, 'psi': 0.7005156476490446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=74 head_norm_before_train=1.924010 cos_to_last_merge=0.7225 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.722
[S2] round=74 local utility u=0.000000 metrics={'f1_val': 0.7122662417566812, 'auprc': 0.7976775547180033, 'loss_val': 0.8769900970201585, 'psi': 0.74643076694121}-{'f1_val': 0.7134839000610599, 'auprc': 0.7963460434716243, 'loss_val': 0.8688324195575, 'psi': 0.7466287574252857}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=74 head_norm_before_train=2.156560 cos_to_last_merge=0.9213 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=74 local utility u=0.052942 metrics={'f1_val': 0.9845100222325289, 'auprc': 0.9980583163196057, 'loss_val': 0.03910743931803255, 'psi': 0.9899293398673596}-{'f1_val': 0.9727678452606576, 'auprc': 0.9979025331885858, 'loss_val': 0.07407174538505679, 'psi': 0.9828217204318288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=74 head_norm_before_train=1.689060 cos_to_last_merge=0.8685 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.869
[S4] round=74 local utility u=0.008817 metrics={'f1_val': 0.9537369473363286, 'auprc': 0.9457453407898646, 'loss_val': 0.3126247769902497, 'psi': 0.9505403047177431}-{'f1_val': 0.9501667442750618, 'auprc': 0.9471692191365867, 'loss_val': 0.3131085629686528, 'psi': 0.9489677342196716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=74 head_norm_before_train=2.097524 (no previous merge yet)
[S5] round=74 local utility u=0.003270 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9939614931587034, 'loss_val': 0.021380035703255557, 'psi': 0.9953848844416154}-{'f1_val': 0.9963338119635569, 'auprc': 0.993320035574974, 'loss_val': 0.02599468640450536, 'psi': 0.9951283014081236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=74 head_norm_before_train=1.889631 cos_to_last_merge=0.8656 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.866
[S6] round=74 local utility u=1.000000 metrics={'f1_val': 0.9857247173586214, 'auprc': 0.9789940160226751, 'loss_val': 0.08872285483535054, 'psi': 0.9830324368242429}-{'f1_val': 0.6180958506591328, 'auprc': 0.7882548449585076, 'loss_val': 1.092703290964492, 'psi': 0.6861594483788827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=74 head_norm_before_train=1.611443 cos_to_last_merge=0.8602 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.860
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5910224405638392, 'auprc': 0.7946388345460285, 'loss_val': 0.6171348725658363, 'psi': 0.6724689981567149}-{'f1_val': 0.8190453420810084, 'auprc': 0.8851442694029678, 'loss_val': 0.24664599338960688, 'psi': 0.8454849130097921}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=2.032559 cos_to_last_merge=0.9499 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.950
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.7996314616321718, 'auprc': 0.999038358277562, 'loss_val': 0.4965993678596024, 'psi': 0.8793942202903279}-{'f1_val': 0.9938130760262815, 'auprc': 0.9961322313504856, 'loss_val': 0.0326524478047795, 'psi': 0.9947407381559631}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=1.911334 cos_to_last_merge=0.9246 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.925
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9986032322415059, 'loss_val': 0.033560514369512726, 'psi': 0.9931543599674284}-{'f1_val': 0.9958267183641853, 'auprc': 0.9982710242108059, 'loss_val': 0.018672144172346628, 'psi': 0.9968044407028336}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.005079 cos_to_last_merge=0.9080 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.908
[S10] round=74 local utility u=0.001331 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9960032271843946, 'loss_val': 0.023535161329962653, 'psi': 0.9953822027928035}-{'f1_val': 0.9949681865317428, 'auprc': 0.9951361938546867, 'loss_val': 0.023596788609762796, 'psi': 0.9950353894609203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=74 head_norm_before_train=2.282660 (no previous merge yet)
[S11] round=74 local utility u=0.024937 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9994534903959583, 'loss_val': 0.015265305210018943, 'psi': 0.9979741070129128}-{'f1_val': 0.9917118539908788, 'auprc': 0.9994363315154653, 'loss_val': 0.03343212264969768, 'psi': 0.9948016450007133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=74 head_norm_before_train=1.884439 (no previous merge yet)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6561680514263213, 'auprc': 0.7290652128453399, 'loss_val': 0.9541932325078099, 'psi': 0.6853269159939288}-{'f1_val': 0.7033935902697905, 'auprc': 0.7075954099194415, 'loss_val': 0.7907777122727174, 'psi': 0.7050743181296508}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=2.073722 cos_to_last_merge=0.9714 (last merge round=17)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9969687589007382, 'auprc': 0.9992360544626789, 'loss_val': 0.024409247334587915, 'psi': 0.9978756771255144}-{'f1_val': 0.9982330107938716, 'auprc': 0.9992359291591939, 'loss_val': 0.019074754833665216, 'psi': 0.9986341781400006}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=1.895957 cos_to_last_merge=0.9132 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.913
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.7115696714498133, 'auprc': 0.9920074312866101, 'loss_val': 0.5739193720076167, 'psi': 0.823744775384532}-{'f1_val': 0.9967466683875206, 'auprc': 0.9983786910194183, 'loss_val': 0.020687172964830504, 'psi': 0.9973994774402797}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=1.910767 cos_to_last_merge=0.9199 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9928403767347922, 'auprc': 0.986670126386706, 'loss_val': 0.03219550602121248, 'psi': 0.9903722765955577}-{'f1_val': 0.9932513258991602, 'auprc': 0.9876308842017435, 'loss_val': 0.03462548039173154, 'psi': 0.9910031492201936}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=1.836044 cos_to_last_merge=0.8760 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.876
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.630358931942244, 'auprc': 0.8306190283592313, 'loss_val': 1.4823474594073813, 'psi': 0.7104629705090388}-{'f1_val': 0.6486963772259096, 'auprc': 0.8846768898178403, 'loss_val': 1.246888952471986, 'psi': 0.7430885822626818}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=1.928824 cos_to_last_merge=0.7221 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.722
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.711180571815616, 'auprc': 0.800285836141343, 'loss_val': 0.9215474638996234, 'psi': 0.7468226775459068}-{'f1_val': 0.7122662417566812, 'auprc': 0.7976775547180033, 'loss_val': 0.8769900970201585, 'psi': 0.74643076694121}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=2.163277 cos_to_last_merge=0.9207 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9977125720317004, 'loss_val': 0.13717390486324343, 'psi': 0.9756824812923818}-{'f1_val': 0.9845100222325289, 'auprc': 0.9980583163196057, 'loss_val': 0.03910743931803255, 'psi': 0.9899293398673596}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.690363 cos_to_last_merge=0.8678 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.868
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9495192283917632, 'auprc': 0.9481300546866196, 'loss_val': 0.31217873883992275, 'psi': 0.9489635589097056}-{'f1_val': 0.9537369473363286, 'auprc': 0.9457453407898646, 'loss_val': 0.3126247769902497, 'psi': 0.9505403047177431}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=2.100802 (no previous merge yet)
[S5] round=75 local utility u=0.004916 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9961968762230233, 'loss_val': 0.020462832270756338, 'psi': 0.9964999315762839}-{'f1_val': 0.9963338119635569, 'auprc': 0.9939614931587034, 'loss_val': 0.021380035703255557, 'psi': 0.9953848844416154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=75 head_norm_before_train=1.894944 cos_to_last_merge=0.8653 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.7572530558865875, 'auprc': 0.7820537259806983, 'loss_val': 0.7961585740580744, 'psi': 0.7671733239242319}-{'f1_val': 0.9857247173586214, 'auprc': 0.9789940160226751, 'loss_val': 0.08872285483535054, 'psi': 0.9830324368242429}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=1.615778 cos_to_last_merge=0.8596 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.860
[S7] round=75 local utility u=1.000000 metrics={'f1_val': 0.9507906324838588, 'auprc': 0.982207791027649, 'loss_val': 0.16204823402500756, 'psi': 0.9633574959013749}-{'f1_val': 0.5910224405638392, 'auprc': 0.7946388345460285, 'loss_val': 0.6171348725658363, 'psi': 0.6724689981567149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=75 head_norm_before_train=2.037304 cos_to_last_merge=0.9494 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.7164338773603038, 'auprc': 0.9902815290806218, 'loss_val': 0.27104975406733495, 'psi': 0.8259729380484311}-{'f1_val': 0.7996314616321718, 'auprc': 0.999038358277562, 'loss_val': 0.4965993678596024, 'psi': 0.8793942202903279}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=1.914621 cos_to_last_merge=0.9238 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.924
[S9] round=75 local utility u=0.024424 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9959307984784063, 'loss_val': 0.01952838868171722, 'psi': 0.9963686264796974}-{'f1_val': 0.9895217784513768, 'auprc': 0.9986032322415059, 'loss_val': 0.033560514369512726, 'psi': 0.9931543599674284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=75 head_norm_before_train=2.009580 cos_to_last_merge=0.9074 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=75 local utility u=0.000629 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963821909990852, 'loss_val': 0.023414580451499526, 'psi': 0.9955337883186798}-{'f1_val': 0.9949681865317428, 'auprc': 0.9960032271843946, 'loss_val': 0.023535161329962653, 'psi': 0.9953822027928035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=75 head_norm_before_train=2.286712 (no previous merge yet)
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9994599685041499, 'loss_val': 0.017098820205897088, 'psi': 0.9975694381718812}-{'f1_val': 0.9969878514242156, 'auprc': 0.9994534903959583, 'loss_val': 0.015265305210018943, 'psi': 0.9979741070129128}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=1.889181 (no previous merge yet)
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.5957853445412074, 'auprc': 0.659381400870401, 'loss_val': 1.2879361166657655, 'psi': 0.6212237670728848}-{'f1_val': 0.6561680514263213, 'auprc': 0.7290652128453399, 'loss_val': 0.9541932325078099, 'psi': 0.6853269159939288}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=2.073854 cos_to_last_merge=0.9711 (last merge round=17)
[S14] round=75 local utility u=0.004995 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992344028844458, 'loss_val': 0.019531950786793765, 'psi': 0.9983868167664337}-{'f1_val': 0.9969687589007382, 'auprc': 0.9992360544626789, 'loss_val': 0.024409247334587915, 'psi': 0.9978756771255144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=75 head_norm_before_train=1.902274 cos_to_last_merge=0.9127 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.913
[S15] round=75 local utility u=0.251670 metrics={'f1_val': 0.7776227447141082, 'auprc': 0.995462186634932, 'loss_val': 0.47726161227106556, 'psi': 0.8647585214824378}-{'f1_val': 0.7115696714498133, 'auprc': 0.9920074312866101, 'loss_val': 0.5739193720076167, 'psi': 0.823744775384532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=75 head_norm_before_train=1.915808 cos_to_last_merge=0.9195 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.992373076668169, 'auprc': 0.9872167907339138, 'loss_val': 0.032812507057432556, 'psi': 0.9903105622944669}-{'f1_val': 0.9928403767347922, 'auprc': 0.986670126386706, 'loss_val': 0.03219550602121248, 'psi': 0.9903722765955577}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=1.841239 cos_to_last_merge=0.8753 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.875
[S17] round=75 local utility u=0.480815 metrics={'f1_val': 0.6984759247690103, 'auprc': 0.8734775599609441, 'loss_val': 1.05799580246262, 'psi': 0.7684765788457839}-{'f1_val': 0.630358931942244, 'auprc': 0.8306190283592313, 'loss_val': 1.4823474594073813, 'psi': 0.7104629705090388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=76 head_norm_before_train=1.934790 cos_to_last_merge=0.7217 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.722
[S2] round=76 local utility u=0.223859 metrics={'f1_val': 0.7748704297393589, 'auprc': 0.7888000110043463, 'loss_val': 0.8215104607117328, 'psi': 0.780442262245354}-{'f1_val': 0.711180571815616, 'auprc': 0.800285836141343, 'loss_val': 0.9215474638996234, 'psi': 0.7468226775459068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=76 head_norm_before_train=2.169487 cos_to_last_merge=0.9201 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.9600241029803138, 'auprc': 0.9970265673050362, 'loss_val': 0.16758392188850268, 'psi': 0.9748250887102028}-{'f1_val': 0.960995754132836, 'auprc': 0.9977125720317004, 'loss_val': 0.13717390486324343, 'psi': 0.9756824812923818}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.695653 cos_to_last_merge=0.8672 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.867
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.9446878880660856, 'auprc': 0.9494643258033287, 'loss_val': 0.3138326022519642, 'psi': 0.946598463160983}-{'f1_val': 0.9495192283917632, 'auprc': 0.9481300546866196, 'loss_val': 0.31217873883992275, 'psi': 0.9489635589097056}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=76 head_norm_before_train=2.106080 (no previous merge yet)
[S5] round=76 local utility u=0.005485 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9997733411544136, 'loss_val': 0.02022137753996394, 'psi': 0.99793051754884}-{'f1_val': 0.9967019684784577, 'auprc': 0.9961968762230233, 'loss_val': 0.020462832270756338, 'psi': 0.9964999315762839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=76 head_norm_before_train=1.901027 cos_to_last_merge=0.8652 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.7321040104682488, 'auprc': 0.7413566532069636, 'loss_val': 0.8462910626732331, 'psi': 0.7358050675637346}-{'f1_val': 0.7572530558865875, 'auprc': 0.7820537259806983, 'loss_val': 0.7961585740580744, 'psi': 0.7671733239242319}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.622458 cos_to_last_merge=0.8587 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.859
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.5901660937692338, 'auprc': 0.7914342249356726, 'loss_val': 0.7906743504382304, 'psi': 0.6706733462358093}-{'f1_val': 0.9507906324838588, 'auprc': 0.982207791027649, 'loss_val': 0.16204823402500756, 'psi': 0.9633574959013749}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=2.040563 cos_to_last_merge=0.9494 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=76 local utility u=0.967716 metrics={'f1_val': 0.9934116751513793, 'auprc': 0.9996626171779295, 'loss_val': 0.02562711137347481, 'psi': 0.9959120519619993}-{'f1_val': 0.7164338773603038, 'auprc': 0.9902815290806218, 'loss_val': 0.27104975406733495, 'psi': 0.8259729380484311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=76 head_norm_before_train=1.919221 cos_to_last_merge=0.9232 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.923
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9954253388438905, 'loss_val': 0.019465701863451507, 'psi': 0.996166442625891}-{'f1_val': 0.9966605118138915, 'auprc': 0.9959307984784063, 'loss_val': 0.01952838868171722, 'psi': 0.9963686264796974}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.015127 cos_to_last_merge=0.9069 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=76 local utility u=0.000047 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963825339440324, 'loss_val': 0.0233218005060321, 'psi': 0.9955339254966586}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963821909990852, 'loss_val': 0.023414580451499526, 'psi': 0.9955337883186798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=76 head_norm_before_train=2.291256 (no previous merge yet)
[S11] round=76 local utility u=0.002220 metrics={'f1_val': 0.9967467623295848, 'auprc': 0.9994914427177957, 'loss_val': 0.015379733612322432, 'psi': 0.9978446344848693}-{'f1_val': 0.9963090846170353, 'auprc': 0.9994599685041499, 'loss_val': 0.017098820205897088, 'psi': 0.9975694381718812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=76 head_norm_before_train=1.894586 (no previous merge yet)
[S13] round=76 local utility u=0.548707 metrics={'f1_val': 0.6455134211604936, 'auprc': 0.7915395812490975, 'loss_val': 0.8853652192415867, 'psi': 0.7039238851959352}-{'f1_val': 0.5957853445412074, 'auprc': 0.659381400870401, 'loss_val': 1.2879361166657655, 'psi': 0.6212237670728848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=76 head_norm_before_train=2.077676 cos_to_last_merge=0.9708 (last merge round=17)
[S14] round=76 local utility u=0.001554 metrics={'f1_val': 0.9982111419559175, 'auprc': 0.9992346807696725, 'loss_val': 0.018761809165784005, 'psi': 0.9986205574814195}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992344028844458, 'loss_val': 0.019531950786793765, 'psi': 0.9983868167664337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=76 head_norm_before_train=1.908271 cos_to_last_merge=0.9122 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.912
[S15] round=76 local utility u=0.531963 metrics={'f1_val': 0.9043782529493407, 'auprc': 0.99790910278858, 'loss_val': 0.1812090813269793, 'psi': 0.9417905928850364}-{'f1_val': 0.7776227447141082, 'auprc': 0.995462186634932, 'loss_val': 0.47726161227106556, 'psi': 0.8647585214824378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=76 head_norm_before_train=1.919767 cos_to_last_merge=0.9188 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=76 local utility u=0.005087 metrics={'f1_val': 0.9928136050251588, 'auprc': 0.9902305179404095, 'loss_val': 0.034323174831457484, 'psi': 0.9917803701912591}-{'f1_val': 0.992373076668169, 'auprc': 0.9872167907339138, 'loss_val': 0.032812507057432556, 'psi': 0.9903105622944669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=76 head_norm_before_train=1.848019 cos_to_last_merge=0.8747 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.875
[S17] round=76 local utility u=0.696350 metrics={'f1_val': 0.8480745969672312, 'auprc': 0.888614995984321, 'loss_val': 0.6082997004797621, 'psi': 0.8642907565740672}-{'f1_val': 0.6984759247690103, 'auprc': 0.8734775599609441, 'loss_val': 1.05799580246262, 'psi': 0.7684765788457839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=77 head_norm_before_train=1.936232 cos_to_last_merge=0.7215 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.722
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.722358124668101, 'auprc': 0.7177852123909058, 'loss_val': 1.0885011217452683, 'psi': 0.7205289597572229}-{'f1_val': 0.7748704297393589, 'auprc': 0.7888000110043463, 'loss_val': 0.8215104607117328, 'psi': 0.780442262245354}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.175333 cos_to_last_merge=0.9196 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=77 local utility u=0.111291 metrics={'f1_val': 0.9778239097960991, 'auprc': 0.9984297579687268, 'loss_val': 0.056009341748778294, 'psi': 0.9860662490651502}-{'f1_val': 0.9600241029803138, 'auprc': 0.9970265673050362, 'loss_val': 0.16758392188850268, 'psi': 0.9748250887102028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=77 head_norm_before_train=1.699988 cos_to_last_merge=0.8670 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.867
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9426655898669427, 'auprc': 0.9525128195998624, 'loss_val': 0.3217081076202432, 'psi': 0.9466044817601106}-{'f1_val': 0.9446878880660856, 'auprc': 0.9494643258033287, 'loss_val': 0.3138326022519642, 'psi': 0.946598463160983}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=2.111436 (no previous merge yet)
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994799941728678, 'loss_val': 0.020390008425672675, 'psi': 0.9978131787562217}-{'f1_val': 0.9967019684784577, 'auprc': 0.9997733411544136, 'loss_val': 0.02022137753996394, 'psi': 0.99793051754884}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=77 head_norm_before_train=1.909418 cos_to_last_merge=0.8649 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=77 local utility u=0.386794 metrics={'f1_val': 0.7679236455647599, 'auprc': 0.8806893086745886, 'loss_val': 0.7056180518467348, 'psi': 0.8130299108086914}-{'f1_val': 0.7321040104682488, 'auprc': 0.7413566532069636, 'loss_val': 0.8462910626732331, 'psi': 0.7358050675637346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=77 head_norm_before_train=1.626347 cos_to_last_merge=0.8580 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.858
[S7] round=77 local utility u=0.907129 metrics={'f1_val': 0.7187766963763128, 'auprc': 0.9457466646848676, 'loss_val': 0.21101707334078668, 'psi': 0.8095646836997348}-{'f1_val': 0.5901660937692338, 'auprc': 0.7914342249356726, 'loss_val': 0.7906743504382304, 'psi': 0.6706733462358093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=77 head_norm_before_train=2.041912 cos_to_last_merge=0.9496 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.950
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.8200543611517623, 'auprc': 0.9988652253164345, 'loss_val': 0.4039808850292742, 'psi': 0.8915787068176312}-{'f1_val': 0.9934116751513793, 'auprc': 0.9996626171779295, 'loss_val': 0.02562711137347481, 'psi': 0.9959120519619993}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=77 head_norm_before_train=1.924486 cos_to_last_merge=0.9226 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.923
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.9858942912577657, 'auprc': 0.9985060741491077, 'loss_val': 0.04629720234198846, 'psi': 0.9909390044143025}-{'f1_val': 0.9966605118138915, 'auprc': 0.9954253388438905, 'loss_val': 0.019465701863451507, 'psi': 0.996166442625891}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=77 head_norm_before_train=2.021168 cos_to_last_merge=0.9063 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=77 local utility u=0.000008 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.996349015617866, 'loss_val': 0.023205226247889583, 'psi': 0.9955205181661921}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963825339440324, 'loss_val': 0.0233218005060321, 'psi': 0.9955339254966586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=77 head_norm_before_train=2.295354 (no previous merge yet)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9905207003221775, 'auprc': 0.9998900066109933, 'loss_val': 0.046529161949944796, 'psi': 0.9942684228377039}-{'f1_val': 0.9967467623295848, 'auprc': 0.9994914427177957, 'loss_val': 0.015379733612322432, 'psi': 0.9978446344848693}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.897768 (no previous merge yet)
[S13] round=77 local utility u=0.079516 metrics={'f1_val': 0.6551297804059797, 'auprc': 0.7886598770780114, 'loss_val': 0.7753916311743511, 'psi': 0.7085418190747924}-{'f1_val': 0.6455134211604936, 'auprc': 0.7915395812490975, 'loss_val': 0.8853652192415867, 'psi': 0.7039238851959352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=77 head_norm_before_train=2.082869 cos_to_last_merge=0.9706 (last merge round=17)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9976262314423188, 'auprc': 0.9992364326940949, 'loss_val': 0.021603780452460163, 'psi': 0.9982703119430293}-{'f1_val': 0.9982111419559175, 'auprc': 0.9992346807696725, 'loss_val': 0.018761809165784005, 'psi': 0.9986205574814195}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=1.914488 cos_to_last_merge=0.9117 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.912
[S15] round=77 local utility u=0.131510 metrics={'f1_val': 0.9352211730002602, 'auprc': 0.9974196574590399, 'loss_val': 0.10177882876780826, 'psi': 0.9601005667837721}-{'f1_val': 0.9043782529493407, 'auprc': 0.99790910278858, 'loss_val': 0.1812090813269793, 'psi': 0.9417905928850364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=77 head_norm_before_train=1.923750 cos_to_last_merge=0.9182 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.8749433061541234, 'auprc': 0.9891339624167654, 'loss_val': 0.3765114514331986, 'psi': 0.9206195686591803}-{'f1_val': 0.9928136050251588, 'auprc': 0.9902305179404095, 'loss_val': 0.034323174831457484, 'psi': 0.9917803701912591}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=1.855162 cos_to_last_merge=0.8744 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.6246769908149119, 'auprc': 0.8149747093812935, 'loss_val': 1.4836375013308063, 'psi': 0.7007960782414646}-{'f1_val': 0.8480745969672312, 'auprc': 0.888614995984321, 'loss_val': 0.6082997004797621, 'psi': 0.8642907565740672}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=1.938257 cos_to_last_merge=0.7213 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.721
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.7210066610293682, 'auprc': 0.7206373385247983, 'loss_val': 1.0915140361290125, 'psi': 0.7208589320275403}-{'f1_val': 0.722358124668101, 'auprc': 0.7177852123909058, 'loss_val': 1.0885011217452683, 'psi': 0.7205289597572229}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.180629 cos_to_last_merge=0.9191 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.970417273328505, 'auprc': 0.9982464267065659, 'loss_val': 0.10345495907164781, 'psi': 0.9815489346797294}-{'f1_val': 0.9778239097960991, 'auprc': 0.9984297579687268, 'loss_val': 0.056009341748778294, 'psi': 0.9860662490651502}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=1.704032 cos_to_last_merge=0.8667 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.867
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.8143693122671207, 'auprc': 0.9456726140030477, 'loss_val': 0.48529602790599974, 'psi': 0.8668906329614915}-{'f1_val': 0.9426655898669427, 'auprc': 0.9525128195998624, 'loss_val': 0.3217081076202432, 'psi': 0.9466044817601106}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=2.116519 (no previous merge yet)
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9983837717814951, 'loss_val': 0.019951996173057738, 'psi': 0.9973746897996727}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994799941728678, 'loss_val': 0.020390008425672675, 'psi': 0.9978131787562217}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=1.916916 cos_to_last_merge=0.8645 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.864
[S6] round=78 local utility u=0.636218 metrics={'f1_val': 0.8623403181037356, 'auprc': 0.9598697559623941, 'loss_val': 0.2372237036135643, 'psi': 0.901352093247199}-{'f1_val': 0.7679236455647599, 'auprc': 0.8806893086745886, 'loss_val': 0.7056180518467348, 'psi': 0.8130299108086914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=78 head_norm_before_train=1.629990 cos_to_last_merge=0.8576 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.858
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.5296290704031555, 'auprc': 0.7806593924013073, 'loss_val': 1.063619903735377, 'psi': 0.6300411992024162}-{'f1_val': 0.7187766963763128, 'auprc': 0.9457466646848676, 'loss_val': 0.21101707334078668, 'psi': 0.8095646836997348}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=2.044042 cos_to_last_merge=0.9496 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.950
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9976035192494533, 'loss_val': 0.41905368194575054, 'psi': 0.8274127083401688}-{'f1_val': 0.8200543611517623, 'auprc': 0.9988652253164345, 'loss_val': 0.4039808850292742, 'psi': 0.8915787068176312}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=1.929322 cos_to_last_merge=0.9223 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.922
[S9] round=78 local utility u=0.040577 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950210857471669, 'loss_val': 0.01928531513331212, 'psi': 0.9960047413872016}-{'f1_val': 0.9858942912577657, 'auprc': 0.9985060741491077, 'loss_val': 0.04629720234198846, 'psi': 0.9909390044143025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=78 head_norm_before_train=2.027444 cos_to_last_merge=0.9058 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9959901412142494, 'loss_val': 0.023270060470849948, 'psi': 0.9953769684047455}-{'f1_val': 0.9949681865317428, 'auprc': 0.996349015617866, 'loss_val': 0.023205226247889583, 'psi': 0.9955205181661921}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.299251 (no previous merge yet)
[S11] round=78 local utility u=0.032798 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9994863186166072, 'loss_val': 0.017073913724505476, 'psi': 0.9978421357305118}-{'f1_val': 0.9905207003221775, 'auprc': 0.9998900066109933, 'loss_val': 0.046529161949944796, 'psi': 0.9942684228377039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=78 head_norm_before_train=1.899855 (no previous merge yet)
[S13] round=78 local utility u=0.066856 metrics={'f1_val': 0.7206599032179442, 'auprc': 0.7594012282246554, 'loss_val': 0.9470835116095505, 'psi': 0.7361564332206286}-{'f1_val': 0.6551297804059797, 'auprc': 0.7886598770780114, 'loss_val': 0.7753916311743511, 'psi': 0.7085418190747924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=78 head_norm_before_train=2.085773 cos_to_last_merge=0.9705 (last merge round=17)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9626647405417732, 'auprc': 0.9992351843045734, 'loss_val': 0.05491704805046823, 'psi': 0.9772929180468932}-{'f1_val': 0.9976262314423188, 'auprc': 0.9992364326940949, 'loss_val': 0.021603780452460163, 'psi': 0.9982703119430293}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=1.920537 cos_to_last_merge=0.9112 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.911
[S15] round=78 local utility u=0.227069 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9984095608932235, 'loss_val': 0.019506003242306575, 'psi': 0.9973860015311428}-{'f1_val': 0.9352211730002602, 'auprc': 0.9974196574590399, 'loss_val': 0.10177882876780826, 'psi': 0.9601005667837721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=78 head_norm_before_train=1.927477 cos_to_last_merge=0.9178 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=78 local utility u=0.523187 metrics={'f1_val': 0.9932729468625441, 'auprc': 0.9877887726920924, 'loss_val': 0.036080405608619553, 'psi': 0.9910792771943634}-{'f1_val': 0.8749433061541234, 'auprc': 0.9891339624167654, 'loss_val': 0.3765114514331986, 'psi': 0.9206195686591803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=78 head_norm_before_train=1.860748 cos_to_last_merge=0.8740 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=78 local utility u=0.264666 metrics={'f1_val': 0.6408556442171086, 'auprc': 0.948706208146664, 'loss_val': 1.452572218803181, 'psi': 0.7639958697889309}-{'f1_val': 0.6246769908149119, 'auprc': 0.8149747093812935, 'loss_val': 1.4836375013308063, 'psi': 0.7007960782414646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=79 head_norm_before_train=1.941579 cos_to_last_merge=0.7210 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.721
[S2] round=79 local utility u=0.289003 metrics={'f1_val': 0.7232710061609086, 'auprc': 0.812066212657695, 'loss_val': 0.8013817252934895, 'psi': 0.7587890887596231}-{'f1_val': 0.7210066610293682, 'auprc': 0.7206373385247983, 'loss_val': 1.0915140361290125, 'psi': 0.7208589320275403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] r=80 psi=0.759 u=0.2890 p_local=0.0896 f1=0.723 auprc=0.812 bytes=77380
[S3] START round=79 head_norm_before_train=2.186217 cos_to_last_merge=0.9187 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.9572051499082004, 'auprc': 0.9960061037226561, 'loss_val': 0.14086829057681063, 'psi': 0.9727255314339827}-{'f1_val': 0.970417273328505, 'auprc': 0.9982464267065659, 'loss_val': 0.10345495907164781, 'psi': 0.9815489346797294}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=80 psi=0.973 u=0.0000 p_local=0.0431 f1=0.957 auprc=0.996 bytes=77279
[S4] START round=79 head_norm_before_train=1.707766 cos_to_last_merge=0.8664 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.866
[S4] round=79 local utility u=0.477573 metrics={'f1_val': 0.9424561650928526, 'auprc': 0.9534398699644705, 'loss_val': 0.3219724919223424, 'psi': 0.9468496470414998}-{'f1_val': 0.8143693122671207, 'auprc': 0.9456726140030477, 'loss_val': 0.48529602790599974, 'psi': 0.8668906329614915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S4] r=80 psi=0.947 u=0.4776 p_local=0.1081 f1=0.942 auprc=0.953 bytes=77264
[S5] START round=79 head_norm_before_train=2.122861 (no previous merge yet)
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.9322411561918532, 'auprc': 0.9916363983677697, 'loss_val': 0.10272465950304704, 'psi': 0.9559992530622198}-{'f1_val': 0.9967019684784577, 'auprc': 0.9983837717814951, 'loss_val': 0.019951996173057738, 'psi': 0.9973746897996727}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.956 u=0.0000 p_local=0.0053 f1=0.932 auprc=0.992 bytes=86262
[S6] START round=79 head_norm_before_train=1.922854 cos_to_last_merge=0.8635 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.864
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.7174552896154478, 'auprc': 0.8050262855579011, 'loss_val': 0.7448462135022579, 'psi': 0.7524836879924292}-{'f1_val': 0.8623403181037356, 'auprc': 0.9598697559623941, 'loss_val': 0.2372237036135643, 'psi': 0.901352093247199}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.752 u=0.0000 p_local=0.3011 f1=0.717 auprc=0.805 bytes=77393
[S7] START round=79 head_norm_before_train=1.631997 cos_to_last_merge=0.8572 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.857
[S7] round=79 local utility u=0.748458 metrics={'f1_val': 0.6623107229356923, 'auprc': 0.8038433161417745, 'loss_val': 0.4323448591372127, 'psi': 0.7189237602181252}-{'f1_val': 0.5296290704031555, 'auprc': 0.7806593924013073, 'loss_val': 1.063619903735377, 'psi': 0.6300411992024162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S7] r=80 psi=0.719 u=0.7485 p_local=0.4308 f1=0.662 auprc=0.804 bytes=79186
[S8] START round=79 head_norm_before_train=2.044755 cos_to_last_merge=0.9496 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.950
[S8] round=79 local utility u=1.000000 metrics={'f1_val': 0.9953918725500761, 'auprc': 0.9996628125650222, 'loss_val': 0.02322613217464911, 'psi': 0.9971002485560545}-{'f1_val': 0.7139521677339791, 'auprc': 0.9976035192494533, 'loss_val': 0.41905368194575054, 'psi': 0.8274127083401688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] r=80 psi=0.997 u=1.0000 p_local=0.3053 f1=0.995 auprc=1.000 bytes=79132
[S9] START round=79 head_norm_before_train=1.934295 cos_to_last_merge=0.9220 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.922
[S9] round=79 local utility u=0.001038 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9957882288726603, 'loss_val': 0.019511630773484553, 'psi': 0.9963115986373989}-{'f1_val': 0.9966605118138915, 'auprc': 0.9950210857471669, 'loss_val': 0.01928531513331212, 'psi': 0.9960047413872016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] r=80 psi=0.996 u=0.0010 p_local=0.0097 f1=0.997 auprc=0.996 bytes=86413
[S10] START round=79 head_norm_before_train=2.032835 cos_to_last_merge=0.9053 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.905
[S10] round=79 local utility u=0.000460 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963432421815608, 'loss_val': 0.023409523466602, 'psi': 0.9955182087916701}-{'f1_val': 0.9949681865317428, 'auprc': 0.9959901412142494, 'loss_val': 0.023270060470849948, 'psi': 0.9953769684047455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S10] r=80 psi=0.996 u=0.0005 p_local=0.0003 f1=0.995 auprc=0.996 bytes=97208
[S11] START round=79 head_norm_before_train=2.302886 (no previous merge yet)
[S11] round=79 local utility u=0.000130 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9994832534157787, 'loss_val': 0.016805368499423892, 'psi': 0.9978409096501805}-{'f1_val': 0.9967460138064482, 'auprc': 0.9994863186166072, 'loss_val': 0.017073913724505476, 'psi': 0.9978421357305118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] r=80 psi=0.998 u=0.0001 p_local=0.0097 f1=0.997 auprc=0.999 bytes=89915
[S13] START round=79 head_norm_before_train=1.904192 (no previous merge yet)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.6261467062105315, 'auprc': 0.7301413896805966, 'loss_val': 1.0166492630973467, 'psi': 0.6677445795985575}-{'f1_val': 0.7206599032179442, 'auprc': 0.7594012282246554, 'loss_val': 0.9470835116095505, 'psi': 0.7361564332206286}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.668 u=0.0000 p_local=0.1087 f1=0.626 auprc=0.730 bytes=72086
[S14] START round=79 head_norm_before_train=2.088570 cos_to_last_merge=0.9703 (last merge round=17)
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.954216961321396, 'auprc': 0.9988566901267719, 'loss_val': 0.08288833481775679, 'psi': 0.9720728528435464}-{'f1_val': 0.9626647405417732, 'auprc': 0.9992351843045734, 'loss_val': 0.05491704805046823, 'psi': 0.9772929180468932}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.972 u=0.0000 p_local=0.0055 f1=0.954 auprc=0.999 bytes=91645
[S15] START round=79 head_norm_before_train=1.926434 cos_to_last_merge=0.9108 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.911
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9978207125799375, 'loss_val': 0.02423729813772738, 'psi': 0.9969277315412596}-{'f1_val': 0.9967036286230888, 'auprc': 0.9984095608932235, 'loss_val': 0.019506003242306575, 'psi': 0.9973860015311428}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.997 u=0.0000 p_local=0.1749 f1=0.996 auprc=0.998 bytes=82718
[S16] START round=79 head_norm_before_train=1.932624 cos_to_last_merge=0.9174 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.917
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.8431429231056708, 'auprc': 0.8481285996472171, 'loss_val': 1.2036898790660755, 'psi': 0.8451371937222893}-{'f1_val': 0.9932729468625441, 'auprc': 0.9877887726920924, 'loss_val': 0.036080405608619553, 'psi': 0.9910792771943634}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.845 u=0.0000 p_local=0.1115 f1=0.843 auprc=0.848 bytes=82719
[S17] START round=79 head_norm_before_train=1.867057 cos_to_last_merge=0.8737 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=79 local utility u=1.000000 metrics={'f1_val': 0.8316484740135845, 'auprc': 0.9930694390075252, 'loss_val': 0.6461469755091501, 'psi': 0.8962168600111609}-{'f1_val': 0.6408556442171086, 'auprc': 0.948706208146664, 'loss_val': 1.452572218803181, 'psi': 0.7639958697889309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S17] r=80 psi=0.896 u=1.0000 p_local=0.3908 f1=0.832 auprc=0.993 bytes=79225
[S2] START round=80 head_norm_before_train=1.940636 cos_to_last_merge=0.7211 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.721
[S2] round=80 local utility u=0.083744 metrics={'f1_val': 0.7080786341251635, 'auprc': 0.8545941142869866, 'loss_val': 0.6703241032337172, 'psi': 0.7666848261898928}-{'f1_val': 0.7232710061609086, 'auprc': 0.812066212657695, 'loss_val': 0.8013817252934895, 'psi': 0.7587890887596231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=80 head_norm_before_train=2.191822 cos_to_last_merge=0.9182 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.9567772480566313, 'auprc': 0.9936806368879154, 'loss_val': 0.17469923370757295, 'psi': 0.9715386035891449}-{'f1_val': 0.9572051499082004, 'auprc': 0.9960061037226561, 'loss_val': 0.14086829057681063, 'psi': 0.9727255314339827}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.708591 cos_to_last_merge=0.8660 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.866
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.942118359881271, 'auprc': 0.952420571006421, 'loss_val': 0.3210221082506703, 'psi': 0.946239244331331}-{'f1_val': 0.9424561650928526, 'auprc': 0.9534398699644705, 'loss_val': 0.3219724919223424, 'psi': 0.9468496470414998}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=2.128238 (no previous merge yet)
[S5] round=80 local utility u=0.247682 metrics={'f1_val': 0.9978756509554264, 'auprc': 0.9998175959957174, 'loss_val': 0.02571050455029847, 'psi': 0.9986524289715428}-{'f1_val': 0.9322411561918532, 'auprc': 0.9916363983677697, 'loss_val': 0.10272465950304704, 'psi': 0.9559992530622198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=80 head_norm_before_train=1.927732 cos_to_last_merge=0.8623 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=80 local utility u=0.957200 metrics={'f1_val': 0.8621286105867737, 'auprc': 0.9819849321795416, 'loss_val': 0.22936303698799992, 'psi': 0.9100711392238809}-{'f1_val': 0.7174552896154478, 'auprc': 0.8050262855579011, 'loss_val': 0.7448462135022579, 'psi': 0.7524836879924292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=80 head_norm_before_train=1.633545 cos_to_last_merge=0.8572 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.857
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.6305262508668605, 'auprc': 0.7943304111377971, 'loss_val': 0.5921572933228155, 'psi': 0.6960479149752352}-{'f1_val': 0.6623107229356923, 'auprc': 0.8038433161417745, 'loss_val': 0.4323448591372127, 'psi': 0.7189237602181252}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=80 head_norm_before_train=2.045364 cos_to_last_merge=0.9496 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.950
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9925374035278365, 'auprc': 0.9989751618243351, 'loss_val': 0.029615710662272175, 'psi': 0.9951125068464359}-{'f1_val': 0.9953918725500761, 'auprc': 0.9996628125650222, 'loss_val': 0.02322613217464911, 'psi': 0.9971002485560545}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=1.939331 cos_to_last_merge=0.9217 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.922
[S9] round=80 local utility u=0.004813 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985665784962284, 'loss_val': 0.01822030871338851, 'psi': 0.9974229384868263}-{'f1_val': 0.9966605118138915, 'auprc': 0.9957882288726603, 'loss_val': 0.019511630773484553, 'psi': 0.9963115986373989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=80 head_norm_before_train=2.035224 cos_to_last_merge=0.9046 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.905
[S10] round=80 local utility u=0.000071 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963630196844943, 'loss_val': 0.02332646469421376, 'psi': 0.9955261197928433}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963432421815608, 'loss_val': 0.023409523466602, 'psi': 0.9955182087916701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=80 head_norm_before_train=2.306823 (no previous merge yet)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9914733941771422, 'auprc': 0.9998685116561324, 'loss_val': 0.03237149074162636, 'psi': 0.9948314411687382}-{'f1_val': 0.9967460138064482, 'auprc': 0.9994832534157787, 'loss_val': 0.016805368499423892, 'psi': 0.9978409096501805}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.908432 (no previous merge yet)
[S13] round=80 local utility u=0.413313 metrics={'f1_val': 0.7270323955089004, 'auprc': 0.7478953098048191, 'loss_val': 0.8486000761717857, 'psi': 0.7353775612272679}-{'f1_val': 0.6261467062105315, 'auprc': 0.7301413896805966, 'loss_val': 1.0166492630973467, 'psi': 0.6677445795985575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=80 head_norm_before_train=2.093360 cos_to_last_merge=0.9701 (last merge round=17)
[S14] round=80 local utility u=0.162896 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9992345029375072, 'loss_val': 0.01872008704737621, 'psi': 0.9982729851489286}-{'f1_val': 0.954216961321396, 'auprc': 0.9988566901267719, 'loss_val': 0.08288833481775679, 'psi': 0.9720728528435464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=80 head_norm_before_train=1.932367 cos_to_last_merge=0.9104 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.910
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9481207130297594, 'auprc': 0.9971849610987726, 'loss_val': 0.08971114276305636, 'psi': 0.9677464122573647}-{'f1_val': 0.9963324108488076, 'auprc': 0.9978207125799375, 'loss_val': 0.02423729813772738, 'psi': 0.9969277315412596}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=1.938208 cos_to_last_merge=0.9169 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.917
[S16] round=80 local utility u=0.876002 metrics={'f1_val': 0.9347831292440432, 'auprc': 0.9889107364210393, 'loss_val': 0.42387420637133727, 'psi': 0.9564341721148417}-{'f1_val': 0.8431429231056708, 'auprc': 0.8481285996472171, 'loss_val': 1.2036898790660755, 'psi': 0.8451371937222893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=80 head_norm_before_train=1.874178 cos_to_last_merge=0.8735 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.873
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.5980973902853217, 'auprc': 0.7845703489555143, 'loss_val': 1.5259691396135742, 'psi': 0.6726865737533987}-{'f1_val': 0.8316484740135845, 'auprc': 0.9930694390075252, 'loss_val': 0.6461469755091501, 'psi': 0.8962168600111609}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=81 head_norm_before_train=1.941653 cos_to_last_merge=0.7209 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.721
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.7062796258586019, 'auprc': 0.8610753171440655, 'loss_val': 0.7493997305704135, 'psi': 0.7681979023727874}-{'f1_val': 0.7080786341251635, 'auprc': 0.8545941142869866, 'loss_val': 0.6703241032337172, 'psi': 0.7666848261898928}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.191723 cos_to_last_merge=0.9176 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=81 local utility u=0.009304 metrics={'f1_val': 0.9517327343072599, 'auprc': 0.9948874487202994, 'loss_val': 0.12944401439625303, 'psi': 0.9689946200724757}-{'f1_val': 0.9567772480566313, 'auprc': 0.9936806368879154, 'loss_val': 0.17469923370757295, 'psi': 0.9715386035891449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=81 head_norm_before_train=1.707949 cos_to_last_merge=0.8656 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.866
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9412619874378233, 'auprc': 0.9490379404128667, 'loss_val': 0.3239408647341064, 'psi': 0.9443723686278407}-{'f1_val': 0.942118359881271, 'auprc': 0.952420571006421, 'loss_val': 0.3210221082506703, 'psi': 0.946239244331331}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=2.132040 (no previous merge yet)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9998230205115483, 'loss_val': 0.019601334851384457, 'psi': 0.9979503892916939}-{'f1_val': 0.9978756509554264, 'auprc': 0.9998175959957174, 'loss_val': 0.02571050455029847, 'psi': 0.9986524289715428}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=1.933879 cos_to_last_merge=0.8617 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.618793486576953, 'auprc': 0.8585742490976952, 'loss_val': 1.2488034506478132, 'psi': 0.7147057915852499}-{'f1_val': 0.8621286105867737, 'auprc': 0.9819849321795416, 'loss_val': 0.22936303698799992, 'psi': 0.9100711392238809}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.637648 cos_to_last_merge=0.8567 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.857
[S7] round=81 local utility u=0.151094 metrics={'f1_val': 0.6623409527989585, 'auprc': 0.8041473184442467, 'loss_val': 0.5103076730342451, 'psi': 0.7190634990570738}-{'f1_val': 0.6305262508668605, 'auprc': 0.7943304111377971, 'loss_val': 0.5921572933228155, 'psi': 0.6960479149752352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=81 head_norm_before_train=2.047500 cos_to_last_merge=0.9494 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9994780098703973, 'loss_val': 0.029759908930003128, 'psi': 0.9950957481662259}-{'f1_val': 0.9925374035278365, 'auprc': 0.9989751618243351, 'loss_val': 0.029615710662272175, 'psi': 0.9951125068464359}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=1.942178 cos_to_last_merge=0.9209 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.921
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9888471887074294, 'auprc': 0.9987534785037107, 'loss_val': 0.03670895540889117, 'psi': 0.9928097046259419}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985665784962284, 'loss_val': 0.01822030871338851, 'psi': 0.9974229384868263}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=81 head_norm_before_train=2.039471 cos_to_last_merge=0.9041 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=81 local utility u=0.000061 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963202664244114, 'loss_val': 0.02307671457054644, 'psi': 0.9955090184888102}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963630196844943, 'loss_val': 0.02332646469421376, 'psi': 0.9955261197928433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=81 head_norm_before_train=2.310767 (no previous merge yet)
[S11] round=81 local utility u=0.024517 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9994712642314363, 'loss_val': 0.015232474701436013, 'psi': 0.9979812165471039}-{'f1_val': 0.9914733941771422, 'auprc': 0.9998685116561324, 'loss_val': 0.03237149074162636, 'psi': 0.9948314411687382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=81 head_norm_before_train=1.912284 (no previous merge yet)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.6498238718673973, 'auprc': 0.6985608293588973, 'loss_val': 0.9623468194938657, 'psi': 0.6693186548639973}-{'f1_val': 0.7270323955089004, 'auprc': 0.7478953098048191, 'loss_val': 0.8486000761717857, 'psi': 0.7353775612272679}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=2.097816 cos_to_last_merge=0.9698 (last merge round=17)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9985011776635007, 'loss_val': 0.020075667160684058, 'psi': 0.9979927767549739}-{'f1_val': 0.9976319732898762, 'auprc': 0.9992345029375072, 'loss_val': 0.01872008704737621, 'psi': 0.9982729851489286}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=1.938241 cos_to_last_merge=0.9099 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.910
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.9324737879674023, 'auprc': 0.9975972593430068, 'loss_val': 0.11063488455905723, 'psi': 0.9585231765176441}-{'f1_val': 0.9481207130297594, 'auprc': 0.9971849610987726, 'loss_val': 0.08971114276305636, 'psi': 0.9677464122573647}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=1.941771 cos_to_last_merge=0.9162 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=81 local utility u=0.372315 metrics={'f1_val': 0.9925808634255231, 'auprc': 0.9925948324649003, 'loss_val': 0.03708343920614275, 'psi': 0.992586451041274}-{'f1_val': 0.9347831292440432, 'auprc': 0.9889107364210393, 'loss_val': 0.42387420637133727, 'psi': 0.9564341721148417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=81 head_norm_before_train=1.877776 cos_to_last_merge=0.8729 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.873
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.5726547944652801, 'auprc': 0.7339000454096677, 'loss_val': 1.5755899645732212, 'psi': 0.6371528948430352}-{'f1_val': 0.5980973902853217, 'auprc': 0.7845703489555143, 'loss_val': 1.5259691396135742, 'psi': 0.6726865737533987}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=1.946121 cos_to_last_merge=0.7206 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.721
[S2] round=82 local utility u=0.355596 metrics={'f1_val': 0.8014570246613546, 'auprc': 0.8556486088631261, 'loss_val': 0.5929912730366024, 'psi': 0.8231336583420632}-{'f1_val': 0.7062796258586019, 'auprc': 0.8610753171440655, 'loss_val': 0.7493997305704135, 'psi': 0.7681979023727874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=82 head_norm_before_train=2.194191 cos_to_last_merge=0.9171 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.952230922886623, 'auprc': 0.9937733016880252, 'loss_val': 0.14982869762480755, 'psi': 0.968847874407184}-{'f1_val': 0.9517327343072599, 'auprc': 0.9948874487202994, 'loss_val': 0.12944401439625303, 'psi': 0.9689946200724757}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=1.708076 cos_to_last_merge=0.8657 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.866
[S4] round=82 local utility u=0.037943 metrics={'f1_val': 0.9488019256579545, 'auprc': 0.9551282180699627, 'loss_val': 0.31156552871652016, 'psi': 0.9513324426227577}-{'f1_val': 0.9412619874378233, 'auprc': 0.9490379404128667, 'loss_val': 0.3239408647341064, 'psi': 0.9443723686278407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=82 head_norm_before_train=2.134360 (no previous merge yet)
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9933414911467549, 'loss_val': 0.028115995914193937, 'psi': 0.995136883636836}-{'f1_val': 0.9967019684784577, 'auprc': 0.9998230205115483, 'loss_val': 0.019601334851384457, 'psi': 0.9979503892916939}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=1.939290 cos_to_last_merge=0.8612 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=82 local utility u=1.000000 metrics={'f1_val': 0.8962830267843107, 'auprc': 0.9596143648927055, 'loss_val': 0.21974335328162733, 'psi': 0.9216155620276686}-{'f1_val': 0.618793486576953, 'auprc': 0.8585742490976952, 'loss_val': 1.2488034506478132, 'psi': 0.7147057915852499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=82 head_norm_before_train=1.643059 cos_to_last_merge=0.8560 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.856
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.6121399275329896, 'auprc': 0.7947769797051814, 'loss_val': 0.7154720304797214, 'psi': 0.6851947484018663}-{'f1_val': 0.6623409527989585, 'auprc': 0.8041473184442467, 'loss_val': 0.5103076730342451, 'psi': 0.7190634990570738}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=2.050911 cos_to_last_merge=0.9491 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=82 local utility u=0.010048 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9996912226410594, 'loss_val': 0.023413136345248997, 'psi': 0.9964919054157397}-{'f1_val': 0.992174240363445, 'auprc': 0.9994780098703973, 'loss_val': 0.029759908930003128, 'psi': 0.9950957481662259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=82 head_norm_before_train=1.935776 cos_to_last_merge=0.9184 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.918
[S9] round=82 local utility u=0.027092 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9957657457764962, 'loss_val': 0.01893958459792152, 'psi': 0.996152409710931}-{'f1_val': 0.9888471887074294, 'auprc': 0.9987534785037107, 'loss_val': 0.03670895540889117, 'psi': 0.9928097046259419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=82 head_norm_before_train=2.044613 cos_to_last_merge=0.9035 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=82 local utility u=0.000153 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963760377151732, 'loss_val': 0.022937352908538225, 'psi': 0.9955313270051149}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963202664244114, 'loss_val': 0.02307671457054644, 'psi': 0.9955090184888102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=82 head_norm_before_train=2.314653 (no previous merge yet)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9962649549813628, 'auprc': 0.999537434490642, 'loss_val': 0.01589728974991649, 'psi': 0.9975739467850745}-{'f1_val': 0.9969878514242156, 'auprc': 0.9994712642314363, 'loss_val': 0.015232474701436013, 'psi': 0.9979812165471039}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=1.915392 (no previous merge yet)
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6371000665525033, 'auprc': 0.6848903907007222, 'loss_val': 1.107274846134311, 'psi': 0.656216196211791}-{'f1_val': 0.6498238718673973, 'auprc': 0.6985608293588973, 'loss_val': 0.9623468194938657, 'psi': 0.6693186548639973}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=2.103669 cos_to_last_merge=0.9695 (last merge round=17)
[S14] round=82 local utility u=0.003118 metrics={'f1_val': 0.9982111419559175, 'auprc': 0.9992348060731575, 'loss_val': 0.019383572884661724, 'psi': 0.9986206076028136}-{'f1_val': 0.9976538428159559, 'auprc': 0.9985011776635007, 'loss_val': 0.020075667160684058, 'psi': 0.9979927767549739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=82 head_norm_before_train=1.944182 cos_to_last_merge=0.9095 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9273450653724742, 'auprc': 0.9976428425902454, 'loss_val': 0.12299335408648557, 'psi': 0.9554641762595826}-{'f1_val': 0.9324737879674023, 'auprc': 0.9975972593430068, 'loss_val': 0.11063488455905723, 'psi': 0.9585231765176441}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=1.945667 cos_to_last_merge=0.9155 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.9083382073132187, 'auprc': 0.9875916025341236, 'loss_val': 0.257838114939154, 'psi': 0.9400395654015806}-{'f1_val': 0.9925808634255231, 'auprc': 0.9925948324649003, 'loss_val': 0.03708343920614275, 'psi': 0.992586451041274}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=1.880012 cos_to_last_merge=0.8723 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=82 local utility u=0.646386 metrics={'f1_val': 0.6516545517468908, 'auprc': 0.8811934218680862, 'loss_val': 1.1986966259298173, 'psi': 0.7434700997953689}-{'f1_val': 0.5726547944652801, 'auprc': 0.7339000454096677, 'loss_val': 1.5755899645732212, 'psi': 0.6371528948430352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=83 head_norm_before_train=1.950799 cos_to_last_merge=0.7203 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.720
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.7074500796433039, 'auprc': 0.8565703363313717, 'loss_val': 0.7449420542015477, 'psi': 0.767098182318531}-{'f1_val': 0.8014570246613546, 'auprc': 0.8556486088631261, 'loss_val': 0.5929912730366024, 'psi': 0.8231336583420632}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.198265 cos_to_last_merge=0.9166 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.956525447130457, 'auprc': 0.9933779000312415, 'loss_val': 0.18083946778082063, 'psi': 0.9712664282907707}-{'f1_val': 0.952230922886623, 'auprc': 0.9937733016880252, 'loss_val': 0.14982869762480755, 'psi': 0.968847874407184}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=1.712296 cos_to_last_merge=0.8653 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.865
[S4] round=83 local utility u=0.000000 metrics={'f1_val': 0.9419179128232715, 'auprc': 0.9483837384632031, 'loss_val': 0.3216175439700025, 'psi': 0.9445042430792442}-{'f1_val': 0.9488019256579545, 'auprc': 0.9551282180699627, 'loss_val': 0.31156552871652016, 'psi': 0.9513324426227577}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=83 head_norm_before_train=2.140038 (no previous merge yet)
[S5] round=83 local utility u=0.015613 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9998960750022785, 'loss_val': 0.018762298567793066, 'psi': 0.9979796110879859}-{'f1_val': 0.9963338119635569, 'auprc': 0.9933414911467549, 'loss_val': 0.028115995914193937, 'psi': 0.995136883636836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=83 head_norm_before_train=1.944150 cos_to_last_merge=0.8610 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=83 local utility u=0.272998 metrics={'f1_val': 0.9630828257755195, 'auprc': 0.9751647258642169, 'loss_val': 0.12119793413678516, 'psi': 0.9679155858109985}-{'f1_val': 0.8962830267843107, 'auprc': 0.9596143648927055, 'loss_val': 0.21974335328162733, 'psi': 0.9216155620276686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=83 head_norm_before_train=1.648785 cos_to_last_merge=0.8553 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.855
[S7] round=83 local utility u=0.596209 metrics={'f1_val': 0.6989595534475257, 'auprc': 0.8658301899017514, 'loss_val': 0.25713055038698557, 'psi': 0.765707808029216}-{'f1_val': 0.6121399275329896, 'auprc': 0.7947769797051814, 'loss_val': 0.7154720304797214, 'psi': 0.6851947484018663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=83 head_norm_before_train=2.053123 cos_to_last_merge=0.9487 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9994511696985362, 'loss_val': 0.02937251294978058, 'psi': 0.9953033026287157}-{'f1_val': 0.9943590272655265, 'auprc': 0.9996912226410594, 'loss_val': 0.023413136345248997, 'psi': 0.9964919054157397}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=1.935302 cos_to_last_merge=0.9168 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.917
[S9] round=83 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9935259173620942, 'loss_val': 0.01984780670467624, 'psi': 0.9951604238124042}-{'f1_val': 0.9964101856672208, 'auprc': 0.9957657457764962, 'loss_val': 0.01893958459792152, 'psi': 0.996152409710931}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=83 head_norm_before_train=2.050272 cos_to_last_merge=0.9030 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.903
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963929784955, 'loss_val': 0.02307297359312342, 'psi': 0.9955381033172457}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963760377151732, 'loss_val': 0.022937352908538225, 'psi': 0.9955313270051149}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=2.314369 (no previous merge yet)
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9936237174181748, 'auprc': 0.9995295227357447, 'loss_val': 0.02593018978510683, 'psi': 0.9959860395452028}-{'f1_val': 0.9962649549813628, 'auprc': 0.999537434490642, 'loss_val': 0.01589728974991649, 'psi': 0.9975739467850745}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.922438 (no previous merge yet)
[S13] round=83 local utility u=0.395741 metrics={'f1_val': 0.6866602075192634, 'auprc': 0.7730371596074517, 'loss_val': 0.8775940835032119, 'psi': 0.7212109883545388}-{'f1_val': 0.6371000665525033, 'auprc': 0.6848903907007222, 'loss_val': 1.107274846134311, 'psi': 0.656216196211791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=83 head_norm_before_train=2.109651 cos_to_last_merge=0.9693 (last merge round=17)
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9503820739589453, 'auprc': 0.998277271568818, 'loss_val': 0.08332121513268088, 'psi': 0.9695401530028944}-{'f1_val': 0.9982111419559175, 'auprc': 0.9992348060731575, 'loss_val': 0.019383572884661724, 'psi': 0.9986206076028136}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=1.950099 cos_to_last_merge=0.9090 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=83 local utility u=0.074157 metrics={'f1_val': 0.9498319561262069, 'auprc': 0.998077918661849, 'loss_val': 0.11090626406748137, 'psi': 0.9691303411404637}-{'f1_val': 0.9273450653724742, 'auprc': 0.9976428425902454, 'loss_val': 0.12299335408648557, 'psi': 0.9554641762595826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=83 head_norm_before_train=1.949188 cos_to_last_merge=0.9147 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=83 local utility u=0.369889 metrics={'f1_val': 0.9925808634255231, 'auprc': 0.9922402149749245, 'loss_val': 0.03746137077317244, 'psi': 0.9924446040452837}-{'f1_val': 0.9083382073132187, 'auprc': 0.9875916025341236, 'loss_val': 0.257838114939154, 'psi': 0.9400395654015806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=83 head_norm_before_train=1.883518 cos_to_last_merge=0.8719 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=83 local utility u=0.855620 metrics={'f1_val': 0.8260549684235233, 'auprc': 0.9507990202669775, 'loss_val': 0.7426763842489977, 'psi': 0.875952589160905}-{'f1_val': 0.6516545517468908, 'auprc': 0.8811934218680862, 'loss_val': 1.1986966259298173, 'psi': 0.7434700997953689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=84 head_norm_before_train=1.954466 cos_to_last_merge=0.7200 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.720
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7097128547532122, 'auprc': 0.8360707294875667, 'loss_val': 0.7686029740171503, 'psi': 0.760256004646954}-{'f1_val': 0.7074500796433039, 'auprc': 0.8565703363313717, 'loss_val': 0.7449420542015477, 'psi': 0.767098182318531}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.203303 cos_to_last_merge=0.9161 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=84 local utility u=0.108194 metrics={'f1_val': 0.9704427633306023, 'auprc': 0.9970174261234901, 'loss_val': 0.058873794623961105, 'psi': 0.9810726284477574}-{'f1_val': 0.956525447130457, 'auprc': 0.9933779000312415, 'loss_val': 0.18083946778082063, 'psi': 0.9712664282907707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=84 head_norm_before_train=1.717354 cos_to_last_merge=0.8648 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.865
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9414811298260634, 'auprc': 0.9471950963263565, 'loss_val': 0.32353728271385807, 'psi': 0.9437667164261806}-{'f1_val': 0.9419179128232715, 'auprc': 0.9483837384632031, 'loss_val': 0.3216175439700025, 'psi': 0.9445042430792442}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=2.146579 (no previous merge yet)
[S5] round=84 local utility u=0.000708 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9999820787563323, 'loss_val': 0.017604252479732182, 'psi': 0.9980140125896075}-{'f1_val': 0.9967019684784577, 'auprc': 0.9998960750022785, 'loss_val': 0.018762298567793066, 'psi': 0.9979796110879859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=84 head_norm_before_train=1.946334 cos_to_last_merge=0.8601 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.860
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.5937447016973104, 'auprc': 0.6696868072380634, 'loss_val': 1.4636599898677076, 'psi': 0.6241215439136116}-{'f1_val': 0.9630828257755195, 'auprc': 0.9751647258642169, 'loss_val': 0.12119793413678516, 'psi': 0.9679155858109985}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.652925 cos_to_last_merge=0.8548 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.855
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.5652837181166651, 'auprc': 0.7880766139166963, 'loss_val': 0.8751651715864119, 'psi': 0.6544008764366775}-{'f1_val': 0.6989595534475257, 'auprc': 0.8658301899017514, 'loss_val': 0.25713055038698557, 'psi': 0.765707808029216}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=2.056587 cos_to_last_merge=0.9485 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.8980071030232113, 'auprc': 0.9992541360337113, 'loss_val': 0.16946329713218808, 'psi': 0.9385059162274112}-{'f1_val': 0.9925380579155019, 'auprc': 0.9994511696985362, 'loss_val': 0.02937251294978058, 'psi': 0.9953033026287157}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=1.934526 cos_to_last_merge=0.9150 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.915
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9914152665170077, 'auprc': 0.9983499891454375, 'loss_val': 0.026985151264991968, 'psi': 0.9941891555683796}-{'f1_val': 0.9962500947792776, 'auprc': 0.9935259173620942, 'loss_val': 0.01984780670467624, 'psi': 0.9951604238124042}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.056176 cos_to_last_merge=0.9025 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.903
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963691855281264, 'loss_val': 0.02310439387816459, 'psi': 0.9955285861302963}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963929784955, 'loss_val': 0.02307297359312342, 'psi': 0.9955381033172457}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.315821 (no previous merge yet)
[S11] round=84 local utility u=0.015376 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9995341346155393, 'loss_val': 0.01537760033820157, 'psi': 0.9980063647007451}-{'f1_val': 0.9936237174181748, 'auprc': 0.9995295227357447, 'loss_val': 0.02593018978510683, 'psi': 0.9959860395452028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=84 head_norm_before_train=1.928506 (no previous merge yet)
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.5921688962784162, 'auprc': 0.5877887140458941, 'loss_val': 1.4490243173468451, 'psi': 0.5904168233854074}-{'f1_val': 0.6866602075192634, 'auprc': 0.7730371596074517, 'loss_val': 0.8775940835032119, 'psi': 0.7212109883545388}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=2.111708 cos_to_last_merge=0.9691 (last merge round=17)
[S14] round=84 local utility u=0.177983 metrics={'f1_val': 0.9980651139537664, 'auprc': 0.9992353842015737, 'loss_val': 0.016327624386061317, 'psi': 0.9985332220528893}-{'f1_val': 0.9503820739589453, 'auprc': 0.998277271568818, 'loss_val': 0.08332121513268088, 'psi': 0.9695401530028944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=84 head_norm_before_train=1.955977 cos_to_last_merge=0.9086 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=84 local utility u=0.042037 metrics={'f1_val': 0.9585471395598362, 'auprc': 0.9974917921206887, 'loss_val': 0.07736465785934106, 'psi': 0.9741250005841772}-{'f1_val': 0.9498319561262069, 'auprc': 0.998077918661849, 'loss_val': 0.11090626406748137, 'psi': 0.9691303411404637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=84 head_norm_before_train=1.953626 cos_to_last_merge=0.9142 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.914
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.942923853985235, 'auprc': 0.9903672180093889, 'loss_val': 0.30201523027683497, 'psi': 0.9619011995948966}-{'f1_val': 0.9925808634255231, 'auprc': 0.9922402149749245, 'loss_val': 0.03746137077317244, 'psi': 0.9924446040452837}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=1.887915 cos_to_last_merge=0.8716 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.6929502226885742, 'auprc': 0.954870016903062, 'loss_val': 1.057596577884786, 'psi': 0.7977181403743694}-{'f1_val': 0.8260549684235233, 'auprc': 0.9507990202669775, 'loss_val': 0.7426763842489977, 'psi': 0.875952589160905}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=1.957512 cos_to_last_merge=0.7198 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.720
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.6632176302093999, 'auprc': 0.7647189561207113, 'loss_val': 1.6954325961792747, 'psi': 0.7038181605739244}-{'f1_val': 0.7097128547532122, 'auprc': 0.8360707294875667, 'loss_val': 0.7686029740171503, 'psi': 0.760256004646954}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.208714 cos_to_last_merge=0.9157 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.9727801496195924, 'auprc': 0.9984778967343173, 'loss_val': 0.09633171962941679, 'psi': 0.9830592484654823}-{'f1_val': 0.9704427633306023, 'auprc': 0.9970174261234901, 'loss_val': 0.058873794623961105, 'psi': 0.9810726284477574}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=1.721159 cos_to_last_merge=0.8645 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.864
[S4] round=85 local utility u=0.025871 metrics={'f1_val': 0.9488200732036658, 'auprc': 0.9469650127540413, 'loss_val': 0.31513882445883273, 'psi': 0.948078049023816}-{'f1_val': 0.9414811298260634, 'auprc': 0.9471950963263565, 'loss_val': 0.32353728271385807, 'psi': 0.9437667164261806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=85 head_norm_before_train=2.149666 (no previous merge yet)
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.981901873353844, 'auprc': 0.9930438995210952, 'loss_val': 0.044752443335278204, 'psi': 0.9863586838207445}-{'f1_val': 0.9967019684784577, 'auprc': 0.9999820787563323, 'loss_val': 0.017604252479732182, 'psi': 0.9980140125896075}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=1.946424 cos_to_last_merge=0.8581 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.858
[S6] round=85 local utility u=1.000000 metrics={'f1_val': 0.8261078517576927, 'auprc': 0.947359164481215, 'loss_val': 0.5535185874105756, 'psi': 0.8746083768471017}-{'f1_val': 0.5937447016973104, 'auprc': 0.6696868072380634, 'loss_val': 1.4636599898677076, 'psi': 0.6241215439136116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=85 head_norm_before_train=1.656355 cos_to_last_merge=0.8543 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=85 local utility u=0.637006 metrics={'f1_val': 0.6714361949674539, 'auprc': 0.8301343907278327, 'loss_val': 0.3642414735092498, 'psi': 0.7349154732716054}-{'f1_val': 0.5652837181166651, 'auprc': 0.7880766139166963, 'loss_val': 0.8751651715864119, 'psi': 0.6544008764366775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=85 head_norm_before_train=2.062286 cos_to_last_merge=0.9481 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=85 local utility u=0.352175 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9996182436297827, 'loss_val': 0.029029131909128963, 'psi': 0.9949338781496189}-{'f1_val': 0.8980071030232113, 'auprc': 0.9992541360337113, 'loss_val': 0.16946329713218808, 'psi': 0.9385059162274112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=85 head_norm_before_train=1.936207 cos_to_last_merge=0.9139 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.914
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9983422314652474, 'loss_val': 0.02939880912386261, 'psi': 0.9936799976458339}-{'f1_val': 0.9914152665170077, 'auprc': 0.9983499891454375, 'loss_val': 0.026985151264991968, 'psi': 0.9941891555683796}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=2.059571 cos_to_last_merge=0.9019 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.902
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9957602815315985, 'loss_val': 0.023062960195370408, 'psi': 0.9952850245316851}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963691855281264, 'loss_val': 0.02310439387816459, 'psi': 0.9955285861302963}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=2.318919 (no previous merge yet)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9995046737596549, 'loss_val': 0.01597907600889505, 'psi': 0.9979945803583914}-{'f1_val': 0.9969878514242156, 'auprc': 0.9995341346155393, 'loss_val': 0.01537760033820157, 'psi': 0.9980063647007451}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=1.935167 (no previous merge yet)
[S13] round=85 local utility u=0.850777 metrics={'f1_val': 0.7340772034313334, 'auprc': 0.7228406870166166, 'loss_val': 1.004076588231012, 'psi': 0.7295825968654467}-{'f1_val': 0.5921688962784162, 'auprc': 0.5877887140458941, 'loss_val': 1.4490243173468451, 'psi': 0.5904168233854074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=85 head_norm_before_train=2.115225 cos_to_last_merge=0.9689 (last merge round=17)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9992360544626789, 'loss_val': 0.02560000734088872, 'psi': 0.9981244518022754}-{'f1_val': 0.9980651139537664, 'auprc': 0.9992353842015737, 'loss_val': 0.016327624386061317, 'psi': 0.9985332220528893}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=1.960480 cos_to_last_merge=0.9083 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.908
[S15] round=85 local utility u=0.080333 metrics={'f1_val': 0.9797655229955603, 'auprc': 0.9972354547536977, 'loss_val': 0.04324050479549702, 'psi': 0.9867534956988152}-{'f1_val': 0.9585471395598362, 'auprc': 0.9974917921206887, 'loss_val': 0.07736465785934106, 'psi': 0.9741250005841772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=85 head_norm_before_train=1.958397 cos_to_last_merge=0.9137 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.914
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.8614342421320952, 'auprc': 0.970841188906939, 'loss_val': 1.0344522335600492, 'psi': 0.9051970208420327}-{'f1_val': 0.942923853985235, 'auprc': 0.9903672180093889, 'loss_val': 0.30201523027683497, 'psi': 0.9619011995948966}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=1.892471 cos_to_last_merge=0.8710 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.871
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.6449738515484242, 'auprc': 0.9256048987452681, 'loss_val': 1.3551553815671056, 'psi': 0.7572262704271617}-{'f1_val': 0.6929502226885742, 'auprc': 0.954870016903062, 'loss_val': 1.057596577884786, 'psi': 0.7977181403743694}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=86 head_norm_before_train=1.960011 cos_to_last_merge=0.7196 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.720
[S2] round=86 local utility u=0.414956 metrics={'f1_val': 0.6633000069674867, 'auprc': 0.8137395896597996, 'loss_val': 1.0130771496864615, 'psi': 0.7234758400444119}-{'f1_val': 0.6632176302093999, 'auprc': 0.7647189561207113, 'loss_val': 1.6954325961792747, 'psi': 0.7038181605739244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=86 head_norm_before_train=2.210369 cos_to_last_merge=0.9151 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=86 local utility u=0.097034 metrics={'f1_val': 0.9929600896899338, 'auprc': 0.9987301393860323, 'loss_val': 0.024099503410946355, 'psi': 0.9952681095683732}-{'f1_val': 0.9727801496195924, 'auprc': 0.9984778967343173, 'loss_val': 0.09633171962941679, 'psi': 0.9830592484654823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=86 head_norm_before_train=1.722860 cos_to_last_merge=0.8640 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.864
[S4] round=86 local utility u=0.041193 metrics={'f1_val': 0.9556246872719614, 'auprc': 0.9615343543006221, 'loss_val': 0.31728942598031623, 'psi': 0.9579885540834256}-{'f1_val': 0.9488200732036658, 'auprc': 0.9469650127540413, 'loss_val': 0.31513882445883273, 'psi': 0.948078049023816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=86 head_norm_before_train=2.150691 (no previous merge yet)
[S5] round=86 local utility u=0.063510 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9968079705456065, 'loss_val': 0.01782535127926195, 'psi': 0.9967443693053173}-{'f1_val': 0.981901873353844, 'auprc': 0.9930438995210952, 'loss_val': 0.044752443335278204, 'psi': 0.9863586838207445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=86 head_norm_before_train=1.950924 cos_to_last_merge=0.8577 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.858
[S6] round=86 local utility u=0.697228 metrics={'f1_val': 0.9802299362197224, 'auprc': 0.9530993886987209, 'loss_val': 0.10101565015463268, 'psi': 0.9693777172113218}-{'f1_val': 0.8261078517576927, 'auprc': 0.947359164481215, 'loss_val': 0.5535185874105756, 'psi': 0.8746083768471017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=86 head_norm_before_train=1.660716 cos_to_last_merge=0.8538 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6149286397090363, 'auprc': 0.7978871948347473, 'loss_val': 0.6742206931753056, 'psi': 0.6881120617593208}-{'f1_val': 0.6714361949674539, 'auprc': 0.8301343907278327, 'loss_val': 0.3642414735092498, 'psi': 0.7349154732716054}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=2.066550 cos_to_last_merge=0.9477 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=86 local utility u=0.009990 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9998629623335331, 'loss_val': 0.026793093109979817, 'psi': 0.9967327638910392}-{'f1_val': 0.9918109678295097, 'auprc': 0.9996182436297827, 'loss_val': 0.029029131909128963, 'psi': 0.9949338781496189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=86 head_norm_before_train=1.939678 cos_to_last_merge=0.9133 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.913
[S9] round=86 local utility u=0.014816 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9937265847841252, 'loss_val': 0.019989379307929538, 'psi': 0.9952406907812167}-{'f1_val': 0.9905718417662249, 'auprc': 0.9983422314652474, 'loss_val': 0.02939880912386261, 'psi': 0.9936799976458339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=86 head_norm_before_train=2.062230 cos_to_last_merge=0.9014 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.901
[S10] round=86 local utility u=0.000541 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9961186640901595, 'loss_val': 0.023056480503917693, 'psi': 0.9954283775551095}-{'f1_val': 0.9949681865317428, 'auprc': 0.9957602815315985, 'loss_val': 0.023062960195370408, 'psi': 0.9952850245316851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=86 head_norm_before_train=2.322664 (no previous merge yet)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9912350492957716, 'auprc': 0.9995361682828954, 'loss_val': 0.03863840343158568, 'psi': 0.9945554968906211}-{'f1_val': 0.9969878514242156, 'auprc': 0.9995046737596549, 'loss_val': 0.01597907600889505, 'psi': 0.9979945803583914}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=1.937341 (no previous merge yet)
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6242611024870987, 'auprc': 0.6485506455874718, 'loss_val': 1.2233918662455279, 'psi': 0.6339769197272479}-{'f1_val': 0.7340772034313334, 'auprc': 0.7228406870166166, 'loss_val': 1.004076588231012, 'psi': 0.7295825968654467}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=2.120861 cos_to_last_merge=0.9688 (last merge round=17)
[S14] round=86 local utility u=0.005563 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9992344255035208, 'loss_val': 0.01956728877472051, 'psi': 0.9986335766777312}-{'f1_val': 0.9973833833620065, 'auprc': 0.9992360544626789, 'loss_val': 0.02560000734088872, 'psi': 0.9981244518022754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=86 head_norm_before_train=1.964038 cos_to_last_merge=0.9080 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.908
[S15] round=86 local utility u=0.006223 metrics={'f1_val': 0.9810319961598701, 'auprc': 0.9978325882112571, 'loss_val': 0.04018440873275285, 'psi': 0.9877522329804249}-{'f1_val': 0.9797655229955603, 'auprc': 0.9972354547536977, 'loss_val': 0.04324050479549702, 'psi': 0.9867534956988152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=86 head_norm_before_train=1.963717 cos_to_last_merge=0.9133 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.8581567604404925, 'auprc': 0.85524399605824, 'loss_val': 1.1051077515765393, 'psi': 0.8569916546875915}-{'f1_val': 0.8614342421320952, 'auprc': 0.970841188906939, 'loss_val': 1.0344522335600492, 'psi': 0.9051970208420327}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=1.897499 cos_to_last_merge=0.8704 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=86 local utility u=0.810588 metrics={'f1_val': 0.8223659895978127, 'auprc': 0.9255398478072534, 'loss_val': 0.7981372112761592, 'psi': 0.863635532881589}-{'f1_val': 0.6449738515484242, 'auprc': 0.9256048987452681, 'loss_val': 1.3551553815671056, 'psi': 0.7572262704271617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=87 head_norm_before_train=1.962983 cos_to_last_merge=0.7194 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.719
[S2] round=87 local utility u=0.155255 metrics={'f1_val': 0.7261998101869774, 'auprc': 0.8065277194069649, 'loss_val': 1.0583294405962598, 'psi': 0.7583309738749724}-{'f1_val': 0.6633000069674867, 'auprc': 0.8137395896597996, 'loss_val': 1.0130771496864615, 'psi': 0.7234758400444119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=87 head_norm_before_train=2.212328 cos_to_last_merge=0.9146 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.9919643682469865, 'auprc': 0.9986592021016261, 'loss_val': 0.026224209310226128, 'psi': 0.9946423017888423}-{'f1_val': 0.9929600896899338, 'auprc': 0.9987301393860323, 'loss_val': 0.024099503410946355, 'psi': 0.9952681095683732}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=1.723366 cos_to_last_merge=0.8637 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.864
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9511060766466728, 'auprc': 0.9483076819396685, 'loss_val': 0.3133482068599066, 'psi': 0.9499867187638711}-{'f1_val': 0.9556246872719614, 'auprc': 0.9615343543006221, 'loss_val': 0.31728942598031623, 'psi': 0.9579885540834256}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=2.154625 (no previous merge yet)
[S5] round=87 local utility u=0.005549 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9999818014561271, 'loss_val': 0.016248464518568227, 'psi': 0.9980139016695255}-{'f1_val': 0.9967019684784577, 'auprc': 0.9968079705456065, 'loss_val': 0.01782535127926195, 'psi': 0.9967443693053173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=87 head_norm_before_train=1.956643 cos_to_last_merge=0.8576 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.858
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.8096594613258237, 'auprc': 0.939408283450069, 'loss_val': 0.6405994182907433, 'psi': 0.8615589901755218}-{'f1_val': 0.9802299362197224, 'auprc': 0.9530993886987209, 'loss_val': 0.10101565015463268, 'psi': 0.9693777172113218}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.666349 cos_to_last_merge=0.8528 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.853
[S7] round=87 local utility u=0.259027 metrics={'f1_val': 0.6615866567464534, 'auprc': 0.8094311947775572, 'loss_val': 0.4707458643703446, 'psi': 0.720724471958895}-{'f1_val': 0.6149286397090363, 'auprc': 0.7978871948347473, 'loss_val': 0.6742206931753056, 'psi': 0.6881120617593208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=87 head_norm_before_train=2.071429 cos_to_last_merge=0.9472 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9710484465030425, 'auprc': 0.9994249946864189, 'loss_val': 0.08543048745456254, 'psi': 0.982399065776393}-{'f1_val': 0.9946459649293765, 'auprc': 0.9998629623335331, 'loss_val': 0.026793093109979817, 'psi': 0.9967327638910392}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=1.944136 cos_to_last_merge=0.9131 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.913
[S9] round=87 local utility u=0.006182 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964943774610597, 'loss_val': 0.018391267035722095, 'psi': 0.9965940580727588}-{'f1_val': 0.9962500947792776, 'auprc': 0.9937265847841252, 'loss_val': 0.019989379307929538, 'psi': 0.9952406907812167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=87 head_norm_before_train=2.066423 cos_to_last_merge=0.9008 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.901
[S10] round=87 local utility u=0.000629 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9965717559744435, 'loss_val': 0.023157977308843298, 'psi': 0.9956096143088231}-{'f1_val': 0.9949681865317428, 'auprc': 0.9961186640901595, 'loss_val': 0.023056480503917693, 'psi': 0.9954283775551095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=87 head_norm_before_train=2.323640 (no previous merge yet)
[S11] round=87 local utility u=0.028610 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9995516248977907, 'loss_val': 0.015982582838481155, 'psi': 0.9980133608136457}-{'f1_val': 0.9912350492957716, 'auprc': 0.9995361682828954, 'loss_val': 0.03863840343158568, 'psi': 0.9945554968906211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=87 head_norm_before_train=1.937167 (no previous merge yet)
[S13] round=87 local utility u=0.721554 metrics={'f1_val': 0.740643785074347, 'auprc': 0.7793091503783918, 'loss_val': 0.870854972500705, 'psi': 0.7561099311959649}-{'f1_val': 0.6242611024870987, 'auprc': 0.6485506455874718, 'loss_val': 1.2233918662455279, 'psi': 0.6339769197272479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=87 head_norm_before_train=2.126764 cos_to_last_merge=0.9686 (last merge round=17)
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9992308467304574, 'loss_val': 0.01942303469869788, 'psi': 0.9981389352528798}-{'f1_val': 0.9982330107938716, 'auprc': 0.9992344255035208, 'loss_val': 0.01956728877472051, 'psi': 0.9986335766777312}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=1.968558 cos_to_last_merge=0.9077 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.908
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.8373750542230671, 'auprc': 0.9964555880180045, 'loss_val': 0.35160943670211064, 'psi': 0.9010072677410421}-{'f1_val': 0.9810319961598701, 'auprc': 0.9978325882112571, 'loss_val': 0.04018440873275285, 'psi': 0.9877522329804249}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=1.966995 cos_to_last_merge=0.9133 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=87 local utility u=0.073201 metrics={'f1_val': 0.8638859469553843, 'auprc': 0.8546580586378332, 'loss_val': 0.9913223377673334, 'psi': 0.8601947916283639}-{'f1_val': 0.8581567604404925, 'auprc': 0.85524399605824, 'loss_val': 1.1051077515765393, 'psi': 0.8569916546875915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=87 head_norm_before_train=1.902254 cos_to_last_merge=0.8703 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.7279867164675935, 'auprc': 0.9154702609870571, 'loss_val': 0.960726262479336, 'psi': 0.802980134275379}-{'f1_val': 0.8223659895978127, 'auprc': 0.9255398478072534, 'loss_val': 0.7981372112761592, 'psi': 0.863635532881589}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=1.965390 cos_to_last_merge=0.7192 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.719
[S2] round=88 local utility u=0.075570 metrics={'f1_val': 0.7110908076848333, 'auprc': 0.8228409716945881, 'loss_val': 0.8654750116721539, 'psi': 0.7557908732887353}-{'f1_val': 0.7261998101869774, 'auprc': 0.8065277194069649, 'loss_val': 1.0583294405962598, 'psi': 0.7583309738749724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=88 head_norm_before_train=2.216296 cos_to_last_merge=0.9142 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9842990376761878, 'auprc': 0.9987343157044524, 'loss_val': 0.04015849733309969, 'psi': 0.9900731488874936}-{'f1_val': 0.9919643682469865, 'auprc': 0.9986592021016261, 'loss_val': 0.026224209310226128, 'psi': 0.9946423017888423}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=1.725330 cos_to_last_merge=0.8634 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.863
[S4] round=88 local utility u=0.013081 metrics={'f1_val': 0.9544190212670296, 'auprc': 0.9504747113444427, 'loss_val': 0.31356450747917164, 'psi': 0.9528412972979948}-{'f1_val': 0.9511060766466728, 'auprc': 0.9483076819396685, 'loss_val': 0.3133482068599066, 'psi': 0.9499867187638711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=88 head_norm_before_train=2.160646 (no previous merge yet)
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9999827502439509, 'loss_val': 0.016461849290599437, 'psi': 0.998014281184655}-{'f1_val': 0.9967019684784577, 'auprc': 0.9999818014561271, 'loss_val': 0.016248464518568227, 'psi': 0.9980139016695255}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=1.961456 cos_to_last_merge=0.8568 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.857
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.6391457560103165, 'auprc': 0.8072140827678422, 'loss_val': 1.0839225156022292, 'psi': 0.7063730867133269}-{'f1_val': 0.8096594613258237, 'auprc': 0.939408283450069, 'loss_val': 0.6405994182907433, 'psi': 0.8615589901755218}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.670962 cos_to_last_merge=0.8523 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.852
[S7] round=88 local utility u=0.091399 metrics={'f1_val': 0.6684590696262156, 'auprc': 0.8267383667957421, 'loss_val': 0.3811033000499282, 'psi': 0.7317707884940262}-{'f1_val': 0.6615866567464534, 'auprc': 0.8094311947775572, 'loss_val': 0.4707458643703446, 'psi': 0.720724471958895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=88 head_norm_before_train=2.076601 cos_to_last_merge=0.9469 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=88 local utility u=0.080995 metrics={'f1_val': 0.9900154226160678, 'auprc': 0.9992651674425775, 'loss_val': 0.03676316622277865, 'psi': 0.9937153205466717}-{'f1_val': 0.9710484465030425, 'auprc': 0.9994249946864189, 'loss_val': 0.08543048745456254, 'psi': 0.982399065776393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=88 head_norm_before_train=1.949327 cos_to_last_merge=0.9129 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.913
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9841766825812317, 'auprc': 0.9986993723256242, 'loss_val': 0.059632429291026044, 'psi': 0.9899857584789887}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964943774610597, 'loss_val': 0.018391267035722095, 'psi': 0.9965940580727588}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.071422 cos_to_last_merge=0.9004 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.900
[S10] round=88 local utility u=0.001257 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974293806769565, 'loss_val': 0.023216907964608693, 'psi': 0.9959526641898283}-{'f1_val': 0.9949681865317428, 'auprc': 0.9965717559744435, 'loss_val': 0.023157977308843298, 'psi': 0.9956096143088231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=88 head_norm_before_train=2.325978 (no previous merge yet)
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.999542810635337, 'loss_val': 0.016254856553969854, 'psi': 0.9980098351086643}-{'f1_val': 0.9969878514242156, 'auprc': 0.9995516248977907, 'loss_val': 0.015982582838481155, 'psi': 0.9980133608136457}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=1.939449 (no previous merge yet)
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6312862175114695, 'auprc': 0.6549241397108789, 'loss_val': 1.240358187473366, 'psi': 0.6407413863912332}-{'f1_val': 0.740643785074347, 'auprc': 0.7793091503783918, 'loss_val': 0.870854972500705, 'psi': 0.7561099311959649}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=2.128943 cos_to_last_merge=0.9683 (last merge round=17)
[S14] round=88 local utility u=0.001860 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9992333718656496, 'loss_val': 0.01817515188012673, 'psi': 0.9983864043589152}-{'f1_val': 0.9974109942678281, 'auprc': 0.9992308467304574, 'loss_val': 0.01942303469869788, 'psi': 0.9981389352528798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=88 head_norm_before_train=1.973655 cos_to_last_merge=0.9073 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.907
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.779457196475893, 'auprc': 0.9949845641998503, 'loss_val': 0.5105583658864971, 'psi': 0.8656681435654758}-{'f1_val': 0.8373750542230671, 'auprc': 0.9964555880180045, 'loss_val': 0.35160943670211064, 'psi': 0.9010072677410421}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.970201 cos_to_last_merge=0.9130 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=88 local utility u=0.996076 metrics={'f1_val': 0.9780104020674074, 'auprc': 0.9898419291706279, 'loss_val': 0.08946779820470586, 'psi': 0.9827430129086956}-{'f1_val': 0.8638859469553843, 'auprc': 0.8546580586378332, 'loss_val': 0.9913223377673334, 'psi': 0.8601947916283639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=88 head_norm_before_train=1.907205 cos_to_last_merge=0.8698 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=88 local utility u=0.392623 metrics={'f1_val': 0.8188165995784621, 'auprc': 0.9444505979611353, 'loss_val': 0.8074007195444587, 'psi': 0.8690701989315314}-{'f1_val': 0.7279867164675935, 'auprc': 0.9154702609870571, 'loss_val': 0.960726262479336, 'psi': 0.802980134275379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=89 head_norm_before_train=1.968959 cos_to_last_merge=0.7190 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.719
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.7141927590363468, 'auprc': 0.8189145425464298, 'loss_val': 0.9107478945417115, 'psi': 0.75608147244038}-{'f1_val': 0.7110908076848333, 'auprc': 0.8228409716945881, 'loss_val': 0.8654750116721539, 'psi': 0.7557908732887353}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=2.221455 cos_to_last_merge=0.9138 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.9834363840689774, 'auprc': 0.9987487420308123, 'loss_val': 0.04967963979652274, 'psi': 0.9895613272537114}-{'f1_val': 0.9842990376761878, 'auprc': 0.9987343157044524, 'loss_val': 0.04015849733309969, 'psi': 0.9900731488874936}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=1.726242 cos_to_last_merge=0.8626 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.863
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.95535443182233, 'auprc': 0.9485463282527742, 'loss_val': 0.3168385675986252, 'psi': 0.9526311903945077}-{'f1_val': 0.9544190212670296, 'auprc': 0.9504747113444427, 'loss_val': 0.31356450747917164, 'psi': 0.9528412972979948}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=2.161355 (no previous merge yet)
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9999830278360499, 'loss_val': 0.017310429369311313, 'psi': 0.9980143922214946}-{'f1_val': 0.9967019684784577, 'auprc': 0.9999827502439509, 'loss_val': 0.016461849290599437, 'psi': 0.998014281184655}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=1.965953 cos_to_last_merge=0.8563 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=89 local utility u=0.602686 metrics={'f1_val': 0.7288740152061912, 'auprc': 0.8759866053241336, 'loss_val': 0.6232371599504714, 'psi': 0.7877190512533683}-{'f1_val': 0.6391457560103165, 'auprc': 0.8072140827678422, 'loss_val': 1.0839225156022292, 'psi': 0.7063730867133269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=89 head_norm_before_train=1.676321 cos_to_last_merge=0.8514 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.851
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.5654778405081073, 'auprc': 0.7845281761298252, 'loss_val': 0.9765513868150457, 'psi': 0.6530979747567944}-{'f1_val': 0.6684590696262156, 'auprc': 0.8267383667957421, 'loss_val': 0.3811033000499282, 'psi': 0.7317707884940262}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=2.080296 cos_to_last_merge=0.9469 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=89 local utility u=0.003810 metrics={'f1_val': 0.990736079195671, 'auprc': 0.9992401972694016, 'loss_val': 0.033391378631294315, 'psi': 0.9941377264251632}-{'f1_val': 0.9900154226160678, 'auprc': 0.9992651674425775, 'loss_val': 0.03676316622277865, 'psi': 0.9937153205466717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=89 head_norm_before_train=1.954097 cos_to_last_merge=0.9128 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.913
[S9] round=89 local utility u=0.048644 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.993671214310299, 'loss_val': 0.019701372616658844, 'psi': 0.9952185425916862}-{'f1_val': 0.9841766825812317, 'auprc': 0.9986993723256242, 'loss_val': 0.059632429291026044, 'psi': 0.9899857584789887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=89 head_norm_before_train=2.075830 cos_to_last_merge=0.8999 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.900
[S10] round=89 local utility u=0.000040 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9973148834093362, 'loss_val': 0.022793912611630905, 'psi': 0.9959068652827802}-{'f1_val': 0.9949681865317428, 'auprc': 0.9974293806769565, 'loss_val': 0.023216907964608693, 'psi': 0.9959526641898283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=89 head_norm_before_train=2.329383 (no previous merge yet)
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9938632294089428, 'auprc': 0.9995527056709632, 'loss_val': 0.025647093109871663, 'psi': 0.996139019913751}-{'f1_val': 0.9969878514242156, 'auprc': 0.999542810635337, 'loss_val': 0.016254856553969854, 'psi': 0.9980098351086643}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=1.945828 (no previous merge yet)
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.5978475025421599, 'auprc': 0.6169200581031455, 'loss_val': 1.4556951673463665, 'psi': 0.6054765247665541}-{'f1_val': 0.6312862175114695, 'auprc': 0.6549241397108789, 'loss_val': 1.240358187473366, 'psi': 0.6407413863912332}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=2.132765 cos_to_last_merge=0.9681 (last merge round=17)
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9503820739589453, 'auprc': 0.9988566901267719, 'loss_val': 0.0772910731287205, 'psi': 0.969771920426076}-{'f1_val': 0.9978217593544257, 'auprc': 0.9992333718656496, 'loss_val': 0.01817515188012673, 'psi': 0.9983864043589152}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=1.978898 cos_to_last_merge=0.9069 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.907
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.7739264604534277, 'auprc': 0.9937776466353805, 'loss_val': 0.553566777884352, 'psi': 0.8618669349262088}-{'f1_val': 0.779457196475893, 'auprc': 0.9949845641998503, 'loss_val': 0.5105583658864971, 'psi': 0.8656681435654758}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=1.973232 cos_to_last_merge=0.9125 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9732935450003808, 'auprc': 0.983770198853403, 'loss_val': 0.10324557481084844, 'psi': 0.9774842065415897}-{'f1_val': 0.9780104020674074, 'auprc': 0.9898419291706279, 'loss_val': 0.08946779820470586, 'psi': 0.9827430129086956}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=1.914986 cos_to_last_merge=0.8695 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.6383212073094419, 'auprc': 0.9349534344966374, 'loss_val': 1.4336681880952806, 'psi': 0.75697409818432}-{'f1_val': 0.8188165995784621, 'auprc': 0.9444505979611353, 'loss_val': 0.8074007195444587, 'psi': 0.8690701989315314}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=90 head_norm_before_train=1.974268 cos_to_last_merge=0.7187 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.719
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.7142047636210938, 'auprc': 0.8006001942025075, 'loss_val': 0.8850342032058433, 'psi': 0.7487629358536593}-{'f1_val': 0.7141927590363468, 'auprc': 0.8189145425464298, 'loss_val': 0.9107478945417115, 'psi': 0.75608147244038}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.227114 cos_to_last_merge=0.9135 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.9596861317232088, 'auprc': 0.9968355341240271, 'loss_val': 0.17415638158943253, 'psi': 0.9745458926835362}-{'f1_val': 0.9834363840689774, 'auprc': 0.9987487420308123, 'loss_val': 0.04967963979652274, 'psi': 0.9895613272537114}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=1.728177 cos_to_last_merge=0.8617 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.862
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.9413740650793365, 'auprc': 0.9492503363514677, 'loss_val': 0.3240343947290276, 'psi': 0.9445245735881891}-{'f1_val': 0.95535443182233, 'auprc': 0.9485463282527742, 'loss_val': 0.3168385675986252, 'psi': 0.9526311903945077}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=2.164598 (no previous merge yet)
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9932898254045002, 'loss_val': 0.028266120118122882, 'psi': 0.9951162173399342}-{'f1_val': 0.9967019684784577, 'auprc': 0.9999830278360499, 'loss_val': 0.017310429369311313, 'psi': 0.9980143922214946}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=1.971123 cos_to_last_merge=0.8559 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=90 local utility u=0.077817 metrics={'f1_val': 0.766578253193065, 'auprc': 0.8339182363683093, 'loss_val': 0.5676239375597981, 'psi': 0.7935142464631628}-{'f1_val': 0.7288740152061912, 'auprc': 0.8759866053241336, 'loss_val': 0.6232371599504714, 'psi': 0.7877190512533683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=90 head_norm_before_train=1.678791 cos_to_last_merge=0.8509 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.851
[S7] round=90 local utility u=0.603663 metrics={'f1_val': 0.661142875428946, 'auprc': 0.8119961173509245, 'loss_val': 0.42561897317173714, 'psi': 0.7214841721977374}-{'f1_val': 0.5654778405081073, 'auprc': 0.7845281761298252, 'loss_val': 0.9765513868150457, 'psi': 0.6530979747567944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=90 head_norm_before_train=2.084939 cos_to_last_merge=0.9466 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.9831265325881958, 'auprc': 0.996421857256594, 'loss_val': 0.0607198147497855, 'psi': 0.9884446624555552}-{'f1_val': 0.990736079195671, 'auprc': 0.9992401972694016, 'loss_val': 0.033391378631294315, 'psi': 0.9941377264251632}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=90 head_norm_before_train=1.956682 cos_to_last_merge=0.9124 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.912
[S9] round=90 local utility u=0.001971 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9938610680318001, 'loss_val': 0.01879069166081192, 'psi': 0.9955407343010549}-{'f1_val': 0.9962500947792776, 'auprc': 0.993671214310299, 'loss_val': 0.019701372616658844, 'psi': 0.9952185425916862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=90 head_norm_before_train=2.077545 cos_to_last_merge=0.8992 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.899
[S10] round=90 local utility u=0.000195 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974568184144272, 'loss_val': 0.022829848701788873, 'psi': 0.9959636392848166}-{'f1_val': 0.9949681865317428, 'auprc': 0.9973148834093362, 'loss_val': 0.022793912611630905, 'psi': 0.9959068652827802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=90 head_norm_before_train=2.333230 (no previous merge yet)
[S11] round=90 local utility u=0.013288 metrics={'f1_val': 0.9967467623295848, 'auprc': 0.9995396139102505, 'loss_val': 0.016332919940825735, 'psi': 0.9978639029618511}-{'f1_val': 0.9938632294089428, 'auprc': 0.9995527056709632, 'loss_val': 0.025647093109871663, 'psi': 0.996139019913751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=90 head_norm_before_train=1.950773 (no previous merge yet)
[S13] round=90 local utility u=0.660947 metrics={'f1_val': 0.7134849751556185, 'auprc': 0.6935178872226749, 'loss_val': 1.057419234510688, 'psi': 0.705498139982441}-{'f1_val': 0.5978475025421599, 'auprc': 0.6169200581031455, 'loss_val': 1.4556951673463665, 'psi': 0.6054765247665541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=90 head_norm_before_train=2.134733 cos_to_last_merge=0.9681 (last merge round=17)
[S14] round=90 local utility u=0.173944 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.999232704207796, 'loss_val': 0.016494949846089013, 'psi': 0.9985187247971732}-{'f1_val': 0.9503820739589453, 'auprc': 0.9988566901267719, 'loss_val': 0.0772910731287205, 'psi': 0.969771920426076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=90 head_norm_before_train=1.984239 cos_to_last_merge=0.9065 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.907
[S15] round=90 local utility u=0.023352 metrics={'f1_val': 0.7776260584662535, 'auprc': 0.9945089535789455, 'loss_val': 0.5312547759667439, 'psi': 0.8643792165113303}-{'f1_val': 0.7739264604534277, 'auprc': 0.9937776466353805, 'loss_val': 0.553566777884352, 'psi': 0.8618669349262088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=90 head_norm_before_train=1.976680 cos_to_last_merge=0.9122 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9447543524965942, 'auprc': 0.9728476605847602, 'loss_val': 0.2928760942906454, 'psi': 0.9559916757318606}-{'f1_val': 0.9732935450003808, 'auprc': 0.983770198853403, 'loss_val': 0.10324557481084844, 'psi': 0.9774842065415897}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=1.921085 cos_to_last_merge=0.8692 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=90 local utility u=0.157712 metrics={'f1_val': 0.6516347347762645, 'auprc': 0.9528272393843757, 'loss_val': 1.251746627313295, 'psi': 0.772111736619509}-{'f1_val': 0.6383212073094419, 'auprc': 0.9349534344966374, 'loss_val': 1.4336681880952806, 'psi': 0.75697409818432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=91 head_norm_before_train=1.977991 cos_to_last_merge=0.7184 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.718
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.7202457417692013, 'auprc': 0.7320069109977643, 'loss_val': 1.0824499520547044, 'psi': 0.7249502094606265}-{'f1_val': 0.7142047636210938, 'auprc': 0.8006001942025075, 'loss_val': 0.8850342032058433, 'psi': 0.7487629358536593}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=91 head_norm_before_train=2.229820 cos_to_last_merge=0.9130 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.8760833117008882, 'auprc': 0.9830011527721658, 'loss_val': 0.3080030248326634, 'psi': 0.9188504481293993}-{'f1_val': 0.9596861317232088, 'auprc': 0.9968355341240271, 'loss_val': 0.17415638158943253, 'psi': 0.9745458926835362}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=1.734919 cos_to_last_merge=0.8612 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.861
[S4] round=91 local utility u=0.006002 metrics={'f1_val': 0.9409731350196345, 'auprc': 0.9563571684895481, 'loss_val': 0.33094597403126536, 'psi': 0.9471267484076}-{'f1_val': 0.9413740650793365, 'auprc': 0.9492503363514677, 'loss_val': 0.3240343947290276, 'psi': 0.9445245735881891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=91 head_norm_before_train=2.164443 (no previous merge yet)
[S5] round=91 local utility u=0.015337 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994075082245772, 'loss_val': 0.018153907906261934, 'psi': 0.9977841843769055}-{'f1_val': 0.9963338119635569, 'auprc': 0.9932898254045002, 'loss_val': 0.028266120118122882, 'psi': 0.9951162173399342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=91 head_norm_before_train=1.980204 cos_to_last_merge=0.8559 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=91 local utility u=0.194131 metrics={'f1_val': 0.801847931441803, 'auprc': 0.9135562187693274, 'loss_val': 0.6298937550186744, 'psi': 0.8465312463728127}-{'f1_val': 0.766578253193065, 'auprc': 0.8339182363683093, 'loss_val': 0.5676239375597981, 'psi': 0.7935142464631628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=91 head_norm_before_train=1.681412 cos_to_last_merge=0.8507 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.851
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.6090621408702225, 'auprc': 0.7948676242451705, 'loss_val': 0.7594466596210464, 'psi': 0.6833843342202017}-{'f1_val': 0.661142875428946, 'auprc': 0.8119961173509245, 'loss_val': 0.42561897317173714, 'psi': 0.7214841721977374}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=2.090143 cos_to_last_merge=0.9462 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.8964383277416168, 'auprc': 0.9993590746150972, 'loss_val': 0.17756575188078616, 'psi': 0.937606626491009}-{'f1_val': 0.9831265325881958, 'auprc': 0.996421857256594, 'loss_val': 0.0607198147497855, 'psi': 0.9884446624555552}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=1.957903 cos_to_last_merge=0.9116 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.912
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9375085258472335, 'auprc': 0.9982342032701328, 'loss_val': 0.10759843526428717, 'psi': 0.9617987968163932}-{'f1_val': 0.9966605118138915, 'auprc': 0.9938610680318001, 'loss_val': 0.01879069166081192, 'psi': 0.9955407343010549}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.078214 cos_to_last_merge=0.8984 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.898
[S10] round=91 local utility u=0.000118 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974622873399245, 'loss_val': 0.022610273890551143, 'psi': 0.9959658268550156}-{'f1_val': 0.9949681865317428, 'auprc': 0.9974568184144272, 'loss_val': 0.022829848701788873, 'psi': 0.9959636392848166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=91 head_norm_before_train=2.337215 (no previous merge yet)
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9995076386676202, 'loss_val': 0.016159216481768993, 'psi': 0.9977336084641064}-{'f1_val': 0.9967467623295848, 'auprc': 0.9995396139102505, 'loss_val': 0.016332919940825735, 'psi': 0.9978639029618511}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=1.954073 (no previous merge yet)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6530075131758105, 'auprc': 0.6743209130258813, 'loss_val': 1.110232733629248, 'psi': 0.6615328731158389}-{'f1_val': 0.7134849751556185, 'auprc': 0.6935178872226749, 'loss_val': 1.057419234510688, 'psi': 0.705498139982441}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=2.138649 cos_to_last_merge=0.9681 (last merge round=17)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9992310628564182, 'loss_val': 0.017527601019598438, 'psi': 0.998271609116493}-{'f1_val': 0.9980427385234248, 'auprc': 0.999232704207796, 'loss_val': 0.016494949846089013, 'psi': 0.9985187247971732}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=1.989504 cos_to_last_merge=0.9062 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.906
[S15] round=91 local utility u=0.919039 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9983426860809708, 'loss_val': 0.0191439721510391, 'psi': 0.9973592516062416}-{'f1_val': 0.7776260584662535, 'auprc': 0.9945089535789455, 'loss_val': 0.5312547759667439, 'psi': 0.8643792165113303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=91 head_norm_before_train=1.980436 cos_to_last_merge=0.9119 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=91 local utility u=0.043900 metrics={'f1_val': 0.945399809041878, 'auprc': 0.9740853540557335, 'loss_val': 0.21266198950649695, 'psi': 0.9568740270474203}-{'f1_val': 0.9447543524965942, 'auprc': 0.9728476605847602, 'loss_val': 0.2928760942906454, 'psi': 0.9559916757318606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=91 head_norm_before_train=1.926794 cos_to_last_merge=0.8690 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=91 local utility u=0.586123 metrics={'f1_val': 0.7787798806627106, 'auprc': 0.9528686669277411, 'loss_val': 0.8424967593760786, 'psi': 0.8484153951687228}-{'f1_val': 0.6516347347762645, 'auprc': 0.9528272393843757, 'loss_val': 1.251746627313295, 'psi': 0.772111736619509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=92 head_norm_before_train=1.983898 cos_to_last_merge=0.7180 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.718
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.7203120073439935, 'auprc': 0.731635018467037, 'loss_val': 1.1010631691379695, 'psi': 0.7248412117932109}-{'f1_val': 0.7202457417692013, 'auprc': 0.7320069109977643, 'loss_val': 1.0824499520547044, 'psi': 0.7249502094606265}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.233656 cos_to_last_merge=0.9126 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=92 local utility u=0.215729 metrics={'f1_val': 0.9159013532670844, 'auprc': 0.997537952216639, 'loss_val': 0.15906291711699774, 'psi': 0.9485559928469063}-{'f1_val': 0.8760833117008882, 'auprc': 0.9830011527721658, 'loss_val': 0.3080030248326634, 'psi': 0.9188504481293993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=92 head_norm_before_train=1.743502 cos_to_last_merge=0.8606 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.861
[S4] round=92 local utility u=0.017538 metrics={'f1_val': 0.9448550354969799, 'auprc': 0.9573553321191979, 'loss_val': 0.3221552865165571, 'psi': 0.9498551541458671}-{'f1_val': 0.9409731350196345, 'auprc': 0.9563571684895481, 'loss_val': 0.33094597403126536, 'psi': 0.9471267484076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=92 head_norm_before_train=2.167448 (no previous merge yet)
[S5] round=92 local utility u=0.001766 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9998856552938936, 'loss_val': 0.018262648441118575, 'psi': 0.9981959972841961}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994075082245772, 'loss_val': 0.018153907906261934, 'psi': 0.9977841843769055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=92 head_norm_before_train=1.990034 cos_to_last_merge=0.8561 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.6489872808004299, 'auprc': 0.897713498525166, 'loss_val': 1.0178115587244814, 'psi': 0.7484777678903244}-{'f1_val': 0.801847931441803, 'auprc': 0.9135562187693274, 'loss_val': 0.6298937550186744, 'psi': 0.8465312463728127}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.685851 cos_to_last_merge=0.8500 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=92 local utility u=0.083037 metrics={'f1_val': 0.6212243639067159, 'auprc': 0.7960652537837415, 'loss_val': 0.669939646038119, 'psi': 0.691160719857526}-{'f1_val': 0.6090621408702225, 'auprc': 0.7948676242451705, 'loss_val': 0.7594466596210464, 'psi': 0.6833843342202017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=92 head_norm_before_train=2.095041 cos_to_last_merge=0.9458 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=92 local utility u=0.363409 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9992686560562141, 'loss_val': 0.02707406690640741, 'psi': 0.9952302971717868}-{'f1_val': 0.8964383277416168, 'auprc': 0.9993590746150972, 'loss_val': 0.17756575188078616, 'psi': 0.937606626491009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=92 head_norm_before_train=1.959101 cos_to_last_merge=0.9112 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.911
[S9] round=92 local utility u=0.224386 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996213702194501, 'loss_val': 0.017900451607841258, 'psi': 0.9978448551761149}-{'f1_val': 0.9375085258472335, 'auprc': 0.9982342032701328, 'loss_val': 0.10759843526428717, 'psi': 0.9617987968163932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=92 head_norm_before_train=2.080379 cos_to_last_merge=0.8977 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.898
[S10] round=92 local utility u=0.000191 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974716639549729, 'loss_val': 0.0222555748947419, 'psi': 0.9959695775010349}-{'f1_val': 0.9949681865317428, 'auprc': 0.9974622873399245, 'loss_val': 0.022610273890551143, 'psi': 0.9959658268550156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=92 head_norm_before_train=2.338445 (no previous merge yet)
[S11] round=92 local utility u=0.000466 metrics={'f1_val': 0.9967467623295848, 'auprc': 0.9995363427474351, 'loss_val': 0.0164878575894917, 'psi': 0.997862594496725}-{'f1_val': 0.9965509216617638, 'auprc': 0.9995076386676202, 'loss_val': 0.016159216481768993, 'psi': 0.9977336084641064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=92 head_norm_before_train=1.955069 (no previous merge yet)
[S13] round=92 local utility u=0.150217 metrics={'f1_val': 0.6978801408711599, 'auprc': 0.6988150466667018, 'loss_val': 1.1525176930031897, 'psi': 0.6982541031893768}-{'f1_val': 0.6530075131758105, 'auprc': 0.6743209130258813, 'loss_val': 1.110232733629248, 'psi': 0.6615328731158389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=92 head_norm_before_train=2.144248 cos_to_last_merge=0.9679 (last merge round=17)
[S14] round=92 local utility u=0.002992 metrics={'f1_val': 0.9984539900362299, 'auprc': 0.9992230008969903, 'loss_val': 0.016452080266939485, 'psi': 0.9987615943805341}-{'f1_val': 0.9976319732898762, 'auprc': 0.9992310628564182, 'loss_val': 0.017527601019598438, 'psi': 0.998271609116493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=92 head_norm_before_train=1.994745 cos_to_last_merge=0.9058 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.906
[S15] round=92 local utility u=0.000478 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9985178869634757, 'loss_val': 0.018712850532686853, 'psi': 0.9974293319592435}-{'f1_val': 0.9967036286230888, 'auprc': 0.9983426860809708, 'loss_val': 0.0191439721510391, 'psi': 0.9973592516062416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=92 head_norm_before_train=1.982787 cos_to_last_merge=0.9117 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=92 local utility u=0.120453 metrics={'f1_val': 0.9671435008830626, 'auprc': 0.9789965282429818, 'loss_val': 0.11695238828818831, 'psi': 0.9718847118270303}-{'f1_val': 0.945399809041878, 'auprc': 0.9740853540557335, 'loss_val': 0.21266198950649695, 'psi': 0.9568740270474203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=92 head_norm_before_train=1.931244 cos_to_last_merge=0.8688 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=92 local utility u=0.300822 metrics={'f1_val': 0.847530886418565, 'auprc': 0.9585934405833936, 'loss_val': 0.6705321264305854, 'psi': 0.8919559080844963}-{'f1_val': 0.7787798806627106, 'auprc': 0.9528686669277411, 'loss_val': 0.8424967593760786, 'psi': 0.8484153951687228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=93 head_norm_before_train=1.990799 cos_to_last_merge=0.7175 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.718
[S2] round=93 local utility u=0.010712 metrics={'f1_val': 0.7197309230626995, 'auprc': 0.7357658884492665, 'loss_val': 1.0885448230547468, 'psi': 0.7261449092173262}-{'f1_val': 0.7203120073439935, 'auprc': 0.731635018467037, 'loss_val': 1.1010631691379695, 'psi': 0.7248412117932109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=93 head_norm_before_train=2.239119 cos_to_last_merge=0.9123 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.7113830337820477, 'auprc': 0.9814888446319692, 'loss_val': 0.6561277281416067, 'psi': 0.8194253581220163}-{'f1_val': 0.9159013532670844, 'auprc': 0.997537952216639, 'loss_val': 0.15906291711699774, 'psi': 0.9485559928469063}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=1.750232 cos_to_last_merge=0.8599 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.860
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.9405149192034439, 'auprc': 0.9499362621845121, 'loss_val': 0.34560172927504784, 'psi': 0.9442834563958711}-{'f1_val': 0.9448550354969799, 'auprc': 0.9573553321191979, 'loss_val': 0.3221552865165571, 'psi': 0.9498551541458671}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=93 head_norm_before_train=2.169240 (no previous merge yet)
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9995806965871572, 'loss_val': 0.01746180884114229, 'psi': 0.9980740138015015}-{'f1_val': 0.9970695586110643, 'auprc': 0.9998856552938936, 'loss_val': 0.018262648441118575, 'psi': 0.9981959972841961}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=1.998340 cos_to_last_merge=0.8556 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=93 local utility u=0.696387 metrics={'f1_val': 0.7950597758189887, 'auprc': 0.9447385991099444, 'loss_val': 0.6425470463107837, 'psi': 0.854931305135371}-{'f1_val': 0.6489872808004299, 'auprc': 0.897713498525166, 'loss_val': 1.0178115587244814, 'psi': 0.7484777678903244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=93 head_norm_before_train=1.689375 cos_to_last_merge=0.8495 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=93 local utility u=0.046525 metrics={'f1_val': 0.6211117911262443, 'auprc': 0.797538047593523, 'loss_val': 0.5806333099728775, 'psi': 0.6916822937131557}-{'f1_val': 0.6212243639067159, 'auprc': 0.7960652537837415, 'loss_val': 0.669939646038119, 'psi': 0.691160719857526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=93 head_norm_before_train=2.100166 cos_to_last_merge=0.9455 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=93 local utility u=0.006250 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9995140890325496, 'loss_val': 0.02407583766454231, 'psi': 0.9962049280331114}-{'f1_val': 0.9925380579155019, 'auprc': 0.9992686560562141, 'loss_val': 0.02707406690640741, 'psi': 0.9952302971717868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=93 head_norm_before_train=1.957636 cos_to_last_merge=0.9103 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.910
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9937436184111791, 'loss_val': 0.020109846264101616, 'psi': 0.9952475042320382}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996213702194501, 'loss_val': 0.017900451607841258, 'psi': 0.9978448551761149}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.084457 cos_to_last_merge=0.8971 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.897
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974824782410265, 'loss_val': 0.022464915979643358, 'psi': 0.9959739032154563}-{'f1_val': 0.9949681865317428, 'auprc': 0.9974716639549729, 'loss_val': 0.0222555748947419, 'psi': 0.9959695775010349}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.339057 (no previous merge yet)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9962649549813628, 'auprc': 0.9995411971415822, 'loss_val': 0.01770357898100989, 'psi': 0.9975754518454505}-{'f1_val': 0.9967467623295848, 'auprc': 0.9995363427474351, 'loss_val': 0.0164878575894917, 'psi': 0.997862594496725}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.956489 (no previous merge yet)
[S13] round=93 local utility u=0.123517 metrics={'f1_val': 0.6889459447757965, 'auprc': 0.7316421250765307, 'loss_val': 0.9503604554748025, 'psi': 0.7060244168960902}-{'f1_val': 0.6978801408711599, 'auprc': 0.6988150466667018, 'loss_val': 1.1525176930031897, 'psi': 0.6982541031893768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=93 head_norm_before_train=2.148137 cos_to_last_merge=0.9678 (last merge round=17)
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.956588167349868, 'auprc': 0.9988566901267719, 'loss_val': 0.06055027862001263, 'psi': 0.9734955764606296}-{'f1_val': 0.9984539900362299, 'auprc': 0.9992230008969903, 'loss_val': 0.016452080266939485, 'psi': 0.9987615943805341}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=1.999831 cos_to_last_merge=0.9054 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.905
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.9196130147474966, 'auprc': 0.9971179713764057, 'loss_val': 0.16000728907282186, 'psi': 0.9506149973990603}-{'f1_val': 0.9967036286230888, 'auprc': 0.9985178869634757, 'loss_val': 0.018712850532686853, 'psi': 0.9974293319592435}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=1.985775 cos_to_last_merge=0.9112 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.911
[S16] round=93 local utility u=0.105933 metrics={'f1_val': 0.9886302922064609, 'auprc': 0.9872428085505949, 'loss_val': 0.0587450815222784, 'psi': 0.9880752987441145}-{'f1_val': 0.9671435008830626, 'auprc': 0.9789965282429818, 'loss_val': 0.11695238828818831, 'psi': 0.9718847118270303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=93 head_norm_before_train=1.934459 cos_to_last_merge=0.8687 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.6227616766916438, 'auprc': 0.9117709987430203, 'loss_val': 1.5072890880220706, 'psi': 0.7383654055121944}-{'f1_val': 0.847530886418565, 'auprc': 0.9585934405833936, 'loss_val': 0.6705321264305854, 'psi': 0.8919559080844963}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=94 head_norm_before_train=1.997227 cos_to_last_merge=0.7170 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.717
[S2] round=94 local utility u=0.194259 metrics={'f1_val': 0.7202611160597661, 'auprc': 0.7917916406367672, 'loss_val': 0.8712855808316269, 'psi': 0.7488733258905665}-{'f1_val': 0.7197309230626995, 'auprc': 0.7357658884492665, 'loss_val': 1.0885448230547468, 'psi': 0.7261449092173262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=94 head_norm_before_train=2.244071 cos_to_last_merge=0.9121 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=94 local utility u=0.777903 metrics={'f1_val': 0.8921022053340371, 'auprc': 0.9972440792947933, 'loss_val': 0.2319021651877017, 'psi': 0.9341589549183396}-{'f1_val': 0.7113830337820477, 'auprc': 0.9814888446319692, 'loss_val': 0.6561277281416067, 'psi': 0.8194253581220163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=94 head_norm_before_train=1.754974 cos_to_last_merge=0.8594 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.859
[S4] round=94 local utility u=0.053134 metrics={'f1_val': 0.9482318682403892, 'auprc': 0.9628250035626976, 'loss_val': 0.3243009673406247, 'psi': 0.9540691223693125}-{'f1_val': 0.9405149192034439, 'auprc': 0.9499362621845121, 'loss_val': 0.34560172927504784, 'psi': 0.9442834563958711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=94 head_norm_before_train=2.169446 (no previous merge yet)
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.996463837470957, 'loss_val': 0.017714496432962166, 'psi': 0.9966067160754575}-{'f1_val': 0.9970695586110643, 'auprc': 0.9995806965871572, 'loss_val': 0.01746180884114229, 'psi': 0.9980740138015015}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=2.004058 cos_to_last_merge=0.8544 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=94 local utility u=0.827579 metrics={'f1_val': 0.9742081474418924, 'auprc': 0.9761897229290404, 'loss_val': 0.15663316211246955, 'psi': 0.9750007776367515}-{'f1_val': 0.7950597758189887, 'auprc': 0.9447385991099444, 'loss_val': 0.6425470463107837, 'psi': 0.854931305135371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=94 head_norm_before_train=1.693422 cos_to_last_merge=0.8488 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.849
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.6037598878263093, 'auprc': 0.7945791466118045, 'loss_val': 0.7790491130471376, 'psi': 0.6800875913405073}-{'f1_val': 0.6211117911262443, 'auprc': 0.797538047593523, 'loss_val': 0.5806333099728775, 'psi': 0.6916822937131557}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.104755 cos_to_last_merge=0.9452 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.8691488981422235, 'auprc': 0.9992721860043611, 'loss_val': 0.24466306575086566, 'psi': 0.9211982132870786}-{'f1_val': 0.9939988207001527, 'auprc': 0.9995140890325496, 'loss_val': 0.02407583766454231, 'psi': 0.9962049280331114}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=94 head_norm_before_train=1.958924 cos_to_last_merge=0.9100 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.910
[S9] round=94 local utility u=0.005509 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964049763211762, 'loss_val': 0.019538756762018578, 'psi': 0.9965582976168054}-{'f1_val': 0.9962500947792776, 'auprc': 0.9937436184111791, 'loss_val': 0.020109846264101616, 'psi': 0.9952475042320382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=94 head_norm_before_train=2.089375 cos_to_last_merge=0.8967 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.897
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.99746348498766, 'loss_val': 0.022668336032746424, 'psi': 0.9959663059141097}-{'f1_val': 0.9949681865317428, 'auprc': 0.9974824782410265, 'loss_val': 0.022464915979643358, 'psi': 0.9959739032154563}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.341460 (no previous merge yet)
[S11] round=94 local utility u=0.002936 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9995372972148714, 'loss_val': 0.016156360256924875, 'psi': 0.998007629740478}-{'f1_val': 0.9962649549813628, 'auprc': 0.9995411971415822, 'loss_val': 0.01770357898100989, 'psi': 0.9975754518454505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=94 head_norm_before_train=1.961298 (no previous merge yet)
[S13] round=94 local utility u=0.154771 metrics={'f1_val': 0.7197479286009862, 'auprc': 0.7575062328539867, 'loss_val': 0.9032235347008105, 'psi': 0.7348512503021865}-{'f1_val': 0.6889459447757965, 'auprc': 0.7316421250765307, 'loss_val': 0.9503604554748025, 'psi': 0.7060244168960902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=94 head_norm_before_train=2.149892 cos_to_last_merge=0.9677 (last merge round=17)
[S14] round=94 local utility u=0.147024 metrics={'f1_val': 0.9984539900362299, 'auprc': 0.9988566901267719, 'loss_val': 0.01769808185609375, 'psi': 0.9986150700724468}-{'f1_val': 0.956588167349868, 'auprc': 0.9988566901267719, 'loss_val': 0.06055027862001263, 'psi': 0.9734955764606296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=94 head_norm_before_train=2.004781 cos_to_last_merge=0.9050 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.905
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.8208205494741663, 'auprc': 0.9955630911617109, 'loss_val': 0.4070190621558173, 'psi': 0.8907175661491842}-{'f1_val': 0.9196130147474966, 'auprc': 0.9971179713764057, 'loss_val': 0.16000728907282186, 'psi': 0.9506149973990603}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=1.990110 cos_to_last_merge=0.9107 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.911
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.942279550922696, 'auprc': 0.9842505573708722, 'loss_val': 0.32971400569887377, 'psi': 0.9590679535019664}-{'f1_val': 0.9886302922064609, 'auprc': 0.9872428085505949, 'loss_val': 0.0587450815222784, 'psi': 0.9880752987441145}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=1.937540 cos_to_last_merge=0.8683 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=94 local utility u=0.120914 metrics={'f1_val': 0.6317716394410514, 'auprc': 0.9124090170921388, 'loss_val': 1.3214348483804028, 'psi': 0.7440265905014865}-{'f1_val': 0.6227616766916438, 'auprc': 0.9117709987430203, 'loss_val': 1.5072890880220706, 'psi': 0.7383654055121944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=95 head_norm_before_train=2.000754 cos_to_last_merge=0.7167 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.717
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.7201070185435628, 'auprc': 0.7299682123231768, 'loss_val': 1.1346147011138064, 'psi': 0.7240514960554084}-{'f1_val': 0.7202611160597661, 'auprc': 0.7917916406367672, 'loss_val': 0.8712855808316269, 'psi': 0.7488733258905665}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.250321 cos_to_last_merge=0.9119 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=95 local utility u=0.248163 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9991369176193834, 'loss_val': 0.15509252218669797, 'psi': 0.9762998182874256}-{'f1_val': 0.8921022053340371, 'auprc': 0.9972440792947933, 'loss_val': 0.2319021651877017, 'psi': 0.9341589549183396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=95 head_norm_before_train=1.757258 cos_to_last_merge=0.8591 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.859
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.6293942456283369, 'auprc': 0.9416859806296103, 'loss_val': 0.7402883792463527, 'psi': 0.7543109396288463}-{'f1_val': 0.9482318682403892, 'auprc': 0.9628250035626976, 'loss_val': 0.3243009673406247, 'psi': 0.9540691223693125}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=2.173780 (no previous merge yet)
[S5] round=95 local utility u=0.006567 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9999355961351556, 'loss_val': 0.017201102846523, 'psi': 0.9982159736207008}-{'f1_val': 0.9967019684784577, 'auprc': 0.996463837470957, 'loss_val': 0.017714496432962166, 'psi': 0.9966067160754575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=95 head_norm_before_train=2.009758 cos_to_last_merge=0.8535 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.7679430549721551, 'auprc': 0.8897224896022947, 'loss_val': 0.6151597741340703, 'psi': 0.816654828824211}-{'f1_val': 0.9742081474418924, 'auprc': 0.9761897229290404, 'loss_val': 0.15663316211246955, 'psi': 0.9750007776367515}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.700156 cos_to_last_merge=0.8477 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.848
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.6047978832334439, 'auprc': 0.794695446762421, 'loss_val': 0.7951082908877855, 'psi': 0.6807569086450347}-{'f1_val': 0.6037598878263093, 'auprc': 0.7945791466118045, 'loss_val': 0.7790491130471376, 'psi': 0.6800875913405073}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=2.108232 cos_to_last_merge=0.9450 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=95 local utility u=0.374084 metrics={'f1_val': 0.970052069218174, 'auprc': 0.995845563052949, 'loss_val': 0.09163358427361924, 'psi': 0.9803694667520839}-{'f1_val': 0.8691488981422235, 'auprc': 0.9992721860043611, 'loss_val': 0.24466306575086566, 'psi': 0.9211982132870786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=95 head_norm_before_train=1.963087 cos_to_last_merge=0.9099 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.910
[S9] round=95 local utility u=0.005810 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9989802625177028, 'loss_val': 0.0181091432164878, 'psi': 0.9978349529287012}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964049763211762, 'loss_val': 0.019538756762018578, 'psi': 0.9965582976168054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=95 head_norm_before_train=2.094738 cos_to_last_merge=0.8963 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=95 local utility u=0.000140 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974709429499113, 'loss_val': 0.02241066701279236, 'psi': 0.9959692890990102}-{'f1_val': 0.9949681865317428, 'auprc': 0.99746348498766, 'loss_val': 0.022668336032746424, 'psi': 0.9959663059141097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=95 head_norm_before_train=2.344935 (no previous merge yet)
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9948224703548484, 'auprc': 0.9995406986926763, 'loss_val': 0.023769806422933047, 'psi': 0.9967097616899796}-{'f1_val': 0.9969878514242156, 'auprc': 0.9995372972148714, 'loss_val': 0.016156360256924875, 'psi': 0.998007629740478}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.968286 (no previous merge yet)
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6776839933652834, 'auprc': 0.6715393328576967, 'loss_val': 1.2116095377473233, 'psi': 0.6752261291622488}-{'f1_val': 0.7197479286009862, 'auprc': 0.7575062328539867, 'loss_val': 0.9032235347008105, 'psi': 0.7348512503021865}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.148929 cos_to_last_merge=0.9674 (last merge round=17)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9991083783236545, 'loss_val': 0.02011679073556294, 'psi': 0.9979763665387719}-{'f1_val': 0.9984539900362299, 'auprc': 0.9988566901267719, 'loss_val': 0.01769808185609375, 'psi': 0.9986150700724468}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.009764 cos_to_last_merge=0.9046 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.905
[S15] round=95 local utility u=0.047120 metrics={'f1_val': 0.8321912692549989, 'auprc': 0.9961556714430387, 'loss_val': 0.38278084873261997, 'psi': 0.8977770301302148}-{'f1_val': 0.8208205494741663, 'auprc': 0.9955630911617109, 'loss_val': 0.4070190621558173, 'psi': 0.8907175661491842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=95 head_norm_before_train=1.994875 cos_to_last_merge=0.9103 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.8608071790466284, 'auprc': 0.8419484334148885, 'loss_val': 1.1030920729171676, 'psi': 0.8532636807939324}-{'f1_val': 0.942279550922696, 'auprc': 0.9842505573708722, 'loss_val': 0.32971400569887377, 'psi': 0.9590679535019664}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=1.938971 cos_to_last_merge=0.8685 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=95 local utility u=0.928429 metrics={'f1_val': 0.8370331227731491, 'auprc': 0.8663586310777271, 'loss_val': 0.5579938418298811, 'psi': 0.8487633260949803}-{'f1_val': 0.6317716394410514, 'auprc': 0.9124090170921388, 'loss_val': 1.3214348483804028, 'psi': 0.7440265905014865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=96 head_norm_before_train=2.004790 cos_to_last_merge=0.7164 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.716
[S2] round=96 local utility u=0.036788 metrics={'f1_val': 0.7206112378371156, 'auprc': 0.7253545351935076, 'loss_val': 1.0502222518048856, 'psi': 0.7225085567796723}-{'f1_val': 0.7201070185435628, 'auprc': 0.7299682123231768, 'loss_val': 1.1346147011138064, 'psi': 0.7240514960554084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=96 head_norm_before_train=2.256531 cos_to_last_merge=0.9117 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.960527581452528, 'auprc': 0.9976490160776906, 'loss_val': 0.16790099696526017, 'psi': 0.9753761553025931}-{'f1_val': 0.9610750853994537, 'auprc': 0.9991369176193834, 'loss_val': 0.15509252218669797, 'psi': 0.9762998182874256}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=1.757671 cos_to_last_merge=0.8589 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.859
[S4] round=96 local utility u=1.000000 metrics={'f1_val': 0.9406164265330743, 'auprc': 0.9542173970200082, 'loss_val': 0.34261215927656236, 'psi': 0.9460568147278479}-{'f1_val': 0.6293942456283369, 'auprc': 0.9416859806296103, 'loss_val': 0.7402883792463527, 'psi': 0.7543109396288463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=96 head_norm_before_train=2.178679 (no previous merge yet)
[S5] round=96 local utility u=0.000023 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9999288738932981, 'loss_val': 0.017133999798013236, 'psi': 0.9982132847239579}-{'f1_val': 0.9970695586110643, 'auprc': 0.9999355961351556, 'loss_val': 0.017201102846523, 'psi': 0.9982159736207008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=96 head_norm_before_train=2.016042 cos_to_last_merge=0.8531 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.853
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.5908533444252762, 'auprc': 0.8065462183142539, 'loss_val': 1.258282088829387, 'psi': 0.6771304939808673}-{'f1_val': 0.7679430549721551, 'auprc': 0.8897224896022947, 'loss_val': 0.6151597741340703, 'psi': 0.816654828824211}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=1.705213 cos_to_last_merge=0.8468 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.847
[S7] round=96 local utility u=0.767975 metrics={'f1_val': 0.7230538800436179, 'auprc': 0.8805904766174026, 'loss_val': 0.22637879623721968, 'psi': 0.7860685186731318}-{'f1_val': 0.6047978832334439, 'auprc': 0.794695446762421, 'loss_val': 0.7951082908877855, 'psi': 0.6807569086450347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=96 head_norm_before_train=2.112417 cos_to_last_merge=0.9448 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=96 local utility u=0.100009 metrics={'f1_val': 0.9918210737370572, 'auprc': 0.9991758756509619, 'loss_val': 0.032220355344344115, 'psi': 0.9947629945026191}-{'f1_val': 0.970052069218174, 'auprc': 0.995845563052949, 'loss_val': 0.09163358427361924, 'psi': 0.9803694667520839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=96 head_norm_before_train=1.968749 cos_to_last_merge=0.9099 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.910
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9989955642928742, 'loss_val': 0.018396784155493114, 'psi': 0.9975924328967964}-{'f1_val': 0.9970714132027002, 'auprc': 0.9989802625177028, 'loss_val': 0.0181091432164878, 'psi': 0.9978349529287012}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.100384 cos_to_last_merge=0.8959 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9971457413364931, 'loss_val': 0.022398185440349695, 'psi': 0.9958392084536429}-{'f1_val': 0.9949681865317428, 'auprc': 0.9974709429499113, 'loss_val': 0.02241066701279236, 'psi': 0.9959692890990102}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.348987 (no previous merge yet)
[S11] round=96 local utility u=0.004163 metrics={'f1_val': 0.9955431649470738, 'auprc': 0.9995392622857315, 'loss_val': 0.019763591669214882, 'psi': 0.9971416038825369}-{'f1_val': 0.9948224703548484, 'auprc': 0.9995406986926763, 'loss_val': 0.023769806422933047, 'psi': 0.9967097616899796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=96 head_norm_before_train=1.976741 (no previous merge yet)
[S13] round=96 local utility u=0.088895 metrics={'f1_val': 0.6913395319009801, 'auprc': 0.6778440078237953, 'loss_val': 1.134666627419397, 'psi': 0.6859413222701062}-{'f1_val': 0.6776839933652834, 'auprc': 0.6715393328576967, 'loss_val': 1.2116095377473233, 'psi': 0.6752261291622488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=96 head_norm_before_train=2.145935 cos_to_last_merge=0.9672 (last merge round=17)
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9983759630795657, 'loss_val': 0.022216898347848492, 'psi': 0.9976834004411363}-{'f1_val': 0.9972216920155168, 'auprc': 0.9991083783236545, 'loss_val': 0.02011679073556294, 'psi': 0.9979763665387719}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.014790 cos_to_last_merge=0.9043 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.904
[S15] round=96 local utility u=0.190918 metrics={'f1_val': 0.8811481377164017, 'auprc': 0.9967063707905364, 'loss_val': 0.296339037590132, 'psi': 0.9273714309460555}-{'f1_val': 0.8321912692549989, 'auprc': 0.9961556714430387, 'loss_val': 0.38278084873261997, 'psi': 0.8977770301302148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=96 head_norm_before_train=1.999734 cos_to_last_merge=0.9100 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=96 local utility u=0.174141 metrics={'f1_val': 0.8700028695820313, 'auprc': 0.8846007513761562, 'loss_val': 0.9379421006113555, 'psi': 0.8758420222996812}-{'f1_val': 0.8608071790466284, 'auprc': 0.8419484334148885, 'loss_val': 1.1030920729171676, 'psi': 0.8532636807939324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=96 head_norm_before_train=1.942141 cos_to_last_merge=0.8687 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.7557579089559214, 'auprc': 0.8469633798724124, 'loss_val': 0.9838100386313152, 'psi': 0.7922400973225179}-{'f1_val': 0.8370331227731491, 'auprc': 0.8663586310777271, 'loss_val': 0.5579938418298811, 'psi': 0.8487633260949803}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=2.008971 cos_to_last_merge=0.7161 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.716
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.7213577605915464, 'auprc': 0.7072701066491265, 'loss_val': 1.1009915538906492, 'psi': 0.7157226990145784}-{'f1_val': 0.7206112378371156, 'auprc': 0.7253545351935076, 'loss_val': 1.0502222518048856, 'psi': 0.7225085567796723}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=2.262125 cos_to_last_merge=0.9115 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.9475472415005931, 'auprc': 0.9938054484795091, 'loss_val': 0.18669335398388426, 'psi': 0.9660505242921595}-{'f1_val': 0.960527581452528, 'auprc': 0.9976490160776906, 'loss_val': 0.16790099696526017, 'psi': 0.9753761553025931}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=1.758048 cos_to_last_merge=0.8588 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.859
[S4] round=97 local utility u=0.064648 metrics={'f1_val': 0.9513518522987715, 'auprc': 0.9667505732752568, 'loss_val': 0.3153288341607569, 'psi': 0.9575113406893656}-{'f1_val': 0.9406164265330743, 'auprc': 0.9542173970200082, 'loss_val': 0.34261215927656236, 'psi': 0.9460568147278479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=97 head_norm_before_train=2.186291 (no previous merge yet)
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9988864775121021, 'loss_val': 0.016971373610296245, 'psi': 0.9975757720919154}-{'f1_val': 0.9970695586110643, 'auprc': 0.9999288738932981, 'loss_val': 0.017133999798013236, 'psi': 0.9982132847239579}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=2.022457 cos_to_last_merge=0.8528 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.853
[S6] round=97 local utility u=1.000000 metrics={'f1_val': 0.8760498348581867, 'auprc': 0.9688869837842629, 'loss_val': 0.20483066172059433, 'psi': 0.9131846944286172}-{'f1_val': 0.5908533444252762, 'auprc': 0.8065462183142539, 'loss_val': 1.258282088829387, 'psi': 0.6771304939808673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=97 head_norm_before_train=1.709459 cos_to_last_merge=0.8463 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.846
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.5964261476496822, 'auprc': 0.7934688949139703, 'loss_val': 0.7269947493234875, 'psi': 0.6752432465553975}-{'f1_val': 0.7230538800436179, 'auprc': 0.8805904766174026, 'loss_val': 0.22637879623721968, 'psi': 0.7860685186731318}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=97 head_norm_before_train=2.118020 cos_to_last_merge=0.9444 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=97 local utility u=0.009804 metrics={'f1_val': 0.9944013360228022, 'auprc': 0.9993523207108868, 'loss_val': 0.02862394798697651, 'psi': 0.996381729898036}-{'f1_val': 0.9918210737370572, 'auprc': 0.9991758756509619, 'loss_val': 0.032220355344344115, 'psi': 0.9947629945026191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=97 head_norm_before_train=1.974933 cos_to_last_merge=0.9101 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.910
[S9] round=97 local utility u=0.001446 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9989959261821232, 'loss_val': 0.017992597000306917, 'psi': 0.9978412183944694}-{'f1_val': 0.9966570119660778, 'auprc': 0.9989955642928742, 'loss_val': 0.018396784155493114, 'psi': 0.9975924328967964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=97 head_norm_before_train=2.106033 cos_to_last_merge=0.8956 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=97 local utility u=0.000867 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9974576053207767, 'loss_val': 0.022917755064840346, 'psi': 0.9960957455399355}-{'f1_val': 0.9949681865317428, 'auprc': 0.9971457413364931, 'loss_val': 0.022398185440349695, 'psi': 0.9958392084536429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=97 head_norm_before_train=2.353421 (no previous merge yet)
[S11] round=97 local utility u=0.006127 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9995226165583246, 'loss_val': 0.016128000765287195, 'psi': 0.9980017574778592}-{'f1_val': 0.9955431649470738, 'auprc': 0.9995392622857315, 'loss_val': 0.019763591669214882, 'psi': 0.9971416038825369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=97 head_norm_before_train=1.988087 (no previous merge yet)
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.637675863762531, 'auprc': 0.6885174309882212, 'loss_val': 1.1496927569577091, 'psi': 0.6580124906528071}-{'f1_val': 0.6913395319009801, 'auprc': 0.6778440078237953, 'loss_val': 1.134666627419397, 'psi': 0.6859413222701062}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=2.146602 cos_to_last_merge=0.9669 (last merge round=17)
[S14] round=97 local utility u=0.001984 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.99910821672473, 'loss_val': 0.022907562139660095, 'psi': 0.9982224706638178}-{'f1_val': 0.9972216920155168, 'auprc': 0.9983759630795657, 'loss_val': 0.022216898347848492, 'psi': 0.9976834004411363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=97 head_norm_before_train=2.019697 cos_to_last_merge=0.9039 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.904
[S15] round=97 local utility u=0.126488 metrics={'f1_val': 0.9087962343580763, 'auprc': 0.9972479230422462, 'loss_val': 0.2108768710749583, 'psi': 0.9441769098317443}-{'f1_val': 0.8811481377164017, 'auprc': 0.9967063707905364, 'loss_val': 0.296339037590132, 'psi': 0.9273714309460555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=97 head_norm_before_train=2.004956 cos_to_last_merge=0.9097 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=97 local utility u=0.599161 metrics={'f1_val': 0.93763908070712, 'auprc': 0.981307773088483, 'loss_val': 0.4355591087481331, 'psi': 0.9551065576596652}-{'f1_val': 0.8700028695820313, 'auprc': 0.8846007513761562, 'loss_val': 0.9379421006113555, 'psi': 0.8758420222996812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=97 head_norm_before_train=1.943706 cos_to_last_merge=0.8685 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.638121904449707, 'auprc': 0.9317400012812294, 'loss_val': 1.314594888455999, 'psi': 0.7555691431823159}-{'f1_val': 0.7557579089559214, 'auprc': 0.8469633798724124, 'loss_val': 0.9838100386313152, 'psi': 0.7922400973225179}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=98 head_norm_before_train=2.011624 cos_to_last_merge=0.7159 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.716
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7201070185435628, 'auprc': 0.7108171808187438, 'loss_val': 1.1198372276066477, 'psi': 0.7163910834536352}-{'f1_val': 0.7213577605915464, 'auprc': 0.7072701066491265, 'loss_val': 1.1009915538906492, 'psi': 0.7157226990145784}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.263423 cos_to_last_merge=0.9111 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=98 local utility u=0.069927 metrics={'f1_val': 0.956711207541875, 'auprc': 0.996024386377407, 'loss_val': 0.10847995866969279, 'psi': 0.9724364790760878}-{'f1_val': 0.9475472415005931, 'auprc': 0.9938054484795091, 'loss_val': 0.18669335398388426, 'psi': 0.9660505242921595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=98 head_norm_before_train=1.758079 cos_to_last_merge=0.8588 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.859
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9498618776711566, 'auprc': 0.9496276414475141, 'loss_val': 0.32825645921061847, 'psi': 0.9497681831816995}-{'f1_val': 0.9513518522987715, 'auprc': 0.9667505732752568, 'loss_val': 0.3153288341607569, 'psi': 0.9575113406893656}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=2.187943 (no previous merge yet)
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9969947366280233, 'auprc': 0.99387913809692, 'loss_val': 0.01880971881715013, 'psi': 0.995748497215582}-{'f1_val': 0.9967019684784577, 'auprc': 0.9988864775121021, 'loss_val': 0.016971373610296245, 'psi': 0.9975757720919154}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.027517 cos_to_last_merge=0.8528 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.853
[S6] round=98 local utility u=0.413715 metrics={'f1_val': 0.9846729286413668, 'auprc': 0.9844363104129223, 'loss_val': 0.07578787803511386, 'psi': 0.984578281349989}-{'f1_val': 0.8760498348581867, 'auprc': 0.9688869837842629, 'loss_val': 0.20483066172059433, 'psi': 0.9131846944286172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=98 head_norm_before_train=1.712748 cos_to_last_merge=0.8458 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.846
[S7] round=98 local utility u=0.639703 metrics={'f1_val': 0.7006798976639728, 'auprc': 0.8600289700005354, 'loss_val': 0.2727908646064765, 'psi': 0.7644195265985978}-{'f1_val': 0.5964261476496822, 'auprc': 0.7934688949139703, 'loss_val': 0.7269947493234875, 'psi': 0.6752432465553975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=98 head_norm_before_train=2.122836 cos_to_last_merge=0.9441 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9153137975903998, 'auprc': 0.999420605021127, 'loss_val': 0.1519868798316297, 'psi': 0.9489565205626906}-{'f1_val': 0.9944013360228022, 'auprc': 0.9993523207108868, 'loss_val': 0.02862394798697651, 'psi': 0.996381729898036}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=1.980498 cos_to_last_merge=0.9102 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.910
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9947882508505149, 'loss_val': 0.019440271239447447, 'psi': 0.9959116074285408}-{'f1_val': 0.9970714132027002, 'auprc': 0.9989959261821232, 'loss_val': 0.017992597000306917, 'psi': 0.9978412183944694}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.108619 cos_to_last_merge=0.8950 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.895
[S10] round=98 local utility u=0.000039 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.997459466973226, 'loss_val': 0.022844702380531847, 'psi': 0.9960964902009153}-{'f1_val': 0.9951878390193748, 'auprc': 0.9974576053207767, 'loss_val': 0.022917755064840346, 'psi': 0.9960957455399355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=98 head_norm_before_train=2.357843 (no previous merge yet)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9931450485312848, 'auprc': 0.999547415384097, 'loss_val': 0.02923479420410944, 'psi': 0.9957059952724097}-{'f1_val': 0.9969878514242156, 'auprc': 0.9995226165583246, 'loss_val': 0.016128000765287195, 'psi': 0.9980017574778592}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=1.995254 (no previous merge yet)
[S13] round=98 local utility u=0.101462 metrics={'f1_val': 0.6798589583926518, 'auprc': 0.677113895009498, 'loss_val': 1.165655789172212, 'psi': 0.6787609330393902}-{'f1_val': 0.637675863762531, 'auprc': 0.6885174309882212, 'loss_val': 1.1496927569577091, 'psi': 0.6580124906528071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=98 head_norm_before_train=2.149066 cos_to_last_merge=0.9664 (last merge round=17)
[S14] round=98 local utility u=0.000532 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.999230523033297, 'loss_val': 0.022210221589935655, 'psi': 0.9982713931872446}-{'f1_val': 0.9976319732898762, 'auprc': 0.99910821672473, 'loss_val': 0.022907562139660095, 'psi': 0.9982224706638178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=98 head_norm_before_train=2.024454 cos_to_last_merge=0.9036 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.904
[S15] round=98 local utility u=0.348308 metrics={'f1_val': 0.9938008041750955, 'auprc': 0.9991710718282277, 'loss_val': 0.03005699411547489, 'psi': 0.9959489112363484}-{'f1_val': 0.9087962343580763, 'auprc': 0.9972479230422462, 'loss_val': 0.2108768710749583, 'psi': 0.9441769098317443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=98 head_norm_before_train=2.008570 cos_to_last_merge=0.9091 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.909
[S16] round=98 local utility u=0.340538 metrics={'f1_val': 0.9879969837309581, 'auprc': 0.9821983717674657, 'loss_val': 0.05930217936058174, 'psi': 0.9856775389455612}-{'f1_val': 0.93763908070712, 'auprc': 0.981307773088483, 'loss_val': 0.4355591087481331, 'psi': 0.9551065576596652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=98 head_norm_before_train=1.946544 cos_to_last_merge=0.8683 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=98 local utility u=1.000000 metrics={'f1_val': 0.9525504569189658, 'auprc': 0.9912474071975126, 'loss_val': 0.09054742130647539, 'psi': 0.9680292370303845}-{'f1_val': 0.638121904449707, 'auprc': 0.9317400012812294, 'loss_val': 1.314594888455999, 'psi': 0.7555691431823159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=99 head_norm_before_train=2.014286 cos_to_last_merge=0.7157 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.716
[S2] round=99 local utility u=0.200162 metrics={'f1_val': 0.7130760954495362, 'auprc': 0.7976769189101403, 'loss_val': 0.9379059384085214, 'psi': 0.7469164248337778}-{'f1_val': 0.7201070185435628, 'auprc': 0.7108171808187438, 'loss_val': 1.1198372276066477, 'psi': 0.7163910834536352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] r=100 psi=0.747 u=0.2002 p_local=0.0680 f1=0.713 auprc=0.798 bytes=93563
[S3] START round=99 head_norm_before_train=2.265164 cos_to_last_merge=0.9106 (last merge round=17)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=99 local utility u=0.075229 metrics={'f1_val': 0.9732190656313666, 'auprc': 0.9974303448625593, 'loss_val': 0.06128675328091367, 'psi': 0.9829035773238437}-{'f1_val': 0.956711207541875, 'auprc': 0.996024386377407, 'loss_val': 0.10847995866969279, 'psi': 0.9724364790760878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S3] r=100 psi=0.983 u=0.0752 p_local=0.1090 f1=0.973 auprc=0.997 bytes=91640
[S4] START round=99 head_norm_before_train=1.754726 cos_to_last_merge=0.8585 (last merge round=13)
[S4] ⚠️ Model drifted since last merge! cos=0.858
[S4] round=99 local utility u=0.007252 metrics={'f1_val': 0.9535263150225751, 'auprc': 0.9478337668790322, 'loss_val': 0.33035836450276596, 'psi': 0.9512492957651579}-{'f1_val': 0.9498618776711566, 'auprc': 0.9496276414475141, 'loss_val': 0.32825645921061847, 'psi': 0.9497681831816995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] r=100 psi=0.951 u=0.0073 p_local=0.1189 f1=0.954 auprc=0.948 bytes=95240
[S5] START round=99 head_norm_before_train=2.189850 (no previous merge yet)
[S5] round=99 local utility u=0.002810 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9958262790465883, 'loss_val': 0.017274808481972638, 'psi': 0.9963516927057099}-{'f1_val': 0.9969947366280233, 'auprc': 0.99387913809692, 'loss_val': 0.01880971881715013, 'psi': 0.995748497215582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] r=100 psi=0.996 u=0.0028 p_local=0.0033 f1=0.997 auprc=0.996 bytes=104227
[S6] START round=99 head_norm_before_train=2.030187 cos_to_last_merge=0.8524 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.852
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.6274203914223816, 'auprc': 0.7216364600903336, 'loss_val': 1.1560593418778937, 'psi': 0.6651068188895624}-{'f1_val': 0.9846729286413668, 'auprc': 0.9844363104129223, 'loss_val': 0.07578787803511386, 'psi': 0.984578281349989}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.665 u=0.0000 p_local=0.3352 f1=0.627 auprc=0.722 bytes=99055
[S7] START round=99 head_norm_before_train=1.717258 cos_to_last_merge=0.8451 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.845
[S7] round=99 local utility u=0.000000 metrics={'f1_val': 0.611417796201801, 'auprc': 0.7940349570555703, 'loss_val': 0.788131358338426, 'psi': 0.6844646605433087}-{'f1_val': 0.7006798976639728, 'auprc': 0.8600289700005354, 'loss_val': 0.2727908646064765, 'psi': 0.7644195265985978}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=100 psi=0.684 u=0.0000 p_local=0.2227 f1=0.611 auprc=0.794 bytes=97206
[S8] START round=99 head_norm_before_train=2.126238 cos_to_last_merge=0.9436 (last merge round=13)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=99 local utility u=0.262134 metrics={'f1_val': 0.9851784257542062, 'auprc': 0.9996508593228088, 'loss_val': 0.047597283687231186, 'psi': 0.9909673991816472}-{'f1_val': 0.9153137975903998, 'auprc': 0.999420605021127, 'loss_val': 0.1519868798316297, 'psi': 0.9489565205626906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] r=100 psi=0.991 u=0.2621 p_local=0.1184 f1=0.985 auprc=1.000 bytes=98926
[S9] START round=99 head_norm_before_train=1.981585 cos_to_last_merge=0.9091 (last merge round=17)
[S9] ⚠️ Model drifted since last merge! cos=0.909
[S9] round=99 local utility u=0.002606 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964841452258286, 'loss_val': 0.019315026568550442, 'psi': 0.9965899651786663}-{'f1_val': 0.9966605118138915, 'auprc': 0.9947882508505149, 'loss_val': 0.019440271239447447, 'psi': 0.9959116074285408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S9] r=100 psi=0.997 u=0.0026 p_local=0.0125 f1=0.997 auprc=0.996 bytes=106227
[S10] START round=99 head_norm_before_train=2.111503 cos_to_last_merge=0.8944 (last merge round=17)
[S10] ⚠️ Model drifted since last merge! cos=0.894
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974402681285829, 'loss_val': 0.022540631896272322, 'psi': 0.9959570191704789}-{'f1_val': 0.9951878390193748, 'auprc': 0.997459466973226, 'loss_val': 0.022844702380531847, 'psi': 0.9960964902009153}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0002 f1=0.995 auprc=0.997 bytes=120602
[S11] START round=99 head_norm_before_train=2.360784 (no previous merge yet)
[S11] round=99 local utility u=0.018043 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9995424383027796, 'loss_val': 0.0161907355504987, 'psi': 0.9980096861756412}-{'f1_val': 0.9931450485312848, 'auprc': 0.999547415384097, 'loss_val': 0.02923479420410944, 'psi': 0.9957059952724097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S11] r=100 psi=0.998 u=0.0180 p_local=0.0061 f1=0.997 auprc=1.000 bytes=106070
[S13] START round=99 head_norm_before_train=1.999410 (no previous merge yet)
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6513383413384422, 'auprc': 0.6607946163664133, 'loss_val': 1.2465876619902978, 'psi': 0.6551208513496307}-{'f1_val': 0.6798589583926518, 'auprc': 0.677113895009498, 'loss_val': 1.165655789172212, 'psi': 0.6787609330393902}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.655 u=0.0000 p_local=0.0881 f1=0.651 auprc=0.661 bytes=90138
[S14] START round=99 head_norm_before_train=2.154921 cos_to_last_merge=0.9661 (last merge round=17)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9992336636029928, 'loss_val': 0.02352037793213032, 'psi': 0.9982726494151228}-{'f1_val': 0.9976319732898762, 'auprc': 0.999230523033297, 'loss_val': 0.022210221589935655, 'psi': 0.9982713931872446}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.998 u=0.0000 p_local=0.0167 f1=0.998 auprc=0.999 bytes=109590
[S15] START round=99 head_norm_before_train=2.029220 cos_to_last_merge=0.9033 (last merge round=16)
[S15] ⚠️ Model drifted since last merge! cos=0.903
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.9840545113927044, 'auprc': 0.9978195517905075, 'loss_val': 0.034689874341678154, 'psi': 0.9895605275518257}-{'f1_val': 0.9938008041750955, 'auprc': 0.9991710718282277, 'loss_val': 0.03005699411547489, 'psi': 0.9959489112363484}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.990 u=0.0000 p_local=0.1303 f1=0.984 auprc=0.998 bytes=102504
[S16] START round=99 head_norm_before_train=2.011419 cos_to_last_merge=0.9087 (last merge round=16)
[S16] ⚠️ Model drifted since last merge! cos=0.909
[S16] round=99 local utility u=0.031898 metrics={'f1_val': 0.99320686395687, 'auprc': 0.9855916987281503, 'loss_val': 0.03694512258684312, 'psi': 0.9901607978653821}-{'f1_val': 0.9879969837309581, 'auprc': 0.9821983717674657, 'loss_val': 0.05930217936058174, 'psi': 0.9856775389455612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S16] r=100 psi=0.990 u=0.0319 p_local=0.1928 f1=0.993 auprc=0.986 bytes=104312
[S17] START round=99 head_norm_before_train=1.949430 cos_to_last_merge=0.8684 (last merge round=13)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.79230007920789, 'auprc': 0.9878752153026226, 'loss_val': 0.6220198733632246, 'psi': 0.8705301336457831}-{'f1_val': 0.9525504569189658, 'auprc': 0.9912474071975126, 'loss_val': 0.09054742130647539, 'psi': 0.9680292370303845}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.871 u=0.0000 p_local=0.3084 f1=0.792 auprc=0.988 bytes=97238
[runner] rounds complete.
[runner] all agents stopped.
