[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:45903
[S3] → join 127.0.0.1:45902
[S4] → join 127.0.0.1:45902
[S5] → join 127.0.0.1:45902
[S6] → join 127.0.0.1:45902
[S7] → join 127.0.0.1:45902
[S8] → join 127.0.0.1:45902
[S9] → join 127.0.0.1:45902
[S10] → join 127.0.0.1:45902
[S11] → join 127.0.0.1:45902
[S13] → join 127.0.0.1:45902
[S14] → join 127.0.0.1:45902
[S15] → join 127.0.0.1:45902
[S16] → join 127.0.0.1:45902
[S17] → join 127.0.0.1:45902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.170418 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.137494 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.128789 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.165938 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.172201 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.131450 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.087867 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.179664 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.200621 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.206260 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.194803 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.162367 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.156782 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.180621 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.135106 (no previous merge yet)
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S11
[S3] + discovered S14
[S3] + discovered S4
[S3] + discovered S13
[S3] + discovered S17
[S3] + discovered S15
[S3] + discovered S7
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S10
[S3] + discovered S6
[S3] + discovered S16
[S3] + discovered S9
[S4] + discovered S2
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S3
[S4] + discovered S14
[S4] + discovered S11
[S4] + discovered S13
[S4] + discovered S17
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S5
[S4] + discovered S8
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S9
[S6] + discovered S5
[S5] + discovered S8
[S5] + discovered S15
[S6] + discovered S4
[S6] + discovered S3
[S5] + discovered S13
[S6] + discovered S2
[S5] + discovered S11
[S5] + discovered S14
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S7
[S6] + discovered S10
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S8
[S7] + discovered S5
[S7] + discovered S4
[S6] + discovered S13
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S3
[S6] + discovered S14
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S7
[S7] + discovered S8
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S14
[S7] + discovered S9
[S9] + discovered S6
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S14
[S9] + discovered S2
[S8] + discovered S15
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S16
[S9] + discovered S7
[S8] + discovered S10
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S8
[S9] + discovered S3
[S10] + discovered S2
[S10] + discovered S6
[S9] + discovered S11
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S13
[S9] + discovered S15
[S10] + discovered S4
[S9] + discovered S10
[S9] + discovered S16
[S10] + discovered S7
[S10] + discovered S3
[S10] + discovered S9
[S10] + discovered S8
[S10] + discovered S5
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S13
[S10] + discovered S17
[S10] + discovered S11
[S11] + discovered S10
[S11] + discovered S2
[S11] + discovered S5
[S11] + discovered S8
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S6
[S11] + discovered S4
[S11] + discovered S7
[S10] + discovered S14
[S13] + discovered S5
[S13] + discovered S6
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S8
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S2
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S16
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S15
[S14] + discovered S3
[S14] + discovered S13
[S14] + discovered S11
[S13] + discovered S16
[S14] + discovered S9
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S7
[S15] + discovered S5
[S14] + discovered S16
[S15] + discovered S8
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S6
[S15] + discovered S7
[S15] + discovered S11
[S14] + discovered S15
[S15] + discovered S14
[S14] + discovered S17
[S15] + discovered S9
[S15] + discovered S13
[S15] + discovered S4
[S15] + discovered S10
[S16] + discovered S8
[S16] + discovered S3
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S4
[S16] + discovered S14
[S16] + discovered S9
[S16] + discovered S7
[S16] + discovered S13
[S16] + discovered S11
[S16] + discovered S15
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S3
[S17] + discovered S14
[S17] + discovered S4
[S16] + discovered S17
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S7
[S17] + discovered S13
[S17] + discovered S15
[S17] + discovered S16
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S2
[S17] + discovered S5
[S17] + discovered S8
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=1.000 → S4@127.0.0.1:45904
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:45913
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:45914
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:45916
[S10] ⇄ pheromone p=1.000 → S8@127.0.0.1:45909
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:45916
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:45917
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:45903
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:45916
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:45915
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:45917
[S3] ⇄ pheromone p=1.000 → S17@127.0.0.1:45917
[S13] ⇄ pheromone p=1.000 → S2@127.0.0.1:45902
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:45912
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:45914
[S2] START round=1 head_norm_before_train=1.172127 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6218242806456459, 'loss_val': 1.2390161157134625, 'psi': 0.3337959922913984}-{'f1_val': 0.1417771333885667, 'auprc': 0.7901128620139534, 'loss_val': 1.310873438819593, 'psi': 0.4011114248387214}
[S3] START round=1 head_norm_before_train=1.141587 (no previous merge yet)
[S3] round=1 local utility u=0.475645 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8408199640253597, 'loss_val': 1.3450533415241048, 'psi': 0.4202320249786081}-{'f1_val': 0.0899929692992735, 'auprc': 0.6327004273073878, 'loss_val': 1.3729029803926391, 'psi': 0.30707595250251923}
[S4] START round=1 head_norm_before_train=1.138511 (no previous merge yet)
[S4] round=1 local utility u=0.244660 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7758496389936155, 'loss_val': 1.2649117091481372, 'psi': 0.3944758329345567}-{'f1_val': 0.14022662889518414, 'auprc': 0.6351554328115936, 'loss_val': 1.332148121320215, 'psi': 0.33819815046174795}
[S5] START round=1 head_norm_before_train=1.169003 (no previous merge yet)
[S5] round=1 local utility u=0.169294 metrics={'f1_val': 0.4247767552317834, 'auprc': 0.732513362670969, 'loss_val': 1.3338196591064941, 'psi': 0.5478713982074577}-{'f1_val': 0.3741745482527711, 'auprc': 0.7337494883899126, 'loss_val': 1.3725029987073247, 'psi': 0.5180045243076277}
[S6] START round=1 head_norm_before_train=1.188875 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8632752358566885, 'loss_val': 1.2635709945281064, 'psi': 0.43016586357344466}-{'f1_val': 0.28665291080268923, 'auprc': 0.8029024863561973, 'loss_val': 1.3340870097015898, 'psi': 0.49315274102409246}
[S7] START round=1 head_norm_before_train=1.128561 (no previous merge yet)
[S7] round=1 local utility u=0.238823 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5934320672804355, 'loss_val': 1.3441780483614207, 'psi': 0.3226069205496292}-{'f1_val': 0.14205682272909165, 'auprc': 0.44436041491979306, 'loss_val': 1.3746095319922091, 'psi': 0.26297825960537224}
[S8] START round=1 head_norm_before_train=1.105153 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7570798277820598, 'loss_val': 1.2449831426719962, 'psi': 0.3868055205485983}-{'f1_val': 0.416084496488008, 'auprc': 0.6317965251315167, 'loss_val': 1.3199065516940522, 'psi': 0.5023693079454115}
[S9] START round=1 head_norm_before_train=1.190467 (no previous merge yet)
[S9] round=1 local utility u=0.487845 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9756306487122088, 'loss_val': 1.2889610056691847, 'psi': 0.4750910337688812}-{'f1_val': 0.141397957139996, 'auprc': 0.6647446815291002, 'loss_val': 1.3319939751690892, 'psi': 0.35073664689563766}
[S10] START round=1 head_norm_before_train=1.209209 (no previous merge yet)
[S10] round=1 local utility u=0.061931 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6420038608090293, 'loss_val': 1.2855851598240267, 'psi': 0.3399745268486461}-{'f1_val': 0.13862163754172394, 'auprc': 0.615548086844786, 'loss_val': 1.3300803857608248, 'psi': 0.32939221726294876}
[S11] START round=1 head_norm_before_train=1.216004 (no previous merge yet)
[S11] round=1 local utility u=0.007033 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8676584478250361, 'loss_val': 1.3063604222246636, 'psi': 0.4313115891538808}-{'f1_val': 0.14041368337311058, 'auprc': 0.8767049136047427, 'loss_val': 1.3475658405548487, 'psi': 0.43493017546576346}
[S13] START round=1 head_norm_before_train=1.199189 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5520746299068219, 'loss_val': 1.2958368834489753, 'psi': 0.3050613095089606}-{'f1_val': 0.37189073220722907, 'auprc': 0.5670033011141212, 'loss_val': 1.3587440878085937, 'psi': 0.4499357597699859}
[S14] START round=1 head_norm_before_train=1.160915 (no previous merge yet)
[S14] round=1 local utility u=0.838866 metrics={'f1_val': 0.33364648873266134, 'auprc': 0.821244822695258, 'loss_val': 1.3432389818559762, 'psi': 0.5286858223177}-{'f1_val': 0.1038107752956636, 'auprc': 0.7294495876134257, 'loss_val': 1.3665707406213563, 'psi': 0.35406630022276847}
[S15] START round=1 head_norm_before_train=1.167567 (no previous merge yet)
[S15] round=1 local utility u=0.423283 metrics={'f1_val': 0.1408418540883926, 'auprc': 0.7652780272412163, 'loss_val': 1.315122601535905, 'psi': 0.39061632334952207}-{'f1_val': 0.103651869669801, 'auprc': 0.5744665188735537, 'loss_val': 1.366115110968799, 'psi': 0.29197772935130206}
[S16] START round=1 head_norm_before_train=1.187791 (no previous merge yet)
[S16] round=1 local utility u=0.277860 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7928480456213158, 'loss_val': 1.3016604891253, 'psi': 0.40152168836804825}-{'f1_val': 0.14063745019920318, 'auprc': 0.6192129040618399, 'loss_val': 1.3364754205112146, 'psi': 0.3320676317442579}
[S17] START round=1 head_norm_before_train=1.146433 (no previous merge yet)
[S17] round=1 local utility u=0.662307 metrics={'f1_val': 0.30853549386546514, 'auprc': 0.68767122751621, 'loss_val': 1.2871068592646664, 'psi': 0.4601897873257631}-{'f1_val': 0.09754189944134078, 'auprc': 0.6885789734246188, 'loss_val': 1.3484820211905344, 'psi': 0.333956729034652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:45908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S5] → sending delta(kind=head bytes=1784) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:45907
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:45907
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:45902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:45903
[S10] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1784 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1789) from S11
[S2] cosine check vs S11: cos=-0.0606
[S2] DROPPED delta from S11 (cos=-0.0606 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S9
[S2] cosine check vs S9: cos=0.0419
[S11] RECEIVED delta(kind=head bytes=1789) from S3
[S11] cosine check vs S3: cos=0.0233
[S11] RECEIVED delta(kind=head bytes=1793) from S10
[S11] cosine check vs S10: cos=-0.0388
[S11] DROPPED delta from S10 (cos=-0.0388 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1784) from S5
[S3] cosine check vs S5: cos=-0.0458
[S3] DROPPED delta from S5 (cos=-0.0458 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S7
[S6] cosine check vs S7: cos=-0.0072
[S6] DROPPED delta from S7 (cos=-0.0072 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1786) from S16
[S15] cosine check vs S16: cos=-0.0181
[S15] DROPPED delta from S16 (cos=-0.0181 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S14
[S6] cosine check vs S14: cos=-0.0650
[S6] DROPPED delta from S14 (cos=-0.0650 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S15
[S7] cosine check vs S15: cos=0.0550
[S3] RECEIVED delta(kind=head bytes=1787) from S4
[S3] cosine check vs S4: cos=0.0160
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:45905
[S17] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S17
[S5] cosine check vs S17: cos=-0.0907
[S5] DROPPED delta from S17 (cos=-0.0907 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.202797
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.364428e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.872282 delta_norm=0.836443
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.234822
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.354797e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.855094 delta_norm=0.835480
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.136495
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.030324e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.848443 delta_norm=0.803032
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.154833
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.179120e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.831105 delta_norm=0.817912
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.872282 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.015774 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6180814837102787, 'loss_val': 1.1962393443243005, 'psi': 0.3322988735172515}-{'f1_val': 0.1417771333885667, 'auprc': 0.6218242806456459, 'loss_val': 1.2390161157134625, 'psi': 0.3337959922913984}
[S3] START round=2 head_norm_before_train=0.831105 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6659961923882559, 'loss_val': 1.3401121979914106, 'psi': 0.35030251632376663}-{'f1_val': 0.13984006561410703, 'auprc': 0.8408199640253597, 'loss_val': 1.3450533415241048, 'psi': 0.4202320249786081}
[S4] START round=2 head_norm_before_train=1.177196 (no previous merge yet)
[S4] round=2 local utility u=0.062926 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7783686412723733, 'loss_val': 1.1466172052166954, 'psi': 0.39548343384605983}-{'f1_val': 0.14022662889518414, 'auprc': 0.7758496389936155, 'loss_val': 1.2649117091481372, 'psi': 0.3944758329345567}
[S5] START round=2 head_norm_before_train=1.183155 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7276440742512134, 'loss_val': 1.2874742428484887, 'psi': 0.37641477255762823}-{'f1_val': 0.4247767552317834, 'auprc': 0.732513362670969, 'loss_val': 1.3338196591064941, 'psi': 0.5478713982074577}
[S6] START round=2 head_norm_before_train=1.230562 (no previous merge yet)
[S6] round=2 local utility u=0.030228 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8645081414713034, 'loss_val': 1.2068128293683271, 'psi': 0.4306590258192906}-{'f1_val': 0.14142628205128205, 'auprc': 0.8632752358566885, 'loss_val': 1.2635709945281064, 'psi': 0.43016586357344466}
[S7] START round=2 head_norm_before_train=0.848443 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.265397 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7693104707594038, 'loss_val': 1.3410198338906574, 'psi': 0.39295828194121657}-{'f1_val': 0.14205682272909165, 'auprc': 0.5934320672804355, 'loss_val': 1.3441780483614207, 'psi': 0.3226069205496292}
[S8] START round=2 head_norm_before_train=1.148979 (no previous merge yet)
[S8] round=2 local utility u=0.731005 metrics={'f1_val': 0.36509408940988636, 'auprc': 0.7661199921959201, 'loss_val': 1.1609227940426943, 'psi': 0.5255044505242998}-{'f1_val': 0.13995598239295717, 'auprc': 0.7570798277820598, 'loss_val': 1.2449831426719962, 'psi': 0.3868055205485983}
[S9] START round=2 head_norm_before_train=1.214210 (no previous merge yet)
[S9] round=2 local utility u=0.039672 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9821740685592951, 'loss_val': 1.2292473005164033, 'psi': 0.47770840170771567}-{'f1_val': 0.141397957139996, 'auprc': 0.9756306487122088, 'loss_val': 1.2889610056691847, 'psi': 0.4750910337688812}
[S10] START round=2 head_norm_before_train=1.244906 (no previous merge yet)
[S10] round=2 local utility u=0.030799 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6354209486100124, 'loss_val': 1.2042376322340653, 'psi': 0.33734136196903936}-{'f1_val': 0.13862163754172394, 'auprc': 0.6420038608090293, 'loss_val': 1.2855851598240267, 'psi': 0.3399745268486461}
[S11] START round=2 head_norm_before_train=0.855094 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8009953416339121, 'loss_val': 1.3198593899123032, 'psi': 0.4046463466774312}-{'f1_val': 0.14041368337311058, 'auprc': 0.8676584478250361, 'loss_val': 1.3063604222246636, 'psi': 0.4313115891538808}
[S13] START round=2 head_norm_before_train=1.232237 (no previous merge yet)
[S13] round=2 local utility u=0.071741 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5691701684396758, 'loss_val': 1.203640957061843, 'psi': 0.3118995249221022}-{'f1_val': 0.1403857625770531, 'auprc': 0.5520746299068219, 'loss_val': 1.2958368834489753, 'psi': 0.3050613095089606}
[S14] START round=2 head_norm_before_train=1.173360 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14714464360150062, 'auprc': 0.8333378712133483, 'loss_val': 1.3164702813069602, 'psi': 0.4216219346462397}-{'f1_val': 0.33364648873266134, 'auprc': 0.821244822695258, 'loss_val': 1.3432389818559762, 'psi': 0.5286858223177}
[S15] START round=2 head_norm_before_train=1.199088 (no previous merge yet)
[S15] round=2 local utility u=0.034481 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7684860078135076, 'loss_val': 1.2491357779147052, 'psi': 0.39123459394233806}-{'f1_val': 0.1408418540883926, 'auprc': 0.7652780272412163, 'loss_val': 1.315122601535905, 'psi': 0.39061632334952207}
[S16] START round=2 head_norm_before_train=1.204971 (no previous merge yet)
[S16] round=2 local utility u=0.031572 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7989410405675292, 'loss_val': 1.2567962777296653, 'psi': 0.40395888634653365}-{'f1_val': 0.14063745019920318, 'auprc': 0.7928480456213158, 'loss_val': 1.3016604891253, 'psi': 0.40152168836804825}
[S17] START round=2 head_norm_before_train=1.185591 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5536182398276094, 'loss_val': 1.1767661615994895, 'psi': 0.30601667392147436}-{'f1_val': 0.30853549386546514, 'auprc': 0.68767122751621, 'loss_val': 1.2871068592646664, 'psi': 0.4601897873257631}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:45902
[S9] not sending this round → trigger blocked (psi=0.478)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.404)
[S4] not sending this round → trigger blocked (psi=0.395)
[S15] not sending this round → trigger blocked (psi=0.391)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:45903
[S7] not sending this round → trigger blocked (psi=0.393)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:45911
[S10] not sending this round → trigger blocked (psi=0.337)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:45915
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S8
[S10] cosine check vs S8: cos=0.0210
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] cosine check vs S6: cos=0.0564
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=-0.0336
[S3] DROPPED delta from S2 (cos=-0.0336 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=-0.0651
[S2] DROPPED delta from S13 (cos=-0.0651 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=1.297526
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.727516e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1428 head_norm=0.891217 delta_norm=0.872752
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.256838
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.741640e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.924886 delta_norm=0.874164
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.908371 cos_to_last_merge=0.9898 (last merge round=1)
[S2] round=3 local utility u=0.913564 metrics={'f1_val': 0.36605312506234167, 'auprc': 0.7263980661543051, 'loss_val': 1.0397166351291145, 'psi': 0.510191101499127}-{'f1_val': 0.1417771333885667, 'auprc': 0.6180814837102787, 'loss_val': 1.1962393443243005, 'psi': 0.3322988735172515}
[S3] START round=3 head_norm_before_train=0.848941 cos_to_last_merge=0.9968 (last merge round=1)
[S3] round=3 local utility u=0.127178 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7409706554571166, 'loss_val': 1.310679301361388, 'psi': 0.3802923015513109}-{'f1_val': 0.13984006561410703, 'auprc': 0.6659961923882559, 'loss_val': 1.3401121979914106, 'psi': 0.35030251632376663}
[S4] START round=3 head_norm_before_train=1.238332 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6735450737465092, 'auprc': 0.6562904482024483, 'loss_val': 0.934509518009965, 'psi': 0.6666432235288848}-{'f1_val': 0.14022662889518414, 'auprc': 0.7783686412723733, 'loss_val': 1.1466172052166954, 'psi': 0.39548343384605983}
[S5] START round=3 head_norm_before_train=1.204637 (no previous merge yet)
[S5] round=3 local utility u=0.027909 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7287316106369356, 'loss_val': 1.234919157544835, 'psi': 0.3768497871119171}-{'f1_val': 0.14226190476190476, 'auprc': 0.7276440742512134, 'loss_val': 1.2874742428484887, 'psi': 0.37641477255762823}
[S6] START round=3 head_norm_before_train=1.288220 (no previous merge yet)
[S6] round=3 local utility u=0.920082 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.8650492459352885, 'loss_val': 1.0196419278789182, 'psi': 0.5960123861074225}-{'f1_val': 0.14142628205128205, 'auprc': 0.8645081414713034, 'loss_val': 1.2068128293683271, 'psi': 0.4306590258192906}
[S7] START round=3 head_norm_before_train=0.857664 cos_to_last_merge=0.9964 (last merge round=1)
[S7] round=3 local utility u=0.044684 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7875313476595281, 'loss_val': 1.3063138537257935, 'psi': 0.40024663270126626}-{'f1_val': 0.14205682272909165, 'auprc': 0.7693104707594038, 'loss_val': 1.3410198338906574, 'psi': 0.39295828194121657}
[S8] START round=3 head_norm_before_train=1.195138 (no previous merge yet)
[S8] round=3 local utility u=0.592160 metrics={'f1_val': 0.51766115170808, 'auprc': 0.7929765691324013, 'loss_val': 0.9725758310874631, 'psi': 0.6277873186778086}-{'f1_val': 0.36509408940988636, 'auprc': 0.7661199921959201, 'loss_val': 1.1609227940426943, 'psi': 0.5255044505242998}
[S9] START round=3 head_norm_before_train=1.248489 (no previous merge yet)
[S9] round=3 local utility u=0.035058 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9774219505159616, 'loss_val': 1.1448747072429186, 'psi': 0.47580755449038226}-{'f1_val': 0.141397957139996, 'auprc': 0.9821740685592951, 'loss_val': 1.2292473005164033, 'psi': 0.47770840170771567}
[S10] START round=3 head_norm_before_train=0.891217 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.907214 metrics={'f1_val': 0.41523735297357967, 'auprc': 0.6489239698191757, 'loss_val': 1.090012482025524, 'psi': 0.508711999711818}-{'f1_val': 0.13862163754172394, 'auprc': 0.6354209486100124, 'loss_val': 1.2042376322340653, 'psi': 0.33734136196903936}
[S11] START round=3 head_norm_before_train=0.875007 cos_to_last_merge=0.9964 (last merge round=1)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6917319451603787, 'loss_val': 1.2557916484102636, 'psi': 0.36094098808801783}-{'f1_val': 0.14041368337311058, 'auprc': 0.8009953416339121, 'loss_val': 1.3198593899123032, 'psi': 0.4046463466774312}
[S13] START round=3 head_norm_before_train=1.291117 (no previous merge yet)
[S13] round=3 local utility u=0.864232 metrics={'f1_val': 0.41666745678544126, 'auprc': 0.5595011207978754, 'loss_val': 1.1038607891355898, 'psi': 0.47380092239041494}-{'f1_val': 0.1403857625770531, 'auprc': 0.5691701684396758, 'loss_val': 1.203640957061843, 'psi': 0.3118995249221022}
[S14] START round=3 head_norm_before_train=1.194117 (no previous merge yet)
[S14] round=3 local utility u=0.000503 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8366219994555858, 'loss_val': 1.2845957213158585, 'psi': 0.4188635115118566}-{'f1_val': 0.14714464360150062, 'auprc': 0.8333378712133483, 'loss_val': 1.3164702813069602, 'psi': 0.4216219346462397}
[S15] START round=3 head_norm_before_train=0.924886 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.024416 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7732876790277265, 'loss_val': 1.214708066612751, 'psi': 0.3931552624280256}-{'f1_val': 0.13973365136155833, 'auprc': 0.7684860078135076, 'loss_val': 1.2491357779147052, 'psi': 0.39123459394233806}
[S16] START round=3 head_norm_before_train=1.232646 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7550621229920991, 'loss_val': 1.1939808104225655, 'psi': 0.3864073193163615}-{'f1_val': 0.14063745019920318, 'auprc': 0.7989410405675292, 'loss_val': 1.2567962777296653, 'psi': 0.40395888634653365}
[S17] START round=3 head_norm_before_train=1.245241 (no previous merge yet)
[S17] round=3 local utility u=0.959706 metrics={'f1_val': 0.3918628032171344, 'auprc': 0.6267676316149071, 'loss_val': 0.9822861494293426, 'psi': 0.48582473457624353}-{'f1_val': 0.14094896331738438, 'auprc': 0.5536182398276094, 'loss_val': 1.1767661615994895, 'psi': 0.30601667392147436}
[S13] not sending this round → trigger blocked (psi=0.474)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[S2] not sending this round → trigger blocked (psi=0.510)
[S8] not sending this round → trigger blocked (psi=0.628)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:45914
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.596)
[S4] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1788) from S9
[S16] cosine check vs S9: cos=0.1138
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=-0.0432
[S13] DROPPED delta from S15 (cos=-0.0432 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=-0.0071
[S17] DROPPED delta from S3 (cos=-0.0071 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.6402
[S14] RECEIVED delta(kind=head bytes=1794) from S4
[S14] cosine check vs S4: cos=0.0685
[S4] RECEIVED delta(kind=head bytes=1796) from S7
[S4] cosine check vs S7: cos=0.0773
[S11] RECEIVED delta(kind=head bytes=1789) from S14
[S11] cosine check vs S14: cos=-0.0157
[S11] DROPPED delta from S14 (cos=-0.0157 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.0004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=0.1195
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.5177 head_norm=1.256889
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.890077e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.7148 head_norm=1.005833 delta_norm=0.489008
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.223406
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.239414e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.820941 delta_norm=0.723941
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.6735 head_norm=1.304910
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.575417e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.6595 head_norm=0.813858 delta_norm=0.757542
[S4] aggregate: ROLLBACK (f1_val pre=0.674 post=0.660 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.267001
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.419187e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.802279 delta_norm=0.741919
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.957919 cos_to_last_merge=0.9671 (last merge round=1)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.7136054873907623, 'auprc': 0.777097088951735, 'loss_val': 0.829893002328372, 'psi': 0.7390021280151514}-{'f1_val': 0.36605312506234167, 'auprc': 0.7263980661543051, 'loss_val': 1.0397166351291145, 'psi': 0.510191101499127}
[S3] START round=4 head_norm_before_train=0.876128 cos_to_last_merge=0.9882 (last merge round=1)
[S3] round=4 local utility u=0.249845 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8953968446948504, 'loss_val': 1.2742671785106003, 'psi': 0.4420627772464044}-{'f1_val': 0.13984006561410703, 'auprc': 0.7409706554571166, 'loss_val': 1.310679301361388, 'psi': 0.3802923015513109}
[S4] START round=4 head_norm_before_train=0.813858 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.045136 metrics={'f1_val': 0.6716804702939992, 'auprc': 0.6563213999669648, 'loss_val': 0.8331431569930502, 'psi': 0.6655368421631855}-{'f1_val': 0.6735450737465092, 'auprc': 0.6562904482024483, 'loss_val': 0.934509518009965, 'psi': 0.6666432235288848}
[S5] START round=4 head_norm_before_train=1.233225 (no previous merge yet)
[S5] round=4 local utility u=0.032868 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7355185541621563, 'loss_val': 1.1895445404194949, 'psi': 0.3795645645220054}-{'f1_val': 0.14226190476190476, 'auprc': 0.7287316106369356, 'loss_val': 1.234919157544835, 'psi': 0.3768497871119171}
[S6] START round=4 head_norm_before_train=1.328313 (no previous merge yet)
[S6] round=4 local utility u=0.122568 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.8653023093877713, 'loss_val': 0.7764702154252454, 'psi': 0.5962340352814289}-{'f1_val': 0.4166544795555117, 'auprc': 0.8650492459352885, 'loss_val': 1.0196419278789182, 'psi': 0.5960123861074225}
[S7] START round=4 head_norm_before_train=0.877313 cos_to_last_merge=0.9867 (last merge round=1)
[S7] round=4 local utility u=0.020638 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7889818069340103, 'loss_val': 1.2693891302225462, 'psi': 0.40082681641105916}-{'f1_val': 0.14205682272909165, 'auprc': 0.7875313476595281, 'loss_val': 1.3063138537257935, 'psi': 0.40024663270126626}
[S8] START round=4 head_norm_before_train=1.005833 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.631308 metrics={'f1_val': 0.700261118104443, 'auprc': 0.7941031723007042, 'loss_val': 0.8089385663253862, 'psi': 0.7377979397829475}-{'f1_val': 0.51766115170808, 'auprc': 0.7929765691324013, 'loss_val': 0.9725758310874631, 'psi': 0.6277873186778086}
[S9] START round=4 head_norm_before_train=1.288575 (no previous merge yet)
[S9] round=4 local utility u=0.602056 metrics={'f1_val': 0.31624937643096274, 'auprc': 0.9813432693423194, 'loss_val': 1.0016345484948987, 'psi': 0.5822869335955054}-{'f1_val': 0.141397957139996, 'auprc': 0.9774219505159616, 'loss_val': 1.1448747072429186, 'psi': 0.47580755449038226}
[S10] START round=4 head_norm_before_train=0.960150 cos_to_last_merge=0.9918 (last merge round=2)
[S10] round=4 local utility u=0.297477 metrics={'f1_val': 0.392779320519141, 'auprc': 0.7969388526944001, 'loss_val': 0.8043556820719615, 'psi': 0.5544431333892447}-{'f1_val': 0.41523735297357967, 'auprc': 0.6489239698191757, 'loss_val': 1.090012482025524, 'psi': 0.508711999711818}
[S11] START round=4 head_norm_before_train=0.904710 cos_to_last_merge=0.9859 (last merge round=1)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5985121482789577, 'loss_val': 1.191798606055086, 'psi': 0.32365306933544946}-{'f1_val': 0.14041368337311058, 'auprc': 0.6917319451603787, 'loss_val': 1.2557916484102636, 'psi': 0.36094098808801783}
[S13] START round=4 head_norm_before_train=1.336613 (no previous merge yet)
[S13] round=4 local utility u=0.229299 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.6501763834729933, 'loss_val': 0.9133069266362416, 'psi': 0.5096728731486744}-{'f1_val': 0.41666745678544126, 'auprc': 0.5595011207978754, 'loss_val': 1.1038607891355898, 'psi': 0.47380092239041494}
[S14] START round=4 head_norm_before_train=0.820941 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7992202575794084, 'loss_val': 1.2852241810795786, 'psi': 0.4039028147613856}-{'f1_val': 0.14035785288270378, 'auprc': 0.8366219994555858, 'loss_val': 1.2845957213158585, 'psi': 0.4188635115118566}
[S15] START round=4 head_norm_before_train=0.979075 cos_to_last_merge=0.9957 (last merge round=2)
[S15] round=4 local utility u=0.948369 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7788713944400173, 'loss_val': 0.994574101676202, 'psi': 0.5613740614803734}-{'f1_val': 0.13973365136155833, 'auprc': 0.7732876790277265, 'loss_val': 1.214708066612751, 'psi': 0.3931552624280256}
[S16] START round=4 head_norm_before_train=0.802279 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5950380919312661, 'loss_val': 1.1760876841609926, 'psi': 0.3223977068920284}-{'f1_val': 0.14063745019920318, 'auprc': 0.7550621229920991, 'loss_val': 1.1939808104225655, 'psi': 0.3864073193163615}
[S17] START round=4 head_norm_before_train=1.302749 (no previous merge yet)
[S17] round=4 local utility u=0.255816 metrics={'f1_val': 0.35401972899042067, 'auprc': 0.8333148094472562, 'loss_val': 0.8632379561705478, 'psi': 0.5457377611731549}-{'f1_val': 0.3918628032171344, 'auprc': 0.6267676316149071, 'loss_val': 0.9822861494293426, 'psi': 0.48582473457624353}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.561)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:45902
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.442)
[S5] not sending this round → trigger blocked (psi=0.380)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[S7] not sending this round → trigger blocked (psi=0.401)
[S4] not sending this round → trigger blocked (psi=0.666)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:45903
[S10] not sending this round → trigger blocked (psi=0.554)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[S9] not sending this round → trigger blocked (psi=0.582)
[S8] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=-0.1329
[S17] DROPPED delta from S6 (cos=-0.1329 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S2
[S17] cosine check vs S2: cos=0.0309
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=-0.0212
[S3] DROPPED delta from S8 (cos=-0.0212 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=-0.0567
[S2] DROPPED delta from S13 (cos=-0.0567 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.546)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.3540 head_norm=1.376759
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.466060e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.3540 head_norm=0.872092 delta_norm=0.846606
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.029129 cos_to_last_merge=0.9381 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=5 local utility u=0.004180 metrics={'f1_val': 0.71440632887503, 'auprc': 0.7775947689562425, 'loss_val': 0.8278316128096922, 'psi': 0.739681704907515}-{'f1_val': 0.7136054873907623, 'auprc': 0.777097088951735, 'loss_val': 0.829893002328372, 'psi': 0.7390021280151514}
[S3] START round=5 head_norm_before_train=0.909900 cos_to_last_merge=0.9768 (last merge round=1)
[S3] round=5 local utility u=0.170334 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9934103273025221, 'loss_val': 1.2276405424024603, 'psi': 0.4812681702894731}-{'f1_val': 0.13984006561410703, 'auprc': 0.8953968446948504, 'loss_val': 1.2742671785106003, 'psi': 0.4420627772464044}
[S4] START round=5 head_norm_before_train=0.899792 cos_to_last_merge=0.9895 (last merge round=3)
[S4] round=5 local utility u=0.032733 metrics={'f1_val': 0.6665166828891429, 'auprc': 0.6522731615520162, 'loss_val': 0.7245503683655659, 'psi': 0.6608192743542922}-{'f1_val': 0.6716804702939992, 'auprc': 0.6563213999669648, 'loss_val': 0.8331431569930502, 'psi': 0.6655368421631855}
[S5] START round=5 head_norm_before_train=1.259556 (no previous merge yet)
[S5] round=5 local utility u=0.087545 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700837962415651, 'loss_val': 1.1181511580711896, 'psi': 0.39339066135376893}-{'f1_val': 0.14226190476190476, 'auprc': 0.7355185541621563, 'loss_val': 1.1895445404194949, 'psi': 0.3795645645220054}
[S6] START round=5 head_norm_before_train=1.390695 (no previous merge yet)
[S6] round=5 local utility u=0.052536 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.8649706234695548, 'loss_val': 0.6716062108644388, 'psi': 0.5962216721123423}-{'f1_val': 0.4168551858772006, 'auprc': 0.8653023093877713, 'loss_val': 0.7764702154252454, 'psi': 0.5962340352814289}
[S7] START round=5 head_norm_before_train=0.905553 cos_to_last_merge=0.9732 (last merge round=1)
[S7] round=5 local utility u=0.014369 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.790760813543331, 'loss_val': 1.2459891271538157, 'psi': 0.40153841905478743}-{'f1_val': 0.14205682272909165, 'auprc': 0.7889818069340103, 'loss_val': 1.2693891302225462, 'psi': 0.40082681641105916}
[S8] START round=5 head_norm_before_train=1.085514 cos_to_last_merge=0.9950 (last merge round=3)
[S8] round=5 local utility u=0.444633 metrics={'f1_val': 0.713566645372378, 'auprc': 0.9858249255311733, 'loss_val': 0.5746712810015102, 'psi': 0.8224699574358961}-{'f1_val': 0.700261118104443, 'auprc': 0.7941031723007042, 'loss_val': 0.8089385663253862, 'psi': 0.7377979397829475}
[S9] START round=5 head_norm_before_train=1.327758 (no previous merge yet)
[S9] round=5 local utility u=0.428449 metrics={'f1_val': 0.4173779042200095, 'auprc': 0.9837423576755691, 'loss_val': 0.7587056359690303, 'psi': 0.6439236856022333}-{'f1_val': 0.31624937643096274, 'auprc': 0.9813432693423194, 'loss_val': 1.0016345484948987, 'psi': 0.5822869335955054}
[S10] START round=5 head_norm_before_train=1.048760 cos_to_last_merge=0.9698 (last merge round=2)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.7001085408329333, 'auprc': 0.991136452088933, 'loss_val': 0.5220406976041054, 'psi': 0.8165197053353332}-{'f1_val': 0.392779320519141, 'auprc': 0.7969388526944001, 'loss_val': 0.8043556820719615, 'psi': 0.5544431333892447}
[S11] START round=5 head_norm_before_train=0.940233 cos_to_last_merge=0.9712 (last merge round=1)
[S11] round=5 local utility u=0.051029 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.598538599811592, 'loss_val': 1.0898200112508813, 'psi': 0.32366364994850316}-{'f1_val': 0.14041368337311058, 'auprc': 0.5985121482789577, 'loss_val': 1.191798606055086, 'psi': 0.32365306933544946}
[S13] START round=5 head_norm_before_train=1.386922 (no previous merge yet)
[S13] round=5 local utility u=1.000000 metrics={'f1_val': 0.7130285068586637, 'auprc': 0.771667966689532, 'loss_val': 0.7097114713835359, 'psi': 0.736484290791011}-{'f1_val': 0.4160038662657951, 'auprc': 0.6501763834729933, 'loss_val': 0.9133069266362416, 'psi': 0.5096728731486744}
[S14] START round=5 head_norm_before_train=0.853026 cos_to_last_merge=0.9975 (last merge round=3)
[S14] round=5 local utility u=0.049095 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8137102187506975, 'loss_val': 1.2305046287313508, 'psi': 0.40969879922990127}-{'f1_val': 0.14035785288270378, 'auprc': 0.7992202575794084, 'loss_val': 1.2852241810795786, 'psi': 0.4039028147613856}
[S15] START round=5 head_norm_before_train=1.050426 cos_to_last_merge=0.9834 (last merge round=2)
[S15] round=5 local utility u=1.000000 metrics={'f1_val': 0.6963617605487296, 'auprc': 0.8008368921625277, 'loss_val': 0.7067576635435178, 'psi': 0.7381518131942488}-{'f1_val': 0.4163758395072774, 'auprc': 0.7788713944400173, 'loss_val': 0.994574101676202, 'psi': 0.5613740614803734}
[S16] START round=5 head_norm_before_train=0.839135 cos_to_last_merge=0.9962 (last merge round=3)
[S16] round=5 local utility u=0.846714 metrics={'f1_val': 0.41578581449487184, 'auprc': 0.5648111494150925, 'loss_val': 1.0428680729249387, 'psi': 0.47539594846296007}-{'f1_val': 0.14063745019920318, 'auprc': 0.5950380919312661, 'loss_val': 1.1760876841609926, 'psi': 0.3223977068920284}
[S17] START round=5 head_norm_before_train=0.872092 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.7867275357983539, 'loss_val': 0.9038182469332294, 'psi': 0.5263306280661573}-{'f1_val': 0.35401972899042067, 'auprc': 0.8333148094472562, 'loss_val': 0.8632379561705478, 'psi': 0.5457377611731549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:45904
[S6] not sending this round → trigger blocked (psi=0.596)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:45916
[S13] not sending this round → trigger blocked (psi=0.736)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[S2] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:45912
[S8] not sending this round → trigger blocked (psi=0.822)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S11] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.4977
[S14] RECEIVED delta(kind=head bytes=1787) from S4
[S14] cosine check vs S4: cos=0.3634
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=-0.0245
[S13] DROPPED delta from S15 (cos=-0.0245 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.0015
[S17] RECEIVED delta(kind=head bytes=1790) from S3
[S17] cosine check vs S3: cos=-0.0380
[S17] DROPPED delta from S3 (cos=-0.0380 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S10
[S8] cosine check vs S10: cos=0.7703
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=-0.0359
[S11] DROPPED delta from S14 (cos=-0.0359 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S16
[S15] cosine check vs S16: cos=0.0130
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.3315
[S16] RECEIVED delta(kind=head bytes=1794) from S9
[S16] cosine check vs S9: cos=0.4448
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.682 → S2@127.0.0.1:45902
[S6] ⇄ pheromone p=0.479 → S17@127.0.0.1:45917
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.7136 head_norm=1.157723
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.885366e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.7009 head_norm=1.078088 delta_norm=0.388537
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.668 → S3@127.0.0.1:45903
[S2] ⇄ pheromone p=0.607 → S17@127.0.0.1:45917
[S11] ⇄ pheromone p=0.338 → S16@127.0.0.1:45916
[S9] ⇄ pheromone p=0.558 → S16@127.0.0.1:45916
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.6665 head_norm=1.003712
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.845806e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.6659 head_norm=0.834962 delta_norm=0.484581
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.496 → S14@127.0.0.1:45914
[S5] ⇄ pheromone p=0.368 → S16@127.0.0.1:45916
[S10] ⇄ pheromone p=0.700 → S8@127.0.0.1:45909
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.895245
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.375300e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.784546 delta_norm=0.537530
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.406 → S11@127.0.0.1:45912
[S7] ⇄ pheromone p=0.386 → S4@127.0.0.1:45904
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.4158 head_norm=0.889402
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.281058e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.3744 head_norm=0.673472 delta_norm=0.428106
[S16] aggregate: ROLLBACK (f1_val pre=0.416 post=0.374 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.523 → S15@127.0.0.1:45915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.6964 head_norm=1.131046
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.148643e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.6896 head_norm=0.723961 delta_norm=0.714864
[S15] aggregate: ROLLBACK (f1_val pre=0.696 post=0.690 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.721 → S13@127.0.0.1:45913
[S3] ⇄ pheromone p=0.457 → S17@127.0.0.1:45917
[S17] ⇄ pheromone p=0.546 → S14@127.0.0.1:45914
[S2] START round=6 head_norm_before_train=1.112247 cos_to_last_merge=0.9078 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.908
[S2] round=6 local utility u=0.065107 metrics={'f1_val': 0.7134749010502567, 'auprc': 0.7762106834044579, 'loss_val': 0.6878771963240725, 'psi': 0.7385692139919372}-{'f1_val': 0.71440632887503, 'auprc': 0.7775947689562425, 'loss_val': 0.8278316128096922, 'psi': 0.739681704907515}
[S3] START round=6 head_norm_before_train=0.947522 cos_to_last_merge=0.9645 (last merge round=1)
[S3] round=6 local utility u=0.044280 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9954795141612631, 'loss_val': 1.1452871344144435, 'psi': 0.48209584503296954}-{'f1_val': 0.13984006561410703, 'auprc': 0.9934103273025221, 'loss_val': 1.2276405424024603, 'psi': 0.4812681702894731}
[S4] START round=6 head_norm_before_train=0.834962 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.018773 metrics={'f1_val': 0.6687890930706538, 'auprc': 0.6522705050048474, 'loss_val': 0.7006309533414817, 'psi': 0.6621816578443313}-{'f1_val': 0.6665166828891429, 'auprc': 0.6522731615520162, 'loss_val': 0.7245503683655659, 'psi': 0.6608192743542922}
[S5] START round=6 head_norm_before_train=1.279111 (no previous merge yet)
[S5] round=6 local utility u=0.879234 metrics={'f1_val': 0.41762836061839237, 'auprc': 0.7733473484302235, 'loss_val': 1.0216728226664968, 'psi': 0.5599159557431248}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700837962415651, 'loss_val': 1.1181511580711896, 'psi': 0.39339066135376893}
[S6] START round=6 head_norm_before_train=1.451642 (no previous merge yet)
[S6] round=6 local utility u=0.167094 metrics={'f1_val': 0.4156048545746194, 'auprc': 0.9456101225245368, 'loss_val': 0.5706308206934515, 'psi': 0.6276069617545863}-{'f1_val': 0.41705570454086727, 'auprc': 0.8649706234695548, 'loss_val': 0.6716062108644388, 'psi': 0.5962216721123423}
[S7] START round=6 head_norm_before_train=0.925484 cos_to_last_merge=0.9634 (last merge round=1)
[S7] round=6 local utility u=0.024907 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7944354792378358, 'loss_val': 1.2071981891166583, 'psi': 0.4030082853325893}-{'f1_val': 0.14205682272909165, 'auprc': 0.790760813543331, 'loss_val': 1.2459891271538157, 'psi': 0.40153841905478743}
[S8] START round=6 head_norm_before_train=1.078088 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.090962 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9991545626906562, 'loss_val': 0.43427335234252545, 'psi': 0.8279555920666185}-{'f1_val': 0.713566645372378, 'auprc': 0.9858249255311733, 'loss_val': 0.5746712810015102, 'psi': 0.8224699574358961}
[S9] START round=6 head_norm_before_train=1.377855 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7018630368647369, 'auprc': 0.9983804559305768, 'loss_val': 0.4957786279072569, 'psi': 0.8204700044910729}-{'f1_val': 0.4173779042200095, 'auprc': 0.9837423576755691, 'loss_val': 0.7587056359690303, 'psi': 0.6439236856022333}
[S10] START round=6 head_norm_before_train=1.134083 cos_to_last_merge=0.9433 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=6 local utility u=0.084466 metrics={'f1_val': 0.6990603157643015, 'auprc': 0.9976666830056633, 'loss_val': 0.3664100326993675, 'psi': 0.8185028626608463}-{'f1_val': 0.7001085408329333, 'auprc': 0.991136452088933, 'loss_val': 0.5220406976041054, 'psi': 0.8165197053353332}
[S11] START round=6 head_norm_before_train=0.974374 cos_to_last_merge=0.9555 (last merge round=1)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.4150663577634667, 'auprc': 0.7081576047474762, 'loss_val': 0.9568861821659862, 'psi': 0.5323028565570704}-{'f1_val': 0.14041368337311058, 'auprc': 0.598538599811592, 'loss_val': 1.0898200112508813, 'psi': 0.32366364994850316}
[S13] START round=6 head_norm_before_train=1.440109 (no previous merge yet)
[S13] round=6 local utility u=0.030521 metrics={'f1_val': 0.7135150731518334, 'auprc': 0.7388253168579145, 'loss_val': 0.5530618035926178, 'psi': 0.7236391706342657}-{'f1_val': 0.7130285068586637, 'auprc': 0.771667966689532, 'loss_val': 0.7097114713835359, 'psi': 0.736484290791011}
[S14] START round=6 head_norm_before_train=0.784546 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.095039 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.8662848949017705, 'loss_val': 1.1983183294698572, 'psi': 0.43074541550694007}-{'f1_val': 0.14035785288270378, 'auprc': 0.8137102187506975, 'loss_val': 1.2305046287313508, 'psi': 0.40969879922990127}
[S15] START round=6 head_norm_before_train=0.723961 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.038764 metrics={'f1_val': 0.6987463079293345, 'auprc': 0.7998377603559923, 'loss_val': 0.6405390057358394, 'psi': 0.7391828888999976}-{'f1_val': 0.6963617605487296, 'auprc': 0.8008368921625277, 'loss_val': 0.7067576635435178, 'psi': 0.7381518131942488}
[S16] START round=6 head_norm_before_train=0.673472 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.420172100334391, 'auprc': 0.5571154250417771, 'loss_val': 1.0463260627103355, 'psi': 0.4749494302173455}-{'f1_val': 0.41578581449487184, 'auprc': 0.5648111494150925, 'loss_val': 1.0428680729249387, 'psi': 0.47539594846296007}
[S17] START round=6 head_norm_before_train=0.951849 cos_to_last_merge=0.9889 (last merge round=4)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35362440232110137, 'auprc': 0.7507806908993567, 'loss_val': 0.8859854472112629, 'psi': 0.5124869177524035}-{'f1_val': 0.35273268957802617, 'auprc': 0.7867275357983539, 'loss_val': 0.9038182469332294, 'psi': 0.5263306280661573}
[S14] not sending this round → trigger blocked (psi=0.431)
[S3] not sending this round → trigger blocked (psi=0.482)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[S4] not sending this round → trigger blocked (psi=0.662)
[S9] not sending this round → trigger blocked (psi=0.820)
[S11] not sending this round → trigger blocked (psi=0.532)
[S5] not sending this round → trigger blocked (psi=0.560)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:45902
[S15] not sending this round → trigger blocked (psi=0.739)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[S7] not sending this round → trigger blocked (psi=0.403)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:45903
[S13] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.0075
[S2] RECEIVED delta(kind=head bytes=1803) from S13
[S2] cosine check vs S13: cos=-0.0433
[S2] DROPPED delta from S13 (cos=-0.0433 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=-0.1045
[S17] DROPPED delta from S6 (cos=-0.1045 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S2
[S17] cosine check vs S2: cos=0.5050
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.1398 head_norm=0.986377
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.569056e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.4010 head_norm=0.762506 delta_norm=0.756906
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3536 head_norm=1.034776
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.584689e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3536 head_norm=0.967156 delta_norm=0.558469
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.193228 cos_to_last_merge=0.8840 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.884
[S2] round=7 local utility u=0.077135 metrics={'f1_val': 0.7118383117719772, 'auprc': 0.7747140364168594, 'loss_val': 0.5192984139570787, 'psi': 0.7369886016299301}-{'f1_val': 0.7134749010502567, 'auprc': 0.7762106834044579, 'loss_val': 0.6878771963240725, 'psi': 0.7385692139919372}
[S3] START round=7 head_norm_before_train=0.762506 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.482728 metrics={'f1_val': 0.39642092198300777, 'auprc': 0.8006622319998448, 'loss_val': 1.134864349107249, 'psi': 0.5581174459897426}-{'f1_val': 0.13984006561410703, 'auprc': 0.9954795141612631, 'loss_val': 1.1452871344144435, 'psi': 0.48209584503296954}
[S4] START round=7 head_norm_before_train=0.923715 cos_to_last_merge=0.9884 (last merge round=5)
[S4] round=7 local utility u=0.046231 metrics={'f1_val': 0.6660701044069413, 'auprc': 0.652654077641331, 'loss_val': 0.5930060203847977, 'psi': 0.6607036937006971}-{'f1_val': 0.6687890930706538, 'auprc': 0.6522705050048474, 'loss_val': 0.7006309533414817, 'psi': 0.6621816578443313}
[S5] START round=7 head_norm_before_train=1.300886 (no previous merge yet)
[S5] round=7 local utility u=0.704514 metrics={'f1_val': 0.6256275734038489, 'auprc': 0.777783923692499, 'loss_val': 0.8739503473773707, 'psi': 0.6864901135193089}-{'f1_val': 0.41762836061839237, 'auprc': 0.7733473484302235, 'loss_val': 1.0216728226664968, 'psi': 0.5599159557431248}
[S6] START round=7 head_norm_before_train=1.504984 (no previous merge yet)
[S6] round=7 local utility u=0.737330 metrics={'f1_val': 0.7083940039529393, 'auprc': 0.8059396970533027, 'loss_val': 0.43369388909717493, 'psi': 0.7474122811930847}-{'f1_val': 0.4156048545746194, 'auprc': 0.9456101225245368, 'loss_val': 0.5706308206934515, 'psi': 0.6276069617545863}
[S7] START round=7 head_norm_before_train=0.948433 cos_to_last_merge=0.9546 (last merge round=1)
[S7] round=7 local utility u=0.035122 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7950147616158102, 'loss_val': 1.1386922527599195, 'psi': 0.4032399982837791}-{'f1_val': 0.14205682272909165, 'auprc': 0.7944354792378358, 'loss_val': 1.2071981891166583, 'psi': 0.4030082853325893}
[S8] START round=7 head_norm_before_train=1.155726 cos_to_last_merge=0.9943 (last merge round=5)
[S8] round=7 local utility u=0.043995 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9985777828218737, 'loss_val': 0.3453288496432417, 'psi': 0.8278024137691369}-{'f1_val': 0.7138229449839267, 'auprc': 0.9991545626906562, 'loss_val': 0.43427335234252545, 'psi': 0.8279555920666185}
[S9] START round=7 head_norm_before_train=1.433854 (no previous merge yet)
[S9] round=7 local utility u=0.007312 metrics={'f1_val': 0.6882985363249039, 'auprc': 0.998460099384551, 'loss_val': 0.4000062699250808, 'psi': 0.8123631615487628}-{'f1_val': 0.7018630368647369, 'auprc': 0.9983804559305768, 'loss_val': 0.4957786279072569, 'psi': 0.8204700044910729}
[S10] START round=7 head_norm_before_train=1.228942 cos_to_last_merge=0.9179 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.576178010799011, 'auprc': 0.9009411607651037, 'loss_val': 0.3975561062693641, 'psi': 0.7060832707854481}-{'f1_val': 0.6990603157643015, 'auprc': 0.9976666830056633, 'loss_val': 0.3664100326993675, 'psi': 0.8185028626608463}
[S11] START round=7 head_norm_before_train=1.015966 cos_to_last_merge=0.9365 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=7 local utility u=0.436669 metrics={'f1_val': 0.393953253332651, 'auprc': 0.9967333333857531, 'loss_val': 0.8225960851953629, 'psi': 0.6350652853538918}-{'f1_val': 0.4150663577634667, 'auprc': 0.7081576047474762, 'loss_val': 0.9568861821659862, 'psi': 0.5323028565570704}
[S13] START round=7 head_norm_before_train=1.491017 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.5713632027132214, 'auprc': 0.7404607901448375, 'loss_val': 0.6494838408988347, 'psi': 0.6390022376858678}-{'f1_val': 0.7135150731518334, 'auprc': 0.7388253168579145, 'loss_val': 0.5530618035926178, 'psi': 0.7236391706342657}
[S14] START round=7 head_norm_before_train=0.819357 cos_to_last_merge=0.9961 (last merge round=5)
[S14] round=7 local utility u=0.139146 metrics={'f1_val': 0.1469914636685405, 'auprc': 0.8992729012890757, 'loss_val': 1.058625269248617, 'psi': 0.44790403871675455}-{'f1_val': 0.1403857625770531, 'auprc': 0.8662848949017705, 'loss_val': 1.1983183294698572, 'psi': 0.43074541550694007}
[S15] START round=7 head_norm_before_train=0.810231 cos_to_last_merge=0.9828 (last merge round=5)
[S15] round=7 local utility u=0.231569 metrics={'f1_val': 0.700089774528956, 'auprc': 0.8888260025546006, 'loss_val': 0.45242690800846214, 'psi': 0.7755842657392139}-{'f1_val': 0.6987463079293345, 'auprc': 0.7998377603559923, 'loss_val': 0.6405390057358394, 'psi': 0.7391828888999976}
[S16] START round=7 head_norm_before_train=0.715495 cos_to_last_merge=0.9923 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.3857402251585393, 'auprc': 0.5374828221882715, 'loss_val': 0.9704149982264585, 'psi': 0.44643726397043215}-{'f1_val': 0.420172100334391, 'auprc': 0.5571154250417771, 'loss_val': 1.0463260627103355, 'psi': 0.4749494302173455}
[S17] START round=7 head_norm_before_train=0.967156 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.35362440232110137, 'auprc': 0.6632086038087878, 'loss_val': 0.9131825224314163, 'psi': 0.477458082916176}-{'f1_val': 0.35362440232110137, 'auprc': 0.7507806908993567, 'loss_val': 0.8859854472112629, 'psi': 0.5124869177524035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S11
[S16] cosine check vs S11: cos=0.2723
[S11] RECEIVED delta(kind=head bytes=1791) from S14
[S11] cosine check vs S14: cos=-0.0085
[S11] DROPPED delta from S14 (cos=-0.0085 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=-0.0321
[S13] DROPPED delta from S15 (cos=-0.0321 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.7176
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.0141
[S17] RECEIVED delta(kind=head bytes=1796) from S2
[S17] cosine check vs S2: cos=0.8286
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=-0.0482
[S17] DROPPED delta from S6 (cos=-0.0482 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.5333
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.6732
[S4] RECEIVED delta(kind=head bytes=1796) from S7
[S4] cosine check vs S7: cos=0.7223
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.4543
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6661 head_norm=1.024090
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.737309e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6660 head_norm=0.929295 delta_norm=0.373731
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3964 head_norm=0.795390
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.346709e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.1511 head_norm=0.947212 delta_norm=0.434671
[S3] aggregate: ROLLBACK (f1_val pre=0.396 post=0.151 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1470 head_norm=0.865074
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.886650e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.2180 head_norm=0.864579 delta_norm=0.388665
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.3857 head_norm=0.771559
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.933500e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4370 head_norm=0.704284 delta_norm=0.293350
[S16] aggregate: ACCEPT kept=['S11', 'S9', 'S5'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3536 head_norm=1.032869
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.599212e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3536 head_norm=0.822789 delta_norm=0.359921
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.265746 cos_to_last_merge=0.8669 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.867
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7125400858081723, 'auprc': 0.7756701601204432, 'loss_val': 0.5328454566046216, 'psi': 0.7377921155330807}-{'f1_val': 0.7118383117719772, 'auprc': 0.7747140364168594, 'loss_val': 0.5192984139570787, 'psi': 0.7369886016299301}
[S3] START round=8 head_norm_before_train=0.947212 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.34064686037191483, 'auprc': 0.8017789157595469, 'loss_val': 1.0785007975674312, 'psi': 0.5250996825269676}-{'f1_val': 0.39642092198300777, 'auprc': 0.8006622319998448, 'loss_val': 1.134864349107249, 'psi': 0.5581174459897426}
[S4] START round=8 head_norm_before_train=0.929295 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.360663 metrics={'f1_val': 0.6649771653209526, 'auprc': 0.8909552679469408, 'loss_val': 0.5800256786433207, 'psi': 0.755368406371348}-{'f1_val': 0.6660701044069413, 'auprc': 0.652654077641331, 'loss_val': 0.5930060203847977, 'psi': 0.6607036937006971}
[S5] START round=8 head_norm_before_train=1.330930 (no previous merge yet)
[S5] round=8 local utility u=0.339802 metrics={'f1_val': 0.7152129867642342, 'auprc': 0.7776223554453364, 'loss_val': 0.7313734613850662, 'psi': 0.7401767342366752}-{'f1_val': 0.6256275734038489, 'auprc': 0.777783923692499, 'loss_val': 0.8739503473773707, 'psi': 0.6864901135193089}
[S6] START round=8 head_norm_before_train=1.559463 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.678971650233573, 'auprc': 0.7292841483271342, 'loss_val': 0.5200334259914685, 'psi': 0.6990966494709975}-{'f1_val': 0.7083940039529393, 'auprc': 0.8059396970533027, 'loss_val': 0.43369388909717493, 'psi': 0.7474122811930847}
[S7] START round=8 head_norm_before_train=0.978657 cos_to_last_merge=0.9447 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=8 local utility u=0.885157 metrics={'f1_val': 0.41748350776510673, 'auprc': 0.7943088681780073, 'loss_val': 1.0188205840245084, 'psi': 0.568213651930267}-{'f1_val': 0.14205682272909165, 'auprc': 0.7950147616158102, 'loss_val': 1.1386922527599195, 'psi': 0.4032399982837791}
[S8] START round=8 head_norm_before_train=1.240827 cos_to_last_merge=0.9826 (last merge round=5)
[S8] round=8 local utility u=0.047772 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9985990422065129, 'loss_val': 0.24984906850659672, 'psi': 0.8278109175229926}-{'f1_val': 0.7139521677339791, 'auprc': 0.9985777828218737, 'loss_val': 0.3453288496432417, 'psi': 0.8278024137691369}
[S9] START round=8 head_norm_before_train=1.488647 (no previous merge yet)
[S9] round=8 local utility u=0.081390 metrics={'f1_val': 0.7016130641860581, 'auprc': 0.9984530257209879, 'loss_val': 0.3170927541098577, 'psi': 0.82034904880003}-{'f1_val': 0.6882985363249039, 'auprc': 0.998460099384551, 'loss_val': 0.4000062699250808, 'psi': 0.8123631615487628}
[S10] START round=8 head_norm_before_train=1.303541 cos_to_last_merge=0.8977 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.898
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.9560171119733367, 'auprc': 0.9968202769263323, 'loss_val': 0.20051923447104383, 'psi': 0.9723383779545349}-{'f1_val': 0.576178010799011, 'auprc': 0.9009411607651037, 'loss_val': 0.3975561062693641, 'psi': 0.7060832707854481}
[S11] START round=8 head_norm_before_train=1.065054 cos_to_last_merge=0.9138 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.914
[S11] round=8 local utility u=0.059205 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.99777835932443, 'loss_val': 0.7431535814740514, 'psi': 0.6390665954112352}-{'f1_val': 0.393953253332651, 'auprc': 0.9967333333857531, 'loss_val': 0.8225960851953629, 'psi': 0.6350652853538918}
[S13] START round=8 head_norm_before_train=1.543301 (no previous merge yet)
[S13] round=8 local utility u=0.277137 metrics={'f1_val': 0.6671700002442096, 'auprc': 0.6760214670207957, 'loss_val': 0.4767317936251094, 'psi': 0.670710586954844}-{'f1_val': 0.5713632027132214, 'auprc': 0.7404607901448375, 'loss_val': 0.6494838408988347, 'psi': 0.6390022376858678}
[S14] START round=8 head_norm_before_train=0.864579 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.791655 metrics={'f1_val': 0.39893779124234596, 'auprc': 0.8974287619222794, 'loss_val': 0.9814606225372268, 'psi': 0.5983341795143193}-{'f1_val': 0.1469914636685405, 'auprc': 0.8992729012890757, 'loss_val': 1.058625269248617, 'psi': 0.44790403871675455}
[S15] START round=8 head_norm_before_train=0.932535 cos_to_last_merge=0.9506 (last merge round=5)
[S15] round=8 local utility u=0.055695 metrics={'f1_val': 0.6895361251940285, 'auprc': 0.9203049364591565, 'loss_val': 0.3721520537029256, 'psi': 0.7818436497000797}-{'f1_val': 0.700089774528956, 'auprc': 0.8888260025546006, 'loss_val': 0.45242690800846214, 'psi': 0.7755842657392139}
[S16] START round=8 head_norm_before_train=0.704284 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.413257 metrics={'f1_val': 0.4144829192530646, 'auprc': 0.7630107404994508, 'loss_val': 0.9929409340429807, 'psi': 0.5538940477516191}-{'f1_val': 0.3857402251585393, 'auprc': 0.5374828221882715, 'loss_val': 0.9704149982264585, 'psi': 0.44643726397043215}
[S17] START round=8 head_norm_before_train=0.822789 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.090586 metrics={'f1_val': 0.3592528761452201, 'auprc': 0.7138813161922806, 'loss_val': 0.9177995203444592, 'psi': 0.5011042521640443}-{'f1_val': 0.35362440232110137, 'auprc': 0.6632086038087878, 'loss_val': 0.9131825224314163, 'psi': 0.477458082916176}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:45912
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:45904
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[S7] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] cosine check vs S13: cos=-0.0270
[S2] DROPPED delta from S13 (cos=-0.0270 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S10
[S8] cosine check vs S10: cos=0.8305
[S4] RECEIVED delta(kind=head bytes=1795) from S7
[S4] cosine check vs S7: cos=0.8776
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.9271
[S13] RECEIVED delta(kind=head bytes=1794) from S15
[S13] cosine check vs S15: cos=-0.0224
[S13] DROPPED delta from S15 (cos=-0.0224 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.5870
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.5274
[S16] RECEIVED delta(kind=head bytes=1793) from S11
[S16] cosine check vs S11: cos=0.4532
[S11] RECEIVED delta(kind=head bytes=1790) from S14
[S11] cosine check vs S14: cos=0.0193
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] cosine check vs S16: cos=0.3685
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.8075
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.1354
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3406 head_norm=0.966821
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.734455e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.3331 head_norm=1.115956 delta_norm=0.273446
[S3] aggregate: ROLLBACK (f1_val pre=0.341 post=0.333 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6650 head_norm=1.012368
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.506361e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6207 head_norm=0.981688 delta_norm=0.250636
[S4] aggregate: ROLLBACK (f1_val pre=0.665 post=0.621 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3999 head_norm=1.116041
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.097493e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3999 head_norm=0.723295 delta_norm=0.709749
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7140 head_norm=1.305954
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.904810e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7140 head_norm=1.279473 delta_norm=0.390481
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.6895 head_norm=1.035491
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.153944e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.6884 head_norm=0.742846 delta_norm=0.515394
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3989 head_norm=0.899029
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.252205e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3940 head_norm=0.726396 delta_norm=0.325221
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4145 head_norm=0.750107
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.944708e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4339 head_norm=0.743487 delta_norm=0.194471
[S16] aggregate: ACCEPT kept=['S9', 'S5', 'S11'] (k=3/3) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.334491 cos_to_last_merge=0.8505 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.850
[S2] round=9 local utility u=0.026884 metrics={'f1_val': 0.7095200595313715, 'auprc': 0.7782755497489258, 'loss_val': 0.4687730790086853, 'psi': 0.7370222556183932}-{'f1_val': 0.7125400858081723, 'auprc': 0.7756701601204432, 'loss_val': 0.5328454566046216, 'psi': 0.7377921155330807}
[S3] START round=9 head_norm_before_train=1.115956 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.226353 metrics={'f1_val': 0.39638969140647473, 'auprc': 0.8016243613912818, 'loss_val': 0.9597875356243437, 'psi': 0.5584835594003976}-{'f1_val': 0.34064686037191483, 'auprc': 0.8017789157595469, 'loss_val': 1.0785007975674312, 'psi': 0.5250996825269676}
[S4] START round=9 head_norm_before_train=0.981688 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6283331345940032, 'auprc': 0.8546464579001621, 'loss_val': 0.5592085253686666, 'psi': 0.7188584639164668}-{'f1_val': 0.6649771653209526, 'auprc': 0.8909552679469408, 'loss_val': 0.5800256786433207, 'psi': 0.755368406371348}
[S5] START round=9 head_norm_before_train=1.365772 (no previous merge yet)
[S5] round=9 local utility u=0.061946 metrics={'f1_val': 0.7149202182934221, 'auprc': 0.777648895018874, 'loss_val': 0.6058052459298602, 'psi': 0.7400116889836029}-{'f1_val': 0.7152129867642342, 'auprc': 0.7776223554453364, 'loss_val': 0.7313734613850662, 'psi': 0.7401767342366752}
[S6] START round=9 head_norm_before_train=1.606305 (no previous merge yet)
[S6] round=9 local utility u=0.549901 metrics={'f1_val': 0.7064961668277819, 'auprc': 0.9672019455153877, 'loss_val': 0.29913255886726636, 'psi': 0.8107784783028242}-{'f1_val': 0.678971650233573, 'auprc': 0.7292841483271342, 'loss_val': 0.5200334259914685, 'psi': 0.6990966494709975}
[S7] START round=9 head_norm_before_train=1.013988 cos_to_last_merge=0.9338 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=9 local utility u=0.059129 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.7940260208677645, 'loss_val': 0.8977611657082765, 'psi': 0.5679052005061699}-{'f1_val': 0.41748350776510673, 'auprc': 0.7943088681780073, 'loss_val': 1.0188205840245084, 'psi': 0.568213651930267}
[S8] START round=9 head_norm_before_train=1.279473 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9991025264614171, 'loss_val': 0.30753672337663857, 'psi': 0.8281844738232643}-{'f1_val': 0.7139521677339791, 'auprc': 0.9985990422065129, 'loss_val': 0.24984906850659672, 'psi': 0.8278109175229926}
[S9] START round=9 head_norm_before_train=1.536550 (no previous merge yet)
[S9] round=9 local utility u=0.011356 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9983766098598632, 'loss_val': 0.2926508316482146, 'psi': 0.8201684111541891}-{'f1_val': 0.7016130641860581, 'auprc': 0.9984530257209879, 'loss_val': 0.3170927541098577, 'psi': 0.82034904880003}
[S10] START round=9 head_norm_before_train=1.368773 cos_to_last_merge=0.8837 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.884
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.8511850947083992, 'auprc': 0.987794459468669, 'loss_val': 0.21317393089125347, 'psi': 0.905828840612507}-{'f1_val': 0.9560171119733367, 'auprc': 0.9968202769263323, 'loss_val': 0.20051923447104383, 'psi': 0.9723383779545349}
[S11] START round=9 head_norm_before_train=0.723295 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.41152813021643125, 'auprc': 0.9868868219662208, 'loss_val': 0.7978325059649715, 'psi': 0.6416716069163471}-{'f1_val': 0.39992541946910537, 'auprc': 0.99777835932443, 'loss_val': 0.7431535814740514, 'psi': 0.6390665954112352}
[S13] START round=9 head_norm_before_train=1.577377 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6118316924803948, 'auprc': 0.6899808448635102, 'loss_val': 0.6043486677062772, 'psi': 0.6430913534336409}-{'f1_val': 0.6671700002442096, 'auprc': 0.6760214670207957, 'loss_val': 0.4767317936251094, 'psi': 0.670710586954844}
[S14] START round=9 head_norm_before_train=0.726396 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.055039 metrics={'f1_val': 0.4012782021821206, 'auprc': 0.897027524381758, 'loss_val': 0.8842217798766833, 'psi': 0.5995779310619755}-{'f1_val': 0.39893779124234596, 'auprc': 0.8974287619222794, 'loss_val': 0.9814606225372268, 'psi': 0.5983341795143193}
[S15] START round=9 head_norm_before_train=0.742846 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.7150574245540698, 'auprc': 0.7997965445107518, 'loss_val': 0.5417470513880485, 'psi': 0.7489530725367426}-{'f1_val': 0.6895361251940285, 'auprc': 0.9203049364591565, 'loss_val': 0.3721520537029256, 'psi': 0.7818436497000797}
[S16] START round=9 head_norm_before_train=0.743487 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.4365091031295064, 'auprc': 0.5479262636406281, 'loss_val': 1.1034388705150127, 'psi': 0.48107596733395513}-{'f1_val': 0.4144829192530646, 'auprc': 0.7630107404994508, 'loss_val': 0.9929409340429807, 'psi': 0.5538940477516191}
[S17] START round=9 head_norm_before_train=0.894275 cos_to_last_merge=0.9810 (last merge round=7)
[S17] round=9 local utility u=0.067099 metrics={'f1_val': 0.3883613387578853, 'auprc': 0.705488752432053, 'loss_val': 0.9330742883496458, 'psi': 0.5152123042275524}-{'f1_val': 0.3592528761452201, 'auprc': 0.7138813161922806, 'loss_val': 0.9177995203444592, 'psi': 0.5011042521640443}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.600)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.568)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.740)
[S9] not sending this round → trigger blocked (psi=0.820)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S3
[S17] cosine check vs S3: cos=0.2441
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.7519
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=-0.0472
[S17] DROPPED delta from S6 (cos=-0.0472 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.515)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3884 head_norm=0.974476
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.511223e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3530 head_norm=0.876141 delta_norm=0.351122
[S17] aggregate: ROLLBACK (f1_val pre=0.388 post=0.353 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.388969 cos_to_last_merge=0.8365 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.836
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.6992468487673049, 'auprc': 0.6560027937159361, 'loss_val': 0.39131668701244265, 'psi': 0.6819492267467574}-{'f1_val': 0.7095200595313715, 'auprc': 0.7782755497489258, 'loss_val': 0.4687730790086853, 'psi': 0.7370222556183932}
[S3] START round=10 head_norm_before_train=1.139074 cos_to_last_merge=0.9948 (last merge round=8)
[S3] round=10 local utility u=0.090995 metrics={'f1_val': 0.39635856801559805, 'auprc': 0.8134077420532856, 'loss_val': 0.8129608489008228, 'psi': 0.5631782376306731}-{'f1_val': 0.39638969140647473, 'auprc': 0.8016243613912818, 'loss_val': 0.9597875356243437, 'psi': 0.5584835594003976}
[S4] START round=10 head_norm_before_train=1.061401 cos_to_last_merge=0.9915 (last merge round=8)
[S4] round=10 local utility u=1.000000 metrics={'f1_val': 0.944458059749143, 'auprc': 0.9342744264900413, 'loss_val': 0.5082301585977326, 'psi': 0.9403846064455024}-{'f1_val': 0.6283331345940032, 'auprc': 0.8546464579001621, 'loss_val': 0.5592085253686666, 'psi': 0.7188584639164668}
[S5] START round=10 head_norm_before_train=1.403077 (no previous merge yet)
[S5] round=10 local utility u=0.314483 metrics={'f1_val': 0.7014484055483905, 'auprc': 0.9747749433380819, 'loss_val': 0.4873864498159923, 'psi': 0.8107790206642671}-{'f1_val': 0.7149202182934221, 'auprc': 0.777648895018874, 'loss_val': 0.6058052459298602, 'psi': 0.7400116889836029}
[S6] START round=10 head_norm_before_train=1.645494 (no previous merge yet)
[S6] round=10 local utility u=0.524776 metrics={'f1_val': 0.8949095814065771, 'auprc': 0.9544565168905913, 'loss_val': 0.34182420962997107, 'psi': 0.9187283556001827}-{'f1_val': 0.7064961668277819, 'auprc': 0.9672019455153877, 'loss_val': 0.29913255886726636, 'psi': 0.8107784783028242}
[S7] START round=10 head_norm_before_train=1.051541 cos_to_last_merge=0.9218 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=10 local utility u=0.844879 metrics={'f1_val': 0.6888905203009068, 'auprc': 0.7917765738989944, 'loss_val': 0.8316506755931463, 'psi': 0.7300449417401418}-{'f1_val': 0.4171579869317734, 'auprc': 0.7940260208677645, 'loss_val': 0.8977611657082765, 'psi': 0.5679052005061699}
[S8] START round=10 head_norm_before_train=1.336711 cos_to_last_merge=0.9982 (last merge round=8)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9980164912377428, 'loss_val': 0.3551921114776721, 'psi': 0.8277500597337946}-{'f1_val': 0.7142391053978291, 'auprc': 0.9991025264614171, 'loss_val': 0.30753672337663857, 'psi': 0.8281844738232643}
[S9] START round=10 head_norm_before_train=1.574831 (no previous merge yet)
[S9] round=10 local utility u=0.006050 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9982738436713965, 'loss_val': 0.2802422881424037, 'psi': 0.8201273046788025}-{'f1_val': 0.7013629453504064, 'auprc': 0.9983766098598632, 'loss_val': 0.2926508316482146, 'psi': 0.8201684111541891}
[S10] START round=10 head_norm_before_train=1.413233 cos_to_last_merge=0.8744 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.874
[S10] round=10 local utility u=0.481550 metrics={'f1_val': 0.994371642699025, 'auprc': 0.9970220305347443, 'loss_val': 0.13687589850059836, 'psi': 0.9954317978333127}-{'f1_val': 0.8511850947083992, 'auprc': 0.987794459468669, 'loss_val': 0.21317393089125347, 'psi': 0.905828840612507}
[S11] START round=10 head_norm_before_train=0.772887 cos_to_last_merge=0.9946 (last merge round=8)
[S11] round=10 local utility u=0.762417 metrics={'f1_val': 0.6618918423988063, 'auprc': 0.9503911932472593, 'loss_val': 0.6656944649247015, 'psi': 0.7772915827381874}-{'f1_val': 0.41152813021643125, 'auprc': 0.9868868219662208, 'loss_val': 0.7978325059649715, 'psi': 0.6416716069163471}
[S13] START round=10 head_norm_before_train=1.602497 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5830205812290585, 'auprc': 0.6984876482137772, 'loss_val': 0.7209508337005174, 'psi': 0.629207408022946}-{'f1_val': 0.6118316924803948, 'auprc': 0.6899808448635102, 'loss_val': 0.6043486677062772, 'psi': 0.6430913534336409}
[S14] START round=10 head_norm_before_train=0.765419 cos_to_last_merge=0.9920 (last merge round=8)
[S14] round=10 local utility u=0.942484 metrics={'f1_val': 0.6393337202760452, 'auprc': 0.9880150447570932, 'loss_val': 0.7005485095853338, 'psi': 0.7788062500684645}-{'f1_val': 0.4012782021821206, 'auprc': 0.897027524381758, 'loss_val': 0.8842217798766833, 'psi': 0.5995779310619755}
[S15] START round=10 head_norm_before_train=0.851102 cos_to_last_merge=0.9896 (last merge round=8)
[S15] round=10 local utility u=0.001413 metrics={'f1_val': 0.7044377349318582, 'auprc': 0.7995611330360473, 'loss_val': 0.47449719011727526, 'psi': 0.7424870941735339}-{'f1_val': 0.7150574245540698, 'auprc': 0.7997965445107518, 'loss_val': 0.5417470513880485, 'psi': 0.7489530725367426}
[S16] START round=10 head_norm_before_train=0.783384 cos_to_last_merge=0.9915 (last merge round=8)
[S16] round=10 local utility u=0.411548 metrics={'f1_val': 0.5169893187347778, 'auprc': 0.5963093694358528, 'loss_val': 0.9083729746655564, 'psi': 0.5487173390152078}-{'f1_val': 0.4365091031295064, 'auprc': 0.5479262636406281, 'loss_val': 1.1034388705150127, 'psi': 0.48107596733395513}
[S17] START round=10 head_norm_before_train=0.876141 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35598831479273185, 'auprc': 0.7434135343330087, 'loss_val': 0.9284061851364155, 'psi': 0.5109584026088426}-{'f1_val': 0.3883613387578853, 'auprc': 0.705488752432053, 'loss_val': 0.9330742883496458, 'psi': 0.5152123042275524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:45912
[S6] not sending this round → trigger blocked (psi=0.919)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:45914
[S3] not sending this round → trigger blocked (psi=0.563)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:45913
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.8938
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.7296
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=0.4530
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.5237
[S13] RECEIVED delta(kind=head bytes=1798) from S15
[S13] cosine check vs S15: cos=-0.0401
[S13] DROPPED delta from S15 (cos=-0.0401 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.5130
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] cosine check vs S16: cos=0.6116
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.5821
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] cosine check vs S10: cos=0.9240
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.216 → S17@127.0.0.1:45917
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7142 head_norm=1.402246
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.784308e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.7142 head_norm=1.396811 delta_norm=0.278431
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.237 → S3@127.0.0.1:45903
[S3] ⇄ pheromone p=0.257 → S17@127.0.0.1:45917
[S6] ⇄ pheromone p=0.439 → S17@127.0.0.1:45917
[S13] ⇄ pheromone p=0.262 → S2@127.0.0.1:45902
[S7] ⇄ pheromone p=0.424 → S4@127.0.0.1:45904
[S9] ⇄ pheromone p=0.279 → S16@127.0.0.1:45916
[S5] ⇄ pheromone p=0.381 → S16@127.0.0.1:45916
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.6619 head_norm=0.838404
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.092139e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6157 head_norm=0.721179 delta_norm=0.409214
[S11] aggregate: ROLLBACK (f1_val pre=0.662 post=0.616 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.398 → S16@127.0.0.1:45916
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6393 head_norm=0.819872
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.903809e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.8013 head_norm=0.913867 delta_norm=0.390381
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.454 → S11@127.0.0.1:45912
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.5170 head_norm=0.829505
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.176946e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.5446 head_norm=0.752823 delta_norm=0.217695
[S16] aggregate: ACCEPT kept=['S11', 'S5', 'S9'] (k=3/3) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.307 → S15@127.0.0.1:45915
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.9445 head_norm=1.141451
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.579941e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6179 head_norm=1.083580 delta_norm=0.257994
[S4] aggregate: ROLLBACK (f1_val pre=0.944 post=0.618 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.415 → S14@127.0.0.1:45914
[S10] ⇄ pheromone p=0.460 → S8@127.0.0.1:45909
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7044 head_norm=0.966736
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.005545e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7035 head_norm=0.806774 delta_norm=0.400555
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.270 → S13@127.0.0.1:45913
[S17] ⇄ pheromone p=0.201 → S14@127.0.0.1:45914
[S2] START round=11 head_norm_before_train=1.435092 cos_to_last_merge=0.8264 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.826
[S2] round=11 local utility u=0.010470 metrics={'f1_val': 0.6992497273755923, 'auprc': 0.6574791067927328, 'loss_val': 0.37482282993888877, 'psi': 0.6825414791424484}-{'f1_val': 0.6992468487673049, 'auprc': 0.6560027937159361, 'loss_val': 0.39131668701244265, 'psi': 0.6819492267467574}
[S3] START round=11 head_norm_before_train=1.179094 cos_to_last_merge=0.9808 (last merge round=8)
[S3] round=11 local utility u=0.276517 metrics={'f1_val': 0.39642092198300777, 'auprc': 0.9658120128661789, 'loss_val': 0.7175145313119334, 'psi': 0.6241773583362762}-{'f1_val': 0.39635856801559805, 'auprc': 0.8134077420532856, 'loss_val': 0.8129608489008228, 'psi': 0.5631782376306731}
[S4] START round=11 head_norm_before_train=1.083580 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6640572677349403, 'auprc': 0.9471750983565608, 'loss_val': 0.5034638281919617, 'psi': 0.7773043999835885}-{'f1_val': 0.944458059749143, 'auprc': 0.9342744264900413, 'loss_val': 0.5082301585977326, 'psi': 0.9403846064455024}
[S5] START round=11 head_norm_before_train=1.442798 (no previous merge yet)
[S5] round=11 local utility u=0.069655 metrics={'f1_val': 0.7011041183246911, 'auprc': 0.9980148151657936, 'loss_val': 0.41572983459150853, 'psi': 0.819868397061132}-{'f1_val': 0.7014484055483905, 'auprc': 0.9747749433380819, 'loss_val': 0.4873864498159923, 'psi': 0.8107790206642671}
[S6] START round=11 head_norm_before_train=1.668518 (no previous merge yet)
[S6] round=11 local utility u=0.245427 metrics={'f1_val': 0.9581546269657426, 'auprc': 0.957422530894066, 'loss_val': 0.23933787292503275, 'psi': 0.9578617885370719}-{'f1_val': 0.8949095814065771, 'auprc': 0.9544565168905913, 'loss_val': 0.34182420962997107, 'psi': 0.9187283556001827}
[S7] START round=11 head_norm_before_train=1.085589 cos_to_last_merge=0.9091 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.621894895988028, 'auprc': 0.7899056008302838, 'loss_val': 0.7855694104724698, 'psi': 0.6890991779249304}-{'f1_val': 0.6888905203009068, 'auprc': 0.7917765738989944, 'loss_val': 0.8316506755931463, 'psi': 0.7300449417401418}
[S8] START round=11 head_norm_before_train=1.396811 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.937040 metrics={'f1_val': 0.993675047592855, 'auprc': 0.9990460253712542, 'loss_val': 0.16081540344519415, 'psi': 0.9958234387042146}-{'f1_val': 0.7142391053978291, 'auprc': 0.9980164912377428, 'loss_val': 0.3551921114776721, 'psi': 0.8277500597337946}
[S9] START round=11 head_norm_before_train=1.609230 (no previous merge yet)
[S9] round=11 local utility u=0.003736 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9982723186627899, 'loss_val': 0.272756622886217, 'psi': 0.8201257431722034}-{'f1_val': 0.7013629453504064, 'auprc': 0.9982738436713965, 'loss_val': 0.2802422881424037, 'psi': 0.8201273046788025}
[S10] START round=11 head_norm_before_train=1.445999 cos_to_last_merge=0.8681 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.868
[S10] round=11 local utility u=0.020548 metrics={'f1_val': 0.994512139992592, 'auprc': 0.9966441986359956, 'loss_val': 0.09548913036184707, 'psi': 0.9953649634499535}-{'f1_val': 0.994371642699025, 'auprc': 0.9970220305347443, 'loss_val': 0.13687589850059836, 'psi': 0.9954317978333127}
[S11] START round=11 head_norm_before_train=0.721179 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.087847 metrics={'f1_val': 0.7015826949324591, 'auprc': 0.9437058654085145, 'loss_val': 0.7080903974479495, 'psi': 0.7984319631228812}-{'f1_val': 0.6618918423988063, 'auprc': 0.9503911932472593, 'loss_val': 0.6656944649247015, 'psi': 0.7772915827381874}
[S13] START round=11 head_norm_before_train=1.620300 (no previous merge yet)
[S13] round=11 local utility u=0.125541 metrics={'f1_val': 0.6161591132548352, 'auprc': 0.6844300537782865, 'loss_val': 0.626526873947506, 'psi': 0.6434674894642156}-{'f1_val': 0.5830205812290585, 'auprc': 0.6984876482137772, 'loss_val': 0.7209508337005174, 'psi': 0.629207408022946}
[S14] START round=11 head_norm_before_train=0.913867 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.709063 metrics={'f1_val': 0.8899163216021411, 'auprc': 0.957367888719441, 'loss_val': 0.6939760064578507, 'psi': 0.916896948449061}-{'f1_val': 0.6393337202760452, 'auprc': 0.9880150447570932, 'loss_val': 0.7005485095853338, 'psi': 0.7788062500684645}
[S15] START round=11 head_norm_before_train=0.806774 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=1.000000 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9972724550248077, 'loss_val': 0.33581959135853295, 'psi': 0.9971269394609109}-{'f1_val': 0.7044377349318582, 'auprc': 0.7995611330360473, 'loss_val': 0.47449719011727526, 'psi': 0.7424870941735339}
[S16] START round=11 head_norm_before_train=0.752823 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.4846954263677051, 'auprc': 0.6034836224080511, 'loss_val': 0.8765633290322558, 'psi': 0.5322107047838435}-{'f1_val': 0.5169893187347778, 'auprc': 0.5963093694358528, 'loss_val': 0.9083729746655564, 'psi': 0.5487173390152078}
[S17] START round=11 head_norm_before_train=0.936175 cos_to_last_merge=0.9915 (last merge round=9)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.35302995561043005, 'auprc': 0.6912373021030153, 'loss_val': 0.9455242099987557, 'psi': 0.48831289420746415}-{'f1_val': 0.35598831479273185, 'auprc': 0.7434135343330087, 'loss_val': 0.9284061851364155, 'psi': 0.5109584026088426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S5] not sending this round → trigger blocked (psi=0.820)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:45917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.798)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:45902
[S14] not sending this round → trigger blocked (psi=0.917)
[S15] not sending this round → trigger blocked (psi=0.997)
[S8] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=-0.0599
[S17] DROPPED delta from S6 (cos=-0.0599 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S2
[S17] cosine check vs S2: cos=0.7389
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] cosine check vs S3: cos=0.4308
[S2] RECEIVED delta(kind=head bytes=1806) from S13
[S2] cosine check vs S13: cos=-0.0148
[S2] DROPPED delta from S13 (cos=-0.0148 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1806) from S8
[S3] cosine check vs S8: cos=0.8498
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.3964 head_norm=1.219317
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.837294e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.3964 head_norm=1.286764 delta_norm=0.383729
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3530 head_norm=0.996386
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.821384e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3530 head_norm=0.939766 delta_norm=0.282138
[S17] aggregate: ACCEPT kept=['S2', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.472057 cos_to_last_merge=0.8213 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.821
[S2] round=12 local utility u=0.120770 metrics={'f1_val': 0.6994246754598581, 'auprc': 0.7318503281472848, 'loss_val': 0.35744702995759464, 'psi': 0.7123949365348288}-{'f1_val': 0.6992497273755923, 'auprc': 0.6574791067927328, 'loss_val': 0.37482282993888877, 'psi': 0.6825414791424484}
[S3] START round=12 head_norm_before_train=1.286764 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.049410 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.9956153764160695, 'loss_val': 0.7082925762762594, 'psi': 0.6361175064557003}-{'f1_val': 0.39642092198300777, 'auprc': 0.9658120128661789, 'loss_val': 0.7175145313119334, 'psi': 0.6241773583362762}
[S4] START round=12 head_norm_before_train=1.160229 cos_to_last_merge=0.9948 (last merge round=10)
[S4] round=12 local utility u=0.259415 metrics={'f1_val': 0.7433441837217141, 'auprc': 0.9511385324227566, 'loss_val': 0.47224543101751254, 'psi': 0.8264619232021311}-{'f1_val': 0.6640572677349403, 'auprc': 0.9471750983565608, 'loss_val': 0.5034638281919617, 'psi': 0.7773043999835885}
[S5] START round=12 head_norm_before_train=1.474385 (no previous merge yet)
[S5] round=12 local utility u=0.026616 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.9983431495204644, 'loss_val': 0.36199654935884645, 'psi': 0.8198510533441123}-{'f1_val': 0.7011041183246911, 'auprc': 0.9980148151657936, 'loss_val': 0.41572983459150853, 'psi': 0.819868397061132}
[S6] START round=12 head_norm_before_train=1.686943 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.8174596271147884, 'auprc': 0.8527366452433284, 'loss_val': 0.36583845026270734, 'psi': 0.8315704343662044}-{'f1_val': 0.9581546269657426, 'auprc': 0.957422530894066, 'loss_val': 0.23933787292503275, 'psi': 0.9578617885370719}
[S7] START round=12 head_norm_before_train=1.117141 cos_to_last_merge=0.8962 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.896
[S7] round=12 local utility u=0.289920 metrics={'f1_val': 0.7138802693288737, 'auprc': 0.7860699391439019, 'loss_val': 0.7461354997511173, 'psi': 0.742756137254885}-{'f1_val': 0.621894895988028, 'auprc': 0.7899056008302838, 'loss_val': 0.7855694104724698, 'psi': 0.6890991779249304}
[S8] START round=12 head_norm_before_train=1.455777 cos_to_last_merge=0.9982 (last merge round=10)
[S8] round=12 local utility u=0.017514 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9992216959082637, 'loss_val': 0.11731032547157691, 'psi': 0.9949932225813725}-{'f1_val': 0.993675047592855, 'auprc': 0.9990460253712542, 'loss_val': 0.16081540344519415, 'psi': 0.9958234387042146}
[S9] START round=12 head_norm_before_train=1.638357 (no previous merge yet)
[S9] round=12 local utility u=0.002635 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9982447541027794, 'loss_val': 0.2674034075055456, 'psi': 0.8201147173481993}-{'f1_val': 0.7013613595118124, 'auprc': 0.9982723186627899, 'loss_val': 0.272756622886217, 'psi': 0.8201257431722034}
[S10] START round=12 head_norm_before_train=1.480213 cos_to_last_merge=0.8638 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.864
[S10] round=12 local utility u=0.009764 metrics={'f1_val': 0.9951941773951698, 'auprc': 0.9946238168855576, 'loss_val': 0.07399261503584796, 'psi': 0.9949660331913249}-{'f1_val': 0.994512139992592, 'auprc': 0.9966441986359956, 'loss_val': 0.09548913036184707, 'psi': 0.9953649634499535}
[S11] START round=12 head_norm_before_train=0.776754 cos_to_last_merge=0.9918 (last merge round=10)
[S11] round=12 local utility u=0.064740 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.941416959451418, 'loss_val': 0.5728014845594389, 'psi': 0.797622146777446}-{'f1_val': 0.7015826949324591, 'auprc': 0.9437058654085145, 'loss_val': 0.7080903974479495, 'psi': 0.7984319631228812}
[S13] START round=12 head_norm_before_train=1.642426 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5820021911678346, 'auprc': 0.6900575178363385, 'loss_val': 0.8075290540007013, 'psi': 0.6252243218352362}-{'f1_val': 0.6161591132548352, 'auprc': 0.6844300537782865, 'loss_val': 0.626526873947506, 'psi': 0.6434674894642156}
[S14] START round=12 head_norm_before_train=0.953326 cos_to_last_merge=0.9947 (last merge round=10)
[S14] round=12 local utility u=0.255263 metrics={'f1_val': 0.9281084904845666, 'auprc': 0.9956493756609047, 'loss_val': 0.5274467619273387, 'psi': 0.9551248445551018}-{'f1_val': 0.8899163216021411, 'auprc': 0.957367888719441, 'loss_val': 0.6939760064578507, 'psi': 0.916896948449061}
[S15] START round=12 head_norm_before_train=0.894134 cos_to_last_merge=0.9925 (last merge round=10)
[S15] round=12 local utility u=0.047996 metrics={'f1_val': 0.9974605999319422, 'auprc': 0.9942794336749645, 'loss_val': 0.23343222688159654, 'psi': 0.9961881334291511}-{'f1_val': 0.9970299290849798, 'auprc': 0.9972724550248077, 'loss_val': 0.33581959135853295, 'psi': 0.9971269394609109}
[S16] START round=12 head_norm_before_train=0.793728 cos_to_last_merge=0.9941 (last merge round=10)
[S16] round=12 local utility u=0.514495 metrics={'f1_val': 0.5084502818393465, 'auprc': 0.8609564482949593, 'loss_val': 0.7625210124865073, 'psi': 0.6494527484215917}-{'f1_val': 0.4846954263677051, 'auprc': 0.6034836224080511, 'loss_val': 0.8765633290322558, 'psi': 0.5322107047838435}
[S17] START round=12 head_norm_before_train=0.939766 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.35412526412747153, 'auprc': 0.6483141540229459, 'loss_val': 0.9338736528885961, 'psi': 0.47180082008566127}-{'f1_val': 0.35302995561043005, 'auprc': 0.6912373021030153, 'loss_val': 0.9455242099987557, 'psi': 0.48831289420746415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:45904
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:45915
[S3] not sending this round → trigger blocked (psi=0.636)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.712)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=-0.0593
[S13] DROPPED delta from S15 (cos=-0.0593 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] cosine check vs S11: cos=0.4678
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.5400
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.5885
[S11] RECEIVED delta(kind=head bytes=1791) from S14
[S11] cosine check vs S14: cos=0.7402
[S15] RECEIVED delta(kind=head bytes=1794) from S16
[S15] cosine check vs S16: cos=0.7776
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9155
[S8] RECEIVED delta(kind=head bytes=1798) from S10
[S8] cosine check vs S10: cos=0.9588
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.8684
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9922 head_norm=1.507382
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.169195e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9922 head_norm=1.496220 delta_norm=0.216919
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.9975 head_norm=0.993437
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.144330e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.9975 head_norm=0.867258 delta_norm=0.314433
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7018 head_norm=0.849555
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.417352e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7018 head_norm=0.864991 delta_norm=0.341735
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9281 head_norm=1.004112
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.066349e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9273 head_norm=1.079999 delta_norm=0.306635
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.7433 head_norm=1.229881
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.477016e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6203 head_norm=1.163517 delta_norm=0.247702
[S4] aggregate: ROLLBACK (f1_val pre=0.743 post=0.620 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.5085 head_norm=0.845631
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.217324e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.5156 head_norm=0.777217 delta_norm=0.221732
[S16] aggregate: ACCEPT kept=['S11', 'S5', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.504534 cos_to_last_merge=0.8170 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6037268138213183, 'auprc': 0.6253510532825345, 'loss_val': 0.6772905638226274, 'psi': 0.6123765096058047}-{'f1_val': 0.6994246754598581, 'auprc': 0.7318503281472848, 'loss_val': 0.35744702995759464, 'psi': 0.7123949365348288}
[S3] START round=13 head_norm_before_train=1.314589 cos_to_last_merge=0.9979 (last merge round=11)
[S3] round=13 local utility u=0.039416 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.9971621927578436, 'loss_val': 0.6341004494939739, 'psi': 0.6367362329924099}-{'f1_val': 0.39645225981545407, 'auprc': 0.9956153764160695, 'loss_val': 0.7082925762762594, 'psi': 0.6361175064557003}
[S4] START round=13 head_norm_before_train=1.163517 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.624298 metrics={'f1_val': 0.9448411637493583, 'auprc': 0.9546010900491432, 'loss_val': 0.4430198873679114, 'psi': 0.9487451342692723}-{'f1_val': 0.7433441837217141, 'auprc': 0.9511385324227566, 'loss_val': 0.47224543101751254, 'psi': 0.8264619232021311}
[S5] START round=13 head_norm_before_train=1.499747 (no previous merge yet)
[S5] round=13 local utility u=0.013214 metrics={'f1_val': 0.7008551563393421, 'auprc': 0.9980773434983756, 'loss_val': 0.33476323128319324, 'psi': 0.8197440312029556}-{'f1_val': 0.7008563225598777, 'auprc': 0.9983431495204644, 'loss_val': 0.36199654935884645, 'psi': 0.8198510533441123}
[S6] START round=13 head_norm_before_train=1.711448 (no previous merge yet)
[S6] round=13 local utility u=0.054769 metrics={'f1_val': 0.7975682541136121, 'auprc': 0.9388536605429129, 'loss_val': 0.39530395092036863, 'psi': 0.8540824166853325}-{'f1_val': 0.8174596271147884, 'auprc': 0.8527366452433284, 'loss_val': 0.36583845026270734, 'psi': 0.8315704343662044}
[S7] START round=13 head_norm_before_train=1.147890 cos_to_last_merge=0.8846 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.885
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.6997556537948297, 'auprc': 0.7881655508754385, 'loss_val': 0.6961851856743893, 'psi': 0.7351196126270733}-{'f1_val': 0.7138802693288737, 'auprc': 0.7860699391439019, 'loss_val': 0.7461354997511173, 'psi': 0.742756137254885}
[S8] START round=13 head_norm_before_train=1.496220 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9993520271167294, 'loss_val': 0.13039661750497034, 'psi': 0.9948273915443976}-{'f1_val': 0.992174240363445, 'auprc': 0.9992216959082637, 'loss_val': 0.11731032547157691, 'psi': 0.9949932225813725}
[S9] START round=13 head_norm_before_train=1.660034 (no previous merge yet)
[S9] round=13 local utility u=0.001374 metrics={'f1_val': 0.7015389534361501, 'auprc': 0.9982310133283547, 'loss_val': 0.26568064802002417, 'psi': 0.820215777393032}-{'f1_val': 0.7013613595118124, 'auprc': 0.9982447541027794, 'loss_val': 0.2674034075055456, 'psi': 0.8201147173481993}
[S10] START round=13 head_norm_before_train=1.516330 cos_to_last_merge=0.8594 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.859
[S10] round=13 local utility u=0.001303 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9934562196116917, 'loss_val': 0.06285810599091236, 'psi': 0.9939963268717296}-{'f1_val': 0.9951941773951698, 'auprc': 0.9946238168855576, 'loss_val': 0.07399261503584796, 'psi': 0.9949660331913249}
[S11] START round=13 head_norm_before_train=0.864991 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.000637 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9410227540166949, 'loss_val': 0.5703454787196741, 'psi': 0.7974644646035567}-{'f1_val': 0.7017589383281313, 'auprc': 0.941416959451418, 'loss_val': 0.5728014845594389, 'psi': 0.797622146777446}
[S13] START round=13 head_norm_before_train=1.664063 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5704648872366334, 'auprc': 0.6925319503757517, 'loss_val': 0.8214905124416985, 'psi': 0.6192917124922807}-{'f1_val': 0.5820021911678346, 'auprc': 0.6900575178363385, 'loss_val': 0.8075290540007013, 'psi': 0.6252243218352362}
[S14] START round=13 head_norm_before_train=1.079999 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.9273903971906747, 'auprc': 0.9668676371165819, 'loss_val': 0.5415359556116828, 'psi': 0.9431812931610376}-{'f1_val': 0.9281084904845666, 'auprc': 0.9956493756609047, 'loss_val': 0.5274467619273387, 'psi': 0.9551248445551018}
[S15] START round=13 head_norm_before_train=0.867258 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.9297153199717254, 'auprc': 0.9943908827326726, 'loss_val': 0.3050108104192755, 'psi': 0.9555855450761044}-{'f1_val': 0.9974605999319422, 'auprc': 0.9942794336749645, 'loss_val': 0.23343222688159654, 'psi': 0.9961881334291511}
[S16] START round=13 head_norm_before_train=0.777217 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.003587 metrics={'f1_val': 0.5364141522948698, 'auprc': 0.8441760120076491, 'loss_val': 0.8727888854494247, 'psi': 0.6595188961799815}-{'f1_val': 0.5084502818393465, 'auprc': 0.8609564482949593, 'loss_val': 0.7625210124865073, 'psi': 0.6494527484215917}
[S17] START round=13 head_norm_before_train=0.992209 cos_to_last_merge=0.9939 (last merge round=11)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3553851604157564, 'auprc': 0.5979613517449107, 'loss_val': 0.946560254826681, 'psi': 0.45241563694741815}-{'f1_val': 0.35412526412747153, 'auprc': 0.6483141540229459, 'loss_val': 0.9338736528885961, 'psi': 0.47180082008566127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[S4] not sending this round → trigger blocked (psi=0.949)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.820)
[S16] not sending this round → trigger blocked (psi=0.660)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.797)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:45917
[S5] not sending this round → trigger blocked (psi=0.820)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[S6] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=-0.0587
[S17] DROPPED delta from S6 (cos=-0.0587 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=0.4983
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3554 head_norm=1.042771
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.128442e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3532 head_norm=1.037099 delta_norm=0.612844
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.526131 cos_to_last_merge=0.8120 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=14 local utility u=0.504295 metrics={'f1_val': 0.6995928138164023, 'auprc': 0.6607516428411349, 'loss_val': 0.3500984408874907, 'psi': 0.6840563454262953}-{'f1_val': 0.6037268138213183, 'auprc': 0.6253510532825345, 'loss_val': 0.6772905638226274, 'psi': 0.6123765096058047}
[S3] START round=14 head_norm_before_train=1.347194 cos_to_last_merge=0.9933 (last merge round=11)
[S3] round=14 local utility u=0.015488 metrics={'f1_val': 0.39642092198300777, 'auprc': 0.9954881817846061, 'loss_val': 0.5979140075105364, 'psi': 0.6360478259036471}-{'f1_val': 0.39645225981545407, 'auprc': 0.9971621927578436, 'loss_val': 0.6341004494939739, 'psi': 0.6367362329924099}
[S4] START round=14 head_norm_before_train=1.212130 cos_to_last_merge=0.9979 (last merge round=12)
[S4] round=14 local utility u=0.051718 metrics={'f1_val': 0.9469449148038496, 'auprc': 0.9551531943753603, 'loss_val': 0.35386258368212514, 'psi': 0.9502282266324538}-{'f1_val': 0.9448411637493583, 'auprc': 0.9546010900491432, 'loss_val': 0.4430198873679114, 'psi': 0.9487451342692723}
[S5] START round=14 head_norm_before_train=1.526792 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7105295246589348, 'auprc': 0.8627904078621504, 'loss_val': 0.342740862363742, 'psi': 0.7714338779402211}-{'f1_val': 0.7008551563393421, 'auprc': 0.9980773434983756, 'loss_val': 0.33476323128319324, 'psi': 0.8197440312029556}
[S6] START round=14 head_norm_before_train=1.738447 (no previous merge yet)
[S6] round=14 local utility u=0.410474 metrics={'f1_val': 0.8937195179725823, 'auprc': 0.9713605073780833, 'loss_val': 0.24878415537485984, 'psi': 0.9247759137347827}-{'f1_val': 0.7975682541136121, 'auprc': 0.9388536605429129, 'loss_val': 0.39530395092036863, 'psi': 0.8540824166853325}
[S7] START round=14 head_norm_before_train=1.176563 cos_to_last_merge=0.8750 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.875
[S7] round=14 local utility u=0.015383 metrics={'f1_val': 0.682211448153997, 'auprc': 0.7897478642152221, 'loss_val': 0.5649002591958366, 'psi': 0.7252260145784871}-{'f1_val': 0.6997556537948297, 'auprc': 0.7881655508754385, 'loss_val': 0.6961851856743893, 'psi': 0.7351196126270733}
[S8] START round=14 head_norm_before_train=1.535919 cos_to_last_merge=0.9991 (last merge round=12)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.7934273653693161, 'loss_val': 0.49359660407174266, 'psi': 0.7457811749319951}-{'f1_val': 0.9918109678295097, 'auprc': 0.9993520271167294, 'loss_val': 0.13039661750497034, 'psi': 0.9948273915443976}
[S9] START round=14 head_norm_before_train=1.678483 (no previous merge yet)
[S9] round=14 local utility u=0.003031 metrics={'f1_val': 0.7015389534361501, 'auprc': 0.9982279043527786, 'loss_val': 0.2596087592939353, 'psi': 0.8202145338028015}-{'f1_val': 0.7015389534361501, 'auprc': 0.9982310133283547, 'loss_val': 0.26568064802002417, 'psi': 0.820215777393032}
[S10] START round=14 head_norm_before_train=1.548716 cos_to_last_merge=0.8566 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.857
[S10] round=14 local utility u=0.008001 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9947360535983845, 'loss_val': 0.05436544745848511, 'psi': 0.9948753333583995}-{'f1_val': 0.9943563983784213, 'auprc': 0.9934562196116917, 'loss_val': 0.06285810599091236, 'psi': 0.9939963268717296}
[S11] START round=14 head_norm_before_train=0.917899 cos_to_last_merge=0.9942 (last merge round=12)
[S11] round=14 local utility u=0.029754 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9205097401468229, 'loss_val': 0.4489052340868401, 'psi': 0.789219983810884}-{'f1_val': 0.7017589383281313, 'auprc': 0.9410227540166949, 'loss_val': 0.5703454787196741, 'psi': 0.7974644646035567}
[S13] START round=14 head_norm_before_train=1.685300 (no previous merge yet)
[S13] round=14 local utility u=0.236670 metrics={'f1_val': 0.6293313317218684, 'auprc': 0.6623898482186218, 'loss_val': 0.6109227784096278, 'psi': 0.6425547383205698}-{'f1_val': 0.5704648872366334, 'auprc': 0.6925319503757517, 'loss_val': 0.8214905124416985, 'psi': 0.6192917124922807}
[S14] START round=14 head_norm_before_train=1.117570 cos_to_last_merge=0.9968 (last merge round=12)
[S14] round=14 local utility u=0.059891 metrics={'f1_val': 0.9249553438578404, 'auprc': 0.9764617620022481, 'loss_val': 0.4359269878440525, 'psi': 0.9455579111156035}-{'f1_val': 0.9273903971906747, 'auprc': 0.9668676371165819, 'loss_val': 0.5415359556116828, 'psi': 0.9431812931610376}
[S15] START round=14 head_norm_before_train=0.962705 cos_to_last_merge=0.9919 (last merge round=12)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.715497032241935, 'auprc': 0.9167097165444843, 'loss_val': 0.35756758066723693, 'psi': 0.7959821059629546}-{'f1_val': 0.9297153199717254, 'auprc': 0.9943908827326726, 'loss_val': 0.3050108104192755, 'psi': 0.9555855450761044}
[S16] START round=14 head_norm_before_train=0.823065 cos_to_last_merge=0.9947 (last merge round=12)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.5497869461673643, 'auprc': 0.8092253103180593, 'loss_val': 0.9293060138534762, 'psi': 0.6535622918276424}-{'f1_val': 0.5364141522948698, 'auprc': 0.8441760120076491, 'loss_val': 0.8727888854494247, 'psi': 0.6595188961799815}
[S17] START round=14 head_norm_before_train=1.037099 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.028507 metrics={'f1_val': 0.35273061711417875, 'auprc': 0.604405189432348, 'loss_val': 0.8929504995451545, 'psi': 0.45340044604144647}-{'f1_val': 0.3553851604157564, 'auprc': 0.5979613517449107, 'loss_val': 0.946560254826681, 'psi': 0.45241563694741815}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.636)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:45912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:45916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.925)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:45909
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S2
[S17] cosine check vs S2: cos=0.3652
[S16] RECEIVED delta(kind=head bytes=1793) from S11
[S16] cosine check vs S11: cos=0.4845
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.6089
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.8444
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=0.9399
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.9178
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=-0.0133
[S2] DROPPED delta from S13 (cos=-0.0133 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S10
[S8] cosine check vs S10: cos=0.9769
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] cosine check vs S17: cos=0.0368
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7140 head_norm=1.579220
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.698836e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7142 head_norm=1.571687 delta_norm=0.169884
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9469 head_norm=1.273071
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.173619e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9451 head_norm=1.220025 delta_norm=0.217362
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9250 head_norm=1.162218
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.930814e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9210 head_norm=0.925571 delta_norm=0.393081
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=0.980207
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.113495e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=1.029000 delta_norm=0.311349
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5498 head_norm=0.874330
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.566793e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5498 head_norm=0.886782 delta_norm=0.356679
[S16] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3527 head_norm=1.083330
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.650678e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3525 head_norm=1.094154 delta_norm=0.765068
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.546415 cos_to_last_merge=0.8089 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=15 local utility u=0.008629 metrics={'f1_val': 0.7126174974796167, 'auprc': 0.7761704226849249, 'loss_val': 0.7572453445859323, 'psi': 0.73803866756174}-{'f1_val': 0.6995928138164023, 'auprc': 0.6607516428411349, 'loss_val': 0.3500984408874907, 'psi': 0.6840563454262953}
[S3] START round=15 head_norm_before_train=1.378854 cos_to_last_merge=0.9882 (last merge round=11)
[S3] round=15 local utility u=0.831204 metrics={'f1_val': 0.6758159467628385, 'auprc': 0.9767107448708752, 'loss_val': 0.5555446455153341, 'psi': 0.7961738660060531}-{'f1_val': 0.39642092198300777, 'auprc': 0.9954881817846061, 'loss_val': 0.5979140075105364, 'psi': 0.6360478259036471}
[S4] START round=15 head_norm_before_train=1.220025 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.015588 metrics={'f1_val': 0.944630095818904, 'auprc': 0.9563533496776259, 'loss_val': 0.31239908227866525, 'psi': 0.9493193973623928}-{'f1_val': 0.9469449148038496, 'auprc': 0.9551531943753603, 'loss_val': 0.35386258368212514, 'psi': 0.9502282266324538}
[S5] START round=15 head_norm_before_train=1.554018 (no previous merge yet)
[S5] round=15 local utility u=0.203112 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9981053941446933, 'loss_val': 0.28293411018682346, 'psi': 0.8196071932554819}-{'f1_val': 0.7105295246589348, 'auprc': 0.8627904078621504, 'loss_val': 0.342740862363742, 'psi': 0.7714338779402211}
[S6] START round=15 head_norm_before_train=1.763279 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6074033334374939, 'auprc': 0.7969731258550194, 'loss_val': 0.8495134886698079, 'psi': 0.6832312504045042}-{'f1_val': 0.8937195179725823, 'auprc': 0.9713605073780833, 'loss_val': 0.24878415537485984, 'psi': 0.9247759137347827}
[S7] START round=15 head_norm_before_train=1.204451 cos_to_last_merge=0.8670 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.867
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5221188002108712, 'auprc': 0.7797640449359864, 'loss_val': 0.7947723274841765, 'psi': 0.6251768981009174}-{'f1_val': 0.682211448153997, 'auprc': 0.7897478642152221, 'loss_val': 0.5649002591958366, 'psi': 0.7252260145784871}
[S8] START round=15 head_norm_before_train=1.571687 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.9878503457462027, 'auprc': 0.9992290318380551, 'loss_val': 0.11310214251579154, 'psi': 0.9924018201829437}-{'f1_val': 0.7140170479737811, 'auprc': 0.7934273653693161, 'loss_val': 0.49359660407174266, 'psi': 0.7457811749319951}
[S9] START round=15 head_norm_before_train=1.696186 (no previous merge yet)
[S9] round=15 local utility u=0.003307 metrics={'f1_val': 0.7015389534361501, 'auprc': 0.9982246964097405, 'loss_val': 0.2529853155429664, 'psi': 0.8202132506255864}-{'f1_val': 0.7015389534361501, 'auprc': 0.9982279043527786, 'loss_val': 0.2596087592939353, 'psi': 0.8202145338028015}
[S10] START round=15 head_norm_before_train=1.582462 cos_to_last_merge=0.8539 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.854
[S10] round=15 local utility u=0.004413 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9946824776487676, 'loss_val': 0.04669575736311147, 'psi': 0.9949856944711319}-{'f1_val': 0.9949681865317428, 'auprc': 0.9947360535983845, 'loss_val': 0.05436544745848511, 'psi': 0.9948753333583995}
[S11] START round=15 head_norm_before_train=1.029000 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.050268 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9507753231790155, 'loss_val': 0.4406160418347799, 'psi': 0.8014713192505982}-{'f1_val': 0.7016934795869249, 'auprc': 0.9205097401468229, 'loss_val': 0.4489052340868401, 'psi': 0.789219983810884}
[S13] START round=15 head_norm_before_train=1.695215 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5970035292175562, 'auprc': 0.6940515645183293, 'loss_val': 0.7754935657406418, 'psi': 0.6358227433378654}-{'f1_val': 0.6293313317218684, 'auprc': 0.6623898482186218, 'loss_val': 0.6109227784096278, 'psi': 0.6425547383205698}
[S14] START round=15 head_norm_before_train=0.925571 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.064875 metrics={'f1_val': 0.943367810059085, 'auprc': 0.9963453288541564, 'loss_val': 0.4763017038953563, 'psi': 0.9645588175771136}-{'f1_val': 0.9249553438578404, 'auprc': 0.9764617620022481, 'loss_val': 0.4359269878440525, 'psi': 0.9455579111156035}
[S15] START round=15 head_norm_before_train=1.068419 cos_to_last_merge=0.9754 (last merge round=12)
[S15] round=15 local utility u=1.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9934371150641905, 'loss_val': 0.12698484726167897, 'psi': 0.9956451981425363}-{'f1_val': 0.715497032241935, 'auprc': 0.9167097165444843, 'loss_val': 0.35756758066723693, 'psi': 0.7959821059629546}
[S16] START round=15 head_norm_before_train=0.886782 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.671475 metrics={'f1_val': 0.6491867256838477, 'auprc': 0.9466268087316774, 'loss_val': 0.5949584243816626, 'psi': 0.7681627589029796}-{'f1_val': 0.5497869461673643, 'auprc': 0.8092253103180593, 'loss_val': 0.9293060138534762, 'psi': 0.6535622918276424}
[S17] START round=15 head_norm_before_train=1.094154 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.35650281011022733, 'auprc': 0.5682491174498371, 'loss_val': 0.9330178824669357, 'psi': 0.44120133304607123}-{'f1_val': 0.35273061711417875, 'auprc': 0.604405189432348, 'loss_val': 0.8929504995451545, 'psi': 0.45340044604144647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:45915
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:45916
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.8895
[S13] RECEIVED delta(kind=head bytes=1792) from S15
[S13] cosine check vs S15: cos=-0.0646
[S13] DROPPED delta from S15 (cos=-0.0646 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S4
[S14] cosine check vs S4: cos=0.8766
[S17] RECEIVED delta(kind=head bytes=1805) from S3
[S17] cosine check vs S3: cos=0.4265
[S17] RECEIVED delta(kind=head bytes=1806) from S2
[S17] cosine check vs S2: cos=0.8641
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] cosine check vs S5: cos=0.3189
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=0.5042
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] cosine check vs S9: cos=0.7969
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.9050
[S15] RECEIVED delta(kind=head bytes=1792) from S16
[S15] cosine check vs S16: cos=0.7620
[S8] RECEIVED delta(kind=head bytes=1793) from S10
[S8] cosine check vs S10: cos=0.9900
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.237 → S17@127.0.0.1:45917
[S7] ⇄ pheromone p=0.171 → S4@127.0.0.1:45904
[S13] ⇄ pheromone p=0.134 → S2@127.0.0.1:45902
[S4] ⇄ pheromone p=0.254 → S14@127.0.0.1:45914
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9434 head_norm=0.969993
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.216289e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9482 head_norm=1.096724 delta_norm=0.321629
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.255 → S11@127.0.0.1:45912
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7019 head_norm=1.076852
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.290386e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7019 head_norm=0.998895 delta_norm=0.229039
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.159 → S16@127.0.0.1:45916
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.6492 head_norm=0.929246
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.322047e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.6488 head_norm=0.870199 delta_norm=0.232205
[S16] aggregate: ACCEPT kept=['S5', 'S11', 'S9'] (k=3/3) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.288 → S15@127.0.0.1:45915
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.6758 head_norm=1.407100
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.676763e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.6678 head_norm=1.465648 delta_norm=0.367676
[S3] aggregate: ROLLBACK (f1_val pre=0.676 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.286 → S17@127.0.0.1:45917
[S9] ⇄ pheromone p=0.093 → S16@127.0.0.1:45916
[S5] ⇄ pheromone p=0.176 → S16@127.0.0.1:45916
[S2] ⇄ pheromone p=0.167 → S17@127.0.0.1:45917
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9879 head_norm=1.608318
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.142309e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9879 head_norm=1.611580 delta_norm=0.114231
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.356 → S3@127.0.0.1:45903
[S10] ⇄ pheromone p=0.156 → S8@127.0.0.1:45909
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.9971 head_norm=1.152282
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.739399e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.9971 head_norm=0.977647 delta_norm=0.373940
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.375 → S13@127.0.0.1:45913
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3565 head_norm=1.141959
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.097737e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.4203 head_norm=1.077171 delta_norm=0.209774
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.070 → S14@127.0.0.1:45914
[S2] START round=16 head_norm_before_train=1.567998 cos_to_last_merge=0.8067 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.713575041682262, 'auprc': 0.7784168733835609, 'loss_val': 0.7907426387905735, 'psi': 0.7395117743627816}-{'f1_val': 0.7126174974796167, 'auprc': 0.7761704226849249, 'loss_val': 0.7572453445859323, 'psi': 0.73803866756174}
[S3] START round=16 head_norm_before_train=1.465648 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.148157 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9971495970702282, 'loss_val': 0.4701892068366859, 'psi': 0.819313561069271}-{'f1_val': 0.6758159467628385, 'auprc': 0.9767107448708752, 'loss_val': 0.5555446455153341, 'psi': 0.7961738660060531}
[S4] START round=16 head_norm_before_train=1.292908 cos_to_last_merge=0.9957 (last merge round=14)
[S4] round=16 local utility u=0.032952 metrics={'f1_val': 0.9459689194560909, 'auprc': 0.9637272927113825, 'loss_val': 0.2766503368476644, 'psi': 0.9530722687582076}-{'f1_val': 0.944630095818904, 'auprc': 0.9563533496776259, 'loss_val': 0.31239908227866525, 'psi': 0.9493193973623928}
[S5] START round=16 head_norm_before_train=1.582111 (no previous merge yet)
[S5] round=16 local utility u=0.188414 metrics={'f1_val': 0.7619349382519125, 'auprc': 0.9969495027957688, 'loss_val': 0.2705968117751423, 'psi': 0.855940764069455}-{'f1_val': 0.7006083926626743, 'auprc': 0.9981053941446933, 'loss_val': 0.28293411018682346, 'psi': 0.8196071932554819}
[S6] START round=16 head_norm_before_train=1.780321 (no previous merge yet)
[S6] round=16 local utility u=0.977787 metrics={'f1_val': 0.7952325683223809, 'auprc': 0.948917724056846, 'loss_val': 0.47674950732075005, 'psi': 0.8567066306161669}-{'f1_val': 0.6074033334374939, 'auprc': 0.7969731258550194, 'loss_val': 0.8495134886698079, 'psi': 0.6832312504045042}
[S7] START round=16 head_norm_before_train=1.228730 cos_to_last_merge=0.8608 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.861
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5452919748188717, 'auprc': 0.6872600984958426, 'loss_val': 0.7700251884114632, 'psi': 0.60207922428966}-{'f1_val': 0.5221188002108712, 'auprc': 0.7797640449359864, 'loss_val': 0.7947723274841765, 'psi': 0.6251768981009174}
[S8] START round=16 head_norm_before_train=1.611580 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.019753 metrics={'f1_val': 0.9922819023012285, 'auprc': 0.9988322911182802, 'loss_val': 0.09899440109714647, 'psi': 0.9949020578280492}-{'f1_val': 0.9878503457462027, 'auprc': 0.9992290318380551, 'loss_val': 0.11310214251579154, 'psi': 0.9924018201829437}
[S9] START round=16 head_norm_before_train=1.712921 (no previous merge yet)
[S9] round=16 local utility u=0.004275 metrics={'f1_val': 0.7015389534361501, 'auprc': 0.9981371191878505, 'loss_val': 0.24417296405746966, 'psi': 0.8201782197368304}-{'f1_val': 0.7015389534361501, 'auprc': 0.9982246964097405, 'loss_val': 0.2529853155429664, 'psi': 0.8202132506255864}
[S10] START round=16 head_norm_before_train=1.622896 cos_to_last_merge=0.8506 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.851
[S10] round=16 local utility u=0.005493 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965122373755002, 'loss_val': 0.041198246511746556, 'psi': 0.9957175983618249}-{'f1_val': 0.9951878390193748, 'auprc': 0.9946824776487676, 'loss_val': 0.04669575736311147, 'psi': 0.9949856944711319}
[S11] START round=16 head_norm_before_train=0.998895 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9530850823450214, 'loss_val': 0.4485091532358567, 'psi': 0.8022501206901635}-{'f1_val': 0.7019353166316534, 'auprc': 0.9507753231790155, 'loss_val': 0.4406160418347799, 'psi': 0.8014713192505982}
[S13] START round=16 head_norm_before_train=1.712574 (no previous merge yet)
[S13] round=16 local utility u=0.191565 metrics={'f1_val': 0.6335755562200227, 'auprc': 0.693320419216053, 'loss_val': 0.6096020311040519, 'psi': 0.6574735014184347}-{'f1_val': 0.5970035292175562, 'auprc': 0.6940515645183293, 'loss_val': 0.7754935657406418, 'psi': 0.6358227433378654}
[S14] START round=16 head_norm_before_train=1.096724 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.170250 metrics={'f1_val': 0.9946600015120297, 'auprc': 0.9945898402533396, 'loss_val': 0.4382874100432924, 'psi': 0.9946319370085537}-{'f1_val': 0.943367810059085, 'auprc': 0.9963453288541564, 'loss_val': 0.4763017038953563, 'psi': 0.9645588175771136}
[S15] START round=16 head_norm_before_train=0.977647 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.9289896550359986, 'auprc': 0.9966105420021889, 'loss_val': 0.23620566585403305, 'psi': 0.9560380098224748}-{'f1_val': 0.9971172535281002, 'auprc': 0.9934371150641905, 'loss_val': 0.12698484726167897, 'psi': 0.9956451981425363}
[S16] START round=16 head_norm_before_train=0.870199 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.986683 metrics={'f1_val': 0.9554828966069454, 'auprc': 0.9776601033586154, 'loss_val': 0.5524684459688068, 'psi': 0.9643537793076135}-{'f1_val': 0.6491867256838477, 'auprc': 0.9466268087316774, 'loss_val': 0.5949584243816626, 'psi': 0.7681627589029796}
[S17] START round=16 head_norm_before_train=1.077171 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.155000 metrics={'f1_val': 0.3820172303518462, 'auprc': 0.5967951386580659, 'loss_val': 0.8617421786897689, 'psi': 0.46792839367433403}-{'f1_val': 0.35650281011022733, 'auprc': 0.5682491174498371, 'loss_val': 0.9330178824669357, 'psi': 0.44120133304607123}
[S9] not sending this round → trigger blocked (psi=0.820)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S2@127.0.0.1:45902
[S10] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → trigger blocked (psi=0.995)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S3] not sending this round → trigger blocked (psi=0.819)
[S16] not sending this round → trigger blocked (psi=0.964)
[S5] not sending this round → trigger blocked (psi=0.856)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:45917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.953)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1807) from S13
[S2] cosine check vs S13: cos=-0.0097
[S2] DROPPED delta from S13 (cos=-0.0097 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S6
[S17] cosine check vs S6: cos=-0.0403
[S17] DROPPED delta from S6 (cos=-0.0403 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.1348
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9947 head_norm=1.125212
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.413704e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9946 head_norm=0.849034 delta_norm=0.741370
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.589103 cos_to_last_merge=0.8049 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7197893770033921, 'auprc': 0.7711687301942861, 'loss_val': 0.8207966192345615, 'psi': 0.7403411182797497}-{'f1_val': 0.713575041682262, 'auprc': 0.7784168733835609, 'loss_val': 0.7907426387905735, 'psi': 0.7395117743627816}
[S3] START round=17 head_norm_before_train=1.490727 cos_to_last_merge=0.9994 (last merge round=15)
[S3] round=17 local utility u=0.018551 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9971494412220842, 'loss_val': 0.4350670958254768, 'psi': 0.8195115897003092}-{'f1_val': 0.7007562037352997, 'auprc': 0.9971495970702282, 'loss_val': 0.4701892068366859, 'psi': 0.819313561069271}
[S4] START round=17 head_norm_before_train=1.361557 cos_to_last_merge=0.9869 (last merge round=14)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9424534574802962, 'auprc': 0.9557931549667286, 'loss_val': 0.276927992752878, 'psi': 0.9477893364748692}-{'f1_val': 0.9459689194560909, 'auprc': 0.9637272927113825, 'loss_val': 0.2766503368476644, 'psi': 0.9530722687582076}
[S5] START round=17 head_norm_before_train=1.612749 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7934770230373526, 'loss_val': 0.5467832864675203, 'psi': 0.7460708487875463}-{'f1_val': 0.7619349382519125, 'auprc': 0.9969495027957688, 'loss_val': 0.2705968117751423, 'psi': 0.855940764069455}
[S6] START round=17 head_norm_before_train=1.799820 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7796014656679967, 'auprc': 0.9504881831363241, 'loss_val': 0.5602896090287155, 'psi': 0.8479561526553276}-{'f1_val': 0.7952325683223809, 'auprc': 0.948917724056846, 'loss_val': 0.47674950732075005, 'psi': 0.8567066306161669}
[S7] START round=17 head_norm_before_train=1.254331 cos_to_last_merge=0.8545 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.855
[S7] round=17 local utility u=0.261274 metrics={'f1_val': 0.5897017356655799, 'auprc': 0.7306070413494178, 'loss_val': 0.6439771922673151, 'psi': 0.6460638579391151}-{'f1_val': 0.5452919748188717, 'auprc': 0.6872600984958426, 'loss_val': 0.7700251884114632, 'psi': 0.60207922428966}
[S8] START round=17 head_norm_before_train=1.651875 cos_to_last_merge=0.9993 (last merge round=15)
[S8] round=17 local utility u=0.004335 metrics={'f1_val': 0.9929283538364014, 'auprc': 0.9938969156184396, 'loss_val': 0.07939779770544886, 'psi': 0.9933157785492167}-{'f1_val': 0.9922819023012285, 'auprc': 0.9988322911182802, 'loss_val': 0.09899440109714647, 'psi': 0.9949020578280492}
[S9] START round=17 head_norm_before_train=1.728216 (no previous merge yet)
[S9] round=17 local utility u=0.004800 metrics={'f1_val': 0.7015389534361501, 'auprc': 0.9981108923019586, 'loss_val': 0.2344939581122218, 'psi': 0.8201677289824736}-{'f1_val': 0.7015389534361501, 'auprc': 0.9981371191878505, 'loss_val': 0.24417296405746966, 'psi': 0.8201782197368304}
[S10] START round=17 head_norm_before_train=1.662465 cos_to_last_merge=0.8477 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.848
[S10] round=17 local utility u=0.001027 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960282095103572, 'loss_val': 0.0376919248861362, 'psi': 0.9955239872157677}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965122373755002, 'loss_val': 0.041198246511746556, 'psi': 0.9957175983618249}
[S11] START round=17 head_norm_before_train=1.044014 cos_to_last_merge=0.9965 (last merge round=15)
[S11] round=17 local utility u=0.104798 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9967580161332412, 'loss_val': 0.3699312103095778, 'psi': 0.8197192942054514}-{'f1_val': 0.7016934795869249, 'auprc': 0.9530850823450214, 'loss_val': 0.4485091532358567, 'psi': 0.8022501206901635}
[S13] START round=17 head_norm_before_train=1.736046 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5684373470344148, 'auprc': 0.7157472631528347, 'loss_val': 0.8971640637449718, 'psi': 0.6273613134817828}-{'f1_val': 0.6335755562200227, 'auprc': 0.693320419216053, 'loss_val': 0.6096020311040519, 'psi': 0.6574735014184347}
[S14] START round=17 head_norm_before_train=0.849034 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9928517195355279, 'auprc': 0.9961838890521857, 'loss_val': 0.5060150958199366, 'psi': 0.994184587342191}-{'f1_val': 0.9946600015120297, 'auprc': 0.9945898402533396, 'loss_val': 0.4382874100432924, 'psi': 0.9946319370085537}
[S15] START round=17 head_norm_before_train=1.055701 cos_to_last_merge=0.9969 (last merge round=15)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.8190535443232201, 'auprc': 0.9761636122388515, 'loss_val': 0.2741152998423987, 'psi': 0.8818975714894727}-{'f1_val': 0.9289896550359986, 'auprc': 0.9966105420021889, 'loss_val': 0.23620566585403305, 'psi': 0.9560380098224748}
[S16] START round=17 head_norm_before_train=0.912984 cos_to_last_merge=0.9961 (last merge round=15)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.6922762681415902, 'auprc': 0.962741513213001, 'loss_val': 0.4562474384283646, 'psi': 0.8004623661701545}-{'f1_val': 0.9554828966069454, 'auprc': 0.9776601033586154, 'loss_val': 0.5524684459688068, 'psi': 0.9643537793076135}
[S17] START round=17 head_norm_before_train=1.129103 cos_to_last_merge=0.9937 (last merge round=15)
[S17] round=17 local utility u=0.061743 metrics={'f1_val': 0.35314629440904527, 'auprc': 0.7267963224083313, 'loss_val': 0.9550338574642331, 'psi': 0.5026063056087596}-{'f1_val': 0.3820172303518462, 'auprc': 0.5967951386580659, 'loss_val': 0.8617421786897689, 'psi': 0.46792839367433403}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:45904
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:45903
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=0.5290
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=0.9602
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9260
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.5039
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.9895
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=0.7178
[S17] not sending this round → trigger blocked (psi=0.503)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9425 head_norm=1.415101
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.678737e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9423 head_norm=1.318462 delta_norm=0.267874
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9929 head_norm=1.702131
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.230071e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9926 head_norm=1.695594 delta_norm=0.123007
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7011 head_norm=1.520163
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.444004e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7011 head_norm=1.595099 delta_norm=0.244400
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.6923 head_norm=0.963863
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.791826e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.6936 head_norm=0.979127 delta_norm=0.279183
[S16] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3531 head_norm=1.187305
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.894971e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3558 head_norm=1.176813 delta_norm=0.689497
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.608796 cos_to_last_merge=0.8019 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.802
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7144902689003755, 'auprc': 0.7346563349430044, 'loss_val': 0.7005711981895762, 'psi': 0.7225566953174271}-{'f1_val': 0.7197893770033921, 'auprc': 0.7711687301942861, 'loss_val': 0.8207966192345615, 'psi': 0.7403411182797497}
[S3] START round=18 head_norm_before_train=1.595099 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.007818 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9971506748696906, 'loss_val': 0.4164051349432267, 'psi': 0.8192091075431293}-{'f1_val': 0.7010863553524592, 'auprc': 0.9971494412220842, 'loss_val': 0.4350670958254768, 'psi': 0.8195115897003092}
[S4] START round=18 head_norm_before_train=1.318462 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.059655 metrics={'f1_val': 0.9525764979302308, 'auprc': 0.9712178177962273, 'loss_val': 0.2646307846527597, 'psi': 0.9600330258766294}-{'f1_val': 0.9424534574802962, 'auprc': 0.9557931549667286, 'loss_val': 0.276927992752878, 'psi': 0.9477893364748692}
[S5] START round=18 head_norm_before_train=1.640054 (no previous merge yet)
[S5] round=18 local utility u=0.410617 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9984736603984284, 'loss_val': 0.2573898785308374, 'psi': 0.8197544997569759}-{'f1_val': 0.7144667326210086, 'auprc': 0.7934770230373526, 'loss_val': 0.5467832864675203, 'psi': 0.7460708487875463}
[S6] START round=18 head_norm_before_train=1.818556 (no previous merge yet)
[S6] round=18 local utility u=0.401059 metrics={'f1_val': 0.8660466110901622, 'auprc': 0.9667607241600151, 'loss_val': 0.32566012882227735, 'psi': 0.9063322563181033}-{'f1_val': 0.7796014656679967, 'auprc': 0.9504881831363241, 'loss_val': 0.5602896090287155, 'psi': 0.8479561526553276}
[S7] START round=18 head_norm_before_train=1.271883 cos_to_last_merge=0.8503 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.43140277116229875, 'auprc': 0.6276558177280396, 'loss_val': 1.0524653240459023, 'psi': 0.5099039897885951}-{'f1_val': 0.5897017356655799, 'auprc': 0.7306070413494178, 'loss_val': 0.6439771922673151, 'psi': 0.6460638579391151}
[S8] START round=18 head_norm_before_train=1.695594 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.006234 metrics={'f1_val': 0.9911935183004846, 'auprc': 0.9985094470468134, 'loss_val': 0.07035882916930669, 'psi': 0.9941198897990162}-{'f1_val': 0.9929283538364014, 'auprc': 0.9938969156184396, 'loss_val': 0.07939779770544886, 'psi': 0.9933157785492167}
[S9] START round=18 head_norm_before_train=1.740857 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.6997999530635638, 'auprc': 0.9981052813774658, 'loss_val': 0.22595082526544477, 'psi': 0.8191220843891246}-{'f1_val': 0.7015389534361501, 'auprc': 0.9981108923019586, 'loss_val': 0.2344939581122218, 'psi': 0.8201677289824736}
[S10] START round=18 head_norm_before_train=1.697967 cos_to_last_merge=0.8451 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.845
[S10] round=18 local utility u=0.000207 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954321067199058, 'loss_val': 0.035490429535868714, 'psi': 0.9952855460995871}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960282095103572, 'loss_val': 0.0376919248861362, 'psi': 0.9955239872157677}
[S11] START round=18 head_norm_before_train=1.092597 cos_to_last_merge=0.9886 (last merge round=15)
[S11] round=18 local utility u=0.031774 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9979414358234281, 'loss_val': 0.3099325976933127, 'psi': 0.8201926620815261}-{'f1_val': 0.7016934795869249, 'auprc': 0.9967580161332412, 'loss_val': 0.3699312103095778, 'psi': 0.8197192942054514}
[S13] START round=18 head_norm_before_train=1.745214 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5641548581737788, 'auprc': 0.7112554424668011, 'loss_val': 0.9231660162153029, 'psi': 0.6229950918909877}-{'f1_val': 0.5684373470344148, 'auprc': 0.7157472631528347, 'loss_val': 0.8971640637449718, 'psi': 0.6273613134817828}
[S14] START round=18 head_norm_before_train=0.889497 cos_to_last_merge=0.9961 (last merge round=16)
[S14] round=18 local utility u=0.077433 metrics={'f1_val': 0.9963695037602027, 'auprc': 0.997150082606094, 'loss_val': 0.37515486334793696, 'psi': 0.9966817352985593}-{'f1_val': 0.9928517195355279, 'auprc': 0.9961838890521857, 'loss_val': 0.5060150958199366, 'psi': 0.994184587342191}
[S15] START round=18 head_norm_before_train=1.153437 cos_to_last_merge=0.9884 (last merge round=15)
[S15] round=18 local utility u=0.360922 metrics={'f1_val': 0.9196929054609598, 'auprc': 0.9993748544396877, 'loss_val': 0.22574206588769655, 'psi': 0.951565685052451}-{'f1_val': 0.8190535443232201, 'auprc': 0.9761636122388515, 'loss_val': 0.2741152998423987, 'psi': 0.8818975714894727}
[S16] START round=18 head_norm_before_train=0.979127 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.300434 metrics={'f1_val': 0.856283979468806, 'auprc': 0.9219772677433958, 'loss_val': 0.7171337741333765, 'psi': 0.8825612947786419}-{'f1_val': 0.6922762681415902, 'auprc': 0.962741513213001, 'loss_val': 0.4562474384283646, 'psi': 0.8004623661701545}
[S17] START round=18 head_norm_before_train=1.176813 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.35548211024076987, 'auprc': 0.7130712417481766, 'loss_val': 0.9329517448521708, 'psi': 0.49851776284373256}-{'f1_val': 0.35314629440904527, 'auprc': 0.7267963224083313, 'loss_val': 0.9550338574642331, 'psi': 0.5026063056087596}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:45915
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S8] not sending this round → trigger blocked (psi=0.994)
[S3] not sending this round → trigger blocked (psi=0.819)
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] cosine check vs S4: cos=0.6308
[S13] RECEIVED delta(kind=head bytes=1794) from S15
[S13] cosine check vs S15: cos=-0.0708
[S13] DROPPED delta from S15 (cos=-0.0708 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=-0.0802
[S17] DROPPED delta from S6 (cos=-0.0802 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.7498
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] cosine check vs S16: cos=0.8203
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.2870
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7017 head_norm=1.139497
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.795255e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7017 head_norm=0.974007 delta_norm=0.379526
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8563 head_norm=1.020419
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.394656e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8217 head_norm=1.091010 delta_norm=0.839466
[S16] aggregate: ROLLBACK (f1_val pre=0.856 post=0.822 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.9197 head_norm=1.236562
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.536249e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.9296 head_norm=1.077089 delta_norm=0.353625
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9964 head_norm=0.941810
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.269949e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9961 head_norm=1.040117 delta_norm=0.526995
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.635211 cos_to_last_merge=0.7984 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.798
[S2] round=19 local utility u=0.082928 metrics={'f1_val': 0.7132884337506978, 'auprc': 0.798908910032903, 'loss_val': 0.7202628254272158, 'psi': 0.7475366242635799}-{'f1_val': 0.7144902689003755, 'auprc': 0.7346563349430044, 'loss_val': 0.7005711981895762, 'psi': 0.7225566953174271}
[S3] START round=19 head_norm_before_train=1.620736 cos_to_last_merge=0.9996 (last merge round=17)
[S3] round=19 local utility u=0.051931 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9988164675639178, 'loss_val': 0.31858945646299297, 'psi': 0.8199803092667469}-{'f1_val': 0.7005813959920884, 'auprc': 0.9971506748696906, 'loss_val': 0.4164051349432267, 'psi': 0.8192091075431293}
[S4] START round=19 head_norm_before_train=1.353561 cos_to_last_merge=0.9991 (last merge round=17)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9405913686964222, 'auprc': 0.9610732114631827, 'loss_val': 0.28178025173527793, 'psi': 0.9487841058031263}-{'f1_val': 0.9525764979302308, 'auprc': 0.9712178177962273, 'loss_val': 0.2646307846527597, 'psi': 0.9600330258766294}
[S5] START round=19 head_norm_before_train=1.657937 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7237615750615479, 'auprc': 0.8371495207966817, 'loss_val': 0.33905558380453554, 'psi': 0.7691167533556014}-{'f1_val': 0.7006083926626743, 'auprc': 0.9984736603984284, 'loss_val': 0.2573898785308374, 'psi': 0.8197544997569759}
[S6] START round=19 head_norm_before_train=1.838152 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8281370660857325, 'auprc': 0.9602712321931166, 'loss_val': 0.5044254732553293, 'psi': 0.8809907325286861}-{'f1_val': 0.8660466110901622, 'auprc': 0.9667607241600151, 'loss_val': 0.32566012882227735, 'psi': 0.9063322563181033}
[S7] START round=19 head_norm_before_train=1.285021 cos_to_last_merge=0.8471 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.847
[S7] round=19 local utility u=1.000000 metrics={'f1_val': 0.6690702798966826, 'auprc': 0.8044185124597201, 'loss_val': 0.5254938078281135, 'psi': 0.7232095729218976}-{'f1_val': 0.43140277116229875, 'auprc': 0.6276558177280396, 'loss_val': 1.0524653240459023, 'psi': 0.5099039897885951}
[S8] START round=19 head_norm_before_train=1.743108 cos_to_last_merge=0.9993 (last merge round=17)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9818761851478031, 'auprc': 0.9990943223822591, 'loss_val': 0.08289977451553794, 'psi': 0.9887634400415855}-{'f1_val': 0.9911935183004846, 'auprc': 0.9985094470468134, 'loss_val': 0.07035882916930669, 'psi': 0.9941198897990162}
[S9] START round=19 head_norm_before_train=1.752681 (no previous merge yet)
[S9] round=19 local utility u=0.012230 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9981642795775957, 'loss_val': 0.21103542151278226, 'psi': 0.8200825275381258}-{'f1_val': 0.6997999530635638, 'auprc': 0.9981052813774658, 'loss_val': 0.22595082526544477, 'psi': 0.8191220843891246}
[S10] START round=19 head_norm_before_train=1.726649 cos_to_last_merge=0.8433 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.843
[S10] round=19 local utility u=0.000338 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9956370321737418, 'loss_val': 0.034110898385402426, 'psi': 0.9952357247885424}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954321067199058, 'loss_val': 0.035490429535868714, 'psi': 0.9952855460995871}
[S11] START round=19 head_norm_before_train=0.974007 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9966512802922824, 'loss_val': 0.3751463045677121, 'psi': 0.8198217020959051}-{'f1_val': 0.7016934795869249, 'auprc': 0.9979414358234281, 'loss_val': 0.3099325976933127, 'psi': 0.8201926620815261}
[S13] START round=19 head_norm_before_train=1.755443 (no previous merge yet)
[S13] round=19 local utility u=0.226642 metrics={'f1_val': 0.6103081523526428, 'auprc': 0.7241349346285721, 'loss_val': 0.7854404313732164, 'psi': 0.6558388652630145}-{'f1_val': 0.5641548581737788, 'auprc': 0.7112554424668011, 'loss_val': 0.9231660162153029, 'psi': 0.6229950918909877}
[S14] START round=19 head_norm_before_train=1.040117 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.016518 metrics={'f1_val': 0.9963708792816148, 'auprc': 0.9970622352929455, 'loss_val': 0.34186351806896575, 'psi': 0.9966474216861472}-{'f1_val': 0.9963695037602027, 'auprc': 0.997150082606094, 'loss_val': 0.37515486334793696, 'psi': 0.9966817352985593}
[S15] START round=19 head_norm_before_train=1.077089 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.197005 metrics={'f1_val': 0.9778625816456512, 'auprc': 0.9974953307565615, 'loss_val': 0.17511061629230845, 'psi': 0.9857156812900153}-{'f1_val': 0.9196929054609598, 'auprc': 0.9993748544396877, 'loss_val': 0.22574206588769655, 'psi': 0.951565685052451}
[S16] START round=19 head_norm_before_train=1.091010 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.334486 metrics={'f1_val': 0.9083098881778031, 'auprc': 0.983433441764009, 'loss_val': 0.5446852336270492, 'psi': 0.9383593096122855}-{'f1_val': 0.856283979468806, 'auprc': 0.9219772677433958, 'loss_val': 0.7171337741333765, 'psi': 0.8825612947786419}
[S17] START round=19 head_norm_before_train=1.226055 cos_to_last_merge=0.9968 (last merge round=17)
[S17] round=19 local utility u=0.593336 metrics={'f1_val': 0.4931911817789264, 'auprc': 0.7880147270014541, 'loss_val': 0.7973643216920651, 'psi': 0.6111205998679375}-{'f1_val': 0.35548211024076987, 'auprc': 0.7130712417481766, 'loss_val': 0.9329517448521708, 'psi': 0.49851776284373256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:45912
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:45902
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:45915
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=0.7118
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.9189
[S13] RECEIVED delta(kind=head bytes=1797) from S15
[S13] cosine check vs S15: cos=-0.0793
[S13] DROPPED delta from S15 (cos=-0.0793 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.8418
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] cosine check vs S2: cos=0.3843
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=0.9911
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9597
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.4475
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] cosine check vs S13: cos=-0.0076
[S2] DROPPED delta from S13 (cos=-0.0076 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=0.2433
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9819 head_norm=1.779667
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.188468e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9812 head_norm=1.761004 delta_norm=0.118847
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.989 u=0.0000 p_local=0.1495 f1=0.982 auprc=0.999 bytes=14393
[S6] r=20 psi=0.881 u=0.0000 p_local=0.2612 f1=0.828 auprc=0.960 bytes=16182
[S5] r=20 psi=0.769 u=0.0000 p_local=0.1569 f1=0.724 auprc=0.837 bytes=16156
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7019 head_norm=1.017827
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.148386e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7019 head_norm=1.031487 delta_norm=0.214839
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.820 u=0.0000 p_local=0.0836 f1=0.702 auprc=0.997 bytes=16161
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9406 head_norm=1.389429
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.960887e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9405 head_norm=1.328772 delta_norm=0.196089
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.949 u=0.0000 p_local=0.1169 f1=0.941 auprc=0.961 bytes=17974
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9083 head_norm=1.130097
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.070054e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.6382 head_norm=1.242351 delta_norm=0.807005
[S16] aggregate: ROLLBACK (f1_val pre=0.908 post=0.638 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.938 u=0.3345 p_local=0.3339 f1=0.908 auprc=0.983 bytes=14373
[S7] r=20 psi=0.723 u=1.0000 p_local=0.3035 f1=0.669 auprc=0.804 bytes=17979
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.9779 head_norm=1.146238
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.321336e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.9655 head_norm=1.052972 delta_norm=0.432134
[S15] aggregate: ROLLBACK (f1_val pre=0.978 post=0.966 tol_abs=0.005 tol_rel=0.0)
[S15] r=20 psi=0.986 u=0.1970 p_local=0.2509 f1=0.978 auprc=0.997 bytes=17970
[S13] r=20 psi=0.656 u=0.2266 p_local=0.1198 f1=0.610 auprc=0.724 bytes=14419
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9964 head_norm=1.088242
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.331220e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9955 head_norm=0.936516 delta_norm=0.733122
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0165 p_local=0.1378 f1=0.996 auprc=0.997 bytes=19737
[S9] r=20 psi=0.820 u=0.0122 p_local=0.0417 f1=0.701 auprc=0.998 bytes=19785
[S2] r=20 psi=0.748 u=0.0829 p_local=0.0848 f1=0.713 auprc=0.799 bytes=16219
[S3] r=20 psi=0.820 u=0.0519 p_local=0.1462 f1=0.701 auprc=0.999 bytes=17986
[S10] r=20 psi=0.995 u=0.0003 p_local=0.0647 f1=0.995 auprc=0.996 bytes=17968
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.4932 head_norm=1.282493
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.037815e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.5114 head_norm=1.179093 delta_norm=0.303782
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] r=20 psi=0.611 u=0.5933 p_local=0.1713 f1=0.493 auprc=0.788 bytes=10795
[S2] START round=20 head_norm_before_train=1.658638 cos_to_last_merge=0.7957 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.796
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6906888035405911, 'auprc': 0.7705257524941207, 'loss_val': 0.7183759801196509, 'psi': 0.7226235831220029}-{'f1_val': 0.7132884337506978, 'auprc': 0.798908910032903, 'loss_val': 0.7202628254272158, 'psi': 0.7475366242635799}
[S3] START round=20 head_norm_before_train=1.647426 cos_to_last_merge=0.9983 (last merge round=17)
[S3] round=20 local utility u=0.026496 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9988709954183586, 'loss_val': 0.26576033395450405, 'psi': 0.8200021204085233}-{'f1_val': 0.7007562037352997, 'auprc': 0.9988164675639178, 'loss_val': 0.31858945646299297, 'psi': 0.8199803092667469}
[S4] START round=20 head_norm_before_train=1.328772 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.055626 metrics={'f1_val': 0.9558220519007794, 'auprc': 0.9613229579912075, 'loss_val': 0.26266178669504187, 'psi': 0.9580224143369506}-{'f1_val': 0.9405913686964222, 'auprc': 0.9610732114631827, 'loss_val': 0.28178025173527793, 'psi': 0.9487841058031263}
[S5] START round=20 head_norm_before_train=1.672404 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7937186876650641, 'loss_val': 0.4303532401566501, 'psi': 0.7461675146386308}-{'f1_val': 0.7237615750615479, 'auprc': 0.8371495207966817, 'loss_val': 0.33905558380453554, 'psi': 0.7691167533556014}
[S6] START round=20 head_norm_before_train=1.851905 (no previous merge yet)
[S6] round=20 local utility u=0.692797 metrics={'f1_val': 0.9857034181171357, 'auprc': 0.9788576825220472, 'loss_val': 0.11998993631594411, 'psi': 0.9829651238791004}-{'f1_val': 0.8281370660857325, 'auprc': 0.9602712321931166, 'loss_val': 0.5044254732553293, 'psi': 0.8809907325286861}
[S7] START round=20 head_norm_before_train=1.295245 cos_to_last_merge=0.8447 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.845
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.61012472897454, 'auprc': 0.7924218640991643, 'loss_val': 0.623599138247088, 'psi': 0.6830435830243897}-{'f1_val': 0.6690702798966826, 'auprc': 0.8044185124597201, 'loss_val': 0.5254938078281135, 'psi': 0.7232095729218976}
[S8] START round=20 head_norm_before_train=1.761004 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.044095 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9986451395554137, 'loss_val': 0.05792526939503999, 'psi': 0.9950401501581336}-{'f1_val': 0.9818761851478031, 'auprc': 0.9990943223822591, 'loss_val': 0.08289977451553794, 'psi': 0.9887634400415855}
[S9] START round=20 head_norm_before_train=1.764162 (no previous merge yet)
[S9] round=20 local utility u=0.011929 metrics={'f1_val': 0.7011111564128257, 'auprc': 0.9983331726180689, 'loss_val': 0.18618357066471627, 'psi': 0.819999962894923}-{'f1_val': 0.7013613595118124, 'auprc': 0.9981642795775957, 'loss_val': 0.21103542151278226, 'psi': 0.8200825275381258}
[S10] START round=20 head_norm_before_train=1.750229 cos_to_last_merge=0.8421 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.842
[S10] round=20 local utility u=0.001070 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955074231572127, 'loss_val': 0.032899114706452987, 'psi': 0.9953156726745099}-{'f1_val': 0.9949681865317428, 'auprc': 0.9956370321737418, 'loss_val': 0.034110898385402426, 'psi': 0.9952357247885424}
[S11] START round=20 head_norm_before_train=1.031487 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9946276959709248, 'loss_val': 0.3735999568483608, 'psi': 0.819012268367362}-{'f1_val': 0.7019353166316534, 'auprc': 0.9966512802922824, 'loss_val': 0.3751463045677121, 'psi': 0.8198217020959051}
[S13] START round=20 head_norm_before_train=1.766850 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5787088375910256, 'auprc': 0.7149640489959761, 'loss_val': 0.9763783573078139, 'psi': 0.6332109221530058}-{'f1_val': 0.6103081523526428, 'auprc': 0.7241349346285721, 'loss_val': 0.7854404313732164, 'psi': 0.6558388652630145}
[S14] START round=20 head_norm_before_train=0.936516 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9945372764652619, 'auprc': 0.9970839577944859, 'loss_val': 0.4013135364467063, 'psi': 0.9955559489969515}-{'f1_val': 0.9963708792816148, 'auprc': 0.9970622352929455, 'loss_val': 0.34186351806896575, 'psi': 0.9966474216861472}
[S15] START round=20 head_norm_before_train=1.052972 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.062409 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9971431359781493, 'loss_val': 0.16254106354077177, 'psi': 0.9969052554237721}-{'f1_val': 0.9778625816456512, 'auprc': 0.9974953307565615, 'loss_val': 0.17511061629230845, 'psi': 0.9857156812900153}
[S16] START round=20 head_norm_before_train=1.242351 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8783601208237037, 'auprc': 0.9515755408267632, 'loss_val': 0.40820594407688016, 'psi': 0.9076462888249275}-{'f1_val': 0.9083098881778031, 'auprc': 0.983433441764009, 'loss_val': 0.5446852336270492, 'psi': 0.9383593096122855}
[S17] START round=20 head_norm_before_train=1.179093 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.185547 metrics={'f1_val': 0.5378658822028957, 'auprc': 0.8089421540418953, 'loss_val': 0.7571002951243394, 'psi': 0.6462963909384956}-{'f1_val': 0.4931911817789264, 'auprc': 0.7880147270014541, 'loss_val': 0.7973643216920651, 'psi': 0.6111205998679375}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.820)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:45903
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] cosine check vs S6: cos=-0.0760
[S17] DROPPED delta from S6 (cos=-0.0760 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=0.5152
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=0.9721
[S17] not sending this round → trigger blocked (psi=0.646)
[S13] ⇄ pheromone p=0.096 → S2@127.0.0.1:45902
[S10] ⇄ pheromone p=0.052 → S8@127.0.0.1:45909
[S5] ⇄ pheromone p=0.126 → S16@127.0.0.1:45916
[S7] ⇄ pheromone p=0.243 → S4@127.0.0.1:45904
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9945 head_norm=0.981836
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.084741e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9936 head_norm=1.034756 delta_norm=0.608474
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.110 → S11@127.0.0.1:45912
[S2] ⇄ pheromone p=0.068 → S17@127.0.0.1:45917
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.7008 head_norm=1.676931
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.138194e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.7008 head_norm=1.724897 delta_norm=0.213819
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.122 → S17@127.0.0.1:45917
[S15] ⇄ pheromone p=0.213 → S13@127.0.0.1:45913
[S11] ⇄ pheromone p=0.067 → S16@127.0.0.1:45916
[S9] ⇄ pheromone p=0.036 → S16@127.0.0.1:45916
[S4] ⇄ pheromone p=0.105 → S14@127.0.0.1:45914
[S6] ⇄ pheromone p=0.348 → S17@127.0.0.1:45917
[S8] ⇄ pheromone p=0.128 → S3@127.0.0.1:45903
[S16] ⇄ pheromone p=0.267 → S15@127.0.0.1:45915
[S17] ⇄ pheromone p=0.174 → S14@127.0.0.1:45914
[S2] START round=21 head_norm_before_train=1.685230 cos_to_last_merge=0.7920 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=21 local utility u=0.082037 metrics={'f1_val': 0.7127423726264086, 'auprc': 0.7902902994919656, 'loss_val': 0.7459172309962461, 'psi': 0.7437615433726315}-{'f1_val': 0.6906888035405911, 'auprc': 0.7705257524941207, 'loss_val': 0.7183759801196509, 'psi': 0.7226235831220029}
[S3] START round=21 head_norm_before_train=1.724897 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.793768 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9992368158391847, 'loss_val': 0.24147532403209082, 'psi': 0.9763638806763653}-{'f1_val': 0.7007562037352997, 'auprc': 0.9988709954183586, 'loss_val': 0.26576033395450405, 'psi': 0.8200021204085233}
[S4] START round=21 head_norm_before_train=1.384889 cos_to_last_merge=0.9970 (last merge round=19)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9415472672984093, 'auprc': 0.9660070643302421, 'loss_val': 0.27594355950841887, 'psi': 0.9513311861111424}-{'f1_val': 0.9558220519007794, 'auprc': 0.9613229579912075, 'loss_val': 0.26266178669504187, 'psi': 0.9580224143369506}
[S5] START round=21 head_norm_before_train=1.687353 (no previous merge yet)
[S5] round=21 local utility u=0.060592 metrics={'f1_val': 0.7153523649613975, 'auprc': 0.8089180199493781, 'loss_val': 0.3600813739827024, 'psi': 0.7527786269565897}-{'f1_val': 0.7144667326210086, 'auprc': 0.7937186876650641, 'loss_val': 0.4303532401566501, 'psi': 0.7461675146386308}
[S6] START round=21 head_norm_before_train=1.866709 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6196637467062829, 'auprc': 0.9239348356254455, 'loss_val': 0.8784671644670684, 'psi': 0.741372182273948}-{'f1_val': 0.9857034181171357, 'auprc': 0.9788576825220472, 'loss_val': 0.11998993631594411, 'psi': 0.9829651238791004}
[S7] START round=21 head_norm_before_train=1.306854 cos_to_last_merge=0.8423 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.842
[S7] round=21 local utility u=0.059373 metrics={'f1_val': 0.6248206112728427, 'auprc': 0.7947976915200511, 'loss_val': 0.600156292588516, 'psi': 0.6928114433717261}-{'f1_val': 0.61012472897454, 'auprc': 0.7924218640991643, 'loss_val': 0.623599138247088, 'psi': 0.6830435830243897}
[S8] START round=21 head_norm_before_train=1.797187 cos_to_last_merge=0.9997 (last merge round=19)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9839949576420534, 'auprc': 0.9991354187254673, 'loss_val': 0.06527799770012344, 'psi': 0.990051142075419}-{'f1_val': 0.9926368238932805, 'auprc': 0.9986451395554137, 'loss_val': 0.05792526939503999, 'psi': 0.9950401501581336}
[S9] START round=21 head_norm_before_train=1.777194 (no previous merge yet)
[S9] round=21 local utility u=0.013245 metrics={'f1_val': 0.7011840123541024, 'auprc': 0.9983676314605565, 'loss_val': 0.16023500411351352, 'psi': 0.8200574599966841}-{'f1_val': 0.7011111564128257, 'auprc': 0.9983331726180689, 'loss_val': 0.18618357066471627, 'psi': 0.819999962894923}
[S10] START round=21 head_norm_before_train=1.769214 cos_to_last_merge=0.8414 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.841
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955541181280987, 'loss_val': 0.03228330024392826, 'psi': 0.9949391113302761}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955074231572127, 'loss_val': 0.032899114706452987, 'psi': 0.9953156726745099}
[S11] START round=21 head_norm_before_train=1.076251 cos_to_last_merge=0.9966 (last merge round=19)
[S11] round=21 local utility u=0.818701 metrics={'f1_val': 0.9573527113557667, 'auprc': 0.9946545754016854, 'loss_val': 0.26878359579672095, 'psi': 0.9722734569741343}-{'f1_val': 0.7019353166316534, 'auprc': 0.9946276959709248, 'loss_val': 0.3735999568483608, 'psi': 0.819012268367362}
[S13] START round=21 head_norm_before_train=1.786040 (no previous merge yet)
[S13] round=21 local utility u=0.094146 metrics={'f1_val': 0.6123371459780448, 'auprc': 0.7354334726027967, 'loss_val': 1.0512645453451874, 'psi': 0.6615756766279455}-{'f1_val': 0.5787088375910256, 'auprc': 0.7149640489959761, 'loss_val': 0.9763783573078139, 'psi': 0.6332109221530058}
[S14] START round=21 head_norm_before_train=1.034756 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.052232 metrics={'f1_val': 0.996683016289686, 'auprc': 0.9970615373652401, 'loss_val': 0.30965605554113745, 'psi': 0.9968344247199077}-{'f1_val': 0.9945372764652619, 'auprc': 0.9970839577944859, 'loss_val': 0.4013135364467063, 'psi': 0.9955559489969515}
[S15] START round=21 head_norm_before_train=1.147929 cos_to_last_merge=0.9944 (last merge round=19)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.9756053967650848, 'auprc': 0.9983848871251336, 'loss_val': 0.12959473617996742, 'psi': 0.9847171929091043}-{'f1_val': 0.9967466683875206, 'auprc': 0.9971431359781493, 'loss_val': 0.16254106354077177, 'psi': 0.9969052554237721}
[S16] START round=21 head_norm_before_train=1.286624 cos_to_last_merge=0.9982 (last merge round=19)
[S16] round=21 local utility u=0.428204 metrics={'f1_val': 0.9742088594950379, 'auprc': 0.9908457732089836, 'loss_val': 0.24470185142954826, 'psi': 0.9808636249806162}-{'f1_val': 0.8783601208237037, 'auprc': 0.9515755408267632, 'loss_val': 0.40820594407688016, 'psi': 0.9076462888249275}
[S17] START round=21 head_norm_before_train=1.233118 cos_to_last_merge=0.9973 (last merge round=19)
[S17] round=21 local utility u=0.065157 metrics={'f1_val': 0.5492734932758772, 'auprc': 0.8231835470765595, 'loss_val': 0.7379567080697951, 'psi': 0.65883751479615}-{'f1_val': 0.5378658822028957, 'auprc': 0.8089421540418953, 'loss_val': 0.7571002951243394, 'psi': 0.6462963909384956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:45917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:45916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] cosine check vs S3: cos=0.7532
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] cosine check vs S11: cos=0.2548
[S17] RECEIVED delta(kind=head bytes=1803) from S2
[S17] cosine check vs S2: cos=0.5382
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.4423
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9607
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.9000
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.9385
[S15] RECEIVED delta(kind=head bytes=1792) from S16
[S15] cosine check vs S16: cos=0.8487
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] cosine check vs S13: cos=-0.0057
[S2] DROPPED delta from S13 (cos=-0.0057 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.3590
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9415 head_norm=1.436461
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.016065e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9417 head_norm=1.364098 delta_norm=0.201606
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9967 head_norm=1.089141
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.745242e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9958 head_norm=0.977062 delta_norm=0.674524
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9742 head_norm=1.326331
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.675346e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9710 head_norm=1.085366 delta_norm=0.367535
[S16] aggregate: ACCEPT kept=['S11', 'S5', 'S9'] (k=3/3) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9574 head_norm=1.126151
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.950447e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9535 head_norm=1.090495 delta_norm=0.195045
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.9756 head_norm=1.241836
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.555383e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9675 head_norm=1.234604 delta_norm=0.355538
[S15] aggregate: ROLLBACK (f1_val pre=0.976 post=0.968 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.5493 head_norm=1.277904
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.279415e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.5580 head_norm=1.218717 delta_norm=0.227941
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.712503 cos_to_last_merge=0.7879 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.788
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6951552358488252, 'auprc': 0.773654054239691, 'loss_val': 0.7371053800933918, 'psi': 0.7265547632051715}-{'f1_val': 0.7127423726264086, 'auprc': 0.7902902994919656, 'loss_val': 0.7459172309962461, 'psi': 0.7437615433726315}
[S3] START round=22 head_norm_before_train=1.754653 cos_to_last_merge=0.9995 (last merge round=20)
[S3] round=22 local utility u=0.025346 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9983082091328114, 'loss_val': 0.18497251310321428, 'psi': 0.9756898441019979}-{'f1_val': 0.9611152572344858, 'auprc': 0.9992368158391847, 'loss_val': 0.24147532403209082, 'psi': 0.9763638806763653}
[S4] START round=22 head_norm_before_train=1.364098 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9397580868023034, 'auprc': 0.9606681139532267, 'loss_val': 0.2912298211567434, 'psi': 0.9481220976626727}-{'f1_val': 0.9415472672984093, 'auprc': 0.9660070643302421, 'loss_val': 0.27594355950841887, 'psi': 0.9513311861111424}
[S5] START round=22 head_norm_before_train=1.694606 (no previous merge yet)
[S5] round=22 local utility u=0.395079 metrics={'f1_val': 0.7443696309991285, 'auprc': 0.9763778601319766, 'loss_val': 0.24640588107419736, 'psi': 0.8371729226522677}-{'f1_val': 0.7153523649613975, 'auprc': 0.8089180199493781, 'loss_val': 0.3600813739827024, 'psi': 0.7527786269565897}
[S6] START round=22 head_norm_before_train=1.883940 (no previous merge yet)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.9595408024407797, 'auprc': 0.9813907020620508, 'loss_val': 0.16023523096180714, 'psi': 0.9682807622892882}-{'f1_val': 0.6196637467062829, 'auprc': 0.9239348356254455, 'loss_val': 0.8784671644670684, 'psi': 0.741372182273948}
[S7] START round=22 head_norm_before_train=1.318862 cos_to_last_merge=0.8399 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.840
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5853665690183003, 'auprc': 0.7869199931408587, 'loss_val': 0.6811646286711905, 'psi': 0.6659879386673238}-{'f1_val': 0.6248206112728427, 'auprc': 0.7947976915200511, 'loss_val': 0.600156292588516, 'psi': 0.6928114433717261}
[S8] START round=22 head_norm_before_train=1.829160 cos_to_last_merge=0.9989 (last merge round=19)
[S8] round=22 local utility u=0.020872 metrics={'f1_val': 0.9884946976640797, 'auprc': 0.9992862644338892, 'loss_val': 0.05098521483304503, 'psi': 0.9928113243720035}-{'f1_val': 0.9839949576420534, 'auprc': 0.9991354187254673, 'loss_val': 0.06527799770012344, 'psi': 0.990051142075419}
[S9] START round=22 head_norm_before_train=1.790065 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.7011840123541024, 'auprc': 0.9983592116023317, 'loss_val': 0.16784280092448925, 'psi': 0.8200540920533941}-{'f1_val': 0.7011840123541024, 'auprc': 0.9983676314605565, 'loss_val': 0.16023500411351352, 'psi': 0.8200574599966841}
[S10] START round=22 head_norm_before_train=1.788841 cos_to_last_merge=0.8404 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.840
[S10] round=22 local utility u=0.000251 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955719028340145, 'loss_val': 0.03183561415206697, 'psi': 0.9949462252126424}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955541181280987, 'loss_val': 0.03228330024392826, 'psi': 0.9949391113302761}
[S11] START round=22 head_norm_before_train=1.090495 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.107808 metrics={'f1_val': 0.995882955255567, 'auprc': 0.9944795805433412, 'loss_val': 0.28382502726936726, 'psi': 0.9953216053706767}-{'f1_val': 0.9573527113557667, 'auprc': 0.9946545754016854, 'loss_val': 0.26878359579672095, 'psi': 0.9722734569741343}
[S13] START round=22 head_norm_before_train=1.803637 (no previous merge yet)
[S13] round=22 local utility u=0.309064 metrics={'f1_val': 0.6515357062587752, 'auprc': 0.7167038317760226, 'loss_val': 0.6121383233367658, 'psi': 0.6776029564656741}-{'f1_val': 0.6123371459780448, 'auprc': 0.7354334726027967, 'loss_val': 1.0512645453451874, 'psi': 0.6615756766279455}
[S14] START round=22 head_norm_before_train=0.977062 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9962385626389639, 'loss_val': 0.373407744600743, 'psi': 0.9964477640220357}-{'f1_val': 0.996683016289686, 'auprc': 0.9970615373652401, 'loss_val': 0.30965605554113745, 'psi': 0.9968344247199077}
[S15] START round=22 head_norm_before_train=1.234604 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.9030444739236343, 'auprc': 0.9965959964844942, 'loss_val': 0.22125363282589344, 'psi': 0.9404650829479783}-{'f1_val': 0.9756053967650848, 'auprc': 0.9983848871251336, 'loss_val': 0.12959473617996742, 'psi': 0.9847171929091043}
[S16] START round=22 head_norm_before_train=1.085366 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9064693457315375, 'auprc': 0.991756641407752, 'loss_val': 0.4828174230560283, 'psi': 0.9405842640020232}-{'f1_val': 0.9742088594950379, 'auprc': 0.9908457732089836, 'loss_val': 0.24470185142954826, 'psi': 0.9808636249806162}
[S17] START round=22 head_norm_before_train=1.218717 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.4165922978247508, 'auprc': 0.8076959998145127, 'loss_val': 0.8285243170238533, 'psi': 0.5730337786206556}-{'f1_val': 0.5492734932758772, 'auprc': 0.8231835470765595, 'loss_val': 0.7379567080697951, 'psi': 0.65883751479615}
[S5] not sending this round → trigger blocked (psi=0.837)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.678)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:45909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.976)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:45917
[S6] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=-0.0710
[S17] DROPPED delta from S6 (cos=-0.0710 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.9880
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.9916
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9606 head_norm=1.785602
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.459664e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9323 head_norm=1.817227 delta_norm=0.145966
[S3] aggregate: ROLLBACK (f1_val pre=0.961 post=0.932 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9885 head_norm=1.859802
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.215229e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9885 head_norm=1.828790 delta_norm=0.121523
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.740415 cos_to_last_merge=0.7839 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=23 local utility u=0.008004 metrics={'f1_val': 0.6932864461894709, 'auprc': 0.7780264948443574, 'loss_val': 0.7230026476099229, 'psi': 0.7271824656514254}-{'f1_val': 0.6951552358488252, 'auprc': 0.773654054239691, 'loss_val': 0.7371053800933918, 'psi': 0.7265547632051715}
[S3] START round=23 head_norm_before_train=1.817227 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.126290 metrics={'f1_val': 0.9965948885374674, 'auprc': 0.999515009234576, 'loss_val': 0.15191644603810167, 'psi': 0.9977629368163109}-{'f1_val': 0.9606109340814555, 'auprc': 0.9983082091328114, 'loss_val': 0.18497251310321428, 'psi': 0.9756898441019979}
[S4] START round=23 head_norm_before_train=1.412671 cos_to_last_merge=0.9974 (last merge round=21)
[S4] round=23 local utility u=0.056810 metrics={'f1_val': 0.9549567778573442, 'auprc': 0.9590301409772013, 'loss_val': 0.26388894259418866, 'psi': 0.956586123105287}-{'f1_val': 0.9397580868023034, 'auprc': 0.9606681139532267, 'loss_val': 0.2912298211567434, 'psi': 0.9481220976626727}
[S5] START round=23 head_norm_before_train=1.699914 (no previous merge yet)
[S5] round=23 local utility u=0.647234 metrics={'f1_val': 0.9388920610016522, 'auprc': 0.9975761253982461, 'loss_val': 0.18266711702793076, 'psi': 0.9623656867602898}-{'f1_val': 0.7443696309991285, 'auprc': 0.9763778601319766, 'loss_val': 0.24640588107419736, 'psi': 0.8371729226522677}
[S6] START round=23 head_norm_before_train=1.893746 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6119116463411133, 'auprc': 0.664669512747207, 'loss_val': 1.3331765153672799, 'psi': 0.6330147929035508}-{'f1_val': 0.9595408024407797, 'auprc': 0.9813907020620508, 'loss_val': 0.16023523096180714, 'psi': 0.9682807622892882}
[S7] START round=23 head_norm_before_train=1.333932 cos_to_last_merge=0.8370 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.837
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.581553000630656, 'auprc': 0.786021510379239, 'loss_val': 0.6842648302748283, 'psi': 0.6633404045300891}-{'f1_val': 0.5853665690183003, 'auprc': 0.7869199931408587, 'loss_val': 0.6811646286711905, 'psi': 0.6659879386673238}
[S8] START round=23 head_norm_before_train=1.828790 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9154491289875578, 'auprc': 0.9859712153201957, 'loss_val': 0.13074720402814474, 'psi': 0.9436579635206129}-{'f1_val': 0.9884946976640797, 'auprc': 0.9992862644338892, 'loss_val': 0.05098521483304503, 'psi': 0.9928113243720035}
[S9] START round=23 head_norm_before_train=1.802387 (no previous merge yet)
[S9] round=23 local utility u=0.865057 metrics={'f1_val': 0.9842492060140275, 'auprc': 0.9983577858766963, 'loss_val': 0.1361165886105043, 'psi': 0.9898926379590951}-{'f1_val': 0.7011840123541024, 'auprc': 0.9983592116023317, 'loss_val': 0.16784280092448925, 'psi': 0.8200540920533941}
[S10] START round=23 head_norm_before_train=1.805441 cos_to_last_merge=0.8397 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.840
[S10] round=23 local utility u=0.000238 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9956170577788478, 'loss_val': 0.03149545407782055, 'psi': 0.9949642871905757}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955719028340145, 'loss_val': 0.03183561415206697, 'psi': 0.9949462252126424}
[S11] START round=23 head_norm_before_train=1.135900 cos_to_last_merge=0.9978 (last merge round=21)
[S11] round=23 local utility u=0.028294 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9952912691230693, 'loss_val': 0.23365540590713105, 'psi': 0.9960447103573815}-{'f1_val': 0.995882955255567, 'auprc': 0.9944795805433412, 'loss_val': 0.28382502726936726, 'psi': 0.9953216053706767}
[S13] START round=23 head_norm_before_train=1.816051 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5912637259505431, 'auprc': 0.6066249692270552, 'loss_val': 1.1040353257752613, 'psi': 0.597408223261148}-{'f1_val': 0.6515357062587752, 'auprc': 0.7167038317760226, 'loss_val': 0.6121383233367658, 'psi': 0.6776029564656741}
[S14] START round=23 head_norm_before_train=1.020870 cos_to_last_merge=0.9967 (last merge round=21)
[S14] round=23 local utility u=0.043215 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.997432103604928, 'loss_val': 0.2920148892191382, 'psi': 0.997070889537298}-{'f1_val': 0.9965872316107504, 'auprc': 0.9962385626389639, 'loss_val': 0.373407744600743, 'psi': 0.9964477640220357}
[S15] START round=23 head_norm_before_train=1.307787 cos_to_last_merge=0.9975 (last merge round=21)
[S15] round=23 local utility u=0.018500 metrics={'f1_val': 0.9165290515568407, 'auprc': 0.9899763834957116, 'loss_val': 0.2453020548133093, 'psi': 0.945907984332389}-{'f1_val': 0.9030444739236343, 'auprc': 0.9965959964844942, 'loss_val': 0.22125363282589344, 'psi': 0.9404650829479783}
[S16] START round=23 head_norm_before_train=1.124951 cos_to_last_merge=0.9986 (last merge round=21)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8820996056682958, 'auprc': 0.9924008717754369, 'loss_val': 0.4793579485614141, 'psi': 0.9262201121111522}-{'f1_val': 0.9064693457315375, 'auprc': 0.991756641407752, 'loss_val': 0.4828174230560283, 'psi': 0.9405842640020232}
[S17] START round=23 head_norm_before_train=1.258626 cos_to_last_merge=0.9984 (last merge round=21)
[S17] round=23 local utility u=0.445105 metrics={'f1_val': 0.5035217764059873, 'auprc': 0.8866367194422722, 'loss_val': 0.6967129332750744, 'psi': 0.6567677536205012}-{'f1_val': 0.4165922978247508, 'auprc': 0.8076959998145127, 'loss_val': 0.8285243170238533, 'psi': 0.5730337786206556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:45917
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:45912
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S3
[S17] cosine check vs S3: cos=0.7169
[S17] RECEIVED delta(kind=head bytes=1804) from S2
[S17] cosine check vs S2: cos=0.6029
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=-0.0843
[S13] DROPPED delta from S15 (cos=-0.0843 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.5124
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=0.5040
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.4024
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=0.8175
[S11] RECEIVED delta(kind=head bytes=1806) from S14
[S11] cosine check vs S14: cos=0.7877
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.8108
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9965 head_norm=1.186523
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.710617e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9965 head_norm=1.063392 delta_norm=0.371062
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9968 head_norm=1.062611
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.014230e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9966 head_norm=0.996954 delta_norm=0.201423
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.8821 head_norm=1.171098
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.381764e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.8808 head_norm=1.040051 delta_norm=0.238176
[S16] aggregate: ACCEPT kept=['S5', 'S11', 'S9'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.5035 head_norm=1.308463
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.927251e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6629 head_norm=1.262952 delta_norm=0.192725
[S17] aggregate: ACCEPT kept=['S3', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.757813 cos_to_last_merge=0.7816 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.6482532629127836, 'auprc': 0.6608557661114757, 'loss_val': 1.284581628277272, 'psi': 0.6532942641922604}-{'f1_val': 0.6932864461894709, 'auprc': 0.7780264948443574, 'loss_val': 0.7230026476099229, 'psi': 0.7271824656514254}
[S3] START round=24 head_norm_before_train=1.843340 cos_to_last_merge=0.9997 (last merge round=22)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9613297054499484, 'auprc': 0.9984840444586832, 'loss_val': 0.13609267128912256, 'psi': 0.9761914410534425}-{'f1_val': 0.9965948885374674, 'auprc': 0.999515009234576, 'loss_val': 0.15191644603810167, 'psi': 0.9977629368163109}
[S4] START round=24 head_norm_before_train=1.455359 cos_to_last_merge=0.9930 (last merge round=21)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9422527803107869, 'auprc': 0.9777050230392228, 'loss_val': 0.27829482265045796, 'psi': 0.9564336774021612}-{'f1_val': 0.9549567778573442, 'auprc': 0.9590301409772013, 'loss_val': 0.26388894259418866, 'psi': 0.956586123105287}
[S5] START round=24 head_norm_before_train=1.708440 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.8985040533633513, 'auprc': 0.9968264887102736, 'loss_val': 0.17880925251351118, 'psi': 0.9378330275021203}-{'f1_val': 0.9388920610016522, 'auprc': 0.9975761253982461, 'loss_val': 0.18266711702793076, 'psi': 0.9623656867602898}
[S6] START round=24 head_norm_before_train=1.901890 (no previous merge yet)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.7885723163153342, 'auprc': 0.9498191339191857, 'loss_val': 0.5966973474611549, 'psi': 0.8530710433568749}-{'f1_val': 0.6119116463411133, 'auprc': 0.664669512747207, 'loss_val': 1.3331765153672799, 'psi': 0.6330147929035508}
[S7] START round=24 head_norm_before_train=1.352747 cos_to_last_merge=0.8335 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.833
[S7] round=24 local utility u=0.678453 metrics={'f1_val': 0.695905035108028, 'auprc': 0.8930622916119425, 'loss_val': 0.334594076748192, 'psi': 0.7747679377095938}-{'f1_val': 0.581553000630656, 'auprc': 0.786021510379239, 'loss_val': 0.6842648302748283, 'psi': 0.6633404045300891}
[S8] START round=24 head_norm_before_train=1.854463 cos_to_last_merge=0.9999 (last merge round=22)
[S8] round=24 local utility u=0.217907 metrics={'f1_val': 0.9726474255219062, 'auprc': 0.9989693687953386, 'loss_val': 0.07711662283536824, 'psi': 0.9831762028312792}-{'f1_val': 0.9154491289875578, 'auprc': 0.9859712153201957, 'loss_val': 0.13074720402814474, 'psi': 0.9436579635206129}
[S9] START round=24 head_norm_before_train=1.814623 (no previous merge yet)
[S9] round=24 local utility u=0.047576 metrics={'f1_val': 0.9963396080778921, 'auprc': 0.9986803648822903, 'loss_val': 0.11447414528293828, 'psi': 0.9972759107996514}-{'f1_val': 0.9842492060140275, 'auprc': 0.9983577858766963, 'loss_val': 0.1361165886105043, 'psi': 0.9898926379590951}
[S10] START round=24 head_norm_before_train=1.823660 cos_to_last_merge=0.8387 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.839
[S10] round=24 local utility u=0.002158 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995282353704916, 'loss_val': 0.030128675468793224, 'psi': 0.9952256448935912}-{'f1_val': 0.9945291067983943, 'auprc': 0.9956170577788478, 'loss_val': 0.03149545407782055, 'psi': 0.9949642871905757}
[S11] START round=24 head_norm_before_train=1.063392 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9960431236482412, 'loss_val': 0.26349022319390214, 'psi': 0.9963454521674502}-{'f1_val': 0.9965470045135896, 'auprc': 0.9952912691230693, 'loss_val': 0.23365540590713105, 'psi': 0.9960447103573815}
[S13] START round=24 head_norm_before_train=1.825327 (no previous merge yet)
[S13] round=24 local utility u=0.880263 metrics={'f1_val': 0.7391786323725895, 'auprc': 0.7323432913058128, 'loss_val': 0.6081539689346236, 'psi': 0.7364444959458789}-{'f1_val': 0.5912637259505431, 'auprc': 0.6066249692270552, 'loss_val': 1.1040353257752613, 'psi': 0.597408223261148}
[S14] START round=24 head_norm_before_train=0.996954 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9969928679178464, 'loss_val': 0.29474743163575773, 'psi': 0.9967631551327929}-{'f1_val': 0.9968300801588782, 'auprc': 0.997432103604928, 'loss_val': 0.2920148892191382, 'psi': 0.997070889537298}
[S15] START round=24 head_norm_before_train=1.374925 cos_to_last_merge=0.9923 (last merge round=21)
[S15] round=24 local utility u=0.133517 metrics={'f1_val': 0.9386322240572448, 'auprc': 0.9953023343959168, 'loss_val': 0.1268649997238273, 'psi': 0.9613002681927136}-{'f1_val': 0.9165290515568407, 'auprc': 0.9899763834957116, 'loss_val': 0.2453020548133093, 'psi': 0.945907984332389}
[S16] START round=24 head_norm_before_train=1.040051 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.144509 metrics={'f1_val': 0.9176565696330423, 'auprc': 0.9923770872874904, 'loss_val': 0.4036108991099699, 'psi': 0.9475447766948215}-{'f1_val': 0.8820996056682958, 'auprc': 0.9924008717754369, 'loss_val': 0.4793579485614141, 'psi': 0.9262201121111522}
[S17] START round=24 head_norm_before_train=1.262952 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.4346076386778591, 'auprc': 0.8372157840754822, 'loss_val': 0.7614406135901659, 'psi': 0.5956508968369084}-{'f1_val': 0.5035217764059873, 'auprc': 0.8866367194422722, 'loss_val': 0.6967129332750744, 'psi': 0.6567677536205012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:45903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.961)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:45904
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:45915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9561
[S2] RECEIVED delta(kind=head bytes=1806) from S13
[S2] cosine check vs S13: cos=-0.0054
[S2] DROPPED delta from S13 (cos=-0.0054 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.9924
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=-0.0721
[S17] DROPPED delta from S6 (cos=-0.0721 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.9954
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] cosine check vs S16: cos=0.9221
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9423 head_norm=1.491970
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.204216e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9425 head_norm=1.415604 delta_norm=0.220422
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9613 head_norm=1.866098
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.152927e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9609 head_norm=1.867842 delta_norm=0.115293
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9726 head_norm=1.876680
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.142531e-02
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9723 head_norm=1.854954 delta_norm=0.091425
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.9386 head_norm=1.432184
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.004763e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9239 head_norm=1.235993 delta_norm=0.300476
[S15] aggregate: ROLLBACK (f1_val pre=0.939 post=0.924 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.771614 cos_to_last_merge=0.7800 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=25 local utility u=0.630260 metrics={'f1_val': 0.7138852033534916, 'auprc': 0.8021684526095457, 'loss_val': 0.841791619895407, 'psi': 0.7491985030559132}-{'f1_val': 0.6482532629127836, 'auprc': 0.6608557661114757, 'loss_val': 1.284581628277272, 'psi': 0.6532942641922604}
[S3] START round=25 head_norm_before_train=1.867842 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.127646 metrics={'f1_val': 0.9969520501205896, 'auprc': 0.9999832333718595, 'loss_val': 0.09903133620621968, 'psi': 0.9981645234210975}-{'f1_val': 0.9613297054499484, 'auprc': 0.9984840444586832, 'loss_val': 0.13609267128912256, 'psi': 0.9761914410534425}
[S4] START round=25 head_norm_before_train=1.415604 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9411583097955265, 'auprc': 0.9596497383896259, 'loss_val': 0.2884066641216085, 'psi': 0.9485548812331663}-{'f1_val': 0.9422527803107869, 'auprc': 0.9777050230392228, 'loss_val': 0.27829482265045796, 'psi': 0.9564336774021612}
[S5] START round=25 head_norm_before_train=1.716716 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7145976896106117, 'auprc': 0.8183815333925462, 'loss_val': 0.31402867183895367, 'psi': 0.7561112271233854}-{'f1_val': 0.8985040533633513, 'auprc': 0.9968264887102736, 'loss_val': 0.17880925251351118, 'psi': 0.9378330275021203}
[S6] START round=25 head_norm_before_train=1.906162 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6150291771538899, 'auprc': 0.9000456771139926, 'loss_val': 1.0143462949367756, 'psi': 0.729035777137931}-{'f1_val': 0.7885723163153342, 'auprc': 0.9498191339191857, 'loss_val': 0.5966973474611549, 'psi': 0.8530710433568749}
[S7] START round=25 head_norm_before_train=1.370791 cos_to_last_merge=0.8302 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.830
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.4382141940058868, 'auprc': 0.7804182097211081, 'loss_val': 0.9918766066407305, 'psi': 0.5750958002919753}-{'f1_val': 0.695905035108028, 'auprc': 0.8930622916119425, 'loss_val': 0.334594076748192, 'psi': 0.7747679377095938}
[S8] START round=25 head_norm_before_train=1.854954 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.072058 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9992193245878449, 'loss_val': 0.05003256560168237, 'psi': 0.9949044359370892}-{'f1_val': 0.9726474255219062, 'auprc': 0.9989693687953386, 'loss_val': 0.07711662283536824, 'psi': 0.9831762028312792}
[S9] START round=25 head_norm_before_train=1.827074 (no previous merge yet)
[S9] round=25 local utility u=0.009174 metrics={'f1_val': 0.997169633649706, 'auprc': 0.9986673994877658, 'loss_val': 0.10106701856628814, 'psi': 0.99776873998493}-{'f1_val': 0.9963396080778921, 'auprc': 0.9986803648822903, 'loss_val': 0.11447414528293828, 'psi': 0.9972759107996514}
[S10] START round=25 head_norm_before_train=1.837524 cos_to_last_merge=0.8383 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.838
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9951975615356758, 'loss_val': 0.03066549002141041, 'psi': 0.994796488693307}-{'f1_val': 0.9951878390193748, 'auprc': 0.995282353704916, 'loss_val': 0.030128675468793224, 'psi': 0.9952256448935912}
[S11] START round=25 head_norm_before_train=1.114507 cos_to_last_merge=0.9975 (last merge round=23)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9856850132646968, 'auprc': 0.9960476345087071, 'loss_val': 0.20037164788234682, 'psi': 0.9898300617623009}-{'f1_val': 0.9965470045135896, 'auprc': 0.9960431236482412, 'loss_val': 0.26349022319390214, 'psi': 0.9963454521674502}
[S13] START round=25 head_norm_before_train=1.831088 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.606074601343634, 'auprc': 0.6064799715687914, 'loss_val': 1.1862631464001365, 'psi': 0.606236749433697}-{'f1_val': 0.7391786323725895, 'auprc': 0.7323432913058128, 'loss_val': 0.6081539689346236, 'psi': 0.7364444959458789}
[S14] START round=25 head_norm_before_train=1.039738 cos_to_last_merge=0.9979 (last merge round=23)
[S14] round=25 local utility u=0.036802 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9969609043049954, 'loss_val': 0.22583687808891154, 'psi': 0.9972293234230335}-{'f1_val': 0.9966100132760906, 'auprc': 0.9969928679178464, 'loss_val': 0.29474743163575773, 'psi': 0.9967631551327929}
[S15] START round=25 head_norm_before_train=1.235993 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.187044 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976354103870897, 'loss_val': 0.1084634372886072, 'psi': 0.9971021651873482}-{'f1_val': 0.9386322240572448, 'auprc': 0.9953023343959168, 'loss_val': 0.1268649997238273, 'psi': 0.9613002681927136}
[S16] START round=25 head_norm_before_train=1.088475 cos_to_last_merge=0.9982 (last merge round=23)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8757985731890944, 'auprc': 0.9945650630106858, 'loss_val': 0.5094811812071299, 'psi': 0.923305169117731}-{'f1_val': 0.9176565696330423, 'auprc': 0.9923770872874904, 'loss_val': 0.4036108991099699, 'psi': 0.9475447766948215}
[S17] START round=25 head_norm_before_train=1.307506 cos_to_last_merge=0.9984 (last merge round=23)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5243905144642006, 'auprc': 0.7026683548317996, 'loss_val': 0.9201504476018675, 'psi': 0.5957016506112401}-{'f1_val': 0.4346076386778591, 'auprc': 0.8372157840754822, 'loss_val': 0.7614406135901659, 'psi': 0.5956508968369084}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:45913
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:45917
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:45917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S15
[S13] cosine check vs S15: cos=-0.0797
[S13] DROPPED delta from S15 (cos=-0.0797 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1805) from S2
[S17] cosine check vs S2: cos=0.6308
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.7453
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.9440
[S17] RECEIVED delta(kind=head bytes=1806) from S3
[S17] cosine check vs S3: cos=0.7044
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.376 → S17@127.0.0.1:45917
[S4] ⇄ pheromone p=0.042 → S14@127.0.0.1:45914
[S10] ⇄ pheromone p=0.017 → S8@127.0.0.1:45909
[S13] ⇄ pheromone p=0.212 → S2@127.0.0.1:45902
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9857 head_norm=1.171671
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.934337e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9822 head_norm=1.116029 delta_norm=0.193434
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.104 → S16@127.0.0.1:45916
[S5] ⇄ pheromone p=0.169 → S16@127.0.0.1:45916
[S7] ⇄ pheromone p=0.193 → S4@127.0.0.1:45904
[S8] ⇄ pheromone p=0.093 → S3@127.0.0.1:45903
[S15] ⇄ pheromone p=0.131 → S13@127.0.0.1:45913
[S3] ⇄ pheromone p=0.149 → S17@127.0.0.1:45917
[S2] ⇄ pheromone p=0.156 → S17@127.0.0.1:45917
[S9] ⇄ pheromone p=0.133 → S16@127.0.0.1:45916
[S14] ⇄ pheromone p=0.053 → S11@127.0.0.1:45912
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.5244 head_norm=1.347458
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.702281e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.5935 head_norm=1.297570 delta_norm=0.170228
[S17] aggregate: ACCEPT kept=['S2', 'S3'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.119 → S14@127.0.0.1:45914
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8758 head_norm=1.142241
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.242194e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8805 head_norm=1.398723 delta_norm=0.624219
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.146 → S15@127.0.0.1:45915
[S2] START round=26 head_norm_before_train=1.783433 cos_to_last_merge=0.7786 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7107521209605671, 'auprc': 0.8035367827992375, 'loss_val': 0.8278209623299013, 'psi': 0.7478659856960352}-{'f1_val': 0.7138852033534916, 'auprc': 0.8021684526095457, 'loss_val': 0.841791619895407, 'psi': 0.7491985030559132}
[S3] START round=26 head_norm_before_train=1.889768 cos_to_last_merge=0.9998 (last merge round=24)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9768927444904899, 'auprc': 0.9998584764498141, 'loss_val': 0.09529983506289938, 'psi': 0.9860790372742196}-{'f1_val': 0.9969520501205896, 'auprc': 0.9999832333718595, 'loss_val': 0.09903133620621968, 'psi': 0.9981645234210975}
[S4] START round=26 head_norm_before_train=1.438813 cos_to_last_merge=0.9995 (last merge round=24)
[S4] round=26 local utility u=0.010253 metrics={'f1_val': 0.9411255372134822, 'auprc': 0.9642918284969146, 'loss_val': 0.28163078068762476, 'psi': 0.9503920537268553}-{'f1_val': 0.9411583097955265, 'auprc': 0.9596497383896259, 'loss_val': 0.2884066641216085, 'psi': 0.9485548812331663}
[S5] START round=26 head_norm_before_train=1.723525 (no previous merge yet)
[S5] round=26 local utility u=1.000000 metrics={'f1_val': 0.9967726868314644, 'auprc': 0.997974470910506, 'loss_val': 0.12346737996546538, 'psi': 0.997253400463081}-{'f1_val': 0.7145976896106117, 'auprc': 0.8183815333925462, 'loss_val': 0.31402867183895367, 'psi': 0.7561112271233854}
[S6] START round=26 head_norm_before_train=1.915089 (no previous merge yet)
[S6] round=26 local utility u=0.410898 metrics={'f1_val': 0.6896596596275223, 'auprc': 0.9407372797874802, 'loss_val': 0.7624082625784421, 'psi': 0.7900907076915055}-{'f1_val': 0.6150291771538899, 'auprc': 0.9000456771139926, 'loss_val': 1.0143462949367756, 'psi': 0.729035777137931}
[S7] START round=26 head_norm_before_train=1.383223 cos_to_last_merge=0.8275 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.828
[S7] round=26 local utility u=0.875586 metrics={'f1_val': 0.6413001364325216, 'auprc': 0.799713159736986, 'loss_val': 0.5171049006032674, 'psi': 0.7046653457543074}-{'f1_val': 0.4382141940058868, 'auprc': 0.7804182097211081, 'loss_val': 0.9918766066407305, 'psi': 0.5750958002919753}
[S8] START round=26 head_norm_before_train=1.879857 cos_to_last_merge=0.9998 (last merge round=24)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9819183889919959, 'auprc': 0.9990608659126076, 'loss_val': 0.06427177780003017, 'psi': 0.9887753797602405}-{'f1_val': 0.992027843503252, 'auprc': 0.9992193245878449, 'loss_val': 0.05003256560168237, 'psi': 0.9949044359370892}
[S9] START round=26 head_norm_before_train=1.840498 (no previous merge yet)
[S9] round=26 local utility u=0.011663 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9986894411754639, 'loss_val': 0.07782450393351742, 'psi': 0.9977792832794292}-{'f1_val': 0.997169633649706, 'auprc': 0.9986673994877658, 'loss_val': 0.10106701856628814, 'psi': 0.99776873998493}
[S10] START round=26 head_norm_before_train=1.852414 cos_to_last_merge=0.8376 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.838
[S10] round=26 local utility u=0.000757 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9953437428884413, 'loss_val': 0.029589574243739862, 'psi': 0.9948549612344131}-{'f1_val': 0.9945291067983943, 'auprc': 0.9951975615356758, 'loss_val': 0.03066549002141041, 'psi': 0.994796488693307}
[S11] START round=26 head_norm_before_train=1.116029 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.980267291664415, 'auprc': 0.9980738790057173, 'loss_val': 0.22619186644496642, 'psi': 0.9873899266009358}-{'f1_val': 0.9856850132646968, 'auprc': 0.9960476345087071, 'loss_val': 0.20037164788234682, 'psi': 0.9898300617623009}
[S13] START round=26 head_norm_before_train=1.842208 (no previous merge yet)
[S13] round=26 local utility u=0.446793 metrics={'f1_val': 0.6949895640552223, 'auprc': 0.6629780856559364, 'loss_val': 0.9956621291541704, 'psi': 0.6821849726955079}-{'f1_val': 0.606074601343634, 'auprc': 0.6064799715687914, 'loss_val': 1.1862631464001365, 'psi': 0.606236749433697}
[S14] START round=26 head_norm_before_train=1.092275 cos_to_last_merge=0.9918 (last merge round=23)
[S14] round=26 local utility u=0.024938 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969632025751749, 'loss_val': 0.1735032819201386, 'psi': 0.9969837859246691}-{'f1_val': 0.9974082695017256, 'auprc': 0.9969609043049954, 'loss_val': 0.22583687808891154, 'psi': 0.9972293234230335}
[S15] START round=26 head_norm_before_train=1.301643 cos_to_last_merge=0.9983 (last merge round=24)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8869672468337704, 'auprc': 0.9961222365578504, 'loss_val': 0.25487753097552973, 'psi': 0.9306292427234023}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976354103870897, 'loss_val': 0.1084634372886072, 'psi': 0.9971021651873482}
[S16] START round=26 head_norm_before_train=1.398723 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.171698 metrics={'f1_val': 0.9109834802357945, 'auprc': 0.9928253480777951, 'loss_val': 0.37197558708295425, 'psi': 0.9437202273725948}-{'f1_val': 0.8757985731890944, 'auprc': 0.9945650630106858, 'loss_val': 0.5094811812071299, 'psi': 0.923305169117731}
[S17] START round=26 head_norm_before_train=1.297570 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.409492 metrics={'f1_val': 0.5564686401839509, 'auprc': 0.8449596826239631, 'loss_val': 0.7205096129335941, 'psi': 0.6718650571599558}-{'f1_val': 0.5243905144642006, 'auprc': 0.7026683548317996, 'loss_val': 0.9201504476018675, 'psi': 0.5957016506112401}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:45917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:45909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:45915
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:45914
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:45904
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:45902
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.6348
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9731
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.2693
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=-0.0694
[S17] DROPPED delta from S6 (cos=-0.0694 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] cosine check vs S16: cos=0.8883
[S8] RECEIVED delta(kind=head bytes=1803) from S10
[S8] cosine check vs S10: cos=0.9967
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=-0.0072
[S2] DROPPED delta from S13 (cos=-0.0072 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=0.6979
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9819 head_norm=1.906601
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.948969e-02
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9812 head_norm=1.885717 delta_norm=0.079490
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9970 head_norm=1.148345
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.133006e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9970 head_norm=1.055801 delta_norm=0.213301
[S14] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.8870 head_norm=1.369707
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.341421e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.8791 head_norm=1.366179 delta_norm=0.334142
[S15] aggregate: ROLLBACK (f1_val pre=0.887 post=0.879 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9411 head_norm=1.475234
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.712440e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9418 head_norm=1.424309 delta_norm=0.171244
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9110 head_norm=1.442253
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.652221e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9111 head_norm=1.266223 delta_norm=0.965222
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.798810 cos_to_last_merge=0.7768 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6985314210449587, 'auprc': 0.7902173455898551, 'loss_val': 0.7601459281320591, 'psi': 0.7352057908629173}-{'f1_val': 0.7107521209605671, 'auprc': 0.8035367827992375, 'loss_val': 0.8278209623299013, 'psi': 0.7478659856960352}
[S3] START round=27 head_norm_before_train=1.912712 cos_to_last_merge=0.9993 (last merge round=24)
[S3] round=27 local utility u=0.017219 metrics={'f1_val': 0.9812358185924561, 'auprc': 0.9984078535857881, 'loss_val': 0.08256871466740073, 'psi': 0.988104632589789}-{'f1_val': 0.9768927444904899, 'auprc': 0.9998584764498141, 'loss_val': 0.09529983506289938, 'psi': 0.9860790372742196}
[S4] START round=27 head_norm_before_train=1.424309 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.940829160711731, 'auprc': 0.9659312451648314, 'loss_val': 0.28995459721148253, 'psi': 0.950869994492971}-{'f1_val': 0.9411255372134822, 'auprc': 0.9642918284969146, 'loss_val': 0.28163078068762476, 'psi': 0.9503920537268553}
[S5] START round=27 head_norm_before_train=1.729120 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7181120699687974, 'auprc': 0.9938698416376232, 'loss_val': 0.22317597111401283, 'psi': 0.8284151786363276}-{'f1_val': 0.9967726868314644, 'auprc': 0.997974470910506, 'loss_val': 0.12346737996546538, 'psi': 0.997253400463081}
[S6] START round=27 head_norm_before_train=1.925652 (no previous merge yet)
[S6] round=27 local utility u=0.606597 metrics={'f1_val': 0.8456268922634491, 'auprc': 0.9467961477033009, 'loss_val': 0.5031938026079261, 'psi': 0.8860945944393899}-{'f1_val': 0.6896596596275223, 'auprc': 0.9407372797874802, 'loss_val': 0.7624082625784421, 'psi': 0.7900907076915055}
[S7] START round=27 head_norm_before_train=1.392711 cos_to_last_merge=0.8257 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.826
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6074630570295603, 'auprc': 0.7940795849212476, 'loss_val': 0.6351037424128332, 'psi': 0.6821096681862353}-{'f1_val': 0.6413001364325216, 'auprc': 0.799713159736986, 'loss_val': 0.5171049006032674, 'psi': 0.7046653457543074}
[S8] START round=27 head_norm_before_train=1.885717 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.042661 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9992412987626765, 'loss_val': 0.04452418580611279, 'psi': 0.9953508559281461}-{'f1_val': 0.9819183889919959, 'auprc': 0.9990608659126076, 'loss_val': 0.06427177780003017, 'psi': 0.9887753797602405}
[S9] START round=27 head_norm_before_train=1.855526 (no previous merge yet)
[S9] round=27 local utility u=0.007180 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9987788084929551, 'loss_val': 0.06373255272999295, 'psi': 0.9978150302064257}-{'f1_val': 0.9971725113487396, 'auprc': 0.9986894411754639, 'loss_val': 0.07782450393351742, 'psi': 0.9977792832794292}
[S10] START round=27 head_norm_before_train=1.867985 cos_to_last_merge=0.8368 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.837
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9952205701984257, 'loss_val': 0.030010531105771523, 'psi': 0.9948056921584069}-{'f1_val': 0.9945291067983943, 'auprc': 0.9953437428884413, 'loss_val': 0.029589574243739862, 'psi': 0.9948549612344131}
[S11] START round=27 head_norm_before_train=1.163394 cos_to_last_merge=0.9980 (last merge round=25)
[S11] round=27 local utility u=0.004857 metrics={'f1_val': 0.9747099311134789, 'auprc': 0.9965692161550394, 'loss_val': 0.178618727595265, 'psi': 0.983453645130103}-{'f1_val': 0.980267291664415, 'auprc': 0.9980738790057173, 'loss_val': 0.22619186644496642, 'psi': 0.9873899266009358}
[S13] START round=27 head_norm_before_train=1.853808 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6174935232320826, 'auprc': 0.6437946282936082, 'loss_val': 1.0494477321154483, 'psi': 0.628013965256693}-{'f1_val': 0.6949895640552223, 'auprc': 0.6629780856559364, 'loss_val': 0.9956621291541704, 'psi': 0.6821849726955079}
[S14] START round=27 head_norm_before_train=1.055801 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9963707085436114, 'auprc': 0.9955173875676468, 'loss_val': 0.21851381106814508, 'psi': 0.9960293801532256}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969632025751749, 'loss_val': 0.1735032819201386, 'psi': 0.9969837859246691}
[S15] START round=27 head_norm_before_train=1.366179 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.887335971744445, 'auprc': 0.9346146949021665, 'loss_val': 0.28106393458622164, 'psi': 0.9062474610075336}-{'f1_val': 0.8869672468337704, 'auprc': 0.9961222365578504, 'loss_val': 0.25487753097552973, 'psi': 0.9306292427234023}
[S16] START round=27 head_norm_before_train=1.266223 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.128150 metrics={'f1_val': 0.93909320798397, 'auprc': 0.9926154618620326, 'loss_val': 0.2837033816501782, 'psi': 0.9605021095351951}-{'f1_val': 0.9109834802357945, 'auprc': 0.9928253480777951, 'loss_val': 0.37197558708295425, 'psi': 0.9437202273725948}
[S17] START round=27 head_norm_before_train=1.326492 cos_to_last_merge=0.9991 (last merge round=25)
[S17] round=27 local utility u=0.235076 metrics={'f1_val': 0.6209684862337991, 'auprc': 0.8759733184295377, 'loss_val': 0.7303978324145275, 'psi': 0.7229704191120945}-{'f1_val': 0.5564686401839509, 'auprc': 0.8449596826239631, 'loss_val': 0.7205096129335941, 'psi': 0.6718650571599558}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:45917
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.886)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:45903
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.961)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S3
[S17] cosine check vs S3: cos=0.7055
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] cosine check vs S11: cos=0.2296
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=0.5927
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=0.9921
[S17] not sending this round → trigger blocked (psi=0.723)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9812 head_norm=1.936338
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.212728e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9716 head_norm=1.918468 delta_norm=0.121273
[S3] aggregate: ROLLBACK (f1_val pre=0.981 post=0.972 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.6210 head_norm=1.359361
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.861746e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.6846 head_norm=1.525712 delta_norm=0.686175
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9391 head_norm=1.304695
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.707106e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9383 head_norm=1.109864 delta_norm=0.570711
[S16] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.810167 cos_to_last_merge=0.7753 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.775
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7115036469992007, 'auprc': 0.7693622288515569, 'loss_val': 0.8172848955800105, 'psi': 0.7346470797401432}-{'f1_val': 0.6985314210449587, 'auprc': 0.7902173455898551, 'loss_val': 0.7601459281320591, 'psi': 0.7352057908629173}
[S3] START round=28 head_norm_before_train=1.918468 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9981237788745374, 'loss_val': 0.11549161180743749, 'psi': 0.975870662213081}-{'f1_val': 0.9812358185924561, 'auprc': 0.9984078535857881, 'loss_val': 0.08256871466740073, 'psi': 0.988104632589789}
[S4] START round=28 head_norm_before_train=1.465741 cos_to_last_merge=0.9983 (last merge round=26)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9313796526410592, 'auprc': 0.9543027112538491, 'loss_val': 0.3800013214366756, 'psi': 0.9405488760861751}-{'f1_val': 0.940829160711731, 'auprc': 0.9659312451648314, 'loss_val': 0.28995459721148253, 'psi': 0.950869994492971}
[S5] START round=28 head_norm_before_train=1.736384 (no previous merge yet)
[S5] round=28 local utility u=0.896819 metrics={'f1_val': 0.9963596129284942, 'auprc': 0.9984061551533471, 'loss_val': 0.11263140848803273, 'psi': 0.9971782298184353}-{'f1_val': 0.7181120699687974, 'auprc': 0.9938698416376232, 'loss_val': 0.22317597111401283, 'psi': 0.8284151786363276}
[S6] START round=28 head_norm_before_train=1.937707 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6108461526516351, 'auprc': 0.8565680896143255, 'loss_val': 1.1741055053767577, 'psi': 0.7091349274367114}-{'f1_val': 0.8456268922634491, 'auprc': 0.9467961477033009, 'loss_val': 0.5031938026079261, 'psi': 0.8860945944393899}
[S7] START round=28 head_norm_before_train=1.403538 cos_to_last_merge=0.8239 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.824
[S7] round=28 local utility u=0.175725 metrics={'f1_val': 0.647486261524764, 'auprc': 0.8005422983903713, 'loss_val': 0.543180801944672, 'psi': 0.7087086762710069}-{'f1_val': 0.6074630570295603, 'auprc': 0.7940795849212476, 'loss_val': 0.6351037424128332, 'psi': 0.6821096681862353}
[S8] START round=28 head_norm_before_train=1.908153 cos_to_last_merge=0.9999 (last merge round=26)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9696437251759733, 'auprc': 0.9990014525441242, 'loss_val': 0.08389677165498872, 'psi': 0.9813868161232336}-{'f1_val': 0.9927572273717925, 'auprc': 0.9992412987626765, 'loss_val': 0.04452418580611279, 'psi': 0.9953508559281461}
[S9] START round=28 head_norm_before_train=1.873870 (no previous merge yet)
[S9] round=28 local utility u=0.005640 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9987788084929551, 'loss_val': 0.05245210213055168, 'psi': 0.9978150302064257}-{'f1_val': 0.9971725113487396, 'auprc': 0.9987788084929551, 'loss_val': 0.06373255272999295, 'psi': 0.9978150302064257}
[S10] START round=28 head_norm_before_train=1.878465 cos_to_last_merge=0.8366 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.837
[S10] round=28 local utility u=0.000613 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9954117578018612, 'loss_val': 0.029358371604918873, 'psi': 0.9948821671997811}-{'f1_val': 0.9945291067983943, 'auprc': 0.9952205701984257, 'loss_val': 0.030010531105771523, 'psi': 0.9948056921584069}
[S11] START round=28 head_norm_before_train=1.211801 cos_to_last_merge=0.9933 (last merge round=25)
[S11] round=28 local utility u=0.085064 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996168893316867, 'loss_val': 0.13831274198613472, 'psi': 0.9963957600349005}-{'f1_val': 0.9747099311134789, 'auprc': 0.9965692161550394, 'loss_val': 0.178618727595265, 'psi': 0.983453645130103}
[S13] START round=28 head_norm_before_train=1.862926 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6062724811738912, 'auprc': 0.6273580140128876, 'loss_val': 1.2000581333173892, 'psi': 0.6147066943094898}-{'f1_val': 0.6174935232320826, 'auprc': 0.6437946282936082, 'loss_val': 1.0494477321154483, 'psi': 0.628013965256693}
[S14] START round=28 head_norm_before_train=1.107528 cos_to_last_merge=0.9984 (last merge round=26)
[S14] round=28 local utility u=0.034183 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9986598983097281, 'loss_val': 0.16233135280167638, 'psi': 0.9975620074192182}-{'f1_val': 0.9963707085436114, 'auprc': 0.9955173875676468, 'loss_val': 0.21851381106814508, 'psi': 0.9960293801532256}
[S15] START round=28 head_norm_before_train=1.424659 cos_to_last_merge=0.9988 (last merge round=26)
[S15] round=28 local utility u=0.532758 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982490482689075, 'loss_val': 0.06291476731144853, 'psi': 0.9973476203400753}-{'f1_val': 0.887335971744445, 'auprc': 0.9346146949021665, 'loss_val': 0.28106393458622164, 'psi': 0.9062474610075336}
[S16] START round=28 head_norm_before_train=1.109864 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.139948 metrics={'f1_val': 0.9759537063633473, 'auprc': 0.993251700609899, 'loss_val': 0.22687883723671903, 'psi': 0.9828729040619679}-{'f1_val': 0.93909320798397, 'auprc': 0.9926154618620326, 'loss_val': 0.2837033816501782, 'psi': 0.9605021095351951}
[S17] START round=28 head_norm_before_train=1.525712 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.539230555798403, 'auprc': 0.8453782483932443, 'loss_val': 0.7676344004694569, 'psi': 0.6616896328363395}-{'f1_val': 0.6209684862337991, 'auprc': 0.8759733184295377, 'loss_val': 0.7303978324145275, 'psi': 0.7229704191120945}
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:45912
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:45913
[S11] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:45909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:45915
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:45904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=-0.0782
[S13] DROPPED delta from S15 (cos=-0.0782 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9755
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] cosine check vs S14: cos=0.9527
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.5234
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] cosine check vs S16: cos=0.9480
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] cosine check vs S10: cos=0.9975
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9696 head_norm=1.931144
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.088662e-02
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9690 head_norm=1.910077 delta_norm=0.070887
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9965 head_norm=1.258568
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.922662e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9965 head_norm=1.194032 delta_norm=0.192266
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9314 head_norm=1.506722
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.681208e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9337 head_norm=1.450590 delta_norm=0.168121
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9760 head_norm=1.157066
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.523117e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9837 head_norm=1.273225 delta_norm=0.752312
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.9967 head_norm=1.484632
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.673116e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.9967 head_norm=1.303845 delta_norm=0.267312
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.819982 cos_to_last_merge=0.7740 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7136893092935961, 'auprc': 0.7655550173106473, 'loss_val': 0.8421524414993098, 'psi': 0.7344355925004166}-{'f1_val': 0.7115036469992007, 'auprc': 0.7693622288515569, 'loss_val': 0.8172848955800105, 'psi': 0.7346470797401432}
[S3] START round=29 head_norm_before_train=1.942249 cos_to_last_merge=0.9999 (last merge round=27)
[S3] round=29 local utility u=0.143214 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9998205611634556, 'loss_val': 0.05216145015137322, 'psi': 0.9983500430604346}-{'f1_val': 0.9610352511054436, 'auprc': 0.9981237788745374, 'loss_val': 0.11549161180743749, 'psi': 0.975870662213081}
[S4] START round=29 head_norm_before_train=1.450590 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.132381 metrics={'f1_val': 0.9524728041657495, 'auprc': 0.9640472490352033, 'loss_val': 0.27103220499568875, 'psi': 0.957102582113531}-{'f1_val': 0.9313796526410592, 'auprc': 0.9543027112538491, 'loss_val': 0.3800013214366756, 'psi': 0.9405488760861751}
[S5] START round=29 head_norm_before_train=1.742225 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9979167251900193, 'loss_val': 0.11884129459051673, 'psi': 0.9971419045477237}-{'f1_val': 0.9963596129284942, 'auprc': 0.9984061551533471, 'loss_val': 0.11263140848803273, 'psi': 0.9971782298184353}
[S6] START round=29 head_norm_before_train=1.955325 (no previous merge yet)
[S6] round=29 local utility u=0.061281 metrics={'f1_val': 0.6004674276548753, 'auprc': 0.8921802763014681, 'loss_val': 1.096107986606872, 'psi': 0.7171525671135124}-{'f1_val': 0.6108461526516351, 'auprc': 0.8565680896143255, 'loss_val': 1.1741055053767577, 'psi': 0.7091349274367114}
[S7] START round=29 head_norm_before_train=1.412353 cos_to_last_merge=0.8224 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.822
[S7] round=29 local utility u=0.144331 metrics={'f1_val': 0.674350686810156, 'auprc': 0.808980319096098, 'loss_val': 0.4410196640750867, 'psi': 0.7282025397245329}-{'f1_val': 0.647486261524764, 'auprc': 0.8005422983903713, 'loss_val': 0.543180801944672, 'psi': 0.7087086762710069}
[S8] START round=29 head_norm_before_train=1.910077 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.094392 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9992732354085678, 'loss_val': 0.04119871057422461, 'psi': 0.9960225635318138}-{'f1_val': 0.9696437251759733, 'auprc': 0.9990014525441242, 'loss_val': 0.08389677165498872, 'psi': 0.9813868161232336}
[S9] START round=29 head_norm_before_train=1.893921 (no previous merge yet)
[S9] round=29 local utility u=0.003590 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9987796768999992, 'loss_val': 0.04527510685026618, 'psi': 0.9978153775692434}-{'f1_val': 0.9971725113487396, 'auprc': 0.9987788084929551, 'loss_val': 0.05245210213055168, 'psi': 0.9978150302064257}
[S10] START round=29 head_norm_before_train=1.891434 cos_to_last_merge=0.8360 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.836
[S10] round=29 local utility u=0.000253 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955668450358415, 'loss_val': 0.029317720803048244, 'psi': 0.9949442020933732}-{'f1_val': 0.9945291067983943, 'auprc': 0.9954117578018612, 'loss_val': 0.029358371604918873, 'psi': 0.9948821671997811}
[S11] START round=29 head_norm_before_train=1.194032 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9940743783892287, 'auprc': 0.9963186887956128, 'loss_val': 0.20000757686174586, 'psi': 0.9949721025517824}-{'f1_val': 0.9965470045135896, 'auprc': 0.996168893316867, 'loss_val': 0.13831274198613472, 'psi': 0.9963957600349005}
[S13] START round=29 head_norm_before_train=1.869417 (no previous merge yet)
[S13] round=29 local utility u=0.460399 metrics={'f1_val': 0.6935753112937039, 'auprc': 0.6748955706933017, 'loss_val': 0.9456901030471351, 'psi': 0.686103415053543}-{'f1_val': 0.6062724811738912, 'auprc': 0.6273580140128876, 'loss_val': 1.2000581333173892, 'psi': 0.6147066943094898}
[S14] START round=29 head_norm_before_train=1.158174 cos_to_last_merge=0.9944 (last merge round=26)
[S14] round=29 local utility u=0.014532 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969736539543309, 'loss_val': 0.1292139474105326, 'psi': 0.9969879664763315}-{'f1_val': 0.9968300801588782, 'auprc': 0.9986598983097281, 'loss_val': 0.16233135280167638, 'psi': 0.9975620074192182}
[S15] START round=29 head_norm_before_train=1.303845 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9972107589945056, 'loss_val': 0.1029207345292137, 'psi': 0.9969323046303146}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982490482689075, 'loss_val': 0.06291476731144853, 'psi': 0.9973476203400753}
[S16] START round=29 head_norm_before_train=1.273225 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9377249203003497, 'auprc': 0.9928566945619958, 'loss_val': 0.35197844937903294, 'psi': 0.959777630005008}-{'f1_val': 0.9759537063633473, 'auprc': 0.993251700609899, 'loss_val': 0.22687883723671903, 'psi': 0.9828729040619679}
[S17] START round=29 head_norm_before_train=1.560609 cos_to_last_merge=0.9990 (last merge round=27)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5369488869097562, 'auprc': 0.8249594588810227, 'loss_val': 0.8355016362056676, 'psi': 0.6521531156982627}-{'f1_val': 0.539230555798403, 'auprc': 0.8453782483932443, 'loss_val': 0.7676344004694569, 'psi': 0.6616896328363395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:45917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:45916
[S7] not sending this round → trigger blocked (psi=0.728)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:45902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S10] not sending this round → trigger blocked (psi=0.995)
[S14] not sending this round → trigger blocked (psi=0.997)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.6879
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=0.9954
[S2] RECEIVED delta(kind=head bytes=1804) from S13
[S2] cosine check vs S13: cos=-0.0085
[S2] DROPPED delta from S13 (cos=-0.0085 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=-0.0866
[S17] DROPPED delta from S6 (cos=-0.0866 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.4226
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] cosine check vs S3: cos=0.9332
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9970 head_norm=1.206636
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.464509e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9970 head_norm=1.237009 delta_norm=0.546451
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.9974 head_norm=1.965516
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.530059e-02
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.9974 head_norm=1.946310 delta_norm=0.095301
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.5369 head_norm=1.591858
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.733552e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.5642 head_norm=1.749068 delta_norm=0.373355
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9377 head_norm=1.313523
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.029260e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9375 head_norm=1.370054 delta_norm=0.902926
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.831733 cos_to_last_merge=0.7726 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.773
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7056720932805547, 'auprc': 0.7663826338004346, 'loss_val': 0.8769856106326813, 'psi': 0.7299563094885066}-{'f1_val': 0.7136893092935961, 'auprc': 0.7655550173106473, 'loss_val': 0.8421524414993098, 'psi': 0.7344355925004166}
[S3] START round=30 head_norm_before_train=1.946310 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9613297054499484, 'auprc': 0.9977009206897974, 'loss_val': 0.10583424890981229, 'psi': 0.9758781915458881}-{'f1_val': 0.9973696976584205, 'auprc': 0.9998205611634556, 'loss_val': 0.05216145015137322, 'psi': 0.9983500430604346}
[S4] START round=30 head_norm_before_train=1.483788 cos_to_last_merge=0.9987 (last merge round=28)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9383029126821826, 'auprc': 0.9603156755801718, 'loss_val': 0.3055426673079057, 'psi': 0.9471080178413782}-{'f1_val': 0.9524728041657495, 'auprc': 0.9640472490352033, 'loss_val': 0.27103220499568875, 'psi': 0.957102582113531}
[S5] START round=30 head_norm_before_train=1.748275 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.8555640250038911, 'auprc': 0.9954639789598052, 'loss_val': 0.15658282007632351, 'psi': 0.9115240065862567}-{'f1_val': 0.9966253574528599, 'auprc': 0.9979167251900193, 'loss_val': 0.11884129459051673, 'psi': 0.9971419045477237}
[S6] START round=30 head_norm_before_train=1.972114 (no previous merge yet)
[S6] round=30 local utility u=0.701137 metrics={'f1_val': 0.7321218523623856, 'auprc': 0.947956186997014, 'loss_val': 0.6510872906733463, 'psi': 0.818455586216237}-{'f1_val': 0.6004674276548753, 'auprc': 0.8921802763014681, 'loss_val': 1.096107986606872, 'psi': 0.7171525671135124}
[S7] START round=30 head_norm_before_train=1.420629 cos_to_last_merge=0.8211 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.821
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5711071323021653, 'auprc': 0.7858180631877973, 'loss_val': 0.719869376992942, 'psi': 0.6569915046564181}-{'f1_val': 0.674350686810156, 'auprc': 0.808980319096098, 'loss_val': 0.4410196640750867, 'psi': 0.7282025397245329}
[S8] START round=30 head_norm_before_train=1.931621 cos_to_last_merge=0.9999 (last merge round=28)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9843044951922839, 'auprc': 0.9990944543434764, 'loss_val': 0.05252863181694191, 'psi': 0.990220478852761}-{'f1_val': 0.9938554489473111, 'auprc': 0.9992732354085678, 'loss_val': 0.04119871057422461, 'psi': 0.9960225635318138}
[S9] START round=30 head_norm_before_train=1.912931 (no previous merge yet)
[S9] round=30 local utility u=0.002139 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.998621636410247, 'loss_val': 0.03805828261463717, 'psi': 0.9975056206285078}-{'f1_val': 0.9971725113487396, 'auprc': 0.9987796768999992, 'loss_val': 0.04527510685026618, 'psi': 0.9978153775692434}
[S10] START round=30 head_norm_before_train=1.905463 cos_to_last_merge=0.8352 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.835
[S10] round=30 local utility u=0.001539 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9954122253405734, 'loss_val': 0.028410067012421478, 'psi': 0.995145802055275}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955668450358415, 'loss_val': 0.029317720803048244, 'psi': 0.9949442020933732}
[S11] START round=30 head_norm_before_train=1.236407 cos_to_last_merge=0.9990 (last merge round=28)
[S11] round=30 local utility u=0.043460 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977607677328747, 'loss_val': 0.12976960389418776, 'psi': 0.9967845120411355}-{'f1_val': 0.9940743783892287, 'auprc': 0.9963186887956128, 'loss_val': 0.20000757686174586, 'psi': 0.9949721025517824}
[S13] START round=30 head_norm_before_train=1.872371 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6754129963045659, 'auprc': 0.7244548734056532, 'loss_val': 1.1405016882972252, 'psi': 0.6950297471450008}-{'f1_val': 0.6935753112937039, 'auprc': 0.6748955706933017, 'loss_val': 0.9456901030471351, 'psi': 0.686103415053543}
[S14] START round=30 head_norm_before_train=1.237009 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.996975452712364, 'loss_val': 0.15899356157481348, 'psi': 0.9969886859795447}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969736539543309, 'loss_val': 0.1292139474105326, 'psi': 0.9969879664763315}
[S15] START round=30 head_norm_before_train=1.365350 cos_to_last_merge=0.9985 (last merge round=28)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.8997649499607565, 'auprc': 0.9294376103031998, 'loss_val': 0.28366894625384736, 'psi': 0.9116340140977338}-{'f1_val': 0.9967466683875206, 'auprc': 0.9972107589945056, 'loss_val': 0.1029207345292137, 'psi': 0.9969323046303146}
[S16] START round=30 head_norm_before_train=1.370054 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.103573 metrics={'f1_val': 0.9490861740423888, 'auprc': 0.9876908004048597, 'loss_val': 0.197502250779226, 'psi': 0.9645280245873771}-{'f1_val': 0.9377249203003497, 'auprc': 0.9928566945619958, 'loss_val': 0.35197844937903294, 'psi': 0.959777630005008}
[S17] START round=30 head_norm_before_train=1.749068 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.774300 metrics={'f1_val': 0.7210076354155268, 'auprc': 0.9014786818444257, 'loss_val': 0.6208116549875421, 'psi': 0.7931960539870864}-{'f1_val': 0.5369488869097562, 'auprc': 0.8249594588810227, 'loss_val': 0.8355016362056676, 'psi': 0.6521531156982627}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:45916
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:45909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.818)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:45915
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=0.9981
[S15] RECEIVED delta(kind=head bytes=1794) from S16
[S15] cosine check vs S16: cos=0.9485
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] cosine check vs S11: cos=0.2380
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] cosine check vs S17: cos=0.2687
[S6] ⇄ pheromone p=0.369 → S17@127.0.0.1:45917
[S5] ⇄ pheromone p=0.252 → S16@127.0.0.1:45916
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9843 head_norm=1.951488
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.236812e-02
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9836 head_norm=1.934412 delta_norm=0.062368
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.050 → S3@127.0.0.1:45903
[S2] ⇄ pheromone p=0.051 → S17@127.0.0.1:45917
[S4] ⇄ pheromone p=0.036 → S14@127.0.0.1:45914
[S9] ⇄ pheromone p=0.047 → S16@127.0.0.1:45916
[S3] ⇄ pheromone p=0.074 → S17@127.0.0.1:45917
[S7] ⇄ pheromone p=0.181 → S4@127.0.0.1:45904
[S13] ⇄ pheromone p=0.180 → S2@127.0.0.1:45902
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9970 head_norm=1.275474
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.466110e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9970 head_norm=1.227666 delta_norm=0.946611
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.026 → S11@127.0.0.1:45912
[S10] ⇄ pheromone p=0.006 → S8@127.0.0.1:45909
[S11] ⇄ pheromone p=0.054 → S16@127.0.0.1:45916
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9491 head_norm=1.416538
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.343904e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9374 head_norm=1.062153 delta_norm=0.834390
[S16] aggregate: ROLLBACK (f1_val pre=0.949 post=0.937 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.114 → S15@127.0.0.1:45915
[S17] ⇄ pheromone p=0.252 → S14@127.0.0.1:45914
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.8998 head_norm=1.432448
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.286291e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.8986 head_norm=1.406048 delta_norm=0.228629
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.111 → S13@127.0.0.1:45913
[S2] START round=31 head_norm_before_train=1.843590 cos_to_last_merge=0.7713 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7206234373800616, 'auprc': 0.7366201901581781, 'loss_val': 1.0351322801048828, 'psi': 0.7270221384913083}-{'f1_val': 0.7056720932805547, 'auprc': 0.7663826338004346, 'loss_val': 0.8769856106326813, 'psi': 0.7299563094885066}
[S3] START round=31 head_norm_before_train=1.964424 cos_to_last_merge=0.9999 (last merge round=29)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9348495175805944, 'auprc': 0.9655334811842708, 'loss_val': 0.17347204671232191, 'psi': 0.9471231030220649}-{'f1_val': 0.9613297054499484, 'auprc': 0.9977009206897974, 'loss_val': 0.10583424890981229, 'psi': 0.9758781915458881}
[S4] START round=31 head_norm_before_train=1.512329 cos_to_last_merge=0.9962 (last merge round=28)
[S4] round=31 local utility u=0.087776 metrics={'f1_val': 0.9518775052224209, 'auprc': 0.9826439395429459, 'loss_val': 0.2784227425940393, 'psi': 0.9641840789506309}-{'f1_val': 0.9383029126821826, 'auprc': 0.9603156755801718, 'loss_val': 0.3055426673079057, 'psi': 0.9471080178413782}
[S5] START round=31 head_norm_before_train=1.756627 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7361428958643917, 'auprc': 0.994575800610782, 'loss_val': 0.1936521939300094, 'psi': 0.8395160577629479}-{'f1_val': 0.8555640250038911, 'auprc': 0.9954639789598052, 'loss_val': 0.15658282007632351, 'psi': 0.9115240065862567}
[S6] START round=31 head_norm_before_train=1.987685 (no previous merge yet)
[S6] round=31 local utility u=0.469094 metrics={'f1_val': 0.8484275809892556, 'auprc': 0.9595141648993692, 'loss_val': 0.44540716138613573, 'psi': 0.8928622145533011}-{'f1_val': 0.7321218523623856, 'auprc': 0.947956186997014, 'loss_val': 0.6510872906733463, 'psi': 0.818455586216237}
[S7] START round=31 head_norm_before_train=1.428003 cos_to_last_merge=0.8199 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.820
[S7] round=31 local utility u=0.398240 metrics={'f1_val': 0.6583665636577269, 'auprc': 0.8018123794363954, 'loss_val': 0.49492884808982673, 'psi': 0.7157448899691943}-{'f1_val': 0.5711071323021653, 'auprc': 0.7858180631877973, 'loss_val': 0.719869376992942, 'psi': 0.6569915046564181}
[S8] START round=31 head_norm_before_train=1.934412 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9836013959184189, 'auprc': 0.9991520016023592, 'loss_val': 0.05414853163498096, 'psi': 0.989821638191995}-{'f1_val': 0.9843044951922839, 'auprc': 0.9990944543434764, 'loss_val': 0.05252863181694191, 'psi': 0.990220478852761}
[S9] START round=31 head_norm_before_train=1.932978 (no previous merge yet)
[S9] round=31 local utility u=0.002067 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9987833498519656, 'loss_val': 0.03441018412443833, 'psi': 0.9975703060051953}-{'f1_val': 0.9967616101073482, 'auprc': 0.998621636410247, 'loss_val': 0.03805828261463717, 'psi': 0.9975056206285078}
[S10] START round=31 head_norm_before_train=1.919212 cos_to_last_merge=0.8345 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.834
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9954363072544345, 'loss_val': 0.02829466085104121, 'psi': 0.9950236884333974}-{'f1_val': 0.9949681865317428, 'auprc': 0.9954122253405734, 'loss_val': 0.028410067012421478, 'psi': 0.995145802055275}
[S11] START round=31 head_norm_before_train=1.281473 cos_to_last_merge=0.9964 (last merge round=28)
[S11] round=31 local utility u=0.013962 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979355067535244, 'loss_val': 0.10236900793245253, 'psi': 0.9968544076493954}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977607677328747, 'loss_val': 0.12976960389418776, 'psi': 0.9967845120411355}
[S13] START round=31 head_norm_before_train=1.879756 (no previous merge yet)
[S13] round=31 local utility u=0.227159 metrics={'f1_val': 0.6650864147658718, 'auprc': 0.7436401600537667, 'loss_val': 0.6817805874095283, 'psi': 0.6965079128810298}-{'f1_val': 0.6754129963045659, 'auprc': 0.7244548734056532, 'loss_val': 1.1405016882972252, 'psi': 0.6950297471450008}
[S14] START round=31 head_norm_before_train=1.227666 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.991134627690468, 'auprc': 0.9986445427309381, 'loss_val': 0.216629761602573, 'psi': 0.994138593706656}-{'f1_val': 0.9969975081576651, 'auprc': 0.996975452712364, 'loss_val': 0.15899356157481348, 'psi': 0.9969886859795447}
[S15] START round=31 head_norm_before_train=1.406048 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.307296 metrics={'f1_val': 0.9489163602243003, 'auprc': 0.9990279276444136, 'loss_val': 0.1727566430338467, 'psi': 0.9689609871923456}-{'f1_val': 0.8997649499607565, 'auprc': 0.9294376103031998, 'loss_val': 0.28366894625384736, 'psi': 0.9116340140977338}
[S16] START round=31 head_norm_before_train=1.062153 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8562688355056732, 'auprc': 0.9440960318135331, 'loss_val': 0.670464446565629, 'psi': 0.8913997140288172}-{'f1_val': 0.9490861740423888, 'auprc': 0.9876908004048597, 'loss_val': 0.197502250779226, 'psi': 0.9645280245873771}
[S17] START round=31 head_norm_before_train=1.783154 cos_to_last_merge=0.9993 (last merge round=29)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6596293224473344, 'auprc': 0.8940047751942898, 'loss_val': 0.6544943455188064, 'psi': 0.7533795035461166}-{'f1_val': 0.7210076354155268, 'auprc': 0.9014786818444257, 'loss_val': 0.6208116549875421, 'psi': 0.7931960539870864}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:45902
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:45914
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:45904
[S11] not sending this round → trigger blocked (psi=0.997)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:45913
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1806) from S13
[S2] cosine check vs S13: cos=-0.0091
[S2] DROPPED delta from S13 (cos=-0.0091 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] cosine check vs S7: cos=0.9744
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.4915
[S13] RECEIVED delta(kind=head bytes=1795) from S15
[S13] cosine check vs S15: cos=-0.0804
[S13] DROPPED delta from S15 (cos=-0.0804 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=-0.0867
[S17] DROPPED delta from S6 (cos=-0.0867 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=0.6950
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9911 head_norm=1.264824
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.159867e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9729 head_norm=1.211572 delta_norm=0.715987
[S14] aggregate: ROLLBACK (f1_val pre=0.991 post=0.973 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9519 head_norm=1.536655
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.754331e-01
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9523 head_norm=1.476070 delta_norm=0.175433
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.8563 head_norm=1.105581
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.131968e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.8622 head_norm=1.417402 delta_norm=0.713197
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.857932 cos_to_last_merge=0.7696 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=32 local utility u=0.021914 metrics={'f1_val': 0.7211172316357484, 'auprc': 0.732166245642081, 'loss_val': 0.9809052829045511, 'psi': 0.7255368372382814}-{'f1_val': 0.7206234373800616, 'auprc': 0.7366201901581781, 'loss_val': 1.0351322801048828, 'psi': 0.7270221384913083}
[S3] START round=32 head_norm_before_train=1.982351 cos_to_last_merge=0.9997 (last merge round=29)
[S3] round=32 local utility u=0.204334 metrics={'f1_val': 0.9764383113667868, 'auprc': 0.9984188482617237, 'loss_val': 0.11299214173350153, 'psi': 0.9852305261247616}-{'f1_val': 0.9348495175805944, 'auprc': 0.9655334811842708, 'loss_val': 0.17347204671232191, 'psi': 0.9471231030220649}
[S4] START round=32 head_norm_before_train=1.476070 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9533479232611104, 'auprc': 0.9563967945248139, 'loss_val': 0.27244194037852953, 'psi': 0.9545674717665917}-{'f1_val': 0.9518775052224209, 'auprc': 0.9826439395429459, 'loss_val': 0.2784227425940393, 'psi': 0.9641840789506309}
[S5] START round=32 head_norm_before_train=1.765864 (no previous merge yet)
[S5] round=32 local utility u=0.239268 metrics={'f1_val': 0.8107620458435978, 'auprc': 0.9942387717590166, 'loss_val': 0.16181916245602093, 'psi': 0.8841527362097654}-{'f1_val': 0.7361428958643917, 'auprc': 0.994575800610782, 'loss_val': 0.1936521939300094, 'psi': 0.8395160577629479}
[S6] START round=32 head_norm_before_train=2.003487 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.790467353854223, 'auprc': 0.9558208664533294, 'loss_val': 0.6936600010035567, 'psi': 0.8566087588938656}-{'f1_val': 0.8484275809892556, 'auprc': 0.9595141648993692, 'loss_val': 0.44540716138613573, 'psi': 0.8928622145533011}
[S7] START round=32 head_norm_before_train=1.434507 cos_to_last_merge=0.8189 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.819
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5872215161088143, 'auprc': 0.788806492235307, 'loss_val': 0.6791656274893957, 'psi': 0.6678555065594114}-{'f1_val': 0.6583665636577269, 'auprc': 0.8018123794363954, 'loss_val': 0.49492884808982673, 'psi': 0.7157448899691943}
[S8] START round=32 head_norm_before_train=1.954180 cos_to_last_merge=0.9999 (last merge round=30)
[S8] round=32 local utility u=0.025421 metrics={'f1_val': 0.9932810269810869, 'auprc': 0.9967682539824233, 'loss_val': 0.054232517772933315, 'psi': 0.9946759177816216}-{'f1_val': 0.9836013959184189, 'auprc': 0.9991520016023592, 'loss_val': 0.05414853163498096, 'psi': 0.989821638191995}
[S9] START round=32 head_norm_before_train=1.952703 (no previous merge yet)
[S9] round=32 local utility u=0.001872 metrics={'f1_val': 0.9969222458854735, 'auprc': 0.9987821605836855, 'loss_val': 0.03162637935480909, 'psi': 0.9976662117647583}-{'f1_val': 0.9967616101073482, 'auprc': 0.9987833498519656, 'loss_val': 0.03441018412443833, 'psi': 0.9975703060051953}
[S10] START round=32 head_norm_before_train=1.929541 cos_to_last_merge=0.8340 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.834
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9950801409778095, 'loss_val': 0.02844681562379928, 'psi': 0.9947495204701604}-{'f1_val': 0.9947486092193725, 'auprc': 0.9954363072544345, 'loss_val': 0.02829466085104121, 'psi': 0.9950236884333974}
[S11] START round=32 head_norm_before_train=1.324451 cos_to_last_merge=0.9928 (last merge round=28)
[S11] round=32 local utility u=0.008637 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979407431065931, 'loss_val': 0.08510992786249863, 'psi': 0.9968565021906228}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979355067535244, 'loss_val': 0.10236900793245253, 'psi': 0.9968544076493954}
[S13] START round=32 head_norm_before_train=1.889365 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6487329285771992, 'auprc': 0.7239151973592245, 'loss_val': 1.1145850111120692, 'psi': 0.6788058360900093}-{'f1_val': 0.6650864147658718, 'auprc': 0.7436401600537667, 'loss_val': 0.6817805874095283, 'psi': 0.6965079128810298}
[S14] START round=32 head_norm_before_train=1.211572 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.032047 metrics={'f1_val': 0.9955251974135692, 'auprc': 0.9968828997814034, 'loss_val': 0.17359328795502002, 'psi': 0.9960682783607029}-{'f1_val': 0.991134627690468, 'auprc': 0.9986445427309381, 'loss_val': 0.216629761602573, 'psi': 0.994138593706656}
[S15] START round=32 head_norm_before_train=1.467861 cos_to_last_merge=0.9987 (last merge round=30)
[S15] round=32 local utility u=0.168417 metrics={'f1_val': 0.9887886891363633, 'auprc': 0.9979944073256689, 'loss_val': 0.07205521100620896, 'psi': 0.9924709764120856}-{'f1_val': 0.9489163602243003, 'auprc': 0.9990279276444136, 'loss_val': 0.1727566430338467, 'psi': 0.9689609871923456}
[S16] START round=32 head_norm_before_train=1.417402 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.630484 metrics={'f1_val': 0.9589373501806212, 'auprc': 0.9943341554975893, 'loss_val': 0.17622187603718742, 'psi': 0.9730960723074085}-{'f1_val': 0.8562688355056732, 'auprc': 0.9440960318135331, 'loss_val': 0.670464446565629, 'psi': 0.8913997140288172}
[S17] START round=32 head_norm_before_train=1.814033 cos_to_last_merge=0.9976 (last merge round=29)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6210803899494785, 'auprc': 0.8535922409342532, 'loss_val': 0.8204957880568093, 'psi': 0.7140851303433884}-{'f1_val': 0.6596293224473344, 'auprc': 0.8940047751942898, 'loss_val': 0.6544943455188064, 'psi': 0.7533795035461166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:45912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:45916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:45903
[S15] not sending this round → trigger blocked (psi=0.992)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:45917
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:45915
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] cosine check vs S2: cos=0.1195
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.9711
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=0.1837
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.8856
[S16] RECEIVED delta(kind=head bytes=1805) from S11
[S16] cosine check vs S11: cos=0.3883
[S15] RECEIVED delta(kind=head bytes=1804) from S16
[S15] cosine check vs S16: cos=0.9306
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=0.9969
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9589 head_norm=1.459182
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.482712e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9464 head_norm=1.088259 delta_norm=0.748271
[S16] aggregate: ROLLBACK (f1_val pre=0.959 post=0.946 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9961 head_norm=1.363336
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.173984e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9961 head_norm=1.270120 delta_norm=0.317398
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9764 head_norm=1.998692
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.882883e-02
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9746 head_norm=1.984809 delta_norm=0.078829
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9888 head_norm=1.517710
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.787509e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9862 head_norm=1.462404 delta_norm=0.278751
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.6211 head_norm=1.843689
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.448053e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.6368 head_norm=1.513928 delta_norm=0.544805
[S17] aggregate: ACCEPT kept=['S2', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.869869 cos_to_last_merge=0.7682 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.768
[S2] round=33 local utility u=0.121973 metrics={'f1_val': 0.7142768175625555, 'auprc': 0.7868324922028123, 'loss_val': 0.8599152302040783, 'psi': 0.7432990874186582}-{'f1_val': 0.7211172316357484, 'auprc': 0.732166245642081, 'loss_val': 0.9809052829045511, 'psi': 0.7255368372382814}
[S3] START round=33 head_norm_before_train=1.984809 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9969197626359072, 'loss_val': 0.10742877506210224, 'psi': 0.9754129562940351}-{'f1_val': 0.9764383113667868, 'auprc': 0.9984188482617237, 'loss_val': 0.11299214173350153, 'psi': 0.9852305261247616}
[S4] START round=33 head_norm_before_train=1.502639 cos_to_last_merge=0.9994 (last merge round=31)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.8459524990990134, 'auprc': 0.9296806644757033, 'loss_val': 0.4218496984038358, 'psi': 0.8794437652496894}-{'f1_val': 0.9533479232611104, 'auprc': 0.9563967945248139, 'loss_val': 0.27244194037852953, 'psi': 0.9545674717665917}
[S5] START round=33 head_norm_before_train=1.776934 (no previous merge yet)
[S5] round=33 local utility u=0.604810 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9979777560777698, 'loss_val': 0.07859676408636673, 'psi': 0.9971663169028238}-{'f1_val': 0.8107620458435978, 'auprc': 0.9942387717590166, 'loss_val': 0.16181916245602093, 'psi': 0.8841527362097654}
[S6] START round=33 head_norm_before_train=2.017360 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7335900445900028, 'auprc': 0.8993052283813037, 'loss_val': 0.832239326165292, 'psi': 0.7998761181065231}-{'f1_val': 0.790467353854223, 'auprc': 0.9558208664533294, 'loss_val': 0.6936600010035567, 'psi': 0.8566087588938656}
[S7] START round=33 head_norm_before_train=1.443386 cos_to_last_merge=0.8174 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=33 local utility u=0.153301 metrics={'f1_val': 0.6193881491045999, 'auprc': 0.7924883090612966, 'loss_val': 0.5766095868907278, 'psi': 0.6886282130872786}-{'f1_val': 0.5872215161088143, 'auprc': 0.788806492235307, 'loss_val': 0.6791656274893957, 'psi': 0.6678555065594114}
[S8] START round=33 head_norm_before_train=1.973978 cos_to_last_merge=0.9997 (last merge round=30)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9618452302349028, 'auprc': 0.9988458981621433, 'loss_val': 0.10823246778180534, 'psi': 0.976645497405799}-{'f1_val': 0.9932810269810869, 'auprc': 0.9967682539824233, 'loss_val': 0.054232517772933315, 'psi': 0.9946759177816216}
[S9] START round=33 head_norm_before_train=1.971580 (no previous merge yet)
[S9] round=33 local utility u=0.001173 metrics={'f1_val': 0.9969222458854735, 'auprc': 0.9987806740046179, 'loss_val': 0.029276079429438353, 'psi': 0.9976656171331313}-{'f1_val': 0.9969222458854735, 'auprc': 0.9987821605836855, 'loss_val': 0.03162637935480909, 'psi': 0.9976662117647583}
[S10] START round=33 head_norm_before_train=1.938805 cos_to_last_merge=0.8337 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.834
[S10] round=33 local utility u=0.000667 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9949614662622718, 'loss_val': 0.028074570992455427, 'psi': 0.9948337520365322}-{'f1_val': 0.9945291067983943, 'auprc': 0.9950801409778095, 'loss_val': 0.02844681562379928, 'psi': 0.9947495204701604}
[S11] START round=33 head_norm_before_train=1.270120 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962566046468198, 'loss_val': 0.11139295020078739, 'psi': 0.9961828468067135}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979407431065931, 'loss_val': 0.08510992786249863, 'psi': 0.9968565021906228}
[S13] START round=33 head_norm_before_train=1.895740 (no previous merge yet)
[S13] round=33 local utility u=0.128076 metrics={'f1_val': 0.6517713793505748, 'auprc': 0.7430932780259198, 'loss_val': 0.9341988803987046, 'psi': 0.6883001388207128}-{'f1_val': 0.6487329285771992, 'auprc': 0.7239151973592245, 'loss_val': 1.1145850111120692, 'psi': 0.6788058360900093}
[S14] START round=33 head_norm_before_train=1.252681 cos_to_last_merge=0.9986 (last merge round=31)
[S14] round=33 local utility u=0.030504 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.99904523774067, 'loss_val': 0.1303709500224877, 'psi': 0.9980630567973033}-{'f1_val': 0.9955251974135692, 'auprc': 0.9968828997814034, 'loss_val': 0.17359328795502002, 'psi': 0.9960682783607029}
[S15] START round=33 head_norm_before_train=1.462404 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.026719 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.998605874385748, 'loss_val': 0.07042370614018215, 'psi': 0.9977127018711593}-{'f1_val': 0.9887886891363633, 'auprc': 0.9979944073256689, 'loss_val': 0.07205521100620896, 'psi': 0.9924709764120856}
[S16] START round=33 head_norm_before_train=1.088259 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.087041 metrics={'f1_val': 0.9909068503289409, 'auprc': 0.9950076192306649, 'loss_val': 0.19597651964517404, 'psi': 0.9925471578896305}-{'f1_val': 0.9589373501806212, 'auprc': 0.9943341554975893, 'loss_val': 0.17622187603718742, 'psi': 0.9730960723074085}
[S17] START round=33 head_norm_before_train=1.513928 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.024889 metrics={'f1_val': 0.6252018628662062, 'auprc': 0.8611742817977537, 'loss_val': 0.8181932315808467, 'psi': 0.7195908304388252}-{'f1_val': 0.6210803899494785, 'auprc': 0.8535922409342532, 'loss_val': 0.8204957880568093, 'psi': 0.7140851303433884}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:45913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:45904
[S2] not sending this round → trigger blocked (psi=0.743)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:45916
[S14] not sending this round → trigger blocked (psi=0.998)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:45902
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9837
[S13] RECEIVED delta(kind=head bytes=1797) from S15
[S13] cosine check vs S15: cos=-0.0752
[S13] DROPPED delta from S15 (cos=-0.0752 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=-0.0088
[S2] DROPPED delta from S13 (cos=-0.0088 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.7100
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.9979
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.4605
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9974 head_norm=1.296716
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.475395e-01
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9970 head_norm=1.218691 delta_norm=0.747539
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9618 head_norm=1.987068
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.629379e-02
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9609 head_norm=1.965330 delta_norm=0.066294
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.8460 head_norm=1.535067
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.408848e-01
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.8580 head_norm=1.487327 delta_norm=0.140885
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9909 head_norm=1.132299
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.143170e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9909 head_norm=1.452375 delta_norm=0.714317
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.882132 cos_to_last_merge=0.7668 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.767
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7159270595974196, 'auprc': 0.7760563303739831, 'loss_val': 0.8465237584660765, 'psi': 0.739978767908045}-{'f1_val': 0.7142768175625555, 'auprc': 0.7868324922028123, 'loss_val': 0.8599152302040783, 'psi': 0.7432990874186582}
[S3] START round=34 head_norm_before_train=2.001208 cos_to_last_merge=0.9999 (last merge round=32)
[S3] round=34 local utility u=0.141189 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9979096653469807, 'loss_val': 0.0457729252975138, 'psi': 0.9975840753388158}-{'f1_val': 0.9610750853994537, 'auprc': 0.9969197626359072, 'loss_val': 0.10742877506210224, 'psi': 0.9754129562940351}
[S4] START round=34 head_norm_before_train=1.487327 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.400492 metrics={'f1_val': 0.9410768041296455, 'auprc': 0.9638548814099943, 'loss_val': 0.2941351369006667, 'psi': 0.9501880350417851}-{'f1_val': 0.8459524990990134, 'auprc': 0.9296806644757033, 'loss_val': 0.4218496984038358, 'psi': 0.8794437652496894}
[S5] START round=34 head_norm_before_train=1.784541 (no previous merge yet)
[S5] round=34 local utility u=0.002139 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9982410936021162, 'loss_val': 0.07510796061404014, 'psi': 0.9972716519125624}-{'f1_val': 0.9966253574528599, 'auprc': 0.9979777560777698, 'loss_val': 0.07859676408636673, 'psi': 0.9971663169028238}
[S6] START round=34 head_norm_before_train=2.025346 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6020703347911828, 'auprc': 0.9159949646800206, 'loss_val': 1.0420129208598286, 'psi': 0.7276401867467179}-{'f1_val': 0.7335900445900028, 'auprc': 0.8993052283813037, 'loss_val': 0.832239326165292, 'psi': 0.7998761181065231}
[S7] START round=34 head_norm_before_train=1.451740 cos_to_last_merge=0.8157 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.816
[S7] round=34 local utility u=0.231227 metrics={'f1_val': 0.6642364035979218, 'auprc': 0.8049887609734087, 'loss_val': 0.4207455235181768, 'psi': 0.7205373465481165}-{'f1_val': 0.6193881491045999, 'auprc': 0.7924883090612966, 'loss_val': 0.5766095868907278, 'psi': 0.6886282130872786}
[S8] START round=34 head_norm_before_train=1.965330 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.126599 metrics={'f1_val': 0.9922164873423569, 'auprc': 0.9993821795209714, 'loss_val': 0.03887048840290896, 'psi': 0.9950827642138027}-{'f1_val': 0.9618452302349028, 'auprc': 0.9988458981621433, 'loss_val': 0.10823246778180534, 'psi': 0.976645497405799}
[S9] START round=34 head_norm_before_train=1.989267 (no previous merge yet)
[S9] round=34 local utility u=0.000878 metrics={'f1_val': 0.9969222458854735, 'auprc': 0.9987805456527644, 'loss_val': 0.027519300006657078, 'psi': 0.9976655657923899}-{'f1_val': 0.9969222458854735, 'auprc': 0.9987806740046179, 'loss_val': 0.029276079429438353, 'psi': 0.9976656171331313}
[S10] START round=34 head_norm_before_train=1.945609 cos_to_last_merge=0.8335 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.834
[S10] round=34 local utility u=0.001319 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.994848160079103, 'loss_val': 0.0277326926783177, 'psi': 0.9950519674432661}-{'f1_val': 0.9947486092193725, 'auprc': 0.9949614662622718, 'loss_val': 0.028074570992455427, 'psi': 0.9948337520365322}
[S11] START round=34 head_norm_before_train=1.305137 cos_to_last_merge=0.9995 (last merge round=32)
[S11] round=34 local utility u=0.009684 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963158746692025, 'loss_val': 0.09220220572272389, 'psi': 0.9962065548156666}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962566046468198, 'loss_val': 0.11139295020078739, 'psi': 0.9961828468067135}
[S13] START round=34 head_norm_before_train=1.900906 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6129242714790399, 'auprc': 0.6251285712739346, 'loss_val': 1.247385077321291, 'psi': 0.6178059913969978}-{'f1_val': 0.6517713793505748, 'auprc': 0.7430932780259198, 'loss_val': 0.9341988803987046, 'psi': 0.6883001388207128}
[S14] START round=34 head_norm_before_train=1.218691 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.998662080623488, 'loss_val': 0.17521905791257225, 'psi': 0.9978965892381441}-{'f1_val': 0.9974082695017256, 'auprc': 0.99904523774067, 'loss_val': 0.1303709500224877, 'psi': 0.9980630567973033}
[S15] START round=34 head_norm_before_train=1.511338 cos_to_last_merge=0.9992 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.903170176196454, 'auprc': 0.997129535761845, 'loss_val': 0.17938337557563486, 'psi': 0.9407539200226104}-{'f1_val': 0.9971172535281002, 'auprc': 0.998605874385748, 'loss_val': 0.07042370614018215, 'psi': 0.9977127018711593}
[S16] START round=34 head_norm_before_train=1.452375 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.040514 metrics={'f1_val': 0.9913687001057281, 'auprc': 0.989402390283334, 'loss_val': 0.1009033344585528, 'psi': 0.9905821761767705}-{'f1_val': 0.9909068503289409, 'auprc': 0.9950076192306649, 'loss_val': 0.19597651964517404, 'psi': 0.9925471578896305}
[S17] START round=34 head_norm_before_train=1.551314 cos_to_last_merge=0.9994 (last merge round=32)
[S17] round=34 local utility u=0.042279 metrics={'f1_val': 0.6322715023177266, 'auprc': 0.8729619264489952, 'loss_val': 0.8114155915228323, 'psi': 0.728547671970234}-{'f1_val': 0.6252018628662062, 'auprc': 0.8611742817977537, 'loss_val': 0.8181932315808467, 'psi': 0.7195908304388252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[S10] not sending this round → trigger blocked (psi=0.995)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:45916
[S7] not sending this round → trigger blocked (psi=0.721)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:45915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:45916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.4916
[S17] RECEIVED delta(kind=head bytes=1796) from S3
[S17] cosine check vs S3: cos=0.8940
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.2501
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=0.2825
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=0.9781
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.9979
[S17] not sending this round → trigger blocked (psi=0.729)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9974 head_norm=1.260627
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.104678e-01
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9974 head_norm=1.203335 delta_norm=0.710468
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9914 head_norm=1.492731
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.679210e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9905 head_norm=1.098786 delta_norm=0.767921
[S16] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9974 head_norm=2.016845
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.796624e-02
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9970 head_norm=1.996574 delta_norm=0.067966
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9032 head_norm=1.555556
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.625270e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9032 head_norm=1.515779 delta_norm=0.162527
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.6323 head_norm=1.592000
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.639791e-01
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.6335 head_norm=1.756641 delta_norm=0.463979
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.895725 cos_to_last_merge=0.7652 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.765
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6626256481346293, 'auprc': 0.7532784956400252, 'loss_val': 1.546780788230527, 'psi': 0.6988867871367876}-{'f1_val': 0.7159270595974196, 'auprc': 0.7760563303739831, 'loss_val': 0.8465237584660765, 'psi': 0.739978767908045}
[S3] START round=35 head_norm_before_train=1.996574 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.000270 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9975641048978114, 'loss_val': 0.044212098733984746, 'psi': 0.9974474605541769}-{'f1_val': 0.9973670153333725, 'auprc': 0.9979096653469807, 'loss_val': 0.0457729252975138, 'psi': 0.9975840753388158}
[S4] START round=35 head_norm_before_train=1.521966 cos_to_last_merge=0.9991 (last merge round=33)
[S4] round=35 local utility u=0.007227 metrics={'f1_val': 0.9430613339673896, 'auprc': 0.9630891099670194, 'loss_val': 0.2892915619702284, 'psi': 0.9510724443672415}-{'f1_val': 0.9410768041296455, 'auprc': 0.9638548814099943, 'loss_val': 0.2941351369006667, 'psi': 0.9501880350417851}
[S5] START round=35 head_norm_before_train=1.793953 (no previous merge yet)
[S5] round=35 local utility u=0.003950 metrics={'f1_val': 0.9967726868314644, 'auprc': 0.998255079001298, 'loss_val': 0.0681331171436108, 'psi': 0.9973656436993978}-{'f1_val': 0.9966253574528599, 'auprc': 0.9982410936021162, 'loss_val': 0.07510796061404014, 'psi': 0.9972716519125624}
[S6] START round=35 head_norm_before_train=2.031667 (no previous merge yet)
[S6] round=35 local utility u=0.768798 metrics={'f1_val': 0.7858285733781041, 'auprc': 0.9145404078714519, 'loss_val': 0.6026033415588365, 'psi': 0.8373133071754433}-{'f1_val': 0.6020703347911828, 'auprc': 0.9159949646800206, 'loss_val': 1.0420129208598286, 'psi': 0.7276401867467179}
[S7] START round=35 head_norm_before_train=1.462876 cos_to_last_merge=0.8137 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.814
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.608176228430923, 'auprc': 0.7892287290458154, 'loss_val': 0.6473416412810034, 'psi': 0.68059722867688}-{'f1_val': 0.6642364035979218, 'auprc': 0.8049887609734087, 'loss_val': 0.4207455235181768, 'psi': 0.7205373465481165}
[S8] START round=35 head_norm_before_train=1.978431 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9729833356986195, 'auprc': 0.998678752799437, 'loss_val': 0.06926834017596796, 'psi': 0.9832615025389465}-{'f1_val': 0.9922164873423569, 'auprc': 0.9993821795209714, 'loss_val': 0.03887048840290896, 'psi': 0.9950827642138027}
[S9] START round=35 head_norm_before_train=2.004949 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9985281752942964, 'loss_val': 0.028855497704932714, 'psi': 0.9977147769269623}-{'f1_val': 0.9969222458854735, 'auprc': 0.9987805456527644, 'loss_val': 0.027519300006657078, 'psi': 0.9976655657923899}
[S10] START round=35 head_norm_before_train=1.954487 cos_to_last_merge=0.8332 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.833
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9951284679967315, 'loss_val': 0.028650650697835223, 'psi': 0.9947688512777292}-{'f1_val': 0.9951878390193748, 'auprc': 0.994848160079103, 'loss_val': 0.0277326926783177, 'psi': 0.9950519674432661}
[S11] START round=35 head_norm_before_train=1.341438 cos_to_last_merge=0.9981 (last merge round=32)
[S11] round=35 local utility u=0.007311 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963351261872574, 'loss_val': 0.07763754127768926, 'psi': 0.9962142554228886}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963158746692025, 'loss_val': 0.09220220572272389, 'psi': 0.9962065548156666}
[S13] START round=35 head_norm_before_train=1.911743 (no previous merge yet)
[S13] round=35 local utility u=0.330574 metrics={'f1_val': 0.6383640408137267, 'auprc': 0.6788421971037455, 'loss_val': 0.900017341628929, 'psi': 0.6545553033297342}-{'f1_val': 0.6129242714790399, 'auprc': 0.6251285712739346, 'loss_val': 1.247385077321291, 'psi': 0.6178059913969978}
[S14] START round=35 head_norm_before_train=1.203335 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.008495 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9986048300934248, 'loss_val': 0.15586169371821765, 'psi': 0.9976541057110953}-{'f1_val': 0.9973862616479148, 'auprc': 0.998662080623488, 'loss_val': 0.17521905791257225, 'psi': 0.9978965892381441}
[S15] START round=35 head_norm_before_train=1.515779 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.340633 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977769211495299, 'loss_val': 0.0615190690638244, 'psi': 0.9971587694923243}-{'f1_val': 0.903170176196454, 'auprc': 0.997129535761845, 'loss_val': 0.17938337557563486, 'psi': 0.9407539200226104}
[S16] START round=35 head_norm_before_train=1.098786 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8508869246677043, 'auprc': 0.9608694241388372, 'loss_val': 0.6401951280177814, 'psi': 0.8948799244561574}-{'f1_val': 0.9913687001057281, 'auprc': 0.989402390283334, 'loss_val': 0.1009033344585528, 'psi': 0.9905821761767705}
[S17] START round=35 head_norm_before_train=1.756641 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.252696 metrics={'f1_val': 0.6594230663340486, 'auprc': 0.9228982169820288, 'loss_val': 0.6187421819694139, 'psi': 0.7648131265932406}-{'f1_val': 0.6322715023177266, 'auprc': 0.8729619264489952, 'loss_val': 0.8114155915228323, 'psi': 0.728547671970234}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:45902
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:45912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:45913
[S3] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.996)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1804) from S13
[S2] cosine check vs S13: cos=-0.0126
[S2] DROPPED delta from S13 (cos=-0.0126 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S15
[S13] cosine check vs S15: cos=-0.0741
[S13] DROPPED delta from S15 (cos=-0.0741 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.9500
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=-0.0831
[S17] DROPPED delta from S6 (cos=-0.0831 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:45914
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] cosine check vs S17: cos=0.4530
[S8] ⇄ pheromone p=0.039 → S3@127.0.0.1:45903
[S2] ⇄ pheromone p=0.035 → S17@127.0.0.1:45917
[S5] ⇄ pheromone p=0.186 → S16@127.0.0.1:45916
[S7] ⇄ pheromone p=0.148 → S4@127.0.0.1:45904
[S3] ⇄ pheromone p=0.068 → S17@127.0.0.1:45917
[S4] ⇄ pheromone p=0.084 → S14@127.0.0.1:45914
[S9] ⇄ pheromone p=0.016 → S16@127.0.0.1:45916
[S10] ⇄ pheromone p=0.002 → S8@127.0.0.1:45909
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.9961 head_norm=1.376117
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.167570e-01
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.9961 head_norm=1.295820 delta_norm=0.216757
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.023 → S16@127.0.0.1:45916
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9970 head_norm=1.248427
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.279944e-01
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9970 head_norm=1.303434 delta_norm=0.827994
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.017 → S11@127.0.0.1:45912
[S6] ⇄ pheromone p=0.313 → S17@127.0.0.1:45917
[S13] ⇄ pheromone p=0.160 → S2@127.0.0.1:45902
[S15] ⇄ pheromone p=0.150 → S13@127.0.0.1:45913
[S16] ⇄ pheromone p=0.119 → S15@127.0.0.1:45915
[S17] ⇄ pheromone p=0.143 → S14@127.0.0.1:45914
[S2] START round=36 head_norm_before_train=1.903990 cos_to_last_merge=0.7644 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.764
[S2] round=36 local utility u=0.387916 metrics={'f1_val': 0.721649467391573, 'auprc': 0.7346763820392705, 'loss_val': 1.0692851331391007, 'psi': 0.726860233250652}-{'f1_val': 0.6626256481346293, 'auprc': 0.7532784956400252, 'loss_val': 1.546780788230527, 'psi': 0.6988867871367876}
[S3] START round=36 head_norm_before_train=2.012866 cos_to_last_merge=0.9999 (last merge round=34)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.961651265966383, 'loss_val': 0.14139712755156428, 'psi': 0.9610030908079286}-{'f1_val': 0.9973696976584205, 'auprc': 0.9975641048978114, 'loss_val': 0.044212098733984746, 'psi': 0.9974474605541769}
[S4] START round=36 head_norm_before_train=1.558395 cos_to_last_merge=0.9970 (last merge round=33)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9401554015721016, 'auprc': 0.965265630686843, 'loss_val': 0.3045615748547813, 'psi': 0.9501994932179982}-{'f1_val': 0.9430613339673896, 'auprc': 0.9630891099670194, 'loss_val': 0.2892915619702284, 'psi': 0.9510724443672415}
[S5] START round=36 head_norm_before_train=1.802987 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9944002593158312, 'loss_val': 0.07933467117902636, 'psi': 0.9957353181980484}-{'f1_val': 0.9967726868314644, 'auprc': 0.998255079001298, 'loss_val': 0.0681331171436108, 'psi': 0.9973656436993978}
[S6] START round=36 head_norm_before_train=2.040076 (no previous merge yet)
[S6] round=36 local utility u=0.025090 metrics={'f1_val': 0.7727930696700067, 'auprc': 0.9518402282465046, 'loss_val': 0.5861092453621101, 'psi': 0.8444119331006059}-{'f1_val': 0.7858285733781041, 'auprc': 0.9145404078714519, 'loss_val': 0.6026033415588365, 'psi': 0.8373133071754433}
[S7] START round=36 head_norm_before_train=1.471351 cos_to_last_merge=0.8122 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.812
[S7] round=36 local utility u=0.155033 metrics={'f1_val': 0.6404441560834239, 'auprc': 0.7982139259398151, 'loss_val': 0.5578378974478491, 'psi': 0.7035520640259805}-{'f1_val': 0.608176228430923, 'auprc': 0.7892287290458154, 'loss_val': 0.6473416412810034, 'psi': 0.68059722867688}
[S8] START round=36 head_norm_before_train=1.992497 cos_to_last_merge=0.9999 (last merge round=33)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9641517641247963, 'auprc': 0.9977380219008328, 'loss_val': 0.11003256358503073, 'psi': 0.9775862672352109}-{'f1_val': 0.9729833356986195, 'auprc': 0.998678752799437, 'loss_val': 0.06926834017596796, 'psi': 0.9832615025389465}
[S9] START round=36 head_norm_before_train=2.017697 (no previous merge yet)
[S9] round=36 local utility u=0.000854 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.998590110467893, 'loss_val': 0.027333256668269804, 'psi': 0.9977395509964009}-{'f1_val': 0.9971725113487396, 'auprc': 0.9985281752942964, 'loss_val': 0.028855497704932714, 'psi': 0.9977147769269623}
[S10] START round=36 head_norm_before_train=1.965264 cos_to_last_merge=0.8327 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.833
[S10] round=36 local utility u=0.000217 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9949815983026064, 'loss_val': 0.02777585880860897, 'psi': 0.9947101034000791}-{'f1_val': 0.9945291067983943, 'auprc': 0.9951284679967315, 'loss_val': 0.028650650697835223, 'psi': 0.9947688512777292}
[S11] START round=36 head_norm_before_train=1.295820 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9948222870966001, 'loss_val': 0.10549406127096629, 'psi': 0.9958571175467938}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963351261872574, 'loss_val': 0.07763754127768926, 'psi': 0.9962142554228886}
[S13] START round=36 head_norm_before_train=1.922890 (no previous merge yet)
[S13] round=36 local utility u=0.141950 metrics={'f1_val': 0.7145189717808142, 'auprc': 0.6619274197109495, 'loss_val': 1.0223022491388793, 'psi': 0.6934823509528684}-{'f1_val': 0.6383640408137267, 'auprc': 0.6788421971037455, 'loss_val': 0.900017341628929, 'psi': 0.6545553033297342}
[S14] START round=36 head_norm_before_train=1.303434 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9987534514625076, 'loss_val': 0.17349209812701982, 'psi': 0.9976998854796021}-{'f1_val': 0.9970202894562089, 'auprc': 0.9986048300934248, 'loss_val': 0.15586169371821765, 'psi': 0.9976541057110953}
[S15] START round=36 head_norm_before_train=1.560937 cos_to_last_merge=0.9994 (last merge round=34)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.948604372467424, 'auprc': 0.9970749705817702, 'loss_val': 0.10181412449305677, 'psi': 0.9679926117131625}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977769211495299, 'loss_val': 0.0615190690638244, 'psi': 0.9971587694923243}
[S16] START round=36 head_norm_before_train=1.137928 cos_to_last_merge=0.9991 (last merge round=34)
[S16] round=36 local utility u=0.059869 metrics={'f1_val': 0.8605261307753214, 'auprc': 0.9669660206579169, 'loss_val': 0.5965817856740128, 'psi': 0.9031020867283596}-{'f1_val': 0.8508869246677043, 'auprc': 0.9608694241388372, 'loss_val': 0.6401951280177814, 'psi': 0.8948799244561574}
[S17] START round=36 head_norm_before_train=1.791776 cos_to_last_merge=0.9995 (last merge round=34)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6394075131240169, 'auprc': 0.8972919745345248, 'loss_val': 0.7119471077072467, 'psi': 0.7425612976882201}-{'f1_val': 0.6594230663340486, 'auprc': 0.9228982169820288, 'loss_val': 0.6187421819694139, 'psi': 0.7648131265932406}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:45917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:45904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:45916
[S13] not sending this round → trigger blocked (psi=0.693)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:45909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.844)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:45915
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=0.9984
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] cosine check vs S16: cos=0.8964
[S17] RECEIVED delta(kind=head bytes=1804) from S2
[S17] cosine check vs S2: cos=0.1475
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.9819
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.7044
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9402 head_norm=1.584022
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.543610e-01
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9402 head_norm=1.525621 delta_norm=0.154361
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.9642 head_norm=2.004869
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.867509e-02
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.9632 head_norm=1.987776 delta_norm=0.058675
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.8605 head_norm=1.182274
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.315727e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.8603 head_norm=1.492277 delta_norm=0.731573
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.6394 head_norm=1.827323
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.221615e+00
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.6430 head_norm=1.417140 delta_norm=1.221615
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.9486 head_norm=1.604509
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.779671e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.9403 head_norm=1.357664 delta_norm=0.377967
[S15] aggregate: ROLLBACK (f1_val pre=0.949 post=0.940 tol_abs=0.005 tol_rel=0.0)
[S2] START round=37 head_norm_before_train=1.913674 cos_to_last_merge=0.7635 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.763
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6804167935101753, 'auprc': 0.7283985657756425, 'loss_val': 1.2231581425470544, 'psi': 0.6996095024163622}-{'f1_val': 0.721649467391573, 'auprc': 0.7346763820392705, 'loss_val': 1.0692851331391007, 'psi': 0.726860233250652}
[S3] START round=37 head_norm_before_train=2.029321 cos_to_last_merge=0.9998 (last merge round=34)
[S3] round=37 local utility u=0.193260 metrics={'f1_val': 0.9906678593791969, 'auprc': 0.9980051541416729, 'loss_val': 0.044520126113127785, 'psi': 0.9936027772841872}-{'f1_val': 0.9605709740356257, 'auprc': 0.961651265966383, 'loss_val': 0.14139712755156428, 'psi': 0.9610030908079286}
[S4] START round=37 head_norm_before_train=1.525621 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9401326765642197, 'auprc': 0.9630692727122467, 'loss_val': 0.3132493398025556, 'psi': 0.9493073150234306}-{'f1_val': 0.9401554015721016, 'auprc': 0.965265630686843, 'loss_val': 0.3045615748547813, 'psi': 0.9501994932179982}
[S5] START round=37 head_norm_before_train=1.809358 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9632845642752507, 'auprc': 0.9915884167447454, 'loss_val': 0.1214743020934482, 'psi': 0.9746061052630486}-{'f1_val': 0.9966253574528599, 'auprc': 0.9944002593158312, 'loss_val': 0.07933467117902636, 'psi': 0.9957353181980484}
[S6] START round=37 head_norm_before_train=2.048341 (no previous merge yet)
[S6] round=37 local utility u=0.402910 metrics={'f1_val': 0.8660034337393779, 'auprc': 0.9654768940790541, 'loss_val': 0.3804606868987021, 'psi': 0.9057928178752485}-{'f1_val': 0.7727930696700067, 'auprc': 0.9518402282465046, 'loss_val': 0.5861092453621101, 'psi': 0.8444119331006059}
[S7] START round=37 head_norm_before_train=1.481070 cos_to_last_merge=0.8106 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6115723793070427, 'auprc': 0.7930836677856766, 'loss_val': 0.6453137489890228, 'psi': 0.6841768946984963}-{'f1_val': 0.6404441560834239, 'auprc': 0.7982139259398151, 'loss_val': 0.5578378974478491, 'psi': 0.7035520640259805}
[S8] START round=37 head_norm_before_train=1.987776 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.132022 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.999404763520988, 'loss_val': 0.035088054172809455, 'psi': 0.9966628759551371}-{'f1_val': 0.9641517641247963, 'auprc': 0.9977380219008328, 'loss_val': 0.11003256358503073, 'psi': 0.9775862672352109}
[S9] START round=37 head_norm_before_train=2.031355 (no previous merge yet)
[S9] round=37 local utility u=0.001390 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9987784927034784, 'loss_val': 0.02511868543470388, 'psi': 0.9978149038906351}-{'f1_val': 0.9971725113487396, 'auprc': 0.998590110467893, 'loss_val': 0.027333256668269804, 'psi': 0.9977395509964009}
[S10] START round=37 head_norm_before_train=1.972281 cos_to_last_merge=0.8325 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.832
[S10] round=37 local utility u=0.000039 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9950282847338738, 'loss_val': 0.027838392565248508, 'psi': 0.9947287779725862}-{'f1_val': 0.9945291067983943, 'auprc': 0.9949815983026064, 'loss_val': 0.02777585880860897, 'psi': 0.9947101034000791}
[S11] START round=37 head_norm_before_train=1.328342 cos_to_last_merge=0.9995 (last merge round=35)
[S11] round=37 local utility u=0.013253 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9973193193437655, 'loss_val': 0.0864796087920739, 'psi': 0.9968559304456599}-{'f1_val': 0.9965470045135896, 'auprc': 0.9948222870966001, 'loss_val': 0.10549406127096629, 'psi': 0.9958571175467938}
[S13] START round=37 head_norm_before_train=1.925568 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6356561296729011, 'auprc': 0.7233059081695444, 'loss_val': 0.9234893673056302, 'psi': 0.6707160410715585}-{'f1_val': 0.7145189717808142, 'auprc': 0.6619274197109495, 'loss_val': 1.0223022491388793, 'psi': 0.6934823509528684}
[S14] START round=37 head_norm_before_train=1.343875 cos_to_last_merge=0.9985 (last merge round=35)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9421058842751687, 'auprc': 0.999119448926013, 'loss_val': 0.18781387706252126, 'psi': 0.9649113101355065}-{'f1_val': 0.9969975081576651, 'auprc': 0.9987534514625076, 'loss_val': 0.17349209812701982, 'psi': 0.9976998854796021}
[S15] START round=37 head_norm_before_train=1.357664 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.159933 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9972471143045396, 'loss_val': 0.07131799667315082, 'psi': 0.9969468467543282}-{'f1_val': 0.948604372467424, 'auprc': 0.9970749705817702, 'loss_val': 0.10181412449305677, 'psi': 0.9679926117131625}
[S16] START round=37 head_norm_before_train=1.492277 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.481121 metrics={'f1_val': 0.9400900083324262, 'auprc': 0.9885224629126768, 'loss_val': 0.17639170043948957, 'psi': 0.9594629901645264}-{'f1_val': 0.8605261307753214, 'auprc': 0.9669660206579169, 'loss_val': 0.5965817856740128, 'psi': 0.9031020867283596}
[S17] START round=37 head_norm_before_train=1.417140 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6072679785138559, 'auprc': 0.8137366271256179, 'loss_val': 0.8828983523439232, 'psi': 0.6898554379585607}-{'f1_val': 0.6394075131240169, 'auprc': 0.8972919745345248, 'loss_val': 0.7119471077072467, 'psi': 0.7425612976882201}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:45903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:45913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:45916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.959)
[S9] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:45917
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=0.9980
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=-0.0764
[S13] DROPPED delta from S15 (cos=-0.0764 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S3
[S17] cosine check vs S3: cos=0.5964
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=-0.0514
[S17] DROPPED delta from S6 (cos=-0.0514 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] cosine check vs S11: cos=0.2560
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9907 head_norm=2.045520
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.862825e-02
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9877 head_norm=2.021735 delta_norm=0.068628
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.6073 head_norm=1.455889
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.293599e-01
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.6090 head_norm=1.569728 delta_norm=0.829360
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9401 head_norm=1.528021
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.840916e-01
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9374 head_norm=1.146703 delta_norm=0.884092
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.923801 cos_to_last_merge=0.7624 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=38 local utility u=0.523566 metrics={'f1_val': 0.7177109905334109, 'auprc': 0.8370400954499355, 'loss_val': 0.7257149532857781, 'psi': 0.7654426325000208}-{'f1_val': 0.6804167935101753, 'auprc': 0.7283985657756425, 'loss_val': 1.2231581425470544, 'psi': 0.6996095024163622}
[S3] START round=38 head_norm_before_train=2.021735 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.007778 metrics={'f1_val': 0.9969737296901819, 'auprc': 0.9982633201123958, 'loss_val': 0.06757470697051673, 'psi': 0.9974895658590675}-{'f1_val': 0.9906678593791969, 'auprc': 0.9980051541416729, 'loss_val': 0.044520126113127785, 'psi': 0.9936027772841872}
[S4] START round=38 head_norm_before_train=1.554933 cos_to_last_merge=0.9994 (last merge round=36)
[S4] round=38 local utility u=0.001808 metrics={'f1_val': 0.9406203224137933, 'auprc': 0.9617447972384368, 'loss_val': 0.3085853264315031, 'psi': 0.9490701123436507}-{'f1_val': 0.9401326765642197, 'auprc': 0.9630692727122467, 'loss_val': 0.3132493398025556, 'psi': 0.9493073150234306}
[S5] START round=38 head_norm_before_train=1.814846 (no previous merge yet)
[S5] round=38 local utility u=0.140938 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9983453755409688, 'loss_val': 0.05991418898684924, 'psi': 0.9973133646881034}-{'f1_val': 0.9632845642752507, 'auprc': 0.9915884167447454, 'loss_val': 0.1214743020934482, 'psi': 0.9746061052630486}
[S6] START round=38 head_norm_before_train=2.054877 (no previous merge yet)
[S6] round=38 local utility u=0.070617 metrics={'f1_val': 0.8775419975566312, 'auprc': 0.9631109806045427, 'loss_val': 0.30136108228686487, 'psi': 0.9117695907757959}-{'f1_val': 0.8660034337393779, 'auprc': 0.9654768940790541, 'loss_val': 0.3804606868987021, 'psi': 0.9057928178752485}
[S7] START round=38 head_norm_before_train=1.493356 cos_to_last_merge=0.8085 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.809
[S7] round=38 local utility u=0.038596 metrics={'f1_val': 0.6115218013403354, 'auprc': 0.7947868172743083, 'loss_val': 0.5729285494360234, 'psi': 0.6848278077139245}-{'f1_val': 0.6115723793070427, 'auprc': 0.7930836677856766, 'loss_val': 0.6453137489890228, 'psi': 0.6841768946984963}
[S8] START round=38 head_norm_before_train=2.000022 cos_to_last_merge=0.9999 (last merge round=36)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9638699522702706, 'auprc': 0.9985589643098126, 'loss_val': 0.11169481659991255, 'psi': 0.9777455570860873}-{'f1_val': 0.9948349509112366, 'auprc': 0.999404763520988, 'loss_val': 0.035088054172809455, 'psi': 0.9966628759551371}
[S9] START round=38 head_norm_before_train=2.044645 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9987089674827831, 'loss_val': 0.02532354897355676, 'psi': 0.997787093802357}-{'f1_val': 0.9971725113487396, 'auprc': 0.9987784927034784, 'loss_val': 0.02511868543470388, 'psi': 0.9978149038906351}
[S10] START round=38 head_norm_before_train=1.980363 cos_to_last_merge=0.8321 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.832
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9951280856217715, 'loss_val': 0.028255804657932742, 'psi': 0.9947686983277452}-{'f1_val': 0.9945291067983943, 'auprc': 0.9950282847338738, 'loss_val': 0.027838392565248508, 'psi': 0.9947287779725862}
[S11] START round=38 head_norm_before_train=1.363175 cos_to_last_merge=0.9980 (last merge round=35)
[S11] round=38 local utility u=0.006409 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974942310248447, 'loss_val': 0.0741866029790542, 'psi': 0.9969258951180916}-{'f1_val': 0.9965470045135896, 'auprc': 0.9973193193437655, 'loss_val': 0.0864796087920739, 'psi': 0.9968559304456599}
[S13] START round=38 head_norm_before_train=1.929666 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6470894151987554, 'auprc': 0.6794737643290771, 'loss_val': 0.9290430200464889, 'psi': 0.660043154850884}-{'f1_val': 0.6356561296729011, 'auprc': 0.7233059081695444, 'loss_val': 0.9234893673056302, 'psi': 0.6707160410715585}
[S14] START round=38 head_norm_before_train=1.387588 cos_to_last_merge=0.9947 (last merge round=35)
[S14] round=38 local utility u=0.201109 metrics={'f1_val': 0.9957680459173418, 'auprc': 0.9986915790655511, 'loss_val': 0.10628558461109243, 'psi': 0.9969374591766256}-{'f1_val': 0.9421058842751687, 'auprc': 0.999119448926013, 'loss_val': 0.18781387706252126, 'psi': 0.9649113101355065}
[S15] START round=38 head_norm_before_train=1.413253 cos_to_last_merge=0.9991 (last merge round=36)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9731432212854145, 'auprc': 0.9978114410069878, 'loss_val': 0.08905545236739476, 'psi': 0.9830105091740438}-{'f1_val': 0.9967466683875206, 'auprc': 0.9972471143045396, 'loss_val': 0.07131799667315082, 'psi': 0.9969468467543282}
[S16] START round=38 head_norm_before_train=1.146703 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.156477 metrics={'f1_val': 0.9904597047350301, 'auprc': 0.9943777775578282, 'loss_val': 0.18322138982563338, 'psi': 0.9920269338641493}-{'f1_val': 0.9400900083324262, 'auprc': 0.9885224629126768, 'loss_val': 0.17639170043948957, 'psi': 0.9594629901645264}
[S17] START round=38 head_norm_before_train=1.569728 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.290076 metrics={'f1_val': 0.6374970024206559, 'auprc': 0.8506432966625521, 'loss_val': 0.5948408409005103, 'psi': 0.7227555201174143}-{'f1_val': 0.6072679785138559, 'auprc': 0.8137366271256179, 'loss_val': 0.8828983523439232, 'psi': 0.6898554379585607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:45909
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:45908
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:45905
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=0.2425
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.8349
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=-0.0132
[S13] DROPPED delta from S2 (cos=-0.0132 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=0.9992
[S7] RECEIVED delta(kind=head bytes=1805) from S4
[S7] cosine check vs S4: cos=0.9871
[S17] RECEIVED delta(kind=head bytes=1796) from S14
[S17] cosine check vs S14: cos=0.8716
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:45907
[S17] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S17
[S6] cosine check vs S17: cos=-0.0766
[S6] DROPPED delta from S17 (cos=-0.0766 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.6115 head_norm=1.503246
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.302681e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.6194 head_norm=1.538549 delta_norm=0.130268
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9639 head_norm=2.014282
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.093799e-02
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9639 head_norm=2.024783 delta_norm=0.040938
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.9966 head_norm=1.820211
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.577277e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.9966 head_norm=1.199775 delta_norm=0.957728
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.6375 head_norm=1.623881
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.981306e-01
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.6312 head_norm=1.476369 delta_norm=0.398131
[S17] aggregate: ROLLBACK (f1_val pre=0.637 post=0.631 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=38 metric=0.9958 head_norm=1.428061
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.054320e-01
[S14] stored merged vector for next round verification (round=38)
[S14] DEBUG after merge:  round=38 metric=0.9958 head_norm=1.350570 delta_norm=0.405432
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.928770 cos_to_last_merge=0.7621 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=39 local utility u=0.322511 metrics={'f1_val': 0.7694034941876835, 'auprc': 0.8881153020788252, 'loss_val': 0.5440739423488483, 'psi': 0.8168882173441401}-{'f1_val': 0.7177109905334109, 'auprc': 0.8370400954499355, 'loss_val': 0.7257149532857781, 'psi': 0.7654426325000208}
[S3] START round=39 head_norm_before_train=2.036054 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=39 local utility u=0.013490 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9989455959058193, 'loss_val': 0.04536183392321691, 'psi': 0.9980345159342623}-{'f1_val': 0.9969737296901819, 'auprc': 0.9982633201123958, 'loss_val': 0.06757470697051673, 'psi': 0.9974895658590675}
[S4] START round=39 head_norm_before_train=1.583811 cos_to_last_merge=0.9980 (last merge round=36)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9408393079667892, 'auprc': 0.9611342650937114, 'loss_val': 0.31186149441054806, 'psi': 0.9489572908175581}-{'f1_val': 0.9406203224137933, 'auprc': 0.9617447972384368, 'loss_val': 0.3085853264315031, 'psi': 0.9490701123436507}
[S5] START round=39 head_norm_before_train=1.199775 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9946881748730728, 'loss_val': 0.1914720907992873, 'psi': 0.995850484420945}-{'f1_val': 0.9966253574528599, 'auprc': 0.9983453755409688, 'loss_val': 0.05991418898684924, 'psi': 0.9973133646881034}
[S6] START round=39 head_norm_before_train=2.062268 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.5951488807778766, 'auprc': 0.8727185018331232, 'loss_val': 1.0899049559268301, 'psi': 0.7061767291999752}-{'f1_val': 0.8775419975566312, 'auprc': 0.9631109806045427, 'loss_val': 0.30136108228686487, 'psi': 0.9117695907757959}
[S7] START round=39 head_norm_before_train=1.538549 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5927324942555371, 'auprc': 0.7911325995555143, 'loss_val': 0.673151510900441, 'psi': 0.6720925363755279}-{'f1_val': 0.6115218013403354, 'auprc': 0.7947868172743083, 'loss_val': 0.5729285494360234, 'psi': 0.6848278077139245}
[S8] START round=39 head_norm_before_train=2.024783 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.128880 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9995047433302133, 'loss_val': 0.03375560455791484, 'psi': 0.9958222835964946}-{'f1_val': 0.9638699522702706, 'auprc': 0.9985589643098126, 'loss_val': 0.11169481659991255, 'psi': 0.9777455570860873}
[S9] START round=39 head_norm_before_train=2.055721 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9969838606176745, 'loss_val': 0.02415188366479164, 'psi': 0.9968505103114788}-{'f1_val': 0.9971725113487396, 'auprc': 0.9987089674827831, 'loss_val': 0.02532354897355676, 'psi': 0.997787093802357}
[S10] START round=39 head_norm_before_train=1.990244 cos_to_last_merge=0.8317 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.832
[S10] round=39 local utility u=0.002618 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952231492217849, 'loss_val': 0.027257300427909425, 'psi': 0.9952019631003388}-{'f1_val': 0.9945291067983943, 'auprc': 0.9951280856217715, 'loss_val': 0.028255804657932742, 'psi': 0.9947686983277452}
[S11] START round=39 head_norm_before_train=1.391931 cos_to_last_merge=0.9961 (last merge round=35)
[S11] round=39 local utility u=0.004215 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997612949626603, 'loss_val': 0.06611201840309502, 'psi': 0.996973382558795}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974942310248447, 'loss_val': 0.0741866029790542, 'psi': 0.9969258951180916}
[S13] START round=39 head_norm_before_train=1.932248 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.634289427654681, 'auprc': 0.6421736962567183, 'loss_val': 1.1325974939039696, 'psi': 0.6374431350954959}-{'f1_val': 0.6470894151987554, 'auprc': 0.6794737643290771, 'loss_val': 0.9290430200464889, 'psi': 0.660043154850884}
[S14] START round=39 head_norm_before_train=1.350570 cos_to_last_merge=1.0000 (last merge round=38)
[S14] round=39 local utility u=0.017664 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9986646259653089, 'loss_val': 0.07825638722844207, 'psi': 0.9976647356573592}-{'f1_val': 0.9957680459173418, 'auprc': 0.9986915790655511, 'loss_val': 0.10628558461109243, 'psi': 0.9969374591766256}
[S15] START round=39 head_norm_before_train=1.472145 cos_to_last_merge=0.9965 (last merge round=36)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.8104950829149268, 'auprc': 0.9941516436027484, 'loss_val': 0.31303819600241933, 'psi': 0.8839577071900555}-{'f1_val': 0.9731432212854145, 'auprc': 0.9978114410069878, 'loss_val': 0.08905545236739476, 'psi': 0.9830105091740438}
[S16] START round=39 head_norm_before_train=1.183316 cos_to_last_merge=0.9990 (last merge round=37)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9412896201852344, 'auprc': 0.9916603857199588, 'loss_val': 0.22842610525722692, 'psi': 0.9614379263991242}-{'f1_val': 0.9904597047350301, 'auprc': 0.9943777775578282, 'loss_val': 0.18322138982563338, 'psi': 0.9920269338641493}
[S17] START round=39 head_norm_before_train=1.476369 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.018355 metrics={'f1_val': 0.636526530082014, 'auprc': 0.9062598145446052, 'loss_val': 0.7191577052197925, 'psi': 0.7444198438670505}-{'f1_val': 0.6374970024206559, 'auprc': 0.8506432966625521, 'loss_val': 0.5948408409005103, 'psi': 0.7227555201174143}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:45909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=-0.0128
[S13] DROPPED delta from S2 (cos=-0.0128 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] cosine check vs S3: cos=0.9996
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:45914
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.9565
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:45911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:45907
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S14
[S17] cosine check vs S14: cos=0.8532
[S10] RECEIVED delta(kind=head bytes=1797) from S8
[S10] cosine check vs S8: cos=0.9981
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] cosine check vs S17: cos=-0.0751
[S6] DROPPED delta from S17 (cos=-0.0751 < 0.0)
[S4] r=40 psi=0.949 u=0.0000 p_local=0.0349 f1=0.941 auprc=0.961 bytes=30578
[S6] r=40 psi=0.706 u=0.0000 p_local=0.1937 f1=0.595 auprc=0.873 bytes=32373
[S5] r=40 psi=0.996 u=0.0000 p_local=0.0986 f1=0.997 auprc=0.995 bytes=28763
[S2] r=40 psi=0.817 u=0.3225 p_local=0.2022 f1=0.769 auprc=0.888 bytes=28840
[S3] r=40 psi=0.998 u=0.0135 p_local=0.0564 f1=0.997 auprc=0.999 bytes=35990
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0068 f1=0.997 auprc=0.997 bytes=34177
[S7] r=40 psi=0.672 u=0.0000 p_local=0.0828 f1=0.593 auprc=0.791 bytes=32371
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=39 metric=0.9952 head_norm=1.995203
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.680527e-02
[S10] stored merged vector for next round verification (round=39)
[S10] DEBUG after merge:  round=39 metric=0.9952 head_norm=2.016579 delta_norm=0.066805
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] r=40 psi=0.995 u=0.0026 p_local=0.0015 f1=0.995 auprc=0.995 bytes=32368
[S13] r=40 psi=0.637 u=0.0000 p_local=0.0801 f1=0.634 auprc=0.642 bytes=27038
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9934 head_norm=2.039919
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.029938e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9934 head_norm=2.045181 delta_norm=0.030299
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.996 u=0.1289 p_local=0.0588 f1=0.993 auprc=1.000 bytes=30582
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9970 head_norm=1.388574
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.072670e-01
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9970 head_norm=1.386518 delta_norm=0.207267
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.998 u=0.0177 p_local=0.0429 f1=0.997 auprc=0.999 bytes=34136
[S15] r=40 psi=0.884 u=0.0000 p_local=0.0821 f1=0.810 auprc=0.994 bytes=30561
[S16] r=40 psi=0.961 u=0.0000 p_local=0.1417 f1=0.941 auprc=0.992 bytes=30549
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.6365 head_norm=1.519215
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.989066e-01
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.6352 head_norm=1.399625 delta_norm=0.398907
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.744 u=0.0184 p_local=0.1086 f1=0.637 auprc=0.906 bytes=25205
[S11] r=40 psi=0.997 u=0.0042 p_local=0.0129 f1=0.997 auprc=0.998 bytes=32347
[S2] START round=40 head_norm_before_train=1.935007 cos_to_last_merge=0.7618 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7208761106926097, 'auprc': 0.7374872859070318, 'loss_val': 1.046908033039345, 'psi': 0.7275205807783786}-{'f1_val': 0.7694034941876835, 'auprc': 0.8881153020788252, 'loss_val': 0.5440739423488483, 'psi': 0.8168882173441401}
[S3] START round=40 head_norm_before_train=2.050877 cos_to_last_merge=0.9999 (last merge round=37)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9742014211050578, 'auprc': 0.9977132794795867, 'loss_val': 0.07197946291577383, 'psi': 0.9836061644548694}-{'f1_val': 0.9974271292865575, 'auprc': 0.9989455959058193, 'loss_val': 0.04536183392321691, 'psi': 0.9980345159342623}
[S4] START round=40 head_norm_before_train=1.610386 cos_to_last_merge=0.9963 (last merge round=36)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9399657960033723, 'auprc': 0.9597288861566804, 'loss_val': 0.33803300481083315, 'psi': 0.9478710320646956}-{'f1_val': 0.9408393079667892, 'auprc': 0.9611342650937114, 'loss_val': 0.31186149441054806, 'psi': 0.9489572908175581}
[S5] START round=40 head_norm_before_train=1.224762 cos_to_last_merge=0.9996 (last merge round=38)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9778419444723411, 'auprc': 0.9946679071678282, 'loss_val': 0.18607015571322544, 'psi': 0.984572329550536}-{'f1_val': 0.9966253574528599, 'auprc': 0.9946881748730728, 'loss_val': 0.1914720907992873, 'psi': 0.995850484420945}
[S6] START round=40 head_norm_before_train=2.070367 (no previous merge yet)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.8424115886072407, 'auprc': 0.9393707499782115, 'loss_val': 0.45103064640724416, 'psi': 0.8811952531556291}-{'f1_val': 0.5951488807778766, 'auprc': 0.8727185018331232, 'loss_val': 1.0899049559268301, 'psi': 0.7061767291999752}
[S7] START round=40 head_norm_before_train=1.549991 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=40 local utility u=0.246960 metrics={'f1_val': 0.6425466489353132, 'auprc': 0.8043587249615397, 'loss_val': 0.5177952346994126, 'psi': 0.7072714793458038}-{'f1_val': 0.5927324942555371, 'auprc': 0.7911325995555143, 'loss_val': 0.673151510900441, 'psi': 0.6720925363755279}
[S8] START round=40 head_norm_before_train=2.045181 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.999498185860036, 'loss_val': 0.03408119389823075, 'psi': 0.9950519233813339}-{'f1_val': 0.9933673104406822, 'auprc': 0.9995047433302133, 'loss_val': 0.03375560455791484, 'psi': 0.9958222835964946}
[S9] START round=40 head_norm_before_train=2.067581 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9965113446440821, 'auprc': 0.9969548471884759, 'loss_val': 0.022995199955523196, 'psi': 0.9966887456618396}-{'f1_val': 0.9967616101073482, 'auprc': 0.9969838606176745, 'loss_val': 0.02415188366479164, 'psi': 0.9968505103114788}
[S10] START round=40 head_norm_before_train=2.016579 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9949489371903193, 'loss_val': 0.027522302965593805, 'psi': 0.9946970389551644}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952231492217849, 'loss_val': 0.027257300427909425, 'psi': 0.9952019631003388}
[S11] START round=40 head_norm_before_train=1.415149 cos_to_last_merge=0.9943 (last merge round=35)
[S11] round=40 local utility u=0.003532 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984708454117448, 'loss_val': 0.05914141209516834, 'psi': 0.9970685431126836}-{'f1_val': 0.9965470045135896, 'auprc': 0.997612949626603, 'loss_val': 0.06611201840309502, 'psi': 0.996973382558795}
[S13] START round=40 head_norm_before_train=1.941370 (no previous merge yet)
[S13] round=40 local utility u=0.024992 metrics={'f1_val': 0.6236417790512601, 'auprc': 0.6537720307027629, 'loss_val': 1.053521739760905, 'psi': 0.6356938797118612}-{'f1_val': 0.634289427654681, 'auprc': 0.6421736962567183, 'loss_val': 1.1325974939039696, 'psi': 0.6374431350954959}
[S14] START round=40 head_norm_before_train=1.386518 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.004632 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9986702032498984, 'loss_val': 0.06887328123597046, 'psi': 0.9976533813502252}-{'f1_val': 0.9969981421187261, 'auprc': 0.9986646259653089, 'loss_val': 0.07825638722844207, 'psi': 0.9976647356573592}
[S15] START round=40 head_norm_before_train=1.517971 cos_to_last_merge=0.9939 (last merge round=36)
[S15] round=40 local utility u=0.701463 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9975903409401122, 'loss_val': 0.037938433296103295, 'psi': 0.9970841374085573}-{'f1_val': 0.8104950829149268, 'auprc': 0.9941516436027484, 'loss_val': 0.31303819600241933, 'psi': 0.8839577071900555}
[S16] START round=40 head_norm_before_train=1.224010 cos_to_last_merge=0.9961 (last merge round=37)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8861770085933365, 'auprc': 0.9892434317179096, 'loss_val': 0.4334235372969731, 'psi': 0.9274035778431657}-{'f1_val': 0.9412896201852344, 'auprc': 0.9916603857199588, 'loss_val': 0.22842610525722692, 'psi': 0.9614379263991242}
[S17] START round=40 head_norm_before_train=1.399625 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6284506972638352, 'auprc': 0.8350462275025042, 'loss_val': 0.9131138093243177, 'psi': 0.7110889093593028}-{'f1_val': 0.636526530082014, 'auprc': 0.9062598145446052, 'loss_val': 0.7191577052197925, 'psi': 0.7444198438670505}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:45915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:45916
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:45914
[S17] RECEIVED delta(kind=head bytes=1796) from S14
[S17] cosine check vs S14: cos=0.9014
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] cosine check vs S13: cos=-0.0743
[S15] DROPPED delta from S13 (cos=-0.0743 < 0.0)
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.9881
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.8866
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.162 → S13@127.0.0.1:45913
[S8] ⇄ pheromone p=0.047 → S10@127.0.0.1:45911
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9970 head_norm=1.417857
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.106169e-01
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9970 head_norm=1.423592 delta_norm=0.110617
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.035 → S17@127.0.0.1:45917
[S13] ⇄ pheromone p=0.069 → S2@127.0.0.1:45902
[S15] ⇄ pheromone p=0.206 → S16@127.0.0.1:45916
[S3] ⇄ pheromone p=0.045 → S8@127.0.0.1:45909
[S10] ⇄ pheromone p=0.001 → S8@127.0.0.1:45909
[S11] ⇄ pheromone p=0.011 → S14@127.0.0.1:45914
[S4] ⇄ pheromone p=0.028 → S7@127.0.0.1:45908
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.6285 head_norm=1.451151
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.189965e-01
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.6270 head_norm=1.398685 delta_norm=0.318996
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.087 → S6@127.0.0.1:45907
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.8862 head_norm=1.266219
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.630730e-01
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.8936 head_norm=1.368913 delta_norm=0.363073
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.113 → S15@127.0.0.1:45915
[S2] START round=41 head_norm_before_train=1.941073 cos_to_last_merge=0.7613 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.761
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7209081847924166, 'auprc': 0.7303402809315254, 'loss_val': 1.0680914640115444, 'psi': 0.72468102324806}-{'f1_val': 0.7208761106926097, 'auprc': 0.7374872859070318, 'loss_val': 1.046908033039345, 'psi': 0.7275205807783786}
[S3] START round=41 head_norm_before_train=2.065281 cos_to_last_merge=0.9997 (last merge round=37)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.997716253595905, 'loss_val': 0.09144626267055736, 'psi': 0.9757076521016281}-{'f1_val': 0.9742014211050578, 'auprc': 0.9977132794795867, 'loss_val': 0.07197946291577383, 'psi': 0.9836061644548694}
[S4] START round=41 head_norm_before_train=1.628002 cos_to_last_merge=0.9949 (last merge round=36)
[S4] round=41 local utility u=0.007479 metrics={'f1_val': 0.9406300786013053, 'auprc': 0.9583774395493161, 'loss_val': 0.32300690132931037, 'psi': 0.9477290229805096}-{'f1_val': 0.9399657960033723, 'auprc': 0.9597288861566804, 'loss_val': 0.33803300481083315, 'psi': 0.9478710320646956}
[S5] START round=41 head_norm_before_train=1.258903 cos_to_last_merge=0.9979 (last merge round=38)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.8969633423361353, 'auprc': 0.9981421982328884, 'loss_val': 0.18550804737829885, 'psi': 0.9374348846948366}-{'f1_val': 0.9778419444723411, 'auprc': 0.9946679071678282, 'loss_val': 0.18607015571322544, 'psi': 0.984572329550536}
[S6] START round=41 head_norm_before_train=2.078365 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6189186824466913, 'auprc': 0.903176619364778, 'loss_val': 1.0937532619955166, 'psi': 0.732621857213926}-{'f1_val': 0.8424115886072407, 'auprc': 0.9393707499782115, 'loss_val': 0.45103064640724416, 'psi': 0.8811952531556291}
[S7] START round=41 head_norm_before_train=1.558695 cos_to_last_merge=0.9999 (last merge round=38)
[S7] round=41 local utility u=0.197991 metrics={'f1_val': 0.6691015969451576, 'auprc': 0.8294483046737612, 'loss_val': 0.3564110057297129, 'psi': 0.733240280036599}-{'f1_val': 0.6425466489353132, 'auprc': 0.8043587249615397, 'loss_val': 0.5177952346994126, 'psi': 0.7072714793458038}
[S8] START round=41 head_norm_before_train=2.062505 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9873556550456547, 'auprc': 0.999330195613438, 'loss_val': 0.0414620951230106, 'psi': 0.9921454712727681}-{'f1_val': 0.9920877483955324, 'auprc': 0.999498185860036, 'loss_val': 0.03408119389823075, 'psi': 0.9950519233813339}
[S9] START round=41 head_norm_before_train=2.076552 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9897988050802651, 'auprc': 0.99878196239625, 'loss_val': 0.03323904898307572, 'psi': 0.993392068006659}-{'f1_val': 0.9965113446440821, 'auprc': 0.9969548471884759, 'loss_val': 0.022995199955523196, 'psi': 0.9966887456618396}
[S10] START round=41 head_norm_before_train=2.024512 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.994977838427747, 'loss_val': 0.027772333903168803, 'psi': 0.9947085994501355}-{'f1_val': 0.9945291067983943, 'auprc': 0.9949489371903193, 'loss_val': 0.027522302965593805, 'psi': 0.9946970389551644}
[S11] START round=41 head_norm_before_train=1.437839 cos_to_last_merge=0.9926 (last merge round=35)
[S11] round=41 local utility u=0.003496 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981899366298428, 'loss_val': 0.053786956436117875, 'psi': 0.9972041773600908}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984708454117448, 'loss_val': 0.05914141209516834, 'psi': 0.9970685431126836}
[S13] START round=41 head_norm_before_train=1.954376 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.611525087686497, 'auprc': 0.6475233649353638, 'loss_val': 1.1976056391396763, 'psi': 0.6259243985860438}-{'f1_val': 0.6236417790512601, 'auprc': 0.6537720307027629, 'loss_val': 1.053521739760905, 'psi': 0.6356938797118612}
[S14] START round=41 head_norm_before_train=1.423592 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9958978994155416, 'loss_val': 0.0662625067205409, 'psi': 0.9961794586296073}-{'f1_val': 0.9969755000837764, 'auprc': 0.9986702032498984, 'loss_val': 0.06887328123597046, 'psi': 0.9976533813502252}
[S15] START round=41 head_norm_before_train=1.551831 cos_to_last_merge=0.9916 (last merge round=36)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8240349582716423, 'auprc': 0.9079908654935984, 'loss_val': 0.35033964666484724, 'psi': 0.8576173211604248}-{'f1_val': 0.9967466683875206, 'auprc': 0.9975903409401122, 'loss_val': 0.037938433296103295, 'psi': 0.9970841374085573}
[S16] START round=41 head_norm_before_train=1.368913 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.029833 metrics={'f1_val': 0.8884868333483794, 'auprc': 0.9916193887327115, 'loss_val': 0.3947436329117584, 'psi': 0.9297398555021122}-{'f1_val': 0.8861770085933365, 'auprc': 0.9892434317179096, 'loss_val': 0.4334235372969731, 'psi': 0.9274035778431657}
[S17] START round=41 head_norm_before_train=1.398685 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.129064 metrics={'f1_val': 0.6393812276372537, 'auprc': 0.8748048254653896, 'loss_val': 0.8398448276810214, 'psi': 0.7335506667685081}-{'f1_val': 0.6284506972638352, 'auprc': 0.8350462275025042, 'loss_val': 0.9131138093243177, 'psi': 0.7110889093593028}
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:45904
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:45908
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:45914
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9917
[S7] RECEIVED delta(kind=head bytes=1806) from S4
[S7] cosine check vs S4: cos=0.9917
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.9961
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9406 head_norm=1.646776
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.114241e-01
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9409 head_norm=1.602773 delta_norm=0.111424
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:45907
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S17
[S6] cosine check vs S17: cos=-0.0617
[S6] DROPPED delta from S17 (cos=-0.0617 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:45915
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] cosine check vs S16: cos=0.9756
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.6691 head_norm=1.565478
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.114241e-01
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.6742 head_norm=1.602773 delta_norm=0.111424
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=41 metric=0.9964 head_norm=1.451079
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.470879e-02
[S14] stored merged vector for next round verification (round=41)
[S14] DEBUG after merge:  round=41 metric=0.9964 head_norm=1.454563 delta_norm=0.064709
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] CommDone barrier timeout: have=2 need=3 — continuing
[S16] CommDone barrier timeout: have=1 need=3 — continuing
[S2] START round=42 head_norm_before_train=1.950709 cos_to_last_merge=0.7604 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=42 local utility u=0.166436 metrics={'f1_val': 0.7147818888844054, 'auprc': 0.8054106083748158, 'loss_val': 0.9236731302037245, 'psi': 0.7510333766805696}-{'f1_val': 0.7209081847924166, 'auprc': 0.7303402809315254, 'loss_val': 1.0680914640115444, 'psi': 0.72468102324806}
[S3] START round=42 head_norm_before_train=2.078899 cos_to_last_merge=0.9995 (last merge round=37)
[S3] round=42 local utility u=0.086261 metrics={'f1_val': 0.9834030929706927, 'auprc': 0.9979757678175133, 'loss_val': 0.05391017698629487, 'psi': 0.989232162909421}-{'f1_val': 0.9610352511054436, 'auprc': 0.997716253595905, 'loss_val': 0.09144626267055736, 'psi': 0.9757076521016281}
[S4] START round=42 head_norm_before_train=1.602773 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.008521 metrics={'f1_val': 0.9411744138564038, 'auprc': 0.9581929882717912, 'loss_val': 0.30867742973488616, 'psi': 0.9479818436225588}-{'f1_val': 0.9406300786013053, 'auprc': 0.9583774395493161, 'loss_val': 0.32300690132931037, 'psi': 0.9477290229805096}
[S5] START round=42 head_norm_before_train=1.286766 cos_to_last_merge=0.9960 (last merge round=38)
[S5] round=42 local utility u=0.315190 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9939512751266135, 'loss_val': 0.13964804592868374, 'psi': 0.9954677841347315}-{'f1_val': 0.8969633423361353, 'auprc': 0.9981421982328884, 'loss_val': 0.18550804737829885, 'psi': 0.9374348846948366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=42 head_norm_before_train=2.086075 (no previous merge yet)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.9167580714962881, 'auprc': 0.9643813316101991, 'loss_val': 0.2193443571290688, 'psi': 0.9358073755418526}-{'f1_val': 0.6189186824466913, 'auprc': 0.903176619364778, 'loss_val': 1.0937532619955166, 'psi': 0.732621857213926}
[S7] START round=42 head_norm_before_train=1.602773 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5592431891656239, 'auprc': 0.7846449158092902, 'loss_val': 0.7930553090302092, 'psi': 0.6494038798230903}-{'f1_val': 0.6691015969451576, 'auprc': 0.8294483046737612, 'loss_val': 0.3564110057297129, 'psi': 0.733240280036599}
[S8] START round=42 head_norm_before_train=2.078354 cos_to_last_merge=0.9999 (last merge round=39)
[S8] round=42 local utility u=0.001159 metrics={'f1_val': 0.9874240139512981, 'auprc': 0.9993367188971856, 'loss_val': 0.03957400030097137, 'psi': 0.9921890959296531}-{'f1_val': 0.9873556550456547, 'auprc': 0.999330195613438, 'loss_val': 0.0414620951230106, 'psi': 0.9921454712727681}
[S9] START round=42 head_norm_before_train=2.085124 (no previous merge yet)
[S9] round=42 local utility u=0.023618 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9969232104290993, 'loss_val': 0.022204062177140785, 'psi': 0.9968262502360486}-{'f1_val': 0.9897988050802651, 'auprc': 0.99878196239625, 'loss_val': 0.03323904898307572, 'psi': 0.993392068006659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=42 head_norm_before_train=2.030419 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=42 local utility u=0.000797 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9949329616775293, 'loss_val': 0.02736011008493672, 'psi': 0.9948223502026352}-{'f1_val': 0.9945291067983943, 'auprc': 0.994977838427747, 'loss_val': 0.027772333903168803, 'psi': 0.9947085994501355}
[S11] START round=42 head_norm_before_train=1.460908 cos_to_last_merge=0.9909 (last merge round=35)
[S11] round=42 local utility u=0.002434 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982047803630211, 'loss_val': 0.04896409184348656, 'psi': 0.9972101148533622}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981899366298428, 'loss_val': 0.053786956436117875, 'psi': 0.9972041773600908}
[S13] START round=42 head_norm_before_train=1.967607 (no previous merge yet)
[S13] round=42 local utility u=0.213026 metrics={'f1_val': 0.64286214539751, 'auprc': 0.6837070705092794, 'loss_val': 1.0681272591292827, 'psi': 0.6592001154422178}-{'f1_val': 0.611525087686497, 'auprc': 0.6475233649353638, 'loss_val': 1.1976056391396763, 'psi': 0.6259243985860438}
[S14] START round=42 head_norm_before_train=1.454563 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=42 local utility u=0.006973 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9989796336892587, 'loss_val': 0.0615621502627045, 'psi': 0.9974121523390942}-{'f1_val': 0.9963671647723179, 'auprc': 0.9958978994155416, 'loss_val': 0.0662625067205409, 'psi': 0.9961794586296073}
[S15] START round=42 head_norm_before_train=1.584176 cos_to_last_merge=0.9894 (last merge round=36)
[S15] round=42 local utility u=0.813183 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9981474540476177, 'loss_val': 0.03293800896071168, 'psi': 0.9975293337359072}-{'f1_val': 0.8240349582716423, 'auprc': 0.9079908654935984, 'loss_val': 0.35033964666484724, 'psi': 0.8576173211604248}
[S16] START round=42 head_norm_before_train=1.406488 cos_to_last_merge=0.9997 (last merge round=40)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8534695715325884, 'auprc': 0.9924765252551762, 'loss_val': 0.6187452058805821, 'psi': 0.9090723530216235}-{'f1_val': 0.8884868333483794, 'auprc': 0.9916193887327115, 'loss_val': 0.3947436329117584, 'psi': 0.9297398555021122}
[S17] START round=42 head_norm_before_train=1.478774 cos_to_last_merge=0.9964 (last merge round=40)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6444808364299024, 'auprc': 0.8613723513012544, 'loss_val': 0.899313286679324, 'psi': 0.7312374423784431}-{'f1_val': 0.6393812276372537, 'auprc': 0.8748048254653896, 'loss_val': 0.8398448276810214, 'psi': 0.7335506667685081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:45908
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:45909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:45917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:45914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:45913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:45916
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:45903
[S2] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=0.9738
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] cosine check vs S2: cos=-0.0140
[S13] DROPPED delta from S2 (cos=-0.0140 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S3
[S8] cosine check vs S3: cos=0.9991
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=0.9985
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.9983
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=-0.0673
[S17] DROPPED delta from S6 (cos=-0.0673 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S4
[S7] cosine check vs S4: cos=0.9998
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9971 head_norm=1.614600
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.006673e-01
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9971 head_norm=1.500768 delta_norm=0.200667
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.9991
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.9874 head_norm=2.089754
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.934225e-02
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.9874 head_norm=2.076033 delta_norm=0.039342
[S8] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:45902
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] cosine check vs S13: cos=-0.0140
[S2] DROPPED delta from S13 (cos=-0.0140 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:45917
[S14] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S14
[S17] cosine check vs S14: cos=0.9121
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S6
[S4]  timeout peer S7
[S16]  timeout peer S5
[S16]  timeout peer S9
[S16]  timeout peer S11
[S13]  timeout peer S15
[S14]  timeout peer S4
[S14]  timeout peer S17
[S11]  timeout peer S14
[S3]  timeout peer S8
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9964 head_norm=1.477630
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.372884e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9964 head_norm=1.479681 delta_norm=0.043729
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.8535 head_norm=1.435902
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.959379e-01
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.8548 head_norm=1.515250 delta_norm=0.195938
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.6445 head_norm=1.556046
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.203606e-01
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.6439 head_norm=1.483140 delta_norm=0.320361
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.960365 cos_to_last_merge=0.7595 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=43 local utility u=0.135463 metrics={'f1_val': 0.7117941468857173, 'auprc': 0.8321128719411672, 'loss_val': 0.7149279402412014, 'psi': 0.7599216369078973}-{'f1_val': 0.7147818888844054, 'auprc': 0.8054106083748158, 'loss_val': 0.9236731302037245, 'psi': 0.7510333766805696}
[S3] START round=43 head_norm_before_train=2.092376 cos_to_last_merge=0.9992 (last merge round=37)
[S3] round=43 local utility u=0.045838 metrics={'f1_val': 0.9952873006695607, 'auprc': 0.9978454620682955, 'loss_val': 0.033149409660889105, 'psi': 0.9963105652290546}-{'f1_val': 0.9834030929706927, 'auprc': 0.9979757678175133, 'loss_val': 0.05391017698629487, 'psi': 0.989232162909421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=43 metric=0.9953 head_norm=2.104887
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.084679e-02
[S3] stored merged vector for next round verification (round=43)
[S3] DEBUG after merge:  round=43 metric=0.9953 head_norm=2.096718 delta_norm=0.050847
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] START round=43 head_norm_before_train=1.622188 cos_to_last_merge=0.9998 (last merge round=41)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9395133003031853, 'auprc': 0.9523561070111592, 'loss_val': 0.3300143924778963, 'psi': 0.9446504229863748}-{'f1_val': 0.9411744138564038, 'auprc': 0.9581929882717912, 'loss_val': 0.30867742973488616, 'psi': 0.9479818436225588}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.309051 cos_to_last_merge=0.9943 (last merge round=38)
[S5] round=43 local utility u=0.021972 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9980284444729504, 'loss_val': 0.10881508368077167, 'psi': 0.997186592260896}-{'f1_val': 0.9964787901401435, 'auprc': 0.9939512751266135, 'loss_val': 0.13964804592868374, 'psi': 0.9954677841347315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=43 head_norm_before_train=2.086865 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.730166342138641, 'auprc': 0.9208860779937491, 'loss_val': 0.6083268739863705, 'psi': 0.8064542364806842}-{'f1_val': 0.9167580714962881, 'auprc': 0.9643813316101991, 'loss_val': 0.2193443571290688, 'psi': 0.9358073755418526}
[S7] START round=43 head_norm_before_train=1.606944 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=43 local utility u=0.332384 metrics={'f1_val': 0.6204603490728023, 'auprc': 0.7978428416276482, 'loss_val': 0.5351840482242137, 'psi': 0.6914133460947407}-{'f1_val': 0.5592431891656239, 'auprc': 0.7846449158092902, 'loss_val': 0.7930553090302092, 'psi': 0.6494038798230903}
[S8] START round=43 head_norm_before_train=2.076033 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9839949576420534, 'auprc': 0.9993735530619046, 'loss_val': 0.04708712173205559, 'psi': 0.9901463958099939}-{'f1_val': 0.9874240139512981, 'auprc': 0.9993367188971856, 'loss_val': 0.03957400030097137, 'psi': 0.9921890959296531}
[S9] START round=43 head_norm_before_train=2.093695 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9932858562960201, 'loss_val': 0.025486753354713967, 'psi': 0.995371308582817}-{'f1_val': 0.9967616101073482, 'auprc': 0.9969232104290993, 'loss_val': 0.022204062177140785, 'psi': 0.9968262502360486}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.035895 cos_to_last_merge=0.9999 (last merge round=39)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995062223360017, 'loss_val': 0.02773842012333222, 'psi': 0.9947423534230434}-{'f1_val': 0.9947486092193725, 'auprc': 0.9949329616775293, 'loss_val': 0.02736011008493672, 'psi': 0.9948223502026352}
[S11] START round=43 head_norm_before_train=1.483018 cos_to_last_merge=0.9891 (last merge round=35)
[S11] round=43 local utility u=0.002051 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982159896581738, 'loss_val': 0.04489671356177873, 'psi': 0.9972145985714232}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982047803630211, 'loss_val': 0.04896409184348656, 'psi': 0.9972101148533622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=43 head_norm_before_train=1.975322 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6133822672357438, 'auprc': 0.6163097271947056, 'loss_val': 1.4066108925931975, 'psi': 0.6145532512193286}-{'f1_val': 0.64286214539751, 'auprc': 0.6837070705092794, 'loss_val': 1.0681272591292827, 'psi': 0.6592001154422178}
[S14] START round=43 head_norm_before_train=1.479681 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.002456 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9990464389229206, 'loss_val': 0.05803836321843828, 'psi': 0.9975577095149442}-{'f1_val': 0.9963671647723179, 'auprc': 0.9989796336892587, 'loss_val': 0.0615621502627045, 'psi': 0.9974121523390942}
[S15] START round=43 head_norm_before_train=1.500768 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9199079678711359, 'auprc': 0.9964075374450174, 'loss_val': 0.11190062627334411, 'psi': 0.9505077957006884}-{'f1_val': 0.9971172535281002, 'auprc': 0.9981474540476177, 'loss_val': 0.03293800896071168, 'psi': 0.9975293337359072}
[S16] START round=43 head_norm_before_train=1.515250 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.167345 metrics={'f1_val': 0.881267602797212, 'auprc': 0.9933468060338789, 'loss_val': 0.45345409420286703, 'psi': 0.9260992840918788}-{'f1_val': 0.8534695715325884, 'auprc': 0.9924765252551762, 'loss_val': 0.6187452058805821, 'psi': 0.9090723530216235}
[S17] START round=43 head_norm_before_train=1.483140 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.121929 metrics={'f1_val': 0.6499658907718194, 'auprc': 0.8954122501420378, 'loss_val': 0.7904843490577962, 'psi': 0.7481444345199069}-{'f1_val': 0.6444808364299024, 'auprc': 0.8613723513012544, 'loss_val': 0.899313286679324, 'psi': 0.7312374423784431}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.6205 head_norm=1.609521
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.701542e-02
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.6215 head_norm=1.615777 delta_norm=0.017015
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.966949 cos_to_last_merge=0.7589 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=44 local utility u=0.086211 metrics={'f1_val': 0.6979459790802716, 'auprc': 0.876314462427567, 'loss_val': 0.5920209623586616, 'psi': 0.7692933724191897}-{'f1_val': 0.7117941468857173, 'auprc': 0.8321128719411672, 'loss_val': 0.7149279402412014, 'psi': 0.7599216369078973}
[S3] START round=44 head_norm_before_train=2.096718 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=44 local utility u=0.007609 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.997562686505209, 'loss_val': 0.03221978045305834, 'psi': 0.9977110951626593}-{'f1_val': 0.9952873006695607, 'auprc': 0.9978454620682955, 'loss_val': 0.033149409660889105, 'psi': 0.9963105652290546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=44 head_norm_before_train=1.641065 cos_to_last_merge=0.9994 (last merge round=41)
[S4] round=44 local utility u=0.041704 metrics={'f1_val': 0.9461493548879711, 'auprc': 0.9594555193410268, 'loss_val': 0.30772149439650065, 'psi': 0.9514718206691934}-{'f1_val': 0.9395133003031853, 'auprc': 0.9523561070111592, 'loss_val': 0.3300143924778963, 'psi': 0.9446504229863748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S4] sending update (kind=head size=1809 to 1 peers)
[S5] START round=44 head_norm_before_train=1.335942 cos_to_last_merge=0.9922 (last merge round=38)
[S5] round=44 local utility u=0.004643 metrics={'f1_val': 0.9967726868314644, 'auprc': 0.998403917304501, 'loss_val': 0.1015395478659054, 'psi': 0.997425179020679}-{'f1_val': 0.9966253574528599, 'auprc': 0.9980284444729504, 'loss_val': 0.10881508368077167, 'psi': 0.997186592260896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=44 head_norm_before_train=2.096209 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.701533603548315, 'auprc': 0.91116654404879, 'loss_val': 0.8361887402476842, 'psi': 0.785386779748505}-{'f1_val': 0.730166342138641, 'auprc': 0.9208860779937491, 'loss_val': 0.6083268739863705, 'psi': 0.8064542364806842}
[S7] START round=44 head_norm_before_train=1.615777 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.147938 metrics={'f1_val': 0.65857193938361, 'auprc': 0.8056288780417089, 'loss_val': 0.4913358439183597, 'psi': 0.7173947148468496}-{'f1_val': 0.6204603490728023, 'auprc': 0.7978428416276482, 'loss_val': 0.5351840482242137, 'psi': 0.6914133460947407}
[S8] START round=44 head_norm_before_train=2.085360 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=44 local utility u=0.031694 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9996742466725448, 'loss_val': 0.033157886965899365, 'psi': 0.9951223477063373}-{'f1_val': 0.9839949576420534, 'auprc': 0.9993735530619046, 'loss_val': 0.04708712173205559, 'psi': 0.9901463958099939}
[S9] START round=44 head_norm_before_train=2.101216 (no previous merge yet)
[S9] round=44 local utility u=0.001859 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9939596161493839, 'loss_val': 0.02378973760336454, 'psi': 0.9956408125241625}-{'f1_val': 0.9967616101073482, 'auprc': 0.9932858562960201, 'loss_val': 0.025486753354713967, 'psi': 0.995371308582817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=44 head_norm_before_train=2.044068 cos_to_last_merge=0.9999 (last merge round=39)
[S10] round=44 local utility u=0.000024 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9951655072132759, 'loss_val': 0.027999514780386234, 'psi': 0.994783666964347}-{'f1_val': 0.9945291067983943, 'auprc': 0.995062223360017, 'loss_val': 0.02773842012333222, 'psi': 0.9947423534230434}
[S11] START round=44 head_norm_before_train=1.504297 cos_to_last_merge=0.9873 (last merge round=35)
[S11] round=44 local utility u=0.002549 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998529498214216, 'loss_val': 0.04073942811397772, 'psi': 0.9973400019938401}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982159896581738, 'loss_val': 0.04489671356177873, 'psi': 0.9972145985714232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=44 head_norm_before_train=1.986139 (no previous merge yet)
[S13] round=44 local utility u=0.827906 metrics={'f1_val': 0.7523193424788648, 'auprc': 0.7127588906496867, 'loss_val': 0.8737696602362338, 'psi': 0.7364951617471935}-{'f1_val': 0.6133822672357438, 'auprc': 0.6163097271947056, 'loss_val': 1.4066108925931975, 'psi': 0.6145532512193286}
[S14] START round=44 head_norm_before_train=1.495965 cos_to_last_merge=0.9999 (last merge round=42)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9968262718771099, 'loss_val': 0.056373613436034684, 'psi': 0.9964188130696463}-{'f1_val': 0.9965652232429598, 'auprc': 0.9990464389229206, 'loss_val': 0.05803836321843828, 'psi': 0.9975577095149442}
[S15] START round=44 head_norm_before_train=1.531221 cos_to_last_merge=0.9999 (last merge round=42)
[S15] round=44 local utility u=0.267611 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977489683636793, 'loss_val': 0.04173565957117124, 'psi': 0.9971475883779841}-{'f1_val': 0.9199079678711359, 'auprc': 0.9964075374450174, 'loss_val': 0.11190062627334411, 'psi': 0.9505077957006884}
[S16] START round=44 head_norm_before_train=1.537300 cos_to_last_merge=0.9999 (last merge round=42)
[S16] round=44 local utility u=0.513814 metrics={'f1_val': 0.9898739538607805, 'auprc': 0.9873659707127043, 'loss_val': 0.05952134559618173, 'psi': 0.9888707606015499}-{'f1_val': 0.881267602797212, 'auprc': 0.9933468060338789, 'loss_val': 0.45345409420286703, 'psi': 0.9260992840918788}
[S17] START round=44 head_norm_before_train=1.529505 cos_to_last_merge=0.9988 (last merge round=42)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6490117747346152, 'auprc': 0.8724966173302388, 'loss_val': 0.8600937641469778, 'psi': 0.7384057117728646}-{'f1_val': 0.6499658907718194, 'auprc': 0.8954122501420378, 'loss_val': 0.7904843490577962, 'psi': 0.7481444345199069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.717)
[S2] START round=45 head_norm_before_train=1.976034 cos_to_last_merge=0.7579 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7190575888197647, 'auprc': 0.7713814793616511, 'loss_val': 0.9894571016696582, 'psi': 0.7399871450365193}-{'f1_val': 0.6979459790802716, 'auprc': 0.876314462427567, 'loss_val': 0.5920209623586616, 'psi': 0.7692933724191897}
[S3] START round=45 head_norm_before_train=2.108495 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9906894689381641, 'auprc': 0.9968200134746926, 'loss_val': 0.07599040898730236, 'psi': 0.9931416867527755}-{'f1_val': 0.9978100342676263, 'auprc': 0.997562686505209, 'loss_val': 0.03221978045305834, 'psi': 0.9977110951626593}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.652225 cos_to_last_merge=0.9990 (last merge round=41)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9412800789166167, 'auprc': 0.9659332230223409, 'loss_val': 0.31628957918062445, 'psi': 0.9511413365589063}-{'f1_val': 0.9461493548879711, 'auprc': 0.9594555193410268, 'loss_val': 0.30772149439650065, 'psi': 0.9514718206691934}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.361637 cos_to_last_merge=0.9899 (last merge round=38)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9944260373272854, 'loss_val': 0.09587990050592046, 'psi': 0.9956576890150002}-{'f1_val': 0.9967726868314644, 'auprc': 0.998403917304501, 'loss_val': 0.1015395478659054, 'psi': 0.997425179020679}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=2.109904 (no previous merge yet)
[S6] round=45 local utility u=0.773484 metrics={'f1_val': 0.8576283587408775, 'auprc': 0.955705391890868, 'loss_val': 0.35940612689670154, 'psi': 0.8968591720008737}-{'f1_val': 0.701533603548315, 'auprc': 0.91116654404879, 'loss_val': 0.8361887402476842, 'psi': 0.785386779748505}
[S7] START round=45 head_norm_before_train=1.620214 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5395850971740543, 'auprc': 0.7801759973011579, 'loss_val': 1.0337085584999124, 'psi': 0.6358214572248957}-{'f1_val': 0.65857193938361, 'auprc': 0.8056288780417089, 'loss_val': 0.4913358439183597, 'psi': 0.7173947148468496}
[S8] START round=45 head_norm_before_train=2.096544 cos_to_last_merge=0.9999 (last merge round=42)
[S8] round=45 local utility u=0.006334 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.9996166029029343, 'loss_val': 0.030191546953226935, 'psi': 0.9960866715022425}-{'f1_val': 0.9920877483955324, 'auprc': 0.9996742466725448, 'loss_val': 0.033157886965899365, 'psi': 0.9951223477063373}
[S9] START round=45 head_norm_before_train=2.111016 (no previous merge yet)
[S9] round=45 local utility u=0.007961 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9984292669404664, 'loss_val': 0.02374293123645072, 'psi': 0.9976752135854303}-{'f1_val': 0.9967616101073482, 'auprc': 0.9939596161493839, 'loss_val': 0.02378973760336454, 'psi': 0.9956408125241625}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=45 head_norm_before_train=2.047196 cos_to_last_merge=0.9998 (last merge round=39)
[S10] round=45 local utility u=0.001369 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995375302960894, 'loss_val': 0.02720779683917008, 'psi': 0.9949992867159811}-{'f1_val': 0.9945291067983943, 'auprc': 0.9951655072132759, 'loss_val': 0.027999514780386234, 'psi': 0.994783666964347}
[S11] START round=45 head_norm_before_train=1.522988 cos_to_last_merge=0.9856 (last merge round=35)
[S11] round=45 local utility u=0.000807 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985441038769824, 'loss_val': 0.039169427130242684, 'psi': 0.9973458442589467}-{'f1_val': 0.9965470045135896, 'auprc': 0.998529498214216, 'loss_val': 0.04073942811397772, 'psi': 0.9973400019938401}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=45 head_norm_before_train=1.992573 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.7247285813309895, 'auprc': 0.6657739985540563, 'loss_val': 1.142146094904337, 'psi': 0.7011467482202163}-{'f1_val': 0.7523193424788648, 'auprc': 0.7127588906496867, 'loss_val': 0.8737696602362338, 'psi': 0.7364951617471935}
[S14] START round=45 head_norm_before_train=1.511165 cos_to_last_merge=0.9998 (last merge round=42)
[S14] round=45 local utility u=0.003815 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9979736941105033, 'loss_val': 0.05218579629613316, 'psi': 0.9968777819630036}-{'f1_val': 0.9961471738646706, 'auprc': 0.9968262718771099, 'loss_val': 0.056373613436034684, 'psi': 0.9964188130696463}
[S15] START round=45 head_norm_before_train=1.563309 cos_to_last_merge=0.9994 (last merge round=42)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9377690705194189, 'auprc': 0.9977276937580353, 'loss_val': 0.099825832633188, 'psi': 0.9617525198148655}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977489683636793, 'loss_val': 0.04173565957117124, 'psi': 0.9971475883779841}
[S16] START round=45 head_norm_before_train=1.555416 cos_to_last_merge=0.9997 (last merge round=42)
[S16] round=45 local utility u=0.014137 metrics={'f1_val': 0.991330160227093, 'auprc': 0.9935093721223938, 'loss_val': 0.058414730258883794, 'psi': 0.9922018449852132}-{'f1_val': 0.9898739538607805, 'auprc': 0.9873659707127043, 'loss_val': 0.05952134559618173, 'psi': 0.9888707606015499}
[S17] START round=45 head_norm_before_train=1.590911 cos_to_last_merge=0.9951 (last merge round=42)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6674376952607761, 'auprc': 0.8149864651426388, 'loss_val': 0.9131611064056183, 'psi': 0.7264572032135213}-{'f1_val': 0.6490117747346152, 'auprc': 0.8724966173302388, 'loss_val': 0.8600937641469778, 'psi': 0.7384057117728646}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.992)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.996)
[S2] START round=46 head_norm_before_train=1.983802 cos_to_last_merge=0.7571 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.757
[S2] round=46 local utility u=0.125014 metrics={'f1_val': 0.713016626030529, 'auprc': 0.8203862422229404, 'loss_val': 0.8501981803658363, 'psi': 0.7559644725074935}-{'f1_val': 0.7190575888197647, 'auprc': 0.7713814793616511, 'loss_val': 0.9894571016696582, 'psi': 0.7399871450365193}
[S3] START round=46 head_norm_before_train=2.118701 cos_to_last_merge=0.9999 (last merge round=43)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9789308446780851, 'loss_val': 0.1455974757454452, 'psi': 0.9682173891109063}-{'f1_val': 0.9906894689381641, 'auprc': 0.9968200134746926, 'loss_val': 0.07599040898730236, 'psi': 0.9931416867527755}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.663995 cos_to_last_merge=0.9985 (last merge round=41)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9423369973714584, 'auprc': 0.9600714826106962, 'loss_val': 0.31459230402743343, 'psi': 0.9494307914671535}-{'f1_val': 0.9412800789166167, 'auprc': 0.9659332230223409, 'loss_val': 0.31628957918062445, 'psi': 0.9511413365589063}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.385026 cos_to_last_merge=0.9874 (last merge round=38)
[S5] round=46 local utility u=0.007775 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9952765142428516, 'loss_val': 0.08288110894904945, 'psi': 0.9959978797812267}-{'f1_val': 0.9964787901401435, 'auprc': 0.9944260373272854, 'loss_val': 0.09587990050592046, 'psi': 0.9956576890150002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=46 head_norm_before_train=2.119004 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.8310481867858955, 'auprc': 0.9565978840777173, 'loss_val': 0.42601123529253204, 'psi': 0.8812680657026242}-{'f1_val': 0.8576283587408775, 'auprc': 0.955705391890868, 'loss_val': 0.35940612689670154, 'psi': 0.8968591720008737}
[S7] START round=46 head_norm_before_train=1.626323 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=46 local utility u=0.929988 metrics={'f1_val': 0.694266972599055, 'auprc': 0.8538534215131653, 'loss_val': 0.3228566625047897, 'psi': 0.7581015521646992}-{'f1_val': 0.5395850971740543, 'auprc': 0.7801759973011579, 'loss_val': 1.0337085584999124, 'psi': 0.6358214572248957}
[S8] START round=46 head_norm_before_train=2.106730 cos_to_last_merge=0.9998 (last merge round=42)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9996805460397964, 'loss_val': 0.03231197109965648, 'psi': 0.995124867453238}-{'f1_val': 0.9937333839017813, 'auprc': 0.9996166029029343, 'loss_val': 0.030191546953226935, 'psi': 0.9960866715022425}
[S9] START round=46 head_norm_before_train=2.117608 (no previous merge yet)
[S9] round=46 local utility u=0.002038 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.998776923146446, 'loss_val': 0.020709274000508652, 'psi': 0.9978142760678221}-{'f1_val': 0.9971725113487396, 'auprc': 0.9984292669404664, 'loss_val': 0.02374293123645072, 'psi': 0.9976752135854303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=46 head_norm_before_train=2.054320 cos_to_last_merge=0.9997 (last merge round=39)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995135775785926, 'loss_val': 0.027540892294332906, 'psi': 0.994771774393407}-{'f1_val': 0.9947486092193725, 'auprc': 0.995375302960894, 'loss_val': 0.02720779683917008, 'psi': 0.9949992867159811}
[S11] START round=46 head_norm_before_train=1.540367 cos_to_last_merge=0.9841 (last merge round=35)
[S11] round=46 local utility u=0.000419 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998223753999304, 'loss_val': 0.037371240477984694, 'psi': 0.9972177043078754}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985441038769824, 'loss_val': 0.039169427130242684, 'psi': 0.9973458442589467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=46 head_norm_before_train=2.000103 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.7239898335799698, 'auprc': 0.6695480252838183, 'loss_val': 1.1550459756317957, 'psi': 0.7022131102615092}-{'f1_val': 0.7247285813309895, 'auprc': 0.6657739985540563, 'loss_val': 1.142146094904337, 'psi': 0.7011467482202163}
[S14] START round=46 head_norm_before_train=1.526548 cos_to_last_merge=0.9995 (last merge round=42)
[S14] round=46 local utility u=0.003834 metrics={'f1_val': 0.9963875947232834, 'auprc': 0.9990466174887225, 'loss_val': 0.04917869721226413, 'psi': 0.9974512038294591}-{'f1_val': 0.9961471738646706, 'auprc': 0.9979736941105033, 'loss_val': 0.05218579629613316, 'psi': 0.9968777819630036}
[S15] START round=46 head_norm_before_train=1.594221 cos_to_last_merge=0.9988 (last merge round=42)
[S15] round=46 local utility u=0.209606 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976036797749257, 'loss_val': 0.03410716377237374, 'psi': 0.9970894729424826}-{'f1_val': 0.9377690705194189, 'auprc': 0.9977276937580353, 'loss_val': 0.099825832633188, 'psi': 0.9617525198148655}
[S16] START round=46 head_norm_before_train=1.570221 cos_to_last_merge=0.9994 (last merge round=42)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8612902392657943, 'auprc': 0.9877862633452689, 'loss_val': 0.6014719222830827, 'psi': 0.9118886488975841}-{'f1_val': 0.991330160227093, 'auprc': 0.9935093721223938, 'loss_val': 0.058414730258883794, 'psi': 0.9922018449852132}
[S17] START round=46 head_norm_before_train=1.650638 cos_to_last_merge=0.9904 (last merge round=42)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6652038607061457, 'auprc': 0.8234601564223591, 'loss_val': 0.9818363903876651, 'psi': 0.7285063789926312}-{'f1_val': 0.6674376952607761, 'auprc': 0.8149864651426388, 'loss_val': 0.9131611064056183, 'psi': 0.7264572032135213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.989569 cos_to_last_merge=0.7566 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.757
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6435799444937368, 'auprc': 0.7434726476820017, 'loss_val': 1.841777494108536, 'psi': 0.6835370257690427}-{'f1_val': 0.713016626030529, 'auprc': 0.8203862422229404, 'loss_val': 0.8501981803658363, 'psi': 0.7559644725074935}
[S3] START round=47 head_norm_before_train=2.128898 cos_to_last_merge=0.9999 (last merge round=43)
[S3] round=47 local utility u=0.169841 metrics={'f1_val': 0.9919952467380473, 'auprc': 0.9973959162592467, 'loss_val': 0.04683169380235031, 'psi': 0.9941555145465271}-{'f1_val': 0.9610750853994537, 'auprc': 0.9789308446780851, 'loss_val': 0.1455974757454452, 'psi': 0.9682173891109063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=47 head_norm_before_train=1.677994 cos_to_last_merge=0.9980 (last merge round=41)
[S4] round=47 local utility u=0.011426 metrics={'f1_val': 0.9506081891786056, 'auprc': 0.9510369268113341, 'loss_val': 0.3142641232522388, 'psi': 0.950779684231697}-{'f1_val': 0.9423369973714584, 'auprc': 0.9600714826106962, 'loss_val': 0.31459230402743343, 'psi': 0.9494307914671535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=47 head_norm_before_train=1.403436 cos_to_last_merge=0.9853 (last merge round=38)
[S5] round=47 local utility u=0.008125 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9980411001759962, 'loss_val': 0.07580440621750102, 'psi': 0.9971916545421144}-{'f1_val': 0.9964787901401435, 'auprc': 0.9952765142428516, 'loss_val': 0.08288110894904945, 'psi': 0.9959978797812267}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=47 head_norm_before_train=2.129453 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.5986831703857795, 'auprc': 0.8993054939720313, 'loss_val': 1.1599351674047442, 'psi': 0.7189320998202802}-{'f1_val': 0.8310481867858955, 'auprc': 0.9565978840777173, 'loss_val': 0.42601123529253204, 'psi': 0.8812680657026242}
[S7] START round=47 head_norm_before_train=1.632311 cos_to_last_merge=0.9999 (last merge round=43)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6151019965803848, 'auprc': 0.7956999929281937, 'loss_val': 0.651537999302401, 'psi': 0.6873411951195083}-{'f1_val': 0.694266972599055, 'auprc': 0.8538534215131653, 'loss_val': 0.3228566625047897, 'psi': 0.7581015521646992}
[S8] START round=47 head_norm_before_train=2.118186 cos_to_last_merge=0.9997 (last merge round=42)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9453991223418639, 'auprc': 0.9966132942847222, 'loss_val': 0.13327860576917158, 'psi': 0.9658847911190072}-{'f1_val': 0.9920877483955324, 'auprc': 0.9996805460397964, 'loss_val': 0.03231197109965648, 'psi': 0.995124867453238}
[S9] START round=47 head_norm_before_train=2.126292 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9969222458854735, 'auprc': 0.998775137392769, 'loss_val': 0.019872466061098805, 'psi': 0.9976634024883917}-{'f1_val': 0.9971725113487396, 'auprc': 0.998776923146446, 'loss_val': 0.020709274000508652, 'psi': 0.9978142760678221}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.062845 cos_to_last_merge=0.9997 (last merge round=39)
[S10] round=47 local utility u=0.000342 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9952799623617277, 'loss_val': 0.027288557973596896, 'psi': 0.9948294490237277}-{'f1_val': 0.9945291067983943, 'auprc': 0.995135775785926, 'loss_val': 0.027540892294332906, 'psi': 0.994771774393407}
[S11] START round=47 head_norm_before_train=1.555700 cos_to_last_merge=0.9827 (last merge round=35)
[S11] round=47 local utility u=0.000900 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982043532211093, 'loss_val': 0.03551261701915452, 'psi': 0.9972099439965975}-{'f1_val': 0.9965470045135896, 'auprc': 0.998223753999304, 'loss_val': 0.037371240477984694, 'psi': 0.9972177043078754}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=2.010183 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6652951490566961, 'auprc': 0.7547810576554995, 'loss_val': 1.0871280242614931, 'psi': 0.7010895124962175}-{'f1_val': 0.7239898335799698, 'auprc': 0.6695480252838183, 'loss_val': 1.1550459756317957, 'psi': 0.7022131102615092}
[S14] START round=47 head_norm_before_train=1.541574 cos_to_last_merge=0.9992 (last merge round=42)
[S14] round=47 local utility u=0.003705 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9990473254609011, 'loss_val': 0.04529728239600721, 'psi': 0.9978042302346263}-{'f1_val': 0.9963875947232834, 'auprc': 0.9990466174887225, 'loss_val': 0.04917869721226413, 'psi': 0.9974512038294591}
[S15] START round=47 head_norm_before_train=1.622308 cos_to_last_merge=0.9981 (last merge round=42)
[S15] round=47 local utility u=0.001834 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977105224789906, 'loss_val': 0.030759944446179296, 'psi': 0.9971322100241086}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976036797749257, 'loss_val': 0.03410716377237374, 'psi': 0.9970894729424826}
[S16] START round=47 head_norm_before_train=1.583080 cos_to_last_merge=0.9991 (last merge round=42)
[S16] round=47 local utility u=0.161370 metrics={'f1_val': 0.8879222490017877, 'auprc': 0.9898289988341132, 'loss_val': 0.44465235055378394, 'psi': 0.928684948934718}-{'f1_val': 0.8612902392657943, 'auprc': 0.9877862633452689, 'loss_val': 0.6014719222830827, 'psi': 0.9118886488975841}
[S17] START round=47 head_norm_before_train=1.699239 cos_to_last_merge=0.9861 (last merge round=42)
[S17] round=47 local utility u=0.313151 metrics={'f1_val': 0.697704215518395, 'auprc': 0.9249682850156844, 'loss_val': 0.8550616822355976, 'psi': 0.7886098433173108}-{'f1_val': 0.6652038607061457, 'auprc': 0.8234601564223591, 'loss_val': 0.9818363903876651, 'psi': 0.7285063789926312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7]  timeout peer S4
[S10]  timeout peer S8
[S8]  timeout peer S3
[S8]  timeout peer S10
[S6]  timeout peer S17
[S2]  timeout peer S13
[S16]  timeout peer S15
[S17]  timeout peer S14
[S13]  timeout peer S2
[S15]  timeout peer S16
[S14]  timeout peer S11
[S2] START round=48 head_norm_before_train=1.997504 cos_to_last_merge=0.7558 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.756
[S2] round=48 local utility u=0.561091 metrics={'f1_val': 0.7221201152922121, 'auprc': 0.7270003848746885, 'loss_val': 1.1414191573200985, 'psi': 0.7240722231252026}-{'f1_val': 0.6435799444937368, 'auprc': 0.7434726476820017, 'loss_val': 1.841777494108536, 'psi': 0.6835370257690427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=48 head_norm_before_train=2.139010 cos_to_last_merge=0.9998 (last merge round=43)
[S3] round=48 local utility u=0.027045 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9975961619084, 'loss_val': 0.02558842713100931, 'psi': 0.9974602833584123}-{'f1_val': 0.9919952467380473, 'auprc': 0.9973959162592467, 'loss_val': 0.04683169380235031, 'psi': 0.9941555145465271}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=48 head_norm_before_train=1.684632 cos_to_last_merge=0.9975 (last merge round=41)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9412800789166167, 'auprc': 0.9540400726955705, 'loss_val': 0.3265653806540508, 'psi': 0.9463840764281982}-{'f1_val': 0.9506081891786056, 'auprc': 0.9510369268113341, 'loss_val': 0.3142641232522388, 'psi': 0.950779684231697}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.423637 cos_to_last_merge=0.9831 (last merge round=38)
[S5] round=48 local utility u=0.004070 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9976819767962102, 'loss_val': 0.0665860464414732, 'psi': 0.9970480051902}-{'f1_val': 0.9966253574528599, 'auprc': 0.9980411001759962, 'loss_val': 0.07580440621750102, 'psi': 0.9971916545421144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=48 head_norm_before_train=2.141527 (no previous merge yet)
[S6] round=48 local utility u=0.622524 metrics={'f1_val': 0.7114576814370426, 'auprc': 0.9151200119638551, 'loss_val': 0.6389767987470824, 'psi': 0.7929226136477676}-{'f1_val': 0.5986831703857795, 'auprc': 0.8993054939720313, 'loss_val': 1.1599351674047442, 'psi': 0.7189320998202802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=48 head_norm_before_train=1.634697 cos_to_last_merge=0.9999 (last merge round=43)
[S7] round=48 local utility u=0.532433 metrics={'f1_val': 0.6998479854459663, 'auprc': 0.8542946836531813, 'loss_val': 0.2709318446713508, 'psi': 0.7616266647288523}-{'f1_val': 0.6151019965803848, 'auprc': 0.7956999929281937, 'loss_val': 0.651537999302401, 'psi': 0.6873411951195083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=48 head_norm_before_train=2.129427 cos_to_last_merge=0.9996 (last merge round=42)
[S8] round=48 local utility u=0.201807 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.999603234650681, 'loss_val': 0.02864036142396864, 'psi': 0.9960813242013412}-{'f1_val': 0.9453991223418639, 'auprc': 0.9966132942847222, 'loss_val': 0.13327860576917158, 'psi': 0.9658847911190072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=48 head_norm_before_train=2.135415 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9965113446440821, 'auprc': 0.9991576623138125, 'loss_val': 0.019992450727281477, 'psi': 0.9975698717119743}-{'f1_val': 0.9969222458854735, 'auprc': 0.998775137392769, 'loss_val': 0.019872466061098805, 'psi': 0.9976634024883917}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.066128 cos_to_last_merge=0.9996 (last merge round=39)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9952764905008863, 'loss_val': 0.027284836828470434, 'psi': 0.9948280602793911}-{'f1_val': 0.9945291067983943, 'auprc': 0.9952799623617277, 'loss_val': 0.027288557973596896, 'psi': 0.9948294490237277}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.570948 cos_to_last_merge=0.9814 (last merge round=35)
[S11] round=48 local utility u=0.000831 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981867605113455, 'loss_val': 0.03379726544609788, 'psi': 0.997202906912692}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982043532211093, 'loss_val': 0.03551261701915452, 'psi': 0.9972099439965975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=48 head_norm_before_train=2.014795 (no previous merge yet)
[S13] round=48 local utility u=0.216053 metrics={'f1_val': 0.7150850917267173, 'auprc': 0.747693991806297, 'loss_val': 0.9325008651881423, 'psi': 0.7281286517585492}-{'f1_val': 0.6652951490566961, 'auprc': 0.7547810576554995, 'loss_val': 1.0871280242614931, 'psi': 0.7010895124962175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=48 head_norm_before_train=1.555393 cos_to_last_merge=0.9989 (last merge round=42)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9506213946367466, 'auprc': 0.9985751928699638, 'loss_val': 0.10030764476628032, 'psi': 0.9698029139300334}-{'f1_val': 0.9969755000837764, 'auprc': 0.9990473254609011, 'loss_val': 0.04529728239600721, 'psi': 0.9978042302346263}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.647923 cos_to_last_merge=0.9974 (last merge round=42)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970888764494458, 'loss_val': 0.029567791236622173, 'psi': 0.9968835516122907}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977105224789906, 'loss_val': 0.030759944446179296, 'psi': 0.9971322100241086}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.593908 cos_to_last_merge=0.9989 (last merge round=42)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.88473256016919, 'auprc': 0.989600269322159, 'loss_val': 0.46810433649828914, 'psi': 0.9266796438303777}-{'f1_val': 0.8879222490017877, 'auprc': 0.9898289988341132, 'loss_val': 0.44465235055378394, 'psi': 0.928684948934718}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.731705 cos_to_last_merge=0.9826 (last merge round=42)
[S17] round=48 local utility u=0.443471 metrics={'f1_val': 0.8015227799307548, 'auprc': 0.9171978523792736, 'loss_val': 0.5677204135032355, 'psi': 0.8477928089101623}-{'f1_val': 0.697704215518395, 'auprc': 0.9249682850156844, 'loss_val': 0.8550616822355976, 'psi': 0.7886098433173108}
[S17] not sending this round → trigger blocked (psi=0.848)
[S2] START round=49 head_norm_before_train=2.003237 cos_to_last_merge=0.7554 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=49 local utility u=0.019021 metrics={'f1_val': 0.7215826829129075, 'auprc': 0.7346074415960004, 'loss_val': 1.122973829878188, 'psi': 0.7267925863861446}-{'f1_val': 0.7221201152922121, 'auprc': 0.7270003848746885, 'loss_val': 1.1414191573200985, 'psi': 0.7240722231252026}
[S2] not sending this round → trigger blocked (psi=0.727)
[S3] START round=49 head_norm_before_train=2.149117 cos_to_last_merge=0.9997 (last merge round=43)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.988972553129342, 'auprc': 0.9979304232858124, 'loss_val': 0.03279198538131002, 'psi': 0.9925557011919302}-{'f1_val': 0.9973696976584205, 'auprc': 0.9975961619084, 'loss_val': 0.02558842713100931, 'psi': 0.9974602833584123}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.696992 cos_to_last_merge=0.9969 (last merge round=41)
[S4] round=49 local utility u=0.007760 metrics={'f1_val': 0.9418075101867134, 'auprc': 0.9576667137391937, 'loss_val': 0.3250899701297952, 'psi': 0.9481511916077054}-{'f1_val': 0.9412800789166167, 'auprc': 0.9540400726955705, 'loss_val': 0.3265653806540508, 'psi': 0.9463840764281982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=49 head_norm_before_train=1.458353 cos_to_last_merge=0.9796 (last merge round=38)
[S5] round=49 local utility u=0.004606 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9977285068981632, 'loss_val': 0.05751269114256449, 'psi': 0.9970666172309812}-{'f1_val': 0.9966253574528599, 'auprc': 0.9976819767962102, 'loss_val': 0.0665860464414732, 'psi': 0.9970480051902}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=49 head_norm_before_train=2.148217 (no previous merge yet)
[S6] round=49 local utility u=0.154750 metrics={'f1_val': 0.7490088543941402, 'auprc': 0.9206989836200825, 'loss_val': 0.5715207524829921, 'psi': 0.8176849060845172}-{'f1_val': 0.7114576814370426, 'auprc': 0.9151200119638551, 'loss_val': 0.6389767987470824, 'psi': 0.7929226136477676}
[S6] not sending this round → trigger blocked (psi=0.818)
[S7] START round=49 head_norm_before_train=1.637705 cos_to_last_merge=0.9998 (last merge round=43)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5926438707341977, 'auprc': 0.7943395697872326, 'loss_val': 0.6710154106008094, 'psi': 0.6733221503554117}-{'f1_val': 0.6998479854459663, 'auprc': 0.8542946836531813, 'loss_val': 0.2709318446713508, 'psi': 0.7616266647288523}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.140371 cos_to_last_merge=0.9995 (last merge round=42)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9414421078876039, 'auprc': 0.9992174786832999, 'loss_val': 0.13831085769382537, 'psi': 0.9645522562058823}-{'f1_val': 0.9937333839017813, 'auprc': 0.999603234650681, 'loss_val': 0.02864036142396864, 'psi': 0.9960813242013412}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.144612 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965113446440821, 'auprc': 0.9987738817222587, 'loss_val': 0.019925113414751932, 'psi': 0.9974163594753527}-{'f1_val': 0.9965113446440821, 'auprc': 0.9991576623138125, 'loss_val': 0.019992450727281477, 'psi': 0.9975698717119743}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.072818 cos_to_last_merge=0.9995 (last merge round=39)
[S10] round=49 local utility u=0.000102 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995337846155019, 'loss_val': 0.027265515338672025, 'psi': 0.9948526025410442}-{'f1_val': 0.9945291067983943, 'auprc': 0.9952764905008863, 'loss_val': 0.027284836828470434, 'psi': 0.9948280602793911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=49 head_norm_before_train=1.585927 cos_to_last_merge=0.9801 (last merge round=35)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9870137789934632, 'auprc': 0.9984262687114719, 'loss_val': 0.05806792373141295, 'psi': 0.9915787748806667}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981867605113455, 'loss_val': 0.03379726544609788, 'psi': 0.997202906912692}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=2.022820 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.7172237414362248, 'auprc': 0.7223969340185681, 'loss_val': 1.0315497272779488, 'psi': 0.7192930184691622}-{'f1_val': 0.7150850917267173, 'auprc': 0.747693991806297, 'loss_val': 0.9325008651881423, 'psi': 0.7281286517585492}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.567257 cos_to_last_merge=0.9985 (last merge round=42)
[S14] round=49 local utility u=0.150074 metrics={'f1_val': 0.9927526851151321, 'auprc': 0.9990439380291077, 'loss_val': 0.05435338520546427, 'psi': 0.9952691862807224}-{'f1_val': 0.9506213946367466, 'auprc': 0.9985751928699638, 'loss_val': 0.10030764476628032, 'psi': 0.9698029139300334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=49 head_norm_before_train=1.671051 cos_to_last_merge=0.9966 (last merge round=42)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.8856768525383373, 'auprc': 0.8457038332544197, 'loss_val': 0.3538060316370003, 'psi': 0.8696876448247702}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970888764494458, 'loss_val': 0.029567791236622173, 'psi': 0.9968835516122907}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.604253 cos_to_last_merge=0.9986 (last merge round=42)
[S16] round=49 local utility u=0.165146 metrics={'f1_val': 0.9218552797237638, 'auprc': 0.9860946399868389, 'loss_val': 0.35003204638042984, 'psi': 0.9475510238289938}-{'f1_val': 0.88473256016919, 'auprc': 0.989600269322159, 'loss_val': 0.46810433649828914, 'psi': 0.9266796438303777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=49 head_norm_before_train=1.760441 cos_to_last_merge=0.9794 (last merge round=42)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6102857907665937, 'auprc': 0.6558624952129432, 'loss_val': 1.406187173734703, 'psi': 0.6285164725451335}-{'f1_val': 0.8015227799307548, 'auprc': 0.9171978523792736, 'loss_val': 0.5677204135032355, 'psi': 0.8477928089101623}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=2.009693 cos_to_last_merge=0.7548 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=50 local utility u=0.005933 metrics={'f1_val': 0.7215826829129075, 'auprc': 0.7340406055843831, 'loss_val': 1.1094075048333745, 'psi': 0.7265658519814977}-{'f1_val': 0.7215826829129075, 'auprc': 0.7346074415960004, 'loss_val': 1.122973829878188, 'psi': 0.7267925863861446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=50 head_norm_before_train=2.158304 cos_to_last_merge=0.9996 (last merge round=43)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9866313087335232, 'loss_val': 0.14508461165408615, 'psi': 0.9709951079147847}-{'f1_val': 0.988972553129342, 'auprc': 0.9979304232858124, 'loss_val': 0.03279198538131002, 'psi': 0.9925557011919302}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.709635 cos_to_last_merge=0.9963 (last merge round=41)
[S4] round=50 local utility u=0.011487 metrics={'f1_val': 0.9421500864083732, 'auprc': 0.9639859969572394, 'loss_val': 0.3231301519408248, 'psi': 0.9508844506279197}-{'f1_val': 0.9418075101867134, 'auprc': 0.9576667137391937, 'loss_val': 0.3250899701297952, 'psi': 0.9481511916077054}
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] START round=50 head_norm_before_train=1.498224 cos_to_last_merge=0.9756 (last merge round=38)
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9945079693366681, 'loss_val': 0.052077927485445576, 'psi': 0.9956904618187533}-{'f1_val': 0.9966253574528599, 'auprc': 0.9977285068981632, 'loss_val': 0.05751269114256449, 'psi': 0.9970666172309812}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=50 head_norm_before_train=2.156732 (no previous merge yet)
[S6] round=50 local utility u=0.306945 metrics={'f1_val': 0.8222865003406657, 'auprc': 0.939110897322883, 'loss_val': 0.452532155292179, 'psi': 0.8690162591335526}-{'f1_val': 0.7490088543941402, 'auprc': 0.9206989836200825, 'loss_val': 0.5715207524829921, 'psi': 0.8176849060845172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=50 head_norm_before_train=1.640622 cos_to_last_merge=0.9998 (last merge round=43)
[S7] round=50 local utility u=0.224469 metrics={'f1_val': 0.6431610942847505, 'auprc': 0.8053477530636801, 'loss_val': 0.5582048218790915, 'psi': 0.7080357577963223}-{'f1_val': 0.5926438707341977, 'auprc': 0.7943395697872326, 'loss_val': 0.6710154106008094, 'psi': 0.6733221503554117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=50 head_norm_before_train=2.149595 cos_to_last_merge=0.9993 (last merge round=42)
[S8] round=50 local utility u=0.208821 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9994763161303504, 'loss_val': 0.02933670153844114, 'psi': 0.9954448628752157}-{'f1_val': 0.9414421078876039, 'auprc': 0.9992174786832999, 'loss_val': 0.13831085769382537, 'psi': 0.9645522562058823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=50 head_norm_before_train=2.153638 (no previous merge yet)
[S9] round=50 local utility u=0.000825 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9987745604487613, 'loss_val': 0.019779597250088987, 'psi': 0.9975667902439135}-{'f1_val': 0.9965113446440821, 'auprc': 0.9987738817222587, 'loss_val': 0.019925113414751932, 'psi': 0.9974163594753527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=50 head_norm_before_train=2.081028 cos_to_last_merge=0.9995 (last merge round=39)
[S10] round=50 local utility u=0.000062 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9953724413926548, 'loss_val': 0.027245748129152158, 'psi': 0.9948664406360985}-{'f1_val': 0.9945291067983943, 'auprc': 0.995337846155019, 'loss_val': 0.027265515338672025, 'psi': 0.9948526025410442}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=50 head_norm_before_train=1.598883 cos_to_last_merge=0.9789 (last merge round=35)
[S11] round=50 local utility u=0.040072 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980748578472295, 'loss_val': 0.032617598935872974, 'psi': 0.9970130436202084}-{'f1_val': 0.9870137789934632, 'auprc': 0.9984262687114719, 'loss_val': 0.05806792373141295, 'psi': 0.9915787748806667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=50 head_norm_before_train=2.034146 (no previous merge yet)
[S13] round=50 local utility u=0.014709 metrics={'f1_val': 0.7222009247343519, 'auprc': 0.7334397562719036, 'loss_val': 1.0651231435667572, 'psi': 0.7266964573493726}-{'f1_val': 0.7172237414362248, 'auprc': 0.7223969340185681, 'loss_val': 1.0315497272779488, 'psi': 0.7192930184691622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=50 head_norm_before_train=1.578874 cos_to_last_merge=0.9982 (last merge round=42)
[S14] round=50 local utility u=0.015904 metrics={'f1_val': 0.9961380077959525, 'auprc': 0.9986695279733815, 'loss_val': 0.0417349766465843, 'psi': 0.9971506158669241}-{'f1_val': 0.9927526851151321, 'auprc': 0.9990439380291077, 'loss_val': 0.05435338520546427, 'psi': 0.9952691862807224}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=50 head_norm_before_train=1.691462 cos_to_last_merge=0.9959 (last merge round=42)
[S15] round=50 local utility u=0.723523 metrics={'f1_val': 0.9966870188820673, 'auprc': 0.9980427983535348, 'loss_val': 0.02983813238019431, 'psi': 0.9972293306706543}-{'f1_val': 0.8856768525383373, 'auprc': 0.8457038332544197, 'loss_val': 0.3538060316370003, 'psi': 0.8696876448247702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=50 head_norm_before_train=1.612461 cos_to_last_merge=0.9984 (last merge round=42)
[S16] round=50 local utility u=0.356797 metrics={'f1_val': 0.9913008496107041, 'auprc': 0.9852217230643457, 'loss_val': 0.05049305844450014, 'psi': 0.9888691989921607}-{'f1_val': 0.9218552797237638, 'auprc': 0.9860946399868389, 'loss_val': 0.35003204638042984, 'psi': 0.9475510238289938}
[S16] not sending this round → trigger blocked (psi=0.989)
[S17] START round=50 head_norm_before_train=1.788528 cos_to_last_merge=0.9767 (last merge round=42)
[S17] round=50 local utility u=0.682753 metrics={'f1_val': 0.6509612470371355, 'auprc': 0.9125590232251446, 'loss_val': 1.0548240588006854, 'psi': 0.7556003575123391}-{'f1_val': 0.6102857907665937, 'auprc': 0.6558624952129432, 'loss_val': 1.406187173734703, 'psi': 0.6285164725451335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=51 head_norm_before_train=2.008386 cos_to_last_merge=0.7552 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.7206234373800616, 'auprc': 0.7341157939197663, 'loss_val': 1.1312508029830879, 'psi': 0.7260203799959435}-{'f1_val': 0.7215826829129075, 'auprc': 0.7340406055843831, 'loss_val': 1.1094075048333745, 'psi': 0.7265658519814977}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=2.167038 cos_to_last_merge=0.9994 (last merge round=43)
[S3] round=51 local utility u=0.131213 metrics={'f1_val': 0.9875886000754115, 'auprc': 0.9978837087736343, 'loss_val': 0.07852181725968946, 'psi': 0.9917066435547006}-{'f1_val': 0.9605709740356257, 'auprc': 0.9866313087335232, 'loss_val': 0.14508461165408615, 'psi': 0.9709951079147847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=51 head_norm_before_train=1.715200 cos_to_last_merge=0.9958 (last merge round=41)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9403883750487798, 'auprc': 0.953050107096372, 'loss_val': 0.3385579874376685, 'psi': 0.9454530678678167}-{'f1_val': 0.9421500864083732, 'auprc': 0.9639859969572394, 'loss_val': 0.3231301519408248, 'psi': 0.9508844506279197}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.533938 cos_to_last_merge=0.9713 (last merge round=38)
[S5] round=51 local utility u=0.006964 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9972428355536632, 'loss_val': 0.04635551554417441, 'psi': 0.9967844083055514}-{'f1_val': 0.9964787901401435, 'auprc': 0.9945079693366681, 'loss_val': 0.052077927485445576, 'psi': 0.9956904618187533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=51 head_norm_before_train=2.169879 (no previous merge yet)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.7790890851568242, 'auprc': 0.9173621001447163, 'loss_val': 0.7313620464367733, 'psi': 0.8343982911519809}-{'f1_val': 0.8222865003406657, 'auprc': 0.939110897322883, 'loss_val': 0.452532155292179, 'psi': 0.8690162591335526}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.646121 cos_to_last_merge=0.9998 (last merge round=43)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.5556545594629765, 'auprc': 0.7883175182665553, 'loss_val': 0.9548781183546255, 'psi': 0.648719742984408}-{'f1_val': 0.6431610942847505, 'auprc': 0.8053477530636801, 'loss_val': 0.5582048218790915, 'psi': 0.7080357577963223}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=2.160075 cos_to_last_merge=0.9992 (last merge round=42)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9396948902479619, 'auprc': 0.9989923299825474, 'loss_val': 0.12969986979307044, 'psi': 0.9634138661417961}-{'f1_val': 0.9927572273717925, 'auprc': 0.9994763161303504, 'loss_val': 0.02933670153844114, 'psi': 0.9954448628752157}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=2.162456 (no previous merge yet)
[S9] round=51 local utility u=0.001390 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9987742790718661, 'loss_val': 0.01946364114503162, 'psi': 0.9978132184379902}-{'f1_val': 0.9967616101073482, 'auprc': 0.9987745604487613, 'loss_val': 0.019779597250088987, 'psi': 0.9975667902439135}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=51 head_norm_before_train=2.089460 cos_to_last_merge=0.9994 (last merge round=39)
[S10] round=51 local utility u=0.002747 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9966896864675205, 'loss_val': 0.027020249336067757, 'psi': 0.9955250401186317}-{'f1_val': 0.9945291067983943, 'auprc': 0.9953724413926548, 'loss_val': 0.027245748129152158, 'psi': 0.9948664406360985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=51 head_norm_before_train=1.609825 cos_to_last_merge=0.9779 (last merge round=35)
[S11] round=51 local utility u=0.002014 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981947079333471, 'loss_val': 0.030399975748773234, 'psi': 0.9972060858814926}-{'f1_val': 0.996305167468861, 'auprc': 0.9980748578472295, 'loss_val': 0.032617598935872974, 'psi': 0.9970130436202084}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=51 head_norm_before_train=2.048743 (no previous merge yet)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.7137839610594364, 'auprc': 0.670802107558699, 'loss_val': 1.2196316037973154, 'psi': 0.6965912196591415}-{'f1_val': 0.7222009247343519, 'auprc': 0.7334397562719036, 'loss_val': 1.0651231435667572, 'psi': 0.7266964573493726}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=1.589567 cos_to_last_merge=0.9978 (last merge round=42)
[S14] round=51 local utility u=0.000808 metrics={'f1_val': 0.9961134279895458, 'auprc': 0.9990448181871856, 'loss_val': 0.04109682310305589, 'psi': 0.9972859840686017}-{'f1_val': 0.9961380077959525, 'auprc': 0.9986695279733815, 'loss_val': 0.0417349766465843, 'psi': 0.9971506158669241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=51 head_norm_before_train=1.707102 cos_to_last_merge=0.9953 (last merge round=42)
[S15] round=51 local utility u=0.004210 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9979236621376618, 'loss_val': 0.023642055305152836, 'psi': 0.9974398169719249}-{'f1_val': 0.9966870188820673, 'auprc': 0.9980427983535348, 'loss_val': 0.02983813238019431, 'psi': 0.9972293306706543}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=51 head_norm_before_train=1.619774 cos_to_last_merge=0.9981 (last merge round=42)
[S16] round=51 local utility u=0.002434 metrics={'f1_val': 0.9921370743744229, 'auprc': 0.9849840302941817, 'loss_val': 0.04992967812931173, 'psi': 0.9892758567423264}-{'f1_val': 0.9913008496107041, 'auprc': 0.9852217230643457, 'loss_val': 0.05049305844450014, 'psi': 0.9888691989921607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=51 head_norm_before_train=1.807085 cos_to_last_merge=0.9745 (last merge round=42)
[S17] round=51 local utility u=0.830869 metrics={'f1_val': 0.830019115900567, 'auprc': 0.9286714269327315, 'loss_val': 0.5157702376576, 'psi': 0.8694800403134328}-{'f1_val': 0.6509612470371355, 'auprc': 0.9125590232251446, 'loss_val': 1.0548240588006854, 'psi': 0.7556003575123391}
[S17] not sending this round → trigger blocked (psi=0.869)
[S2] START round=52 head_norm_before_train=2.011946 cos_to_last_merge=0.7550 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=52 local utility u=0.008251 metrics={'f1_val': 0.7196577353138458, 'auprc': 0.7343610901535164, 'loss_val': 1.1096899397752247, 'psi': 0.725539077249714}-{'f1_val': 0.7206234373800616, 'auprc': 0.7341157939197663, 'loss_val': 1.1312508029830879, 'psi': 0.7260203799959435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=52 head_norm_before_train=2.174959 cos_to_last_merge=0.9993 (last merge round=43)
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9715404807088818, 'loss_val': 0.1658333412637192, 'psi': 0.9651139576662908}-{'f1_val': 0.9875886000754115, 'auprc': 0.9978837087736343, 'loss_val': 0.07852181725968946, 'psi': 0.9917066435547006}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=1.725441 cos_to_last_merge=0.9954 (last merge round=41)
[S4] round=52 local utility u=0.040494 metrics={'f1_val': 0.9491887242469357, 'auprc': 0.9578071385327982, 'loss_val': 0.32464342462754536, 'psi': 0.9526360899612807}-{'f1_val': 0.9403883750487798, 'auprc': 0.953050107096372, 'loss_val': 0.3385579874376685, 'psi': 0.9454530678678167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=52 head_norm_before_train=1.565513 cos_to_last_merge=0.9674 (last merge round=38)
[S5] round=52 local utility u=0.003834 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.9979362000359553, 'loss_val': 0.041646883460173194, 'psi': 0.997149694486098}-{'f1_val': 0.9964787901401435, 'auprc': 0.9972428355536632, 'loss_val': 0.04635551554417441, 'psi': 0.9967844083055514}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=52 head_norm_before_train=2.187901 (no previous merge yet)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.5810264613742936, 'auprc': 0.8205462709854824, 'loss_val': 1.4233455399988852, 'psi': 0.676834385218769}-{'f1_val': 0.7790890851568242, 'auprc': 0.9173621001447163, 'loss_val': 0.7313620464367733, 'psi': 0.8343982911519809}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.651242 cos_to_last_merge=0.9998 (last merge round=43)
[S7] round=52 local utility u=0.673987 metrics={'f1_val': 0.6703172078700819, 'auprc': 0.8182082587705383, 'loss_val': 0.38455168509495463, 'psi': 0.7294736282302645}-{'f1_val': 0.5556545594629765, 'auprc': 0.7883175182665553, 'loss_val': 0.9548781183546255, 'psi': 0.648719742984408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=52 head_norm_before_train=2.167217 cos_to_last_merge=0.9991 (last merge round=42)
[S8] round=52 local utility u=0.202975 metrics={'f1_val': 0.990820193592503, 'auprc': 0.9996669640394273, 'loss_val': 0.03252506183754414, 'psi': 0.9943589017712727}-{'f1_val': 0.9396948902479619, 'auprc': 0.9989923299825474, 'loss_val': 0.12969986979307044, 'psi': 0.9634138661417961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=52 head_norm_before_train=2.171047 (no previous merge yet)
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9959282335575622, 'auprc': 0.9983103692381172, 'loss_val': 0.01959807426755844, 'psi': 0.9968810878297842}-{'f1_val': 0.9971725113487396, 'auprc': 0.9987742790718661, 'loss_val': 0.01946364114503162, 'psi': 0.9978132184379902}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=2.091822 cos_to_last_merge=0.9992 (last merge round=39)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9962658158125123, 'loss_val': 0.027095398702356107, 'psi': 0.9952237904040415}-{'f1_val': 0.9947486092193725, 'auprc': 0.9966896864675205, 'loss_val': 0.027020249336067757, 'psi': 0.9955250401186317}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=52 head_norm_before_train=1.621073 cos_to_last_merge=0.9769 (last merge round=35)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9924737983551225, 'auprc': 0.9985315859114499, 'loss_val': 0.04171334822501724, 'psi': 0.9948969133776534}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981947079333471, 'loss_val': 0.030399975748773234, 'psi': 0.9972060858814926}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=2.054271 (no previous merge yet)
[S13] round=52 local utility u=0.327576 metrics={'f1_val': 0.7225475873371381, 'auprc': 0.7832622338081854, 'loss_val': 0.954441735887207, 'psi': 0.746833445925557}-{'f1_val': 0.7137839610594364, 'auprc': 0.670802107558699, 'loss_val': 1.2196316037973154, 'psi': 0.6965912196591415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=52 head_norm_before_train=1.597489 cos_to_last_merge=0.9975 (last merge round=42)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9338527800136562, 'auprc': 0.9989261227017685, 'loss_val': 0.14982600255970852, 'psi': 0.9598821170889011}-{'f1_val': 0.9961134279895458, 'auprc': 0.9990448181871856, 'loss_val': 0.04109682310305589, 'psi': 0.9972859840686017}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=1.723011 cos_to_last_merge=0.9946 (last merge round=42)
[S15] round=52 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.997643276036239, 'loss_val': 0.024930882508163867, 'psi': 0.997105311447008}-{'f1_val': 0.9971172535281002, 'auprc': 0.9979236621376618, 'loss_val': 0.023642055305152836, 'psi': 0.9974398169719249}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=52 head_norm_before_train=1.627229 cos_to_last_merge=0.9979 (last merge round=42)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9406951852006941, 'auprc': 0.9820408256342772, 'loss_val': 0.2064969339087576, 'psi': 0.9572334413741272}-{'f1_val': 0.9921370743744229, 'auprc': 0.9849840302941817, 'loss_val': 0.04992967812931173, 'psi': 0.9892758567423264}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.827861 cos_to_last_merge=0.9723 (last merge round=42)
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.5808568607298581, 'auprc': 0.6408211177795546, 'loss_val': 1.3918653142486082, 'psi': 0.6048425635497368}-{'f1_val': 0.830019115900567, 'auprc': 0.9286714269327315, 'loss_val': 0.5157702376576, 'psi': 0.8694800403134328}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=2.019074 cos_to_last_merge=0.7545 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.6823895231718714, 'auprc': 0.725275556286118, 'loss_val': 1.2810667459913307, 'psi': 0.69954393641757}-{'f1_val': 0.7196577353138458, 'auprc': 0.7343610901535164, 'loss_val': 1.1096899397752247, 'psi': 0.725539077249714}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=53 head_norm_before_train=2.182274 cos_to_last_merge=0.9992 (last merge round=43)
[S3] round=53 local utility u=0.079478 metrics={'f1_val': 0.9635859775639782, 'auprc': 0.9982318271273964, 'loss_val': 0.10348883065047683, 'psi': 0.9774443173893456}-{'f1_val': 0.9608296089712303, 'auprc': 0.9715404807088818, 'loss_val': 0.1658333412637192, 'psi': 0.9651139576662908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=53 head_norm_before_train=1.739550 cos_to_last_merge=0.9948 (last merge round=41)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9390273749218988, 'auprc': 0.9454421141629815, 'loss_val': 0.3533520648314821, 'psi': 0.9415932706183319}-{'f1_val': 0.9491887242469357, 'auprc': 0.9578071385327982, 'loss_val': 0.32464342462754536, 'psi': 0.9526360899612807}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.596546 cos_to_last_merge=0.9641 (last merge round=38)
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9923282993781273, 'loss_val': 0.04075674420162832, 'psi': 0.994818593835337}-{'f1_val': 0.9966253574528599, 'auprc': 0.9979362000359553, 'loss_val': 0.041646883460173194, 'psi': 0.997149694486098}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=2.202427 (no previous merge yet)
[S6] round=53 local utility u=1.000000 metrics={'f1_val': 0.7738541355141184, 'auprc': 0.945719665588237, 'loss_val': 0.7190856065227464, 'psi': 0.8426003475437658}-{'f1_val': 0.5810264613742936, 'auprc': 0.8205462709854824, 'loss_val': 1.4233455399988852, 'psi': 0.676834385218769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=53 head_norm_before_train=1.656321 cos_to_last_merge=0.9997 (last merge round=43)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.6207793686928638, 'auprc': 0.7982508196196078, 'loss_val': 0.5678119309533738, 'psi': 0.6917679490635613}-{'f1_val': 0.6703172078700819, 'auprc': 0.8182082587705383, 'loss_val': 0.38455168509495463, 'psi': 0.7294736282302645}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=2.172068 cos_to_last_merge=0.9990 (last merge round=42)
[S8] round=53 local utility u=0.008023 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9996765852291987, 'loss_val': 0.029596923298934912, 'psi': 0.995671708783352}-{'f1_val': 0.990820193592503, 'auprc': 0.9996669640394273, 'loss_val': 0.03252506183754414, 'psi': 0.9943589017712727}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=53 head_norm_before_train=2.176844 (no previous merge yet)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.996632022811077, 'loss_val': 0.02263725116165839, 'psi': 0.9967097751888397}-{'f1_val': 0.9959282335575622, 'auprc': 0.9983103692381172, 'loss_val': 0.01959807426755844, 'psi': 0.9968810878297842}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=2.091898 cos_to_last_merge=0.9989 (last merge round=39)
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9963053918268387, 'loss_val': 0.02735169908006812, 'psi': 0.9952396208097721}-{'f1_val': 0.9945291067983943, 'auprc': 0.9962658158125123, 'loss_val': 0.027095398702356107, 'psi': 0.9952237904040415}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=1.631975 cos_to_last_merge=0.9758 (last merge round=35)
[S11] round=53 local utility u=0.016311 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979070180649384, 'loss_val': 0.030205369478256756, 'psi': 0.996945907707292}-{'f1_val': 0.9924737983551225, 'auprc': 0.9985315859114499, 'loss_val': 0.04171334822501724, 'psi': 0.9948969133776534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=53 head_norm_before_train=2.064495 (no previous merge yet)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.7252679582878083, 'auprc': 0.6965343850470653, 'loss_val': 1.1382500163172848, 'psi': 0.7137745289915112}-{'f1_val': 0.7225475873371381, 'auprc': 0.7832622338081854, 'loss_val': 0.954441735887207, 'psi': 0.746833445925557}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=1.606735 cos_to_last_merge=0.9972 (last merge round=42)
[S14] round=53 local utility u=0.232790 metrics={'f1_val': 0.9938092796660458, 'auprc': 0.9990478449163008, 'loss_val': 0.044349712943034796, 'psi': 0.9959047057661479}-{'f1_val': 0.9338527800136562, 'auprc': 0.9989261227017685, 'loss_val': 0.14982600255970852, 'psi': 0.9598821170889011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=53 head_norm_before_train=1.739053 cos_to_last_merge=0.9940 (last merge round=42)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.9250769459895791, 'auprc': 0.9978178844428796, 'loss_val': 0.15101456565457538, 'psi': 0.9541733213708994}-{'f1_val': 0.9967466683875206, 'auprc': 0.997643276036239, 'loss_val': 0.024930882508163867, 'psi': 0.997105311447008}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.635611 cos_to_last_merge=0.9975 (last merge round=42)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.9356668884522608, 'auprc': 0.98213577077338, 'loss_val': 0.3109514647671217, 'psi': 0.9542544413807084}-{'f1_val': 0.9406951852006941, 'auprc': 0.9820408256342772, 'loss_val': 0.2064969339087576, 'psi': 0.9572334413741272}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.846586 cos_to_last_merge=0.9705 (last merge round=42)
[S17] round=53 local utility u=1.000000 metrics={'f1_val': 0.7792384837758638, 'auprc': 0.8610795013193393, 'loss_val': 0.7996826676512141, 'psi': 0.811974890793254}-{'f1_val': 0.5808568607298581, 'auprc': 0.6408211177795546, 'loss_val': 1.3918653142486082, 'psi': 0.6048425635497368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=54 head_norm_before_train=2.021395 cos_to_last_merge=0.7543 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=54 local utility u=1.000000 metrics={'f1_val': 0.8122724192415404, 'auprc': 0.9217971195013376, 'loss_val': 0.4722585396425695, 'psi': 0.8560822993454593}-{'f1_val': 0.6823895231718714, 'auprc': 0.725275556286118, 'loss_val': 1.2810667459913307, 'psi': 0.69954393641757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=54 head_norm_before_train=2.189678 cos_to_last_merge=0.9991 (last merge round=43)
[S3] round=54 local utility u=0.140294 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9986976817688671, 'loss_val': 0.027172923015711566, 'psi': 0.9979180141751813}-{'f1_val': 0.9635859775639782, 'auprc': 0.9982318271273964, 'loss_val': 0.10348883065047683, 'psi': 0.9774443173893456}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=54 head_norm_before_train=1.749633 cos_to_last_merge=0.9944 (last merge round=41)
[S4] round=54 local utility u=0.042949 metrics={'f1_val': 0.9453487063673898, 'auprc': 0.9537691508254549, 'loss_val': 0.3303638265732029, 'psi': 0.9487168841506157}-{'f1_val': 0.9390273749218988, 'auprc': 0.9454421141629815, 'loss_val': 0.3533520648314821, 'psi': 0.9415932706183319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=54 head_norm_before_train=1.621483 cos_to_last_merge=0.9615 (last merge round=38)
[S5] round=54 local utility u=0.005448 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9955786564662079, 'loss_val': 0.03961233289692218, 'psi': 0.9961187366705693}-{'f1_val': 0.9964787901401435, 'auprc': 0.9923282993781273, 'loss_val': 0.04075674420162832, 'psi': 0.994818593835337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=54 head_norm_before_train=2.211697 (no previous merge yet)
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.6029634500840179, 'auprc': 0.628512330055934, 'loss_val': 1.830464547265183, 'psi': 0.6131830020727843}-{'f1_val': 0.7738541355141184, 'auprc': 0.945719665588237, 'loss_val': 0.7190856065227464, 'psi': 0.8426003475437658}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.660603 cos_to_last_merge=0.9997 (last merge round=43)
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.5845690717086056, 'auprc': 0.7924676990125982, 'loss_val': 0.7309603939063921, 'psi': 0.6677285226302027}-{'f1_val': 0.6207793686928638, 'auprc': 0.7982508196196078, 'loss_val': 0.5678119309533738, 'psi': 0.6917679490635613}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=2.180885 cos_to_last_merge=0.9989 (last merge round=42)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9038927737061222, 'auprc': 0.999139056289623, 'loss_val': 0.17819883548188892, 'psi': 0.9419912867395225}-{'f1_val': 0.9930017911527874, 'auprc': 0.9996765852291987, 'loss_val': 0.029596923298934912, 'psi': 0.995671708783352}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=2.182220 (no previous merge yet)
[S9] round=54 local utility u=0.004799 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9983987765276348, 'loss_val': 0.020805186441187534, 'psi': 0.9976630174202976}-{'f1_val': 0.9967616101073482, 'auprc': 0.996632022811077, 'loss_val': 0.02263725116165839, 'psi': 0.9967097751888397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=54 head_norm_before_train=2.097278 cos_to_last_merge=0.9988 (last merge round=39)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9964063835701051, 'loss_val': 0.027691939164754032, 'psi': 0.9952800175070786}-{'f1_val': 0.9945291067983943, 'auprc': 0.9963053918268387, 'loss_val': 0.02735169908006812, 'psi': 0.9952396208097721}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=1.639689 cos_to_last_merge=0.9750 (last merge round=35)
[S11] round=54 local utility u=0.002721 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985561928399018, 'loss_val': 0.02816251154635525, 'psi': 0.9973506798441145}-{'f1_val': 0.996305167468861, 'auprc': 0.9979070180649384, 'loss_val': 0.030205369478256756, 'psi': 0.996945907707292}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=54 head_norm_before_train=2.066052 (no previous merge yet)
[S13] round=54 local utility u=0.023184 metrics={'f1_val': 0.7320678192162705, 'auprc': 0.7045727613864661, 'loss_val': 1.1567971274972115, 'psi': 0.7210697960843487}-{'f1_val': 0.7252679582878083, 'auprc': 0.6965343850470653, 'loss_val': 1.1382500163172848, 'psi': 0.7137745289915112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=54 head_norm_before_train=1.617733 cos_to_last_merge=0.9968 (last merge round=42)
[S14] round=54 local utility u=0.015391 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9986714734133015, 'loss_val': 0.033899806954769914, 'psi': 0.9979003463540694}-{'f1_val': 0.9938092796660458, 'auprc': 0.9990478449163008, 'loss_val': 0.044349712943034796, 'psi': 0.9959047057661479}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=54 head_norm_before_train=1.754659 cos_to_last_merge=0.9934 (last merge round=42)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.9016001089992542, 'auprc': 0.9007738644955361, 'loss_val': 0.3362676336790302, 'psi': 0.9012696111977669}-{'f1_val': 0.9250769459895791, 'auprc': 0.9978178844428796, 'loss_val': 0.15101456565457538, 'psi': 0.9541733213708994}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=1.644814 cos_to_last_merge=0.9972 (last merge round=42)
[S16] round=54 local utility u=0.005315 metrics={'f1_val': 0.9360268718422556, 'auprc': 0.984472967278128, 'loss_val': 0.3094922900793749, 'psi': 0.9554053100166047}-{'f1_val': 0.9356668884522608, 'auprc': 0.98213577077338, 'loss_val': 0.3109514647671217, 'psi': 0.9542544413807084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=54 head_norm_before_train=1.863757 cos_to_last_merge=0.9689 (last merge round=42)
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.7457641041411591, 'auprc': 0.8648209171796475, 'loss_val': 0.9125554397606102, 'psi': 0.7933868293565545}-{'f1_val': 0.7792384837758638, 'auprc': 0.8610795013193393, 'loss_val': 0.7996826676512141, 'psi': 0.811974890793254}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=55 head_norm_before_train=2.018930 cos_to_last_merge=0.7546 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.783225631838511, 'auprc': 0.8725956464507111, 'loss_val': 0.653175680987674, 'psi': 0.818973637683391}-{'f1_val': 0.8122724192415404, 'auprc': 0.9217971195013376, 'loss_val': 0.4722585396425695, 'psi': 0.8560822993454593}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=55 head_norm_before_train=2.196929 cos_to_last_merge=0.9989 (last merge round=43)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9642653659854442, 'auprc': 0.9980920965257049, 'loss_val': 0.07943074475149248, 'psi': 0.9777960582015486}-{'f1_val': 0.9973982357793907, 'auprc': 0.9986976817688671, 'loss_val': 0.027172923015711566, 'psi': 0.9979180141751813}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.755484 cos_to_last_merge=0.9940 (last merge round=41)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9424982389785559, 'auprc': 0.9530617980909593, 'loss_val': 0.33272515944501796, 'psi': 0.9467236626235171}-{'f1_val': 0.9453487063673898, 'auprc': 0.9537691508254549, 'loss_val': 0.3303638265732029, 'psi': 0.9487168841506157}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.636083 cos_to_last_merge=0.9600 (last merge round=38)
[S5] round=55 local utility u=0.003024 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9970140607852646, 'loss_val': 0.0378699773598117, 'psi': 0.9966928983981919}-{'f1_val': 0.9964787901401435, 'auprc': 0.9955786564662079, 'loss_val': 0.03961233289692218, 'psi': 0.9961187366705693}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=55 head_norm_before_train=2.217242 (no previous merge yet)
[S6] round=55 local utility u=1.000000 metrics={'f1_val': 0.6980603453854213, 'auprc': 0.8906129270656635, 'loss_val': 0.7728664601942853, 'psi': 0.7750813780575182}-{'f1_val': 0.6029634500840179, 'auprc': 0.628512330055934, 'loss_val': 1.830464547265183, 'psi': 0.6131830020727843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=55 head_norm_before_train=1.666427 cos_to_last_merge=0.9996 (last merge round=43)
[S7] round=55 local utility u=0.533139 metrics={'f1_val': 0.6716721040891502, 'auprc': 0.8333642368493406, 'loss_val': 0.3099902164414942, 'psi': 0.7363489571932263}-{'f1_val': 0.5845690717086056, 'auprc': 0.7924676990125982, 'loss_val': 0.7309603939063921, 'psi': 0.6677285226302027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=55 head_norm_before_train=2.192216 cos_to_last_merge=0.9987 (last merge round=42)
[S8] round=55 local utility u=0.062368 metrics={'f1_val': 0.9208853747987498, 'auprc': 0.9992507349182262, 'loss_val': 0.15575329488806838, 'psi': 0.9522315188465404}-{'f1_val': 0.9038927737061222, 'auprc': 0.999139056289623, 'loss_val': 0.17819883548188892, 'psi': 0.9419912867395225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=55 head_norm_before_train=2.188687 (no previous merge yet)
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9932516776587306, 'loss_val': 0.02152406552488082, 'psi': 0.9953576371279012}-{'f1_val': 0.9971725113487396, 'auprc': 0.9983987765276348, 'loss_val': 0.020805186441187534, 'psi': 0.9976630174202976}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=2.104955 cos_to_last_merge=0.9987 (last merge round=39)
[S10] round=55 local utility u=0.000718 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.99665728962542, 'loss_val': 0.02700927829443526, 'psi': 0.9953803799292046}-{'f1_val': 0.9945291067983943, 'auprc': 0.9964063835701051, 'loss_val': 0.027691939164754032, 'psi': 0.9952800175070786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=55 head_norm_before_train=1.647452 cos_to_last_merge=0.9743 (last merge round=35)
[S11] round=55 local utility u=0.000321 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998565284918366, 'loss_val': 0.027548132703037975, 'psi': 0.9973543166755001}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985561928399018, 'loss_val': 0.02816251154635525, 'psi': 0.9973506798441145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=55 head_norm_before_train=2.067782 (no previous merge yet)
[S13] round=55 local utility u=0.124418 metrics={'f1_val': 0.719466970339044, 'auprc': 0.7398210021570374, 'loss_val': 0.9381015653810185, 'psi': 0.7276085830662413}-{'f1_val': 0.7320678192162705, 'auprc': 0.7045727613864661, 'loss_val': 1.1567971274972115, 'psi': 0.7210697960843487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=55 head_norm_before_train=1.629217 cos_to_last_merge=0.9964 (last merge round=42)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9968012154155281, 'auprc': 0.9990439273935676, 'loss_val': 0.036087437594432434, 'psi': 0.9976983002067439}-{'f1_val': 0.9973862616479148, 'auprc': 0.9986714734133015, 'loss_val': 0.033899806954769914, 'psi': 0.9979003463540694}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.768803 cos_to_last_merge=0.9928 (last merge round=42)
[S15] round=55 local utility u=0.588513 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9980645773452315, 'loss_val': 0.02421628407711594, 'psi': 0.9974961830549527}-{'f1_val': 0.9016001089992542, 'auprc': 0.9007738644955361, 'loss_val': 0.3362676336790302, 'psi': 0.9012696111977669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=55 head_norm_before_train=1.654374 cos_to_last_merge=0.9969 (last merge round=42)
[S16] round=55 local utility u=0.063362 metrics={'f1_val': 0.9404096281089026, 'auprc': 0.9904390140223726, 'loss_val': 0.22696387464393605, 'psi': 0.9604213824742905}-{'f1_val': 0.9360268718422556, 'auprc': 0.984472967278128, 'loss_val': 0.3094922900793749, 'psi': 0.9554053100166047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=55 head_norm_before_train=1.879247 cos_to_last_merge=0.9673 (last merge round=42)
[S17] round=55 local utility u=0.439504 metrics={'f1_val': 0.83622151790722, 'auprc': 0.9121467667979068, 'loss_val': 0.7182699224893021, 'psi': 0.8665916174634948}-{'f1_val': 0.7457641041411591, 'auprc': 0.8648209171796475, 'loss_val': 0.9125554397606102, 'psi': 0.7933868293565545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=56 head_norm_before_train=2.021165 cos_to_last_merge=0.7544 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.7023206574300332, 'auprc': 0.9172986537226275, 'loss_val': 0.5844488520588633, 'psi': 0.788311855947071}-{'f1_val': 0.783225631838511, 'auprc': 0.8725956464507111, 'loss_val': 0.653175680987674, 'psi': 0.818973637683391}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=2.204245 cos_to_last_merge=0.9988 (last merge round=43)
[S3] round=56 local utility u=0.124790 metrics={'f1_val': 0.9972354948704062, 'auprc': 0.99747597982199, 'loss_val': 0.025823394217863022, 'psi': 0.9973316888510397}-{'f1_val': 0.9642653659854442, 'auprc': 0.9980920965257049, 'loss_val': 0.07943074475149248, 'psi': 0.9777960582015486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=56 head_norm_before_train=1.756104 cos_to_last_merge=0.9936 (last merge round=41)
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.940929027383375, 'auprc': 0.9559075439894428, 'loss_val': 0.3381310805058589, 'psi': 0.9469204340258022}-{'f1_val': 0.9424982389785559, 'auprc': 0.9530617980909593, 'loss_val': 0.33272515944501796, 'psi': 0.9467236626235171}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.644642 cos_to_last_merge=0.9589 (last merge round=38)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9916888389001882, 'loss_val': 0.03630555195701622, 'psi': 0.9945628096441613}-{'f1_val': 0.9964787901401435, 'auprc': 0.9970140607852646, 'loss_val': 0.0378699773598117, 'psi': 0.9966928983981919}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=2.222512 (no previous merge yet)
[S6] round=56 local utility u=1.000000 metrics={'f1_val': 0.9580272906209217, 'auprc': 0.9793038865846956, 'loss_val': 0.1472623250139254, 'psi': 0.9665379290064313}-{'f1_val': 0.6980603453854213, 'auprc': 0.8906129270656635, 'loss_val': 0.7728664601942853, 'psi': 0.7750813780575182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=56 head_norm_before_train=1.673361 cos_to_last_merge=0.9994 (last merge round=43)
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.6172277934105872, 'auprc': 0.7959753518692604, 'loss_val': 0.6853052337896575, 'psi': 0.6887268167940565}-{'f1_val': 0.6716721040891502, 'auprc': 0.8333642368493406, 'loss_val': 0.3099902164414942, 'psi': 0.7363489571932263}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=2.199823 cos_to_last_merge=0.9986 (last merge round=42)
[S8] round=56 local utility u=0.281208 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9996603094895925, 'loss_val': 0.02799124709826514, 'psi': 0.9957377715853332}-{'f1_val': 0.9208853747987498, 'auprc': 0.9992507349182262, 'loss_val': 0.15575329488806838, 'psi': 0.9522315188465404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=56 head_norm_before_train=2.193987 (no previous merge yet)
[S9] round=56 local utility u=0.003058 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9949403157686754, 'loss_val': 0.020473238519506783, 'psi': 0.9960330923718791}-{'f1_val': 0.9967616101073482, 'auprc': 0.9932516776587306, 'loss_val': 0.02152406552488082, 'psi': 0.9953576371279012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=56 head_norm_before_train=2.112252 cos_to_last_merge=0.9987 (last merge round=39)
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9963932031169443, 'loss_val': 0.027101529509158572, 'psi': 0.9952747453258144}-{'f1_val': 0.9945291067983943, 'auprc': 0.99665728962542, 'loss_val': 0.02700927829443526, 'psi': 0.9953803799292046}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=1.656155 cos_to_last_merge=0.9735 (last merge round=35)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981576993321093, 'loss_val': 0.028531036540431175, 'psi': 0.9970461802141604}-{'f1_val': 0.9965470045135896, 'auprc': 0.998565284918366, 'loss_val': 0.027548132703037975, 'psi': 0.9973543166755001}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=2.081437 (no previous merge yet)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6538469771306532, 'auprc': 0.6447132656301556, 'loss_val': 1.41425695967232, 'psi': 0.6501934925304542}-{'f1_val': 0.719466970339044, 'auprc': 0.7398210021570374, 'loss_val': 0.9381015653810185, 'psi': 0.7276085830662413}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=1.637254 cos_to_last_merge=0.9962 (last merge round=42)
[S14] round=56 local utility u=0.001126 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9986687948512507, 'loss_val': 0.03377589901629149, 'psi': 0.9976548243016229}-{'f1_val': 0.9968012154155281, 'auprc': 0.9990439273935676, 'loss_val': 0.036087437594432434, 'psi': 0.9976983002067439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=56 head_norm_before_train=1.781895 cos_to_last_merge=0.9922 (last merge round=42)
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970246174665298, 'loss_val': 0.02308702941039809, 'psi': 0.9968578480191242}-{'f1_val': 0.9971172535281002, 'auprc': 0.9980645773452315, 'loss_val': 0.02421628407711594, 'psi': 0.9974961830549527}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=1.664052 cos_to_last_merge=0.9966 (last merge round=42)
[S16] round=56 local utility u=0.068705 metrics={'f1_val': 0.9481953933852607, 'auprc': 0.9923603316315815, 'loss_val': 0.14203184347568149, 'psi': 0.965861368683789}-{'f1_val': 0.9404096281089026, 'auprc': 0.9904390140223726, 'loss_val': 0.22696387464393605, 'psi': 0.9604213824742905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=56 head_norm_before_train=1.891208 cos_to_last_merge=0.9661 (last merge round=42)
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.8326564394091774, 'auprc': 0.8978304543469159, 'loss_val': 0.7233717095076168, 'psi': 0.8587260453842729}-{'f1_val': 0.83622151790722, 'auprc': 0.9121467667979068, 'loss_val': 0.7182699224893021, 'psi': 0.8665916174634948}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=57 head_norm_before_train=2.029528 cos_to_last_merge=0.7537 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.7213914234519476, 'auprc': 0.7170311883883556, 'loss_val': 1.1072069579880135, 'psi': 0.7196473294265108}-{'f1_val': 0.7023206574300332, 'auprc': 0.9172986537226275, 'loss_val': 0.5844488520588633, 'psi': 0.788311855947071}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=2.208996 cos_to_last_merge=0.9987 (last merge round=43)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.99392005828232, 'auprc': 0.997043158223289, 'loss_val': 0.06244281921369566, 'psi': 0.9951692982587076}-{'f1_val': 0.9972354948704062, 'auprc': 0.99747597982199, 'loss_val': 0.025823394217863022, 'psi': 0.9973316888510397}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.760355 cos_to_last_merge=0.9933 (last merge round=41)
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9416579187582688, 'auprc': 0.950497454828981, 'loss_val': 0.3421458413175852, 'psi': 0.9451937331865536}-{'f1_val': 0.940929027383375, 'auprc': 0.9559075439894428, 'loss_val': 0.3381310805058589, 'psi': 0.9469204340258022}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.658260 cos_to_last_merge=0.9573 (last merge round=38)
[S5] round=57 local utility u=0.005250 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.994735091324816, 'loss_val': 0.034945201825587524, 'psi': 0.9957813106140124}-{'f1_val': 0.9964787901401435, 'auprc': 0.9916888389001882, 'loss_val': 0.03630555195701622, 'psi': 0.9945628096441613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=57 head_norm_before_train=2.232826 (no previous merge yet)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.7654686343578279, 'auprc': 0.8695035199751847, 'loss_val': 0.595393309353169, 'psi': 0.8070825886047706}-{'f1_val': 0.9580272906209217, 'auprc': 0.9793038865846956, 'loss_val': 0.1472623250139254, 'psi': 0.9665379290064313}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.679948 cos_to_last_merge=0.9992 (last merge round=43)
[S7] round=57 local utility u=0.178430 metrics={'f1_val': 0.6388584932688185, 'auprc': 0.8059020756308175, 'loss_val': 0.48800884509061915, 'psi': 0.7056759262136181}-{'f1_val': 0.6172277934105872, 'auprc': 0.7959753518692604, 'loss_val': 0.6853052337896575, 'psi': 0.6887268167940565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=57 head_norm_before_train=2.205132 cos_to_last_merge=0.9984 (last merge round=42)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9917244887003366, 'auprc': 0.99955622009259, 'loss_val': 0.02909833862773779, 'psi': 0.994857181257238}-{'f1_val': 0.993122746315827, 'auprc': 0.9996603094895925, 'loss_val': 0.02799124709826514, 'psi': 0.9957377715853332}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=2.200908 (no previous merge yet)
[S9] round=57 local utility u=0.007853 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.998682728538832, 'loss_val': 0.01846009353023269, 'psi': 0.9977765982247766}-{'f1_val': 0.9967616101073482, 'auprc': 0.9949403157686754, 'loss_val': 0.020473238519506783, 'psi': 0.9960330923718791}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=57 head_norm_before_train=2.115303 cos_to_last_merge=0.9984 (last merge round=39)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9964147946038269, 'loss_val': 0.027691633041103374, 'psi': 0.9952833819205673}-{'f1_val': 0.9945291067983943, 'auprc': 0.9963932031169443, 'loss_val': 0.027101529509158572, 'psi': 0.9952747453258144}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=57 head_norm_before_train=1.665020 cos_to_last_merge=0.9726 (last merge round=35)
[S11] round=57 local utility u=0.000729 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986272421431857, 'loss_val': 0.027453684678904564, 'psi': 0.9971311018052599}-{'f1_val': 0.996305167468861, 'auprc': 0.9981576993321093, 'loss_val': 0.028531036540431175, 'psi': 0.9970461802141604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=57 head_norm_before_train=2.097068 (no previous merge yet)
[S13] round=57 local utility u=0.463167 metrics={'f1_val': 0.732319385401272, 'auprc': 0.7142953817619617, 'loss_val': 1.1675030801037276, 'psi': 0.7251097839455478}-{'f1_val': 0.6538469771306532, 'auprc': 0.6447132656301556, 'loss_val': 1.41425695967232, 'psi': 0.6501934925304542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=57 head_norm_before_train=1.646546 cos_to_last_merge=0.9958 (last merge round=42)
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9961057239562078, 'auprc': 0.9990258418110239, 'loss_val': 0.034080285711700777, 'psi': 0.9972737710981342}-{'f1_val': 0.9969788439352044, 'auprc': 0.9986687948512507, 'loss_val': 0.03377589901629149, 'psi': 0.9976548243016229}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=57 head_norm_before_train=1.794670 cos_to_last_merge=0.9917 (last merge round=42)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.8999464404096108, 'auprc': 0.8712378440751168, 'loss_val': 0.3678389203826659, 'psi': 0.8884630018758133}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970246174665298, 'loss_val': 0.02308702941039809, 'psi': 0.9968578480191242}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.673438 cos_to_last_merge=0.9962 (last merge round=42)
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.9385492537545468, 'auprc': 0.9863007001259441, 'loss_val': 0.2818042739005104, 'psi': 0.9576498323031057}-{'f1_val': 0.9481953933852607, 'auprc': 0.9923603316315815, 'loss_val': 0.14203184347568149, 'psi': 0.965861368683789}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=1.904891 cos_to_last_merge=0.9650 (last merge round=42)
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.6447924118012578, 'auprc': 0.7051850729816331, 'loss_val': 1.2238410413482863, 'psi': 0.668949476273408}-{'f1_val': 0.8326564394091774, 'auprc': 0.8978304543469159, 'loss_val': 0.7233717095076168, 'psi': 0.8587260453842729}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=58 head_norm_before_train=2.036931 cos_to_last_merge=0.7531 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.7205566596674691, 'auprc': 0.7141266589815285, 'loss_val': 1.1195820144040571, 'psi': 0.7179846593930929}-{'f1_val': 0.7213914234519476, 'auprc': 0.7170311883883556, 'loss_val': 1.1072069579880135, 'psi': 0.7196473294265108}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=2.212770 cos_to_last_merge=0.9986 (last merge round=43)
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.852863166796525, 'auprc': 0.985484523715557, 'loss_val': 0.23361026762201795, 'psi': 0.9059117095641378}-{'f1_val': 0.99392005828232, 'auprc': 0.997043158223289, 'loss_val': 0.06244281921369566, 'psi': 0.9951692982587076}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.765498 cos_to_last_merge=0.9928 (last merge round=41)
[S4] round=58 local utility u=0.001496 metrics={'f1_val': 0.9406286604185776, 'auprc': 0.9555124486600707, 'loss_val': 0.3480236792743406, 'psi': 0.9465821757151749}-{'f1_val': 0.9416579187582688, 'auprc': 0.950497454828981, 'loss_val': 0.3421458413175852, 'psi': 0.9451937331865536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=58 head_norm_before_train=1.670268 cos_to_last_merge=0.9562 (last merge round=38)
[S5] round=58 local utility u=0.000369 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.994764991742093, 'loss_val': 0.03429647135257306, 'psi': 0.9957932707809233}-{'f1_val': 0.9964787901401435, 'auprc': 0.994735091324816, 'loss_val': 0.034945201825587524, 'psi': 0.9957813106140124}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=58 head_norm_before_train=2.240670 (no previous merge yet)
[S6] round=58 local utility u=0.039359 metrics={'f1_val': 0.7951009868648584, 'auprc': 0.8739946492214743, 'loss_val': 0.7079425138165077, 'psi': 0.8266584518075049}-{'f1_val': 0.7654686343578279, 'auprc': 0.8695035199751847, 'loss_val': 0.595393309353169, 'psi': 0.8070825886047706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=58 head_norm_before_train=1.686642 cos_to_last_merge=0.9991 (last merge round=43)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.6185496992182302, 'auprc': 0.7991918090588858, 'loss_val': 0.6004198825181878, 'psi': 0.6908065431544924}-{'f1_val': 0.6388584932688185, 'auprc': 0.8059020756308175, 'loss_val': 0.48800884509061915, 'psi': 0.7056759262136181}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=2.211009 cos_to_last_merge=0.9982 (last merge round=42)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9530113861179942, 'auprc': 0.999342781292321, 'loss_val': 0.11060935174549757, 'psi': 0.9715439441877249}-{'f1_val': 0.9917244887003366, 'auprc': 0.99955622009259, 'loss_val': 0.02909833862773779, 'psi': 0.994857181257238}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=2.208625 (no previous merge yet)
[S9] round=58 local utility u=0.000525 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9987737968205112, 'loss_val': 0.01768374640397734, 'psi': 0.9978130255374482}-{'f1_val': 0.9971725113487396, 'auprc': 0.998682728538832, 'loss_val': 0.01846009353023269, 'psi': 0.9977765982247766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=58 head_norm_before_train=2.121828 cos_to_last_merge=0.9983 (last merge round=39)
[S10] round=58 local utility u=0.000428 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.99658443951422, 'loss_val': 0.027343887193724624, 'psi': 0.9953512398847246}-{'f1_val': 0.9945291067983943, 'auprc': 0.9964147946038269, 'loss_val': 0.027691633041103374, 'psi': 0.9952833819205673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=58 head_norm_before_train=1.671916 cos_to_last_merge=0.9720 (last merge round=35)
[S11] round=58 local utility u=0.001660 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9986343090550306, 'loss_val': 0.025605692474113536, 'psi': 0.9972789557674627}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986272421431857, 'loss_val': 0.027453684678904564, 'psi': 0.9971311018052599}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=58 head_norm_before_train=2.099952 (no previous merge yet)
[S13] round=58 local utility u=0.051087 metrics={'f1_val': 0.7363068950230374, 'auprc': 0.7284044865949432, 'loss_val': 1.1315812615326528, 'psi': 0.7331459316517996}-{'f1_val': 0.732319385401272, 'auprc': 0.7142953817619617, 'loss_val': 1.1675030801037276, 'psi': 0.7251097839455478}
[S13] not sending this round → trigger blocked (psi=0.733)
[S14] START round=58 head_norm_before_train=1.655532 cos_to_last_merge=0.9955 (last merge round=42)
[S14] round=58 local utility u=0.002400 metrics={'f1_val': 0.9965155232876948, 'auprc': 0.9990418428471362, 'loss_val': 0.03178795938286428, 'psi': 0.9975260511114713}-{'f1_val': 0.9961057239562078, 'auprc': 0.9990258418110239, 'loss_val': 0.034080285711700777, 'psi': 0.9972737710981342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=58 head_norm_before_train=1.805708 cos_to_last_merge=0.9912 (last merge round=42)
[S15] round=58 local utility u=0.478994 metrics={'f1_val': 0.9519440747136492, 'auprc': 0.9979170286835009, 'loss_val': 0.10187470593519063, 'psi': 0.9703332563015898}-{'f1_val': 0.8999464404096108, 'auprc': 0.8712378440751168, 'loss_val': 0.3678389203826659, 'psi': 0.8884630018758133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=58 head_norm_before_train=1.680868 cos_to_last_merge=0.9959 (last merge round=42)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.8937799263179199, 'auprc': 0.9828758719332077, 'loss_val': 0.4892955801701293, 'psi': 0.929418304564035}-{'f1_val': 0.9385492537545468, 'auprc': 0.9863007001259441, 'loss_val': 0.2818042739005104, 'psi': 0.9576498323031057}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=1.915034 cos_to_last_merge=0.9640 (last merge round=42)
[S17] round=58 local utility u=1.000000 metrics={'f1_val': 0.8274368970608321, 'auprc': 0.8892885066049784, 'loss_val': 0.503896544641822, 'psi': 0.8521775408784906}-{'f1_val': 0.6447924118012578, 'auprc': 0.7051850729816331, 'loss_val': 1.2238410413482863, 'psi': 0.668949476273408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=59 head_norm_before_train=2.037666 cos_to_last_merge=0.7532 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=59 local utility u=0.004195 metrics={'f1_val': 0.7194332271788366, 'auprc': 0.7145701233996298, 'loss_val': 1.1057810534999013, 'psi': 0.7174879856671539}-{'f1_val': 0.7205566596674691, 'auprc': 0.7141266589815285, 'loss_val': 1.1195820144040571, 'psi': 0.7179846593930929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S2] r=60 psi=0.717 u=0.0042 p_local=0.0828 f1=0.719 auprc=0.715 bytes=45034
[S3] START round=59 head_norm_before_train=2.217531 cos_to_last_merge=0.9985 (last merge round=43)
[S3] round=59 local utility u=0.312081 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9577200077035384, 'loss_val': 0.1728835464730422, 'psi': 0.9594787419663806}-{'f1_val': 0.852863166796525, 'auprc': 0.985484523715557, 'loss_val': 0.23361026762201795, 'psi': 0.9059117095641378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=60 psi=0.959 u=0.3121 p_local=0.0971 f1=0.961 auprc=0.958 bytes=50385
[S4] START round=59 head_norm_before_train=1.774292 cos_to_last_merge=0.9924 (last merge round=41)
[S4] round=59 local utility u=0.012582 metrics={'f1_val': 0.9415033731576101, 'auprc': 0.9610711547498203, 'loss_val': 0.34478366512718844, 'psi': 0.9493304857944942}-{'f1_val': 0.9406286604185776, 'auprc': 0.9555124486600707, 'loss_val': 0.3480236792743406, 'psi': 0.9465821757151749}
[S4] not sending this round → trigger blocked (psi=0.949)
[S4] r=60 psi=0.949 u=0.0126 p_local=0.0087 f1=0.942 auprc=0.961 bytes=45014
[S5] START round=59 head_norm_before_train=1.683415 cos_to_last_merge=0.9547 (last merge round=38)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9918554206489038, 'loss_val': 0.04169250113584272, 'psi': 0.9946294423436476}-{'f1_val': 0.9964787901401435, 'auprc': 0.994764991742093, 'loss_val': 0.03429647135257306, 'psi': 0.9957932707809233}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.995 u=0.0000 p_local=0.0048 f1=0.996 auprc=0.992 bytes=43185
[S6] START round=59 head_norm_before_train=2.253107 (no previous merge yet)
[S6] round=59 local utility u=0.272020 metrics={'f1_val': 0.8281553868874669, 'auprc': 0.9427592816235532, 'loss_val': 0.5685220454186866, 'psi': 0.8739969447819014}-{'f1_val': 0.7951009868648584, 'auprc': 0.8739946492214743, 'loss_val': 0.7079425138165077, 'psi': 0.8266584518075049}
[S6] not sending this round → trigger blocked (psi=0.874)
[S6] r=60 psi=0.874 u=0.2720 p_local=0.3361 f1=0.828 auprc=0.943 bytes=48543
[S7] START round=59 head_norm_before_train=1.691988 cos_to_last_merge=0.9989 (last merge round=43)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.5985723663262014, 'auprc': 0.7952104836692065, 'loss_val': 0.7718319122525092, 'psi': 0.6772276132634034}-{'f1_val': 0.6185496992182302, 'auprc': 0.7991918090588858, 'loss_val': 0.6004198825181878, 'psi': 0.6908065431544924}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.677 u=0.0000 p_local=0.1255 f1=0.599 auprc=0.795 bytes=48580
[S8] START round=59 head_norm_before_train=2.216878 cos_to_last_merge=0.9979 (last merge round=42)
[S8] round=59 local utility u=0.149291 metrics={'f1_val': 0.9893766104424556, 'auprc': 0.9995728301679963, 'loss_val': 0.03090823011954613, 'psi': 0.9934550983326719}-{'f1_val': 0.9530113861179942, 'auprc': 0.999342781292321, 'loss_val': 0.11060935174549757, 'psi': 0.9715439441877249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] r=60 psi=0.993 u=0.1493 p_local=0.0827 f1=0.989 auprc=1.000 bytes=44976
[S9] START round=59 head_norm_before_train=2.216156 (no previous merge yet)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9954888642046869, 'loss_val': 0.018032892513178047, 'psi': 0.9962264245231331}-{'f1_val': 0.9971725113487396, 'auprc': 0.9987737968205112, 'loss_val': 0.01768374640397734, 'psi': 0.9978130255374482}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.996 u=0.0000 p_local=0.0021 f1=0.997 auprc=0.995 bytes=46765
[S10] START round=59 head_norm_before_train=2.129600 cos_to_last_merge=0.9983 (last merge round=39)
[S10] round=59 local utility u=0.001055 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9962262471757397, 'loss_val': 0.026793528223295626, 'psi': 0.9954714107893416}-{'f1_val': 0.9945291067983943, 'auprc': 0.99658443951422, 'loss_val': 0.027343887193724624, 'psi': 0.9953512398847246}
[S10] not sending this round → trigger blocked (psi=0.995)
[S10] r=60 psi=0.995 u=0.0011 p_local=0.0005 f1=0.995 auprc=0.996 bytes=44960
[S11] START round=59 head_norm_before_train=1.679804 cos_to_last_merge=0.9712 (last merge round=35)
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985491376014084, 'loss_val': 0.026643122994579056, 'psi': 0.997099859988549}-{'f1_val': 0.9963753869090841, 'auprc': 0.9986343090550306, 'loss_val': 0.025605692474113536, 'psi': 0.9972789557674627}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.997 u=0.0000 p_local=0.0028 f1=0.996 auprc=0.999 bytes=52145
[S13] START round=59 head_norm_before_train=2.097184 (no previous merge yet)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6180332050915034, 'auprc': 0.6429604400311678, 'loss_val': 1.489950725435345, 'psi': 0.6280040990673692}-{'f1_val': 0.7363068950230374, 'auprc': 0.7284044865949432, 'loss_val': 1.1315812615326528, 'psi': 0.7331459316517996}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.628 u=0.0000 p_local=0.1048 f1=0.618 auprc=0.643 bytes=43226
[S14] START round=59 head_norm_before_train=1.665179 cos_to_last_merge=0.9952 (last merge round=42)
[S14] round=59 local utility u=0.001291 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9990450590140607, 'loss_val': 0.030518277470674947, 'psi': 0.9976575381050208}-{'f1_val': 0.9965155232876948, 'auprc': 0.9990418428471362, 'loss_val': 0.03178795938286428, 'psi': 0.9975260511114713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=60 psi=0.998 u=0.0013 p_local=0.0183 f1=0.997 auprc=0.999 bytes=53920
[S15] START round=59 head_norm_before_train=1.815846 cos_to_last_merge=0.9907 (last merge round=42)
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.9016001089992542, 'auprc': 0.928939827503307, 'loss_val': 0.34040148783022756, 'psi': 0.9125359964008753}-{'f1_val': 0.9519440747136492, 'auprc': 0.9979170286835009, 'loss_val': 0.10187470593519063, 'psi': 0.9703332563015898}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.913 u=0.0000 p_local=0.1553 f1=0.902 auprc=0.929 bytes=43169
[S16] START round=59 head_norm_before_train=1.684970 cos_to_last_merge=0.9956 (last merge round=42)
[S16] round=59 local utility u=0.514367 metrics={'f1_val': 0.9904832560526668, 'auprc': 0.9856654049480321, 'loss_val': 0.04914923348441717, 'psi': 0.9885561156108129}-{'f1_val': 0.8937799263179199, 'auprc': 0.9828758719332077, 'loss_val': 0.4892955801701293, 'psi': 0.929418304564035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S16] r=60 psi=0.989 u=0.5144 p_local=0.1373 f1=0.990 auprc=0.986 bytes=48534
[S17] START round=59 head_norm_before_train=1.922513 cos_to_last_merge=0.9633 (last merge round=42)
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6418285474723432, 'auprc': 0.7049071671069842, 'loss_val': 1.3007883679163939, 'psi': 0.6670599953261995}-{'f1_val': 0.8274368970608321, 'auprc': 0.8892885066049784, 'loss_val': 0.503896544641822, 'psi': 0.8521775408784906}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.667 u=0.0000 p_local=0.3090 f1=0.642 auprc=0.705 bytes=37829
[S2] START round=60 head_norm_before_train=2.040410 cos_to_last_merge=0.7529 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=60 local utility u=0.035733 metrics={'f1_val': 0.7206639238528042, 'auprc': 0.7168590497921831, 'loss_val': 1.048565136062799, 'psi': 0.7191419742285557}-{'f1_val': 0.7194332271788366, 'auprc': 0.7145701233996298, 'loss_val': 1.1057810534999013, 'psi': 0.7174879856671539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=60 head_norm_before_train=2.223670 cos_to_last_merge=0.9984 (last merge round=43)
[S3] round=60 local utility u=0.081572 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9960273914294062, 'loss_val': 0.12696584228129312, 'psi': 0.9750321072350286}-{'f1_val': 0.960651231474942, 'auprc': 0.9577200077035384, 'loss_val': 0.1728835464730422, 'psi': 0.9594787419663806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=60 head_norm_before_train=1.786825 cos_to_last_merge=0.9920 (last merge round=41)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9422287623737955, 'auprc': 0.9525938576132732, 'loss_val': 0.34528013230814325, 'psi': 0.9463748004695867}-{'f1_val': 0.9415033731576101, 'auprc': 0.9610711547498203, 'loss_val': 0.34478366512718844, 'psi': 0.9493304857944942}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.693907 cos_to_last_merge=0.9536 (last merge round=38)
[S5] round=60 local utility u=0.013890 metrics={'f1_val': 0.9966253574528599, 'auprc': 0.998173332944994, 'loss_val': 0.03374504992219056, 'psi': 0.9972445476497135}-{'f1_val': 0.9964787901401435, 'auprc': 0.9918554206489038, 'loss_val': 0.04169250113584272, 'psi': 0.9946294423436476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=60 head_norm_before_train=2.266820 (no previous merge yet)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.8300706113018794, 'auprc': 0.9341428202070026, 'loss_val': 0.612260049120325, 'psi': 0.8716994948639287}-{'f1_val': 0.8281553868874669, 'auprc': 0.9427592816235532, 'loss_val': 0.5685220454186866, 'psi': 0.8739969447819014}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.697970 cos_to_last_merge=0.9988 (last merge round=43)
[S7] round=60 local utility u=0.536128 metrics={'f1_val': 0.679729174557652, 'auprc': 0.8392395836465308, 'loss_val': 0.3186033830712812, 'psi': 0.7435333381932036}-{'f1_val': 0.5985723663262014, 'auprc': 0.7952104836692065, 'loss_val': 0.7718319122525092, 'psi': 0.6772276132634034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=60 head_norm_before_train=2.224971 cos_to_last_merge=0.9978 (last merge round=42)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9340478869905773, 'auprc': 0.9993307571066619, 'loss_val': 0.1345227908986617, 'psi': 0.9601610350370111}-{'f1_val': 0.9893766104424556, 'auprc': 0.9995728301679963, 'loss_val': 0.03090823011954613, 'psi': 0.9934550983326719}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=2.223351 (no previous merge yet)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9965405347871763, 'auprc': 0.9940852505650605, 'loss_val': 0.017822005029435168, 'psi': 0.9955584210983299}-{'f1_val': 0.9967181314020974, 'auprc': 0.9954888642046869, 'loss_val': 0.018032892513178047, 'psi': 0.9962264245231331}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=2.132385 cos_to_last_merge=0.9981 (last merge round=39)
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9958764865664294, 'loss_val': 0.026733874542475916, 'psi': 0.9953315065456174}-{'f1_val': 0.9949681865317428, 'auprc': 0.9962262471757397, 'loss_val': 0.026793528223295626, 'psi': 0.9954714107893416}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=1.688641 cos_to_last_merge=0.9704 (last merge round=35)
[S11] round=60 local utility u=0.000476 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986241781391494, 'loss_val': 0.025916053625327767, 'psi': 0.9971298762036453}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985491376014084, 'loss_val': 0.026643122994579056, 'psi': 0.997099859988549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=60 head_norm_before_train=2.100613 (no previous merge yet)
[S13] round=60 local utility u=0.033205 metrics={'f1_val': 0.6260862453120489, 'auprc': 0.6503219632433624, 'loss_val': 1.493943061802499, 'psi': 0.6357805324845743}-{'f1_val': 0.6180332050915034, 'auprc': 0.6429604400311678, 'loss_val': 1.489950725435345, 'psi': 0.6280040990673692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=60 head_norm_before_train=1.672416 cos_to_last_merge=0.9948 (last merge round=42)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9965123182311155, 'auprc': 0.9990412903832506, 'loss_val': 0.029795572339859314, 'psi': 0.9975239070919696}-{'f1_val': 0.9967325241656609, 'auprc': 0.9990450590140607, 'loss_val': 0.030518277470674947, 'psi': 0.9976575381050208}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.822370 cos_to_last_merge=0.9904 (last merge round=42)
[S15] round=60 local utility u=0.165347 metrics={'f1_val': 0.9043289571245133, 'auprc': 0.9971096806925571, 'loss_val': 0.23058955366273307, 'psi': 0.9414412465517309}-{'f1_val': 0.9016001089992542, 'auprc': 0.928939827503307, 'loss_val': 0.34040148783022756, 'psi': 0.9125359964008753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=60 head_norm_before_train=1.690316 cos_to_last_merge=0.9952 (last merge round=42)
[S16] round=60 local utility u=0.009416 metrics={'f1_val': 0.991703024727855, 'auprc': 0.9884445212093022, 'loss_val': 0.04597328849639534, 'psi': 0.990399623320434}-{'f1_val': 0.9904832560526668, 'auprc': 0.9856654049480321, 'loss_val': 0.04914923348441717, 'psi': 0.9885561156108129}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=60 head_norm_before_train=1.932148 cos_to_last_merge=0.9625 (last merge round=42)
[S17] round=60 local utility u=0.724801 metrics={'f1_val': 0.7526134059242671, 'auprc': 0.7904803594390026, 'loss_val': 0.772615418366746, 'psi': 0.7677601873301613}-{'f1_val': 0.6418285474723432, 'auprc': 0.7049071671069842, 'loss_val': 1.3007883679163939, 'psi': 0.6670599953261995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=61 head_norm_before_train=2.041205 cos_to_last_merge=0.7528 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7209081847924166, 'auprc': 0.7112825456761042, 'loss_val': 1.0872096551577994, 'psi': 0.7170579291458916}-{'f1_val': 0.7206639238528042, 'auprc': 0.7168590497921831, 'loss_val': 1.048565136062799, 'psi': 0.7191419742285557}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.230511 cos_to_last_merge=0.9982 (last merge round=43)
[S3] round=61 local utility u=0.012817 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9980193647818554, 'loss_val': 0.10730764544369496, 'psi': 0.9758288965760082}-{'f1_val': 0.9610352511054436, 'auprc': 0.9960273914294062, 'loss_val': 0.12696584228129312, 'psi': 0.9750321072350286}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=61 head_norm_before_train=1.795819 cos_to_last_merge=0.9918 (last merge round=41)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.941624914000216, 'auprc': 0.9492901073073046, 'loss_val': 0.35255524281809886, 'psi': 0.9446909913230513}-{'f1_val': 0.9422287623737955, 'auprc': 0.9525938576132732, 'loss_val': 0.34528013230814325, 'psi': 0.9463748004695867}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.702950 cos_to_last_merge=0.9524 (last merge round=38)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9982058346018057, 'loss_val': 0.0331344623660066, 'psi': 0.9971696079248084}-{'f1_val': 0.9966253574528599, 'auprc': 0.998173332944994, 'loss_val': 0.03374504992219056, 'psi': 0.9972445476497135}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=2.276248 (no previous merge yet)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.580261274608678, 'auprc': 0.8136317202552092, 'loss_val': 1.2773659346595114, 'psi': 0.6736094528672905}-{'f1_val': 0.8300706113018794, 'auprc': 0.9341428202070026, 'loss_val': 0.612260049120325, 'psi': 0.8716994948639287}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.704017 cos_to_last_merge=0.9988 (last merge round=43)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.6070370440007993, 'auprc': 0.7964828820488461, 'loss_val': 0.6768930934415046, 'psi': 0.682815379220018}-{'f1_val': 0.679729174557652, 'auprc': 0.8392395836465308, 'loss_val': 0.3186033830712812, 'psi': 0.7435333381932036}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=2.230348 cos_to_last_merge=0.9975 (last merge round=42)
[S8] round=61 local utility u=0.225662 metrics={'f1_val': 0.9915452129742699, 'auprc': 0.9996238402102092, 'loss_val': 0.02906105740560692, 'psi': 0.9947766638686456}-{'f1_val': 0.9340478869905773, 'auprc': 0.9993307571066619, 'loss_val': 0.1345227908986617, 'psi': 0.9601610350370111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=61 head_norm_before_train=2.230397 (no previous merge yet)
[S9] round=61 local utility u=0.007470 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9984336886215931, 'loss_val': 0.019719280183401484, 'psi': 0.997676982257881}-{'f1_val': 0.9965405347871763, 'auprc': 0.9940852505650605, 'loss_val': 0.017822005029435168, 'psi': 0.9955584210983299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=61 head_norm_before_train=2.137906 cos_to_last_merge=0.9979 (last merge round=39)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9963389945846945, 'loss_val': 0.027669046174654932, 'psi': 0.9952530619129144}-{'f1_val': 0.9949681865317428, 'auprc': 0.9958764865664294, 'loss_val': 0.026733874542475916, 'psi': 0.9953315065456174}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=1.696998 cos_to_last_merge=0.9696 (last merge round=35)
[S11] round=61 local utility u=0.000785 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998627904548542, 'loss_val': 0.024357498507860623, 'psi': 0.9971313667674024}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986241781391494, 'loss_val': 0.025916053625327767, 'psi': 0.9971298762036453}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=61 head_norm_before_train=2.108294 (no previous merge yet)
[S13] round=61 local utility u=0.105739 metrics={'f1_val': 0.6495013155514927, 'auprc': 0.6653590714726788, 'loss_val': 1.4680664348848682, 'psi': 0.6558444179199672}-{'f1_val': 0.6260862453120489, 'auprc': 0.6503219632433624, 'loss_val': 1.493943061802499, 'psi': 0.6357805324845743}
[S13] not sending this round → trigger blocked (psi=0.656)
[S14] START round=61 head_norm_before_train=1.680952 cos_to_last_merge=0.9944 (last merge round=42)
[S14] round=61 local utility u=0.001028 metrics={'f1_val': 0.996920339792768, 'auprc': 0.9990434288722642, 'loss_val': 0.030193858773954776, 'psi': 0.9977695754245663}-{'f1_val': 0.9965123182311155, 'auprc': 0.9990412903832506, 'loss_val': 0.029795572339859314, 'psi': 0.9975239070919696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=61 head_norm_before_train=1.829294 cos_to_last_merge=0.9900 (last merge round=42)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.8143934260102134, 'auprc': 0.8182511912763348, 'loss_val': 0.4884171777474146, 'psi': 0.815936532116662}-{'f1_val': 0.9043289571245133, 'auprc': 0.9971096806925571, 'loss_val': 0.23058955366273307, 'psi': 0.9414412465517309}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.695888 cos_to_last_merge=0.9948 (last merge round=42)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.9900013290715174, 'auprc': 0.9839013329915158, 'loss_val': 0.056005500194550265, 'psi': 0.9875613306395168}-{'f1_val': 0.991703024727855, 'auprc': 0.9884445212093022, 'loss_val': 0.04597328849639534, 'psi': 0.990399623320434}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=1.940351 cos_to_last_merge=0.9617 (last merge round=42)
[S17] round=61 local utility u=0.064136 metrics={'f1_val': 0.7871036441970297, 'auprc': 0.7768728420208263, 'loss_val': 0.8104625147028174, 'psi': 0.7830113233265483}-{'f1_val': 0.7526134059242671, 'auprc': 0.7904803594390026, 'loss_val': 0.772615418366746, 'psi': 0.7677601873301613}
[S17] not sending this round → trigger blocked (psi=0.783)
[S2] START round=62 head_norm_before_train=2.045945 cos_to_last_merge=0.7524 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.7218076952396743, 'auprc': 0.7071765205502023, 'loss_val': 1.0862427220523732, 'psi': 0.7159552253638855}-{'f1_val': 0.7209081847924166, 'auprc': 0.7112825456761042, 'loss_val': 1.0872096551577994, 'psi': 0.7170579291458916}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=2.237380 cos_to_last_merge=0.9980 (last merge round=43)
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9975739281793397, 'loss_val': 0.11431248084258785, 'psi': 0.975650721935002}-{'f1_val': 0.9610352511054436, 'auprc': 0.9980193647818554, 'loss_val': 0.10730764544369496, 'psi': 0.9758288965760082}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.802219 cos_to_last_merge=0.9918 (last merge round=41)
[S4] round=62 local utility u=0.025420 metrics={'f1_val': 0.9483764162796946, 'auprc': 0.9502988081892103, 'loss_val': 0.3452495768224823, 'psi': 0.9491453730435009}-{'f1_val': 0.941624914000216, 'auprc': 0.9492901073073046, 'loss_val': 0.35255524281809886, 'psi': 0.9446909913230513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=62 head_norm_before_train=1.711421 cos_to_last_merge=0.9513 (last merge round=38)
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9949399823326442, 'loss_val': 0.03187422838520992, 'psi': 0.9958632670171438}-{'f1_val': 0.9964787901401435, 'auprc': 0.9982058346018057, 'loss_val': 0.0331344623660066, 'psi': 0.9971696079248084}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=2.286048 (no previous merge yet)
[S6] round=62 local utility u=0.022984 metrics={'f1_val': 0.6350788638447762, 'auprc': 0.735101990740598, 'loss_val': 1.3247136576893963, 'psi': 0.6750881146031049}-{'f1_val': 0.580261274608678, 'auprc': 0.8136317202552092, 'loss_val': 1.2773659346595114, 'psi': 0.6736094528672905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=62 head_norm_before_train=1.708822 cos_to_last_merge=0.9986 (last merge round=43)
[S7] round=62 local utility u=0.320976 metrics={'f1_val': 0.657863614077319, 'auprc': 0.8140673361043502, 'loss_val': 0.3926548563876718, 'psi': 0.7203451028881315}-{'f1_val': 0.6070370440007993, 'auprc': 0.7964828820488461, 'loss_val': 0.6768930934415046, 'psi': 0.682815379220018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=62 head_norm_before_train=2.237785 cos_to_last_merge=0.9973 (last merge round=42)
[S8] round=62 local utility u=0.003637 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9996627333239544, 'loss_val': 0.027341479648034885, 'psi': 0.995336025600923}-{'f1_val': 0.9915452129742699, 'auprc': 0.9996238402102092, 'loss_val': 0.02906105740560692, 'psi': 0.9947766638686456}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=62 head_norm_before_train=2.234884 (no previous merge yet)
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9967582493480517, 'auprc': 0.9984266148989279, 'loss_val': 0.022679374080579445, 'psi': 0.9974255955684022}-{'f1_val': 0.9971725113487396, 'auprc': 0.9984336886215931, 'loss_val': 0.019719280183401484, 'psi': 0.997676982257881}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=2.139401 cos_to_last_merge=0.9976 (last merge round=39)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9958845243107914, 'loss_val': 0.02713159838169379, 'psi': 0.9950712738033531}-{'f1_val': 0.9945291067983943, 'auprc': 0.9963389945846945, 'loss_val': 0.027669046174654932, 'psi': 0.9952530619129144}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=1.703963 cos_to_last_merge=0.9689 (last merge round=35)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986318651358407, 'loss_val': 0.024830311603752653, 'psi': 0.9971329510023219}-{'f1_val': 0.9961336749133093, 'auprc': 0.998627904548542, 'loss_val': 0.024357498507860623, 'psi': 0.9971313667674024}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=2.119272 (no previous merge yet)
[S13] round=62 local utility u=0.580544 metrics={'f1_val': 0.7587998498624969, 'auprc': 0.7216378376708411, 'loss_val': 1.1316065860094142, 'psi': 0.7439350449858346}-{'f1_val': 0.6495013155514927, 'auprc': 0.6653590714726788, 'loss_val': 1.4680664348848682, 'psi': 0.6558444179199672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=62 head_norm_before_train=1.689149 cos_to_last_merge=0.9941 (last merge round=42)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9405761367644887, 'auprc': 0.9967865770252529, 'loss_val': 0.137731134809337, 'psi': 0.9630603128687943}-{'f1_val': 0.996920339792768, 'auprc': 0.9990434288722642, 'loss_val': 0.030193858773954776, 'psi': 0.9977695754245663}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.835524 cos_to_last_merge=0.9897 (last merge round=42)
[S15] round=62 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9968151773940599, 'loss_val': 0.022088256487894333, 'psi': 0.9967740719901363}-{'f1_val': 0.8143934260102134, 'auprc': 0.8182511912763348, 'loss_val': 0.4884171777474146, 'psi': 0.815936532116662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=62 head_norm_before_train=1.702744 cos_to_last_merge=0.9945 (last merge round=42)
[S16] round=62 local utility u=0.015071 metrics={'f1_val': 0.991990432657946, 'auprc': 0.9857175644372176, 'loss_val': 0.04324587623968719, 'psi': 0.9894812853696546}-{'f1_val': 0.9900013290715174, 'auprc': 0.9839013329915158, 'loss_val': 0.056005500194550265, 'psi': 0.9875613306395168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=62 head_norm_before_train=1.945760 cos_to_last_merge=0.9608 (last merge round=42)
[S17] round=62 local utility u=0.894831 metrics={'f1_val': 0.8978026428945441, 'auprc': 0.9858482408098858, 'loss_val': 0.31192116774163164, 'psi': 0.9330208820606807}-{'f1_val': 0.7871036441970297, 'auprc': 0.7768728420208263, 'loss_val': 0.8104625147028174, 'psi': 0.7830113233265483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=63 head_norm_before_train=2.046245 cos_to_last_merge=0.7524 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.7198823323381369, 'auprc': 0.7031007316480737, 'loss_val': 1.0858148858564707, 'psi': 0.7131696920621117}-{'f1_val': 0.7218076952396743, 'auprc': 0.7071765205502023, 'loss_val': 1.0862427220523732, 'psi': 0.7159552253638855}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=2.243922 cos_to_last_merge=0.9979 (last merge round=43)
[S3] round=63 local utility u=0.045762 metrics={'f1_val': 0.9692731806453452, 'auprc': 0.9988961124840456, 'loss_val': 0.07618258612903, 'psi': 0.9811223533808253}-{'f1_val': 0.9610352511054436, 'auprc': 0.9975739281793397, 'loss_val': 0.11431248084258785, 'psi': 0.975650721935002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=63 head_norm_before_train=1.801472 cos_to_last_merge=0.9914 (last merge round=41)
[S4] round=63 local utility u=0.006357 metrics={'f1_val': 0.9429574691834586, 'auprc': 0.963679531000158, 'loss_val': 0.34016426429912194, 'psi': 0.9512462939101384}-{'f1_val': 0.9483764162796946, 'auprc': 0.9502988081892103, 'loss_val': 0.3452495768224823, 'psi': 0.9491453730435009}
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] START round=63 head_norm_before_train=1.721207 cos_to_last_merge=0.9500 (last merge round=38)
[S5] round=63 local utility u=0.004970 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9979715528147683, 'loss_val': 0.031029524193698456, 'psi': 0.9970758952099934}-{'f1_val': 0.9964787901401435, 'auprc': 0.9949399823326442, 'loss_val': 0.03187422838520992, 'psi': 0.9958632670171438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=63 head_norm_before_train=2.295652 (no previous merge yet)
[S6] round=63 local utility u=0.386838 metrics={'f1_val': 0.6782555667393511, 'auprc': 0.837071797010079, 'loss_val': 1.1160081766028143, 'psi': 0.7417820588476423}-{'f1_val': 0.6350788638447762, 'auprc': 0.735101990740598, 'loss_val': 1.3247136576893963, 'psi': 0.6750881146031049}
[S6] not sending this round → trigger blocked (psi=0.742)
[S7] START round=63 head_norm_before_train=1.713338 cos_to_last_merge=0.9985 (last merge round=43)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.6254906880099667, 'auprc': 0.7983260288438759, 'loss_val': 0.7147237402985875, 'psi': 0.6946248243435303}-{'f1_val': 0.657863614077319, 'auprc': 0.8140673361043502, 'loss_val': 0.3926548563876718, 'psi': 0.7203451028881315}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=2.245788 cos_to_last_merge=0.9971 (last merge round=42)
[S8] round=63 local utility u=0.008097 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.999141448435823, 'loss_val': 0.02388440266081536, 'psi': 0.9965575499210712}-{'f1_val': 0.9924515537855688, 'auprc': 0.9996627333239544, 'loss_val': 0.027341479648034885, 'psi': 0.995336025600923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=63 head_norm_before_train=2.240158 (no previous merge yet)
[S9] round=63 local utility u=0.003674 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9987214530121126, 'loss_val': 0.01870191158700965, 'psi': 0.9977920880140887}-{'f1_val': 0.9967582493480517, 'auprc': 0.9984266148989279, 'loss_val': 0.022679374080579445, 'psi': 0.9974255955684022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=63 head_norm_before_train=2.143023 cos_to_last_merge=0.9973 (last merge round=39)
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955376713062626, 'loss_val': 0.027159751000628434, 'psi': 0.9949325326015417}-{'f1_val': 0.9945291067983943, 'auprc': 0.9958845243107914, 'loss_val': 0.02713159838169379, 'psi': 0.9950712738033531}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=1.711593 cos_to_last_merge=0.9682 (last merge round=35)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985410218652842, 'loss_val': 0.026253088474963607, 'psi': 0.9970966136940993}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986318651358407, 'loss_val': 0.024830311603752653, 'psi': 0.9971329510023219}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=2.126947 (no previous merge yet)
[S13] round=63 local utility u=0.000000 metrics={'f1_val': 0.6467893243488552, 'auprc': 0.783811413947396, 'loss_val': 1.4405687091411181, 'psi': 0.7015981601882715}-{'f1_val': 0.7587998498624969, 'auprc': 0.7216378376708411, 'loss_val': 1.1316065860094142, 'psi': 0.7439350449858346}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=63 head_norm_before_train=1.696827 cos_to_last_merge=0.9938 (last merge round=42)
[S14] round=63 local utility u=0.213482 metrics={'f1_val': 0.9942299548204913, 'auprc': 0.9973418956692466, 'loss_val': 0.03435578616723728, 'psi': 0.9954747311599934}-{'f1_val': 0.9405761367644887, 'auprc': 0.9967865770252529, 'loss_val': 0.137731134809337, 'psi': 0.9630603128687943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=63 head_norm_before_train=1.841810 cos_to_last_merge=0.9894 (last merge round=42)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.8971279715291052, 'auprc': 0.8240176163423981, 'loss_val': 0.3790888885246544, 'psi': 0.8678838294544223}-{'f1_val': 0.9967466683875206, 'auprc': 0.9968151773940599, 'loss_val': 0.022088256487894333, 'psi': 0.9967740719901363}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.708999 cos_to_last_merge=0.9942 (last merge round=42)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9910717993343138, 'auprc': 0.9830985135516688, 'loss_val': 0.05008044960183597, 'psi': 0.9878824850212558}-{'f1_val': 0.991990432657946, 'auprc': 0.9857175644372176, 'loss_val': 0.04324587623968719, 'psi': 0.9894812853696546}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=1.955251 cos_to_last_merge=0.9598 (last merge round=42)
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.8105870870844459, 'auprc': 0.7411445741306455, 'loss_val': 0.8173962370452467, 'psi': 0.7828100819029258}-{'f1_val': 0.8978026428945441, 'auprc': 0.9858482408098858, 'loss_val': 0.31192116774163164, 'psi': 0.9330208820606807}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=2.045976 cos_to_last_merge=0.7524 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=64 local utility u=0.002814 metrics={'f1_val': 0.7194137648007268, 'auprc': 0.7012983210340982, 'loss_val': 1.0719673901086069, 'psi': 0.7121675872940754}-{'f1_val': 0.7198823323381369, 'auprc': 0.7031007316480737, 'loss_val': 1.0858148858564707, 'psi': 0.7131696920621117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=64 head_norm_before_train=2.250449 cos_to_last_merge=0.9977 (last merge round=43)
[S3] round=64 local utility u=0.110370 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9982523638201255, 'loss_val': 0.02226115558867267, 'psi': 0.9977398869956846}-{'f1_val': 0.9692731806453452, 'auprc': 0.9988961124840456, 'loss_val': 0.07618258612903, 'psi': 0.9811223533808253}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=64 head_norm_before_train=1.807243 cos_to_last_merge=0.9910 (last merge round=41)
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9399042068693442, 'auprc': 0.9557226115631892, 'loss_val': 0.3634636325125555, 'psi': 0.9462315687468822}-{'f1_val': 0.9429574691834586, 'auprc': 0.963679531000158, 'loss_val': 0.34016426429912194, 'psi': 0.9512462939101384}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.731214 cos_to_last_merge=0.9490 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9926796463714118, 'loss_val': 0.03559998872214918, 'psi': 0.9947834725341513}-{'f1_val': 0.9964787901401435, 'auprc': 0.9979715528147683, 'loss_val': 0.031029524193698456, 'psi': 0.9970758952099934}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=2.304049 (no previous merge yet)
[S6] round=64 local utility u=1.000000 metrics={'f1_val': 0.8302527157873475, 'auprc': 0.9539259209195485, 'loss_val': 0.35702559262100414, 'psi': 0.879721997840228}-{'f1_val': 0.6782555667393511, 'auprc': 0.837071797010079, 'loss_val': 1.1160081766028143, 'psi': 0.7417820588476423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=64 head_norm_before_train=1.719811 cos_to_last_merge=0.9984 (last merge round=43)
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.5858584278668585, 'auprc': 0.7912524363694772, 'loss_val': 0.9393480529504568, 'psi': 0.668016031267906}-{'f1_val': 0.6254906880099667, 'auprc': 0.7983260288438759, 'loss_val': 0.7147237402985875, 'psi': 0.6946248243435303}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=64 head_norm_before_train=2.251751 cos_to_last_merge=0.9967 (last merge round=42)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.6045686339659974, 'auprc': 0.9930588472785503, 'loss_val': 1.1158294925708199, 'psi': 0.7599647192910186}-{'f1_val': 0.9948349509112366, 'auprc': 0.999141448435823, 'loss_val': 0.02388440266081536, 'psi': 0.9965575499210712}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=2.247029 (no previous merge yet)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9965113446440821, 'auprc': 0.9969845965703974, 'loss_val': 0.01895998985662817, 'psi': 0.9967006454146082}-{'f1_val': 0.9971725113487396, 'auprc': 0.9987214530121126, 'loss_val': 0.01870191158700965, 'psi': 0.9977920880140887}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.146521 cos_to_last_merge=0.9970 (last merge round=39)
[S10] round=64 local utility u=0.000628 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995906901518364, 'loss_val': 0.027010924361885184, 'psi': 0.9950802246863822}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955376713062626, 'loss_val': 0.027159751000628434, 'psi': 0.9949325326015417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=64 head_norm_before_train=1.718249 cos_to_last_merge=0.9675 (last merge round=35)
[S11] round=64 local utility u=0.000391 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985360416213016, 'loss_val': 0.025455711276283297, 'psi': 0.9970946215965062}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985410218652842, 'loss_val': 0.026253088474963607, 'psi': 0.9970966136940993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=64 head_norm_before_train=2.133146 (no previous merge yet)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6569551902261475, 'auprc': 0.6934346133810775, 'loss_val': 1.3116883222180338, 'psi': 0.6715469594881194}-{'f1_val': 0.6467893243488552, 'auprc': 0.783811413947396, 'loss_val': 1.4405687091411181, 'psi': 0.7015981601882715}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=1.704767 cos_to_last_merge=0.9935 (last merge round=42)
[S14] round=64 local utility u=0.013991 metrics={'f1_val': 0.9971404074438908, 'auprc': 0.9990405930618065, 'loss_val': 0.02893239851179183, 'psi': 0.997900481691057}-{'f1_val': 0.9942299548204913, 'auprc': 0.9973418956692466, 'loss_val': 0.03435578616723728, 'psi': 0.9954747311599934}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=64 head_norm_before_train=1.850194 cos_to_last_merge=0.9890 (last merge round=42)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.8224832505311145, 'auprc': 0.9270718076975442, 'loss_val': 0.4123214033843212, 'psi': 0.8643186733976864}-{'f1_val': 0.8971279715291052, 'auprc': 0.8240176163423981, 'loss_val': 0.3790888885246544, 'psi': 0.8678838294544223}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=1.714827 cos_to_last_merge=0.9939 (last merge round=42)
[S16] round=64 local utility u=0.008792 metrics={'f1_val': 0.9915080504535831, 'auprc': 0.9857955616749843, 'loss_val': 0.04320518032087517, 'psi': 0.9892230549421437}-{'f1_val': 0.9910717993343138, 'auprc': 0.9830985135516688, 'loss_val': 0.05008044960183597, 'psi': 0.9878824850212558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=64 head_norm_before_train=1.965625 cos_to_last_merge=0.9588 (last merge round=42)
[S17] round=64 local utility u=0.176389 metrics={'f1_val': 0.8249750679558179, 'auprc': 0.8209838304577182, 'loss_val': 0.7904638048431364, 'psi': 0.823378572956578}-{'f1_val': 0.8105870870844459, 'auprc': 0.7411445741306455, 'loss_val': 0.8173962370452467, 'psi': 0.7828100819029258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=65 head_norm_before_train=2.051068 cos_to_last_merge=0.7521 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=65 local utility u=0.221168 metrics={'f1_val': 0.7173271914147288, 'auprc': 0.7933251580049205, 'loss_val': 0.8931915160502467, 'psi': 0.7477263780508054}-{'f1_val': 0.7194137648007268, 'auprc': 0.7012983210340982, 'loss_val': 1.0719673901086069, 'psi': 0.7121675872940754}
[S2] not sending this round → trigger blocked (psi=0.748)
[S3] START round=65 head_norm_before_train=2.255423 cos_to_last_merge=0.9976 (last merge round=43)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9864949698171659, 'loss_val': 0.1351835938895855, 'psi': 0.9712430391665386}-{'f1_val': 0.9973982357793907, 'auprc': 0.9982523638201255, 'loss_val': 0.02226115558867267, 'psi': 0.9977398869956846}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.812568 cos_to_last_merge=0.9907 (last merge round=41)
[S4] round=65 local utility u=0.033050 metrics={'f1_val': 0.9514400632963718, 'auprc': 0.9470980321027601, 'loss_val': 0.3407044243702494, 'psi': 0.9497032508189271}-{'f1_val': 0.9399042068693442, 'auprc': 0.9557226115631892, 'loss_val': 0.3634636325125555, 'psi': 0.9462315687468822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=65 head_norm_before_train=1.742761 cos_to_last_merge=0.9483 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=65 local utility u=0.011991 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9985798091356302, 'loss_val': 0.030197636345066718, 'psi': 0.9972314782475463}-{'f1_val': 0.996186023309311, 'auprc': 0.9926796463714118, 'loss_val': 0.03559998872214918, 'psi': 0.9947834725341513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=65 head_norm_before_train=2.311961 (no previous merge yet)
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.6219799484633209, 'auprc': 0.7242830709539917, 'loss_val': 1.5167495269308215, 'psi': 0.6629011974595893}-{'f1_val': 0.8302527157873475, 'auprc': 0.9539259209195485, 'loss_val': 0.35702559262100414, 'psi': 0.879721997840228}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=1.724232 cos_to_last_merge=0.9983 (last merge round=43)
[S7] round=65 local utility u=1.000000 metrics={'f1_val': 0.8302877073136579, 'auprc': 0.8394265130544992, 'loss_val': 0.3052904156633616, 'psi': 0.8339432296099945}-{'f1_val': 0.5858584278668585, 'auprc': 0.7912524363694772, 'loss_val': 0.9393480529504568, 'psi': 0.668016031267906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=65 head_norm_before_train=2.259704 cos_to_last_merge=0.9965 (last merge round=42)
[S8] round=65 local utility u=1.000000 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9992914611378627, 'loss_val': 0.025169702069770136, 'psi': 0.9957369707195544}-{'f1_val': 0.6045686339659974, 'auprc': 0.9930588472785503, 'loss_val': 1.1158294925708199, 'psi': 0.7599647192910186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=65 head_norm_before_train=2.253870 (no previous merge yet)
[S9] round=65 local utility u=0.000146 metrics={'f1_val': 0.9965841382871666, 'auprc': 0.9970164888543006, 'loss_val': 0.019200121722189975, 'psi': 0.9967570785140202}-{'f1_val': 0.9965113446440821, 'auprc': 0.9969845965703974, 'loss_val': 0.01895998985662817, 'psi': 0.9967006454146082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=65 head_norm_before_train=2.153495 cos_to_last_merge=0.9970 (last merge round=39)
[S10] round=65 local utility u=0.000931 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9960152412003441, 'loss_val': 0.02679019950893388, 'psi': 0.9952552620117612}-{'f1_val': 0.9945291067983943, 'auprc': 0.995906901518364, 'loss_val': 0.027010924361885184, 'psi': 0.9950802246863822}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=65 head_norm_before_train=1.726133 cos_to_last_merge=0.9667 (last merge round=35)
[S11] round=65 local utility u=0.000413 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985101954396434, 'loss_val': 0.02455247235303045, 'psi': 0.9970842831238429}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985360416213016, 'loss_val': 0.025455711276283297, 'psi': 0.9970946215965062}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=65 head_norm_before_train=2.135596 (no previous merge yet)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.6374820344997953, 'auprc': 0.6777678936515847, 'loss_val': 1.4521800169306933, 'psi': 0.6535963781605111}-{'f1_val': 0.6569551902261475, 'auprc': 0.6934346133810775, 'loss_val': 1.3116883222180338, 'psi': 0.6715469594881194}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=1.712819 cos_to_last_merge=0.9931 (last merge round=42)
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9989703915362717, 'loss_val': 0.03147004489903272, 'psi': 0.9978741280523882}-{'f1_val': 0.9971404074438908, 'auprc': 0.9990405930618065, 'loss_val': 0.02893239851179183, 'psi': 0.997900481691057}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=1.859227 cos_to_last_merge=0.9886 (last merge round=42)
[S15] round=65 local utility u=0.695605 metrics={'f1_val': 0.9627519808495014, 'auprc': 0.9971407767081398, 'loss_val': 0.07293053187187094, 'psi': 0.9765074991929568}-{'f1_val': 0.8224832505311145, 'auprc': 0.9270718076975442, 'loss_val': 0.4123214033843212, 'psi': 0.8643186733976864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=65 head_norm_before_train=1.719511 cos_to_last_merge=0.9937 (last merge round=42)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9027428850944355, 'auprc': 0.9758201384595218, 'loss_val': 0.2842804506019235, 'psi': 0.93197378644047}-{'f1_val': 0.9915080504535831, 'auprc': 0.9857955616749843, 'loss_val': 0.04320518032087517, 'psi': 0.9892230549421437}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.973518 cos_to_last_merge=0.9578 (last merge round=42)
[S17] round=65 local utility u=0.035104 metrics={'f1_val': 0.8206285375547578, 'auprc': 0.8445646216039147, 'loss_val': 0.764919382012391, 'psi': 0.8302029711744205}-{'f1_val': 0.8249750679558179, 'auprc': 0.8209838304577182, 'loss_val': 0.7904638048431364, 'psi': 0.823378572956578}
[S17] not sending this round → trigger blocked (psi=0.830)
[S2] START round=66 head_norm_before_train=2.054782 cos_to_last_merge=0.7518 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=66 local utility u=0.320306 metrics={'f1_val': 0.7288726442296669, 'auprc': 0.8863735710720233, 'loss_val': 0.6009975991423278, 'psi': 0.7918730149666094}-{'f1_val': 0.7173271914147288, 'auprc': 0.7933251580049205, 'loss_val': 0.8931915160502467, 'psi': 0.7477263780508054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=66 head_norm_before_train=2.260175 cos_to_last_merge=0.9975 (last merge round=43)
[S3] round=66 local utility u=0.027357 metrics={'f1_val': 0.9620012470396173, 'auprc': 0.9925037247699086, 'loss_val': 0.10405338337255382, 'psi': 0.9742022381317338}-{'f1_val': 0.9610750853994537, 'auprc': 0.9864949698171659, 'loss_val': 0.1351835938895855, 'psi': 0.9712430391665386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=66 head_norm_before_train=1.814387 cos_to_last_merge=0.9903 (last merge round=41)
[S4] round=66 local utility u=0.011250 metrics={'f1_val': 0.9556385009876092, 'auprc': 0.9470488840266644, 'loss_val': 0.3432470641848888, 'psi': 0.9522026542032312}-{'f1_val': 0.9514400632963718, 'auprc': 0.9470980321027601, 'loss_val': 0.3407044243702494, 'psi': 0.9497032508189271}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=66 head_norm_before_train=1.752462 cos_to_last_merge=0.9478 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=66 local utility u=0.000085 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9980753994778644, 'loss_val': 0.029392449202725802, 'psi': 0.9971174338752318}-{'f1_val': 0.9963325909888239, 'auprc': 0.9985798091356302, 'loss_val': 0.030197636345066718, 'psi': 0.9972314782475463}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=66 head_norm_before_train=2.325178 (no previous merge yet)
[S6] round=66 local utility u=0.990014 metrics={'f1_val': 0.7424499129338318, 'auprc': 0.8833654879279972, 'loss_val': 0.7367885809681156, 'psi': 0.7988161429314979}-{'f1_val': 0.6219799484633209, 'auprc': 0.7242830709539917, 'loss_val': 1.5167495269308215, 'psi': 0.6629011974595893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=66 head_norm_before_train=1.726585 cos_to_last_merge=0.9981 (last merge round=43)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.7311330932642901, 'auprc': 0.8132176253097744, 'loss_val': 0.4135424708383876, 'psi': 0.7639669060824839}-{'f1_val': 0.8302877073136579, 'auprc': 0.8394265130544992, 'loss_val': 0.3052904156633616, 'psi': 0.8339432296099945}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=2.267277 cos_to_last_merge=0.9963 (last merge round=42)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9995525810220708, 'loss_val': 0.026836949688768624, 'psi': 0.9958414186732376}-{'f1_val': 0.9933673104406822, 'auprc': 0.9992914611378627, 'loss_val': 0.025169702069770136, 'psi': 0.9957369707195544}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=2.260452 (no previous merge yet)
[S9] round=66 local utility u=0.000636 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9969905119568199, 'loss_val': 0.01891471034147147, 'psi': 0.9968531708471369}-{'f1_val': 0.9965841382871666, 'auprc': 0.9970164888543006, 'loss_val': 0.019200121722189975, 'psi': 0.9967570785140202}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=66 head_norm_before_train=2.161325 cos_to_last_merge=0.9970 (last merge round=39)
[S10] round=66 local utility u=0.000419 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9963223517394524, 'loss_val': 0.02687414888943615, 'psi': 0.9953781062274045}-{'f1_val': 0.9947486092193725, 'auprc': 0.9960152412003441, 'loss_val': 0.02679019950893388, 'psi': 0.9952552620117612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=66 head_norm_before_train=1.734395 cos_to_last_merge=0.9660 (last merge round=35)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9437088055105303, 'auprc': 0.99859525407926, 'loss_val': 0.2019662801417369, 'psi': 0.9656633849380222}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985101954396434, 'loss_val': 0.02455247235303045, 'psi': 0.9970842831238429}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=2.142275 (no previous merge yet)
[S13] round=66 local utility u=0.400715 metrics={'f1_val': 0.7067626490674033, 'auprc': 0.7148381740929164, 'loss_val': 1.1776450805287562, 'psi': 0.7099928590776086}-{'f1_val': 0.6374820344997953, 'auprc': 0.6777678936515847, 'loss_val': 1.4521800169306933, 'psi': 0.6535963781605111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=66 head_norm_before_train=1.719800 cos_to_last_merge=0.9927 (last merge round=42)
[S14] round=66 local utility u=0.000326 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9990408368897696, 'loss_val': 0.027531753867895817, 'psi': 0.9975525615261666}-{'f1_val': 0.9971432857297993, 'auprc': 0.9989703915362717, 'loss_val': 0.03147004489903272, 'psi': 0.9978741280523882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=66 head_norm_before_train=1.869203 cos_to_last_merge=0.9882 (last merge round=42)
[S15] round=66 local utility u=0.128699 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977773844003786, 'loss_val': 0.021410883872452886, 'psi': 0.9971589547926638}-{'f1_val': 0.9627519808495014, 'auprc': 0.9971407767081398, 'loss_val': 0.07293053187187094, 'psi': 0.9765074991929568}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=66 head_norm_before_train=1.724208 cos_to_last_merge=0.9934 (last merge round=42)
[S16] round=66 local utility u=0.000000 metrics={'f1_val': 0.8565816196978802, 'auprc': 0.9764548523841506, 'loss_val': 0.8559930348209239, 'psi': 0.9045309127723884}-{'f1_val': 0.9027428850944355, 'auprc': 0.9758201384595218, 'loss_val': 0.2842804506019235, 'psi': 0.93197378644047}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=66 head_norm_before_train=1.983233 cos_to_last_merge=0.9569 (last merge round=42)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.8092208106248531, 'auprc': 0.8341621717729776, 'loss_val': 0.6945524759597146, 'psi': 0.8191973550841029}-{'f1_val': 0.8206285375547578, 'auprc': 0.8445646216039147, 'loss_val': 0.764919382012391, 'psi': 0.8302029711744205}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=2.056515 cos_to_last_merge=0.7517 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.7187651292320925, 'auprc': 0.7366479734583405, 'loss_val': 0.9970093978501827, 'psi': 0.7259182669225916}-{'f1_val': 0.7288726442296669, 'auprc': 0.8863735710720233, 'loss_val': 0.6009975991423278, 'psi': 0.7918730149666094}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.265457 cos_to_last_merge=0.9973 (last merge round=43)
[S3] round=67 local utility u=0.147512 metrics={'f1_val': 0.9953166962312615, 'auprc': 0.9989860386356813, 'loss_val': 0.028368932160745087, 'psi': 0.9967844331930295}-{'f1_val': 0.9620012470396173, 'auprc': 0.9925037247699086, 'loss_val': 0.10405338337255382, 'psi': 0.9742022381317338}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=67 head_norm_before_train=1.818364 cos_to_last_merge=0.9898 (last merge round=41)
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9480731390643471, 'auprc': 0.9465064357196443, 'loss_val': 0.34923440863136473, 'psi': 0.9474464577264661}-{'f1_val': 0.9556385009876092, 'auprc': 0.9470488840266644, 'loss_val': 0.3432470641848888, 'psi': 0.9522026542032312}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=1.756788 cos_to_last_merge=0.9468 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.992096678453028, 'loss_val': 0.03164084574428114, 'psi': 0.9947259454652972}-{'f1_val': 0.9964787901401435, 'auprc': 0.9980753994778644, 'loss_val': 0.029392449202725802, 'psi': 0.9971174338752318}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=2.338551 (no previous merge yet)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.7534688870439389, 'auprc': 0.891806436195528, 'loss_val': 0.9863813359889001, 'psi': 0.8088039067045745}-{'f1_val': 0.7424499129338318, 'auprc': 0.8833654879279972, 'loss_val': 0.7367885809681156, 'psi': 0.7988161429314979}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.727735 cos_to_last_merge=0.9981 (last merge round=43)
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.6252269108063073, 'auprc': 0.8024166606676015, 'loss_val': 0.5628330030096477, 'psi': 0.696102810750825}-{'f1_val': 0.7311330932642901, 'auprc': 0.8132176253097744, 'loss_val': 0.4135424708383876, 'psi': 0.7639669060824839}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=2.272113 cos_to_last_merge=0.9960 (last merge round=42)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9995224377127365, 'loss_val': 0.028290278011544216, 'psi': 0.995610049776767}-{'f1_val': 0.9933673104406822, 'auprc': 0.9995525810220708, 'loss_val': 0.026836949688768624, 'psi': 0.9958414186732376}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=2.264560 (no previous merge yet)
[S9] round=67 local utility u=0.002706 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9984386164632753, 'loss_val': 0.020311964201761398, 'psi': 0.9976789533945538}-{'f1_val': 0.9967616101073482, 'auprc': 0.9969905119568199, 'loss_val': 0.01891471034147147, 'psi': 0.9968531708471369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=67 head_norm_before_train=2.168286 cos_to_last_merge=0.9970 (last merge round=39)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.99628103070321, 'loss_val': 0.027208129124371386, 'psi': 0.9952298763603206}-{'f1_val': 0.9947486092193725, 'auprc': 0.9963223517394524, 'loss_val': 0.02687414888943615, 'psi': 0.9953781062274045}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=67 head_norm_before_train=1.742375 cos_to_last_merge=0.9653 (last merge round=35)
[S11] round=67 local utility u=0.246052 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9982369310700044, 'loss_val': 0.024366461110581186, 'psi': 0.9970778729093184}-{'f1_val': 0.9437088055105303, 'auprc': 0.99859525407926, 'loss_val': 0.2019662801417369, 'psi': 0.9656633849380222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=67 head_norm_before_train=2.153702 (no previous merge yet)
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.6882947828247483, 'auprc': 0.676893816271882, 'loss_val': 1.446298930654041, 'psi': 0.6837343962036018}-{'f1_val': 0.7067626490674033, 'auprc': 0.7148381740929164, 'loss_val': 1.1776450805287562, 'psi': 0.7099928590776086}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=1.726742 cos_to_last_merge=0.9924 (last merge round=42)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9965382307139673, 'auprc': 0.9968756427383165, 'loss_val': 0.0283269900606729, 'psi': 0.996673195523707}-{'f1_val': 0.9965603779504312, 'auprc': 0.9990408368897696, 'loss_val': 0.027531753867895817, 'psi': 0.9975525615261666}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=1.879016 cos_to_last_merge=0.9877 (last merge round=42)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977166600034048, 'loss_val': 0.023533263988023665, 'psi': 0.9971346650338743}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977773844003786, 'loss_val': 0.021410883872452886, 'psi': 0.9971589547926638}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.729671 cos_to_last_merge=0.9931 (last merge round=42)
[S16] round=67 local utility u=0.276796 metrics={'f1_val': 0.8936575911090473, 'auprc': 0.9800260866075926, 'loss_val': 0.5355698110253229, 'psi': 0.9282049893084654}-{'f1_val': 0.8565816196978802, 'auprc': 0.9764548523841506, 'loss_val': 0.8559930348209239, 'psi': 0.9045309127723884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=67 head_norm_before_train=1.993611 cos_to_last_merge=0.9561 (last merge round=42)
[S17] round=67 local utility u=0.054563 metrics={'f1_val': 0.8341327222221372, 'auprc': 0.8361820131796598, 'loss_val': 0.7409579048360523, 'psi': 0.8349524386051462}-{'f1_val': 0.8092208106248531, 'auprc': 0.8341621717729776, 'loss_val': 0.6945524759597146, 'psi': 0.8191973550841029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=68 head_norm_before_train=2.061819 cos_to_last_merge=0.7513 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=68 local utility u=0.017416 metrics={'f1_val': 0.718829148700757, 'auprc': 0.7341057947961889, 'loss_val': 0.9549354584910111, 'psi': 0.7249398071389297}-{'f1_val': 0.7187651292320925, 'auprc': 0.7366479734583405, 'loss_val': 0.9970093978501827, 'psi': 0.7259182669225916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=68 head_norm_before_train=2.271158 cos_to_last_merge=0.9971 (last merge round=43)
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.9146010097044246, 'auprc': 0.9966247295337325, 'loss_val': 0.15362822705794124, 'psi': 0.9474104976361477}-{'f1_val': 0.9953166962312615, 'auprc': 0.9989860386356813, 'loss_val': 0.028368932160745087, 'psi': 0.9967844331930295}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.823623 cos_to_last_merge=0.9894 (last merge round=41)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9448851395154491, 'auprc': 0.944913173458356, 'loss_val': 0.35435483923665656, 'psi': 0.9448963530926118}-{'f1_val': 0.9480731390643471, 'auprc': 0.9465064357196443, 'loss_val': 0.34923440863136473, 'psi': 0.9474464577264661}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.765457 cos_to_last_merge=0.9455 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=68 local utility u=0.003058 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9940363134782708, 'loss_val': 0.031343191393968815, 'psi': 0.9955017994753944}-{'f1_val': 0.9964787901401435, 'auprc': 0.992096678453028, 'loss_val': 0.03164084574428114, 'psi': 0.9947259454652972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=68 head_norm_before_train=2.345569 (no previous merge yet)
[S6] round=68 local utility u=0.417116 metrics={'f1_val': 0.8224626205937318, 'auprc': 0.9141983877119275, 'loss_val': 0.6332872198757593, 'psi': 0.85915692744101}-{'f1_val': 0.7534688870439389, 'auprc': 0.891806436195528, 'loss_val': 0.9863813359889001, 'psi': 0.8088039067045745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=68 head_norm_before_train=1.730195 cos_to_last_merge=0.9981 (last merge round=43)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.5635915609082075, 'auprc': 0.786598924298713, 'loss_val': 0.9274510197883781, 'psi': 0.6527945062644098}-{'f1_val': 0.6252269108063073, 'auprc': 0.8024166606676015, 'loss_val': 0.5628330030096477, 'psi': 0.696102810750825}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=2.280564 cos_to_last_merge=0.9959 (last merge round=42)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9922724065265219, 'auprc': 0.9995958984413413, 'loss_val': 0.02831304811536121, 'psi': 0.9952018032924497}-{'f1_val': 0.9930017911527874, 'auprc': 0.9995224377127365, 'loss_val': 0.028290278011544216, 'psi': 0.995610049776767}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=2.268170 (no previous merge yet)
[S9] round=68 local utility u=0.000063 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.998452072923897, 'loss_val': 0.02022611318981873, 'psi': 0.9976843359788026}-{'f1_val': 0.9971725113487396, 'auprc': 0.9984386164632753, 'loss_val': 0.020311964201761398, 'psi': 0.9976789533945538}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=68 head_norm_before_train=2.171035 cos_to_last_merge=0.9967 (last merge round=39)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9960833548358158, 'loss_val': 0.027277380751617442, 'psi': 0.9951508060133629}-{'f1_val': 0.9945291067983943, 'auprc': 0.99628103070321, 'loss_val': 0.027208129124371386, 'psi': 0.9952298763603206}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=1.748115 cos_to_last_merge=0.9647 (last merge round=35)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981899877043725, 'loss_val': 0.02428075505932939, 'psi': 0.9970590955630656}-{'f1_val': 0.996305167468861, 'auprc': 0.9982369310700044, 'loss_val': 0.024366461110581186, 'psi': 0.9970778729093184}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=2.162309 (no previous merge yet)
[S13] round=68 local utility u=0.161993 metrics={'f1_val': 0.7040863130545361, 'auprc': 0.7006767438857089, 'loss_val': 1.288410478556183, 'psi': 0.7027224853870052}-{'f1_val': 0.6882947828247483, 'auprc': 0.676893816271882, 'loss_val': 1.446298930654041, 'psi': 0.6837343962036018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=68 head_norm_before_train=1.733378 cos_to_last_merge=0.9921 (last merge round=42)
[S14] round=68 local utility u=0.004113 metrics={'f1_val': 0.9967584991393483, 'auprc': 0.9986689932205908, 'loss_val': 0.02680271154715357, 'psi': 0.9975226967718454}-{'f1_val': 0.9965382307139673, 'auprc': 0.9968756427383165, 'loss_val': 0.0283269900606729, 'psi': 0.996673195523707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=68 head_norm_before_train=1.888580 cos_to_last_merge=0.9873 (last merge round=42)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.9677746957009835, 'auprc': 0.9973027116494861, 'loss_val': 0.06171690308742358, 'psi': 0.9795859020803845}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977166600034048, 'loss_val': 0.023533263988023665, 'psi': 0.9971346650338743}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=1.735581 cos_to_last_merge=0.9930 (last merge round=42)
[S16] round=68 local utility u=0.316172 metrics={'f1_val': 0.9445920217077863, 'auprc': 0.9853076198777477, 'loss_val': 0.22467662246547726, 'psi': 0.9608782609757709}-{'f1_val': 0.8936575911090473, 'auprc': 0.9800260866075926, 'loss_val': 0.5355698110253229, 'psi': 0.9282049893084654}
[S16] not sending this round → trigger blocked (psi=0.961)
[S17] START round=68 head_norm_before_train=2.003807 cos_to_last_merge=0.9552 (last merge round=42)
[S17] round=68 local utility u=0.037438 metrics={'f1_val': 0.825998696385998, 'auprc': 0.8359391714428316, 'loss_val': 0.6165482822098637, 'psi': 0.8299748864087314}-{'f1_val': 0.8341327222221372, 'auprc': 0.8361820131796598, 'loss_val': 0.7409579048360523, 'psi': 0.8349524386051462}
[S17] not sending this round → trigger blocked (psi=0.830)
[S2] START round=69 head_norm_before_train=2.063744 cos_to_last_merge=0.7511 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=69 local utility u=0.398585 metrics={'f1_val': 0.8074588929791413, 'auprc': 0.7728630892157327, 'loss_val': 0.80581542996487, 'psi': 0.7936205714737778}-{'f1_val': 0.718829148700757, 'auprc': 0.7341057947961889, 'loss_val': 0.9549354584910111, 'psi': 0.7249398071389297}
[S2] not sending this round → trigger blocked (psi=0.794)
[S3] START round=69 head_norm_before_train=2.276477 cos_to_last_merge=0.9970 (last merge round=43)
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.9348958752843897, 'auprc': 0.9426123322375115, 'loss_val': 0.2294282115137505, 'psi': 0.9379824580656384}-{'f1_val': 0.9146010097044246, 'auprc': 0.9966247295337325, 'loss_val': 0.15362822705794124, 'psi': 0.9474104976361477}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=1.828781 cos_to_last_merge=0.9893 (last merge round=41)
[S4] round=69 local utility u=0.007810 metrics={'f1_val': 0.9429487192955263, 'auprc': 0.952541144641702, 'loss_val': 0.35000057180727295, 'psi': 0.9467856894339965}-{'f1_val': 0.9448851395154491, 'auprc': 0.944913173458356, 'loss_val': 0.35435483923665656, 'psi': 0.9448963530926118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=69 head_norm_before_train=1.772394 cos_to_last_merge=0.9445 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=69 local utility u=0.008041 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9982429729052711, 'loss_val': 0.02788177406098132, 'psi': 0.9971844632461945}-{'f1_val': 0.9964787901401435, 'auprc': 0.9940363134782708, 'loss_val': 0.031343191393968815, 'psi': 0.9955017994753944}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=69 head_norm_before_train=2.354697 (no previous merge yet)
[S6] round=69 local utility u=0.061479 metrics={'f1_val': 0.8213953460726691, 'auprc': 0.9410236986279594, 'loss_val': 0.5844009261901394, 'psi': 0.8692466870947853}-{'f1_val': 0.8224626205937318, 'auprc': 0.9141983877119275, 'loss_val': 0.6332872198757593, 'psi': 0.85915692744101}
[S6] not sending this round → trigger blocked (psi=0.869)
[S7] START round=69 head_norm_before_train=1.733256 cos_to_last_merge=0.9980 (last merge round=43)
[S7] round=69 local utility u=0.633981 metrics={'f1_val': 0.6645338590763457, 'auprc': 0.8186425450926029, 'loss_val': 0.3612745110513097, 'psi': 0.7261773334828485}-{'f1_val': 0.5635915609082075, 'auprc': 0.786598924298713, 'loss_val': 0.9274510197883781, 'psi': 0.6527945062644098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=69 head_norm_before_train=2.291114 cos_to_last_merge=0.9957 (last merge round=42)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.8689376705879672, 'auprc': 0.9990120775825355, 'loss_val': 0.28690304978020703, 'psi': 0.9209674333857946}-{'f1_val': 0.9922724065265219, 'auprc': 0.9995958984413413, 'loss_val': 0.02831304811536121, 'psi': 0.9952018032924497}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=2.273569 (no previous merge yet)
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9971065605080082, 'loss_val': 0.019134543722526237, 'psi': 0.9968995902676122}-{'f1_val': 0.9971725113487396, 'auprc': 0.998452072923897, 'loss_val': 0.02022611318981873, 'psi': 0.9976843359788026}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=2.177207 cos_to_last_merge=0.9966 (last merge round=39)
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9954831441079299, 'loss_val': 0.027319302676677804, 'psi': 0.9949107217222086}-{'f1_val': 0.9945291067983943, 'auprc': 0.9960833548358158, 'loss_val': 0.027277380751617442, 'psi': 0.9951508060133629}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=1.753981 cos_to_last_merge=0.9642 (last merge round=35)
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.9913449160568414, 'auprc': 0.998575033803476, 'loss_val': 0.03586141295488795, 'psi': 0.9942369631554953}-{'f1_val': 0.996305167468861, 'auprc': 0.9981899877043725, 'loss_val': 0.02428075505932939, 'psi': 0.9970590955630656}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=69 head_norm_before_train=2.169548 (no previous merge yet)
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.6022301278127887, 'auprc': 0.6477159363604202, 'loss_val': 1.6807533155920265, 'psi': 0.6204244512318413}-{'f1_val': 0.7040863130545361, 'auprc': 0.7006767438857089, 'loss_val': 1.288410478556183, 'psi': 0.7027224853870052}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=1.739471 cos_to_last_merge=0.9919 (last merge round=42)
[S14] round=69 local utility u=0.000953 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9989546363856243, 'loss_val': 0.02561880641429467, 'psi': 0.9976233753645031}-{'f1_val': 0.9967584991393483, 'auprc': 0.9986689932205908, 'loss_val': 0.02680271154715357, 'psi': 0.9975226967718454}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=69 head_norm_before_train=1.897862 cos_to_last_merge=0.9869 (last merge round=42)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.9343862688593145, 'auprc': 0.9973040210110526, 'loss_val': 0.12141081836008392, 'psi': 0.9595533697200098}-{'f1_val': 0.9677746957009835, 'auprc': 0.9973027116494861, 'loss_val': 0.06171690308742358, 'psi': 0.9795859020803845}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=1.742315 cos_to_last_merge=0.9928 (last merge round=42)
[S16] round=69 local utility u=0.229856 metrics={'f1_val': 0.9906753969094043, 'auprc': 0.9878500333152296, 'loss_val': 0.049092739932808695, 'psi': 0.9895452514717344}-{'f1_val': 0.9445920217077863, 'auprc': 0.9853076198777477, 'loss_val': 0.22467662246547726, 'psi': 0.9608782609757709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=69 head_norm_before_train=2.015085 cos_to_last_merge=0.9543 (last merge round=42)
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.7585827214071549, 'auprc': 0.7280398788009768, 'loss_val': 1.0104307088575724, 'psi': 0.7463655843646836}-{'f1_val': 0.825998696385998, 'auprc': 0.8359391714428316, 'loss_val': 0.6165482822098637, 'psi': 0.8299748864087314}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=2.067256 cos_to_last_merge=0.7508 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.7324250654451632, 'auprc': 0.814844663184757, 'loss_val': 0.7554893322004416, 'psi': 0.7653929045410007}-{'f1_val': 0.8074588929791413, 'auprc': 0.7728630892157327, 'loss_val': 0.80581542996487, 'psi': 0.7936205714737778}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=2.281395 cos_to_last_merge=0.9969 (last merge round=43)
[S3] round=70 local utility u=0.168761 metrics={'f1_val': 0.9447163127512364, 'auprc': 0.998157156443304, 'loss_val': 0.1174623679918462, 'psi': 0.9660926502280633}-{'f1_val': 0.9348958752843897, 'auprc': 0.9426123322375115, 'loss_val': 0.2294282115137505, 'psi': 0.9379824580656384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=70 head_norm_before_train=1.835426 cos_to_last_merge=0.9890 (last merge round=41)
[S4] round=70 local utility u=0.000000 metrics={'f1_val': 0.9398480206368113, 'auprc': 0.9529139523545797, 'loss_val': 0.35957217142668, 'psi': 0.9450743933239187}-{'f1_val': 0.9429487192955263, 'auprc': 0.952541144641702, 'loss_val': 0.35000057180727295, 'psi': 0.9467856894339965}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=70 head_norm_before_train=1.778975 cos_to_last_merge=0.9430 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9969807845412676, 'loss_val': 0.027884465035503056, 'psi': 0.9966795879005931}-{'f1_val': 0.9964787901401435, 'auprc': 0.9982429729052711, 'loss_val': 0.02788177406098132, 'psi': 0.9971844632461945}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=2.364079 (no previous merge yet)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.7483953515262113, 'auprc': 0.9044075471430622, 'loss_val': 0.9909776665481661, 'psi': 0.8108002297729516}-{'f1_val': 0.8213953460726691, 'auprc': 0.9410236986279594, 'loss_val': 0.5844009261901394, 'psi': 0.8692466870947853}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.734969 cos_to_last_merge=0.9981 (last merge round=43)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.6662721177373343, 'auprc': 0.814506179448319, 'loss_val': 0.38741076269542035, 'psi': 0.7255657424217282}-{'f1_val': 0.6645338590763457, 'auprc': 0.8186425450926029, 'loss_val': 0.3612745110513097, 'psi': 0.7261773334828485}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=2.299016 cos_to_last_merge=0.9955 (last merge round=42)
[S8] round=70 local utility u=0.374119 metrics={'f1_val': 0.9612162843577711, 'auprc': 0.9992752748930961, 'loss_val': 0.09312579417984483, 'psi': 0.976439880571901}-{'f1_val': 0.8689376705879672, 'auprc': 0.9990120775825355, 'loss_val': 0.28690304978020703, 'psi': 0.9209674333857946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=70 head_norm_before_train=2.280007 (no previous merge yet)
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9971228971809463, 'loss_val': 0.020902069386641402, 'psi': 0.9969061249367874}-{'f1_val': 0.9967616101073482, 'auprc': 0.9971065605080082, 'loss_val': 0.019134543722526237, 'psi': 0.9968995902676122}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=2.180289 cos_to_last_merge=0.9963 (last merge round=39)
[S10] round=70 local utility u=0.001476 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9958974362831363, 'loss_val': 0.026926740745646074, 'psi': 0.995208140044878}-{'f1_val': 0.9945291067983943, 'auprc': 0.9954831441079299, 'loss_val': 0.027319302676677804, 'psi': 0.9949107217222086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=70 head_norm_before_train=1.758411 cos_to_last_merge=0.9638 (last merge round=35)
[S11] round=70 local utility u=0.021188 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984718829496135, 'loss_val': 0.0229380561987325, 'psi': 0.997171853661162}-{'f1_val': 0.9913449160568414, 'auprc': 0.998575033803476, 'loss_val': 0.03586141295488795, 'psi': 0.9942369631554953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=70 head_norm_before_train=2.180381 (no previous merge yet)
[S13] round=70 local utility u=0.869743 metrics={'f1_val': 0.688914355229159, 'auprc': 0.8768661694461526, 'loss_val': 1.1488240684772404, 'psi': 0.7640950809159565}-{'f1_val': 0.6022301278127887, 'auprc': 0.6477159363604202, 'loss_val': 1.6807533155920265, 'psi': 0.6204244512318413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=70 head_norm_before_train=1.744591 cos_to_last_merge=0.9916 (last merge round=42)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9963875947232834, 'auprc': 0.9988340680352195, 'loss_val': 0.027979365115622514, 'psi': 0.9973661840480579}-{'f1_val': 0.9967358680170888, 'auprc': 0.9989546363856243, 'loss_val': 0.02561880641429467, 'psi': 0.9976233753645031}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=1.906678 cos_to_last_merge=0.9865 (last merge round=42)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.9154389259277564, 'auprc': 0.9973178724605677, 'loss_val': 0.17016320955441996, 'psi': 0.9481905045408809}-{'f1_val': 0.9343862688593145, 'auprc': 0.9973040210110526, 'loss_val': 0.12141081836008392, 'psi': 0.9595533697200098}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=1.749366 cos_to_last_merge=0.9926 (last merge round=42)
[S16] round=70 local utility u=0.009052 metrics={'f1_val': 0.9910676930354919, 'auprc': 0.9921361519767072, 'loss_val': 0.04620142127430092, 'psi': 0.9914950766119781}-{'f1_val': 0.9906753969094043, 'auprc': 0.9878500333152296, 'loss_val': 0.049092739932808695, 'psi': 0.9895452514717344}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=70 head_norm_before_train=2.023266 cos_to_last_merge=0.9536 (last merge round=42)
[S17] round=70 local utility u=0.731889 metrics={'f1_val': 0.8568104240539096, 'auprc': 0.8537358699221608, 'loss_val': 0.5131061412995875, 'psi': 0.8555806024012101}-{'f1_val': 0.7585827214071549, 'auprc': 0.7280398788009768, 'loss_val': 1.0104307088575724, 'psi': 0.7463655843646836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=71 head_norm_before_train=2.069332 cos_to_last_merge=0.7506 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.7206639238528042, 'auprc': 0.7021736387026126, 'loss_val': 1.0369910583413557, 'psi': 0.7132678097927276}-{'f1_val': 0.7324250654451632, 'auprc': 0.814844663184757, 'loss_val': 0.7554893322004416, 'psi': 0.7653929045410007}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.285131 cos_to_last_merge=0.9968 (last merge round=43)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9153842584790087, 'auprc': 0.9966007392284334, 'loss_val': 0.151255739004221, 'psi': 0.9478708507787786}-{'f1_val': 0.9447163127512364, 'auprc': 0.998157156443304, 'loss_val': 0.1174623679918462, 'psi': 0.9660926502280633}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.843020 cos_to_last_merge=0.9886 (last merge round=41)
[S4] round=71 local utility u=0.042906 metrics={'f1_val': 0.953815165033801, 'auprc': 0.950899446015602, 'loss_val': 0.3515198801749203, 'psi': 0.9526488774265214}-{'f1_val': 0.9398480206368113, 'auprc': 0.9529139523545797, 'loss_val': 0.35957217142668, 'psi': 0.9450743933239187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=71 head_norm_before_train=1.788506 cos_to_last_merge=0.9421 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=71 local utility u=0.002341 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9983354948370065, 'loss_val': 0.027266442981806343, 'psi': 0.9972214720188887}-{'f1_val': 0.9964787901401435, 'auprc': 0.9969807845412676, 'loss_val': 0.027884465035503056, 'psi': 0.9966795879005931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=71 head_norm_before_train=2.373103 (no previous merge yet)
[S6] round=71 local utility u=0.909465 metrics={'f1_val': 0.9109075256280448, 'auprc': 0.9485515811109804, 'loss_val': 0.2795525795350419, 'psi': 0.925965147821219}-{'f1_val': 0.7483953515262113, 'auprc': 0.9044075471430622, 'loss_val': 0.9909776665481661, 'psi': 0.8108002297729516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=71 head_norm_before_train=1.738364 cos_to_last_merge=0.9981 (last merge round=43)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.623482103328717, 'auprc': 0.7979772986435446, 'loss_val': 0.6202149145267681, 'psi': 0.6932801814546481}-{'f1_val': 0.6662721177373343, 'auprc': 0.814506179448319, 'loss_val': 0.38741076269542035, 'psi': 0.7255657424217282}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=2.305801 cos_to_last_merge=0.9953 (last merge round=42)
[S8] round=71 local utility u=0.136075 metrics={'f1_val': 0.9950246274718425, 'auprc': 0.9991098759285986, 'loss_val': 0.023329901496096622, 'psi': 0.996658726854545}-{'f1_val': 0.9612162843577711, 'auprc': 0.9992752748930961, 'loss_val': 0.09312579417984483, 'psi': 0.976439880571901}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=71 head_norm_before_train=2.284210 (no previous merge yet)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9892013548861434, 'auprc': 0.9985512272832191, 'loss_val': 0.0395171057616381, 'psi': 0.9929413038449737}-{'f1_val': 0.9967616101073482, 'auprc': 0.9971228971809463, 'loss_val': 0.020902069386641402, 'psi': 0.9969061249367874}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.184876 cos_to_last_merge=0.9962 (last merge round=39)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9954268001150075, 'loss_val': 0.027178606739516314, 'psi': 0.9948881841250397}-{'f1_val': 0.9947486092193725, 'auprc': 0.9958974362831363, 'loss_val': 0.026926740745646074, 'psi': 0.995208140044878}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=1.763808 cos_to_last_merge=0.9633 (last merge round=35)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983869293275981, 'loss_val': 0.023726997492668933, 'psi': 0.9971378722123558}-{'f1_val': 0.996305167468861, 'auprc': 0.9984718829496135, 'loss_val': 0.0229380561987325, 'psi': 0.997171853661162}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=2.187837 (no previous merge yet)
[S13] round=71 local utility u=0.099615 metrics={'f1_val': 0.7704261236182152, 'auprc': 0.773001505249108, 'loss_val': 1.1270714700499969, 'psi': 0.7714562762705723}-{'f1_val': 0.688914355229159, 'auprc': 0.8768661694461526, 'loss_val': 1.1488240684772404, 'psi': 0.7640950809159565}
[S13] not sending this round → trigger blocked (psi=0.771)
[S14] START round=71 head_norm_before_train=1.750811 cos_to_last_merge=0.9913 (last merge round=42)
[S14] round=71 local utility u=0.001463 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9989010918192684, 'loss_val': 0.024863330029737056, 'psi': 0.9973537851226137}-{'f1_val': 0.9963875947232834, 'auprc': 0.9988340680352195, 'loss_val': 0.027979365115622514, 'psi': 0.9973661840480579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=71 head_norm_before_train=1.915215 cos_to_last_merge=0.9861 (last merge round=42)
[S15] round=71 local utility u=0.092165 metrics={'f1_val': 0.9372665255493237, 'auprc': 0.9973023957647302, 'loss_val': 0.116752366133397, 'psi': 0.9612808736354863}-{'f1_val': 0.9154389259277564, 'auprc': 0.9973178724605677, 'loss_val': 0.17016320955441996, 'psi': 0.9481905045408809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=71 head_norm_before_train=1.755072 cos_to_last_merge=0.9923 (last merge round=42)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9359683613924629, 'auprc': 0.9773948411185436, 'loss_val': 0.38644188945385094, 'psi': 0.9525389532828952}-{'f1_val': 0.9910676930354919, 'auprc': 0.9921361519767072, 'loss_val': 0.04620142127430092, 'psi': 0.9914950766119781}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=2.029080 cos_to_last_merge=0.9529 (last merge round=42)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.8422770905331893, 'auprc': 0.8557163630951776, 'loss_val': 0.6825117703062278, 'psi': 0.8476527995579846}-{'f1_val': 0.8568104240539096, 'auprc': 0.8537358699221608, 'loss_val': 0.5131061412995875, 'psi': 0.8555806024012101}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=2.073299 cos_to_last_merge=0.7501 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.750
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.72059017588537, 'auprc': 0.7006071956727046, 'loss_val': 1.0820299751548468, 'psi': 0.7125969838003039}-{'f1_val': 0.7206639238528042, 'auprc': 0.7021736387026126, 'loss_val': 1.0369910583413557, 'psi': 0.7132678097927276}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.289109 cos_to_last_merge=0.9966 (last merge round=43)
[S3] round=72 local utility u=0.040179 metrics={'f1_val': 0.9592141584139489, 'auprc': 0.9429265156869417, 'loss_val': 0.17285377492245768, 'psi': 0.9526991013231461}-{'f1_val': 0.9153842584790087, 'auprc': 0.9966007392284334, 'loss_val': 0.151255739004221, 'psi': 0.9478708507787786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=72 head_norm_before_train=1.849758 cos_to_last_merge=0.9883 (last merge round=41)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.8516911685546791, 'auprc': 0.933856193662302, 'loss_val': 0.4770475698668677, 'psi': 0.8845571785977282}-{'f1_val': 0.953815165033801, 'auprc': 0.950899446015602, 'loss_val': 0.3515198801749203, 'psi': 0.9526488774265214}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=1.800528 cos_to_last_merge=0.9410 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9982956876000171, 'loss_val': 0.027412245725451215, 'psi': 0.9970298890255934}-{'f1_val': 0.9964787901401435, 'auprc': 0.9983354948370065, 'loss_val': 0.027266442981806343, 'psi': 0.9972214720188887}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=2.380391 (no previous merge yet)
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.7986501236274638, 'auprc': 0.9360934149332715, 'loss_val': 0.739932113179651, 'psi': 0.8536274401497869}-{'f1_val': 0.9109075256280448, 'auprc': 0.9485515811109804, 'loss_val': 0.2795525795350419, 'psi': 0.925965147821219}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=1.742851 cos_to_last_merge=0.9979 (last merge round=43)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.6199346652271516, 'auprc': 0.7973946976232086, 'loss_val': 0.6153056620132167, 'psi': 0.6909186781855744}-{'f1_val': 0.623482103328717, 'auprc': 0.7979772986435446, 'loss_val': 0.6202149145267681, 'psi': 0.6932801814546481}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=2.311922 cos_to_last_merge=0.9951 (last merge round=42)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.999583825982128, 'loss_val': 0.024741604280209686, 'psi': 0.9956346050845237}-{'f1_val': 0.9950246274718425, 'auprc': 0.9991098759285986, 'loss_val': 0.023329901496096622, 'psi': 0.996658726854545}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=2.289168 (no previous merge yet)
[S9] round=72 local utility u=0.031930 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9973789087225099, 'loss_val': 0.017500772076409907, 'psi': 0.9970085295534129}-{'f1_val': 0.9892013548861434, 'auprc': 0.9985512272832191, 'loss_val': 0.0395171057616381, 'psi': 0.9929413038449737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=72 head_norm_before_train=2.190656 cos_to_last_merge=0.9961 (last merge round=39)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9953893093151523, 'loss_val': 0.027284405407715383, 'psi': 0.9948731878050976}-{'f1_val': 0.9945291067983943, 'auprc': 0.9954268001150075, 'loss_val': 0.027178606739516314, 'psi': 0.9948881841250397}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=1.770072 cos_to_last_merge=0.9627 (last merge round=35)
[S11] round=72 local utility u=0.000490 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985709619035269, 'loss_val': 0.02226951596126722, 'psi': 0.9971085897093963}-{'f1_val': 0.996305167468861, 'auprc': 0.9983869293275981, 'loss_val': 0.023726997492668933, 'psi': 0.9971378722123558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=72 head_norm_before_train=2.192453 (no previous merge yet)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.5551016951008059, 'auprc': 0.6517341866295565, 'loss_val': 1.9286504675849825, 'psi': 0.5937546917123062}-{'f1_val': 0.7704261236182152, 'auprc': 0.773001505249108, 'loss_val': 1.1270714700499969, 'psi': 0.7714562762705723}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=1.757387 cos_to_last_merge=0.9910 (last merge round=42)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9961020416842007, 'auprc': 0.9990263053220952, 'loss_val': 0.02445995418608703, 'psi': 0.9972717471393586}-{'f1_val': 0.9963222473248441, 'auprc': 0.9989010918192684, 'loss_val': 0.024863330029737056, 'psi': 0.9973537851226137}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=1.923612 cos_to_last_merge=0.9857 (last merge round=42)
[S15] round=72 local utility u=0.103408 metrics={'f1_val': 0.963671457910184, 'auprc': 0.9972874525797703, 'loss_val': 0.0683211573676409, 'psi': 0.9771178557780186}-{'f1_val': 0.9372665255493237, 'auprc': 0.9973023957647302, 'loss_val': 0.116752366133397, 'psi': 0.9612808736354863}
[S15] not sending this round → trigger blocked (psi=0.977)
[S16] START round=72 head_norm_before_train=1.759177 cos_to_last_merge=0.9920 (last merge round=42)
[S16] round=72 local utility u=0.346887 metrics={'f1_val': 0.9913361711213216, 'auprc': 0.9844390262873671, 'loss_val': 0.04600727883076168, 'psi': 0.9885773131877398}-{'f1_val': 0.9359683613924629, 'auprc': 0.9773948411185436, 'loss_val': 0.38644188945385094, 'psi': 0.9525389532828952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=72 head_norm_before_train=2.034784 cos_to_last_merge=0.9522 (last merge round=42)
[S17] round=72 local utility u=0.186681 metrics={'f1_val': 0.8750335376103203, 'auprc': 0.8564843471056504, 'loss_val': 0.5079926474541556, 'psi': 0.8676138614084523}-{'f1_val': 0.8422770905331893, 'auprc': 0.8557163630951776, 'loss_val': 0.6825117703062278, 'psi': 0.8476527995579846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=73 head_norm_before_train=2.080391 cos_to_last_merge=0.7496 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.750
[S2] round=73 local utility u=0.013174 metrics={'f1_val': 0.7209421402222307, 'auprc': 0.7022502819621457, 'loss_val': 1.0627240098173167, 'psi': 0.7134653969181967}-{'f1_val': 0.72059017588537, 'auprc': 0.7006071956727046, 'loss_val': 1.0820299751548468, 'psi': 0.7125969838003039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=73 head_norm_before_train=2.294058 cos_to_last_merge=0.9965 (last merge round=43)
[S3] round=73 local utility u=0.271966 metrics={'f1_val': 0.9969869110332736, 'auprc': 0.9987831112025879, 'loss_val': 0.02312709218979347, 'psi': 0.9977053911009993}-{'f1_val': 0.9592141584139489, 'auprc': 0.9429265156869417, 'loss_val': 0.17285377492245768, 'psi': 0.9526991013231461}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=73 head_norm_before_train=1.854202 cos_to_last_merge=0.9880 (last merge round=41)
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.6204826712410331, 'auprc': 0.918112382972848, 'loss_val': 0.8119513680727718, 'psi': 0.739534555933759}-{'f1_val': 0.8516911685546791, 'auprc': 0.933856193662302, 'loss_val': 0.4770475698668677, 'psi': 0.8845571785977282}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=1.806172 cos_to_last_merge=0.9405 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9961714921856497, 'loss_val': 0.028059297095584287, 'psi': 0.9961802108598465}-{'f1_val': 0.996186023309311, 'auprc': 0.9982956876000171, 'loss_val': 0.027412245725451215, 'psi': 0.9970298890255934}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=2.387882 (no previous merge yet)
[S6] round=73 local utility u=0.230819 metrics={'f1_val': 0.8207197164295877, 'auprc': 0.9487257109569026, 'loss_val': 0.4486086365788336, 'psi': 0.8719221142405137}-{'f1_val': 0.7986501236274638, 'auprc': 0.9360934149332715, 'loss_val': 0.739932113179651, 'psi': 0.8536274401497869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=73 head_norm_before_train=1.747209 cos_to_last_merge=0.9977 (last merge round=43)
[S7] round=73 local utility u=0.337889 metrics={'f1_val': 0.670576435377332, 'auprc': 0.825699794165539, 'loss_val': 0.3282938324347647, 'psi': 0.7326257788926148}-{'f1_val': 0.6199346652271516, 'auprc': 0.7973946976232086, 'loss_val': 0.6153056620132167, 'psi': 0.6909186781855744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=73 head_norm_before_train=2.316805 cos_to_last_merge=0.9948 (last merge round=42)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9895700826501451, 'auprc': 0.9995719358362467, 'loss_val': 0.03213085257688121, 'psi': 0.9935708239245857}-{'f1_val': 0.9930017911527874, 'auprc': 0.999583825982128, 'loss_val': 0.024741604280209686, 'psi': 0.9956346050845237}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=2.295096 (no previous merge yet)
[S9] round=73 local utility u=0.000557 metrics={'f1_val': 0.9967908009243918, 'auprc': 0.9975988977395447, 'loss_val': 0.017222525226066057, 'psi': 0.997114039650453}-{'f1_val': 0.9967616101073482, 'auprc': 0.9973789087225099, 'loss_val': 0.017500772076409907, 'psi': 0.9970085295534129}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=73 head_norm_before_train=2.192950 cos_to_last_merge=0.9957 (last merge round=39)
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995291209167967, 'loss_val': 0.027114318670676773, 'psi': 0.9948339477462234}-{'f1_val': 0.9945291067983943, 'auprc': 0.9953893093151523, 'loss_val': 0.027284405407715383, 'psi': 0.9948731878050976}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=1.776264 cos_to_last_merge=0.9621 (last merge round=35)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986116178037133, 'loss_val': 0.02301612392589186, 'psi': 0.9971248520694709}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985709619035269, 'loss_val': 0.02226951596126722, 'psi': 0.9971085897093963}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=2.192456 (no previous merge yet)
[S13] round=73 local utility u=1.000000 metrics={'f1_val': 0.7536574481600077, 'auprc': 0.7388779441183869, 'loss_val': 1.1860569093393813, 'psi': 0.7477456465433594}-{'f1_val': 0.5551016951008059, 'auprc': 0.6517341866295565, 'loss_val': 1.9286504675849825, 'psi': 0.5937546917123062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=73 head_norm_before_train=1.763704 cos_to_last_merge=0.9907 (last merge round=42)
[S14] round=73 local utility u=0.003449 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9990436141527268, 'loss_val': 0.023861813835367344, 'psi': 0.9979034170989702}-{'f1_val': 0.9961020416842007, 'auprc': 0.9990263053220952, 'loss_val': 0.02445995418608703, 'psi': 0.9972717471393586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=73 head_norm_before_train=1.931658 cos_to_last_merge=0.9853 (last merge round=42)
[S15] round=73 local utility u=0.025310 metrics={'f1_val': 0.9700305310795656, 'auprc': 0.9972683381546024, 'loss_val': 0.055798313466615526, 'psi': 0.9809256539095803}-{'f1_val': 0.963671457910184, 'auprc': 0.9972874525797703, 'loss_val': 0.0683211573676409, 'psi': 0.9771178557780186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=73 head_norm_before_train=1.764715 cos_to_last_merge=0.9917 (last merge round=42)
[S16] round=73 local utility u=0.012697 metrics={'f1_val': 0.9914837993992816, 'auprc': 0.992083188794115, 'loss_val': 0.044432085392551245, 'psi': 0.9917235551572149}-{'f1_val': 0.9913361711213216, 'auprc': 0.9844390262873671, 'loss_val': 0.04600727883076168, 'psi': 0.9885773131877398}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=73 head_norm_before_train=2.044633 cos_to_last_merge=0.9514 (last merge round=42)
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.8596063019120413, 'auprc': 0.8555355438146577, 'loss_val': 0.568465438847857, 'psi': 0.8579779986730879}-{'f1_val': 0.8750335376103203, 'auprc': 0.8564843471056504, 'loss_val': 0.5079926474541556, 'psi': 0.8676138614084523}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=2.088790 cos_to_last_merge=0.7489 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.749
[S2] round=74 local utility u=0.000000 metrics={'f1_val': 0.7196577353138458, 'auprc': 0.7039796179648383, 'loss_val': 1.0984534130450772, 'psi': 0.7133864883742428}-{'f1_val': 0.7209421402222307, 'auprc': 0.7022502819621457, 'loss_val': 1.0627240098173167, 'psi': 0.7134653969181967}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=74 head_norm_before_train=2.298885 cos_to_last_merge=0.9964 (last merge round=43)
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.972865017655, 'auprc': 0.9979650395913127, 'loss_val': 0.07020950684652931, 'psi': 0.9829050264295252}-{'f1_val': 0.9969869110332736, 'auprc': 0.9987831112025879, 'loss_val': 0.02312709218979347, 'psi': 0.9977053911009993}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=1.855712 cos_to_last_merge=0.9879 (last merge round=41)
[S4] round=74 local utility u=1.000000 metrics={'f1_val': 0.9527567409010432, 'auprc': 0.9477089106626216, 'loss_val': 0.35406248047668376, 'psi': 0.9507376088056747}-{'f1_val': 0.6204826712410331, 'auprc': 0.918112382972848, 'loss_val': 0.8119513680727718, 'psi': 0.739534555933759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=74 head_norm_before_train=1.815709 cos_to_last_merge=0.9397 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=74 local utility u=0.003036 metrics={'f1_val': 0.996186023309311, 'auprc': 0.998023397313269, 'loss_val': 0.027543088542682427, 'psi': 0.9969209729108942}-{'f1_val': 0.996186023309311, 'auprc': 0.9961714921856497, 'loss_val': 0.028059297095584287, 'psi': 0.9961802108598465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=74 head_norm_before_train=2.398743 (no previous merge yet)
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.7769512572430112, 'auprc': 0.9111518477148082, 'loss_val': 0.9024022280910281, 'psi': 0.83063149343173}-{'f1_val': 0.8207197164295877, 'auprc': 0.9487257109569026, 'loss_val': 0.4486086365788336, 'psi': 0.8719221142405137}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=74 head_norm_before_train=1.750412 cos_to_last_merge=0.9976 (last merge round=43)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.6552973676551119, 'auprc': 0.8115623679743619, 'loss_val': 0.3831417699291273, 'psi': 0.717803367782812}-{'f1_val': 0.670576435377332, 'auprc': 0.825699794165539, 'loss_val': 0.3282938324347647, 'psi': 0.7326257788926148}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=2.320668 cos_to_last_merge=0.9946 (last merge round=42)
[S8] round=74 local utility u=0.020020 metrics={'f1_val': 0.9950246274718425, 'auprc': 0.9993497330295152, 'loss_val': 0.024151903741548422, 'psi': 0.9967546696949117}-{'f1_val': 0.9895700826501451, 'auprc': 0.9995719358362467, 'loss_val': 0.03213085257688121, 'psi': 0.9935708239245857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=74 head_norm_before_train=2.299667 (no previous merge yet)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9927489669882278, 'auprc': 0.9987839397629661, 'loss_val': 0.023833716444509004, 'psi': 0.9951629560981231}-{'f1_val': 0.9967908009243918, 'auprc': 0.9975988977395447, 'loss_val': 0.017222525226066057, 'psi': 0.997114039650453}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.198891 cos_to_last_merge=0.9957 (last merge round=39)
[S10] round=74 local utility u=0.001498 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9958052202968467, 'loss_val': 0.026977080325387367, 'psi': 0.9951712536503622}-{'f1_val': 0.9945291067983943, 'auprc': 0.995291209167967, 'loss_val': 0.027114318670676773, 'psi': 0.9948339477462234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=74 head_norm_before_train=1.781609 cos_to_last_merge=0.9616 (last merge round=35)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984322282025075, 'loss_val': 0.02272357889967325, 'psi': 0.9970530962289886}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986116178037133, 'loss_val': 0.02301612392589186, 'psi': 0.9971248520694709}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=2.193128 (no previous merge yet)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.7031641193405425, 'auprc': 0.748060481421152, 'loss_val': 1.3735730248262987, 'psi': 0.7211226641727864}-{'f1_val': 0.7536574481600077, 'auprc': 0.7388779441183869, 'loss_val': 1.1860569093393813, 'psi': 0.7477456465433594}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=1.769874 cos_to_last_merge=0.9904 (last merge round=42)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.995895031877837, 'auprc': 0.9990335094777016, 'loss_val': 0.028080273099564918, 'psi': 0.9971504229177829}-{'f1_val': 0.9971432857297993, 'auprc': 0.9990436141527268, 'loss_val': 0.023861813835367344, 'psi': 0.9979034170989702}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=1.939451 cos_to_last_merge=0.9849 (last merge round=42)
[S15] round=74 local utility u=0.041404 metrics={'f1_val': 0.9810700326853032, 'auprc': 0.9972530509826065, 'loss_val': 0.039181786328470275, 'psi': 0.9875432400042246}-{'f1_val': 0.9700305310795656, 'auprc': 0.9972683381546024, 'loss_val': 0.055798313466615526, 'psi': 0.9809256539095803}
[S15] not sending this round → trigger blocked (psi=0.988)
[S16] START round=74 head_norm_before_train=1.770290 cos_to_last_merge=0.9915 (last merge round=42)
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9760598493093653, 'auprc': 0.9801755406865935, 'loss_val': 0.09606509670313915, 'psi': 0.9777061258602566}-{'f1_val': 0.9914837993992816, 'auprc': 0.992083188794115, 'loss_val': 0.044432085392551245, 'psi': 0.9917235551572149}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=2.054725 cos_to_last_merge=0.9506 (last merge round=42)
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.8511890426142616, 'auprc': 0.849850122162614, 'loss_val': 0.5407165251088336, 'psi': 0.8506534744336025}-{'f1_val': 0.8596063019120413, 'auprc': 0.8555355438146577, 'loss_val': 0.568465438847857, 'psi': 0.8579779986730879}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=2.099790 cos_to_last_merge=0.7481 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.748
[S2] round=75 local utility u=0.031441 metrics={'f1_val': 0.7206639238528042, 'auprc': 0.7104926327261012, 'loss_val': 1.0611466437456851, 'psi': 0.716595407402123}-{'f1_val': 0.7196577353138458, 'auprc': 0.7039796179648383, 'loss_val': 1.0984534130450772, 'psi': 0.7133864883742428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=75 head_norm_before_train=2.302535 cos_to_last_merge=0.9963 (last merge round=43)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9959796534409173, 'loss_val': 0.13597612874489273, 'psi': 0.9749893138560686}-{'f1_val': 0.972865017655, 'auprc': 0.9979650395913127, 'loss_val': 0.07020950684652931, 'psi': 0.9829050264295252}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.857813 cos_to_last_merge=0.9877 (last merge round=41)
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9529333483419697, 'auprc': 0.9442593811265159, 'loss_val': 0.3567270283458749, 'psi': 0.9494637614557883}-{'f1_val': 0.9527567409010432, 'auprc': 0.9477089106626216, 'loss_val': 0.35406248047668376, 'psi': 0.9507376088056747}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=1.828385 cos_to_last_merge=0.9387 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9946373262597785, 'loss_val': 0.027253070498232425, 'psi': 0.995566544489498}-{'f1_val': 0.996186023309311, 'auprc': 0.998023397313269, 'loss_val': 0.027543088542682427, 'psi': 0.9969209729108942}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=2.408442 (no previous merge yet)
[S6] round=75 local utility u=0.371761 metrics={'f1_val': 0.8214476484826752, 'auprc': 0.9409582248023725, 'loss_val': 0.5152785063653419, 'psi': 0.8692518790105541}-{'f1_val': 0.7769512572430112, 'auprc': 0.9111518477148082, 'loss_val': 0.9024022280910281, 'psi': 0.83063149343173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=75 head_norm_before_train=1.753709 cos_to_last_merge=0.9975 (last merge round=43)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.6226882033426342, 'auprc': 0.7981567546228313, 'loss_val': 0.5766067951985798, 'psi': 0.692875623854713}-{'f1_val': 0.6552973676551119, 'auprc': 0.8115623679743619, 'loss_val': 0.3831417699291273, 'psi': 0.717803367782812}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=2.325908 cos_to_last_merge=0.9943 (last merge round=42)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9393451450786504, 'auprc': 0.9992226197307208, 'loss_val': 0.13148540801029565, 'psi': 0.9632961349394785}-{'f1_val': 0.9950246274718425, 'auprc': 0.9993497330295152, 'loss_val': 0.024151903741548422, 'psi': 0.9967546696949117}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=2.302964 (no previous merge yet)
[S9] round=75 local utility u=0.012217 metrics={'f1_val': 0.9965405347871763, 'auprc': 0.9974596080053211, 'loss_val': 0.018175461402295333, 'psi': 0.9969081640744342}-{'f1_val': 0.9927489669882278, 'auprc': 0.9987839397629661, 'loss_val': 0.023833716444509004, 'psi': 0.9951629560981231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=75 head_norm_before_train=2.205966 cos_to_last_merge=0.9957 (last merge round=39)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9953887677437518, 'loss_val': 0.027541839288601773, 'psi': 0.9948729711765374}-{'f1_val': 0.9947486092193725, 'auprc': 0.9958052202968467, 'loss_val': 0.026977080325387367, 'psi': 0.9951712536503622}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=1.785910 cos_to_last_merge=0.9611 (last merge round=35)
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9985290659953361, 'loss_val': 0.024549338700279016, 'psi': 0.9969467291192828}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984322282025075, 'loss_val': 0.02272357889967325, 'psi': 0.9970530962289886}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=2.194273 (no previous merge yet)
[S13] round=75 local utility u=0.422091 metrics={'f1_val': 0.7165558902147522, 'auprc': 0.8902172248889962, 'loss_val': 1.0362123416558024, 'psi': 0.7860204240844498}-{'f1_val': 0.7031641193405425, 'auprc': 0.748060481421152, 'loss_val': 1.3735730248262987, 'psi': 0.7211226641727864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=75 head_norm_before_train=1.775273 cos_to_last_merge=0.9902 (last merge round=42)
[S14] round=75 local utility u=0.004608 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9989795655614309, 'loss_val': 0.02372779780924618, 'psi': 0.9976313407239689}-{'f1_val': 0.995895031877837, 'auprc': 0.9990335094777016, 'loss_val': 0.028080273099564918, 'psi': 0.9971504229177829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=75 head_norm_before_train=1.947039 cos_to_last_merge=0.9846 (last merge round=42)
[S15] round=75 local utility u=0.013634 metrics={'f1_val': 0.9849521591821299, 'auprc': 0.9973742127636065, 'loss_val': 0.03557036275189072, 'psi': 0.9899209806147204}-{'f1_val': 0.9810700326853032, 'auprc': 0.9972530509826065, 'loss_val': 0.039181786328470275, 'psi': 0.9875432400042246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=75 head_norm_before_train=1.774182 cos_to_last_merge=0.9911 (last merge round=42)
[S16] round=75 local utility u=0.072797 metrics={'f1_val': 0.9908332017420798, 'auprc': 0.9820446804773244, 'loss_val': 0.044718856126603306, 'psi': 0.9873177932361776}-{'f1_val': 0.9760598493093653, 'auprc': 0.9801755406865935, 'loss_val': 0.09606509670313915, 'psi': 0.9777061258602566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=75 head_norm_before_train=2.062553 cos_to_last_merge=0.9498 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.950
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.838069006489499, 'auprc': 0.8396099456489645, 'loss_val': 0.752048550084145, 'psi': 0.8386853821532851}-{'f1_val': 0.8511890426142616, 'auprc': 0.849850122162614, 'loss_val': 0.5407165251088336, 'psi': 0.8506534744336025}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=76 head_norm_before_train=2.104985 cos_to_last_merge=0.7476 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.748
[S2] round=76 local utility u=0.024012 metrics={'f1_val': 0.7209023457746471, 'auprc': 0.7154129411032695, 'loss_val': 1.0293132956336704, 'psi': 0.718706583906096}-{'f1_val': 0.7206639238528042, 'auprc': 0.7104926327261012, 'loss_val': 1.0611466437456851, 'psi': 0.716595407402123}
[S2] not sending this round → trigger blocked (psi=0.719)
[S3] START round=76 head_norm_before_train=2.305873 cos_to_last_merge=0.9962 (last merge round=43)
[S3] round=76 local utility u=0.169256 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9975588586796029, 'loss_val': 0.017976856739553033, 'psi': 0.9971985670336383}-{'f1_val': 0.960995754132836, 'auprc': 0.9959796534409173, 'loss_val': 0.13597612874489273, 'psi': 0.9749893138560686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=76 head_norm_before_train=1.859967 cos_to_last_merge=0.9874 (last merge round=41)
[S4] round=76 local utility u=0.011786 metrics={'f1_val': 0.9481059104300789, 'auprc': 0.9604903647295524, 'loss_val': 0.35288410297478756, 'psi': 0.9530596921498682}-{'f1_val': 0.9529333483419697, 'auprc': 0.9442593811265159, 'loss_val': 0.3567270283458749, 'psi': 0.9494637614557883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=76 head_norm_before_train=1.835984 cos_to_last_merge=0.9373 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.9914709382062592, 'loss_val': 0.029131212037111973, 'psi': 0.9944756493665897}-{'f1_val': 0.996186023309311, 'auprc': 0.9946373262597785, 'loss_val': 0.027253070498232425, 'psi': 0.995566544489498}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=2.418503 (no previous merge yet)
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.7316295734371556, 'auprc': 0.8961311867241752, 'loss_val': 1.053360917813922, 'psi': 0.7974302187519635}-{'f1_val': 0.8214476484826752, 'auprc': 0.9409582248023725, 'loss_val': 0.5152785063653419, 'psi': 0.8692518790105541}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.756220 cos_to_last_merge=0.9974 (last merge round=43)
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.6165263563514132, 'auprc': 0.7920295318786751, 'loss_val': 0.7539296701794216, 'psi': 0.6867276265623179}-{'f1_val': 0.6226882033426342, 'auprc': 0.7981567546228313, 'loss_val': 0.5766067951985798, 'psi': 0.692875623854713}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=2.329173 cos_to_last_merge=0.9941 (last merge round=42)
[S8] round=76 local utility u=0.221946 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9995968422493307, 'loss_val': 0.021655683401884642, 'psi': 0.9967397074464742}-{'f1_val': 0.9393451450786504, 'auprc': 0.9992226197307208, 'loss_val': 0.13148540801029565, 'psi': 0.9632961349394785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=76 head_norm_before_train=2.306053 (no previous merge yet)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9956852630438562, 'loss_val': 0.0186406780168411, 'psi': 0.9963310712819514}-{'f1_val': 0.9965405347871763, 'auprc': 0.9974596080053211, 'loss_val': 0.018175461402295333, 'psi': 0.9969081640744342}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.205709 cos_to_last_merge=0.9952 (last merge round=39)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9953227123153416, 'loss_val': 0.027675981689686695, 'psi': 0.9948465490051732}-{'f1_val': 0.9945291067983943, 'auprc': 0.9953887677437518, 'loss_val': 0.027541839288601773, 'psi': 0.9948729711765374}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=1.791491 cos_to_last_merge=0.9606 (last merge round=35)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983009528625933, 'loss_val': 0.025708450237273178, 'psi': 0.9970005860930229}-{'f1_val': 0.9958918378685807, 'auprc': 0.9985290659953361, 'loss_val': 0.024549338700279016, 'psi': 0.9969467291192828}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=76 head_norm_before_train=2.193878 (no previous merge yet)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.7101941150584701, 'auprc': 0.7119662203674361, 'loss_val': 1.2403039953916168, 'psi': 0.7109029571820564}-{'f1_val': 0.7165558902147522, 'auprc': 0.8902172248889962, 'loss_val': 1.0362123416558024, 'psi': 0.7860204240844498}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=1.776933 cos_to_last_merge=0.9900 (last merge round=42)
[S14] round=76 local utility u=0.000282 metrics={'f1_val': 0.9969258043412784, 'auprc': 0.9988789946504697, 'loss_val': 0.024022092784783244, 'psi': 0.9977070804649549}-{'f1_val': 0.9967325241656609, 'auprc': 0.9989795655614309, 'loss_val': 0.02372779780924618, 'psi': 0.9976313407239689}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=76 head_norm_before_train=1.954506 cos_to_last_merge=0.9842 (last merge round=42)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.9806357866875467, 'auprc': 0.9976241242223947, 'loss_val': 0.040191586060279894, 'psi': 0.987431121701486}-{'f1_val': 0.9849521591821299, 'auprc': 0.9973742127636065, 'loss_val': 0.03557036275189072, 'psi': 0.9899209806147204}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=1.778029 cos_to_last_merge=0.9909 (last merge round=42)
[S16] round=76 local utility u=0.014160 metrics={'f1_val': 0.990024649341821, 'auprc': 0.993424979788518, 'loss_val': 0.04568750913210624, 'psi': 0.9913847815204998}-{'f1_val': 0.9908332017420798, 'auprc': 0.9820446804773244, 'loss_val': 0.044718856126603306, 'psi': 0.9873177932361776}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=76 head_norm_before_train=2.066815 cos_to_last_merge=0.9491 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.949
[S17] round=76 local utility u=0.202546 metrics={'f1_val': 0.8521928356367721, 'auprc': 0.8724145823505498, 'loss_val': 0.5301132349944283, 'psi': 0.8602815343222832}-{'f1_val': 0.838069006489499, 'auprc': 0.8396099456489645, 'loss_val': 0.752048550084145, 'psi': 0.8386853821532851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=77 head_norm_before_train=2.107619 cos_to_last_merge=0.7475 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.747
[S2] round=77 local utility u=0.301195 metrics={'f1_val': 0.7123873599899018, 'auprc': 0.8295600012103143, 'loss_val': 0.7182752303047789, 'psi': 0.7592564164780669}-{'f1_val': 0.7209023457746471, 'auprc': 0.7154129411032695, 'loss_val': 1.0293132956336704, 'psi': 0.718706583906096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=77 head_norm_before_train=2.309306 cos_to_last_merge=0.9961 (last merge round=43)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.9619616648309319, 'auprc': 0.9974336393514873, 'loss_val': 0.09623498003484748, 'psi': 0.9761504546391541}-{'f1_val': 0.9969583726029951, 'auprc': 0.9975588586796029, 'loss_val': 0.017976856739553033, 'psi': 0.9971985670336383}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=1.861643 cos_to_last_merge=0.9870 (last merge round=41)
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9418790913664952, 'auprc': 0.9435098535498224, 'loss_val': 0.359357808628661, 'psi': 0.9425313962398261}-{'f1_val': 0.9481059104300789, 'auprc': 0.9604903647295524, 'loss_val': 0.35288410297478756, 'psi': 0.9530596921498682}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.835933 cos_to_last_merge=0.9361 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=77 local utility u=0.008580 metrics={'f1_val': 0.9959673157242839, 'auprc': 0.9977901385135621, 'loss_val': 0.027859852828291506, 'psi': 0.9966964448399951}-{'f1_val': 0.9964787901401435, 'auprc': 0.9914709382062592, 'loss_val': 0.029131212037111973, 'psi': 0.9944756493665897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=77 head_norm_before_train=2.429824 (no previous merge yet)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.7014056772933576, 'auprc': 0.8636932554175801, 'loss_val': 1.2143974980070646, 'psi': 0.7663207085430466}-{'f1_val': 0.7316295734371556, 'auprc': 0.8961311867241752, 'loss_val': 1.053360917813922, 'psi': 0.7974302187519635}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.760745 cos_to_last_merge=0.9972 (last merge round=43)
[S7] round=77 local utility u=0.667850 metrics={'f1_val': 0.7141268674796615, 'auprc': 0.8694863529358129, 'loss_val': 0.23620301084690334, 'psi': 0.776270661662122}-{'f1_val': 0.6165263563514132, 'auprc': 0.7920295318786751, 'loss_val': 0.7539296701794216, 'psi': 0.6867276265623179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=77 head_norm_before_train=2.331607 cos_to_last_merge=0.9938 (last merge round=42)
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9996264428950319, 'loss_val': 0.021800958328863584, 'psi': 0.9967515477047547}-{'f1_val': 0.9948349509112366, 'auprc': 0.9995968422493307, 'loss_val': 0.021655683401884642, 'psi': 0.9967397074464742}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=77 head_norm_before_train=2.307567 (no previous merge yet)
[S9] round=77 local utility u=0.000110 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9973010666715831, 'loss_val': 0.023267773104901492, 'psi': 0.9969773927330422}-{'f1_val': 0.9967616101073482, 'auprc': 0.9956852630438562, 'loss_val': 0.0186406780168411, 'psi': 0.9963310712819514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=77 head_norm_before_train=2.207083 cos_to_last_merge=0.9947 (last merge round=39)
[S10] round=77 local utility u=0.000177 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9953289629308522, 'loss_val': 0.027340879624900612, 'psi': 0.9948490492513775}-{'f1_val': 0.9945291067983943, 'auprc': 0.9953227123153416, 'loss_val': 0.027675981689686695, 'psi': 0.9948465490051732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=77 head_norm_before_train=1.796686 cos_to_last_merge=0.9601 (last merge round=35)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9133350253079369, 'auprc': 0.9980725458353729, 'loss_val': 0.1283681429787032, 'psi': 0.9472300335189112}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983009528625933, 'loss_val': 0.025708450237273178, 'psi': 0.9970005860930229}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=2.196459 (no previous merge yet)
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.7243683367766002, 'auprc': 0.7059433684199831, 'loss_val': 1.3098404230623228, 'psi': 0.7169983494339534}-{'f1_val': 0.7101941150584701, 'auprc': 0.7119662203674361, 'loss_val': 1.2403039953916168, 'psi': 0.7109029571820564}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=1.779290 cos_to_last_merge=0.9897 (last merge round=42)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.998815283512166, 'loss_val': 0.023622066931782062, 'psi': 0.9975676342151197}-{'f1_val': 0.9969258043412784, 'auprc': 0.9988789946504697, 'loss_val': 0.024022092784783244, 'psi': 0.9977070804649549}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=1.961799 cos_to_last_merge=0.9839 (last merge round=42)
[S15] round=77 local utility u=0.015479 metrics={'f1_val': 0.9849521591821299, 'auprc': 0.9976440411791188, 'loss_val': 0.03519223183375127, 'psi': 0.9900289119809254}-{'f1_val': 0.9806357866875467, 'auprc': 0.9976241242223947, 'loss_val': 0.040191586060279894, 'psi': 0.987431121701486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=77 head_norm_before_train=1.782979 cos_to_last_merge=0.9906 (last merge round=42)
[S16] round=77 local utility u=0.000178 metrics={'f1_val': 0.990024649341821, 'auprc': 0.993634329300773, 'loss_val': 0.045959145552825174, 'psi': 0.9914685213254018}-{'f1_val': 0.990024649341821, 'auprc': 0.993424979788518, 'loss_val': 0.04568750913210624, 'psi': 0.9913847815204998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=77 head_norm_before_train=2.071228 cos_to_last_merge=0.9484 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.8300782350997244, 'auprc': 0.8811118265714206, 'loss_val': 0.7825208411102761, 'psi': 0.850491671688403}-{'f1_val': 0.8521928356367721, 'auprc': 0.8724145823505498, 'loss_val': 0.5301132349944283, 'psi': 0.8602815343222832}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.109476 cos_to_last_merge=0.7473 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.747
[S2] round=78 local utility u=0.450188 metrics={'f1_val': 0.8229296796311313, 'auprc': 0.8545898541620605, 'loss_val': 0.5562421710325189, 'psi': 0.835593749443503}-{'f1_val': 0.7123873599899018, 'auprc': 0.8295600012103143, 'loss_val': 0.7182752303047789, 'psi': 0.7592564164780669}
[S2] not sending this round → trigger blocked (psi=0.836)
[S3] START round=78 head_norm_before_train=2.312623 cos_to_last_merge=0.9960 (last merge round=43)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.9423648424943778, 'auprc': 0.9477290739659308, 'loss_val': 0.1847642850340108, 'psi': 0.944510535082999}-{'f1_val': 0.9619616648309319, 'auprc': 0.9974336393514873, 'loss_val': 0.09623498003484748, 'psi': 0.9761504546391541}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=1.867999 cos_to_last_merge=0.9867 (last merge round=41)
[S4] round=78 local utility u=0.012933 metrics={'f1_val': 0.9403032403690645, 'auprc': 0.9572047885082555, 'loss_val': 0.365122255079043, 'psi': 0.9470638596247409}-{'f1_val': 0.9418790913664952, 'auprc': 0.9435098535498224, 'loss_val': 0.359357808628661, 'psi': 0.9425313962398261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=78 head_norm_before_train=1.837835 cos_to_last_merge=0.9354 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9955313024030846, 'loss_val': 0.026649210454315838, 'psi': 0.9959241349468204}-{'f1_val': 0.9959673157242839, 'auprc': 0.9977901385135621, 'loss_val': 0.027859852828291506, 'psi': 0.9966964448399951}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=2.440308 (no previous merge yet)
[S6] round=78 local utility u=0.746042 metrics={'f1_val': 0.802504342184612, 'auprc': 0.9355663482358927, 'loss_val': 0.5445251122378498, 'psi': 0.8557291446051243}-{'f1_val': 0.7014056772933576, 'auprc': 0.8636932554175801, 'loss_val': 1.2143974980070646, 'psi': 0.7663207085430466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=78 head_norm_before_train=1.764193 cos_to_last_merge=0.9971 (last merge round=43)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.6337629135003844, 'auprc': 0.7976806927195867, 'loss_val': 0.5979793370872323, 'psi': 0.6993300251880653}-{'f1_val': 0.7141268674796615, 'auprc': 0.8694863529358129, 'loss_val': 0.23620301084690334, 'psi': 0.776270661662122}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=2.337410 cos_to_last_merge=0.9935 (last merge round=42)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.999377747941421, 'loss_val': 0.025987398600023887, 'psi': 0.9954406433692702}-{'f1_val': 0.9948349509112366, 'auprc': 0.9996264428950319, 'loss_val': 0.021800958328863584, 'psi': 0.9967515477047547}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=2.308698 (no previous merge yet)
[S9] round=78 local utility u=0.005188 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9984305866739164, 'loss_val': 0.018745686133078032, 'psi': 0.9976757414788102}-{'f1_val': 0.9967616101073482, 'auprc': 0.9973010666715831, 'loss_val': 0.023267773104901492, 'psi': 0.9969773927330422}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=78 head_norm_before_train=2.213019 cos_to_last_merge=0.9947 (last merge round=39)
[S10] round=78 local utility u=0.000983 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9954413145739264, 'loss_val': 0.027028452220813987, 'psi': 0.9950256913611941}-{'f1_val': 0.9945291067983943, 'auprc': 0.9953289629308522, 'loss_val': 0.027340879624900612, 'psi': 0.9948490492513775}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=78 head_norm_before_train=1.799823 cos_to_last_merge=0.9597 (last merge round=35)
[S11] round=78 local utility u=0.203949 metrics={'f1_val': 0.9698374697316041, 'auprc': 0.9980565278610779, 'loss_val': 0.05943582997264004, 'psi': 0.9811250929833937}-{'f1_val': 0.9133350253079369, 'auprc': 0.9980725458353729, 'loss_val': 0.1283681429787032, 'psi': 0.9472300335189112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=78 head_norm_before_train=2.199108 (no previous merge yet)
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6222841081547578, 'auprc': 0.6512036912700279, 'loss_val': 1.524923862136511, 'psi': 0.6338519414008659}-{'f1_val': 0.7243683367766002, 'auprc': 0.7059433684199831, 'loss_val': 1.3098404230623228, 'psi': 0.7169983494339534}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=1.781246 cos_to_last_merge=0.9895 (last merge round=42)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9984069443410484, 'loss_val': 0.02966566561555041, 'psi': 0.9974022922358159}-{'f1_val': 0.9967358680170888, 'auprc': 0.998815283512166, 'loss_val': 0.023622066931782062, 'psi': 0.9975676342151197}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=1.968853 cos_to_last_merge=0.9836 (last merge round=42)
[S15] round=78 local utility u=0.020654 metrics={'f1_val': 0.9909010870725673, 'auprc': 0.997618790041036, 'loss_val': 0.029502465924738677, 'psi': 0.9935881682599548}-{'f1_val': 0.9849521591821299, 'auprc': 0.9976440411791188, 'loss_val': 0.03519223183375127, 'psi': 0.9900289119809254}
[S15] not sending this round → trigger blocked (psi=0.994)
[S16] START round=78 head_norm_before_train=1.787932 cos_to_last_merge=0.9904 (last merge round=42)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.9921566164524568, 'auprc': 0.9856710881418238, 'loss_val': 0.041927711982264984, 'psi': 0.9895624051282037}-{'f1_val': 0.990024649341821, 'auprc': 0.993634329300773, 'loss_val': 0.045959145552825174, 'psi': 0.9914685213254018}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=2.077671 cos_to_last_merge=0.9476 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=78 local utility u=0.497379 metrics={'f1_val': 0.8931838786726684, 'auprc': 0.9555161522868646, 'loss_val': 0.3896104852961774, 'psi': 0.9181167881183468}-{'f1_val': 0.8300782350997244, 'auprc': 0.8811118265714206, 'loss_val': 0.7825208411102761, 'psi': 0.850491671688403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=79 head_norm_before_train=2.116682 cos_to_last_merge=0.7468 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.747
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.7117643620475295, 'auprc': 0.8447585614744161, 'loss_val': 0.6724009593072212, 'psi': 0.7649620418182841}-{'f1_val': 0.8229296796311313, 'auprc': 0.8545898541620605, 'loss_val': 0.5562421710325189, 'psi': 0.835593749443503}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.765 u=0.0000 p_local=0.1317 f1=0.712 auprc=0.845 bytes=57643
[S3] START round=79 head_norm_before_train=2.316152 cos_to_last_merge=0.9959 (last merge round=43)
[S3] round=79 local utility u=0.316343 metrics={'f1_val': 0.9970158049264538, 'auprc': 0.9983865670281818, 'loss_val': 0.03195738342844725, 'psi': 0.997564109767145}-{'f1_val': 0.9423648424943778, 'auprc': 0.9477290739659308, 'loss_val': 0.1847642850340108, 'psi': 0.944510535082999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=80 psi=0.998 u=0.3163 p_local=0.1058 f1=0.997 auprc=0.998 bytes=62970
[S4] START round=79 head_norm_before_train=1.874444 cos_to_last_merge=0.9862 (last merge round=41)
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9423106791686737, 'auprc': 0.9521027874846139, 'loss_val': 0.3682114074055216, 'psi': 0.9462275224950497}-{'f1_val': 0.9403032403690645, 'auprc': 0.9572047885082555, 'loss_val': 0.365122255079043, 'psi': 0.9470638596247409}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.946 u=0.0000 p_local=0.0711 f1=0.942 auprc=0.952 bytes=57618
[S5] START round=79 head_norm_before_train=1.843163 cos_to_last_merge=0.9345 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=79 local utility u=0.005675 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9987633285235902, 'loss_val': 0.025875609656338484, 'psi': 0.9973048860027304}-{'f1_val': 0.996186023309311, 'auprc': 0.9955313024030846, 'loss_val': 0.026649210454315838, 'psi': 0.9959241349468204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] r=80 psi=0.997 u=0.0057 p_local=0.0030 f1=0.996 auprc=0.999 bytes=57594
[S6] START round=79 head_norm_before_train=2.449640 (no previous merge yet)
[S6] round=79 local utility u=0.797678 metrics={'f1_val': 0.9710185573561775, 'auprc': 0.9791714795098361, 'loss_val': 0.0910693775465581, 'psi': 0.9742797262176409}-{'f1_val': 0.802504342184612, 'auprc': 0.9355663482358927, 'loss_val': 0.5445251122378498, 'psi': 0.8557291446051243}
[S6] not sending this round → trigger blocked (psi=0.974)
[S6] r=80 psi=0.974 u=0.7977 p_local=0.3845 f1=0.971 auprc=0.979 bytes=62905
[S7] START round=79 head_norm_before_train=1.766342 cos_to_last_merge=0.9970 (last merge round=43)
[S7] round=79 local utility u=0.144715 metrics={'f1_val': 0.662499033695143, 'auprc': 0.8039523043453636, 'loss_val': 0.4997805608024179, 'psi': 0.7190803419552312}-{'f1_val': 0.6337629135003844, 'auprc': 0.7976806927195867, 'loss_val': 0.5979793370872323, 'psi': 0.6993300251880653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=80 psi=0.719 u=0.1447 p_local=0.1590 f1=0.662 auprc=0.804 bytes=61189
[S8] START round=79 head_norm_before_train=2.344793 cos_to_last_merge=0.9933 (last merge round=42)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9904584939724955, 'auprc': 0.9994862127461792, 'loss_val': 0.03363623310067958, 'psi': 0.994069581481969}-{'f1_val': 0.9928159069878363, 'auprc': 0.999377747941421, 'loss_val': 0.025987398600023887, 'psi': 0.9954406433692702}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.994 u=0.0000 p_local=0.0493 f1=0.990 auprc=0.999 bytes=55756
[S9] START round=79 head_norm_before_train=2.312024 (no previous merge yet)
[S9] round=79 local utility u=0.000460 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9985131572255148, 'loss_val': 0.01807363831453009, 'psi': 0.9977087696994497}-{'f1_val': 0.9971725113487396, 'auprc': 0.9984305866739164, 'loss_val': 0.018745686133078032, 'psi': 0.9976757414788102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S9] r=80 psi=0.998 u=0.0005 p_local=0.0034 f1=0.997 auprc=0.999 bytes=61149
[S10] START round=79 head_norm_before_train=2.220205 cos_to_last_merge=0.9948 (last merge round=39)
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9952830176362502, 'loss_val': 0.027300146917899934, 'psi': 0.9948306711335366}-{'f1_val': 0.9947486092193725, 'auprc': 0.9954413145739264, 'loss_val': 0.027028452220813987, 'psi': 0.9950256913611941}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.995 u=0.0000 p_local=0.0003 f1=0.995 auprc=0.995 bytes=53958
[S11] START round=79 head_norm_before_train=1.803849 cos_to_last_merge=0.9593 (last merge round=35)
[S11] round=79 local utility u=0.095713 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983327356257161, 'loss_val': 0.02661645845581147, 'psi': 0.9970132991982721}-{'f1_val': 0.9698374697316041, 'auprc': 0.9980565278610779, 'loss_val': 0.05943582997264004, 'psi': 0.9811250929833937}
[S11] not sending this round → trigger blocked (psi=0.997)
[S11] r=80 psi=0.997 u=0.0957 p_local=0.0558 f1=0.996 auprc=0.998 bytes=62939
[S13] START round=79 head_norm_before_train=2.194468 (no previous merge yet)
[S13] round=79 local utility u=0.151178 metrics={'f1_val': 0.6485109515151257, 'auprc': 0.6706995127650034, 'loss_val': 1.4384169749350928, 'psi': 0.6573863760150768}-{'f1_val': 0.6222841081547578, 'auprc': 0.6512036912700279, 'loss_val': 1.524923862136511, 'psi': 0.6338519414008659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S13] r=80 psi=0.657 u=0.1512 p_local=0.1554 f1=0.649 auprc=0.671 bytes=57611
[S14] START round=79 head_norm_before_train=1.784863 cos_to_last_merge=0.9892 (last merge round=42)
[S14] round=79 local utility u=0.002648 metrics={'f1_val': 0.9973343280406688, 'auprc': 0.9986369868389409, 'loss_val': 0.028670156347299927, 'psi': 0.9978553915599777}-{'f1_val': 0.9967325241656609, 'auprc': 0.9984069443410484, 'loss_val': 0.02966566561555041, 'psi': 0.9974022922358159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] r=80 psi=0.998 u=0.0026 p_local=0.0028 f1=0.997 auprc=0.999 bytes=68301
[S15] START round=79 head_norm_before_train=1.975850 cos_to_last_merge=0.9832 (last merge round=42)
[S15] round=79 local utility u=0.019590 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976218930612835, 'loss_val': 0.02540567735098579, 'psi': 0.9970967582570257}-{'f1_val': 0.9909010870725673, 'auprc': 0.997618790041036, 'loss_val': 0.029502465924738677, 'psi': 0.9935881682599548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S15] r=80 psi=0.997 u=0.0196 p_local=0.0361 f1=0.997 auprc=0.998 bytes=57563
[S16] START round=79 head_norm_before_train=1.792074 cos_to_last_merge=0.9900 (last merge round=42)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.9921331317123151, 'auprc': 0.9851674014422475, 'loss_val': 0.04185738320544524, 'psi': 0.9893468396042879}-{'f1_val': 0.9921566164524568, 'auprc': 0.9856710881418238, 'loss_val': 0.041927711982264984, 'psi': 0.9895624051282037}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.989 u=0.0000 p_local=0.0388 f1=0.992 auprc=0.985 bytes=61118
[S17] START round=79 head_norm_before_train=2.081809 cos_to_last_merge=0.9470 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.8745559912087153, 'auprc': 0.953786955243379, 'loss_val': 0.49648464333113906, 'psi': 0.9062483768225809}-{'f1_val': 0.8931838786726684, 'auprc': 0.9555161522868646, 'loss_val': 0.3896104852961774, 'psi': 0.9181167881183468}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.906 u=0.0000 p_local=0.1407 f1=0.875 auprc=0.954 bytes=52246
[S2] START round=80 head_norm_before_train=2.124169 cos_to_last_merge=0.7462 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.746
[S2] round=80 local utility u=0.093857 metrics={'f1_val': 0.7026439372386976, 'auprc': 0.894711279793316, 'loss_val': 0.5798222128991238, 'psi': 0.779470874260545}-{'f1_val': 0.7117643620475295, 'auprc': 0.8447585614744161, 'loss_val': 0.6724009593072212, 'psi': 0.7649620418182841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=80 head_norm_before_train=2.319802 cos_to_last_merge=0.9958 (last merge round=43)
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.9706452019766871, 'auprc': 0.994474288233145, 'loss_val': 0.10100224574591556, 'psi': 0.9801768364792702}-{'f1_val': 0.9970158049264538, 'auprc': 0.9983865670281818, 'loss_val': 0.03195738342844725, 'psi': 0.997564109767145}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.881607 cos_to_last_merge=0.9858 (last merge round=41)
[S4] round=80 local utility u=0.041713 metrics={'f1_val': 0.9539465135025251, 'auprc': 0.9529537490590623, 'loss_val': 0.3571533491741267, 'psi': 0.95354940772514}-{'f1_val': 0.9423106791686737, 'auprc': 0.9521027874846139, 'loss_val': 0.3682114074055216, 'psi': 0.9462275224950497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=80 head_norm_before_train=1.847029 cos_to_last_merge=0.9343 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=80 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9936633552070215, 'loss_val': 0.028372376241395957, 'psi': 0.9951769560683952}-{'f1_val': 0.9963325909888239, 'auprc': 0.9987633285235902, 'loss_val': 0.025875609656338484, 'psi': 0.9973048860027304}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=80 head_norm_before_train=2.459105 (no previous merge yet)
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.8133618722627908, 'auprc': 0.9226607541128301, 'loss_val': 0.7311501240168277, 'psi': 0.8570814250028065}-{'f1_val': 0.9710185573561775, 'auprc': 0.9791714795098361, 'loss_val': 0.0910693775465581, 'psi': 0.9742797262176409}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=1.769973 cos_to_last_merge=0.9968 (last merge round=43)
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.627655473474839, 'auprc': 0.7933682605099217, 'loss_val': 0.6470715757652765, 'psi': 0.6939405882888721}-{'f1_val': 0.662499033695143, 'auprc': 0.8039523043453636, 'loss_val': 0.4997805608024179, 'psi': 0.7190803419552312}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=80 head_norm_before_train=2.349285 cos_to_last_merge=0.9930 (last merge round=42)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9897367044659179, 'auprc': 0.9994845349935835, 'loss_val': 0.036888095647995015, 'psi': 0.9936358366769841}-{'f1_val': 0.9904584939724955, 'auprc': 0.9994862127461792, 'loss_val': 0.03363623310067958, 'psi': 0.994069581481969}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.315978 (no previous merge yet)
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9984134495678371, 'loss_val': 0.021256684543582184, 'psi': 0.9976688866363785}-{'f1_val': 0.9971725113487396, 'auprc': 0.9985131572255148, 'loss_val': 0.01807363831453009, 'psi': 0.9977087696994497}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.227649 cos_to_last_merge=0.9949 (last merge round=39)
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9951206806815839, 'loss_val': 0.027429160022273344, 'psi': 0.9947657363516702}-{'f1_val': 0.9945291067983943, 'auprc': 0.9952830176362502, 'loss_val': 0.027300146917899934, 'psi': 0.9948306711335366}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=1.809117 cos_to_last_merge=0.9588 (last merge round=35)
[S11] round=80 local utility u=0.002165 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985919277329888, 'loss_val': 0.023063872208447602, 'psi': 0.9971169760411811}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983327356257161, 'loss_val': 0.02661645845581147, 'psi': 0.9970132991982721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=80 head_norm_before_train=2.199524 (no previous merge yet)
[S13] round=80 local utility u=0.362643 metrics={'f1_val': 0.6575881945411086, 'auprc': 0.8493050780402739, 'loss_val': 1.3034115234502013, 'psi': 0.7342749479407746}-{'f1_val': 0.6485109515151257, 'auprc': 0.6706995127650034, 'loss_val': 1.4384169749350928, 'psi': 0.6573863760150768}
[S13] not sending this round → trigger blocked (psi=0.734)
[S14] START round=80 head_norm_before_train=1.790050 cos_to_last_merge=0.9889 (last merge round=42)
[S14] round=80 local utility u=0.001249 metrics={'f1_val': 0.9969682102907778, 'auprc': 0.9988427331105151, 'loss_val': 0.024592389460628448, 'psi': 0.9977180194186727}-{'f1_val': 0.9973343280406688, 'auprc': 0.9986369868389409, 'loss_val': 0.028670156347299927, 'psi': 0.9978553915599777}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=80 head_norm_before_train=1.982720 cos_to_last_merge=0.9829 (last merge round=42)
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9921621803925177, 'auprc': 0.9976214857831394, 'loss_val': 0.02847440403407841, 'psi': 0.9943459025487664}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976218930612835, 'loss_val': 0.02540567735098579, 'psi': 0.9970967582570257}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=1.796574 cos_to_last_merge=0.9898 (last merge round=42)
[S16] round=80 local utility u=0.000633 metrics={'f1_val': 0.9921331317123151, 'auprc': 0.9856727484200067, 'loss_val': 0.0421077449289289, 'psi': 0.9895489783953917}-{'f1_val': 0.9921331317123151, 'auprc': 0.9851674014422475, 'loss_val': 0.04185738320544524, 'psi': 0.9893468396042879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=80 head_norm_before_train=2.088793 cos_to_last_merge=0.9463 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.8412653264284854, 'auprc': 0.8227354925691709, 'loss_val': 0.7971941033418273, 'psi': 0.8338533928847596}-{'f1_val': 0.8745559912087153, 'auprc': 0.953786955243379, 'loss_val': 0.49648464333113906, 'psi': 0.9062483768225809}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=81 head_norm_before_train=2.130213 cos_to_last_merge=0.7458 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.746
[S2] round=81 local utility u=0.193550 metrics={'f1_val': 0.7670724579348137, 'auprc': 0.8764833164776529, 'loss_val': 0.524608922850018, 'psi': 0.8108368013519494}-{'f1_val': 0.7026439372386976, 'auprc': 0.894711279793316, 'loss_val': 0.5798222128991238, 'psi': 0.779470874260545}
[S2] not sending this round → trigger blocked (psi=0.811)
[S3] START round=81 head_norm_before_train=2.322837 cos_to_last_merge=0.9957 (last merge round=43)
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.9601864874536103, 'auprc': 0.9361406062937219, 'loss_val': 0.18632605620439593, 'psi': 0.950568134989655}-{'f1_val': 0.9706452019766871, 'auprc': 0.994474288233145, 'loss_val': 0.10100224574591556, 'psi': 0.9801768364792702}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=1.887603 cos_to_last_merge=0.9858 (last merge round=41)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9410320084140887, 'auprc': 0.946310144969774, 'loss_val': 0.3684297899059395, 'psi': 0.9431432630363628}-{'f1_val': 0.9539465135025251, 'auprc': 0.9529537490590623, 'loss_val': 0.3571533491741267, 'psi': 0.95354940772514}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.852601 cos_to_last_merge=0.9340 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=81 local utility u=0.008090 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9980000051123128, 'loss_val': 0.02608174319488313, 'psi': 0.9969995566382194}-{'f1_val': 0.996186023309311, 'auprc': 0.9936633552070215, 'loss_val': 0.028372376241395957, 'psi': 0.9951769560683952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=81 head_norm_before_train=2.469022 (no previous merge yet)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.7868211264494698, 'auprc': 0.9199601939117514, 'loss_val': 0.8433359526481725, 'psi': 0.8400767534343825}-{'f1_val': 0.8133618722627908, 'auprc': 0.9226607541128301, 'loss_val': 0.7311501240168277, 'psi': 0.8570814250028065}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.771303 cos_to_last_merge=0.9967 (last merge round=43)
[S7] round=81 local utility u=0.029718 metrics={'f1_val': 0.625322823602254, 'auprc': 0.7955072753787577, 'loss_val': 0.5800565078975328, 'psi': 0.6933966043128554}-{'f1_val': 0.627655473474839, 'auprc': 0.7933682605099217, 'loss_val': 0.6470715757652765, 'psi': 0.6939405882888721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=81 head_norm_before_train=2.356186 cos_to_last_merge=0.9928 (last merge round=42)
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9800564111482306, 'auprc': 0.9994628147845623, 'loss_val': 0.05307379860157365, 'psi': 0.9878189726027633}-{'f1_val': 0.9897367044659179, 'auprc': 0.9994845349935835, 'loss_val': 0.036888095647995015, 'psi': 0.9936358366769841}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=2.319554 (no previous merge yet)
[S9] round=81 local utility u=0.001219 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9989887772538154, 'loss_val': 0.01807936416888117, 'psi': 0.9976524769659352}-{'f1_val': 0.9971725113487396, 'auprc': 0.9984134495678371, 'loss_val': 0.021256684543582184, 'psi': 0.9976688866363785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=81 head_norm_before_train=2.234028 cos_to_last_merge=0.9949 (last merge round=39)
[S10] round=81 local utility u=0.000242 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9952419946966038, 'loss_val': 0.027309253596082085, 'psi': 0.9948142619576781}-{'f1_val': 0.9945291067983943, 'auprc': 0.9951206806815839, 'loss_val': 0.027429160022273344, 'psi': 0.9947657363516702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=81 head_norm_before_train=1.815064 cos_to_last_merge=0.9583 (last merge round=35)
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.998522397524406, 'loss_val': 0.022782435846392845, 'psi': 0.9969440617309109}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985919277329888, 'loss_val': 0.023063872208447602, 'psi': 0.9971169760411811}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=2.202899 (no previous merge yet)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.6885410810397253, 'auprc': 0.6842859835830475, 'loss_val': 1.3657317551619417, 'psi': 0.6868390420570543}-{'f1_val': 0.6575881945411086, 'auprc': 0.8493050780402739, 'loss_val': 1.3034115234502013, 'psi': 0.7342749479407746}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=1.795543 cos_to_last_merge=0.9887 (last merge round=42)
[S14] round=81 local utility u=0.000294 metrics={'f1_val': 0.9969258043412784, 'auprc': 0.998696132054201, 'loss_val': 0.02331036382295101, 'psi': 0.9976339354264474}-{'f1_val': 0.9969682102907778, 'auprc': 0.9988427331105151, 'loss_val': 0.024592389460628448, 'psi': 0.9977180194186727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=81 head_norm_before_train=1.989235 cos_to_last_merge=0.9826 (last merge round=42)
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.985808594582198, 'auprc': 0.9976171716753446, 'loss_val': 0.033315091819769, 'psi': 0.9905320254194566}-{'f1_val': 0.9921621803925177, 'auprc': 0.9976214857831394, 'loss_val': 0.02847440403407841, 'psi': 0.9943459025487664}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=1.800853 cos_to_last_merge=0.9895 (last merge round=42)
[S16] round=81 local utility u=0.005172 metrics={'f1_val': 0.9921331317123151, 'auprc': 0.9891681087280355, 'loss_val': 0.04224991927498061, 'psi': 0.9909471225186033}-{'f1_val': 0.9921331317123151, 'auprc': 0.9856727484200067, 'loss_val': 0.0421077449289289, 'psi': 0.9895489783953917}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=81 head_norm_before_train=2.095042 cos_to_last_merge=0.9456 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=81 local utility u=0.140838 metrics={'f1_val': 0.8507218541113233, 'auprc': 0.8291495255943749, 'loss_val': 0.5914983937445446, 'psi': 0.842092922704544}-{'f1_val': 0.8412653264284854, 'auprc': 0.8227354925691709, 'loss_val': 0.7971941033418273, 'psi': 0.8338533928847596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=82 head_norm_before_train=2.135168 cos_to_last_merge=0.7454 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.745
[S2] round=82 local utility u=0.074046 metrics={'f1_val': 0.7983844530185978, 'auprc': 0.863133255972844, 'loss_val': 0.5243385796369961, 'psi': 0.8242839742002963}-{'f1_val': 0.7670724579348137, 'auprc': 0.8764833164776529, 'loss_val': 0.524608922850018, 'psi': 0.8108368013519494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=82 head_norm_before_train=2.326484 cos_to_last_merge=0.9956 (last merge round=43)
[S3] round=82 local utility u=0.000258 metrics={'f1_val': 0.9286330793483657, 'auprc': 0.9909741603038396, 'loss_val': 0.1609900433486062, 'psi': 0.9535695117305553}-{'f1_val': 0.9601864874536103, 'auprc': 0.9361406062937219, 'loss_val': 0.18632605620439593, 'psi': 0.950568134989655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=82 head_norm_before_train=1.892633 cos_to_last_merge=0.9860 (last merge round=41)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9409892771564607, 'auprc': 0.9299921217204863, 'loss_val': 0.368451985642291, 'psi': 0.936590414982071}-{'f1_val': 0.9410320084140887, 'auprc': 0.946310144969774, 'loss_val': 0.3684297899059395, 'psi': 0.9431432630363628}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=1.860051 cos_to_last_merge=0.9336 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9916382133034913, 'loss_val': 0.026415518277160755, 'psi': 0.9943668993069832}-{'f1_val': 0.9963325909888239, 'auprc': 0.9980000051123128, 'loss_val': 0.02608174319488313, 'psi': 0.9969995566382194}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=2.478455 (no previous merge yet)
[S6] round=82 local utility u=0.347149 metrics={'f1_val': 0.8270154719950996, 'auprc': 0.9550066932077388, 'loss_val': 0.49534266329273113, 'psi': 0.8782119604801553}-{'f1_val': 0.7868211264494698, 'auprc': 0.9199601939117514, 'loss_val': 0.8433359526481725, 'psi': 0.8400767534343825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=82 head_norm_before_train=1.771678 cos_to_last_merge=0.9967 (last merge round=43)
[S7] round=82 local utility u=0.252716 metrics={'f1_val': 0.6708824321947051, 'auprc': 0.8107931526892354, 'loss_val': 0.39384048499335883, 'psi': 0.7268467203925172}-{'f1_val': 0.625322823602254, 'auprc': 0.7955072753787577, 'loss_val': 0.5800565078975328, 'psi': 0.6933966043128554}
[S7] not sending this round → trigger blocked (psi=0.727)
[S8] START round=82 head_norm_before_train=2.366039 cos_to_last_merge=0.9927 (last merge round=42)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9363911173324877, 'auprc': 0.9964842753006319, 'loss_val': 0.13365765728337625, 'psi': 0.9604283805197454}-{'f1_val': 0.9800564111482306, 'auprc': 0.9994628147845623, 'loss_val': 0.05307379860157365, 'psi': 0.9878189726027633}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=2.324575 (no previous merge yet)
[S9] round=82 local utility u=0.000653 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9991464220721383, 'loss_val': 0.0169861499304161, 'psi': 0.9976894476701137}-{'f1_val': 0.9967616101073482, 'auprc': 0.9989887772538154, 'loss_val': 0.01807936416888117, 'psi': 0.9976524769659352}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=82 head_norm_before_train=2.232628 cos_to_last_merge=0.9943 (last merge round=39)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9952991945192893, 'loss_val': 0.027671999902406902, 'psi': 0.9948371418867523}-{'f1_val': 0.9945291067983943, 'auprc': 0.9952419946966038, 'loss_val': 0.027309253596082085, 'psi': 0.9948142619576781}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=1.821447 cos_to_last_merge=0.9577 (last merge round=35)
[S11] round=82 local utility u=0.001269 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986087072835741, 'loss_val': 0.021955120507212354, 'psi': 0.9971236878614153}-{'f1_val': 0.9958918378685807, 'auprc': 0.998522397524406, 'loss_val': 0.022782435846392845, 'psi': 0.9969440617309109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=82 head_norm_before_train=2.205790 (no previous merge yet)
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6653601110873566, 'auprc': 0.6797646151543634, 'loss_val': 1.4286383185660285, 'psi': 0.6711219127141592}-{'f1_val': 0.6885410810397253, 'auprc': 0.6842859835830475, 'loss_val': 1.3657317551619417, 'psi': 0.6868390420570543}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=1.799082 cos_to_last_merge=0.9884 (last merge round=42)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9986449734660426, 'loss_val': 0.024901215292366982, 'psi': 0.9974995101966704}-{'f1_val': 0.9969258043412784, 'auprc': 0.998696132054201, 'loss_val': 0.02331036382295101, 'psi': 0.9976339354264474}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=1.995522 cos_to_last_merge=0.9823 (last merge round=42)
[S15] round=82 local utility u=0.001682 metrics={'f1_val': 0.9862359745487574, 'auprc': 0.9976211645364264, 'loss_val': 0.032527778421811954, 'psi': 0.990790050543825}-{'f1_val': 0.985808594582198, 'auprc': 0.9976171716753446, 'loss_val': 0.033315091819769, 'psi': 0.9905320254194566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=82 head_norm_before_train=1.805133 cos_to_last_merge=0.9893 (last merge round=42)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.991729783534131, 'auprc': 0.9794377069051486, 'loss_val': 0.047139305659704096, 'psi': 0.986812952882538}-{'f1_val': 0.9921331317123151, 'auprc': 0.9891681087280355, 'loss_val': 0.04224991927498061, 'psi': 0.9909471225186033}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=2.101036 cos_to_last_merge=0.9450 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.826238549281942, 'auprc': 0.8137147155397214, 'loss_val': 0.6493797494643484, 'psi': 0.8212290157850537}-{'f1_val': 0.8507218541113233, 'auprc': 0.8291495255943749, 'loss_val': 0.5914983937445446, 'psi': 0.842092922704544}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=83 head_norm_before_train=2.139541 cos_to_last_merge=0.7450 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.745
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.7012399705557567, 'auprc': 0.8870551579404427, 'loss_val': 0.55907313538136, 'psi': 0.7755660455096312}-{'f1_val': 0.7983844530185978, 'auprc': 0.863133255972844, 'loss_val': 0.5243385796369961, 'psi': 0.8242839742002963}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.330154 cos_to_last_merge=0.9954 (last merge round=43)
[S3] round=83 local utility u=0.058827 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.969083146192039, 'loss_val': 0.17255528151082117, 'psi': 0.9643024128175071}-{'f1_val': 0.9286330793483657, 'auprc': 0.9909741603038396, 'loss_val': 0.1609900433486062, 'psi': 0.9535695117305553}
[S3] not sending this round → trigger blocked (psi=0.964)
[S4] START round=83 head_norm_before_train=1.890985 cos_to_last_merge=0.9856 (last merge round=41)
[S4] round=83 local utility u=0.064561 metrics={'f1_val': 0.9524660609596726, 'auprc': 0.9515557131923125, 'loss_val': 0.3728807758929807, 'psi': 0.9521019218527285}-{'f1_val': 0.9409892771564607, 'auprc': 0.9299921217204863, 'loss_val': 0.368451985642291, 'psi': 0.936590414982071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=83 head_norm_before_train=1.866584 cos_to_last_merge=0.9332 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=83 local utility u=0.004424 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9943940579166377, 'loss_val': 0.025835709078404545, 'psi': 0.9954692371522417}-{'f1_val': 0.996186023309311, 'auprc': 0.9916382133034913, 'loss_val': 0.026415518277160755, 'psi': 0.9943668993069832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=83 head_norm_before_train=2.486417 (no previous merge yet)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.6340960492449853, 'auprc': 0.803880523949255, 'loss_val': 1.4052896382335223, 'psi': 0.7020098391266932}-{'f1_val': 0.8270154719950996, 'auprc': 0.9550066932077388, 'loss_val': 0.49534266329273113, 'psi': 0.8782119604801553}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.774008 cos_to_last_merge=0.9967 (last merge round=43)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.6171530621474358, 'auprc': 0.7901351299577652, 'loss_val': 0.7678406183781747, 'psi': 0.6863458892715676}-{'f1_val': 0.6708824321947051, 'auprc': 0.8107931526892354, 'loss_val': 0.39384048499335883, 'psi': 0.7268467203925172}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=2.372130 cos_to_last_merge=0.9924 (last merge round=42)
[S8] round=83 local utility u=0.234042 metrics={'f1_val': 0.9945903856431277, 'auprc': 0.9995204529338454, 'loss_val': 0.023876941148739204, 'psi': 0.9965624125594148}-{'f1_val': 0.9363911173324877, 'auprc': 0.9964842753006319, 'loss_val': 0.13365765728337625, 'psi': 0.9604283805197454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=83 head_norm_before_train=2.329783 (no previous merge yet)
[S9] round=83 local utility u=0.000043 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9991528697590366, 'loss_val': 0.016918577097545642, 'psi': 0.997692026744873}-{'f1_val': 0.9967181314020974, 'auprc': 0.9991464220721383, 'loss_val': 0.0169861499304161, 'psi': 0.9976894476701137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=83 head_norm_before_train=2.233855 cos_to_last_merge=0.9938 (last merge round=39)
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9951644147113509, 'loss_val': 0.027303632900351725, 'psi': 0.9947832299635769}-{'f1_val': 0.9945291067983943, 'auprc': 0.9952991945192893, 'loss_val': 0.027671999902406902, 'psi': 0.9948371418867523}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=1.826788 cos_to_last_merge=0.9572 (last merge round=35)
[S11] round=83 local utility u=0.000207 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985917673865936, 'loss_val': 0.021490032810638396, 'psi': 0.9971169119026231}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986087072835741, 'loss_val': 0.021955120507212354, 'psi': 0.9971236878614153}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=83 head_norm_before_train=2.216347 (no previous merge yet)
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.6071827567786107, 'auprc': 0.657805618662326, 'loss_val': 1.555218788486639, 'psi': 0.6274319015320968}-{'f1_val': 0.6653601110873566, 'auprc': 0.6797646151543634, 'loss_val': 1.4286383185660285, 'psi': 0.6711219127141592}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=1.800814 cos_to_last_merge=0.9882 (last merge round=42)
[S14] round=83 local utility u=0.002299 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9985503843733109, 'loss_val': 0.021476657860194055, 'psi': 0.997607460110447}-{'f1_val': 0.9967358680170888, 'auprc': 0.9986449734660426, 'loss_val': 0.024901215292366982, 'psi': 0.9974995101966704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=83 head_norm_before_train=2.001815 cos_to_last_merge=0.9820 (last merge round=42)
[S15] round=83 local utility u=0.029384 metrics={'f1_val': 0.9950866547103594, 'auprc': 0.9976308901894054, 'loss_val': 0.026893256143013806, 'psi': 0.9961043489019777}-{'f1_val': 0.9862359745487574, 'auprc': 0.9976211645364264, 'loss_val': 0.032527778421811954, 'psi': 0.990790050543825}
[S15] not sending this round → trigger blocked (psi=0.996)
[S16] START round=83 head_norm_before_train=1.808540 cos_to_last_merge=0.9890 (last merge round=42)
[S16] round=83 local utility u=0.008875 metrics={'f1_val': 0.9921192457842261, 'auprc': 0.9828625897329636, 'loss_val': 0.042001032641413055, 'psi': 0.9884165833637211}-{'f1_val': 0.991729783534131, 'auprc': 0.9794377069051486, 'loss_val': 0.047139305659704096, 'psi': 0.986812952882538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=83 head_norm_before_train=2.107769 cos_to_last_merge=0.9443 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.8121993719800391, 'auprc': 0.816494808264741, 'loss_val': 0.7872560935284412, 'psi': 0.8139175464939199}-{'f1_val': 0.826238549281942, 'auprc': 0.8137147155397214, 'loss_val': 0.6493797494643484, 'psi': 0.8212290157850537}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.141119 cos_to_last_merge=0.7452 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.745
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7251065060263311, 'auprc': 0.8247923527529997, 'loss_val': 0.7380218101068227, 'psi': 0.7649808447169986}-{'f1_val': 0.7012399705557567, 'auprc': 0.8870551579404427, 'loss_val': 0.55907313538136, 'psi': 0.7755660455096312}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.334278 cos_to_last_merge=0.9953 (last merge round=43)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.8208823913093524, 'auprc': 0.9790072038133109, 'loss_val': 0.3105597562107558, 'psi': 0.8841323163109358}-{'f1_val': 0.9611152572344858, 'auprc': 0.969083146192039, 'loss_val': 0.17255528151082117, 'psi': 0.9643024128175071}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=1.889688 cos_to_last_merge=0.9854 (last merge round=41)
[S4] round=84 local utility u=0.025588 metrics={'f1_val': 0.9510197920008887, 'auprc': 0.9668128149563034, 'loss_val': 0.35879767767452675, 'psi': 0.9573370011830546}-{'f1_val': 0.9524660609596726, 'auprc': 0.9515557131923125, 'loss_val': 0.3728807758929807, 'psi': 0.9521019218527285}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=84 head_norm_before_train=1.872896 cos_to_last_merge=0.9329 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=84 local utility u=0.005944 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9980128998596636, 'loss_val': 0.0248045012982031, 'psi': 0.996916773929452}-{'f1_val': 0.996186023309311, 'auprc': 0.9943940579166377, 'loss_val': 0.025835709078404545, 'psi': 0.9954692371522417}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=84 head_norm_before_train=2.495167 (no previous merge yet)
[S6] round=84 local utility u=1.000000 metrics={'f1_val': 0.9608612499851689, 'auprc': 0.9743181834601768, 'loss_val': 0.14824003779187722, 'psi': 0.966244023375172}-{'f1_val': 0.6340960492449853, 'auprc': 0.803880523949255, 'loss_val': 1.4052896382335223, 'psi': 0.7020098391266932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=84 head_norm_before_train=1.775329 cos_to_last_merge=0.9967 (last merge round=43)
[S7] round=84 local utility u=0.068098 metrics={'f1_val': 0.6170974992254691, 'auprc': 0.7938109804305904, 'loss_val': 0.6423385315978232, 'psi': 0.6877828917075176}-{'f1_val': 0.6171530621474358, 'auprc': 0.7901351299577652, 'loss_val': 0.7678406183781747, 'psi': 0.6863458892715676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=84 head_norm_before_train=2.375133 cos_to_last_merge=0.9921 (last merge round=42)
[S8] round=84 local utility u=0.001685 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9995287434243652, 'loss_val': 0.021999640910045325, 'psi': 0.996712467916488}-{'f1_val': 0.9945903856431277, 'auprc': 0.9995204529338454, 'loss_val': 0.023876941148739204, 'psi': 0.9965624125594148}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=84 head_norm_before_train=2.335065 (no previous merge yet)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9959282335575622, 'auprc': 0.9984642072908226, 'loss_val': 0.024193436495145597, 'psi': 0.9969426230508664}-{'f1_val': 0.9967181314020974, 'auprc': 0.9991528697590366, 'loss_val': 0.016918577097545642, 'psi': 0.997692026744873}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.239651 cos_to_last_merge=0.9938 (last merge round=39)
[S10] round=84 local utility u=0.002358 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952608428188421, 'loss_val': 0.026829685252801234, 'psi': 0.9952170405391616}-{'f1_val': 0.9945291067983943, 'auprc': 0.9951644147113509, 'loss_val': 0.027303632900351725, 'psi': 0.9947832299635769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=84 head_norm_before_train=1.832146 cos_to_last_merge=0.9567 (last merge round=35)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985977615693336, 'loss_val': 0.02171087388600175, 'psi': 0.997119309575719}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985917673865936, 'loss_val': 0.021490032810638396, 'psi': 0.9971169119026231}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=2.221621 (no previous merge yet)
[S13] round=84 local utility u=0.752753 metrics={'f1_val': 0.749671436751232, 'auprc': 0.758358740088606, 'loss_val': 1.2063045408816673, 'psi': 0.7531463580861817}-{'f1_val': 0.6071827567786107, 'auprc': 0.657805618662326, 'loss_val': 1.555218788486639, 'psi': 0.6274319015320968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=84 head_norm_before_train=1.805408 cos_to_last_merge=0.9879 (last merge round=42)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9986495027068202, 'loss_val': 0.026814762400561205, 'psi': 0.9981383072386647}-{'f1_val': 0.9969788439352044, 'auprc': 0.9985503843733109, 'loss_val': 0.021476657860194055, 'psi': 0.997607460110447}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.008014 cos_to_last_merge=0.9817 (last merge round=42)
[S15] round=84 local utility u=0.005972 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976379443905822, 'loss_val': 0.024930354279617924, 'psi': 0.9971031787887452}-{'f1_val': 0.9950866547103594, 'auprc': 0.9976308901894054, 'loss_val': 0.026893256143013806, 'psi': 0.9961043489019777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=84 head_norm_before_train=1.813743 cos_to_last_merge=0.9888 (last merge round=42)
[S16] round=84 local utility u=0.009534 metrics={'f1_val': 0.9917207636244626, 'auprc': 0.9897476472372749, 'loss_val': 0.04119698228893955, 'psi': 0.9909315170695876}-{'f1_val': 0.9921192457842261, 'auprc': 0.9828625897329636, 'loss_val': 0.042001032641413055, 'psi': 0.9884165833637211}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=84 head_norm_before_train=2.112054 cos_to_last_merge=0.9435 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.7968130309083877, 'auprc': 0.7736859899571612, 'loss_val': 0.7524406088117658, 'psi': 0.7875622145278971}-{'f1_val': 0.8121993719800391, 'auprc': 0.816494808264741, 'loss_val': 0.7872560935284412, 'psi': 0.8139175464939199}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=2.145509 cos_to_last_merge=0.7450 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.745
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.6857281378655151, 'auprc': 0.6959237158579158, 'loss_val': 1.2295578152344413, 'psi': 0.6898063690624754}-{'f1_val': 0.7251065060263311, 'auprc': 0.8247923527529997, 'loss_val': 0.7380218101068227, 'psi': 0.7649808447169986}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.338260 cos_to_last_merge=0.9952 (last merge round=43)
[S3] round=85 local utility u=0.237344 metrics={'f1_val': 0.896925068578775, 'auprc': 0.9675656087186711, 'loss_val': 0.2578025625210006, 'psi': 0.9251812846347335}-{'f1_val': 0.8208823913093524, 'auprc': 0.9790072038133109, 'loss_val': 0.3105597562107558, 'psi': 0.8841323163109358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=85 head_norm_before_train=1.885194 cos_to_last_merge=0.9857 (last merge round=41)
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9407546898659411, 'auprc': 0.9438429688833447, 'loss_val': 0.36135744503608225, 'psi': 0.9419900014729026}-{'f1_val': 0.9510197920008887, 'auprc': 0.9668128149563034, 'loss_val': 0.35879767767452675, 'psi': 0.9573370011830546}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.880037 cos_to_last_merge=0.9325 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.991720252172182, 'loss_val': 0.026127914703947448, 'psi': 0.9943997148544594}-{'f1_val': 0.996186023309311, 'auprc': 0.9980128998596636, 'loss_val': 0.0248045012982031, 'psi': 0.996916773929452}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=2.503368 (no previous merge yet)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.7640808679394759, 'auprc': 0.8950562708264012, 'loss_val': 1.060069902329451, 'psi': 0.8164710290942461}-{'f1_val': 0.9608612499851689, 'auprc': 0.9743181834601768, 'loss_val': 0.14824003779187722, 'psi': 0.966244023375172}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=85 head_norm_before_train=1.776711 cos_to_last_merge=0.9966 (last merge round=43)
[S7] round=85 local utility u=0.350005 metrics={'f1_val': 0.6734079608846268, 'auprc': 0.8228082383341677, 'loss_val': 0.3671821869926552, 'psi': 0.7331680718644432}-{'f1_val': 0.6170974992254691, 'auprc': 0.7938109804305904, 'loss_val': 0.6423385315978232, 'psi': 0.6877828917075176}
[S7] not sending this round → trigger blocked (psi=0.733)
[S8] START round=85 head_norm_before_train=2.379712 cos_to_last_merge=0.9920 (last merge round=42)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.9936910743895857, 'auprc': 0.9996680957229958, 'loss_val': 0.025232840254281793, 'psi': 0.9960818829229497}-{'f1_val': 0.9948349509112366, 'auprc': 0.9995287434243652, 'loss_val': 0.021999640910045325, 'psi': 0.996712467916488}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=85 head_norm_before_train=2.338130 (no previous merge yet)
[S9] round=85 local utility u=0.006315 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9985790467837358, 'loss_val': 0.019373177187358915, 'psi': 0.997735125522738}-{'f1_val': 0.9959282335575622, 'auprc': 0.9984642072908226, 'loss_val': 0.024193436495145597, 'psi': 0.9969426230508664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=85 head_norm_before_train=2.246696 cos_to_last_merge=0.9939 (last merge round=39)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9950557170562413, 'loss_val': 0.02713534028204146, 'psi': 0.99487145235412}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952608428188421, 'loss_val': 0.026829685252801234, 'psi': 0.9952170405391616}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=1.837084 cos_to_last_merge=0.9562 (last merge round=35)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9986127460421017, 'loss_val': 0.021823340776611085, 'psi': 0.9971253033648263}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985977615693336, 'loss_val': 0.02171087388600175, 'psi': 0.997119309575719}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=2.229362 (no previous merge yet)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.6308433834145524, 'auprc': 0.6699639090296299, 'loss_val': 1.4552252752410562, 'psi': 0.6464915936605833}-{'f1_val': 0.749671436751232, 'auprc': 0.758358740088606, 'loss_val': 1.2063045408816673, 'psi': 0.7531463580861817}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=1.809723 cos_to_last_merge=0.9877 (last merge round=42)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9969687589007382, 'auprc': 0.9985759899041252, 'loss_val': 0.0327521952174136, 'psi': 0.997611651302093}-{'f1_val': 0.9977975102598944, 'auprc': 0.9986495027068202, 'loss_val': 0.026814762400561205, 'psi': 0.9981383072386647}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=2.014035 cos_to_last_merge=0.9814 (last merge round=42)
[S15] round=85 local utility u=0.000074 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976304851806224, 'loss_val': 0.024759304685407737, 'psi': 0.9971001951047613}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976379443905822, 'loss_val': 0.024930354279617924, 'psi': 0.9971031787887452}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=85 head_norm_before_train=1.819316 cos_to_last_merge=0.9886 (last merge round=42)
[S16] round=85 local utility u=0.005166 metrics={'f1_val': 0.9919393555893374, 'auprc': 0.9926612944839642, 'loss_val': 0.04091683222540282, 'psi': 0.9922281311471881}-{'f1_val': 0.9917207636244626, 'auprc': 0.9897476472372749, 'loss_val': 0.04119698228893955, 'psi': 0.9909315170695876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=85 head_norm_before_train=2.115134 cos_to_last_merge=0.9428 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.943
[S17] round=85 local utility u=0.711575 metrics={'f1_val': 0.8825694537361461, 'auprc': 0.9862648083387736, 'loss_val': 0.48156647963604554, 'psi': 0.9240475955771972}-{'f1_val': 0.7968130309083877, 'auprc': 0.7736859899571612, 'loss_val': 0.7524406088117658, 'psi': 0.7875622145278971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=86 head_norm_before_train=2.148631 cos_to_last_merge=0.7444 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.744
[S2] round=86 local utility u=0.351165 metrics={'f1_val': 0.7205131245027989, 'auprc': 0.7751723748325109, 'loss_val': 0.9736846011001412, 'psi': 0.7423768246346838}-{'f1_val': 0.6857281378655151, 'auprc': 0.6959237158579158, 'loss_val': 1.2295578152344413, 'psi': 0.6898063690624754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=86 head_norm_before_train=2.342737 cos_to_last_merge=0.9950 (last merge round=43)
[S3] round=86 local utility u=0.201324 metrics={'f1_val': 0.9525051149225763, 'auprc': 0.9699010489051457, 'loss_val': 0.19564038168095546, 'psi': 0.959463488515604}-{'f1_val': 0.896925068578775, 'auprc': 0.9675656087186711, 'loss_val': 0.2578025625210006, 'psi': 0.9251812846347335}
[S3] not sending this round → trigger blocked (psi=0.959)
[S4] START round=86 head_norm_before_train=1.884795 cos_to_last_merge=0.9851 (last merge round=41)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.6204114642933211, 'auprc': 0.9140555664906438, 'loss_val': 0.8088561190000485, 'psi': 0.7378691051722501}-{'f1_val': 0.9407546898659411, 'auprc': 0.9438429688833447, 'loss_val': 0.36135744503608225, 'psi': 0.9419900014729026}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=1.883641 cos_to_last_merge=0.9326 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=86 local utility u=0.009808 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9978817587716636, 'loss_val': 0.024996222658985663, 'psi': 0.9968643174942521}-{'f1_val': 0.996186023309311, 'auprc': 0.991720252172182, 'loss_val': 0.026127914703947448, 'psi': 0.9943997148544594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=86 head_norm_before_train=2.508021 (no previous merge yet)
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.6432002802655563, 'auprc': 0.6784606363687887, 'loss_val': 1.6268915794390817, 'psi': 0.6573044227068493}-{'f1_val': 0.7640808679394759, 'auprc': 0.8950562708264012, 'loss_val': 1.060069902329451, 'psi': 0.8164710290942461}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=1.780294 cos_to_last_merge=0.9965 (last merge round=43)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.5789620278028498, 'auprc': 0.7820829570727446, 'loss_val': 1.0148111858070081, 'psi': 0.6602103995108077}-{'f1_val': 0.6734079608846268, 'auprc': 0.8228082383341677, 'loss_val': 0.3671821869926552, 'psi': 0.7331680718644432}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=2.383644 cos_to_last_merge=0.9916 (last merge round=42)
[S8] round=86 local utility u=0.005034 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9996361058879963, 'loss_val': 0.02193150770753298, 'psi': 0.9967554129019405}-{'f1_val': 0.9936910743895857, 'auprc': 0.9996680957229958, 'loss_val': 0.025232840254281793, 'psi': 0.9960818829229497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=86 head_norm_before_train=2.342780 (no previous merge yet)
[S9] round=86 local utility u=0.001075 metrics={'f1_val': 0.9967582493480517, 'auprc': 0.9991456201229502, 'loss_val': 0.016436484420929553, 'psi': 0.9977131976580111}-{'f1_val': 0.9971725113487396, 'auprc': 0.9985790467837358, 'loss_val': 0.019373177187358915, 'psi': 0.997735125522738}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=86 head_norm_before_train=2.249425 cos_to_last_merge=0.9936 (last merge round=39)
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995270728342665, 'loss_val': 0.027478807797475167, 'psi': 0.9948257554161026}-{'f1_val': 0.9947486092193725, 'auprc': 0.9950557170562413, 'loss_val': 0.02713534028204146, 'psi': 0.99487145235412}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=1.841095 cos_to_last_merge=0.9558 (last merge round=35)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9985201332722329, 'loss_val': 0.02230684106180661, 'psi': 0.9969431560300416}-{'f1_val': 0.9961336749133093, 'auprc': 0.9986127460421017, 'loss_val': 0.021823340776611085, 'psi': 0.9971253033648263}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=2.236441 (no previous merge yet)
[S13] round=86 local utility u=0.680094 metrics={'f1_val': 0.7408136198810871, 'auprc': 0.8078795925580453, 'loss_val': 1.1686061318908392, 'psi': 0.7676400089518705}-{'f1_val': 0.6308433834145524, 'auprc': 0.6699639090296299, 'loss_val': 1.4552252752410562, 'psi': 0.6464915936605833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=86 head_norm_before_train=1.815486 cos_to_last_merge=0.9874 (last merge round=42)
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9953052378684425, 'auprc': 0.9985754319255219, 'loss_val': 0.033172080802262326, 'psi': 0.9966133154912742}-{'f1_val': 0.9969687589007382, 'auprc': 0.9985759899041252, 'loss_val': 0.0327521952174136, 'psi': 0.997611651302093}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=2.019972 cos_to_last_merge=0.9811 (last merge round=42)
[S15] round=86 local utility u=0.000094 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976387089652634, 'loss_val': 0.024596888915190702, 'psi': 0.9971034846186178}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976304851806224, 'loss_val': 0.024759304685407737, 'psi': 0.9971001951047613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=86 head_norm_before_train=1.823844 cos_to_last_merge=0.9884 (last merge round=42)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9910839032534137, 'auprc': 0.9929787795734205, 'loss_val': 0.042919880783718764, 'psi': 0.9918418537814164}-{'f1_val': 0.9919393555893374, 'auprc': 0.9926612944839642, 'loss_val': 0.04091683222540282, 'psi': 0.9922281311471881}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=2.122055 cos_to_last_merge=0.9422 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.8751027084045295, 'auprc': 0.9665446790819647, 'loss_val': 0.5454073426865291, 'psi': 0.9116794966755036}-{'f1_val': 0.8825694537361461, 'auprc': 0.9862648083387736, 'loss_val': 0.48156647963604554, 'psi': 0.9240475955771972}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.157270 cos_to_last_merge=0.7436 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.744
[S2] round=87 local utility u=0.629716 metrics={'f1_val': 0.7990250894524507, 'auprc': 0.9020663406201666, 'loss_val': 0.5660064598828097, 'psi': 0.840241589919537}-{'f1_val': 0.7205131245027989, 'auprc': 0.7751723748325109, 'loss_val': 0.9736846011001412, 'psi': 0.7423768246346838}
[S2] not sending this round → trigger blocked (psi=0.840)
[S3] START round=87 head_norm_before_train=2.347382 cos_to_last_merge=0.9949 (last merge round=43)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.8068056500141997, 'auprc': 0.9914352439196308, 'loss_val': 0.2875743096619356, 'psi': 0.8806574875763722}-{'f1_val': 0.9525051149225763, 'auprc': 0.9699010489051457, 'loss_val': 0.19564038168095546, 'psi': 0.959463488515604}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=1.888214 cos_to_last_merge=0.9845 (last merge round=41)
[S4] round=87 local utility u=1.000000 metrics={'f1_val': 0.8790940566589054, 'auprc': 0.9546112451656282, 'loss_val': 0.4612976116908536, 'psi': 0.9093009320615946}-{'f1_val': 0.6204114642933211, 'auprc': 0.9140555664906438, 'loss_val': 0.8088561190000485, 'psi': 0.7378691051722501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=87 head_norm_before_train=1.887505 cos_to_last_merge=0.9321 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9978825647462306, 'loss_val': 0.02542064298155498, 'psi': 0.9968646398840788}-{'f1_val': 0.996186023309311, 'auprc': 0.9978817587716636, 'loss_val': 0.024996222658985663, 'psi': 0.9968643174942521}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=2.513518 (no previous merge yet)
[S6] round=87 local utility u=1.000000 metrics={'f1_val': 0.9599530590704938, 'auprc': 0.9708782203080992, 'loss_val': 0.17337162016166727, 'psi': 0.964323123565536}-{'f1_val': 0.6432002802655563, 'auprc': 0.6784606363687887, 'loss_val': 1.6268915794390817, 'psi': 0.6573044227068493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=87 head_norm_before_train=1.782008 cos_to_last_merge=0.9964 (last merge round=43)
[S7] round=87 local utility u=0.484451 metrics={'f1_val': 0.6408395552850314, 'auprc': 0.8073163570606794, 'loss_val': 0.49287538891058963, 'psi': 0.7074302759952906}-{'f1_val': 0.5789620278028498, 'auprc': 0.7820829570727446, 'loss_val': 1.0148111858070081, 'psi': 0.6602103995108077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=87 head_norm_before_train=2.391089 cos_to_last_merge=0.9915 (last merge round=42)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9670367112096404, 'auprc': 0.9987837346041036, 'loss_val': 0.06995916865952462, 'psi': 0.9797355205674257}-{'f1_val': 0.9948349509112366, 'auprc': 0.9996361058879963, 'loss_val': 0.02193150770753298, 'psi': 0.9967554129019405}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=2.347910 (no previous merge yet)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9967940048034993, 'auprc': 0.9942100830969225, 'loss_val': 0.01650702354205652, 'psi': 0.9957604361208686}-{'f1_val': 0.9967582493480517, 'auprc': 0.9991456201229502, 'loss_val': 0.016436484420929553, 'psi': 0.9977131976580111}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.250459 cos_to_last_merge=0.9931 (last merge round=39)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9952409849352806, 'loss_val': 0.027488447441308843, 'psi': 0.9948138580531488}-{'f1_val': 0.9945291067983943, 'auprc': 0.995270728342665, 'loss_val': 0.027478807797475167, 'psi': 0.9948257554161026}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=1.845230 cos_to_last_merge=0.9555 (last merge round=35)
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9985226102679199, 'loss_val': 0.023389752948770753, 'psi': 0.9969441468283164}-{'f1_val': 0.9958918378685807, 'auprc': 0.9985201332722329, 'loss_val': 0.02230684106180661, 'psi': 0.9969431560300416}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=2.231303 (no previous merge yet)
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.7450238264313076, 'auprc': 0.771246510476002, 'loss_val': 1.2014020984686968, 'psi': 0.7555129000491854}-{'f1_val': 0.7408136198810871, 'auprc': 0.8078795925580453, 'loss_val': 1.1686061318908392, 'psi': 0.7676400089518705}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=1.821964 cos_to_last_merge=0.9871 (last merge round=42)
[S14] round=87 local utility u=0.008352 metrics={'f1_val': 0.9971633156444213, 'auprc': 0.9985947808269209, 'loss_val': 0.027674627299528253, 'psi': 0.9977359017174212}-{'f1_val': 0.9953052378684425, 'auprc': 0.9985754319255219, 'loss_val': 0.033172080802262326, 'psi': 0.9966133154912742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=87 head_norm_before_train=2.025947 cos_to_last_merge=0.9808 (last merge round=42)
[S15] round=87 local utility u=0.001075 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976611025127654, 'loss_val': 0.022514377629687332, 'psi': 0.9971124420376185}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976387089652634, 'loss_val': 0.024596888915190702, 'psi': 0.9971034846186178}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=87 head_norm_before_train=1.828718 cos_to_last_merge=0.9882 (last merge round=42)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9906639134450257, 'auprc': 0.9908362539902149, 'loss_val': 0.044390643709725154, 'psi': 0.9907328496631014}-{'f1_val': 0.9910839032534137, 'auprc': 0.9929787795734205, 'loss_val': 0.042919880783718764, 'psi': 0.9918418537814164}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.130665 cos_to_last_merge=0.9417 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.8497713702399466, 'auprc': 0.8234569331866657, 'loss_val': 0.6299805400580255, 'psi': 0.8392455954186342}-{'f1_val': 0.8751027084045295, 'auprc': 0.9665446790819647, 'loss_val': 0.5454073426865291, 'psi': 0.9116794966755036}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.154369 cos_to_last_merge=0.7437 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.744
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.7235268607592265, 'auprc': 0.7931493117001547, 'loss_val': 0.9019322210348074, 'psi': 0.7513758411355977}-{'f1_val': 0.7990250894524507, 'auprc': 0.9020663406201666, 'loss_val': 0.5660064598828097, 'psi': 0.840241589919537}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=2.351800 cos_to_last_merge=0.9947 (last merge round=43)
[S3] round=88 local utility u=0.261323 metrics={'f1_val': 0.8772021722718063, 'auprc': 0.9943625335385562, 'loss_val': 0.1960883926359665, 'psi': 0.9240663167785064}-{'f1_val': 0.8068056500141997, 'auprc': 0.9914352439196308, 'loss_val': 0.2875743096619356, 'psi': 0.8806574875763722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=88 head_norm_before_train=1.893207 cos_to_last_merge=0.9844 (last merge round=41)
[S4] round=88 local utility u=0.247202 metrics={'f1_val': 0.9441132756173982, 'auprc': 0.9554145951058186, 'loss_val': 0.35941917151764585, 'psi': 0.9486338034127664}-{'f1_val': 0.8790940566589054, 'auprc': 0.9546112451656282, 'loss_val': 0.4612976116908536, 'psi': 0.9093009320615946}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=88 head_norm_before_train=1.893520 cos_to_last_merge=0.9320 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9938256262295818, 'loss_val': 0.026151009233889716, 'psi': 0.9952418644774194}-{'f1_val': 0.996186023309311, 'auprc': 0.9978825647462306, 'loss_val': 0.02542064298155498, 'psi': 0.9968646398840788}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=2.521222 (no previous merge yet)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.908771212471047, 'auprc': 0.9678981702392409, 'loss_val': 0.29730745659488844, 'psi': 0.9324219955783245}-{'f1_val': 0.9599530590704938, 'auprc': 0.9708782203080992, 'loss_val': 0.17337162016166727, 'psi': 0.964323123565536}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.784018 cos_to_last_merge=0.9963 (last merge round=43)
[S7] round=88 local utility u=0.411588 metrics={'f1_val': 0.7041187004919138, 'auprc': 0.8704239968778743, 'loss_val': 0.23869655390189373, 'psi': 0.770640819046298}-{'f1_val': 0.6408395552850314, 'auprc': 0.8073163570606794, 'loss_val': 0.49287538891058963, 'psi': 0.7074302759952906}
[S7] not sending this round → trigger blocked (psi=0.771)
[S8] START round=88 head_norm_before_train=2.396059 cos_to_last_merge=0.9913 (last merge round=42)
[S8] round=88 local utility u=0.059232 metrics={'f1_val': 0.9829635333007474, 'auprc': 0.9994390425618516, 'loss_val': 0.049021832146422965, 'psi': 0.989553737005189}-{'f1_val': 0.9670367112096404, 'auprc': 0.9987837346041036, 'loss_val': 0.06995916865952462, 'psi': 0.9797355205674257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=88 head_norm_before_train=2.352579 (no previous merge yet)
[S9] round=88 local utility u=0.008851 metrics={'f1_val': 0.9971290324227131, 'auprc': 0.9991587671500417, 'loss_val': 0.015661711002923646, 'psi': 0.9979409263136446}-{'f1_val': 0.9967940048034993, 'auprc': 0.9942100830969225, 'loss_val': 0.01650702354205652, 'psi': 0.9957604361208686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=88 head_norm_before_train=2.254022 cos_to_last_merge=0.9929 (last merge round=39)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995093434466458, 'loss_val': 0.02747746239824958, 'psi': 0.9947548378656198}-{'f1_val': 0.9945291067983943, 'auprc': 0.9952409849352806, 'loss_val': 0.027488447441308843, 'psi': 0.9948138580531488}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=1.849570 cos_to_last_merge=0.9551 (last merge round=35)
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9648267711168951, 'auprc': 0.9984225726045036, 'loss_val': 0.12960866355459197, 'psi': 0.9782650917119385}-{'f1_val': 0.9958918378685807, 'auprc': 0.9985226102679199, 'loss_val': 0.023389752948770753, 'psi': 0.9969441468283164}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=2.237363 (no previous merge yet)
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6201740478586987, 'auprc': 0.6575446341230113, 'loss_val': 1.5648721559302314, 'psi': 0.6351222823644238}-{'f1_val': 0.7450238264313076, 'auprc': 0.771246510476002, 'loss_val': 1.2014020984686968, 'psi': 0.7555129000491854}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=1.827599 cos_to_last_merge=0.9868 (last merge round=42)
[S14] round=88 local utility u=0.005777 metrics={'f1_val': 0.9979907967189754, 'auprc': 0.998982909665531, 'loss_val': 0.022250508862325446, 'psi': 0.9983876418975977}-{'f1_val': 0.9971633156444213, 'auprc': 0.9985947808269209, 'loss_val': 0.027674627299528253, 'psi': 0.9977359017174212}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=88 head_norm_before_train=2.031749 cos_to_last_merge=0.9806 (last merge round=42)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976549176782692, 'loss_val': 0.023487450288282665, 'psi': 0.99710996810382}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976611025127654, 'loss_val': 0.022514377629687332, 'psi': 0.9971124420376185}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.832523 cos_to_last_merge=0.9879 (last merge round=42)
[S16] round=88 local utility u=0.000498 metrics={'f1_val': 0.9915033728562261, 'auprc': 0.9885096630108837, 'loss_val': 0.04145070422472369, 'psi': 0.9903058889180891}-{'f1_val': 0.9906639134450257, 'auprc': 0.9908362539902149, 'loss_val': 0.044390643709725154, 'psi': 0.9907328496631014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=88 head_norm_before_train=2.139348 cos_to_last_merge=0.9413 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.7805462592368874, 'auprc': 0.7522984169557159, 'loss_val': 1.0009389026683813, 'psi': 0.7692471223244188}-{'f1_val': 0.8497713702399466, 'auprc': 0.8234569331866657, 'loss_val': 0.6299805400580255, 'psi': 0.8392455954186342}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=89 head_norm_before_train=2.156171 cos_to_last_merge=0.7434 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.743
[S2] round=89 local utility u=0.451681 metrics={'f1_val': 0.7907269234590211, 'auprc': 0.8437758130004399, 'loss_val': 0.5536501447743246, 'psi': 0.8119464792755886}-{'f1_val': 0.7235268607592265, 'auprc': 0.7931493117001547, 'loss_val': 0.9019322210348074, 'psi': 0.7513758411355977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=89 head_norm_before_train=2.356288 cos_to_last_merge=0.9946 (last merge round=43)
[S3] round=89 local utility u=0.269214 metrics={'f1_val': 0.9589633526272194, 'auprc': 0.9883883838110998, 'loss_val': 0.1303054603604379, 'psi': 0.9707333651007716}-{'f1_val': 0.8772021722718063, 'auprc': 0.9943625335385562, 'loss_val': 0.1960883926359665, 'psi': 0.9240663167785064}
[S3] not sending this round → trigger blocked (psi=0.971)
[S4] START round=89 head_norm_before_train=1.896001 cos_to_last_merge=0.9842 (last merge round=41)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9439806484518608, 'auprc': 0.949928837131673, 'loss_val': 0.36047703727395536, 'psi': 0.9463599239237857}-{'f1_val': 0.9441132756173982, 'auprc': 0.9554145951058186, 'loss_val': 0.35941917151764585, 'psi': 0.9486338034127664}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.897229 cos_to_last_merge=0.9315 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9926963839349138, 'loss_val': 0.02686696860432586, 'psi': 0.9947901675595521}-{'f1_val': 0.996186023309311, 'auprc': 0.9938256262295818, 'loss_val': 0.026151009233889716, 'psi': 0.9952418644774194}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=2.523106 (no previous merge yet)
[S6] round=89 local utility u=0.025310 metrics={'f1_val': 0.9195084782574479, 'auprc': 0.9492182341821299, 'loss_val': 0.2550714475425042, 'psi': 0.9313923806273208}-{'f1_val': 0.908771212471047, 'auprc': 0.9678981702392409, 'loss_val': 0.29730745659488844, 'psi': 0.9324219955783245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=89 head_norm_before_train=1.787706 cos_to_last_merge=0.9962 (last merge round=43)
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.5975690369522847, 'auprc': 0.7913813510955048, 'loss_val': 0.8900247244531757, 'psi': 0.6750939626095727}-{'f1_val': 0.7041187004919138, 'auprc': 0.8704239968778743, 'loss_val': 0.23869655390189373, 'psi': 0.770640819046298}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=2.400863 cos_to_last_merge=0.9912 (last merge round=42)
[S8] round=89 local utility u=0.035142 metrics={'f1_val': 0.9932225217693944, 'auprc': 0.9961995952542698, 'loss_val': 0.03057413389375175, 'psi': 0.9944133511633446}-{'f1_val': 0.9829635333007474, 'auprc': 0.9994390425618516, 'loss_val': 0.049021832146422965, 'psi': 0.989553737005189}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=89 head_norm_before_train=2.356814 (no previous merge yet)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9967582493480517, 'auprc': 0.9987672524527019, 'loss_val': 0.016818215785279193, 'psi': 0.9975618505899118}-{'f1_val': 0.9971290324227131, 'auprc': 0.9991587671500417, 'loss_val': 0.015661711002923646, 'psi': 0.9979409263136446}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.260540 cos_to_last_merge=0.9930 (last merge round=39)
[S10] round=89 local utility u=0.001272 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9954300702188036, 'loss_val': 0.027261148111239437, 'psi': 0.9950211936191449}-{'f1_val': 0.9945291067983943, 'auprc': 0.995093434466458, 'loss_val': 0.02747746239824958, 'psi': 0.9947548378656198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=89 head_norm_before_train=1.854112 cos_to_last_merge=0.9547 (last merge round=35)
[S11] round=89 local utility u=0.148105 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985753220850592, 'loss_val': 0.021699138622706934, 'psi': 0.9971103337820093}-{'f1_val': 0.9648267711168951, 'auprc': 0.9984225726045036, 'loss_val': 0.12960866355459197, 'psi': 0.9782650917119385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=89 head_norm_before_train=2.242164 (no previous merge yet)
[S13] round=89 local utility u=0.339987 metrics={'f1_val': 0.6956512879106491, 'auprc': 0.6886754340303144, 'loss_val': 1.4311547957981525, 'psi': 0.6928609463585153}-{'f1_val': 0.6201740478586987, 'auprc': 0.6575446341230113, 'loss_val': 1.5648721559302314, 'psi': 0.6351222823644238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=89 head_norm_before_train=1.831210 cos_to_last_merge=0.9866 (last merge round=42)
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9975545343417789, 'auprc': 0.9988194756407559, 'loss_val': 0.02357976275790226, 'psi': 0.9980605108613697}-{'f1_val': 0.9979907967189754, 'auprc': 0.998982909665531, 'loss_val': 0.022250508862325446, 'psi': 0.9983876418975977}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=2.037370 cos_to_last_merge=0.9803 (last merge round=42)
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.9934185961837458, 'auprc': 0.9976501369863784, 'loss_val': 0.027446840870475407, 'psi': 0.995111212504799}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976549176782692, 'loss_val': 0.023487450288282665, 'psi': 0.99710996810382}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=1.834608 cos_to_last_merge=0.9876 (last merge round=42)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9401700712677342, 'auprc': 0.9838418585891138, 'loss_val': 0.32375062866963616, 'psi': 0.9576387861962861}-{'f1_val': 0.9915033728562261, 'auprc': 0.9885096630108837, 'loss_val': 0.04145070422472369, 'psi': 0.9903058889180891}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=2.145462 cos_to_last_merge=0.9407 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=89 local utility u=0.259550 metrics={'f1_val': 0.8061778455720906, 'auprc': 0.7915646216938096, 'loss_val': 0.7534277616105471, 'psi': 0.8003325560207781}-{'f1_val': 0.7805462592368874, 'auprc': 0.7522984169557159, 'loss_val': 1.0009389026683813, 'psi': 0.7692471223244188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=90 head_norm_before_train=2.156474 cos_to_last_merge=0.7432 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.743
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.7676771496487027, 'auprc': 0.8478916502578739, 'loss_val': 0.4932359309055637, 'psi': 0.7997629498923712}-{'f1_val': 0.7907269234590211, 'auprc': 0.8437758130004399, 'loss_val': 0.5536501447743246, 'psi': 0.8119464792755886}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.360906 cos_to_last_merge=0.9944 (last merge round=43)
[S3] round=90 local utility u=0.010096 metrics={'f1_val': 0.9621055268592779, 'auprc': 0.9875584761565817, 'loss_val': 0.12647648839360015, 'psi': 0.9722867065781994}-{'f1_val': 0.9589633526272194, 'auprc': 0.9883883838110998, 'loss_val': 0.1303054603604379, 'psi': 0.9707333651007716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=90 head_norm_before_train=1.900255 cos_to_last_merge=0.9839 (last merge round=41)
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.9406406539107757, 'auprc': 0.9499206188523607, 'loss_val': 0.3675495316353548, 'psi': 0.9443526398874097}-{'f1_val': 0.9439806484518608, 'auprc': 0.949928837131673, 'loss_val': 0.36047703727395536, 'psi': 0.9463599239237857}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=1.897534 cos_to_last_merge=0.9305 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=90 local utility u=0.002136 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9937368634579182, 'loss_val': 0.025716126085499086, 'psi': 0.9952063593687539}-{'f1_val': 0.996186023309311, 'auprc': 0.9926963839349138, 'loss_val': 0.02686696860432586, 'psi': 0.9947901675595521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=90 head_norm_before_train=2.528262 (no previous merge yet)
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.8411918073295418, 'auprc': 0.9400582654158784, 'loss_val': 0.685055007455995, 'psi': 0.8807383905640764}-{'f1_val': 0.9195084782574479, 'auprc': 0.9492182341821299, 'loss_val': 0.2550714475425042, 'psi': 0.9313923806273208}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=1.790361 cos_to_last_merge=0.9961 (last merge round=43)
[S7] round=90 local utility u=0.445633 metrics={'f1_val': 0.6587642046339802, 'auprc': 0.8128143996659732, 'loss_val': 0.4302282794122715, 'psi': 0.7203842826467775}-{'f1_val': 0.5975690369522847, 'auprc': 0.7913813510955048, 'loss_val': 0.8900247244531757, 'psi': 0.6750939626095727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=90 head_norm_before_train=2.402803 cos_to_last_merge=0.9908 (last merge round=42)
[S8] round=90 local utility u=0.013176 metrics={'f1_val': 0.9951212911203298, 'auprc': 0.9995167600868216, 'loss_val': 0.02556708121064298, 'psi': 0.9968794787069265}-{'f1_val': 0.9932225217693944, 'auprc': 0.9961995952542698, 'loss_val': 0.03057413389375175, 'psi': 0.9944133511633446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=90 head_norm_before_train=2.360044 (no previous merge yet)
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9974226301843913, 'auprc': 0.9983989157662985, 'loss_val': 0.026045785879156978, 'psi': 0.9978131444171541}-{'f1_val': 0.9967582493480517, 'auprc': 0.9987672524527019, 'loss_val': 0.016818215785279193, 'psi': 0.9975618505899118}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.267854 cos_to_last_merge=0.9932 (last merge round=39)
[S10] round=90 local utility u=0.000087 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9955158013504556, 'loss_val': 0.027344327114581374, 'psi': 0.9950554860718057}-{'f1_val': 0.9947486092193725, 'auprc': 0.9954300702188036, 'loss_val': 0.027261148111239437, 'psi': 0.9950211936191449}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=90 head_norm_before_train=1.858108 cos_to_last_merge=0.9543 (last merge round=35)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9984748285959446, 'loss_val': 0.022953439332040016, 'psi': 0.9969250341595263}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985753220850592, 'loss_val': 0.021699138622706934, 'psi': 0.9971103337820093}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=2.254024 (no previous merge yet)
[S13] round=90 local utility u=0.240460 metrics={'f1_val': 0.7414908785740933, 'auprc': 0.7210480793195939, 'loss_val': 1.3223905604953843, 'psi': 0.7333137588722936}-{'f1_val': 0.6956512879106491, 'auprc': 0.6886754340303144, 'loss_val': 1.4311547957981525, 'psi': 0.6928609463585153}
[S13] not sending this round → trigger blocked (psi=0.733)
[S14] START round=90 head_norm_before_train=1.834106 cos_to_last_merge=0.9863 (last merge round=42)
[S14] round=90 local utility u=0.001050 metrics={'f1_val': 0.9975569145249968, 'auprc': 0.9987910191551801, 'loss_val': 0.02140861793811051, 'psi': 0.9980505563770702}-{'f1_val': 0.9975545343417789, 'auprc': 0.9988194756407559, 'loss_val': 0.02357976275790226, 'psi': 0.9980605108613697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=90 head_norm_before_train=2.042832 cos_to_last_merge=0.9800 (last merge round=42)
[S15] round=90 local utility u=0.010018 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9976859524018425, 'loss_val': 0.025002006205676906, 'psi': 0.9968738274700215}-{'f1_val': 0.9934185961837458, 'auprc': 0.9976501369863784, 'loss_val': 0.027446840870475407, 'psi': 0.995111212504799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=90 head_norm_before_train=1.837723 cos_to_last_merge=0.9874 (last merge round=42)
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.8664618690228201, 'auprc': 0.9381134114278413, 'loss_val': 0.8899567260714756, 'psi': 0.8951224859848286}-{'f1_val': 0.9401700712677342, 'auprc': 0.9838418585891138, 'loss_val': 0.32375062866963616, 'psi': 0.9576387861962861}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=2.152337 cos_to_last_merge=0.9401 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.940
[S17] round=90 local utility u=0.260708 metrics={'f1_val': 0.8533166239414716, 'auprc': 0.8240497361356018, 'loss_val': 0.6122990235044309, 'psi': 0.8416098688191237}-{'f1_val': 0.8061778455720906, 'auprc': 0.7915646216938096, 'loss_val': 0.7534277616105471, 'psi': 0.8003325560207781}
[S17] not sending this round → trigger blocked (psi=0.842)
[S2] START round=91 head_norm_before_train=2.164290 cos_to_last_merge=0.7427 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.743
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.7202006438702886, 'auprc': 0.8216462098625957, 'loss_val': 0.7236580173833244, 'psi': 0.7607788702672115}-{'f1_val': 0.7676771496487027, 'auprc': 0.8478916502578739, 'loss_val': 0.4932359309055637, 'psi': 0.7997629498923712}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=91 head_norm_before_train=2.365400 cos_to_last_merge=0.9943 (last merge round=43)
[S3] round=91 local utility u=0.032035 metrics={'f1_val': 0.9648019994991639, 'auprc': 0.9939207941898689, 'loss_val': 0.09767147521657972, 'psi': 0.9764495173754459}-{'f1_val': 0.9621055268592779, 'auprc': 0.9875584761565817, 'loss_val': 0.12647648839360015, 'psi': 0.9722867065781994}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=91 head_norm_before_train=1.895760 cos_to_last_merge=0.9838 (last merge round=41)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9389811644938102, 'auprc': 0.9567111153302086, 'loss_val': 0.3940490003427386, 'psi': 0.9460731448283695}-{'f1_val': 0.9406406539107757, 'auprc': 0.9499206188523607, 'loss_val': 0.3675495316353548, 'psi': 0.9443526398874097}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.902824 cos_to_last_merge=0.9297 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=91 local utility u=0.008439 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9980419796984996, 'loss_val': 0.024392178784868195, 'psi': 0.9971923373375416}-{'f1_val': 0.996186023309311, 'auprc': 0.9937368634579182, 'loss_val': 0.025716126085499086, 'psi': 0.9952063593687539}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=91 head_norm_before_train=2.534891 (no previous merge yet)
[S6] round=91 local utility u=0.046665 metrics={'f1_val': 0.8391058421359233, 'auprc': 0.9495346662789674, 'loss_val': 0.6076378569303532, 'psi': 0.8832773717931409}-{'f1_val': 0.8411918073295418, 'auprc': 0.9400582654158784, 'loss_val': 0.685055007455995, 'psi': 0.8807383905640764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=91 head_norm_before_train=1.792285 cos_to_last_merge=0.9961 (last merge round=43)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.6232903692780691, 'auprc': 0.7966090358546145, 'loss_val': 0.6870664937578684, 'psi': 0.6926178359086873}-{'f1_val': 0.6587642046339802, 'auprc': 0.8128143996659732, 'loss_val': 0.4302282794122715, 'psi': 0.7203842826467775}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=2.407983 cos_to_last_merge=0.9905 (last merge round=42)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9888526342761694, 'auprc': 0.9994826780377091, 'loss_val': 0.03959749777006151, 'psi': 0.9931046517807853}-{'f1_val': 0.9951212911203298, 'auprc': 0.9995167600868216, 'loss_val': 0.02556708121064298, 'psi': 0.9968794787069265}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=2.362344 (no previous merge yet)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9965897269135436, 'auprc': 0.9985085696003598, 'loss_val': 0.024827074230801334, 'psi': 0.9973572639882701}-{'f1_val': 0.9974226301843913, 'auprc': 0.9983989157662985, 'loss_val': 0.026045785879156978, 'psi': 0.9978131444171541}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.275025 cos_to_last_merge=0.9934 (last merge round=39)
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9953214664662944, 'loss_val': 0.027338660758358276, 'psi': 0.9949777521181413}-{'f1_val': 0.9947486092193725, 'auprc': 0.9955158013504556, 'loss_val': 0.027344327114581374, 'psi': 0.9950554860718057}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=1.861431 cos_to_last_merge=0.9540 (last merge round=35)
[S11] round=91 local utility u=0.001745 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985977571552274, 'loss_val': 0.02128415685367035, 'psi': 0.9971193078100765}-{'f1_val': 0.9958918378685807, 'auprc': 0.9984748285959446, 'loss_val': 0.022953439332040016, 'psi': 0.9969250341595263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=91 head_norm_before_train=2.267271 (no previous merge yet)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6229430087139878, 'auprc': 0.6731475179626112, 'loss_val': 1.5633431168122605, 'psi': 0.6430248124134371}-{'f1_val': 0.7414908785740933, 'auprc': 0.7210480793195939, 'loss_val': 1.3223905604953843, 'psi': 0.7333137588722936}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=1.836622 cos_to_last_merge=0.9860 (last merge round=42)
[S14] round=91 local utility u=0.000779 metrics={'f1_val': 0.9975569145249968, 'auprc': 0.9987598438670504, 'loss_val': 0.019756248157007193, 'psi': 0.9980380862618183}-{'f1_val': 0.9975569145249968, 'auprc': 0.9987910191551801, 'loss_val': 0.02140861793811051, 'psi': 0.9980505563770702}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=91 head_norm_before_train=2.048264 cos_to_last_merge=0.9798 (last merge round=42)
[S15] round=91 local utility u=0.002292 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977035314060559, 'loss_val': 0.02295563996970991, 'psi': 0.9971294135949347}-{'f1_val': 0.9963324108488076, 'auprc': 0.9976859524018425, 'loss_val': 0.025002006205676906, 'psi': 0.9968738274700215}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=91 head_norm_before_train=1.841801 cos_to_last_merge=0.9872 (last merge round=42)
[S16] round=91 local utility u=0.047594 metrics={'f1_val': 0.8284394785070998, 'auprc': 0.981448328313324, 'loss_val': 0.6966381931719265, 'psi': 0.8896430184295895}-{'f1_val': 0.8664618690228201, 'auprc': 0.9381134114278413, 'loss_val': 0.8899567260714756, 'psi': 0.8951224859848286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=91 head_norm_before_train=2.154430 cos_to_last_merge=0.9395 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.940
[S17] round=91 local utility u=0.311164 metrics={'f1_val': 0.895865123189458, 'auprc': 0.9118597046910688, 'loss_val': 0.5086911447372585, 'psi': 0.9022629557901023}-{'f1_val': 0.8533166239414716, 'auprc': 0.8240497361356018, 'loss_val': 0.6122990235044309, 'psi': 0.8416098688191237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=92 head_norm_before_train=2.170867 cos_to_last_merge=0.7421 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.742
[S2] round=92 local utility u=0.031570 metrics={'f1_val': 0.7234912294158771, 'auprc': 0.8431523891740427, 'loss_val': 0.744780819821891, 'psi': 0.7713556933191433}-{'f1_val': 0.7202006438702886, 'auprc': 0.8216462098625957, 'loss_val': 0.7236580173833244, 'psi': 0.7607788702672115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=92 head_norm_before_train=2.369867 cos_to_last_merge=0.9941 (last merge round=43)
[S3] round=92 local utility u=0.044964 metrics={'f1_val': 0.9746816052812316, 'auprc': 0.9967316157307243, 'loss_val': 0.07545346620577958, 'psi': 0.9835016094610287}-{'f1_val': 0.9648019994991639, 'auprc': 0.9939207941898689, 'loss_val': 0.09767147521657972, 'psi': 0.9764495173754459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] START round=92 head_norm_before_train=1.897791 cos_to_last_merge=0.9838 (last merge round=41)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.7244662137594696, 'auprc': 0.9556290314011828, 'loss_val': 0.584207552420688, 'psi': 0.8169313408161549}-{'f1_val': 0.9389811644938102, 'auprc': 0.9567111153302086, 'loss_val': 0.3940490003427386, 'psi': 0.9460731448283695}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=1.909550 cos_to_last_merge=0.9291 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9926170532522651, 'loss_val': 0.025293437865592017, 'psi': 0.9947584352864927}-{'f1_val': 0.996625909096903, 'auprc': 0.9980419796984996, 'loss_val': 0.024392178784868195, 'psi': 0.9971923373375416}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=2.543335 (no previous merge yet)
[S6] round=92 local utility u=0.682032 metrics={'f1_val': 0.9724824583876893, 'auprc': 0.973691453290435, 'loss_val': 0.11630300230477406, 'psi': 0.9729660563487876}-{'f1_val': 0.8391058421359233, 'auprc': 0.9495346662789674, 'loss_val': 0.6076378569303532, 'psi': 0.8832773717931409}
[S6] not sending this round → trigger blocked (psi=0.973)
[S7] START round=92 head_norm_before_train=1.795911 cos_to_last_merge=0.9960 (last merge round=43)
[S7] round=92 local utility u=0.352926 metrics={'f1_val': 0.6691280906462974, 'auprc': 0.8291796128855207, 'loss_val': 0.3539521877015405, 'psi': 0.7331486995419867}-{'f1_val': 0.6232903692780691, 'auprc': 0.7966090358546145, 'loss_val': 0.6870664937578684, 'psi': 0.6926178359086873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=92 head_norm_before_train=2.416768 cos_to_last_merge=0.9903 (last merge round=42)
[S8] round=92 local utility u=0.027320 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9994662833985999, 'loss_val': 0.020803111350032696, 'psi': 0.9966874839061819}-{'f1_val': 0.9888526342761694, 'auprc': 0.9994826780377091, 'loss_val': 0.03959749777006151, 'psi': 0.9931046517807853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=92 head_norm_before_train=2.366020 (no previous merge yet)
[S9] round=92 local utility u=0.002907 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9973559962114276, 'loss_val': 0.016326102064253438, 'psi': 0.9969732773258294}-{'f1_val': 0.9965897269135436, 'auprc': 0.9985085696003598, 'loss_val': 0.024827074230801334, 'psi': 0.9973572639882701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=92 head_norm_before_train=2.277002 cos_to_last_merge=0.9930 (last merge round=39)
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9950743167315694, 'loss_val': 0.027425881073988568, 'psi': 0.9948788922242513}-{'f1_val': 0.9947486092193725, 'auprc': 0.9953214664662944, 'loss_val': 0.027338660758358276, 'psi': 0.9949777521181413}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=1.864735 cos_to_last_merge=0.9536 (last merge round=35)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984446714790935, 'loss_val': 0.022613233450903776, 'psi': 0.9970580735396231}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985977571552274, 'loss_val': 0.02128415685367035, 'psi': 0.9971193078100765}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=2.267293 (no previous merge yet)
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.6000176337877237, 'auprc': 0.6507201567323139, 'loss_val': 1.7062806311587801, 'psi': 0.6202986429655597}-{'f1_val': 0.6229430087139878, 'auprc': 0.6731475179626112, 'loss_val': 1.5633431168122605, 'psi': 0.6430248124134371}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=1.839094 cos_to_last_merge=0.9857 (last merge round=42)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.994470429891246, 'auprc': 0.998723569908481, 'loss_val': 0.029977088705980797, 'psi': 0.99617168589814}-{'f1_val': 0.9975569145249968, 'auprc': 0.9987598438670504, 'loss_val': 0.019756248157007193, 'psi': 0.9980380862618183}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=2.053713 cos_to_last_merge=0.9795 (last merge round=42)
[S15] round=92 local utility u=0.000577 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977279599161216, 'loss_val': 0.02187574228223107, 'psi': 0.997139184998961}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977035314060559, 'loss_val': 0.02295563996970991, 'psi': 0.9971294135949347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=92 head_norm_before_train=1.845454 cos_to_last_merge=0.9871 (last merge round=42)
[S16] round=92 local utility u=0.826848 metrics={'f1_val': 0.9917207636244626, 'auprc': 0.987607602979885, 'loss_val': 0.04110766137671781, 'psi': 0.9900754993666316}-{'f1_val': 0.8284394785070998, 'auprc': 0.981448328313324, 'loss_val': 0.6966381931719265, 'psi': 0.8896430184295895}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=92 head_norm_before_train=2.160763 cos_to_last_merge=0.9390 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.939
[S17] round=92 local utility u=0.103368 metrics={'f1_val': 0.9017095214166946, 'auprc': 0.9538133860628942, 'loss_val': 0.46288277015819174, 'psi': 0.9225510672751744}-{'f1_val': 0.895865123189458, 'auprc': 0.9118597046910688, 'loss_val': 0.5086911447372585, 'psi': 0.9022629557901023}
[S17] not sending this round → trigger blocked (psi=0.923)
[S2] START round=93 head_norm_before_train=2.178115 cos_to_last_merge=0.7416 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.742
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.7198627084942519, 'auprc': 0.7147385287215986, 'loss_val': 1.1091718270992457, 'psi': 0.7178130365851906}-{'f1_val': 0.7234912294158771, 'auprc': 0.8431523891740427, 'loss_val': 0.744780819821891, 'psi': 0.7713556933191433}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.374150 cos_to_last_merge=0.9940 (last merge round=43)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.7679289608391466, 'auprc': 0.9305953279958332, 'loss_val': 0.4259068258841772, 'psi': 0.8329955077018213}-{'f1_val': 0.9746816052812316, 'auprc': 0.9967316157307243, 'loss_val': 0.07545346620577958, 'psi': 0.9835016094610287}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=1.901787 cos_to_last_merge=0.9834 (last merge round=41)
[S4] round=93 local utility u=0.773083 metrics={'f1_val': 0.9417774674265573, 'auprc': 0.9644156885258193, 'loss_val': 0.36826862746281996, 'psi': 0.950832755866262}-{'f1_val': 0.7244662137594696, 'auprc': 0.9556290314011828, 'loss_val': 0.584207552420688, 'psi': 0.8169313408161549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=93 head_norm_before_train=1.909946 cos_to_last_merge=0.9283 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.928
[S5] round=93 local utility u=0.005960 metrics={'f1_val': 0.9956026010935064, 'auprc': 0.9976531050232856, 'loss_val': 0.02498078618809724, 'psi': 0.996422802665418}-{'f1_val': 0.996186023309311, 'auprc': 0.9926170532522651, 'loss_val': 0.025293437865592017, 'psi': 0.9947584352864927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=93 head_norm_before_train=2.550357 (no previous merge yet)
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.9190212748363462, 'auprc': 0.9607050541752108, 'loss_val': 0.2874967807698672, 'psi': 0.9356947865718921}-{'f1_val': 0.9724824583876893, 'auprc': 0.973691453290435, 'loss_val': 0.11630300230477406, 'psi': 0.9729660563487876}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=1.801525 cos_to_last_merge=0.9958 (last merge round=43)
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.6462493142042862, 'auprc': 0.8059902708451323, 'loss_val': 0.5114382754691099, 'psi': 0.7101456968606247}-{'f1_val': 0.6691280906462974, 'auprc': 0.8291796128855207, 'loss_val': 0.3539521877015405, 'psi': 0.7331486995419867}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=2.424798 cos_to_last_merge=0.9901 (last merge round=42)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9743928789650693, 'auprc': 0.9995473767080632, 'loss_val': 0.07384945127935391, 'psi': 0.9844546780622668}-{'f1_val': 0.9948349509112366, 'auprc': 0.9994662833985999, 'loss_val': 0.020803111350032696, 'psi': 0.9966874839061819}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=2.370634 (no previous merge yet)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9967908009243918, 'auprc': 0.9967242421736291, 'loss_val': 0.016735903537296162, 'psi': 0.9967641774240867}-{'f1_val': 0.9967181314020974, 'auprc': 0.9973559962114276, 'loss_val': 0.016326102064253438, 'psi': 0.9969732773258294}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.281066 cos_to_last_merge=0.9929 (last merge round=39)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.994700404821484, 'loss_val': 0.027645403150104393, 'psi': 0.9945976260076302}-{'f1_val': 0.9947486092193725, 'auprc': 0.9950743167315694, 'loss_val': 0.027425881073988568, 'psi': 0.9948788922242513}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=1.867921 cos_to_last_merge=0.9533 (last merge round=35)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.8677555760898368, 'auprc': 0.998057644602266, 'loss_val': 0.21923363882699037, 'psi': 0.9198764034948085}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984446714790935, 'loss_val': 0.022613233450903776, 'psi': 0.9970580735396231}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=2.268255 (no previous merge yet)
[S13] round=93 local utility u=0.875587 metrics={'f1_val': 0.7365308082237793, 'auprc': 0.7826138324167313, 'loss_val': 1.1698674021226279, 'psi': 0.7549640179009601}-{'f1_val': 0.6000176337877237, 'auprc': 0.6507201567323139, 'loss_val': 1.7062806311587801, 'psi': 0.6202986429655597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=93 head_norm_before_train=1.843313 cos_to_last_merge=0.9855 (last merge round=42)
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.930143594533109, 'auprc': 0.9986139795637297, 'loss_val': 0.16298019471255068, 'psi': 0.9575317485453573}-{'f1_val': 0.994470429891246, 'auprc': 0.998723569908481, 'loss_val': 0.029977088705980797, 'psi': 0.99617168589814}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.059052 cos_to_last_merge=0.9792 (last merge round=42)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977233461321255, 'loss_val': 0.022797718312845237, 'psi': 0.9971373394853625}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977279599161216, 'loss_val': 0.02187574228223107, 'psi': 0.997139184998961}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=1.847625 cos_to_last_merge=0.9868 (last merge round=42)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9845719783873109, 'auprc': 0.9818438892644401, 'loss_val': 0.09198563758471041, 'psi': 0.9834807427381625}-{'f1_val': 0.9917207636244626, 'auprc': 0.987607602979885, 'loss_val': 0.04110766137671781, 'psi': 0.9900754993666316}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=2.168191 cos_to_last_merge=0.9385 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.939
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.8680326360981627, 'auprc': 0.9383057031698208, 'loss_val': 0.6168714573694181, 'psi': 0.896141862926826}-{'f1_val': 0.9017095214166946, 'auprc': 0.9538133860628942, 'loss_val': 0.46288277015819174, 'psi': 0.9225510672751744}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=94 head_norm_before_train=2.188086 cos_to_last_merge=0.7409 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.741
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.7215826829129075, 'auprc': 0.6998695597671306, 'loss_val': 1.0923237876073932, 'psi': 0.7128974336545968}-{'f1_val': 0.7198627084942519, 'auprc': 0.7147385287215986, 'loss_val': 1.1091718270992457, 'psi': 0.7178130365851906}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.377371 cos_to_last_merge=0.9938 (last merge round=43)
[S3] round=94 local utility u=0.607661 metrics={'f1_val': 0.9230170571765399, 'auprc': 0.9664113362060855, 'loss_val': 0.24856193324066275, 'psi': 0.9403747687883581}-{'f1_val': 0.7679289608391466, 'auprc': 0.9305953279958332, 'loss_val': 0.4259068258841772, 'psi': 0.8329955077018213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=94 head_norm_before_train=1.909048 cos_to_last_merge=0.9830 (last merge round=41)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9157310170980804, 'auprc': 0.9488658888537542, 'loss_val': 0.462130979010777, 'psi': 0.92898496580035}-{'f1_val': 0.9417774674265573, 'auprc': 0.9644156885258193, 'loss_val': 0.36826862746281996, 'psi': 0.950832755866262}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.910525 cos_to_last_merge=0.9278 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.928
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.995815189951128, 'loss_val': 0.02455000358068027, 'psi': 0.9960376899660378}-{'f1_val': 0.9956026010935064, 'auprc': 0.9976531050232856, 'loss_val': 0.02498078618809724, 'psi': 0.996422802665418}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=2.557631 (no previous merge yet)
[S6] round=94 local utility u=0.085656 metrics={'f1_val': 0.9435993006660376, 'auprc': 0.945839987223418, 'loss_val': 0.21905743018763804, 'psi': 0.9444955752889898}-{'f1_val': 0.9190212748363462, 'auprc': 0.9607050541752108, 'loss_val': 0.2874967807698672, 'psi': 0.9356947865718921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=94 head_norm_before_train=1.807566 cos_to_last_merge=0.9955 (last merge round=43)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.6284663817624387, 'auprc': 0.7957963670786904, 'loss_val': 0.7820005952058376, 'psi': 0.6953983758889395}-{'f1_val': 0.6462493142042862, 'auprc': 0.8059902708451323, 'loss_val': 0.5114382754691099, 'psi': 0.7101456968606247}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.427975 cos_to_last_merge=0.9898 (last merge round=42)
[S8] round=94 local utility u=0.069773 metrics={'f1_val': 0.9913835456513718, 'auprc': 0.9987463568282265, 'loss_val': 0.0338443798747963, 'psi': 0.9943286701221137}-{'f1_val': 0.9743928789650693, 'auprc': 0.9995473767080632, 'loss_val': 0.07384945127935391, 'psi': 0.9844546780622668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=94 head_norm_before_train=2.375243 (no previous merge yet)
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9967616101073482, 'auprc': 0.9969426736407643, 'loss_val': 0.017652843003088652, 'psi': 0.9968340355207147}-{'f1_val': 0.9967908009243918, 'auprc': 0.9967242421736291, 'loss_val': 0.016735903537296162, 'psi': 0.9967641774240867}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.280980 cos_to_last_merge=0.9924 (last merge round=39)
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9946890022298605, 'loss_val': 0.02762558396025616, 'psi': 0.9945930649709808}-{'f1_val': 0.9945291067983943, 'auprc': 0.994700404821484, 'loss_val': 0.027645403150104393, 'psi': 0.9945976260076302}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=1.871465 cos_to_last_merge=0.9529 (last merge round=35)
[S11] round=94 local utility u=0.269889 metrics={'f1_val': 0.9371041011556822, 'auprc': 0.9980075608912481, 'loss_val': 0.09539572584278336, 'psi': 0.9614654850499086}-{'f1_val': 0.8677555760898368, 'auprc': 0.998057644602266, 'loss_val': 0.21923363882699037, 'psi': 0.9198764034948085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=94 head_norm_before_train=2.270643 (no previous merge yet)
[S13] round=94 local utility u=0.073212 metrics={'f1_val': 0.7075617171345967, 'auprc': 0.8737179624668763, 'loss_val': 1.1229404975248547, 'psi': 0.7740242152675085}-{'f1_val': 0.7365308082237793, 'auprc': 0.7826138324167313, 'loss_val': 1.1698674021226279, 'psi': 0.7549640179009601}
[S13] not sending this round → trigger blocked (psi=0.774)
[S14] START round=94 head_norm_before_train=1.847221 cos_to_last_merge=0.9853 (last merge round=42)
[S14] round=94 local utility u=0.273201 metrics={'f1_val': 0.9975773038923221, 'auprc': 0.9986594623550782, 'loss_val': 0.021317281991571856, 'psi': 0.9980101672774245}-{'f1_val': 0.930143594533109, 'auprc': 0.9986139795637297, 'loss_val': 0.16298019471255068, 'psi': 0.9575317485453573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=94 head_norm_before_train=2.064344 cos_to_last_merge=0.9790 (last merge round=42)
[S15] round=94 local utility u=0.000097 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977161495063134, 'loss_val': 0.022582602097910378, 'psi': 0.9971344608350377}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977233461321255, 'loss_val': 0.022797718312845237, 'psi': 0.9971373394853625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=94 head_norm_before_train=1.849467 cos_to_last_merge=0.9865 (last merge round=42)
[S16] round=94 local utility u=0.047410 metrics={'f1_val': 0.9921237182743798, 'auprc': 0.9839867160876842, 'loss_val': 0.04890534528111957, 'psi': 0.9888689173997015}-{'f1_val': 0.9845719783873109, 'auprc': 0.9818438892644401, 'loss_val': 0.09198563758471041, 'psi': 0.9834807427381625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=94 head_norm_before_train=2.171635 cos_to_last_merge=0.9380 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.938
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.849840851525371, 'auprc': 0.8506728491680695, 'loss_val': 0.803779101069997, 'psi': 0.8501736505824504}-{'f1_val': 0.8680326360981627, 'auprc': 0.9383057031698208, 'loss_val': 0.6168714573694181, 'psi': 0.896141862926826}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.196886 cos_to_last_merge=0.7402 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.740
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.72059017588537, 'auprc': 0.6933197818288822, 'loss_val': 1.1478535832927823, 'psi': 0.7096820182627749}-{'f1_val': 0.7215826829129075, 'auprc': 0.6998695597671306, 'loss_val': 1.0923237876073932, 'psi': 0.7128974336545968}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.380809 cos_to_last_merge=0.9937 (last merge round=43)
[S3] round=95 local utility u=0.066067 metrics={'f1_val': 0.9123575602574369, 'auprc': 0.9979847725668456, 'loss_val': 0.14719079211617503, 'psi': 0.9466084451812004}-{'f1_val': 0.9230170571765399, 'auprc': 0.9664113362060855, 'loss_val': 0.24856193324066275, 'psi': 0.9403747687883581}
[S3] not sending this round → trigger blocked (psi=0.947)
[S4] START round=95 head_norm_before_train=1.917877 cos_to_last_merge=0.9829 (last merge round=41)
[S4] round=95 local utility u=0.194284 metrics={'f1_val': 0.952123428413268, 'auprc': 0.972542508477289, 'loss_val': 0.36294662776875924, 'psi': 0.9602910604388764}-{'f1_val': 0.9157310170980804, 'auprc': 0.9488658888537542, 'loss_val': 0.462130979010777, 'psi': 0.92898496580035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=95 head_norm_before_train=1.914704 cos_to_last_merge=0.9275 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.928
[S5] round=95 local utility u=0.001828 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9969024590724173, 'loss_val': 0.024156081689914684, 'psi': 0.9964725976145535}-{'f1_val': 0.996186023309311, 'auprc': 0.995815189951128, 'loss_val': 0.02455000358068027, 'psi': 0.9960376899660378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=95 head_norm_before_train=2.564986 (no previous merge yet)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.9075658767931245, 'auprc': 0.9467271815367555, 'loss_val': 0.32757748454375757, 'psi': 0.9232303986905769}-{'f1_val': 0.9435993006660376, 'auprc': 0.945839987223418, 'loss_val': 0.21905743018763804, 'psi': 0.9444955752889898}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.812617 cos_to_last_merge=0.9954 (last merge round=43)
[S7] round=95 local utility u=0.357503 metrics={'f1_val': 0.6711504410481073, 'auprc': 0.8167179232041557, 'loss_val': 0.3858633186483541, 'psi': 0.7293774339105267}-{'f1_val': 0.6284663817624387, 'auprc': 0.7957963670786904, 'loss_val': 0.7820005952058376, 'psi': 0.6953983758889395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=95 head_norm_before_train=2.430539 cos_to_last_merge=0.9896 (last merge round=42)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.988272459098805, 'auprc': 0.9996435801577112, 'loss_val': 0.0404836345614965, 'psi': 0.9928209075223675}-{'f1_val': 0.9913835456513718, 'auprc': 0.9987463568282265, 'loss_val': 0.0338443798747963, 'psi': 0.9943286701221137}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=2.378798 (no previous merge yet)
[S9] round=95 local utility u=0.001906 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.9985596235587832, 'loss_val': 0.021156690903724795, 'psi': 0.9977273562327571}-{'f1_val': 0.9967616101073482, 'auprc': 0.9969426736407643, 'loss_val': 0.017652843003088652, 'psi': 0.9968340355207147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=95 head_norm_before_train=2.285647 cos_to_last_merge=0.9923 (last merge round=39)
[S10] round=95 local utility u=0.000216 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9948515105767891, 'loss_val': 0.027680987434645105, 'psi': 0.9946580683097522}-{'f1_val': 0.9945291067983943, 'auprc': 0.9946890022298605, 'loss_val': 0.02762558396025616, 'psi': 0.9945930649709808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=95 head_norm_before_train=1.876190 cos_to_last_merge=0.9525 (last merge round=35)
[S11] round=95 local utility u=0.213759 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985690007192094, 'loss_val': 0.02374003538334141, 'psi': 0.9971078052356693}-{'f1_val': 0.9371041011556822, 'auprc': 0.9980075608912481, 'loss_val': 0.09539572584278336, 'psi': 0.9614654850499086}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=95 head_norm_before_train=2.280597 (no previous merge yet)
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.738619145116073, 'auprc': 0.7615911320668801, 'loss_val': 1.240961796869272, 'psi': 0.7478079398963958}-{'f1_val': 0.7075617171345967, 'auprc': 0.8737179624668763, 'loss_val': 1.1229404975248547, 'psi': 0.7740242152675085}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=1.851746 cos_to_last_merge=0.9850 (last merge round=42)
[S14] round=95 local utility u=0.001104 metrics={'f1_val': 0.9975795452795295, 'auprc': 0.9986569584590496, 'loss_val': 0.019115117885585644, 'psi': 0.9980105105513375}-{'f1_val': 0.9975773038923221, 'auprc': 0.9986594623550782, 'loss_val': 0.021317281991571856, 'psi': 0.9980101672774245}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=95 head_norm_before_train=2.069398 cos_to_last_merge=0.9787 (last merge round=42)
[S15] round=95 local utility u=0.000308 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977257948237603, 'loss_val': 0.021994821293908916, 'psi': 0.9971383189620164}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977161495063134, 'loss_val': 0.022582602097910378, 'psi': 0.9971344608350377}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=95 head_norm_before_train=1.853271 cos_to_last_merge=0.9863 (last merge round=42)
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.8644852460521183, 'auprc': 0.9775481182653, 'loss_val': 0.8051410717571117, 'psi': 0.909710394937391}-{'f1_val': 0.9921237182743798, 'auprc': 0.9839867160876842, 'loss_val': 0.04890534528111957, 'psi': 0.9888689173997015}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.176017 cos_to_last_merge=0.9375 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.937
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.8105739384100998, 'auprc': 0.8504877713973102, 'loss_val': 0.6443653325930027, 'psi': 0.826539471604984}-{'f1_val': 0.849840851525371, 'auprc': 0.8506728491680695, 'loss_val': 0.803779101069997, 'psi': 0.8501736505824504}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=96 head_norm_before_train=2.203676 cos_to_last_merge=0.7396 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.740
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.7210066610293682, 'auprc': 0.6903121633371115, 'loss_val': 1.150275630044372, 'psi': 0.7087288619524655}-{'f1_val': 0.72059017588537, 'auprc': 0.6933197818288822, 'loss_val': 1.1478535832927823, 'psi': 0.7096820182627749}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.383882 cos_to_last_merge=0.9936 (last merge round=43)
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.8596030312286489, 'auprc': 0.9964599228596502, 'loss_val': 0.20470591171989103, 'psi': 0.9143457878810495}-{'f1_val': 0.9123575602574369, 'auprc': 0.9979847725668456, 'loss_val': 0.14719079211617503, 'psi': 0.9466084451812004}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=1.923031 cos_to_last_merge=0.9827 (last merge round=41)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9506776681115706, 'auprc': 0.9547147430352972, 'loss_val': 0.37212432730890055, 'psi': 0.9522924980810613}-{'f1_val': 0.952123428413268, 'auprc': 0.972542508477289, 'loss_val': 0.36294662776875924, 'psi': 0.9602910604388764}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=1.924064 cos_to_last_merge=0.9271 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=96 local utility u=0.002887 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9978737143358346, 'loss_val': 0.023057091243216733, 'psi': 0.9970371739059719}-{'f1_val': 0.996186023309311, 'auprc': 0.9969024590724173, 'loss_val': 0.024156081689914684, 'psi': 0.9964725976145535}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=96 head_norm_before_train=2.572379 (no previous merge yet)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.8283509806392971, 'auprc': 0.9374099748645988, 'loss_val': 0.48803873374903706, 'psi': 0.8719745783294177}-{'f1_val': 0.9075658767931245, 'auprc': 0.9467271815367555, 'loss_val': 0.32757748454375757, 'psi': 0.9232303986905769}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=1.815647 cos_to_last_merge=0.9952 (last merge round=43)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.6301188331281828, 'auprc': 0.8017818358847789, 'loss_val': 0.5471737089463505, 'psi': 0.6987840342308212}-{'f1_val': 0.6711504410481073, 'auprc': 0.8167179232041557, 'loss_val': 0.3858633186483541, 'psi': 0.7293774339105267}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.436035 cos_to_last_merge=0.9895 (last merge round=42)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.8115087057291306, 'auprc': 0.993140901832468, 'loss_val': 0.5211649323882632, 'psi': 0.8841615841704655}-{'f1_val': 0.988272459098805, 'auprc': 0.9996435801577112, 'loss_val': 0.0404836345614965, 'psi': 0.9928209075223675}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.380680 (no previous merge yet)
[S9] round=96 local utility u=0.002873 metrics={'f1_val': 0.9971290324227131, 'auprc': 0.9990680841482401, 'loss_val': 0.016675928182667547, 'psi': 0.997904653112924}-{'f1_val': 0.9971725113487396, 'auprc': 0.9985596235587832, 'loss_val': 0.021156690903724795, 'psi': 0.9977273562327571}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=96 head_norm_before_train=2.286548 cos_to_last_merge=0.9918 (last merge round=39)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9948950113089383, 'loss_val': 0.0278213430287232, 'psi': 0.9946754686026119}-{'f1_val': 0.9945291067983943, 'auprc': 0.9948515105767891, 'loss_val': 0.027680987434645105, 'psi': 0.9946580683097522}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=1.879172 cos_to_last_merge=0.9522 (last merge round=35)
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9950298048205717, 'auprc': 0.9980431706581996, 'loss_val': 0.022998429727394413, 'psi': 0.9962351511556229}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985690007192094, 'loss_val': 0.02374003538334141, 'psi': 0.9971078052356693}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=2.285489 (no previous merge yet)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6530609948877288, 'auprc': 0.6771858818641338, 'loss_val': 1.4769309397857766, 'psi': 0.6627109496782908}-{'f1_val': 0.738619145116073, 'auprc': 0.7615911320668801, 'loss_val': 1.240961796869272, 'psi': 0.7478079398963958}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=1.857253 cos_to_last_merge=0.9848 (last merge round=42)
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9971687801929319, 'auprc': 0.9985765372756061, 'loss_val': 0.019425489239832616, 'psi': 0.9977318830260016}-{'f1_val': 0.9975795452795295, 'auprc': 0.9986569584590496, 'loss_val': 0.019115117885585644, 'psi': 0.9980105105513375}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.074425 cos_to_last_merge=0.9785 (last merge round=42)
[S15] round=96 local utility u=0.000006 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977257240955603, 'loss_val': 0.021983503939081744, 'psi': 0.9971382906707364}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977257948237603, 'loss_val': 0.021994821293908916, 'psi': 0.9971383189620164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=96 head_norm_before_train=1.858091 cos_to_last_merge=0.9861 (last merge round=42)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.8614887459590637, 'auprc': 0.9800441764455041, 'loss_val': 0.883240034821817, 'psi': 0.9089109181536399}-{'f1_val': 0.8644852460521183, 'auprc': 0.9775481182653, 'loss_val': 0.8051410717571117, 'psi': 0.909710394937391}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.177457 cos_to_last_merge=0.9369 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.937
[S17] round=96 local utility u=0.353545 metrics={'f1_val': 0.8725095192449754, 'auprc': 0.9289184141402069, 'loss_val': 0.5441811729876096, 'psi': 0.895073077203068}-{'f1_val': 0.8105739384100998, 'auprc': 0.8504877713973102, 'loss_val': 0.6443653325930027, 'psi': 0.826539471604984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=97 head_norm_before_train=2.204673 cos_to_last_merge=0.7393 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.739
[S2] round=97 local utility u=0.040533 metrics={'f1_val': 0.7203920281772388, 'auprc': 0.7101985286899426, 'loss_val': 1.1251809294371042, 'psi': 0.7163146283823203}-{'f1_val': 0.7210066610293682, 'auprc': 0.6903121633371115, 'loss_val': 1.150275630044372, 'psi': 0.7087288619524655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=97 head_norm_before_train=2.385959 cos_to_last_merge=0.9936 (last merge round=43)
[S3] round=97 local utility u=0.276731 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9686812187968398, 'loss_val': 0.17526630712320332, 'psi': 0.963970252901474}-{'f1_val': 0.8596030312286489, 'auprc': 0.9964599228596502, 'loss_val': 0.20470591171989103, 'psi': 0.9143457878810495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=97 head_norm_before_train=1.928911 cos_to_last_merge=0.9821 (last merge round=41)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.912291368732924, 'auprc': 0.9510724930567924, 'loss_val': 0.4667693166933696, 'psi': 0.9278038184624715}-{'f1_val': 0.9506776681115706, 'auprc': 0.9547147430352972, 'loss_val': 0.37212432730890055, 'psi': 0.9522924980810613}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=1.934489 cos_to_last_merge=0.9269 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9939219140705378, 'loss_val': 0.02617829166220268, 'psi': 0.9954564537998531}-{'f1_val': 0.9964794802860635, 'auprc': 0.9978737143358346, 'loss_val': 0.023057091243216733, 'psi': 0.9970371739059719}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=2.579142 (no previous merge yet)
[S6] round=97 local utility u=0.194853 metrics={'f1_val': 0.8833609015302328, 'auprc': 0.9403790540435266, 'loss_val': 0.4372987162223324, 'psi': 0.9061681625355503}-{'f1_val': 0.8283509806392971, 'auprc': 0.9374099748645988, 'loss_val': 0.48803873374903706, 'psi': 0.8719745783294177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=97 head_norm_before_train=1.817995 cos_to_last_merge=0.9951 (last merge round=43)
[S7] round=97 local utility u=0.005094 metrics={'f1_val': 0.6426969243828294, 'auprc': 0.8002120286364278, 'loss_val': 0.6077439999119811, 'psi': 0.7057029660842689}-{'f1_val': 0.6301188331281828, 'auprc': 0.8017818358847789, 'loss_val': 0.5471737089463505, 'psi': 0.6987840342308212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=97 head_norm_before_train=2.440443 cos_to_last_merge=0.9893 (last merge round=42)
[S8] round=97 local utility u=0.771837 metrics={'f1_val': 0.985783416145626, 'auprc': 0.9989949173779539, 'loss_val': 0.04070034479920007, 'psi': 0.9910680166385571}-{'f1_val': 0.8115087057291306, 'auprc': 0.993140901832468, 'loss_val': 0.5211649323882632, 'psi': 0.8841615841704655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=97 head_norm_before_train=2.382660 (no previous merge yet)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9967908009243918, 'auprc': 0.9984664419495415, 'loss_val': 0.0158119907259807, 'psi': 0.9974610573344517}-{'f1_val': 0.9971290324227131, 'auprc': 0.9990680841482401, 'loss_val': 0.016675928182667547, 'psi': 0.997904653112924}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.291545 cos_to_last_merge=0.9918 (last merge round=39)
[S10] round=97 local utility u=0.000160 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9949629378629058, 'loss_val': 0.027704632096204756, 'psi': 0.9947026392241989}-{'f1_val': 0.9945291067983943, 'auprc': 0.9948950113089383, 'loss_val': 0.0278213430287232, 'psi': 0.9946754686026119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=97 head_norm_before_train=1.883219 cos_to_last_merge=0.9518 (last merge round=35)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9572074717220812, 'auprc': 0.998060837019987, 'loss_val': 0.11992008068097743, 'psi': 0.9735488178412435}-{'f1_val': 0.9950298048205717, 'auprc': 0.9980431706581996, 'loss_val': 0.022998429727394413, 'psi': 0.9962351511556229}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.287079 (no previous merge yet)
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.6443784032577854, 'auprc': 0.6609583273007721, 'loss_val': 1.589734224850978, 'psi': 0.6510103728749801}-{'f1_val': 0.6530609948877288, 'auprc': 0.6771858818641338, 'loss_val': 1.4769309397857766, 'psi': 0.6627109496782908}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=1.860754 cos_to_last_merge=0.9845 (last merge round=42)
[S14] round=97 local utility u=0.000246 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9984407944188771, 'loss_val': 0.01984791765918866, 'psi': 0.9978097928932892}-{'f1_val': 0.9971687801929319, 'auprc': 0.9985765372756061, 'loss_val': 0.019425489239832616, 'psi': 0.9977318830260016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=97 head_norm_before_train=2.079402 cos_to_last_merge=0.9782 (last merge round=42)
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977242094858395, 'loss_val': 0.023419210982459446, 'psi': 0.9971376848268482}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977257240955603, 'loss_val': 0.021983503939081744, 'psi': 0.9971382906707364}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=1.862009 cos_to_last_merge=0.9859 (last merge round=42)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.8491846292524103, 'auprc': 0.9159976332673746, 'loss_val': 1.1309623657355612, 'psi': 0.875909830858396}-{'f1_val': 0.8614887459590637, 'auprc': 0.9800441764455041, 'loss_val': 0.883240034821817, 'psi': 0.9089109181536399}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.182361 cos_to_last_merge=0.9364 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.8573464794974655, 'auprc': 0.9552479520695742, 'loss_val': 0.7222101295551302, 'psi': 0.896507068526309}-{'f1_val': 0.8725095192449754, 'auprc': 0.9289184141402069, 'loss_val': 0.5441811729876096, 'psi': 0.895073077203068}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=98 head_norm_before_train=2.210340 cos_to_last_merge=0.7387 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.739
[S2] round=98 local utility u=0.408163 metrics={'f1_val': 0.7175681060589865, 'auprc': 0.848391954120443, 'loss_val': 0.7064911368682611, 'psi': 0.7698976452835691}-{'f1_val': 0.7203920281772388, 'auprc': 0.7101985286899426, 'loss_val': 1.1251809294371042, 'psi': 0.7163146283823203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=98 head_norm_before_train=2.388164 cos_to_last_merge=0.9935 (last merge round=43)
[S3] round=98 local utility u=0.027452 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9826562079973142, 'loss_val': 0.16400036255617187, 'psi': 0.9697316375396172}-{'f1_val': 0.9608296089712303, 'auprc': 0.9686812187968398, 'loss_val': 0.17526630712320332, 'psi': 0.963970252901474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=98 head_norm_before_train=1.928903 cos_to_last_merge=0.9816 (last merge round=41)
[S4] round=98 local utility u=0.156791 metrics={'f1_val': 0.9420147127171903, 'auprc': 0.9638555946879023, 'loss_val': 0.3698773051238469, 'psi': 0.9507510655054751}-{'f1_val': 0.912291368732924, 'auprc': 0.9510724930567924, 'loss_val': 0.4667693166933696, 'psi': 0.9278038184624715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=98 head_norm_before_train=1.938687 cos_to_last_merge=0.9269 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=98 local utility u=0.006590 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9974479988941176, 'loss_val': 0.023575589204775153, 'psi': 0.9968668877292851}-{'f1_val': 0.9964794802860635, 'auprc': 0.9939219140705378, 'loss_val': 0.02617829166220268, 'psi': 0.9954564537998531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=98 head_norm_before_train=2.586070 (no previous merge yet)
[S6] round=98 local utility u=0.271177 metrics={'f1_val': 0.9258006863760693, 'auprc': 0.9714786157431999, 'loss_val': 0.24288259641054133, 'psi': 0.9440718581229215}-{'f1_val': 0.8833609015302328, 'auprc': 0.9403790540435266, 'loss_val': 0.4372987162223324, 'psi': 0.9061681625355503}
[S6] not sending this round → trigger blocked (psi=0.944)
[S7] START round=98 head_norm_before_train=1.820615 cos_to_last_merge=0.9952 (last merge round=43)
[S7] round=98 local utility u=0.392916 metrics={'f1_val': 0.6915357521114582, 'auprc': 0.8657062484837075, 'loss_val': 0.3114271407776095, 'psi': 0.7612039506603578}-{'f1_val': 0.6426969243828294, 'auprc': 0.8002120286364278, 'loss_val': 0.6077439999119811, 'psi': 0.7057029660842689}
[S7] not sending this round → trigger blocked (psi=0.761)
[S8] START round=98 head_norm_before_train=2.444034 cos_to_last_merge=0.9890 (last merge round=42)
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9378640029906739, 'auprc': 0.9992524824151449, 'loss_val': 0.15446602691056957, 'psi': 0.9624193947604622}-{'f1_val': 0.985783416145626, 'auprc': 0.9989949173779539, 'loss_val': 0.04070034479920007, 'psi': 0.9910680166385571}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=2.386092 (no previous merge yet)
[S9] round=98 local utility u=0.001988 metrics={'f1_val': 0.9971725113487396, 'auprc': 0.999137075292551, 'loss_val': 0.01613773440736858, 'psi': 0.9979583369262641}-{'f1_val': 0.9967908009243918, 'auprc': 0.9984664419495415, 'loss_val': 0.0158119907259807, 'psi': 0.9974610573344517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=98 head_norm_before_train=2.298059 cos_to_last_merge=0.9920 (last merge round=39)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.994949543679412, 'loss_val': 0.028003046901483516, 'psi': 0.9946972815508014}-{'f1_val': 0.9945291067983943, 'auprc': 0.9949629378629058, 'loss_val': 0.027704632096204756, 'psi': 0.9947026392241989}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=1.887941 cos_to_last_merge=0.9514 (last merge round=35)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9567653203810371, 'auprc': 0.9980655638922098, 'loss_val': 0.14284148043365272, 'psi': 0.9732854177855061}-{'f1_val': 0.9572074717220812, 'auprc': 0.998060837019987, 'loss_val': 0.11992008068097743, 'psi': 0.9735488178412435}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=2.290587 (no previous merge yet)
[S13] round=98 local utility u=0.205485 metrics={'f1_val': 0.6559654873228353, 'auprc': 0.7050212889585039, 'loss_val': 1.380476263296589, 'psi': 0.6755878079771027}-{'f1_val': 0.6443784032577854, 'auprc': 0.6609583273007721, 'loss_val': 1.589734224850978, 'psi': 0.6510103728749801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=98 head_norm_before_train=1.863540 cos_to_last_merge=0.9842 (last merge round=42)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9983868908865385, 'loss_val': 0.022122714216079132, 'psi': 0.9977882314803537}-{'f1_val': 0.9973891252095638, 'auprc': 0.9984407944188771, 'loss_val': 0.01984791765918866, 'psi': 0.9978097928932892}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.084378 cos_to_last_merge=0.9780 (last merge round=42)
[S15] round=98 local utility u=0.000517 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977183715048578, 'loss_val': 0.022367576141919917, 'psi': 0.9971353496344555}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977242094858395, 'loss_val': 0.023419210982459446, 'psi': 0.9971376848268482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=98 head_norm_before_train=1.865698 cos_to_last_merge=0.9857 (last merge round=42)
[S16] round=98 local utility u=1.000000 metrics={'f1_val': 0.9910268116868775, 'auprc': 0.9826911932111776, 'loss_val': 0.056079234840747595, 'psi': 0.9876925642965975}-{'f1_val': 0.8491846292524103, 'auprc': 0.9159976332673746, 'loss_val': 1.1309623657355612, 'psi': 0.875909830858396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=98 head_norm_before_train=2.188536 cos_to_last_merge=0.9359 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=98 local utility u=0.292418 metrics={'f1_val': 0.9075090206207849, 'auprc': 0.9651624478764937, 'loss_val': 0.468093574389871, 'psi': 0.9305703915230683}-{'f1_val': 0.8573464794974655, 'auprc': 0.9552479520695742, 'loss_val': 0.7222101295551302, 'psi': 0.896507068526309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=99 head_norm_before_train=2.210532 cos_to_last_merge=0.7386 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.739
[S2] round=99 local utility u=0.268016 metrics={'f1_val': 0.7666988252435243, 'auprc': 0.8523163236050241, 'loss_val': 0.47701712650268935, 'psi': 0.8009458245881242}-{'f1_val': 0.7175681060589865, 'auprc': 0.848391954120443, 'loss_val': 0.7064911368682611, 'psi': 0.7698976452835691}
[S2] not sending this round → trigger blocked (psi=0.801)
[S2] r=100 psi=0.801 u=0.2680 p_local=0.1505 f1=0.767 auprc=0.852 bytes=70234
[S3] START round=99 head_norm_before_train=2.391348 cos_to_last_merge=0.9934 (last merge round=43)
[S3] round=99 local utility u=0.035837 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9940948186040927, 'loss_val': 0.1266425796508117, 'psi': 0.9743070817823285}-{'f1_val': 0.9611152572344858, 'auprc': 0.9826562079973142, 'loss_val': 0.16400036255617187, 'psi': 0.9697316375396172}
[S3] not sending this round → trigger blocked (psi=0.974)
[S3] r=100 psi=0.974 u=0.0358 p_local=0.1116 f1=0.961 auprc=0.994 bytes=77334
[S4] START round=99 head_norm_before_train=1.929225 cos_to_last_merge=0.9814 (last merge round=41)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9409442599166533, 'auprc': 0.958858127446546, 'loss_val': 0.3715011029282947, 'psi': 0.9481098069286104}-{'f1_val': 0.9420147127171903, 'auprc': 0.9638555946879023, 'loss_val': 0.3698773051238469, 'psi': 0.9507510655054751}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.948 u=0.0000 p_local=0.1010 f1=0.941 auprc=0.959 bytes=68421
[S5] START round=99 head_norm_before_train=1.939721 cos_to_last_merge=0.9260 (last merge round=38)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9962282646733219, 'loss_val': 0.024803384686209656, 'psi': 0.9962029198549154}-{'f1_val': 0.9964794802860635, 'auprc': 0.9974479988941176, 'loss_val': 0.023575589204775153, 'psi': 0.9968668877292851}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.996 u=0.0000 p_local=0.0024 f1=0.996 auprc=0.996 bytes=70190
[S6] START round=99 head_norm_before_train=2.592018 (no previous merge yet)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.8323432151761606, 'auprc': 0.9479900630222776, 'loss_val': 0.34935047715138645, 'psi': 0.8786019543146074}-{'f1_val': 0.9258006863760693, 'auprc': 0.9714786157431999, 'loss_val': 0.24288259641054133, 'psi': 0.9440718581229215}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.879 u=0.0000 p_local=0.1314 f1=0.832 auprc=0.948 bytes=75485
[S7] START round=99 head_norm_before_train=1.824393 cos_to_last_merge=0.9951 (last merge round=43)
[S7] round=99 local utility u=0.000000 metrics={'f1_val': 0.5859245070516252, 'auprc': 0.7874218536912382, 'loss_val': 1.095265851712371, 'psi': 0.6665234457074705}-{'f1_val': 0.6915357521114582, 'auprc': 0.8657062484837075, 'loss_val': 0.3114271407776095, 'psi': 0.7612039506603578}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=100 psi=0.667 u=0.0000 p_local=0.1399 f1=0.586 auprc=0.787 bytes=73806
[S8] START round=99 head_norm_before_train=2.447982 cos_to_last_merge=0.9888 (last merge round=42)
[S8] round=99 local utility u=0.244673 metrics={'f1_val': 0.9969685224833627, 'auprc': 0.9995349574682286, 'loss_val': 0.020594578538002645, 'psi': 0.997995096477309}-{'f1_val': 0.9378640029906739, 'auprc': 0.9992524824151449, 'loss_val': 0.15446602691056957, 'psi': 0.9624193947604622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S8] r=100 psi=0.998 u=0.2447 p_local=0.1575 f1=0.997 auprc=1.000 bytes=70132
[S9] START round=99 head_norm_before_train=2.389861 (no previous merge yet)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9965897269135436, 'auprc': 0.9985343638762116, 'loss_val': 0.02758391419713494, 'psi': 0.9973675816986108}-{'f1_val': 0.9971725113487396, 'auprc': 0.999137075292551, 'loss_val': 0.01613773440736858, 'psi': 0.9979583369262641}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.997 u=0.0000 p_local=0.0012 f1=0.997 auprc=0.999 bytes=73732
[S10] START round=99 head_norm_before_train=2.300505 cos_to_last_merge=0.9917 (last merge round=39)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9948607615260321, 'loss_val': 0.0279443106054748, 'psi': 0.9946617686894494}-{'f1_val': 0.9945291067983943, 'auprc': 0.994949543679412, 'loss_val': 0.028003046901483516, 'psi': 0.9946972815508014}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.995 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.995 bytes=62948
[S11] START round=99 head_norm_before_train=1.893022 cos_to_last_merge=0.9510 (last merge round=35)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9570071574257657, 'auprc': 0.9980747566887653, 'loss_val': 0.1456981016502999, 'psi': 0.9734341971309656}-{'f1_val': 0.9567653203810371, 'auprc': 0.9980655638922098, 'loss_val': 0.14284148043365272, 'psi': 0.9732854177855061}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.973 u=0.0000 p_local=0.0391 f1=0.957 auprc=0.998 bytes=71945
[S13] START round=99 head_norm_before_train=2.301802 (no previous merge yet)
[S13] round=99 local utility u=0.073942 metrics={'f1_val': 0.6861129416154328, 'auprc': 0.6995097472064382, 'loss_val': 1.396941685265501, 'psi': 0.691471663851835}-{'f1_val': 0.6559654873228353, 'auprc': 0.7050212889585039, 'loss_val': 1.380476263296589, 'psi': 0.6755878079771027}
[S13] not sending this round → trigger blocked (psi=0.691)
[S13] r=100 psi=0.691 u=0.0739 p_local=0.1277 f1=0.686 auprc=0.700 bytes=66596
[S14] START round=99 head_norm_before_train=1.866407 cos_to_last_merge=0.9840 (last merge round=42)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9969485114736489, 'auprc': 0.9988123834669055, 'loss_val': 0.021766733754343914, 'psi': 0.9976940602709515}-{'f1_val': 0.9973891252095638, 'auprc': 0.9983868908865385, 'loss_val': 0.022122714216079132, 'psi': 0.9977882314803537}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.998 u=0.0000 p_local=0.0183 f1=0.997 auprc=0.999 bytes=79082
[S15] START round=99 head_norm_before_train=2.089283 cos_to_last_merge=0.9778 (last merge round=42)
[S15] round=99 local utility u=0.000088 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977234402584048, 'loss_val': 0.022206873910062895, 'psi': 0.9971373771358742}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977183715048578, 'loss_val': 0.022367576141919917, 'psi': 0.9971353496344555}
[S15] not sending this round → trigger blocked (psi=0.997)
[S15] r=100 psi=0.997 u=0.0001 p_local=0.0012 f1=0.997 auprc=0.998 bytes=71944
[S16] START round=99 head_norm_before_train=1.868662 cos_to_last_merge=0.9855 (last merge round=42)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.842933578086326, 'auprc': 0.9802201174368673, 'loss_val': 0.5493605083655952, 'psi': 0.8978481938265426}-{'f1_val': 0.9910268116868775, 'auprc': 0.9826911932111776, 'loss_val': 0.056079234840747595, 'psi': 0.9876925642965975}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.898 u=0.0000 p_local=0.2000 f1=0.843 auprc=0.980 bytes=73708
[S17] START round=99 head_norm_before_train=2.191518 cos_to_last_merge=0.9354 (last merge round=42)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.8947361423722855, 'auprc': 0.960792224850419, 'loss_val': 0.5008304332262661, 'psi': 0.921158575363539}-{'f1_val': 0.9075090206207849, 'auprc': 0.9651624478764937, 'loss_val': 0.468093574389871, 'psi': 0.9305703915230683}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.921 u=0.0000 p_local=0.1187 f1=0.895 auprc=0.961 bytes=63034
[runner] rounds complete.
[runner] all agents stopped.
