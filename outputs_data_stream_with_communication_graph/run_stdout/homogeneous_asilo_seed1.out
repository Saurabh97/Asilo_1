[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:36603
[S3] → join 127.0.0.1:36602
[S4] → join 127.0.0.1:36602
[S5] → join 127.0.0.1:36602
[S6] → join 127.0.0.1:36602
[S7] → join 127.0.0.1:36602
[S8] → join 127.0.0.1:36602
[S9] → join 127.0.0.1:36602
[S10] → join 127.0.0.1:36602
[S11] → join 127.0.0.1:36602
[S13] → join 127.0.0.1:36602
[S14] → join 127.0.0.1:36602
[S15] → join 127.0.0.1:36602
[S16] → join 127.0.0.1:36602
[S17] → join 127.0.0.1:36602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.142707 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.144691 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.144834 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.155828 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.211743 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.164485 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.175274 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.147208 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.198083 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.156185 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.190974 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.129446 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.186037 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.205872 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.117439 (no previous merge yet)
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S3] + discovered S4
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S14
[S3] + discovered S16
[S4] + discovered S3
[S3] + discovered S6
[S4] + discovered S2
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S17
[S4] + discovered S14
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S6
[S5] + discovered S2
[S4] + discovered S9
[S4] + discovered S7
[S4] + discovered S15
[S5] + discovered S3
[S4] + discovered S5
[S4] + discovered S10
[S4] + discovered S17
[S5] + discovered S4
[S4] + discovered S16
[S4] + discovered S13
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S14
[S5] + discovered S10
[S5] + discovered S7
[S5] + discovered S15
[S5] + discovered S8
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S6
[S5] + discovered S11
[S5] + discovered S13
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S8
[S7] + discovered S4
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S14
[S6] + discovered S9
[S7] + discovered S2
[S7] + discovered S3
[S6] + discovered S15
[S7] + discovered S5
[S7] + discovered S6
[S6] + discovered S16
[S8] + discovered S5
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S7
[S7] + discovered S16
[S7] + discovered S11
[S8] + discovered S2
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S9
[S7] + discovered S10
[S8] + discovered S6
[S7] + discovered S15
[S7] + discovered S17
[S7] + discovered S13
[S9] + discovered S2
[S8] + discovered S16
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S9
[S9] + discovered S8
[S8] + discovered S10
[S8] + discovered S15
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S7
[S8] + discovered S17
[S8] + discovered S14
[S9] + discovered S5
[S9] + discovered S4
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S6
[S10] + discovered S8
[S9] + discovered S10
[S10] + discovered S3
[S9] + discovered S13
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S15
[S10] + discovered S9
[S9] + discovered S14
[S9] + discovered S11
[S10] + discovered S2
[S10] + discovered S5
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S7
[S10] + discovered S13
[S10] + discovered S16
[S10] + discovered S11
[S11] + discovered S10
[S10] + discovered S15
[S11] + discovered S5
[S10] + discovered S14
[S11] + discovered S8
[S11] + discovered S9
[S10] + discovered S17
[S11] + discovered S2
[S13] + discovered S7
[S11] + discovered S13
[S13] + discovered S8
[S13] + discovered S10
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S2
[S13] + discovered S4
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S5
[S11] + discovered S14
[S13] + discovered S9
[S11] + discovered S16
[S13] + discovered S11
[S14] + discovered S7
[S13] + discovered S16
[S14] + discovered S9
[S14] + discovered S11
[S14] + discovered S13
[S13] + discovered S14
[S14] + discovered S10
[S13] + discovered S15
[S14] + discovered S4
[S14] + discovered S2
[S14] + discovered S8
[S14] + discovered S5
[S13] + discovered S17
[S14] + discovered S6
[S14] + discovered S3
[S14] + discovered S15
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S13
[S14] + discovered S16
[S15] + discovered S14
[S15] + discovered S8
[S15] + discovered S7
[S15] + discovered S10
[S14] + discovered S17
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S6
[S15] + discovered S5
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S10
[S16] + discovered S7
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S6
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S5
[S16] + discovered S11
[S16] + discovered S14
[S16] + discovered S8
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S3
[S17] + discovered S5
[S17] + discovered S15
[S17] + discovered S9
[S17] + discovered S4
[S17] + discovered S7
[S17] + discovered S13
[S17] + discovered S10
[S17] + discovered S8
[S16] + discovered S17
[S17] + discovered S11
[S17] + discovered S16
[S17] + discovered S14
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:36610
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S4] ⇄ pheromone p=1.000 → S16@127.0.0.1:36616
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S2] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S9] ⇄ pheromone p=1.000 → S5@127.0.0.1:36605
[S5] ⇄ pheromone p=1.000 → S7@127.0.0.1:36608
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:36602
[S15] ⇄ pheromone p=1.000 → S4@127.0.0.1:36604
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:36607
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:36613
[S2] START round=1 head_norm_before_train=1.153204 (no previous merge yet)
[S2] round=1 local utility u=0.911983 metrics={'f1_val': 0.39905944882492794, 'auprc': 0.7721290468727977, 'loss_val': 1.3162940730247945, 'psi': 0.5482872880440759}-{'f1_val': 0.10477605118829982, 'auprc': 0.7641868738265065, 'loss_val': 1.3507338941479912, 'psi': 0.36854038024358254}
[S3] START round=1 head_norm_before_train=1.148692 (no previous merge yet)
[S3] round=1 local utility u=0.812278 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9722427747258642, 'loss_val': 1.3140824742632018, 'psi': 0.4728011492588099}-{'f1_val': 0.13984006561410703, 'auprc': 0.44005687767148866, 'loss_val': 1.3420804646469573, 'psi': 0.2599267904370597}
[S4] START round=1 head_norm_before_train=1.154932 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7776691901479026, 'loss_val': 1.3287291659765676, 'psi': 0.39520365339627156}-{'f1_val': 0.3060706214148224, 'auprc': 0.7325752855266546, 'loss_val': 1.37161161751046, 'psi': 0.47667248705955534}
[S5] START round=1 head_norm_before_train=1.158787 (no previous merge yet)
[S5] round=1 local utility u=1.000000 metrics={'f1_val': 0.4247767552317834, 'auprc': 0.7350822534709714, 'loss_val': 1.3442009631081917, 'psi': 0.5488989545274586}-{'f1_val': 0.11396970425583072, 'auprc': 0.5351953114290138, 'loss_val': 1.381315273578414, 'psi': 0.28245994712510397}
[S6] START round=1 head_norm_before_train=1.211750 (no previous merge yet)
[S6] round=1 local utility u=0.273938 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8130128676031989, 'loss_val': 1.3179868176693523, 'psi': 0.41006091627204877}-{'f1_val': 0.14142628205128205, 'auprc': 0.6400292606180382, 'loss_val': 1.346911467596811, 'psi': 0.3408674734779845}
[S7] START round=1 head_norm_before_train=1.167050 (no previous merge yet)
[S7] round=1 local utility u=0.648949 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6342875884387065, 'loss_val': 1.3356114295941681, 'psi': 0.3389491290129376}-{'f1_val': 0.14205682272909165, 'auprc': 0.2119368384090621, 'loss_val': 1.366457170669782, 'psi': 0.17000882900107983}
[S8] START round=1 head_norm_before_train=1.181308 (no previous merge yet)
[S8] round=1 local utility u=0.017139 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6548292659683475, 'loss_val': 1.3107848941404177, 'psi': 0.3459052958231133}-{'f1_val': 0.13995598239295717, 'auprc': 0.6533316048912757, 'loss_val': 1.3405694261597987, 'psi': 0.3453062313922846}
[S9] START round=1 head_norm_before_train=1.151791 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.864702433895191, 'loss_val': 1.3119211673696565, 'psi': 0.430719747842074}-{'f1_val': 0.6582640529049696, 'auprc': 0.6761294458229766, 'loss_val': 1.3543450837188304, 'psi': 0.6654102100721724}
[S10] START round=1 head_norm_before_train=1.204049 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.9980095816553604, 'loss_val': 1.3089962944028717, 'psi': 0.4823768151871785}-{'f1_val': 0.38733748574823096, 'auprc': 0.9960466244881723, 'loss_val': 1.340019544845923, 'psi': 0.6308211412442075}
[S11] START round=1 head_norm_before_train=1.161880 (no previous merge yet)
[S11] round=1 local utility u=0.351123 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6547732229283586, 'loss_val': 1.2993131134574212, 'psi': 0.3461574991952098}-{'f1_val': 0.14041368337311058, 'auprc': 0.4315756304483825, 'loss_val': 1.33196664294105, 'psi': 0.25687846220321936}
[S13] START round=1 head_norm_before_train=1.201007 (no previous merge yet)
[S13] round=1 local utility u=0.048823 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5850597473193823, 'loss_val': 1.3184691358981242, 'psi': 0.3182553564739848}-{'f1_val': 0.1403857625770531, 'auprc': 0.5637066898746478, 'loss_val': 1.3520554826416642, 'psi': 0.309714133496091}
[S14] START round=1 head_norm_before_train=1.124580 (no previous merge yet)
[S14] round=1 local utility u=0.653672 metrics={'f1_val': 0.2691901186269561, 'auprc': 0.33707938262379855, 'loss_val': 1.359467614327657, 'psi': 0.29634582422569306}-{'f1_val': 0.1038107752956636, 'auprc': 0.2388308929414939, 'loss_val': 1.3797903765511226, 'psi': 0.15781882235399572}
[S15] START round=1 head_norm_before_train=1.186309 (no previous merge yet)
[S15] round=1 local utility u=0.968756 metrics={'f1_val': 0.4221773205975998, 'auprc': 0.7583053286987795, 'loss_val': 1.3411120385390642, 'psi': 0.5566285238380717}-{'f1_val': 0.103651869669801, 'auprc': 0.7595045250657438, 'loss_val': 1.371068835295014, 'psi': 0.36599293182817816}
[S16] START round=1 head_norm_before_train=1.210904 (no previous merge yet)
[S16] round=1 local utility u=0.198014 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7462539530100998, 'loss_val': 1.3255675855790352, 'psi': 0.38288405132356185}-{'f1_val': 0.1473290768821495, 'auprc': 0.6145961736690415, 'loss_val': 1.36677269694039, 'psi': 0.3342359155969063}
[S17] START round=1 head_norm_before_train=1.117981 (no previous merge yet)
[S17] round=1 local utility u=0.181436 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.4175009769490212, 'loss_val': 1.3435378800380848, 'psi': 0.2515697687700391}-{'f1_val': 0.18109574731803757, 'auprc': 0.22670064605034634, 'loss_val': 1.3748899148861584, 'psi': 0.19933770681096108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:36613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:36614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:36614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:36607
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S2] → sending delta(kind=head bytes=1786) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:36612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:36614
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:36603
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1786 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S6
[S14] cosine check vs S6: cos=0.0829
[S16] RECEIVED delta(kind=head bytes=1791) from S15
[S16] cosine check vs S15: cos=-0.0098
[S16] DROPPED delta from S15 (cos=-0.0098 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=-0.0162
[S14] DROPPED delta from S7 (cos=-0.0162 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S11
[S14] cosine check vs S11: cos=0.0306
[S4] RECEIVED delta(kind=head bytes=1786) from S2
[S4] cosine check vs S2: cos=-0.0121
[S4] DROPPED delta from S2 (cos=-0.0121 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S13
[S3] cosine check vs S13: cos=0.0330
[S13] RECEIVED delta(kind=head bytes=1791) from S3
[S13] cosine check vs S3: cos=0.0330
[S2] RECEIVED delta(kind=head bytes=1788) from S8
[S2] cosine check vs S8: cos=-0.0496
[S2] DROPPED delta from S8 (cos=-0.0496 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S14
[S6] cosine check vs S14: cos=0.0829
[S11] RECEIVED delta(kind=head bytes=1794) from S5
[S11] cosine check vs S5: cos=0.0241
[S5] RECEIVED delta(kind=head bytes=1792) from S16
[S5] cosine check vs S16: cos=0.0016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:36614
[S17] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S17
[S14] cosine check vs S17: cos=-0.0463
[S14] DROPPED delta from S17 (cos=-0.0463 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.219640
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.287378e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.856518 delta_norm=0.828738
[S13] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.163330
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.287378e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.856518 delta_norm=0.828738
[S3] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.177036
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.201262e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.840144 delta_norm=0.820126
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.2692 head_norm=1.129857
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.833770e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.737898 delta_norm=0.683377
[S14] aggregate: ROLLBACK (f1_val pre=0.269 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.220378
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.964556e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.865221 delta_norm=0.796456
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.4248 head_norm=1.171104
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.479248e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.849311 delta_norm=0.847925
[S5] aggregate: ROLLBACK (f1_val pre=0.425 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.171464 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1446839991545128, 'auprc': 0.7721467897992392, 'loss_val': 1.2722789326771373, 'psi': 0.3956691154124034}-{'f1_val': 0.39905944882492794, 'auprc': 0.7721290468727977, 'loss_val': 1.3162940730247945, 'psi': 0.5482872880440759}
[S3] START round=2 head_norm_before_train=0.856518 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.039338 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.997998511533844, 'loss_val': 1.3126728327681871, 'psi': 0.4831034439820019}-{'f1_val': 0.13984006561410703, 'auprc': 0.9722427747258642, 'loss_val': 1.3140824742632018, 'psi': 0.4728011492588099}
[S4] START round=2 head_norm_before_train=1.172960 (no previous merge yet)
[S4] round=2 local utility u=0.030733 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.780683432843207, 'loss_val': 1.2763058142403154, 'psi': 0.3964093504743933}-{'f1_val': 0.14022662889518414, 'auprc': 0.7776691901479026, 'loss_val': 1.3287291659765676, 'psi': 0.39520365339627156}
[S5] START round=2 head_norm_before_train=0.849311 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.735644996078842, 'loss_val': 1.334424199061132, 'psi': 0.3796151412886797}-{'f1_val': 0.4247767552317834, 'auprc': 0.7350822534709714, 'loss_val': 1.3442009631081917, 'psi': 0.5488989545274586}
[S6] START round=2 head_norm_before_train=0.865221 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.021023 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8276181910945022, 'loss_val': 1.3197566842747936, 'psi': 0.4159030456685701}-{'f1_val': 0.14142628205128205, 'auprc': 0.8130128676031989, 'loss_val': 1.3179868176693523, 'psi': 0.41006091627204877}
[S7] START round=2 head_norm_before_train=1.178332 (no previous merge yet)
[S7] round=2 local utility u=0.222015 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7711203030632139, 'loss_val': 1.3020794320459754, 'psi': 0.3936822148627406}-{'f1_val': 0.14205682272909165, 'auprc': 0.6342875884387065, 'loss_val': 1.3356114295941681, 'psi': 0.3389491290129376}
[S8] START round=2 head_norm_before_train=1.197900 (no previous merge yet)
[S8] round=2 local utility u=0.043777 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6715766935700653, 'loss_val': 1.2734729549226125, 'psi': 0.3526042668638005}-{'f1_val': 0.13995598239295717, 'auprc': 0.6548292659683475, 'loss_val': 1.3107848941404177, 'psi': 0.3459052958231133}
[S9] START round=2 head_norm_before_train=1.167664 (no previous merge yet)
[S9] round=2 local utility u=0.028766 metrics={'f1_val': 0.141397957139996, 'auprc': 0.865718046600477, 'loss_val': 1.2574362835596022, 'psi': 0.43112599292418846}-{'f1_val': 0.141397957139996, 'auprc': 0.864702433895191, 'loss_val': 1.3119211673696565, 'psi': 0.430719747842074}
[S10] START round=2 head_norm_before_train=1.218502 (no previous merge yet)
[S10] round=2 local utility u=0.021600 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.9982841395209029, 'loss_val': 1.266619230151138, 'psi': 0.48248663833339556}-{'f1_val': 0.13862163754172394, 'auprc': 0.9980095816553604, 'loss_val': 1.3089962944028717, 'psi': 0.4823768151871785}
[S11] START round=2 head_norm_before_train=0.840144 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.027212 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6745826303519877, 'loss_val': 1.3043170454382775, 'psi': 0.35408126216466146}-{'f1_val': 0.14041368337311058, 'auprc': 0.6547732229283586, 'loss_val': 1.2993131134574212, 'psi': 0.3461574991952098}
[S13] START round=2 head_norm_before_train=0.856518 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5742370699689986, 'loss_val': 1.3085442385413124, 'psi': 0.3139262855338313}-{'f1_val': 0.1403857625770531, 'auprc': 0.5850597473193823, 'loss_val': 1.3184691358981242, 'psi': 0.3182553564739848}
[S14] START round=2 head_norm_before_train=0.737898 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.43546413975736664, 'loss_val': 1.347003796328373, 'psi': 0.2584003676325689}-{'f1_val': 0.2691901186269561, 'auprc': 0.33707938262379855, 'loss_val': 1.359467614327657, 'psi': 0.29634582422569306}
[S15] START round=2 head_norm_before_train=1.193968 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7594958950499409, 'loss_val': 1.3084959752259235, 'psi': 0.38763854883691135}-{'f1_val': 0.4221773205975998, 'auprc': 0.7583053286987795, 'loss_val': 1.3411120385390642, 'psi': 0.5566285238380717}
[S16] START round=2 head_norm_before_train=1.228465 (no previous merge yet)
[S16] round=2 local utility u=0.048848 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7641972446631318, 'loss_val': 1.2817014907875557, 'psi': 0.39006136798477464}-{'f1_val': 0.14063745019920318, 'auprc': 0.7462539530100998, 'loss_val': 1.3255675855790352, 'psi': 0.38288405132356185}
[S17] START round=2 head_norm_before_train=1.131684 (no previous merge yet)
[S17] round=2 local utility u=0.355839 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6429168143550679, 'loss_val': 1.3081076679335228, 'psi': 0.3417361037324578}-{'f1_val': 0.14094896331738438, 'auprc': 0.4175009769490212, 'loss_val': 1.3435378800380848, 'psi': 0.2515697687700391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:36603
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:36615
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:36603
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:36611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:36617
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:36612
[S3] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=0.1001
[S6] RECEIVED delta(kind=head bytes=1791) from S4
[S6] cosine check vs S4: cos=-0.0082
[S6] DROPPED delta from S4 (cos=-0.0082 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1788) from S16
[S15] cosine check vs S16: cos=-0.0082
[S15] DROPPED delta from S16 (cos=-0.0082 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.0365
[S11] RECEIVED delta(kind=head bytes=1792) from S3
[S11] cosine check vs S3: cos=-0.0143
[S11] DROPPED delta from S3 (cos=-0.0143 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1791) from S6
[S17] cosine check vs S6: cos=0.0069
[S3] RECEIVED delta(kind=head bytes=1794) from S10
[S3] cosine check vs S10: cos=-0.0428
[S3] DROPPED delta from S10 (cos=-0.0428 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S9
[S16] cosine check vs S9: cos=-0.0062
[S16] DROPPED delta from S9 (cos=-0.0062 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1791) from S8
[S3] cosine check vs S8: cos=-0.0675
[S3] DROPPED delta from S8 (cos=-0.0675 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:36610
[S17] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S17
[S9] cosine check vs S17: cos=0.0286
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1447 head_norm=1.197933
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.319346e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.862912 delta_norm=0.831935
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.195014
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.179369e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1537 head_norm=0.841662 delta_norm=0.817937
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=1.244464
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.208451e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.791883 delta_norm=0.720845
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=1.151857
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.236498e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.728507 delta_norm=0.723650
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.862912 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000765 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7773041719181264, 'loss_val': 1.2687802117079388, 'psi': 0.3959879488003906}-{'f1_val': 0.1446839991545128, 'auprc': 0.7721467897992392, 'loss_val': 1.2722789326771373, 'psi': 0.3956691154124034}
[S3] START round=3 head_norm_before_train=0.877986 cos_to_last_merge=0.9969 (last merge round=1)
[S3] round=3 local utility u=0.022679 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9986572206256803, 'loss_val': 1.2692900449592401, 'psi': 0.48336692761873634}-{'f1_val': 0.13984006561410703, 'auprc': 0.997998511533844, 'loss_val': 1.3126728327681871, 'psi': 0.4831034439820019}
[S4] START round=3 head_norm_before_train=1.199949 (no previous merge yet)
[S4] round=3 local utility u=0.035782 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7822074378873357, 'loss_val': 1.2093145829432155, 'psi': 0.3970189524920448}-{'f1_val': 0.14022662889518414, 'auprc': 0.780683432843207, 'loss_val': 1.2763058142403154, 'psi': 0.3964093504743933}
[S5] START round=3 head_norm_before_train=0.865945 cos_to_last_merge=0.9967 (last merge round=1)
[S5] round=3 local utility u=0.012590 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7288791449538454, 'loss_val': 1.288946795129634, 'psi': 0.37690880083868106}-{'f1_val': 0.14226190476190476, 'auprc': 0.735644996078842, 'loss_val': 1.334424199061132, 'psi': 0.3796151412886797}
[S6] START round=3 head_norm_before_train=0.884313 cos_to_last_merge=0.9970 (last merge round=1)
[S6] round=3 local utility u=0.022502 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8301539126262936, 'loss_val': 1.2823605896309411, 'psi': 0.41691733428128663}-{'f1_val': 0.14142628205128205, 'auprc': 0.8276181910945022, 'loss_val': 1.3197566842747936, 'psi': 0.4159030456685701}
[S7] START round=3 head_norm_before_train=1.199341 (no previous merge yet)
[S7] round=3 local utility u=0.021587 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.774553134552972, 'loss_val': 1.2692029959525706, 'psi': 0.39505534745864385}-{'f1_val': 0.14205682272909165, 'auprc': 0.7711203030632139, 'loss_val': 1.3020794320459754, 'psi': 0.3936822148627406}
[S8] START round=3 head_norm_before_train=1.225617 (no previous merge yet)
[S8] round=3 local utility u=0.120629 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7378627905717507, 'loss_val': 1.231072837855486, 'psi': 0.37911870566447464}-{'f1_val': 0.13995598239295717, 'auprc': 0.6715766935700653, 'loss_val': 1.2734729549226125, 'psi': 0.3526042668638005}
[S9] START round=3 head_norm_before_train=0.841662 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8653055749724602, 'loss_val': 1.26521051204229, 'psi': 0.43096100427298173}-{'f1_val': 0.141397957139996, 'auprc': 0.865718046600477, 'loss_val': 1.2574362835596022, 'psi': 0.43112599292418846}
[S10] START round=3 head_norm_before_train=0.791883 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.973585629731046, 'loss_val': 1.269603422698219, 'psi': 0.4726072344174528}-{'f1_val': 0.13862163754172394, 'auprc': 0.9982841395209029, 'loss_val': 1.266619230151138, 'psi': 0.48248663833339556}
[S11] START round=3 head_norm_before_train=0.862961 cos_to_last_merge=0.9967 (last merge round=1)
[S11] round=3 local utility u=0.153788 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7555782462237225, 'loss_val': 1.239727482103623, 'psi': 0.3864795085133554}-{'f1_val': 0.14041368337311058, 'auprc': 0.6745826303519877, 'loss_val': 1.3043170454382775, 'psi': 0.35408126216466146}
[S13] START round=3 head_norm_before_train=0.878214 cos_to_last_merge=0.9970 (last merge round=1)
[S13] round=3 local utility u=0.048700 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.59227983177485, 'loss_val': 1.2652722954068274, 'psi': 0.3211433902561719}-{'f1_val': 0.1403857625770531, 'auprc': 0.5742370699689986, 'loss_val': 1.3085442385413124, 'psi': 0.3139262855338313}
[S14] START round=3 head_norm_before_train=0.748764 cos_to_last_merge=0.9963 (last merge round=1)
[S14] round=3 local utility u=0.331801 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6508112755043512, 'loss_val': 1.3294435093801111, 'psi': 0.34453922193136277}-{'f1_val': 0.14035785288270378, 'auprc': 0.43546413975736664, 'loss_val': 1.347003796328373, 'psi': 0.2584003676325689}
[S15] START round=3 head_norm_before_train=1.211767 (no previous merge yet)
[S15] round=3 local utility u=0.029297 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7678952990751917, 'loss_val': 1.2751010172199126, 'psi': 0.3909983104470117}-{'f1_val': 0.13973365136155833, 'auprc': 0.7594958950499409, 'loss_val': 1.3084959752259235, 'psi': 0.38763854883691135}
[S16] START round=3 head_norm_before_train=1.256595 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7229072335761462, 'loss_val': 1.2306125091238698, 'psi': 0.37354536354998036}-{'f1_val': 0.14063745019920318, 'auprc': 0.7641972446631318, 'loss_val': 1.2817014907875557, 'psi': 0.39006136798477464}
[S17] START round=3 head_norm_before_train=0.728507 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6187333007210728, 'loss_val': 1.2978275025475878, 'psi': 0.33206269827885976}-{'f1_val': 0.14094896331738438, 'auprc': 0.6429168143550679, 'loss_val': 1.3081076679335228, 'psi': 0.3417361037324578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S5
[S7] cosine check vs S5: cos=0.0068
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=-0.0197
[S4] DROPPED delta from S2 (cos=-0.0197 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=0.0006
[S4] RECEIVED delta(kind=head bytes=1799) from S15
[S4] cosine check vs S15: cos=0.1204
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] cosine check vs S6: cos=-0.0100
[S4] DROPPED delta from S6 (cos=-0.0100 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.0015
[S9] RECEIVED delta(kind=head bytes=1795) from S8
[S9] cosine check vs S8: cos=0.0303
[S6] RECEIVED delta(kind=head bytes=1792) from S7
[S6] cosine check vs S7: cos=-0.0413
[S6] DROPPED delta from S7 (cos=-0.0413 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=0.0280
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=-0.0151
[S7] DROPPED delta from S14 (cos=-0.0151 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=-0.0292
[S7] DROPPED delta from S13 (cos=-0.0292 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.866900
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.512060e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.772780 delta_norm=0.751206
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=1.235623
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.199953e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.925415 delta_norm=0.819995
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.914595
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.438600e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.644248 delta_norm=0.643860
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.890105
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.314815e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.632427 delta_norm=0.631481
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.222364
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.548176e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.759690 delta_norm=0.754818
[S7] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.292632
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.815188e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.906507 delta_norm=0.881519
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.632427 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6816244660896449, 'loss_val': 1.2465818085237121, 'psi': 0.357716066468998}-{'f1_val': 0.1417771333885667, 'auprc': 0.7773041719181264, 'loss_val': 1.2687802117079388, 'psi': 0.3959879488003906}
[S3] START round=4 head_norm_before_train=0.907049 cos_to_last_merge=0.9882 (last merge round=1)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9299936792289174, 'loss_val': 1.2237208010398761, 'psi': 0.4559015110600312}-{'f1_val': 0.13984006561410703, 'auprc': 0.9986572206256803, 'loss_val': 1.2692900449592401, 'psi': 0.48336692761873634}
[S4] START round=4 head_norm_before_train=0.925415 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.001904 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7809735086362113, 'loss_val': 1.2018050864767647, 'psi': 0.396525380791595}-{'f1_val': 0.14022662889518414, 'auprc': 0.7822074378873357, 'loss_val': 1.2093145829432155, 'psi': 0.3970189524920448}
[S5] START round=4 head_norm_before_train=0.894195 cos_to_last_merge=0.9880 (last merge round=1)
[S5] round=4 local utility u=0.018122 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7289877454155822, 'loss_val': 1.2530281951464994, 'psi': 0.37695224102337577}-{'f1_val': 0.14226190476190476, 'auprc': 0.7288791449538454, 'loss_val': 1.288946795129634, 'psi': 0.37690880083868106}
[S6] START round=4 head_norm_before_train=0.644248 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000944 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8332013712571615, 'loss_val': 1.289614628613106, 'psi': 0.41813631773363386}-{'f1_val': 0.14142628205128205, 'auprc': 0.8301539126262936, 'loss_val': 1.2823605896309411, 'psi': 0.41691733428128663}
[S7] START round=4 head_norm_before_train=0.759690 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7721962201807356, 'loss_val': 1.2833181603558288, 'psi': 0.3941125817097493}-{'f1_val': 0.14205682272909165, 'auprc': 0.774553134552972, 'loss_val': 1.2692029959525706, 'psi': 0.39505534745864385}
[S8] START round=4 head_norm_before_train=1.253587 (no previous merge yet)
[S8] round=4 local utility u=0.073850 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7678746468293798, 'loss_val': 1.173408218349447, 'psi': 0.39112344816752626}-{'f1_val': 0.13995598239295717, 'auprc': 0.7378627905717507, 'loss_val': 1.231072837855486, 'psi': 0.37911870566447464}
[S9] START round=4 head_norm_before_train=0.772780 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.093533 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9265295674068834, 'loss_val': 1.261816261048903, 'psi': 0.455450601246751}-{'f1_val': 0.141397957139996, 'auprc': 0.8653055749724602, 'loss_val': 1.26521051204229, 'psi': 0.43096100427298173}
[S10] START round=4 head_norm_before_train=0.818288 cos_to_last_merge=0.9963 (last merge round=2)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6420976803180037, 'loss_val': 1.1985450814620289, 'psi': 0.3400120546522359}-{'f1_val': 0.13862163754172394, 'auprc': 0.973585629731046, 'loss_val': 1.269603422698219, 'psi': 0.4726072344174528}
[S11] START round=4 head_norm_before_train=0.897317 cos_to_last_merge=0.9881 (last merge round=1)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6011834856711407, 'loss_val': 1.1628944552533091, 'psi': 0.3247216042923226}-{'f1_val': 0.14041368337311058, 'auprc': 0.7555782462237225, 'loss_val': 1.239727482103623, 'psi': 0.3864795085133554}
[S13] START round=4 head_norm_before_train=0.908827 cos_to_last_merge=0.9888 (last merge round=1)
[S13] round=4 local utility u=0.253716 metrics={'f1_val': 0.19254745500289422, 'auprc': 0.6367156668279961, 'loss_val': 1.2041185490591924, 'psi': 0.37021473973293495}-{'f1_val': 0.1403857625770531, 'auprc': 0.59227983177485, 'loss_val': 1.2652722954068274, 'psi': 0.3211433902561719}
[S14] START round=4 head_norm_before_train=0.766084 cos_to_last_merge=0.9870 (last merge round=1)
[S14] round=4 local utility u=0.291770 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8370808251296151, 'loss_val': 1.304711870536389, 'psi': 0.41904704178146834}-{'f1_val': 0.14035785288270378, 'auprc': 0.6508112755043512, 'loss_val': 1.3294435093801111, 'psi': 0.34453922193136277}
[S15] START round=4 head_norm_before_train=1.237258 (no previous merge yet)
[S15] round=4 local utility u=0.023842 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.772844194039329, 'loss_val': 1.2422645332715894, 'psi': 0.39297786843266663}-{'f1_val': 0.13973365136155833, 'auprc': 0.7678952990751917, 'loss_val': 1.2751010172199126, 'psi': 0.3909983104470117}
[S16] START round=4 head_norm_before_train=0.906507 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.210263 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8624188864136648, 'loss_val': 1.2286223395234415, 'psi': 0.42935002468498784}-{'f1_val': 0.14063745019920318, 'auprc': 0.7229072335761462, 'loss_val': 1.2306125091238698, 'psi': 0.37354536354998036}
[S17] START round=4 head_norm_before_train=0.752853 cos_to_last_merge=0.9966 (last merge round=2)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5823962218868213, 'loss_val': 1.2566554878073632, 'psi': 0.31752786674515915}-{'f1_val': 0.14094896331738438, 'auprc': 0.6187333007210728, 'loss_val': 1.2978275025475878, 'psi': 0.33206269827885976}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.3227
[S5] RECEIVED delta(kind=head bytes=1793) from S9
[S5] cosine check vs S9: cos=-0.0170
[S5] DROPPED delta from S9 (cos=-0.0170 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S5
[S7] cosine check vs S5: cos=0.5737
[S4] RECEIVED delta(kind=head bytes=1797) from S15
[S4] cosine check vs S15: cos=0.7341
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] cosine check vs S4: cos=0.5044
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=0.8071
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=-0.0466
[S7] DROPPED delta from S13 (cos=-0.0466 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] cosine check vs S14: cos=-0.0260
[S7] DROPPED delta from S14 (cos=-0.0260 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] cosine check vs S6: cos=0.0271
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.782539
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.916461e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1920 head_norm=0.692817 delta_norm=0.391646
[S7] aggregate: ACCEPT kept=['S16', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.789877
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.987536e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.988914 delta_norm=0.398754
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.936343
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.713516e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.821105 delta_norm=0.471352
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.957097
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.605394e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1520 head_norm=0.763610 delta_norm=0.360539
[S4] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.665051 cos_to_last_merge=0.9933 (last merge round=3)
[S2] round=5 local utility u=0.043749 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6947647198459037, 'loss_val': 1.1985038480771102, 'psi': 0.36297216797150156}-{'f1_val': 0.1417771333885667, 'auprc': 0.6816244660896449, 'loss_val': 1.2465818085237121, 'psi': 0.357716066468998}
[S3] START round=5 head_norm_before_train=0.937959 cos_to_last_merge=0.9764 (last merge round=1)
[S3] round=5 local utility u=0.100036 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9719847505178293, 'loss_val': 1.1496225634829669, 'psi': 0.4726979395755959}-{'f1_val': 0.13984006561410703, 'auprc': 0.9299936792289174, 'loss_val': 1.2237208010398761, 'psi': 0.4559015110600312}
[S4] START round=5 head_norm_before_train=0.763610 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.024198 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7796985704751601, 'loss_val': 1.1495845379876983, 'psi': 0.39601540552717457}-{'f1_val': 0.14022662889518414, 'auprc': 0.7809735086362113, 'loss_val': 1.2018050864767647, 'psi': 0.396525380791595}
[S5] START round=5 head_norm_before_train=0.928441 cos_to_last_merge=0.9781 (last merge round=1)
[S5] round=5 local utility u=0.073249 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7674140423661228, 'loss_val': 1.221808472076677, 'psi': 0.392322759803592}-{'f1_val': 0.14226190476190476, 'auprc': 0.7289877454155822, 'loss_val': 1.2530281951464994, 'psi': 0.37695224102337577}
[S6] START round=5 head_norm_before_train=0.675232 cos_to_last_merge=0.9944 (last merge round=3)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8189507587240823, 'loss_val': 1.247041425965861, 'psi': 0.41243607272040217}-{'f1_val': 0.14142628205128205, 'auprc': 0.8332013712571615, 'loss_val': 1.289614628613106, 'psi': 0.41813631773363386}
[S7] START round=5 head_norm_before_train=0.692817 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7613895804430746, 'loss_val': 1.2850204606193831, 'psi': 0.38978992581468486}-{'f1_val': 0.14205682272909165, 'auprc': 0.7721962201807356, 'loss_val': 1.2833181603558288, 'psi': 0.3941125817097493}
[S8] START round=5 head_norm_before_train=1.284525 (no previous merge yet)
[S8] round=5 local utility u=0.905988 metrics={'f1_val': 0.42214654358197473, 'auprc': 0.7770423754810097, 'loss_val': 1.0820778154445105, 'psi': 0.5641048763415888}-{'f1_val': 0.13995598239295717, 'auprc': 0.7678746468293798, 'loss_val': 1.173408218349447, 'psi': 0.39112344816752626}
[S9] START round=5 head_norm_before_train=0.988914 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.125773 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9990772333222919, 'loss_val': 1.2279136467086504, 'psi': 0.4844696676129144}-{'f1_val': 0.141397957139996, 'auprc': 0.9265295674068834, 'loss_val': 1.261816261048903, 'psi': 0.455450601246751}
[S10] START round=5 head_norm_before_train=0.852207 cos_to_last_merge=0.9873 (last merge round=2)
[S10] round=5 local utility u=0.022324 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6219648354366711, 'loss_val': 1.0934992348952717, 'psi': 0.3319589166997028}-{'f1_val': 0.13862163754172394, 'auprc': 0.6420976803180037, 'loss_val': 1.1985450814620289, 'psi': 0.3400120546522359}
[S11] START round=5 head_norm_before_train=0.935574 cos_to_last_merge=0.9772 (last merge round=1)
[S11] round=5 local utility u=0.059997 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6011986576660542, 'loss_val': 1.042945335412195, 'psi': 0.32472767309028805}-{'f1_val': 0.14041368337311058, 'auprc': 0.6011834856711407, 'loss_val': 1.1628944552533091, 'psi': 0.3247216042923226}
[S13] START round=5 head_norm_before_train=0.945942 cos_to_last_merge=0.9773 (last merge round=1)
[S13] round=5 local utility u=0.856039 metrics={'f1_val': 0.41627458463323097, 'auprc': 0.7277632219000192, 'loss_val': 1.1075459843717301, 'psi': 0.5408700395399463}-{'f1_val': 0.19254745500289422, 'auprc': 0.6367156668279961, 'loss_val': 1.2041185490591924, 'psi': 0.37021473973293495}
[S14] START round=5 head_norm_before_train=0.793394 cos_to_last_merge=0.9721 (last merge round=1)
[S14] round=5 local utility u=0.054539 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8623797216216964, 'loss_val': 1.271530432195262, 'psi': 0.42916660037830084}-{'f1_val': 0.14035785288270378, 'auprc': 0.8370808251296151, 'loss_val': 1.304711870536389, 'psi': 0.41904704178146834}
[S15] START round=5 head_norm_before_train=1.264868 (no previous merge yet)
[S15] round=5 local utility u=0.028182 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770223299633482, 'loss_val': 1.1984342945063822, 'psi': 0.3946491228022743}-{'f1_val': 0.13973365136155833, 'auprc': 0.772844194039329, 'loss_val': 1.2422645332715894, 'psi': 0.39297786843266663}
[S16] START round=5 head_norm_before_train=0.821105 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7249193409044892, 'loss_val': 1.2244929228742065, 'psi': 0.37435020648131756}-{'f1_val': 0.14063745019920318, 'auprc': 0.8624188864136648, 'loss_val': 1.2286223395234415, 'psi': 0.42935002468498784}
[S17] START round=5 head_norm_before_train=0.784064 cos_to_last_merge=0.9884 (last merge round=2)
[S17] round=5 local utility u=0.023874 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5796632667948797, 'loss_val': 1.200708459805889, 'psi': 0.31643468470838254}-{'f1_val': 0.14094896331738438, 'auprc': 0.5823962218868213, 'loss_val': 1.2566554878073632, 'psi': 0.31752786674515915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:36616
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.6228
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] cosine check vs S14: cos=-0.0295
[S7] DROPPED delta from S14 (cos=-0.0295 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S5
[S7] cosine check vs S5: cos=0.8045
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=-0.0345
[S7] DROPPED delta from S13 (cos=-0.0345 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S9
[S5] cosine check vs S9: cos=0.0067
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.9575
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=0.6567
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=-0.0121
[S4] DROPPED delta from S2 (cos=-0.0121 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=-0.0136
[S6] DROPPED delta from S10 (cos=-0.0136 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] cosine check vs S4: cos=0.7348
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.8462
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1790 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1790) from S17
[S13] cosine check vs S17: cos=0.0040
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.707248
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.830938e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.787331 delta_norm=0.283094
[S7] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.406 → S6@127.0.0.1:36607
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.715783
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.828773e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.760377 delta_norm=0.382877
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.355 → S4@127.0.0.1:36604
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.948612
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.880891e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.692703 delta_norm=0.688089
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.429 → S7@127.0.0.1:36608
[S15] ⇄ pheromone p=0.420 → S4@127.0.0.1:36604
[S3] ⇄ pheromone p=0.421 → S6@127.0.0.1:36607
[S8] ⇄ pheromone p=0.542 → S9@127.0.0.1:36610
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.4163 head_norm=0.984988
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.379727e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.3664 head_norm=0.640469 delta_norm=0.637973
[S13] aggregate: ROLLBACK (f1_val pre=0.416 post=0.366 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.550 → S7@127.0.0.1:36608
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=1.003366
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.301406e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=1.148735 delta_norm=0.230141
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.371 → S5@127.0.0.1:36605
[S11] ⇄ pheromone p=0.391 → S2@127.0.0.1:36602
[S14] ⇄ pheromone p=0.481 → S7@127.0.0.1:36608
[S10] ⇄ pheromone p=0.334 → S6@127.0.0.1:36607
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=0.802053
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.756175e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.3967 head_norm=1.010479 delta_norm=0.375618
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.341 → S16@127.0.0.1:36616
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.695325
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.697180e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=0.763673 delta_norm=0.369718
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.411 → S4@127.0.0.1:36604
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.847736
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.011372e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.768302 delta_norm=0.301137
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.383 → S7@127.0.0.1:36608
[S17] ⇄ pheromone p=0.384 → S13@127.0.0.1:36613
[S2] START round=6 head_norm_before_train=0.763673 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.142177 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7803634437295878, 'loss_val': 1.170946140221694, 'psi': 0.39721165752497517}-{'f1_val': 0.1417771333885667, 'auprc': 0.6947647198459037, 'loss_val': 1.1985038480771102, 'psi': 0.36297216797150156}
[S3] START round=6 head_norm_before_train=0.968086 cos_to_last_merge=0.9653 (last merge round=1)
[S3] round=6 local utility u=0.950010 metrics={'f1_val': 0.4226526521515814, 'auprc': 0.9979428479316169, 'loss_val': 1.0243514517951273, 'psi': 0.6527687304635956}-{'f1_val': 0.13984006561410703, 'auprc': 0.9719847505178293, 'loss_val': 1.1496225634829669, 'psi': 0.4726979395755959}
[S4] START round=6 head_norm_before_train=1.010479 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.882907 metrics={'f1_val': 0.4219531488424766, 'auprc': 0.7681359658376118, 'loss_val': 1.0394423314372272, 'psi': 0.5604262756405307}-{'f1_val': 0.14022662889518414, 'auprc': 0.7796985704751601, 'loss_val': 1.1495845379876983, 'psi': 0.39601540552717457}
[S5] START round=6 head_norm_before_train=0.692703 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.000905 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7731273950148849, 'loss_val': 1.2371380311326732, 'psi': 0.39460810086309683}-{'f1_val': 0.14226190476190476, 'auprc': 0.7674140423661228, 'loss_val': 1.221808472076677, 'psi': 0.392322759803592}
[S6] START round=6 head_norm_before_train=0.760377 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7896368638004747, 'loss_val': 1.2418103074596627, 'psi': 0.4007105147509591}-{'f1_val': 0.14142628205128205, 'auprc': 0.8189507587240823, 'loss_val': 1.247041425965861, 'psi': 0.41243607272040217}
[S7] START round=6 head_norm_before_train=0.787331 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.034754 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7754268640034141, 'loss_val': 1.257623779453176, 'psi': 0.39540483923882064}-{'f1_val': 0.14205682272909165, 'auprc': 0.7613895804430746, 'loss_val': 1.2850204606193831, 'psi': 0.38978992581468486}
[S8] START round=6 head_norm_before_train=1.318473 (no previous merge yet)
[S8] round=6 local utility u=0.951570 metrics={'f1_val': 0.7147181481511302, 'auprc': 0.7771077662003114, 'loss_val': 0.934563254482238, 'psi': 0.7396739953708027}-{'f1_val': 0.42214654358197473, 'auprc': 0.7770423754810097, 'loss_val': 1.0820778154445105, 'psi': 0.5641048763415888}
[S9] START round=6 head_norm_before_train=1.148735 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.033391 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9980952829607215, 'loss_val': 1.158186154134454, 'psi': 0.4840768874682862}-{'f1_val': 0.141397957139996, 'auprc': 0.9990772333222919, 'loss_val': 1.2279136467086504, 'psi': 0.4844696676129144}
[S10] START round=6 head_norm_before_train=0.894456 cos_to_last_merge=0.9750 (last merge round=2)
[S10] round=6 local utility u=0.899055 metrics={'f1_val': 0.3904393384156911, 'auprc': 0.6731790762803566, 'loss_val': 0.9599371898449353, 'psi': 0.5035352335615573}-{'f1_val': 0.13862163754172394, 'auprc': 0.6219648354366711, 'loss_val': 1.0934992348952717, 'psi': 0.3319589166997028}
[S11] START round=6 head_norm_before_train=0.977906 cos_to_last_merge=0.9654 (last merge round=1)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9431158444543295, 'loss_val': 0.8915975772336752, 'psi': 0.6151776793374556}-{'f1_val': 0.14041368337311058, 'auprc': 0.6011986576660542, 'loss_val': 1.042945335412195, 'psi': 0.32472767309028805}
[S13] START round=6 head_norm_before_train=0.640469 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.026258 metrics={'f1_val': 0.4160404975377924, 'auprc': 0.7340905248228761, 'loss_val': 1.0726076798286985, 'psi': 0.5432605084518258}-{'f1_val': 0.41627458463323097, 'auprc': 0.7277632219000192, 'loss_val': 1.1075459843717301, 'psi': 0.5408700395399463}
[S14] START round=6 head_norm_before_train=0.829077 cos_to_last_merge=0.9540 (last merge round=1)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8357760162555032, 'loss_val': 1.2241581024072818, 'psi': 0.4185251182318236}-{'f1_val': 0.14035785288270378, 'auprc': 0.8623797216216964, 'loss_val': 1.271530432195262, 'psi': 0.42916660037830084}
[S15] START round=6 head_norm_before_train=1.296544 (no previous merge yet)
[S15] round=6 local utility u=0.315459 metrics={'f1_val': 0.2318266382503566, 'auprc': 0.7770540174705958, 'loss_val': 1.1201684179245999, 'psi': 0.4499175899384523}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770223299633482, 'loss_val': 1.1984342945063822, 'psi': 0.3946491228022743}
[S16] START round=6 head_norm_before_train=0.768302 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6419226517060546, 'loss_val': 1.1949801367022082, 'psi': 0.3411515308019437}-{'f1_val': 0.14063745019920318, 'auprc': 0.7249193409044892, 'loss_val': 1.2244929228742065, 'psi': 0.37435020648131756}
[S17] START round=6 head_norm_before_train=0.814995 cos_to_last_merge=0.9777 (last merge round=2)
[S17] round=6 local utility u=0.110278 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6307927286756896, 'loss_val': 1.1335406270485369, 'psi': 0.3368864694607065}-{'f1_val': 0.14094896331738438, 'auprc': 0.5796632667948797, 'loss_val': 1.200708459805889, 'psi': 0.31643468470838254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:36607
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:36602
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:36616
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9189
[S7] RECEIVED delta(kind=head bytes=1793) from S5
[S7] cosine check vs S5: cos=0.6511
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=0.8975
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=-0.0193
[S6] DROPPED delta from S10 (cos=-0.0193 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=-0.0807
[S7] DROPPED delta from S13 (cos=-0.0807 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S7
[S6] cosine check vs S7: cos=-0.0593
[S6] DROPPED delta from S7 (cos=-0.0593 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.9621
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=0.7124
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=0.0426
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] cosine check vs S8: cos=0.9825
[S16] RECEIVED delta(kind=head bytes=1791) from S4
[S16] cosine check vs S4: cos=0.8098
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.6013
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.785262
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.273973e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.869539 delta_norm=0.227397
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.780350
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.176661e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.884433 delta_norm=0.217666
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1414 head_norm=1.162158
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.524321e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=1.253995 delta_norm=0.152432
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.707609
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.121767e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.869351 delta_norm=0.412177
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4220 head_norm=1.042420
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.929695e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.3717 head_norm=0.878942 delta_norm=0.292970
[S4] aggregate: ROLLBACK (f1_val pre=0.422 post=0.372 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.802909
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.184066e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.686516 delta_norm=0.318407
[S7] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.4160 head_norm=0.682966
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.467731e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.4153 head_norm=0.681712 delta_norm=0.346773
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1406 head_norm=0.794912
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.068126e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1672 head_norm=0.874716 delta_norm=0.306813
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.884433 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.346175 metrics={'f1_val': 0.2527652263193677, 'auprc': 0.7641310295499278, 'loss_val': 1.0958270807767359, 'psi': 0.45731154761159176}-{'f1_val': 0.1417771333885667, 'auprc': 0.7803634437295878, 'loss_val': 1.170946140221694, 'psi': 0.39721165752497517}
[S3] START round=7 head_norm_before_train=0.999489 cos_to_last_merge=0.9535 (last merge round=1)
[S3] round=7 local utility u=0.820469 metrics={'f1_val': 0.6690377499369518, 'auprc': 0.9976220373557587, 'loss_val': 0.8607611699331745, 'psi': 0.8004714649044745}-{'f1_val': 0.4226526521515814, 'auprc': 0.9979428479316169, 'loss_val': 1.0243514517951273, 'psi': 0.6527687304635956}
[S4] START round=7 head_norm_before_train=0.878942 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.703997 metrics={'f1_val': 0.697709751347384, 'auprc': 0.6611124622475169, 'loss_val': 0.9649171432824727, 'psi': 0.6830708357074371}-{'f1_val': 0.4219531488424766, 'auprc': 0.7681359658376118, 'loss_val': 1.0394423314372272, 'psi': 0.5604262756405307}
[S5] START round=7 head_norm_before_train=0.869351 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.019141 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7775024289552409, 'loss_val': 1.211980432328429, 'psi': 0.39635811443923924}-{'f1_val': 0.14226190476190476, 'auprc': 0.7731273950148849, 'loss_val': 1.2371380311326732, 'psi': 0.39460810086309683}
[S6] START round=7 head_norm_before_train=0.869539 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.058556 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8139757536249547, 'loss_val': 1.1977152736889047, 'psi': 0.4104460706807511}-{'f1_val': 0.14142628205128205, 'auprc': 0.7896368638004747, 'loss_val': 1.2418103074596627, 'psi': 0.4007105147509591}
[S7] START round=7 head_norm_before_train=0.686516 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.574094519748188, 'loss_val': 1.2422336580073914, 'psi': 0.3148719015367302}-{'f1_val': 0.14205682272909165, 'auprc': 0.7754268640034141, 'loss_val': 1.257623779453176, 'psi': 0.39540483923882064}
[S8] START round=7 head_norm_before_train=1.356786 (no previous merge yet)
[S8] round=7 local utility u=0.099690 metrics={'f1_val': 0.7151263327978871, 'auprc': 0.7806211795708473, 'loss_val': 0.7481717847527976, 'psi': 0.7413242715070711}-{'f1_val': 0.7147181481511302, 'auprc': 0.7771077662003114, 'loss_val': 0.934563254482238, 'psi': 0.7396739953708027}
[S9] START round=7 head_norm_before_train=1.253995 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.049229 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9835921724893509, 'loss_val': 1.0162188368648544, 'psi': 0.478275643279738}-{'f1_val': 0.141397957139996, 'auprc': 0.9980952829607215, 'loss_val': 1.158186154134454, 'psi': 0.4840768874682862}
[S10] START round=7 head_norm_before_train=0.939091 cos_to_last_merge=0.9609 (last merge round=2)
[S10] round=7 local utility u=0.068177 metrics={'f1_val': 0.38619757426506407, 'auprc': 0.6751717882099448, 'loss_val': 0.8041104272854799, 'psi': 0.5017872598430164}-{'f1_val': 0.3904393384156911, 'auprc': 0.6731790762803566, 'loss_val': 0.9599371898449353, 'psi': 0.5035352335615573}
[S11] START round=7 head_norm_before_train=1.024819 cos_to_last_merge=0.9529 (last merge round=1)
[S11] round=7 local utility u=0.123750 metrics={'f1_val': 0.3995637850793995, 'auprc': 0.9860263028574807, 'loss_val': 0.7908987057554043, 'psi': 0.6341487921906319}-{'f1_val': 0.39655223592620625, 'auprc': 0.9431158444543295, 'loss_val': 0.8915975772336752, 'psi': 0.6151776793374556}
[S13] START round=7 head_norm_before_train=0.681712 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.3795976417655888, 'auprc': 0.674007233602475, 'loss_val': 1.0495996973703725, 'psi': 0.4973614785003433}-{'f1_val': 0.4160404975377924, 'auprc': 0.7340905248228761, 'loss_val': 1.0726076798286985, 'psi': 0.5432605084518258}
[S14] START round=7 head_norm_before_train=0.864660 cos_to_last_merge=0.9371 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=7 local utility u=0.049198 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8345400012463122, 'loss_val': 1.122054110965447, 'psi': 0.41803071222814714}-{'f1_val': 0.14035785288270378, 'auprc': 0.8357760162555032, 'loss_val': 1.2241581024072818, 'psi': 0.4185251182318236}
[S15] START round=7 head_norm_before_train=1.334868 (no previous merge yet)
[S15] round=7 local utility u=0.630896 metrics={'f1_val': 0.4161838404121786, 'auprc': 0.7770564776813459, 'loss_val': 0.9645271624843899, 'psi': 0.5605328953198455}-{'f1_val': 0.2318266382503566, 'auprc': 0.7770540174705958, 'loss_val': 1.1201684179245999, 'psi': 0.4499175899384523}
[S16] START round=7 head_norm_before_train=0.874716 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.390483 metrics={'f1_val': 0.3601161488589431, 'auprc': 0.4498515980011628, 'loss_val': 1.1546727528323595, 'psi': 0.39601032851583096}-{'f1_val': 0.14063745019920318, 'auprc': 0.6419226517060546, 'loss_val': 1.1949801367022082, 'psi': 0.3411515308019437}
[S17] START round=7 head_norm_before_train=0.838763 cos_to_last_merge=0.9678 (last merge round=2)
[S17] round=7 local utility u=0.828991 metrics={'f1_val': 0.3858696563932905, 'auprc': 0.6590197618614716, 'loss_val': 1.0297639675722945, 'psi': 0.495129698580563}-{'f1_val': 0.14094896331738438, 'auprc': 0.6307927286756896, 'loss_val': 1.1335406270485369, 'psi': 0.3368864694607065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:36608
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] cosine check vs S8: cos=0.9881
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.9583
[S6] RECEIVED delta(kind=head bytes=1796) from S10
[S6] cosine check vs S10: cos=-0.0191
[S6] DROPPED delta from S10 (cos=-0.0191 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S6
[S4] cosine check vs S6: cos=0.0656
[S4] RECEIVED delta(kind=head bytes=1797) from S15
[S4] cosine check vs S15: cos=0.9496
[S4] RECEIVED delta(kind=head bytes=1793) from S2
[S4] cosine check vs S2: cos=0.2558
[S2] RECEIVED delta(kind=head bytes=1806) from S11
[S2] cosine check vs S11: cos=0.9672
[S7] RECEIVED delta(kind=head bytes=1789) from S5
[S7] cosine check vs S5: cos=0.6278
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.1054
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.9139
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=0.9393
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=-0.0399
[S7] DROPPED delta from S14 (cos=-0.0399 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.8753
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.701700
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.219586e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.576150 delta_norm=0.321959
[S7] aggregate: ACCEPT kept=['S5', 'S16'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.3796 head_norm=0.714010
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.139720e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4158 head_norm=0.770967 delta_norm=0.213972
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.3601 head_norm=0.900264
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.881568e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3372 head_norm=0.886637 delta_norm=0.188157
[S16] aggregate: ROLLBACK (f1_val pre=0.360 post=0.337 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.888728
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.590629e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.955954 delta_norm=0.159063
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.1414 head_norm=1.270787
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.205431e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4121 head_norm=1.329570 delta_norm=0.120543
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.1423 head_norm=0.885287
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.670312e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.1423 head_norm=1.062078 delta_norm=0.267031
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6977 head_norm=0.912458
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.134631e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6935 head_norm=0.705776 delta_norm=0.313463
[S4] aggregate: ACCEPT kept=['S6', 'S15', 'S2'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.2528 head_norm=0.905448
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.528717e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.1418 head_norm=0.983252 delta_norm=0.152872
[S2] aggregate: ROLLBACK (f1_val pre=0.253 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=0.983252 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.488546 metrics={'f1_val': 0.41629809586997835, 'auprc': 0.7386812661516388, 'loss_val': 1.0235839925372274, 'psi': 0.5452513639826425}-{'f1_val': 0.2527652263193677, 'auprc': 0.7641310295499278, 'loss_val': 1.0958270807767359, 'psi': 0.45731154761159176}
[S3] START round=8 head_norm_before_train=1.043293 cos_to_last_merge=0.9377 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.4703985944377043, 'auprc': 0.9984254521231789, 'loss_val': 0.7228154173611124, 'psi': 0.6816093375118941}-{'f1_val': 0.6690377499369518, 'auprc': 0.9976220373557587, 'loss_val': 0.8607611699331745, 'psi': 0.8004714649044745}
[S4] START round=8 head_norm_before_train=0.705776 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.031689 metrics={'f1_val': 0.6981547396384704, 'auprc': 0.661371832561915, 'loss_val': 0.9049868680500639, 'psi': 0.6834415768078482}-{'f1_val': 0.697709751347384, 'auprc': 0.6611124622475169, 'loss_val': 0.9649171432824727, 'psi': 0.6830708357074371}
[S5] START round=8 head_norm_before_train=1.062078 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.020463 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.777822664421745, 'loss_val': 1.1720151910282273, 'psi': 0.3964862086258409}-{'f1_val': 0.14226190476190476, 'auprc': 0.7775024289552409, 'loss_val': 1.211980432328429, 'psi': 0.39635811443923924}
[S6] START round=8 head_norm_before_train=0.955954 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=1.000000 metrics={'f1_val': 0.41463700409720844, 'auprc': 0.978973526422222, 'loss_val': 1.0930741004916378, 'psi': 0.6403716130272139}-{'f1_val': 0.14142628205128205, 'auprc': 0.8139757536249547, 'loss_val': 1.1977152736889047, 'psi': 0.4104460706807511}
[S7] START round=8 head_norm_before_train=0.576150 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.015463 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5738304316381274, 'loss_val': 1.2105147956038986, 'psi': 0.314766266292706}-{'f1_val': 0.14205682272909165, 'auprc': 0.574094519748188, 'loss_val': 1.2422336580073914, 'psi': 0.3148719015367302}
[S8] START round=8 head_norm_before_train=1.396307 (no previous merge yet)
[S8] round=8 local utility u=0.096117 metrics={'f1_val': 0.7017091745307121, 'auprc': 0.7944118583655242, 'loss_val': 0.5168061054840672, 'psi': 0.7387902480646369}-{'f1_val': 0.7151263327978871, 'auprc': 0.7806211795708473, 'loss_val': 0.7481717847527976, 'psi': 0.7413242715070711}
[S9] START round=8 head_norm_before_train=1.329570 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.991736 metrics={'f1_val': 0.43694443442174585, 'auprc': 0.9836269351915757, 'loss_val': 0.8061291973093762, 'psi': 0.6556174347296778}-{'f1_val': 0.141397957139996, 'auprc': 0.9835921724893509, 'loss_val': 1.0162188368648544, 'psi': 0.478275643279738}
[S10] START round=8 head_norm_before_train=0.988716 cos_to_last_merge=0.9443 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=8 local utility u=0.526168 metrics={'f1_val': 0.3861561803544076, 'auprc': 0.9954410973394173, 'loss_val': 0.7123336614801983, 'psi': 0.6298701471484115}-{'f1_val': 0.38619757426506407, 'auprc': 0.6751717882099448, 'loss_val': 0.8041104272854799, 'psi': 0.5017872598430164}
[S11] START round=8 head_norm_before_train=1.077252 cos_to_last_merge=0.9383 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.3998848669786352, 'auprc': 0.9400090055994359, 'loss_val': 0.7194253051834401, 'psi': 0.6159345224269555}-{'f1_val': 0.3995637850793995, 'auprc': 0.9860263028574807, 'loss_val': 0.7908987057554043, 'psi': 0.6341487921906319}
[S13] START round=8 head_norm_before_train=0.770967 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.123497 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6715954782994495, 'loss_val': 1.0126291413318456, 'psi': 0.5181225525111981}-{'f1_val': 0.3795976417655888, 'auprc': 0.674007233602475, 'loss_val': 1.0495996973703725, 'psi': 0.4973614785003433}
[S14] START round=8 head_norm_before_train=0.904095 cos_to_last_merge=0.9195 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.919
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.3915311964828873, 'auprc': 0.947368017660381, 'loss_val': 0.9659210993613373, 'psi': 0.6138659249538848}-{'f1_val': 0.14035785288270378, 'auprc': 0.8345400012463122, 'loss_val': 1.122054110965447, 'psi': 0.41803071222814714}
[S15] START round=8 head_norm_before_train=1.382869 (no previous merge yet)
[S15] round=8 local utility u=1.000000 metrics={'f1_val': 0.7152389013842606, 'auprc': 0.80002064887904, 'loss_val': 0.7619680257592085, 'psi': 0.7491516003821723}-{'f1_val': 0.4161838404121786, 'auprc': 0.7770564776813459, 'loss_val': 0.9645271624843899, 'psi': 0.5605328953198455}
[S16] START round=8 head_norm_before_train=0.886637 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.037096 metrics={'f1_val': 0.34392476065707145, 'auprc': 0.5052910293156825, 'loss_val': 1.1496498649391902, 'psi': 0.4084712681205159}-{'f1_val': 0.3601161488589431, 'auprc': 0.4498515980011628, 'loss_val': 1.1546727528323595, 'psi': 0.39601032851583096}
[S17] START round=8 head_norm_before_train=0.877803 cos_to_last_merge=0.9529 (last merge round=2)
[S17] round=8 local utility u=0.055119 metrics={'f1_val': 0.3911980630728032, 'auprc': 0.6601830633764707, 'loss_val': 0.9549864615950605, 'psi': 0.4987920631942702}-{'f1_val': 0.3858696563932905, 'auprc': 0.6590197618614716, 'loss_val': 1.0297639675722945, 'psi': 0.495129698580563}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:36607
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] → sending delta(kind=head bytes=1785) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:36604
[S2] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1785 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=-0.0280
[S7] DROPPED delta from S14 (cos=-0.0280 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=0.9887
[S4] RECEIVED delta(kind=head bytes=1790) from S2
[S4] cosine check vs S2: cos=0.3868
[S4] RECEIVED delta(kind=head bytes=1804) from S15
[S4] cosine check vs S15: cos=0.8626
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=0.2635
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=-0.0170
[S6] DROPPED delta from S10 (cos=-0.0170 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S9
[S5] cosine check vs S9: cos=0.9794
[S7] RECEIVED delta(kind=head bytes=1788) from S5
[S7] cosine check vs S5: cos=0.6344
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] cosine check vs S4: cos=0.9134
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=-0.0100
[S7] DROPPED delta from S13 (cos=-0.0100 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1785) from S16
[S7] cosine check vs S16: cos=0.4287
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] cosine check vs S7: cos=-0.0272
[S6] DROPPED delta from S7 (cos=-0.0272 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=0.9421
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.1423 head_norm=1.068415
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.880842e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.1423 head_norm=1.205223 delta_norm=0.188084
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.3439 head_norm=0.916414
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.917265e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3476 head_norm=0.814190 delta_norm=0.191726
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.594404
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.148491e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.603623 delta_norm=0.214849
[S7] aggregate: ACCEPT kept=['S5', 'S16'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4158 head_norm=0.797561
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.583847e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4158 head_norm=0.846975 delta_norm=0.158385
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6982 head_norm=0.748007
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.896975e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6963 head_norm=0.676487 delta_norm=0.189697
[S4] aggregate: ACCEPT kept=['S2', 'S15', 'S6'] (k=3/3) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.4369 head_norm=1.354388
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.136920e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.6969 head_norm=1.393542 delta_norm=0.113692
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.010057 cos_to_last_merge=0.9963 (last merge round=7)
[S2] round=9 local utility u=0.879539 metrics={'f1_val': 0.701694804504878, 'auprc': 0.7113732817454984, 'loss_val': 0.8949616113129982, 'psi': 0.7055661954011261}-{'f1_val': 0.41629809586997835, 'auprc': 0.7386812661516388, 'loss_val': 1.0235839925372274, 'psi': 0.5452513639826425}
[S3] START round=9 head_norm_before_train=1.094126 cos_to_last_merge=0.9196 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=9 local utility u=0.154010 metrics={'f1_val': 0.5092158740093474, 'auprc': 0.9931258776007315, 'loss_val': 0.6318005283035284, 'psi': 0.702779875445901}-{'f1_val': 0.4703985944377043, 'auprc': 0.9984254521231789, 'loss_val': 0.7228154173611124, 'psi': 0.6816093375118941}
[S4] START round=9 head_norm_before_train=0.676487 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.244986 metrics={'f1_val': 0.6916847766655213, 'auprc': 0.8158826670446883, 'loss_val': 0.8397283236938106, 'psi': 0.7413639328171882}-{'f1_val': 0.6981547396384704, 'auprc': 0.661371832561915, 'loss_val': 0.9049868680500639, 'psi': 0.6834415768078482}
[S5] START round=9 head_norm_before_train=1.205223 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.827590 metrics={'f1_val': 0.4091787534819328, 'auprc': 0.7778226845228442, 'loss_val': 1.1183353860432943, 'psi': 0.5566363258982974}-{'f1_val': 0.14226190476190476, 'auprc': 0.777822664421745, 'loss_val': 1.1720151910282273, 'psi': 0.3964862086258409}
[S6] START round=9 head_norm_before_train=0.975638 cos_to_last_merge=0.9968 (last merge round=7)
[S6] round=9 local utility u=0.109568 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.9939399605046905, 'loss_val': 0.9333487196827126, 'psi': 0.6478094069263967}-{'f1_val': 0.41463700409720844, 'auprc': 0.978973526422222, 'loss_val': 1.0930741004916378, 'psi': 0.6403716130272139}
[S7] START round=9 head_norm_before_train=0.603623 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.844820 metrics={'f1_val': 0.41626420531236646, 'auprc': 0.573579193713086, 'loss_val': 1.1653655016244329, 'psi': 0.4791902006726543}-{'f1_val': 0.14205682272909165, 'auprc': 0.5738304316381274, 'loss_val': 1.2105147956038986, 'psi': 0.314766266292706}
[S8] START round=9 head_norm_before_train=1.440626 (no previous merge yet)
[S8] round=9 local utility u=0.213595 metrics={'f1_val': 0.714460606093301, 'auprc': 0.8727144691516735, 'loss_val': 0.4010326838234314, 'psi': 0.7777621513166499}-{'f1_val': 0.7017091745307121, 'auprc': 0.7944118583655242, 'loss_val': 0.5168061054840672, 'psi': 0.7387902480646369}
[S9] START round=9 head_norm_before_train=1.393542 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.931377 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9992363810682708, 'loss_val': 0.5782267936027289, 'psi': 0.8206634618582453}-{'f1_val': 0.43694443442174585, 'auprc': 0.9836269351915757, 'loss_val': 0.8061291973093762, 'psi': 0.6556174347296778}
[S10] START round=9 head_norm_before_train=1.043836 cos_to_last_merge=0.9263 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.3876314032919985, 'auprc': 0.912025826434175, 'loss_val': 0.675733928675347, 'psi': 0.5973891725488691}-{'f1_val': 0.3861561803544076, 'auprc': 0.9954410973394173, 'loss_val': 0.7123336614801983, 'psi': 0.6298701471484115}
[S11] START round=9 head_norm_before_train=1.134265 cos_to_last_merge=0.9225 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.923
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9377289654876009, 'loss_val': 0.713942975323331, 'psi': 0.6150468378765035}-{'f1_val': 0.3998848669786352, 'auprc': 0.9400090055994359, 'loss_val': 0.7194253051834401, 'psi': 0.6159345224269555}
[S13] START round=9 head_norm_before_train=0.846975 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.016411 metrics={'f1_val': 0.45443733920283197, 'auprc': 0.60287267681117, 'loss_val': 1.0054184926598022, 'psi': 0.5138114742461672}-{'f1_val': 0.41580726865236384, 'auprc': 0.6715954782994495, 'loss_val': 1.0126291413318456, 'psi': 0.5181225525111981}
[S14] START round=9 head_norm_before_train=0.946758 cos_to_last_merge=0.9013 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.901
[S14] round=9 local utility u=0.141537 metrics={'f1_val': 0.3915416722537795, 'auprc': 0.9778384875678394, 'loss_val': 0.7743216196351855, 'psi': 0.6260603983794035}-{'f1_val': 0.3915311964828873, 'auprc': 0.947368017660381, 'loss_val': 0.9659210993613373, 'psi': 0.6138659249538848}
[S15] START round=9 head_norm_before_train=1.430566 (no previous merge yet)
[S15] round=9 local utility u=0.054232 metrics={'f1_val': 0.7011608994153706, 'auprc': 0.8006812255549275, 'loss_val': 0.571018020042296, 'psi': 0.7409690298711934}-{'f1_val': 0.7152389013842606, 'auprc': 0.80002064887904, 'loss_val': 0.7619680257592085, 'psi': 0.7491516003821723}
[S16] START round=9 head_norm_before_train=0.814190 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.073932 metrics={'f1_val': 0.34872458768856335, 'auprc': 0.5306006704536798, 'loss_val': 1.1065130224189181, 'psi': 0.4214750207946099}-{'f1_val': 0.34392476065707145, 'auprc': 0.5052910293156825, 'loss_val': 1.1496498649391902, 'psi': 0.4084712681205159}
[S17] START round=9 head_norm_before_train=0.921305 cos_to_last_merge=0.9358 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=9 local utility u=0.024375 metrics={'f1_val': 0.3802418568199457, 'auprc': 0.6883265069173355, 'loss_val': 0.9249286002875297, 'psi': 0.5034757168589017}-{'f1_val': 0.3911980630728032, 'auprc': 0.6601830633764707, 'loss_val': 0.9549864615950605, 'psi': 0.4987920631942702}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] cosine check vs S6: cos=0.3862
[S4] RECEIVED delta(kind=head bytes=1795) from S2
[S4] cosine check vs S2: cos=0.4635
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.7676
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=0.9014
[S9] RECEIVED delta(kind=head bytes=1805) from S8
[S9] cosine check vs S8: cos=0.9891
[S7] RECEIVED delta(kind=head bytes=1796) from S5
[S7] cosine check vs S5: cos=0.6925
[S7] RECEIVED delta(kind=head bytes=1799) from S13
[S7] cosine check vs S13: cos=0.0080
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=0.9506
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=0.9865
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=0.5565
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] cosine check vs S14: cos=-0.0187
[S7] DROPPED delta from S14 (cos=-0.0187 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=-0.0144
[S6] DROPPED delta from S7 (cos=-0.0144 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.9620
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4544 head_norm=0.870851
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.354571e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.5828 head_norm=0.910615 delta_norm=0.135457
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4092 head_norm=1.214978
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.516038e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.1592 head_norm=1.316867 delta_norm=0.151604
[S5] aggregate: ROLLBACK (f1_val pre=0.409 post=0.159 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7016 head_norm=1.427611
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.111914e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7019 head_norm=1.451702 delta_norm=0.111191
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3487 head_norm=0.849634
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.850473e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3487 head_norm=0.768161 delta_norm=0.185047
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6917 head_norm=0.725775
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.395922e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6944 head_norm=0.685675 delta_norm=0.139592
[S4] aggregate: ACCEPT kept=['S6', 'S2', 'S15'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4171 head_norm=1.006157
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.829987e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.4171 head_norm=1.063311 delta_norm=0.182999
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4163 head_norm=0.624053
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.271422e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4169 head_norm=0.541482 delta_norm=0.227142
[S7] aggregate: ACCEPT kept=['S5', 'S13', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.043204 cos_to_last_merge=0.9876 (last merge round=7)
[S2] round=10 local utility u=0.069948 metrics={'f1_val': 0.6768563053600047, 'auprc': 0.7767220440390954, 'loss_val': 0.8020803209610233, 'psi': 0.716802600831641}-{'f1_val': 0.701694804504878, 'auprc': 0.7113732817454984, 'loss_val': 0.8949616113129982, 'psi': 0.7055661954011261}
[S3] START round=10 head_norm_before_train=1.147120 cos_to_last_merge=0.9005 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=10 local utility u=0.654729 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9954884300247377, 'loss_val': 0.47611953309318805, 'psi': 0.8183939234218123}-{'f1_val': 0.5092158740093474, 'auprc': 0.9931258776007315, 'loss_val': 0.6318005283035284, 'psi': 0.702779875445901}
[S4] START round=10 head_norm_before_train=0.685675 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.207509 metrics={'f1_val': 0.7238198040661955, 'auprc': 0.8723265698675585, 'loss_val': 0.7868527701582716, 'psi': 0.7832225103867407}-{'f1_val': 0.6916847766655213, 'auprc': 0.8158826670446883, 'loss_val': 0.8397283236938106, 'psi': 0.7413639328171882}
[S5] START round=10 head_norm_before_train=1.316867 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.070660 metrics={'f1_val': 0.41819354899256067, 'auprc': 0.7778229307148449, 'loss_val': 1.0311051260944302, 'psi': 0.5620453016814744}-{'f1_val': 0.4091787534819328, 'auprc': 0.7778226845228442, 'loss_val': 1.1183353860432943, 'psi': 0.5566363258982974}
[S6] START round=10 head_norm_before_train=1.063311 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.474951 metrics={'f1_val': 0.5542881749720121, 'auprc': 0.9949578099986902, 'loss_val': 0.8098949930851524, 'psi': 0.7305560289826833}-{'f1_val': 0.41705570454086727, 'auprc': 0.9939399605046905, 'loss_val': 0.9333487196827126, 'psi': 0.6478094069263967}
[S7] START round=10 head_norm_before_train=0.541482 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.025311 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.5732134640471332, 'loss_val': 1.1185274324912102, 'psi': 0.47953209682905956}-{'f1_val': 0.41626420531236646, 'auprc': 0.573579193713086, 'loss_val': 1.1653655016244329, 'psi': 0.4791902006726543}
[S8] START round=10 head_norm_before_train=1.483756 (no previous merge yet)
[S8] round=10 local utility u=0.205055 metrics={'f1_val': 0.701182975368286, 'auprc': 0.9976144844801724, 'loss_val': 0.28595689283217063, 'psi': 0.8197555790130406}-{'f1_val': 0.714460606093301, 'auprc': 0.8727144691516735, 'loss_val': 0.4010326838234314, 'psi': 0.7777621513166499}
[S9] START round=10 head_norm_before_train=1.451702 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.070718 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9988520034947606, 'loss_val': 0.4351924402219521, 'psi': 0.8204651999190675}-{'f1_val': 0.7016148490515617, 'auprc': 0.9992363810682708, 'loss_val': 0.5782267936027289, 'psi': 0.8206634618582453}
[S10] START round=10 head_norm_before_train=1.098723 cos_to_last_merge=0.9088 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.909
[S10] round=10 local utility u=0.616618 metrics={'f1_val': 0.5376074599774022, 'auprc': 0.98668925562885, 'loss_val': 0.5663443457691189, 'psi': 0.7172401782379814}-{'f1_val': 0.3876314032919985, 'auprc': 0.912025826434175, 'loss_val': 0.675733928675347, 'psi': 0.5973891725488691}
[S11] START round=10 head_norm_before_train=1.187912 cos_to_last_merge=0.9081 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=10 local utility u=0.996041 metrics={'f1_val': 0.7014095185520394, 'auprc': 0.9384732163029171, 'loss_val': 0.5329990338093744, 'psi': 0.7962349976523905}-{'f1_val': 0.39992541946910537, 'auprc': 0.9377289654876009, 'loss_val': 0.713942975323331, 'psi': 0.6150468378765035}
[S13] START round=10 head_norm_before_train=0.910615 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.061925 metrics={'f1_val': 0.43470205322916605, 'auprc': 0.6676390399350556, 'loss_val': 0.9574556894599738, 'psi': 0.5278768479115219}-{'f1_val': 0.45443733920283197, 'auprc': 0.60287267681117, 'loss_val': 1.0054184926598022, 'psi': 0.5138114742461672}
[S14] START round=10 head_norm_before_train=1.002285 cos_to_last_merge=0.8798 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.880
[S14] round=10 local utility u=0.449259 metrics={'f1_val': 0.5138137639622441, 'auprc': 0.9887187099893984, 'loss_val': 0.6420764598563522, 'psi': 0.7037757423731059}-{'f1_val': 0.3915416722537795, 'auprc': 0.9778384875678394, 'loss_val': 0.7743216196351855, 'psi': 0.6260603983794035}
[S15] START round=10 head_norm_before_train=1.482480 (no previous merge yet)
[S15] round=10 local utility u=0.027507 metrics={'f1_val': 0.6945166225580497, 'auprc': 0.8009946835599719, 'loss_val': 0.4770784328566248, 'psi': 0.7371078469588186}-{'f1_val': 0.7011608994153706, 'auprc': 0.8006812255549275, 'loss_val': 0.571018020042296, 'psi': 0.7409690298711934}
[S16] START round=10 head_norm_before_train=0.768161 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.221003 metrics={'f1_val': 0.35068041349546775, 'auprc': 0.6504324071850914, 'loss_val': 1.0357369240973655, 'psi': 0.4705812109713172}-{'f1_val': 0.34872458768856335, 'auprc': 0.5306006704536798, 'loss_val': 1.1065130224189181, 'psi': 0.4214750207946099}
[S17] START round=10 head_norm_before_train=0.967861 cos_to_last_merge=0.9178 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.918
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3599426751909836, 'auprc': 0.7019415727367431, 'loss_val': 0.8518824461826673, 'psi': 0.4967422342092874}-{'f1_val': 0.3802418568199457, 'auprc': 0.6883265069173355, 'loss_val': 0.9249286002875297, 'psi': 0.5034757168589017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:36605
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.9903
[S4] RECEIVED delta(kind=head bytes=1794) from S6
[S4] cosine check vs S6: cos=0.4424
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=0.4965
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=0.9733
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=0.9228
[S6] RECEIVED delta(kind=head bytes=1800) from S10
[S6] cosine check vs S10: cos=-0.0161
[S6] DROPPED delta from S10 (cos=-0.0161 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.3093
[S7] RECEIVED delta(kind=head bytes=1796) from S5
[S7] cosine check vs S5: cos=0.6571
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.0783
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.0721
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=0.9882
[S4] RECEIVED delta(kind=head bytes=1801) from S15
[S4] cosine check vs S15: cos=0.7085
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9339
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.5734
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.422 → S2@127.0.0.1:36602
[S8] ⇄ pheromone p=0.353 → S9@127.0.0.1:36610
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7015 head_norm=1.492002
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.059284e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7015 head_norm=1.503255 delta_norm=0.105928
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.419 → S5@127.0.0.1:36605
[S3] ⇄ pheromone p=0.455 → S6@127.0.0.1:36607
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4182 head_norm=1.331820
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.346782e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4188 head_norm=1.407753 delta_norm=0.134678
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.292 → S7@127.0.0.1:36608
[S10] ⇄ pheromone p=0.381 → S6@127.0.0.1:36607
[S14] ⇄ pheromone p=0.403 → S7@127.0.0.1:36608
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3507 head_norm=0.809294
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.558928e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3759 head_norm=0.759836 delta_norm=0.155893
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.226 → S7@127.0.0.1:36608
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.7238 head_norm=0.740507
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.292700e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6924 head_norm=0.714019 delta_norm=0.129270
[S4] aggregate: ROLLBACK (f1_val pre=0.724 post=0.692 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.341 → S16@127.0.0.1:36616
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.6769 head_norm=1.083632
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.259061e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.6711 head_norm=1.144728 delta_norm=0.225906
[S2] aggregate: ROLLBACK (f1_val pre=0.677 post=0.671 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.399 → S4@127.0.0.1:36604
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.5543 head_norm=1.095909
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.890778e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.6149 head_norm=0.863407 delta_norm=0.289078
[S6] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.363 → S4@127.0.0.1:36604
[S7] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4171 head_norm=0.563992
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.220486e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4171 head_norm=0.514706 delta_norm=0.222049
[S7] aggregate: ACCEPT kept=['S13', 'S5', 'S14', 'S16'] (k=4/4) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.278 → S6@127.0.0.1:36607
[S15] ⇄ pheromone p=0.370 → S4@127.0.0.1:36604
[S13] ⇄ pheromone p=0.213 → S7@127.0.0.1:36608
[S17] ⇄ pheromone p=0.231 → S13@127.0.0.1:36613
[S2] START round=11 head_norm_before_train=1.144728 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.69931463913676, 'auprc': 0.6709752392768366, 'loss_val': 0.6908103671841562, 'psi': 0.6879788791927905}-{'f1_val': 0.6768563053600047, 'auprc': 0.7767220440390954, 'loss_val': 0.8020803209610233, 'psi': 0.716802600831641}
[S3] START round=11 head_norm_before_train=1.199286 cos_to_last_merge=0.8818 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.882
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.6832068987394209, 'auprc': 0.9929363311987991, 'loss_val': 0.4453880930097924, 'psi': 0.8070986717231722}-{'f1_val': 0.700330919019862, 'auprc': 0.9954884300247377, 'loss_val': 0.47611953309318805, 'psi': 0.8183939234218123}
[S4] START round=11 head_norm_before_train=0.714019 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6853482668563149, 'auprc': 0.8723099808567485, 'loss_val': 0.7202801392122233, 'psi': 0.7601329524564884}-{'f1_val': 0.7238198040661955, 'auprc': 0.8723265698675585, 'loss_val': 0.7868527701582716, 'psi': 0.7832225103867407}
[S5] START round=11 head_norm_before_train=1.407753 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.945617 metrics={'f1_val': 0.7155058228390914, 'auprc': 0.7782646193424259, 'loss_val': 0.9250689381118288, 'psi': 0.7406093414404251}-{'f1_val': 0.41819354899256067, 'auprc': 0.7778229307148449, 'loss_val': 1.0311051260944302, 'psi': 0.5620453016814744}
[S6] START round=11 head_norm_before_train=0.863407 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.217886 metrics={'f1_val': 0.6203278383218184, 'auprc': 0.9952315423891709, 'loss_val': 0.7711817919329278, 'psi': 0.7702893199487594}-{'f1_val': 0.5542881749720121, 'auprc': 0.9949578099986902, 'loss_val': 0.8098949930851524, 'psi': 0.7305560289826833}
[S7] START round=11 head_norm_before_train=0.514706 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.002586 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.5687222555004681, 'loss_val': 1.099627160494499, 'psi': 0.4777101584929561}-{'f1_val': 0.4170778520170104, 'auprc': 0.5732134640471332, 'loss_val': 1.1185274324912102, 'psi': 0.47953209682905956}
[S8] START round=11 head_norm_before_train=1.521816 (no previous merge yet)
[S8] round=11 local utility u=0.032579 metrics={'f1_val': 0.7053317764216975, 'auprc': 0.9924714548020832, 'loss_val': 0.2302616337024894, 'psi': 0.8201876477738519}-{'f1_val': 0.701182975368286, 'auprc': 0.9976144844801724, 'loss_val': 0.28595689283217063, 'psi': 0.8197555790130406}
[S9] START round=11 head_norm_before_train=1.503255 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.043235 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9988367693805864, 'loss_val': 0.3471754451938598, 'psi': 0.8203089978767726}-{'f1_val': 0.7015406642019387, 'auprc': 0.9988520034947606, 'loss_val': 0.4351924402219521, 'psi': 0.8204651999190675}
[S10] START round=11 head_norm_before_train=1.149646 cos_to_last_merge=0.8932 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.893
[S10] round=11 local utility u=0.548442 metrics={'f1_val': 0.7016946595131214, 'auprc': 0.9911247560969516, 'loss_val': 0.4672897380010941, 'psi': 0.8174666981466534}-{'f1_val': 0.5376074599774022, 'auprc': 0.98668925562885, 'loss_val': 0.5663443457691189, 'psi': 0.7172401782379814}
[S11] START round=11 head_norm_before_train=1.244432 cos_to_last_merge=0.8945 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.895
[S11] round=11 local utility u=0.016198 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9158497985188423, 'loss_val': 0.437730021367581, 'psi': 0.7876854124470953}-{'f1_val': 0.7014095185520394, 'auprc': 0.9384732163029171, 'loss_val': 0.5329990338093744, 'psi': 0.7962349976523905}
[S13] START round=11 head_norm_before_train=0.932410 cos_to_last_merge=0.9958 (last merge round=9)
[S13] round=11 local utility u=0.478224 metrics={'f1_val': 0.603713350791559, 'auprc': 0.6345881696618029, 'loss_val': 0.9159234074988317, 'psi': 0.6160632783396565}-{'f1_val': 0.43470205322916605, 'auprc': 0.6676390399350556, 'loss_val': 0.9574556894599738, 'psi': 0.5278768479115219}
[S14] START round=11 head_norm_before_train=1.058466 cos_to_last_merge=0.8590 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.859
[S14] round=11 local utility u=0.836165 metrics={'f1_val': 0.7843520738043208, 'auprc': 0.9781122146925932, 'loss_val': 0.5611574569733717, 'psi': 0.8618561301596298}-{'f1_val': 0.5138137639622441, 'auprc': 0.9887187099893984, 'loss_val': 0.6420764598563522, 'psi': 0.7037757423731059}
[S15] START round=11 head_norm_before_train=1.533586 (no previous merge yet)
[S15] round=11 local utility u=0.190149 metrics={'f1_val': 0.6979069611432517, 'auprc': 0.8851722880053606, 'loss_val': 0.369656193435415, 'psi': 0.7728130918880953}-{'f1_val': 0.6945166225580497, 'auprc': 0.8009946835599719, 'loss_val': 0.4770784328566248, 'psi': 0.7371078469588186}
[S16] START round=11 head_norm_before_train=0.759836 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.695141 metrics={'f1_val': 0.5305767920198007, 'auprc': 0.7330816015658861, 'loss_val': 0.972781583127339, 'psi': 0.6115787158382349}-{'f1_val': 0.35068041349546775, 'auprc': 0.6504324071850914, 'loss_val': 1.0357369240973655, 'psi': 0.4705812109713172}
[S17] START round=11 head_norm_before_train=1.015555 cos_to_last_merge=0.8999 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.900
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3534728608424502, 'auprc': 0.7036531933216249, 'loss_val': 0.8719023743051697, 'psi': 0.4935449938341201}-{'f1_val': 0.3599426751909836, 'auprc': 0.7019415727367431, 'loss_val': 0.8518824461826673, 'psi': 0.4967422342092874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S11] → sending delta(kind=head bytes=1808) to S2@127.0.0.1:36602
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:36604
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1808 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=-0.0179
[S6] DROPPED delta from S10 (cos=-0.0179 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.3680
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=0.9915
[S7] RECEIVED delta(kind=head bytes=1802) from S5
[S7] cosine check vs S5: cos=0.5748
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.5269
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] cosine check vs S6: cos=0.5384
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.9900
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.2757
[S2] RECEIVED delta(kind=head bytes=1808) from S11
[S2] cosine check vs S11: cos=0.9752
[S4] RECEIVED delta(kind=head bytes=1799) from S15
[S4] cosine check vs S15: cos=0.6777
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.5101
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6853 head_norm=0.771378
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.649536e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.5350 head_norm=0.820252 delta_norm=0.264954
[S4] aggregate: ROLLBACK (f1_val pre=0.685 post=0.535 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.6993 head_norm=1.180827
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.502581e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.6991 head_norm=1.232470 delta_norm=0.150258
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.6203 head_norm=0.902928
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.571349e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.6214 head_norm=0.585191 delta_norm=0.457135
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7155 head_norm=1.427710
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.206381e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7139 head_norm=1.483418 delta_norm=0.120638
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7013 head_norm=1.546547
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.009439e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=1.547621 delta_norm=0.100944
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4170 head_norm=0.536249
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.420144e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4170 head_norm=0.539053 delta_norm=0.142014
[S7] aggregate: ACCEPT kept=['S14', 'S5', 'S16', 'S13'] (k=4/4) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.232470 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.243044 metrics={'f1_val': 0.7009351753227933, 'auprc': 0.7929492631912347, 'loss_val': 0.5803680094742589, 'psi': 0.7377408104701699}-{'f1_val': 0.69931463913676, 'auprc': 0.6709752392768366, 'loss_val': 0.6908103671841562, 'psi': 0.6879788791927905}
[S3] START round=12 head_norm_before_train=1.248628 cos_to_last_merge=0.8631 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.863
[S3] round=12 local utility u=0.094191 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9927273344092702, 'loss_val': 0.35761915423102775, 'psi': 0.817139115919859}-{'f1_val': 0.6832068987394209, 'auprc': 0.9929363311987991, 'loss_val': 0.4453880930097924, 'psi': 0.8070986717231722}
[S4] START round=12 head_norm_before_train=0.820252 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.027608 metrics={'f1_val': 0.6813434556621615, 'auprc': 0.86933769282208, 'loss_val': 0.632117872546699, 'psi': 0.7565411505261288}-{'f1_val': 0.6853482668563149, 'auprc': 0.8723099808567485, 'loss_val': 0.7202801392122233, 'psi': 0.7601329524564884}
[S5] START round=12 head_norm_before_train=1.483418 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.6808548394004867, 'auprc': 0.7778726623325325, 'loss_val': 0.8189620423098116, 'psi': 0.719661968573305}-{'f1_val': 0.7155058228390914, 'auprc': 0.7782646193424259, 'loss_val': 0.9250689381118288, 'psi': 0.7406093414404251}
[S6] START round=12 head_norm_before_train=0.585191 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.251715 metrics={'f1_val': 0.7088791357313466, 'auprc': 0.9941474910283875, 'loss_val': 0.7958081470048873, 'psi': 0.822986477850163}-{'f1_val': 0.6203278383218184, 'auprc': 0.9952315423891709, 'loss_val': 0.7711817919329278, 'psi': 0.7702893199487594}
[S7] START round=12 head_norm_before_train=0.539053 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.4550682843185142, 'loss_val': 1.0712033230261784, 'psi': 0.43212679338646975}-{'f1_val': 0.41703542715461484, 'auprc': 0.5687222555004681, 'loss_val': 1.099627160494499, 'psi': 0.4777101584929561}
[S8] START round=12 head_norm_before_train=1.555261 (no previous merge yet)
[S8] round=12 local utility u=0.894838 metrics={'f1_val': 0.9945058427751525, 'auprc': 0.9942337921226443, 'loss_val': 0.1809164205877267, 'psi': 0.9943970225141492}-{'f1_val': 0.7053317764216975, 'auprc': 0.9924714548020832, 'loss_val': 0.2302616337024894, 'psi': 0.8201876477738519}
[S9] START round=12 head_norm_before_train=1.547621 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.030972 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9988444158303129, 'loss_val': 0.28525479965284306, 'psi': 0.8203120564566633}-{'f1_val': 0.7012904835408967, 'auprc': 0.9988367693805864, 'loss_val': 0.3471754451938598, 'psi': 0.8203089978767726}
[S10] START round=12 head_norm_before_train=1.195098 cos_to_last_merge=0.8804 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.880
[S10] round=12 local utility u=0.022111 metrics={'f1_val': 0.701236798752475, 'auprc': 0.9792041491768211, 'loss_val': 0.38455827729116354, 'psi': 0.8124237389222134}-{'f1_val': 0.7016946595131214, 'auprc': 0.9911247560969516, 'loss_val': 0.4672897380010941, 'psi': 0.8174666981466534}
[S11] START round=12 head_norm_before_train=1.299525 cos_to_last_merge=0.8828 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=12 local utility u=0.046964 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9180764853010035, 'loss_val': 0.34718822163809604, 'psi': 0.7882466818725563}-{'f1_val': 0.702242488399264, 'auprc': 0.9158497985188423, 'loss_val': 0.437730021367581, 'psi': 0.7876854124470953}
[S13] START round=12 head_norm_before_train=0.958148 cos_to_last_merge=0.9866 (last merge round=9)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.3722310382816899, 'auprc': 0.5224116639106979, 'loss_val': 0.9328686312679422, 'psi': 0.43230328853329314}-{'f1_val': 0.603713350791559, 'auprc': 0.6345881696618029, 'loss_val': 0.9159234074988317, 'psi': 0.6160632783396565}
[S14] START round=12 head_norm_before_train=1.109039 cos_to_last_merge=0.8403 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.840
[S14] round=12 local utility u=0.699517 metrics={'f1_val': 0.9901089674551543, 'auprc': 0.995382979990065, 'loss_val': 0.44847709872032937, 'psi': 0.9922185724691186}-{'f1_val': 0.7843520738043208, 'auprc': 0.9781122146925932, 'loss_val': 0.5611574569733717, 'psi': 0.8618561301596298}
[S15] START round=12 head_norm_before_train=1.588121 (no previous merge yet)
[S15] round=12 local utility u=0.004793 metrics={'f1_val': 0.698119900490342, 'auprc': 0.8766184990302789, 'loss_val': 0.3356868236193196, 'psi': 0.7695193399063167}-{'f1_val': 0.6979069611432517, 'auprc': 0.8851722880053606, 'loss_val': 0.369656193435415, 'psi': 0.7728130918880953}
[S16] START round=12 head_norm_before_train=0.803727 cos_to_last_merge=0.9947 (last merge round=10)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.43436053627638255, 'auprc': 0.746613065159612, 'loss_val': 0.9125403767370567, 'psi': 0.5592615478296743}-{'f1_val': 0.5305767920198007, 'auprc': 0.7330816015658861, 'loss_val': 0.972781583127339, 'psi': 0.6115787158382349}
[S17] START round=12 head_norm_before_train=1.054968 cos_to_last_merge=0.8840 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.884
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3329410874827109, 'auprc': 0.6566522361900567, 'loss_val': 1.0854108860982978, 'psi': 0.4624255469656492}-{'f1_val': 0.3534728608424502, 'auprc': 0.7036531933216249, 'loss_val': 0.8719023743051697, 'psi': 0.4935449938341201}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:36604
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:36616
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] cosine check vs S4: cos=0.9276
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.4977
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.9914
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] cosine check vs S8: cos=0.9930
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] cosine check vs S3: cos=0.7642
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] cosine check vs S6: cos=0.6305
[S4] RECEIVED delta(kind=head bytes=1803) from S15
[S4] cosine check vs S15: cos=0.8145
[S4] RECEIVED delta(kind=head bytes=1806) from S2
[S4] cosine check vs S2: cos=0.2702
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=-0.0146
[S6] DROPPED delta from S10 (cos=-0.0146 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1805) from S11
[S2] cosine check vs S11: cos=0.9883
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4168 head_norm=0.565770
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.015398e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4168 head_norm=0.759707 delta_norm=0.501540
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.6809 head_norm=1.507625
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.092772e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7149 head_norm=1.545054 delta_norm=0.109277
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7009 head_norm=1.271473
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.073386e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7004 head_norm=1.306232 delta_norm=0.107339
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6813 head_norm=0.880885
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.160361e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6818 head_norm=0.745015 delta_norm=0.216036
[S4] aggregate: ACCEPT kept=['S6', 'S15', 'S2'] (k=3/3) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=1.589129
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.400272e-02
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7015 head_norm=1.586873 delta_norm=0.094003
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7089 head_norm=0.633614
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.524641e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7123 head_norm=0.911146 delta_norm=0.452464
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4344 head_norm=0.858640
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.657991e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4542 head_norm=0.853886 delta_norm=0.165799
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.306232 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7001098153138046, 'auprc': 0.6649622253767472, 'loss_val': 0.5191259190309895, 'psi': 0.6860507793389816}-{'f1_val': 0.7009351753227933, 'auprc': 0.7929492631912347, 'loss_val': 0.5803680094742589, 'psi': 0.7377408104701699}
[S3] START round=13 head_norm_before_train=1.291648 cos_to_last_merge=0.8458 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.846
[S3] round=13 local utility u=0.018297 metrics={'f1_val': 0.7003355634446948, 'auprc': 0.9929353416182543, 'loss_val': 0.3231811715048389, 'psi': 0.8173754747141186}-{'f1_val': 0.7000803035935849, 'auprc': 0.9927273344092702, 'loss_val': 0.35761915423102775, 'psi': 0.817139115919859}
[S4] START round=13 head_norm_before_train=0.745015 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.123654 metrics={'f1_val': 0.678887210606654, 'auprc': 0.9511934584147476, 'loss_val': 0.6156389583505321, 'psi': 0.7878097097298915}-{'f1_val': 0.6813434556621615, 'auprc': 0.86933769282208, 'loss_val': 0.632117872546699, 'psi': 0.7565411505261288}
[S5] START round=13 head_norm_before_train=1.545054 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.374582 metrics={'f1_val': 0.7011053602517017, 'auprc': 0.9375773778610772, 'loss_val': 0.6704146321878409, 'psi': 0.7956941672954518}-{'f1_val': 0.6808548394004867, 'auprc': 0.7778726623325325, 'loss_val': 0.8189620423098116, 'psi': 0.719661968573305}
[S6] START round=13 head_norm_before_train=0.911146 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.077177 metrics={'f1_val': 0.7093883247887298, 'auprc': 0.9862758645666323, 'loss_val': 0.6208937847117775, 'psi': 0.8201433406998908}-{'f1_val': 0.7088791357313466, 'auprc': 0.9941474910283875, 'loss_val': 0.7958081470048873, 'psi': 0.822986477850163}
[S7] START round=13 head_norm_before_train=0.759707 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.474897 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7792927527438512, 'loss_val': 1.094082128278769, 'psi': 0.5618165807566046}-{'f1_val': 0.41683246609844005, 'auprc': 0.4550682843185142, 'loss_val': 1.0712033230261784, 'psi': 0.43212679338646975}
[S8] START round=13 head_norm_before_train=1.590181 (no previous merge yet)
[S8] round=13 local utility u=0.018667 metrics={'f1_val': 0.9932775562128633, 'auprc': 0.996034203707735, 'loss_val': 0.14161401540990473, 'psi': 0.9943802152108119}-{'f1_val': 0.9945058427751525, 'auprc': 0.9942337921226443, 'loss_val': 0.1809164205877267, 'psi': 0.9943970225141492}
[S9] START round=13 head_norm_before_train=1.586873 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9988106801133677, 'loss_val': 0.30502000973703397, 'psi': 0.8202985621698852}-{'f1_val': 0.7012904835408967, 'auprc': 0.9988444158303129, 'loss_val': 0.28525479965284306, 'psi': 0.8203120564566633}
[S10] START round=13 head_norm_before_train=1.246033 cos_to_last_merge=0.8679 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.868
[S10] round=13 local utility u=0.064330 metrics={'f1_val': 0.7000680725537874, 'auprc': 0.9979023107826122, 'loss_val': 0.30498076150899445, 'psi': 0.8192017678453174}-{'f1_val': 0.701236798752475, 'auprc': 0.9792041491768211, 'loss_val': 0.38455827729116354, 'psi': 0.8124237389222134}
[S11] START round=13 head_norm_before_train=1.348660 cos_to_last_merge=0.8741 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.874
[S11] round=13 local utility u=0.105813 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9798718965562184, 'loss_val': 0.3242423762798863, 'psi': 0.8132942516620458}-{'f1_val': 0.7016934795869249, 'auprc': 0.9180764853010035, 'loss_val': 0.34718822163809604, 'psi': 0.7882466818725563}
[S13] START round=13 head_norm_before_train=0.985705 cos_to_last_merge=0.9753 (last merge round=9)
[S13] round=13 local utility u=0.790502 metrics={'f1_val': 0.5904379986386634, 'auprc': 0.5798723568781077, 'loss_val': 0.8334885591870818, 'psi': 0.5862117419344411}-{'f1_val': 0.3722310382816899, 'auprc': 0.5224116639106979, 'loss_val': 0.9328686312679422, 'psi': 0.43230328853329314}
[S14] START round=13 head_norm_before_train=1.156415 cos_to_last_merge=0.8255 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.825
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.9269040766027381, 'auprc': 0.9900829564789274, 'loss_val': 0.39968194154837056, 'psi': 0.9521756285532139}-{'f1_val': 0.9901089674551543, 'auprc': 0.995382979990065, 'loss_val': 0.44847709872032937, 'psi': 0.9922185724691186}
[S15] START round=13 head_norm_before_train=1.634495 (no previous merge yet)
[S15] round=13 local utility u=0.245497 metrics={'f1_val': 0.7138027983451374, 'auprc': 0.9813343317498582, 'loss_val': 0.2529373706952036, 'psi': 0.8208154117070257}-{'f1_val': 0.698119900490342, 'auprc': 0.8766184990302789, 'loss_val': 0.3356868236193196, 'psi': 0.7695193399063167}
[S16] START round=13 head_norm_before_train=0.853886 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.142002 metrics={'f1_val': 0.4611984846638801, 'auprc': 0.7680082677429778, 'loss_val': 0.8537498431239795, 'psi': 0.5839223978955191}-{'f1_val': 0.43436053627638255, 'auprc': 0.746613065159612, 'loss_val': 0.9125403767370567, 'psi': 0.5592615478296743}
[S17] START round=13 head_norm_before_train=1.086392 cos_to_last_merge=0.8714 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.871
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.33493431235653653, 'auprc': 0.577565025296369, 'loss_val': 1.086990310570046, 'psi': 0.43198659753246954}-{'f1_val': 0.3329410874827109, 'auprc': 0.6566522361900567, 'loss_val': 1.0854108860982978, 'psi': 0.4624255469656492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=0.9925
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] cosine check vs S4: cos=0.9641
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.2047
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=0.9939
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] cosine check vs S6: cos=0.5296
[S4] RECEIVED delta(kind=head bytes=1800) from S15
[S4] cosine check vs S15: cos=0.7603
[S7] RECEIVED delta(kind=head bytes=1798) from S5
[S7] cosine check vs S5: cos=0.1971
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.2224
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] cosine check vs S13: cos=0.4420
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] cosine check vs S3: cos=0.9623
[S6] RECEIVED delta(kind=head bytes=1796) from S10
[S6] cosine check vs S10: cos=-0.0198
[S6] DROPPED delta from S10 (cos=-0.0198 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7001 head_norm=1.343458
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.682526e-02
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7001 head_norm=1.363327 delta_norm=0.086825
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7013 head_norm=1.626379
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.981843e-02
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7013 head_norm=1.623947 delta_norm=0.089818
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6789 head_norm=0.808184
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.259050e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6760 head_norm=0.877778 delta_norm=0.225905
[S4] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.7094 head_norm=0.956055
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.981263e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.7118 head_norm=0.852599 delta_norm=0.198126
[S6] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4612 head_norm=0.904709
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.243282e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4545 head_norm=0.848747 delta_norm=0.124328
[S16] aggregate: ROLLBACK (f1_val pre=0.461 post=0.455 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4168 head_norm=0.772486
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.631598e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4167 head_norm=0.616518 delta_norm=0.363160
[S7] aggregate: ACCEPT kept=['S5', 'S16', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.363327 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.023826 metrics={'f1_val': 0.7010315658334224, 'auprc': 0.6625218125674497, 'loss_val': 0.4696831011838332, 'psi': 0.6856276645270333}-{'f1_val': 0.7001098153138046, 'auprc': 0.6649622253767472, 'loss_val': 0.5191259190309895, 'psi': 0.6860507793389816}
[S3] START round=14 head_norm_before_train=1.330539 cos_to_last_merge=0.8316 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.832
[S3] round=14 local utility u=0.025312 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9952799372410354, 'loss_val': 0.2825689087550805, 'psi': 0.8186110159117006}-{'f1_val': 0.7003355634446948, 'auprc': 0.9929353416182543, 'loss_val': 0.3231811715048389, 'psi': 0.8173754747141186}
[S4] START round=14 head_norm_before_train=0.877778 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6562659852616717, 'auprc': 0.9543440437774704, 'loss_val': 0.5500953064648805, 'psi': 0.7754972086679912}-{'f1_val': 0.678887210606654, 'auprc': 0.9511934584147476, 'loss_val': 0.6156389583505321, 'psi': 0.7878097097298915}
[S5] START round=14 head_norm_before_train=1.568888 cos_to_last_merge=0.9993 (last merge round=12)
[S5] round=14 local utility u=0.059711 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9404276331510915, 'loss_val': 0.5580524410559691, 'psi': 0.7966852233499558}-{'f1_val': 0.7011053602517017, 'auprc': 0.9375773778610772, 'loss_val': 0.6704146321878409, 'psi': 0.7956941672954518}
[S6] START round=14 head_norm_before_train=0.852599 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6192245740124167, 'auprc': 0.7922381791504293, 'loss_val': 0.6628156070012933, 'psi': 0.6884300160676218}-{'f1_val': 0.7093883247887298, 'auprc': 0.9862758645666323, 'loss_val': 0.6208937847117775, 'psi': 0.8201433406998908}
[S7] START round=14 head_norm_before_train=0.616518 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.5696412638467167, 'loss_val': 1.0147200995961767, 'psi': 0.47788257640530074}-{'f1_val': 0.41683246609844005, 'auprc': 0.7792927527438512, 'loss_val': 1.094082128278769, 'psi': 0.5618165807566046}
[S8] START round=14 head_norm_before_train=1.626479 (no previous merge yet)
[S8] round=14 local utility u=0.011282 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9975530019145267, 'loss_val': 0.11263063175195145, 'psi': 0.9938901436916467}-{'f1_val': 0.9932775562128633, 'auprc': 0.996034203707735, 'loss_val': 0.14161401540990473, 'psi': 0.9943802152108119}
[S9] START round=14 head_norm_before_train=1.623947 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.051393 metrics={'f1_val': 0.7024932145862333, 'auprc': 0.9988061488437721, 'loss_val': 0.20943626785197297, 'psi': 0.8210183882892488}-{'f1_val': 0.7012904835408967, 'auprc': 0.9988106801133677, 'loss_val': 0.30502000973703397, 'psi': 0.8202985621698852}
[S10] START round=14 head_norm_before_train=1.297760 cos_to_last_merge=0.8563 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=14 local utility u=0.023472 metrics={'f1_val': 0.6999475952406476, 'auprc': 0.9974512595808367, 'loss_val': 0.25596115014580423, 'psi': 0.8189490609767233}-{'f1_val': 0.7000680725537874, 'auprc': 0.9979023107826122, 'loss_val': 0.30498076150899445, 'psi': 0.8192017678453174}
[S11] START round=14 head_norm_before_train=1.388351 cos_to_last_merge=0.8678 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.868
[S11] round=14 local utility u=0.032891 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.993641487628882, 'loss_val': 0.2964754518938095, 'psi': 0.8184726828037077}-{'f1_val': 0.702242488399264, 'auprc': 0.9798718965562184, 'loss_val': 0.3242423762798863, 'psi': 0.8132942516620458}
[S13] START round=14 head_norm_before_train=1.016704 cos_to_last_merge=0.9627 (last merge round=9)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5725981740225751, 'auprc': 0.5177200052557982, 'loss_val': 0.8454440642462352, 'psi': 0.5506469065158643}-{'f1_val': 0.5904379986386634, 'auprc': 0.5798723568781077, 'loss_val': 0.8334885591870818, 'psi': 0.5862117419344411}
[S14] START round=14 head_norm_before_train=1.201209 cos_to_last_merge=0.8135 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.814
[S14] round=14 local utility u=0.263191 metrics={'f1_val': 0.9940552518399735, 'auprc': 0.997502747372363, 'loss_val': 0.29846725104459787, 'psi': 0.9954342500529293}-{'f1_val': 0.9269040766027381, 'auprc': 0.9900829564789274, 'loss_val': 0.39968194154837056, 'psi': 0.9521756285532139}
[S15] START round=14 head_norm_before_train=1.675938 (no previous merge yet)
[S15] round=14 local utility u=0.351019 metrics={'f1_val': 0.8231332742746365, 'auprc': 0.9841834339998767, 'loss_val': 0.21543011315999588, 'psi': 0.8875533381647325}-{'f1_val': 0.7138027983451374, 'auprc': 0.9813343317498582, 'loss_val': 0.2529373706952036, 'psi': 0.8208154117070257}
[S16] START round=14 head_norm_before_train=0.848747 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.125250 metrics={'f1_val': 0.47821893211791155, 'auprc': 0.7943681276777065, 'loss_val': 0.7844522463649728, 'psi': 0.6046786103418296}-{'f1_val': 0.4611984846638801, 'auprc': 0.7680082677429778, 'loss_val': 0.8537498431239795, 'psi': 0.5839223978955191}
[S17] START round=14 head_norm_before_train=1.112072 cos_to_last_merge=0.8615 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.862
[S17] round=14 local utility u=0.197336 metrics={'f1_val': 0.3460591672696829, 'auprc': 0.642657996514532, 'loss_val': 0.9543466106341532, 'psi': 0.46469869896762256}-{'f1_val': 0.33493431235653653, 'auprc': 0.577565025296369, 'loss_val': 1.086990310570046, 'psi': 0.43198659753246954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:36608
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:36602
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:36604
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.9878
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.4643
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.6510
[S4] RECEIVED delta(kind=head bytes=1804) from S15
[S4] cosine check vs S15: cos=0.8375
[S4] RECEIVED delta(kind=head bytes=1805) from S2
[S4] cosine check vs S2: cos=0.2300
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=0.9285
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=0.9943
[S7] RECEIVED delta(kind=head bytes=1803) from S5
[S7] cosine check vs S5: cos=0.4283
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=0.9947
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=0.0017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.8873
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.5726 head_norm=1.048913
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.623050e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.5753 head_norm=1.060102 delta_norm=0.262305
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4167 head_norm=0.644427
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.733390e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4167 head_norm=0.648001 delta_norm=0.173339
[S7] aggregate: ACCEPT kept=['S16', 'S14', 'S5'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.6192 head_norm=0.901266
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.773923e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6857 head_norm=0.845040 delta_norm=0.377392
[S6] aggregate: ACCEPT kept=['S3', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6563 head_norm=0.935331
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.564873e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6816 head_norm=0.974261 delta_norm=0.356487
[S4] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7025 head_norm=1.655525
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.539639e-02
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7013 head_norm=1.656847 delta_norm=0.085396
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7010 head_norm=1.399661
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.583591e-02
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7010 head_norm=1.408000 delta_norm=0.075836
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7009 head_norm=1.591042
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.306028e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7009 head_norm=1.618342 delta_norm=0.130603
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.408000 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.169349 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7618991225263919, 'loss_val': 0.4308122217180703, 'psi': 0.7255481592540434}-{'f1_val': 0.7010315658334224, 'auprc': 0.6625218125674497, 'loss_val': 0.4696831011838332, 'psi': 0.6856276645270333}
[S3] START round=15 head_norm_before_train=1.363875 cos_to_last_merge=0.8218 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.822
[S3] round=15 local utility u=0.009184 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9968220841546167, 'loss_val': 0.26837323800826507, 'psi': 0.8191825559030265}-{'f1_val': 0.7008317350254774, 'auprc': 0.9952799372410354, 'loss_val': 0.2825689087550805, 'psi': 0.8186110159117006}
[S4] START round=15 head_norm_before_train=0.974261 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.871777 metrics={'f1_val': 0.9463690618285576, 'auprc': 0.9396797162024093, 'loss_val': 0.5031669503632937, 'psi': 0.9436933235780982}-{'f1_val': 0.6562659852616717, 'auprc': 0.9543440437774704, 'loss_val': 0.5500953064648805, 'psi': 0.7754972086679912}
[S5] START round=15 head_norm_before_train=1.618342 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.106914 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9852124820909993, 'loss_val': 0.4785792283691339, 'psi': 0.814599162925919}-{'f1_val': 0.7008569501491988, 'auprc': 0.9404276331510915, 'loss_val': 0.5580524410559691, 'psi': 0.7966852233499558}
[S6] START round=15 head_norm_before_train=0.845040 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.586348 metrics={'f1_val': 0.7093605683442025, 'auprc': 0.970202295222447, 'loss_val': 0.5648283362717131, 'psi': 0.8136972590955003}-{'f1_val': 0.6192245740124167, 'auprc': 0.7922381791504293, 'loss_val': 0.6628156070012933, 'psi': 0.6884300160676218}
[S7] START round=15 head_norm_before_train=0.648001 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.069435 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6020104296134096, 'loss_val': 0.972957033860916, 'psi': 0.4908302427119779}-{'f1_val': 0.41671011811102343, 'auprc': 0.5696412638467167, 'loss_val': 1.0147200995961767, 'psi': 0.47788257640530074}
[S8] START round=15 head_norm_before_train=1.662559 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9929848166558567, 'auprc': 0.9872651348238386, 'loss_val': 0.09581627445822202, 'psi': 0.9906969439230495}-{'f1_val': 0.9914482382097267, 'auprc': 0.9975530019145267, 'loss_val': 0.11263063175195145, 'psi': 0.9938901436916467}
[S9] START round=15 head_norm_before_train=1.656847 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.007866 metrics={'f1_val': 0.7024932145862333, 'auprc': 0.9986982345804425, 'loss_val': 0.19338142939459554, 'psi': 0.820975222583917}-{'f1_val': 0.7024932145862333, 'auprc': 0.9988061488437721, 'loss_val': 0.20943626785197297, 'psi': 0.8210183882892488}
[S10] START round=15 head_norm_before_train=1.342506 cos_to_last_merge=0.8458 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.846
[S10] round=15 local utility u=0.774632 metrics={'f1_val': 0.9568986766790955, 'auprc': 0.9973312058583743, 'loss_val': 0.2480433522293978, 'psi': 0.973071688350807}-{'f1_val': 0.6999475952406476, 'auprc': 0.9974512595808367, 'loss_val': 0.25596115014580423, 'psi': 0.8189490609767233}
[S11] START round=15 head_norm_before_train=1.420344 cos_to_last_merge=0.8630 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.863
[S11] round=15 local utility u=0.010265 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9961043727935851, 'loss_val': 0.2833347091421136, 'psi': 0.819457836869589}-{'f1_val': 0.7016934795869249, 'auprc': 0.993641487628882, 'loss_val': 0.2964754518938095, 'psi': 0.8184726828037077}
[S13] START round=15 head_norm_before_train=1.060102 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5574203352022047, 'auprc': 0.5179157925447527, 'loss_val': 0.9193463613546498, 'psi': 0.5416185181392239}-{'f1_val': 0.5725981740225751, 'auprc': 0.5177200052557982, 'loss_val': 0.8454440642462352, 'psi': 0.5506469065158643}
[S14] START round=15 head_norm_before_train=1.242077 cos_to_last_merge=0.8032 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.803
[S14] round=15 local utility u=0.017790 metrics={'f1_val': 0.9934238919081974, 'auprc': 0.9974973309699018, 'loss_val': 0.2590820550321318, 'psi': 0.9950532675328791}-{'f1_val': 0.9940552518399735, 'auprc': 0.997502747372363, 'loss_val': 0.29846725104459787, 'psi': 0.9954342500529293}
[S15] START round=15 head_norm_before_train=1.714489 (no previous merge yet)
[S15] round=15 local utility u=0.590106 metrics={'f1_val': 0.9932877501412771, 'auprc': 0.9978552970374872, 'loss_val': 0.09716126387022374, 'psi': 0.9951147688997612}-{'f1_val': 0.8231332742746365, 'auprc': 0.9841834339998767, 'loss_val': 0.21543011315999588, 'psi': 0.8875533381647325}
[S16] START round=15 head_norm_before_train=0.897103 cos_to_last_merge=0.9974 (last merge round=13)
[S16] round=15 local utility u=1.000000 metrics={'f1_val': 0.8158444126919255, 'auprc': 0.8590176081342085, 'loss_val': 0.7837248898968948, 'psi': 0.8331136908688387}-{'f1_val': 0.47821893211791155, 'auprc': 0.7943681276777065, 'loss_val': 0.7844522463649728, 'psi': 0.6046786103418296}
[S17] START round=15 head_norm_before_train=1.133589 cos_to_last_merge=0.8523 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.852
[S17] round=15 local utility u=0.189521 metrics={'f1_val': 0.3534424412471507, 'auprc': 0.7377178549640527, 'loss_val': 0.9047829862349601, 'psi': 0.5071526067339115}-{'f1_val': 0.3460591672696829, 'auprc': 0.642657996514532, 'loss_val': 0.9543466106341532, 'psi': 0.46469869896762256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:36608
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:36605
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.3708
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.6240
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.3498
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.9929
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] cosine check vs S11: cos=0.9957
[S4] RECEIVED delta(kind=head bytes=1806) from S15
[S4] cosine check vs S15: cos=0.8504
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=0.8863
[S4] RECEIVED delta(kind=head bytes=1792) from S6
[S4] cosine check vs S6: cos=0.3409
[S4] RECEIVED delta(kind=head bytes=1804) from S2
[S4] cosine check vs S2: cos=0.4776
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.5478
[S16] RECEIVED delta(kind=head bytes=1796) from S4
[S16] cosine check vs S4: cos=0.9346
[S7] RECEIVED delta(kind=head bytes=1803) from S5
[S7] cosine check vs S5: cos=0.5069
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.9612
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.5574 head_norm=1.085768
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.594166e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.5621 head_norm=1.108325 delta_norm=0.159417
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.210 → S7@127.0.0.1:36608
[S8] ⇄ pheromone p=0.214 → S9@127.0.0.1:36610
[S14] ⇄ pheromone p=0.318 → S7@127.0.0.1:36608
[S10] ⇄ pheromone p=0.339 → S6@127.0.0.1:36607
[S15] ⇄ pheromone p=0.343 → S4@127.0.0.1:36604
[S9] ⇄ pheromone p=0.154 → S5@127.0.0.1:36605
[S3] ⇄ pheromone p=0.167 → S6@127.0.0.1:36607
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7009 head_norm=1.644744
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.010851e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7009 head_norm=1.662615 delta_norm=0.101085
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.252 → S7@127.0.0.1:36608
[S11] ⇄ pheromone p=0.165 → S2@127.0.0.1:36602
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9464 head_norm=1.029738
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.729149e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.7814 head_norm=0.878267 delta_norm=0.272915
[S4] aggregate: ROLLBACK (f1_val pre=0.946 post=0.781 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.305 → S16@127.0.0.1:36616
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4167 head_norm=0.680500
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.169072e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4167 head_norm=0.692473 delta_norm=0.116907
[S7] aggregate: ACCEPT kept=['S14', 'S16', 'S5'] (k=3/3) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.166 → S6@127.0.0.1:36607
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.8158 head_norm=0.950708
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.831908e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.8145 head_norm=0.973932 delta_norm=0.183191
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.369 → S7@127.0.0.1:36608
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.7094 head_norm=0.886590
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.311940e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.7102 head_norm=0.733514 delta_norm=0.231194
[S6] aggregate: ACCEPT kept=['S10', 'S7', 'S3'] (k=3/3) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.290 → S4@127.0.0.1:36604
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7013 head_norm=1.443240
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.759807e-02
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7013 head_norm=1.445948 delta_norm=0.067598
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.193 → S4@127.0.0.1:36604
[S17] ⇄ pheromone p=0.145 → S13@127.0.0.1:36613
[S2] START round=16 head_norm_before_train=1.445948 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.6629716289001637, 'loss_val': 0.3823251313636467, 'psi': 0.685977161803552}-{'f1_val': 0.7013141837391442, 'auprc': 0.7618991225263919, 'loss_val': 0.4308122217180703, 'psi': 0.7255481592540434}
[S3] START round=16 head_norm_before_train=1.398525 cos_to_last_merge=0.8144 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.814
[S3] round=16 local utility u=0.015049 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984529264822994, 'loss_val': 0.2427162293966623, 'psi': 0.8197897463921207}-{'f1_val': 0.7007562037352997, 'auprc': 0.9968220841546167, 'loss_val': 0.26837323800826507, 'psi': 0.8191825559030265}
[S4] START round=16 head_norm_before_train=0.878267 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.016903 metrics={'f1_val': 0.9513239493432806, 'auprc': 0.9406297598496747, 'loss_val': 0.501941209800189, 'psi': 0.9470462735458383}-{'f1_val': 0.9463690618285576, 'auprc': 0.9396797162024093, 'loss_val': 0.5031669503632937, 'psi': 0.9436933235780982}
[S5] START round=16 head_norm_before_train=1.662615 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.5906163030223162, 'auprc': 0.7896008043234273, 'loss_val': 0.6540265643312176, 'psi': 0.6702101035427606}-{'f1_val': 0.7008569501491988, 'auprc': 0.9852124820909993, 'loss_val': 0.4785792283691339, 'psi': 0.814599162925919}
[S6] START round=16 head_norm_before_train=0.733514 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7078300605511465, 'auprc': 0.7969731329217435, 'loss_val': 0.637376891495693, 'psi': 0.7434872894993854}-{'f1_val': 0.7093605683442025, 'auprc': 0.970202295222447, 'loss_val': 0.5648283362717131, 'psi': 0.8136972590955003}
[S7] START round=16 head_norm_before_train=0.692473 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.42280275337789724, 'loss_val': 0.9438909045459679, 'psi': 0.419147172217773}-{'f1_val': 0.41671011811102343, 'auprc': 0.6020104296134096, 'loss_val': 0.972957033860916, 'psi': 0.4908302427119779}
[S8] START round=16 head_norm_before_train=1.692180 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.9858220668156676, 'loss_val': 0.09449395304141738, 'psi': 0.990081151242989}-{'f1_val': 0.9929848166558567, 'auprc': 0.9872651348238386, 'loss_val': 0.09581627445822202, 'psi': 0.9906969439230495}
[S9] START round=16 head_norm_before_train=1.686366 cos_to_last_merge=0.9995 (last merge round=14)
[S9] round=16 local utility u=0.910938 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984592197328035, 'loss_val': 0.13844675478982832, 'psi': 0.9976454354004071}-{'f1_val': 0.7024932145862333, 'auprc': 0.9986982345804425, 'loss_val': 0.19338142939459554, 'psi': 0.820975222583917}
[S10] START round=16 head_norm_before_train=1.381094 cos_to_last_merge=0.8362 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.836
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.8769652759596207, 'auprc': 0.9974702278212582, 'loss_val': 0.18675506638810843, 'psi': 0.9251672567042757}-{'f1_val': 0.9568986766790955, 'auprc': 0.9973312058583743, 'loss_val': 0.2480433522293978, 'psi': 0.973071688350807}
[S11] START round=16 head_norm_before_train=1.451802 cos_to_last_merge=0.8587 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.859
[S11] round=16 local utility u=0.007881 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.994213693205713, 'loss_val': 0.26150999457000296, 'psi': 0.8186624466208281}-{'f1_val': 0.7016934795869249, 'auprc': 0.9961043727935851, 'loss_val': 0.2833347091421136, 'psi': 0.819457836869589}
[S13] START round=16 head_norm_before_train=1.108325 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5462161340630809, 'auprc': 0.5153447398139188, 'loss_val': 0.975957222310434, 'psi': 0.533867576363416}-{'f1_val': 0.5574203352022047, 'auprc': 0.5179157925447527, 'loss_val': 0.9193463613546498, 'psi': 0.5416185181392239}
[S14] START round=16 head_norm_before_train=1.276792 cos_to_last_merge=0.7947 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.795
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9632584938938074, 'auprc': 0.9991201600623095, 'loss_val': 0.2776816370563724, 'psi': 0.9776031603612082}-{'f1_val': 0.9934238919081974, 'auprc': 0.9974973309699018, 'loss_val': 0.2590820550321318, 'psi': 0.9950532675328791}
[S15] START round=16 head_norm_before_train=1.750291 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7771772570047224, 'auprc': 0.9877795838905258, 'loss_val': 0.23016309477692176, 'psi': 0.8614181877590437}-{'f1_val': 0.9932877501412771, 'auprc': 0.9978552970374872, 'loss_val': 0.09716126387022374, 'psi': 0.9951147688997612}
[S16] START round=16 head_norm_before_train=0.973932 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.180228 metrics={'f1_val': 0.8150049143003899, 'auprc': 0.9020242129048304, 'loss_val': 0.5472511056038003, 'psi': 0.8498126337421661}-{'f1_val': 0.8158444126919255, 'auprc': 0.8590176081342085, 'loss_val': 0.7837248898968948, 'psi': 0.8331136908688387}
[S17] START round=16 head_norm_before_train=1.152695 cos_to_last_merge=0.8442 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.844
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.3527407011044409, 'auprc': 0.6840795139254215, 'loss_val': 0.9317823751980543, 'psi': 0.4852762262328332}-{'f1_val': 0.3534424412471507, 'auprc': 0.7377178549640527, 'loss_val': 0.9047829862349601, 'psi': 0.5071526067339115}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:36608
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:36605
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:36607
[S16] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=0.9965
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.5769
[S16] RECEIVED delta(kind=head bytes=1791) from S4
[S16] cosine check vs S4: cos=0.9563
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] cosine check vs S11: cos=0.9970
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] cosine check vs S3: cos=0.8028
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.5906 head_norm=1.688426
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.289798e-02
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.6285 head_norm=1.700905 delta_norm=0.072898
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7013 head_norm=1.477406
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.750990e-02
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7013 head_norm=1.479744 delta_norm=0.057510
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.4167 head_norm=0.727481
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.234607e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.4167 head_norm=0.780208 delta_norm=0.423461
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.7078 head_norm=0.772424
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.661793e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.7080 head_norm=1.050950 delta_norm=0.466179
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8150 head_norm=1.023161
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.514267e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8228 head_norm=0.966328 delta_norm=0.151427
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.479744 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.048680 metrics={'f1_val': 0.7005925029290768, 'auprc': 0.6913961828737214, 'loss_val': 0.36590839080198734, 'psi': 0.6969139749069346}-{'f1_val': 0.7013141837391442, 'auprc': 0.6629716289001637, 'loss_val': 0.3823251313636467, 'psi': 0.685977161803552}
[S3] START round=17 head_norm_before_train=1.430735 cos_to_last_merge=0.8078 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.808
[S3] round=17 local utility u=0.016832 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.998453231877414, 'loss_val': 0.20752485303943702, 'psi': 0.8196370095037595}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984529264822994, 'loss_val': 0.2427162293966623, 'psi': 0.8197897463921207}
[S4] START round=17 head_norm_before_train=0.930902 cos_to_last_merge=0.9974 (last merge round=15)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9313463687151264, 'auprc': 0.9604759036879649, 'loss_val': 0.4640653853380042, 'psi': 0.9429981827042617}-{'f1_val': 0.9513239493432806, 'auprc': 0.9406297598496747, 'loss_val': 0.501941209800189, 'psi': 0.9470462735458383}
[S5] START round=17 head_norm_before_train=1.700905 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.778552 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9927751578191297, 'loss_val': 0.3664026311309391, 'psi': 0.8174755195311203}-{'f1_val': 0.5906163030223162, 'auprc': 0.7896008043234273, 'loss_val': 0.6540265643312176, 'psi': 0.6702101035427606}
[S6] START round=17 head_norm_before_train=1.050950 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.306636 metrics={'f1_val': 0.6954595350695446, 'auprc': 0.9773120203898736, 'loss_val': 0.49089852741499934, 'psi': 0.8082005291976763}-{'f1_val': 0.7078300605511465, 'auprc': 0.7969731329217435, 'loss_val': 0.637376891495693, 'psi': 0.7434872894993854}
[S7] START round=17 head_norm_before_train=0.780208 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.115031 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.4949156967680212, 'loss_val': 0.9301678550504736, 'psi': 0.44799234957382256}-{'f1_val': 0.41671011811102343, 'auprc': 0.42280275337789724, 'loss_val': 0.9438909045459679, 'psi': 0.419147172217773}
[S8] START round=17 head_norm_before_train=1.722289 (no previous merge yet)
[S8] round=17 local utility u=0.019066 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.988548383020176, 'loss_val': 0.06941707732994172, 'psi': 0.9916593835491392}-{'f1_val': 0.9929205408612032, 'auprc': 0.9858220668156676, 'loss_val': 0.09449395304141738, 'psi': 0.990081151242989}
[S9] START round=17 head_norm_before_train=1.716391 cos_to_last_merge=0.9981 (last merge round=14)
[S9] round=17 local utility u=0.011309 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984778984671595, 'loss_val': 0.11089445308694137, 'psi': 0.9971537768251075}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984592197328035, 'loss_val': 0.13844675478982832, 'psi': 0.9976454354004071}
[S10] START round=17 head_norm_before_train=1.418206 cos_to_last_merge=0.8272 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.827
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.789752450553775, 'auprc': 0.9975152794444616, 'loss_val': 0.18622434125251786, 'psi': 0.8728575821100496}-{'f1_val': 0.8769652759596207, 'auprc': 0.9974702278212582, 'loss_val': 0.18675506638810843, 'psi': 0.9251672567042757}
[S11] START round=17 head_norm_before_train=1.484309 cos_to_last_merge=0.8548 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.855
[S11] round=17 local utility u=0.015617 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9980789225367778, 'loss_val': 0.24371302500093406, 'psi': 0.8203927589937032}-{'f1_val': 0.7016282822309048, 'auprc': 0.994213693205713, 'loss_val': 0.26150999457000296, 'psi': 0.8186624466208281}
[S13] START round=17 head_norm_before_train=1.131593 cos_to_last_merge=0.9985 (last merge round=15)
[S13] round=17 local utility u=0.018197 metrics={'f1_val': 0.5523269918015306, 'auprc': 0.5163591783034301, 'loss_val': 0.9792710998195207, 'psi': 0.5379398664022904}-{'f1_val': 0.5462161340630809, 'auprc': 0.5153447398139188, 'loss_val': 0.975957222310434, 'psi': 0.533867576363416}
[S14] START round=17 head_norm_before_train=1.304043 cos_to_last_merge=0.7882 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.788
[S14] round=17 local utility u=0.128022 metrics={'f1_val': 0.9949423986016118, 'auprc': 0.997450622004852, 'loss_val': 0.20673182913065205, 'psi': 0.9959456879629079}-{'f1_val': 0.9632584938938074, 'auprc': 0.9991201600623095, 'loss_val': 0.2776816370563724, 'psi': 0.9776031603612082}
[S15] START round=17 head_norm_before_train=1.778713 (no previous merge yet)
[S15] round=17 local utility u=0.175743 metrics={'f1_val': 0.8270679327110915, 'auprc': 0.9904283812727643, 'loss_val': 0.18596709506591444, 'psi': 0.8924121121357607}-{'f1_val': 0.7771772570047224, 'auprc': 0.9877795838905258, 'loss_val': 0.23016309477692176, 'psi': 0.8614181877590437}
[S16] START round=17 head_norm_before_train=0.966328 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.337062 metrics={'f1_val': 0.8834616244150572, 'auprc': 0.985906067402176, 'loss_val': 0.5355128229073838, 'psi': 0.9244394016099047}-{'f1_val': 0.8150049143003899, 'auprc': 0.9020242129048304, 'loss_val': 0.5472511056038003, 'psi': 0.8498126337421661}
[S17] START round=17 head_norm_before_train=1.168505 cos_to_last_merge=0.8376 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=17 local utility u=0.025991 metrics={'f1_val': 0.3541518446936578, 'auprc': 0.6944092990492801, 'loss_val': 0.9192571528327053, 'psi': 0.4902548264359067}-{'f1_val': 0.3527407011044409, 'auprc': 0.6840795139254215, 'loss_val': 0.9317823751980543, 'psi': 0.4852762262328332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:36608
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.3205
[S7] RECEIVED delta(kind=head bytes=1801) from S5
[S7] cosine check vs S5: cos=0.2802
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.1557
[S4] RECEIVED delta(kind=head bytes=1802) from S15
[S4] cosine check vs S15: cos=0.7356
[S4] RECEIVED delta(kind=head bytes=1794) from S6
[S4] cosine check vs S6: cos=0.4484
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.9880
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.9694
[S6] RECEIVED delta(kind=head bytes=1793) from S7
[S6] cosine check vs S7: cos=0.3728
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.9030
[S5] RECEIVED delta(kind=head bytes=1807) from S9
[S5] cosine check vs S9: cos=0.9972
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=0.9972
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.5563
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.9709
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9313 head_norm=0.985575
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.803391e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.8027 head_norm=0.908458 delta_norm=0.180339
[S4] aggregate: ROLLBACK (f1_val pre=0.931 post=0.803 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7006 head_norm=1.724017
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.537350e-02
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7006 head_norm=1.732189 delta_norm=0.065373
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.4167 head_norm=0.810727
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.877235e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.4167 head_norm=0.701484 delta_norm=0.287724
[S7] aggregate: ACCEPT kept=['S14', 'S5', 'S13', 'S16'] (k=4/4) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9963 head_norm=1.742777
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.353200e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9963 head_norm=1.740822 delta_norm=0.135320
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7006 head_norm=1.507794
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.623559e-02
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7006 head_norm=1.510854 delta_norm=0.056236
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.5523 head_norm=1.160175
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.420446e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.5607 head_norm=1.163823 delta_norm=0.142045
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.6955 head_norm=1.085213
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.997627e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.6959 head_norm=0.985766 delta_norm=0.199763
[S6] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.510854 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.122454 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7540772705332146, 'loss_val': 0.31337351949190084, 'psi': 0.7224194184567724}-{'f1_val': 0.7005925029290768, 'auprc': 0.6913961828737214, 'loss_val': 0.36590839080198734, 'psi': 0.6969139749069346}
[S3] START round=18 head_norm_before_train=1.459797 cos_to_last_merge=0.8038 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.804
[S3] round=18 local utility u=0.018881 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.998453231877414, 'loss_val': 0.17084210490914414, 'psi': 0.819744894251089}-{'f1_val': 0.7004261945879899, 'auprc': 0.998453231877414, 'loss_val': 0.20752485303943702, 'psi': 0.8196370095037595}
[S4] START round=18 head_norm_before_train=0.908458 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.056208 metrics={'f1_val': 0.9458913389926621, 'auprc': 0.9510763751103682, 'loss_val': 0.4107208526350836, 'psi': 0.9479653534397445}-{'f1_val': 0.9313463687151264, 'auprc': 0.9604759036879649, 'loss_val': 0.4640653853380042, 'psi': 0.9429981827042617}
[S5] START round=18 head_norm_before_train=1.732189 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.6402360776825129, 'auprc': 0.7917725685586767, 'loss_val': 0.6235372211364519, 'psi': 0.7008506740329785}-{'f1_val': 0.7006090940057808, 'auprc': 0.9927751578191297, 'loss_val': 0.3664026311309391, 'psi': 0.8174755195311203}
[S6] START round=18 head_norm_before_train=0.985766 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7095899298305519, 'auprc': 0.8670389510073762, 'loss_val': 0.5119139714773697, 'psi': 0.7725695383012816}-{'f1_val': 0.6954595350695446, 'auprc': 0.9773120203898736, 'loss_val': 0.49089852741499934, 'psi': 0.8082005291976763}
[S7] START round=18 head_norm_before_train=0.701484 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.43548923927209215, 'loss_val': 0.9132749696220479, 'psi': 0.4242217665754509}-{'f1_val': 0.41671011811102343, 'auprc': 0.4949156967680212, 'loss_val': 0.9301678550504736, 'psi': 0.44799234957382256}
[S8] START round=18 head_norm_before_train=1.749364 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7776299364943633, 'auprc': 0.9847572694841122, 'loss_val': 0.1512689375171365, 'psi': 0.8604808696902628}-{'f1_val': 0.9937333839017813, 'auprc': 0.988548383020176, 'loss_val': 0.06941707732994172, 'psi': 0.9916593835491392}
[S9] START round=18 head_norm_before_train=1.740822 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.003865 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9985338421290781, 'loss_val': 0.10333290426557468, 'psi': 0.9971761542898749}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984778984671595, 'loss_val': 0.11089445308694137, 'psi': 0.9971537768251075}
[S10] START round=18 head_norm_before_train=1.446970 cos_to_last_merge=0.8205 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=18 local utility u=0.642747 metrics={'f1_val': 0.9961684647169089, 'auprc': 0.9969181739669121, 'loss_val': 0.13743554735134242, 'psi': 0.9964683484169101}-{'f1_val': 0.789752450553775, 'auprc': 0.9975152794444616, 'loss_val': 0.18622434125251786, 'psi': 0.8728575821100496}
[S11] START round=18 head_norm_before_train=1.515996 cos_to_last_merge=0.8522 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.852
[S11] round=18 local utility u=0.000001 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9966538500673188, 'loss_val': 0.23798453026344177, 'psi': 0.8196776277790825}-{'f1_val': 0.7019353166316534, 'auprc': 0.9980789225367778, 'loss_val': 0.24371302500093406, 'psi': 0.8203927589937032}
[S13] START round=18 head_norm_before_train=1.163823 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.058431 metrics={'f1_val': 0.5326902444222887, 'auprc': 0.602264781768548, 'loss_val': 1.0023055636858347, 'psi': 0.5605200593607924}-{'f1_val': 0.5523269918015306, 'auprc': 0.5163591783034301, 'loss_val': 0.9792710998195207, 'psi': 0.5379398664022904}
[S14] START round=18 head_norm_before_train=1.334138 cos_to_last_merge=0.7817 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.782
[S14] round=18 local utility u=0.020430 metrics={'f1_val': 0.9958142949221049, 'auprc': 0.9960488322805119, 'loss_val': 0.16689699051602708, 'psi': 0.9959081098654677}-{'f1_val': 0.9949423986016118, 'auprc': 0.997450622004852, 'loss_val': 0.20673182913065205, 'psi': 0.9959456879629079}
[S15] START round=18 head_norm_before_train=1.802457 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7552107925943118, 'auprc': 0.9878627652394999, 'loss_val': 0.2706573582977306, 'psi': 0.848271581652387}-{'f1_val': 0.8270679327110915, 'auprc': 0.9904283812727643, 'loss_val': 0.18596709506591444, 'psi': 0.8924121121357607}
[S16] START round=18 head_norm_before_train=1.018500 cos_to_last_merge=0.9978 (last merge round=16)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8705366702950201, 'auprc': 0.9922683275119708, 'loss_val': 0.5270808406252645, 'psi': 0.9192293331818004}-{'f1_val': 0.8834616244150572, 'auprc': 0.985906067402176, 'loss_val': 0.5355128229073838, 'psi': 0.9244394016099047}
[S17] START round=18 head_norm_before_train=1.184617 cos_to_last_merge=0.8321 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=18 local utility u=0.130472 metrics={'f1_val': 0.39266239276861503, 'auprc': 0.7036028235671905, 'loss_val': 0.9169562951195775, 'psi': 0.5170385650880452}-{'f1_val': 0.3541518446936578, 'auprc': 0.6944092990492801, 'loss_val': 0.9192571528327053, 'psi': 0.4902548264359067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:36608
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:36605
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:36604
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:36616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[S4] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S10
[S6] cosine check vs S10: cos=0.0858
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=0.9501
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.3952
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.9963
[S4] RECEIVED delta(kind=head bytes=1802) from S2
[S4] cosine check vs S2: cos=0.5920
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.4892
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] cosine check vs S4: cos=0.9505
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=0.9975
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.9850
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.7096 head_norm=1.016946
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.662455e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.7098 head_norm=0.958538 delta_norm=0.366246
[S6] aggregate: ACCEPT kept=['S10', 'S3'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.6402 head_norm=1.753046
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.574891e-02
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.6483 head_norm=1.758499 delta_norm=0.075749
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4167 head_norm=0.736513
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.245529e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4167 head_norm=0.774786 delta_norm=0.424553
[S7] aggregate: ACCEPT kept=['S13', 'S14'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5327 head_norm=1.189798
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.036435e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.5364 head_norm=1.190286 delta_norm=0.103644
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9459 head_norm=0.962000
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.207810e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9446 head_norm=1.123390 delta_norm=0.620781
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7013 head_norm=1.539254
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.422373e-02
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7013 head_norm=1.538965 delta_norm=0.054224
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8705 head_norm=1.075879
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.698623e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8636 head_norm=1.006294 delta_norm=0.169862
[S16] aggregate: ROLLBACK (f1_val pre=0.871 post=0.864 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.538965 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.008639 metrics={'f1_val': 0.7013120848906231, 'auprc': 0.7545148466082868, 'loss_val': 0.29739590389994663, 'psi': 0.7225931895776886}-{'f1_val': 0.7013141837391442, 'auprc': 0.7540772705332146, 'loss_val': 0.31337351949190084, 'psi': 0.7224194184567724}
[S3] START round=19 head_norm_before_train=1.491207 cos_to_last_merge=0.8003 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.800
[S3] round=19 local utility u=0.868913 metrics={'f1_val': 0.9829707816095319, 'auprc': 0.9984537027742203, 'loss_val': 0.12720716939228438, 'psi': 0.9891639500754073}-{'f1_val': 0.7006060025002057, 'auprc': 0.998453231877414, 'loss_val': 0.17084210490914414, 'psi': 0.819744894251089}
[S4] START round=19 head_norm_before_train=1.123390 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9487172040564169, 'auprc': 0.9495518336472658, 'loss_val': 0.4431106008012995, 'psi': 0.9490510558927564}-{'f1_val': 0.9458913389926621, 'auprc': 0.9510763751103682, 'loss_val': 0.4107208526350836, 'psi': 0.9479653534397445}
[S5] START round=19 head_norm_before_train=1.758499 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.630533 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9917539936748588, 'loss_val': 0.32292294120626264, 'psi': 0.8168939565647589}-{'f1_val': 0.6402360776825129, 'auprc': 0.7917725685586767, 'loss_val': 0.6235372211364519, 'psi': 0.7008506740329785}
[S6] START round=19 head_norm_before_train=0.958538 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.143297 metrics={'f1_val': 0.7079394718648842, 'auprc': 0.9607171603602451, 'loss_val': 0.4964519238871134, 'psi': 0.8090505472630285}-{'f1_val': 0.7095899298305519, 'auprc': 0.8670389510073762, 'loss_val': 0.5119139714773697, 'psi': 0.7725695383012816}
[S7] START round=19 head_norm_before_train=0.774786 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.519476 metrics={'f1_val': 0.41662931103489464, 'auprc': 0.7819933107961612, 'loss_val': 0.9133506005968681, 'psi': 0.5627749109394014}-{'f1_val': 0.41671011811102343, 'auprc': 0.43548923927209215, 'loss_val': 0.9132749696220479, 'psi': 0.4242217665754509}
[S8] START round=19 head_norm_before_train=1.772455 (no previous merge yet)
[S8] round=19 local utility u=0.676627 metrics={'f1_val': 0.9836013959184189, 'auprc': 0.9987525050743014, 'loss_val': 0.07582929510384233, 'psi': 0.9896618395807719}-{'f1_val': 0.7776299364943633, 'auprc': 0.9847572694841122, 'loss_val': 0.1512689375171365, 'psi': 0.8604808696902628}
[S9] START round=19 head_norm_before_train=1.767184 cos_to_last_merge=0.9997 (last merge round=17)
[S9] round=19 local utility u=0.014259 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998485884311724, 'loss_val': 0.07966218940337771, 'psi': 0.9976561012319753}-{'f1_val': 0.9962710290637395, 'auprc': 0.9985338421290781, 'loss_val': 0.10333290426557468, 'psi': 0.9971761542898749}
[S10] START round=19 head_norm_before_train=1.472833 cos_to_last_merge=0.8144 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=19 local utility u=0.007647 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.996582602890318, 'loss_val': 0.11596157420674003, 'psi': 0.995816839723172}-{'f1_val': 0.9961684647169089, 'auprc': 0.9969181739669121, 'loss_val': 0.13743554735134242, 'psi': 0.9964683484169101}
[S11] START round=19 head_norm_before_train=1.540586 cos_to_last_merge=0.8511 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.851
[S11] round=19 local utility u=0.019844 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9978852520145514, 'loss_val': 0.2034418143459511, 'psi': 0.8203152907848126}-{'f1_val': 0.7016934795869249, 'auprc': 0.9966538500673188, 'loss_val': 0.23798453026344177, 'psi': 0.8196776277790825}
[S13] START round=19 head_norm_before_train=1.190286 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.300885 metrics={'f1_val': 0.5912703324601856, 'auprc': 0.6535090890113474, 'loss_val': 0.9057495969877398, 'psi': 0.6161658350806503}-{'f1_val': 0.5326902444222887, 'auprc': 0.602264781768548, 'loss_val': 1.0023055636858347, 'psi': 0.5605200593607924}
[S14] START round=19 head_norm_before_train=1.370513 cos_to_last_merge=0.7750 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.775
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9838177178459929, 'auprc': 0.9983217710396904, 'loss_val': 0.1703134896000323, 'psi': 0.9896193391234719}-{'f1_val': 0.9958142949221049, 'auprc': 0.9960488322805119, 'loss_val': 0.16689699051602708, 'psi': 0.9959081098654677}
[S15] START round=19 head_norm_before_train=1.829136 (no previous merge yet)
[S15] round=19 local utility u=0.837825 metrics={'f1_val': 0.992439920238213, 'auprc': 0.998626883363239, 'loss_val': 0.05067417354481497, 'psi': 0.9949147054882235}-{'f1_val': 0.7552107925943118, 'auprc': 0.9878627652394999, 'loss_val': 0.2706573582977306, 'psi': 0.848271581652387}
[S16] START round=19 head_norm_before_train=1.006294 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.194213 metrics={'f1_val': 0.916683226523233, 'auprc': 0.9940436134671555, 'loss_val': 0.4208595572974815, 'psi': 0.947627381300802}-{'f1_val': 0.8705366702950201, 'auprc': 0.9922683275119708, 'loss_val': 0.5270808406252645, 'psi': 0.9192293331818004}
[S17] START round=19 head_norm_before_train=1.199761 cos_to_last_merge=0.8270 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.358750420439229, 'auprc': 0.6827599013864823, 'loss_val': 0.9240014404282169, 'psi': 0.48835421281813035}-{'f1_val': 0.39266239276861503, 'auprc': 0.7036028235671905, 'loss_val': 0.9169562951195775, 'psi': 0.5170385650880452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:36608
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:36602
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:36607
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9977
[S7] RECEIVED delta(kind=head bytes=1792) from S16
[S7] cosine check vs S16: cos=0.4013
[S6] RECEIVED delta(kind=head bytes=1799) from S10
[S6] cosine check vs S10: cos=0.4061
[S4] RECEIVED delta(kind=head bytes=1802) from S15
[S4] cosine check vs S15: cos=0.3347
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=0.8826
[S4] RECEIVED delta(kind=head bytes=1805) from S2
[S4] cosine check vs S2: cos=0.9205
[S4] RECEIVED delta(kind=head bytes=1791) from S6
[S4] cosine check vs S6: cos=0.4467
[S7] RECEIVED delta(kind=head bytes=1793) from S13
[S7] cosine check vs S13: cos=0.6579
[S7] RECEIVED delta(kind=head bytes=1794) from S5
[S7] cosine check vs S5: cos=0.2124
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9982
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] cosine check vs S7: cos=0.2607
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.9916
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9487 head_norm=1.161689
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.865378e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9488 head_norm=0.988026 delta_norm=0.286538
[S4] aggregate: ACCEPT kept=['S15', 'S2', 'S6'] (k=3/3) mode=median trim_p=0.1
[S4] r=20 psi=0.949 u=0.0000 p_local=0.1355 f1=0.949 auprc=0.950 bytes=25117
[S14] r=20 psi=0.990 u=0.0000 p_local=0.1499 f1=0.984 auprc=0.998 bytes=25180
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9971 head_norm=1.795235
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.160616e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9971 head_norm=1.790473 delta_norm=0.116062
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.998 u=0.0143 p_local=0.1612 f1=0.997 auprc=0.998 bytes=28780
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7003 head_norm=1.774192
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.476876e-02
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7003 head_norm=1.783904 delta_norm=0.054769
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.817 u=0.6305 p_local=0.3290 f1=0.700 auprc=0.992 bytes=26954
[S11] r=20 psi=0.820 u=0.0198 p_local=0.0745 f1=0.702 auprc=0.998 bytes=28815
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4166 head_norm=0.803841
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.004670e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.4166 head_norm=0.730586 delta_norm=0.300467
[S7] aggregate: ACCEPT kept=['S16', 'S13', 'S5'] (k=3/3) mode=median trim_p=0.1
[S7] r=20 psi=0.563 u=0.5195 p_local=0.1866 f1=0.417 auprc=0.782 bytes=21579
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7013 head_norm=1.565325
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.254591e-02
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7013 head_norm=1.562180 delta_norm=0.052546
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.723 u=0.0086 p_local=0.1067 f1=0.701 auprc=0.755 bytes=25174
[S16] r=20 psi=0.948 u=0.1942 p_local=0.2517 f1=0.917 auprc=0.994 bytes=25118
[S8] r=20 psi=0.990 u=0.6766 p_local=0.2255 f1=0.984 auprc=0.999 bytes=28787
[S10] r=20 psi=0.996 u=0.0076 p_local=0.2432 f1=0.995 auprc=0.997 bytes=23385
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.7079 head_norm=0.988291
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.741693e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.7081 head_norm=0.811947 delta_norm=0.274169
[S6] aggregate: ACCEPT kept=['S10', 'S3', 'S7'] (k=3/3) mode=median trim_p=0.1
[S6] r=20 psi=0.809 u=0.1433 p_local=0.1866 f1=0.708 auprc=0.961 bytes=25119
[S15] r=20 psi=0.995 u=0.8378 p_local=0.3306 f1=0.992 auprc=0.999 bytes=28799
[S3] r=20 psi=0.989 u=0.8689 p_local=0.2489 f1=0.983 auprc=0.998 bytes=28776
[S13] r=20 psi=0.616 u=0.3009 p_local=0.1579 f1=0.591 auprc=0.654 bytes=23363
[S17] r=20 psi=0.488 u=0.0000 p_local=0.0836 f1=0.359 auprc=0.683 bytes=19761
[S2] START round=20 head_norm_before_train=1.562180 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7013120848906231, 'auprc': 0.7440564371457246, 'loss_val': 0.29288935381747677, 'psi': 0.7184098257926637}-{'f1_val': 0.7013120848906231, 'auprc': 0.7545148466082868, 'loss_val': 0.29739590389994663, 'psi': 0.7225931895776886}
[S3] START round=20 head_norm_before_train=1.518602 cos_to_last_merge=0.7976 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.798
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.998452714541483, 'loss_val': 0.12390906457604159, 'psi': 0.9759785382962949}-{'f1_val': 0.9829707816095319, 'auprc': 0.9984537027742203, 'loss_val': 0.12720716939228438, 'psi': 0.9891639500754073}
[S4] START round=20 head_norm_before_train=0.988026 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.021856 metrics={'f1_val': 0.9461622700564661, 'auprc': 0.9582970047304125, 'loss_val': 0.41030396344043696, 'psi': 0.9510161639260446}-{'f1_val': 0.9487172040564169, 'auprc': 0.9495518336472658, 'loss_val': 0.4431106008012995, 'psi': 0.9490510558927564}
[S5] START round=20 head_norm_before_train=1.783904 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.007631 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9915381654555293, 'loss_val': 0.3070128715028817, 'psi': 0.8168076252770271}-{'f1_val': 0.700320598491359, 'auprc': 0.9917539936748588, 'loss_val': 0.32292294120626264, 'psi': 0.8168939565647589}
[S6] START round=20 head_norm_before_train=0.811947 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6184722881421532, 'auprc': 0.777748975967862, 'loss_val': 0.6610965923209063, 'psi': 0.6821829632724367}-{'f1_val': 0.7079394718648842, 'auprc': 0.9607171603602451, 'loss_val': 0.4964519238871134, 'psi': 0.8090505472630285}
[S7] START round=20 head_norm_before_train=0.730586 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.5092061477881212, 'loss_val': 0.8983651478703796, 'psi': 0.45370852998186256}-{'f1_val': 0.41662931103489464, 'auprc': 0.7819933107961612, 'loss_val': 0.9133506005968681, 'psi': 0.5627749109394014}
[S8] START round=20 head_norm_before_train=1.793226 (no previous merge yet)
[S8] round=20 local utility u=0.004982 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.9852938980238284, 'loss_val': 0.08051324715901838, 'psi': 0.9897808092441258}-{'f1_val': 0.9836013959184189, 'auprc': 0.9987525050743014, 'loss_val': 0.07582929510384233, 'psi': 0.9896618395807719}
[S9] START round=20 head_norm_before_train=1.790473 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.002047 metrics={'f1_val': 0.9972634903368587, 'auprc': 0.9986257283183602, 'loss_val': 0.07695141649461307, 'psi': 0.9978083855294593}-{'f1_val': 0.9971029125121428, 'auprc': 0.998485884311724, 'loss_val': 0.07966218940337771, 'psi': 0.9976561012319753}
[S10] START round=20 head_norm_before_train=1.497447 cos_to_last_merge=0.8091 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.809
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9949140915418154, 'auprc': 0.9938417799871584, 'loss_val': 0.11899135842208128, 'psi': 0.9944851669199526}-{'f1_val': 0.9953063309450747, 'auprc': 0.996582602890318, 'loss_val': 0.11596157420674003, 'psi': 0.995816839723172}
[S11] START round=20 head_norm_before_train=1.560798 cos_to_last_merge=0.8502 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.850
[S11] round=20 local utility u=0.772526 metrics={'f1_val': 0.9542152731741638, 'auprc': 0.9982178270618918, 'loss_val': 0.17306682307871477, 'psi': 0.971816294729255}-{'f1_val': 0.7019353166316534, 'auprc': 0.9978852520145514, 'loss_val': 0.2034418143459511, 'psi': 0.8203152907848126}
[S13] START round=20 head_norm_before_train=1.217562 cos_to_last_merge=0.9983 (last merge round=18)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.4895915073725087, 'auprc': 0.5992895143842247, 'loss_val': 1.0986298459248915, 'psi': 0.5334707101771952}-{'f1_val': 0.5912703324601856, 'auprc': 0.6535090890113474, 'loss_val': 0.9057495969877398, 'psi': 0.6161658350806503}
[S14] START round=20 head_norm_before_train=1.402041 cos_to_last_merge=0.7694 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.769
[S14] round=20 local utility u=0.062638 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971562325080118, 'loss_val': 0.12454200341523973, 'psi': 0.9974531638331169}-{'f1_val': 0.9838177178459929, 'auprc': 0.9983217710396904, 'loss_val': 0.1703134896000323, 'psi': 0.9896193391234719}
[S15] START round=20 head_norm_before_train=1.853844 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.8977210303150167, 'auprc': 0.9950555634761011, 'loss_val': 0.18340745877456005, 'psi': 0.9366548435794504}-{'f1_val': 0.992439920238213, 'auprc': 0.998626883363239, 'loss_val': 0.05067417354481497, 'psi': 0.9949147054882235}
[S16] START round=20 head_norm_before_train=1.063796 cos_to_last_merge=0.9979 (last merge round=18)
[S16] round=20 local utility u=0.219709 metrics={'f1_val': 0.9634457612260177, 'auprc': 0.9927899815117298, 'loss_val': 0.25825561128419333, 'psi': 0.9751834493403024}-{'f1_val': 0.916683226523233, 'auprc': 0.9940436134671555, 'loss_val': 0.4208595572974815, 'psi': 0.947627381300802}
[S17] START round=20 head_norm_before_train=1.215724 cos_to_last_merge=0.8218 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.822
[S17] round=20 local utility u=0.124726 metrics={'f1_val': 0.388240448203987, 'auprc': 0.7066694162134131, 'loss_val': 0.9232185638193527, 'psi': 0.5156120354077575}-{'f1_val': 0.358750420439229, 'auprc': 0.6827599013864823, 'loss_val': 0.9240014404282169, 'psi': 0.48835421281813035}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:36608
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:36610
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:36602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:36608
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:36616
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:36605
[S11] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S5
[S7] cosine check vs S5: cos=0.4498
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.4955
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.5098
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] cosine check vs S8: cos=0.9961
[S2] RECEIVED delta(kind=head bytes=1806) from S11
[S2] cosine check vs S11: cos=0.9980
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9972
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] cosine check vs S4: cos=0.8751
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] cosine check vs S17: cos=0.9806
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7013 head_norm=1.585385
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.067001e-02
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7013 head_norm=1.582032 delta_norm=0.050670
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.085 → S4@127.0.0.1:36604
[S6] ⇄ pheromone p=0.149 → S4@127.0.0.1:36604
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.4896 head_norm=1.244415
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.220238e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.4827 head_norm=1.231306 delta_norm=0.122024
[S13] aggregate: ROLLBACK (f1_val pre=0.490 post=0.483 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.126 → S7@127.0.0.1:36608
[S3] ⇄ pheromone p=0.199 → S6@127.0.0.1:36607
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.4167 head_norm=0.759922
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.457855e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.4167 head_norm=0.757354 delta_norm=0.245785
[S7] aggregate: ACCEPT kept=['S5', 'S14', 'S16'] (k=3/3) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.149 → S6@127.0.0.1:36607
[S10] ⇄ pheromone p=0.195 → S6@127.0.0.1:36607
[S15] ⇄ pheromone p=0.264 → S4@127.0.0.1:36604
[S11] ⇄ pheromone p=0.214 → S2@127.0.0.1:36602
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9973 head_norm=1.817123
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.046457e-02
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9973 head_norm=1.813417 delta_norm=0.080465
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.129 → S5@127.0.0.1:36605
[S8] ⇄ pheromone p=0.181 → S9@127.0.0.1:36610
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7003 head_norm=1.804610
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.769709e-02
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7003 head_norm=1.809612 delta_norm=0.067697
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.265 → S7@127.0.0.1:36608
[S14] ⇄ pheromone p=0.132 → S7@127.0.0.1:36608
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9634 head_norm=1.125235
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.735198e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9454 head_norm=1.046480 delta_norm=0.273520
[S16] aggregate: ROLLBACK (f1_val pre=0.963 post=0.945 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.245 → S7@127.0.0.1:36608
[S4] ⇄ pheromone p=0.113 → S16@127.0.0.1:36616
[S17] ⇄ pheromone p=0.092 → S13@127.0.0.1:36613
[S2] START round=21 head_norm_before_train=1.582032 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.057005 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7815839560393905, 'loss_val': 0.29253953645538716, 'psi': 0.7335286721540637}-{'f1_val': 0.7013120848906231, 'auprc': 0.7440564371457246, 'loss_val': 0.29288935381747677, 'psi': 0.7184098257926637}
[S3] START round=21 head_norm_before_train=1.547261 cos_to_last_merge=0.7957 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.796
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9563597742054231, 'auprc': 0.9984401933662357, 'loss_val': 0.13871659631681266, 'psi': 0.9731919418697481}-{'f1_val': 0.960995754132836, 'auprc': 0.998452714541483, 'loss_val': 0.12390906457604159, 'psi': 0.9759785382962949}
[S4] START round=21 head_norm_before_train=1.036201 cos_to_last_merge=0.9970 (last merge round=19)
[S4] round=21 local utility u=0.021140 metrics={'f1_val': 0.9440203921090792, 'auprc': 0.9609327765018169, 'loss_val': 0.36308077875944117, 'psi': 0.9507853458661742}-{'f1_val': 0.9461622700564661, 'auprc': 0.9582970047304125, 'loss_val': 0.41030396344043696, 'psi': 0.9510161639260446}
[S5] START round=21 head_norm_before_train=1.809612 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9895877383162799, 'loss_val': 0.3050822518581258, 'psi': 0.8160274544213273}-{'f1_val': 0.700320598491359, 'auprc': 0.9915381654555293, 'loss_val': 0.3070128715028817, 'psi': 0.8168076252770271}
[S6] START round=21 head_norm_before_train=0.854170 cos_to_last_merge=0.9969 (last merge round=19)
[S6] round=21 local utility u=0.686622 metrics={'f1_val': 0.7077119513704995, 'auprc': 0.9821862295531875, 'loss_val': 0.4366030592290894, 'psi': 0.8175016626435747}-{'f1_val': 0.6184722881421532, 'auprc': 0.777748975967862, 'loss_val': 0.6610965923209063, 'psi': 0.6821829632724367}
[S7] START round=21 head_norm_before_train=0.757354 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.46167741751071883, 'loss_val': 0.8983965340737219, 'psi': 0.4346970378709016}-{'f1_val': 0.41671011811102343, 'auprc': 0.5092061477881212, 'loss_val': 0.8983651478703796, 'psi': 0.45370852998186256}
[S8] START round=21 head_norm_before_train=1.813277 (no previous merge yet)
[S8] round=21 local utility u=0.025075 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.9983039941846561, 'loss_val': 0.052778160709747654, 'psi': 0.9933232219366448}-{'f1_val': 0.9927720833909908, 'auprc': 0.9852938980238284, 'loss_val': 0.08051324715901838, 'psi': 0.9897808092441258}
[S9] START round=21 head_norm_before_train=1.813417 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.002294 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983931566600773, 'loss_val': 0.07070215882658545, 'psi': 0.9976190101713166}-{'f1_val': 0.9972634903368587, 'auprc': 0.9986257283183602, 'loss_val': 0.07695141649461307, 'psi': 0.9978083855294593}
[S10] START round=21 head_norm_before_train=1.523432 cos_to_last_merge=0.8041 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.804
[S10] round=21 local utility u=0.020360 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.9967830285751228, 'loss_val': 0.08549812501074228, 'psi': 0.9955020397636388}-{'f1_val': 0.9949140915418154, 'auprc': 0.9938417799871584, 'loss_val': 0.11899135842208128, 'psi': 0.9944851669199526}
[S11] START round=21 head_norm_before_train=1.580297 cos_to_last_merge=0.8495 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.850
[S11] round=21 local utility u=0.106574 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9975353461015843, 'loss_val': 0.21289381434427532, 'psi': 0.9970455340605733}-{'f1_val': 0.9542152731741638, 'auprc': 0.9982178270618918, 'loss_val': 0.17306682307871477, 'psi': 0.971816294729255}
[S13] START round=21 head_norm_before_train=1.231306 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.357666 metrics={'f1_val': 0.5615713405572049, 'auprc': 0.6444361965452825, 'loss_val': 0.9506177673685398, 'psi': 0.594717282952436}-{'f1_val': 0.4895915073725087, 'auprc': 0.5992895143842247, 'loss_val': 1.0986298459248915, 'psi': 0.5334707101771952}
[S14] START round=21 head_norm_before_train=1.432784 cos_to_last_merge=0.7633 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.763
[S14] round=21 local utility u=0.009392 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9971538066649925, 'loss_val': 0.10734128141102568, 'psi': 0.9976112281485413}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971562325080118, 'loss_val': 0.12454200341523973, 'psi': 0.9974531638331169}
[S15] START round=21 head_norm_before_train=1.872583 (no previous merge yet)
[S15] round=21 local utility u=0.362473 metrics={'f1_val': 0.9962174043289, 'auprc': 0.9956638590180348, 'loss_val': 0.051264041144832954, 'psi': 0.995995986204554}-{'f1_val': 0.8977210303150167, 'auprc': 0.9950555634761011, 'loss_val': 0.18340745877456005, 'psi': 0.9366548435794504}
[S16] START round=21 head_norm_before_train=1.046480 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8481217778979647, 'auprc': 0.9936865968860177, 'loss_val': 0.6219735543128181, 'psi': 0.9063477054931859}-{'f1_val': 0.9634457612260177, 'auprc': 0.9927899815117298, 'loss_val': 0.25825561128419333, 'psi': 0.9751834493403024}
[S17] START round=21 head_norm_before_train=1.230220 cos_to_last_merge=0.8173 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=21 local utility u=0.121595 metrics={'f1_val': 0.3921656537126879, 'auprc': 0.784106849483881, 'loss_val': 0.9358917134616085, 'psi': 0.5489421320211652}-{'f1_val': 0.388240448203987, 'auprc': 0.7066694162134131, 'loss_val': 0.9232185638193527, 'psi': 0.5156120354077575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:36602
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:36608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:36607
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:36604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:36616
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:36608
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.4697
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] cosine check vs S6: cos=0.6126
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=0.7953
[S16] RECEIVED delta(kind=head bytes=1794) from S4
[S16] cosine check vs S4: cos=0.9603
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] cosine check vs S8: cos=0.9977
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.5667
[S6] RECEIVED delta(kind=head bytes=1802) from S10
[S6] cosine check vs S10: cos=0.4357
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=0.9972
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] cosine check vs S11: cos=0.9980
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=0.4257
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:36613
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.9880
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7003 head_norm=1.833490
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.934752e-02
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7006 head_norm=1.834927 delta_norm=0.069348
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.4167 head_norm=0.784987
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.119174e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.4167 head_norm=0.839817 delta_norm=0.411917
[S7] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.5616 head_norm=1.256847
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.710861e-02
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.5670 head_norm=1.246446 delta_norm=0.097109
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7015 head_norm=1.604163
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.017137e-02
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7016 head_norm=1.601184 delta_norm=0.050171
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.7077 head_norm=0.892190
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.054685e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.7084 head_norm=1.048656 delta_norm=0.705468
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9971 head_norm=1.838980
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.234249e-02
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9971 head_norm=1.833321 delta_norm=0.062342
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9440 head_norm=1.087144
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.955750e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9440 head_norm=0.957368 delta_norm=0.195575
[S4] aggregate: ACCEPT kept=['S15', 'S6', 'S2'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8481 head_norm=1.100842
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.542651e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8470 head_norm=1.083083 delta_norm=0.154265
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.601184 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7013120848906231, 'auprc': 0.7463122050624165, 'loss_val': 0.2937646212751822, 'psi': 0.7193121329593404}-{'f1_val': 0.7014918162305126, 'auprc': 0.7815839560393905, 'loss_val': 0.29253953645538716, 'psi': 0.7335286721540637}
[S3] START round=22 head_norm_before_train=1.575076 cos_to_last_merge=0.7938 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.794
[S3] round=22 local utility u=0.150044 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9986637761961488, 'loss_val': 0.0881743703734288, 'psi': 0.9981688669583468}-{'f1_val': 0.9563597742054231, 'auprc': 0.9984401933662357, 'loss_val': 0.13871659631681266, 'psi': 0.9731919418697481}
[S4] START round=22 head_norm_before_train=0.957368 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.018679 metrics={'f1_val': 0.9527834449960026, 'auprc': 0.9528802084312014, 'loss_val': 0.35414377625284377, 'psi': 0.9528221503700822}-{'f1_val': 0.9440203921090792, 'auprc': 0.9609327765018169, 'loss_val': 0.36308077875944117, 'psi': 0.9507853458661742}
[S5] START round=22 head_norm_before_train=1.834927 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.70041718685076, 'auprc': 0.9807967521995751, 'loss_val': 0.3097562783793489, 'psi': 0.812569012990286}-{'f1_val': 0.700320598491359, 'auprc': 0.9895877383162799, 'loss_val': 0.3050822518581258, 'psi': 0.8160274544213273}
[S6] START round=22 head_norm_before_train=1.048656 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.7076193981198, 'auprc': 0.9591182278896166, 'loss_val': 0.561192198074961, 'psi': 0.8082189300277267}-{'f1_val': 0.7077119513704995, 'auprc': 0.9821862295531875, 'loss_val': 0.4366030592290894, 'psi': 0.8175016626435747}
[S7] START round=22 head_norm_before_train=0.839817 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.254722 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6304973375164988, 'loss_val': 0.8954114665877003, 'psi': 0.5022250058732136}-{'f1_val': 0.41671011811102343, 'auprc': 0.46167741751071883, 'loss_val': 0.8983965340737219, 'psi': 0.4346970378709016}
[S8] START round=22 head_norm_before_train=1.829769 (no previous merge yet)
[S8] round=22 local utility u=0.009029 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9980278140928074, 'loss_val': 0.04711758495799865, 'psi': 0.9945352815958077}-{'f1_val': 0.9900027071046373, 'auprc': 0.9983039941846561, 'loss_val': 0.052778160709747654, 'psi': 0.9933232219366448}
[S9] START round=22 head_norm_before_train=1.833321 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9986268770299578, 'loss_val': 0.07030413055978904, 'psi': 0.9960647443296733}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983931566600773, 'loss_val': 0.07070215882658545, 'psi': 0.9976190101713166}
[S10] START round=22 head_norm_before_train=1.548783 cos_to_last_merge=0.7996 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.800
[S10] round=22 local utility u=0.001800 metrics={'f1_val': 0.9941434254657042, 'auprc': 0.9965663421608308, 'loss_val': 0.07821953917036657, 'psi': 0.9951125921437549}-{'f1_val': 0.9946480472226495, 'auprc': 0.9967830285751228, 'loss_val': 0.08549812501074228, 'psi': 0.9955020397636388}
[S11] START round=22 head_norm_before_train=1.599774 cos_to_last_merge=0.8490 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.849
[S11] round=22 local utility u=0.044333 metrics={'f1_val': 0.9971824017077261, 'auprc': 0.9982200442044539, 'loss_val': 0.1290616650388895, 'psi': 0.9975974587064173}-{'f1_val': 0.9967189926998994, 'auprc': 0.9975353461015843, 'loss_val': 0.21289381434427532, 'psi': 0.9970455340605733}
[S13] START round=22 head_norm_before_train=1.246446 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5201318009459117, 'auprc': 0.6445945852398082, 'loss_val': 1.0420350045737632, 'psi': 0.5699169146634703}-{'f1_val': 0.5615713405572049, 'auprc': 0.6444361965452825, 'loss_val': 0.9506177673685398, 'psi': 0.594717282952436}
[S14] START round=22 head_norm_before_train=1.464019 cos_to_last_merge=0.7573 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.757
[S14] round=22 local utility u=0.001932 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.997081488645233, 'loss_val': 0.09934102706434302, 'psi': 0.9971904017249147}-{'f1_val': 0.9979161758042404, 'auprc': 0.9971538066649925, 'loss_val': 0.10734128141102568, 'psi': 0.9976112281485413}
[S15] START round=22 head_norm_before_train=1.890342 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.9500585149683037, 'auprc': 0.990804629125598, 'loss_val': 0.09111163778367656, 'psi': 0.9663569606312215}-{'f1_val': 0.9962174043289, 'auprc': 0.9956638590180348, 'loss_val': 0.051264041144832954, 'psi': 0.995995986204554}
[S16] START round=22 head_norm_before_train=1.083083 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8328297124907665, 'auprc': 0.9384063334799816, 'loss_val': 0.5182479302272543, 'psi': 0.8750603608864526}-{'f1_val': 0.8481217778979647, 'auprc': 0.9936865968860177, 'loss_val': 0.6219735543128181, 'psi': 0.9063477054931859}
[S17] START round=22 head_norm_before_train=1.243564 cos_to_last_merge=0.8135 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=22 local utility u=0.008363 metrics={'f1_val': 0.3920544628395636, 'auprc': 0.7927127749155823, 'loss_val': 0.9443160868864169, 'psi': 0.5523177876699711}-{'f1_val': 0.3921656537126879, 'auprc': 0.784106849483881, 'loss_val': 0.9358917134616085, 'psi': 0.5489421320211652}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:36615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:36605
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S4
[S15] cosine check vs S4: cos=0.5129
[S5] RECEIVED delta(kind=head bytes=1801) from S7
[S5] cosine check vs S7: cos=0.2616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.9501 head_norm=1.909553
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.197473e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.9308 head_norm=1.288827 delta_norm=0.819747
[S15] aggregate: ROLLBACK (f1_val pre=0.950 post=0.931 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7004 head_norm=1.859050
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.167464e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7005 head_norm=1.122571 delta_norm=0.916746
[S5] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.620743 cos_to_last_merge=0.9999 (last merge round=21)
[S2] round=23 local utility u=0.245037 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.9074322766907595, 'loss_val': 0.2886050931859207, 'psi': 0.7839155460994529}-{'f1_val': 0.7013120848906231, 'auprc': 0.7463122050624165, 'loss_val': 0.2937646212751822, 'psi': 0.7193121329593404}
[S3] START round=23 head_norm_before_train=1.600272 cos_to_last_merge=0.7917 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9969696733094051, 'loss_val': 0.1071144258307589, 'psi': 0.9754570236644535}-{'f1_val': 0.9978389274664787, 'auprc': 0.9986637761961488, 'loss_val': 0.0881743703734288, 'psi': 0.9981688669583468}
[S4] START round=23 head_norm_before_train=1.009815 cos_to_last_merge=0.9978 (last merge round=21)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9403814969788762, 'auprc': 0.9661098729219157, 'loss_val': 0.32789290928414067, 'psi': 0.950672847356092}-{'f1_val': 0.9527834449960026, 'auprc': 0.9528802084312014, 'loss_val': 0.35414377625284377, 'psi': 0.9528221503700822}
[S5] START round=23 head_norm_before_train=1.122571 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9945318144225991, 'loss_val': 0.39783240865105374, 'psi': 0.818005084863855}-{'f1_val': 0.70041718685076, 'auprc': 0.9807967521995751, 'loss_val': 0.3097562783793489, 'psi': 0.812569012990286}
[S6] START round=23 head_norm_before_train=1.068891 cos_to_last_merge=0.9981 (last merge round=21)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7076028283554217, 'auprc': 0.784010796824163, 'loss_val': 0.5737179691249268, 'psi': 0.7381660157429182}-{'f1_val': 0.7076193981198, 'auprc': 0.9591182278896166, 'loss_val': 0.561192198074961, 'psi': 0.8082189300277267}
[S7] START round=23 head_norm_before_train=0.863198 cos_to_last_merge=0.9977 (last merge round=21)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6182976123669882, 'loss_val': 0.8627187017193665, 'psi': 0.49734511581340934}-{'f1_val': 0.41671011811102343, 'auprc': 0.6304973375164988, 'loss_val': 0.8954114665877003, 'psi': 0.5022250058732136}
[S8] START round=23 head_norm_before_train=1.847345 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.865035986720463, 'loss_val': 0.554875299390936, 'psi': 0.7742666882474868}-{'f1_val': 0.9922069265978078, 'auprc': 0.9980278140928074, 'loss_val': 0.04711758495799865, 'psi': 0.9945352815958077}
[S9] START round=23 head_norm_before_train=1.857549 cos_to_last_merge=0.9998 (last merge round=21)
[S9] round=23 local utility u=0.016532 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986554407774346, 'loss_val': 0.053803534009000877, 'psi': 0.9977239238182596}-{'f1_val': 0.994356655862817, 'auprc': 0.9986268770299578, 'loss_val': 0.07030413055978904, 'psi': 0.9960647443296733}
[S10] START round=23 head_norm_before_train=1.574646 cos_to_last_merge=0.7956 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.796
[S10] round=23 local utility u=0.004185 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9948309166604571, 'loss_val': 0.06827481038633808, 'psi': 0.9947815321958063}-{'f1_val': 0.9941434254657042, 'auprc': 0.9965663421608308, 'loss_val': 0.07821953917036657, 'psi': 0.9951125921437549}
[S11] START round=23 head_norm_before_train=1.621206 cos_to_last_merge=0.8481 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.848
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977480836602618, 'loss_val': 0.14430412803190673, 'psi': 0.9970274361722584}-{'f1_val': 0.9971824017077261, 'auprc': 0.9982200442044539, 'loss_val': 0.1290616650388895, 'psi': 0.9975974587064173}
[S13] START round=23 head_norm_before_train=1.269740 cos_to_last_merge=0.9988 (last merge round=21)
[S13] round=23 local utility u=0.238222 metrics={'f1_val': 0.5730684603858436, 'auprc': 0.6568332612791201, 'loss_val': 0.9199274947365882, 'psi': 0.6065743807431542}-{'f1_val': 0.5201318009459117, 'auprc': 0.6445945852398082, 'loss_val': 1.0420350045737632, 'psi': 0.5699169146634703}
[S14] START round=23 head_norm_before_train=1.490604 cos_to_last_merge=0.7517 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.752
[S14] round=23 local utility u=0.007456 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.9970658345310377, 'loss_val': 0.08437956432552288, 'psi': 0.9971839499175457}-{'f1_val': 0.9972630104447024, 'auprc': 0.997081488645233, 'loss_val': 0.09934102706434302, 'psi': 0.9971904017249147}
[S15] START round=23 head_norm_before_train=1.288827 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.098611 metrics={'f1_val': 0.9921077193017869, 'auprc': 0.9898148507659205, 'loss_val': 0.1432159755211696, 'psi': 0.9911905718874403}-{'f1_val': 0.9500585149683037, 'auprc': 0.990804629125598, 'loss_val': 0.09111163778367656, 'psi': 0.9663569606312215}
[S16] START round=23 head_norm_before_train=1.132130 cos_to_last_merge=0.9982 (last merge round=21)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8195561669503213, 'auprc': 0.7750527158365523, 'loss_val': 0.8979347227469823, 'psi': 0.8017547865048137}-{'f1_val': 0.8328297124907665, 'auprc': 0.9384063334799816, 'loss_val': 0.5182479302272543, 'psi': 0.8750603608864526}
[S17] START round=23 head_norm_before_train=1.259661 cos_to_last_merge=0.8098 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=23 local utility u=0.125098 metrics={'f1_val': 0.3967643434577176, 'auprc': 0.8192821907901129, 'loss_val': 0.8020880642500289, 'psi': 0.5657714823906758}-{'f1_val': 0.3920544628395636, 'auprc': 0.7927127749155823, 'loss_val': 0.9443160868864169, 'psi': 0.5523177876699711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:36617
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:36612
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:36609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1805) from S2
[S11] cosine check vs S2: cos=0.9964
[S8] RECEIVED delta(kind=head bytes=1801) from S9
[S8] cosine check vs S9: cos=0.9970
[S17] RECEIVED delta(kind=head bytes=1799) from S13
[S17] cosine check vs S13: cos=0.9832
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.7138 head_norm=1.863709
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.304135e-02
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.7138 head_norm=1.871370 delta_norm=0.073041
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9965 head_norm=1.646351
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.935998e-02
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9965 head_norm=1.641499 delta_norm=0.069360
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.3968 head_norm=1.277329
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.183364e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3975 head_norm=1.282358 delta_norm=0.118336
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.639569 cos_to_last_merge=0.9995 (last merge round=21)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.5201885115732257, 'auprc': 0.7504615378766053, 'loss_val': 0.8266096054167374, 'psi': 0.6122977220945776}-{'f1_val': 0.7015710590385817, 'auprc': 0.9074322766907595, 'loss_val': 0.2886050931859207, 'psi': 0.7839155460994529}
[S3] START round=24 head_norm_before_train=1.628394 cos_to_last_merge=0.7896 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.790
[S3] round=24 local utility u=0.130760 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9988004473047001, 'loss_val': 0.0671771098563142, 'psi': 0.997798311223748}-{'f1_val': 0.9611152572344858, 'auprc': 0.9969696733094051, 'loss_val': 0.1071144258307589, 'psi': 0.9754570236644535}
[S4] START round=24 head_norm_before_train=1.060960 cos_to_last_merge=0.9931 (last merge round=21)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9122998044729033, 'auprc': 0.9716263294374159, 'loss_val': 0.38136137021241956, 'psi': 0.9360304144587084}-{'f1_val': 0.9403814969788762, 'auprc': 0.9661098729219157, 'loss_val': 0.32789290928414067, 'psi': 0.950672847356092}
[S5] START round=24 head_norm_before_train=1.160843 cos_to_last_merge=0.9984 (last merge round=22)
[S5] round=24 local utility u=0.022633 metrics={'f1_val': 0.700320598491359, 'auprc': 0.992017556347489, 'loss_val': 0.3450229313249417, 'psi': 0.816999381633811}-{'f1_val': 0.700320598491359, 'auprc': 0.9945318144225991, 'loss_val': 0.39783240865105374, 'psi': 0.818005084863855}
[S6] START round=24 head_norm_before_train=1.097680 cos_to_last_merge=0.9924 (last merge round=21)
[S6] round=24 local utility u=0.343787 metrics={'f1_val': 0.7120226228407013, 'auprc': 0.9542117941740059, 'loss_val': 0.4232658629072884, 'psi': 0.8088982913740231}-{'f1_val': 0.7076028283554217, 'auprc': 0.784010796824163, 'loss_val': 0.5737179691249268, 'psi': 0.7381660157429182}
[S7] START round=24 head_norm_before_train=0.891277 cos_to_last_merge=0.9916 (last merge round=21)
[S7] round=24 local utility u=0.192005 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.739140629315151, 'loss_val': 0.8419709291625631, 'psi': 0.5457557313851245}-{'f1_val': 0.41671011811102343, 'auprc': 0.6182976123669882, 'loss_val': 0.8627187017193665, 'psi': 0.49734511581340934}
[S8] START round=24 head_norm_before_train=1.871370 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=1.000000 metrics={'f1_val': 0.9839092979549603, 'auprc': 0.9962105824669081, 'loss_val': 0.0611554267471233, 'psi': 0.9888298117597394}-{'f1_val': 0.7137538225988359, 'auprc': 0.865035986720463, 'loss_val': 0.554875299390936, 'psi': 0.7742666882474868}
[S9] START round=24 head_norm_before_train=1.881838 cos_to_last_merge=0.9991 (last merge round=21)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9987499679197694, 'loss_val': 0.05568961206753665, 'psi': 0.9938430922276428}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986554407774346, 'loss_val': 0.053803534009000877, 'psi': 0.9977239238182596}
[S10] START round=24 head_norm_before_train=1.595667 cos_to_last_merge=0.7928 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.793
[S10] round=24 local utility u=0.004109 metrics={'f1_val': 0.9949509212940392, 'auprc': 0.9951264156228378, 'loss_val': 0.062157283502590734, 'psi': 0.9950211190255587}-{'f1_val': 0.9947486092193725, 'auprc': 0.9948309166604571, 'loss_val': 0.06827481038633808, 'psi': 0.9947815321958063}
[S11] START round=24 head_norm_before_train=1.641499 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.020779 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979373664167044, 'loss_val': 0.10331451820953025, 'psi': 0.9971031492748355}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977480836602618, 'loss_val': 0.14430412803190673, 'psi': 0.9970274361722584}
[S13] START round=24 head_norm_before_train=1.298200 cos_to_last_merge=0.9951 (last merge round=21)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5346482610483414, 'auprc': 0.6361856863301114, 'loss_val': 1.031325325023021, 'psi': 0.5752632311610494}-{'f1_val': 0.5730684603858436, 'auprc': 0.6568332612791201, 'loss_val': 0.9199274947365882, 'psi': 0.6065743807431542}
[S14] START round=24 head_norm_before_train=1.525327 cos_to_last_merge=0.7457 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.746
[S14] round=24 local utility u=0.008276 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970591459186806, 'loss_val': 0.07013750350367297, 'psi': 0.9974143291973844}-{'f1_val': 0.9972626935085508, 'auprc': 0.9970658345310377, 'loss_val': 0.08437956432552288, 'psi': 0.9971839499175457}
[S15] START round=24 head_norm_before_train=1.317282 cos_to_last_merge=0.9998 (last merge round=22)
[S15] round=24 local utility u=0.008318 metrics={'f1_val': 0.9905920476281491, 'auprc': 0.9916733456756149, 'loss_val': 0.12306080576171426, 'psi': 0.9910245668471355}-{'f1_val': 0.9921077193017869, 'auprc': 0.9898148507659205, 'loss_val': 0.1432159755211696, 'psi': 0.9911905718874403}
[S16] START round=24 head_norm_before_train=1.178813 cos_to_last_merge=0.9943 (last merge round=21)
[S16] round=24 local utility u=1.000000 metrics={'f1_val': 0.9923907950405445, 'auprc': 0.9933607775641016, 'loss_val': 0.15614247468245585, 'psi': 0.9927787880499674}-{'f1_val': 0.8195561669503213, 'auprc': 0.7750527158365523, 'loss_val': 0.8979347227469823, 'psi': 0.8017547865048137}
[S17] START round=24 head_norm_before_train=1.282358 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.213742 metrics={'f1_val': 0.42044062274072225, 'auprc': 0.8455035517469439, 'loss_val': 0.5953265357374415, 'psi': 0.5904657943432109}-{'f1_val': 0.3967643434577176, 'auprc': 0.8192821907901129, 'loss_val': 0.8020880642500289, 'psi': 0.5657714823906758}
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S16
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:36604
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.9710
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:36610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:36605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:36603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S7
[S5] cosine check vs S7: cos=0.5821
[S3] RECEIVED delta(kind=head bytes=1796) from S6
[S3] cosine check vs S6: cos=0.3729
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.9238
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7003 head_norm=1.208565
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.029480e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7003 head_norm=0.948032 delta_norm=0.502948
[S5] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] CommDone barrier timeout: have=1 need=2 — continuing
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9123 head_norm=1.109154
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.489074e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9176 head_norm=1.152213 delta_norm=0.148907
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] CommDone barrier timeout: have=1 need=3 — continuing
[S6] CommDone barrier timeout: have=1 need=2 — continuing
[S2] START round=25 head_norm_before_train=1.654521 cos_to_last_merge=0.9990 (last merge round=21)
[S2] round=25 local utility u=1.000000 metrics={'f1_val': 0.7014937575602418, 'auprc': 0.9351800184076535, 'loss_val': 0.280517218529396, 'psi': 0.7949682618992064}-{'f1_val': 0.5201885115732257, 'auprc': 0.7504615378766053, 'loss_val': 0.8266096054167374, 'psi': 0.6122977220945776}
[S3] START round=25 head_norm_before_train=1.656354 cos_to_last_merge=0.7872 (last merge round=1)
[S3] ⚠️ Model drifted since last merge! cos=0.787
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9351703544209241, 'auprc': 0.997019502002785, 'loss_val': 0.16651159353682607, 'psi': 0.9599100134536684}-{'f1_val': 0.9971302205031132, 'auprc': 0.9988004473047001, 'loss_val': 0.0671771098563142, 'psi': 0.997798311223748}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9352 head_norm=1.683123
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.200837e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9354 head_norm=1.173239 delta_norm=0.820084
[S3] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] START round=25 head_norm_before_train=1.152213 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.126381 metrics={'f1_val': 0.93960798759153, 'auprc': 0.966419701946044, 'loss_val': 0.2768293673578909, 'psi': 0.9503326733333356}-{'f1_val': 0.9122998044729033, 'auprc': 0.9716263294374159, 'loss_val': 0.38136137021241956, 'psi': 0.9360304144587084}
[S5] START round=25 head_norm_before_train=0.948032 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9445481660209709, 'loss_val': 0.5029789536739209, 'psi': 0.7981843020059929}-{'f1_val': 0.700320598491359, 'auprc': 0.992017556347489, 'loss_val': 0.3450229313249417, 'psi': 0.816999381633811}
[S6] START round=25 head_norm_before_train=1.124788 cos_to_last_merge=0.9861 (last merge round=21)
[S6] round=25 local utility u=0.696298 metrics={'f1_val': 0.9286530182559225, 'auprc': 0.9643118053257919, 'loss_val': 0.3607517734132133, 'psi': 0.9429165330838702}-{'f1_val': 0.7120226228407013, 'auprc': 0.9542117941740059, 'loss_val': 0.4232658629072884, 'psi': 0.8088982913740231}
[S7] START round=25 head_norm_before_train=0.918049 cos_to_last_merge=0.9845 (last merge round=21)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7003829420183394, 'loss_val': 0.8104855026323045, 'psi': 0.5301792476739497}-{'f1_val': 0.41683246609844005, 'auprc': 0.739140629315151, 'loss_val': 0.8419709291625631, 'psi': 0.5457557313851245}
[S8] START round=25 head_norm_before_train=1.881078 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=25 local utility u=0.036726 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.998034284133132, 'loss_val': 0.04270711929213226, 'psi': 0.9945124833262842}-{'f1_val': 0.9839092979549603, 'auprc': 0.9962105824669081, 'loss_val': 0.0611554267471233, 'psi': 0.9888298117597394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=25 head_norm_before_train=1.904746 cos_to_last_merge=0.9983 (last merge round=21)
[S9] round=25 local utility u=0.002800 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9988362439525893, 'loss_val': 0.05034789298194869, 'psi': 0.9938776026407707}-{'f1_val': 0.9905718417662249, 'auprc': 0.9987499679197694, 'loss_val': 0.05568961206753665, 'psi': 0.9938430922276428}
[S10] START round=25 head_norm_before_train=1.617025 cos_to_last_merge=0.7901 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.790
[S10] round=25 local utility u=0.001154 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9946785615657927, 'loss_val': 0.055974443760211275, 'psi': 0.9945888887053537}-{'f1_val': 0.9949509212940392, 'auprc': 0.9951264156228378, 'loss_val': 0.062157283502590734, 'psi': 0.9950211190255587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=25 head_norm_before_train=1.668606 cos_to_last_merge=0.9996 (last merge round=23)
[S11] round=25 local utility u=0.011432 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9980942157456156, 'loss_val': 0.08237147444132625, 'psi': 0.9973109162038649}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979373664167044, 'loss_val': 0.10331451820953025, 'psi': 0.9971031492748355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=25 head_norm_before_train=1.324969 cos_to_last_merge=0.9908 (last merge round=21)
[S13] round=25 local utility u=0.023548 metrics={'f1_val': 0.56123982465647, 'auprc': 0.6233234715580379, 'loss_val': 1.1051916979890586, 'psi': 0.5860732834170972}-{'f1_val': 0.5346482610483414, 'auprc': 0.6361856863301114, 'loss_val': 1.031325325023021, 'psi': 0.5752632311610494}
[S14] START round=25 head_norm_before_train=1.560652 cos_to_last_merge=0.7404 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.740
[S14] round=25 local utility u=0.002527 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9970657087354022, 'loss_val': 0.061633694308749494, 'psi': 0.9970699641959047}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970591459186806, 'loss_val': 0.07013750350367297, 'psi': 0.9974143291973844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=25 head_norm_before_train=1.354047 cos_to_last_merge=0.9989 (last merge round=22)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.9742281721908362, 'auprc': 0.989821839472976, 'loss_val': 0.11976744470632181, 'psi': 0.9804656391036921}-{'f1_val': 0.9905920476281491, 'auprc': 0.9916733456756149, 'loss_val': 0.12306080576171426, 'psi': 0.9910245668471355}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.212153 cos_to_last_merge=0.9907 (last merge round=21)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.967481772671087, 'auprc': 0.989780772253652, 'loss_val': 0.17862849867479172, 'psi': 0.976401372504113}-{'f1_val': 0.9923907950405445, 'auprc': 0.9933607775641016, 'loss_val': 0.15614247468245585, 'psi': 0.9927787880499674}
[S17] START round=25 head_norm_before_train=1.299995 cos_to_last_merge=0.9994 (last merge round=23)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.4191349662740309, 'auprc': 0.8450961211134194, 'loss_val': 0.5962170036709088, 'psi': 0.5895194282097863}-{'f1_val': 0.42044062274072225, 'auprc': 0.8455035517469439, 'loss_val': 0.5953265357374415, 'psi': 0.5904657943432109}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:36609
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:36612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:36617
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] ⇄ pheromone p=0.240 → S4@127.0.0.1:36604
[S5] ⇄ pheromone p=0.090 → S9@127.0.0.1:36610
[S17] RECEIVED delta(kind=head bytes=1798) from S13
[S17] cosine check vs S13: cos=0.9842
[S11] RECEIVED delta(kind=head bytes=1803) from S2
[S11] cosine check vs S2: cos=0.9958
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] cosine check vs S9: cos=0.9975
[S13] ⇄ pheromone p=0.106 → S17@127.0.0.1:36617
[S2] ⇄ pheromone p=0.264 → S11@127.0.0.1:36612
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9906 head_norm=1.925792
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.663020e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9906 head_norm=1.538575 delta_norm=0.466302
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.045 → S8@127.0.0.1:36609
[S7]  timeout peer S5
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S5]  timeout peer S9
[S2]  timeout peer S11
[S4]  timeout peer S2
[S4]  timeout peer S6
[S4]  timeout peer S15
[S6]  timeout peer S3
[S6]  timeout peer S7
[S6]  timeout peer S10
[S13]  timeout peer S17
[S16]  timeout peer S4
[S9]  timeout peer S8
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=1.668438 cos_to_last_merge=0.9984 (last merge round=21)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.713444139500043, 'auprc': 0.6997900292834538, 'loss_val': 0.3092559623788247, 'psi': 0.7079824954134073}-{'f1_val': 0.7014937575602418, 'auprc': 0.9351800184076535, 'loss_val': 0.280517218529396, 'psi': 0.7949682618992064}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.173239 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.065494 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.997069652146343, 'loss_val': 0.18981559983993365, 'psi': 0.9753441555717117}-{'f1_val': 0.9351703544209241, 'auprc': 0.997019502002785, 'loss_val': 0.16651159353682607, 'psi': 0.9599100134536684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=26 head_norm_before_train=1.192275 cos_to_last_merge=0.9995 (last merge round=24)
[S4] round=26 local utility u=0.040395 metrics={'f1_val': 0.9496966776963082, 'auprc': 0.957662375570073, 'loss_val': 0.23029866933463206, 'psi': 0.9528829568458141}-{'f1_val': 0.93960798759153, 'auprc': 0.966419701946044, 'loss_val': 0.2768293673578909, 'psi': 0.9503326733333356}
[S4] not sending this round → trigger blocked (psi=0.953)
[S5] START round=26 head_norm_before_train=0.990084 cos_to_last_merge=0.9972 (last merge round=24)
[S5] round=26 local utility u=0.131302 metrics={'f1_val': 0.700320598491359, 'auprc': 0.991008783348358, 'loss_val': 0.378029580828937, 'psi': 0.8165958724341587}-{'f1_val': 0.7006083926626743, 'auprc': 0.9445481660209709, 'loss_val': 0.5029789536739209, 'psi': 0.7981843020059929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=26 head_norm_before_train=1.157035 cos_to_last_merge=0.9783 (last merge round=21)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6262145611845996, 'auprc': 0.7896934432681386, 'loss_val': 0.5774540209406648, 'psi': 0.6916061140180152}-{'f1_val': 0.9286530182559225, 'auprc': 0.9643118053257919, 'loss_val': 0.3607517734132133, 'psi': 0.9429165330838702}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=0.941925 cos_to_last_merge=0.9776 (last merge round=21)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.37597927483581983, 'auprc': 0.786174737048046, 'loss_val': 0.8432574017498379, 'psi': 0.5400574597207103}-{'f1_val': 0.41671011811102343, 'auprc': 0.7003829420183394, 'loss_val': 0.8104855026323045, 'psi': 0.5301792476739497}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.891363 cos_to_last_merge=0.9999 (last merge round=23)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9932810269810869, 'auprc': 0.9873557793644194, 'loss_val': 0.05646409853552624, 'psi': 0.9909109279344199}-{'f1_val': 0.9921646161217188, 'auprc': 0.998034284133132, 'loss_val': 0.04270711929213226, 'psi': 0.9945124833262842}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9933 head_norm=1.900815
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.054082e-02
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9929 head_norm=1.912043 delta_norm=0.070541
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] START round=26 head_norm_before_train=1.538575 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.007855 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9979053191617273, 'loss_val': 0.07103178502002354, 'psi': 0.9974238751719766}-{'f1_val': 0.9905718417662249, 'auprc': 0.9988362439525893, 'loss_val': 0.05034789298194869, 'psi': 0.9938776026407707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=26 head_norm_before_train=1.643471 cos_to_last_merge=0.7869 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.787
[S10] round=26 local utility u=0.001271 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9966127111958467, 'loss_val': 0.0524069956999755, 'psi': 0.9946796946792332}-{'f1_val': 0.9945291067983943, 'auprc': 0.9946785615657927, 'loss_val': 0.055974443760211275, 'psi': 0.9945888887053537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=26 head_norm_before_train=1.696703 cos_to_last_merge=0.9986 (last merge round=23)
[S11] round=26 local utility u=0.004705 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981099376421351, 'loss_val': 0.07155749135091023, 'psi': 0.9971721777650078}-{'f1_val': 0.9967887165093644, 'auprc': 0.9980942157456156, 'loss_val': 0.08237147444132625, 'psi': 0.9973109162038649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9965 head_norm=1.724858
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.802187e-02
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9965 head_norm=1.694049 delta_norm=0.098022
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] START round=26 head_norm_before_train=1.349945 cos_to_last_merge=0.9866 (last merge round=21)
[S13] round=26 local utility u=0.109551 metrics={'f1_val': 0.5762506101966074, 'auprc': 0.6121674198411594, 'loss_val': 0.9426856822103934, 'psi': 0.5906173340544283}-{'f1_val': 0.56123982465647, 'auprc': 0.6233234715580379, 'loss_val': 1.1051916979890586, 'psi': 0.5860732834170972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=26 head_norm_before_train=1.591447 cos_to_last_merge=0.7355 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.736
[S14] round=26 local utility u=0.001258 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969679785130737, 'loss_val': 0.05837191845104799, 'psi': 0.9969856962998285}-{'f1_val': 0.9970728011695729, 'auprc': 0.9970657087354022, 'loss_val': 0.061633694308749494, 'psi': 0.9970699641959047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=26 head_norm_before_train=1.402714 cos_to_last_merge=0.9972 (last merge round=22)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9458703837100212, 'auprc': 0.9919405812202441, 'loss_val': 0.11975880466283155, 'psi': 0.9642984627141103}-{'f1_val': 0.9742281721908362, 'auprc': 0.989821839472976, 'loss_val': 0.11976744470632181, 'psi': 0.9804656391036921}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.245640 cos_to_last_merge=0.9872 (last merge round=21)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9412043316857326, 'auprc': 0.9910631682388527, 'loss_val': 0.21618315046377456, 'psi': 0.9611478663069806}-{'f1_val': 0.967481772671087, 'auprc': 0.989780772253652, 'loss_val': 0.17862849867479172, 'psi': 0.976401372504113}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.320814 cos_to_last_merge=0.9973 (last merge round=23)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.4187622450919144, 'auprc': 0.8450381603803125, 'loss_val': 0.6201559437485135, 'psi': 0.5892726112072737}-{'f1_val': 0.4191349662740309, 'auprc': 0.8450961211134194, 'loss_val': 0.5962170036709088, 'psi': 0.5895194282097863}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.4188 head_norm=1.341637
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.295264e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.4196 head_norm=1.339550 delta_norm=0.129526
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.681413 cos_to_last_merge=0.9978 (last merge round=21)
[S2] round=27 local utility u=0.363641 metrics={'f1_val': 0.7100393005050238, 'auprc': 0.9268057758963149, 'loss_val': 0.24259146590495134, 'psi': 0.7967458906615403}-{'f1_val': 0.713444139500043, 'auprc': 0.6997900292834538, 'loss_val': 0.3092559623788247, 'psi': 0.7079824954134073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=27 head_norm_before_train=1.208839 cos_to_last_merge=0.9994 (last merge round=25)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9400697270543387, 'auprc': 0.9972177698869282, 'loss_val': 0.2076382229137371, 'psi': 0.9629289441873745}-{'f1_val': 0.9608604911886242, 'auprc': 0.997069652146343, 'loss_val': 0.18981559983993365, 'psi': 0.9753441555717117}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.225272 cos_to_last_merge=0.9985 (last merge round=24)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9508626225694267, 'auprc': 0.9572103324112988, 'loss_val': 0.2568764472197072, 'psi': 0.9534017065061755}-{'f1_val': 0.9496966776963082, 'auprc': 0.957662375570073, 'loss_val': 0.23029866933463206, 'psi': 0.9528829568458141}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.049191 cos_to_last_merge=0.9880 (last merge round=24)
[S5] round=27 local utility u=0.036086 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9938145431941081, 'loss_val': 0.31427516357697904, 'psi': 0.8177181763724586}-{'f1_val': 0.700320598491359, 'auprc': 0.991008783348358, 'loss_val': 0.378029580828937, 'psi': 0.8165958724341587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] sending update (kind=head size=1791 to 1 peers)
[S6] START round=27 head_norm_before_train=1.188544 cos_to_last_merge=0.9696 (last merge round=21)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9583684375565886, 'auprc': 0.9767661576093843, 'loss_val': 0.2868978773472305, 'psi': 0.9657275255777069}-{'f1_val': 0.6262145611845996, 'auprc': 0.7896934432681386, 'loss_val': 0.5774540209406648, 'psi': 0.6916061140180152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=27 head_norm_before_train=0.961326 cos_to_last_merge=0.9720 (last merge round=21)
[S7] round=27 local utility u=0.115918 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.752292126597938, 'loss_val': 0.755376908317962, 'psi': 0.5510647089006498}-{'f1_val': 0.37597927483581983, 'auprc': 0.786174737048046, 'loss_val': 0.8432574017498379, 'psi': 0.5400574597207103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=27 head_norm_before_train=1.912043 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.010370 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9983286323795759, 'loss_val': 0.046812790868540136, 'psi': 0.9931170494362007}-{'f1_val': 0.9932810269810869, 'auprc': 0.9873557793644194, 'loss_val': 0.05646409853552624, 'psi': 0.9909109279344199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=27 head_norm_before_train=1.560924 cos_to_last_merge=0.9999 (last merge round=25)
[S9] round=27 local utility u=0.001417 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9953717255637474, 'loss_val': 0.06059696522548998, 'psi': 0.9964104377327847}-{'f1_val': 0.9971029125121428, 'auprc': 0.9979053191617273, 'loss_val': 0.07103178502002354, 'psi': 0.9974238751719766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=27 head_norm_before_train=1.671656 cos_to_last_merge=0.7838 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.784
[S10] round=27 local utility u=0.001644 metrics={'f1_val': 0.993391017001491, 'auprc': 0.996617290670308, 'loss_val': 0.04913280057508389, 'psi': 0.9946815264690178}-{'f1_val': 0.993391017001491, 'auprc': 0.9966127111958467, 'loss_val': 0.0524069956999755, 'psi': 0.9946796946792332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=27 head_norm_before_train=1.694049 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.001052 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978623582530725, 'loss_val': 0.0687099977173987, 'psi': 0.9970731460093827}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981099376421351, 'loss_val': 0.07155749135091023, 'psi': 0.9971721777650078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=27 head_norm_before_train=1.373789 cos_to_last_merge=0.9832 (last merge round=21)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.548689094886509, 'auprc': 0.6516431111771749, 'loss_val': 1.0651308048773023, 'psi': 0.5898707014027753}-{'f1_val': 0.5762506101966074, 'auprc': 0.6121674198411594, 'loss_val': 0.9426856822103934, 'psi': 0.5906173340544283}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.617313 cos_to_last_merge=0.7322 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.732
[S14] round=27 local utility u=0.004125 metrics={'f1_val': 0.9970198446089119, 'auprc': 0.9970635604890753, 'loss_val': 0.0505435879220069, 'psi': 0.9970373309609772}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969679785130737, 'loss_val': 0.05837191845104799, 'psi': 0.9969856962998285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=27 head_norm_before_train=1.454211 cos_to_last_merge=0.9949 (last merge round=22)
[S15] round=27 local utility u=0.184841 metrics={'f1_val': 0.9959270690537547, 'auprc': 0.995772860438356, 'loss_val': 0.06191389294365449, 'psi': 0.9958653856075952}-{'f1_val': 0.9458703837100212, 'auprc': 0.9919405812202441, 'loss_val': 0.11975880466283155, 'psi': 0.9642984627141103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=27 head_norm_before_train=1.281672 cos_to_last_merge=0.9833 (last merge round=21)
[S16] round=27 local utility u=0.215671 metrics={'f1_val': 0.9921723254558092, 'auprc': 0.994468174709487, 'loss_val': 0.10086471031786809, 'psi': 0.9930906651572804}-{'f1_val': 0.9412043316857326, 'auprc': 0.9910631682388527, 'loss_val': 0.21618315046377456, 'psi': 0.9611478663069806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=27 head_norm_before_train=1.339550 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.029736 metrics={'f1_val': 0.4198741668934173, 'auprc': 0.8550815924743691, 'loss_val': 0.5974864281176595, 'psi': 0.593957137125798}-{'f1_val': 0.4187622450919144, 'auprc': 0.8450381603803125, 'loss_val': 0.6201559437485135, 'psi': 0.5892726112072737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=28 head_norm_before_train=1.693769 cos_to_last_merge=0.9971 (last merge round=21)
[S2] round=28 local utility u=0.027102 metrics={'f1_val': 0.7229814587495024, 'auprc': 0.9221613891541836, 'loss_val': 0.2521079312745865, 'psi': 0.8026534309113749}-{'f1_val': 0.7100393005050238, 'auprc': 0.9268057758963149, 'loss_val': 0.24259146590495134, 'psi': 0.7967458906615403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=28 head_norm_before_train=1.252095 cos_to_last_merge=0.9976 (last merge round=25)
[S3] round=28 local utility u=0.100926 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9984988317890566, 'loss_val': 0.13590338244738936, 'psi': 0.9760686870563141}-{'f1_val': 0.9400697270543387, 'auprc': 0.9972177698869282, 'loss_val': 0.2076382229137371, 'psi': 0.9629289441873745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=28 head_norm_before_train=1.253740 cos_to_last_merge=0.9972 (last merge round=24)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9394405704610602, 'auprc': 0.9563790712063149, 'loss_val': 0.27337167220172204, 'psi': 0.9462159707591621}-{'f1_val': 0.9508626225694267, 'auprc': 0.9572103324112988, 'loss_val': 0.2568764472197072, 'psi': 0.9534017065061755}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.114071 cos_to_last_merge=0.9756 (last merge round=24)
[S5] round=28 local utility u=0.003965 metrics={'f1_val': 0.7003686869375041, 'auprc': 0.9889023670065409, 'loss_val': 0.2918967130956552, 'psi': 0.8157821589651189}-{'f1_val': 0.700320598491359, 'auprc': 0.9938145431941081, 'loss_val': 0.31427516357697904, 'psi': 0.8177181763724586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=28 head_norm_before_train=1.214509 cos_to_last_merge=0.9628 (last merge round=21)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6394787160614839, 'auprc': 0.7915500056868794, 'loss_val': 0.5790218541712348, 'psi': 0.7003072319116421}-{'f1_val': 0.9583684375565886, 'auprc': 0.9767661576093843, 'loss_val': 0.2868978773472305, 'psi': 0.9657275255777069}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=0.977628 cos_to_last_merge=0.9677 (last merge round=21)
[S7] round=28 local utility u=0.004119 metrics={'f1_val': 0.4180873189613038, 'auprc': 0.7767513550948271, 'loss_val': 0.8275629244145847, 'psi': 0.5615529334147131}-{'f1_val': 0.4169130971024577, 'auprc': 0.752292126597938, 'loss_val': 0.755376908317962, 'psi': 0.5510647089006498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=28 head_norm_before_train=1.921276 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=28 local utility u=0.010624 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9980685175576378, 'loss_val': 0.039915245838215305, 'psi': 0.9945261766960865}-{'f1_val': 0.9896426608072839, 'auprc': 0.9983286323795759, 'loss_val': 0.046812790868540136, 'psi': 0.9931170494362007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=28 head_norm_before_train=1.590127 cos_to_last_merge=0.9993 (last merge round=25)
[S9] round=28 local utility u=0.008547 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9988285323252827, 'loss_val': 0.0523721018155892, 'psi': 0.9976429641854674}-{'f1_val': 0.9971029125121428, 'auprc': 0.9953717255637474, 'loss_val': 0.06059696522548998, 'psi': 0.9964104377327847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=28 head_norm_before_train=1.694155 cos_to_last_merge=0.7817 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.782
[S10] round=28 local utility u=0.004533 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9941550289061675, 'loss_val': 0.04295430333587263, 'psi': 0.994724092408126}-{'f1_val': 0.993391017001491, 'auprc': 0.996617290670308, 'loss_val': 0.04913280057508389, 'psi': 0.9946815264690178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=28 head_norm_before_train=1.720855 cos_to_last_merge=0.9998 (last merge round=26)
[S11] round=28 local utility u=0.002871 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980765169136285, 'loss_val': 0.06361049636994517, 'psi': 0.9971588094736051}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978623582530725, 'loss_val': 0.0687099977173987, 'psi': 0.9970731460093827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=28 head_norm_before_train=1.390482 cos_to_last_merge=0.9803 (last merge round=21)
[S13] round=28 local utility u=0.125852 metrics={'f1_val': 0.5837713979731894, 'auprc': 0.6189436285459768, 'loss_val': 0.9258218243442289, 'psi': 0.5978402902023044}-{'f1_val': 0.548689094886509, 'auprc': 0.6516431111771749, 'loss_val': 1.0651308048773023, 'psi': 0.5898707014027753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=28 head_norm_before_train=1.639557 cos_to_last_merge=0.7302 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.730
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9413425745310523, 'auprc': 0.9970658170368539, 'loss_val': 0.09448837548754355, 'psi': 0.9636318715333729}-{'f1_val': 0.9970198446089119, 'auprc': 0.9970635604890753, 'loss_val': 0.0505435879220069, 'psi': 0.9970373309609772}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.502171 cos_to_last_merge=0.9924 (last merge round=22)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9311488223407176, 'auprc': 0.9951914871336178, 'loss_val': 0.09414202388765532, 'psi': 0.9567658882578777}-{'f1_val': 0.9959270690537547, 'auprc': 0.995772860438356, 'loss_val': 0.06191389294365449, 'psi': 0.9958653856075952}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.317650 cos_to_last_merge=0.9794 (last merge round=21)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8654172888607025, 'auprc': 0.9873129427525017, 'loss_val': 0.5415535264907244, 'psi': 0.9141755504174222}-{'f1_val': 0.9921723254558092, 'auprc': 0.994468174709487, 'loss_val': 0.10086471031786809, 'psi': 0.9930906651572804}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.358817 cos_to_last_merge=0.9990 (last merge round=26)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.4206067050544785, 'auprc': 0.8441757827659866, 'loss_val': 0.6385245665139826, 'psi': 0.5900343361390817}-{'f1_val': 0.4198741668934173, 'auprc': 0.8550815924743691, 'loss_val': 0.5974864281176595, 'psi': 0.593957137125798}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.706182 cos_to_last_merge=0.9961 (last merge round=21)
[S2] round=29 local utility u=0.202679 metrics={'f1_val': 0.8310110584572278, 'auprc': 0.8422048686853849, 'loss_val': 0.2550585730841413, 'psi': 0.8354885825484907}-{'f1_val': 0.7229814587495024, 'auprc': 0.9221613891541836, 'loss_val': 0.2521079312745865, 'psi': 0.8026534309113749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=29 head_norm_before_train=1.296950 cos_to_last_merge=0.9950 (last merge round=25)
[S3] round=29 local utility u=0.036402 metrics={'f1_val': 0.9705716454851786, 'auprc': 0.9986458674501484, 'loss_val': 0.12027917882058474, 'psi': 0.9818013342711664}-{'f1_val': 0.9611152572344858, 'auprc': 0.9984988317890566, 'loss_val': 0.13590338244738936, 'psi': 0.9760686870563141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=29 head_norm_before_train=1.272405 cos_to_last_merge=0.9961 (last merge round=24)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.938646486294227, 'auprc': 0.9271586122205697, 'loss_val': 0.2764702682353644, 'psi': 0.934051336664764}-{'f1_val': 0.9394405704610602, 'auprc': 0.9563790712063149, 'loss_val': 0.27337167220172204, 'psi': 0.9462159707591621}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.174751 cos_to_last_merge=0.9644 (last merge round=24)
[S5] round=29 local utility u=0.036562 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9972999845273163, 'loss_val': 0.24367784606949583, 'psi': 0.8191123529057419}-{'f1_val': 0.7003686869375041, 'auprc': 0.9889023670065409, 'loss_val': 0.2918967130956552, 'psi': 0.8157821589651189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=29 head_norm_before_train=1.238555 cos_to_last_merge=0.9569 (last merge round=21)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9661264707979955, 'auprc': 0.9872364284589517, 'loss_val': 0.23578069418923925, 'psi': 0.9745704538623781}-{'f1_val': 0.6394787160614839, 'auprc': 0.7915500056868794, 'loss_val': 0.5790218541712348, 'psi': 0.7003072319116421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=29 head_norm_before_train=0.988654 cos_to_last_merge=0.9641 (last merge round=21)
[S7] round=29 local utility u=0.832605 metrics={'f1_val': 0.6673886634745722, 'auprc': 0.7772529794604731, 'loss_val': 0.6596665745036089, 'psi': 0.7113343898689326}-{'f1_val': 0.4180873189613038, 'auprc': 0.7767513550948271, 'loss_val': 0.8275629244145847, 'psi': 0.5615529334147131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=29 head_norm_before_train=1.931112 cos_to_last_merge=0.9999 (last merge round=26)
[S8] round=29 local utility u=0.002350 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9980340196343079, 'loss_val': 0.03926916694586601, 'psi': 0.9949281792235509}-{'f1_val': 0.9921646161217188, 'auprc': 0.9980685175576378, 'loss_val': 0.039915245838215305, 'psi': 0.9945261766960865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=29 head_norm_before_train=1.618391 cos_to_last_merge=0.9985 (last merge round=25)
[S9] round=29 local utility u=0.002551 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9984295173362304, 'loss_val': 0.04607308880026441, 'psi': 0.9974833581898466}-{'f1_val': 0.9968525854255906, 'auprc': 0.9988285323252827, 'loss_val': 0.0523721018155892, 'psi': 0.9976429641854674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=29 head_norm_before_train=1.715588 cos_to_last_merge=0.7796 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.780
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.993924439075923, 'auprc': 0.9964848784321798, 'loss_val': 0.04603079092002908, 'psi': 0.9949486148184257}-{'f1_val': 0.9951034680760983, 'auprc': 0.9941550289061675, 'loss_val': 0.04295430333587263, 'psi': 0.994724092408126}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=1.748495 cos_to_last_merge=0.9990 (last merge round=26)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9961459728782474, 'loss_val': 0.06938392904326747, 'psi': 0.9963865918594527}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980765169136285, 'loss_val': 0.06361049636994517, 'psi': 0.9971588094736051}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=1.407260 cos_to_last_merge=0.9770 (last merge round=21)
[S13] round=29 local utility u=0.141505 metrics={'f1_val': 0.5828312036309939, 'auprc': 0.7062941037320156, 'loss_val': 0.8992211430246987, 'psi': 0.6322163636714027}-{'f1_val': 0.5837713979731894, 'auprc': 0.6189436285459768, 'loss_val': 0.9258218243442289, 'psi': 0.5978402902023044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=29 head_norm_before_train=1.660035 cos_to_last_merge=0.7281 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.728
[S14] round=29 local utility u=0.189346 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9968583108074918, 'loss_val': 0.05055968481161847, 'psi': 0.9970875383464726}-{'f1_val': 0.9413425745310523, 'auprc': 0.9970658170368539, 'loss_val': 0.09448837548754355, 'psi': 0.9636318715333729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=29 head_norm_before_train=1.544120 cos_to_last_merge=0.9898 (last merge round=22)
[S15] round=29 local utility u=0.222813 metrics={'f1_val': 0.9960847273356198, 'auprc': 0.9973898982273863, 'loss_val': 0.0447267929808512, 'psi': 0.9966067956923264}-{'f1_val': 0.9311488223407176, 'auprc': 0.9951914871336178, 'loss_val': 0.09414202388765532, 'psi': 0.9567658882578777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=29 head_norm_before_train=1.350579 cos_to_last_merge=0.9756 (last merge round=21)
[S16] round=29 local utility u=0.589650 metrics={'f1_val': 0.9859469326357586, 'auprc': 0.992453125400092, 'loss_val': 0.10085226507917575, 'psi': 0.988549409741492}-{'f1_val': 0.8654172888607025, 'auprc': 0.9873129427525017, 'loss_val': 0.5415535264907244, 'psi': 0.9141755504174222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=29 head_norm_before_train=1.379801 cos_to_last_merge=0.9964 (last merge round=26)
[S17] round=29 local utility u=0.025250 metrics={'f1_val': 0.42826720596868384, 'auprc': 0.8488978249064711, 'loss_val': 0.6481536157398572, 'psi': 0.5965194535437988}-{'f1_val': 0.4206067050544785, 'auprc': 0.8441757827659866, 'loss_val': 0.6385245665139826, 'psi': 0.5900343361390817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=30 head_norm_before_train=1.717318 cos_to_last_merge=0.9952 (last merge round=21)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.743300991344275, 'auprc': 0.7630831769075941, 'loss_val': 0.3211589416957677, 'psi': 0.7512138655696026}-{'f1_val': 0.8310110584572278, 'auprc': 0.8422048686853849, 'loss_val': 0.2550585730841413, 'psi': 0.8354885825484907}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.338327 cos_to_last_merge=0.9922 (last merge round=25)
[S3] round=30 local utility u=0.104252 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9985122908239692, 'loss_val': 0.07250834964079678, 'psi': 0.9978611939015223}-{'f1_val': 0.9705716454851786, 'auprc': 0.9986458674501484, 'loss_val': 0.12027917882058474, 'psi': 0.9818013342711664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=30 head_norm_before_train=1.290195 cos_to_last_merge=0.9950 (last merge round=24)
[S4] round=30 local utility u=0.071078 metrics={'f1_val': 0.9411359572608211, 'auprc': 0.9619789028337861, 'loss_val': 0.2537113399669047, 'psi': 0.9494731354900071}-{'f1_val': 0.938646486294227, 'auprc': 0.9271586122205697, 'loss_val': 0.2764702682353644, 'psi': 0.934051336664764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=30 head_norm_before_train=1.226158 cos_to_last_merge=0.9556 (last merge round=24)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7899319137104677, 'loss_val': 0.5380206455074272, 'psi': 0.7446528050567922}-{'f1_val': 0.700320598491359, 'auprc': 0.9972999845273163, 'loss_val': 0.24367784606949583, 'psi': 0.8191123529057419}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.258356 cos_to_last_merge=0.9522 (last merge round=21)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7190944042372328, 'auprc': 0.8102252830812015, 'loss_val': 0.4544773856092631, 'psi': 0.7555467557748203}-{'f1_val': 0.9661264707979955, 'auprc': 0.9872364284589517, 'loss_val': 0.23578069418923925, 'psi': 0.9745704538623781}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=0.999432 cos_to_last_merge=0.9610 (last merge round=21)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.419695011900997, 'auprc': 0.8200697506669108, 'loss_val': 0.8287152354046602, 'psi': 0.5798449074073625}-{'f1_val': 0.6673886634745722, 'auprc': 0.7772529794604731, 'loss_val': 0.6596665745036089, 'psi': 0.7113343898689326}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.941753 cos_to_last_merge=0.9999 (last merge round=26)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9839092979549603, 'auprc': 0.9964133310838323, 'loss_val': 0.05803061330957571, 'psi': 0.9889109112065091}-{'f1_val': 0.9928576189497129, 'auprc': 0.9980340196343079, 'loss_val': 0.03926916694586601, 'psi': 0.9949281792235509}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.644796 cos_to_last_merge=0.9974 (last merge round=25)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9984282738571171, 'loss_val': 0.04543915876459372, 'psi': 0.995985303060537}-{'f1_val': 0.9968525854255906, 'auprc': 0.9984295173362304, 'loss_val': 0.04607308880026441, 'psi': 0.9974833581898466}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.736176 cos_to_last_merge=0.7777 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.778
[S10] round=30 local utility u=0.004988 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9962358513769253, 'loss_val': 0.03974765801115885, 'psi': 0.99529297355642}-{'f1_val': 0.993924439075923, 'auprc': 0.9964848784321798, 'loss_val': 0.04603079092002908, 'psi': 0.9949486148184257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=30 head_norm_before_train=1.775082 cos_to_last_merge=0.9978 (last merge round=26)
[S11] round=30 local utility u=0.010008 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9972145939940189, 'loss_val': 0.052573973516605206, 'psi': 0.9968140403057613}-{'f1_val': 0.9965470045135896, 'auprc': 0.9961459728782474, 'loss_val': 0.06938392904326747, 'psi': 0.9963865918594527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=30 head_norm_before_train=1.420091 cos_to_last_merge=0.9747 (last merge round=21)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5848108849083291, 'auprc': 0.681980839902631, 'loss_val': 0.8742037458721078, 'psi': 0.6236788669060498}-{'f1_val': 0.5828312036309939, 'auprc': 0.7062941037320156, 'loss_val': 0.8992211430246987, 'psi': 0.6322163636714027}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.676064 cos_to_last_merge=0.7254 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.725
[S14] round=30 local utility u=0.002380 metrics={'f1_val': 0.9972657600632533, 'auprc': 0.9970476361254401, 'loss_val': 0.04652095446142372, 'psi': 0.997178510488128}-{'f1_val': 0.997240356705793, 'auprc': 0.9968583108074918, 'loss_val': 0.05055968481161847, 'psi': 0.9970875383464726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=30 head_norm_before_train=1.580835 cos_to_last_merge=0.9875 (last merge round=22)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9945428197223292, 'auprc': 0.9982518830458964, 'loss_val': 0.040598197784377024, 'psi': 0.9960264450517561}-{'f1_val': 0.9960847273356198, 'auprc': 0.9973898982273863, 'loss_val': 0.0447267929808512, 'psi': 0.9966067956923264}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.378104 cos_to_last_merge=0.9725 (last merge round=21)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9890036694477365, 'auprc': 0.9878703872561247, 'loss_val': 0.11090573425817563, 'psi': 0.9885503565710918}-{'f1_val': 0.9859469326357586, 'auprc': 0.992453125400092, 'loss_val': 0.10085226507917575, 'psi': 0.988549409741492}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.402897 cos_to_last_merge=0.9932 (last merge round=26)
[S17] round=30 local utility u=0.148599 metrics={'f1_val': 0.4750531189077751, 'auprc': 0.8616431779877859, 'loss_val': 0.6699062291660655, 'psi': 0.6296891425397794}-{'f1_val': 0.42826720596868384, 'auprc': 0.8488978249064711, 'loss_val': 0.6481536157398572, 'psi': 0.5965194535437988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=31 head_norm_before_train=1.730213 cos_to_last_merge=0.9939 (last merge round=21)
[S2] round=31 local utility u=0.526129 metrics={'f1_val': 0.8283907815121289, 'auprc': 0.9243734681438438, 'loss_val': 0.2633102504649191, 'psi': 0.8667838561648149}-{'f1_val': 0.743300991344275, 'auprc': 0.7630831769075941, 'loss_val': 0.3211589416957677, 'psi': 0.7512138655696026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=31 head_norm_before_train=1.375123 cos_to_last_merge=0.9895 (last merge round=25)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9983189452558607, 'loss_val': 0.1383747452055541, 'psi': 0.9756941385512176}-{'f1_val': 0.9974271292865575, 'auprc': 0.9985122908239692, 'loss_val': 0.07250834964079678, 'psi': 0.9978611939015223}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.304677 cos_to_last_merge=0.9941 (last merge round=24)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9382455475393349, 'auprc': 0.9379346603430397, 'loss_val': 0.26349444316128745, 'psi': 0.9381211926608168}-{'f1_val': 0.9411359572608211, 'auprc': 0.9619789028337861, 'loss_val': 0.2537113399669047, 'psi': 0.9494731354900071}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.265124 cos_to_last_merge=0.9493 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=31 local utility u=0.414400 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9911336981495693, 'loss_val': 0.22967572165817174, 'psi': 0.8168185148574323}-{'f1_val': 0.7144667326210086, 'auprc': 0.7899319137104677, 'loss_val': 0.5380206455074272, 'psi': 0.7446528050567922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=31 head_norm_before_train=1.279500 cos_to_last_merge=0.9474 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.9603334423887783, 'auprc': 0.9614824855891183, 'loss_val': 0.24131279835467745, 'psi': 0.9607930596689143}-{'f1_val': 0.7190944042372328, 'auprc': 0.8102252830812015, 'loss_val': 0.4544773856092631, 'psi': 0.7555467557748203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S7] START round=31 head_norm_before_train=1.009202 cos_to_last_merge=0.9580 (last merge round=21)
[S7] round=31 local utility u=0.375326 metrics={'f1_val': 0.5354853282236156, 'auprc': 0.8166521025632341, 'loss_val': 0.7625525057759325, 'psi': 0.647952037959463}-{'f1_val': 0.419695011900997, 'auprc': 0.8200697506669108, 'loss_val': 0.8287152354046602, 'psi': 0.5798449074073625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=31 head_norm_before_train=1.950072 cos_to_last_merge=0.9998 (last merge round=26)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.7562417624680171, 'auprc': 0.9840669277050325, 'loss_val': 0.20927356562099605, 'psi': 0.8473718285628232}-{'f1_val': 0.9839092979549603, 'auprc': 0.9964133310838323, 'loss_val': 0.05803061330957571, 'psi': 0.9889109112065091}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.670263 cos_to_last_merge=0.9963 (last merge round=25)
[S9] round=31 local utility u=0.013016 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.99873878359461, 'loss_val': 0.03681664574643851, 'psi': 0.9977572609451297}-{'f1_val': 0.994356655862817, 'auprc': 0.9984282738571171, 'loss_val': 0.04543915876459372, 'psi': 0.995985303060537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=31 head_norm_before_train=1.756546 cos_to_last_merge=0.7760 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.776
[S10] round=31 local utility u=0.000588 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9962543753090676, 'loss_val': 0.03862674817044812, 'psi': 0.9953003831292768}-{'f1_val': 0.9946643883427498, 'auprc': 0.9962358513769253, 'loss_val': 0.03974765801115885, 'psi': 0.99529297355642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=31 head_norm_before_train=1.800359 cos_to_last_merge=0.9963 (last merge round=26)
[S11] round=31 local utility u=0.007590 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9976223793195987, 'loss_val': 0.040066750256016095, 'psi': 0.9971221816334581}-{'f1_val': 0.9965470045135896, 'auprc': 0.9972145939940189, 'loss_val': 0.052573973516605206, 'psi': 0.9968140403057613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=31 head_norm_before_train=1.432428 cos_to_last_merge=0.9724 (last merge round=21)
[S13] round=31 local utility u=0.100529 metrics={'f1_val': 0.5904551076648485, 'auprc': 0.7125073673171316, 'loss_val': 0.7985905556319829, 'psi': 0.6392760115257617}-{'f1_val': 0.5848108849083291, 'auprc': 0.681980839902631, 'loss_val': 0.8742037458721078, 'psi': 0.6236788669060498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=31 head_norm_before_train=1.691633 cos_to_last_merge=0.7233 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.723
[S14] round=31 local utility u=0.002836 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9970128190338001, 'loss_val': 0.04059550047802639, 'psi': 0.9971496452677234}-{'f1_val': 0.9972657600632533, 'auprc': 0.9970476361254401, 'loss_val': 0.04652095446142372, 'psi': 0.997178510488128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=31 head_norm_before_train=1.615566 cos_to_last_merge=0.9853 (last merge round=22)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.8137825379633612, 'auprc': 0.9315862096836689, 'loss_val': 0.32261821711049155, 'psi': 0.8609040066514844}-{'f1_val': 0.9945428197223292, 'auprc': 0.9982518830458964, 'loss_val': 0.040598197784377024, 'psi': 0.9960264450517561}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.403964 cos_to_last_merge=0.9695 (last merge round=21)
[S16] round=31 local utility u=0.041646 metrics={'f1_val': 0.9926407240032312, 'auprc': 0.9934376607585965, 'loss_val': 0.06613869778640104, 'psi': 0.9929594987053774}-{'f1_val': 0.9890036694477365, 'auprc': 0.9878703872561247, 'loss_val': 0.11090573425817563, 'psi': 0.9885503565710918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=31 head_norm_before_train=1.428719 cos_to_last_merge=0.9897 (last merge round=26)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.4463444617514762, 'auprc': 0.8564317692818979, 'loss_val': 0.7360881592961592, 'psi': 0.6103793847636448}-{'f1_val': 0.4750531189077751, 'auprc': 0.8616431779877859, 'loss_val': 0.6699062291660655, 'psi': 0.6296891425397794}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.742993 cos_to_last_merge=0.9925 (last merge round=21)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.8329149912576829, 'auprc': 0.8395739561615481, 'loss_val': 0.253436022842017, 'psi': 0.835578577219229}-{'f1_val': 0.8283907815121289, 'auprc': 0.9243734681438438, 'loss_val': 0.2633102504649191, 'psi': 0.8667838561648149}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.415898 cos_to_last_merge=0.9865 (last merge round=25)
[S3] round=32 local utility u=0.153622 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9985123770753002, 'loss_val': 0.0526076432371612, 'psi': 0.9978612284020546}-{'f1_val': 0.9606109340814555, 'auprc': 0.9983189452558607, 'loss_val': 0.1383747452055541, 'psi': 0.9756941385512176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=32 head_norm_before_train=1.319092 cos_to_last_merge=0.9931 (last merge round=24)
[S4] round=32 local utility u=0.054143 metrics={'f1_val': 0.9403303900694051, 'auprc': 0.9721329104910892, 'loss_val': 0.27031132260335133, 'psi': 0.9530513982380787}-{'f1_val': 0.9382455475393349, 'auprc': 0.9379346603430397, 'loss_val': 0.26349444316128745, 'psi': 0.9381211926608168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=32 head_norm_before_train=1.295594 cos_to_last_merge=0.9444 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9901823322792953, 'loss_val': 0.22775480164314887, 'psi': 0.8164379685093227}-{'f1_val': 0.7006083926626743, 'auprc': 0.9911336981495693, 'loss_val': 0.22967572165817174, 'psi': 0.8168185148574323}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.299249 cos_to_last_merge=0.9431 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8221580007081091, 'auprc': 0.959523629261062, 'loss_val': 0.35239730362219496, 'psi': 0.8771042521292902}-{'f1_val': 0.9603334423887783, 'auprc': 0.9614824855891183, 'loss_val': 0.24131279835467745, 'psi': 0.9607930596689143}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.022004 cos_to_last_merge=0.9544 (last merge round=21)
[S7] round=32 local utility u=0.581357 metrics={'f1_val': 0.6634654257484509, 'auprc': 0.9076866519921869, 'loss_val': 0.6408222276550344, 'psi': 0.7611539162459453}-{'f1_val': 0.5354853282236156, 'auprc': 0.8166521025632341, 'loss_val': 0.7625525057759325, 'psi': 0.647952037959463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=32 head_norm_before_train=1.960359 cos_to_last_merge=0.9997 (last merge round=26)
[S8] round=32 local utility u=0.813828 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.998280658781139, 'loss_val': 0.03939483131891511, 'psi': 0.9945710068084715}-{'f1_val': 0.7562417624680171, 'auprc': 0.9840669277050325, 'loss_val': 0.20927356562099605, 'psi': 0.8473718285628232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=32 head_norm_before_train=1.694733 cos_to_last_merge=0.9951 (last merge round=25)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9988241268380801, 'loss_val': 0.037714353776098865, 'psi': 0.9961436442529222}-{'f1_val': 0.9971029125121428, 'auprc': 0.99873878359461, 'loss_val': 0.03681664574643851, 'psi': 0.9977572609451297}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.776076 cos_to_last_merge=0.7744 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.774
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9939487387271932, 'auprc': 0.9964875945508959, 'loss_val': 0.039803910114059454, 'psi': 0.9949642810566743}-{'f1_val': 0.9946643883427498, 'auprc': 0.9962543753090676, 'loss_val': 0.03862674817044812, 'psi': 0.9953003831292768}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.821795 cos_to_last_merge=0.9949 (last merge round=26)
[S11] round=32 local utility u=0.001536 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980531176319757, 'loss_val': 0.03683624103125619, 'psi': 0.997149449760944}-{'f1_val': 0.9967887165093644, 'auprc': 0.9976223793195987, 'loss_val': 0.040066750256016095, 'psi': 0.9971221816334581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=32 head_norm_before_train=1.446594 cos_to_last_merge=0.9699 (last merge round=21)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5804946287617785, 'auprc': 0.6555920115969035, 'loss_val': 0.9593623310498914, 'psi': 0.6105335818958285}-{'f1_val': 0.5904551076648485, 'auprc': 0.7125073673171316, 'loss_val': 0.7985905556319829, 'psi': 0.6392760115257617}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.706638 cos_to_last_merge=0.7213 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.721
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970641796061449, 'loss_val': 0.03942839860111009, 'psi': 0.997024176737057}-{'f1_val': 0.9972408627570057, 'auprc': 0.9970128190338001, 'loss_val': 0.04059550047802639, 'psi': 0.9971496452677234}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.646059 cos_to_last_merge=0.9833 (last merge round=22)
[S15] round=32 local utility u=0.778636 metrics={'f1_val': 0.9959606213387688, 'auprc': 0.9962985777963055, 'loss_val': 0.05255184666461188, 'psi': 0.9960958039217835}-{'f1_val': 0.8137825379633612, 'auprc': 0.9315862096836689, 'loss_val': 0.32261821711049155, 'psi': 0.8609040066514844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=32 head_norm_before_train=1.429183 cos_to_last_merge=0.9666 (last merge round=21)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9368185403259156, 'auprc': 0.9874581004752371, 'loss_val': 0.25876618083088676, 'psi': 0.9570743643856441}-{'f1_val': 0.9926407240032312, 'auprc': 0.9934376607585965, 'loss_val': 0.06613869778640104, 'psi': 0.9929594987053774}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.453912 cos_to_last_merge=0.9855 (last merge round=26)
[S17] round=32 local utility u=0.752117 metrics={'f1_val': 0.6746364917917422, 'auprc': 0.8676357108477556, 'loss_val': 0.6352185634053787, 'psi': 0.7518361794141475}-{'f1_val': 0.4463444617514762, 'auprc': 0.8564317692818979, 'loss_val': 0.7360881592961592, 'psi': 0.6103793847636448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=33 head_norm_before_train=1.758566 cos_to_last_merge=0.9907 (last merge round=21)
[S2] round=33 local utility u=0.094773 metrics={'f1_val': 0.8259126683905101, 'auprc': 0.927924348148295, 'loss_val': 0.286927769310941, 'psi': 0.8667173402936241}-{'f1_val': 0.8329149912576829, 'auprc': 0.8395739561615481, 'loss_val': 0.253436022842017, 'psi': 0.835578577219229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=33 head_norm_before_train=1.452226 cos_to_last_merge=0.9836 (last merge round=25)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9985053492803376, 'loss_val': 0.11298048265909513, 'psi': 0.9760712940528264}-{'f1_val': 0.9974271292865575, 'auprc': 0.9985123770753002, 'loss_val': 0.0526076432371612, 'psi': 0.9978612284020546}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.332950 cos_to_last_merge=0.9921 (last merge round=24)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9383354465443027, 'auprc': 0.9445792332781142, 'loss_val': 0.27599784025754376, 'psi': 0.9408329612378272}-{'f1_val': 0.9403303900694051, 'auprc': 0.9721329104910892, 'loss_val': 0.27031132260335133, 'psi': 0.9530513982380787}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.320742 cos_to_last_merge=0.9405 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=33 local utility u=0.020977 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9978617877850327, 'loss_val': 0.2071164675481395, 'psi': 0.8193375055743612}-{'f1_val': 0.7006083926626743, 'auprc': 0.9901823322792953, 'loss_val': 0.22775480164314887, 'psi': 0.8164379685093227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=33 head_norm_before_train=1.320297 cos_to_last_merge=0.9385 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6171574079456745, 'auprc': 0.7925802106906941, 'loss_val': 0.6446236200692684, 'psi': 0.6873265290436823}-{'f1_val': 0.8221580007081091, 'auprc': 0.959523629261062, 'loss_val': 0.35239730362219496, 'psi': 0.8771042521292902}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.033940 cos_to_last_merge=0.9509 (last merge round=21)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.4835093555456904, 'auprc': 0.7864135071069882, 'loss_val': 0.8375788433423879, 'psi': 0.6046710161702096}-{'f1_val': 0.6634654257484509, 'auprc': 0.9076866519921869, 'loss_val': 0.6408222276550344, 'psi': 0.7611539162459453}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.970105 cos_to_last_merge=0.9996 (last merge round=26)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9253320557115503, 'auprc': 0.9963262742943313, 'loss_val': 0.1479154798524236, 'psi': 0.9537297431446626}-{'f1_val': 0.9920979054933599, 'auprc': 0.998280658781139, 'loss_val': 0.03939483131891511, 'psi': 0.9945710068084715}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.716320 cos_to_last_merge=0.9939 (last merge round=25)
[S9] round=33 local utility u=0.000590 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9988254147743473, 'loss_val': 0.03653873220785315, 'psi': 0.9961441594274292}-{'f1_val': 0.994356655862817, 'auprc': 0.9988241268380801, 'loss_val': 0.037714353776098865, 'psi': 0.9961436442529222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=33 head_norm_before_train=1.788979 cos_to_last_merge=0.7736 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.774
[S10] round=33 local utility u=0.000667 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9931773190689084, 'loss_val': 0.03678601809424259, 'psi': 0.9944647999658016}-{'f1_val': 0.9939487387271932, 'auprc': 0.9964875945508959, 'loss_val': 0.039803910114059454, 'psi': 0.9949642810566743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=33 head_norm_before_train=1.841399 cos_to_last_merge=0.9936 (last merge round=26)
[S11] round=33 local utility u=0.000404 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980018308854801, 'loss_val': 0.03587345199603352, 'psi': 0.9971289350623458}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980531176319757, 'loss_val': 0.03683624103125619, 'psi': 0.997149449760944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=33 head_norm_before_train=1.462394 cos_to_last_merge=0.9674 (last merge round=21)
[S13] round=33 local utility u=0.257861 metrics={'f1_val': 0.6132876728881367, 'auprc': 0.7051906746909167, 'loss_val': 0.7891937134136757, 'psi': 0.6500488736092487}-{'f1_val': 0.5804946287617785, 'auprc': 0.6555920115969035, 'loss_val': 0.9593623310498914, 'psi': 0.6105335818958285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=33 head_norm_before_train=1.721561 cos_to_last_merge=0.7194 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.719
[S14] round=33 local utility u=0.001496 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970636982642922, 'loss_val': 0.03643423321798784, 'psi': 0.9970239842003159}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970641796061449, 'loss_val': 0.03942839860111009, 'psi': 0.997024176737057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=33 head_norm_before_train=1.672568 cos_to_last_merge=0.9817 (last merge round=22)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.9139522216096773, 'auprc': 0.9960664859049783, 'loss_val': 0.09697042778665842, 'psi': 0.9467979273277977}-{'f1_val': 0.9959606213387688, 'auprc': 0.9962985777963055, 'loss_val': 0.05255184666461188, 'psi': 0.9960958039217835}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.452575 cos_to_last_merge=0.9639 (last merge round=21)
[S16] round=33 local utility u=0.029475 metrics={'f1_val': 0.939740479559922, 'auprc': 0.9892583911045033, 'loss_val': 0.22274935141359564, 'psi': 0.9595476441777545}-{'f1_val': 0.9368185403259156, 'auprc': 0.9874581004752371, 'loss_val': 0.25876618083088676, 'psi': 0.9570743643856441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=33 head_norm_before_train=1.472444 cos_to_last_merge=0.9820 (last merge round=26)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5490392450090441, 'auprc': 0.8429067583535579, 'loss_val': 0.7141030371847074, 'psi': 0.6665862503468496}-{'f1_val': 0.6746364917917422, 'auprc': 0.8676357108477556, 'loss_val': 0.6352185634053787, 'psi': 0.7518361794141475}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.771742 cos_to_last_merge=0.9891 (last merge round=21)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6615241613382983, 'auprc': 0.78914978577839, 'loss_val': 0.6425061854353987, 'psi': 0.7125744111143351}-{'f1_val': 0.8259126683905101, 'auprc': 0.927924348148295, 'loss_val': 0.286927769310941, 'psi': 0.8667173402936241}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.480110 cos_to_last_merge=0.9812 (last merge round=25)
[S3] round=34 local utility u=0.139787 metrics={'f1_val': 0.9971279671228781, 'auprc': 0.9985114235270082, 'loss_val': 0.049500869171020354, 'psi': 0.9976813496845301}-{'f1_val': 0.9611152572344858, 'auprc': 0.9985053492803376, 'loss_val': 0.11298048265909513, 'psi': 0.9760712940528264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=34 head_norm_before_train=1.347270 cos_to_last_merge=0.9910 (last merge round=24)
[S4] round=34 local utility u=0.023766 metrics={'f1_val': 0.9386962052752474, 'auprc': 0.9592207455755997, 'loss_val': 0.2745548914615611, 'psi': 0.9469060213953883}-{'f1_val': 0.9383354465443027, 'auprc': 0.9445792332781142, 'loss_val': 0.27599784025754376, 'psi': 0.9408329612378272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=34 head_norm_before_train=1.340717 cos_to_last_merge=0.9377 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.938
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7940607225266577, 'loss_val': 0.5396778865164714, 'psi': 0.7463043285832682}-{'f1_val': 0.7003213174339138, 'auprc': 0.9978617877850327, 'loss_val': 0.2071164675481395, 'psi': 0.8193375055743612}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.342501 cos_to_last_merge=0.9339 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.8291569176465962, 'auprc': 0.9747308670273375, 'loss_val': 0.3080167695046574, 'psi': 0.8873864973988926}-{'f1_val': 0.6171574079456745, 'auprc': 0.7925802106906941, 'loss_val': 0.6446236200692684, 'psi': 0.6873265290436823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=34 head_norm_before_train=1.045897 cos_to_last_merge=0.9476 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=34 local utility u=0.178051 metrics={'f1_val': 0.529893587306289, 'auprc': 0.7912289921583566, 'loss_val': 0.7742296665189532, 'psi': 0.634427749247116}-{'f1_val': 0.4835093555456904, 'auprc': 0.7864135071069882, 'loss_val': 0.8375788433423879, 'psi': 0.6046710161702096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=34 head_norm_before_train=1.980744 cos_to_last_merge=0.9995 (last merge round=26)
[S8] round=34 local utility u=0.260002 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9973804036683775, 'loss_val': 0.03709184039944933, 'psi': 0.9947532361590234}-{'f1_val': 0.9253320557115503, 'auprc': 0.9963262742943313, 'loss_val': 0.1479154798524236, 'psi': 0.9537297431446626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=34 head_norm_before_train=1.733298 cos_to_last_merge=0.9930 (last merge round=25)
[S9] round=34 local utility u=0.005747 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9988188100426916, 'loss_val': 0.032517541182540646, 'psi': 0.9968907908139768}-{'f1_val': 0.994356655862817, 'auprc': 0.9988254147743473, 'loss_val': 0.03653873220785315, 'psi': 0.9961441594274292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=34 head_norm_before_train=1.803431 cos_to_last_merge=0.7726 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.773
[S10] round=34 local utility u=0.000489 metrics={'f1_val': 0.9939487387271932, 'auprc': 0.9965420661098389, 'loss_val': 0.03765554027357446, 'psi': 0.9949860696802515}-{'f1_val': 0.9953231205637304, 'auprc': 0.9931773190689084, 'loss_val': 0.03678601809424259, 'psi': 0.9944647999658016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=34 head_norm_before_train=1.858206 cos_to_last_merge=0.9925 (last merge round=26)
[S11] round=34 local utility u=0.000313 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978869986638265, 'loss_val': 0.0349036803212424, 'psi': 0.9970830021736843}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980018308854801, 'loss_val': 0.03587345199603352, 'psi': 0.9971289350623458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=34 head_norm_before_train=1.477975 cos_to_last_merge=0.9650 (last merge round=21)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6235719849874493, 'auprc': 0.7153906277701046, 'loss_val': 0.9988969835999124, 'psi': 0.6602994421005115}-{'f1_val': 0.6132876728881367, 'auprc': 0.7051906746909167, 'loss_val': 0.7891937134136757, 'psi': 0.6500488736092487}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.739028 cos_to_last_merge=0.7177 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.718
[S14] round=34 local utility u=0.002702 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9970645574005547, 'loss_val': 0.033496719547152984, 'psi': 0.9972707846612572}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970636982642922, 'loss_val': 0.03643423321798784, 'psi': 0.9970239842003159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=34 head_norm_before_train=1.695100 cos_to_last_merge=0.9802 (last merge round=22)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8983932670009406, 'auprc': 0.9952006650443097, 'loss_val': 0.22220663761926146, 'psi': 0.9371162262182882}-{'f1_val': 0.9139522216096773, 'auprc': 0.9960664859049783, 'loss_val': 0.09697042778665842, 'psi': 0.9467979273277977}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.474332 cos_to_last_merge=0.9614 (last merge round=21)
[S16] round=34 local utility u=0.249251 metrics={'f1_val': 0.9926407240032312, 'auprc': 0.994453693832396, 'loss_val': 0.057235385166815096, 'psi': 0.9933659119348972}-{'f1_val': 0.939740479559922, 'auprc': 0.9892583911045033, 'loss_val': 0.22274935141359564, 'psi': 0.9595476441777545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=34 head_norm_before_train=1.490710 cos_to_last_merge=0.9786 (last merge round=26)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.42937169106596973, 'auprc': 0.7101640744971239, 'loss_val': 0.8067394759821639, 'psi': 0.5416886444384315}-{'f1_val': 0.5490392450090441, 'auprc': 0.8429067583535579, 'loss_val': 0.7141030371847074, 'psi': 0.6665862503468496}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.783898 cos_to_last_merge=0.9873 (last merge round=21)
[S2] round=35 local utility u=0.833910 metrics={'f1_val': 0.8274210466869565, 'auprc': 0.9060364217684975, 'loss_val': 0.32072789068288765, 'psi': 0.8588671967195729}-{'f1_val': 0.6615241613382983, 'auprc': 0.78914978577839, 'loss_val': 0.6425061854353987, 'psi': 0.7125744111143351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=35 head_norm_before_train=1.508958 cos_to_last_merge=0.9788 (last merge round=25)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9805778274355272, 'auprc': 0.9985033449008915, 'loss_val': 0.06640598350588844, 'psi': 0.9877480344216729}-{'f1_val': 0.9971279671228781, 'auprc': 0.9985114235270082, 'loss_val': 0.049500869171020354, 'psi': 0.9976813496845301}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.363507 cos_to_last_merge=0.9901 (last merge round=24)
[S4] round=35 local utility u=0.051683 metrics={'f1_val': 0.9473757753167805, 'auprc': 0.970985980308877, 'loss_val': 0.2585629248686409, 'psi': 0.9568198573136191}-{'f1_val': 0.9386962052752474, 'auprc': 0.9592207455755997, 'loss_val': 0.2745548914615611, 'psi': 0.9469060213953883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=35 head_norm_before_train=1.354713 cos_to_last_merge=0.9357 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=35 local utility u=0.443417 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9976782165996427, 'loss_val': 0.17882415702147222, 'psi': 0.8192640771002053}-{'f1_val': 0.7144667326210086, 'auprc': 0.7940607225266577, 'loss_val': 0.5396778865164714, 'psi': 0.7463043285832682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=35 head_norm_before_train=1.359846 cos_to_last_merge=0.9304 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=35 local utility u=0.560177 metrics={'f1_val': 0.9853772279611392, 'auprc': 0.9828132906301055, 'loss_val': 0.14923205511814516, 'psi': 0.9843516530287257}-{'f1_val': 0.8291569176465962, 'auprc': 0.9747308670273375, 'loss_val': 0.3080167695046574, 'psi': 0.8873864973988926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=35 head_norm_before_train=1.059564 cos_to_last_merge=0.9440 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.39103686737511234, 'auprc': 0.7779459784338412, 'loss_val': 0.9862741719267675, 'psi': 0.5458005117986039}-{'f1_val': 0.529893587306289, 'auprc': 0.7912289921583566, 'loss_val': 0.7742296665189532, 'psi': 0.634427749247116}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.987948 cos_to_last_merge=0.9994 (last merge round=26)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.7138880036303916, 'auprc': 0.9774947410744975, 'loss_val': 0.5769530079509287, 'psi': 0.819330698608034}-{'f1_val': 0.9930017911527874, 'auprc': 0.9973804036683775, 'loss_val': 0.03709184039944933, 'psi': 0.9947532361590234}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.749288 cos_to_last_merge=0.9921 (last merge round=25)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9914992806135696, 'loss_val': 0.030259171646954172, 'psi': 0.9946152070042852}-{'f1_val': 0.9956054446615002, 'auprc': 0.9988188100426916, 'loss_val': 0.032517541182540646, 'psi': 0.9968907908139768}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.817940 cos_to_last_merge=0.7715 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.771
[S10] round=35 local utility u=0.001410 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9945395469592988, 'loss_val': 0.03443867899575586, 'psi': 0.9947461532419563}-{'f1_val': 0.9939487387271932, 'auprc': 0.9965420661098389, 'loss_val': 0.03765554027357446, 'psi': 0.9949860696802515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=35 head_norm_before_train=1.875508 cos_to_last_merge=0.9912 (last merge round=26)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.8553387703884088, 'auprc': 0.9950456957138557, 'loss_val': 0.1714963204045537, 'psi': 0.9112215405185875}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978869986638265, 'loss_val': 0.0349036803212424, 'psi': 0.9970830021736843}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.490652 cos_to_last_merge=0.9629 (last merge round=21)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5902091700562725, 'auprc': 0.7330387296709227, 'loss_val': 0.8586035493845708, 'psi': 0.6473409939021326}-{'f1_val': 0.6235719849874493, 'auprc': 0.7153906277701046, 'loss_val': 0.9988969835999124, 'psi': 0.6602994421005115}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.756452 cos_to_last_merge=0.7163 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.716
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9967978174134032, 'loss_val': 0.034970402613143055, 'psi': 0.9968104705980536}-{'f1_val': 0.9974082695017256, 'auprc': 0.9970645574005547, 'loss_val': 0.033496719547152984, 'psi': 0.9972707846612572}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.714369 cos_to_last_merge=0.9790 (last merge round=22)
[S15] round=35 local utility u=0.352384 metrics={'f1_val': 0.9900235186721312, 'auprc': 0.992322685005903, 'loss_val': 0.05858645774083827, 'psi': 0.99094318520564}-{'f1_val': 0.8983932670009406, 'auprc': 0.9952006650443097, 'loss_val': 0.22220663761926146, 'psi': 0.9371162262182882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=35 head_norm_before_train=1.492972 cos_to_last_merge=0.9594 (last merge round=21)
[S16] round=35 local utility u=0.005244 metrics={'f1_val': 0.9922436405801754, 'auprc': 0.9972145676743608, 'loss_val': 0.052646847508090455, 'psi': 0.9942320114178496}-{'f1_val': 0.9926407240032312, 'auprc': 0.994453693832396, 'loss_val': 0.057235385166815096, 'psi': 0.9933659119348972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=35 head_norm_before_train=1.507780 cos_to_last_merge=0.9758 (last merge round=26)
[S17] round=35 local utility u=0.973687 metrics={'f1_val': 0.6571526638222502, 'auprc': 0.8533801976893701, 'loss_val': 0.6556998644363632, 'psi': 0.7356436773690982}-{'f1_val': 0.42937169106596973, 'auprc': 0.7101640744971239, 'loss_val': 0.8067394759821639, 'psi': 0.5416886444384315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=36 head_norm_before_train=1.795090 cos_to_last_merge=0.9858 (last merge round=21)
[S2] round=36 local utility u=0.000694 metrics={'f1_val': 0.8280156315309264, 'auprc': 0.9025969955348304, 'loss_val': 0.3125893599863677, 'psi': 0.857848177132488}-{'f1_val': 0.8274210466869565, 'auprc': 0.9060364217684975, 'loss_val': 0.32072789068288765, 'psi': 0.8588671967195729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=36 head_norm_before_train=1.537305 cos_to_last_merge=0.9763 (last merge round=25)
[S3] round=36 local utility u=0.026336 metrics={'f1_val': 0.9866128927318738, 'auprc': 0.998505084265857, 'loss_val': 0.049950240233934864, 'psi': 0.9913697693454672}-{'f1_val': 0.9805778274355272, 'auprc': 0.9985033449008915, 'loss_val': 0.06640598350588844, 'psi': 0.9877480344216729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=36 head_norm_before_train=1.378246 cos_to_last_merge=0.9892 (last merge round=24)
[S4] round=36 local utility u=0.005939 metrics={'f1_val': 0.9513797916876384, 'auprc': 0.9668676671064858, 'loss_val': 0.2583543019901875, 'psi': 0.9575749418551773}-{'f1_val': 0.9473757753167805, 'auprc': 0.970985980308877, 'loss_val': 0.2585629248686409, 'psi': 0.9568198573136191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=36 head_norm_before_train=1.365358 cos_to_last_merge=0.9343 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7048687643572322, 'auprc': 0.9471802724182461, 'loss_val': 0.2728257568614385, 'psi': 0.8017933675816378}-{'f1_val': 0.7003213174339138, 'auprc': 0.9976782165996427, 'loss_val': 0.17882415702147222, 'psi': 0.8192640771002053}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.374369 cos_to_last_merge=0.9279 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.7265269972399734, 'auprc': 0.9091010536904595, 'loss_val': 0.5468425385901898, 'psi': 0.7995566198201678}-{'f1_val': 0.9853772279611392, 'auprc': 0.9828132906301055, 'loss_val': 0.14923205511814516, 'psi': 0.9843516530287257}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.075773 cos_to_last_merge=0.9398 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.6683706491069941, 'auprc': 0.8359459363683602, 'loss_val': 0.5719870019173163, 'psi': 0.7354007640115405}-{'f1_val': 0.39103686737511234, 'auprc': 0.7779459784338412, 'loss_val': 0.9862741719267675, 'psi': 0.5458005117986039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=36 head_norm_before_train=1.991971 cos_to_last_merge=0.9994 (last merge round=26)
[S8] round=36 local utility u=1.000000 metrics={'f1_val': 0.9933514266435809, 'auprc': 0.9952508328912381, 'loss_val': 0.035637791578588644, 'psi': 0.9941111891426437}-{'f1_val': 0.7138880036303916, 'auprc': 0.9774947410744975, 'loss_val': 0.5769530079509287, 'psi': 0.819330698608034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=36 head_norm_before_train=1.763261 cos_to_last_merge=0.9913 (last merge round=25)
[S9] round=36 local utility u=0.013096 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985361662926706, 'loss_val': 0.027640431796246194, 'psi': 0.9976762140243539}-{'f1_val': 0.9966924912647621, 'auprc': 0.9914992806135696, 'loss_val': 0.030259171646954172, 'psi': 0.9946152070042852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=36 head_norm_before_train=1.832254 cos_to_last_merge=0.7704 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.770
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9939487387271932, 'auprc': 0.9965548507962891, 'loss_val': 0.037168011227984604, 'psi': 0.9949911835548315}-{'f1_val': 0.9948838907637279, 'auprc': 0.9945395469592988, 'loss_val': 0.03443867899575586, 'psi': 0.9947461532419563}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.893248 cos_to_last_merge=0.9898 (last merge round=26)
[S11] round=36 local utility u=0.189858 metrics={'f1_val': 0.9098430822153789, 'auprc': 0.9958814021147673, 'loss_val': 0.12131300579973701, 'psi': 0.9442584101751343}-{'f1_val': 0.8553387703884088, 'auprc': 0.9950456957138557, 'loss_val': 0.1714963204045537, 'psi': 0.9112215405185875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=36 head_norm_before_train=1.502647 cos_to_last_merge=0.9610 (last merge round=21)
[S13] round=36 local utility u=0.009911 metrics={'f1_val': 0.6067464894804996, 'auprc': 0.7125208268950141, 'loss_val': 0.8764522075144233, 'psi': 0.6490562244463054}-{'f1_val': 0.5902091700562725, 'auprc': 0.7330387296709227, 'loss_val': 0.8586035493845708, 'psi': 0.6473409939021326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=36 head_norm_before_train=1.772279 cos_to_last_merge=0.7147 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.715
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9955294726206314, 'loss_val': 0.039343934615024376, 'psi': 0.9959081303231767}-{'f1_val': 0.9968189060544872, 'auprc': 0.9967978174134032, 'loss_val': 0.034970402613143055, 'psi': 0.9968104705980536}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.732700 cos_to_last_merge=0.9778 (last merge round=22)
[S15] round=36 local utility u=0.042510 metrics={'f1_val': 0.9960143947672967, 'auprc': 0.9983051081756522, 'loss_val': 0.027459658145706743, 'psi': 0.9969306801306389}-{'f1_val': 0.9900235186721312, 'auprc': 0.992322685005903, 'loss_val': 0.05858645774083827, 'psi': 0.99094318520564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=36 head_norm_before_train=1.510323 cos_to_last_merge=0.9575 (last merge round=21)
[S16] round=36 local utility u=0.000518 metrics={'f1_val': 0.9924624549696315, 'auprc': 0.996560000039191, 'loss_val': 0.05095939633643433, 'psi': 0.9941014729974553}-{'f1_val': 0.9922436405801754, 'auprc': 0.9972145676743608, 'loss_val': 0.052646847508090455, 'psi': 0.9942320114178496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=36 head_norm_before_train=1.522356 cos_to_last_merge=0.9733 (last merge round=26)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5732797547452337, 'auprc': 0.8137126000086183, 'loss_val': 0.7748862057551412, 'psi': 0.6694528928505876}-{'f1_val': 0.6571526638222502, 'auprc': 0.8533801976893701, 'loss_val': 0.6556998644363632, 'psi': 0.7356436773690982}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.805320 cos_to_last_merge=0.9844 (last merge round=21)
[S2] round=37 local utility u=0.040929 metrics={'f1_val': 0.8307209159257842, 'auprc': 0.9165287428456392, 'loss_val': 0.2887589188315899, 'psi': 0.8650440466937261}-{'f1_val': 0.8280156315309264, 'auprc': 0.9025969955348304, 'loss_val': 0.3125893599863677, 'psi': 0.857848177132488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=37 head_norm_before_train=1.566108 cos_to_last_merge=0.9739 (last merge round=25)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9808691885975782, 'auprc': 0.9985008189908551, 'loss_val': 0.05843943017879682, 'psi': 0.987921840754889}-{'f1_val': 0.9866128927318738, 'auprc': 0.998505084265857, 'loss_val': 0.049950240233934864, 'psi': 0.9913697693454672}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.387953 cos_to_last_merge=0.9885 (last merge round=24)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9347817117873845, 'auprc': 0.942057399377662, 'loss_val': 0.28252563907387274, 'psi': 0.9376919868234955}-{'f1_val': 0.9513797916876384, 'auprc': 0.9668676671064858, 'loss_val': 0.2583543019901875, 'psi': 0.9575749418551773}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.377008 cos_to_last_merge=0.9327 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7118866270877238, 'auprc': 0.8877814253744944, 'loss_val': 0.35401546807243267, 'psi': 0.7822445464024321}-{'f1_val': 0.7048687643572322, 'auprc': 0.9471802724182461, 'loss_val': 0.2728257568614385, 'psi': 0.8017933675816378}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.389327 cos_to_last_merge=0.9251 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.925
[S6] round=37 local utility u=0.941252 metrics={'f1_val': 0.9597554053592215, 'auprc': 0.9614257629192879, 'loss_val': 0.22068229814023999, 'psi': 0.9604235483832481}-{'f1_val': 0.7265269972399734, 'auprc': 0.9091010536904595, 'loss_val': 0.5468425385901898, 'psi': 0.7995566198201678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=37 head_norm_before_train=1.089606 cos_to_last_merge=0.9364 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.525781930739879, 'auprc': 0.7857831408088445, 'loss_val': 0.7937968921271531, 'psi': 0.6297824147674651}-{'f1_val': 0.6683706491069941, 'auprc': 0.8359459363683602, 'loss_val': 0.5719870019173163, 'psi': 0.7354007640115405}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.993878 cos_to_last_merge=0.9993 (last merge round=26)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9984632101720534, 'loss_val': 0.038122422139615836, 'psi': 0.9944718647665272}-{'f1_val': 0.9933514266435809, 'auprc': 0.9952508328912381, 'loss_val': 0.035637791578588644, 'psi': 0.9941111891426437}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.776586 cos_to_last_merge=0.9905 (last merge round=25)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9985208119050202, 'loss_val': 0.04015113024640465, 'psi': 0.9939016260736744}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985361662926706, 'loss_val': 0.027640431796246194, 'psi': 0.9976762140243539}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.844132 cos_to_last_merge=0.7696 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.770
[S10] round=37 local utility u=0.001740 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9961420127591727, 'loss_val': 0.034110030346575226, 'psi': 0.9949921693284507}-{'f1_val': 0.9939487387271932, 'auprc': 0.9965548507962891, 'loss_val': 0.037168011227984604, 'psi': 0.9949911835548315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=37 head_norm_before_train=1.910451 cos_to_last_merge=0.9885 (last merge round=26)
[S11] round=37 local utility u=0.304210 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9968244486699687, 'loss_val': 0.03346472889531961, 'psi': 0.9964099844159731}-{'f1_val': 0.9098430822153789, 'auprc': 0.9958814021147673, 'loss_val': 0.12131300579973701, 'psi': 0.9442584101751343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=37 head_norm_before_train=1.514763 cos_to_last_merge=0.9591 (last merge round=21)
[S13] round=37 local utility u=0.085355 metrics={'f1_val': 0.6209326565562858, 'auprc': 0.7410298178868049, 'loss_val': 0.8763869835356602, 'psi': 0.6689715210884934}-{'f1_val': 0.6067464894804996, 'auprc': 0.7125208268950141, 'loss_val': 0.8764522075144233, 'psi': 0.6490562244463054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=37 head_norm_before_train=1.785536 cos_to_last_merge=0.7134 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.713
[S14] round=37 local utility u=0.009072 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970633603514132, 'loss_val': 0.03082245714610633, 'psi': 0.9970238490351644}-{'f1_val': 0.9961605687915402, 'auprc': 0.9955294726206314, 'loss_val': 0.039343934615024376, 'psi': 0.9959081303231767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=37 head_norm_before_train=1.747729 cos_to_last_merge=0.9767 (last merge round=22)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9962474835081591, 'loss_val': 0.03815602570777421, 'psi': 0.996546994435776}-{'f1_val': 0.9960143947672967, 'auprc': 0.9983051081756522, 'loss_val': 0.027459658145706743, 'psi': 0.9969306801306389}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.525811 cos_to_last_merge=0.9558 (last merge round=21)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.939107528778592, 'auprc': 0.992231152066532, 'loss_val': 0.23613880912768637, 'psi': 0.960356978093768}-{'f1_val': 0.9924624549696315, 'auprc': 0.996560000039191, 'loss_val': 0.05095939633643433, 'psi': 0.9941014729974553}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.542270 cos_to_last_merge=0.9698 (last merge round=26)
[S17] round=37 local utility u=0.580634 metrics={'f1_val': 0.6867286577373075, 'auprc': 0.9147742144723588, 'loss_val': 0.5974966898407585, 'psi': 0.7779468804313281}-{'f1_val': 0.5732797547452337, 'auprc': 0.8137126000086183, 'loss_val': 0.7748862057551412, 'psi': 0.6694528928505876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=38 head_norm_before_train=1.815992 cos_to_last_merge=0.9830 (last merge round=21)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.8318440169575543, 'auprc': 0.8342576538149802, 'loss_val': 0.2977010521420013, 'psi': 0.8328094717005247}-{'f1_val': 0.8307209159257842, 'auprc': 0.9165287428456392, 'loss_val': 0.2887589188315899, 'psi': 0.8650440466937261}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.593059 cos_to_last_merge=0.9716 (last merge round=25)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9986701674479552, 'loss_val': 0.10193972038829496, 'psi': 0.9757943907186504}-{'f1_val': 0.9808691885975782, 'auprc': 0.9985008189908551, 'loss_val': 0.05843943017879682, 'psi': 0.987921840754889}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.396423 cos_to_last_merge=0.9877 (last merge round=24)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9319870373517708, 'auprc': 0.9311535535281298, 'loss_val': 0.28024441283568774, 'psi': 0.9316536438223144}-{'f1_val': 0.9347817117873845, 'auprc': 0.942057399377662, 'loss_val': 0.28252563907387274, 'psi': 0.9376919868234955}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.388865 cos_to_last_merge=0.9310 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.931
[S5] round=38 local utility u=1.000000 metrics={'f1_val': 0.9611891366083367, 'auprc': 0.9971401357351155, 'loss_val': 0.15595475172729154, 'psi': 0.9755695362590483}-{'f1_val': 0.7118866270877238, 'auprc': 0.8877814253744944, 'loss_val': 0.35401546807243267, 'psi': 0.7822445464024321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=38 head_norm_before_train=1.405985 cos_to_last_merge=0.9223 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.922
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.7684625102218055, 'auprc': 0.954382751515279, 'loss_val': 0.49823689396656157, 'psi': 0.8428306067391949}-{'f1_val': 0.9597554053592215, 'auprc': 0.9614257629192879, 'loss_val': 0.22068229814023999, 'psi': 0.9604235483832481}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.102724 cos_to_last_merge=0.9330 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5031411903942465, 'auprc': 0.7825631645360287, 'loss_val': 0.8472301869950631, 'psi': 0.6149099800509594}-{'f1_val': 0.525781930739879, 'auprc': 0.7857831408088445, 'loss_val': 0.7937968921271531, 'psi': 0.6297824147674651}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.999119 cos_to_last_merge=0.9992 (last merge round=26)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9882077600002297, 'auprc': 0.9987141081131394, 'loss_val': 0.043961707382627814, 'psi': 0.9924102992453936}-{'f1_val': 0.9918109678295097, 'auprc': 0.9984632101720534, 'loss_val': 0.038122422139615836, 'psi': 0.9944718647665272}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.790149 cos_to_last_merge=0.9897 (last merge round=25)
[S9] round=38 local utility u=0.024888 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9984404546822974, 'loss_val': 0.0253351991345626, 'psi': 0.9973896708516221}-{'f1_val': 0.9908221688527771, 'auprc': 0.9985208119050202, 'loss_val': 0.04015113024640465, 'psi': 0.9939016260736744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=38 head_norm_before_train=1.852927 cos_to_last_merge=0.7692 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.769
[S10] round=38 local utility u=0.000134 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9961318737912802, 'loss_val': 0.03381089267995821, 'psi': 0.9949881137412937}-{'f1_val': 0.9942256070413027, 'auprc': 0.9961420127591727, 'loss_val': 0.034110030346575226, 'psi': 0.9949921693284507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=38 head_norm_before_train=1.927316 cos_to_last_merge=0.9871 (last merge round=26)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9969049811838047, 'loss_val': 0.033883010968831506, 'psi': 0.9964421974215074}-{'f1_val': 0.9961336749133093, 'auprc': 0.9968244486699687, 'loss_val': 0.03346472889531961, 'psi': 0.9964099844159731}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.528039 cos_to_last_merge=0.9570 (last merge round=21)
[S13] round=38 local utility u=0.097709 metrics={'f1_val': 0.6483877179162001, 'auprc': 0.7175211249484257, 'loss_val': 0.7751724892007962, 'psi': 0.6760410807290904}-{'f1_val': 0.6209326565562858, 'auprc': 0.7410298178868049, 'loss_val': 0.8763869835356602, 'psi': 0.6689715210884934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=38 head_norm_before_train=1.797635 cos_to_last_merge=0.7122 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.712
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9936999228903409, 'auprc': 0.9986370671642023, 'loss_val': 0.04435836667878241, 'psi': 0.9956747805998856}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970633603514132, 'loss_val': 0.03082245714610633, 'psi': 0.9970238490351644}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.763377 cos_to_last_merge=0.9756 (last merge round=22)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9014525766685394, 'auprc': 0.9969232266990836, 'loss_val': 0.2040814081979593, 'psi': 0.9396408366807572}-{'f1_val': 0.9967466683875206, 'auprc': 0.9962474835081591, 'loss_val': 0.03815602570777421, 'psi': 0.996546994435776}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.540210 cos_to_last_merge=0.9543 (last merge round=21)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8359775672333127, 'auprc': 0.8939325972020562, 'loss_val': 0.8955542507806195, 'psi': 0.8591595792208101}-{'f1_val': 0.939107528778592, 'auprc': 0.992231152066532, 'loss_val': 0.23613880912768637, 'psi': 0.960356978093768}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.560622 cos_to_last_merge=0.9667 (last merge round=26)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5749916907614594, 'auprc': 0.8022485056833615, 'loss_val': 0.8057894331304394, 'psi': 0.6658944167302203}-{'f1_val': 0.6867286577373075, 'auprc': 0.9147742144723588, 'loss_val': 0.5974966898407585, 'psi': 0.7779468804313281}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.828922 cos_to_last_merge=0.9814 (last merge round=21)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8184278992583978, 'auprc': 0.8309615487085378, 'loss_val': 0.3423125468067691, 'psi': 0.8234413590384537}-{'f1_val': 0.8318440169575543, 'auprc': 0.8342576538149802, 'loss_val': 0.2977010521420013, 'psi': 0.8328094717005247}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.823 u=0.0000 p_local=0.1177 f1=0.818 auprc=0.831 bytes=45000
[S3] START round=39 head_norm_before_train=1.614054 cos_to_last_merge=0.9698 (last merge round=25)
[S3] round=39 local utility u=0.001687 metrics={'f1_val': 0.9598687123038214, 'auprc': 0.9985826803043408, 'loss_val': 0.09425231736835905, 'psi': 0.9753542995040292}-{'f1_val': 0.9605438728991138, 'auprc': 0.9986701674479552, 'loss_val': 0.10193972038829496, 'psi': 0.9757943907186504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=40 psi=0.975 u=0.0017 p_local=0.0291 f1=0.960 auprc=0.999 bytes=46751
[S4] START round=39 head_norm_before_train=1.406130 cos_to_last_merge=0.9867 (last merge round=24)
[S4] round=39 local utility u=0.076335 metrics={'f1_val': 0.9373292136415133, 'auprc': 0.9736858128946035, 'loss_val': 0.2872243555710952, 'psi': 0.9518718533427494}-{'f1_val': 0.9319870373517708, 'auprc': 0.9311535535281298, 'loss_val': 0.28024441283568774, 'psi': 0.9316536438223144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] r=40 psi=0.952 u=0.0763 p_local=0.0292 f1=0.937 auprc=0.974 bytes=43085
[S5] START round=39 head_norm_before_train=1.400796 cos_to_last_merge=0.9296 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9406202390917656, 'auprc': 0.9922762107613959, 'loss_val': 0.15674312438049356, 'psi': 0.9612826277596178}-{'f1_val': 0.9611891366083367, 'auprc': 0.9971401357351155, 'loss_val': 0.15595475172729154, 'psi': 0.9755695362590483}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.961 u=0.0000 p_local=0.2181 f1=0.941 auprc=0.992 bytes=44955
[S6] START round=39 head_norm_before_train=1.422034 cos_to_last_merge=0.9197 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.920
[S6] round=39 local utility u=0.803365 metrics={'f1_val': 0.9701340723464322, 'auprc': 0.9794538061016427, 'loss_val': 0.17674952250790882, 'psi': 0.9738619658485165}-{'f1_val': 0.7684625102218055, 'auprc': 0.954382751515279, 'loss_val': 0.49823689396656157, 'psi': 0.8428306067391949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=40 psi=0.974 u=0.8034 p_local=0.4745 f1=0.970 auprc=0.979 bytes=43067
[S7] START round=39 head_norm_before_train=1.116268 cos_to_last_merge=0.9293 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.929
[S7] round=39 local utility u=0.097136 metrics={'f1_val': 0.5296613578845709, 'auprc': 0.7852259357721392, 'loss_val': 0.8200673178588711, 'psi': 0.6318871890395983}-{'f1_val': 0.5031411903942465, 'auprc': 0.7825631645360287, 'loss_val': 0.8472301869950631, 'psi': 0.6149099800509594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=40 psi=0.632 u=0.0971 p_local=0.1947 f1=0.530 auprc=0.785 bytes=39594
[S8] START round=39 head_norm_before_train=2.005743 cos_to_last_merge=0.9990 (last merge round=26)
[S8] round=39 local utility u=0.004976 metrics={'f1_val': 0.9936566772467331, 'auprc': 0.9911951312158671, 'loss_val': 0.044146439656243416, 'psi': 0.9926720588343867}-{'f1_val': 0.9882077600002297, 'auprc': 0.9987141081131394, 'loss_val': 0.043961707382627814, 'psi': 0.9924102992453936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S8] r=40 psi=0.993 u=0.0050 p_local=0.1651 f1=0.994 auprc=0.991 bytes=50377
[S9] START round=39 head_norm_before_train=1.803443 cos_to_last_merge=0.9888 (last merge round=25)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9988446465208743, 'loss_val': 0.025988642437263423, 'psi': 0.9971502797946621}-{'f1_val': 0.9966891482978385, 'auprc': 0.9984404546822974, 'loss_val': 0.0253351991345626, 'psi': 0.9973896708516221}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0085 f1=0.996 auprc=0.999 bytes=52210
[S10] START round=39 head_norm_before_train=1.863382 cos_to_last_merge=0.7686 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.769
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9967430250918461, 'loss_val': 0.03590187873885751, 'psi': 0.9948129891642463}-{'f1_val': 0.9942256070413027, 'auprc': 0.9961318737912802, 'loss_val': 0.03381089267995821, 'psi': 0.9949881137412937}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0036 f1=0.994 auprc=0.997 bytes=50376
[S11] START round=39 head_norm_before_train=1.940839 cos_to_last_merge=0.9860 (last merge round=26)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9961352899639802, 'auprc': 0.9971094418963239, 'loss_val': 0.04960881386911951, 'psi': 0.9965249507369176}-{'f1_val': 0.9961336749133093, 'auprc': 0.9969049811838047, 'loss_val': 0.033883010968831506, 'psi': 0.9964421974215074}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0630 f1=0.996 auprc=0.997 bytes=55859
[S13] START round=39 head_norm_before_train=1.540038 cos_to_last_merge=0.9552 (last merge round=21)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5970845024758967, 'auprc': 0.693865261534198, 'loss_val': 0.9554723616148036, 'psi': 0.6357968060992172}-{'f1_val': 0.6483877179162001, 'auprc': 0.7175211249484257, 'loss_val': 0.7751724892007962, 'psi': 0.6760410807290904}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.636 u=0.0000 p_local=0.0555 f1=0.597 auprc=0.694 bytes=43155
[S14] START round=39 head_norm_before_train=1.806163 cos_to_last_merge=0.7111 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.711
[S14] round=39 local utility u=0.013252 metrics={'f1_val': 0.9969682102907778, 'auprc': 0.9970601488020225, 'loss_val': 0.03273409868740547, 'psi': 0.9970049856952756}-{'f1_val': 0.9936999228903409, 'auprc': 0.9986370671642023, 'loss_val': 0.04435836667878241, 'psi': 0.9956747805998856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S14] r=40 psi=0.997 u=0.0133 p_local=0.0104 f1=0.997 auprc=0.997 bytes=52189
[S15] START round=39 head_norm_before_train=1.779930 cos_to_last_merge=0.9745 (last merge round=22)
[S15] round=39 local utility u=0.015331 metrics={'f1_val': 0.9008967941393231, 'auprc': 0.9960430716040537, 'loss_val': 0.1674432958121048, 'psi': 0.9389553051252153}-{'f1_val': 0.9014525766685394, 'auprc': 0.9969232266990836, 'loss_val': 0.2040814081979593, 'psi': 0.9396408366807572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] r=40 psi=0.939 u=0.0153 p_local=0.0820 f1=0.901 auprc=0.996 bytes=44994
[S16] START round=39 head_norm_before_train=1.554174 cos_to_last_merge=0.9528 (last merge round=21)
[S16] round=39 local utility u=1.000000 metrics={'f1_val': 0.9908930479453208, 'auprc': 0.993082770502044, 'loss_val': 0.06354163797336743, 'psi': 0.99176893696801}-{'f1_val': 0.8359775672333127, 'auprc': 0.8939325972020562, 'loss_val': 0.8955542507806195, 'psi': 0.8591595792208101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S16] r=40 psi=0.992 u=1.0000 p_local=0.2460 f1=0.991 auprc=0.993 bytes=43114
[S17] START round=39 head_norm_before_train=1.576887 cos_to_last_merge=0.9641 (last merge round=26)
[S17] round=39 local utility u=0.074149 metrics={'f1_val': 0.5852217166519433, 'auprc': 0.8256986957005528, 'loss_val': 0.7892221757437504, 'psi': 0.6814125082713871}-{'f1_val': 0.5749916907614594, 'auprc': 0.8022485056833615, 'loss_val': 0.8057894331304394, 'psi': 0.6658944167302203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S17] r=40 psi=0.681 u=0.0741 p_local=0.2094 f1=0.585 auprc=0.826 bytes=41338
[S2] START round=40 head_norm_before_train=1.843234 cos_to_last_merge=0.9796 (last merge round=21)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7780972090199424, 'auprc': 0.842542399113267, 'loss_val': 0.560232406728082, 'psi': 0.8038752850572722}-{'f1_val': 0.8184278992583978, 'auprc': 0.8309615487085378, 'loss_val': 0.3423125468067691, 'psi': 0.8234413590384537}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.632363 cos_to_last_merge=0.9682 (last merge round=25)
[S3] round=40 local utility u=0.020757 metrics={'f1_val': 0.9651428193912157, 'auprc': 0.9984967771675428, 'loss_val': 0.08412544527951397, 'psi': 0.9784844025017466}-{'f1_val': 0.9598687123038214, 'auprc': 0.9985826803043408, 'loss_val': 0.09425231736835905, 'psi': 0.9753542995040292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=40 head_norm_before_train=1.412192 cos_to_last_merge=0.9853 (last merge round=24)
[S4] round=40 local utility u=0.060122 metrics={'f1_val': 0.9500203511421514, 'auprc': 0.9804607794369845, 'loss_val': 0.263451219723786, 'psi': 0.9621965224600847}-{'f1_val': 0.9373292136415133, 'auprc': 0.9736858128946035, 'loss_val': 0.2872243555710952, 'psi': 0.9518718533427494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=40 head_norm_before_train=1.413709 cos_to_last_merge=0.9279 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.928
[S5] round=40 local utility u=0.173722 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9914912368009137, 'loss_val': 0.14210055361611534, 'psi': 0.9944841828920036}-{'f1_val': 0.9406202390917656, 'auprc': 0.9922762107613959, 'loss_val': 0.15674312438049356, 'psi': 0.9612826277596178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=40 head_norm_before_train=1.437087 cos_to_last_merge=0.9172 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.917
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.778138061984067, 'auprc': 0.9597254312156462, 'loss_val': 0.4921118287412571, 'psi': 0.8507730096766987}-{'f1_val': 0.9701340723464322, 'auprc': 0.9794538061016427, 'loss_val': 0.17674952250790882, 'psi': 0.9738619658485165}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.129281 cos_to_last_merge=0.9257 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.4904262928693358, 'auprc': 0.7816554127566482, 'loss_val': 0.8890370437619813, 'psi': 0.6069179408242609}-{'f1_val': 0.5296613578845709, 'auprc': 0.7852259357721392, 'loss_val': 0.8200673178588711, 'psi': 0.6318871890395983}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=2.013339 cos_to_last_merge=0.9989 (last merge round=26)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.978705126228928, 'auprc': 0.9964728263072561, 'loss_val': 0.06150509176257659, 'psi': 0.9858122062602592}-{'f1_val': 0.9936566772467331, 'auprc': 0.9911951312158671, 'loss_val': 0.044146439656243416, 'psi': 0.9926720588343867}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.814729 cos_to_last_merge=0.9881 (last merge round=25)
[S9] round=40 local utility u=0.002052 metrics={'f1_val': 0.9964354604519897, 'auprc': 0.9988489606413196, 'loss_val': 0.02438636612141762, 'psi': 0.9974008605277216}-{'f1_val': 0.9960207019771873, 'auprc': 0.9988446465208743, 'loss_val': 0.025988642437263423, 'psi': 0.9971502797946621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=40 head_norm_before_train=1.874849 cos_to_last_merge=0.7678 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.768
[S10] round=40 local utility u=0.000173 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9967724120377438, 'loss_val': 0.03564425575901799, 'psi': 0.9948247439426053}-{'f1_val': 0.9935262985458464, 'auprc': 0.9967430250918461, 'loss_val': 0.03590187873885751, 'psi': 0.9948129891642463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=40 head_norm_before_train=1.952440 cos_to_last_merge=0.9851 (last merge round=26)
[S11] round=40 local utility u=0.006848 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9970014412264306, 'loss_val': 0.03702917497749519, 'psi': 0.9966258086360227}-{'f1_val': 0.9961352899639802, 'auprc': 0.9971094418963239, 'loss_val': 0.04960881386911951, 'psi': 0.9965249507369176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=40 head_norm_before_train=1.550758 cos_to_last_merge=0.9537 (last merge round=21)
[S13] round=40 local utility u=0.116385 metrics={'f1_val': 0.6332150792666398, 'auprc': 0.6996879503050596, 'loss_val': 0.9569546044034369, 'psi': 0.6598042276820077}-{'f1_val': 0.5970845024758967, 'auprc': 0.693865261534198, 'loss_val': 0.9554723616148036, 'psi': 0.6357968060992172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=40 head_norm_before_train=1.811029 cos_to_last_merge=0.7104 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.710
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9963370861721053, 'auprc': 0.995622461520544, 'loss_val': 0.03155595666535828, 'psi': 0.9960512363114808}-{'f1_val': 0.9969682102907778, 'auprc': 0.9970601488020225, 'loss_val': 0.03273409868740547, 'psi': 0.9970049856952756}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.796245 cos_to_last_merge=0.9733 (last merge round=22)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9014525766685394, 'auprc': 0.9967287847287702, 'loss_val': 0.21303946698509343, 'psi': 0.9395630598926318}-{'f1_val': 0.9008967941393231, 'auprc': 0.9960430716040537, 'loss_val': 0.1674432958121048, 'psi': 0.9389553051252153}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.567218 cos_to_last_merge=0.9513 (last merge round=21)
[S16] round=40 local utility u=0.013646 metrics={'f1_val': 0.9925465741632458, 'auprc': 0.9936240713545668, 'loss_val': 0.04779498344936278, 'psi': 0.9929775730397742}-{'f1_val': 0.9908930479453208, 'auprc': 0.993082770502044, 'loss_val': 0.06354163797336743, 'psi': 0.99176893696801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=40 head_norm_before_train=1.591703 cos_to_last_merge=0.9617 (last merge round=26)
[S17] round=40 local utility u=0.086883 metrics={'f1_val': 0.5992708232262245, 'auprc': 0.8456620815005982, 'loss_val': 0.7596419510295186, 'psi': 0.697827326535974}-{'f1_val': 0.5852217166519433, 'auprc': 0.8256986957005528, 'loss_val': 0.7892221757437504, 'psi': 0.6814125082713871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=41 head_norm_before_train=1.857248 cos_to_last_merge=0.9778 (last merge round=21)
[S2] round=41 local utility u=0.324763 metrics={'f1_val': 0.8311941136409626, 'auprc': 0.8623633852232246, 'loss_val': 0.28875062497290443, 'psi': 0.8436618222738674}-{'f1_val': 0.7780972090199424, 'auprc': 0.842542399113267, 'loss_val': 0.560232406728082, 'psi': 0.8038752850572722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=41 head_norm_before_train=1.650714 cos_to_last_merge=0.9666 (last merge round=25)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9306728695440732, 'auprc': 0.9626922153163225, 'loss_val': 0.2370781653905069, 'psi': 0.9434806078529729}-{'f1_val': 0.9651428193912157, 'auprc': 0.9984967771675428, 'loss_val': 0.08412544527951397, 'psi': 0.9784844025017466}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.417880 cos_to_last_merge=0.9835 (last merge round=24)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9463746673904534, 'auprc': 0.9832497900854935, 'loss_val': 0.26981812870676525, 'psi': 0.9611247164684694}-{'f1_val': 0.9500203511421514, 'auprc': 0.9804607794369845, 'loss_val': 0.263451219723786, 'psi': 0.9621965224600847}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.423560 cos_to_last_merge=0.9265 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=41 local utility u=0.011810 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9937538594066955, 'loss_val': 0.1252685731870617, 'psi': 0.9953892319343163}-{'f1_val': 0.9964794802860635, 'auprc': 0.9914912368009137, 'loss_val': 0.14210055361611534, 'psi': 0.9944841828920036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=41 head_norm_before_train=1.451853 cos_to_last_merge=0.9143 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=41 local utility u=0.630420 metrics={'f1_val': 0.9397550191897712, 'auprc': 0.9717498378580066, 'loss_val': 0.23704679876565515, 'psi': 0.9525529466570654}-{'f1_val': 0.778138061984067, 'auprc': 0.9597254312156462, 'loss_val': 0.4921118287412571, 'psi': 0.8507730096766987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=41 head_norm_before_train=1.139082 cos_to_last_merge=0.9232 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=41 local utility u=0.508913 metrics={'f1_val': 0.6079605132810338, 'auprc': 0.7967663375252396, 'loss_val': 0.6217481782171763, 'psi': 0.6834828429787162}-{'f1_val': 0.4904262928693358, 'auprc': 0.7816554127566482, 'loss_val': 0.8890370437619813, 'psi': 0.6069179408242609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=41 head_norm_before_train=2.021842 cos_to_last_merge=0.9987 (last merge round=26)
[S8] round=41 local utility u=0.030535 metrics={'f1_val': 0.9917725281076084, 'auprc': 0.9886698746179955, 'loss_val': 0.055431647624407325, 'psi': 0.9905314667117633}-{'f1_val': 0.978705126228928, 'auprc': 0.9964728263072561, 'loss_val': 0.06150509176257659, 'psi': 0.9858122062602592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=41 head_norm_before_train=1.826562 cos_to_last_merge=0.9874 (last merge round=25)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9968841373706654, 'auprc': 0.9946514074713213, 'loss_val': 0.024009582955304018, 'psi': 0.9959910454109278}-{'f1_val': 0.9964354604519897, 'auprc': 0.9988489606413196, 'loss_val': 0.02438636612141762, 'psi': 0.9974008605277216}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.886537 cos_to_last_merge=0.7669 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.767
[S10] round=41 local utility u=0.000241 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9968486406934718, 'loss_val': 0.03539132274613347, 'psi': 0.9948552354048965}-{'f1_val': 0.9935262985458464, 'auprc': 0.9967724120377438, 'loss_val': 0.03564425575901799, 'psi': 0.9948247439426053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=41 head_norm_before_train=1.964215 cos_to_last_merge=0.9841 (last merge round=26)
[S11] round=41 local utility u=0.003596 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9969404534052347, 'loss_val': 0.02820399507230053, 'psi': 0.9964563863100795}-{'f1_val': 0.9963753869090841, 'auprc': 0.9970014412264306, 'loss_val': 0.03702917497749519, 'psi': 0.9966258086360227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=41 head_norm_before_train=1.561751 cos_to_last_merge=0.9520 (last merge round=21)
[S13] round=41 local utility u=0.275817 metrics={'f1_val': 0.6719496697438159, 'auprc': 0.7546275780267825, 'loss_val': 0.80254623501033, 'psi': 0.7050208330570025}-{'f1_val': 0.6332150792666398, 'auprc': 0.6996879503050596, 'loss_val': 0.9569546044034369, 'psi': 0.6598042276820077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=41 head_norm_before_train=1.819388 cos_to_last_merge=0.7096 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.710
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9957047465423481, 'loss_val': 0.03874763756373311, 'psi': 0.9967268603179746}-{'f1_val': 0.9963370861721053, 'auprc': 0.995622461520544, 'loss_val': 0.03155595666535828, 'psi': 0.9960512363114808}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.812485 cos_to_last_merge=0.9722 (last merge round=22)
[S15] round=41 local utility u=0.045738 metrics={'f1_val': 0.9055839496786238, 'auprc': 0.9977344273979835, 'loss_val': 0.14936921301737568, 'psi': 0.9424441407663676}-{'f1_val': 0.9014525766685394, 'auprc': 0.9967287847287702, 'loss_val': 0.21303946698509343, 'psi': 0.9395630598926318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=41 head_norm_before_train=1.580116 cos_to_last_merge=0.9498 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=41 local utility u=0.002223 metrics={'f1_val': 0.9922439429761212, 'auprc': 0.9971541237536933, 'loss_val': 0.052123099483267245, 'psi': 0.99420801528715}-{'f1_val': 0.9925465741632458, 'auprc': 0.9936240713545668, 'loss_val': 0.04779498344936278, 'psi': 0.9929775730397742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=41 head_norm_before_train=1.608129 cos_to_last_merge=0.9589 (last merge round=26)
[S17] round=41 local utility u=0.378926 metrics={'f1_val': 0.6597449955999558, 'auprc': 0.9435726429861345, 'loss_val': 0.6583670862298671, 'psi': 0.7732760545544273}-{'f1_val': 0.5992708232262245, 'auprc': 0.8456620815005982, 'loss_val': 0.7596419510295186, 'psi': 0.697827326535974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=42 head_norm_before_train=1.871735 cos_to_last_merge=0.9760 (last merge round=21)
[S2] round=42 local utility u=0.037024 metrics={'f1_val': 0.8268322894576607, 'auprc': 0.9240402991245835, 'loss_val': 0.3735633898383032, 'psi': 0.8657154933244299}-{'f1_val': 0.8311941136409626, 'auprc': 0.8623633852232246, 'loss_val': 0.28875062497290443, 'psi': 0.8436618222738674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=42 head_norm_before_train=1.665837 cos_to_last_merge=0.9652 (last merge round=25)
[S3] round=42 local utility u=0.146686 metrics={'f1_val': 0.9408300105398107, 'auprc': 0.9983166519624567, 'loss_val': 0.11152193422410213, 'psi': 0.9638246671088692}-{'f1_val': 0.9306728695440732, 'auprc': 0.9626922153163225, 'loss_val': 0.2370781653905069, 'psi': 0.9434806078529729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=42 head_norm_before_train=1.425520 cos_to_last_merge=0.9826 (last merge round=24)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.945185299309961, 'auprc': 0.9802010558166876, 'loss_val': 0.2761179948582668, 'psi': 0.9591916019126516}-{'f1_val': 0.9463746673904534, 'auprc': 0.9832497900854935, 'loss_val': 0.26981812870676525, 'psi': 0.9611247164684694}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.434176 cos_to_last_merge=0.9250 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.925
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.8859571440031129, 'auprc': 0.990329779420401, 'loss_val': 0.18350438345435882, 'psi': 0.9277061981700281}-{'f1_val': 0.9964794802860635, 'auprc': 0.9937538594066955, 'loss_val': 0.1252685731870617, 'psi': 0.9953892319343163}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.465283 cos_to_last_merge=0.9119 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7849138038719738, 'auprc': 0.9554802886180563, 'loss_val': 0.5414476974609553, 'psi': 0.8531403977704068}-{'f1_val': 0.9397550191897712, 'auprc': 0.9717498378580066, 'loss_val': 0.23704679876565515, 'psi': 0.9525529466570654}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.146166 cos_to_last_merge=0.9214 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=42 local utility u=0.075277 metrics={'f1_val': 0.6291289439168606, 'auprc': 0.7969616566101776, 'loss_val': 0.5987912083444207, 'psi': 0.6962620289941874}-{'f1_val': 0.6079605132810338, 'auprc': 0.7967663375252396, 'loss_val': 0.6217481782171763, 'psi': 0.6834828429787162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=42 head_norm_before_train=2.027587 cos_to_last_merge=0.9986 (last merge round=26)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9845908343944727, 'auprc': 0.9941967794389119, 'loss_val': 0.049591417688789774, 'psi': 0.9884332124122484}-{'f1_val': 0.9917725281076084, 'auprc': 0.9886698746179955, 'loss_val': 0.055431647624407325, 'psi': 0.9905314667117633}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.837735 cos_to_last_merge=0.9867 (last merge round=25)
[S9] round=42 local utility u=0.000960 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9951016180792643, 'loss_val': 0.023251539884543298, 'psi': 0.99615219848706}-{'f1_val': 0.9968841373706654, 'auprc': 0.9946514074713213, 'loss_val': 0.024009582955304018, 'psi': 0.9959910454109278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=42 head_norm_before_train=1.898041 cos_to_last_merge=0.7660 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.766
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.996981442659848, 'loss_val': 0.036399831077294144, 'psi': 0.994908356191447}-{'f1_val': 0.9935262985458464, 'auprc': 0.9968486406934718, 'loss_val': 0.03539132274613347, 'psi': 0.9948552354048965}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.976533 cos_to_last_merge=0.9831 (last merge round=26)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9939737390387893, 'auprc': 0.9969186429692973, 'loss_val': 0.05655908352462935, 'psi': 0.9951517006109925}-{'f1_val': 0.9961336749133093, 'auprc': 0.9969404534052347, 'loss_val': 0.02820399507230053, 'psi': 0.9964563863100795}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.570453 cos_to_last_merge=0.9503 (last merge round=21)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.617032569550003, 'auprc': 0.7629076530893273, 'loss_val': 0.9013854816542417, 'psi': 0.6753826029657327}-{'f1_val': 0.6719496697438159, 'auprc': 0.7546275780267825, 'loss_val': 0.80254623501033, 'psi': 0.7050208330570025}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.828750 cos_to_last_merge=0.7085 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.709
[S14] round=42 local utility u=0.002411 metrics={'f1_val': 0.9962301447146618, 'auprc': 0.998674116208309, 'loss_val': 0.03576411533548145, 'psi': 0.9972077333121206}-{'f1_val': 0.9974082695017256, 'auprc': 0.9957047465423481, 'loss_val': 0.03874763756373311, 'psi': 0.9967268603179746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=42 head_norm_before_train=1.827285 cos_to_last_merge=0.9713 (last merge round=22)
[S15] round=42 local utility u=0.335224 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9971395420196298, 'loss_val': 0.024112877407516282, 'psi': 0.9969038178403643}-{'f1_val': 0.9055839496786238, 'auprc': 0.9977344273979835, 'loss_val': 0.14936921301737568, 'psi': 0.9424441407663676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=42 head_norm_before_train=1.592269 cos_to_last_merge=0.9485 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8747131349970275, 'auprc': 0.9915595526252451, 'loss_val': 0.5144715640815433, 'psi': 0.9214517020483146}-{'f1_val': 0.9922439429761212, 'auprc': 0.9971541237536933, 'loss_val': 0.052123099483267245, 'psi': 0.99420801528715}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.621944 cos_to_last_merge=0.9567 (last merge round=26)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6496143617652874, 'auprc': 0.84780154788082, 'loss_val': 0.7725439394512759, 'psi': 0.7288892362115005}-{'f1_val': 0.6597449955999558, 'auprc': 0.9435726429861345, 'loss_val': 0.6583670862298671, 'psi': 0.7732760545544273}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.884072 cos_to_last_merge=0.9747 (last merge round=21)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.651536639639746, 'auprc': 0.7758297076479872, 'loss_val': 0.7727989673935045, 'psi': 0.7012538668430425}-{'f1_val': 0.8268322894576607, 'auprc': 0.9240402991245835, 'loss_val': 0.3735633898383032, 'psi': 0.8657154933244299}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.679380 cos_to_last_merge=0.9640 (last merge round=25)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9341048331427513, 'auprc': 0.9942747051537024, 'loss_val': 0.18880511350542198, 'psi': 0.9581727819471317}-{'f1_val': 0.9408300105398107, 'auprc': 0.9983166519624567, 'loss_val': 0.11152193422410213, 'psi': 0.9638246671088692}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.433967 cos_to_last_merge=0.9818 (last merge round=24)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9440307302024651, 'auprc': 0.9721992409653227, 'loss_val': 0.27963772343392473, 'psi': 0.9552981345076081}-{'f1_val': 0.945185299309961, 'auprc': 0.9802010558166876, 'loss_val': 0.2761179948582668, 'psi': 0.9591916019126516}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.443584 cos_to_last_merge=0.9236 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.924
[S5] round=43 local utility u=0.376514 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9938465784504185, 'loss_val': 0.10328727693440137, 'psi': 0.9953389185583015}-{'f1_val': 0.8859571440031129, 'auprc': 0.990329779420401, 'loss_val': 0.18350438345435882, 'psi': 0.9277061981700281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=43 head_norm_before_train=1.475896 cos_to_last_merge=0.9100 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.910
[S6] round=43 local utility u=0.034204 metrics={'f1_val': 0.7920201204294159, 'auprc': 0.9537903949718386, 'loss_val': 0.5106075742676507, 'psi': 0.856728230246385}-{'f1_val': 0.7849138038719738, 'auprc': 0.9554802886180563, 'loss_val': 0.5414476974609553, 'psi': 0.8531403977704068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=43 head_norm_before_train=1.154773 cos_to_last_merge=0.9193 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.919
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5029574388899336, 'auprc': 0.7817435233115595, 'loss_val': 0.8347166454023893, 'psi': 0.6144718726585839}-{'f1_val': 0.6291289439168606, 'auprc': 0.7969616566101776, 'loss_val': 0.5987912083444207, 'psi': 0.6962620289941874}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.031400 cos_to_last_merge=0.9985 (last merge round=26)
[S8] round=43 local utility u=0.038633 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9984906395743065, 'loss_val': 0.03455752973394271, 'psi': 0.9950858000224243}-{'f1_val': 0.9845908343944727, 'auprc': 0.9941967794389119, 'loss_val': 0.049591417688789774, 'psi': 0.9884332124122484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=43 head_norm_before_train=1.847032 cos_to_last_merge=0.9862 (last merge round=25)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.9991784130080352, 'loss_val': 0.039523504152854945, 'psi': 0.9937609631340399}-{'f1_val': 0.9968525854255906, 'auprc': 0.9951016180792643, 'loss_val': 0.023251539884543298, 'psi': 0.99615219848706}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.906845 cos_to_last_merge=0.7655 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.765
[S10] round=43 local utility u=0.000089 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9969779271069581, 'loss_val': 0.03621062501584986, 'psi': 0.994906949970291}-{'f1_val': 0.9935262985458464, 'auprc': 0.996981442659848, 'loss_val': 0.036399831077294144, 'psi': 0.994908356191447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=43 head_norm_before_train=1.985753 cos_to_last_merge=0.9824 (last merge round=26)
[S11] round=43 local utility u=0.012653 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9968474705130411, 'loss_val': 0.043999609439000664, 'psi': 0.996419193153202}-{'f1_val': 0.9939737390387893, 'auprc': 0.9969186429692973, 'loss_val': 0.05655908352462935, 'psi': 0.9951517006109925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=43 head_norm_before_train=1.581715 cos_to_last_merge=0.9486 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=43 local utility u=0.063627 metrics={'f1_val': 0.6322139392096415, 'auprc': 0.76579367650411, 'loss_val': 0.8738776132848717, 'psi': 0.685645834127429}-{'f1_val': 0.617032569550003, 'auprc': 0.7629076530893273, 'loss_val': 0.9013854816542417, 'psi': 0.6753826029657327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=43 head_norm_before_train=1.837133 cos_to_last_merge=0.7079 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.708
[S14] round=43 local utility u=0.004443 metrics={'f1_val': 0.9974284489365712, 'auprc': 0.9970676383889729, 'loss_val': 0.029247785051611522, 'psi': 0.9972841247175319}-{'f1_val': 0.9962301447146618, 'auprc': 0.998674116208309, 'loss_val': 0.03576411533548145, 'psi': 0.9972077333121206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=43 head_norm_before_train=1.840862 cos_to_last_merge=0.9703 (last merge round=22)
[S15] round=43 local utility u=0.004536 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987256371204363, 'loss_val': 0.019799993519241024, 'psi': 0.9975382558806869}-{'f1_val': 0.9967466683875206, 'auprc': 0.9971395420196298, 'loss_val': 0.024112877407516282, 'psi': 0.9969038178403643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=43 head_norm_before_train=1.604382 cos_to_last_merge=0.9471 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8592027619089261, 'auprc': 0.9909010737288432, 'loss_val': 0.6316587736589578, 'psi': 0.9118820866368929}-{'f1_val': 0.8747131349970275, 'auprc': 0.9915595526252451, 'loss_val': 0.5144715640815433, 'psi': 0.9214517020483146}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.640526 cos_to_last_merge=0.9535 (last merge round=26)
[S17] round=43 local utility u=0.061232 metrics={'f1_val': 0.6327759016933621, 'auprc': 0.9114848357714952, 'loss_val': 0.7400992335158908, 'psi': 0.7442594753246153}-{'f1_val': 0.6496143617652874, 'auprc': 0.84780154788082, 'loss_val': 0.7725439394512759, 'psi': 0.7288892362115005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=44 head_norm_before_train=1.893559 cos_to_last_merge=0.9738 (last merge round=21)
[S2] round=44 local utility u=0.761265 metrics={'f1_val': 0.8051641527662572, 'auprc': 0.8680891141364079, 'loss_val': 0.4488114931475303, 'psi': 0.8303341373143174}-{'f1_val': 0.651536639639746, 'auprc': 0.7758297076479872, 'loss_val': 0.7727989673935045, 'psi': 0.7012538668430425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=44 head_norm_before_train=1.690192 cos_to_last_merge=0.9631 (last merge round=25)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9217130575494585, 'loss_val': 0.5399381521764595, 'psi': 0.7888837744317007}-{'f1_val': 0.9341048331427513, 'auprc': 0.9942747051537024, 'loss_val': 0.18880511350542198, 'psi': 0.9581727819471317}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.446004 cos_to_last_merge=0.9812 (last merge round=24)
[S4] round=44 local utility u=0.052245 metrics={'f1_val': 0.9538734685631711, 'auprc': 0.981198557249419, 'loss_val': 0.2612029548963199, 'psi': 0.9648035040376703}-{'f1_val': 0.9440307302024651, 'auprc': 0.9721992409653227, 'loss_val': 0.27963772343392473, 'psi': 0.9552981345076081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=44 head_norm_before_train=1.452651 cos_to_last_merge=0.9223 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.922
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.8435519181325497, 'auprc': 0.9888363938039723, 'loss_val': 0.2131097643109912, 'psi': 0.9016657084011187}-{'f1_val': 0.9963338119635569, 'auprc': 0.9938465784504185, 'loss_val': 0.10328727693440137, 'psi': 0.9953389185583015}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.488333 cos_to_last_merge=0.9079 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=44 local utility u=0.646790 metrics={'f1_val': 0.9408949442661385, 'auprc': 0.9716673151372709, 'loss_val': 0.1639081654043853, 'psi': 0.9532038926145915}-{'f1_val': 0.7920201204294159, 'auprc': 0.9537903949718386, 'loss_val': 0.5106075742676507, 'psi': 0.856728230246385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=44 head_norm_before_train=1.162519 cos_to_last_merge=0.9174 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.917
[S7] round=44 local utility u=0.709388 metrics={'f1_val': 0.6760650031609544, 'auprc': 0.8049855983665795, 'loss_val': 0.524312030470184, 'psi': 0.7276332412432045}-{'f1_val': 0.5029574388899336, 'auprc': 0.7817435233115595, 'loss_val': 0.8347166454023893, 'psi': 0.6144718726585839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=44 head_norm_before_train=2.037309 cos_to_last_merge=0.9984 (last merge round=26)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.9825063844676932, 'loss_val': 0.6684512510893575, 'psi': 0.8212548473463789}-{'f1_val': 0.9928159069878363, 'auprc': 0.9984906395743065, 'loss_val': 0.03455752973394271, 'psi': 0.9950858000224243}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.856229 cos_to_last_merge=0.9856 (last merge round=25)
[S9] round=44 local utility u=0.025814 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9972857743236632, 'loss_val': 0.022436623945440142, 'psi': 0.9970258609848196}-{'f1_val': 0.9901493298847097, 'auprc': 0.9991784130080352, 'loss_val': 0.039523504152854945, 'psi': 0.9937609631340399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=44 head_norm_before_train=1.912780 cos_to_last_merge=0.7652 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.765
[S10] round=44 local utility u=0.000075 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.996937356348891, 'loss_val': 0.035939036675864386, 'psi': 0.9948907216670642}-{'f1_val': 0.9935262985458464, 'auprc': 0.9969779271069581, 'loss_val': 0.03621062501584986, 'psi': 0.994906949970291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=44 head_norm_before_train=1.994630 cos_to_last_merge=0.9818 (last merge round=26)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.996778126805221, 'loss_val': 0.051711208271612547, 'psi': 0.9966814352818019}-{'f1_val': 0.9961336749133093, 'auprc': 0.9968474705130411, 'loss_val': 0.043999609439000664, 'psi': 0.996419193153202}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.592196 cos_to_last_merge=0.9470 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=44 local utility u=0.063116 metrics={'f1_val': 0.651440596795507, 'auprc': 0.7573042213876396, 'loss_val': 0.8375372360480238, 'psi': 0.69378604663236}-{'f1_val': 0.6322139392096415, 'auprc': 0.76579367650411, 'loss_val': 0.8738776132848717, 'psi': 0.685645834127429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=44 head_norm_before_train=1.846388 cos_to_last_merge=0.7075 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.707
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9930611278268856, 'auprc': 0.9969792464642967, 'loss_val': 0.04045376281194526, 'psi': 0.9946283752818501}-{'f1_val': 0.9974284489365712, 'auprc': 0.9970676383889729, 'loss_val': 0.029247785051611522, 'psi': 0.9972841247175319}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.854595 cos_to_last_merge=0.9695 (last merge round=22)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9849521591821299, 'auprc': 0.9978509007052785, 'loss_val': 0.03947876043743112, 'psi': 0.9901116557913893}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987256371204363, 'loss_val': 0.019799993519241024, 'psi': 0.9975382558806869}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.614889 cos_to_last_merge=0.9459 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=44 local utility u=0.071045 metrics={'f1_val': 0.8753581369811814, 'auprc': 0.9842794928380112, 'loss_val': 0.5666371819905249, 'psi': 0.9189266793239133}-{'f1_val': 0.8592027619089261, 'auprc': 0.9909010737288432, 'loss_val': 0.6316587736589578, 'psi': 0.9118820866368929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] sending update (kind=head size=1808 to 1 peers)
[S17] START round=44 head_norm_before_train=1.655594 cos_to_last_merge=0.9506 (last merge round=26)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5015443984346233, 'auprc': 0.6940207102471777, 'loss_val': 1.065522040124893, 'psi': 0.578534923159645}-{'f1_val': 0.6327759016933621, 'auprc': 0.9114848357714952, 'loss_val': 0.7400992335158908, 'psi': 0.7442594753246153}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.901475 cos_to_last_merge=0.9730 (last merge round=21)
[S2] round=45 local utility u=0.146037 metrics={'f1_val': 0.8295644438915784, 'auprc': 0.8985415894487578, 'loss_val': 0.39449613663103056, 'psi': 0.8571553021144502}-{'f1_val': 0.8051641527662572, 'auprc': 0.8680891141364079, 'loss_val': 0.4488114931475303, 'psi': 0.8303341373143174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=45 head_norm_before_train=1.697197 cos_to_last_merge=0.9627 (last merge round=25)
[S3] round=45 local utility u=0.275132 metrics={'f1_val': 0.7410887110804413, 'auprc': 0.998392285018366, 'loss_val': 0.46425951520266595, 'psi': 0.8440101406556111}-{'f1_val': 0.700330919019862, 'auprc': 0.9217130575494585, 'loss_val': 0.5399381521764595, 'psi': 0.7888837744317007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=45 head_norm_before_train=1.455158 cos_to_last_merge=0.9809 (last merge round=24)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9377744001926662, 'auprc': 0.9481089103697815, 'loss_val': 0.2993512098741133, 'psi': 0.9419082042635123}-{'f1_val': 0.9538734685631711, 'auprc': 0.981198557249419, 'loss_val': 0.2612029548963199, 'psi': 0.9648035040376703}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.464635 cos_to_last_merge=0.9205 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.920
[S5] round=45 local utility u=0.518709 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9914485798962809, 'loss_val': 0.10022030895688053, 'psi': 0.9943797191366464}-{'f1_val': 0.8435519181325497, 'auprc': 0.9888363938039723, 'loss_val': 0.2131097643109912, 'psi': 0.9016657084011187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=45 head_norm_before_train=1.500227 cos_to_last_merge=0.9059 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8367223856878243, 'auprc': 0.9720713702583399, 'loss_val': 0.3489898569572219, 'psi': 0.8908619795160305}-{'f1_val': 0.9408949442661385, 'auprc': 0.9716673151372709, 'loss_val': 0.1639081654043853, 'psi': 0.9532038926145915}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.169765 cos_to_last_merge=0.9159 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6123123970397327, 'auprc': 0.7923888866229769, 'loss_val': 0.6245324396348393, 'psi': 0.6843429928730305}-{'f1_val': 0.6760650031609544, 'auprc': 0.8049855983665795, 'loss_val': 0.524312030470184, 'psi': 0.7276332412432045}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.042974 cos_to_last_merge=0.9983 (last merge round=26)
[S8] round=45 local utility u=1.000000 metrics={'f1_val': 0.9934815081849845, 'auprc': 0.9978574952240207, 'loss_val': 0.03424041454201027, 'psi': 0.9952319030005989}-{'f1_val': 0.7137538225988359, 'auprc': 0.9825063844676932, 'loss_val': 0.6684512510893575, 'psi': 0.8212548473463789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=45 head_norm_before_train=1.864100 cos_to_last_merge=0.9853 (last merge round=25)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9954320288503682, 'loss_val': 0.0220558508880479, 'psi': 0.9964345590474329}-{'f1_val': 0.9968525854255906, 'auprc': 0.9972857743236632, 'loss_val': 0.022436623945440142, 'psi': 0.9970258609848196}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.920607 cos_to_last_merge=0.7648 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.765
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969814138583982, 'loss_val': 0.0365605849504082, 'psi': 0.9947769907759022}-{'f1_val': 0.9935262985458464, 'auprc': 0.996937356348891, 'loss_val': 0.035939036675864386, 'psi': 0.9948907216670642}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.001451 cos_to_last_merge=0.9812 (last merge round=26)
[S11] round=45 local utility u=0.009231 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9967456068343723, 'loss_val': 0.03025283378900072, 'psi': 0.9963784476817346}-{'f1_val': 0.9966169742661891, 'auprc': 0.996778126805221, 'loss_val': 0.051711208271612547, 'psi': 0.9966814352818019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=45 head_norm_before_train=1.600548 cos_to_last_merge=0.9457 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=45 local utility u=0.031498 metrics={'f1_val': 0.6493326534059749, 'auprc': 0.7781991557894004, 'loss_val': 0.824577705083038, 'psi': 0.7008792543593451}-{'f1_val': 0.651440596795507, 'auprc': 0.7573042213876396, 'loss_val': 0.8375372360480238, 'psi': 0.69378604663236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=45 head_norm_before_train=1.857006 cos_to_last_merge=0.7065 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.707
[S14] round=45 local utility u=0.018574 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9969758179143515, 'loss_val': 0.025908467975872315, 'psi': 0.9968883752610675}-{'f1_val': 0.9930611278268856, 'auprc': 0.9969792464642967, 'loss_val': 0.04045376281194526, 'psi': 0.9946283752818501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=45 head_norm_before_train=1.867341 cos_to_last_merge=0.9686 (last merge round=22)
[S15] round=45 local utility u=0.045998 metrics={'f1_val': 0.9968965306828483, 'auprc': 0.9985425263945786, 'loss_val': 0.02122318804049281, 'psi': 0.9975549289675405}-{'f1_val': 0.9849521591821299, 'auprc': 0.9978509007052785, 'loss_val': 0.03947876043743112, 'psi': 0.9901116557913893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=45 head_norm_before_train=1.623716 cos_to_last_merge=0.9451 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=45 local utility u=0.622116 metrics={'f1_val': 0.9931523691165829, 'auprc': 0.9875902124228413, 'loss_val': 0.03910232908162183, 'psi': 0.9909275064390862}-{'f1_val': 0.8753581369811814, 'auprc': 0.9842794928380112, 'loss_val': 0.5666371819905249, 'psi': 0.9189266793239133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=45 head_norm_before_train=1.668424 cos_to_last_merge=0.9483 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=45 local utility u=0.313625 metrics={'f1_val': 0.5513164642994123, 'auprc': 0.7841864319841519, 'loss_val': 1.007400883755534, 'psi': 0.6444644513733082}-{'f1_val': 0.5015443984346233, 'auprc': 0.6940207102471777, 'loss_val': 1.065522040124893, 'psi': 0.578534923159645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=46 head_norm_before_train=1.909054 cos_to_last_merge=0.9722 (last merge round=21)
[S2] round=46 local utility u=0.002234 metrics={'f1_val': 0.8302308876188674, 'auprc': 0.8922103769540843, 'loss_val': 0.37503350924967854, 'psi': 0.8550226833529542}-{'f1_val': 0.8295644438915784, 'auprc': 0.8985415894487578, 'loss_val': 0.39449613663103056, 'psi': 0.8571553021144502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=46 head_norm_before_train=1.700755 cos_to_last_merge=0.9628 (last merge round=25)
[S3] round=46 local utility u=0.987552 metrics={'f1_val': 0.9974247332315468, 'auprc': 0.9985103708928532, 'loss_val': 0.02752499512092642, 'psi': 0.9978589882960693}-{'f1_val': 0.7410887110804413, 'auprc': 0.998392285018366, 'loss_val': 0.46425951520266595, 'psi': 0.8440101406556111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=46 head_norm_before_train=1.463214 cos_to_last_merge=0.9805 (last merge round=24)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9364563962656277, 'auprc': 0.9307436566012203, 'loss_val': 0.3361224892735137, 'psi': 0.9341713003998647}-{'f1_val': 0.9377744001926662, 'auprc': 0.9481089103697815, 'loss_val': 0.2993512098741133, 'psi': 0.9419082042635123}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.478073 cos_to_last_merge=0.9184 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=46 local utility u=0.020324 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9966354319651242, 'loss_val': 0.07513247310535205, 'psi': 0.9964544599641838}-{'f1_val': 0.9963338119635569, 'auprc': 0.9914485798962809, 'loss_val': 0.10022030895688053, 'psi': 0.9943797191366464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=46 head_norm_before_train=1.509525 cos_to_last_merge=0.9043 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.904
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.5967738757187887, 'auprc': 0.9220821689523332, 'loss_val': 0.7850791780474227, 'psi': 0.7268971930122066}-{'f1_val': 0.8367223856878243, 'auprc': 0.9720713702583399, 'loss_val': 0.3489898569572219, 'psi': 0.8908619795160305}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.176223 cos_to_last_merge=0.9144 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=46 local utility u=0.288788 metrics={'f1_val': 0.6805342645556118, 'auprc': 0.8065395897974053, 'loss_val': 0.49874075195111545, 'psi': 0.7309363946523293}-{'f1_val': 0.6123123970397327, 'auprc': 0.7923888866229769, 'loss_val': 0.6245324396348393, 'psi': 0.6843429928730305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=46 head_norm_before_train=2.045789 cos_to_last_merge=0.9981 (last merge round=26)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.8864914379494935, 'auprc': 0.9966240596585599, 'loss_val': 0.23366113697164245, 'psi': 0.9305444866331201}-{'f1_val': 0.9934815081849845, 'auprc': 0.9978574952240207, 'loss_val': 0.03424041454201027, 'psi': 0.9952319030005989}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.871443 cos_to_last_merge=0.9849 (last merge round=25)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9904109382186765, 'auprc': 0.9987383603784221, 'loss_val': 0.03573386676709678, 'psi': 0.9937419070825748}-{'f1_val': 0.9971029125121428, 'auprc': 0.9954320288503682, 'loss_val': 0.0220558508880479, 'psi': 0.9964345590474329}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.926912 cos_to_last_merge=0.7645 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.764
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969848617051288, 'loss_val': 0.03670382584132534, 'psi': 0.9947783699145945}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969814138583982, 'loss_val': 0.0365605849504082, 'psi': 0.9947769907759022}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.009127 cos_to_last_merge=0.9805 (last merge round=26)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9535731057875573, 'auprc': 0.9966741977641791, 'loss_val': 0.08316703409466623, 'psi': 0.970813542578206}-{'f1_val': 0.9961336749133093, 'auprc': 0.9967456068343723, 'loss_val': 0.03025283378900072, 'psi': 0.9963784476817346}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.606847 cos_to_last_merge=0.9448 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=46 local utility u=0.153298 metrics={'f1_val': 0.6986452190598889, 'auprc': 0.7848442717536948, 'loss_val': 0.8337917749240331, 'psi': 0.7331248401374112}-{'f1_val': 0.6493326534059749, 'auprc': 0.7781991557894004, 'loss_val': 0.824577705083038, 'psi': 0.7008792543593451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=46 head_norm_before_train=1.867905 cos_to_last_merge=0.7049 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.705
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9964220880800234, 'loss_val': 0.02644155594621286, 'psi': 0.9966668833273362}-{'f1_val': 0.9968300801588782, 'auprc': 0.9969758179143515, 'loss_val': 0.025908467975872315, 'psi': 0.9968883752610675}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.878848 cos_to_last_merge=0.9679 (last merge round=22)
[S15] round=46 local utility u=0.001272 metrics={'f1_val': 0.9968965306828483, 'auprc': 0.9990128731651794, 'loss_val': 0.020090771016492995, 'psi': 0.9977430676757808}-{'f1_val': 0.9968965306828483, 'auprc': 0.9985425263945786, 'loss_val': 0.02122318804049281, 'psi': 0.9975549289675405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=46 head_norm_before_train=1.632336 cos_to_last_merge=0.9444 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.835796639062583, 'auprc': 0.9832989546348426, 'loss_val': 0.6212315801631645, 'psi': 0.8947975652914868}-{'f1_val': 0.9931523691165829, 'auprc': 0.9875902124228413, 'loss_val': 0.03910232908162183, 'psi': 0.9909275064390862}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.679064 cos_to_last_merge=0.9466 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=46 local utility u=0.198952 metrics={'f1_val': 0.5676980868637824, 'auprc': 0.8621356330299786, 'loss_val': 0.9416333718023303, 'psi': 0.685473105330261}-{'f1_val': 0.5513164642994123, 'auprc': 0.7841864319841519, 'loss_val': 1.007400883755534, 'psi': 0.6444644513733082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=47 head_norm_before_train=1.917825 cos_to_last_merge=0.9712 (last merge round=21)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6825941782062146, 'auprc': 0.7555151754140266, 'loss_val': 1.3712649299959847, 'psi': 0.7117625770893394}-{'f1_val': 0.8302308876188674, 'auprc': 0.8922103769540843, 'loss_val': 0.37503350924967854, 'psi': 0.8550226833529542}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.706658 cos_to_last_merge=0.9625 (last merge round=25)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9613297054499484, 'auprc': 0.998403005773961, 'loss_val': 0.1247052506225108, 'psi': 0.9761590255795536}-{'f1_val': 0.9974247332315468, 'auprc': 0.9985103708928532, 'loss_val': 0.02752499512092642, 'psi': 0.9978589882960693}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.470861 cos_to_last_merge=0.9800 (last merge round=24)
[S4] round=47 local utility u=0.087323 metrics={'f1_val': 0.9396042490188085, 'auprc': 0.9680162849117386, 'loss_val': 0.2921815566025866, 'psi': 0.9509690633759804}-{'f1_val': 0.9364563962656277, 'auprc': 0.9307436566012203, 'loss_val': 0.3361224892735137, 'psi': 0.9341713003998647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=47 head_norm_before_train=1.489567 cos_to_last_merge=0.9166 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.917
[S5] round=47 local utility u=0.004313 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9975191833664568, 'loss_val': 0.06915711617137861, 'psi': 0.9968079605247169}-{'f1_val': 0.9963338119635569, 'auprc': 0.9966354319651242, 'loss_val': 0.07513247310535205, 'psi': 0.9964544599641838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=47 head_norm_before_train=1.518494 cos_to_last_merge=0.9029 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.903
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.9554931342219224, 'auprc': 0.9845802771900738, 'loss_val': 0.18401276976157832, 'psi': 0.9671279914091829}-{'f1_val': 0.5967738757187887, 'auprc': 0.9220821689523332, 'loss_val': 0.7850791780474227, 'psi': 0.7268971930122066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=47 head_norm_before_train=1.181593 cos_to_last_merge=0.9132 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6802857954539878, 'auprc': 0.8064087018351804, 'loss_val': 0.4973372341888733, 'psi': 0.7307349580064648}-{'f1_val': 0.6805342645556118, 'auprc': 0.8065395897974053, 'loss_val': 0.49874075195111545, 'psi': 0.7309363946523293}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.049404 cos_to_last_merge=0.9978 (last merge round=26)
[S8] round=47 local utility u=0.415615 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.994242586208971, 'loss_val': 0.035327160731917565, 'psi': 0.9935959454144003}-{'f1_val': 0.8864914379494935, 'auprc': 0.9966240596585599, 'loss_val': 0.23366113697164245, 'psi': 0.9305444866331201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=47 head_norm_before_train=1.878127 cos_to_last_merge=0.9845 (last merge round=25)
[S9] round=47 local utility u=0.026900 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998589614468857, 'loss_val': 0.021640469459584616, 'psi': 0.9976975932948284}-{'f1_val': 0.9904109382186765, 'auprc': 0.9987383603784221, 'loss_val': 0.03573386676709678, 'psi': 0.9937419070825748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=47 head_norm_before_train=1.931079 cos_to_last_merge=0.7644 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.764
[S10] round=47 local utility u=0.000081 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969718017598797, 'loss_val': 0.036502833562168324, 'psi': 0.9947731459364948}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969848617051288, 'loss_val': 0.03670382584132534, 'psi': 0.9947783699145945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=47 head_norm_before_train=2.015640 cos_to_last_merge=0.9800 (last merge round=26)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9242419944240495, 'auprc': 0.9954983171160157, 'loss_val': 0.1081985527999773, 'psi': 0.952744523500836}-{'f1_val': 0.9535731057875573, 'auprc': 0.9966741977641791, 'loss_val': 0.08316703409466623, 'psi': 0.970813542578206}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.612306 cos_to_last_merge=0.9439 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=47 local utility u=0.232019 metrics={'f1_val': 0.757761215826528, 'auprc': 0.7929648515805076, 'loss_val': 0.748811093436568, 'psi': 0.7718426701281198}-{'f1_val': 0.6986452190598889, 'auprc': 0.7848442717536948, 'loss_val': 0.8337917749240331, 'psi': 0.7331248401374112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=47 head_norm_before_train=1.879149 cos_to_last_merge=0.7035 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.703
[S14] round=47 local utility u=0.003195 metrics={'f1_val': 0.997240356705793, 'auprc': 0.996975947172618, 'loss_val': 0.024174228303521214, 'psi': 0.997134592892523}-{'f1_val': 0.9968300801588782, 'auprc': 0.9964220880800234, 'loss_val': 0.02644155594621286, 'psi': 0.9966668833273362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=47 head_norm_before_train=1.890270 cos_to_last_merge=0.9672 (last merge round=22)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9047489569571503, 'auprc': 0.9962183328943555, 'loss_val': 0.11947971838591202, 'psi': 0.9413367073320323}-{'f1_val': 0.9968965306828483, 'auprc': 0.9990128731651794, 'loss_val': 0.020090771016492995, 'psi': 0.9977430676757808}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.641770 cos_to_last_merge=0.9435 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=47 local utility u=0.363825 metrics={'f1_val': 0.9196113229140689, 'auprc': 0.9764028601872639, 'loss_val': 0.37578180585514087, 'psi': 0.9423279378233469}-{'f1_val': 0.835796639062583, 'auprc': 0.9832989546348426, 'loss_val': 0.6212315801631645, 'psi': 0.8947975652914868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=47 head_norm_before_train=1.690713 cos_to_last_merge=0.9448 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5605885923341587, 'auprc': 0.8384974583040736, 'loss_val': 0.9862125963441157, 'psi': 0.6717521387221247}-{'f1_val': 0.5676980868637824, 'auprc': 0.8621356330299786, 'loss_val': 0.9416333718023303, 'psi': 0.685473105330261}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.924902 cos_to_last_merge=0.9705 (last merge round=21)
[S2] round=48 local utility u=0.581987 metrics={'f1_val': 0.7197596611185854, 'auprc': 0.8254325936898037, 'loss_val': 0.640035615460392, 'psi': 0.7620288341470727}-{'f1_val': 0.6825941782062146, 'auprc': 0.7555151754140266, 'loss_val': 1.3712649299959847, 'psi': 0.7117625770893394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=48 head_norm_before_train=1.712360 cos_to_last_merge=0.9621 (last merge round=25)
[S3] round=48 local utility u=0.157555 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9985110423322174, 'loss_val': 0.02369129291778837, 'psi': 0.997579440494684}-{'f1_val': 0.9613297054499484, 'auprc': 0.998403005773961, 'loss_val': 0.1247052506225108, 'psi': 0.9761590255795536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=48 head_norm_before_train=1.477284 cos_to_last_merge=0.9792 (last merge round=24)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.939290045122387, 'auprc': 0.9684976780862987, 'loss_val': 0.2948825665387103, 'psi': 0.9509730983079516}-{'f1_val': 0.9396042490188085, 'auprc': 0.9680162849117386, 'loss_val': 0.2921815566025866, 'psi': 0.9509690633759804}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.500652 cos_to_last_merge=0.9150 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.915
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9945360548558673, 'loss_val': 0.06529365228690195, 'psi': 0.995614709120481}-{'f1_val': 0.9963338119635569, 'auprc': 0.9975191833664568, 'loss_val': 0.06915711617137861, 'psi': 0.9968079605247169}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.527744 cos_to_last_merge=0.9016 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.902
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6204674222050947, 'auprc': 0.8036603597662995, 'loss_val': 0.7412289798470546, 'psi': 0.6937445972295766}-{'f1_val': 0.9554931342219224, 'auprc': 0.9845802771900738, 'loss_val': 0.18401276976157832, 'psi': 0.9671279914091829}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.186566 cos_to_last_merge=0.9121 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5399115403151977, 'auprc': 0.7829065001801946, 'loss_val': 0.7959517453751122, 'psi': 0.6371095242611965}-{'f1_val': 0.6802857954539878, 'auprc': 0.8064087018351804, 'loss_val': 0.4973372341888733, 'psi': 0.7307349580064648}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.054373 cos_to_last_merge=0.9976 (last merge round=26)
[S8] round=48 local utility u=0.008154 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9992254905238653, 'loss_val': 0.032990285541867795, 'psi': 0.9954912709012186}-{'f1_val': 0.9931648515513533, 'auprc': 0.994242586208971, 'loss_val': 0.035327160731917565, 'psi': 0.9935959454144003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=48 head_norm_before_train=1.884560 cos_to_last_merge=0.9842 (last merge round=25)
[S9] round=48 local utility u=0.000673 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987704675907734, 'loss_val': 0.02083648661785756, 'psi': 0.9977699345435951}-{'f1_val': 0.9971029125121428, 'auprc': 0.998589614468857, 'loss_val': 0.021640469459584616, 'psi': 0.9976975932948284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S9] sending update (kind=head size=1808 to 1 peers)
[S10] START round=48 head_norm_before_train=1.937630 cos_to_last_merge=0.7641 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.764
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969821107503889, 'loss_val': 0.036652215552292144, 'psi': 0.9947772695326985}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969718017598797, 'loss_val': 0.036502833562168324, 'psi': 0.9947731459364948}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.023399 cos_to_last_merge=0.9793 (last merge round=26)
[S11] round=48 local utility u=0.138728 metrics={'f1_val': 0.9651834408818776, 'auprc': 0.9953665249768696, 'loss_val': 0.07599539072775398, 'psi': 0.9772566745198743}-{'f1_val': 0.9242419944240495, 'auprc': 0.9954983171160157, 'loss_val': 0.1081985527999773, 'psi': 0.952744523500836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=48 head_norm_before_train=1.619508 cos_to_last_merge=0.9428 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.7297837407182198, 'auprc': 0.7886778956866758, 'loss_val': 0.7245723950586878, 'psi': 0.7533414027056022}-{'f1_val': 0.757761215826528, 'auprc': 0.7929648515805076, 'loss_val': 0.748811093436568, 'psi': 0.7718426701281198}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.887640 cos_to_last_merge=0.7030 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.703
[S14] round=48 local utility u=0.001622 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969781817760984, 'loss_val': 0.023401181435744215, 'psi': 0.9973819435403515}-{'f1_val': 0.997240356705793, 'auprc': 0.996975947172618, 'loss_val': 0.024174228303521214, 'psi': 0.997134592892523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=48 head_norm_before_train=1.900449 cos_to_last_merge=0.9665 (last merge round=22)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.8414088746383926, 'auprc': 0.995988952563318, 'loss_val': 0.31750935924031526, 'psi': 0.9032409058083628}-{'f1_val': 0.9047489569571503, 'auprc': 0.9962183328943555, 'loss_val': 0.11947971838591202, 'psi': 0.9413367073320323}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.649227 cos_to_last_merge=0.9428 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8755478346712674, 'auprc': 0.9883164599469125, 'loss_val': 0.5312984569522613, 'psi': 0.9206552847815255}-{'f1_val': 0.9196113229140689, 'auprc': 0.9764028601872639, 'loss_val': 0.37578180585514087, 'psi': 0.9423279378233469}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.701210 cos_to_last_merge=0.9435 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=48 local utility u=0.071126 metrics={'f1_val': 0.569591117383064, 'auprc': 0.8488058287059438, 'loss_val': 0.9289015307784669, 'psi': 0.6812770019122159}-{'f1_val': 0.5605885923341587, 'auprc': 0.8384974583040736, 'loss_val': 0.9862125963441157, 'psi': 0.6717521387221247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=49 head_norm_before_train=1.932255 cos_to_last_merge=0.9695 (last merge round=21)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7415647988175518, 'auprc': 0.7766163534377203, 'loss_val': 0.6538431890236452, 'psi': 0.7555854206656192}-{'f1_val': 0.7197596611185854, 'auprc': 0.8254325936898037, 'loss_val': 0.640035615460392, 'psi': 0.7620288341470727}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.717950 cos_to_last_merge=0.9617 (last merge round=25)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.99826849223608, 'loss_val': 0.025705002532431086, 'psi': 0.9977276060944555}-{'f1_val': 0.9969583726029951, 'auprc': 0.9985110423322174, 'loss_val': 0.02369129291778837, 'psi': 0.997579440494684}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.481741 cos_to_last_merge=0.9789 (last merge round=24)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.935457300699905, 'auprc': 0.9413161562412256, 'loss_val': 0.3389745656435887, 'psi': 0.9378008429164332}-{'f1_val': 0.939290045122387, 'auprc': 0.9684976780862987, 'loss_val': 0.2948825665387103, 'psi': 0.9509730983079516}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.509634 cos_to_last_merge=0.9135 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.914
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9118770049817305, 'auprc': 0.9895811607815366, 'loss_val': 0.14483439698012346, 'psi': 0.9429586673016529}-{'f1_val': 0.9963338119635569, 'auprc': 0.9945360548558673, 'loss_val': 0.06529365228690195, 'psi': 0.995614709120481}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.535420 cos_to_last_merge=0.9003 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.900
[S6] round=49 local utility u=0.174501 metrics={'f1_val': 0.6082377556723734, 'auprc': 0.9561242415755269, 'loss_val': 0.7762407671268539, 'psi': 0.7473923500336348}-{'f1_val': 0.6204674222050947, 'auprc': 0.8036603597662995, 'loss_val': 0.7412289798470546, 'psi': 0.6937445972295766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=49 head_norm_before_train=1.194270 cos_to_last_merge=0.9104 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.910
[S7] round=49 local utility u=0.223278 metrics={'f1_val': 0.5850492792276646, 'auprc': 0.7922703188455489, 'loss_val': 0.6483143916128172, 'psi': 0.6679376950748184}-{'f1_val': 0.5399115403151977, 'auprc': 0.7829065001801946, 'loss_val': 0.7959517453751122, 'psi': 0.6371095242611965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=49 head_norm_before_train=2.060741 cos_to_last_merge=0.9974 (last merge round=26)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.8919786240479444, 'auprc': 0.9991312549474871, 'loss_val': 0.23839756736243417, 'psi': 0.9348396764077616}-{'f1_val': 0.9930017911527874, 'auprc': 0.9992254905238653, 'loss_val': 0.032990285541867795, 'psi': 0.9954912709012186}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.892341 cos_to_last_merge=0.9837 (last merge round=25)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9987752918499491, 'loss_val': 0.024432033059999782, 'psi': 0.996524367388457}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987704675907734, 'loss_val': 0.02083648661785756, 'psi': 0.9977699345435951}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.945408 cos_to_last_merge=0.7637 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.764
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969917273923347, 'loss_val': 0.03691151700407254, 'psi': 0.9947811161894768}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969821107503889, 'loss_val': 0.036652215552292144, 'psi': 0.9947772695326985}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.031751 cos_to_last_merge=0.9786 (last merge round=26)
[S11] round=49 local utility u=0.114734 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9970463900977659, 'loss_val': 0.037268393568083945, 'psi': 0.9964987609870919}-{'f1_val': 0.9651834408818776, 'auprc': 0.9953665249768696, 'loss_val': 0.07599539072775398, 'psi': 0.9772566745198743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=49 head_norm_before_train=1.626081 cos_to_last_merge=0.9417 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6942347658279637, 'auprc': 0.7877248793559504, 'loss_val': 0.8402636203899082, 'psi': 0.7316308112391584}-{'f1_val': 0.7297837407182198, 'auprc': 0.7886778956866758, 'loss_val': 0.7245723950586878, 'psi': 0.7533414027056022}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.895608 cos_to_last_merge=0.7027 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.703
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9955709227491966, 'auprc': 0.9984458075849314, 'loss_val': 0.03410436987219374, 'psi': 0.9967208766834905}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969781817760984, 'loss_val': 0.023401181435744215, 'psi': 0.9973819435403515}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.910485 cos_to_last_merge=0.9659 (last merge round=22)
[S15] round=49 local utility u=0.239755 metrics={'f1_val': 0.9013277441892558, 'auprc': 0.9962090333160769, 'loss_val': 0.19817320088861204, 'psi': 0.9392802598399842}-{'f1_val': 0.8414088746383926, 'auprc': 0.995988952563318, 'loss_val': 0.31750935924031526, 'psi': 0.9032409058083628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=49 head_norm_before_train=1.657991 cos_to_last_merge=0.9418 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.942
[S16] round=49 local utility u=0.062451 metrics={'f1_val': 0.8807954877077515, 'auprc': 0.9967354780606251, 'loss_val': 0.46313997345783314, 'psi': 0.927171483848901}-{'f1_val': 0.8755478346712674, 'auprc': 0.9883164599469125, 'loss_val': 0.5312984569522613, 'psi': 0.9206552847815255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=49 head_norm_before_train=1.711599 cos_to_last_merge=0.9421 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5354893943819916, 'auprc': 0.7794313768790598, 'loss_val': 1.068285654150192, 'psi': 0.633066187380819}-{'f1_val': 0.569591117383064, 'auprc': 0.8488058287059438, 'loss_val': 0.9289015307784669, 'psi': 0.6812770019122159}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=1.937391 cos_to_last_merge=0.9690 (last merge round=21)
[S2] round=50 local utility u=0.546976 metrics={'f1_val': 0.8093856336522798, 'auprc': 0.92469807603047, 'loss_val': 0.4110611812169433, 'psi': 0.8555106106035559}-{'f1_val': 0.7415647988175518, 'auprc': 0.7766163534377203, 'loss_val': 0.6538431890236452, 'psi': 0.7555854206656192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=50 head_norm_before_train=1.724849 cos_to_last_merge=0.9611 (last merge round=25)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.972865017655, 'auprc': 0.9982375120420428, 'loss_val': 0.05641435251849275, 'psi': 0.9830140154098171}-{'f1_val': 0.9973670153333725, 'auprc': 0.99826849223608, 'loss_val': 0.025705002532431086, 'psi': 0.9977276060944555}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.486745 cos_to_last_merge=0.9784 (last merge round=24)
[S4] round=50 local utility u=0.062465 metrics={'f1_val': 0.9372687138127609, 'auprc': 0.966624273336105, 'loss_val': 0.3008370472351443, 'psi': 0.9490109376220985}-{'f1_val': 0.935457300699905, 'auprc': 0.9413161562412256, 'loss_val': 0.3389745656435887, 'psi': 0.9378008429164332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=50 head_norm_before_train=1.520834 cos_to_last_merge=0.9117 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=50 local utility u=0.313681 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9984928904575673, 'loss_val': 0.053156734233846085, 'psi': 0.9974183372701015}-{'f1_val': 0.9118770049817305, 'auprc': 0.9895811607815366, 'loss_val': 0.14483439698012346, 'psi': 0.9429586673016529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=50 head_norm_before_train=1.541311 cos_to_last_merge=0.8995 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=50 local utility u=0.620447 metrics={'f1_val': 0.7738273145294668, 'auprc': 0.9635777471627487, 'loss_val': 0.5512453951785855, 'psi': 0.8497274875827796}-{'f1_val': 0.6082377556723734, 'auprc': 0.9561242415755269, 'loss_val': 0.7762407671268539, 'psi': 0.7473923500336348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=50 head_norm_before_train=1.202766 cos_to_last_merge=0.9089 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=50 local utility u=0.565868 metrics={'f1_val': 0.6905536982521393, 'auprc': 0.8732569328868323, 'loss_val': 0.3925644734033997, 'psi': 0.7636349921060165}-{'f1_val': 0.5850492792276646, 'auprc': 0.7922703188455489, 'loss_val': 0.6483143916128172, 'psi': 0.6679376950748184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=50 head_norm_before_train=2.066962 cos_to_last_merge=0.9973 (last merge round=26)
[S8] round=50 local utility u=0.405391 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9991432987517377, 'loss_val': 0.032324218214176186, 'psi': 0.9953116559237707}-{'f1_val': 0.8919786240479444, 'auprc': 0.9991312549474871, 'loss_val': 0.23839756736243417, 'psi': 0.9348396764077616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=50 head_norm_before_train=1.899458 cos_to_last_merge=0.9833 (last merge round=25)
[S9] round=50 local utility u=0.008334 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988030758960889, 'loss_val': 0.020322730803256396, 'psi': 0.9977829778657212}-{'f1_val': 0.9950237510807955, 'auprc': 0.9987752918499491, 'loss_val': 0.024432033059999782, 'psi': 0.996524367388457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=50 head_norm_before_train=1.953794 cos_to_last_merge=0.7631 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.763
[S10] round=50 local utility u=0.000198 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969402946188963, 'loss_val': 0.03636192220131469, 'psi': 0.9947605430801014}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969917273923347, 'loss_val': 0.03691151700407254, 'psi': 0.9947811161894768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=50 head_norm_before_train=2.039373 cos_to_last_merge=0.9780 (last merge round=26)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9360227806304137, 'auprc': 0.9953188084598202, 'loss_val': 0.09754364298756672, 'psi': 0.9597411917621763}-{'f1_val': 0.9961336749133093, 'auprc': 0.9970463900977659, 'loss_val': 0.037268393568083945, 'psi': 0.9964987609870919}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.632095 cos_to_last_merge=0.9408 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.6716656289530603, 'auprc': 0.7927801975171014, 'loss_val': 0.7679159560252069, 'psi': 0.7201114563786768}-{'f1_val': 0.6942347658279637, 'auprc': 0.7877248793559504, 'loss_val': 0.8402636203899082, 'psi': 0.7316308112391584}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=1.900009 cos_to_last_merge=0.7023 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.702
[S14] round=50 local utility u=0.008638 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969758831441218, 'loss_val': 0.024898951159849445, 'psi': 0.9973810240875609}-{'f1_val': 0.9955709227491966, 'auprc': 0.9984458075849314, 'loss_val': 0.03410436987219374, 'psi': 0.9967208766834905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=50 head_norm_before_train=1.920057 cos_to_last_merge=0.9653 (last merge round=22)
[S15] round=50 local utility u=0.370941 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9974203314453796, 'loss_val': 0.029953430759151925, 'psi': 0.9967675790874364}-{'f1_val': 0.9013277441892558, 'auprc': 0.9962090333160769, 'loss_val': 0.19817320088861204, 'psi': 0.9392802598399842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=50 head_norm_before_train=1.667259 cos_to_last_merge=0.9408 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.941
[S16] round=50 local utility u=0.076835 metrics={'f1_val': 0.8931855467293977, 'auprc': 0.9960653432497057, 'loss_val': 0.3818002409631833, 'psi': 0.9343374653375208}-{'f1_val': 0.8807954877077515, 'auprc': 0.9967354780606251, 'loss_val': 0.46313997345783314, 'psi': 0.927171483848901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=50 head_norm_before_train=1.721529 cos_to_last_merge=0.9407 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=50 local utility u=0.355299 metrics={'f1_val': 0.5852969438668335, 'auprc': 0.8669926657607734, 'loss_val': 0.9192172966593797, 'psi': 0.6979752326244095}-{'f1_val': 0.5354893943819916, 'auprc': 0.7794313768790598, 'loss_val': 1.068285654150192, 'psi': 0.633066187380819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=51 head_norm_before_train=1.943941 cos_to_last_merge=0.9683 (last merge round=21)
[S2] round=51 local utility u=0.007346 metrics={'f1_val': 0.8301835793538164, 'auprc': 0.8581650842945612, 'loss_val': 0.3215575025350967, 'psi': 0.8413761813301143}-{'f1_val': 0.8093856336522798, 'auprc': 0.92469807603047, 'loss_val': 0.4110611812169433, 'psi': 0.8555106106035559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=51 head_norm_before_train=1.735300 cos_to_last_merge=0.9602 (last merge round=25)
[S3] round=51 local utility u=0.006645 metrics={'f1_val': 0.9746456354643639, 'auprc': 0.9982406545475766, 'loss_val': 0.05381752519813625, 'psi': 0.984083643097649}-{'f1_val': 0.972865017655, 'auprc': 0.9982375120420428, 'loss_val': 0.05641435251849275, 'psi': 0.9830140154098171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=51 head_norm_before_train=1.486950 cos_to_last_merge=0.9775 (last merge round=24)
[S4] round=51 local utility u=0.060306 metrics={'f1_val': 0.9482891563492839, 'auprc': 0.9775508675203273, 'loss_val': 0.27912652338774263, 'psi': 0.9599938408177012}-{'f1_val': 0.9372687138127609, 'auprc': 0.966624273336105, 'loss_val': 0.3008370472351443, 'psi': 0.9490109376220985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=51 head_norm_before_train=1.536079 cos_to_last_merge=0.9095 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.909
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9921361323843874, 'loss_val': 0.05861304752670409, 'psi': 0.994654740131889}-{'f1_val': 0.9967019684784577, 'auprc': 0.9984928904575673, 'loss_val': 0.053156734233846085, 'psi': 0.9974183372701015}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.546520 cos_to_last_merge=0.8987 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=51 local utility u=0.876716 metrics={'f1_val': 0.9769187504670764, 'auprc': 0.9914852665824657, 'loss_val': 0.10008484333635559, 'psi': 0.9827453569132322}-{'f1_val': 0.7738273145294668, 'auprc': 0.9635777471627487, 'loss_val': 0.5512453951785855, 'psi': 0.8497274875827796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=51 head_norm_before_train=1.212727 cos_to_last_merge=0.9071 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.907
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.5217293967130144, 'auprc': 0.7813101982346385, 'loss_val': 0.8737738021174493, 'psi': 0.6255617173216641}-{'f1_val': 0.6905536982521393, 'auprc': 0.8732569328868323, 'loss_val': 0.3925644734033997, 'psi': 0.7636349921060165}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=2.073881 cos_to_last_merge=0.9972 (last merge round=26)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.97654063587235, 'auprc': 0.9868994308509413, 'loss_val': 0.07712748329881024, 'psi': 0.9806841538637865}-{'f1_val': 0.9927572273717925, 'auprc': 0.9991432987517377, 'loss_val': 0.032324218214176186, 'psi': 0.9953116559237707}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=1.905972 cos_to_last_merge=0.9829 (last merge round=25)
[S9] round=51 local utility u=0.000194 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9988006211847535, 'loss_val': 0.019910773381326893, 'psi': 0.9977802781974394}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988030758960889, 'loss_val': 0.020322730803256396, 'psi': 0.9977829778657212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=51 head_norm_before_train=1.962277 cos_to_last_merge=0.7626 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.763
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9930885249073472, 'auprc': 0.9969919718791409, 'loss_val': 0.03735458292277114, 'psi': 0.9946499036960647}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969402946188963, 'loss_val': 0.03636192220131469, 'psi': 0.9947605430801014}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=2.045513 cos_to_last_merge=0.9776 (last merge round=26)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.8355444864460281, 'auprc': 0.9954329455228339, 'loss_val': 0.24683644502379157, 'psi': 0.8994998700767504}-{'f1_val': 0.9360227806304137, 'auprc': 0.9953188084598202, 'loss_val': 0.09754364298756672, 'psi': 0.9597411917621763}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=51 head_norm_before_train=1.637248 cos_to_last_merge=0.9401 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.662065731402681, 'auprc': 0.7843409606615968, 'loss_val': 0.9512031276684549, 'psi': 0.7109758231062473}-{'f1_val': 0.6716656289530603, 'auprc': 0.7927801975171014, 'loss_val': 0.7679159560252069, 'psi': 0.7201114563786768}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=1.905950 cos_to_last_merge=0.7016 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.702
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.99697694280675, 'loss_val': 0.02287936123363575, 'psi': 0.9971349911461758}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969758831441218, 'loss_val': 0.024898951159849445, 'psi': 0.9973810240875609}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=51 head_norm_before_train=1.929002 cos_to_last_merge=0.9647 (last merge round=22)
[S15] round=51 local utility u=0.009078 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9987040100638945, 'loss_val': 0.018133661508688444, 'psi': 0.9975296050580702}-{'f1_val': 0.9963324108488076, 'auprc': 0.9974203314453796, 'loss_val': 0.029953430759151925, 'psi': 0.9967675790874364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=51 head_norm_before_train=1.676624 cos_to_last_merge=0.9398 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=51 local utility u=0.021791 metrics={'f1_val': 0.8969840161502729, 'auprc': 0.9960404036924388, 'loss_val': 0.3609345258073882, 'psi': 0.9366065711671393}-{'f1_val': 0.8931855467293977, 'auprc': 0.9960653432497057, 'loss_val': 0.3818002409631833, 'psi': 0.9343374653375208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=51 head_norm_before_train=1.734384 cos_to_last_merge=0.9389 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.939
[S17] round=51 local utility u=0.563867 metrics={'f1_val': 0.6911128648642835, 'auprc': 0.993225510895161, 'loss_val': 0.8050770785745903, 'psi': 0.8119579232766345}-{'f1_val': 0.5852969438668335, 'auprc': 0.8669926657607734, 'loss_val': 0.9192172966593797, 'psi': 0.6979752326244095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=52 head_norm_before_train=1.950487 cos_to_last_merge=0.9675 (last merge round=21)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.790799484165605, 'auprc': 0.8745280294820539, 'loss_val': 0.46660158525369383, 'psi': 0.8242909022921845}-{'f1_val': 0.8301835793538164, 'auprc': 0.8581650842945612, 'loss_val': 0.3215575025350967, 'psi': 0.8413761813301143}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=1.748166 cos_to_last_merge=0.9590 (last merge round=25)
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.9737565819597069, 'auprc': 0.9983269357704541, 'loss_val': 0.05417544042318945, 'psi': 0.9835847234840058}-{'f1_val': 0.9746456354643639, 'auprc': 0.9982406545475766, 'loss_val': 0.05381752519813625, 'psi': 0.984083643097649}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=1.490189 cos_to_last_merge=0.9767 (last merge round=24)
[S4] round=52 local utility u=0.018779 metrics={'f1_val': 0.9515356993997824, 'auprc': 0.9821501727369839, 'loss_val': 0.274846004778298, 'psi': 0.963781488734663}-{'f1_val': 0.9482891563492839, 'auprc': 0.9775508675203273, 'loss_val': 0.27912652338774263, 'psi': 0.9599938408177012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=52 head_norm_before_train=1.548598 cos_to_last_merge=0.9076 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.908
[S5] round=52 local utility u=0.004253 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9923742912466131, 'loss_val': 0.050821442745725344, 'psi': 0.9947500036767793}-{'f1_val': 0.9963338119635569, 'auprc': 0.9921361323843874, 'loss_val': 0.05861304752670409, 'psi': 0.994654740131889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=52 head_norm_before_train=1.552616 cos_to_last_merge=0.8979 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.6293668292645805, 'auprc': 0.8040398172676108, 'loss_val': 0.8410207553594967, 'psi': 0.6992360244657927}-{'f1_val': 0.9769187504670764, 'auprc': 0.9914852665824657, 'loss_val': 0.10008484333635559, 'psi': 0.9827453569132322}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.220325 cos_to_last_merge=0.9056 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.906
[S7] round=52 local utility u=0.719263 metrics={'f1_val': 0.6811565557722068, 'auprc': 0.808696848249582, 'loss_val': 0.473970989733302, 'psi': 0.7321726727631569}-{'f1_val': 0.5217293967130144, 'auprc': 0.7813101982346385, 'loss_val': 0.8737738021174493, 'psi': 0.6255617173216641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=52 head_norm_before_train=2.081657 cos_to_last_merge=0.9970 (last merge round=26)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9705945520203241, 'auprc': 0.9966019028298093, 'loss_val': 0.08070341129168576, 'psi': 0.9809974923441183}-{'f1_val': 0.97654063587235, 'auprc': 0.9868994308509413, 'loss_val': 0.07712748329881024, 'psi': 0.9806841538637865}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=1.912370 cos_to_last_merge=0.9825 (last merge round=25)
[S9] round=52 local utility u=0.000075 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988072751127834, 'loss_val': 0.019797919487753727, 'psi': 0.9977846575523991}-{'f1_val': 0.9971000495392299, 'auprc': 0.9988006211847535, 'loss_val': 0.019910773381326893, 'psi': 0.9977802781974394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=52 head_norm_before_train=1.964960 cos_to_last_merge=0.7625 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.762
[S10] round=52 local utility u=0.000827 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969863301546085, 'loss_val': 0.036996015477536684, 'psi': 0.9947789572943864}-{'f1_val': 0.9930885249073472, 'auprc': 0.9969919718791409, 'loss_val': 0.03735458292277114, 'psi': 0.9946499036960647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=52 head_norm_before_train=2.052358 cos_to_last_merge=0.9770 (last merge round=26)
[S11] round=52 local utility u=0.592169 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9969305705316089, 'loss_val': 0.03052691519497797, 'psi': 0.9964524331606291}-{'f1_val': 0.8355444864460281, 'auprc': 0.9954329455228339, 'loss_val': 0.24683644502379157, 'psi': 0.8994998700767504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=52 head_norm_before_train=1.642992 cos_to_last_merge=0.9393 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6004042544133964, 'auprc': 0.7791571848952014, 'loss_val': 1.080297352801534, 'psi': 0.6719054266061184}-{'f1_val': 0.662065731402681, 'auprc': 0.7843409606615968, 'loss_val': 0.9512031276684549, 'psi': 0.7109758231062473}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=1.913002 cos_to_last_merge=0.7008 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.701
[S14] round=52 local utility u=0.002587 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9986725293527243, 'loss_val': 0.022792084919791483, 'psi': 0.9978132257645655}-{'f1_val': 0.997240356705793, 'auprc': 0.99697694280675, 'loss_val': 0.02287936123363575, 'psi': 0.9971349911461758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=52 head_norm_before_train=1.938021 cos_to_last_merge=0.9641 (last merge round=22)
[S15] round=52 local utility u=0.001470 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9987295993432455, 'loss_val': 0.017854660392192155, 'psi': 0.9977982429440702}-{'f1_val': 0.9967466683875206, 'auprc': 0.9987040100638945, 'loss_val': 0.018133661508688444, 'psi': 0.9975296050580702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=52 head_norm_before_train=1.685941 cos_to_last_merge=0.9388 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.939
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.8885261137014642, 'auprc': 0.9962342442334284, 'loss_val': 0.42335605768249557, 'psi': 0.9316093659142499}-{'f1_val': 0.8969840161502729, 'auprc': 0.9960404036924388, 'loss_val': 0.3609345258073882, 'psi': 0.9366065711671393}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.748119 cos_to_last_merge=0.9363 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.48785806264386633, 'auprc': 0.7173704191134336, 'loss_val': 1.306443174003779, 'psi': 0.5796630052316932}-{'f1_val': 0.6911128648642835, 'auprc': 0.993225510895161, 'loss_val': 0.8050770785745903, 'psi': 0.8119579232766345}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=1.957832 cos_to_last_merge=0.9667 (last merge round=21)
[S2] round=53 local utility u=0.131486 metrics={'f1_val': 0.8308944441165399, 'auprc': 0.8500189507069165, 'loss_val': 0.3706712690988651, 'psi': 0.8385442467526905}-{'f1_val': 0.790799484165605, 'auprc': 0.8745280294820539, 'loss_val': 0.46660158525369383, 'psi': 0.8242909022921845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=53 head_norm_before_train=1.761237 cos_to_last_merge=0.9578 (last merge round=25)
[S3] round=53 local utility u=0.038123 metrics={'f1_val': 0.9838348379227521, 'auprc': 0.9982978259507908, 'loss_val': 0.03831106255641106, 'psi': 0.9896200331339675}-{'f1_val': 0.9737565819597069, 'auprc': 0.9983269357704541, 'loss_val': 0.05417544042318945, 'psi': 0.9835847234840058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=53 head_norm_before_train=1.498503 cos_to_last_merge=0.9761 (last merge round=24)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9463375046576686, 'auprc': 0.979981360420198, 'loss_val': 0.28081897626544566, 'psi': 0.9597950469626804}-{'f1_val': 0.9515356993997824, 'auprc': 0.9821501727369839, 'loss_val': 0.274846004778298, 'psi': 0.963781488734663}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.561980 cos_to_last_merge=0.9056 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=53 local utility u=0.010640 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9975186188126676, 'loss_val': 0.04497393115581681, 'psi': 0.9968077347032012}-{'f1_val': 0.9963338119635569, 'auprc': 0.9923742912466131, 'loss_val': 0.050821442745725344, 'psi': 0.9947500036767793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=53 head_norm_before_train=1.557731 cos_to_last_merge=0.8972 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.897
[S6] round=53 local utility u=0.181731 metrics={'f1_val': 0.6791971482406451, 'auprc': 0.8024899120084475, 'loss_val': 0.771891812549154, 'psi': 0.7285142537477661}-{'f1_val': 0.6293668292645805, 'auprc': 0.8040398172676108, 'loss_val': 0.8410207553594967, 'psi': 0.6992360244657927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=53 head_norm_before_train=1.226551 cos_to_last_merge=0.9045 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.6492905343307973, 'auprc': 0.795757764658779, 'loss_val': 0.5688343300744529, 'psi': 0.70787742646199}-{'f1_val': 0.6811565557722068, 'auprc': 0.808696848249582, 'loss_val': 0.473970989733302, 'psi': 0.7321726727631569}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=2.088054 cos_to_last_merge=0.9969 (last merge round=26)
[S8] round=53 local utility u=0.093014 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9992637165636774, 'loss_val': 0.03233558171705674, 'psi': 0.9950296425841557}-{'f1_val': 0.9705945520203241, 'auprc': 0.9966019028298093, 'loss_val': 0.08070341129168576, 'psi': 0.9809974923441183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=53 head_norm_before_train=1.918760 cos_to_last_merge=0.9821 (last merge round=25)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.997109318585981, 'loss_val': 0.020323043324918768, 'psi': 0.9968592221932497}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988072751127834, 'loss_val': 0.019797919487753727, 'psi': 0.9977846575523991}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=1.970116 cos_to_last_merge=0.7622 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.762
[S10] round=53 local utility u=0.000052 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969758660493463, 'loss_val': 0.036860803266739184, 'psi': 0.9947747716522815}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969863301546085, 'loss_val': 0.036996015477536684, 'psi': 0.9947789572943864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=53 head_norm_before_train=2.058823 cos_to_last_merge=0.9765 (last merge round=26)
[S11] round=53 local utility u=0.003303 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9974666275147436, 'loss_val': 0.025528730945135653, 'psi': 0.996666855953883}-{'f1_val': 0.9961336749133093, 'auprc': 0.9969305705316089, 'loss_val': 0.03052691519497797, 'psi': 0.9964524331606291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=53 head_norm_before_train=1.651141 cos_to_last_merge=0.9382 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=53 local utility u=0.160945 metrics={'f1_val': 0.6271829184733517, 'auprc': 0.7841375975013795, 'loss_val': 0.934019685724815, 'psi': 0.6899647900845629}-{'f1_val': 0.6004042544133964, 'auprc': 0.7791571848952014, 'loss_val': 1.080297352801534, 'psi': 0.6719054266061184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=53 head_norm_before_train=1.919533 cos_to_last_merge=0.7001 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.700
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969757488034532, 'loss_val': 0.02525400406901608, 'psi': 0.997134513544857}-{'f1_val': 0.997240356705793, 'auprc': 0.9986725293527243, 'loss_val': 0.022792084919791483, 'psi': 0.9978132257645655}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=53 head_norm_before_train=1.947085 cos_to_last_merge=0.9635 (last merge round=22)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.9682271986794423, 'auprc': 0.9974088854618792, 'loss_val': 0.051688302717252776, 'psi': 0.979899873392417}-{'f1_val': 0.9971773386779533, 'auprc': 0.9987295993432455, 'loss_val': 0.017854660392192155, 'psi': 0.9977982429440702}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.692969 cos_to_last_merge=0.9382 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.8532177436485626, 'auprc': 0.988340291333375, 'loss_val': 0.7403416670798338, 'psi': 0.9072667627224875}-{'f1_val': 0.8885261137014642, 'auprc': 0.9962342442334284, 'loss_val': 0.42335605768249557, 'psi': 0.9316093659142499}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.757141 cos_to_last_merge=0.9350 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.4308061176829646, 'auprc': 0.6749761766311664, 'loss_val': 1.4560671227803947, 'psi': 0.5284741412622453}-{'f1_val': 0.48785806264386633, 'auprc': 0.7173704191134336, 'loss_val': 1.306443174003779, 'psi': 0.5796630052316932}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=1.964988 cos_to_last_merge=0.9659 (last merge round=21)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.7562593945419489, 'auprc': 0.8196905248413852, 'loss_val': 0.7058205230725477, 'psi': 0.7816318466617234}-{'f1_val': 0.8308944441165399, 'auprc': 0.8500189507069165, 'loss_val': 0.3706712690988651, 'psi': 0.8385442467526905}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=54 head_norm_before_train=1.772904 cos_to_last_merge=0.9566 (last merge round=25)
[S3] round=54 local utility u=0.037780 metrics={'f1_val': 0.9948994170532618, 'auprc': 0.9984585461056246, 'loss_val': 0.02962001069796133, 'psi': 0.9963230686742068}-{'f1_val': 0.9838348379227521, 'auprc': 0.9982978259507908, 'loss_val': 0.03831106255641106, 'psi': 0.9896200331339675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=54 head_norm_before_train=1.507999 cos_to_last_merge=0.9756 (last merge round=24)
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9459498368355045, 'auprc': 0.9800480012930158, 'loss_val': 0.28251769130614784, 'psi': 0.959589102618509}-{'f1_val': 0.9463375046576686, 'auprc': 0.979981360420198, 'loss_val': 0.28081897626544566, 'psi': 0.9597950469626804}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.573270 cos_to_last_merge=0.9036 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.904
[S5] round=54 local utility u=0.001270 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9978319598595888, 'loss_val': 0.043373016180197954, 'psi': 0.9969330711219696}-{'f1_val': 0.9963338119635569, 'auprc': 0.9975186188126676, 'loss_val': 0.04497393115581681, 'psi': 0.9968077347032012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=54 head_norm_before_train=1.564073 cos_to_last_merge=0.8963 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.896
[S6] round=54 local utility u=1.000000 metrics={'f1_val': 0.9372869357262279, 'auprc': 0.9664653280414737, 'loss_val': 0.23621759405504444, 'psi': 0.9489582926523262}-{'f1_val': 0.6791971482406451, 'auprc': 0.8024899120084475, 'loss_val': 0.771891812549154, 'psi': 0.7285142537477661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=54 head_norm_before_train=1.231675 cos_to_last_merge=0.9036 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.904
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.547456090235622, 'auprc': 0.783551777425517, 'loss_val': 0.7480992716827222, 'psi': 0.64189436511158}-{'f1_val': 0.6492905343307973, 'auprc': 0.795757764658779, 'loss_val': 0.5688343300744529, 'psi': 0.70787742646199}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=2.090954 cos_to_last_merge=0.9969 (last merge round=26)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9936566772467331, 'auprc': 0.996388408761638, 'loss_val': 0.034924501465374354, 'psi': 0.9947493698526951}-{'f1_val': 0.9922069265978078, 'auprc': 0.9992637165636774, 'loss_val': 0.03233558171705674, 'psi': 0.9950296425841557}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=1.926055 cos_to_last_merge=0.9816 (last merge round=25)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.998572348419556, 'loss_val': 0.026916702021169556, 'psi': 0.9961931291374438}-{'f1_val': 0.9966924912647621, 'auprc': 0.997109318585981, 'loss_val': 0.020323043324918768, 'psi': 0.9968592221932497}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=1.976704 cos_to_last_merge=0.7618 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.762
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969768379240036, 'loss_val': 0.036988606341289886, 'psi': 0.9947751604021444}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969758660493463, 'loss_val': 0.036860803266739184, 'psi': 0.9947747716522815}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=2.066199 cos_to_last_merge=0.9759 (last merge round=26)
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.9934947148231096, 'auprc': 0.9975851487865002, 'loss_val': 0.03248175852156412, 'psi': 0.9951308884084658}-{'f1_val': 0.9961336749133093, 'auprc': 0.9974666275147436, 'loss_val': 0.025528730945135653, 'psi': 0.996666855953883}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=54 head_norm_before_train=1.658442 cos_to_last_merge=0.9365 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.617293932090738, 'auprc': 0.7621224082372149, 'loss_val': 1.0119341983672552, 'psi': 0.6752253225493288}-{'f1_val': 0.6271829184733517, 'auprc': 0.7841375975013795, 'loss_val': 0.934019685724815, 'psi': 0.6899647900845629}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=1.925194 cos_to_last_merge=0.6997 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.700
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9957371719265123, 'loss_val': 0.036640705072769814, 'psi': 0.9967398304716403}-{'f1_val': 0.997240356705793, 'auprc': 0.9969757488034532, 'loss_val': 0.02525400406901608, 'psi': 0.997134513544857}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=1.955942 cos_to_last_merge=0.9629 (last merge round=22)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.9013470868748241, 'auprc': 0.9959459710653156, 'loss_val': 0.17034474101769403, 'psi': 0.9391866405510207}-{'f1_val': 0.9682271986794423, 'auprc': 0.9974088854618792, 'loss_val': 0.051688302717252776, 'psi': 0.979899873392417}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=1.699635 cos_to_last_merge=0.9376 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=54 local utility u=0.344309 metrics={'f1_val': 0.9127295857750247, 'auprc': 0.9846434137480753, 'loss_val': 0.3977035247262273, 'psi': 0.9414951169642449}-{'f1_val': 0.8532177436485626, 'auprc': 0.988340291333375, 'loss_val': 0.7403416670798338, 'psi': 0.9072667627224875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=54 head_norm_before_train=1.761280 cos_to_last_merge=0.9347 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=54 local utility u=1.000000 metrics={'f1_val': 0.9015045952891455, 'auprc': 0.9959656083286099, 'loss_val': 0.2125276796408975, 'psi': 0.9392890005049312}-{'f1_val': 0.4308061176829646, 'auprc': 0.6749761766311664, 'loss_val': 1.4560671227803947, 'psi': 0.5284741412622453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=55 head_norm_before_train=1.969615 cos_to_last_merge=0.9654 (last merge round=21)
[S2] round=55 local utility u=0.182921 metrics={'f1_val': 0.795429174999363, 'auprc': 0.7923675329538813, 'loss_val': 0.493028725345776, 'psi': 0.7942045181811703}-{'f1_val': 0.7562593945419489, 'auprc': 0.8196905248413852, 'loss_val': 0.7058205230725477, 'psi': 0.7816318466617234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=55 head_norm_before_train=1.784040 cos_to_last_merge=0.9556 (last merge round=25)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9948994170532618, 'auprc': 0.9985853705338072, 'loss_val': 0.030184660894949793, 'psi': 0.9963737984454799}-{'f1_val': 0.9948994170532618, 'auprc': 0.9984585461056246, 'loss_val': 0.02962001069796133, 'psi': 0.9963230686742068}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.518102 cos_to_last_merge=0.9751 (last merge round=24)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9426488632011435, 'auprc': 0.9770346204550134, 'loss_val': 0.28800310819308605, 'psi': 0.9564031661026915}-{'f1_val': 0.9459498368355045, 'auprc': 0.9800480012930158, 'loss_val': 0.28251769130614784, 'psi': 0.959589102618509}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.584851 cos_to_last_merge=0.9015 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.901
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.991573653368039, 'loss_val': 0.04543211661923871, 'psi': 0.9944297485253497}-{'f1_val': 0.9963338119635569, 'auprc': 0.9978319598595888, 'loss_val': 0.043373016180197954, 'psi': 0.9969330711219696}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.573068 cos_to_last_merge=0.8951 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.895
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.6772204934337985, 'auprc': 0.7940101549636127, 'loss_val': 0.8259799384464234, 'psi': 0.7239363580457242}-{'f1_val': 0.9372869357262279, 'auprc': 0.9664653280414737, 'loss_val': 0.23621759405504444, 'psi': 0.9489582926523262}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.239528 cos_to_last_merge=0.9021 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.902
[S7] round=55 local utility u=0.629504 metrics={'f1_val': 0.682493790852025, 'auprc': 0.8282042235100777, 'loss_val': 0.4332741409454906, 'psi': 0.7407779639152461}-{'f1_val': 0.547456090235622, 'auprc': 0.783551777425517, 'loss_val': 0.7480992716827222, 'psi': 0.64189436511158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=55 head_norm_before_train=2.093755 cos_to_last_merge=0.9968 (last merge round=26)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.8888517990303165, 'auprc': 0.9986208358551769, 'loss_val': 0.21889842954529362, 'psi': 0.9327594137602606}-{'f1_val': 0.9936566772467331, 'auprc': 0.996388408761638, 'loss_val': 0.034924501465374354, 'psi': 0.9947493698526951}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=1.931891 cos_to_last_merge=0.9812 (last merge round=25)
[S9] round=55 local utility u=0.012239 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991940006631883, 'loss_val': 0.019278567108198228, 'psi': 0.997939347772561}-{'f1_val': 0.9946069829493691, 'auprc': 0.998572348419556, 'loss_val': 0.026916702021169556, 'psi': 0.9961931291374438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=55 head_norm_before_train=1.983909 cos_to_last_merge=0.7613 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.761
[S10] round=55 local utility u=0.000121 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9969558665419983, 'loss_val': 0.036682851166064644, 'psi': 0.9947667718493423}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969768379240036, 'loss_val': 0.036988606341289886, 'psi': 0.9947751604021444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=55 head_norm_before_train=2.069455 cos_to_last_merge=0.9753 (last merge round=26)
[S11] round=55 local utility u=0.014071 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976711188581188, 'loss_val': 0.022911341617389364, 'psi': 0.9969966502514013}-{'f1_val': 0.9934947148231096, 'auprc': 0.9975851487865002, 'loss_val': 0.03248175852156412, 'psi': 0.9951308884084658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=55 head_norm_before_train=1.663078 cos_to_last_merge=0.9352 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=55 local utility u=0.259959 metrics={'f1_val': 0.6618104223065086, 'auprc': 0.7688413320520786, 'loss_val': 0.7792724238393278, 'psi': 0.7046227862047366}-{'f1_val': 0.617293932090738, 'auprc': 0.7621224082372149, 'loss_val': 1.0119341983672552, 'psi': 0.6752253225493288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=55 head_norm_before_train=1.931887 cos_to_last_merge=0.6991 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.699
[S14] round=55 local utility u=0.007255 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9969756155273015, 'loss_val': 0.0235176396705282, 'psi': 0.997002419884646}-{'f1_val': 0.9974082695017256, 'auprc': 0.9957371719265123, 'loss_val': 0.036640705072769814, 'psi': 0.9967398304716403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=55 head_norm_before_train=1.964303 cos_to_last_merge=0.9624 (last merge round=22)
[S15] round=55 local utility u=0.329349 metrics={'f1_val': 0.987939970038929, 'auprc': 0.9973549940051805, 'loss_val': 0.035431851916893145, 'psi': 0.9917059796254295}-{'f1_val': 0.9013470868748241, 'auprc': 0.9959459710653156, 'loss_val': 0.17034474101769403, 'psi': 0.9391866405510207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=55 head_norm_before_train=1.706309 cos_to_last_merge=0.9370 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.937
[S16] round=55 local utility u=0.428757 metrics={'f1_val': 0.9932375859311773, 'auprc': 0.9885015355462776, 'loss_val': 0.03481194161279241, 'psi': 0.9913431657772174}-{'f1_val': 0.9127295857750247, 'auprc': 0.9846434137480753, 'loss_val': 0.3977035247262273, 'psi': 0.9414951169642449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=55 head_norm_before_train=1.762373 cos_to_last_merge=0.9350 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.62400253578785, 'auprc': 0.9840998904940619, 'loss_val': 0.808099522995679, 'psi': 0.7680414776703348}-{'f1_val': 0.9015045952891455, 'auprc': 0.9959656083286099, 'loss_val': 0.2125276796408975, 'psi': 0.9392890005049312}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=56 head_norm_before_train=1.975174 cos_to_last_merge=0.9649 (last merge round=21)
[S2] round=56 local utility u=0.344434 metrics={'f1_val': 0.8287777093734265, 'auprc': 0.9251906126978069, 'loss_val': 0.40272151140649887, 'psi': 0.8673428707031787}-{'f1_val': 0.795429174999363, 'auprc': 0.7923675329538813, 'loss_val': 0.493028725345776, 'psi': 0.7942045181811703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=56 head_norm_before_train=1.796075 cos_to_last_merge=0.9545 (last merge round=25)
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9984815711434089, 'loss_val': 0.10454648021544447, 'psi': 0.9760376796970358}-{'f1_val': 0.9948994170532618, 'auprc': 0.9985853705338072, 'loss_val': 0.030184660894949793, 'psi': 0.9963737984454799}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.522653 cos_to_last_merge=0.9748 (last merge round=24)
[S4] round=56 local utility u=0.048166 metrics={'f1_val': 0.9537290096691617, 'auprc': 0.9818519643181743, 'loss_val': 0.2726039294699807, 'psi': 0.9649781915287668}-{'f1_val': 0.9426488632011435, 'auprc': 0.9770346204550134, 'loss_val': 0.28800310819308605, 'psi': 0.9564031661026915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=56 head_norm_before_train=1.593680 cos_to_last_merge=0.8998 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.900
[S5] round=56 local utility u=0.002800 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9922319026635864, 'loss_val': 0.04180742502046518, 'psi': 0.9946930482435686}-{'f1_val': 0.9963338119635569, 'auprc': 0.991573653368039, 'loss_val': 0.04543211661923871, 'psi': 0.9944297485253497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=56 head_norm_before_train=1.579707 cos_to_last_merge=0.8941 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=56 local utility u=1.000000 metrics={'f1_val': 0.8664524440967861, 'auprc': 0.9768612714876469, 'loss_val': 0.23115183893629312, 'psi': 0.9106159750531304}-{'f1_val': 0.6772204934337985, 'auprc': 0.7940101549636127, 'loss_val': 0.8259799384464234, 'psi': 0.7239363580457242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=56 head_norm_before_train=1.248153 cos_to_last_merge=0.9006 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.901
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.47217633210146187, 'auprc': 0.7813394870072611, 'loss_val': 1.0050864077672925, 'psi': 0.5958415940637816}-{'f1_val': 0.682493790852025, 'auprc': 0.8282042235100777, 'loss_val': 0.4332741409454906, 'psi': 0.7407779639152461}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=2.098409 cos_to_last_merge=0.9967 (last merge round=26)
[S8] round=56 local utility u=0.404334 metrics={'f1_val': 0.9925028268365944, 'auprc': 0.9991947878351483, 'loss_val': 0.03385764568875076, 'psi': 0.9951796112360158}-{'f1_val': 0.8888517990303165, 'auprc': 0.9986208358551769, 'loss_val': 0.21889842954529362, 'psi': 0.9327594137602606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=56 head_norm_before_train=1.938537 cos_to_last_merge=0.9808 (last merge round=25)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9957820518364, 'loss_val': 0.019384537512754003, 'psi': 0.9963283154934173}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991940006631883, 'loss_val': 0.019278567108198228, 'psi': 0.997939347772561}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=1.986189 cos_to_last_merge=0.7613 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.761
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9969953163074936, 'loss_val': 0.03767938816018649, 'psi': 0.9945700725407924}-{'f1_val': 0.9933073753875716, 'auprc': 0.9969558665419983, 'loss_val': 0.036682851166064644, 'psi': 0.9947667718493423}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=2.074889 cos_to_last_merge=0.9747 (last merge round=26)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9970478736949308, 'loss_val': 0.028089749799182853, 'psi': 0.9964993544259579}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976711188581188, 'loss_val': 0.022911341617389364, 'psi': 0.9969966502514013}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.667240 cos_to_last_merge=0.9345 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6155022543444699, 'auprc': 0.7143122091445452, 'loss_val': 1.0588331382812664, 'psi': 0.6550262362645001}-{'f1_val': 0.6618104223065086, 'auprc': 0.7688413320520786, 'loss_val': 0.7792724238393278, 'psi': 0.7046227862047366}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=1.938784 cos_to_last_merge=0.6989 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.699
[S14] round=56 local utility u=0.004193 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9986742031258807, 'loss_val': 0.024012206318915014, 'psi': 0.9980603520802644}-{'f1_val': 0.9970202894562089, 'auprc': 0.9969756155273015, 'loss_val': 0.0235176396705282, 'psi': 0.997002419884646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=56 head_norm_before_train=1.972634 cos_to_last_merge=0.9618 (last merge round=22)
[S15] round=56 local utility u=0.036436 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985247162615409, 'loss_val': 0.01890881822757259, 'psi': 0.9974578875371287}-{'f1_val': 0.987939970038929, 'auprc': 0.9973549940051805, 'loss_val': 0.035431851916893145, 'psi': 0.9917059796254295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=56 head_norm_before_train=1.712418 cos_to_last_merge=0.9365 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.937
[S16] round=56 local utility u=0.001451 metrics={'f1_val': 0.9936061294502886, 'auprc': 0.989036454649472, 'loss_val': 0.03572622181765544, 'psi': 0.9917782595299619}-{'f1_val': 0.9932375859311773, 'auprc': 0.9885015355462776, 'loss_val': 0.03481194161279241, 'psi': 0.9913431657772174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=56 head_norm_before_train=1.764026 cos_to_last_merge=0.9348 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.6024836545945497, 'auprc': 0.9996520962849321, 'loss_val': 0.7846660424704955, 'psi': 0.7613510312707026}-{'f1_val': 0.62400253578785, 'auprc': 0.9840998904940619, 'loss_val': 0.808099522995679, 'psi': 0.7680414776703348}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=57 head_norm_before_train=1.981189 cos_to_last_merge=0.9644 (last merge round=21)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.8315576283941473, 'auprc': 0.8290822338363916, 'loss_val': 0.35545347437869573, 'psi': 0.8305674705710451}-{'f1_val': 0.8287777093734265, 'auprc': 0.9251906126978069, 'loss_val': 0.40272151140649887, 'psi': 0.8673428707031787}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=1.808017 cos_to_last_merge=0.9534 (last merge round=25)
[S3] round=57 local utility u=0.092365 metrics={'f1_val': 0.9826053740447527, 'auprc': 0.9984415150266852, 'loss_val': 0.048878324649890774, 'psi': 0.9889398304375256}-{'f1_val': 0.9610750853994537, 'auprc': 0.9984815711434089, 'loss_val': 0.10454648021544447, 'psi': 0.9760376796970358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=57 head_norm_before_train=1.524846 cos_to_last_merge=0.9744 (last merge round=24)
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9417405968795319, 'auprc': 0.9712044674506557, 'loss_val': 0.2928314552302604, 'psi': 0.9535261451079815}-{'f1_val': 0.9537290096691617, 'auprc': 0.9818519643181743, 'loss_val': 0.2726039294699807, 'psi': 0.9649781915287668}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.604119 cos_to_last_merge=0.8980 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.898
[S5] round=57 local utility u=0.000185 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9922391902491866, 'loss_val': 0.04145938274076622, 'psi': 0.9946959632778087}-{'f1_val': 0.9963338119635569, 'auprc': 0.9922319026635864, 'loss_val': 0.04180742502046518, 'psi': 0.9946930482435686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=57 head_norm_before_train=1.585621 cos_to_last_merge=0.8932 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.893
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.7691053052587522, 'auprc': 0.9548976971217471, 'loss_val': 0.6045852341670821, 'psi': 0.8434222620039502}-{'f1_val': 0.8664524440967861, 'auprc': 0.9768612714876469, 'loss_val': 0.23115183893629312, 'psi': 0.9106159750531304}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.254165 cos_to_last_merge=0.8995 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.899
[S7] round=57 local utility u=0.666424 metrics={'f1_val': 0.6141275687795028, 'auprc': 0.8016822239458553, 'loss_val': 0.5849742018138548, 'psi': 0.6891494308460439}-{'f1_val': 0.47217633210146187, 'auprc': 0.7813394870072611, 'loss_val': 1.0050864077672925, 'psi': 0.5958415940637816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=57 head_norm_before_train=2.102642 cos_to_last_merge=0.9967 (last merge round=26)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9927548269253964, 'auprc': 0.9981131724728738, 'loss_val': 0.045033238466214, 'psi': 0.9948981651443873}-{'f1_val': 0.9925028268365944, 'auprc': 0.9991947878351483, 'loss_val': 0.03385764568875076, 'psi': 0.9951796112360158}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=1.943817 cos_to_last_merge=0.9805 (last merge round=25)
[S9] round=57 local utility u=0.002858 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9991984955765069, 'loss_val': 0.019886368743237594, 'psi': 0.9972918194169151}-{'f1_val': 0.9966924912647621, 'auprc': 0.9957820518364, 'loss_val': 0.019384537512754003, 'psi': 0.9963283154934173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=57 head_norm_before_train=1.990377 cos_to_last_merge=0.7610 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.761
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9930885249073472, 'auprc': 0.9967728906856135, 'loss_val': 0.03847609292724581, 'psi': 0.9945622712186537}-{'f1_val': 0.9929532433629917, 'auprc': 0.9969953163074936, 'loss_val': 0.03767938816018649, 'psi': 0.9945700725407924}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=57 head_norm_before_train=2.079985 cos_to_last_merge=0.9742 (last merge round=26)
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.970994969835449, 'auprc': 0.9958483664818121, 'loss_val': 0.0664082677022039, 'psi': 0.9809363284939943}-{'f1_val': 0.9961336749133093, 'auprc': 0.9970478736949308, 'loss_val': 0.028089749799182853, 'psi': 0.9964993544259579}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.669943 cos_to_last_merge=0.9338 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.934
[S13] round=57 local utility u=0.382953 metrics={'f1_val': 0.6637947851441923, 'auprc': 0.7781579361819695, 'loss_val': 0.7742199348367348, 'psi': 0.7095400455593033}-{'f1_val': 0.6155022543444699, 'auprc': 0.7143122091445452, 'loss_val': 1.0588331382812664, 'psi': 0.6550262362645001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=57 head_norm_before_train=1.946906 cos_to_last_merge=0.6985 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.699
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9951539120677446, 'auprc': 0.9979047631435409, 'loss_val': 0.03573838617412655, 'psi': 0.9962542524980631}-{'f1_val': 0.9976511180498535, 'auprc': 0.9986742031258807, 'loss_val': 0.024012206318915014, 'psi': 0.9980603520802644}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=57 head_norm_before_train=1.980749 cos_to_last_merge=0.9613 (last merge round=22)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.8856116121774232, 'auprc': 0.9967003676996689, 'loss_val': 0.34015696713023136, 'psi': 0.9300471143863215}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985247162615409, 'loss_val': 0.01890881822757259, 'psi': 0.9974578875371287}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.718886 cos_to_last_merge=0.9359 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.936
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.9939587257637393, 'auprc': 0.9854688690567714, 'loss_val': 0.035209128181054025, 'psi': 0.9905627830809521}-{'f1_val': 0.9936061294502886, 'auprc': 0.989036454649472, 'loss_val': 0.03572622181765544, 'psi': 0.9917782595299619}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=1.770929 cos_to_last_merge=0.9339 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.934
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.5912369875440359, 'auprc': 0.9159706161611165, 'loss_val': 0.845877878036896, 'psi': 0.7211304389908682}-{'f1_val': 0.6024836545945497, 'auprc': 0.9996520962849321, 'loss_val': 0.7846660424704955, 'psi': 0.7613510312707026}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=58 head_norm_before_train=1.987865 cos_to_last_merge=0.9636 (last merge round=21)
[S2] round=58 local utility u=0.013196 metrics={'f1_val': 0.8268322894576607, 'auprc': 0.8840512982331711, 'loss_val': 0.46561700599510597, 'psi': 0.8497198929678649}-{'f1_val': 0.8315576283941473, 'auprc': 0.8290822338363916, 'loss_val': 0.35545347437869573, 'psi': 0.8305674705710451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=58 head_norm_before_train=1.818389 cos_to_last_merge=0.9524 (last merge round=25)
[S3] round=58 local utility u=0.055439 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9984567894081016, 'loss_val': 0.02697751070155057, 'psi': 0.9978389933351752}-{'f1_val': 0.9826053740447527, 'auprc': 0.9984415150266852, 'loss_val': 0.048878324649890774, 'psi': 0.9889398304375256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=58 head_norm_before_train=1.526891 cos_to_last_merge=0.9741 (last merge round=24)
[S4] round=58 local utility u=0.043954 metrics={'f1_val': 0.9512203439071182, 'auprc': 0.9763042247488886, 'loss_val': 0.27710182512363185, 'psi': 0.9612538962438264}-{'f1_val': 0.9417405968795319, 'auprc': 0.9712044674506557, 'loss_val': 0.2928314552302604, 'psi': 0.9535261451079815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=58 head_norm_before_train=1.615199 cos_to_last_merge=0.8963 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.896
[S5] round=58 local utility u=0.002837 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9927456581501107, 'loss_val': 0.03730436859755707, 'psi': 0.9948985504381784}-{'f1_val': 0.9963338119635569, 'auprc': 0.9922391902491866, 'loss_val': 0.04145938274076622, 'psi': 0.9946959632778087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=58 head_norm_before_train=1.592698 cos_to_last_merge=0.8922 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.892
[S6] round=58 local utility u=0.304408 metrics={'f1_val': 0.8252900388802125, 'auprc': 0.9655548483182567, 'loss_val': 0.3648495225124007, 'psi': 0.8813959626554302}-{'f1_val': 0.7691053052587522, 'auprc': 0.9548976971217471, 'loss_val': 0.6045852341670821, 'psi': 0.8434222620039502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=58 head_norm_before_train=1.259123 cos_to_last_merge=0.8986 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.899
[S7] round=58 local utility u=0.114817 metrics={'f1_val': 0.6432806289311184, 'auprc': 0.8032351945278451, 'loss_val': 0.5349182209008989, 'psi': 0.707262455169809}-{'f1_val': 0.6141275687795028, 'auprc': 0.8016822239458553, 'loss_val': 0.5849742018138548, 'psi': 0.6891494308460439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=58 head_norm_before_train=2.104074 cos_to_last_merge=0.9967 (last merge round=26)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9888520358145082, 'auprc': 0.9959367331671969, 'loss_val': 0.03844938221136507, 'psi': 0.9916859147555837}-{'f1_val': 0.9927548269253964, 'auprc': 0.9981131724728738, 'loss_val': 0.045033238466214, 'psi': 0.9948981651443873}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=1.949494 cos_to_last_merge=0.9801 (last merge round=25)
[S9] round=58 local utility u=0.005123 metrics={'f1_val': 0.9972945621169176, 'auprc': 0.999199439801388, 'loss_val': 0.01728601914499406, 'psi': 0.9980565131907058}-{'f1_val': 0.9960207019771873, 'auprc': 0.9991984955765069, 'loss_val': 0.019886368743237594, 'psi': 0.9972918194169151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=58 head_norm_before_train=1.996120 cos_to_last_merge=0.7607 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.761
[S10] round=58 local utility u=0.001341 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9969653786064464, 'loss_val': 0.03687235987208027, 'psi': 0.9946894077485083}-{'f1_val': 0.9930885249073472, 'auprc': 0.9967728906856135, 'loss_val': 0.03847609292724581, 'psi': 0.9945622712186537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=58 head_norm_before_train=2.085426 cos_to_last_merge=0.9737 (last merge round=26)
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.8925950089924257, 'auprc': 0.9954977621557164, 'loss_val': 0.1321270169061246, 'psi': 0.933756110257742}-{'f1_val': 0.970994969835449, 'auprc': 0.9958483664818121, 'loss_val': 0.0664082677022039, 'psi': 0.9809363284939943}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.673420 cos_to_last_merge=0.9334 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.933
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.6256715333117044, 'auprc': 0.7884205618097323, 'loss_val': 0.9261821757632459, 'psi': 0.6907711447109155}-{'f1_val': 0.6637947851441923, 'auprc': 0.7781579361819695, 'loss_val': 0.7742199348367348, 'psi': 0.7095400455593033}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=1.955915 cos_to_last_merge=0.6979 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.698
[S14] round=58 local utility u=0.012869 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969792610955488, 'loss_val': 0.02220712818910888, 'psi': 0.9973823752681317}-{'f1_val': 0.9951539120677446, 'auprc': 0.9979047631435409, 'loss_val': 0.03573838617412655, 'psi': 0.9962542524980631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=58 head_norm_before_train=1.988572 cos_to_last_merge=0.9608 (last merge round=22)
[S15] round=58 local utility u=0.112138 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9977740267644774, 'loss_val': 0.22445233633551012, 'psi': 0.9410117164236633}-{'f1_val': 0.8856116121774232, 'auprc': 0.9967003676996689, 'loss_val': 0.34015696713023136, 'psi': 0.9300471143863215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=58 head_norm_before_train=1.724755 cos_to_last_merge=0.9354 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.935
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.9933000740342921, 'auprc': 0.9873071709157514, 'loss_val': 0.03951126164357496, 'psi': 0.9909029127868758}-{'f1_val': 0.9939587257637393, 'auprc': 0.9854688690567714, 'loss_val': 0.035209128181054025, 'psi': 0.9905627830809521}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=1.776633 cos_to_last_merge=0.9334 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.5576189408650002, 'auprc': 0.790619456777322, 'loss_val': 1.161739023051889, 'psi': 0.650819147229929}-{'f1_val': 0.5912369875440359, 'auprc': 0.9159706161611165, 'loss_val': 0.845877878036896, 'psi': 0.7211304389908682}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=1.994444 cos_to_last_merge=0.9629 (last merge round=21)
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.7902038492999447, 'auprc': 0.8333662378282936, 'loss_val': 0.5605581361208725, 'psi': 0.8074688047112842}-{'f1_val': 0.8268322894576607, 'auprc': 0.8840512982331711, 'loss_val': 0.46561700599510597, 'psi': 0.8497198929678649}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.807 u=0.0000 p_local=0.0935 f1=0.790 auprc=0.833 bytes=66616
[S3] START round=59 head_norm_before_train=1.829150 cos_to_last_merge=0.9514 (last merge round=25)
[S3] round=59 local utility u=0.001631 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.998454501254576, 'loss_val': 0.02370774164873162, 'psi': 0.997838078073765}-{'f1_val': 0.9974271292865575, 'auprc': 0.9984567894081016, 'loss_val': 0.02697751070155057, 'psi': 0.9978389933351752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] r=60 psi=0.998 u=0.0016 p_local=0.0428 f1=0.997 auprc=0.998 bytes=66539
[S4] START round=59 head_norm_before_train=1.528019 cos_to_last_merge=0.9735 (last merge round=24)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9458600607046692, 'auprc': 0.9754335728616741, 'loss_val': 0.2858485899938481, 'psi': 0.9576894655674711}-{'f1_val': 0.9512203439071182, 'auprc': 0.9763042247488886, 'loss_val': 0.27710182512363185, 'psi': 0.9612538962438264}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.958 u=0.0000 p_local=0.0185 f1=0.946 auprc=0.975 bytes=57500
[S5] START round=59 head_norm_before_train=1.626882 cos_to_last_merge=0.8946 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.895
[S5] round=59 local utility u=0.005726 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9948458476533618, 'loss_val': 0.03436145299562863, 'psi': 0.9959595201484193}-{'f1_val': 0.9963338119635569, 'auprc': 0.9927456581501107, 'loss_val': 0.03730436859755707, 'psi': 0.9948985504381784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=60 psi=0.996 u=0.0057 p_local=0.0212 f1=0.997 auprc=0.995 bytes=70146
[S6] START round=59 head_norm_before_train=1.599167 cos_to_last_merge=0.8914 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.7747999798279073, 'auprc': 0.9754277028092875, 'loss_val': 0.41349997172838643, 'psi': 0.8550510690204594}-{'f1_val': 0.8252900388802125, 'auprc': 0.9655548483182567, 'loss_val': 0.3648495225124007, 'psi': 0.8813959626554302}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.855 u=0.0000 p_local=0.3022 f1=0.775 auprc=0.975 bytes=62843
[S7] START round=59 head_norm_before_train=1.264662 cos_to_last_merge=0.8977 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.898
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.6247512947326997, 'auprc': 0.7945859024797819, 'loss_val': 0.5761321932361996, 'psi': 0.6926851378315326}-{'f1_val': 0.6432806289311184, 'auprc': 0.8032351945278451, 'loss_val': 0.5349182209008989, 'psi': 0.707262455169809}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.693 u=0.0000 p_local=0.2180 f1=0.625 auprc=0.795 bytes=57633
[S8] START round=59 head_norm_before_train=2.104190 cos_to_last_merge=0.9967 (last merge round=26)
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.9655958945436245, 'auprc': 0.9947718663190169, 'loss_val': 0.11673694333931747, 'psi': 0.9772662832537814}-{'f1_val': 0.9888520358145082, 'auprc': 0.9959367331671969, 'loss_val': 0.03844938221136507, 'psi': 0.9916859147555837}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=60 psi=0.977 u=0.0000 p_local=0.0740 f1=0.966 auprc=0.995 bytes=64739
[S9] START round=59 head_norm_before_train=1.954738 cos_to_last_merge=0.9799 (last merge round=25)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9976595487074817, 'loss_val': 0.018052309298345257, 'psi': 0.9973444986416277}-{'f1_val': 0.9972945621169176, 'auprc': 0.999199439801388, 'loss_val': 0.01728601914499406, 'psi': 0.9980565131907058}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.997 u=0.0000 p_local=0.0031 f1=0.997 auprc=0.998 bytes=72024
[S10] START round=59 head_norm_before_train=2.002776 cos_to_last_merge=0.7602 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.760
[S10] round=59 local utility u=0.000115 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9969571196339517, 'loss_val': 0.03661742902500752, 'psi': 0.9946861041595105}-{'f1_val': 0.9931720938432163, 'auprc': 0.9969653786064464, 'loss_val': 0.03687235987208027, 'psi': 0.9946894077485083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] r=60 psi=0.995 u=0.0001 p_local=0.0003 f1=0.993 auprc=0.997 bytes=70150
[S11] START round=59 head_norm_before_train=2.091263 cos_to_last_merge=0.9732 (last merge round=26)
[S11] round=59 local utility u=0.362600 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9966270992133737, 'loss_val': 0.03154680116259021, 'psi': 0.9963310446333351}-{'f1_val': 0.8925950089924257, 'auprc': 0.9954977621557164, 'loss_val': 0.1321270169061246, 'psi': 0.933756110257742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=60 psi=0.996 u=0.3626 p_local=0.1044 f1=0.996 auprc=0.997 bytes=73857
[S13] START round=59 head_norm_before_train=1.678377 cos_to_last_merge=0.9325 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.933
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6125936944929652, 'auprc': 0.7717537840130096, 'loss_val': 1.0134292181870495, 'psi': 0.6762577303009829}-{'f1_val': 0.6256715333117044, 'auprc': 0.7884205618097323, 'loss_val': 0.9261821757632459, 'psi': 0.6907711447109155}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.676 u=0.0000 p_local=0.0867 f1=0.613 auprc=0.772 bytes=61171
[S14] START round=59 head_norm_before_train=1.963282 cos_to_last_merge=0.6973 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.697
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9969756357645091, 'loss_val': 0.022837814935671937, 'psi': 0.9967425932722538}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969792610955488, 'loss_val': 0.02220712818910888, 'psi': 0.9973823752681317}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0038 f1=0.997 auprc=0.997 bytes=70204
[S15] START round=59 head_norm_before_train=1.996251 cos_to_last_merge=0.9603 (last merge round=22)
[S15] round=59 local utility u=0.384469 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985165862954535, 'loss_val': 0.019201511429620025, 'psi': 0.9974546355506937}-{'f1_val': 0.903170176196454, 'auprc': 0.9977740267644774, 'loss_val': 0.22445233633551012, 'psi': 0.9410117164236633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S15] r=60 psi=0.997 u=0.3845 p_local=0.1441 f1=0.997 auprc=0.999 bytes=68342
[S16] START round=59 head_norm_before_train=1.731753 cos_to_last_merge=0.9346 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.935
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9922027668152875, 'auprc': 0.9882854523871263, 'loss_val': 0.041256516760896964, 'psi': 0.990635841044023}-{'f1_val': 0.9933000740342921, 'auprc': 0.9873071709157514, 'loss_val': 0.03951126164357496, 'psi': 0.9909029127868758}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.991 u=0.0000 p_local=0.0758 f1=0.992 auprc=0.988 bytes=62910
[S17] START round=59 head_norm_before_train=1.786802 cos_to_last_merge=0.9322 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.932
[S17] round=59 local utility u=0.621058 metrics={'f1_val': 0.6178517127674392, 'auprc': 0.945794506811076, 'loss_val': 0.7465440526558356, 'psi': 0.749028830384894}-{'f1_val': 0.5576189408650002, 'auprc': 0.790619456777322, 'loss_val': 1.161739023051889, 'psi': 0.650819147229929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S17] r=60 psi=0.749 u=0.6211 p_local=0.2287 f1=0.618 auprc=0.946 bytes=59321
[S2] START round=60 head_norm_before_train=1.999888 cos_to_last_merge=0.9623 (last merge round=21)
[S2] round=60 local utility u=0.206639 metrics={'f1_val': 0.8270255426660497, 'auprc': 0.8678062096989577, 'loss_val': 0.4715310368391271, 'psi': 0.8433378094792129}-{'f1_val': 0.7902038492999447, 'auprc': 0.8333662378282936, 'loss_val': 0.5605581361208725, 'psi': 0.8074688047112842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=60 head_norm_before_train=1.840140 cos_to_last_merge=0.9504 (last merge round=25)
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.9724918820927569, 'auprc': 0.9983240194337955, 'loss_val': 0.06434794736054586, 'psi': 0.9828247370291724}-{'f1_val': 0.9974271292865575, 'auprc': 0.998454501254576, 'loss_val': 0.02370774164873162, 'psi': 0.997838078073765}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=1.530918 cos_to_last_merge=0.9729 (last merge round=24)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9427813172025559, 'auprc': 0.9733119490342284, 'loss_val': 0.29009346385761053, 'psi': 0.9549935699352249}-{'f1_val': 0.9458600607046692, 'auprc': 0.9754335728616741, 'loss_val': 0.2858485899938481, 'psi': 0.9576894655674711}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.639727 cos_to_last_merge=0.8927 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.893
[S5] round=60 local utility u=0.006747 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9987984844242809, 'loss_val': 0.03272591346347585, 'psi': 0.9975405748567869}-{'f1_val': 0.9967019684784577, 'auprc': 0.9948458476533618, 'loss_val': 0.03436145299562863, 'psi': 0.9959595201484193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=60 head_norm_before_train=1.606121 cos_to_last_merge=0.8904 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.890
[S6] round=60 local utility u=0.347073 metrics={'f1_val': 0.8665237026687179, 'auprc': 0.9716239932253623, 'loss_val': 0.2582849743158022, 'psi': 0.9085638188913756}-{'f1_val': 0.7747999798279073, 'auprc': 0.9754277028092875, 'loss_val': 0.41349997172838643, 'psi': 0.8550510690204594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=60 head_norm_before_train=1.272983 cos_to_last_merge=0.8965 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.897
[S7] round=60 local utility u=0.000000 metrics={'f1_val': 0.5939252739832476, 'auprc': 0.7869247789156042, 'loss_val': 0.6543004884050627, 'psi': 0.6711250759561902}-{'f1_val': 0.6247512947326997, 'auprc': 0.7945859024797819, 'loss_val': 0.5761321932361996, 'psi': 0.6926851378315326}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=60 head_norm_before_train=2.103931 cos_to_last_merge=0.9967 (last merge round=26)
[S8] round=60 local utility u=0.131312 metrics={'f1_val': 0.9935456668823853, 'auprc': 0.9991803429464734, 'loss_val': 0.035036643854446534, 'psi': 0.9957995373080206}-{'f1_val': 0.9655958945436245, 'auprc': 0.9947718663190169, 'loss_val': 0.11673694333931747, 'psi': 0.9772662832537814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=60 head_norm_before_train=1.958519 cos_to_last_merge=0.9798 (last merge round=25)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9931335167423329, 'auprc': 0.9991983811126252, 'loss_val': 0.023906285004166992, 'psi': 0.9955594624904498}-{'f1_val': 0.9971344652643916, 'auprc': 0.9976595487074817, 'loss_val': 0.018052309298345257, 'psi': 0.9973444986416277}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=2.003819 cos_to_last_merge=0.7602 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.760
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9969927185845864, 'loss_val': 0.03732166975823322, 'psi': 0.9945690334516296}-{'f1_val': 0.9931720938432163, 'auprc': 0.9969571196339517, 'loss_val': 0.03661742902500752, 'psi': 0.9946861041595105}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=2.098682 cos_to_last_merge=0.9727 (last merge round=26)
[S11] round=60 local utility u=0.000000 metrics={'f1_val': 0.9740976096201773, 'auprc': 0.9951171484603398, 'loss_val': 0.06352157603714056, 'psi': 0.9825054251562424}-{'f1_val': 0.9961336749133093, 'auprc': 0.9966270992133737, 'loss_val': 0.03154680116259021, 'psi': 0.9963310446333351}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=60 head_norm_before_train=1.684813 cos_to_last_merge=0.9316 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=60 local utility u=0.091951 metrics={'f1_val': 0.6230027792148751, 'auprc': 0.7963574925855501, 'loss_val': 0.9657927410249066, 'psi': 0.6923446645631451}-{'f1_val': 0.6125936944929652, 'auprc': 0.7717537840130096, 'loss_val': 1.0134292181870495, 'psi': 0.6762577303009829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=60 head_norm_before_train=1.968362 cos_to_last_merge=0.6969 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.697
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9969762764300393, 'loss_val': 0.025970276966878803, 'psi': 0.9969909385005624}-{'f1_val': 0.9965872316107504, 'auprc': 0.9969756357645091, 'loss_val': 0.022837814935671937, 'psi': 0.9967425932722538}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=2.003550 cos_to_last_merge=0.9598 (last merge round=22)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.9557948396628284, 'auprc': 0.9968976349355353, 'loss_val': 0.06470493445261116, 'psi': 0.9722359577719111}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985165862954535, 'loss_val': 0.019201511429620025, 'psi': 0.9974546355506937}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=1.738866 cos_to_last_merge=0.9339 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.934
[S16] round=60 local utility u=0.000357 metrics={'f1_val': 0.9922027668152875, 'auprc': 0.9886945481373722, 'loss_val': 0.041770393425148294, 'psi': 0.9907994793441215}-{'f1_val': 0.9922027668152875, 'auprc': 0.9882854523871263, 'loss_val': 0.041256516760896964, 'psi': 0.990635841044023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=60 head_norm_before_train=1.798487 cos_to_last_merge=0.9307 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.931
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.6021664477342625, 'auprc': 0.8942332470469975, 'loss_val': 0.9683394735740294, 'psi': 0.7189931674593566}-{'f1_val': 0.6178517127674392, 'auprc': 0.945794506811076, 'loss_val': 0.7465440526558356, 'psi': 0.749028830384894}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=61 head_norm_before_train=2.002843 cos_to_last_merge=0.9622 (last merge round=21)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.8252606077140138, 'auprc': 0.869214788235362, 'loss_val': 0.4795242975766015, 'psi': 0.842842279922553}-{'f1_val': 0.8270255426660497, 'auprc': 0.8678062096989577, 'loss_val': 0.4715310368391271, 'psi': 0.8433378094792129}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=1.849964 cos_to_last_merge=0.9495 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9986530661695823, 'loss_val': 0.12739670623651453, 'psi': 0.9761062777075051}-{'f1_val': 0.9724918820927569, 'auprc': 0.9983240194337955, 'loss_val': 0.06434794736054586, 'psi': 0.9828247370291724}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.536827 cos_to_last_merge=0.9724 (last merge round=24)
[S4] round=61 local utility u=0.004664 metrics={'f1_val': 0.9434268307333559, 'auprc': 0.974673555008545, 'loss_val': 0.28872406998819944, 'psi': 0.9559255204434315}-{'f1_val': 0.9427813172025559, 'auprc': 0.9733119490342284, 'loss_val': 0.29009346385761053, 'psi': 0.9549935699352249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=61 head_norm_before_train=1.649135 cos_to_last_merge=0.8911 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.891
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9922429727602176, 'loss_val': 0.036450651735133656, 'psi': 0.9946974762822212}-{'f1_val': 0.9967019684784577, 'auprc': 0.9987984844242809, 'loss_val': 0.03272591346347585, 'psi': 0.9975405748567869}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.614267 cos_to_last_merge=0.8891 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.889
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.6480549718921683, 'auprc': 0.953607080624468, 'loss_val': 0.6044950991894719, 'psi': 0.7702758153850882}-{'f1_val': 0.8665237026687179, 'auprc': 0.9716239932253623, 'loss_val': 0.2582849743158022, 'psi': 0.9085638188913756}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.281256 cos_to_last_merge=0.8953 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.895
[S7] round=61 local utility u=0.056781 metrics={'f1_val': 0.6060261376427825, 'auprc': 0.7926173207269882, 'loss_val': 0.6304211302820454, 'psi': 0.6806626108764647}-{'f1_val': 0.5939252739832476, 'auprc': 0.7869247789156042, 'loss_val': 0.6543004884050627, 'psi': 0.6711250759561902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] START round=61 head_norm_before_train=2.105595 cos_to_last_merge=0.9966 (last merge round=26)
[S8] round=61 local utility u=0.003991 metrics={'f1_val': 0.9942782421240355, 'auprc': 0.9989639172846732, 'loss_val': 0.03080050083248024, 'psi': 0.9961525121882905}-{'f1_val': 0.9935456668823853, 'auprc': 0.9991803429464734, 'loss_val': 0.035036643854446534, 'psi': 0.9957995373080206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=61 head_norm_before_train=1.959940 cos_to_last_merge=0.9799 (last merge round=25)
[S9] round=61 local utility u=0.010959 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9991982183429343, 'loss_val': 0.01931137254196938, 'psi': 0.997291708523486}-{'f1_val': 0.9931335167423329, 'auprc': 0.9991983811126252, 'loss_val': 0.023906285004166992, 'psi': 0.9955594624904498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=61 head_norm_before_train=2.007787 cos_to_last_merge=0.7599 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.760
[S10] round=61 local utility u=0.000080 metrics={'f1_val': 0.9930885249073472, 'auprc': 0.9969931275694917, 'loss_val': 0.03797497652801312, 'psi': 0.994650365972205}-{'f1_val': 0.9929532433629917, 'auprc': 0.9969927185845864, 'loss_val': 0.03732166975823322, 'psi': 0.9945690334516296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=61 head_norm_before_train=2.103916 cos_to_last_merge=0.9723 (last merge round=26)
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.8549944257172404, 'auprc': 0.9954381121572473, 'loss_val': 0.19186150708148464, 'psi': 0.9111719002932432}-{'f1_val': 0.9740976096201773, 'auprc': 0.9951171484603398, 'loss_val': 0.06352157603714056, 'psi': 0.9825054251562424}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=1.689092 cos_to_last_merge=0.9307 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.931
[S13] round=61 local utility u=0.010568 metrics={'f1_val': 0.6506135142638517, 'auprc': 0.746892536883188, 'loss_val': 0.961926848709091, 'psi': 0.6891251233115863}-{'f1_val': 0.6230027792148751, 'auprc': 0.7963574925855501, 'loss_val': 0.9657927410249066, 'psi': 0.6923446645631451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=61 head_norm_before_train=1.973442 cos_to_last_merge=0.6964 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.696
[S14] round=61 local utility u=0.001415 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969757457291192, 'loss_val': 0.023119046497096625, 'psi': 0.9969888031862467}-{'f1_val': 0.9970007132142444, 'auprc': 0.9969762764300393, 'loss_val': 0.025970276966878803, 'psi': 0.9969909385005624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=61 head_norm_before_train=2.009889 cos_to_last_merge=0.9595 (last merge round=22)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.7748954527014897, 'auprc': 0.9958258707030465, 'loss_val': 0.4601015249146159, 'psi': 0.8632676199021124}-{'f1_val': 0.9557948396628284, 'auprc': 0.9968976349355353, 'loss_val': 0.06470493445261116, 'psi': 0.9722359577719111}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.744822 cos_to_last_merge=0.9332 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=61 local utility u=0.001437 metrics={'f1_val': 0.9924216950727743, 'auprc': 0.9890890503605689, 'loss_val': 0.04139436851600851, 'psi': 0.9910886371878922}-{'f1_val': 0.9922027668152875, 'auprc': 0.9886945481373722, 'loss_val': 0.041770393425148294, 'psi': 0.9907994793441215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=61 head_norm_before_train=1.812373 cos_to_last_merge=0.9289 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.929
[S17] round=61 local utility u=0.158370 metrics={'f1_val': 0.6193989105232374, 'auprc': 0.9366406321303767, 'loss_val': 0.8822167266250535, 'psi': 0.7462955991660931}-{'f1_val': 0.6021664477342625, 'auprc': 0.8942332470469975, 'loss_val': 0.9683394735740294, 'psi': 0.7189931674593566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=62 head_norm_before_train=2.006818 cos_to_last_merge=0.9619 (last merge round=21)
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.7021639951121328, 'auprc': 0.7758489273519504, 'loss_val': 0.8833104527419617, 'psi': 0.7316379680080598}-{'f1_val': 0.8252606077140138, 'auprc': 0.869214788235362, 'loss_val': 0.4795242975766015, 'psi': 0.842842279922553}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=1.858944 cos_to_last_merge=0.9487 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=62 local utility u=0.159066 metrics={'f1_val': 0.9970100543679847, 'auprc': 0.9987320764537821, 'loss_val': 0.025111839872461662, 'psi': 0.9976988632023037}-{'f1_val': 0.9610750853994537, 'auprc': 0.9986530661695823, 'loss_val': 0.12739670623651453, 'psi': 0.9761062777075051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=62 head_norm_before_train=1.544930 cos_to_last_merge=0.9718 (last merge round=24)
[S4] round=62 local utility u=0.008782 metrics={'f1_val': 0.945988057213447, 'auprc': 0.9751548253178615, 'loss_val': 0.28797096069828176, 'psi': 0.9576547644552128}-{'f1_val': 0.9434268307333559, 'auprc': 0.974673555008545, 'loss_val': 0.28872406998819944, 'psi': 0.9559255204434315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=62 head_norm_before_train=1.658479 cos_to_last_merge=0.8896 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.890
[S5] round=62 local utility u=0.004894 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9941699597196402, 'loss_val': 0.032444330116928315, 'psi': 0.9954682710659901}-{'f1_val': 0.9963338119635569, 'auprc': 0.9922429727602176, 'loss_val': 0.036450651735133656, 'psi': 0.9946974762822212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=62 head_norm_before_train=1.622739 cos_to_last_merge=0.8879 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.888
[S6] round=62 local utility u=0.714994 metrics={'f1_val': 0.8364085539348773, 'auprc': 0.9598890188123863, 'loss_val': 0.3234752157500917, 'psi': 0.8858007398858809}-{'f1_val': 0.6480549718921683, 'auprc': 0.953607080624468, 'loss_val': 0.6044950991894719, 'psi': 0.7702758153850882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=62 head_norm_before_train=1.289876 cos_to_last_merge=0.8940 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.894
[S7] round=62 local utility u=0.348626 metrics={'f1_val': 0.6704897265770624, 'auprc': 0.8240069233994223, 'loss_val': 0.4141201731791225, 'psi': 0.7318966053060063}-{'f1_val': 0.6060261376427825, 'auprc': 0.7926173207269882, 'loss_val': 0.6304211302820454, 'psi': 0.6806626108764647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] START round=62 head_norm_before_train=2.112913 cos_to_last_merge=0.9965 (last merge round=26)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9939539858461368, 'auprc': 0.999234846070687, 'loss_val': 0.029922813950659575, 'psi': 0.9960663299359569}-{'f1_val': 0.9942782421240355, 'auprc': 0.9989639172846732, 'loss_val': 0.03080050083248024, 'psi': 0.9961525121882905}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=1.963477 cos_to_last_merge=0.9797 (last merge round=25)
[S9] round=62 local utility u=0.002688 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984485723755017, 'loss_val': 0.01818004103031791, 'psi': 0.9976411764574864}-{'f1_val': 0.9960207019771873, 'auprc': 0.9991982183429343, 'loss_val': 0.01931137254196938, 'psi': 0.997291708523486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=62 head_norm_before_train=2.013399 cos_to_last_merge=0.7596 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.760
[S10] round=62 local utility u=0.001075 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9968988644643827, 'loss_val': 0.036044053191682586, 'psi': 0.9946628020916829}-{'f1_val': 0.9930885249073472, 'auprc': 0.9969931275694917, 'loss_val': 0.03797497652801312, 'psi': 0.994650365972205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=62 head_norm_before_train=2.104810 cos_to_last_merge=0.9719 (last merge round=26)
[S11] round=62 local utility u=0.497320 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.9952704580264493, 'loss_val': 0.046453002222230685, 'psi': 0.9960783677702931}-{'f1_val': 0.8549944257172404, 'auprc': 0.9954381121572473, 'loss_val': 0.19186150708148464, 'psi': 0.9111719002932432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=62 head_norm_before_train=1.694189 cos_to_last_merge=0.9302 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=62 local utility u=0.333546 metrics={'f1_val': 0.7337688025597142, 'auprc': 0.7856690418643473, 'loss_val': 0.9100954061241857, 'psi': 0.7545288982815674}-{'f1_val': 0.6506135142638517, 'auprc': 0.746892536883188, 'loss_val': 0.961926848709091, 'psi': 0.6891251233115863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=62 head_norm_before_train=1.980047 cos_to_last_merge=0.6960 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.696
[S14] round=62 local utility u=0.002857 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9986748861858894, 'loss_val': 0.026408292610182436, 'psi': 0.9980589814348231}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969757457291192, 'loss_val': 0.023119046497096625, 'psi': 0.9969888031862467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=62 head_norm_before_train=2.016076 cos_to_last_merge=0.9591 (last merge round=22)
[S15] round=62 local utility u=0.892245 metrics={'f1_val': 0.9968965306828483, 'auprc': 0.9990262352702988, 'loss_val': 0.017219880137393753, 'psi': 0.9977484125178285}-{'f1_val': 0.7748954527014897, 'auprc': 0.9958258707030465, 'loss_val': 0.4601015249146159, 'psi': 0.8632676199021124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=62 head_norm_before_train=1.749986 cos_to_last_merge=0.9329 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=62 local utility u=0.002871 metrics={'f1_val': 0.9924216950727743, 'auprc': 0.9911267782774013, 'loss_val': 0.04176635195030056, 'psi': 0.9919037283546251}-{'f1_val': 0.9924216950727743, 'auprc': 0.9890890503605689, 'loss_val': 0.04139436851600851, 'psi': 0.9910886371878922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=62 head_norm_before_train=1.822377 cos_to_last_merge=0.9277 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.928
[S17] round=62 local utility u=0.063426 metrics={'f1_val': 0.6347582931833649, 'auprc': 0.9473444942648714, 'loss_val': 0.8796327256156142, 'psi': 0.7597927736159675}-{'f1_val': 0.6193989105232374, 'auprc': 0.9366406321303767, 'loss_val': 0.8822167266250535, 'psi': 0.7462955991660931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=63 head_norm_before_train=2.009586 cos_to_last_merge=0.9617 (last merge round=21)
[S2] round=63 local utility u=0.621551 metrics={'f1_val': 0.8026372779377606, 'auprc': 0.8663773726711677, 'loss_val': 0.5146327273940009, 'psi': 0.8281333158311235}-{'f1_val': 0.7021639951121328, 'auprc': 0.7758489273519504, 'loss_val': 0.8833104527419617, 'psi': 0.7316379680080598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=63 head_norm_before_train=1.867582 cos_to_last_merge=0.9479 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.988785957764895, 'auprc': 0.9984473236566251, 'loss_val': 0.0433850874149153, 'psi': 0.9926505041215871}-{'f1_val': 0.9970100543679847, 'auprc': 0.9987320764537821, 'loss_val': 0.025111839872461662, 'psi': 0.9976988632023037}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.553528 cos_to_last_merge=0.9712 (last merge round=24)
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.9457992124748181, 'auprc': 0.96676731790592, 'loss_val': 0.2906105883269355, 'psi': 0.9541864546472588}-{'f1_val': 0.945988057213447, 'auprc': 0.9751548253178615, 'loss_val': 0.28797096069828176, 'psi': 0.9576547644552128}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.667701 cos_to_last_merge=0.8883 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.888
[S5] round=63 local utility u=0.007323 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9976761005052478, 'loss_val': 0.03052516748637357, 'psi': 0.9970916212891737}-{'f1_val': 0.9963338119635569, 'auprc': 0.9941699597196402, 'loss_val': 0.032444330116928315, 'psi': 0.9954682710659901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=63 head_norm_before_train=1.631027 cos_to_last_merge=0.8868 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=63 local utility u=0.257429 metrics={'f1_val': 0.8897061364379965, 'auprc': 0.9778074263296817, 'loss_val': 0.18215825781034894, 'psi': 0.9249466523946706}-{'f1_val': 0.8364085539348773, 'auprc': 0.9598890188123863, 'loss_val': 0.3234752157500917, 'psi': 0.8858007398858809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=63 head_norm_before_train=1.299806 cos_to_last_merge=0.8923 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.892
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.5405705790866717, 'auprc': 0.7840560330600399, 'loss_val': 0.789707900350743, 'psi': 0.637964760676019}-{'f1_val': 0.6704897265770624, 'auprc': 0.8240069233994223, 'loss_val': 0.4141201731791225, 'psi': 0.7318966053060063}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=2.122287 cos_to_last_merge=0.9963 (last merge round=26)
[S8] round=63 local utility u=0.000000 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.999176360917394, 'loss_val': 0.029749397805232752, 'psi': 0.9953851157367855}-{'f1_val': 0.9939539858461368, 'auprc': 0.999234846070687, 'loss_val': 0.029922813950659575, 'psi': 0.9960663299359569}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=63 head_norm_before_train=1.968921 cos_to_last_merge=0.9794 (last merge round=25)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9991826329969727, 'loss_val': 0.021770285442579706, 'psi': 0.9966873038472664}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984485723755017, 'loss_val': 0.01818004103031791, 'psi': 0.9976411764574864}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.019699 cos_to_last_merge=0.7592 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.759
[S10] round=63 local utility u=0.000815 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9968716109834418, 'loss_val': 0.03564499012260512, 'psi': 0.9947832545942713}-{'f1_val': 0.9931720938432163, 'auprc': 0.9968988644643827, 'loss_val': 0.036044053191682586, 'psi': 0.9946628020916829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=63 head_norm_before_train=2.109541 cos_to_last_merge=0.9714 (last merge round=26)
[S11] round=63 local utility u=0.013447 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9972395186528149, 'loss_val': 0.022566005482713217, 'psi': 0.9965760124091115}-{'f1_val': 0.9966169742661891, 'auprc': 0.9952704580264493, 'loss_val': 0.046453002222230685, 'psi': 0.9960783677702931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=63 head_norm_before_train=1.698135 cos_to_last_merge=0.9295 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=63 local utility u=0.126581 metrics={'f1_val': 0.741945625223581, 'auprc': 0.798357842544767, 'loss_val': 0.7440603578753273, 'psi': 0.7645105121520555}-{'f1_val': 0.7337688025597142, 'auprc': 0.7856690418643473, 'loss_val': 0.9100954061241857, 'psi': 0.7545288982815674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=63 head_norm_before_train=1.987144 cos_to_last_merge=0.6956 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.696
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9482754443736202, 'auprc': 0.9969780652994071, 'loss_val': 0.060269680657710316, 'psi': 0.967756492743935}-{'f1_val': 0.9976483782674455, 'auprc': 0.9986748861858894, 'loss_val': 0.026408292610182436, 'psi': 0.9980589814348231}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=2.022372 cos_to_last_merge=0.9587 (last merge round=22)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.9895237632536011, 'auprc': 0.9994559853892943, 'loss_val': 0.03117799649647649, 'psi': 0.9934966521078784}-{'f1_val': 0.9968965306828483, 'auprc': 0.9990262352702988, 'loss_val': 0.017219880137393753, 'psi': 0.9977484125178285}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.756191 cos_to_last_merge=0.9323 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.932
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9922027668152875, 'auprc': 0.9908141898452282, 'loss_val': 0.04198758359300923, 'psi': 0.9916473360272638}-{'f1_val': 0.9924216950727743, 'auprc': 0.9911267782774013, 'loss_val': 0.04176635195030056, 'psi': 0.9919037283546251}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=1.833776 cos_to_last_merge=0.9262 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.926
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.6110269195250042, 'auprc': 0.8713925384007744, 'loss_val': 0.9813446646046755, 'psi': 0.7151731670753123}-{'f1_val': 0.6347582931833649, 'auprc': 0.9473444942648714, 'loss_val': 0.8796327256156142, 'psi': 0.7597927736159675}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=2.012410 cos_to_last_merge=0.9615 (last merge round=21)
[S2] round=64 local utility u=0.066698 metrics={'f1_val': 0.8115224130831855, 'auprc': 0.8824130251038611, 'loss_val': 0.48265389739083076, 'psi': 0.8398786578914558}-{'f1_val': 0.8026372779377606, 'auprc': 0.8663773726711677, 'loss_val': 0.5146327273940009, 'psi': 0.8281333158311235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=64 head_norm_before_train=1.876400 cos_to_last_merge=0.9471 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.947
[S3] round=64 local utility u=0.031005 metrics={'f1_val': 0.9968332416810847, 'auprc': 0.9985613115821714, 'loss_val': 0.030000778570933053, 'psi': 0.9975244696415194}-{'f1_val': 0.988785957764895, 'auprc': 0.9984473236566251, 'loss_val': 0.0433850874149153, 'psi': 0.9926505041215871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=64 head_norm_before_train=1.560338 cos_to_last_merge=0.9707 (last merge round=24)
[S4] round=64 local utility u=0.014342 metrics={'f1_val': 0.9480239689459693, 'auprc': 0.9701688694209345, 'loss_val': 0.2854795144014125, 'psi': 0.9568819291359554}-{'f1_val': 0.9457992124748181, 'auprc': 0.96676731790592, 'loss_val': 0.2906105883269355, 'psi': 0.9541864546472588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=64 head_norm_before_train=1.679440 cos_to_last_merge=0.8868 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.887
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.992805509016243, 'loss_val': 0.03170036999834555, 'psi': 0.9949224907846312}-{'f1_val': 0.9967019684784577, 'auprc': 0.9976761005052478, 'loss_val': 0.03052516748637357, 'psi': 0.9970916212891737}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=1.640857 cos_to_last_merge=0.8856 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.886
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.8501125979998446, 'auprc': 0.9801494295988684, 'loss_val': 0.24839362912502616, 'psi': 0.9021273306394542}-{'f1_val': 0.8897061364379965, 'auprc': 0.9778074263296817, 'loss_val': 0.18215825781034894, 'psi': 0.9249466523946706}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.309542 cos_to_last_merge=0.8907 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.891
[S7] round=64 local utility u=0.690081 metrics={'f1_val': 0.6781057930529437, 'auprc': 0.8360086674870686, 'loss_val': 0.39061485051182987, 'psi': 0.7412669428265937}-{'f1_val': 0.5405705790866717, 'auprc': 0.7840560330600399, 'loss_val': 0.789707900350743, 'psi': 0.637964760676019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=64 head_norm_before_train=2.132692 cos_to_last_merge=0.9961 (last merge round=26)
[S8] round=64 local utility u=0.003610 metrics={'f1_val': 0.9941417884415487, 'auprc': 0.9986342700751918, 'loss_val': 0.02860750440944717, 'psi': 0.9959387810950059}-{'f1_val': 0.9928576189497129, 'auprc': 0.999176360917394, 'loss_val': 0.029749397805232752, 'psi': 0.9953851157367855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=64 head_norm_before_train=1.974441 cos_to_last_merge=0.9790 (last merge round=25)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9991859892867184, 'loss_val': 0.024925127008155194, 'psi': 0.995937547157264}-{'f1_val': 0.9950237510807955, 'auprc': 0.9991826329969727, 'loss_val': 0.021770285442579706, 'psi': 0.9966873038472664}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.024963 cos_to_last_merge=0.7590 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.759
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9965861148621276, 'loss_val': 0.03763742347046368, 'psi': 0.994406391962646}-{'f1_val': 0.993391017001491, 'auprc': 0.9968716109834418, 'loss_val': 0.03564499012260512, 'psi': 0.9947832545942713}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=2.116246 cos_to_last_merge=0.9708 (last merge round=26)
[S11] round=64 local utility u=0.003091 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975827511284244, 'loss_val': 0.0198937616429626, 'psi': 0.9969613031595235}-{'f1_val': 0.9961336749133093, 'auprc': 0.9972395186528149, 'loss_val': 0.022566005482713217, 'psi': 0.9965760124091115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=64 head_norm_before_train=1.701772 cos_to_last_merge=0.9293 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6611735651366647, 'auprc': 0.8011164144223188, 'loss_val': 0.9166316007286687, 'psi': 0.7171507048509264}-{'f1_val': 0.741945625223581, 'auprc': 0.798357842544767, 'loss_val': 0.7440603578753273, 'psi': 0.7645105121520555}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=1.991434 cos_to_last_merge=0.6958 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.696
[S14] round=64 local utility u=0.154662 metrics={'f1_val': 0.994934808751637, 'auprc': 0.9969761559024085, 'loss_val': 0.030895382803366473, 'psi': 0.9957513476119455}-{'f1_val': 0.9482754443736202, 'auprc': 0.9969780652994071, 'loss_val': 0.060269680657710316, 'psi': 0.967756492743935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=64 head_norm_before_train=2.029123 cos_to_last_merge=0.9582 (last merge round=22)
[S15] round=64 local utility u=0.025366 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977060120591906, 'loss_val': 0.018532645144358578, 'psi': 0.9971304058561886}-{'f1_val': 0.9895237632536011, 'auprc': 0.9994559853892943, 'loss_val': 0.03117799649647649, 'psi': 0.9934966521078784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=64 head_norm_before_train=1.762828 cos_to_last_merge=0.9316 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.932
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.9850175895062269, 'auprc': 0.989758992029077, 'loss_val': 0.06302099580351805, 'psi': 0.9869141505153669}-{'f1_val': 0.9922027668152875, 'auprc': 0.9908141898452282, 'loss_val': 0.04198758359300923, 'psi': 0.9916473360272638}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=1.843792 cos_to_last_merge=0.9249 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.925
[S17] round=64 local utility u=0.119625 metrics={'f1_val': 0.6373734661384517, 'auprc': 0.8569833014877111, 'loss_val': 0.8569455771907052, 'psi': 0.7252174002781555}-{'f1_val': 0.6110269195250042, 'auprc': 0.8713925384007744, 'loss_val': 0.9813446646046755, 'psi': 0.7151731670753123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=65 head_norm_before_train=2.017255 cos_to_last_merge=0.9610 (last merge round=21)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.6674928300595946, 'auprc': 0.8098079580293568, 'loss_val': 1.2796178352029526, 'psi': 0.7244188812474994}-{'f1_val': 0.8115224130831855, 'auprc': 0.8824130251038611, 'loss_val': 0.48265389739083076, 'psi': 0.8398786578914558}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=65 head_norm_before_train=1.885340 cos_to_last_merge=0.9464 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.9348958752843897, 'auprc': 0.9637784079611669, 'loss_val': 0.19411775671070505, 'psi': 0.9464488883551005}-{'f1_val': 0.9968332416810847, 'auprc': 0.9985613115821714, 'loss_val': 0.030000778570933053, 'psi': 0.9975244696415194}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.566679 cos_to_last_merge=0.9703 (last merge round=24)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9446023564321342, 'auprc': 0.9608057470281373, 'loss_val': 0.2953458930653462, 'psi': 0.9510837126705354}-{'f1_val': 0.9480239689459693, 'auprc': 0.9701688694209345, 'loss_val': 0.2854795144014125, 'psi': 0.9568819291359554}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.689338 cos_to_last_merge=0.8855 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.886
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9919257211612738, 'loss_val': 0.03189096308368419, 'psi': 0.9945705756426435}-{'f1_val': 0.9963338119635569, 'auprc': 0.992805509016243, 'loss_val': 0.03170036999834555, 'psi': 0.9949224907846312}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=1.648950 cos_to_last_merge=0.8847 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.885
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.62651697263099, 'auprc': 0.9474015761663436, 'loss_val': 0.6304327287792829, 'psi': 0.7548708140451315}-{'f1_val': 0.8501125979998446, 'auprc': 0.9801494295988684, 'loss_val': 0.24839362912502616, 'psi': 0.9021273306394542}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=1.317356 cos_to_last_merge=0.8895 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.890
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.5965305865737547, 'auprc': 0.7944034813857122, 'loss_val': 0.6436894747914108, 'psi': 0.6756797444985376}-{'f1_val': 0.6781057930529437, 'auprc': 0.8360086674870686, 'loss_val': 0.39061485051182987, 'psi': 0.7412669428265937}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=2.142356 cos_to_last_merge=0.9958 (last merge round=26)
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.9939539858461368, 'auprc': 0.9987128533456407, 'loss_val': 0.027983355473579045, 'psi': 0.9958575328459384}-{'f1_val': 0.9941417884415487, 'auprc': 0.9986342700751918, 'loss_val': 0.02860750440944717, 'psi': 0.9959387810950059}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=65 head_norm_before_train=1.980247 cos_to_last_merge=0.9786 (last merge round=25)
[S9] round=65 local utility u=0.013027 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9989189710251835, 'loss_val': 0.018056411577594772, 'psi': 0.9978293359173591}-{'f1_val': 0.9937719190709611, 'auprc': 0.9991859892867184, 'loss_val': 0.024925127008155194, 'psi': 0.995937547157264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=65 head_norm_before_train=2.026360 cos_to_last_merge=0.7589 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.759
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9965691615734168, 'loss_val': 0.0378974465655488, 'psi': 0.9943996106471618}-{'f1_val': 0.9929532433629917, 'auprc': 0.9965861148621276, 'loss_val': 0.03763742347046368, 'psi': 0.994406391962646}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=2.121810 cos_to_last_merge=0.9702 (last merge round=26)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.9967100199194604, 'loss_val': 0.02144797994903301, 'psi': 0.9966541925274977}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975827511284244, 'loss_val': 0.0198937616429626, 'psi': 0.9969613031595235}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.706145 cos_to_last_merge=0.9289 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=65 local utility u=0.150745 metrics={'f1_val': 0.7127652296511541, 'auprc': 0.8007654366669746, 'loss_val': 0.9236395076853541, 'psi': 0.7479653124574823}-{'f1_val': 0.6611735651366647, 'auprc': 0.8011164144223188, 'loss_val': 0.9166316007286687, 'psi': 0.7171507048509264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=65 head_norm_before_train=1.998204 cos_to_last_merge=0.6953 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.695
[S14] round=65 local utility u=0.010965 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969766180132813, 'loss_val': 0.02134274929380636, 'psi': 0.9969891520999116}-{'f1_val': 0.994934808751637, 'auprc': 0.9969761559024085, 'loss_val': 0.030895382803366473, 'psi': 0.9957513476119455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=65 head_norm_before_train=2.035424 cos_to_last_merge=0.9578 (last merge round=22)
[S15] round=65 local utility u=0.000268 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981365898728877, 'loss_val': 0.01928899172130964, 'psi': 0.9973026369816674}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977060120591906, 'loss_val': 0.018532645144358578, 'psi': 0.9971304058561886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=65 head_norm_before_train=1.769657 cos_to_last_merge=0.9310 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.931
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9449644471357865, 'auprc': 0.9881591502167557, 'loss_val': 0.15632979304275577, 'psi': 0.9622423283681742}-{'f1_val': 0.9850175895062269, 'auprc': 0.989758992029077, 'loss_val': 0.06302099580351805, 'psi': 0.9869141505153669}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.852080 cos_to_last_merge=0.9240 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.924
[S17] round=65 local utility u=0.240818 metrics={'f1_val': 0.680371952656361, 'auprc': 0.8954413837372454, 'loss_val': 0.748675554199902, 'psi': 0.7663997250887147}-{'f1_val': 0.6373734661384517, 'auprc': 0.8569833014877111, 'loss_val': 0.8569455771907052, 'psi': 0.7252174002781555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=66 head_norm_before_train=2.023492 cos_to_last_merge=0.9602 (last merge round=21)
[S2] round=66 local utility u=1.000000 metrics={'f1_val': 0.8146788265845081, 'auprc': 0.92544781354802, 'loss_val': 0.4656262429454734, 'psi': 0.8589864213699128}-{'f1_val': 0.6674928300595946, 'auprc': 0.8098079580293568, 'loss_val': 1.2796178352029526, 'psi': 0.7244188812474994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=66 head_norm_before_train=1.892455 cos_to_last_merge=0.9458 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=66 local utility u=0.327301 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.998821137452222, 'loss_val': 0.019831679260997978, 'psi': 0.9979847325528234}-{'f1_val': 0.9348958752843897, 'auprc': 0.9637784079611669, 'loss_val': 0.19411775671070505, 'psi': 0.9464488883551005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=66 head_norm_before_train=1.570635 cos_to_last_merge=0.9700 (last merge round=24)
[S4] round=66 local utility u=0.035233 metrics={'f1_val': 0.9527055974958365, 'auprc': 0.9648990647898252, 'loss_val': 0.28578023880046166, 'psi': 0.957582984413432}-{'f1_val': 0.9446023564321342, 'auprc': 0.9608057470281373, 'loss_val': 0.2953458930653462, 'psi': 0.9510837126705354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=66 head_norm_before_train=1.699946 cos_to_last_merge=0.8841 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.884
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9894329522884896, 'loss_val': 0.03642204121757137, 'psi': 0.99357346809353}-{'f1_val': 0.9963338119635569, 'auprc': 0.9919257211612738, 'loss_val': 0.03189096308368419, 'psi': 0.9945705756426435}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=66 head_norm_before_train=1.656333 cos_to_last_merge=0.8838 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.884
[S6] round=66 local utility u=0.741527 metrics={'f1_val': 0.8160145673581988, 'auprc': 0.9653319528611034, 'loss_val': 0.33815547075206703, 'psi': 0.8757415215593607}-{'f1_val': 0.62651697263099, 'auprc': 0.9474015761663436, 'loss_val': 0.6304327287792829, 'psi': 0.7548708140451315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=66 head_norm_before_train=1.323049 cos_to_last_merge=0.8887 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.889
[S7] round=66 local utility u=0.354753 metrics={'f1_val': 0.667680430873519, 'auprc': 0.8191266260779653, 'loss_val': 0.4352510962891705, 'psi': 0.7282589089552975}-{'f1_val': 0.5965305865737547, 'auprc': 0.7944034813857122, 'loss_val': 0.6436894747914108, 'psi': 0.6756797444985376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=66 head_norm_before_train=2.151547 cos_to_last_merge=0.9955 (last merge round=26)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.984943134154014, 'auprc': 0.9991311998969632, 'loss_val': 0.0468332850662662, 'psi': 0.9906183604511937}-{'f1_val': 0.9939539858461368, 'auprc': 0.9987128533456407, 'loss_val': 0.027983355473579045, 'psi': 0.9958575328459384}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=1.986761 cos_to_last_merge=0.9782 (last merge round=25)
[S9] round=66 local utility u=0.000127 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987901144797973, 'loss_val': 0.017416811712893665, 'psi': 0.9977777932992046}-{'f1_val': 0.9971029125121428, 'auprc': 0.9989189710251835, 'loss_val': 0.018056411577594772, 'psi': 0.9978293359173591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=66 head_norm_before_train=2.030188 cos_to_last_merge=0.7586 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.759
[S10] round=66 local utility u=0.001866 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9969424101665422, 'loss_val': 0.03659915996883229, 'psi': 0.9946802203725467}-{'f1_val': 0.9929532433629917, 'auprc': 0.9965691615734168, 'loss_val': 0.0378974465655488, 'psi': 0.9943996106471618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=66 head_norm_before_train=2.122897 cos_to_last_merge=0.9698 (last merge round=26)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9967009646061735, 'loss_val': 0.026524848468469118, 'psi': 0.996360590790455}-{'f1_val': 0.9966169742661891, 'auprc': 0.9967100199194604, 'loss_val': 0.02144797994903301, 'psi': 0.9966541925274977}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.712595 cos_to_last_merge=0.9279 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.928
[S13] round=66 local utility u=0.017296 metrics={'f1_val': 0.688836121011771, 'auprc': 0.7959081550813167, 'loss_val': 0.7309018060196318, 'psi': 0.7316649346395894}-{'f1_val': 0.7127652296511541, 'auprc': 0.8007654366669746, 'loss_val': 0.9236395076853541, 'psi': 0.7479653124574823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=66 head_norm_before_train=2.004905 cos_to_last_merge=0.6945 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.695
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9969768256984236, 'loss_val': 0.028471692819366498, 'psi': 0.9970899060780245}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969766180132813, 'loss_val': 0.02134274929380636, 'psi': 0.9969891520999116}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=2.041633 cos_to_last_merge=0.9574 (last merge round=22)
[S15] round=66 local utility u=0.000396 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9984586593427798, 'loss_val': 0.019463938832799014, 'psi': 0.9974314647696243}-{'f1_val': 0.9967466683875206, 'auprc': 0.9981365898728877, 'loss_val': 0.01928899172130964, 'psi': 0.9973026369816674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=66 head_norm_before_train=1.776640 cos_to_last_merge=0.9303 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=66 local utility u=0.000000 metrics={'f1_val': 0.9436528332013745, 'auprc': 0.9867718492909587, 'loss_val': 0.2121133271163246, 'psi': 0.9609004396372082}-{'f1_val': 0.9449644471357865, 'auprc': 0.9881591502167557, 'loss_val': 0.15632979304275577, 'psi': 0.9622423283681742}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=66 head_norm_before_train=1.861196 cos_to_last_merge=0.9229 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.923
[S17] round=66 local utility u=0.054959 metrics={'f1_val': 0.6698061534753109, 'auprc': 0.9587135333775729, 'loss_val': 0.7651794787205414, 'psi': 0.7853691054362157}-{'f1_val': 0.680371952656361, 'auprc': 0.8954413837372454, 'loss_val': 0.748675554199902, 'psi': 0.7663997250887147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=67 head_norm_before_train=2.029693 cos_to_last_merge=0.9595 (last merge round=21)
[S2] round=67 local utility u=0.081676 metrics={'f1_val': 0.8272149810087457, 'auprc': 0.9269586496845625, 'loss_val': 0.3820227449636277, 'psi': 0.8671124484790724}-{'f1_val': 0.8146788265845081, 'auprc': 0.92544781354802, 'loss_val': 0.4656262429454734, 'psi': 0.8589864213699128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=67 head_norm_before_train=1.899287 cos_to_last_merge=0.9452 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.8819167554717036, 'auprc': 0.9902049768675856, 'loss_val': 0.2179614765954394, 'psi': 0.9252320440300563}-{'f1_val': 0.9974271292865575, 'auprc': 0.998821137452222, 'loss_val': 0.019831679260997978, 'psi': 0.9979847325528234}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.573093 cos_to_last_merge=0.9697 (last merge round=24)
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9410619172241415, 'auprc': 0.9652212872998915, 'loss_val': 0.3003331584664587, 'psi': 0.9507256652544415}-{'f1_val': 0.9527055974958365, 'auprc': 0.9648990647898252, 'loss_val': 0.28578023880046166, 'psi': 0.957582984413432}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=1.705908 cos_to_last_merge=0.8831 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.883
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9878930472281506, 'loss_val': 0.03344297272160758, 'psi': 0.9929575060693943}-{'f1_val': 0.9963338119635569, 'auprc': 0.9894329522884896, 'loss_val': 0.03642204121757137, 'psi': 0.99357346809353}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.661734 cos_to_last_merge=0.8830 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.883
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.6940179782319891, 'auprc': 0.9604792416657603, 'loss_val': 0.5593843249160607, 'psi': 0.8006024836054976}-{'f1_val': 0.8160145673581988, 'auprc': 0.9653319528611034, 'loss_val': 0.33815547075206703, 'psi': 0.8757415215593607}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.329279 cos_to_last_merge=0.8879 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.6650785638064528, 'auprc': 0.8199398859696125, 'loss_val': 0.4235346823595162, 'psi': 0.7270230926717167}-{'f1_val': 0.667680430873519, 'auprc': 0.8191266260779653, 'loss_val': 0.4352510962891705, 'psi': 0.7282589089552975}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=2.154427 cos_to_last_merge=0.9953 (last merge round=26)
[S8] round=67 local utility u=0.027866 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9992322858746077, 'loss_val': 0.034329794167034224, 'psi': 0.9949512985688622}-{'f1_val': 0.984943134154014, 'auprc': 0.9991311998969632, 'loss_val': 0.0468332850662662, 'psi': 0.9906183604511937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=67 head_norm_before_train=1.989154 cos_to_last_merge=0.9781 (last merge round=25)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9904109382186765, 'auprc': 0.9987851310762742, 'loss_val': 0.031711020542096686, 'psi': 0.9937606153617156}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987901144797973, 'loss_val': 0.017416811712893665, 'psi': 0.9977777932992046}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=2.035399 cos_to_last_merge=0.7584 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.758
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9969481347141905, 'loss_val': 0.03678484032707407, 'psi': 0.994682510191606}-{'f1_val': 0.9931720938432163, 'auprc': 0.9969424101665422, 'loss_val': 0.03659915996883229, 'psi': 0.9946802203725467}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=67 head_norm_before_train=2.126059 cos_to_last_merge=0.9694 (last merge round=26)
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9952535889404076, 'loss_val': 0.02879275579649195, 'psi': 0.9957816405241486}-{'f1_val': 0.9961336749133093, 'auprc': 0.9967009646061735, 'loss_val': 0.026524848468469118, 'psi': 0.996360590790455}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=1.720806 cos_to_last_merge=0.9267 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.927
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.6917637625373715, 'auprc': 0.8041427714267253, 'loss_val': 0.8404663033672383, 'psi': 0.7367153660931129}-{'f1_val': 0.688836121011771, 'auprc': 0.7959081550813167, 'loss_val': 0.7309018060196318, 'psi': 0.7316649346395894}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=2.006809 cos_to_last_merge=0.6943 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.694
[S14] round=67 local utility u=0.004615 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.996977356362839, 'loss_val': 0.020701437719696836, 'psi': 0.9972359042461709}-{'f1_val': 0.9971652929977585, 'auprc': 0.9969768256984236, 'loss_val': 0.028471692819366498, 'psi': 0.9970899060780245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=67 head_norm_before_train=2.048336 cos_to_last_merge=0.9570 (last merge round=22)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9977862416270449, 'loss_val': 0.20339526560547277, 'psi': 0.9410166023686903}-{'f1_val': 0.9967466683875206, 'auprc': 0.9984586593427798, 'loss_val': 0.019463938832799014, 'psi': 0.9974314647696243}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.781046 cos_to_last_merge=0.9300 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=67 local utility u=0.035654 metrics={'f1_val': 0.9463446617261272, 'auprc': 0.9866294562504656, 'loss_val': 0.1565299243246608, 'psi': 0.9624585795358626}-{'f1_val': 0.9436528332013745, 'auprc': 0.9867718492909587, 'loss_val': 0.2121133271163246, 'psi': 0.9609004396372082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=67 head_norm_before_train=1.869423 cos_to_last_merge=0.9218 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.922
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.6287600455018396, 'auprc': 0.9635547389254512, 'loss_val': 0.8812191115559871, 'psi': 0.7626779228712842}-{'f1_val': 0.6698061534753109, 'auprc': 0.9587135333775729, 'loss_val': 0.7651794787205414, 'psi': 0.7853691054362157}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=68 head_norm_before_train=2.036500 cos_to_last_merge=0.9587 (last merge round=21)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.8279975043835877, 'auprc': 0.9240244056052359, 'loss_val': 0.39545010797374197, 'psi': 0.866408264872247}-{'f1_val': 0.8272149810087457, 'auprc': 0.9269586496845625, 'loss_val': 0.3820227449636277, 'psi': 0.8671124484790724}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=1.906049 cos_to_last_merge=0.9446 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=68 local utility u=0.179949 metrics={'f1_val': 0.9270832536092732, 'auprc': 0.997990409006478, 'loss_val': 0.1524193995486529, 'psi': 0.9554461157681551}-{'f1_val': 0.8819167554717036, 'auprc': 0.9902049768675856, 'loss_val': 0.2179614765954394, 'psi': 0.9252320440300563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=68 head_norm_before_train=1.577219 cos_to_last_merge=0.9693 (last merge round=24)
[S4] round=68 local utility u=0.001918 metrics={'f1_val': 0.9407916687269428, 'auprc': 0.9670882116935797, 'loss_val': 0.3004756197524279, 'psi': 0.9513102859135976}-{'f1_val': 0.9410619172241415, 'auprc': 0.9652212872998915, 'loss_val': 0.3003331584664587, 'psi': 0.9507256652544415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=68 head_norm_before_train=1.712746 cos_to_last_merge=0.8821 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.882
[S5] round=68 local utility u=0.020001 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9982980135130058, 'loss_val': 0.02686557410639112, 'psi': 0.997340386492277}-{'f1_val': 0.9963338119635569, 'auprc': 0.9878930472281506, 'loss_val': 0.03344297272160758, 'psi': 0.9929575060693943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=68 head_norm_before_train=1.669936 cos_to_last_merge=0.8821 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.882
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.6519724398662321, 'auprc': 0.9578902850166477, 'loss_val': 0.5540896235562538, 'psi': 0.7743395779263984}-{'f1_val': 0.6940179782319891, 'auprc': 0.9604792416657603, 'loss_val': 0.5593843249160607, 'psi': 0.8006024836054976}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.335388 cos_to_last_merge=0.8872 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.887
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.5833871946347643, 'auprc': 0.7908368511775831, 'loss_val': 0.6997644044442827, 'psi': 0.6663670572518918}-{'f1_val': 0.6650785638064528, 'auprc': 0.8199398859696125, 'loss_val': 0.4235346823595162, 'psi': 0.7270230926717167}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=2.153716 cos_to_last_merge=0.9952 (last merge round=26)
[S8] round=68 local utility u=0.003182 metrics={'f1_val': 0.9939430167409706, 'auprc': 0.9981341085634092, 'loss_val': 0.035744807181187124, 'psi': 0.9956194534699461}-{'f1_val': 0.9920973070316986, 'auprc': 0.9992322858746077, 'loss_val': 0.034329794167034224, 'psi': 0.9949512985688622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=68 head_norm_before_train=1.993416 cos_to_last_merge=0.9778 (last merge round=25)
[S9] round=68 local utility u=0.026939 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987934326292651, 'loss_val': 0.018009379319786856, 'psi': 0.9977791205589918}-{'f1_val': 0.9904109382186765, 'auprc': 0.9987851310762742, 'loss_val': 0.031711020542096686, 'psi': 0.9937606153617156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=68 head_norm_before_train=2.038121 cos_to_last_merge=0.7581 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.758
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9969734321896111, 'loss_val': 0.03763104062165356, 'psi': 0.9945613188936395}-{'f1_val': 0.9931720938432163, 'auprc': 0.9969481347141905, 'loss_val': 0.03678484032707407, 'psi': 0.994682510191606}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=2.131449 cos_to_last_merge=0.9690 (last merge round=26)
[S11] round=68 local utility u=0.003701 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9960986882963659, 'loss_val': 0.023926810688031094, 'psi': 0.996119680266532}-{'f1_val': 0.9961336749133093, 'auprc': 0.9952535889404076, 'loss_val': 0.02879275579649195, 'psi': 0.9957816405241486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=68 head_norm_before_train=1.726445 cos_to_last_merge=0.9257 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.926
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6055260204788951, 'auprc': 0.7333767365239453, 'loss_val': 1.0806073466775308, 'psi': 0.6566663068969152}-{'f1_val': 0.6917637625373715, 'auprc': 0.8041427714267253, 'loss_val': 0.8404663033672383, 'psi': 0.7367153660931129}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=2.011357 cos_to_last_merge=0.6940 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.694
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.997211058727947, 'auprc': 0.9969998730781169, 'loss_val': 0.0203888025891232, 'psi': 0.997126584468015}-{'f1_val': 0.9974082695017256, 'auprc': 0.996977356362839, 'loss_val': 0.020701437719696836, 'psi': 0.9972359042461709}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=2.055024 cos_to_last_merge=0.9566 (last merge round=22)
[S15] round=68 local utility u=0.009494 metrics={'f1_val': 0.9026184145866213, 'auprc': 0.9972831955931846, 'loss_val': 0.1795871601820219, 'psi': 0.9404843269892466}-{'f1_val': 0.903170176196454, 'auprc': 0.9977862416270449, 'loss_val': 0.20339526560547277, 'psi': 0.9410166023686903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=68 head_norm_before_train=1.784538 cos_to_last_merge=0.9298 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=68 local utility u=0.162805 metrics={'f1_val': 0.9847955916189711, 'auprc': 0.9866529996560582, 'loss_val': 0.061695623973120145, 'psi': 0.9855385548338059}-{'f1_val': 0.9463446617261272, 'auprc': 0.9866294562504656, 'loss_val': 0.1565299243246608, 'psi': 0.9624585795358626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=68 head_norm_before_train=1.878905 cos_to_last_merge=0.9205 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=68 local utility u=0.780313 metrics={'f1_val': 0.812056232727666, 'auprc': 0.9798854520784147, 'loss_val': 0.46936193602760073, 'psi': 0.8791879204679656}-{'f1_val': 0.6287600455018396, 'auprc': 0.9635547389254512, 'loss_val': 0.8812191115559871, 'psi': 0.7626779228712842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=69 head_norm_before_train=2.042526 cos_to_last_merge=0.9581 (last merge round=21)
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.8236794944107189, 'auprc': 0.9251959340330009, 'loss_val': 0.4530519543329743, 'psi': 0.8642860702596317}-{'f1_val': 0.8279975043835877, 'auprc': 0.9240244056052359, 'loss_val': 0.39545010797374197, 'psi': 0.866408264872247}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=1.913280 cos_to_last_merge=0.9440 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=69 local utility u=0.096533 metrics={'f1_val': 0.9602886800868435, 'auprc': 0.9986856364324659, 'loss_val': 0.16067164469235487, 'psi': 0.9756474626250925}-{'f1_val': 0.9270832536092732, 'auprc': 0.997990409006478, 'loss_val': 0.1524193995486529, 'psi': 0.9554461157681551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=69 head_norm_before_train=1.583193 cos_to_last_merge=0.9687 (last merge round=24)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.939720266800924, 'auprc': 0.9569880731206555, 'loss_val': 0.3052501619663399, 'psi': 0.9466273893288166}-{'f1_val': 0.9407916687269428, 'auprc': 0.9670882116935797, 'loss_val': 0.3004756197524279, 'psi': 0.9513102859135976}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.722143 cos_to_last_merge=0.8810 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.881
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.7148616753480442, 'auprc': 0.9840218825183868, 'loss_val': 0.574931544749153, 'psi': 0.8225257582161813}-{'f1_val': 0.9967019684784577, 'auprc': 0.9982980135130058, 'loss_val': 0.02686557410639112, 'psi': 0.997340386492277}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.676518 cos_to_last_merge=0.8811 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.881
[S6] round=69 local utility u=0.437210 metrics={'f1_val': 0.7524273392414926, 'auprc': 0.9803014567125695, 'loss_val': 0.34963180172261693, 'psi': 0.8435769862299234}-{'f1_val': 0.6519724398662321, 'auprc': 0.9578902850166477, 'loss_val': 0.5540896235562538, 'psi': 0.7743395779263984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=69 head_norm_before_train=1.340570 cos_to_last_merge=0.8865 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.886
[S7] round=69 local utility u=0.216938 metrics={'f1_val': 0.6276470881452666, 'auprc': 0.8022720091495384, 'loss_val': 0.565752267859829, 'psi': 0.6974970565469754}-{'f1_val': 0.5833871946347643, 'auprc': 0.7908368511775831, 'loss_val': 0.6997644044442827, 'psi': 0.6663670572518918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1812 reason=None
[S7] sending update (kind=head size=1812 to 1 peers)
[S8] START round=69 head_norm_before_train=2.152247 cos_to_last_merge=0.9951 (last merge round=26)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9870675562934325, 'auprc': 0.9955379538722329, 'loss_val': 0.05275994835098589, 'psi': 0.9904557153249527}-{'f1_val': 0.9939430167409706, 'auprc': 0.9981341085634092, 'loss_val': 0.035744807181187124, 'psi': 0.9956194534699461}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=1.997901 cos_to_last_merge=0.9775 (last merge round=25)
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991951055256202, 'loss_val': 0.019119847880366775, 'psi': 0.9974406596484917}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987934326292651, 'loss_val': 0.018009379319786856, 'psi': 0.9977791205589918}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=2.040264 cos_to_last_merge=0.7578 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.758
[S10] round=69 local utility u=0.000050 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9969893575218867, 'loss_val': 0.037578924840884584, 'psi': 0.9945676890265498}-{'f1_val': 0.9929532433629917, 'auprc': 0.9969734321896111, 'loss_val': 0.03763104062165356, 'psi': 0.9945613188936395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=69 head_norm_before_train=2.137935 cos_to_last_merge=0.9686 (last merge round=26)
[S11] round=69 local utility u=0.004465 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.9969402891078647, 'loss_val': 0.020420873812642484, 'psi': 0.9967463002028594}-{'f1_val': 0.9961336749133093, 'auprc': 0.9960986882963659, 'loss_val': 0.023926810688031094, 'psi': 0.996119680266532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=69 head_norm_before_train=1.732054 cos_to_last_merge=0.9245 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=69 local utility u=0.527012 metrics={'f1_val': 0.7228806913015203, 'auprc': 0.8047279524808693, 'loss_val': 0.944764108152582, 'psi': 0.7556195957732599}-{'f1_val': 0.6055260204788951, 'auprc': 0.7333767365239453, 'loss_val': 1.0806073466775308, 'psi': 0.6566663068969152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=69 head_norm_before_train=2.016839 cos_to_last_merge=0.6934 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.693
[S14] round=69 local utility u=0.000384 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9969769701658048, 'loss_val': 0.020872154216244346, 'psi': 0.9972494183706996}-{'f1_val': 0.997211058727947, 'auprc': 0.9969998730781169, 'loss_val': 0.0203888025891232, 'psi': 0.997126584468015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=69 head_norm_before_train=2.061310 cos_to_last_merge=0.9562 (last merge round=22)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.903170176196454, 'auprc': 0.997277039509169, 'loss_val': 0.20799893553010168, 'psi': 0.94081292152154}-{'f1_val': 0.9026184145866213, 'auprc': 0.9972831955931846, 'loss_val': 0.1795871601820219, 'psi': 0.9404843269892466}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=1.788800 cos_to_last_merge=0.9296 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=69 local utility u=0.038608 metrics={'f1_val': 0.9937626402756854, 'auprc': 0.98628570712779, 'loss_val': 0.03718075543730549, 'psi': 0.9907718670165272}-{'f1_val': 0.9847955916189711, 'auprc': 0.9866529996560582, 'loss_val': 0.061695623973120145, 'psi': 0.9855385548338059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=69 head_norm_before_train=1.889447 cos_to_last_merge=0.9190 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.919
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.6047199265487609, 'auprc': 0.9333182671950878, 'loss_val': 1.1117286769074177, 'psi': 0.7361592628072917}-{'f1_val': 0.812056232727666, 'auprc': 0.9798854520784147, 'loss_val': 0.46936193602760073, 'psi': 0.8791879204679656}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=2.046302 cos_to_last_merge=0.9581 (last merge round=21)
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.822312913206648, 'auprc': 0.8758713665442868, 'loss_val': 0.4734188591726067, 'psi': 0.8437362945417035}-{'f1_val': 0.8236794944107189, 'auprc': 0.9251959340330009, 'loss_val': 0.4530519543329743, 'psi': 0.8642860702596317}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=1.921308 cos_to_last_merge=0.9432 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.9464223448730016, 'auprc': 0.9981231279947369, 'loss_val': 0.1425601029040785, 'psi': 0.9671026581216957}-{'f1_val': 0.9602886800868435, 'auprc': 0.9986856364324659, 'loss_val': 0.16067164469235487, 'psi': 0.9756474626250925}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=1.592497 cos_to_last_merge=0.9680 (last merge round=24)
[S4] round=70 local utility u=0.044126 metrics={'f1_val': 0.9413957111958984, 'auprc': 0.9820814203076047, 'loss_val': 0.30233063982349684, 'psi': 0.9576699948405809}-{'f1_val': 0.939720266800924, 'auprc': 0.9569880731206555, 'loss_val': 0.3052501619663399, 'psi': 0.9466273893288166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=70 head_norm_before_train=1.730158 cos_to_last_merge=0.8801 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.880
[S5] round=70 local utility u=1.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9972379531023221, 'loss_val': 0.026578846787367355, 'psi': 0.9969163623280035}-{'f1_val': 0.7148616753480442, 'auprc': 0.9840218825183868, 'loss_val': 0.574931544749153, 'psi': 0.8225257582161813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=70 head_norm_before_train=1.683272 cos_to_last_merge=0.8801 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.880
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.688471806979144, 'auprc': 0.9755443583911473, 'loss_val': 0.4318389255724799, 'psi': 0.8033008275439453}-{'f1_val': 0.7524273392414926, 'auprc': 0.9803014567125695, 'loss_val': 0.34963180172261693, 'psi': 0.8435769862299234}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.346070 cos_to_last_merge=0.8856 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.886
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.5625985431773985, 'auprc': 0.7863732952678291, 'loss_val': 0.7792123915261129, 'psi': 0.6521084440135707}-{'f1_val': 0.6276470881452666, 'auprc': 0.8022720091495384, 'loss_val': 0.565752267859829, 'psi': 0.6974970565469754}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=2.156386 cos_to_last_merge=0.9949 (last merge round=26)
[S8] round=70 local utility u=0.012485 metrics={'f1_val': 0.9888942878352466, 'auprc': 0.996023513882919, 'loss_val': 0.04020718591751065, 'psi': 0.9917459782543155}-{'f1_val': 0.9870675562934325, 'auprc': 0.9955379538722329, 'loss_val': 0.05275994835098589, 'psi': 0.9904557153249527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=70 head_norm_before_train=2.003158 cos_to_last_merge=0.9771 (last merge round=25)
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9991983783159847, 'loss_val': 0.02410005697195305, 'psi': 0.9960429789248021}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991951055256202, 'loss_val': 0.019119847880366775, 'psi': 0.9974406596484917}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=2.044554 cos_to_last_merge=0.7575 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.758
[S10] round=70 local utility u=0.000946 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9969445740887862, 'loss_val': 0.03686524560198431, 'psi': 0.9946810859414443}-{'f1_val': 0.9929532433629917, 'auprc': 0.9969893575218867, 'loss_val': 0.037578924840884584, 'psi': 0.9945676890265498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=70 head_norm_before_train=2.145034 cos_to_last_merge=0.9681 (last merge round=26)
[S11] round=70 local utility u=0.000000 metrics={'f1_val': 0.9958946321126402, 'auprc': 0.9972391269637382, 'loss_val': 0.021012542305389174, 'psi': 0.9964324300530794}-{'f1_val': 0.9966169742661891, 'auprc': 0.9969402891078647, 'loss_val': 0.020420873812642484, 'psi': 0.9967463002028594}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=70 head_norm_before_train=1.735919 cos_to_last_merge=0.9239 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=70 local utility u=0.057645 metrics={'f1_val': 0.7257735830984218, 'auprc': 0.814068783708318, 'loss_val': 0.8748541958779799, 'psi': 0.7610916633423803}-{'f1_val': 0.7228806913015203, 'auprc': 0.8047279524808693, 'loss_val': 0.944764108152582, 'psi': 0.7556195957732599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=70 head_norm_before_train=2.019768 cos_to_last_merge=0.6930 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.693
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9969789500514393, 'loss_val': 0.024927610434772558, 'psi': 0.9976289999297836}-{'f1_val': 0.9974310505072961, 'auprc': 0.9969769701658048, 'loss_val': 0.020872154216244346, 'psi': 0.9972494183706996}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=2.067824 cos_to_last_merge=0.9558 (last merge round=22)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.903170176196454, 'auprc': 0.9977816763081737, 'loss_val': 0.2259971994192494, 'psi': 0.9410147762411418}-{'f1_val': 0.903170176196454, 'auprc': 0.997277039509169, 'loss_val': 0.20799893553010168, 'psi': 0.94081292152154}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=1.794296 cos_to_last_merge=0.9291 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.929
[S16] round=70 local utility u=0.004256 metrics={'f1_val': 0.9933003328734109, 'auprc': 0.9898959461581514, 'loss_val': 0.03672586428401327, 'psi': 0.991938578187307}-{'f1_val': 0.9937626402756854, 'auprc': 0.98628570712779, 'loss_val': 0.03718075543730549, 'psi': 0.9907718670165272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=70 head_norm_before_train=1.899297 cos_to_last_merge=0.9176 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.918
[S17] round=70 local utility u=0.005533 metrics={'f1_val': 0.6197702201903753, 'auprc': 0.8956355077633116, 'loss_val': 1.077917156815768, 'psi': 0.7301163352195499}-{'f1_val': 0.6047199265487609, 'auprc': 0.9333182671950878, 'loss_val': 1.1117286769074177, 'psi': 0.7361592628072917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=71 head_norm_before_train=2.050280 cos_to_last_merge=0.9579 (last merge round=21)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.8278407183949745, 'auprc': 0.8462460957705483, 'loss_val': 0.44593448630209265, 'psi': 0.835202869345204}-{'f1_val': 0.822312913206648, 'auprc': 0.8758713665442868, 'loss_val': 0.4734188591726067, 'psi': 0.8437362945417035}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=1.929065 cos_to_last_merge=0.9426 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.8027436655628464, 'auprc': 0.9789909112698866, 'loss_val': 0.3875422152640495, 'psi': 0.8732425638456625}-{'f1_val': 0.9464223448730016, 'auprc': 0.9981231279947369, 'loss_val': 0.1425601029040785, 'psi': 0.9671026581216957}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.597558 cos_to_last_merge=0.9676 (last merge round=24)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9388480143635535, 'auprc': 0.96201125908604, 'loss_val': 0.31202242752945436, 'psi': 0.948113312252548}-{'f1_val': 0.9413957111958984, 'auprc': 0.9820814203076047, 'loss_val': 0.30233063982349684, 'psi': 0.9576699948405809}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.735135 cos_to_last_merge=0.8794 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.879
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.9952491367231745, 'auprc': 0.9988885881230589, 'loss_val': 0.03212767860050237, 'psi': 0.9967049172831284}-{'f1_val': 0.9967019684784577, 'auprc': 0.9972379531023221, 'loss_val': 0.026578846787367355, 'psi': 0.9969163623280035}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=1.691135 cos_to_last_merge=0.8790 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.879
[S6] round=71 local utility u=0.457830 metrics={'f1_val': 0.8304336247244625, 'auprc': 0.9670161037421615, 'loss_val': 0.3423645231707289, 'psi': 0.885066616331542}-{'f1_val': 0.688471806979144, 'auprc': 0.9755443583911473, 'loss_val': 0.4318389255724799, 'psi': 0.8033008275439453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=71 head_norm_before_train=1.351324 cos_to_last_merge=0.8849 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.885
[S7] round=71 local utility u=0.073449 metrics={'f1_val': 0.578382464770707, 'auprc': 0.7869886311905857, 'loss_val': 0.7288643641153032, 'psi': 0.6618249313386585}-{'f1_val': 0.5625985431773985, 'auprc': 0.7863732952678291, 'loss_val': 0.7792123915261129, 'psi': 0.6521084440135707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=71 head_norm_before_train=2.163227 cos_to_last_merge=0.9948 (last merge round=26)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9850518562300145, 'auprc': 0.995846170922562, 'loss_val': 0.04851527961879151, 'psi': 0.9893695821070334}-{'f1_val': 0.9888942878352466, 'auprc': 0.996023513882919, 'loss_val': 0.04020718591751065, 'psi': 0.9917459782543155}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=2.008728 cos_to_last_merge=0.9767 (last merge round=25)
[S9] round=71 local utility u=0.012846 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991557672901467, 'loss_val': 0.017262232924698025, 'psi': 0.9979240544233443}-{'f1_val': 0.9939393793306803, 'auprc': 0.9991983783159847, 'loss_val': 0.02410005697195305, 'psi': 0.9960429789248021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=71 head_norm_before_train=2.049830 cos_to_last_merge=0.7572 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.757
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9969433315825902, 'loss_val': 0.03693669858171268, 'psi': 0.9946805889389658}-{'f1_val': 0.9931720938432163, 'auprc': 0.9969445740887862, 'loss_val': 0.03686524560198431, 'psi': 0.9946810859414443}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=2.151881 cos_to_last_merge=0.9676 (last merge round=26)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9706087791382102, 'auprc': 0.9951674871088778, 'loss_val': 0.06385413513625057, 'psi': 0.9804322623264772}-{'f1_val': 0.9958946321126402, 'auprc': 0.9972391269637382, 'loss_val': 0.021012542305389174, 'psi': 0.9964324300530794}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.739953 cos_to_last_merge=0.9237 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.924
[S13] round=71 local utility u=0.138791 metrics={'f1_val': 0.7455312363697804, 'auprc': 0.8176790988446326, 'loss_val': 0.7266481359930806, 'psi': 0.7743903813597213}-{'f1_val': 0.7257735830984218, 'auprc': 0.814068783708318, 'loss_val': 0.8748541958779799, 'psi': 0.7610916633423803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=71 head_norm_before_train=2.021289 cos_to_last_merge=0.6929 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.693
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9976262314423188, 'auprc': 0.9986737491534379, 'loss_val': 0.027752973988102086, 'psi': 0.9980452385267664}-{'f1_val': 0.9980623665153463, 'auprc': 0.9969789500514393, 'loss_val': 0.024927610434772558, 'psi': 0.9976289999297836}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=2.074213 cos_to_last_merge=0.9554 (last merge round=22)
[S15] round=71 local utility u=0.016671 metrics={'f1_val': 0.9037402512786699, 'auprc': 0.997802074012557, 'loss_val': 0.19613753807214232, 'psi': 0.9413649803722247}-{'f1_val': 0.903170176196454, 'auprc': 0.9977816763081737, 'loss_val': 0.2259971994192494, 'psi': 0.9410147762411418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=71 head_norm_before_train=1.799919 cos_to_last_merge=0.9286 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.929
[S16] round=71 local utility u=0.000615 metrics={'f1_val': 0.9933003328734109, 'auprc': 0.9903784131583746, 'loss_val': 0.036943770516189675, 'psi': 0.9921315649873963}-{'f1_val': 0.9933003328734109, 'auprc': 0.9898959461581514, 'loss_val': 0.03672586428401327, 'psi': 0.991938578187307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=71 head_norm_before_train=1.907325 cos_to_last_merge=0.9166 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.917
[S17] round=71 local utility u=0.931578 metrics={'f1_val': 0.8072159289001012, 'auprc': 0.9579364109107142, 'loss_val': 0.5263384420408611, 'psi': 0.8675041217043464}-{'f1_val': 0.6197702201903753, 'auprc': 0.8956355077633116, 'loss_val': 1.077917156815768, 'psi': 0.7301163352195499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=72 head_norm_before_train=2.053859 cos_to_last_merge=0.9579 (last merge round=21)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7822509825287247, 'auprc': 0.8113042061818393, 'loss_val': 0.5841436386751403, 'psi': 0.7938722719899705}-{'f1_val': 0.8278407183949745, 'auprc': 0.8462460957705483, 'loss_val': 0.44593448630209265, 'psi': 0.835202869345204}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=1.936609 cos_to_last_merge=0.9419 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=72 local utility u=0.753197 metrics={'f1_val': 0.9872890346139882, 'auprc': 0.9983993987513444, 'loss_val': 0.04664656627817796, 'psi': 0.9917331802689308}-{'f1_val': 0.8027436655628464, 'auprc': 0.9789909112698866, 'loss_val': 0.3875422152640495, 'psi': 0.8732425638456625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=72 head_norm_before_train=1.603798 cos_to_last_merge=0.9671 (last merge round=24)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.938261724863868, 'auprc': 0.9387442166896837, 'loss_val': 0.3200298301403931, 'psi': 0.9384547215941943}-{'f1_val': 0.9388480143635535, 'auprc': 0.96201125908604, 'loss_val': 0.31202242752945436, 'psi': 0.948113312252548}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=1.737826 cos_to_last_merge=0.8790 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.879
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9926300802125012, 'loss_val': 0.02891897786749908, 'psi': 0.9948523192631346}-{'f1_val': 0.9952491367231745, 'auprc': 0.9988885881230589, 'loss_val': 0.03212767860050237, 'psi': 0.9967049172831284}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.697114 cos_to_last_merge=0.8783 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.6438750933498603, 'auprc': 0.9602158977774797, 'loss_val': 0.6506607620395768, 'psi': 0.770411415120908}-{'f1_val': 0.8304336247244625, 'auprc': 0.9670161037421615, 'loss_val': 0.3423645231707289, 'psi': 0.885066616331542}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=1.355556 cos_to_last_merge=0.8844 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.884
[S7] round=72 local utility u=0.680980 metrics={'f1_val': 0.6900848227781048, 'auprc': 0.875023779043281, 'loss_val': 0.3012237891078523, 'psi': 0.7640604052841753}-{'f1_val': 0.578382464770707, 'auprc': 0.7869886311905857, 'loss_val': 0.7288643641153032, 'psi': 0.6618249313386585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=72 head_norm_before_train=2.170477 cos_to_last_merge=0.9947 (last merge round=26)
[S8] round=72 local utility u=0.038564 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9992558521177268, 'loss_val': 0.03004156014509382, 'psi': 0.9955759886365869}-{'f1_val': 0.9850518562300145, 'auprc': 0.995846170922562, 'loss_val': 0.04851527961879151, 'psi': 0.9893695821070334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=72 head_norm_before_train=2.011956 cos_to_last_merge=0.9766 (last merge round=25)
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996171312455874, 'loss_val': 0.017171217333612397, 'psi': 0.9967302724896353}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991557672901467, 'loss_val': 0.017262232924698025, 'psi': 0.9979240544233443}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.055699 cos_to_last_merge=0.7569 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.757
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9969883806978992, 'loss_val': 0.03771909774293577, 'psi': 0.9945672982969547}-{'f1_val': 0.9931720938432163, 'auprc': 0.9969433315825902, 'loss_val': 0.03693669858171268, 'psi': 0.9946805889389658}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=2.155229 cos_to_last_merge=0.9674 (last merge round=26)
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.8782100749779838, 'auprc': 0.9953211626637004, 'loss_val': 0.14808175799021298, 'psi': 0.9250545100522704}-{'f1_val': 0.9706087791382102, 'auprc': 0.9951674871088778, 'loss_val': 0.06385413513625057, 'psi': 0.9804322623264772}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.744321 cos_to_last_merge=0.9234 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=72 local utility u=0.053777 metrics={'f1_val': 0.7646407593329265, 'auprc': 0.826442040073835, 'loss_val': 0.7600406452325291, 'psi': 0.7893612716292899}-{'f1_val': 0.7455312363697804, 'auprc': 0.8176790988446326, 'loss_val': 0.7266481359930806, 'psi': 0.7743903813597213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=72 head_norm_before_train=2.026757 cos_to_last_merge=0.6924 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.692
[S14] round=72 local utility u=0.003390 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.9986737491534379, 'loss_val': 0.02345674197125736, 'psi': 0.9982937146654993}-{'f1_val': 0.9976262314423188, 'auprc': 0.9986737491534379, 'loss_val': 0.027752973988102086, 'psi': 0.9980452385267664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=72 head_norm_before_train=2.080331 cos_to_last_merge=0.9551 (last merge round=22)
[S15] round=72 local utility u=0.054271 metrics={'f1_val': 0.9126995218950944, 'auprc': 0.9978500498820377, 'loss_val': 0.1414957960790084, 'psi': 0.9467597330898717}-{'f1_val': 0.9037402512786699, 'auprc': 0.997802074012557, 'loss_val': 0.19613753807214232, 'psi': 0.9413649803722247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] sending update (kind=head size=1788 to 1 peers)
[S16] START round=72 head_norm_before_train=1.804760 cos_to_last_merge=0.9281 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9922027668152875, 'auprc': 0.9907546105868401, 'loss_val': 0.04155570825610407, 'psi': 0.9916235043239086}-{'f1_val': 0.9933003328734109, 'auprc': 0.9903784131583746, 'loss_val': 0.036943770516189675, 'psi': 0.9921315649873963}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=1.914864 cos_to_last_merge=0.9156 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.916
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.6438488759831416, 'auprc': 0.8531292784808442, 'loss_val': 0.9944177157729646, 'psi': 0.7275610369822225}-{'f1_val': 0.8072159289001012, 'auprc': 0.9579364109107142, 'loss_val': 0.5263384420408611, 'psi': 0.8675041217043464}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=2.057400 cos_to_last_merge=0.9579 (last merge round=21)
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.6666882752872355, 'auprc': 0.7993566604491538, 'loss_val': 1.2620419410868773, 'psi': 0.7197556293520029}-{'f1_val': 0.7822509825287247, 'auprc': 0.8113042061818393, 'loss_val': 0.5841436386751403, 'psi': 0.7938722719899705}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=1.943606 cos_to_last_merge=0.9413 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9988283310869229, 'loss_val': 0.13367736708703246, 'psi': 0.9760290978175072}-{'f1_val': 0.9872890346139882, 'auprc': 0.9983993987513444, 'loss_val': 0.04664656627817796, 'psi': 0.9917331802689308}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.608230 cos_to_last_merge=0.9666 (last merge round=24)
[S4] round=73 local utility u=0.013941 metrics={'f1_val': 0.9409311696732033, 'auprc': 0.9383519068831256, 'loss_val': 0.3069883546586369, 'psi': 0.9398994645571723}-{'f1_val': 0.938261724863868, 'auprc': 0.9387442166896837, 'loss_val': 0.3200298301403931, 'psi': 0.9384547215941943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=73 head_norm_before_train=1.739385 cos_to_last_merge=0.8786 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.879
[S5] round=73 local utility u=0.000527 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9927960064565478, 'loss_val': 0.028363722949332853, 'psi': 0.9949186897607531}-{'f1_val': 0.9963338119635569, 'auprc': 0.9926300802125012, 'loss_val': 0.02891897786749908, 'psi': 0.9948523192631346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=73 head_norm_before_train=1.703372 cos_to_last_merge=0.8775 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=73 local utility u=0.854272 metrics={'f1_val': 0.8521955479852577, 'auprc': 0.9858195245276414, 'loss_val': 0.26884996621570617, 'psi': 0.9056451386022111}-{'f1_val': 0.6438750933498603, 'auprc': 0.9602158977774797, 'loss_val': 0.6506607620395768, 'psi': 0.770411415120908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=73 head_norm_before_train=1.360053 cos_to_last_merge=0.8839 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.884
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.48467300540475033, 'auprc': 0.780374948551104, 'loss_val': 0.9452328101740738, 'psi': 0.6029537826632918}-{'f1_val': 0.6900848227781048, 'auprc': 0.875023779043281, 'loss_val': 0.3012237891078523, 'psi': 0.7640604052841753}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=73 head_norm_before_train=2.174411 cos_to_last_merge=0.9946 (last merge round=26)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9935326376274699, 'auprc': 0.9968312232910232, 'loss_val': 0.03115940331824505, 'psi': 0.9948520718928913}-{'f1_val': 0.993122746315827, 'auprc': 0.9992558521177268, 'loss_val': 0.03004156014509382, 'psi': 0.9955759886365869}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=2.016636 cos_to_last_merge=0.9764 (last merge round=25)
[S9] round=73 local utility u=0.004672 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992052842177628, 'loss_val': 0.016930040037551507, 'psi': 0.9979438611943908}-{'f1_val': 0.9971029125121428, 'auprc': 0.996171312455874, 'loss_val': 0.017171217333612397, 'psi': 0.9967302724896353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=73 head_norm_before_train=2.061826 cos_to_last_merge=0.7565 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.757
[S10] round=73 local utility u=0.000020 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.996965617574663, 'loss_val': 0.03761166042401842, 'psi': 0.9945581930476602}-{'f1_val': 0.9929532433629917, 'auprc': 0.9969883806978992, 'loss_val': 0.03771909774293577, 'psi': 0.9945672982969547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=73 head_norm_before_train=2.159036 cos_to_last_merge=0.9670 (last merge round=26)
[S11] round=73 local utility u=0.322833 metrics={'f1_val': 0.9713815203759102, 'auprc': 0.9951471556154298, 'loss_val': 0.06092340241052046, 'psi': 0.980887774471718}-{'f1_val': 0.8782100749779838, 'auprc': 0.9953211626637004, 'loss_val': 0.14808175799021298, 'psi': 0.9250545100522704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=73 head_norm_before_train=1.749220 cos_to_last_merge=0.9227 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.622731929338876, 'auprc': 0.8095266300575734, 'loss_val': 1.064906252300089, 'psi': 0.697449809626355}-{'f1_val': 0.7646407593329265, 'auprc': 0.826442040073835, 'loss_val': 0.7600406452325291, 'psi': 0.7893612716292899}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=2.034409 cos_to_last_merge=0.6918 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.692
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9498990918356249, 'auprc': 0.9984384815160001, 'loss_val': 0.06412786147697801, 'psi': 0.969314847707775}-{'f1_val': 0.9980403583402068, 'auprc': 0.9986737491534379, 'loss_val': 0.02345674197125736, 'psi': 0.9982937146654993}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=2.086302 cos_to_last_merge=0.9547 (last merge round=22)
[S15] round=73 local utility u=0.078792 metrics={'f1_val': 0.9306495522977927, 'auprc': 0.9979616626941208, 'loss_val': 0.0919471112252619, 'psi': 0.9575743964563239}-{'f1_val': 0.9126995218950944, 'auprc': 0.9978500498820377, 'loss_val': 0.1414957960790084, 'psi': 0.9467597330898717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=73 head_norm_before_train=1.809725 cos_to_last_merge=0.9276 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9643120298644215, 'auprc': 0.9901902376241072, 'loss_val': 0.10948836259869638, 'psi': 0.9746633129682958}-{'f1_val': 0.9922027668152875, 'auprc': 0.9907546105868401, 'loss_val': 0.04155570825610407, 'psi': 0.9916235043239086}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=1.921292 cos_to_last_merge=0.9149 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.915
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.6088715208199582, 'auprc': 0.8410446893548851, 'loss_val': 1.07705122376133, 'psi': 0.7017407882339289}-{'f1_val': 0.6438488759831416, 'auprc': 0.8531292784808442, 'loss_val': 0.9944177157729646, 'psi': 0.7275610369822225}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=2.062739 cos_to_last_merge=0.9575 (last merge round=21)
[S2] round=74 local utility u=0.604169 metrics={'f1_val': 0.756890826115506, 'auprc': 0.8481645593183835, 'loss_val': 0.7413438985117087, 'psi': 0.793400319396657}-{'f1_val': 0.6666882752872355, 'auprc': 0.7993566604491538, 'loss_val': 1.2620419410868773, 'psi': 0.7197556293520029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=74 head_norm_before_train=1.950391 cos_to_last_merge=0.9407 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.9580327140959826, 'auprc': 0.9964619382289113, 'loss_val': 0.1660786112323998, 'psi': 0.973404403749154}-{'f1_val': 0.9608296089712303, 'auprc': 0.9988283310869229, 'loss_val': 0.13367736708703246, 'psi': 0.9760290978175072}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=1.612368 cos_to_last_merge=0.9661 (last merge round=24)
[S4] round=74 local utility u=0.029144 metrics={'f1_val': 0.9408311342460448, 'auprc': 0.9583763148644809, 'loss_val': 0.3081733564815717, 'psi': 0.9478492064934192}-{'f1_val': 0.9409311696732033, 'auprc': 0.9383519068831256, 'loss_val': 0.3069883546586369, 'psi': 0.9398994645571723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=74 head_norm_before_train=1.744770 cos_to_last_merge=0.8777 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.878
[S5] round=74 local utility u=0.002629 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9939943191072539, 'loss_val': 0.026700367934355956, 'psi': 0.9953980148210356}-{'f1_val': 0.9963338119635569, 'auprc': 0.9927960064565478, 'loss_val': 0.028363722949332853, 'psi': 0.9949186897607531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=74 head_norm_before_train=1.711578 cos_to_last_merge=0.8766 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.877
[S6] round=74 local utility u=0.106754 metrics={'f1_val': 0.8793976618905951, 'auprc': 0.9887340646796456, 'loss_val': 0.2272981358652397, 'psi': 0.9231322230062153}-{'f1_val': 0.8521955479852577, 'auprc': 0.9858195245276414, 'loss_val': 0.26884996621570617, 'psi': 0.9056451386022111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=74 head_norm_before_train=1.363357 cos_to_last_merge=0.8835 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.884
[S7] round=74 local utility u=1.000000 metrics={'f1_val': 0.7004474717274484, 'auprc': 0.8788433136442193, 'loss_val': 0.2999100444944074, 'psi': 0.7718058084941568}-{'f1_val': 0.48467300540475033, 'auprc': 0.780374948551104, 'loss_val': 0.9452328101740738, 'psi': 0.6029537826632918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=74 head_norm_before_train=2.179257 cos_to_last_merge=0.9945 (last merge round=26)
[S8] round=74 local utility u=0.002729 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9992994443238287, 'loss_val': 0.028806483217435452, 'psi': 0.9954093219222332}-{'f1_val': 0.9935326376274699, 'auprc': 0.9968312232910232, 'loss_val': 0.03115940331824505, 'psi': 0.9948520718928913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=74 head_norm_before_train=2.022136 cos_to_last_merge=0.9760 (last merge round=25)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9991934609605999, 'loss_val': 0.0458779289607597, 'psi': 0.9922391281905163}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992052842177628, 'loss_val': 0.016930040037551507, 'psi': 0.9979438611943908}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.067967 cos_to_last_merge=0.7562 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.756
[S10] round=74 local utility u=0.000010 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9969298039338796, 'loss_val': 0.037485010582592085, 'psi': 0.9945438675913469}-{'f1_val': 0.9929532433629917, 'auprc': 0.996965617574663, 'loss_val': 0.03761166042401842, 'psi': 0.9945581930476602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=74 head_norm_before_train=2.162323 cos_to_last_merge=0.9666 (last merge round=26)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.7566212093662578, 'auprc': 0.9948383584997436, 'loss_val': 0.543101958903054, 'psi': 0.8519080690196521}-{'f1_val': 0.9713815203759102, 'auprc': 0.9951471556154298, 'loss_val': 0.06092340241052046, 'psi': 0.980887774471718}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.754275 cos_to_last_merge=0.9220 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.922
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6319887130469897, 'auprc': 0.7132715216822645, 'loss_val': 1.0735603789736838, 'psi': 0.6645018365010996}-{'f1_val': 0.622731929338876, 'auprc': 0.8095266300575734, 'loss_val': 1.064906252300089, 'psi': 0.697449809626355}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=2.039584 cos_to_last_merge=0.6917 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.692
[S14] round=74 local utility u=0.163243 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9969781979504435, 'loss_val': 0.02223971951933727, 'psi': 0.9976286990893852}-{'f1_val': 0.9498990918356249, 'auprc': 0.9984384815160001, 'loss_val': 0.06412786147697801, 'psi': 0.969314847707775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=74 head_norm_before_train=2.092106 cos_to_last_merge=0.9543 (last merge round=22)
[S15] round=74 local utility u=0.115375 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.998071400661983, 'loss_val': 0.056901759614906185, 'psi': 0.9771558036372459}-{'f1_val': 0.9306495522977927, 'auprc': 0.9979616626941208, 'loss_val': 0.0919471112252619, 'psi': 0.9575743964563239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=74 head_norm_before_train=1.814402 cos_to_last_merge=0.9270 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.927
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9449644471357865, 'auprc': 0.9906427808826614, 'loss_val': 0.16680784129755843, 'psi': 0.9632357806345365}-{'f1_val': 0.9643120298644215, 'auprc': 0.9901902376241072, 'loss_val': 0.10948836259869638, 'psi': 0.9746633129682958}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=1.929708 cos_to_last_merge=0.9140 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.914
[S17] round=74 local utility u=0.576393 metrics={'f1_val': 0.7127317596582743, 'auprc': 0.9232940437058947, 'loss_val': 0.7941756896943993, 'psi': 0.7969566732773226}-{'f1_val': 0.6088715208199582, 'auprc': 0.8410446893548851, 'loss_val': 1.07705122376133, 'psi': 0.7017407882339289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=75 head_norm_before_train=2.067775 cos_to_last_merge=0.9572 (last merge round=21)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.7617597956370534, 'auprc': 0.786082308281669, 'loss_val': 0.719768440423863, 'psi': 0.7714888006948997}-{'f1_val': 0.756890826115506, 'auprc': 0.8481645593183835, 'loss_val': 0.7413438985117087, 'psi': 0.793400319396657}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=1.956807 cos_to_last_merge=0.9402 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=75 local utility u=0.184307 metrics={'f1_val': 0.995644613046271, 'auprc': 0.9987588547294004, 'loss_val': 0.03002666662281703, 'psi': 0.9968903097195227}-{'f1_val': 0.9580327140959826, 'auprc': 0.9964619382289113, 'loss_val': 0.1660786112323998, 'psi': 0.973404403749154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=75 head_norm_before_train=1.617252 cos_to_last_merge=0.9655 (last merge round=24)
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9380700323391429, 'auprc': 0.9510484164032924, 'loss_val': 0.3203936251196929, 'psi': 0.9432613859648027}-{'f1_val': 0.9408311342460448, 'auprc': 0.9583763148644809, 'loss_val': 0.3081733564815717, 'psi': 0.9478492064934192}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=1.750952 cos_to_last_merge=0.8768 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.877
[S5] round=75 local utility u=0.008239 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9982704423675638, 'loss_val': 0.025260010935761527, 'psi': 0.9973293580341}-{'f1_val': 0.9963338119635569, 'auprc': 0.9939943191072539, 'loss_val': 0.026700367934355956, 'psi': 0.9953980148210356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=75 head_norm_before_train=1.722186 cos_to_last_merge=0.8755 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.641887652402189, 'auprc': 0.9579620066776035, 'loss_val': 0.6739912539630689, 'psi': 0.7683173941123548}-{'f1_val': 0.8793976618905951, 'auprc': 0.9887340646796456, 'loss_val': 0.2272981358652397, 'psi': 0.9231322230062153}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=1.366127 cos_to_last_merge=0.8832 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.883
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.6554614115369505, 'auprc': 0.8017058122700053, 'loss_val': 0.49849064875132554, 'psi': 0.7139591718301724}-{'f1_val': 0.7004474717274484, 'auprc': 0.8788433136442193, 'loss_val': 0.2999100444944074, 'psi': 0.7718058084941568}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=2.183379 cos_to_last_merge=0.9944 (last merge round=26)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.999296512438939, 'loss_val': 0.029523353712447555, 'psi': 0.9951895372469169}-{'f1_val': 0.9928159069878363, 'auprc': 0.9992994443238287, 'loss_val': 0.028806483217435452, 'psi': 0.9954093219222332}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=2.025998 cos_to_last_merge=0.9758 (last merge round=25)
[S9] round=75 local utility u=0.038283 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963457514113276, 'loss_val': 0.017769424712573832, 'psi': 0.9968000480718168}-{'f1_val': 0.9876029063437939, 'auprc': 0.9991934609605999, 'loss_val': 0.0458779289607597, 'psi': 0.9922391281905163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=75 head_norm_before_train=2.074044 cos_to_last_merge=0.7558 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.756
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9965851605015079, 'loss_val': 0.038099703897794095, 'psi': 0.9944060102183983}-{'f1_val': 0.9929532433629917, 'auprc': 0.9969298039338796, 'loss_val': 0.037485010582592085, 'psi': 0.9945438675913469}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=2.164494 cos_to_last_merge=0.9664 (last merge round=26)
[S11] round=75 local utility u=0.973705 metrics={'f1_val': 0.9956540965861346, 'auprc': 0.9950334415372186, 'loss_val': 0.030475229270561538, 'psi': 0.9954058345665682}-{'f1_val': 0.7566212093662578, 'auprc': 0.9948383584997436, 'loss_val': 0.543101958903054, 'psi': 0.8519080690196521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=75 head_norm_before_train=1.760246 cos_to_last_merge=0.9212 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.921
[S13] round=75 local utility u=0.159279 metrics={'f1_val': 0.6307482450275345, 'auprc': 0.7977614929218088, 'loss_val': 1.0010293313769925, 'psi': 0.6975535441852442}-{'f1_val': 0.6319887130469897, 'auprc': 0.7132715216822645, 'loss_val': 1.0735603789736838, 'psi': 0.6645018365010996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=75 head_norm_before_train=2.044723 cos_to_last_merge=0.6914 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.691
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9969771057017651, 'loss_val': 0.019122873904584607, 'psi': 0.9972510243430619}-{'f1_val': 0.9980623665153463, 'auprc': 0.9969781979504435, 'loss_val': 0.02223971951933727, 'psi': 0.9976286990893852}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=2.097861 cos_to_last_merge=0.9540 (last merge round=22)
[S15] round=75 local utility u=0.116039 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9973945748061679, 'loss_val': 0.024000648928189833, 'psi': 0.9970058309549795}-{'f1_val': 0.9632120722874211, 'auprc': 0.998071400661983, 'loss_val': 0.056901759614906185, 'psi': 0.9771558036372459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=75 head_norm_before_train=1.819777 cos_to_last_merge=0.9265 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9444896985561508, 'auprc': 0.9874858639742632, 'loss_val': 0.20615147682542914, 'psi': 0.9616881647233957}-{'f1_val': 0.9449644471357865, 'auprc': 0.9906427808826614, 'loss_val': 0.16680784129755843, 'psi': 0.9632357806345365}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=1.938981 cos_to_last_merge=0.9129 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.913
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.6967055582498433, 'auprc': 0.9394400741359584, 'loss_val': 0.8098415586788971, 'psi': 0.7937993646042893}-{'f1_val': 0.7127317596582743, 'auprc': 0.9232940437058947, 'loss_val': 0.7941756896943993, 'psi': 0.7969566732773226}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=76 head_norm_before_train=2.072125 cos_to_last_merge=0.9569 (last merge round=21)
[S2] round=76 local utility u=0.464340 metrics={'f1_val': 0.8218126204789896, 'auprc': 0.889872267840737, 'loss_val': 0.4627754080867654, 'psi': 0.8490364794236887}-{'f1_val': 0.7617597956370534, 'auprc': 0.786082308281669, 'loss_val': 0.719768440423863, 'psi': 0.7714888006948997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=76 head_norm_before_train=1.963419 cos_to_last_merge=0.9396 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.9877761827508432, 'auprc': 0.9983273136799451, 'loss_val': 0.03540386381749125, 'psi': 0.991996635122484}-{'f1_val': 0.995644613046271, 'auprc': 0.9987588547294004, 'loss_val': 0.03002666662281703, 'psi': 0.9968903097195227}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.623701 cos_to_last_merge=0.9649 (last merge round=24)
[S4] round=76 local utility u=0.026471 metrics={'f1_val': 0.9384058463728744, 'auprc': 0.9668107316745636, 'loss_val': 0.31675316400268455, 'psi': 0.94976780049355}-{'f1_val': 0.9380700323391429, 'auprc': 0.9510484164032924, 'loss_val': 0.3203936251196929, 'psi': 0.9432613859648027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=76 head_norm_before_train=1.757693 cos_to_last_merge=0.8759 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.876
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9942167933201513, 'loss_val': 0.026326639151990256, 'psi': 0.9954870045061945}-{'f1_val': 0.9967019684784577, 'auprc': 0.9982704423675638, 'loss_val': 0.025260010935761527, 'psi': 0.9973293580341}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=1.732401 cos_to_last_merge=0.8743 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.874
[S6] round=76 local utility u=0.299126 metrics={'f1_val': 0.7011145367192972, 'auprc': 0.9743535237261555, 'loss_val': 0.480275252066179, 'psi': 0.8104101315220406}-{'f1_val': 0.641887652402189, 'auprc': 0.9579620066776035, 'loss_val': 0.6739912539630689, 'psi': 0.7683173941123548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=76 head_norm_before_train=1.368603 cos_to_last_merge=0.8829 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.883
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.627849600899474, 'auprc': 0.7952490552882531, 'loss_val': 0.5811061438186989, 'psi': 0.6948093826549856}-{'f1_val': 0.6554614115369505, 'auprc': 0.8017058122700053, 'loss_val': 0.49849064875132554, 'psi': 0.7139591718301724}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=2.185811 cos_to_last_merge=0.9943 (last merge round=26)
[S8] round=76 local utility u=0.004956 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9991973526135496, 'loss_val': 0.029940643362483702, 'psi': 0.9962125232166423}-{'f1_val': 0.9924515537855688, 'auprc': 0.999296512438939, 'loss_val': 0.029523353712447555, 'psi': 0.9951895372469169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=76 head_norm_before_train=2.029293 cos_to_last_merge=0.9756 (last merge round=25)
[S9] round=76 local utility u=0.002496 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9979858346275534, 'loss_val': 0.017698031122217416, 'psi': 0.9974560813583071}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963457514113276, 'loss_val': 0.017769424712573832, 'psi': 0.9968000480718168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S9] sending update (kind=head size=1809 to 1 peers)
[S10] START round=76 head_norm_before_train=2.075673 cos_to_last_merge=0.7556 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.756
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9965435083916888, 'loss_val': 0.03815456074803185, 'psi': 0.9943893493744707}-{'f1_val': 0.9929532433629917, 'auprc': 0.9965851605015079, 'loss_val': 0.038099703897794095, 'psi': 0.9944060102183983}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=2.169107 cos_to_last_merge=0.9660 (last merge round=26)
[S11] round=76 local utility u=0.012004 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977842061653825, 'loss_val': 0.020077508380302107, 'psi': 0.9970418851743068}-{'f1_val': 0.9956540965861346, 'auprc': 0.9950334415372186, 'loss_val': 0.030475229270561538, 'psi': 0.9954058345665682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=76 head_norm_before_train=1.765809 cos_to_last_merge=0.9206 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.921
[S13] round=76 local utility u=0.219869 metrics={'f1_val': 0.6738967454662896, 'auprc': 0.8172178565838313, 'loss_val': 0.8785515027412673, 'psi': 0.7312251899133063}-{'f1_val': 0.6307482450275345, 'auprc': 0.7977614929218088, 'loss_val': 1.0010293313769925, 'psi': 0.6975535441852442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=76 head_norm_before_train=2.048413 cos_to_last_merge=0.6910 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.691
[S14] round=76 local utility u=0.000091 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.996977521396696, 'loss_val': 0.020262490446572298, 'psi': 0.997383314248252}-{'f1_val': 0.9974336367705932, 'auprc': 0.9969771057017651, 'loss_val': 0.019122873904584607, 'psi': 0.9972510243430619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=76 head_norm_before_train=2.103578 cos_to_last_merge=0.9536 (last merge round=22)
[S15] round=76 local utility u=0.001440 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981670270727446, 'loss_val': 0.023437203417695403, 'psi': 0.9973148118616102}-{'f1_val': 0.9967466683875206, 'auprc': 0.9973945748061679, 'loss_val': 0.024000648928189833, 'psi': 0.9970058309549795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=76 head_norm_before_train=1.823431 cos_to_last_merge=0.9263 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=76 local utility u=0.017371 metrics={'f1_val': 0.9455361545686339, 'auprc': 0.9875491901614593, 'loss_val': 0.17787902797913, 'psi': 0.962341368805764}-{'f1_val': 0.9444896985561508, 'auprc': 0.9874858639742632, 'loss_val': 0.20615147682542914, 'psi': 0.9616881647233957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=76 head_norm_before_train=1.946248 cos_to_last_merge=0.9122 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.912
[S17] round=76 local utility u=0.342551 metrics={'f1_val': 0.7702237642552286, 'auprc': 0.9555797665445049, 'loss_val': 0.6142673746377568, 'psi': 0.8443661651709391}-{'f1_val': 0.6967055582498433, 'auprc': 0.9394400741359584, 'loss_val': 0.8098415586788971, 'psi': 0.7937993646042893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=77 head_norm_before_train=2.075528 cos_to_last_merge=0.9569 (last merge round=21)
[S2] round=77 local utility u=0.097461 metrics={'f1_val': 0.8268127369279497, 'auprc': 0.9296140563978922, 'loss_val': 0.4170800163099796, 'psi': 0.8679332647159266}-{'f1_val': 0.8218126204789896, 'auprc': 0.889872267840737, 'loss_val': 0.4627754080867654, 'psi': 0.8490364794236887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=77 head_norm_before_train=1.970192 cos_to_last_merge=0.9390 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.705417008822546, 'auprc': 0.9606673114637122, 'loss_val': 0.6106718167901002, 'psi': 0.8075171298790125}-{'f1_val': 0.9877761827508432, 'auprc': 0.9983273136799451, 'loss_val': 0.03540386381749125, 'psi': 0.991996635122484}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=1.629343 cos_to_last_merge=0.9641 (last merge round=24)
[S4] round=77 local utility u=0.061252 metrics={'f1_val': 0.9480400966436319, 'auprc': 0.9815577009233827, 'loss_val': 0.29629574940539166, 'psi': 0.9614471383555322}-{'f1_val': 0.9384058463728744, 'auprc': 0.9668107316745636, 'loss_val': 0.31675316400268455, 'psi': 0.94976780049355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=77 head_norm_before_train=1.762251 cos_to_last_merge=0.8753 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.875
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.9166210431710422, 'auprc': 0.9909212885193941, 'loss_val': 0.1151892496609066, 'psi': 0.9463411413103829}-{'f1_val': 0.9963338119635569, 'auprc': 0.9942167933201513, 'loss_val': 0.026326639151990256, 'psi': 0.9954870045061945}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=77 head_norm_before_train=1.740551 cos_to_last_merge=0.8734 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=77 local utility u=0.522208 metrics={'f1_val': 0.8632860266050566, 'auprc': 0.9592742767820922, 'loss_val': 0.3636508918620267, 'psi': 0.9016813266758709}-{'f1_val': 0.7011145367192972, 'auprc': 0.9743535237261555, 'loss_val': 0.480275252066179, 'psi': 0.8104101315220406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=77 head_norm_before_train=1.371170 cos_to_last_merge=0.8825 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.883
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.6024513497840485, 'auprc': 0.786530736184019, 'loss_val': 0.6863408314859449, 'psi': 0.6760831043440367}-{'f1_val': 0.627849600899474, 'auprc': 0.7952490552882531, 'loss_val': 0.5811061438186989, 'psi': 0.6948093826549856}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=2.191803 cos_to_last_merge=0.9941 (last merge round=26)
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9994785749245995, 'loss_val': 0.030254008343744043, 'psi': 0.995553139334934}-{'f1_val': 0.9942226369520374, 'auprc': 0.9991973526135496, 'loss_val': 0.029940643362483702, 'psi': 0.9962125232166423}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=77 head_norm_before_train=2.032544 cos_to_last_merge=0.9754 (last merge round=25)
[S9] round=77 local utility u=0.000999 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987895121308833, 'loss_val': 0.018111168370275346, 'psi': 0.997777552359639}-{'f1_val': 0.9971029125121428, 'auprc': 0.9979858346275534, 'loss_val': 0.017698031122217416, 'psi': 0.9974560813583071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=77 head_norm_before_train=2.077752 cos_to_last_merge=0.7553 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.755
[S10] round=77 local utility u=0.001117 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9964889018638264, 'loss_val': 0.037070761491362174, 'psi': 0.9944988170514604}-{'f1_val': 0.9929532433629917, 'auprc': 0.9965435083916888, 'loss_val': 0.03815456074803185, 'psi': 0.9943893493744707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=77 head_norm_before_train=2.175104 cos_to_last_merge=0.9656 (last merge round=26)
[S11] round=77 local utility u=0.000057 metrics={'f1_val': 0.9970303038664694, 'auprc': 0.9964769504132123, 'loss_val': 0.018942240513736573, 'psi': 0.9968089624851666}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977842061653825, 'loss_val': 0.020077508380302107, 'psi': 0.9970418851743068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=77 head_norm_before_train=1.770090 cos_to_last_merge=0.9200 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6450133184510443, 'auprc': 0.8517377856390792, 'loss_val': 0.9076809229640838, 'psi': 0.7277031053262583}-{'f1_val': 0.6738967454662896, 'auprc': 0.8172178565838313, 'loss_val': 0.8785515027412673, 'psi': 0.7312251899133063}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=2.052317 cos_to_last_merge=0.6905 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.690
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.996977414459524, 'loss_val': 0.02167168262625886, 'psi': 0.9973832714733832}-{'f1_val': 0.9976538428159559, 'auprc': 0.996977521396696, 'loss_val': 0.020262490446572298, 'psi': 0.997383314248252}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=2.109205 cos_to_last_merge=0.9533 (last merge round=22)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.9762238356507673, 'auprc': 0.998668113142962, 'loss_val': 0.04028355891970568, 'psi': 0.9852015466476451}-{'f1_val': 0.9967466683875206, 'auprc': 0.9981670270727446, 'loss_val': 0.023437203417695403, 'psi': 0.9973148118616102}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=1.827343 cos_to_last_merge=0.9260 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=77 local utility u=0.084841 metrics={'f1_val': 0.9624075813481736, 'auprc': 0.9893965194294092, 'loss_val': 0.11496806718409028, 'psi': 0.9732031565806678}-{'f1_val': 0.9455361545686339, 'auprc': 0.9875491901614593, 'loss_val': 0.17787902797913, 'psi': 0.962341368805764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=77 head_norm_before_train=1.951379 cos_to_last_merge=0.9118 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.912
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.7131865227438036, 'auprc': 0.9285562564194858, 'loss_val': 0.7851931089180446, 'psi': 0.7993344162140765}-{'f1_val': 0.7702237642552286, 'auprc': 0.9555797665445049, 'loss_val': 0.6142673746377568, 'psi': 0.8443661651709391}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.079048 cos_to_last_merge=0.9568 (last merge round=21)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.7720210582672267, 'auprc': 0.9922131397082712, 'loss_val': 0.38538693664417917, 'psi': 0.8600978908436445}-{'f1_val': 0.8268127369279497, 'auprc': 0.9296140563978922, 'loss_val': 0.4170800163099796, 'psi': 0.8679332647159266}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=1.976534 cos_to_last_merge=0.9385 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=78 local utility u=1.000000 metrics={'f1_val': 0.9691226522107406, 'auprc': 0.9982670668694598, 'loss_val': 0.07276062172036957, 'psi': 0.9807804180742282}-{'f1_val': 0.705417008822546, 'auprc': 0.9606673114637122, 'loss_val': 0.6106718167901002, 'psi': 0.8075171298790125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=78 head_norm_before_train=1.632081 cos_to_last_merge=0.9639 (last merge round=24)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9401537106182069, 'auprc': 0.9765780511356714, 'loss_val': 0.31251511269165766, 'psi': 0.9547234468251926}-{'f1_val': 0.9480400966436319, 'auprc': 0.9815577009233827, 'loss_val': 0.29629574940539166, 'psi': 0.9614471383555322}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.767230 cos_to_last_merge=0.8748 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.875
[S5] round=78 local utility u=0.295428 metrics={'f1_val': 0.9963379289822979, 'auprc': 0.9991543868991917, 'loss_val': 0.027333704339953843, 'psi': 0.9974645121490554}-{'f1_val': 0.9166210431710422, 'auprc': 0.9909212885193941, 'loss_val': 0.1151892496609066, 'psi': 0.9463411413103829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=78 head_norm_before_train=1.746436 cos_to_last_merge=0.8728 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.6672392199167906, 'auprc': 0.976480795880458, 'loss_val': 0.4738874951748381, 'psi': 0.7909358503022575}-{'f1_val': 0.8632860266050566, 'auprc': 0.9592742767820922, 'loss_val': 0.3636508918620267, 'psi': 0.9016813266758709}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=78 head_norm_before_train=1.373940 cos_to_last_merge=0.8822 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.882
[S7] round=78 local utility u=0.245000 metrics={'f1_val': 0.6470260516356832, 'auprc': 0.7997230800313785, 'loss_val': 0.5033660338837997, 'psi': 0.7081048629939612}-{'f1_val': 0.6024513497840485, 'auprc': 0.786530736184019, 'loss_val': 0.6863408314859449, 'psi': 0.6760831043440367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=78 head_norm_before_train=2.199591 cos_to_last_merge=0.9939 (last merge round=26)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9715944828492281, 'auprc': 0.9970133022066321, 'loss_val': 0.07616092853060083, 'psi': 0.9817620105921897}-{'f1_val': 0.9929361822751569, 'auprc': 0.9994785749245995, 'loss_val': 0.030254008343744043, 'psi': 0.995553139334934}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=2.034223 cos_to_last_merge=0.9753 (last merge round=25)
[S9] round=78 local utility u=0.000486 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991732607818876, 'loss_val': 0.0182908053832686, 'psi': 0.9979310518200407}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987895121308833, 'loss_val': 0.018111168370275346, 'psi': 0.997777552359639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=78 head_norm_before_train=2.078468 cos_to_last_merge=0.7551 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.755
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9964941314915818, 'loss_val': 0.0372795537845744, 'psi': 0.9943695986144279}-{'f1_val': 0.9931720938432163, 'auprc': 0.9964889018638264, 'loss_val': 0.037070761491362174, 'psi': 0.9944988170514604}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.178898 cos_to_last_merge=0.9653 (last merge round=26)
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.8205808948518207, 'auprc': 0.9947967382842291, 'loss_val': 0.3870665737914122, 'psi': 0.8902672322247841}-{'f1_val': 0.9970303038664694, 'auprc': 0.9964769504132123, 'loss_val': 0.018942240513736573, 'psi': 0.9968089624851666}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.772151 cos_to_last_merge=0.9196 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6297453226358244, 'auprc': 0.8104362192899022, 'loss_val': 0.9534764023744599, 'psi': 0.7020216812974556}-{'f1_val': 0.6450133184510443, 'auprc': 0.8517377856390792, 'loss_val': 0.9076809229640838, 'psi': 0.7277031053262583}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=2.056697 cos_to_last_merge=0.6899 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.690
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9972116069810506, 'auprc': 0.9986752785140752, 'loss_val': 0.028658863044588014, 'psi': 0.9977970755942605}-{'f1_val': 0.9976538428159559, 'auprc': 0.996977414459524, 'loss_val': 0.02167168262625886, 'psi': 0.9973832714733832}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=2.114683 cos_to_last_merge=0.9529 (last merge round=22)
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.9706805385936345, 'auprc': 0.9986707338673044, 'loss_val': 0.04456518323648238, 'psi': 0.9818766167031024}-{'f1_val': 0.9762238356507673, 'auprc': 0.998668113142962, 'loss_val': 0.04028355891970568, 'psi': 0.9852015466476451}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=1.831606 cos_to_last_merge=0.9256 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=78 local utility u=0.083029 metrics={'f1_val': 0.9833029709129775, 'auprc': 0.9865323504083197, 'loss_val': 0.06569056257519568, 'psi': 0.9845947227111143}-{'f1_val': 0.9624075813481736, 'auprc': 0.9893965194294092, 'loss_val': 0.11496806718409028, 'psi': 0.9732031565806678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=78 head_norm_before_train=1.956677 cos_to_last_merge=0.9113 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.911
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.6885548817595297, 'auprc': 0.9106109284224462, 'loss_val': 0.8689541519827967, 'psi': 0.7773773004246962}-{'f1_val': 0.7131865227438036, 'auprc': 0.9285562564194858, 'loss_val': 0.7851931089180446, 'psi': 0.7993344162140765}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=2.081804 cos_to_last_merge=0.9567 (last merge round=21)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.8322595253649474, 'auprc': 0.8483525878913126, 'loss_val': 0.3453782240022751, 'psi': 0.8386967503754935}-{'f1_val': 0.7720210582672267, 'auprc': 0.9922131397082712, 'loss_val': 0.38538693664417917, 'psi': 0.8600978908436445}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.839 u=0.0000 p_local=0.1174 f1=0.832 auprc=0.848 bytes=81011
[S3] START round=79 head_norm_before_train=1.982777 cos_to_last_merge=0.9379 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=79 local utility u=0.016857 metrics={'f1_val': 0.9741734386372481, 'auprc': 0.9989732623182535, 'loss_val': 0.07147024646586699, 'psi': 0.9840933681096502}-{'f1_val': 0.9691226522107406, 'auprc': 0.9982670668694598, 'loss_val': 0.07276062172036957, 'psi': 0.9807804180742282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S3] r=80 psi=0.984 u=0.0169 p_local=0.2203 f1=0.974 auprc=0.999 bytes=82733
[S4] START round=79 head_norm_before_train=1.634675 cos_to_last_merge=0.9637 (last merge round=24)
[S4] round=79 local utility u=0.001385 metrics={'f1_val': 0.9397643050353006, 'auprc': 0.9791814956652012, 'loss_val': 0.3152197984392247, 'psi': 0.9555311812872608}-{'f1_val': 0.9401537106182069, 'auprc': 0.9765780511356714, 'loss_val': 0.31251511269165766, 'psi': 0.9547234468251926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S4] r=80 psi=0.956 u=0.0014 p_local=0.0154 f1=0.940 auprc=0.979 bytes=77286
[S5] START round=79 head_norm_before_train=1.770393 cos_to_last_merge=0.8744 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.874
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9936033062196582, 'loss_val': 0.028502748133357177, 'psi': 0.9952416096659973}-{'f1_val': 0.9963379289822979, 'auprc': 0.9991543868991917, 'loss_val': 0.027333704339953843, 'psi': 0.9974645121490554}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.995 u=0.0000 p_local=0.0757 f1=0.996 auprc=0.994 bytes=86359
[S6] START round=79 head_norm_before_train=1.749257 cos_to_last_merge=0.8722 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.6285367011649297, 'auprc': 0.9576662377267577, 'loss_val': 0.7528215399499485, 'psi': 0.7601885157896608}-{'f1_val': 0.6672392199167906, 'auprc': 0.976480795880458, 'loss_val': 0.4738874951748381, 'psi': 0.7909358503022575}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.760 u=0.0000 p_local=0.1913 f1=0.629 auprc=0.958 bytes=80825
[S7] START round=79 head_norm_before_train=1.376899 cos_to_last_merge=0.8818 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.882
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.5773330967370118, 'auprc': 0.784969965958206, 'loss_val': 0.7223660072147257, 'psi': 0.6603878444254895}-{'f1_val': 0.6470260516356832, 'auprc': 0.7997230800313785, 'loss_val': 0.5033660338837997, 'psi': 0.7081048629939612}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.660 u=0.0000 p_local=0.1535 f1=0.577 auprc=0.785 bytes=73892
[S8] START round=79 head_norm_before_train=2.207414 cos_to_last_merge=0.9937 (last merge round=26)
[S8] round=79 local utility u=0.090620 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.9993100256781536, 'loss_val': 0.030913017642865515, 'psi': 0.9955908117443285}-{'f1_val': 0.9715944828492281, 'auprc': 0.9970133022066321, 'loss_val': 0.07616092853060083, 'psi': 0.9817620105921897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S8] r=80 psi=0.996 u=0.0906 p_local=0.0225 f1=0.993 auprc=0.999 bytes=82719
[S9] START round=79 head_norm_before_train=2.038317 cos_to_last_merge=0.9751 (last merge round=25)
[S9] round=79 local utility u=0.002231 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9991888646381831, 'loss_val': 0.016340545870232193, 'psi': 0.9981838363093198}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991732607818876, 'loss_val': 0.0182908053832686, 'psi': 0.9979310518200407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] r=80 psi=0.998 u=0.0022 p_local=0.0054 f1=0.998 auprc=0.999 bytes=93641
[S10] START round=79 head_norm_before_train=2.079204 cos_to_last_merge=0.7548 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.755
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9965356877595688, 'loss_val': 0.03904244954213041, 'psi': 0.994254954271952}-{'f1_val': 0.9929532433629917, 'auprc': 0.9964941314915818, 'loss_val': 0.0372795537845744, 'psi': 0.9943695986144279}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.994 u=0.0000 p_local=0.0002 f1=0.993 auprc=0.997 bytes=86346
[S11] START round=79 head_norm_before_train=2.180233 cos_to_last_merge=0.9650 (last merge round=26)
[S11] round=79 local utility u=0.056058 metrics={'f1_val': 0.8302985259397593, 'auprc': 0.9948864009884427, 'loss_val': 0.33352509861970725, 'psi': 0.8961336759592327}-{'f1_val': 0.8205808948518207, 'auprc': 0.9947967382842291, 'loss_val': 0.3870665737914122, 'psi': 0.8902672322247841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=80 psi=0.896 u=0.0561 p_local=0.1128 f1=0.830 auprc=0.995 bytes=91868
[S13] START round=79 head_norm_before_train=1.773329 cos_to_last_merge=0.9196 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.920
[S13] round=79 local utility u=0.029261 metrics={'f1_val': 0.6254465325816722, 'auprc': 0.8851078437196208, 'loss_val': 1.0931757643920559, 'psi': 0.7293110570368516}-{'f1_val': 0.6297453226358244, 'auprc': 0.8104362192899022, 'loss_val': 0.9534764023744599, 'psi': 0.7020216812974556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] r=80 psi=0.729 u=0.0293 p_local=0.0662 f1=0.625 auprc=0.885 bytes=84611
[S14] START round=79 head_norm_before_train=2.062556 cos_to_last_merge=0.6895 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.690
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9401008495948229, 'auprc': 0.996979042330337, 'loss_val': 0.07994646049863839, 'psi': 0.9628521266890285}-{'f1_val': 0.9972116069810506, 'auprc': 0.9986752785140752, 'loss_val': 0.028658863044588014, 'psi': 0.9977970755942605}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.963 u=0.0000 p_local=0.0122 f1=0.940 auprc=0.997 bytes=86403
[S15] START round=79 head_norm_before_train=2.119996 cos_to_last_merge=0.9526 (last merge round=22)
[S15] round=79 local utility u=0.088451 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9983681307380833, 'loss_val': 0.023152784656264594, 'psi': 0.9973952533277457}-{'f1_val': 0.9706805385936345, 'auprc': 0.9986707338673044, 'loss_val': 0.04456518323648238, 'psi': 0.9818766167031024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S15] r=80 psi=0.997 u=0.0885 p_local=0.0479 f1=0.997 auprc=0.998 bytes=89868
[S16] START round=79 head_norm_before_train=1.835102 cos_to_last_merge=0.9254 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=79 local utility u=0.039813 metrics={'f1_val': 0.9928854325705972, 'auprc': 0.9864418233072447, 'loss_val': 0.043287102424511226, 'psi': 0.9903079888652562}-{'f1_val': 0.9833029709129775, 'auprc': 0.9865323504083197, 'loss_val': 0.06569056257519568, 'psi': 0.9845947227111143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S16] r=80 psi=0.990 u=0.0398 p_local=0.0390 f1=0.993 auprc=0.986 bytes=84487
[S17] START round=79 head_norm_before_train=1.963304 cos_to_last_merge=0.9106 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.911
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.6226811496591709, 'auprc': 0.9013362117548466, 'loss_val': 1.0203676942026416, 'psi': 0.7341431744974412}-{'f1_val': 0.6885548817595297, 'auprc': 0.9106109284224462, 'loss_val': 0.8689541519827967, 'psi': 0.7773773004246962}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.734 u=0.0000 p_local=0.1247 f1=0.623 auprc=0.901 bytes=77291
[S2] START round=80 head_norm_before_train=2.083623 cos_to_last_merge=0.9563 (last merge round=21)
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.8258341259697568, 'auprc': 0.8823699882468998, 'loss_val': 0.45442670555045983, 'psi': 0.848448470880614}-{'f1_val': 0.8322595253649474, 'auprc': 0.8483525878913126, 'loss_val': 0.3453782240022751, 'psi': 0.8386967503754935}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=80 head_norm_before_train=1.989004 cos_to_last_merge=0.9374 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9985481727173776, 'loss_val': 0.16161435198883975, 'psi': 0.9757455928264194}-{'f1_val': 0.9741734386372481, 'auprc': 0.9989732623182535, 'loss_val': 0.07147024646586699, 'psi': 0.9840933681096502}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.636877 cos_to_last_merge=0.9634 (last merge round=24)
[S4] round=80 local utility u=0.019690 metrics={'f1_val': 0.9456884160004377, 'auprc': 0.9755129344341869, 'loss_val': 0.30037929955027826, 'psi': 0.9576182233739374}-{'f1_val': 0.9397643050353006, 'auprc': 0.9791814956652012, 'loss_val': 0.3152197984392247, 'psi': 0.9555311812872608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=80 head_norm_before_train=1.772216 cos_to_last_merge=0.8738 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.874
[S5] round=80 local utility u=0.000945 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9940915999387312, 'loss_val': 0.028077206510036673, 'psi': 0.9954369271536265}-{'f1_val': 0.9963338119635569, 'auprc': 0.9936033062196582, 'loss_val': 0.028502748133357177, 'psi': 0.9952416096659973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=80 head_norm_before_train=1.752595 cos_to_last_merge=0.8717 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=80 local utility u=0.465797 metrics={'f1_val': 0.7547264254741128, 'auprc': 0.9624995713571906, 'loss_val': 0.5928654540913136, 'psi': 0.837835683827344}-{'f1_val': 0.6285367011649297, 'auprc': 0.9576662377267577, 'loss_val': 0.7528215399499485, 'psi': 0.7601885157896608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=80 head_norm_before_train=1.381058 cos_to_last_merge=0.8814 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.881
[S7] round=80 local utility u=0.663686 metrics={'f1_val': 0.6879039575491209, 'auprc': 0.8660850863405372, 'loss_val': 0.3017635509433352, 'psi': 0.7591764090656874}-{'f1_val': 0.5773330967370118, 'auprc': 0.784969965958206, 'loss_val': 0.7223660072147257, 'psi': 0.6603878444254895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=80 head_norm_before_train=2.212652 cos_to_last_merge=0.9935 (last merge round=26)
[S8] round=80 local utility u=0.002620 metrics={'f1_val': 0.9939497221170495, 'auprc': 0.9986599439717991, 'loss_val': 0.028753113137905156, 'psi': 0.9958338108589493}-{'f1_val': 0.9931113357884451, 'auprc': 0.9993100256781536, 'loss_val': 0.030913017642865515, 'psi': 0.9955908117443285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=80 head_norm_before_train=2.043647 cos_to_last_merge=0.9747 (last merge round=25)
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9972634903368587, 'auprc': 0.9991978809639269, 'loss_val': 0.01594197665128631, 'psi': 0.9980372465876859}-{'f1_val': 0.9975138174234109, 'auprc': 0.9991888646381831, 'loss_val': 0.016340545870232193, 'psi': 0.9981838363093198}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.082465 cos_to_last_merge=0.7545 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.755
[S10] round=80 local utility u=0.001385 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9965914328323158, 'loss_val': 0.03775170384283164, 'psi': 0.9944085191507214}-{'f1_val': 0.9927344652802075, 'auprc': 0.9965356877595688, 'loss_val': 0.03904244954213041, 'psi': 0.994254954271952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=80 head_norm_before_train=2.183640 cos_to_last_merge=0.9647 (last merge round=26)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.7851922253498183, 'auprc': 0.9948272937014245, 'loss_val': 0.47267787444441933, 'psi': 0.8690462526904608}-{'f1_val': 0.8302985259397593, 'auprc': 0.9948864009884427, 'loss_val': 0.33352509861970725, 'psi': 0.8961336759592327}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.775429 cos_to_last_merge=0.9192 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.919
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.6171746353224655, 'auprc': 0.8026734833903879, 'loss_val': 1.077969694214704, 'psi': 0.6913741745496345}-{'f1_val': 0.6254465325816722, 'auprc': 0.8851078437196208, 'loss_val': 1.0931757643920559, 'psi': 0.7293110570368516}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=2.066936 cos_to_last_merge=0.6893 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.689
[S14] round=80 local utility u=0.202423 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9969783051306645, 'loss_val': 0.0228671696048252, 'psi': 0.9976287419614737}-{'f1_val': 0.9401008495948229, 'auprc': 0.996979042330337, 'loss_val': 0.07994646049863839, 'psi': 0.9628521266890285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=80 head_norm_before_train=2.125281 cos_to_last_merge=0.9523 (last merge round=22)
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9961660416963759, 'loss_val': 0.022726475044469598, 'psi': 0.996291724864744}-{'f1_val': 0.9967466683875206, 'auprc': 0.9983681307380833, 'loss_val': 0.023152784656264594, 'psi': 0.9973952533277457}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=1.839197 cos_to_last_merge=0.9252 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=80 local utility u=0.004325 metrics={'f1_val': 0.9926433270515651, 'auprc': 0.9885074604130637, 'loss_val': 0.039381853591264775, 'psi': 0.9909889803961645}-{'f1_val': 0.9928854325705972, 'auprc': 0.9864418233072447, 'loss_val': 0.043287102424511226, 'psi': 0.9903079888652562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=80 head_norm_before_train=1.969962 cos_to_last_merge=0.9098 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.910
[S17] round=80 local utility u=0.797318 metrics={'f1_val': 0.7797288635265767, 'auprc': 0.9688882722033646, 'loss_val': 0.5706740771899843, 'psi': 0.8553926269972918}-{'f1_val': 0.6226811496591709, 'auprc': 0.9013362117548466, 'loss_val': 1.0203676942026416, 'psi': 0.7341431744974412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=81 head_norm_before_train=2.085779 cos_to_last_merge=0.9558 (last merge round=21)
[S2] round=81 local utility u=0.062292 metrics={'f1_val': 0.8305229755809778, 'auprc': 0.8998854655182362, 'loss_val': 0.4105213801682686, 'psi': 0.8582679715558812}-{'f1_val': 0.8258341259697568, 'auprc': 0.8823699882468998, 'loss_val': 0.45442670555045983, 'psi': 0.848448470880614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=81 head_norm_before_train=1.995048 cos_to_last_merge=0.9369 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.6906253528376795, 'auprc': 0.9416399486951718, 'loss_val': 0.6649891938951759, 'psi': 0.7910311911806764}-{'f1_val': 0.9605438728991138, 'auprc': 0.9985481727173776, 'loss_val': 0.16161435198883975, 'psi': 0.9757455928264194}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=1.639738 cos_to_last_merge=0.9628 (last merge round=24)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9425256746640834, 'auprc': 0.9808491165428743, 'loss_val': 0.30714607814957945, 'psi': 0.9578550514155999}-{'f1_val': 0.9456884160004377, 'auprc': 0.9755129344341869, 'loss_val': 0.30037929955027826, 'psi': 0.9576182233739374}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.778244 cos_to_last_merge=0.8731 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.873
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9934117287349628, 'loss_val': 0.02747337990817738, 'psi': 0.9951649786721192}-{'f1_val': 0.9963338119635569, 'auprc': 0.9940915999387312, 'loss_val': 0.028077206510036673, 'psi': 0.9954369271536265}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=1.756245 cos_to_last_merge=0.8713 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.871
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.6171381871161844, 'auprc': 0.7594274871551968, 'loss_val': 0.9187463608681339, 'psi': 0.6740539071317894}-{'f1_val': 0.7547264254741128, 'auprc': 0.9624995713571906, 'loss_val': 0.5928654540913136, 'psi': 0.837835683827344}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.386277 cos_to_last_merge=0.8808 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.881
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6130813503789889, 'auprc': 0.7946987258647613, 'loss_val': 0.6438441544866849, 'psi': 0.6857283005732979}-{'f1_val': 0.6879039575491209, 'auprc': 0.8660850863405372, 'loss_val': 0.3017635509433352, 'psi': 0.7591764090656874}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=2.217003 cos_to_last_merge=0.9933 (last merge round=26)
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9773353396799672, 'auprc': 0.9967734751745394, 'loss_val': 0.05780600898166198, 'psi': 0.9851105938777961}-{'f1_val': 0.9939497221170495, 'auprc': 0.9986599439717991, 'loss_val': 0.028753113137905156, 'psi': 0.9958338108589493}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=2.049252 cos_to_last_merge=0.9743 (last merge round=25)
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992092941740371, 'loss_val': 0.016136320139551963, 'psi': 0.9979454651769005}-{'f1_val': 0.9972634903368587, 'auprc': 0.9991978809639269, 'loss_val': 0.01594197665128631, 'psi': 0.9980372465876859}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=81 head_norm_before_train=2.086937 cos_to_last_merge=0.7542 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.754
[S10] round=81 local utility u=0.002017 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9968808455708815, 'loss_val': 0.03589988218588007, 'psi': 0.9946555945342824}-{'f1_val': 0.9929532433629917, 'auprc': 0.9965914328323158, 'loss_val': 0.03775170384283164, 'psi': 0.9944085191507214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=81 head_norm_before_train=2.185964 cos_to_last_merge=0.9643 (last merge round=26)
[S11] round=81 local utility u=0.856150 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9962072372654559, 'loss_val': 0.02871571835969846, 'psi': 0.9960179976273308}-{'f1_val': 0.7851922253498183, 'auprc': 0.9948272937014245, 'loss_val': 0.47267787444441933, 'psi': 0.8690462526904608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=81 head_norm_before_train=1.779267 cos_to_last_merge=0.9186 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.919
[S13] round=81 local utility u=0.108159 metrics={'f1_val': 0.6390426965102494, 'auprc': 0.8221423538691192, 'loss_val': 1.0512659466757137, 'psi': 0.7122825594537973}-{'f1_val': 0.6171746353224655, 'auprc': 0.8026734833903879, 'loss_val': 1.077969694214704, 'psi': 0.6913741745496345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=81 head_norm_before_train=2.069474 cos_to_last_merge=0.6893 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.689
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.997211058727947, 'auprc': 0.9969785728580721, 'loss_val': 0.019275384062605073, 'psi': 0.9971180643799971}-{'f1_val': 0.9980623665153463, 'auprc': 0.9969783051306645, 'loss_val': 0.0228671696048252, 'psi': 0.9976287419614737}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=2.130256 cos_to_last_merge=0.9520 (last merge round=22)
[S15] round=81 local utility u=0.006008 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9984619781153716, 'loss_val': 0.019826092475698488, 'psi': 0.997432792278661}-{'f1_val': 0.9963755136436562, 'auprc': 0.9961660416963759, 'loss_val': 0.022726475044469598, 'psi': 0.996291724864744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=81 head_norm_before_train=1.844140 cos_to_last_merge=0.9248 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.9926433270515651, 'auprc': 0.9887380851031154, 'loss_val': 0.04062021844769804, 'psi': 0.9910812302721852}-{'f1_val': 0.9926433270515651, 'auprc': 0.9885074604130637, 'loss_val': 0.039381853591264775, 'psi': 0.9909889803961645}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=81 head_norm_before_train=1.976988 cos_to_last_merge=0.9090 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.909
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.7292959379314081, 'auprc': 0.9607004853866508, 'loss_val': 0.751645429233292, 'psi': 0.8218577569135052}-{'f1_val': 0.7797288635265767, 'auprc': 0.9688882722033646, 'loss_val': 0.5706740771899843, 'psi': 0.8553926269972918}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=2.089445 cos_to_last_merge=0.9552 (last merge round=21)
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.8301394827601664, 'auprc': 0.8907571543355008, 'loss_val': 0.44444753779243823, 'psi': 0.8543865513903002}-{'f1_val': 0.8305229755809778, 'auprc': 0.8998854655182362, 'loss_val': 0.4105213801682686, 'psi': 0.8582679715558812}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=2.000249 cos_to_last_merge=0.9364 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=82 local utility u=0.948874 metrics={'f1_val': 0.9095322711500041, 'auprc': 0.9978486580471023, 'loss_val': 0.24930807039843556, 'psi': 0.9448588259088434}-{'f1_val': 0.6906253528376795, 'auprc': 0.9416399486951718, 'loss_val': 0.6649891938951759, 'psi': 0.7910311911806764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=82 head_norm_before_train=1.643974 cos_to_last_merge=0.9622 (last merge round=24)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9442610095577961, 'auprc': 0.974717649429111, 'loss_val': 0.30512273594808914, 'psi': 0.9564436655063221}-{'f1_val': 0.9425256746640834, 'auprc': 0.9808491165428743, 'loss_val': 0.30714607814957945, 'psi': 0.9578550514155999}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=1.784486 cos_to_last_merge=0.8724 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.872
[S5] round=82 local utility u=0.005875 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9956248286561191, 'loss_val': 0.024571944833000806, 'psi': 0.9962711125495223}-{'f1_val': 0.9963338119635569, 'auprc': 0.9934117287349628, 'loss_val': 0.02747337990817738, 'psi': 0.9951649786721192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=82 head_norm_before_train=1.762418 cos_to_last_merge=0.8707 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.871
[S6] round=82 local utility u=1.000000 metrics={'f1_val': 0.9869894324087634, 'auprc': 0.9862992265722239, 'loss_val': 0.061138357787435954, 'psi': 0.9867133500741476}-{'f1_val': 0.6171381871161844, 'auprc': 0.7594274871551968, 'loss_val': 0.9187463608681339, 'psi': 0.6740539071317894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=82 head_norm_before_train=1.390231 cos_to_last_merge=0.8803 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.880
[S7] round=82 local utility u=0.267070 metrics={'f1_val': 0.6651097911068398, 'auprc': 0.8082874818951393, 'loss_val': 0.4626407811904055, 'psi': 0.7223808674221597}-{'f1_val': 0.6130813503789889, 'auprc': 0.7946987258647613, 'loss_val': 0.6438441544866849, 'psi': 0.6857283005732979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=82 head_norm_before_train=2.222942 cos_to_last_merge=0.9931 (last merge round=26)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9736060242896892, 'auprc': 0.996578175791106, 'loss_val': 0.06727127831029703, 'psi': 0.9827948848902559}-{'f1_val': 0.9773353396799672, 'auprc': 0.9967734751745394, 'loss_val': 0.05780600898166198, 'psi': 0.9851105938777961}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=2.055057 cos_to_last_merge=0.9739 (last merge round=25)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984555585588784, 'loss_val': 0.015991519872562907, 'psi': 0.997643970930837}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992092941740371, 'loss_val': 0.016136320139551963, 'psi': 0.9979454651769005}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.086793 cos_to_last_merge=0.7539 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.754
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9969783158825245, 'loss_val': 0.036208154545246396, 'psi': 0.9946945826589396}-{'f1_val': 0.9931720938432163, 'auprc': 0.9968808455708815, 'loss_val': 0.03589988218588007, 'psi': 0.9946555945342824}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=2.188926 cos_to_last_merge=0.9640 (last merge round=26)
[S11] round=82 local utility u=0.003425 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962048512224961, 'loss_val': 0.023310034263958834, 'psi': 0.996162145436984}-{'f1_val': 0.9958918378685807, 'auprc': 0.9962072372654559, 'loss_val': 0.02871571835969846, 'psi': 0.9960179976273308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=82 head_norm_before_train=1.783644 cos_to_last_merge=0.9178 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.918
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6167189709761407, 'auprc': 0.8163918794488496, 'loss_val': 1.231081691499137, 'psi': 0.6965881343652243}-{'f1_val': 0.6390426965102494, 'auprc': 0.8221423538691192, 'loss_val': 1.0512659466757137, 'psi': 0.7122825594537973}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=2.071811 cos_to_last_merge=0.6895 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.690
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.984529403016775, 'auprc': 0.9985317440259284, 'loss_val': 0.040894076683387647, 'psi': 0.9901303394204364}-{'f1_val': 0.997211058727947, 'auprc': 0.9969785728580721, 'loss_val': 0.019275384062605073, 'psi': 0.9971180643799971}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=2.135382 cos_to_last_merge=0.9517 (last merge round=22)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9816826159518441, 'auprc': 0.9987971681662527, 'loss_val': 0.033016346903494476, 'psi': 0.9885284368376076}-{'f1_val': 0.9967466683875206, 'auprc': 0.9984619781153716, 'loss_val': 0.019826092475698488, 'psi': 0.997432792278661}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=1.849520 cos_to_last_merge=0.9243 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=82 local utility u=0.002711 metrics={'f1_val': 0.9930812571555108, 'auprc': 0.988756869743135, 'loss_val': 0.0378825332176118, 'psi': 0.9913515021905605}-{'f1_val': 0.9926433270515651, 'auprc': 0.9887380851031154, 'loss_val': 0.04062021844769804, 'psi': 0.9910812302721852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=82 head_norm_before_train=1.984770 cos_to_last_merge=0.9081 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.908
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.7162786116897311, 'auprc': 0.9619102145844485, 'loss_val': 0.7983782193597448, 'psi': 0.8145312528476181}-{'f1_val': 0.7292959379314081, 'auprc': 0.9607004853866508, 'loss_val': 0.751645429233292, 'psi': 0.8218577569135052}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=83 head_norm_before_train=2.092955 cos_to_last_merge=0.9551 (last merge round=21)
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.7469965988754224, 'auprc': 0.8252384426255002, 'loss_val': 0.80305134123281, 'psi': 0.7782933363754535}-{'f1_val': 0.8301394827601664, 'auprc': 0.8907571543355008, 'loss_val': 0.44444753779243823, 'psi': 0.8543865513903002}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.004386 cos_to_last_merge=0.9360 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.7129864226107366, 'auprc': 0.9976154999560993, 'loss_val': 0.5988876107104985, 'psi': 0.8268380535488817}-{'f1_val': 0.9095322711500041, 'auprc': 0.9978486580471023, 'loss_val': 0.24930807039843556, 'psi': 0.9448588259088434}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=1.649867 cos_to_last_merge=0.9618 (last merge round=24)
[S4] round=83 local utility u=0.000000 metrics={'f1_val': 0.9414644222104088, 'auprc': 0.9691076663282898, 'loss_val': 0.3143130738417133, 'psi': 0.9525217198575613}-{'f1_val': 0.9442610095577961, 'auprc': 0.974717649429111, 'loss_val': 0.30512273594808914, 'psi': 0.9564436655063221}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=83 head_norm_before_train=1.792696 cos_to_last_merge=0.8716 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.872
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9916958345523731, 'loss_val': 0.0270355599550692, 'psi': 0.9944786209990832}-{'f1_val': 0.9967019684784577, 'auprc': 0.9956248286561191, 'loss_val': 0.024571944833000806, 'psi': 0.9962711125495223}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=1.767904 cos_to_last_merge=0.8701 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.870
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.8899890989614118, 'auprc': 0.9854670639956943, 'loss_val': 0.20904987969355934, 'psi': 0.9281802849751248}-{'f1_val': 0.9869894324087634, 'auprc': 0.9862992265722239, 'loss_val': 0.061138357787435954, 'psi': 0.9867133500741476}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.393424 cos_to_last_merge=0.8800 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.880
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.6151811283126641, 'auprc': 0.7959032847378922, 'loss_val': 0.6418393350123108, 'psi': 0.6874699908827553}-{'f1_val': 0.6651097911068398, 'auprc': 0.8082874818951393, 'loss_val': 0.4626407811904055, 'psi': 0.7223808674221597}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=2.229245 cos_to_last_merge=0.9929 (last merge round=26)
[S8] round=83 local utility u=0.082359 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9992951039869826, 'loss_val': 0.027805206130327473, 'psi': 0.9955916893842892}-{'f1_val': 0.9736060242896892, 'auprc': 0.996578175791106, 'loss_val': 0.06727127831029703, 'psi': 0.9827948848902559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=83 head_norm_before_train=2.061050 cos_to_last_merge=0.9734 (last merge round=25)
[S9] round=83 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982438093044073, 'loss_val': 0.01595959025293369, 'psi': 0.9975592712290486}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984555585588784, 'loss_val': 0.015991519872562907, 'psi': 0.997643970930837}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=83 head_norm_before_train=2.089534 cos_to_last_merge=0.7536 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.754
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9967126812605547, 'loss_val': 0.038399195006610695, 'psi': 0.994457018522017}-{'f1_val': 0.9931720938432163, 'auprc': 0.9969783158825245, 'loss_val': 0.036208154545246396, 'psi': 0.9946945826589396}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=2.193262 cos_to_last_merge=0.9636 (last merge round=26)
[S11] round=83 local utility u=0.001101 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964967220263649, 'loss_val': 0.02198425294776977, 'psi': 0.9962788937585315}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962048512224961, 'loss_val': 0.023310034263958834, 'psi': 0.996162145436984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=83 head_norm_before_train=1.787183 cos_to_last_merge=0.9171 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.917
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.6209262337680648, 'auprc': 0.7052157874735585, 'loss_val': 1.1165518939992007, 'psi': 0.6546420552502623}-{'f1_val': 0.6167189709761407, 'auprc': 0.8163918794488496, 'loss_val': 1.231081691499137, 'psi': 0.6965881343652243}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=2.074130 cos_to_last_merge=0.6897 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.690
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9345019753943689, 'auprc': 0.9969803055382368, 'loss_val': 0.13811838584159347, 'psi': 0.9594933074519161}-{'f1_val': 0.984529403016775, 'auprc': 0.9985317440259284, 'loss_val': 0.040894076683387647, 'psi': 0.9901303394204364}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=2.140396 cos_to_last_merge=0.9514 (last merge round=22)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9682475236346391, 'auprc': 0.9987040583124486, 'loss_val': 0.04775607951045157, 'psi': 0.9804301375057629}-{'f1_val': 0.9816826159518441, 'auprc': 0.9987971681662527, 'loss_val': 0.033016346903494476, 'psi': 0.9885284368376076}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=1.853216 cos_to_last_merge=0.9240 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=83 local utility u=0.001560 metrics={'f1_val': 0.9933003328734109, 'auprc': 0.988786354797584, 'loss_val': 0.03616614312746804, 'psi': 0.9914947416430802}-{'f1_val': 0.9930812571555108, 'auprc': 0.988756869743135, 'loss_val': 0.0378825332176118, 'psi': 0.9913515021905605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=83 head_norm_before_train=1.992469 cos_to_last_merge=0.9072 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.907
[S17] round=83 local utility u=0.522415 metrics={'f1_val': 0.826069978971113, 'auprc': 0.972405857049836, 'loss_val': 0.4437828859378786, 'psi': 0.8846043302026022}-{'f1_val': 0.7162786116897311, 'auprc': 0.9619102145844485, 'loss_val': 0.7983782193597448, 'psi': 0.8145312528476181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=84 head_norm_before_train=2.096834 cos_to_last_merge=0.9548 (last merge round=21)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.6891298863821503, 'auprc': 0.7997088996647322, 'loss_val': 1.1198133512834296, 'psi': 0.7333614916951832}-{'f1_val': 0.7469965988754224, 'auprc': 0.8252384426255002, 'loss_val': 0.80305134123281, 'psi': 0.7782933363754535}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.008906 cos_to_last_merge=0.9355 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=84 local utility u=0.851994 metrics={'f1_val': 0.9232397156666834, 'auprc': 0.9980164105449956, 'loss_val': 0.15762286482708612, 'psi': 0.9531503936180082}-{'f1_val': 0.7129864226107366, 'auprc': 0.9976154999560993, 'loss_val': 0.5988876107104985, 'psi': 0.8268380535488817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=84 head_norm_before_train=1.653181 cos_to_last_merge=0.9614 (last merge round=24)
[S4] round=84 local utility u=0.022250 metrics={'f1_val': 0.9458287423903771, 'auprc': 0.9723808799307798, 'loss_val': 0.3058181547397395, 'psi': 0.9564495974065381}-{'f1_val': 0.9414644222104088, 'auprc': 0.9691076663282898, 'loss_val': 0.3143130738417133, 'psi': 0.9525217198575613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=84 head_norm_before_train=1.801835 cos_to_last_merge=0.8708 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.871
[S5] round=84 local utility u=0.004266 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9941233516631496, 'loss_val': 0.025785637381731896, 'psi': 0.995449627843394}-{'f1_val': 0.9963338119635569, 'auprc': 0.9916958345523731, 'loss_val': 0.0270355599550692, 'psi': 0.9944786209990832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=84 head_norm_before_train=1.770540 cos_to_last_merge=0.8697 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.870
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.6522600830873929, 'auprc': 0.7837718035335806, 'loss_val': 0.7986265347755267, 'psi': 0.704864771265868}-{'f1_val': 0.8899890989614118, 'auprc': 0.9854670639956943, 'loss_val': 0.20904987969355934, 'psi': 0.9281802849751248}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.396042 cos_to_last_merge=0.8797 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.880
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.6027147362586871, 'auprc': 0.7935385582271854, 'loss_val': 0.6656792417247878, 'psi': 0.6790442650460864}-{'f1_val': 0.6151811283126641, 'auprc': 0.7959032847378922, 'loss_val': 0.6418393350123108, 'psi': 0.6874699908827553}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=2.234076 cos_to_last_merge=0.9928 (last merge round=26)
[S8] round=84 local utility u=0.001491 metrics={'f1_val': 0.9934090858100645, 'auprc': 0.9995027716883529, 'loss_val': 0.027164124674247628, 'psi': 0.99584656016138}-{'f1_val': 0.993122746315827, 'auprc': 0.9992951039869826, 'loss_val': 0.027805206130327473, 'psi': 0.9955916893842892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=84 head_norm_before_train=2.067086 cos_to_last_merge=0.9730 (last merge round=25)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.9991891657727815, 'loss_val': 0.02303845355515344, 'psi': 0.9956878374016898}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982438093044073, 'loss_val': 0.01595959025293369, 'psi': 0.9975592712290486}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.093840 cos_to_last_merge=0.7533 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.753
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9967007753446786, 'loss_val': 0.038623206445971524, 'psi': 0.9944522561556666}-{'f1_val': 0.9929532433629917, 'auprc': 0.9967126812605547, 'loss_val': 0.038399195006610695, 'psi': 0.994457018522017}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.194454 cos_to_last_merge=0.9631 (last merge round=26)
[S11] round=84 local utility u=0.001163 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9965470389036053, 'loss_val': 0.01980905199392838, 'psi': 0.9962990205094278}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964967220263649, 'loss_val': 0.02198425294776977, 'psi': 0.9962788937585315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=84 head_norm_before_train=1.790214 cos_to_last_merge=0.9169 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.917
[S13] round=84 local utility u=0.556282 metrics={'f1_val': 0.7368432336507758, 'auprc': 0.7795605805544812, 'loss_val': 0.9225243712159684, 'psi': 0.753930172412258}-{'f1_val': 0.6209262337680648, 'auprc': 0.7052157874735585, 'loss_val': 1.1165518939992007, 'psi': 0.6546420552502623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=84 head_norm_before_train=2.079748 cos_to_last_merge=0.6895 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.690
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9348085321146704, 'auprc': 0.9955477234385933, 'loss_val': 0.1401894146772547, 'psi': 0.9591042086442396}-{'f1_val': 0.9345019753943689, 'auprc': 0.9969803055382368, 'loss_val': 0.13811838584159347, 'psi': 0.9594933074519161}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.145300 cos_to_last_merge=0.9511 (last merge round=22)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.9630438119969724, 'auprc': 0.998685472203322, 'loss_val': 0.055440452915905006, 'psi': 0.9773004760795123}-{'f1_val': 0.9682475236346391, 'auprc': 0.9987040583124486, 'loss_val': 0.04775607951045157, 'psi': 0.9804301375057629}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=1.856141 cos_to_last_merge=0.9238 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=84 local utility u=0.000008 metrics={'f1_val': 0.9933003328734109, 'auprc': 0.988885042422656, 'loss_val': 0.03644577321421842, 'psi': 0.9915342166931089}-{'f1_val': 0.9933003328734109, 'auprc': 0.988786354797584, 'loss_val': 0.03616614312746804, 'psi': 0.9914947416430802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=84 head_norm_before_train=1.997485 cos_to_last_merge=0.9068 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.907
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.7702254957631584, 'auprc': 0.9379445074257666, 'loss_val': 0.6572408604383019, 'psi': 0.8373131004282017}-{'f1_val': 0.826069978971113, 'auprc': 0.972405857049836, 'loss_val': 0.4437828859378786, 'psi': 0.8846043302026022}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=2.099923 cos_to_last_merge=0.9546 (last merge round=21)
[S2] round=85 local utility u=0.693113 metrics={'f1_val': 0.8087777078296333, 'auprc': 0.805896190960548, 'loss_val': 0.47003535499392857, 'psi': 0.8076251010819993}-{'f1_val': 0.6891298863821503, 'auprc': 0.7997088996647322, 'loss_val': 1.1198133512834296, 'psi': 0.7333614916951832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=85 head_norm_before_train=2.014319 cos_to_last_merge=0.9351 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=85 local utility u=0.132155 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9990942965355043, 'loss_val': 0.12355833249917288, 'psi': 0.976282769853874}-{'f1_val': 0.9232397156666834, 'auprc': 0.9980164105449956, 'loss_val': 0.15762286482708612, 'psi': 0.9531503936180082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=85 head_norm_before_train=1.654709 cos_to_last_merge=0.9613 (last merge round=24)
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9425285369744071, 'auprc': 0.9587436418848692, 'loss_val': 0.3137736322781137, 'psi': 0.949014578938592}-{'f1_val': 0.9458287423903771, 'auprc': 0.9723808799307798, 'loss_val': 0.3058181547397395, 'psi': 0.9564495974065381}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.807968 cos_to_last_merge=0.8699 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.870
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9915531615940965, 'loss_val': 0.029445888557595404, 'psi': 0.9944215518157726}-{'f1_val': 0.9963338119635569, 'auprc': 0.9941233516631496, 'loss_val': 0.025785637381731896, 'psi': 0.995449627843394}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=1.773326 cos_to_last_merge=0.8695 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=85 local utility u=1.000000 metrics={'f1_val': 0.8702251248874151, 'auprc': 0.9674664477678027, 'loss_val': 0.2772561406689509, 'psi': 0.9091216540395701}-{'f1_val': 0.6522600830873929, 'auprc': 0.7837718035335806, 'loss_val': 0.7986265347755267, 'psi': 0.704864771265868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=85 head_norm_before_train=1.399374 cos_to_last_merge=0.8793 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.879
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.6005220851036973, 'auprc': 0.7938599472363981, 'loss_val': 0.7031609478921862, 'psi': 0.6778572299567777}-{'f1_val': 0.6027147362586871, 'auprc': 0.7935385582271854, 'loss_val': 0.6656792417247878, 'psi': 0.6790442650460864}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=85 head_norm_before_train=2.236324 cos_to_last_merge=0.9927 (last merge round=26)
[S8] round=85 local utility u=0.002996 metrics={'f1_val': 0.994753542178155, 'auprc': 0.9992500878857368, 'loss_val': 0.028481525777650073, 'psi': 0.9965521604611878}-{'f1_val': 0.9934090858100645, 'auprc': 0.9995027716883529, 'loss_val': 0.027164124674247628, 'psi': 0.99584656016138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=85 head_norm_before_train=2.071680 cos_to_last_merge=0.9727 (last merge round=25)
[S9] round=85 local utility u=0.014072 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987963636469567, 'loss_val': 0.016211227819759748, 'psi': 0.9977802929660684}-{'f1_val': 0.9933536184876286, 'auprc': 0.9991891657727815, 'loss_val': 0.02303845355515344, 'psi': 0.9956878374016898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=85 head_norm_before_train=2.098916 cos_to_last_merge=0.7530 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.753
[S10] round=85 local utility u=0.001061 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9970094905248501, 'loss_val': 0.03742720966463414, 'psi': 0.994575742227735}-{'f1_val': 0.9929532433629917, 'auprc': 0.9967007753446786, 'loss_val': 0.038623206445971524, 'psi': 0.9944522561556666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=85 head_norm_before_train=2.197740 cos_to_last_merge=0.9626 (last merge round=26)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.996268412918549, 'loss_val': 0.023079996754703683, 'psi': 0.9961875701154052}-{'f1_val': 0.9961336749133093, 'auprc': 0.9965470389036053, 'loss_val': 0.01980905199392838, 'psi': 0.9962990205094278}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=1.794320 cos_to_last_merge=0.9163 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.916
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.6476090442617404, 'auprc': 0.7560895162905161, 'loss_val': 0.9642703711983636, 'psi': 0.6910012330732507}-{'f1_val': 0.7368432336507758, 'auprc': 0.7795605805544812, 'loss_val': 0.9225243712159684, 'psi': 0.753930172412258}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.085825 cos_to_last_merge=0.6891 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.689
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9342984928403986, 'auprc': 0.9723560014735375, 'loss_val': 0.1613033928060264, 'psi': 0.9495214962936542}-{'f1_val': 0.9348085321146704, 'auprc': 0.9955477234385933, 'loss_val': 0.1401894146772547, 'psi': 0.9591042086442396}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=2.150074 cos_to_last_merge=0.9508 (last merge round=22)
[S15] round=85 local utility u=0.000781 metrics={'f1_val': 0.9632543203286786, 'auprc': 0.998680348138438, 'loss_val': 0.05512593791772453, 'psi': 0.9774247314525824}-{'f1_val': 0.9630438119969724, 'auprc': 0.998685472203322, 'loss_val': 0.055440452915905006, 'psi': 0.9773004760795123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=85 head_norm_before_train=1.860389 cos_to_last_merge=0.9235 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9930812571555108, 'auprc': 0.9892470796375358, 'loss_val': 0.03872015932866214, 'psi': 0.9915475861483207}-{'f1_val': 0.9933003328734109, 'auprc': 0.988885042422656, 'loss_val': 0.03644577321421842, 'psi': 0.9915342166931089}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.000720 cos_to_last_merge=0.9066 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.907
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.6924316325601564, 'auprc': 0.908982252861601, 'loss_val': 0.875152022142738, 'psi': 0.7790518806807343}-{'f1_val': 0.7702254957631584, 'auprc': 0.9379445074257666, 'loss_val': 0.6572408604383019, 'psi': 0.8373131004282017}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=86 head_norm_before_train=2.104628 cos_to_last_merge=0.9541 (last merge round=21)
[S2] round=86 local utility u=0.128312 metrics={'f1_val': 0.8246335616724108, 'auprc': 0.8647978339642737, 'loss_val': 0.48525042618766007, 'psi': 0.8406992705891558}-{'f1_val': 0.8087777078296333, 'auprc': 0.805896190960548, 'loss_val': 0.47003535499392857, 'psi': 0.8076251010819993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=86 head_norm_before_train=2.017198 cos_to_last_merge=0.9350 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.972266755064086, 'loss_val': 0.17066368657207107, 'psi': 0.9655517532653066}-{'f1_val': 0.9610750853994537, 'auprc': 0.9990942965355043, 'loss_val': 0.12355833249917288, 'psi': 0.976282769853874}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=1.659421 cos_to_last_merge=0.9610 (last merge round=24)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9450981190992302, 'auprc': 0.9482689675110458, 'loss_val': 0.3128679320982193, 'psi': 0.9463664584639565}-{'f1_val': 0.9425285369744071, 'auprc': 0.9587436418848692, 'loss_val': 0.3137736322781137, 'psi': 0.949014578938592}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=1.812693 cos_to_last_merge=0.8692 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.869
[S5] round=86 local utility u=0.007409 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9947254382199673, 'loss_val': 0.024144232638941738, 'psi': 0.9956904624661209}-{'f1_val': 0.9963338119635569, 'auprc': 0.9915531615940965, 'loss_val': 0.029445888557595404, 'psi': 0.9944215518157726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=86 head_norm_before_train=1.775012 cos_to_last_merge=0.8692 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.7351102575982352, 'auprc': 0.8888440835793976, 'loss_val': 0.5720003622019665, 'psi': 0.7966037879907002}-{'f1_val': 0.8702251248874151, 'auprc': 0.9674664477678027, 'loss_val': 0.2772561406689509, 'psi': 0.9091216540395701}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=1.403379 cos_to_last_merge=0.8789 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.879
[S7] round=86 local utility u=0.305772 metrics={'f1_val': 0.6560659490108607, 'auprc': 0.8077355819274544, 'loss_val': 0.4665067150914433, 'psi': 0.7167338021774983}-{'f1_val': 0.6005220851036973, 'auprc': 0.7938599472363981, 'loss_val': 0.7031609478921862, 'psi': 0.6778572299567777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=86 head_norm_before_train=2.239088 cos_to_last_merge=0.9925 (last merge round=26)
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.993467150337892, 'auprc': 0.9994450455168146, 'loss_val': 0.03955812962678493, 'psi': 0.9958583084094611}-{'f1_val': 0.994753542178155, 'auprc': 0.9992500878857368, 'loss_val': 0.028481525777650073, 'psi': 0.9965521604611878}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=2.074080 cos_to_last_merge=0.9726 (last merge round=25)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9991942804084988, 'loss_val': 0.019772657339745328, 'psi': 0.9962917056810897}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987963636469567, 'loss_val': 0.016211227819759748, 'psi': 0.9977802929660684}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.104351 cos_to_last_merge=0.7528 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.753
[S10] round=86 local utility u=0.000827 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9969595830736151, 'loss_val': 0.03693668583884527, 'psi': 0.9946870895353759}-{'f1_val': 0.9929532433629917, 'auprc': 0.9970094905248501, 'loss_val': 0.03742720966463414, 'psi': 0.994575742227735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=86 head_norm_before_train=2.199145 cos_to_last_merge=0.9625 (last merge round=26)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9948409463834123, 'loss_val': 0.02947667498412744, 'psi': 0.9956165835013505}-{'f1_val': 0.9961336749133093, 'auprc': 0.996268412918549, 'loss_val': 0.023079996754703683, 'psi': 0.9961875701154052}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=1.798398 cos_to_last_merge=0.9159 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.916
[S13] round=86 local utility u=0.594538 metrics={'f1_val': 0.7666605619776858, 'auprc': 0.8272327089663803, 'loss_val': 0.7029323901411546, 'psi': 0.7908894207731636}-{'f1_val': 0.6476090442617404, 'auprc': 0.7560895162905161, 'loss_val': 0.9642703711983636, 'psi': 0.6910012330732507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=86 head_norm_before_train=2.091525 cos_to_last_merge=0.6886 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.689
[S14] round=86 local utility u=0.300092 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9969794268738141, 'loss_val': 0.0175733146210751, 'psi': 0.9976291906587335}-{'f1_val': 0.9342984928403986, 'auprc': 0.9723560014735375, 'loss_val': 0.1613033928060264, 'psi': 0.9495214962936542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=86 head_norm_before_train=2.154813 cos_to_last_merge=0.9505 (last merge round=22)
[S15] round=86 local utility u=0.096947 metrics={'f1_val': 0.9909010870725673, 'auprc': 0.9983939973867944, 'loss_val': 0.02625255423419247, 'psi': 0.9938982511982581}-{'f1_val': 0.9632543203286786, 'auprc': 0.998680348138438, 'loss_val': 0.05512593791772453, 'psi': 0.9774247314525824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=86 head_norm_before_train=1.865292 cos_to_last_merge=0.9230 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9919839118646606, 'auprc': 0.9890958160564446, 'loss_val': 0.04235765063385753, 'psi': 0.9908286735413743}-{'f1_val': 0.9930812571555108, 'auprc': 0.9892470796375358, 'loss_val': 0.03872015932866214, 'psi': 0.9915475861483207}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=2.004028 cos_to_last_merge=0.9063 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.906
[S17] round=86 local utility u=0.634468 metrics={'f1_val': 0.8165805314513264, 'auprc': 0.9624809742437692, 'loss_val': 0.5116053631783541, 'psi': 0.8749407085683035}-{'f1_val': 0.6924316325601564, 'auprc': 0.908982252861601, 'loss_val': 0.875152022142738, 'psi': 0.7790518806807343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=87 head_norm_before_train=2.109090 cos_to_last_merge=0.9537 (last merge round=21)
[S2] round=87 local utility u=0.000000 metrics={'f1_val': 0.5989573545763119, 'auprc': 0.7725983763349549, 'loss_val': 1.7822422520071233, 'psi': 0.6684137632797691}-{'f1_val': 0.8246335616724108, 'auprc': 0.8647978339642737, 'loss_val': 0.48525042618766007, 'psi': 0.8406992705891558}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=87 head_norm_before_train=2.020206 cos_to_last_merge=0.9348 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=87 local utility u=0.010841 metrics={'f1_val': 0.9504399250119783, 'auprc': 0.9955975820014474, 'loss_val': 0.15516267217940863, 'psi': 0.968502987807766}-{'f1_val': 0.9610750853994537, 'auprc': 0.972266755064086, 'loss_val': 0.17066368657207107, 'psi': 0.9655517532653066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=87 head_norm_before_train=1.663611 cos_to_last_merge=0.9606 (last merge round=24)
[S4] round=87 local utility u=0.045616 metrics={'f1_val': 0.9486873433412965, 'auprc': 0.9677987182796814, 'loss_val': 0.3017597236977757, 'psi': 0.9563318933166505}-{'f1_val': 0.9450981190992302, 'auprc': 0.9482689675110458, 'loss_val': 0.3128679320982193, 'psi': 0.9463664584639565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=87 head_norm_before_train=1.818376 cos_to_last_merge=0.8685 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.868
[S5] round=87 local utility u=0.005561 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9981791293509887, 'loss_val': 0.02338246718725349, 'psi': 0.9970719389185296}-{'f1_val': 0.9963338119635569, 'auprc': 0.9947254382199673, 'loss_val': 0.024144232638941738, 'psi': 0.9956904624661209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=87 head_norm_before_train=1.777322 cos_to_last_merge=0.8687 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.5726603079851734, 'auprc': 0.8247780141043424, 'loss_val': 0.7113004587698788, 'psi': 0.673507390432841}-{'f1_val': 0.7351102575982352, 'auprc': 0.8888440835793976, 'loss_val': 0.5720003622019665, 'psi': 0.7966037879907002}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.406932 cos_to_last_merge=0.8786 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.879
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.5449404267449569, 'auprc': 0.7833865065770954, 'loss_val': 0.900078527664076, 'psi': 0.6403188586778124}-{'f1_val': 0.6560659490108607, 'auprc': 0.8077355819274544, 'loss_val': 0.4665067150914433, 'psi': 0.7167338021774983}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=2.243805 cos_to_last_merge=0.9923 (last merge round=26)
[S8] round=87 local utility u=0.001765 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.9993115360163853, 'loss_val': 0.03349192249355626, 'psi': 0.9955914158796212}-{'f1_val': 0.993467150337892, 'auprc': 0.9994450455168146, 'loss_val': 0.03955812962678493, 'psi': 0.9958583084094611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=87 head_norm_before_train=2.077350 cos_to_last_merge=0.9723 (last merge round=25)
[S9] round=87 local utility u=0.010621 metrics={'f1_val': 0.9972945621169176, 'auprc': 0.9992046195655457, 'loss_val': 0.016188436324257014, 'psi': 0.9980585850963688}-{'f1_val': 0.994356655862817, 'auprc': 0.9991942804084988, 'loss_val': 0.019772657339745328, 'psi': 0.9962917056810897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=87 head_norm_before_train=2.109964 cos_to_last_merge=0.7525 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.752
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9965507437321827, 'loss_val': 0.03774325052987256, 'psi': 0.9943922435106681}-{'f1_val': 0.9931720938432163, 'auprc': 0.9969595830736151, 'loss_val': 0.03693668583884527, 'psi': 0.9946870895353759}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=2.202686 cos_to_last_merge=0.9622 (last merge round=26)
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9918614823862775, 'auprc': 0.9950006326733185, 'loss_val': 0.0432115891727654, 'psi': 0.9931171425010938}-{'f1_val': 0.9961336749133093, 'auprc': 0.9948409463834123, 'loss_val': 0.02947667498412744, 'psi': 0.9956165835013505}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=1.802083 cos_to_last_merge=0.9155 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.916
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.7172420585232996, 'auprc': 0.7287333948342745, 'loss_val': 0.9930190082396307, 'psi': 0.7218385930476896}-{'f1_val': 0.7666605619776858, 'auprc': 0.8272327089663803, 'loss_val': 0.7029323901411546, 'psi': 0.7908894207731636}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=2.095931 cos_to_last_merge=0.6882 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.688
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.996993452559553, 'auprc': 0.9969830926431986, 'loss_val': 0.019414270844107906, 'psi': 0.9969893085930113}-{'f1_val': 0.9980623665153463, 'auprc': 0.9969794268738141, 'loss_val': 0.0175733146210751, 'psi': 0.9976291906587335}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=2.159386 cos_to_last_merge=0.9502 (last merge round=22)
[S15] round=87 local utility u=0.018184 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970491339558633, 'loss_val': 0.02092407421060696, 'psi': 0.9968676546148576}-{'f1_val': 0.9909010870725673, 'auprc': 0.9983939973867944, 'loss_val': 0.02625255423419247, 'psi': 0.9938982511982581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=87 head_norm_before_train=1.870462 cos_to_last_merge=0.9226 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9889274826319894, 'auprc': 0.9889235446314134, 'loss_val': 0.0527253671335211, 'psi': 0.988925907431759}-{'f1_val': 0.9919839118646606, 'auprc': 0.9890958160564446, 'loss_val': 0.04235765063385753, 'psi': 0.9908286735413743}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.009030 cos_to_last_merge=0.9057 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.906
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.7667475403423407, 'auprc': 0.9524772970936035, 'loss_val': 0.7146444307146183, 'psi': 0.8410394430428458}-{'f1_val': 0.8165805314513264, 'auprc': 0.9624809742437692, 'loss_val': 0.5116053631783541, 'psi': 0.8749407085683035}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.113580 cos_to_last_merge=0.9532 (last merge round=21)
[S2] round=88 local utility u=1.000000 metrics={'f1_val': 0.8268519393427252, 'auprc': 0.827859201459133, 'loss_val': 0.49432058197959766, 'psi': 0.8272548441892883}-{'f1_val': 0.5989573545763119, 'auprc': 0.7725983763349549, 'loss_val': 1.7822422520071233, 'psi': 0.6684137632797691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=88 head_norm_before_train=2.022625 cos_to_last_merge=0.9347 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=88 local utility u=0.010735 metrics={'f1_val': 0.9464967446770873, 'auprc': 0.9965451263635008, 'loss_val': 0.11287528750983683, 'psi': 0.9665160973516527}-{'f1_val': 0.9504399250119783, 'auprc': 0.9955975820014474, 'loss_val': 0.15516267217940863, 'psi': 0.968502987807766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=88 head_norm_before_train=1.666264 cos_to_last_merge=0.9602 (last merge round=24)
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9398594711184903, 'auprc': 0.9532444391320298, 'loss_val': 0.31936059563422164, 'psi': 0.9452134583239061}-{'f1_val': 0.9486873433412965, 'auprc': 0.9677987182796814, 'loss_val': 0.3017597236977757, 'psi': 0.9563318933166505}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.825041 cos_to_last_merge=0.8677 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.868
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9919048077078801, 'loss_val': 0.024941105241920204, 'psi': 0.9945622102612861}-{'f1_val': 0.9963338119635569, 'auprc': 0.9981791293509887, 'loss_val': 0.02338246718725349, 'psi': 0.9970719389185296}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=1.778039 cos_to_last_merge=0.8684 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.868
[S6] round=88 local utility u=1.000000 metrics={'f1_val': 0.8651172033989465, 'auprc': 0.9874303122989034, 'loss_val': 0.22977132307468956, 'psi': 0.9140424469589292}-{'f1_val': 0.5726603079851734, 'auprc': 0.8247780141043424, 'loss_val': 0.7113004587698788, 'psi': 0.673507390432841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=88 head_norm_before_train=1.410429 cos_to_last_merge=0.8782 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.878
[S7] round=88 local utility u=0.730460 metrics={'f1_val': 0.6699414907231033, 'auprc': 0.8359121299332201, 'loss_val': 0.3467420321925623, 'psi': 0.73632974640715}-{'f1_val': 0.5449404267449569, 'auprc': 0.7833865065770954, 'loss_val': 0.900078527664076, 'psi': 0.6403188586778124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=88 head_norm_before_train=2.245625 cos_to_last_merge=0.9922 (last merge round=26)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9863996358172417, 'auprc': 0.9959441593472255, 'loss_val': 0.045840084841240164, 'psi': 0.9902174452292352}-{'f1_val': 0.9931113357884451, 'auprc': 0.9993115360163853, 'loss_val': 0.03349192249355626, 'psi': 0.9955914158796212}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=2.081104 cos_to_last_merge=0.9721 (last merge round=25)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9992048951789823, 'loss_val': 0.016395239116371464, 'psi': 0.9977935093269472}-{'f1_val': 0.9972945621169176, 'auprc': 0.9992046195655457, 'loss_val': 0.016188436324257014, 'psi': 0.9980585850963688}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.115576 cos_to_last_merge=0.7521 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.752
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9965388817042333, 'loss_val': 0.03821312451606344, 'psi': 0.9943874986994884}-{'f1_val': 0.9929532433629917, 'auprc': 0.9965507437321827, 'loss_val': 0.03774325052987256, 'psi': 0.9943922435106681}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=2.204981 cos_to_last_merge=0.9618 (last merge round=26)
[S11] round=88 local utility u=0.020058 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9950549055160982, 'loss_val': 0.02889076148653241, 'psi': 0.9957021671544248}-{'f1_val': 0.9918614823862775, 'auprc': 0.9950006326733185, 'loss_val': 0.0432115891727654, 'psi': 0.9931171425010938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=88 head_norm_before_train=1.804934 cos_to_last_merge=0.9152 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6727549986461232, 'auprc': 0.700594427866414, 'loss_val': 1.1417967264826399, 'psi': 0.6838907703342395}-{'f1_val': 0.7172420585232996, 'auprc': 0.7287333948342745, 'loss_val': 0.9930190082396307, 'psi': 0.7218385930476896}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=2.101627 cos_to_last_merge=0.6876 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.688
[S14] round=88 local utility u=0.000000 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9963820003318391, 'loss_val': 0.019135915389157054, 'psi': 0.9967668137392826}-{'f1_val': 0.996993452559553, 'auprc': 0.9969830926431986, 'loss_val': 0.019414270844107906, 'psi': 0.9969893085930113}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=88 head_norm_before_train=2.163660 cos_to_last_merge=0.9500 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9975803154976411, 'loss_val': 0.023287895285534047, 'psi': 0.9970801272315688}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970491339558633, 'loss_val': 0.02092407421060696, 'psi': 0.9968676546148576}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.875020 cos_to_last_merge=0.9221 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.9852342455249441, 'auprc': 0.9901345453414927, 'loss_val': 0.06253606312544781, 'psi': 0.9871943654515636}-{'f1_val': 0.9889274826319894, 'auprc': 0.9889235446314134, 'loss_val': 0.0527253671335211, 'psi': 0.988925907431759}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=2.015304 cos_to_last_merge=0.9049 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.905
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.622068359919836, 'auprc': 0.927430942628525, 'loss_val': 1.1343441571937138, 'psi': 0.7442133930033116}-{'f1_val': 0.7667475403423407, 'auprc': 0.9524772970936035, 'loss_val': 0.7146444307146183, 'psi': 0.8410394430428458}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=89 head_norm_before_train=2.118377 cos_to_last_merge=0.9527 (last merge round=21)
[S2] round=89 local utility u=0.118376 metrics={'f1_val': 0.8273378635688552, 'auprc': 0.8999356301952482, 'loss_val': 0.476712546628978, 'psi': 0.8563769702194124}-{'f1_val': 0.8268519393427252, 'auprc': 0.827859201459133, 'loss_val': 0.49432058197959766, 'psi': 0.8272548441892883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=89 head_norm_before_train=2.026911 cos_to_last_merge=0.9343 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=89 local utility u=0.141004 metrics={'f1_val': 0.9838832197587216, 'auprc': 0.9977956026402324, 'loss_val': 0.058937847938291286, 'psi': 0.9894481729113259}-{'f1_val': 0.9464967446770873, 'auprc': 0.9965451263635008, 'loss_val': 0.11287528750983683, 'psi': 0.9665160973516527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=89 head_norm_before_train=1.670312 cos_to_last_merge=0.9597 (last merge round=24)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9388946837223223, 'auprc': 0.9519905033307176, 'loss_val': 0.3266851804255364, 'psi': 0.9441330115656803}-{'f1_val': 0.9398594711184903, 'auprc': 0.9532444391320298, 'loss_val': 0.31936059563422164, 'psi': 0.9452134583239061}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.830139 cos_to_last_merge=0.8670 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.867
[S5] round=89 local utility u=0.003250 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9940607514027684, 'loss_val': 0.024907947964136704, 'psi': 0.9954245877392414}-{'f1_val': 0.9963338119635569, 'auprc': 0.9919048077078801, 'loss_val': 0.024941105241920204, 'psi': 0.9945622102612861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=89 head_norm_before_train=1.780636 cos_to_last_merge=0.8679 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.868
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.6319430046165087, 'auprc': 0.9432882145236504, 'loss_val': 0.5444296773766918, 'psi': 0.7564810885793654}-{'f1_val': 0.8651172033989465, 'auprc': 0.9874303122989034, 'loss_val': 0.22977132307468956, 'psi': 0.9140424469589292}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.413271 cos_to_last_merge=0.8779 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.878
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.58061336104375, 'auprc': 0.7838772808689062, 'loss_val': 0.741742284513627, 'psi': 0.6619189289738125}-{'f1_val': 0.6699414907231033, 'auprc': 0.8359121299332201, 'loss_val': 0.3467420321925623, 'psi': 0.73632974640715}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=2.248554 cos_to_last_merge=0.9921 (last merge round=26)
[S8] round=89 local utility u=0.016027 metrics={'f1_val': 0.9896117350694913, 'auprc': 0.9971407012362415, 'loss_val': 0.03664895544197594, 'psi': 0.9926233215361914}-{'f1_val': 0.9863996358172417, 'auprc': 0.9959441593472255, 'loss_val': 0.045840084841240164, 'psi': 0.9902174452292352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=89 head_norm_before_train=2.085059 cos_to_last_merge=0.9718 (last merge round=25)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9982507723051741, 'loss_val': 0.016451156572006978, 'psi': 0.997315803680927}-{'f1_val': 0.9968525854255906, 'auprc': 0.9992048951789823, 'loss_val': 0.016395239116371464, 'psi': 0.9977935093269472}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.121015 cos_to_last_merge=0.7519 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.752
[S10] round=89 local utility u=0.000026 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9966236872533133, 'loss_val': 0.03841582876528689, 'psi': 0.9944214209191204}-{'f1_val': 0.9929532433629917, 'auprc': 0.9965388817042333, 'loss_val': 0.03821312451606344, 'psi': 0.9943874986994884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=89 head_norm_before_train=2.207742 cos_to_last_merge=0.9614 (last merge round=26)
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.7998535528846582, 'auprc': 0.9949326541927217, 'loss_val': 0.48541483822125, 'psi': 0.8778851934078835}-{'f1_val': 0.9961336749133093, 'auprc': 0.9950549055160982, 'loss_val': 0.02889076148653241, 'psi': 0.9957021671544248}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=1.808514 cos_to_last_merge=0.9148 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=89 local utility u=0.352612 metrics={'f1_val': 0.7359536161697524, 'auprc': 0.7435134991034549, 'loss_val': 0.9445215009978003, 'psi': 0.7389775693432334}-{'f1_val': 0.6727549986461232, 'auprc': 0.700594427866414, 'loss_val': 1.1417967264826399, 'psi': 0.6838907703342395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=89 head_norm_before_train=2.106351 cos_to_last_merge=0.6873 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.687
[S14] round=89 local utility u=0.000971 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9962264847450736, 'loss_val': 0.01905301298751623, 'psi': 0.9969371904587263}-{'f1_val': 0.9970233560109115, 'auprc': 0.9963820003318391, 'loss_val': 0.019135915389157054, 'psi': 0.9967668137392826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=89 head_norm_before_train=2.168257 cos_to_last_merge=0.9497 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.9641301409518149, 'auprc': 0.9976313312493523, 'loss_val': 0.05763811001483818, 'psi': 0.9775306170708299}-{'f1_val': 0.9967466683875206, 'auprc': 0.9975803154976411, 'loss_val': 0.023287895285534047, 'psi': 0.9970801272315688}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=1.879008 cos_to_last_merge=0.9217 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=89 local utility u=0.013373 metrics={'f1_val': 0.9887096936695857, 'auprc': 0.9892004033173254, 'loss_val': 0.05384034773472938, 'psi': 0.9889059775286816}-{'f1_val': 0.9852342455249441, 'auprc': 0.9901345453414927, 'loss_val': 0.06253606312544781, 'psi': 0.9871943654515636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=89 head_norm_before_train=2.021743 cos_to_last_merge=0.9042 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=89 local utility u=1.000000 metrics={'f1_val': 0.87842887071783, 'auprc': 0.9885406660101883, 'loss_val': 0.34720578399615576, 'psi': 0.9224735888347734}-{'f1_val': 0.622068359919836, 'auprc': 0.927430942628525, 'loss_val': 1.1343441571937138, 'psi': 0.7442133930033116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=90 head_norm_before_train=2.123956 cos_to_last_merge=0.9521 (last merge round=21)
[S2] round=90 local utility u=0.068957 metrics={'f1_val': 0.8275977784136561, 'auprc': 0.9285142400119232, 'loss_val': 0.4260946503466883, 'psi': 0.867964363052963}-{'f1_val': 0.8273378635688552, 'auprc': 0.8999356301952482, 'loss_val': 0.476712546628978, 'psi': 0.8563769702194124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=90 head_norm_before_train=2.032277 cos_to_last_merge=0.9339 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=90 local utility u=0.017896 metrics={'f1_val': 0.98674631187684, 'auprc': 0.9982652956605504, 'loss_val': 0.04173343793152926, 'psi': 0.9913539053903242}-{'f1_val': 0.9838832197587216, 'auprc': 0.9977956026402324, 'loss_val': 0.058937847938291286, 'psi': 0.9894481729113259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=90 head_norm_before_train=1.673249 cos_to_last_merge=0.9594 (last merge round=24)
[S4] round=90 local utility u=0.026249 metrics={'f1_val': 0.940440383471048, 'auprc': 0.9630479896611628, 'loss_val': 0.3166328457362523, 'psi': 0.9494834259470939}-{'f1_val': 0.9388946837223223, 'auprc': 0.9519905033307176, 'loss_val': 0.3266851804255364, 'psi': 0.9441330115656803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=90 head_norm_before_train=1.832403 cos_to_last_merge=0.8665 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.866
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9917213785205339, 'loss_val': 0.026242183594715054, 'psi': 0.9944888385863476}-{'f1_val': 0.9963338119635569, 'auprc': 0.9940607514027684, 'loss_val': 0.024907947964136704, 'psi': 0.9954245877392414}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=1.782014 cos_to_last_merge=0.8675 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=90 local utility u=0.771532 metrics={'f1_val': 0.8366724986956703, 'auprc': 0.9771050922655302, 'loss_val': 0.33119335928486243, 'psi': 0.8928455361236143}-{'f1_val': 0.6319430046165087, 'auprc': 0.9432882145236504, 'loss_val': 0.5444296773766918, 'psi': 0.7564810885793654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=90 head_norm_before_train=1.416640 cos_to_last_merge=0.8775 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.878
[S7] round=90 local utility u=0.740953 metrics={'f1_val': 0.7221404066213943, 'auprc': 0.8530437037497474, 'loss_val': 0.3164975110087737, 'psi': 0.7745017254727355}-{'f1_val': 0.58061336104375, 'auprc': 0.7838772808689062, 'loss_val': 0.741742284513627, 'psi': 0.6619189289738125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=90 head_norm_before_train=2.254355 cos_to_last_merge=0.9919 (last merge round=26)
[S8] round=90 local utility u=0.000267 metrics={'f1_val': 0.9917822352048012, 'auprc': 0.9935028635121248, 'loss_val': 0.03822514302135767, 'psi': 0.9924704865277306}-{'f1_val': 0.9896117350694913, 'auprc': 0.9971407012362415, 'loss_val': 0.03664895544197594, 'psi': 0.9926233215361914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=90 head_norm_before_train=2.087958 cos_to_last_merge=0.9717 (last merge round=25)
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.998821187156961, 'loss_val': 0.01674859550543579, 'psi': 0.9972910923010281}-{'f1_val': 0.9966924912647621, 'auprc': 0.9982507723051741, 'loss_val': 0.016451156572006978, 'psi': 0.997315803680927}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.123256 cos_to_last_merge=0.7516 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.752
[S10] round=90 local utility u=0.000609 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9966616233250716, 'loss_val': 0.037311330547685866, 'psi': 0.9944365953478237}-{'f1_val': 0.9929532433629917, 'auprc': 0.9966236872533133, 'loss_val': 0.03841582876528689, 'psi': 0.9944214209191204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=90 head_norm_before_train=2.209128 cos_to_last_merge=0.9612 (last merge round=26)
[S11] round=90 local utility u=0.643516 metrics={'f1_val': 0.9476601773366014, 'auprc': 0.9950301820501541, 'loss_val': 0.08551500909931865, 'psi': 0.9666081792220225}-{'f1_val': 0.7998535528846582, 'auprc': 0.9949326541927217, 'loss_val': 0.48541483822125, 'psi': 0.8778851934078835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=90 head_norm_before_train=1.811957 cos_to_last_merge=0.9145 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.915
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.6539195149509595, 'auprc': 0.712859546526986, 'loss_val': 1.0284573477097243, 'psi': 0.6774955275813701}-{'f1_val': 0.7359536161697524, 'auprc': 0.7435134991034549, 'loss_val': 0.9445215009978003, 'psi': 0.7389775693432334}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=2.111684 cos_to_last_merge=0.6870 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.687
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9968576989310864, 'loss_val': 0.021900206533738757, 'psi': 0.9971896761331315}-{'f1_val': 0.9974109942678281, 'auprc': 0.9962264847450736, 'loss_val': 0.01905301298751623, 'psi': 0.9969371904587263}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.172734 cos_to_last_merge=0.9494 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9224338790805343, 'auprc': 0.9979104513688136, 'loss_val': 0.12004603030120413, 'psi': 0.952624507995846}-{'f1_val': 0.9641301409518149, 'auprc': 0.9976313312493523, 'loss_val': 0.05763811001483818, 'psi': 0.9775306170708299}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=1.882637 cos_to_last_merge=0.9214 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=90 local utility u=0.014743 metrics={'f1_val': 0.9919839118646606, 'auprc': 0.988668928864663, 'loss_val': 0.042406089950947586, 'psi': 0.9906579186646616}-{'f1_val': 0.9887096936695857, 'auprc': 0.9892004033173254, 'loss_val': 0.05384034773472938, 'psi': 0.9889059775286816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=90 head_norm_before_train=2.025336 cos_to_last_merge=0.9039 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=90 local utility u=0.019804 metrics={'f1_val': 0.8798383995896814, 'auprc': 0.9878141511916533, 'loss_val': 0.31387500327345663, 'psi': 0.9230287002304701}-{'f1_val': 0.87842887071783, 'auprc': 0.9885406660101883, 'loss_val': 0.34720578399615576, 'psi': 0.9224735888347734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=91 head_norm_before_train=2.128433 cos_to_last_merge=0.9516 (last merge round=21)
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.8172055600637655, 'auprc': 0.9378311430304316, 'loss_val': 0.4640424576186224, 'psi': 0.8654557932504319}-{'f1_val': 0.8275977784136561, 'auprc': 0.9285142400119232, 'loss_val': 0.4260946503466883, 'psi': 0.867964363052963}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=91 head_norm_before_train=2.037834 cos_to_last_merge=0.9335 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9617650886698078, 'loss_val': 0.1818488418222631, 'psi': 0.9610725959167964}-{'f1_val': 0.98674631187684, 'auprc': 0.9982652956605504, 'loss_val': 0.04173343793152926, 'psi': 0.9913539053903242}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=1.675825 cos_to_last_merge=0.9590 (last merge round=24)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.8038247010389291, 'auprc': 0.9425978292893755, 'loss_val': 0.4840648995943774, 'psi': 0.8593339523391077}-{'f1_val': 0.940440383471048, 'auprc': 0.9630479896611628, 'loss_val': 0.3166328457362523, 'psi': 0.9494834259470939}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.836183 cos_to_last_merge=0.8661 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.866
[S5] round=91 local utility u=0.006493 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9941913488358562, 'loss_val': 0.02287417271093188, 'psi': 0.995697720621417}-{'f1_val': 0.9963338119635569, 'auprc': 0.9917213785205339, 'loss_val': 0.026242183594715054, 'psi': 0.9944888385863476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=91 head_norm_before_train=1.784643 cos_to_last_merge=0.8670 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.7516930804370264, 'auprc': 0.9719776370611714, 'loss_val': 0.45690363432406145, 'psi': 0.8398069030866844}-{'f1_val': 0.8366724986956703, 'auprc': 0.9771050922655302, 'loss_val': 0.33119335928486243, 'psi': 0.8928455361236143}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=1.422062 cos_to_last_merge=0.8771 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.575199653702718, 'auprc': 0.7863507700975397, 'loss_val': 0.8251886314996167, 'psi': 0.6596601002606466}-{'f1_val': 0.7221404066213943, 'auprc': 0.8530437037497474, 'loss_val': 0.3164975110087737, 'psi': 0.7745017254727355}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=2.260275 cos_to_last_merge=0.9917 (last merge round=26)
[S8] round=91 local utility u=0.001737 metrics={'f1_val': 0.9892110952630988, 'auprc': 0.9992937116327819, 'loss_val': 0.03669611131167107, 'psi': 0.9932441418109721}-{'f1_val': 0.9917822352048012, 'auprc': 0.9935028635121248, 'loss_val': 0.03822514302135767, 'psi': 0.9924704865277306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] sending update (kind=head size=1791 to 1 peers)
[S9] START round=91 head_norm_before_train=2.089863 cos_to_last_merge=0.9716 (last merge round=25)
[S9] round=91 local utility u=0.002942 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988096977120815, 'loss_val': 0.015821654755643164, 'psi': 0.9977856265921183}-{'f1_val': 0.9962710290637395, 'auprc': 0.998821187156961, 'loss_val': 0.01674859550543579, 'psi': 0.9972910923010281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=91 head_norm_before_train=2.124639 cos_to_last_merge=0.7513 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.751
[S10] round=91 local utility u=0.001405 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9970442664964588, 'loss_val': 0.03696151978305859, 'psi': 0.9947209629045133}-{'f1_val': 0.9929532433629917, 'auprc': 0.9966616233250716, 'loss_val': 0.037311330547685866, 'psi': 0.9944365953478237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=91 head_norm_before_train=2.213220 cos_to_last_merge=0.9610 (last merge round=26)
[S11] round=91 local utility u=0.181384 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9965712053212057, 'loss_val': 0.020691839950766542, 'psi': 0.9965566848366361}-{'f1_val': 0.9476601773366014, 'auprc': 0.9950301820501541, 'loss_val': 0.08551500909931865, 'psi': 0.9666081792220225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=91 head_norm_before_train=1.816962 cos_to_last_merge=0.9138 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.914
[S13] round=91 local utility u=0.268730 metrics={'f1_val': 0.720663444469254, 'auprc': 0.7489784901747537, 'loss_val': 0.9998179026708626, 'psi': 0.7319894627514538}-{'f1_val': 0.6539195149509595, 'auprc': 0.712859546526986, 'loss_val': 1.0284573477097243, 'psi': 0.6774955275813701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=91 head_norm_before_train=2.117623 cos_to_last_merge=0.6866 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.687
[S14] round=91 local utility u=0.004649 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9985532687815364, 'loss_val': 0.017688267721032755, 'psi': 0.9978679040733114}-{'f1_val': 0.9974109942678281, 'auprc': 0.9968576989310864, 'loss_val': 0.021900206533738757, 'psi': 0.9971896761331315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=91 head_norm_before_train=2.177218 cos_to_last_merge=0.9492 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.9148932727677044, 'auprc': 0.9978961093066623, 'loss_val': 0.13748888974439094, 'psi': 0.9480944073832875}-{'f1_val': 0.9224338790805343, 'auprc': 0.9979104513688136, 'loss_val': 0.12004603030120413, 'psi': 0.952624507995846}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=1.885632 cos_to_last_merge=0.9213 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=91 local utility u=0.006261 metrics={'f1_val': 0.9930812571555108, 'auprc': 0.988867522699199, 'loss_val': 0.037062969713027215, 'psi': 0.991395763372986}-{'f1_val': 0.9919839118646606, 'auprc': 0.988668928864663, 'loss_val': 0.042406089950947586, 'psi': 0.9906579186646616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=91 head_norm_before_train=2.025545 cos_to_last_merge=0.9040 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.6846266047008873, 'auprc': 0.9118997844599859, 'loss_val': 0.8796461250535214, 'psi': 0.7755358766045267}-{'f1_val': 0.8798383995896814, 'auprc': 0.9878141511916533, 'loss_val': 0.31387500327345663, 'psi': 0.9230287002304701}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.132094 cos_to_last_merge=0.9514 (last merge round=21)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.8172055600637655, 'auprc': 0.9331153577332375, 'loss_val': 0.4779125268066264, 'psi': 0.8635694791315542}-{'f1_val': 0.8172055600637655, 'auprc': 0.9378311430304316, 'loss_val': 0.4640424576186224, 'psi': 0.8654557932504319}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.042939 cos_to_last_merge=0.9331 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=92 local utility u=0.218007 metrics={'f1_val': 0.9894602533459695, 'auprc': 0.9987433825055001, 'loss_val': 0.02986631444365317, 'psi': 0.9931735050097819}-{'f1_val': 0.9606109340814555, 'auprc': 0.9617650886698078, 'loss_val': 0.1818488418222631, 'psi': 0.9610725959167964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=92 head_norm_before_train=1.677232 cos_to_last_merge=0.9584 (last merge round=24)
[S4] round=92 local utility u=0.488858 metrics={'f1_val': 0.9386068511174468, 'auprc': 0.9491282515991373, 'loss_val': 0.33463332229410636, 'psi': 0.9428154113101229}-{'f1_val': 0.8038247010389291, 'auprc': 0.9425978292893755, 'loss_val': 0.4840648995943774, 'psi': 0.8593339523391077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=92 head_norm_before_train=1.840358 cos_to_last_merge=0.8657 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.866
[S5] round=92 local utility u=0.000005 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9941849234416944, 'loss_val': 0.02284582894679479, 'psi': 0.9956951504637523}-{'f1_val': 0.9967019684784577, 'auprc': 0.9941913488358562, 'loss_val': 0.02287417271093188, 'psi': 0.995697720621417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=92 head_norm_before_train=1.789782 cos_to_last_merge=0.8661 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.866
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.7258949774004155, 'auprc': 0.9526158988570118, 'loss_val': 0.6819523609101518, 'psi': 0.816583345983054}-{'f1_val': 0.7516930804370264, 'auprc': 0.9719776370611714, 'loss_val': 0.45690363432406145, 'psi': 0.8398069030866844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.426924 cos_to_last_merge=0.8766 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=92 local utility u=0.682674 metrics={'f1_val': 0.6887826819172357, 'auprc': 0.8494036193879727, 'loss_val': 0.33049694991528067, 'psi': 0.7530310569055305}-{'f1_val': 0.575199653702718, 'auprc': 0.7863507700975397, 'loss_val': 0.8251886314996167, 'psi': 0.6596601002606466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=92 head_norm_before_train=2.265965 cos_to_last_merge=0.9915 (last merge round=26)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9719292512674685, 'auprc': 0.9991230096049699, 'loss_val': 0.07643023254457974, 'psi': 0.9828067546024691}-{'f1_val': 0.9892110952630988, 'auprc': 0.9992937116327819, 'loss_val': 0.03669611131167107, 'psi': 0.9932441418109721}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=2.092597 cos_to_last_merge=0.9715 (last merge round=25)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967772797106957, 'loss_val': 0.016347449668733634, 'psi': 0.996972659391564}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988096977120815, 'loss_val': 0.015821654755643164, 'psi': 0.9977856265921183}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.127847 cos_to_last_merge=0.7510 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.751
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9969819577283161, 'loss_val': 0.037580071800431096, 'psi': 0.9945647291091215}-{'f1_val': 0.9931720938432163, 'auprc': 0.9970442664964588, 'loss_val': 0.03696151978305859, 'psi': 0.9947209629045133}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=2.218926 cos_to_last_merge=0.9606 (last merge round=26)
[S11] round=92 local utility u=0.001519 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9973751845278803, 'loss_val': 0.020065648409528514, 'psi': 0.9968782765193058}-{'f1_val': 0.9965470045135896, 'auprc': 0.9965712053212057, 'loss_val': 0.020691839950766542, 'psi': 0.9965566848366361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=92 head_norm_before_train=1.821860 cos_to_last_merge=0.9129 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.913
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.6267297922637194, 'auprc': 0.6534522381402803, 'loss_val': 1.20418632368063, 'psi': 0.6374187706143437}-{'f1_val': 0.720663444469254, 'auprc': 0.7489784901747537, 'loss_val': 0.9998179026708626, 'psi': 0.7319894627514538}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=2.121526 cos_to_last_merge=0.6865 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.687
[S14] round=92 local utility u=0.001046 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9986748369409734, 'loss_val': 0.01828006548407918, 'psi': 0.998148440932326}-{'f1_val': 0.9974109942678281, 'auprc': 0.9985532687815364, 'loss_val': 0.017688267721032755, 'psi': 0.9978679040733114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=92 head_norm_before_train=2.181669 cos_to_last_merge=0.9489 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=92 local utility u=0.006411 metrics={'f1_val': 0.9165269274616898, 'auprc': 0.9979045173379757, 'loss_val': 0.13449403024563172, 'psi': 0.9490779634122042}-{'f1_val': 0.9148932727677044, 'auprc': 0.9978961093066623, 'loss_val': 0.13748888974439094, 'psi': 0.9480944073832875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=92 head_norm_before_train=1.888786 cos_to_last_merge=0.9212 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=92 local utility u=0.002068 metrics={'f1_val': 0.9933439843583706, 'auprc': 0.9888106121449083, 'loss_val': 0.034333561088134894, 'psi': 0.9915306354729857}-{'f1_val': 0.9930812571555108, 'auprc': 0.988867522699199, 'loss_val': 0.037062969713027215, 'psi': 0.991395763372986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=92 head_norm_before_train=2.026978 cos_to_last_merge=0.9039 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=92 local utility u=0.622208 metrics={'f1_val': 0.8120264956041418, 'auprc': 0.954778955419351, 'loss_val': 0.5282675758594949, 'psi': 0.8691274795302255}-{'f1_val': 0.6846266047008873, 'auprc': 0.9118997844599859, 'loss_val': 0.8796461250535214, 'psi': 0.7755358766045267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=93 head_norm_before_train=2.137006 cos_to_last_merge=0.9509 (last merge round=21)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.8271463847630155, 'auprc': 0.8726123880649413, 'loss_val': 0.47619720747869365, 'psi': 0.8453327860837858}-{'f1_val': 0.8172055600637655, 'auprc': 0.9331153577332375, 'loss_val': 0.4779125268066264, 'psi': 0.8635694791315542}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.048452 cos_to_last_merge=0.9326 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=93 local utility u=0.026009 metrics={'f1_val': 0.996718896605481, 'auprc': 0.998713577532511, 'loss_val': 0.021309767760670433, 'psi': 0.9975167689762929}-{'f1_val': 0.9894602533459695, 'auprc': 0.9987433825055001, 'loss_val': 0.02986631444365317, 'psi': 0.9931735050097819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=93 head_norm_before_train=1.678122 cos_to_last_merge=0.9579 (last merge round=24)
[S4] round=93 local utility u=0.044883 metrics={'f1_val': 0.9406844855678808, 'auprc': 0.9679093773451125, 'loss_val': 0.3136773878104559, 'psi': 0.9515744422787734}-{'f1_val': 0.9386068511174468, 'auprc': 0.9491282515991373, 'loss_val': 0.33463332229410636, 'psi': 0.9428154113101229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=93 head_norm_before_train=1.842298 cos_to_last_merge=0.8654 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.865
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.7261764128930577, 'auprc': 0.989257373264933, 'loss_val': 0.401253659538635, 'psi': 0.8314087970418078}-{'f1_val': 0.9967019684784577, 'auprc': 0.9941849234416944, 'loss_val': 0.02284582894679479, 'psi': 0.9956951504637523}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=1.796890 cos_to_last_merge=0.8651 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=93 local utility u=0.723925 metrics={'f1_val': 0.8823597231387926, 'auprc': 0.9805473128584994, 'loss_val': 0.2566847787119533, 'psi': 0.9216347590266754}-{'f1_val': 0.7258949774004155, 'auprc': 0.9526158988570118, 'loss_val': 0.6819523609101518, 'psi': 0.816583345983054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=93 head_norm_before_train=1.431216 cos_to_last_merge=0.8763 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.876
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.5470975733594234, 'auprc': 0.7830431905077949, 'loss_val': 0.975455651375795, 'psi': 0.641475820218772}-{'f1_val': 0.6887826819172357, 'auprc': 0.8494036193879727, 'loss_val': 0.33049694991528067, 'psi': 0.7530310569055305}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=2.270564 cos_to_last_merge=0.9914 (last merge round=26)
[S8] round=93 local utility u=0.008319 metrics={'f1_val': 0.9735566135715626, 'auprc': 0.9991960756380184, 'loss_val': 0.06977620723301553, 'psi': 0.983812398398145}-{'f1_val': 0.9719292512674685, 'auprc': 0.9991230096049699, 'loss_val': 0.07643023254457974, 'psi': 0.9828067546024691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=93 head_norm_before_train=2.096134 cos_to_last_merge=0.9712 (last merge round=25)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.999201372934805, 'loss_val': 0.026966959445515998, 'psi': 0.9941738504855883}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967772797106957, 'loss_val': 0.016347449668733634, 'psi': 0.996972659391564}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.132011 cos_to_last_merge=0.7507 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.751
[S10] round=93 local utility u=0.000513 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9976301385440512, 'loss_val': 0.03849851241322694, 'psi': 0.9948240014354155}-{'f1_val': 0.9929532433629917, 'auprc': 0.9969819577283161, 'loss_val': 0.037580071800431096, 'psi': 0.9945647291091215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=93 head_norm_before_train=2.225128 cos_to_last_merge=0.9603 (last merge round=26)
[S11] round=93 local utility u=0.001642 metrics={'f1_val': 0.9967894001465077, 'auprc': 0.9976427015698351, 'loss_val': 0.01903863145558763, 'psi': 0.9971307207158387}-{'f1_val': 0.9965470045135896, 'auprc': 0.9973751845278803, 'loss_val': 0.020065648409528514, 'psi': 0.9968782765193058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=93 head_norm_before_train=1.826652 cos_to_last_merge=0.9122 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.912
[S13] round=93 local utility u=0.354352 metrics={'f1_val': 0.6890051409410713, 'auprc': 0.729985994247586, 'loss_val': 1.098736108719529, 'psi': 0.7053974822636773}-{'f1_val': 0.6267297922637194, 'auprc': 0.6534522381402803, 'loss_val': 1.20418632368063, 'psi': 0.6374187706143437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=93 head_norm_before_train=2.124750 cos_to_last_merge=0.6864 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.686
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9948880898436442, 'auprc': 0.9986748369409733, 'loss_val': 0.028305560635086807, 'psi': 0.9964027886825757}-{'f1_val': 0.9977975102598944, 'auprc': 0.9986748369409734, 'loss_val': 0.01828006548407918, 'psi': 0.998148440932326}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.185966 cos_to_last_merge=0.9486 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=93 local utility u=0.019187 metrics={'f1_val': 0.9208356231870446, 'auprc': 0.9979250212934333, 'loss_val': 0.12203307250529383, 'psi': 0.9516713824296001}-{'f1_val': 0.9165269274616898, 'auprc': 0.9979045173379757, 'loss_val': 0.13449403024563172, 'psi': 0.9490779634122042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=93 head_norm_before_train=1.891385 cos_to_last_merge=0.9211 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=93 local utility u=0.000559 metrics={'f1_val': 0.9933865550435556, 'auprc': 0.9891571134076356, 'loss_val': 0.034509902025887905, 'psi': 0.9916947783891876}-{'f1_val': 0.9933439843583706, 'auprc': 0.9888106121449083, 'loss_val': 0.034333561088134894, 'psi': 0.9915306354729857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=93 head_norm_before_train=2.031043 cos_to_last_merge=0.9035 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.903
[S17] round=93 local utility u=0.009107 metrics={'f1_val': 0.813638506828747, 'auprc': 0.9608730444499851, 'loss_val': 0.5380074905406502, 'psi': 0.8725323218772423}-{'f1_val': 0.8120264956041418, 'auprc': 0.954778955419351, 'loss_val': 0.5282675758594949, 'psi': 0.8691274795302255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=94 head_norm_before_train=2.137026 cos_to_last_merge=0.9507 (last merge round=21)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.7899218332193008, 'auprc': 0.7821709442747382, 'loss_val': 0.5812753713628629, 'psi': 0.7868214776414757}-{'f1_val': 0.8271463847630155, 'auprc': 0.8726123880649413, 'loss_val': 0.47619720747869365, 'psi': 0.8453327860837858}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.054105 cos_to_last_merge=0.9322 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.769869701101431, 'auprc': 0.9808493076455129, 'loss_val': 0.47114228950034276, 'psi': 0.8542615437190638}-{'f1_val': 0.996718896605481, 'auprc': 0.998713577532511, 'loss_val': 0.021309767760670433, 'psi': 0.9975167689762929}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=1.680393 cos_to_last_merge=0.9573 (last merge round=24)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9396846221613159, 'auprc': 0.952160212904039, 'loss_val': 0.31756845857331284, 'psi': 0.9446748584584052}-{'f1_val': 0.9406844855678808, 'auprc': 0.9679093773451125, 'loss_val': 0.3136773878104559, 'psi': 0.9515744422787734}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.841108 cos_to_last_merge=0.8654 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.865
[S5] round=94 local utility u=1.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9942003345132573, 'loss_val': 0.023156174706047403, 'psi': 0.9957013148923775}-{'f1_val': 0.7261764128930577, 'auprc': 0.989257373264933, 'loss_val': 0.401253659538635, 'psi': 0.8314087970418078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=94 head_norm_before_train=1.802341 cos_to_last_merge=0.8644 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.864
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.7788276253347767, 'auprc': 0.9601336662427744, 'loss_val': 0.4772167125764881, 'psi': 0.8513500416979758}-{'f1_val': 0.8823597231387926, 'auprc': 0.9805473128584994, 'loss_val': 0.2566847787119533, 'psi': 0.9216347590266754}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.434033 cos_to_last_merge=0.8758 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.876
[S7] round=94 local utility u=0.739770 metrics={'f1_val': 0.6793720791577516, 'auprc': 0.8227839119821396, 'loss_val': 0.4087852696736453, 'psi': 0.7367368122875068}-{'f1_val': 0.5470975733594234, 'auprc': 0.7830431905077949, 'loss_val': 0.975455651375795, 'psi': 0.641475820218772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=94 head_norm_before_train=2.273297 cos_to_last_merge=0.9912 (last merge round=26)
[S8] round=94 local utility u=0.084568 metrics={'f1_val': 0.9949425920495649, 'auprc': 0.9981394389370524, 'loss_val': 0.025787062129308296, 'psi': 0.9962213308045599}-{'f1_val': 0.9735566135715626, 'auprc': 0.9991960756380184, 'loss_val': 0.06977620723301553, 'psi': 0.983812398398145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=94 head_norm_before_train=2.100413 cos_to_last_merge=0.9709 (last merge round=25)
[S9] round=94 local utility u=0.021946 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9992012713193503, 'loss_val': 0.015767166627425562, 'psi': 0.9974431259659838}-{'f1_val': 0.9908221688527771, 'auprc': 0.999201372934805, 'loss_val': 0.026966959445515998, 'psi': 0.9941738504855883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=94 head_norm_before_train=2.132171 cos_to_last_merge=0.7503 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.750
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9976260820169679, 'loss_val': 0.03851014846093901, 'psi': 0.9948223788245822}-{'f1_val': 0.9929532433629917, 'auprc': 0.9976301385440512, 'loss_val': 0.03849851241322694, 'psi': 0.9948240014354155}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.228607 cos_to_last_merge=0.9601 (last merge round=26)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9963079617129205, 'auprc': 0.9973659370329948, 'loss_val': 0.02007901220464627, 'psi': 0.9967311518409502}-{'f1_val': 0.9967894001465077, 'auprc': 0.9976427015698351, 'loss_val': 0.01903863145558763, 'psi': 0.9971307207158387}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=1.829288 cos_to_last_merge=0.9116 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.912
[S13] round=94 local utility u=0.338665 metrics={'f1_val': 0.7351482746997597, 'auprc': 0.7728042416116145, 'loss_val': 0.8267186844194228, 'psi': 0.7502106614645017}-{'f1_val': 0.6890051409410713, 'auprc': 0.729985994247586, 'loss_val': 1.098736108719529, 'psi': 0.7053974822636773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=94 head_norm_before_train=2.128548 cos_to_last_merge=0.6861 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.686
[S14] round=94 local utility u=0.011686 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9969789330251245, 'loss_val': 0.017434168774159348, 'psi': 0.9974832839903809}-{'f1_val': 0.9948880898436442, 'auprc': 0.9986748369409733, 'loss_val': 0.028305560635086807, 'psi': 0.9964027886825757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=94 head_norm_before_train=2.190105 cos_to_last_merge=0.9484 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=94 local utility u=0.034594 metrics={'f1_val': 0.9285813320479938, 'auprc': 0.9979576140604082, 'loss_val': 0.09941769875724939, 'psi': 0.9563318448529595}-{'f1_val': 0.9208356231870446, 'auprc': 0.9979250212934333, 'loss_val': 0.12203307250529383, 'psi': 0.9516713824296001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] sending update (kind=head size=1789 to 1 peers)
[S16] START round=94 head_norm_before_train=1.894091 cos_to_last_merge=0.9208 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=94 local utility u=0.000717 metrics={'f1_val': 0.9937810775649601, 'auprc': 0.9889842306196659, 'loss_val': 0.03492420527011058, 'psi': 0.9918623387868424}-{'f1_val': 0.9933865550435556, 'auprc': 0.9891571134076356, 'loss_val': 0.034509902025887905, 'psi': 0.9916947783891876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=94 head_norm_before_train=2.037154 cos_to_last_merge=0.9027 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.903
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.6964560555387923, 'auprc': 0.93081424239815, 'loss_val': 0.9515866269028807, 'psi': 0.7901993302825354}-{'f1_val': 0.813638506828747, 'auprc': 0.9608730444499851, 'loss_val': 0.5380074905406502, 'psi': 0.8725323218772423}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.134771 cos_to_last_merge=0.9511 (last merge round=21)
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.771072043294432, 'auprc': 0.7606688436281626, 'loss_val': 0.6855718215141695, 'psi': 0.7669107634279242}-{'f1_val': 0.7899218332193008, 'auprc': 0.7821709442747382, 'loss_val': 0.5812753713628629, 'psi': 0.7868214776414757}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.058050 cos_to_last_merge=0.9318 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=95 local utility u=0.486688 metrics={'f1_val': 0.8909548824311598, 'auprc': 0.994150531131097, 'loss_val': 0.2641814265532425, 'psi': 0.9322331419111347}-{'f1_val': 0.769869701101431, 'auprc': 0.9808493076455129, 'loss_val': 0.47114228950034276, 'psi': 0.8542615437190638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=95 head_norm_before_train=1.681800 cos_to_last_merge=0.9571 (last merge round=24)
[S4] round=95 local utility u=0.036690 metrics={'f1_val': 0.941306646825604, 'auprc': 0.972896868283434, 'loss_val': 0.3161308444129564, 'psi': 0.9539427354087361}-{'f1_val': 0.9396846221613159, 'auprc': 0.952160212904039, 'loss_val': 0.31756845857331284, 'psi': 0.9446748584584052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=95 head_norm_before_train=1.841384 cos_to_last_merge=0.8650 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.865
[S5] round=95 local utility u=0.008427 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.999652139946984, 'loss_val': 0.022658116990564196, 'psi': 0.9978820370658682}-{'f1_val': 0.9967019684784577, 'auprc': 0.9942003345132573, 'loss_val': 0.023156174706047403, 'psi': 0.9957013148923775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=95 head_norm_before_train=1.805027 cos_to_last_merge=0.8640 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.864
[S6] round=95 local utility u=0.086590 metrics={'f1_val': 0.7921171260470693, 'auprc': 0.9748136671966131, 'loss_val': 0.42781370335974134, 'psi': 0.8651957425068868}-{'f1_val': 0.7788276253347767, 'auprc': 0.9601336662427744, 'loss_val': 0.4772167125764881, 'psi': 0.8513500416979758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=95 head_norm_before_train=1.435960 cos_to_last_merge=0.8755 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.876
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.674968471038231, 'auprc': 0.8161357715755313, 'loss_val': 0.4075657004907831, 'psi': 0.731435391253151}-{'f1_val': 0.6793720791577516, 'auprc': 0.8227839119821396, 'loss_val': 0.4087852696736453, 'psi': 0.7367368122875068}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=2.275503 cos_to_last_merge=0.9912 (last merge round=26)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.993467150337892, 'auprc': 0.9995229540280524, 'loss_val': 0.029106642984914936, 'psi': 0.9958894718139562}-{'f1_val': 0.9949425920495649, 'auprc': 0.9981394389370524, 'loss_val': 0.025787062129308296, 'psi': 0.9962213308045599}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=2.104902 cos_to_last_merge=0.9706 (last merge round=25)
[S9] round=95 local utility u=0.000325 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978395389570128, 'loss_val': 0.016023998926619484, 'psi': 0.9973975630900909}-{'f1_val': 0.9962710290637395, 'auprc': 0.9992012713193503, 'loss_val': 0.015767166627425562, 'psi': 0.9974431259659838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=95 head_norm_before_train=2.134147 cos_to_last_merge=0.7500 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.750
[S10] round=95 local utility u=0.000317 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9975245948634958, 'loss_val': 0.03757222322792791, 'psi': 0.9947817839631934}-{'f1_val': 0.9929532433629917, 'auprc': 0.9976260820169679, 'loss_val': 0.03851014846093901, 'psi': 0.9948223788245822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=95 head_norm_before_train=2.229874 cos_to_last_merge=0.9600 (last merge round=26)
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9955867204872706, 'auprc': 0.9972048971702316, 'loss_val': 0.022570925250496428, 'psi': 0.996233991160455}-{'f1_val': 0.9963079617129205, 'auprc': 0.9973659370329948, 'loss_val': 0.02007901220464627, 'psi': 0.9967311518409502}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.830907 cos_to_last_merge=0.9115 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.911
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6918519735543291, 'auprc': 0.6868514602676669, 'loss_val': 1.2465423630494992, 'psi': 0.6898517682396642}-{'f1_val': 0.7351482746997597, 'auprc': 0.7728042416116145, 'loss_val': 0.8267186844194228, 'psi': 0.7502106614645017}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.133634 cos_to_last_merge=0.6855 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.686
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.996977571634724, 'loss_val': 0.026730188940196933, 'psi': 0.9969856548673589}-{'f1_val': 0.9978195179672185, 'auprc': 0.9969789330251245, 'loss_val': 0.017434168774159348, 'psi': 0.9974832839903809}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.194184 cos_to_last_merge=0.9481 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=95 local utility u=0.073938 metrics={'f1_val': 0.9495692536736018, 'auprc': 0.9980045515446683, 'loss_val': 0.07761101504047592, 'psi': 0.9689433728220284}-{'f1_val': 0.9285813320479938, 'auprc': 0.9979576140604082, 'loss_val': 0.09941769875724939, 'psi': 0.9563318448529595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=95 head_norm_before_train=1.898097 cos_to_last_merge=0.9205 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.9935617159047636, 'auprc': 0.9895397322424466, 'loss_val': 0.03549136876719577, 'psi': 0.9919529224398369}-{'f1_val': 0.9937810775649601, 'auprc': 0.9889842306196659, 'loss_val': 0.03492420527011058, 'psi': 0.9918623387868424}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.043444 cos_to_last_merge=0.9019 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.902
[S17] round=95 local utility u=0.547199 metrics={'f1_val': 0.801068971733954, 'auprc': 0.9687110885958539, 'loss_val': 0.5985560941088158, 'psi': 0.868125818478714}-{'f1_val': 0.6964560555387923, 'auprc': 0.93081424239815, 'loss_val': 0.9515866269028807, 'psi': 0.7901993302825354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=96 head_norm_before_train=2.136762 cos_to_last_merge=0.9510 (last merge round=21)
[S2] round=96 local utility u=0.365674 metrics={'f1_val': 0.8228820696973287, 'auprc': 0.8311457559744442, 'loss_val': 0.47651427363291365, 'psi': 0.8261875442081749}-{'f1_val': 0.771072043294432, 'auprc': 0.7606688436281626, 'loss_val': 0.6855718215141695, 'psi': 0.7669107634279242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=96 head_norm_before_train=2.060882 cos_to_last_merge=0.9318 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.713325281931591, 'auprc': 0.9767504630425466, 'loss_val': 0.6360315634237684, 'psi': 0.8186953543759732}-{'f1_val': 0.8909548824311598, 'auprc': 0.994150531131097, 'loss_val': 0.2641814265532425, 'psi': 0.9322331419111347}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=1.684890 cos_to_last_merge=0.9571 (last merge round=24)
[S4] round=96 local utility u=0.018879 metrics={'f1_val': 0.9459323395224908, 'auprc': 0.9752469846432404, 'loss_val': 0.3131771249543593, 'psi': 0.9576581975707906}-{'f1_val': 0.941306646825604, 'auprc': 0.972896868283434, 'loss_val': 0.3161308444129564, 'psi': 0.9539427354087361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=96 head_norm_before_train=1.842061 cos_to_last_merge=0.8646 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.865
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9942051591173661, 'loss_val': 0.024238998180711537, 'psi': 0.9954823508250805}-{'f1_val': 0.9967019684784577, 'auprc': 0.999652139946984, 'loss_val': 0.022658116990564196, 'psi': 0.9978820370658682}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=1.809351 cos_to_last_merge=0.8634 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.863
[S6] round=96 local utility u=0.384290 metrics={'f1_val': 0.8854655320305823, 'auprc': 0.9885313919820083, 'loss_val': 0.26047729335835446, 'psi': 0.9266918760111527}-{'f1_val': 0.7921171260470693, 'auprc': 0.9748136671966131, 'loss_val': 0.42781370335974134, 'psi': 0.8651957425068868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=96 head_norm_before_train=1.438056 cos_to_last_merge=0.8753 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.875
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.5610978739398002, 'auprc': 0.7811034738292295, 'loss_val': 0.8746383087879359, 'psi': 0.6491001138955719}-{'f1_val': 0.674968471038231, 'auprc': 0.8161357715755313, 'loss_val': 0.4075657004907831, 'psi': 0.731435391253151}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.278945 cos_to_last_merge=0.9910 (last merge round=26)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.9995018949055606, 'loss_val': 0.035902157373827404, 'psi': 0.9956675594352913}-{'f1_val': 0.993467150337892, 'auprc': 0.9995229540280524, 'loss_val': 0.029106642984914936, 'psi': 0.9958894718139562}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.106843 cos_to_last_merge=0.9705 (last merge round=25)
[S9] round=96 local utility u=0.000828 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9991829411648994, 'loss_val': 0.015895292154390714, 'psi': 0.9976846489890849}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978395389570128, 'loss_val': 0.016023998926619484, 'psi': 0.9973975630900909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=96 head_norm_before_train=2.137716 cos_to_last_merge=0.7497 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.750
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9971850353932079, 'loss_val': 0.03792256854261235, 'psi': 0.9946459601750782}-{'f1_val': 0.9929532433629917, 'auprc': 0.9975245948634958, 'loss_val': 0.03757222322792791, 'psi': 0.9947817839631934}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.233017 cos_to_last_merge=0.9599 (last merge round=26)
[S11] round=96 local utility u=0.002513 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9962281151571851, 'loss_val': 0.020376092923339598, 'psi': 0.9964194487710278}-{'f1_val': 0.9955867204872706, 'auprc': 0.9972048971702316, 'loss_val': 0.022570925250496428, 'psi': 0.996233991160455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=96 head_norm_before_train=1.833990 cos_to_last_merge=0.9110 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.911
[S13] round=96 local utility u=0.264155 metrics={'f1_val': 0.7401792205287363, 'auprc': 0.7199400668464838, 'loss_val': 1.1074615061769104, 'psi': 0.7320835590558352}-{'f1_val': 0.6918519735543291, 'auprc': 0.6868514602676669, 'loss_val': 1.2465423630494992, 'psi': 0.6898517682396642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=96 head_norm_before_train=2.138298 cos_to_last_merge=0.6851 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.685
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9858457201457009, 'auprc': 0.9986767498758549, 'loss_val': 0.03482493131006157, 'psi': 0.9909781320377624}-{'f1_val': 0.9969910436891155, 'auprc': 0.996977571634724, 'loss_val': 0.026730188940196933, 'psi': 0.9969856548673589}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.198172 cos_to_last_merge=0.9479 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=96 local utility u=0.050390 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9980541269372761, 'loss_val': 0.05883748356281526, 'psi': 0.9771488941473631}-{'f1_val': 0.9495692536736018, 'auprc': 0.9980045515446683, 'loss_val': 0.07761101504047592, 'psi': 0.9689433728220284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=96 head_norm_before_train=1.902646 cos_to_last_merge=0.9201 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9378618614622034, 'auprc': 0.9869136025071574, 'loss_val': 0.38874714548883066, 'psi': 0.9574825578801851}-{'f1_val': 0.9935617159047636, 'auprc': 0.9895397322424466, 'loss_val': 0.03549136876719577, 'psi': 0.9919529224398369}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.047531 cos_to_last_merge=0.9016 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.902
[S17] round=96 local utility u=0.295953 metrics={'f1_val': 0.8686415907966086, 'auprc': 0.9779539471378665, 'loss_val': 0.43981512990586363, 'psi': 0.9123665333331119}-{'f1_val': 0.801068971733954, 'auprc': 0.9687110885958539, 'loss_val': 0.5985560941088158, 'psi': 0.868125818478714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=97 head_norm_before_train=2.138056 cos_to_last_merge=0.9510 (last merge round=21)
[S2] round=97 local utility u=0.063775 metrics={'f1_val': 0.8253810000735562, 'auprc': 0.8641867562792336, 'loss_val': 0.4630805146397227, 'psi': 0.8409033025558272}-{'f1_val': 0.8228820696973287, 'auprc': 0.8311457559744442, 'loss_val': 0.47651427363291365, 'psi': 0.8261875442081749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=97 head_norm_before_train=2.065286 cos_to_last_merge=0.9315 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=97 local utility u=0.062868 metrics={'f1_val': 0.7182901863582283, 'auprc': 0.9917954944726907, 'loss_val': 0.5852203236380028, 'psi': 0.8276923096040132}-{'f1_val': 0.713325281931591, 'auprc': 0.9767504630425466, 'loss_val': 0.6360315634237684, 'psi': 0.8186953543759732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=97 head_norm_before_train=1.689603 cos_to_last_merge=0.9571 (last merge round=24)
[S4] round=97 local utility u=0.016678 metrics={'f1_val': 0.9531542027225245, 'auprc': 0.9727196912527412, 'loss_val': 0.31557079615363315, 'psi': 0.9609803981346112}-{'f1_val': 0.9459323395224908, 'auprc': 0.9752469846432404, 'loss_val': 0.3131771249543593, 'psi': 0.9576581975707906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=97 head_norm_before_train=1.844294 cos_to_last_merge=0.8644 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.864
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9937881604237808, 'loss_val': 0.024421752700494893, 'psi': 0.9953155513476464}-{'f1_val': 0.9963338119635569, 'auprc': 0.9942051591173661, 'loss_val': 0.024238998180711537, 'psi': 0.9954823508250805}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=1.814786 cos_to_last_merge=0.8629 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.863
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.6477259270724507, 'auprc': 0.9674662451947917, 'loss_val': 0.7624832805231485, 'psi': 0.7756220543213872}-{'f1_val': 0.8854655320305823, 'auprc': 0.9885313919820083, 'loss_val': 0.26047729335835446, 'psi': 0.9266918760111527}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=1.439919 cos_to_last_merge=0.8752 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.875
[S7] round=97 local utility u=0.627977 metrics={'f1_val': 0.663948121502188, 'auprc': 0.8267674743345417, 'loss_val': 0.3727772264759016, 'psi': 0.7290758626351295}-{'f1_val': 0.5610978739398002, 'auprc': 0.7811034738292295, 'loss_val': 0.8746383087879359, 'psi': 0.6491001138955719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=97 head_norm_before_train=2.281504 cos_to_last_merge=0.9908 (last merge round=26)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9912976772143413, 'auprc': 0.9993127909644072, 'loss_val': 0.03628063607904724, 'psi': 0.9945037227143676}-{'f1_val': 0.9931113357884451, 'auprc': 0.9995018949055606, 'loss_val': 0.035902157373827404, 'psi': 0.9956675594352913}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=2.109814 cos_to_last_merge=0.9704 (last merge round=25)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9991818752406547, 'loss_val': 0.019323182554707757, 'psi': 0.9964369398658833}-{'f1_val': 0.9966857875385419, 'auprc': 0.9991829411648994, 'loss_val': 0.015895292154390714, 'psi': 0.9976846489890849}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.137861 cos_to_last_merge=0.7493 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.749
[S10] round=97 local utility u=0.000000 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9972284859378084, 'loss_val': 0.0384963377818755, 'psi': 0.9946633403929184}-{'f1_val': 0.9929532433629917, 'auprc': 0.9971850353932079, 'loss_val': 0.03792256854261235, 'psi': 0.9946459601750782}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=97 head_norm_before_train=2.234488 cos_to_last_merge=0.9598 (last merge round=26)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.9945991435698681, 'loss_val': 0.019663431957529485, 'psi': 0.9958098419876606}-{'f1_val': 0.9965470045135896, 'auprc': 0.9962281151571851, 'loss_val': 0.020376092923339598, 'psi': 0.9964194487710278}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=1.838875 cos_to_last_merge=0.9104 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=97 local utility u=0.332911 metrics={'f1_val': 0.7471712501712011, 'auprc': 0.8042140888858551, 'loss_val': 0.7364143158168373, 'psi': 0.7699883856570626}-{'f1_val': 0.7401792205287363, 'auprc': 0.7199400668464838, 'loss_val': 1.1074615061769104, 'psi': 0.7320835590558352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=97 head_norm_before_train=2.143272 cos_to_last_merge=0.6848 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.685
[S14] round=97 local utility u=0.043960 metrics={'f1_val': 0.9973804726257689, 'auprc': 0.9987019543646865, 'loss_val': 0.016188269582746603, 'psi': 0.9979090653213358}-{'f1_val': 0.9858457201457009, 'auprc': 0.9986767498758549, 'loss_val': 0.03482493131006157, 'psi': 0.9909781320377624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=97 head_norm_before_train=2.202149 cos_to_last_merge=0.9477 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=97 local utility u=0.055508 metrics={'f1_val': 0.9784556569123816, 'auprc': 0.9981532795956052, 'loss_val': 0.039579618450685174, 'psi': 0.986334705985671}-{'f1_val': 0.9632120722874211, 'auprc': 0.9980541269372761, 'loss_val': 0.05883748356281526, 'psi': 0.9771488941473631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=97 head_norm_before_train=1.907517 cos_to_last_merge=0.9196 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.8705729390361261, 'auprc': 0.8925565111968623, 'loss_val': 0.8799895133412555, 'psi': 0.8793663679004207}-{'f1_val': 0.9378618614622034, 'auprc': 0.9869136025071574, 'loss_val': 0.38874714548883066, 'psi': 0.9574825578801851}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.051561 cos_to_last_merge=0.9013 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.7233600324312937, 'auprc': 0.9391054495558613, 'loss_val': 0.8807238046690561, 'psi': 0.8096581992811207}-{'f1_val': 0.8686415907966086, 'auprc': 0.9779539471378665, 'loss_val': 0.43981512990586363, 'psi': 0.9123665333331119}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=98 head_norm_before_train=2.141116 cos_to_last_merge=0.9508 (last merge round=21)
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.6383591345268277, 'auprc': 0.7106831970619824, 'loss_val': 1.8420479304399848, 'psi': 0.6672887595408896}-{'f1_val': 0.8253810000735562, 'auprc': 0.8641867562792336, 'loss_val': 0.4630805146397227, 'psi': 0.8409033025558272}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.070607 cos_to_last_merge=0.9311 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=98 local utility u=0.611419 metrics={'f1_val': 0.8681363029855753, 'auprc': 0.9979823960786167, 'loss_val': 0.28001909934530167, 'psi': 0.9200747402227918}-{'f1_val': 0.7182901863582283, 'auprc': 0.9917954944726907, 'loss_val': 0.5852203236380028, 'psi': 0.8276923096040132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] START round=98 head_norm_before_train=1.695228 cos_to_last_merge=0.9570 (last merge round=24)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9411602085995671, 'auprc': 0.9609459330616124, 'loss_val': 0.32223105717618533, 'psi': 0.9490744983843852}-{'f1_val': 0.9531542027225245, 'auprc': 0.9727196912527412, 'loss_val': 0.31557079615363315, 'psi': 0.9609803981346112}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=1.850036 cos_to_last_merge=0.8639 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.864
[S5] round=98 local utility u=0.011356 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9997744125689533, 'loss_val': 0.021876630296775317, 'psi': 0.9979309461146559}-{'f1_val': 0.9963338119635569, 'auprc': 0.9937881604237808, 'loss_val': 0.024421752700494893, 'psi': 0.9953155513476464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=98 head_norm_before_train=1.820440 cos_to_last_merge=0.8624 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=98 local utility u=0.369092 metrics={'f1_val': 0.7212571928270922, 'auprc': 0.9620838263023923, 'loss_val': 0.4493387100771693, 'psi': 0.8175878462172123}-{'f1_val': 0.6477259270724507, 'auprc': 0.9674662451947917, 'loss_val': 0.7624832805231485, 'psi': 0.7756220543213872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=98 head_norm_before_train=1.442344 cos_to_last_merge=0.8750 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.875
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.5971518189238094, 'auprc': 0.792755701696544, 'loss_val': 0.7428310725356646, 'psi': 0.6753933720329033}-{'f1_val': 0.663948121502188, 'auprc': 0.8267674743345417, 'loss_val': 0.3727772264759016, 'psi': 0.7290758626351295}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.286126 cos_to_last_merge=0.9906 (last merge round=26)
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9863996358172417, 'auprc': 0.9974398252945167, 'loss_val': 0.04663667359244709, 'psi': 0.9908157116081517}-{'f1_val': 0.9912976772143413, 'auprc': 0.9993127909644072, 'loss_val': 0.03628063607904724, 'psi': 0.9945037227143676}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=2.113556 cos_to_last_merge=0.9701 (last merge round=25)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9927341914448654, 'loss_val': 0.017478506928594213, 'psi': 0.9951091713368034}-{'f1_val': 0.9946069829493691, 'auprc': 0.9991818752406547, 'loss_val': 0.019323182554707757, 'psi': 0.9964369398658833}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.139980 cos_to_last_merge=0.7489 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.749
[S10] round=98 local utility u=0.000170 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9972151036768133, 'loss_val': 0.03811587088978415, 'psi': 0.9946579874885204}-{'f1_val': 0.9929532433629917, 'auprc': 0.9972284859378084, 'loss_val': 0.0384963377818755, 'psi': 0.9946633403929184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=98 head_norm_before_train=2.237989 cos_to_last_merge=0.9595 (last merge round=26)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.9943795548318735, 'loss_val': 0.02051551852770916, 'psi': 0.9957220064924628}-{'f1_val': 0.9966169742661891, 'auprc': 0.9945991435698681, 'loss_val': 0.019663431957529485, 'psi': 0.9958098419876606}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=1.841450 cos_to_last_merge=0.9101 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.7384195733427381, 'auprc': 0.7725285623644536, 'loss_val': 1.0670264805411618, 'psi': 0.7520631689514243}-{'f1_val': 0.7471712501712011, 'auprc': 0.8042140888858551, 'loss_val': 0.7364143158168373, 'psi': 0.7699883856570626}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=2.146824 cos_to_last_merge=0.6844 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.684
[S14] round=98 local utility u=0.001383 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9986754823000613, 'loss_val': 0.014851448243308344, 'psi': 0.9980493768939502}-{'f1_val': 0.9973804726257689, 'auprc': 0.9987019543646865, 'loss_val': 0.016188269582746603, 'psi': 0.9979090653213358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=98 head_norm_before_train=2.206088 cos_to_last_merge=0.9474 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=98 local utility u=0.026211 metrics={'f1_val': 0.9862359745487574, 'auprc': 0.9978121936698157, 'loss_val': 0.03281591232371219, 'psi': 0.9908664621971808}-{'f1_val': 0.9784556569123816, 'auprc': 0.9981532795956052, 'loss_val': 0.039579618450685174, 'psi': 0.986334705985671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=98 head_norm_before_train=1.910826 cos_to_last_merge=0.9195 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.8659901413030301, 'auprc': 0.8910034247220537, 'loss_val': 0.9180387224614227, 'psi': 0.8759954546706396}-{'f1_val': 0.8705729390361261, 'auprc': 0.8925565111968623, 'loss_val': 0.8799895133412555, 'psi': 0.8793663679004207}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.055838 cos_to_last_merge=0.9008 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=98 local utility u=0.231384 metrics={'f1_val': 0.7730173932110487, 'auprc': 0.9438031299343795, 'loss_val': 0.7299922269773765, 'psi': 0.841331687900381}-{'f1_val': 0.7233600324312937, 'auprc': 0.9391054495558613, 'loss_val': 0.8807238046690561, 'psi': 0.8096581992811207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=99 head_norm_before_train=2.145403 cos_to_last_merge=0.9503 (last merge round=21)
[S2] round=99 local utility u=1.000000 metrics={'f1_val': 0.8258564072619063, 'auprc': 0.8942770687908461, 'loss_val': 0.4670223874912686, 'psi': 0.8532246718734823}-{'f1_val': 0.6383591345268277, 'auprc': 0.7106831970619824, 'loss_val': 1.8420479304399848, 'psi': 0.6672887595408896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S2] r=100 psi=0.853 u=1.0000 p_local=0.2763 f1=0.826 auprc=0.894 bytes=97204
[S3] START round=99 head_norm_before_train=2.075947 cos_to_last_merge=0.9307 (last merge round=25)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=99 local utility u=0.258540 metrics={'f1_val': 0.9396996737046746, 'auprc': 0.9971228154452896, 'loss_val': 0.18973970817537666, 'psi': 0.9626689304009206}-{'f1_val': 0.8681363029855753, 'auprc': 0.9979823960786167, 'loss_val': 0.28001909934530167, 'psi': 0.9200747402227918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] r=100 psi=0.963 u=0.2585 p_local=0.2258 f1=0.940 auprc=0.997 bytes=106088
[S4] START round=99 head_norm_before_train=1.697802 cos_to_last_merge=0.9565 (last merge round=24)
[S4] round=99 local utility u=0.005177 metrics={'f1_val': 0.9410274075074468, 'auprc': 0.9641447055134235, 'loss_val': 0.3206758043455574, 'psi': 0.9502743267098375}-{'f1_val': 0.9411602085995671, 'auprc': 0.9609459330616124, 'loss_val': 0.32223105717618533, 'psi': 0.9490744983843852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S4] r=100 psi=0.950 u=0.0052 p_local=0.0327 f1=0.941 auprc=0.964 bytes=95291
[S5] START round=99 head_norm_before_train=1.855993 cos_to_last_merge=0.8634 (last merge round=24)
[S5] ⚠️ Model drifted since last merge! cos=0.863
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.998466433304867, 'loss_val': 0.02260636788836063, 'psi': 0.9971868605000809}-{'f1_val': 0.9967019684784577, 'auprc': 0.9997744125689533, 'loss_val': 0.021876630296775317, 'psi': 0.9979309461146559}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.997 u=0.0000 p_local=0.0694 f1=0.996 auprc=0.998 bytes=106178
[S6] START round=99 head_norm_before_train=1.825508 cos_to_last_merge=0.8619 (last merge round=21)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=99 local utility u=0.272003 metrics={'f1_val': 0.8121305800578724, 'auprc': 0.9473695425800849, 'loss_val': 0.4064305037293301, 'psi': 0.8662261650667573}-{'f1_val': 0.7212571928270922, 'auprc': 0.9620838263023923, 'loss_val': 0.4493387100771693, 'psi': 0.8175878462172123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S6] r=100 psi=0.866 u=0.2720 p_local=0.2526 f1=0.812 auprc=0.947 bytes=98805
[S7] START round=99 head_norm_before_train=1.447083 cos_to_last_merge=0.8745 (last merge round=21)
[S7] ⚠️ Model drifted since last merge! cos=0.875
[S7] round=99 local utility u=0.329133 metrics={'f1_val': 0.6608572563584374, 'auprc': 0.8071054886572586, 'loss_val': 0.5098475420205644, 'psi': 0.7193565492779659}-{'f1_val': 0.5971518189238094, 'auprc': 0.792755701696544, 'loss_val': 0.7428310725356646, 'psi': 0.6753933720329033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=100 psi=0.719 u=0.3291 p_local=0.2640 f1=0.661 auprc=0.807 bytes=90129
[S8] START round=99 head_norm_before_train=2.289900 cos_to_last_merge=0.9905 (last merge round=26)
[S8] round=99 local utility u=0.010135 metrics={'f1_val': 0.9881789382045629, 'auprc': 0.9990081912096004, 'loss_val': 0.04174785633124367, 'psi': 0.9925106394065779}-{'f1_val': 0.9863996358172417, 'auprc': 0.9974398252945167, 'loss_val': 0.04663667359244709, 'psi': 0.9908157116081517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] r=100 psi=0.993 u=0.0101 p_local=0.0092 f1=0.988 auprc=0.999 bytes=102482
[S9] START round=99 head_norm_before_train=2.117777 cos_to_last_merge=0.9698 (last merge round=25)
[S9] round=99 local utility u=0.010215 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.998535583398641, 'loss_val': 0.01541274282833681, 'psi': 0.9975257846148107}-{'f1_val': 0.9966924912647621, 'auprc': 0.9927341914448654, 'loss_val': 0.017478506928594213, 'psi': 0.9951091713368034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S9] r=100 psi=0.998 u=0.0102 p_local=0.0040 f1=0.997 auprc=0.999 bytes=106235
[S10] START round=99 head_norm_before_train=2.143796 cos_to_last_merge=0.7486 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.749
[S10] round=99 local utility u=0.000560 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9973678654781234, 'loss_val': 0.03745337264919841, 'psi': 0.9947190922090444}-{'f1_val': 0.9929532433629917, 'auprc': 0.9972151036768133, 'loss_val': 0.03811587088978415, 'psi': 0.9946579874885204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=100 psi=0.995 u=0.0006 p_local=0.0003 f1=0.993 auprc=0.997 bytes=106119
[S11] START round=99 head_norm_before_train=2.243084 cos_to_last_merge=0.9592 (last merge round=26)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.994428767888302, 'loss_val': 0.02063143529164297, 'psi': 0.9954517121033064}-{'f1_val': 0.9966169742661891, 'auprc': 0.9943795548318735, 'loss_val': 0.02051551852770916, 'psi': 0.9957220064924628}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.995 u=0.0000 p_local=0.0285 f1=0.996 auprc=0.994 bytes=109863
[S13] START round=99 head_norm_before_train=1.843244 cos_to_last_merge=0.9097 (last merge round=21)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6134580540163165, 'auprc': 0.7817237544794888, 'loss_val': 1.2436050965266412, 'psi': 0.6807643342015854}-{'f1_val': 0.7384195733427381, 'auprc': 0.7725285623644536, 'loss_val': 1.0670264805411618, 'psi': 0.7520631689514243}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.681 u=0.0000 p_local=0.1386 f1=0.613 auprc=0.782 bytes=100800
[S14] START round=99 head_norm_before_train=2.150073 cos_to_last_merge=0.6840 (last merge round=1)
[S14] ⚠️ Model drifted since last merge! cos=0.684
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9986746596938294, 'loss_val': 0.016605219183127733, 'psi': 0.9980490478514575}-{'f1_val': 0.9976319732898762, 'auprc': 0.9986754823000613, 'loss_val': 0.014851448243308344, 'psi': 0.9980493768939502}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.998 u=0.0000 p_local=0.0109 f1=0.998 auprc=0.999 bytes=100789
[S15] START round=99 head_norm_before_train=2.209998 cos_to_last_merge=0.9472 (last merge round=22)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.9862359745487574, 'auprc': 0.9976981117675332, 'loss_val': 0.0331981175802254, 'psi': 0.9908208294362677}-{'f1_val': 0.9862359745487574, 'auprc': 0.9978121936698157, 'loss_val': 0.03281591232371219, 'psi': 0.9908664621971808}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.991 u=0.0000 p_local=0.0280 f1=0.986 auprc=0.998 bytes=109581
[S16] START round=99 head_norm_before_train=1.913100 cos_to_last_merge=0.9193 (last merge round=21)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=99 local utility u=0.957958 metrics={'f1_val': 0.9915464207573165, 'auprc': 0.9885068220358458, 'loss_val': 0.04797039721938756, 'psi': 0.9903305812687282}-{'f1_val': 0.8659901413030301, 'auprc': 0.8910034247220537, 'loss_val': 0.9180387224614227, 'psi': 0.8759954546706396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] r=100 psi=0.990 u=0.9580 p_local=0.1931 f1=0.992 auprc=0.989 bytes=104269
[S17] START round=99 head_norm_before_train=2.061105 cos_to_last_merge=0.9003 (last merge round=26)
[S17] ⚠️ Model drifted since last merge! cos=0.900
[S17] round=99 local utility u=0.383194 metrics={'f1_val': 0.8524031076332229, 'auprc': 0.9581407145006443, 'loss_val': 0.48293057051119753, 'psi': 0.8946981503801914}-{'f1_val': 0.7730173932110487, 'auprc': 0.9438031299343795, 'loss_val': 0.7299922269773765, 'psi': 0.841331687900381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S17] r=100 psi=0.895 u=0.3832 p_local=0.2510 f1=0.852 auprc=0.958 bytes=97054
[runner] rounds complete.
[runner] all agents stopped.
