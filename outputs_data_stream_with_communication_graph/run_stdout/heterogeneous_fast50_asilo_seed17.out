[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:38403
[S3] → join 127.0.0.1:38402
[S4] → join 127.0.0.1:38402
[S5] → join 127.0.0.1:38402
[S6] → join 127.0.0.1:38402
[S7] → join 127.0.0.1:38402
[S8] → join 127.0.0.1:38402
[S9] → join 127.0.0.1:38402
[S10] → join 127.0.0.1:38402
[S11] → join 127.0.0.1:38402
[S13] → join 127.0.0.1:38402
[S14] → join 127.0.0.1:38402
[S15] → join 127.0.0.1:38402
[S16] → join 127.0.0.1:38402
[S17] → join 127.0.0.1:38402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.125648 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.173471 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.146894 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.185224 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.166678 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.205551 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.142632 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.127227 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.170361 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.190554 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.117798 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.212333 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.183620 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.161134 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.138077 (no previous merge yet)
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3] + discovered S9
[S3] + discovered S8
[S3] + discovered S17
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S7
[S3] + discovered S5
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S11
[S3] + discovered S15
[S3] + discovered S10
[S5] + discovered S4
[S4] + discovered S7
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S5
[S4] + discovered S6
[S4] + discovered S14
[S4] + discovered S13
[S4] + discovered S16
[S4] + discovered S11
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S9
[S4] + discovered S8
[S4] + discovered S17
[S6] + discovered S2
[S5] + discovered S6
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S15
[S6] + discovered S3
[S5] + discovered S13
[S6] + discovered S5
[S5] + discovered S7
[S5] + discovered S14
[S6] + discovered S4
[S5] + discovered S17
[S5] + discovered S10
[S5] + discovered S11
[S5] + discovered S16
[S6] + discovered S17
[S7] + discovered S5
[S7] + discovered S3
[S6] + discovered S10
[S7] + discovered S4
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S16
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S14
[S7] + discovered S2
[S6] + discovered S7
[S7] + discovered S17
[S8] + discovered S5
[S7] + discovered S11
[S8] + discovered S3
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S2
[S7] + discovered S14
[S8] + discovered S4
[S7] + discovered S10
[S7] + discovered S15
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S9
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S8
[S9] + discovered S6
[S9] + discovered S7
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S16
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S15
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S11
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S8
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S16
[S11] + discovered S3
[S11] + discovered S2
[S11] + discovered S5
[S11] + discovered S4
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S6
[S11] + discovered S7
[S10] + discovered S13
[S11] + discovered S9
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S15
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S10
[S13] + discovered S8
[S13] + discovered S6
[S13] + discovered S2
[S11] + discovered S13
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S9
[S14] + discovered S11
[S14] + discovered S13
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S7
[S13] + discovered S14
[S14] + discovered S10
[S14] + discovered S3
[S14] + discovered S5
[S13] + discovered S17
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S15] + discovered S7
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S8
[S15] + discovered S5
[S15] + discovered S3
[S15] + discovered S11
[S15] + discovered S4
[S15] + discovered S13
[S16] + discovered S10
[S15] + discovered S17
[S16] + discovered S7
[S16] + discovered S4
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S9
[S15] + discovered S16
[S16] + discovered S13
[S16] + discovered S11
[S16] + discovered S14
[S16] + discovered S2
[S16] + discovered S6
[S17] + discovered S4
[S16] + discovered S17
[S17] + discovered S9
[S17] + discovered S15
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S5
[S17] + discovered S2
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S10
[S17] + discovered S3
[S17] + discovered S6
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:38403
[S8] ⇄ pheromone p=1.000 → S16@127.0.0.1:38416
[S15] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S14] ⇄ pheromone p=1.000 → S13@127.0.0.1:38413
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S11] ⇄ pheromone p=1.000 → S10@127.0.0.1:38411
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:38403
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:38416
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:38405
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:38409
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:38404
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:38409
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:38407
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:38414
[S2] START round=1 head_norm_before_train=1.135807 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.760636057220203, 'loss_val': 1.2685218011254287, 'psi': 0.3893207029212213}-{'f1_val': 0.3971995211779742, 'auprc': 0.7612761576788557, 'loss_val': 1.333406070443292, 'psi': 0.5428301757783268}
[S3] START round=1 head_norm_before_train=1.177196 (no previous merge yet)
[S3] round=1 local utility u=0.059657 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8904706883508997, 'loss_val': 1.3146810394378043, 'psi': 0.44009231470882415}-{'f1_val': 0.13984006561410703, 'auprc': 0.8608117684620669, 'loss_val': 1.3450177218603594, 'psi': 0.42822874675329103}
[S4] START round=1 head_norm_before_train=1.157771 (no previous merge yet)
[S4] round=1 local utility u=0.222759 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7793265475101938, 'loss_val': 1.2668915730404244, 'psi': 0.39586659634118804}-{'f1_val': 0.14022662889518414, 'auprc': 0.6506752789668561, 'loss_val': 1.3264549798141656, 'psi': 0.34440608892385294}
[S5] START round=1 head_norm_before_train=1.183755 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5274404473763041, 'loss_val': 1.3521355253338472, 'psi': 0.29633332180766453}-{'f1_val': 0.31691025927300404, 'auprc': 0.4165689283448594, 'loss_val': 1.3921661980014732, 'psi': 0.3567737269017462}
[S6] START round=1 head_norm_before_train=1.170042 (no previous merge yet)
[S6] round=1 local utility u=0.079155 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8005429669092489, 'loss_val': 1.2617085269530643, 'psi': 0.4050729559944688}-{'f1_val': 0.14142628205128205, 'auprc': 0.7728814915426307, 'loss_val': 1.3370339338909332, 'psi': 0.3940083658478215}
[S7] START round=1 head_norm_before_train=1.204297 (no previous merge yet)
[S7] round=1 local utility u=0.456568 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7751205324761528, 'loss_val': 1.3222416556518664, 'psi': 0.39528230662791614}-{'f1_val': 0.10429108604291086, 'auprc': 0.5558846401693596, 'loss_val': 1.3510761276832337, 'psi': 0.2849285076934903}
[S8] START round=1 head_norm_before_train=1.152207 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7658550519077267, 'loss_val': 1.2779808499594554, 'psi': 0.390315610198865}-{'f1_val': 0.39935103986579623, 'auprc': 0.7657062722164476, 'loss_val': 1.3487451083765096, 'psi': 0.5458931328060568}
[S9] START round=1 head_norm_before_train=1.127754 (no previous merge yet)
[S9] round=1 local utility u=0.400439 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6605095673010809, 'loss_val': 1.3075177196205574, 'psi': 0.34904260120443}-{'f1_val': 0.141397957139996, 'auprc': 0.40478272157124967, 'loss_val': 1.341214680047598, 'psi': 0.24675186291249745}
[S10] START round=1 head_norm_before_train=1.186747 (no previous merge yet)
[S10] round=1 local utility u=0.025250 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.772474165752628, 'loss_val': 1.272285152295404, 'psi': 0.39216264882608554}-{'f1_val': 0.13862163754172394, 'auprc': 0.7731185610081115, 'loss_val': 1.3247181973701656, 'psi': 0.39242040692827895}
[S11] START round=1 head_norm_before_train=1.196737 (no previous merge yet)
[S11] round=1 local utility u=0.323626 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8295588644353178, 'loss_val': 1.3178733547384185, 'psi': 0.4160717557979935}-{'f1_val': 0.16690239788550362, 'auprc': 0.5721891781897727, 'loss_val': 1.3519479024358705, 'psi': 0.32901711000721123}
[S13] START round=1 head_norm_before_train=1.129387 (no previous merge yet)
[S13] round=1 local utility u=0.102376 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7198611756656241, 'loss_val': 1.2845104989007037, 'psi': 0.3721759278124815}-{'f1_val': 0.1403857625770531, 'auprc': 0.6680825465448839, 'loss_val': 1.3339272037415877, 'psi': 0.3514644761641854}
[S14] START round=1 head_norm_before_train=1.216275 (no previous merge yet)
[S14] round=1 local utility u=0.018738 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5543427817682531, 'loss_val': 1.329343168690987, 'psi': 0.30595182443692354}-{'f1_val': 0.14035785288270378, 'auprc': 0.5496641983632609, 'loss_val': 1.352782489230746, 'psi': 0.3040803910749266}
[S15] START round=1 head_norm_before_train=1.190801 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.773294438295646, 'loss_val': 1.3025425334978444, 'psi': 0.39315796613519344}-{'f1_val': 0.3948815974531582, 'auprc': 0.7702781156973055, 'loss_val': 1.3603525121336655, 'psi': 0.5450402047508172}
[S16] START round=1 head_norm_before_train=1.164157 (no previous merge yet)
[S16] round=1 local utility u=0.071279 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7963180235708768, 'loss_val': 1.3213519348519316, 'psi': 0.4029096795478726}-{'f1_val': 0.14063745019920318, 'auprc': 0.7582379566589295, 'loss_val': 1.3496707112374837, 'psi': 0.38767765278309374}
[S17] START round=1 head_norm_before_train=1.154549 (no previous merge yet)
[S17] round=1 local utility u=0.210708 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8418980972360821, 'loss_val': 1.2874811890358948, 'psi': 0.4213286168848635}-{'f1_val': 0.14094896331738438, 'auprc': 0.7206607805335534, 'loss_val': 1.34518513569516, 'psi': 0.372833690203852}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:38402
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S11@127.0.0.1:38412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S13] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:38411
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:38402
[S16] sending update (kind=head size=1786 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1787 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1792) from S4
[S2] cosine check vs S4: cos=-0.0383
[S2] DROPPED delta from S4 (cos=-0.0383 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S14
[S2] cosine check vs S14: cos=-0.0145
[S2] DROPPED delta from S14 (cos=-0.0145 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S9
[S4] cosine check vs S9: cos=0.0351
[S16] RECEIVED delta(kind=head bytes=1790) from S7
[S16] cosine check vs S7: cos=-0.0275
[S16] DROPPED delta from S7 (cos=-0.0275 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S11
[S2] cosine check vs S11: cos=0.0428
[S10] RECEIVED delta(kind=head bytes=1787) from S13
[S10] cosine check vs S13: cos=0.0374
[S7] RECEIVED delta(kind=head bytes=1790) from S10
[S7] cosine check vs S10: cos=0.0207
[S11] RECEIVED delta(kind=head bytes=1786) from S16
[S11] cosine check vs S16: cos=-0.1060
[S11] DROPPED delta from S16 (cos=-0.1060 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S6
[S2] cosine check vs S6: cos=0.0282
[S2] RECEIVED delta(kind=head bytes=1790) from S3
[S2] cosine check vs S3: cos=-0.0486
[S2] DROPPED delta from S3 (cos=-0.0486 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38407
[S17] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S17
[S6] cosine check vs S17: cos=-0.0455
[S6] DROPPED delta from S17 (cos=-0.0455 < 0.0)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.168016
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.001269e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.735161 delta_norm=0.700127
[S2] aggregate: ACCEPT kept=['S11', 'S6'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.218451
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.260918e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.857517 delta_norm=0.826092
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.209796
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.495754e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.867374 delta_norm=0.849575
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.191664
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.095809e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.838468 delta_norm=0.809581
[S4] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.735161 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7108833504700475, 'loss_val': 1.2208498121561768, 'psi': 0.36941962022115904}-{'f1_val': 0.1417771333885667, 'auprc': 0.760636057220203, 'loss_val': 1.2685218011254287, 'psi': 0.3893207029212213}
[S3] START round=2 head_norm_before_train=1.191475 (no previous merge yet)
[S3] round=2 local utility u=0.179086 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9984953142443491, 'loss_val': 1.2805820494486477, 'psi': 0.48330216506620394}-{'f1_val': 0.13984006561410703, 'auprc': 0.8904706883508997, 'loss_val': 1.3146810394378043, 'psi': 0.44009231470882415}
[S4] START round=2 head_norm_before_train=0.838468 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.022368 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7815771547911574, 'loss_val': 1.228906983645901, 'psi': 0.3967668392535735}-{'f1_val': 0.14022662889518414, 'auprc': 0.7793265475101938, 'loss_val': 1.2668915730404244, 'psi': 0.39586659634118804}
[S5] START round=2 head_norm_before_train=1.191162 (no previous merge yet)
[S5] round=2 local utility u=0.090067 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.572280150454928, 'loss_val': 1.3065215394042993, 'psi': 0.31426920303911404}-{'f1_val': 0.14226190476190476, 'auprc': 0.5274404473763041, 'loss_val': 1.3521355253338472, 'psi': 0.29633332180766453}
[S6] START round=2 head_norm_before_train=1.206357 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6167093369224869, 'loss_val': 1.2116916879216015, 'psi': 0.33153950399976395}-{'f1_val': 0.14142628205128205, 'auprc': 0.8005429669092489, 'loss_val': 1.2617085269530643, 'psi': 0.4050729559944688}
[S7] START round=2 head_norm_before_train=0.867374 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7435811139571538, 'loss_val': 1.3171359973096155, 'psi': 0.3826665392203165}-{'f1_val': 0.14205682272909165, 'auprc': 0.7751205324761528, 'loss_val': 1.3222416556518664, 'psi': 0.39528230662791614}
[S8] START round=2 head_norm_before_train=1.190405 (no previous merge yet)
[S8] round=2 local utility u=0.046948 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7662462147339602, 'loss_val': 1.1852573984132042, 'psi': 0.3904720753293584}-{'f1_val': 0.13995598239295717, 'auprc': 0.7658550519077267, 'loss_val': 1.2779808499594554, 'psi': 0.390315610198865}
[S9] START round=2 head_norm_before_train=1.138788 (no previous merge yet)
[S9] round=2 local utility u=0.320934 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8634588568303018, 'loss_val': 1.2744976490385336, 'psi': 0.43022231701611835}-{'f1_val': 0.141397957139996, 'auprc': 0.6605095673010809, 'loss_val': 1.3075177196205574, 'psi': 0.34904260120443}
[S10] START round=2 head_norm_before_train=0.857517 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.009336 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7711500667258924, 'loss_val': 1.2496414597437422, 'psi': 0.39163300921539135}-{'f1_val': 0.13862163754172394, 'auprc': 0.772474165752628, 'loss_val': 1.272285152295404, 'psi': 0.39216264882608554}
[S11] START round=2 head_norm_before_train=1.214725 (no previous merge yet)
[S11] round=2 local utility u=0.054988 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8511044807655426, 'loss_val': 1.2725344230517577, 'psi': 0.4246900023300834}-{'f1_val': 0.14041368337311058, 'auprc': 0.8295588644353178, 'loss_val': 1.3178733547384185, 'psi': 0.4160717557979935}
[S13] START round=2 head_norm_before_train=1.162283 (no previous merge yet)
[S13] round=2 local utility u=0.037449 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.721756030710809, 'loss_val': 1.2152969386753456, 'psi': 0.37293386983055543}-{'f1_val': 0.1403857625770531, 'auprc': 0.7198611756656241, 'loss_val': 1.2845104989007037, 'psi': 0.3721759278124815}
[S14] START round=2 head_norm_before_train=1.230527 (no previous merge yet)
[S14] round=2 local utility u=0.021879 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.560858339265406, 'loss_val': 1.305132637271368, 'psi': 0.30855804743578463}-{'f1_val': 0.14035785288270378, 'auprc': 0.5543427817682531, 'loss_val': 1.329343168690987, 'psi': 0.30595182443692354}
[S15] START round=2 head_norm_before_train=1.222336 (no previous merge yet)
[S15] round=2 local utility u=0.048170 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7764969309721755, 'loss_val': 1.215809413863987, 'psi': 0.39443896320580524}-{'f1_val': 0.13973365136155833, 'auprc': 0.773294438295646, 'loss_val': 1.3025425334978444, 'psi': 0.39315796613519344}
[S16] START round=2 head_norm_before_train=1.177031 (no previous merge yet)
[S16] round=2 local utility u=0.051266 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8192696213147436, 'loss_val': 1.2876743995153304, 'psi': 0.41209031864541934}-{'f1_val': 0.14063745019920318, 'auprc': 0.7963180235708768, 'loss_val': 1.3213519348519316, 'psi': 0.4029096795478726}
[S17] START round=2 head_norm_before_train=1.192979 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5958865587734247, 'loss_val': 1.1680240879977288, 'psi': 0.3229240014998005}-{'f1_val': 0.14094896331738438, 'auprc': 0.8418980972360821, 'loss_val': 1.2874811890358948, 'psi': 0.4213286168848635}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.309)
[S13] not sending this round → trigger blocked (psi=0.373)
[S16] not sending this round → trigger blocked (psi=0.412)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:38412
[S4] not sending this round → trigger blocked (psi=0.397)
[S11] not sending this round → trigger blocked (psi=0.425)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:38403
[S9] not sending this round → trigger blocked (psi=0.430)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.483)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.392)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38405
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.1124
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=-0.0164
[S11] DROPPED delta from S5 (cos=-0.0164 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=-0.0327
[S3] DROPPED delta from S8 (cos=-0.0327 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=1.207811
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.281929e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.926958 delta_norm=0.828193
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.792033 cos_to_last_merge=0.9905 (last merge round=1)
[S2] round=3 local utility u=0.137034 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7737826912592563, 'loss_val': 1.1354798190729318, 'psi': 0.39457935653684256}-{'f1_val': 0.1417771333885667, 'auprc': 0.7108833504700475, 'loss_val': 1.2208498121561768, 'psi': 0.36941962022115904}
[S3] START round=3 head_norm_before_train=1.215452 (no previous merge yet)
[S3] round=3 local utility u=0.021777 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9986694661960123, 'loss_val': 1.2375503180693619, 'psi': 0.4833718258468691}-{'f1_val': 0.13984006561410703, 'auprc': 0.9984953142443491, 'loss_val': 1.2805820494486477, 'psi': 0.48330216506620394}
[S4] START round=3 head_norm_before_train=0.891643 cos_to_last_merge=0.9915 (last merge round=1)
[S4] round=3 local utility u=0.752229 metrics={'f1_val': 0.35613493046188044, 'auprc': 0.786218752825381, 'loss_val': 1.0338234603161844, 'psi': 0.5281684594072807}-{'f1_val': 0.14022662889518414, 'auprc': 0.7815771547911574, 'loss_val': 1.228906983645901, 'psi': 0.3967668392535735}
[S5] START round=3 head_norm_before_train=0.926958 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5403297761982025, 'loss_val': 1.2990434848923162, 'psi': 0.3014890533364239}-{'f1_val': 0.14226190476190476, 'auprc': 0.572280150454928, 'loss_val': 1.3065215394042993, 'psi': 0.31426920303911404}
[S6] START round=3 head_norm_before_train=1.258466 (no previous merge yet)
[S6] round=3 local utility u=1.000000 metrics={'f1_val': 0.3971081463755489, 'auprc': 0.762694813629045, 'loss_val': 1.063755163724039, 'psi': 0.5433428132769473}-{'f1_val': 0.14142628205128205, 'auprc': 0.6167093369224869, 'loss_val': 1.2116916879216015, 'psi': 0.33153950399976395}
[S7] START round=3 head_norm_before_train=0.883606 cos_to_last_merge=0.9969 (last merge round=1)
[S7] round=3 local utility u=0.055001 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7700926343195558, 'loss_val': 1.2866679626619368, 'psi': 0.3932711473652773}-{'f1_val': 0.14205682272909165, 'auprc': 0.7435811139571538, 'loss_val': 1.3171359973096155, 'psi': 0.3826665392203165}
[S8] START round=3 head_norm_before_train=1.240332 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.7149647659364445, 'auprc': 0.7904132914559039, 'loss_val': 1.0372355939331372, 'psi': 0.7451441761442283}-{'f1_val': 0.13995598239295717, 'auprc': 0.7662462147339602, 'loss_val': 1.1852573984132042, 'psi': 0.3904720753293584}
[S9] START round=3 head_norm_before_train=1.157065 (no previous merge yet)
[S9] round=3 local utility u=0.025161 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8653275497928333, 'loss_val': 1.229782702037325, 'psi': 0.43096979420113096}-{'f1_val': 0.141397957139996, 'auprc': 0.8634588568303018, 'loss_val': 1.2744976490385336, 'psi': 0.43022231701611835}
[S10] START round=3 head_norm_before_train=0.894340 cos_to_last_merge=0.9933 (last merge round=1)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5917013986708136, 'loss_val': 1.1056296821096554, 'psi': 0.3198535419933598}-{'f1_val': 0.13862163754172394, 'auprc': 0.7711500667258924, 'loss_val': 1.2496414597437422, 'psi': 0.39163300921539135}
[S11] START round=3 head_norm_before_train=1.240785 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7651805591609385, 'loss_val': 1.2092758607989997, 'psi': 0.39032043368824176}-{'f1_val': 0.14041368337311058, 'auprc': 0.8511044807655426, 'loss_val': 1.2725344230517577, 'psi': 0.4246900023300834}
[S13] START round=3 head_norm_before_train=1.213199 (no previous merge yet)
[S13] round=3 local utility u=0.918163 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.7373030550808277, 'loss_val': 1.079764014493832, 'psi': 0.5445679503611061}-{'f1_val': 0.1403857625770531, 'auprc': 0.721756030710809, 'loss_val': 1.2152969386753456, 'psi': 0.37293386983055543}
[S14] START round=3 head_norm_before_train=1.253299 (no previous merge yet)
[S14] round=3 local utility u=0.382520 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.806834112914416, 'loss_val': 1.2780205872517931, 'psi': 0.40694835689538866}-{'f1_val': 0.14035785288270378, 'auprc': 0.560858339265406, 'loss_val': 1.305132637271368, 'psi': 0.30855804743578463}
[S15] START round=3 head_norm_before_train=1.277303 (no previous merge yet)
[S15] round=3 local utility u=0.896680 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7770227068376663, 'loss_val': 1.0838802904858214, 'psi': 0.560634586439433}-{'f1_val': 0.13973365136155833, 'auprc': 0.7764969309721755, 'loss_val': 1.215809413863987, 'psi': 0.39443896320580524}
[S16] START round=3 head_norm_before_train=1.199494 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8049038090681995, 'loss_val': 1.2486507754248533, 'psi': 0.40634399374680175}-{'f1_val': 0.14063745019920318, 'auprc': 0.8192696213147436, 'loss_val': 1.2876743995153304, 'psi': 0.41209031864541934}
[S17] START round=3 head_norm_before_train=1.245680 (no previous merge yet)
[S17] round=3 local utility u=1.000000 metrics={'f1_val': 0.39165840333776125, 'auprc': 0.8419211021248654, 'loss_val': 0.9689685705174994, 'psi': 0.5717634828526029}-{'f1_val': 0.14094896331738438, 'auprc': 0.5958865587734247, 'loss_val': 1.1680240879977288, 'psi': 0.3229240014998005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S13@127.0.0.1:38413
[S15] not sending this round → trigger blocked (psi=0.561)
[S8] not sending this round → trigger blocked (psi=0.745)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:38405
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:38407
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S2
[S5] cosine check vs S2: cos=0.0151
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] cosine check vs S13: cos=-0.0140
[S16] DROPPED delta from S13 (cos=-0.0140 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1787) from S14
[S13] cosine check vs S14: cos=-0.0138
[S13] DROPPED delta from S14 (cos=-0.0138 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.0425
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=-0.0536
[S7] DROPPED delta from S6 (cos=-0.0536 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] cosine check vs S3: cos=-0.0250
[S6] DROPPED delta from S3 (cos=-0.0250 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1790) from S9
[S3] cosine check vs S9: cos=0.0177
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] cosine check vs S7: cos=-0.0928
[S8] DROPPED delta from S7 (cos=-0.0928 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.0344
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.945119
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.297510e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.639301 delta_norm=0.629751
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.7150 head_norm=1.287194
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.887751e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.4936 head_norm=0.821694 delta_norm=0.788775
[S8] aggregate: ROLLBACK (f1_val pre=0.715 post=0.494 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.280774
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.992219e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.930716 delta_norm=0.899222
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.247932
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.524183e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.867615 delta_norm=0.852418
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.846956 cos_to_last_merge=0.9758 (last merge round=1)
[S2] round=4 local utility u=0.901303 metrics={'f1_val': 0.41676958851984036, 'auprc': 0.7754186290329337, 'loss_val': 0.9877366336686669, 'psi': 0.5602292047250776}-{'f1_val': 0.1417771333885667, 'auprc': 0.7737826912592563, 'loss_val': 1.1354798190729318, 'psi': 0.39457935653684256}
[S3] START round=4 head_norm_before_train=0.867615 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9969703520342539, 'loss_val': 1.2418809420597903, 'psi': 0.48269218018216575}-{'f1_val': 0.13984006561410703, 'auprc': 0.9986694661960123, 'loss_val': 1.2375503180693619, 'psi': 0.4833718258468691}
[S4] START round=4 head_norm_before_train=0.968414 cos_to_last_merge=0.9722 (last merge round=1)
[S4] round=4 local utility u=0.922349 metrics={'f1_val': 0.6734060347908016, 'auprc': 0.6602731169886544, 'loss_val': 0.7149158454576655, 'psi': 0.6681528676699428}-{'f1_val': 0.35613493046188044, 'auprc': 0.786218752825381, 'loss_val': 1.0338234603161844, 'psi': 0.5281684594072807}
[S5] START round=4 head_norm_before_train=0.639301 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.286725 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7285436180090756, 'loss_val': 1.2902348062707614, 'psi': 0.37677459006077313}-{'f1_val': 0.14226190476190476, 'auprc': 0.5403297761982025, 'loss_val': 1.2990434848923162, 'psi': 0.3014890533364239}
[S6] START round=4 head_norm_before_train=1.296046 (no previous merge yet)
[S6] round=4 local utility u=0.148645 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.7651435688955307, 'loss_val': 0.8898836649738804, 'psi': 0.5559295786567466}-{'f1_val': 0.3971081463755489, 'auprc': 0.762694813629045, 'loss_val': 1.063755163724039, 'psi': 0.5433428132769473}
[S7] START round=4 head_norm_before_train=0.905903 cos_to_last_merge=0.9893 (last merge round=1)
[S7] round=4 local utility u=0.021098 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7729210374338423, 'loss_val': 1.2529579483094024, 'psi': 0.39440250861099196}-{'f1_val': 0.14205682272909165, 'auprc': 0.7700926343195558, 'loss_val': 1.2866679626619368, 'psi': 0.3932711473652773}
[S8] START round=4 head_norm_before_train=0.821694 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.098496 metrics={'f1_val': 0.7148762255234283, 'auprc': 0.7946219851442842, 'loss_val': 0.8523379018888049, 'psi': 0.7467745293717707}-{'f1_val': 0.7149647659364445, 'auprc': 0.7904132914559039, 'loss_val': 1.0372355939331372, 'psi': 0.7451441761442283}
[S9] START round=4 head_norm_before_train=1.183812 (no previous merge yet)
[S9] round=4 local utility u=0.026685 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659075997013715, 'loss_val': 1.1781538290692335, 'psi': 0.4312018141645462}-{'f1_val': 0.141397957139996, 'auprc': 0.8653275497928333, 'loss_val': 1.229782702037325, 'psi': 0.43096979420113096}
[S10] START round=4 head_norm_before_train=0.946413 cos_to_last_merge=0.9775 (last merge round=1)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.3922205615636295, 'auprc': 0.7833643539554616, 'loss_val': 0.8383387963024008, 'psi': 0.5486780785203623}-{'f1_val': 0.13862163754172394, 'auprc': 0.5917013986708136, 'loss_val': 1.1056296821096554, 'psi': 0.3198535419933598}
[S11] START round=4 head_norm_before_train=1.274737 (no previous merge yet)
[S11] round=4 local utility u=0.027225 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7635817235227662, 'loss_val': 1.1500292864782933, 'psi': 0.38968089943297285}-{'f1_val': 0.14041368337311058, 'auprc': 0.7651805591609385, 'loss_val': 1.2092758607989997, 'psi': 0.39032043368824176}
[S13] START round=4 head_norm_before_train=1.246062 (no previous merge yet)
[S13] round=4 local utility u=0.010478 metrics={'f1_val': 0.37227062240302067, 'auprc': 0.7657553161092809, 'loss_val': 0.8813215520257104, 'psi': 0.5296644998855248}-{'f1_val': 0.41607788054795825, 'auprc': 0.7373030550808277, 'loss_val': 1.079764014493832, 'psi': 0.5445679503611061}
[S14] START round=4 head_norm_before_train=0.930716 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.096156 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8727210058655188, 'loss_val': 1.2833701107300723, 'psi': 0.4333031140758298}-{'f1_val': 0.14035785288270378, 'auprc': 0.806834112914416, 'loss_val': 1.2780205872517931, 'psi': 0.40694835689538866}
[S15] START round=4 head_norm_before_train=1.335084 (no previous merge yet)
[S15] round=4 local utility u=0.438957 metrics={'f1_val': 0.41737443498404936, 'auprc': 0.9675181383632401, 'loss_val': 0.7834450030273729, 'psi': 0.6374319163357256}-{'f1_val': 0.4163758395072774, 'auprc': 0.7770227068376663, 'loss_val': 1.0838802904858214, 'psi': 0.560634586439433}
[S16] START round=4 head_norm_before_train=1.227999 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7230696761252077, 'loss_val': 1.2048941298893203, 'psi': 0.37361034056960496}-{'f1_val': 0.14063745019920318, 'auprc': 0.8049038090681995, 'loss_val': 1.2486507754248533, 'psi': 0.40634399374680175}
[S17] START round=4 head_norm_before_train=1.307394 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.3525844685111543, 'auprc': 0.8969973121208683, 'loss_val': 0.9066327711287285, 'psi': 0.5703496059550399}-{'f1_val': 0.39165840333776125, 'auprc': 0.8419211021248654, 'loss_val': 0.9689685705174994, 'psi': 0.5717634828526029}
[S6] not sending this round → trigger blocked (psi=0.556)
[S9] not sending this round → trigger blocked (psi=0.431)
[S14] not sending this round → trigger blocked (psi=0.433)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:38411
[S4] not sending this round → trigger blocked (psi=0.668)
[S13] not sending this round → trigger blocked (psi=0.530)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S7] not sending this round → trigger blocked (psi=0.394)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[S2] not sending this round → trigger blocked (psi=0.560)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[S10] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1793) from S11
[S10] cosine check vs S11: cos=-0.0005
[S10] DROPPED delta from S11 (cos=-0.0005 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=0.5386
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=-0.0458
[S3] DROPPED delta from S5 (cos=-0.0458 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.0214
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.0013
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.931803
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.219535e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.735286 delta_norm=0.521954
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=1.261737
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.748889e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.2806 head_norm=0.775870 delta_norm=0.774889
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.903680 cos_to_last_merge=0.9594 (last merge round=1)
[S2] round=5 local utility u=0.999995 metrics={'f1_val': 0.713686015178052, 'auprc': 0.7751483638033987, 'loss_val': 0.7684352940111803, 'psi': 0.7382709546281907}-{'f1_val': 0.41676958851984036, 'auprc': 0.7754186290329337, 'loss_val': 0.9877366336686669, 'psi': 0.5602292047250776}
[S3] START round=5 head_norm_before_train=0.896585 cos_to_last_merge=0.9968 (last merge round=3)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9283488120498952, 'loss_val': 1.1803322900961641, 'psi': 0.45524356418842227}-{'f1_val': 0.13984006561410703, 'auprc': 0.9969703520342539, 'loss_val': 1.2418809420597903, 'psi': 0.48269218018216575}
[S4] START round=5 head_norm_before_train=1.058446 cos_to_last_merge=0.9478 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=5 local utility u=0.145563 metrics={'f1_val': 0.6836179644462202, 'auprc': 0.6651747034128942, 'loss_val': 0.49976548096648304, 'psi': 0.6762406600328899}-{'f1_val': 0.6734060347908016, 'auprc': 0.6602731169886544, 'loss_val': 0.7149158454576655, 'psi': 0.6681528676699428}
[S5] START round=5 head_norm_before_train=0.658962 cos_to_last_merge=0.9957 (last merge round=3)
[S5] round=5 local utility u=0.017660 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7287852014476219, 'loss_val': 1.2556390487847957, 'psi': 0.3768712234361916}-{'f1_val': 0.14226190476190476, 'auprc': 0.7285436180090756, 'loss_val': 1.2902348062707614, 'psi': 0.37677459006077313}
[S6] START round=5 head_norm_before_train=1.357475 (no previous merge yet)
[S6] round=5 local utility u=1.000000 metrics={'f1_val': 0.7113074740981404, 'auprc': 0.7955268739399456, 'loss_val': 0.5603360217291716, 'psi': 0.7449952340348625}-{'f1_val': 0.4164535851642239, 'auprc': 0.7651435688955307, 'loss_val': 0.8898836649738804, 'psi': 0.5559295786567466}
[S7] START round=5 head_norm_before_train=0.735286 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.003505 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7766087451643985, 'loss_val': 1.2570100918629925, 'psi': 0.3958775917032144}-{'f1_val': 0.14205682272909165, 'auprc': 0.7729210374338423, 'loss_val': 1.2529579483094024, 'psi': 0.39440250861099196}
[S8] START round=5 head_norm_before_train=0.901595 cos_to_last_merge=0.9918 (last merge round=3)
[S8] round=5 local utility u=0.118641 metrics={'f1_val': 0.7019576002791107, 'auprc': 0.7945129929836383, 'loss_val': 0.537217786682387, 'psi': 0.7389797573609218}-{'f1_val': 0.7148762255234283, 'auprc': 0.7946219851442842, 'loss_val': 0.8523379018888049, 'psi': 0.7467745293717707}
[S9] START round=5 head_norm_before_train=1.218378 (no previous merge yet)
[S9] round=5 local utility u=0.043924 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659635625158328, 'loss_val': 1.0904741745465953, 'psi': 0.4312241992903308}-{'f1_val': 0.141397957139996, 'auprc': 0.8659075997013715, 'loss_val': 1.1781538290692335, 'psi': 0.4312018141645462}
[S10] START round=5 head_norm_before_train=1.012980 cos_to_last_merge=0.9545 (last merge round=1)
[S10] round=5 local utility u=0.959272 metrics={'f1_val': 0.6600609977660347, 'auprc': 0.8202010693540496, 'loss_val': 0.6373475286648517, 'psi': 0.7241170264012406}-{'f1_val': 0.3922205615636295, 'auprc': 0.7833643539554616, 'loss_val': 0.8383387963024008, 'psi': 0.5486780785203623}
[S11] START round=5 head_norm_before_train=1.308157 (no previous merge yet)
[S11] round=5 local utility u=0.920648 metrics={'f1_val': 0.4225625868721864, 'auprc': 0.7776167661421142, 'loss_val': 1.0437313770024184, 'psi': 0.5645842585801575}-{'f1_val': 0.14041368337311058, 'auprc': 0.7635817235227662, 'loss_val': 1.1500292864782933, 'psi': 0.38968089943297285}
[S13] START round=5 head_norm_before_train=1.299064 (no previous merge yet)
[S13] round=5 local utility u=0.053894 metrics={'f1_val': 0.3778988899456025, 'auprc': 0.7488413495789736, 'loss_val': 0.7565612382070587, 'psi': 0.5262758737989509}-{'f1_val': 0.37227062240302067, 'auprc': 0.7657553161092809, 'loss_val': 0.8813215520257104, 'psi': 0.5296644998855248}
[S14] START round=5 head_norm_before_train=0.956170 cos_to_last_merge=0.9979 (last merge round=3)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7765909683995273, 'loss_val': 1.2361493443457383, 'psi': 0.3948510990894332}-{'f1_val': 0.14035785288270378, 'auprc': 0.8727210058655188, 'loss_val': 1.2833701107300723, 'psi': 0.4333031140758298}
[S15] START round=5 head_norm_before_train=1.406127 (no previous merge yet)
[S15] round=5 local utility u=0.962724 metrics={'f1_val': 0.6986767022543137, 'auprc': 0.9700542659074692, 'loss_val': 0.5534191896553441, 'psi': 0.8072277277155759}-{'f1_val': 0.41737443498404936, 'auprc': 0.9675181383632401, 'loss_val': 0.7834450030273729, 'psi': 0.6374319163357256}
[S16] START round=5 head_norm_before_train=0.775870 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.683172 metrics={'f1_val': 0.4150731431819776, 'auprc': 0.6353614148976889, 'loss_val': 1.2220394980130782, 'psi': 0.5031884518682621}-{'f1_val': 0.14063745019920318, 'auprc': 0.7230696761252077, 'loss_val': 1.2048941298893203, 'psi': 0.37361034056960496}
[S17] START round=5 head_norm_before_train=1.377883 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35342870760485867, 'auprc': 0.7642232697061996, 'loss_val': 0.8721795696895484, 'psi': 0.517746532445395}-{'f1_val': 0.3525844685111543, 'auprc': 0.8969973121208683, 'loss_val': 0.9066327711287285, 'psi': 0.5703496059550399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:38404
[S8] not sending this round → trigger blocked (psi=0.739)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:38403
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.724)
[S15] not sending this round → trigger blocked (psi=0.807)
[S11] not sending this round → trigger blocked (psi=0.565)
[S5] not sending this round → trigger blocked (psi=0.377)
[S7] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=-0.0756
[S16] DROPPED delta from S13 (cos=-0.0756 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] cosine check vs S16: cos=0.3423
[S5] RECEIVED delta(kind=head bytes=1795) from S2
[S5] cosine check vs S2: cos=0.6238
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.5225
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] cosine check vs S9: cos=0.6420
[S8] RECEIVED delta(kind=head bytes=1793) from S7
[S8] cosine check vs S7: cos=-0.0134
[S8] DROPPED delta from S7 (cos=-0.0134 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=-0.0872
[S7] DROPPED delta from S6 (cos=-0.0872 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.683 → S7@127.0.0.1:38408
[S11] ⇄ pheromone p=0.548 → S10@127.0.0.1:38411
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.928220
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.836425e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.989638 delta_norm=0.483642
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.354 → S6@127.0.0.1:38407
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.7020 head_norm=0.997566
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.357186e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.7035 head_norm=0.947787 delta_norm=0.535719
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.500 → S16@127.0.0.1:38416
[S14] ⇄ pheromone p=0.396 → S13@127.0.0.1:38413
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.682972
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.884966e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.756949 delta_norm=0.388497
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.386 → S3@127.0.0.1:38403
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.6836 head_norm=1.172796
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.872646e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.6889 head_norm=0.818067 delta_norm=0.587265
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.621 → S8@127.0.0.1:38409
[S9] ⇄ pheromone p=0.410 → S3@127.0.0.1:38403
[S13] ⇄ pheromone p=0.470 → S16@127.0.0.1:38416
[S2] ⇄ pheromone p=0.689 → S5@127.0.0.1:38405
[S6] ⇄ pheromone p=0.686 → S7@127.0.0.1:38408
[S16] ⇄ pheromone p=0.475 → S4@127.0.0.1:38404
[S7] ⇄ pheromone p=0.376 → S8@127.0.0.1:38409
[S17] ⇄ pheromone p=0.473 → S14@127.0.0.1:38414
[S15] ⇄ pheromone p=0.710 → S7@127.0.0.1:38408
[S2] START round=6 head_norm_before_train=0.990632 cos_to_last_merge=0.9350 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=6 local utility u=0.110479 metrics={'f1_val': 0.7143636197196823, 'auprc': 0.778001592460691, 'loss_val': 0.5601027587752377, 'psi': 0.7398188088160857}-{'f1_val': 0.713686015178052, 'auprc': 0.7751483638033987, 'loss_val': 0.7684352940111803, 'psi': 0.7382709546281907}
[S3] START round=6 head_norm_before_train=0.989638 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8081909998980166, 'loss_val': 1.1143770809495732, 'psi': 0.4071804393276709}-{'f1_val': 0.13984006561410703, 'auprc': 0.9283488120498952, 'loss_val': 1.1803322900961641, 'psi': 0.45524356418842227}
[S4] START round=6 head_norm_before_train=0.818067 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.6793195344789089, 'auprc': 0.6638950432608471, 'loss_val': 0.4800898026199649, 'psi': 0.6731497379916842}-{'f1_val': 0.6836179644462202, 'auprc': 0.6651747034128942, 'loss_val': 0.49976548096648304, 'psi': 0.6762406600328899}
[S5] START round=6 head_norm_before_train=0.756949 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.007722 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7287063736130147, 'loss_val': 1.2399585027490134, 'psi': 0.37683969230234876}-{'f1_val': 0.14226190476190476, 'auprc': 0.7287852014476219, 'loss_val': 1.2556390487847957, 'psi': 0.3768712234361916}
[S6] START round=6 head_norm_before_train=1.425638 (no previous merge yet)
[S6] round=6 local utility u=0.126142 metrics={'f1_val': 0.698619388596838, 'auprc': 0.8504286439832486, 'loss_val': 0.39662980757107513, 'psi': 0.7593430907514023}-{'f1_val': 0.7113074740981404, 'auprc': 0.7955268739399456, 'loss_val': 0.5603360217291716, 'psi': 0.7449952340348625}
[S7] START round=6 head_norm_before_train=0.756112 cos_to_last_merge=0.9972 (last merge round=4)
[S7] round=6 local utility u=0.023316 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.776408661197024, 'loss_val': 1.2097787937618776, 'psi': 0.3957975581162646}-{'f1_val': 0.14205682272909165, 'auprc': 0.7766087451643985, 'loss_val': 1.2570100918629925, 'psi': 0.3958775917032144}
[S8] START round=6 head_norm_before_train=0.947787 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.337157 metrics={'f1_val': 0.7021561464358999, 'auprc': 0.9967570660359214, 'loss_val': 0.47082755046391217, 'psi': 0.8199965142759085}-{'f1_val': 0.7019576002791107, 'auprc': 0.7945129929836383, 'loss_val': 0.537217786682387, 'psi': 0.7389797573609218}
[S9] START round=6 head_norm_before_train=1.250997 (no previous merge yet)
[S9] round=6 local utility u=0.234346 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9612194717322726, 'loss_val': 0.9075507713494807, 'psi': 0.46932656297690667}-{'f1_val': 0.141397957139996, 'auprc': 0.8659635625158328, 'loss_val': 1.0904741745465953, 'psi': 0.4312241992903308}
[S10] START round=6 head_norm_before_train=1.084957 cos_to_last_merge=0.9251 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=6 local utility u=0.200284 metrics={'f1_val': 0.6472518318811008, 'auprc': 0.9405949784779968, 'loss_val': 0.5211065494948642, 'psi': 0.7645890905198591}-{'f1_val': 0.6600609977660347, 'auprc': 0.8202010693540496, 'loss_val': 0.6373475286648517, 'psi': 0.7241170264012406}
[S11] START round=6 head_norm_before_train=1.333430 (no previous merge yet)
[S11] round=6 local utility u=0.251174 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9460979051967501, 'loss_val': 0.8907656216376704, 'psi': 0.6163705036344238}-{'f1_val': 0.4225625868721864, 'auprc': 0.7776167661421142, 'loss_val': 1.0437313770024184, 'psi': 0.5645842585801575}
[S13] START round=6 head_norm_before_train=1.356316 (no previous merge yet)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.7097696480519168, 'auprc': 0.7949557292583987, 'loss_val': 0.5802187122611083, 'psi': 0.7438440805345096}-{'f1_val': 0.3778988899456025, 'auprc': 0.7488413495789736, 'loss_val': 0.7565612382070587, 'psi': 0.5262758737989509}
[S14] START round=6 head_norm_before_train=0.992347 cos_to_last_merge=0.9921 (last merge round=3)
[S14] round=6 local utility u=0.100862 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8159622323030288, 'loss_val': 1.1525394659056956, 'psi': 0.4105996046508338}-{'f1_val': 0.14035785288270378, 'auprc': 0.7765909683995273, 'loss_val': 1.2361493443457383, 'psi': 0.3948510990894332}
[S15] START round=6 head_norm_before_train=1.484229 (no previous merge yet)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.6978491642704908, 'auprc': 0.8903465302010343, 'loss_val': 0.4191741877758484, 'psi': 0.7748481106427083}-{'f1_val': 0.6986767022543137, 'auprc': 0.9700542659074692, 'loss_val': 0.5534191896553441, 'psi': 0.8072277277155759}
[S16] START round=6 head_norm_before_train=0.807946 cos_to_last_merge=0.9969 (last merge round=4)
[S16] round=6 local utility u=0.052462 metrics={'f1_val': 0.4175015313869336, 'auprc': 0.6318364416693794, 'loss_val': 1.121111730524865, 'psi': 0.5032354954999119}-{'f1_val': 0.4150731431819776, 'auprc': 0.6353614148976889, 'loss_val': 1.2220394980130782, 'psi': 0.5031884518682621}
[S17] START round=6 head_norm_before_train=1.439446 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.3521394294854705, 'auprc': 0.7343944578526664, 'loss_val': 0.9260999099813917, 'psi': 0.5050414408323489}-{'f1_val': 0.35342870760485867, 'auprc': 0.7642232697061996, 'loss_val': 0.8721795696895484, 'psi': 0.517746532445395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:38413
[S9] not sending this round → trigger blocked (psi=0.469)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.503)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38416
[S2] not sending this round → trigger blocked (psi=0.740)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:38411
[S6] not sending this round → trigger blocked (psi=0.759)
[S13] not sending this round → trigger blocked (psi=0.744)
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=0.0063
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.6456
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] cosine check vs S8: cos=0.4809
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] cosine check vs S14: cos=-0.0222
[S13] DROPPED delta from S14 (cos=-0.0222 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] cosine check vs S5: cos=-0.0765
[S3] DROPPED delta from S5 (cos=-0.0765 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.779472
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.435765e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.883731 delta_norm=0.443577
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.6473 head_norm=1.160993
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.947284e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.6895 head_norm=0.900283 delta_norm=0.894728
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4175 head_norm=0.847707
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.865528e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4172 head_norm=0.811798 delta_norm=0.486553
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.091677 cos_to_last_merge=0.9091 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.909
[S2] round=7 local utility u=0.012868 metrics={'f1_val': 0.701470645897668, 'auprc': 0.7494302910719723, 'loss_val': 0.3712960043032904, 'psi': 0.7206545039673897}-{'f1_val': 0.7143636197196823, 'auprc': 0.778001592460691, 'loss_val': 0.5601027587752377, 'psi': 0.7398188088160857}
[S3] START round=7 head_norm_before_train=1.014409 cos_to_last_merge=0.9970 (last merge round=5)
[S3] round=7 local utility u=0.881992 metrics={'f1_val': 0.3954188034945724, 'auprc': 0.8290863306336993, 'loss_val': 0.9465509347613983, 'psi': 0.5688858143502231}-{'f1_val': 0.13984006561410703, 'auprc': 0.8081909998980166, 'loss_val': 1.1143770809495732, 'psi': 0.4071804393276709}
[S4] START round=7 head_norm_before_train=0.931804 cos_to_last_merge=0.9904 (last merge round=5)
[S4] round=7 local utility u=0.376570 metrics={'f1_val': 0.658949747659581, 'auprc': 0.9463168003889236, 'loss_val': 0.4519971739946333, 'psi': 0.7738965687513181}-{'f1_val': 0.6793195344789089, 'auprc': 0.6638950432608471, 'loss_val': 0.4800898026199649, 'psi': 0.6731497379916842}
[S5] START round=7 head_norm_before_train=0.776097 cos_to_last_merge=0.9969 (last merge round=5)
[S5] round=7 local utility u=0.044242 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7361821810647209, 'loss_val': 1.1739010842271578, 'psi': 0.37983001528303123}-{'f1_val': 0.14226190476190476, 'auprc': 0.7287063736130147, 'loss_val': 1.2399585027490134, 'psi': 0.37683969230234876}
[S6] START round=7 head_norm_before_train=1.495420 (no previous merge yet)
[S6] round=7 local utility u=0.196531 metrics={'f1_val': 0.6959093359994626, 'auprc': 0.9632893873861065, 'loss_val': 0.3258896595190786, 'psi': 0.80286135655412}-{'f1_val': 0.698619388596838, 'auprc': 0.8504286439832486, 'loss_val': 0.39662980757107513, 'psi': 0.7593430907514023}
[S7] START round=7 head_norm_before_train=0.883731 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.712111 metrics={'f1_val': 0.38226123532277967, 'auprc': 0.7564021648164844, 'loss_val': 1.1667636379071842, 'psi': 0.5319176071202616}-{'f1_val': 0.14205682272909165, 'auprc': 0.776408661197024, 'loss_val': 1.2097787937618776, 'psi': 0.3957975581162646}
[S8] START round=7 head_norm_before_train=1.035805 cos_to_last_merge=0.9877 (last merge round=5)
[S8] round=7 local utility u=0.965799 metrics={'f1_val': 0.9944524190866717, 'auprc': 0.9975884929217694, 'loss_val': 0.2955007475682816, 'psi': 0.9957068486207108}-{'f1_val': 0.7021561464358999, 'auprc': 0.9967570660359214, 'loss_val': 0.47082755046391217, 'psi': 0.8199965142759085}
[S9] START round=7 head_norm_before_train=1.284503 (no previous merge yet)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.7017640638110727, 'auprc': 0.9780320800621598, 'loss_val': 0.679034756975661, 'psi': 0.8122712703115076}-{'f1_val': 0.141397957139996, 'auprc': 0.9612194717322726, 'loss_val': 0.9075507713494807, 'psi': 0.46932656297690667}
[S10] START round=7 head_norm_before_train=0.900283 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.261829 metrics={'f1_val': 0.7007673032853614, 'auprc': 0.9964703298883435, 'loss_val': 0.4861676100741153, 'psi': 0.8190485139265542}-{'f1_val': 0.6472518318811008, 'auprc': 0.9405949784779968, 'loss_val': 0.5211065494948642, 'psi': 0.7645890905198591}
[S11] START round=7 head_norm_before_train=1.369011 (no previous merge yet)
[S11] round=7 local utility u=0.157538 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9978787074138448, 'loss_val': 0.7308303047607527, 'psi': 0.6370626156110375}-{'f1_val': 0.39655223592620625, 'auprc': 0.9460979051967501, 'loss_val': 0.8907656216376704, 'psi': 0.6163705036344238}
[S13] START round=7 head_norm_before_train=1.419002 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.4170131440255094, 'auprc': 0.6321752682208563, 'loss_val': 0.6997047088835779, 'psi': 0.5030779937036481}-{'f1_val': 0.7097696480519168, 'auprc': 0.7949557292583987, 'loss_val': 0.5802187122611083, 'psi': 0.7438440805345096}
[S14] START round=7 head_norm_before_train=1.027241 cos_to_last_merge=0.9842 (last merge round=3)
[S14] round=7 local utility u=0.999070 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.9227421142768031, 'loss_val': 1.0115606613438697, 'psi': 0.606993671480236}-{'f1_val': 0.14035785288270378, 'auprc': 0.8159622323030288, 'loss_val': 1.1525394659056956, 'psi': 0.4105996046508338}
[S15] START round=7 head_norm_before_train=1.573013 (no previous merge yet)
[S15] round=7 local utility u=0.150402 metrics={'f1_val': 0.6953935457165975, 'auprc': 0.9692853273235437, 'loss_val': 0.34045306940052017, 'psi': 0.804950258359376}-{'f1_val': 0.6978491642704908, 'auprc': 0.8903465302010343, 'loss_val': 0.4191741877758484, 'psi': 0.7748481106427083}
[S16] START round=7 head_norm_before_train=0.811798 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.38328280545907634, 'auprc': 0.4368045412362263, 'loss_val': 1.1827103625564421, 'psi': 0.40469149976993635}-{'f1_val': 0.4175015313869336, 'auprc': 0.6318364416693794, 'loss_val': 1.121111730524865, 'psi': 0.5032354954999119}
[S17] START round=7 head_norm_before_train=1.478111 (no previous merge yet)
[S17] round=7 local utility u=0.063943 metrics={'f1_val': 0.35169382415044237, 'auprc': 0.785255835878897, 'loss_val': 0.9481242431864965, 'psi': 0.5251186288418243}-{'f1_val': 0.3521394294854705, 'auprc': 0.7343944578526664, 'loss_val': 0.9260999099813917, 'psi': 0.5050414408323489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:38403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S2] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.8793
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=0.6995
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=-0.0394
[S6] DROPPED delta from S3 (cos=-0.0394 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.6678
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.1972
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=-0.0670
[S7] DROPPED delta from S6 (cos=-0.0670 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.8510
[S13] RECEIVED delta(kind=head bytes=1796) from S14
[S13] cosine check vs S14: cos=-0.0224
[S13] DROPPED delta from S14 (cos=-0.0224 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.8814
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=-0.0744
[S3] DROPPED delta from S5 (cos=-0.0744 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=-0.0410
[S8] DROPPED delta from S7 (cos=-0.0410 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1791) from S4
[S8] cosine check vs S4: cos=0.8038
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.6403
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.3823 head_norm=0.893126
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.692187e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.810383 delta_norm=0.469219
[S7] aggregate: ROLLBACK (f1_val pre=0.382 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.1423 head_norm=0.800847
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.080040e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.1423 head_norm=0.965047 delta_norm=0.308004
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3965 head_norm=1.068659
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.782892e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3921 head_norm=1.166281 delta_norm=0.578289
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.9945 head_norm=1.137082
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.439498e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.9749 head_norm=1.033218 delta_norm=0.343950
[S8] aggregate: ROLLBACK (f1_val pre=0.994 post=0.975 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3954 head_norm=1.049901
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.198639e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.3952 head_norm=1.154419 delta_norm=0.319864
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.7008 head_norm=0.978536
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.056962e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.6998 head_norm=1.106517 delta_norm=0.505696
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.3833 head_norm=0.843227
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.050216e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.1528 head_norm=0.953391 delta_norm=0.305022
[S16] aggregate: ROLLBACK (f1_val pre=0.383 post=0.153 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.187859 cos_to_last_merge=0.8842 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.884
[S2] round=8 local utility u=0.112117 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.8002244629878899, 'loss_val': 0.3000584726728268, 'psi': 0.7410336327030544}-{'f1_val': 0.701470645897668, 'auprc': 0.7494302910719723, 'loss_val': 0.3712960043032904, 'psi': 0.7206545039673897}
[S3] START round=8 head_norm_before_train=1.154419 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.946742 metrics={'f1_val': 0.6789667013197942, 'auprc': 0.8490332679768442, 'loss_val': 0.814195141513994, 'psi': 0.7469933279826142}-{'f1_val': 0.3954188034945724, 'auprc': 0.8290863306336993, 'loss_val': 0.9465509347613983, 'psi': 0.5688858143502231}
[S4] START round=8 head_norm_before_train=1.038617 cos_to_last_merge=0.9723 (last merge round=5)
[S4] round=8 local utility u=0.892878 metrics={'f1_val': 0.9558935324190682, 'auprc': 0.9310000076300928, 'loss_val': 0.4019537032796366, 'psi': 0.945936122503478}-{'f1_val': 0.658949747659581, 'auprc': 0.9463168003889236, 'loss_val': 0.4519971739946333, 'psi': 0.7738965687513181}
[S5] START round=8 head_norm_before_train=0.965047 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.904509 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7718930240247394, 'loss_val': 1.1261518468764515, 'psi': 0.5595280241885475}-{'f1_val': 0.14226190476190476, 'auprc': 0.7361821810647209, 'loss_val': 1.1739010842271578, 'psi': 0.37983001528303123}
[S6] START round=8 head_norm_before_train=1.551935 (no previous merge yet)
[S6] round=8 local utility u=0.796500 metrics={'f1_val': 0.9585156771228237, 'auprc': 0.9574416208210947, 'loss_val': 0.2909841887322083, 'psi': 0.9580860546021321}-{'f1_val': 0.6959093359994626, 'auprc': 0.9632893873861065, 'loss_val': 0.3258896595190786, 'psi': 0.80286135655412}
[S7] START round=8 head_norm_before_train=0.810383 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.40279958054109055, 'auprc': 0.6101243334235894, 'loss_val': 1.1371978336694344, 'psi': 0.48572948169409014}-{'f1_val': 0.38226123532277967, 'auprc': 0.7564021648164844, 'loss_val': 1.1667636379071842, 'psi': 0.5319176071202616}
[S8] START round=8 head_norm_before_train=1.033218 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.8615614979824144, 'auprc': 0.9911757153335443, 'loss_val': 0.30186357390246776, 'psi': 0.9134071849228663}-{'f1_val': 0.9944524190866717, 'auprc': 0.9975884929217694, 'loss_val': 0.2955007475682816, 'psi': 0.9957068486207108}
[S9] START round=8 head_norm_before_train=1.329549 (no previous merge yet)
[S9] round=8 local utility u=0.152217 metrics={'f1_val': 0.7016893154854569, 'auprc': 0.9999128521783519, 'loss_val': 0.4397937191052861, 'psi': 0.8209787301626149}-{'f1_val': 0.7017640638110727, 'auprc': 0.9780320800621598, 'loss_val': 0.679034756975661, 'psi': 0.8122712703115076}
[S10] START round=8 head_norm_before_train=1.106517 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.6962766681333978, 'auprc': 0.9963302503695561, 'loss_val': 0.48440358828715596, 'psi': 0.8162981010278612}-{'f1_val': 0.7007673032853614, 'auprc': 0.9964703298883435, 'loss_val': 0.4861676100741153, 'psi': 0.8190485139265542}
[S11] START round=8 head_norm_before_train=1.415162 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.40062503679542427, 'auprc': 0.9070689468068719, 'loss_val': 0.6800324232063665, 'psi': 0.6032026008000033}-{'f1_val': 0.39651855440916606, 'auprc': 0.9978787074138448, 'loss_val': 0.7308303047607527, 'psi': 0.6370626156110375}
[S13] START round=8 head_norm_before_train=1.471953 (no previous merge yet)
[S13] round=8 local utility u=1.000000 metrics={'f1_val': 0.6994698393507436, 'auprc': 0.7154104971267108, 'loss_val': 0.4555109062482006, 'psi': 0.7058461024611304}-{'f1_val': 0.4170131440255094, 'auprc': 0.6321752682208563, 'loss_val': 0.6997047088835779, 'psi': 0.5030779937036481}
[S14] START round=8 head_norm_before_train=1.166281 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.468510 metrics={'f1_val': 0.5205269621354764, 'auprc': 0.9504762436230572, 'loss_val': 0.9019358201390854, 'psi': 0.6925066747305088}-{'f1_val': 0.39649470961585787, 'auprc': 0.9227421142768031, 'loss_val': 1.0115606613438697, 'psi': 0.606993671480236}
[S15] START round=8 head_norm_before_train=1.643511 (no previous merge yet)
[S15] round=8 local utility u=0.007183 metrics={'f1_val': 0.6969927531736653, 'auprc': 0.9735300332908364, 'loss_val': 0.34841555416958797, 'psi': 0.8076076652205337}-{'f1_val': 0.6953935457165975, 'auprc': 0.9692853273235437, 'loss_val': 0.34045306940052017, 'psi': 0.804950258359376}
[S16] START round=8 head_norm_before_train=0.953391 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3489695862013944, 'auprc': 0.4602619832065861, 'loss_val': 1.2865726705439648, 'psi': 0.39348654500347113}-{'f1_val': 0.38328280545907634, 'auprc': 0.4368045412362263, 'loss_val': 1.1827103625564421, 'psi': 0.40469149976993635}
[S17] START round=8 head_norm_before_train=1.499075 (no previous merge yet)
[S17] round=8 local utility u=0.052807 metrics={'f1_val': 0.3542671943202623, 'auprc': 0.7911220598031437, 'loss_val': 0.8755497187858395, 'psi': 0.5290091405134149}-{'f1_val': 0.35169382415044237, 'auprc': 0.785255835878897, 'loss_val': 0.9481242431864965, 'psi': 0.5251186288418243}
[S5] not sending this round → trigger blocked (psi=0.560)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S9] not sending this round → trigger blocked (psi=0.821)
[S4] not sending this round → trigger blocked (psi=0.946)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.741)
[S6] not sending this round → trigger blocked (psi=0.958)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.693)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.747)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.808)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=-0.1037
[S16] DROPPED delta from S13 (cos=-0.1037 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.529)
[S2] START round=9 head_norm_before_train=1.261670 cos_to_last_merge=0.8629 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.863
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6743398223579826, 'loss_val': 0.28781844099371656, 'psi': 0.6905220077669142}-{'f1_val': 0.7015730791798309, 'auprc': 0.8002244629878899, 'loss_val': 0.3000584726728268, 'psi': 0.7410336327030544}
[S3] START round=9 head_norm_before_train=1.185815 cos_to_last_merge=0.9971 (last merge round=7)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.4017507627824197, 'auprc': 0.8803610382960612, 'loss_val': 0.8235510875107449, 'psi': 0.5931948729878763}-{'f1_val': 0.6789667013197942, 'auprc': 0.8490332679768442, 'loss_val': 0.814195141513994, 'psi': 0.7469933279826142}
[S4] START round=9 head_norm_before_train=1.121349 cos_to_last_merge=0.9577 (last merge round=5)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.7706030086250444, 'auprc': 0.94235757925207, 'loss_val': 0.42234655792968506, 'psi': 0.8393048368758547}-{'f1_val': 0.9558935324190682, 'auprc': 0.9310000076300928, 'loss_val': 0.4019537032796366, 'psi': 0.945936122503478}
[S5] START round=9 head_norm_before_train=0.980287 cos_to_last_merge=0.9984 (last merge round=7)
[S5] round=9 local utility u=0.067385 metrics={'f1_val': 0.41762898496828804, 'auprc': 0.7737937732674353, 'loss_val': 0.9951488654444784, 'psi': 0.560094900287947}-{'f1_val': 0.41795135763108626, 'auprc': 0.7718930240247394, 'loss_val': 1.1261518468764515, 'psi': 0.5595280241885475}
[S6] START round=9 head_norm_before_train=1.590342 (no previous merge yet)
[S6] round=9 local utility u=0.028405 metrics={'f1_val': 0.9607559733223235, 'auprc': 0.9598106090335011, 'loss_val': 0.2547226954017218, 'psi': 0.9603778276067946}-{'f1_val': 0.9585156771228237, 'auprc': 0.9574416208210947, 'loss_val': 0.2909841887322083, 'psi': 0.9580860546021321}
[S7] START round=9 head_norm_before_train=0.823204 cos_to_last_merge=0.9960 (last merge round=7)
[S7] round=9 local utility u=0.323278 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7634931465572962, 'loss_val': 1.0361639490938828, 'psi': 0.5556185149156874}-{'f1_val': 0.40279958054109055, 'auprc': 0.6101243334235894, 'loss_val': 1.1371978336694344, 'psi': 0.48572948169409014}
[S8] START round=9 head_norm_before_train=1.115239 cos_to_last_merge=0.9946 (last merge round=7)
[S8] round=9 local utility u=0.444160 metrics={'f1_val': 0.9934667705418724, 'auprc': 0.9971567246543862, 'loss_val': 0.22291884326237332, 'psi': 0.9949427521868779}-{'f1_val': 0.8615614979824144, 'auprc': 0.9911757153335443, 'loss_val': 0.30186357390246776, 'psi': 0.9134071849228663}
[S9] START round=9 head_norm_before_train=1.381013 (no previous merge yet)
[S9] round=9 local utility u=0.058246 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.999124269335582, 'loss_val': 0.32004453331956817, 'psi': 0.820574106255396}-{'f1_val': 0.7016893154854569, 'auprc': 0.9999128521783519, 'loss_val': 0.4397937191052861, 'psi': 0.8209787301626149}
[S10] START round=9 head_norm_before_train=1.160860 cos_to_last_merge=0.9902 (last merge round=7)
[S10] round=9 local utility u=0.323027 metrics={'f1_val': 0.784303501945344, 'auprc': 0.9937389889446003, 'loss_val': 0.358736063862562, 'psi': 0.8680776967450465}-{'f1_val': 0.6962766681333978, 'auprc': 0.9963302503695561, 'loss_val': 0.48440358828715596, 'psi': 0.8162981010278612}
[S11] START round=9 head_norm_before_train=1.460244 (no previous merge yet)
[S11] round=9 local utility u=0.811586 metrics={'f1_val': 0.5971558514062655, 'auprc': 0.9960242438249927, 'loss_val': 0.502912110187545, 'psi': 0.7567032083737564}-{'f1_val': 0.40062503679542427, 'auprc': 0.9070689468068719, 'loss_val': 0.6800324232063665, 'psi': 0.6032026008000033}
[S13] START round=9 head_norm_before_train=1.513261 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6110164210386745, 'auprc': 0.6987774198622516, 'loss_val': 0.5703304631525892, 'psi': 0.6461208205681053}-{'f1_val': 0.6994698393507436, 'auprc': 0.7154104971267108, 'loss_val': 0.4555109062482006, 'psi': 0.7058461024611304}
[S14] START round=9 head_norm_before_train=1.202641 cos_to_last_merge=0.9973 (last merge round=7)
[S14] round=9 local utility u=0.140162 metrics={'f1_val': 0.5188092559561256, 'auprc': 0.985062062673995, 'loss_val': 0.7150623912438755, 'psi': 0.7053103786432733}-{'f1_val': 0.5205269621354764, 'auprc': 0.9504762436230572, 'loss_val': 0.9019358201390854, 'psi': 0.6925066747305088}
[S15] START round=9 head_norm_before_train=1.693318 (no previous merge yet)
[S15] round=9 local utility u=0.205774 metrics={'f1_val': 0.7384554285375154, 'auprc': 0.9796730293126262, 'loss_val': 0.20407237584436846, 'psi': 0.8349424688475597}-{'f1_val': 0.6969927531736653, 'auprc': 0.9735300332908364, 'loss_val': 0.34841555416958797, 'psi': 0.8076076652205337}
[S16] START round=9 head_norm_before_train=0.978815 cos_to_last_merge=0.9950 (last merge round=7)
[S16] round=9 local utility u=0.280368 metrics={'f1_val': 0.3112061526472954, 'auprc': 0.6885243554920507, 'loss_val': 1.1840421946999797, 'psi': 0.46213343378519756}-{'f1_val': 0.3489695862013944, 'auprc': 0.4602619832065861, 'loss_val': 1.2865726705439648, 'psi': 0.39348654500347113}
[S17] START round=9 head_norm_before_train=1.516016 (no previous merge yet)
[S17] round=9 local utility u=0.444004 metrics={'f1_val': 0.39192929799195303, 'auprc': 0.9376025016417893, 'loss_val': 0.6529548891137419, 'psi': 0.6101985794518876}-{'f1_val': 0.3542671943202623, 'auprc': 0.7911220598031437, 'loss_val': 0.8755497187858395, 'psi': 0.5290091405134149}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[S9] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] cosine check vs S11: cos=0.8687
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=-0.0793
[S7] DROPPED delta from S6 (cos=-0.0793 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.5938
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=0.5387
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.8296
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] cosine check vs S8: cos=0.9496
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=-0.0282
[S13] DROPPED delta from S14 (cos=-0.0282 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] cosine check vs S5: cos=-0.0769
[S3] DROPPED delta from S5 (cos=-0.0769 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.0404
[S3] RECEIVED delta(kind=head bytes=1792) from S9
[S3] cosine check vs S9: cos=0.9321
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] cosine check vs S17: cos=0.8906
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.7706 head_norm=1.179904
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.298708e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.9488 head_norm=1.049513 delta_norm=0.329871
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4018 head_norm=1.226347
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.658344e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.4032 head_norm=1.308261 delta_norm=0.265834
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.7843 head_norm=1.223941
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.735666e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.7840 head_norm=1.316929 delta_norm=0.373567
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.9935 head_norm=1.185980
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.142277e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.9937 head_norm=0.742058 delta_norm=0.714228
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3112 head_norm=1.014105
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.941954e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3617 head_norm=1.086171 delta_norm=0.194195
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.5188 head_norm=1.253735
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.538095e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.5204 head_norm=1.356466 delta_norm=0.353810
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4170 head_norm=0.845574
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.443951e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4170 head_norm=0.912889 delta_norm=0.344395
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.318875 cos_to_last_merge=0.8471 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.847
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.6296048709593386, 'auprc': 0.7376673029713278, 'loss_val': 0.5572985758085507, 'psi': 0.6728298437641342}-{'f1_val': 0.7013101313728686, 'auprc': 0.6743398223579826, 'loss_val': 0.28781844099371656, 'psi': 0.6905220077669142}
[S3] START round=10 head_norm_before_train=1.308261 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=1.000000 metrics={'f1_val': 0.7000757262075916, 'auprc': 0.9951874060101298, 'loss_val': 0.6037359091041755, 'psi': 0.8181203981286069}-{'f1_val': 0.4017507627824197, 'auprc': 0.8803610382960612, 'loss_val': 0.8235510875107449, 'psi': 0.5931948729878763}
[S4] START round=10 head_norm_before_train=1.049513 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.518248 metrics={'f1_val': 0.9472697853078189, 'auprc': 0.9327101669122551, 'loss_val': 0.4169082468718261, 'psi': 0.9414459379495933}-{'f1_val': 0.7706030086250444, 'auprc': 0.94235757925207, 'loss_val': 0.42234655792968506, 'psi': 0.8393048368758547}
[S5] START round=10 head_norm_before_train=1.005304 cos_to_last_merge=0.9938 (last merge round=7)
[S5] round=10 local utility u=0.059336 metrics={'f1_val': 0.4181926743009027, 'auprc': 0.7772635081952362, 'loss_val': 0.8902680651046252, 'psi': 0.5618210078586361}-{'f1_val': 0.41762898496828804, 'auprc': 0.7737937732674353, 'loss_val': 0.9951488654444784, 'psi': 0.560094900287947}
[S6] START round=10 head_norm_before_train=1.618459 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.6327711611544236, 'auprc': 0.7867166921856769, 'loss_val': 0.4864777636309639, 'psi': 0.6943493735669248}-{'f1_val': 0.9607559733223235, 'auprc': 0.9598106090335011, 'loss_val': 0.2547226954017218, 'psi': 0.9603778276067946}
[S7] START round=10 head_norm_before_train=0.912889 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.6434963350573719, 'loss_val': 1.0113714511141916, 'psi': 0.5074980136820129}-{'f1_val': 0.41703542715461484, 'auprc': 0.7634931465572962, 'loss_val': 1.0361639490938828, 'psi': 0.5556185149156874}
[S8] START round=10 head_norm_before_train=0.742058 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.9917725281076084, 'auprc': 0.9881861626242372, 'loss_val': 0.3699511754563601, 'psi': 0.9903379819142599}-{'f1_val': 0.9934667705418724, 'auprc': 0.9971567246543862, 'loss_val': 0.22291884326237332, 'psi': 0.9949427521868779}
[S9] START round=10 head_norm_before_train=1.435445 (no previous merge yet)
[S9] round=10 local utility u=0.029526 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9986214556539867, 'loss_val': 0.25904042398098304, 'psi': 0.8203286386397978}-{'f1_val': 0.7015406642019387, 'auprc': 0.999124269335582, 'loss_val': 0.32004453331956817, 'psi': 0.820574106255396}
[S10] START round=10 head_norm_before_train=1.316929 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.647327 metrics={'f1_val': 0.9945588208961169, 'auprc': 0.9920664893577297, 'loss_val': 0.3205960565979989, 'psi': 0.993561888280762}-{'f1_val': 0.784303501945344, 'auprc': 0.9937389889446003, 'loss_val': 0.358736063862562, 'psi': 0.8680776967450465}
[S11] START round=10 head_norm_before_train=1.499892 (no previous merge yet)
[S11] round=10 local utility u=0.371003 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9970914000145005, 'loss_val': 0.39172586478149385, 'psi': 0.819891923002679}-{'f1_val': 0.5971558514062655, 'auprc': 0.9960242438249927, 'loss_val': 0.502912110187545, 'psi': 0.7567032083737564}
[S13] START round=10 head_norm_before_train=1.550519 (no previous merge yet)
[S13] round=10 local utility u=0.272257 metrics={'f1_val': 0.6635368724532975, 'auprc': 0.733826304491295, 'loss_val': 0.4460866754775884, 'psi': 0.6916526452684966}-{'f1_val': 0.6110164210386745, 'auprc': 0.6987774198622516, 'loss_val': 0.5703304631525892, 'psi': 0.6461208205681053}
[S14] START round=10 head_norm_before_train=1.356466 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.355215 metrics={'f1_val': 0.6167271757122349, 'auprc': 0.9952855497807308, 'loss_val': 0.6228110379021197, 'psi': 0.7681505253396332}-{'f1_val': 0.5188092559561256, 'auprc': 0.985062062673995, 'loss_val': 0.7150623912438755, 'psi': 0.7053103786432733}
[S15] START round=10 head_norm_before_train=1.736748 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6980633928433543, 'auprc': 0.7913990338651721, 'loss_val': 0.6213102697174475, 'psi': 0.7353976492520815}-{'f1_val': 0.7384554285375154, 'auprc': 0.9796730293126262, 'loss_val': 0.20407237584436846, 'psi': 0.8349424688475597}
[S16] START round=10 head_norm_before_train=1.086171 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.175696 metrics={'f1_val': 0.38502064296936256, 'auprc': 0.638847661279902, 'loss_val': 1.1265074047268164, 'psi': 0.4865514502935783}-{'f1_val': 0.3112061526472954, 'auprc': 0.6885243554920507, 'loss_val': 1.1840421946999797, 'psi': 0.46213343378519756}
[S17] START round=10 head_norm_before_train=1.535744 (no previous merge yet)
[S17] round=10 local utility u=0.013328 metrics={'f1_val': 0.39194328393368116, 'auprc': 0.9368616955585687, 'loss_val': 0.6241613623270402, 'psi': 0.6099106485836362}-{'f1_val': 0.39192929799195303, 'auprc': 0.9376025016417893, 'loss_val': 0.6529548891137419, 'psi': 0.6101985794518876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38416
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38407
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.562)
[S14] not sending this round → trigger blocked (psi=0.768)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.487)
[S9] not sending this round → trigger blocked (psi=0.820)
[S11] not sending this round → trigger blocked (psi=0.820)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.7880
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=-0.0559
[S6] DROPPED delta from S3 (cos=-0.0559 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=-0.0941
[S16] DROPPED delta from S13 (cos=-0.0941 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.610)
[S5] ⇄ pheromone p=0.270 → S3@127.0.0.1:38403
[S10] ⇄ pheromone p=0.448 → S7@127.0.0.1:38408
[S14] ⇄ pheromone p=0.394 → S13@127.0.0.1:38413
[S15] ⇄ pheromone p=0.282 → S7@127.0.0.1:38408
[S7] ⇄ pheromone p=0.250 → S8@127.0.0.1:38409
[S11] ⇄ pheromone p=0.420 → S10@127.0.0.1:38411
[S2] ⇄ pheromone p=0.251 → S5@127.0.0.1:38405
[S9] ⇄ pheromone p=0.291 → S3@127.0.0.1:38403
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.9918 head_norm=0.828532
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.405249e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.9512 head_norm=0.914764 delta_norm=0.340525
[S8] aggregate: ROLLBACK (f1_val pre=0.992 post=0.951 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.361 → S16@127.0.0.1:38416
[S6] ⇄ pheromone p=0.362 → S7@127.0.0.1:38408
[S4] ⇄ pheromone p=0.460 → S8@127.0.0.1:38409
[S3] ⇄ pheromone p=0.527 → S6@127.0.0.1:38407
[S13] ⇄ pheromone p=0.418 → S16@127.0.0.1:38416
[S16] ⇄ pheromone p=0.240 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.242 → S14@127.0.0.1:38414
[S2] START round=11 head_norm_before_train=1.363647 cos_to_last_merge=0.8385 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.838
[S2] round=11 local utility u=0.418177 metrics={'f1_val': 0.7014937575602418, 'auprc': 0.7779286115972879, 'loss_val': 0.273061860672418, 'psi': 0.7320676991750602}-{'f1_val': 0.6296048709593386, 'auprc': 0.7376673029713278, 'loss_val': 0.5572985758085507, 'psi': 0.6728298437641342}
[S3] START round=11 head_norm_before_train=1.338294 cos_to_last_merge=0.9984 (last merge round=9)
[S3] round=11 local utility u=0.032762 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9977186269205435, 'loss_val': 0.545832420965766, 'psi': 0.8191356329243683}-{'f1_val': 0.7000757262075916, 'auprc': 0.9951874060101298, 'loss_val': 0.6037359091041755, 'psi': 0.8181203981286069}
[S4] START round=11 head_norm_before_train=1.104099 cos_to_last_merge=0.9985 (last merge round=9)
[S4] round=11 local utility u=0.050547 metrics={'f1_val': 0.9480128801972588, 'auprc': 0.9389671997196504, 'loss_val': 0.3390433178994394, 'psi': 0.9443946080062153}-{'f1_val': 0.9472697853078189, 'auprc': 0.9327101669122551, 'loss_val': 0.4169082468718261, 'psi': 0.9414459379495933}
[S5] START round=11 head_norm_before_train=1.038453 cos_to_last_merge=0.9860 (last merge round=7)
[S5] round=11 local utility u=0.823944 metrics={'f1_val': 0.6669091329046546, 'auprc': 0.7945113770636305, 'loss_val': 0.786423377970909, 'psi': 0.7179500305682449}-{'f1_val': 0.4181926743009027, 'auprc': 0.7772635081952362, 'loss_val': 0.8902680651046252, 'psi': 0.5618210078586361}
[S6] START round=11 head_norm_before_train=1.640047 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.619996969477369, 'auprc': 0.7866368701967319, 'loss_val': 0.7016530032576049, 'psi': 0.6866529297651142}-{'f1_val': 0.6327711611544236, 'auprc': 0.7867166921856769, 'loss_val': 0.4864777636309639, 'psi': 0.6943493735669248}
[S7] START round=11 head_norm_before_train=0.935075 cos_to_last_merge=0.9953 (last merge round=9)
[S7] round=11 local utility u=0.144338 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7096454522453167, 'loss_val': 0.9204090079425622, 'psi': 0.5338842517647407}-{'f1_val': 0.41683246609844005, 'auprc': 0.6434963350573719, 'loss_val': 1.0113714511141916, 'psi': 0.5074980136820129}
[S8] START round=11 head_norm_before_train=0.914764 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.091393 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.9978615378241252, 'loss_val': 0.22795705436612498, 'psi': 0.9953846454707189}-{'f1_val': 0.9917725281076084, 'auprc': 0.9881861626242372, 'loss_val': 0.3699511754563601, 'psi': 0.9903379819142599}
[S9] START round=11 head_norm_before_train=1.488433 (no previous merge yet)
[S9] round=11 local utility u=0.030728 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9984846280471532, 'loss_val': 0.19567242003653787, 'psi': 0.8201237996828724}-{'f1_val': 0.7014667606303384, 'auprc': 0.9986214556539867, 'loss_val': 0.25904042398098304, 'psi': 0.8203286386397978}
[S10] START round=11 head_norm_before_train=1.375146 cos_to_last_merge=0.9957 (last merge round=9)
[S10] round=11 local utility u=0.043150 metrics={'f1_val': 0.9945358580698285, 'auprc': 0.9920528651626441, 'loss_val': 0.23411756903847084, 'psi': 0.9935426609069548}-{'f1_val': 0.9945588208961169, 'auprc': 0.9920664893577297, 'loss_val': 0.3205960565979989, 'psi': 0.993561888280762}
[S11] START round=11 head_norm_before_train=1.532691 (no previous merge yet)
[S11] round=11 local utility u=0.039747 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9960893674844253, 'loss_val': 0.30922477042426705, 'psi': 0.819491109990649}-{'f1_val': 0.7017589383281313, 'auprc': 0.9970914000145005, 'loss_val': 0.39172586478149385, 'psi': 0.819891923002679}
[S13] START round=11 head_norm_before_train=1.579532 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6266864418575779, 'auprc': 0.6521507348258732, 'loss_val': 0.5722490069882801, 'psi': 0.636872159044896}-{'f1_val': 0.6635368724532975, 'auprc': 0.733826304491295, 'loss_val': 0.4460866754775884, 'psi': 0.6916526452684966}
[S14] START round=11 head_norm_before_train=1.392734 cos_to_last_merge=0.9979 (last merge round=9)
[S14] round=11 local utility u=0.334538 metrics={'f1_val': 0.7022370829656733, 'auprc': 0.9971595868957916, 'loss_val': 0.47241745422104237, 'psi': 0.8202060845377206}-{'f1_val': 0.6167271757122349, 'auprc': 0.9952855497807308, 'loss_val': 0.6228110379021197, 'psi': 0.7681505253396332}
[S15] START round=11 head_norm_before_train=1.784816 (no previous merge yet)
[S15] round=11 local utility u=0.866071 metrics={'f1_val': 0.8238532343917775, 'auprc': 0.9723871609313085, 'loss_val': 0.18687219454689316, 'psi': 0.8832668050075898}-{'f1_val': 0.6980633928433543, 'auprc': 0.7913990338651721, 'loss_val': 0.6213102697174475, 'psi': 0.7353976492520815}
[S16] START round=11 head_norm_before_train=1.118839 cos_to_last_merge=0.9975 (last merge round=9)
[S16] round=11 local utility u=0.413400 metrics={'f1_val': 0.48437064434570387, 'auprc': 0.676525838140796, 'loss_val': 1.0088427903258819, 'psi': 0.5612327218637407}-{'f1_val': 0.38502064296936256, 'auprc': 0.638847661279902, 'loss_val': 1.1265074047268164, 'psi': 0.4865514502935783}
[S17] START round=11 head_norm_before_train=1.555419 (no previous merge yet)
[S17] round=11 local utility u=0.386506 metrics={'f1_val': 0.5167082675412698, 'auprc': 0.9282665740196169, 'loss_val': 0.5739541026066987, 'psi': 0.6813315901326087}-{'f1_val': 0.39194328393368116, 'auprc': 0.9368616955585687, 'loss_val': 0.6241613623270402, 'psi': 0.6099106485836362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:38413
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38405
[S3] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.944)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1794) from S10
[S7] cosine check vs S10: cos=0.5468
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.9414
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.9552
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=0.9199
[S10] RECEIVED delta(kind=head bytes=1800) from S11
[S10] cosine check vs S11: cos=0.9279
[S13] RECEIVED delta(kind=head bytes=1794) from S14
[S13] cosine check vs S14: cos=-0.0305
[S13] DROPPED delta from S14 (cos=-0.0305 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.7270
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=-0.0755
[S3] DROPPED delta from S5 (cos=-0.0755 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=0.2786
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.9603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] cosine check vs S17: cos=0.9485
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.9480 head_norm=1.168746
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.987003e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.9540 head_norm=1.142695 delta_norm=0.198700
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7001 head_norm=1.371203
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.199620e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7003 head_norm=1.438427 delta_norm=0.219962
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=0.971518
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.825142e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=1.051306 delta_norm=0.282514
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.7022 head_norm=1.432035
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.518058e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.9979 head_norm=1.484886 delta_norm=0.251806
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4844 head_norm=1.150869
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.743495e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4520 head_norm=1.075771 delta_norm=0.174350
[S16] aggregate: ROLLBACK (f1_val pre=0.484 post=0.452 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.9945 head_norm=1.437896
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.931685e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.9930 head_norm=1.477433 delta_norm=0.293168
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.9937 head_norm=1.025116
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.999733e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9934 head_norm=0.798365 delta_norm=0.599973
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.6669 head_norm=1.071520
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.942547e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.6635 head_norm=1.210164 delta_norm=0.294255
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.397860 cos_to_last_merge=0.8341 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.834
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7594734035325146, 'loss_val': 0.2709325941696008, 'psi': 0.7246844511513133}-{'f1_val': 0.7014937575602418, 'auprc': 0.7779286115972879, 'loss_val': 0.273061860672418, 'psi': 0.7320676991750602}
[S3] START round=12 head_norm_before_train=1.438427 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.6940226410609599, 'auprc': 0.999810590877001, 'loss_val': 0.5479925263957492, 'psi': 0.8163378209873764}-{'f1_val': 0.7000803035935849, 'auprc': 0.9977186269205435, 'loss_val': 0.545832420965766, 'psi': 0.8191356329243683}
[S4] START round=12 head_norm_before_train=1.142695 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.004886 metrics={'f1_val': 0.941078634637618, 'auprc': 0.9606652221800036, 'loss_val': 0.352759172343447, 'psi': 0.9489132696545723}-{'f1_val': 0.9480128801972588, 'auprc': 0.9389671997196504, 'loss_val': 0.3390433178994394, 'psi': 0.9443946080062153}
[S5] START round=12 head_norm_before_train=1.210164 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.185724 metrics={'f1_val': 0.7141374876955867, 'auprc': 0.7931009721367512, 'loss_val': 0.6941152648298704, 'psi': 0.7457228814720525}-{'f1_val': 0.6669091329046546, 'auprc': 0.7945113770636305, 'loss_val': 0.786423377970909, 'psi': 0.7179500305682449}
[S6] START round=12 head_norm_before_train=1.658604 (no previous merge yet)
[S6] round=12 local utility u=0.663535 metrics={'f1_val': 0.7817599542513749, 'auprc': 0.8128290463068617, 'loss_val': 0.42373688070958193, 'psi': 0.7941875910735696}-{'f1_val': 0.619996969477369, 'auprc': 0.7866368701967319, 'loss_val': 0.7016530032576049, 'psi': 0.6866529297651142}
[S7] START round=12 head_norm_before_train=1.051306 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6295196635881022, 'loss_val': 0.919699741174211, 'psi': 0.5018339363018549}-{'f1_val': 0.41671011811102343, 'auprc': 0.7096454522453167, 'loss_val': 0.9204090079425622, 'psi': 0.5338842517647407}
[S8] START round=12 head_norm_before_train=0.798365 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9885830257911148, 'loss_val': 0.28875902256678426, 'psi': 0.9917738035015548}-{'f1_val': 0.9937333839017813, 'auprc': 0.9978615378241252, 'loss_val': 0.22795705436612498, 'psi': 0.9953846454707189}
[S9] START round=12 head_norm_before_train=1.534507 (no previous merge yet)
[S9] round=12 local utility u=0.876949 metrics={'f1_val': 0.9873949972964658, 'auprc': 0.9980923654526926, 'loss_val': 0.15766718416681128, 'psi': 0.9916739445589565}-{'f1_val': 0.7012165807733519, 'auprc': 0.9984846280471532, 'loss_val': 0.19567242003653787, 'psi': 0.8201237996828724}
[S10] START round=12 head_norm_before_train=1.477433 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.012066 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9951785514787687, 'loss_val': 0.2098673288806674, 'psi': 0.9938433666093025}-{'f1_val': 0.9945358580698285, 'auprc': 0.9920528651626441, 'loss_val': 0.23411756903847084, 'psi': 0.9935426609069548}
[S11] START round=12 head_norm_before_train=1.571612 (no previous merge yet)
[S11] round=12 local utility u=0.029462 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9963853760483161, 'loss_val': 0.25263910857072347, 'psi': 0.8197546159868656}-{'f1_val': 0.7017589383281313, 'auprc': 0.9960893674844253, 'loss_val': 0.30922477042426705, 'psi': 0.819491109990649}
[S13] START round=12 head_norm_before_train=1.605054 (no previous merge yet)
[S13] round=12 local utility u=0.079173 metrics={'f1_val': 0.6187987589205186, 'auprc': 0.7321921672226926, 'loss_val': 0.6067020874747007, 'psi': 0.6641561222413882}-{'f1_val': 0.6266864418575779, 'auprc': 0.6521507348258732, 'loss_val': 0.5722490069882801, 'psi': 0.636872159044896}
[S14] START round=12 head_norm_before_train=1.484886 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.932380 metrics={'f1_val': 0.9983274240503504, 'auprc': 0.9971587176909659, 'loss_val': 0.38419722843558596, 'psi': 0.9978599415065965}-{'f1_val': 0.7022370829656733, 'auprc': 0.9971595868957916, 'loss_val': 0.47241745422104237, 'psi': 0.8202060845377206}
[S15] START round=12 head_norm_before_train=1.822095 (no previous merge yet)
[S15] round=12 local utility u=0.586461 metrics={'f1_val': 0.9909316893271702, 'auprc': 0.992729571691785, 'loss_val': 0.07744810873038638, 'psi': 0.9916508422730161}-{'f1_val': 0.8238532343917775, 'auprc': 0.9723871609313085, 'loss_val': 0.18687219454689316, 'psi': 0.8832668050075898}
[S16] START round=12 head_norm_before_train=1.075771 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.40999617284241346, 'auprc': 0.7286269616048003, 'loss_val': 0.98094333645303, 'psi': 0.5374484883473682}-{'f1_val': 0.48437064434570387, 'auprc': 0.676525838140796, 'loss_val': 1.0088427903258819, 'psi': 0.5612327218637407}
[S17] START round=12 head_norm_before_train=1.576661 (no previous merge yet)
[S17] round=12 local utility u=0.397745 metrics={'f1_val': 0.6340568249845268, 'auprc': 0.9433062090334707, 'loss_val': 0.5276742847265091, 'psi': 0.7577565786041044}-{'f1_val': 0.5167082675412698, 'auprc': 0.9282665740196169, 'loss_val': 0.5739541026066987, 'psi': 0.6813315901326087}
[S15] not sending this round → trigger blocked (psi=0.992)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:38411
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:38403
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:38413
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.5813
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] cosine check vs S11: cos=0.9704
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=-0.0850
[S7] DROPPED delta from S6 (cos=-0.0850 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=-0.0580
[S16] DROPPED delta from S13 (cos=-0.0580 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1806) from S14
[S13] cosine check vs S14: cos=-0.0231
[S13] DROPPED delta from S14 (cos=-0.0231 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.9848
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0915
[S3] DROPPED delta from S5 (cos=-0.0915 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.7066
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9789
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9939 head_norm=0.912432
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.233138e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9931 head_norm=0.973591 delta_norm=0.423314
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6940 head_norm=1.462697
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.438400e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7001 head_norm=1.512887 delta_norm=0.143840
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4167 head_norm=1.080276
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.298985e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4046 head_norm=1.165307 delta_norm=0.629898
[S7] aggregate: ROLLBACK (f1_val pre=0.417 post=0.405 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.9930 head_norm=1.530499
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.953311e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9930 head_norm=1.559872 delta_norm=0.195331
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9983 head_norm=1.518430
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.667774e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9979 head_norm=1.555316 delta_norm=0.166777
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.422742 cos_to_last_merge=0.8297 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.830
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6995078406626564, 'auprc': 0.76627560400613, 'loss_val': 0.30017033142874083, 'psi': 0.7262149460000459}-{'f1_val': 0.7014918162305126, 'auprc': 0.7594734035325146, 'loss_val': 0.2709325941696008, 'psi': 0.7246844511513133}
[S3] START round=13 head_norm_before_train=1.512887 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.042619 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9947448523753006, 'loss_val': 0.4839038655305649, 'psi': 0.8179461231062712}-{'f1_val': 0.6940226410609599, 'auprc': 0.999810590877001, 'loss_val': 0.5479925263957492, 'psi': 0.8163378209873764}
[S4] START round=13 head_norm_before_train=1.192315 cos_to_last_merge=0.9986 (last merge round=11)
[S4] round=13 local utility u=0.058342 metrics={'f1_val': 0.9459100488609287, 'auprc': 0.9675904722400605, 'loss_val': 0.2858401769727452, 'psi': 0.9545822182125814}-{'f1_val': 0.941078634637618, 'auprc': 0.9606652221800036, 'loss_val': 0.352759172343447, 'psi': 0.9489132696545723}
[S5] START round=13 head_norm_before_train=1.235922 cos_to_last_merge=0.9992 (last merge round=11)
[S5] round=13 local utility u=0.021035 metrics={'f1_val': 0.7144008589453258, 'auprc': 0.7928195498886637, 'loss_val': 0.6527815542897869, 'psi': 0.745768335322661}-{'f1_val': 0.7141374876955867, 'auprc': 0.7931009721367512, 'loss_val': 0.6941152648298704, 'psi': 0.7457228814720525}
[S6] START round=13 head_norm_before_train=1.676268 (no previous merge yet)
[S6] round=13 local utility u=0.914033 metrics={'f1_val': 0.9600130709894976, 'auprc': 0.9773692331196329, 'loss_val': 0.1588100382904683, 'psi': 0.9669555358415517}-{'f1_val': 0.7817599542513749, 'auprc': 0.8128290463068617, 'loss_val': 0.42373688070958193, 'psi': 0.7941875910735696}
[S7] START round=13 head_norm_before_train=1.165307 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.40458305520114235, 'auprc': 0.5977193597766235, 'loss_val': 0.9232846723903411, 'psi': 0.4818375770313348}-{'f1_val': 0.41671011811102343, 'auprc': 0.6295196635881022, 'loss_val': 0.919699741174211, 'psi': 0.5018339363018549}
[S8] START round=13 head_norm_before_train=0.973591 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9384710806131618, 'auprc': 0.9835627713197915, 'loss_val': 0.19479951122268735, 'psi': 0.9565077568958136}-{'f1_val': 0.9939009886418481, 'auprc': 0.9885830257911148, 'loss_val': 0.28875902256678426, 'psi': 0.9917738035015548}
[S9] START round=13 head_norm_before_train=1.574659 (no previous merge yet)
[S9] round=13 local utility u=0.014115 metrics={'f1_val': 0.9869679892487694, 'auprc': 0.9984734227507077, 'loss_val': 0.1280180706998074, 'psi': 0.9915701626495447}-{'f1_val': 0.9873949972964658, 'auprc': 0.9980923654526926, 'loss_val': 0.15766718416681128, 'psi': 0.9916739445589565}
[S10] START round=13 head_norm_before_train=1.559872 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000299 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9921756385045885, 'loss_val': 0.20867953992072588, 'psi': 0.9934840944288882}-{'f1_val': 0.9929532433629917, 'auprc': 0.9951785514787687, 'loss_val': 0.2098673288806674, 'psi': 0.9938433666093025}
[S11] START round=13 head_norm_before_train=1.612539 (no previous merge yet)
[S11] round=13 local utility u=0.790139 metrics={'f1_val': 0.955923326508306, 'auprc': 0.9974249330475472, 'loss_val': 0.19901462371301257, 'psi': 0.9725239691240024}-{'f1_val': 0.7020007759458987, 'auprc': 0.9963853760483161, 'loss_val': 0.25263910857072347, 'psi': 0.8197546159868656}
[S13] START round=13 head_norm_before_train=1.620794 (no previous merge yet)
[S13] round=13 local utility u=0.270972 metrics={'f1_val': 0.6765516669787701, 'auprc': 0.7273814998534587, 'loss_val': 0.39684307868000546, 'psi': 0.6968836001286456}-{'f1_val': 0.6187987589205186, 'auprc': 0.7321921672226926, 'loss_val': 0.6067020874747007, 'psi': 0.6641561222413882}
[S14] START round=13 head_norm_before_train=1.555316 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.029420 metrics={'f1_val': 0.9947601438263527, 'auprc': 0.9971593066262856, 'loss_val': 0.30395443037940684, 'psi': 0.9957198089463258}-{'f1_val': 0.9983274240503504, 'auprc': 0.9971587176909659, 'loss_val': 0.38419722843558596, 'psi': 0.9978599415065965}
[S15] START round=13 head_norm_before_train=1.848852 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.9654053372845738, 'auprc': 0.9898080727420587, 'loss_val': 0.09612391351218362, 'psi': 0.9751664314675678}-{'f1_val': 0.9909316893271702, 'auprc': 0.992729571691785, 'loss_val': 0.07744810873038638, 'psi': 0.9916508422730161}
[S16] START round=13 head_norm_before_train=1.108194 cos_to_last_merge=0.9988 (last merge round=11)
[S16] round=13 local utility u=0.456798 metrics={'f1_val': 0.5232821098043482, 'auprc': 0.7716785162015393, 'loss_val': 0.8762173242822252, 'psi': 0.6226406723632247}-{'f1_val': 0.40999617284241346, 'auprc': 0.7286269616048003, 'loss_val': 0.98094333645303, 'psi': 0.5374484883473682}
[S17] START round=13 head_norm_before_train=1.608731 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.5475381741960916, 'auprc': 0.7752220459839514, 'loss_val': 0.5926110249719391, 'psi': 0.6386117229112356}-{'f1_val': 0.6340568249845268, 'auprc': 0.9433062090334707, 'loss_val': 0.5276742847265091, 'psi': 0.7577565786041044}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:38404
[S9] not sending this round → trigger blocked (psi=0.992)
[S11] not sending this round → trigger blocked (psi=0.973)
[S6] not sending this round → trigger blocked (psi=0.967)
[S10] not sending this round → trigger blocked (psi=0.993)
[S13] not sending this round → trigger blocked (psi=0.697)
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] not sending this round → trigger blocked (psi=0.746)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38407
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.996)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.9688
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=-0.0668
[S6] DROPPED delta from S3 (cos=-0.0668 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.9459 head_norm=1.233959
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.549292e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.9490 head_norm=1.180661 delta_norm=0.154929
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.443215 cos_to_last_merge=0.8270 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=14 local utility u=0.077126 metrics={'f1_val': 0.711499438416324, 'auprc': 0.787594805584771, 'loss_val': 0.28182484468519386, 'psi': 0.7419375852837028}-{'f1_val': 0.6995078406626564, 'auprc': 0.76627560400613, 'loss_val': 0.30017033142874083, 'psi': 0.7262149460000459}
[S3] START round=14 head_norm_before_train=1.535742 cos_to_last_merge=0.9995 (last merge round=12)
[S3] round=14 local utility u=0.018650 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9923871949529885, 'loss_val': 0.4395317160791025, 'psi': 0.8170030601373464}-{'f1_val': 0.7000803035935849, 'auprc': 0.9947448523753006, 'loss_val': 0.4839038655305649, 'psi': 0.8179461231062712}
[S4] START round=14 head_norm_before_train=1.180661 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.017852 metrics={'f1_val': 0.9501713390595509, 'auprc': 0.9572971763422541, 'loss_val': 0.24482305120538503, 'psi': 0.9530216739726322}-{'f1_val': 0.9459100488609287, 'auprc': 0.9675904722400605, 'loss_val': 0.2858401769727452, 'psi': 0.9545822182125814}
[S5] START round=14 head_norm_before_train=1.260424 cos_to_last_merge=0.9976 (last merge round=11)
[S5] round=14 local utility u=0.145324 metrics={'f1_val': 0.7005708485915159, 'auprc': 0.8949759515956004, 'loss_val': 0.5856224676537988, 'psi': 0.7783328897931496}-{'f1_val': 0.7144008589453258, 'auprc': 0.7928195498886637, 'loss_val': 0.6527815542897869, 'psi': 0.745768335322661}
[S6] START round=14 head_norm_before_train=1.698597 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.7243873979436618, 'auprc': 0.8085116067399511, 'loss_val': 0.6265668548882548, 'psi': 0.7580370814621775}-{'f1_val': 0.9600130709894976, 'auprc': 0.9773692331196329, 'loss_val': 0.1588100382904683, 'psi': 0.9669555358415517}
[S7] START round=14 head_norm_before_train=1.188270 cos_to_last_merge=0.9973 (last merge round=12)
[S7] round=14 local utility u=0.180381 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6682078043535943, 'loss_val': 0.8467500647799071, 'psi': 0.5173091926080517}-{'f1_val': 0.40458305520114235, 'auprc': 0.5977193597766235, 'loss_val': 0.9232846723903411, 'psi': 0.4818375770313348}
[S8] START round=14 head_norm_before_train=1.090541 cos_to_last_merge=0.9949 (last merge round=12)
[S8] round=14 local utility u=0.206101 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.9855502715288275, 'loss_val': 0.11746433986872933, 'psi': 0.990193104555498}-{'f1_val': 0.9384710806131618, 'auprc': 0.9835627713197915, 'loss_val': 0.19479951122268735, 'psi': 0.9565077568958136}
[S9] START round=14 head_norm_before_train=1.610577 (no previous merge yet)
[S9] round=14 local utility u=0.014520 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9984740466094427, 'loss_val': 0.10665546819527587, 'psi': 0.9923380309476455}-{'f1_val': 0.9869679892487694, 'auprc': 0.9984734227507077, 'loss_val': 0.1280180706998074, 'psi': 0.9915701626495447}
[S10] START round=14 head_norm_before_train=1.611097 cos_to_last_merge=0.9980 (last merge round=12)
[S10] round=14 local utility u=0.037644 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9922726173447157, 'loss_val': 0.13867050590686553, 'psi': 0.9940217503495111}-{'f1_val': 0.9943563983784213, 'auprc': 0.9921756385045885, 'loss_val': 0.20867953992072588, 'psi': 0.9934840944288882}
[S11] START round=14 head_norm_before_train=1.654819 (no previous merge yet)
[S11] round=14 local utility u=0.135361 metrics={'f1_val': 0.9973751529959437, 'auprc': 0.9964298731969066, 'loss_val': 0.17401806200567255, 'psi': 0.9969970410763289}-{'f1_val': 0.955923326508306, 'auprc': 0.9974249330475472, 'loss_val': 0.19901462371301257, 'psi': 0.9725239691240024}
[S13] START round=14 head_norm_before_train=1.644015 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6029459299594165, 'auprc': 0.7602188607797514, 'loss_val': 0.7100832042323831, 'psi': 0.6658551022875505}-{'f1_val': 0.6765516669787701, 'auprc': 0.7273814998534587, 'loss_val': 0.39684307868000546, 'psi': 0.6968836001286456}
[S14] START round=14 head_norm_before_train=1.591823 cos_to_last_merge=0.9987 (last merge round=12)
[S14] round=14 local utility u=0.046374 metrics={'f1_val': 0.995722037616147, 'auprc': 0.9956405311475903, 'loss_val': 0.21242124367678916, 'psi': 0.9956894350287242}-{'f1_val': 0.9947601438263527, 'auprc': 0.9971593066262856, 'loss_val': 0.30395443037940684, 'psi': 0.9957198089463258}
[S15] START round=14 head_norm_before_train=1.871794 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6968887903990659, 'auprc': 0.7994409141252877, 'loss_val': 0.6462154127496382, 'psi': 0.7379096398895546}-{'f1_val': 0.9654053372845738, 'auprc': 0.9898080727420587, 'loss_val': 0.09612391351218362, 'psi': 0.9751664314675678}
[S16] START round=14 head_norm_before_train=1.145980 cos_to_last_merge=0.9952 (last merge round=11)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.42918237353408284, 'auprc': 0.7837396167465326, 'loss_val': 0.8246848368864111, 'psi': 0.5710052708190627}-{'f1_val': 0.5232821098043482, 'auprc': 0.7716785162015393, 'loss_val': 0.8762173242822252, 'psi': 0.6226406723632247}
[S17] START round=14 head_norm_before_train=1.643364 (no previous merge yet)
[S17] round=14 local utility u=0.754844 metrics={'f1_val': 0.7367051561292256, 'auprc': 0.8694276960821314, 'loss_val': 0.5005420625458065, 'psi': 0.7897941721103879}-{'f1_val': 0.5475381741960916, 'auprc': 0.7752220459839514, 'loss_val': 0.5926110249719391, 'psi': 0.6386117229112356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:38416
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38405
[S3] not sending this round → trigger blocked (psi=0.817)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:38403
[S2] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=-0.0956
[S3] DROPPED delta from S5 (cos=-0.0956 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.9429
[S8] RECEIVED delta(kind=head bytes=1792) from S7
[S8] cosine check vs S7: cos=0.3144
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.9670
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=0.9735
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=0.8913
[S16] RECEIVED delta(kind=head bytes=1793) from S8
[S16] cosine check vs S8: cos=0.9572
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=-0.0215
[S13] DROPPED delta from S14 (cos=-0.0215 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] cosine check vs S9: cos=0.9878
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.9768
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7001 head_norm=1.560793
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.317504e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7002 head_norm=1.597329 delta_norm=0.131750
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9952 head_norm=1.661864
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.940170e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9950 head_norm=1.667801 delta_norm=0.194017
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7006 head_norm=1.283874
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.982096e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.363210 delta_norm=0.198210
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9933 head_norm=1.167176
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.147256e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9933 head_norm=0.997458 delta_norm=0.314726
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9957 head_norm=1.629057
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.827715e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9947 head_norm=1.654803 delta_norm=0.182771
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4167 head_norm=1.215024
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.995622e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4587 head_norm=1.399781 delta_norm=0.399562
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4292 head_norm=1.182626
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.720968e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.4353 head_norm=1.162254 delta_norm=0.172097
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.465238 cos_to_last_merge=0.8251 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=15 local utility u=0.574854 metrics={'f1_val': 0.8892930360885223, 'auprc': 0.8209980314631407, 'loss_val': 0.29908835719465865, 'psi': 0.8619750342383696}-{'f1_val': 0.711499438416324, 'auprc': 0.787594805584771, 'loss_val': 0.28182484468519386, 'psi': 0.7419375852837028}
[S3] START round=15 head_norm_before_train=1.597329 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.035385 metrics={'f1_val': 0.7006684434760702, 'auprc': 0.9949344834446802, 'loss_val': 0.3799317076811617, 'psi': 0.8183748594635142}-{'f1_val': 0.7000803035935849, 'auprc': 0.9923871949529885, 'loss_val': 0.4395317160791025, 'psi': 0.8170030601373464}
[S4] START round=15 head_norm_before_train=1.222901 cos_to_last_merge=0.9991 (last merge round=13)
[S4] round=15 local utility u=0.015790 metrics={'f1_val': 0.9432947352051666, 'auprc': 0.9762023255575675, 'loss_val': 0.22869821779354638, 'psi': 0.956457771346127}-{'f1_val': 0.9501713390595509, 'auprc': 0.9572971763422541, 'loss_val': 0.24482305120538503, 'psi': 0.9530216739726322}
[S5] START round=15 head_norm_before_train=1.363210 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7143347548915031, 'auprc': 0.791743221271011, 'loss_val': 0.5324759214005022, 'psi': 0.7452981414433063}-{'f1_val': 0.7005708485915159, 'auprc': 0.8949759515956004, 'loss_val': 0.5856224676537988, 'psi': 0.7783328897931496}
[S6] START round=15 head_norm_before_train=1.715960 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.597687309212426, 'auprc': 0.7970009589036416, 'loss_val': 0.7711342148809428, 'psi': 0.6774127690889122}-{'f1_val': 0.7243873979436618, 'auprc': 0.8085116067399511, 'loss_val': 0.6265668548882548, 'psi': 0.7580370814621775}
[S7] START round=15 head_norm_before_train=1.399781 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.812661 metrics={'f1_val': 0.6431573955549187, 'auprc': 0.7478252838022992, 'loss_val': 0.818964027240266, 'psi': 0.6850245508538708}-{'f1_val': 0.41671011811102343, 'auprc': 0.6682078043535943, 'loss_val': 0.8467500647799071, 'psi': 0.5173091926080517}
[S8] START round=15 head_norm_before_train=0.997458 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.991490485949629, 'auprc': 0.9979316108915937, 'loss_val': 0.14618716441858612, 'psi': 0.9940669359264148}-{'f1_val': 0.9932883265732785, 'auprc': 0.9855502715288275, 'loss_val': 0.11746433986872933, 'psi': 0.990193104555498}
[S9] START round=15 head_norm_before_train=1.643643 (no previous merge yet)
[S9] round=15 local utility u=0.036953 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984653925908377, 'loss_val': 0.07820023093827143, 'psi': 0.9968821880548463}-{'f1_val': 0.9882473538397808, 'auprc': 0.9984740466094427, 'loss_val': 0.10665546819527587, 'psi': 0.9923380309476455}
[S10] START round=15 head_norm_before_train=1.667801 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.003210 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9962128900508236, 'loss_val': 0.12935071199692794, 'psi': 0.9941258351884539}-{'f1_val': 0.9951878390193748, 'auprc': 0.9922726173447157, 'loss_val': 0.13867050590686553, 'psi': 0.9940217503495111}
[S11] START round=15 head_norm_before_train=1.696058 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.995580993089167, 'loss_val': 0.17225431068600205, 'psi': 0.9962637928556064}-{'f1_val': 0.9973751529959437, 'auprc': 0.9964298731969066, 'loss_val': 0.17401806200567255, 'psi': 0.9969970410763289}
[S13] START round=15 head_norm_before_train=1.657854 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.574557582658916, 'auprc': 0.8174467414448846, 'loss_val': 0.9067458841168793, 'psi': 0.6717132461733035}-{'f1_val': 0.6029459299594165, 'auprc': 0.7602188607797514, 'loss_val': 0.7100832042323831, 'psi': 0.6658551022875505}
[S14] START round=15 head_norm_before_train=1.654803 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.018350 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9963375232731362, 'loss_val': 0.191853428844262, 'psi': 0.9973724292184623}-{'f1_val': 0.995722037616147, 'auprc': 0.9956405311475903, 'loss_val': 0.21242124367678916, 'psi': 0.9956894350287242}
[S15] START round=15 head_norm_before_train=1.890548 (no previous merge yet)
[S15] round=15 local utility u=1.000000 metrics={'f1_val': 0.9555477391488824, 'auprc': 0.9893426925026176, 'loss_val': 0.10570902534144945, 'psi': 0.9690657204903765}-{'f1_val': 0.6968887903990659, 'auprc': 0.7994409141252877, 'loss_val': 0.6462154127496382, 'psi': 0.7379096398895546}
[S16] START round=15 head_norm_before_train=1.162254 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.324911 metrics={'f1_val': 0.5281526072703877, 'auprc': 0.8129522409305188, 'loss_val': 0.8563224805496221, 'psi': 0.6420724607344401}-{'f1_val': 0.42918237353408284, 'auprc': 0.7837396167465326, 'loss_val': 0.8246848368864111, 'psi': 0.5710052708190627}
[S17] START round=15 head_norm_before_train=1.699921 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.5773418623502804, 'auprc': 0.8572753516150575, 'loss_val': 0.6856355980435971, 'psi': 0.6893152580561912}-{'f1_val': 0.7367051561292256, 'auprc': 0.8694276960821314, 'loss_val': 0.5005420625458065, 'psi': 0.7897941721103879}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38407
[S14] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → trigger blocked (psi=0.956)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.685)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.862)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:38404
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=-0.0697
[S6] DROPPED delta from S3 (cos=-0.0697 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.2168
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.9669
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.201 → S3@127.0.0.1:38403
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6432 head_norm=1.417157
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.058996e+00
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.6212 head_norm=1.307077 delta_norm=1.058996
[S7] aggregate: ROLLBACK (f1_val pre=0.643 post=0.621 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.285 → S8@127.0.0.1:38409
[S13] ⇄ pheromone p=0.180 → S16@127.0.0.1:38416
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9433 head_norm=1.285416
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.656658e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9439 head_norm=1.230820 delta_norm=0.165666
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.169 → S8@127.0.0.1:38409
[S14] ⇄ pheromone p=0.267 → S13@127.0.0.1:38413
[S2] ⇄ pheromone p=0.244 → S5@127.0.0.1:38405
[S8] ⇄ pheromone p=0.159 → S16@127.0.0.1:38416
[S6] ⇄ pheromone p=0.303 → S7@127.0.0.1:38408
[S11] ⇄ pheromone p=0.267 → S10@127.0.0.1:38411
[S10] ⇄ pheromone p=0.158 → S7@127.0.0.1:38408
[S9] ⇄ pheromone p=0.199 → S3@127.0.0.1:38403
[S15] ⇄ pheromone p=0.423 → S7@127.0.0.1:38408
[S3] ⇄ pheromone p=0.191 → S6@127.0.0.1:38407
[S16] ⇄ pheromone p=0.236 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.272 → S14@127.0.0.1:38414
[S2] START round=16 head_norm_before_train=1.486706 cos_to_last_merge=0.8251 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.693114131141437, 'auprc': 0.8297600878120164, 'loss_val': 0.3457039946424012, 'psi': 0.7477725138096688}-{'f1_val': 0.8892930360885223, 'auprc': 0.8209980314631407, 'loss_val': 0.29908835719465865, 'psi': 0.8619750342383696}
[S3] START round=16 head_norm_before_train=1.627324 cos_to_last_merge=0.9995 (last merge round=14)
[S3] round=16 local utility u=0.027714 metrics={'f1_val': 0.7020275052927452, 'auprc': 0.9950025814347552, 'loss_val': 0.3328623507426219, 'psi': 0.8192175357495491}-{'f1_val': 0.7006684434760702, 'auprc': 0.9949344834446802, 'loss_val': 0.3799317076811617, 'psi': 0.8183748594635142}
[S4] START round=16 head_norm_before_train=1.230820 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9328398109603796, 'auprc': 0.9710973335221298, 'loss_val': 0.22954691952293652, 'psi': 0.9481428199850797}-{'f1_val': 0.9432947352051666, 'auprc': 0.9762023255575675, 'loss_val': 0.22869821779354638, 'psi': 0.956457771346127}
[S5] START round=16 head_norm_before_train=1.379205 cos_to_last_merge=0.9998 (last merge round=14)
[S5] round=16 local utility u=0.284776 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9779093985677418, 'loss_val': 0.43882934995112316, 'psi': 0.811505252533255}-{'f1_val': 0.7143347548915031, 'auprc': 0.791743221271011, 'loss_val': 0.5324759214005022, 'psi': 0.7452981414433063}
[S6] START round=16 head_norm_before_train=1.730113 (no previous merge yet)
[S6] round=16 local utility u=1.000000 metrics={'f1_val': 0.8237184286582567, 'auprc': 0.968186766887708, 'loss_val': 0.33144428633196704, 'psi': 0.8815057639500372}-{'f1_val': 0.597687309212426, 'auprc': 0.7970009589036416, 'loss_val': 0.7711342148809428, 'psi': 0.6774127690889122}
[S7] START round=16 head_norm_before_train=1.307077 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.3754646530009066, 'auprc': 0.7652354284177152, 'loss_val': 0.9152821746606769, 'psi': 0.53137296316763}-{'f1_val': 0.6431573955549187, 'auprc': 0.7478252838022992, 'loss_val': 0.818964027240266, 'psi': 0.6850245508538708}
[S8] START round=16 head_norm_before_train=1.061785 cos_to_last_merge=0.9985 (last merge round=14)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9931569338135257, 'auprc': 0.9847892850971054, 'loss_val': 0.12047625594076326, 'psi': 0.9898098743269576}-{'f1_val': 0.991490485949629, 'auprc': 0.9979316108915937, 'loss_val': 0.14618716441858612, 'psi': 0.9940669359264148}
[S9] START round=16 head_norm_before_train=1.676836 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9873949972964658, 'auprc': 0.992265131507614, 'loss_val': 0.08535002093708963, 'psi': 0.9893430509809251}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984653925908377, 'loss_val': 0.07820023093827143, 'psi': 0.9968821880548463}
[S10] START round=16 head_norm_before_train=1.720807 cos_to_last_merge=0.9986 (last merge round=14)
[S10] round=16 local utility u=0.017789 metrics={'f1_val': 0.9939177191057856, 'auprc': 0.9924396528320638, 'loss_val': 0.08955166601623415, 'psi': 0.9933264925962969}-{'f1_val': 0.9927344652802075, 'auprc': 0.9962128900508236, 'loss_val': 0.12935071199692794, 'psi': 0.9941258351884539}
[S11] START round=16 head_norm_before_train=1.726152 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.9034598673649913, 'auprc': 0.9966630802911648, 'loss_val': 0.33422857095451897, 'psi': 0.9407411525354608}-{'f1_val': 0.9967189926998994, 'auprc': 0.995580993089167, 'loss_val': 0.17225431068600205, 'psi': 0.9962637928556064}
[S13] START round=16 head_norm_before_train=1.672142 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5673443951181136, 'auprc': 0.6656781156857279, 'loss_val': 1.0189991640223774, 'psi': 0.6066778833451594}-{'f1_val': 0.574557582658916, 'auprc': 0.8174467414448846, 'loss_val': 0.9067458841168793, 'psi': 0.6717132461733035}
[S14] START round=16 head_norm_before_train=1.684450 cos_to_last_merge=0.9994 (last merge round=14)
[S14] round=16 local utility u=0.016691 metrics={'f1_val': 0.9970684233841665, 'auprc': 0.994630604604013, 'loss_val': 0.14738742845908398, 'psi': 0.9960932958721052}-{'f1_val': 0.9980623665153463, 'auprc': 0.9963375232731362, 'loss_val': 0.191853428844262, 'psi': 0.9973724292184623}
[S15] START round=16 head_norm_before_train=1.910893 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.8618401725254812, 'auprc': 0.9907678366876979, 'loss_val': 0.15519176800033796, 'psi': 0.9134112381903678}-{'f1_val': 0.9555477391488824, 'auprc': 0.9893426925026176, 'loss_val': 0.10570902534144945, 'psi': 0.9690657204903765}
[S16] START round=16 head_norm_before_train=1.196844 cos_to_last_merge=0.9993 (last merge round=14)
[S16] round=16 local utility u=0.009460 metrics={'f1_val': 0.4904148573065211, 'auprc': 0.8538828474041547, 'loss_val': 0.7337679626033664, 'psi': 0.6358020533455746}-{'f1_val': 0.5281526072703877, 'auprc': 0.8129522409305188, 'loss_val': 0.8563224805496221, 'psi': 0.6420724607344401}
[S17] START round=16 head_norm_before_train=1.758314 (no previous merge yet)
[S17] round=16 local utility u=0.165359 metrics={'f1_val': 0.5859782718958898, 'auprc': 0.9572581503362868, 'loss_val': 0.7066842458526003, 'psi': 0.7344902232720486}-{'f1_val': 0.5773418623502804, 'auprc': 0.8572753516150575, 'loss_val': 0.6856355980435971, 'psi': 0.6893152580561912}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.819)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.636)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=0.5645
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=-0.0786
[S7] DROPPED delta from S6 (cos=-0.0786 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=-0.1051
[S3] DROPPED delta from S5 (cos=-0.1051 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S14
[S13] cosine check vs S14: cos=-0.0138
[S13] DROPPED delta from S14 (cos=-0.0138 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S17
[S14] cosine check vs S17: cos=0.9830
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.3755 head_norm=1.328690
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.522237e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.3747 head_norm=1.378761 delta_norm=0.752224
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9971 head_norm=1.711493
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.696663e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9971 head_norm=1.752929 delta_norm=0.169666
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.513833 cos_to_last_merge=0.8254 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.5963742025057299, 'auprc': 0.8139491464621988, 'loss_val': 0.582528025841189, 'psi': 0.6834041800883175}-{'f1_val': 0.693114131141437, 'auprc': 0.8297600878120164, 'loss_val': 0.3457039946424012, 'psi': 0.7477725138096688}
[S3] START round=17 head_norm_before_train=1.658617 cos_to_last_merge=0.9981 (last merge round=14)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.6997617322591348, 'auprc': 0.8949409204382852, 'loss_val': 0.35589319221882354, 'psi': 0.777833407530795}-{'f1_val': 0.7020275052927452, 'auprc': 0.9950025814347552, 'loss_val': 0.3328623507426219, 'psi': 0.8192175357495491}
[S4] START round=17 head_norm_before_train=1.284288 cos_to_last_merge=0.9989 (last merge round=15)
[S4] round=17 local utility u=0.085349 metrics={'f1_val': 0.9447906024987838, 'auprc': 0.9899221611683289, 'loss_val': 0.18702758172107736, 'psi': 0.9628432259666019}-{'f1_val': 0.9328398109603796, 'auprc': 0.9710973335221298, 'loss_val': 0.22954691952293652, 'psi': 0.9481428199850797}
[S5] START round=17 head_norm_before_train=1.400399 cos_to_last_merge=0.9990 (last merge round=14)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7141740326016373, 'auprc': 0.7929145487681206, 'loss_val': 0.5480481172712794, 'psi': 0.7456702390682306}-{'f1_val': 0.7005691551769304, 'auprc': 0.9779093985677418, 'loss_val': 0.43882934995112316, 'psi': 0.811505252533255}
[S6] START round=17 head_norm_before_train=1.739882 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.8521571454152129, 'auprc': 0.9548598046168594, 'loss_val': 0.4623781949500104, 'psi': 0.8932382090958715}-{'f1_val': 0.8237184286582567, 'auprc': 0.968186766887708, 'loss_val': 0.33144428633196704, 'psi': 0.8815057639500372}
[S7] START round=17 head_norm_before_train=1.378761 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.950443 metrics={'f1_val': 0.6629101666690057, 'auprc': 0.7663595934215742, 'loss_val': 0.7424425125720631, 'psi': 0.7042899373700331}-{'f1_val': 0.3754646530009066, 'auprc': 0.7652354284177152, 'loss_val': 0.9152821746606769, 'psi': 0.53137296316763}
[S8] START round=17 head_norm_before_train=1.133316 cos_to_last_merge=0.9948 (last merge round=14)
[S8] round=17 local utility u=0.032701 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9966800878450607, 'loss_val': 0.0883479576329326, 'psi': 0.9943263715610998}-{'f1_val': 0.9931569338135257, 'auprc': 0.9847892850971054, 'loss_val': 0.12047625594076326, 'psi': 0.9898098743269576}
[S9] START round=17 head_norm_before_train=1.707895 (no previous merge yet)
[S9] round=17 local utility u=0.055192 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984656738290321, 'loss_val': 0.04682377699964872, 'psi': 0.9971488869698565}-{'f1_val': 0.9873949972964658, 'auprc': 0.992265131507614, 'loss_val': 0.08535002093708963, 'psi': 0.9893430509809251}
[S10] START round=17 head_norm_before_train=1.779951 cos_to_last_merge=0.9950 (last merge round=14)
[S10] round=17 local utility u=0.012953 metrics={'f1_val': 0.9937298155689185, 'auprc': 0.9964032964515467, 'loss_val': 0.07440932110367698, 'psi': 0.9947992079219697}-{'f1_val': 0.9939177191057856, 'auprc': 0.9924396528320638, 'loss_val': 0.08955166601623415, 'psi': 0.9933264925962969}
[S11] START round=17 head_norm_before_train=1.747965 (no previous merge yet)
[S11] round=17 local utility u=0.390459 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977796519242135, 'loss_val': 0.11518341687726921, 'psi': 0.9970400634778391}-{'f1_val': 0.9034598673649913, 'auprc': 0.9966630802911648, 'loss_val': 0.33422857095451897, 'psi': 0.9407411525354608}
[S13] START round=17 head_norm_before_train=1.678299 (no previous merge yet)
[S13] round=17 local utility u=0.541585 metrics={'f1_val': 0.6154012380644445, 'auprc': 0.8026514368305903, 'loss_val': 0.6350904566296445, 'psi': 0.6903013175709027}-{'f1_val': 0.5673443951181136, 'auprc': 0.6656781156857279, 'loss_val': 1.0189991640223774, 'psi': 0.6066778833451594}
[S14] START round=17 head_norm_before_train=1.752929 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9962301447146618, 'auprc': 0.9958907494414087, 'loss_val': 0.1696915974202888, 'psi': 0.9960943866053605}-{'f1_val': 0.9970684233841665, 'auprc': 0.994630604604013, 'loss_val': 0.14738742845908398, 'psi': 0.9960932958721052}
[S15] START round=17 head_norm_before_train=1.938981 (no previous merge yet)
[S15] round=17 local utility u=0.349010 metrics={'f1_val': 0.9828085260124504, 'auprc': 0.9677222839271606, 'loss_val': 0.1138455751243873, 'psi': 0.9767740291783344}-{'f1_val': 0.8618401725254812, 'auprc': 0.9907678366876979, 'loss_val': 0.15519176800033796, 'psi': 0.9134112381903678}
[S16] START round=17 head_norm_before_train=1.230775 cos_to_last_merge=0.9971 (last merge round=14)
[S16] round=17 local utility u=0.889395 metrics={'f1_val': 0.8280772732894249, 'auprc': 0.8271023078265306, 'loss_val': 0.900610673728219, 'psi': 0.8276872871042672}-{'f1_val': 0.4904148573065211, 'auprc': 0.8538828474041547, 'loss_val': 0.7337679626033664, 'psi': 0.6358020533455746}
[S17] START round=17 head_norm_before_train=1.809389 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.618031664952226, 'auprc': 0.8128515035008946, 'loss_val': 0.6357191483997079, 'psi': 0.6959596003716935}-{'f1_val': 0.5859782718958898, 'auprc': 0.9572581503362868, 'loss_val': 0.7066842458526003, 'psi': 0.7344902232720486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:38403
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=0.9695
[S4] RECEIVED delta(kind=head bytes=1793) from S16
[S4] cosine check vs S16: cos=0.9781
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.4480
[S16] RECEIVED delta(kind=head bytes=1792) from S8
[S16] cosine check vs S8: cos=0.9409
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=-0.0466
[S16] DROPPED delta from S13 (cos=-0.0466 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=0.9837
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.9142
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=0.4787
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9937 head_norm=1.827443
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.240854e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9935 head_norm=1.782714 delta_norm=0.224085
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.6998 head_norm=1.683595
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.564967e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.6966 head_norm=1.702536 delta_norm=0.156497
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9928 head_norm=1.193672
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.603189e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9928 head_norm=1.089256 delta_norm=0.260319
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8281 head_norm=1.263980
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.140970e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8287 head_norm=1.210542 delta_norm=0.214097
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6629 head_norm=1.396343
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.135191e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6657 head_norm=1.435329 delta_norm=0.913519
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9448 head_norm=1.319133
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.380508e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9465 head_norm=1.284453 delta_norm=0.138051
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.535305 cos_to_last_merge=0.8258 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.826
[S2] round=18 local utility u=0.926079 metrics={'f1_val': 0.8689053702037107, 'auprc': 0.7999750663573417, 'loss_val': 0.32363492175124386, 'psi': 0.8413332486651631}-{'f1_val': 0.5963742025057299, 'auprc': 0.8139491464621988, 'loss_val': 0.582528025841189, 'psi': 0.6834041800883175}
[S3] START round=18 head_norm_before_train=1.702536 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.633213629554735, 'auprc': 0.8219675784957525, 'loss_val': 0.4456137498653234, 'psi': 0.7087152091311419}-{'f1_val': 0.6997617322591348, 'auprc': 0.8949409204382852, 'loss_val': 0.35589319221882354, 'psi': 0.777833407530795}
[S4] START round=18 head_norm_before_train=1.284453 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9414911452463772, 'auprc': 0.9098519237992769, 'loss_val': 0.25427620592517086, 'psi': 0.9288354566675371}-{'f1_val': 0.9447906024987838, 'auprc': 0.9899221611683289, 'loss_val': 0.18702758172107736, 'psi': 0.9628432259666019}
[S5] START round=18 head_norm_before_train=1.430948 cos_to_last_merge=0.9968 (last merge round=14)
[S5] round=18 local utility u=0.366437 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.99815097247538, 'loss_val': 0.3492583476975127, 'psi': 0.8196023498199176}-{'f1_val': 0.7141740326016373, 'auprc': 0.7929145487681206, 'loss_val': 0.5480481172712794, 'psi': 0.7456702390682306}
[S6] START round=18 head_norm_before_train=1.766823 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6915101138830515, 'auprc': 0.9422753089432085, 'loss_val': 0.6171692434147218, 'psi': 0.7918161919071143}-{'f1_val': 0.8521571454152129, 'auprc': 0.9548598046168594, 'loss_val': 0.4623781949500104, 'psi': 0.8932382090958715}
[S7] START round=18 head_norm_before_train=1.435329 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6518331776648223, 'auprc': 0.7860713439978211, 'loss_val': 0.7648679541575328, 'psi': 0.7055284441980219}-{'f1_val': 0.6629101666690057, 'auprc': 0.7663595934215742, 'loss_val': 0.7424425125720631, 'psi': 0.7042899373700331}
[S8] START round=18 head_norm_before_train=1.089256 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9913729870729182, 'auprc': 0.9979547823311092, 'loss_val': 0.10884100140719391, 'psi': 0.9940057051761946}-{'f1_val': 0.9927572273717925, 'auprc': 0.9966800878450607, 'loss_val': 0.0883479576329326, 'psi': 0.9943263715610998}
[S9] START round=18 head_norm_before_train=1.735439 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9920865114751727, 'auprc': 0.9984710455788625, 'loss_val': 0.045013293231042674, 'psi': 0.9946403251166486}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984656738290321, 'loss_val': 0.04682377699964872, 'psi': 0.9971488869698565}
[S10] START round=18 head_norm_before_train=1.782714 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9924753255875621, 'loss_val': 0.08357428396219257, 'psi': 0.9937075943140614}-{'f1_val': 0.9937298155689185, 'auprc': 0.9964032964515467, 'loss_val': 0.07440932110367698, 'psi': 0.9947992079219697}
[S11] START round=18 head_norm_before_train=1.765508 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9953334032513049, 'loss_val': 0.11994924978762045, 'psi': 0.9959164617818386}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977796519242135, 'loss_val': 0.11518341687726921, 'psi': 0.9970400634778391}
[S13] START round=18 head_norm_before_train=1.673925 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5914916019699542, 'auprc': 0.8627142841428447, 'loss_val': 0.7121679462672388, 'psi': 0.6999806748391104}-{'f1_val': 0.6154012380644445, 'auprc': 0.8026514368305903, 'loss_val': 0.6350904566296445, 'psi': 0.6903013175709027}
[S14] START round=18 head_norm_before_train=1.774656 cos_to_last_merge=0.9998 (last merge round=16)
[S14] round=18 local utility u=0.031097 metrics={'f1_val': 0.9974535255208126, 'auprc': 0.9971526093078339, 'loss_val': 0.11862318123155381, 'psi': 0.9973331590356211}-{'f1_val': 0.9962301447146618, 'auprc': 0.9958907494414087, 'loss_val': 0.1696915974202888, 'psi': 0.9960943866053605}
[S15] START round=18 head_norm_before_train=1.959489 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6951377261032485, 'auprc': 0.7987137587898254, 'loss_val': 0.7273260478709026, 'psi': 0.7365681391778793}-{'f1_val': 0.9828085260124504, 'auprc': 0.9677222839271606, 'loss_val': 0.1138455751243873, 'psi': 0.9767740291783344}
[S16] START round=18 head_norm_before_train=1.210542 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.7456933841140592, 'auprc': 0.8393041179340364, 'loss_val': 0.8981482902024495, 'psi': 0.78313767764205}-{'f1_val': 0.8280772732894249, 'auprc': 0.8271023078265306, 'loss_val': 0.900610673728219, 'psi': 0.8276872871042672}
[S17] START round=18 head_norm_before_train=1.851221 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5859201888714459, 'auprc': 0.7800072189990728, 'loss_val': 0.8983855949308742, 'psi': 0.6635550009224966}-{'f1_val': 0.618031664952226, 'auprc': 0.8128515035008946, 'loss_val': 0.6357191483997079, 'psi': 0.6959596003716935}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:38413
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.9719
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=-0.0060
[S13] DROPPED delta from S14 (cos=-0.0060 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.1080
[S3] DROPPED delta from S5 (cos=-0.1080 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7006 head_norm=1.453660
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.846489e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7006 head_norm=1.492201 delta_norm=0.184649
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.551899 cos_to_last_merge=0.8252 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.8337749496072135, 'auprc': 0.8175956488978031, 'loss_val': 0.29160584728810435, 'psi': 0.8273032293234494}-{'f1_val': 0.8689053702037107, 'auprc': 0.7999750663573417, 'loss_val': 0.32363492175124386, 'psi': 0.8413332486651631}
[S3] START round=19 head_norm_before_train=1.724741 cos_to_last_merge=0.9998 (last merge round=17)
[S3] round=19 local utility u=0.557204 metrics={'f1_val': 0.7042340030762868, 'auprc': 0.9958304619005612, 'loss_val': 0.27891729547290395, 'psi': 0.8208725866059966}-{'f1_val': 0.633213629554735, 'auprc': 0.8219675784957525, 'loss_val': 0.4456137498653234, 'psi': 0.7087152091311419}
[S4] START round=19 head_norm_before_train=1.323345 cos_to_last_merge=0.9994 (last merge round=17)
[S4] round=19 local utility u=0.251079 metrics={'f1_val': 0.9713304617668823, 'auprc': 0.9827253125253999, 'loss_val': 0.1497748032549294, 'psi': 0.9758884020702893}-{'f1_val': 0.9414911452463772, 'auprc': 0.9098519237992769, 'loss_val': 0.25427620592517086, 'psi': 0.9288354566675371}
[S5] START round=19 head_norm_before_train=1.492201 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.714400588689728, 'auprc': 0.7927077705717821, 'loss_val': 0.5066208447051505, 'psi': 0.7457234614425496}-{'f1_val': 0.7005699347162762, 'auprc': 0.99815097247538, 'loss_val': 0.3492583476975127, 'psi': 0.8196023498199176}
[S6] START round=19 head_norm_before_train=1.793681 (no previous merge yet)
[S6] round=19 local utility u=0.378041 metrics={'f1_val': 0.7833742569661132, 'auprc': 0.9604649627684667, 'loss_val': 0.46684165611752465, 'psi': 0.8542105392870546}-{'f1_val': 0.6915101138830515, 'auprc': 0.9422753089432085, 'loss_val': 0.6171692434147218, 'psi': 0.7918161919071143}
[S7] START round=19 head_norm_before_train=1.455147 cos_to_last_merge=0.9995 (last merge round=17)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.4442608830441585, 'auprc': 0.7666263192776726, 'loss_val': 0.8993865556723072, 'psi': 0.5732070575375641}-{'f1_val': 0.6518331776648223, 'auprc': 0.7860713439978211, 'loss_val': 0.7648679541575328, 'psi': 0.7055284441980219}
[S8] START round=19 head_norm_before_train=1.156983 cos_to_last_merge=0.9987 (last merge round=17)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.9850273042872424, 'loss_val': 0.08307303509325187, 'psi': 0.9899839176588641}-{'f1_val': 0.9913729870729182, 'auprc': 0.9979547823311092, 'loss_val': 0.10884100140719391, 'psi': 0.9940057051761946}
[S9] START round=19 head_norm_before_train=1.762271 (no previous merge yet)
[S9] round=19 local utility u=0.016517 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962610368298636, 'loss_val': 0.035447106785375264, 'psi': 0.9967661622392311}-{'f1_val': 0.9920865114751727, 'auprc': 0.9984710455788625, 'loss_val': 0.045013293231042674, 'psi': 0.9946403251166486}
[S10] START round=19 head_norm_before_train=1.824972 cos_to_last_merge=0.9994 (last merge round=17)
[S10] round=19 local utility u=0.008162 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9926267327721461, 'loss_val': 0.06770475377247821, 'psi': 0.993768157187895}-{'f1_val': 0.9945291067983943, 'auprc': 0.9924753255875621, 'loss_val': 0.08357428396219257, 'psi': 0.9937075943140614}
[S11] START round=19 head_norm_before_train=1.784325 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9979299098741619, 'loss_val': 0.14245191674417573, 'psi': 0.996864448796112}-{'f1_val': 0.996305167468861, 'auprc': 0.9953334032513049, 'loss_val': 0.11994924978762045, 'psi': 0.9959164617818386}
[S13] START round=19 head_norm_before_train=1.675400 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5853002103348109, 'auprc': 0.7384698544192806, 'loss_val': 0.82110585017763, 'psi': 0.6465680679685988}-{'f1_val': 0.5914916019699542, 'auprc': 0.8627142841428447, 'loss_val': 0.7121679462672388, 'psi': 0.6999806748391104}
[S14] START round=19 head_norm_before_train=1.792806 cos_to_last_merge=0.9993 (last merge round=16)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9482398021790731, 'auprc': 0.9965938400475383, 'loss_val': 0.14535053897921635, 'psi': 0.9675814173264592}-{'f1_val': 0.9974535255208126, 'auprc': 0.9971526093078339, 'loss_val': 0.11862318123155381, 'psi': 0.9973331590356211}
[S15] START round=19 head_norm_before_train=1.974217 (no previous merge yet)
[S15] round=19 local utility u=1.000000 metrics={'f1_val': 0.9821377004805396, 'auprc': 0.9922971244803853, 'loss_val': 0.06471565533618023, 'psi': 0.986201470080478}-{'f1_val': 0.6951377261032485, 'auprc': 0.7987137587898254, 'loss_val': 0.7273260478709026, 'psi': 0.7365681391778793}
[S16] START round=19 head_norm_before_train=1.243511 cos_to_last_merge=0.9995 (last merge round=17)
[S16] round=19 local utility u=0.930603 metrics={'f1_val': 0.9291989610323594, 'auprc': 0.9379516764804149, 'loss_val': 0.4339175024903383, 'psi': 0.9327000472115816}-{'f1_val': 0.7456933841140592, 'auprc': 0.8393041179340364, 'loss_val': 0.8981482902024495, 'psi': 0.78313767764205}
[S17] START round=19 head_norm_before_train=1.881373 (no previous merge yet)
[S17] round=19 local utility u=0.219572 metrics={'f1_val': 0.6165352938341382, 'auprc': 0.8562025449053797, 'loss_val': 0.8715179482435056, 'psi': 0.7124021942626348}-{'f1_val': 0.5859201888714459, 'auprc': 0.7800072189990728, 'loss_val': 0.8983855949308742, 'psi': 0.6635550009224966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:38404
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:38403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=-0.0751
[S6] DROPPED delta from S3 (cos=-0.0751 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.4816
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] cosine check vs S6: cos=-0.0729
[S7] DROPPED delta from S6 (cos=-0.0729 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.8938
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.9735
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] cosine check vs S9: cos=0.9913
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.8812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1807 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1807) from S17
[S14] cosine check vs S17: cos=0.9873
[S2] r=20 psi=0.827 u=0.0000 p_local=0.2480 f1=0.834 auprc=0.818 bytes=10774
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9482 head_norm=1.814397
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.568439e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9478 head_norm=1.858375 delta_norm=0.156844
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.968 u=0.0000 p_local=0.1159 f1=0.948 auprc=0.997 bytes=17974
[S5] r=20 psi=0.746 u=0.0000 p_local=0.1701 f1=0.714 auprc=0.793 bytes=17982
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9933 head_norm=1.231459
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.232115e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9933 head_norm=1.259660 delta_norm=0.323211
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.990 u=0.0000 p_local=0.0693 f1=0.993 auprc=0.985 bytes=14381
[S13] r=20 psi=0.647 u=0.0000 p_local=0.1430 f1=0.585 auprc=0.738 bytes=12581
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.4443 head_norm=1.476333
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.179404e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.4343 head_norm=1.421611 delta_norm=0.217940
[S7] aggregate: ROLLBACK (f1_val pre=0.444 post=0.434 tol_abs=0.005 tol_rel=0.0)
[S7] r=20 psi=0.573 u=0.0000 p_local=0.2384 f1=0.444 auprc=0.767 bytes=14370
[S11] r=20 psi=0.997 u=0.0000 p_local=0.1593 f1=0.996 auprc=0.998 bytes=16173
[S10] r=20 psi=0.994 u=0.0082 p_local=0.0699 f1=0.995 auprc=0.993 bytes=17973
[S16] r=20 psi=0.933 u=0.9306 p_local=0.3976 f1=0.929 auprc=0.938 bytes=14362
[S15] r=20 psi=0.986 u=1.0000 p_local=0.4181 f1=0.982 auprc=0.992 bytes=14398
[S6] r=20 psi=0.854 u=0.3780 p_local=0.3023 f1=0.783 auprc=0.960 bytes=14385
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.7042 head_norm=1.746737
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.182466e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.8572 head_norm=1.761660 delta_norm=0.118247
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.821 u=0.5572 p_local=0.1925 f1=0.704 auprc=0.996 bytes=12582
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9713 head_norm=1.365988
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.588423e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9726 head_norm=1.309662 delta_norm=0.158842
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.976 u=0.2511 p_local=0.1303 f1=0.971 auprc=0.983 bytes=16181
[S9] r=20 psi=0.997 u=0.0165 p_local=0.0919 f1=0.997 auprc=0.996 bytes=17968
[S17] r=20 psi=0.712 u=0.2196 p_local=0.1724 f1=0.617 auprc=0.856 bytes=16218
[S2] START round=20 head_norm_before_train=1.577058 cos_to_last_merge=0.8234 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.823
[S2] round=20 local utility u=0.043669 metrics={'f1_val': 0.8335336152269344, 'auprc': 0.8548246939880935, 'loss_val': 0.3145066011297578, 'psi': 0.842050046731398}-{'f1_val': 0.8337749496072135, 'auprc': 0.8175956488978031, 'loss_val': 0.29160584728810435, 'psi': 0.8273032293234494}
[S3] START round=20 head_norm_before_train=1.761660 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.5113563020430031, 'auprc': 0.8060522228304527, 'loss_val': 0.5430091600213526, 'psi': 0.629234670357983}-{'f1_val': 0.7042340030762868, 'auprc': 0.9958304619005612, 'loss_val': 0.27891729547290395, 'psi': 0.8208725866059966}
[S4] START round=20 head_norm_before_train=1.309662 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9363001881936224, 'auprc': 0.9701214545569727, 'loss_val': 0.23161034208748885, 'psi': 0.9498286947389625}-{'f1_val': 0.9713304617668823, 'auprc': 0.9827253125253999, 'loss_val': 0.1497748032549294, 'psi': 0.9758884020702893}
[S5] START round=20 head_norm_before_train=1.512064 cos_to_last_merge=0.9997 (last merge round=18)
[S5] round=20 local utility u=0.348387 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9961462811287531, 'loss_val': 0.3356873694258672, 'psi': 0.8186513029118495}-{'f1_val': 0.714400588689728, 'auprc': 0.7927077705717821, 'loss_val': 0.5066208447051505, 'psi': 0.7457234614425496}
[S6] START round=20 head_norm_before_train=1.821996 (no previous merge yet)
[S6] round=20 local utility u=0.112707 metrics={'f1_val': 0.8314044468653299, 'auprc': 0.9474198994296946, 'loss_val': 0.4904732122792447, 'psi': 0.8778106278910758}-{'f1_val': 0.7833742569661132, 'auprc': 0.9604649627684667, 'loss_val': 0.46684165611752465, 'psi': 0.8542105392870546}
[S7] START round=20 head_norm_before_train=1.421611 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.3956096295279814, 'auprc': 0.7591746961076259, 'loss_val': 1.035578547193169, 'psi': 0.5410356561598392}-{'f1_val': 0.4442608830441585, 'auprc': 0.7666263192776726, 'loss_val': 0.8993865556723072, 'psi': 0.5732070575375641}
[S8] START round=20 head_norm_before_train=1.259660 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.009374 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9883557103865906, 'loss_val': 0.06674798303617295, 'psi': 0.9905589902565874}-{'f1_val': 0.9932883265732785, 'auprc': 0.9850273042872424, 'loss_val': 0.08307303509325187, 'psi': 0.9899839176588641}
[S9] START round=20 head_norm_before_train=1.784310 (no previous merge yet)
[S9] round=20 local utility u=0.002416 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984608661166742, 'loss_val': 0.032223055177538304, 'psi': 0.9971469638849133}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962610368298636, 'loss_val': 0.035447106785375264, 'psi': 0.9967661622392311}
[S10] START round=20 head_norm_before_train=1.862317 cos_to_last_merge=0.9981 (last merge round=17)
[S10] round=20 local utility u=0.007137 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9939929164003722, 'loss_val': 0.05621292275410622, 'psi': 0.9941829739513297}-{'f1_val': 0.9945291067983943, 'auprc': 0.9926267327721461, 'loss_val': 0.06770475377247821, 'psi': 0.993768157187895}
[S11] START round=20 head_norm_before_train=1.803733 (no previous merge yet)
[S11] round=20 local utility u=0.027487 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9965636053332186, 'loss_val': 0.08440866312325737, 'psi': 0.9964208219463553}-{'f1_val': 0.9961541414107454, 'auprc': 0.9979299098741619, 'loss_val': 0.14245191674417573, 'psi': 0.996864448796112}
[S13] START round=20 head_norm_before_train=1.690877 (no previous merge yet)
[S13] round=20 local utility u=0.327958 metrics={'f1_val': 0.6054444936222991, 'auprc': 0.8656313768078413, 'loss_val': 0.6675396514938325, 'psi': 0.709519246896516}-{'f1_val': 0.5853002103348109, 'auprc': 0.7384698544192806, 'loss_val': 0.82110585017763, 'psi': 0.6465680679685988}
[S14] START round=20 head_norm_before_train=1.858375 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.171658 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.99696557446547, 'loss_val': 0.09437548769196867, 'psi': 0.9968526943576497}-{'f1_val': 0.9482398021790731, 'auprc': 0.9965938400475383, 'loss_val': 0.14535053897921635, 'psi': 0.9675814173264592}
[S15] START round=20 head_norm_before_train=1.987603 (no previous merge yet)
[S15] round=20 local utility u=0.055024 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9923295651203179, 'loss_val': 0.04019235306304035, 'psi': 0.9947571342343209}-{'f1_val': 0.9821377004805396, 'auprc': 0.9922971244803853, 'loss_val': 0.06471565533618023, 'psi': 0.986201470080478}
[S16] START round=20 head_norm_before_train=1.270814 cos_to_last_merge=0.9986 (last merge round=17)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8402022153952351, 'auprc': 0.9474162862795998, 'loss_val': 0.450276766291782, 'psi': 0.883087843748981}-{'f1_val': 0.9291989610323594, 'auprc': 0.9379516764804149, 'loss_val': 0.4339175024903383, 'psi': 0.9327000472115816}
[S17] START round=20 head_norm_before_train=1.914230 (no previous merge yet)
[S17] round=20 local utility u=0.126438 metrics={'f1_val': 0.6087062223374289, 'auprc': 0.9482044559786543, 'loss_val': 0.8476738932885046, 'psi': 0.7445055157939191}-{'f1_val': 0.6165352938341382, 'auprc': 0.8562025449053797, 'loss_val': 0.8715179482435056, 'psi': 0.7124021942626348}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:38411
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:38413
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38408
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.9843
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] cosine check vs S11: cos=0.9766
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=-0.0721
[S7] DROPPED delta from S6 (cos=-0.0721 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=0.8296
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.5964
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=-0.0450
[S16] DROPPED delta from S13 (cos=-0.0450 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] cosine check vs S8: cos=0.9894
[S13] RECEIVED delta(kind=head bytes=1803) from S14
[S13] cosine check vs S14: cos=-0.0031
[S13] DROPPED delta from S14 (cos=-0.0031 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=0.9964
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.1065
[S3] DROPPED delta from S5 (cos=-0.1065 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S17
[S14] cosine check vs S17: cos=0.9950
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.5114 head_norm=1.784383
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.714364e-02
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.5057 head_norm=1.793542 delta_norm=0.077144
[S3] aggregate: ROLLBACK (f1_val pre=0.511 post=0.506 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.154 → S6@127.0.0.1:38407
[S4] ⇄ pheromone p=0.104 → S8@127.0.0.1:38409
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.3956 head_norm=1.441645
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.211703e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.3949 head_norm=1.424822 delta_norm=0.121170
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.191 → S8@127.0.0.1:38409
[S11] ⇄ pheromone p=0.133 → S10@127.0.0.1:38411
[S13] ⇄ pheromone p=0.180 → S16@127.0.0.1:38416
[S2] ⇄ pheromone p=0.207 → S5@127.0.0.1:38405
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9943 head_norm=1.898429
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.042884e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9934 head_norm=1.853588 delta_norm=0.204288
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.057 → S7@127.0.0.1:38408
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7003 head_norm=1.527076
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.440048e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7003 head_norm=1.559119 delta_norm=0.144005
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.206 → S3@127.0.0.1:38403
[S6] ⇄ pheromone p=0.264 → S7@127.0.0.1:38408
[S15] ⇄ pheromone p=0.345 → S7@127.0.0.1:38408
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9968 head_norm=1.880720
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.015835e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9968 head_norm=1.912301 delta_norm=0.101584
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.127 → S13@127.0.0.1:38413
[S9] ⇄ pheromone p=0.074 → S3@127.0.0.1:38403
[S8] ⇄ pheromone p=0.057 → S16@127.0.0.1:38416
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8402 head_norm=1.301883
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.544568e-02
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8437 head_norm=1.303809 delta_norm=0.095446
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.318 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.163 → S14@127.0.0.1:38414
[S2] START round=21 head_norm_before_train=1.603502 cos_to_last_merge=0.8218 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.8182519870695176, 'auprc': 0.8921663309921121, 'loss_val': 0.36924667137013606, 'psi': 0.8478177246385554}-{'f1_val': 0.8335336152269344, 'auprc': 0.8548246939880935, 'loss_val': 0.3145066011297578, 'psi': 0.842050046731398}
[S3] START round=21 head_norm_before_train=1.793542 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=1.000000 metrics={'f1_val': 0.9990501435478858, 'auprc': 0.9997917467519023, 'loss_val': 0.21707711029769852, 'psi': 0.9993467848294925}-{'f1_val': 0.5113563020430031, 'auprc': 0.8060522228304527, 'loss_val': 0.5430091600213526, 'psi': 0.629234670357983}
[S4] START round=21 head_norm_before_train=1.354448 cos_to_last_merge=0.9993 (last merge round=19)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.934295383937679, 'auprc': 0.9526352713011281, 'loss_val': 0.21493053676635715, 'psi': 0.9416313388830586}-{'f1_val': 0.9363001881936224, 'auprc': 0.9701214545569727, 'loss_val': 0.23161034208748885, 'psi': 0.9498286947389625}
[S5] START round=21 head_norm_before_train=1.559119 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8496231583579262, 'loss_val': 0.36356588025556935, 'psi': 0.7602142989407751}-{'f1_val': 0.7003213174339138, 'auprc': 0.9961462811287531, 'loss_val': 0.3356873694258672, 'psi': 0.8186513029118495}
[S6] START round=21 head_norm_before_train=1.844106 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.7148815834003042, 'auprc': 0.948540661784266, 'loss_val': 0.6359366959924957, 'psi': 0.808345214753889}-{'f1_val': 0.8314044468653299, 'auprc': 0.9474198994296946, 'loss_val': 0.4904732122792447, 'psi': 0.8778106278910758}
[S7] START round=21 head_norm_before_train=1.424822 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.3876122058941707, 'auprc': 0.7615024732465258, 'loss_val': 1.1272091119501302, 'psi': 0.5371683128351128}-{'f1_val': 0.3956096295279814, 'auprc': 0.7591746961076259, 'loss_val': 1.035578547193169, 'psi': 0.5410356561598392}
[S8] START round=21 head_norm_before_train=1.312690 cos_to_last_merge=0.9995 (last merge round=19)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9843044951922839, 'auprc': 0.9984544483924199, 'loss_val': 0.07203857247192703, 'psi': 0.9899644764723383}-{'f1_val': 0.992027843503252, 'auprc': 0.9883557103865906, 'loss_val': 0.06674798303617295, 'psi': 0.9905589902565874}
[S9] START round=21 head_norm_before_train=1.805952 (no previous merge yet)
[S9] round=21 local utility u=0.001010 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984608662951674, 'loss_val': 0.030202653786109042, 'psi': 0.9971469639563106}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984608661166742, 'loss_val': 0.032223055177538304, 'psi': 0.9971469638849133}
[S10] START round=21 head_norm_before_train=1.853588 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.993145594583889, 'loss_val': 0.06697639094326263, 'psi': 0.9938440452247363}-{'f1_val': 0.9943096789853013, 'auprc': 0.9939929164003722, 'loss_val': 0.05621292275410622, 'psi': 0.9941829739513297}
[S11] START round=21 head_norm_before_train=1.830576 (no previous merge yet)
[S11] round=21 local utility u=0.010136 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9975197456241667, 'loss_val': 0.0684567883696825, 'psi': 0.996948380633395}-{'f1_val': 0.9963256330217796, 'auprc': 0.9965636053332186, 'loss_val': 0.08440866312325737, 'psi': 0.9964208219463553}
[S13] START round=21 head_norm_before_train=1.707507 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5881994939820339, 'auprc': 0.8226450997305842, 'loss_val': 0.8236135437166298, 'psi': 0.6819777362814541}-{'f1_val': 0.6054444936222991, 'auprc': 0.8656313768078413, 'loss_val': 0.6675396514938325, 'psi': 0.709519246896516}
[S14] START round=21 head_norm_before_train=1.912301 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.006703 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9962007706812286, 'loss_val': 0.0775329146733009, 'psi': 0.9964326472389416}-{'f1_val': 0.9967774409524363, 'auprc': 0.99696557446547, 'loss_val': 0.09437548769196867, 'psi': 0.9968526943576497}
[S15] START round=21 head_norm_before_train=2.005381 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6989648565909865, 'auprc': 0.7835427231691051, 'loss_val': 0.7389416686680151, 'psi': 0.7327960032222339}-{'f1_val': 0.9963755136436562, 'auprc': 0.9923295651203179, 'loss_val': 0.04019235306304035, 'psi': 0.9947571342343209}
[S16] START round=21 head_norm_before_train=1.303809 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8228828028948192, 'auprc': 0.788380680571241, 'loss_val': 1.0130995658658313, 'psi': 0.809081953965388}-{'f1_val': 0.8402022153952351, 'auprc': 0.9474162862795998, 'loss_val': 0.450276766291782, 'psi': 0.883087843748981}
[S17] START round=21 head_norm_before_train=1.948672 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5687378765205583, 'auprc': 0.7470599695048392, 'loss_val': 1.0888936065167714, 'psi': 0.6400667137142706}-{'f1_val': 0.6087062223374289, 'auprc': 0.9482044559786543, 'loss_val': 0.8476738932885046, 'psi': 0.7445055157939191}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:38403
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:38411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:38413
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S11
[S10] cosine check vs S11: cos=0.9899
[S13] RECEIVED delta(kind=head bytes=1802) from S14
[S13] cosine check vs S14: cos=-0.0008
[S13] DROPPED delta from S14 (cos=-0.0008 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=-0.0752
[S6] DROPPED delta from S3 (cos=-0.0752 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] cosine check vs S9: cos=0.9979
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9943 head_norm=1.890212
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.341300e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9941 head_norm=1.869844 delta_norm=0.134130
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.9991 head_norm=1.817352
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.886699e-02
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.9986 head_norm=1.820143 delta_norm=0.058867
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.627628 cos_to_last_merge=0.8206 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.821
[S2] round=22 local utility u=0.023582 metrics={'f1_val': 0.8312009590273788, 'auprc': 0.8756241651737731, 'loss_val': 0.35014920157003576, 'psi': 0.8489702414859365}-{'f1_val': 0.8182519870695176, 'auprc': 0.8921663309921121, 'loss_val': 0.36924667137013606, 'psi': 0.8478177246385554}
[S3] START round=22 head_norm_before_train=1.820143 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9546628603985101, 'auprc': 0.9946584040214741, 'loss_val': 0.217989159806407, 'psi': 0.9706610778476956}-{'f1_val': 0.9990501435478858, 'auprc': 0.9997917467519023, 'loss_val': 0.21707711029769852, 'psi': 0.9993467848294925}
[S4] START round=22 head_norm_before_train=1.396410 cos_to_last_merge=0.9974 (last merge round=19)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9309608403532025, 'auprc': 0.9400327798690454, 'loss_val': 0.2628614888925897, 'psi': 0.9345896161595397}-{'f1_val': 0.934295383937679, 'auprc': 0.9526352713011281, 'loss_val': 0.21493053676635715, 'psi': 0.9416313388830586}
[S5] START round=22 head_norm_before_train=1.571440 cos_to_last_merge=0.9999 (last merge round=20)
[S5] round=22 local utility u=0.218578 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9851996563455268, 'loss_val': 0.33314429769883397, 'psi': 0.8144453189416792}-{'f1_val': 0.7006083926626743, 'auprc': 0.8496231583579262, 'loss_val': 0.36356588025556935, 'psi': 0.7602142989407751}
[S6] START round=22 head_norm_before_train=1.867678 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.722533984350705, 'auprc': 0.9298446484447955, 'loss_val': 0.7457146048333974, 'psi': 0.8054582499883413}-{'f1_val': 0.7148815834003042, 'auprc': 0.948540661784266, 'loss_val': 0.6359366959924957, 'psi': 0.808345214753889}
[S7] START round=22 head_norm_before_train=1.446635 cos_to_last_merge=0.9995 (last merge round=20)
[S7] round=22 local utility u=0.101888 metrics={'f1_val': 0.4030539940505423, 'auprc': 0.774085335186292, 'loss_val': 1.0538321399300532, 'psi': 0.5514665305048422}-{'f1_val': 0.3876122058941707, 'auprc': 0.7615024732465258, 'loss_val': 1.1272091119501302, 'psi': 0.5371683128351128}
[S8] START round=22 head_norm_before_train=1.354929 cos_to_last_merge=0.9985 (last merge round=19)
[S8] round=22 local utility u=0.003668 metrics={'f1_val': 0.9917822352048012, 'auprc': 0.9838520064741045, 'loss_val': 0.06576163358965388, 'psi': 0.9886101437125225}-{'f1_val': 0.9843044951922839, 'auprc': 0.9984544483924199, 'loss_val': 0.07203857247192703, 'psi': 0.9899644764723383}
[S9] START round=22 head_norm_before_train=1.824831 (no previous merge yet)
[S9] round=22 local utility u=0.000083 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959054775230267, 'loss_val': 0.027362119559189994, 'psi': 0.9966239385164963}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984608662951674, 'loss_val': 0.030202653786109042, 'psi': 0.9971469639563106}
[S10] START round=22 head_norm_before_train=1.869844 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.993388048049354, 'loss_val': 0.0677570698064324, 'psi': 0.9934148441122851}-{'f1_val': 0.9943096789853013, 'auprc': 0.993145594583889, 'loss_val': 0.06697639094326263, 'psi': 0.9938440452247363}
[S11] START round=22 head_norm_before_train=1.858956 (no previous merge yet)
[S11] round=22 local utility u=0.005279 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9977521045759224, 'loss_val': 0.057145804561405694, 'psi': 0.9968962216434367}-{'f1_val': 0.996567470639547, 'auprc': 0.9975197456241667, 'loss_val': 0.0684567883696825, 'psi': 0.996948380633395}
[S13] START round=22 head_norm_before_train=1.732577 (no previous merge yet)
[S13] round=22 local utility u=0.542162 metrics={'f1_val': 0.6978442188952417, 'auprc': 0.8712697631408876, 'loss_val': 0.5430328250921349, 'psi': 0.7672144365935001}-{'f1_val': 0.5881994939820339, 'auprc': 0.8226450997305842, 'loss_val': 0.8236135437166298, 'psi': 0.6819777362814541}
[S14] START round=22 head_norm_before_train=1.937548 cos_to_last_merge=0.9998 (last merge round=20)
[S14] round=22 local utility u=0.012507 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9968733723249026, 'loss_val': 0.058455233303532465, 'psi': 0.9970935629534369}-{'f1_val': 0.9965872316107504, 'auprc': 0.9962007706812286, 'loss_val': 0.0775329146733009, 'psi': 0.9964326472389416}
[S15] START round=22 head_norm_before_train=2.022193 (no previous merge yet)
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.99237324367253, 'auprc': 0.9952370672840032, 'loss_val': 0.04886033177925111, 'psi': 0.9935187731171193}-{'f1_val': 0.6989648565909865, 'auprc': 0.7835427231691051, 'loss_val': 0.7389416686680151, 'psi': 0.7327960032222339}
[S16] START round=22 head_norm_before_train=1.334830 cos_to_last_merge=0.9997 (last merge round=20)
[S16] round=22 local utility u=0.740145 metrics={'f1_val': 0.866048006710559, 'auprc': 0.982526533563787, 'loss_val': 0.3742373705324084, 'psi': 0.9126394174518502}-{'f1_val': 0.8228828028948192, 'auprc': 0.788380680571241, 'loss_val': 1.0130995658658313, 'psi': 0.809081953965388}
[S17] START round=22 head_norm_before_train=1.971958 (no previous merge yet)
[S17] round=22 local utility u=0.330912 metrics={'f1_val': 0.614601231866379, 'auprc': 0.8617921397575476, 'loss_val': 1.046446475520043, 'psi': 0.7134775950228465}-{'f1_val': 0.5687378765205583, 'auprc': 0.7470599695048392, 'loss_val': 1.0888936065167714, 'psi': 0.6400667137142706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:38404
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38405
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[S14] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → trigger blocked (psi=0.997)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=-0.0555
[S16] DROPPED delta from S13 (cos=-0.0555 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.7867
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=0.9840
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=-0.1029
[S3] DROPPED delta from S5 (cos=-0.1029 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.4084
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.9914
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.9933
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] cosine check vs S17: cos=0.9958
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9972 head_norm=1.962439
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.150095e-02
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9972 head_norm=1.976033 delta_norm=0.091501
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9310 head_norm=1.436759
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.304063e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9309 head_norm=1.394916 delta_norm=0.130406
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.8660 head_norm=1.364302
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.057678e-02
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.8670 head_norm=1.375115 delta_norm=0.080577
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7006 head_norm=1.587243
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.088817e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7006 head_norm=1.610167 delta_norm=0.108882
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9918 head_norm=1.390520
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.772140e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9929 head_norm=1.198389 delta_norm=0.777214
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.4031 head_norm=1.465212
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.323387e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.4134 head_norm=1.657434 delta_norm=0.632339
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.640015 cos_to_last_merge=0.8196 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.820
[S2] round=23 local utility u=0.024436 metrics={'f1_val': 0.8301506901307244, 'auprc': 0.8968285679581995, 'loss_val': 0.35858785999910503, 'psi': 0.8568218412617145}-{'f1_val': 0.8312009590273788, 'auprc': 0.8756241651737731, 'loss_val': 0.35014920157003576, 'psi': 0.8489702414859365}
[S3] START round=23 head_norm_before_train=1.841679 cos_to_last_merge=0.9998 (last merge round=21)
[S3] round=23 local utility u=0.056104 metrics={'f1_val': 0.9625264541981038, 'auprc': 0.9995523357704261, 'loss_val': 0.16764537310084354, 'psi': 0.9773368068270327}-{'f1_val': 0.9546628603985101, 'auprc': 0.9946584040214741, 'loss_val': 0.217989159806407, 'psi': 0.9706610778476956}
[S4] START round=23 head_norm_before_train=1.394916 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.085244 metrics={'f1_val': 0.9335512694252552, 'auprc': 0.9772700942204942, 'loss_val': 0.21962873553181675, 'psi': 0.9510387993433508}-{'f1_val': 0.9309608403532025, 'auprc': 0.9400327798690454, 'loss_val': 0.2628614888925897, 'psi': 0.9345896161595397}
[S5] START round=23 head_norm_before_train=1.610167 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7939702262713982, 'loss_val': 0.36342151879505596, 'psi': 0.7379531261061638}-{'f1_val': 0.7006090940057808, 'auprc': 0.9851996563455268, 'loss_val': 0.33314429769883397, 'psi': 0.8144453189416792}
[S6] START round=23 head_norm_before_train=1.887854 (no previous merge yet)
[S6] round=23 local utility u=0.144448 metrics={'f1_val': 0.7342852588779598, 'auprc': 0.9534266012601939, 'loss_val': 0.5980721019452555, 'psi': 0.8219417958308535}-{'f1_val': 0.722533984350705, 'auprc': 0.9298446484447955, 'loss_val': 0.7457146048333974, 'psi': 0.8054582499883413}
[S7] START round=23 head_norm_before_train=1.657434 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.375795 metrics={'f1_val': 0.4964080381511268, 'auprc': 0.7793052359556006, 'loss_val': 0.8780262232749692, 'psi': 0.6095669172729163}-{'f1_val': 0.4030539940505423, 'auprc': 0.774085335186292, 'loss_val': 1.0538321399300532, 'psi': 0.5514665305048422}
[S8] START round=23 head_norm_before_train=1.198389 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9866483731271759, 'auprc': 0.9903418249619013, 'loss_val': 0.1256438934284853, 'psi': 0.9881257538610659}-{'f1_val': 0.9917822352048012, 'auprc': 0.9838520064741045, 'loss_val': 0.06576163358965388, 'psi': 0.9886101437125225}
[S9] START round=23 head_norm_before_train=1.843978 (no previous merge yet)
[S9] round=23 local utility u=0.004879 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984603624886355, 'loss_val': 0.025268011532377482, 'psi': 0.9976458925027398}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959054775230267, 'loss_val': 0.027362119559189994, 'psi': 0.9966239385164963}
[S10] START round=23 head_norm_before_train=1.911095 cos_to_last_merge=0.9992 (last merge round=21)
[S10] round=23 local utility u=0.010200 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9933413235577876, 'loss_val': 0.05275868222675991, 'psi': 0.9939503684501678}-{'f1_val': 0.9934327081542391, 'auprc': 0.993388048049354, 'loss_val': 0.0677570698064324, 'psi': 0.9934148441122851}
[S11] START round=23 head_norm_before_train=1.889136 (no previous merge yet)
[S11] round=23 local utility u=0.001658 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9977262936510309, 'loss_val': 0.05520263309526913, 'psi': 0.9970309998441407}-{'f1_val': 0.9963256330217796, 'auprc': 0.9977521045759224, 'loss_val': 0.057145804561405694, 'psi': 0.9968962216434367}
[S13] START round=23 head_norm_before_train=1.757918 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5933461088604223, 'auprc': 0.7495558254793455, 'loss_val': 0.8785186815018595, 'psi': 0.6558299955079916}-{'f1_val': 0.6978442188952417, 'auprc': 0.8712697631408876, 'loss_val': 0.5430328250921349, 'psi': 0.7672144365935001}
[S14] START round=23 head_norm_before_train=1.976033 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9950685355605942, 'loss_val': 0.056581373206410074, 'psi': 0.9963677495665838}-{'f1_val': 0.997240356705793, 'auprc': 0.9968733723249026, 'loss_val': 0.058455233303532465, 'psi': 0.9970935629534369}
[S15] START round=23 head_norm_before_train=2.036427 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.8054609399943726, 'auprc': 0.9762016580554618, 'loss_val': 0.3762178860217628, 'psi': 0.8737572272188083}-{'f1_val': 0.99237324367253, 'auprc': 0.9952370672840032, 'loss_val': 0.04886033177925111, 'psi': 0.9935187731171193}
[S16] START round=23 head_norm_before_train=1.375115 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8413348494518017, 'auprc': 0.9859002055469523, 'loss_val': 0.4069929700370458, 'psi': 0.899160991889862}-{'f1_val': 0.866048006710559, 'auprc': 0.982526533563787, 'loss_val': 0.3742373705324084, 'psi': 0.9126394174518502}
[S17] START round=23 head_norm_before_train=1.993738 (no previous merge yet)
[S17] round=23 local utility u=0.198135 metrics={'f1_val': 0.6397133637594266, 'auprc': 0.8785472005768163, 'loss_val': 0.8511144534111423, 'psi': 0.7352468984863825}-{'f1_val': 0.614601231866379, 'auprc': 0.8617921397575476, 'loss_val': 1.046446475520043, 'psi': 0.7134775950228465}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:38403
[S7] not sending this round → trigger blocked (psi=0.610)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38408
[S2] not sending this round → trigger blocked (psi=0.857)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:38411
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=0.3208
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.9973
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.7860
[S10] RECEIVED delta(kind=head bytes=1795) from S11
[S10] cosine check vs S11: cos=0.9890
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=-0.0749
[S6] DROPPED delta from S3 (cos=-0.0749 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S6
[S7] cosine check vs S6: cos=-0.0620
[S7] DROPPED delta from S6 (cos=-0.0620 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.735)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9866 head_norm=1.240606
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.479271e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9870 head_norm=1.266010 delta_norm=0.447927
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.4964 head_norm=1.670790
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.061116e+00
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.4462 head_norm=1.473465 delta_norm=1.061116
[S7] aggregate: ROLLBACK (f1_val pre=0.496 post=0.446 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.9625 head_norm=1.862186
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.836634e-02
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9852 head_norm=1.861184 delta_norm=0.068366
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9944 head_norm=1.950023
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.443118e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9939 head_norm=1.927852 delta_norm=0.144312
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.661637 cos_to_last_merge=0.8179 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.818
[S2] round=24 local utility u=0.024911 metrics={'f1_val': 0.8341060615314798, 'auprc': 0.8961646018767436, 'loss_val': 0.33050707147390346, 'psi': 0.8589294776695853}-{'f1_val': 0.8301506901307244, 'auprc': 0.8968285679581995, 'loss_val': 0.35858785999910503, 'psi': 0.8568218412617145}
[S3] START round=24 head_norm_before_train=1.861184 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9018252054327209, 'auprc': 0.9611041949119383, 'loss_val': 0.26253874709628683, 'psi': 0.9255368012244078}-{'f1_val': 0.9625264541981038, 'auprc': 0.9995523357704261, 'loss_val': 0.16764537310084354, 'psi': 0.9773368068270327}
[S4] START round=24 head_norm_before_train=1.437962 cos_to_last_merge=0.9996 (last merge round=22)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9312862348605015, 'auprc': 0.9756582363391579, 'loss_val': 0.23902573485894085, 'psi': 0.9490350354519641}-{'f1_val': 0.9335512694252552, 'auprc': 0.9772700942204942, 'loss_val': 0.21962873553181675, 'psi': 0.9510387993433508}
[S5] START round=24 head_norm_before_train=1.627968 cos_to_last_merge=0.9997 (last merge round=22)
[S5] round=24 local utility u=0.276766 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9656400205249314, 'loss_val': 0.32317684900294863, 'psi': 0.8064487986703208}-{'f1_val': 0.7006083926626743, 'auprc': 0.7939702262713982, 'loss_val': 0.36342151879505596, 'psi': 0.7379531261061638}
[S6] START round=24 head_norm_before_train=1.905033 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.6332563906075269, 'auprc': 0.9568547763968644, 'loss_val': 0.5869527939332526, 'psi': 0.7626957449232619}-{'f1_val': 0.7342852588779598, 'auprc': 0.9534266012601939, 'loss_val': 0.5980721019452555, 'psi': 0.8219417958308535}
[S7] START round=24 head_norm_before_train=1.473465 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.4942249330735188, 'auprc': 0.7774351709969417, 'loss_val': 0.9093978184707296, 'psi': 0.607509028242888}-{'f1_val': 0.4964080381511268, 'auprc': 0.7793052359556006, 'loss_val': 0.8780262232749692, 'psi': 0.6095669172729163}
[S8] START round=24 head_norm_before_train=1.266010 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.056564 metrics={'f1_val': 0.991479862271931, 'auprc': 0.9980815448750686, 'loss_val': 0.06472379496347973, 'psi': 0.9941205353131861}-{'f1_val': 0.9866483731271759, 'auprc': 0.9903418249619013, 'loss_val': 0.1256438934284853, 'psi': 0.9881257538610659}
[S9] START round=24 head_norm_before_train=1.862693 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9918452858557183, 'auprc': 0.9988442587604051, 'loss_val': 0.03197559326769164, 'psi': 0.994644875017593}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984603624886355, 'loss_val': 0.025268011532377482, 'psi': 0.9976458925027398}
[S10] START round=24 head_norm_before_train=1.927852 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9937298155689185, 'auprc': 0.9961319915820395, 'loss_val': 0.0748229885761412, 'psi': 0.9946906859741669}-{'f1_val': 0.9943563983784213, 'auprc': 0.9933413235577876, 'loss_val': 0.05275868222675991, 'psi': 0.9939503684501678}
[S11] START round=24 head_norm_before_train=1.916321 (no previous merge yet)
[S11] round=24 local utility u=0.004582 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9979319792731218, 'loss_val': 0.045204582176916336, 'psi': 0.9969681715223164}-{'f1_val': 0.996567470639547, 'auprc': 0.9977262936510309, 'loss_val': 0.05520263309526913, 'psi': 0.9970309998441407}
[S13] START round=24 head_norm_before_train=1.772647 (no previous merge yet)
[S13] round=24 local utility u=0.369770 metrics={'f1_val': 0.6648890070352323, 'auprc': 0.8231301349091482, 'loss_val': 0.7889589029703774, 'psi': 0.7281854581847986}-{'f1_val': 0.5933461088604223, 'auprc': 0.7495558254793455, 'loss_val': 0.8785186815018595, 'psi': 0.6558299955079916}
[S14] START round=24 head_norm_before_train=1.999187 cos_to_last_merge=0.9998 (last merge round=22)
[S14] round=24 local utility u=0.004989 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9950684318465477, 'loss_val': 0.04763364572828687, 'psi': 0.9964706905702096}-{'f1_val': 0.9972338922372435, 'auprc': 0.9950685355605942, 'loss_val': 0.056581373206410074, 'psi': 0.9963677495665838}
[S15] START round=24 head_norm_before_train=2.054037 (no previous merge yet)
[S15] round=24 local utility u=0.758879 metrics={'f1_val': 0.9934706406865853, 'auprc': 0.9953989995245205, 'loss_val': 0.044110689251625874, 'psi': 0.9942419842217594}-{'f1_val': 0.8054609399943726, 'auprc': 0.9762016580554618, 'loss_val': 0.3762178860217628, 'psi': 0.8737572272188083}
[S16] START round=24 head_norm_before_train=1.406711 cos_to_last_merge=0.9997 (last merge round=22)
[S16] round=24 local utility u=0.382463 metrics={'f1_val': 0.9385933003436591, 'auprc': 0.9940050274688457, 'loss_val': 0.24993205154846776, 'psi': 0.9607579911937336}-{'f1_val': 0.8413348494518017, 'auprc': 0.9859002055469523, 'loss_val': 0.4069929700370458, 'psi': 0.899160991889862}
[S17] START round=24 head_norm_before_train=2.016056 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.5936069004049013, 'auprc': 0.7579410701082817, 'loss_val': 1.1443417052204472, 'psi': 0.6593405682862534}-{'f1_val': 0.6397133637594266, 'auprc': 0.8785472005768163, 'loss_val': 0.8511144534111423, 'psi': 0.7352468984863825}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:38416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:38408
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] cosine check vs S2: cos=0.9926
[S7] RECEIVED delta(kind=head bytes=1804) from S15
[S7] cosine check vs S15: cos=0.5806
[S4] RECEIVED delta(kind=head bytes=1794) from S16
[S4] cosine check vs S16: cos=0.9913
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.9708
[S16] RECEIVED delta(kind=head bytes=1807) from S13
[S16] cosine check vs S13: cos=-0.0638
[S16] DROPPED delta from S13 (cos=-0.0638 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.1014
[S3] DROPPED delta from S5 (cos=-0.1014 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=-0.0034
[S13] DROPPED delta from S14 (cos=-0.0034 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9313 head_norm=1.465190
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.660345e-02
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9313 head_norm=1.449871 delta_norm=0.096603
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.4942 head_norm=1.487923
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.560457e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.5664 head_norm=1.588736 delta_norm=0.856046
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7003 head_norm=1.645740
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.034066e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7003 head_norm=1.663672 delta_norm=0.103407
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9386 head_norm=1.440880
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.780509e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9384 head_norm=1.366696 delta_norm=0.178051
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.687760 cos_to_last_merge=0.8166 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.8345394577240689, 'auprc': 0.8731214223953843, 'loss_val': 0.3360504310995844, 'psi': 0.849972243592595}-{'f1_val': 0.8341060615314798, 'auprc': 0.8961646018767436, 'loss_val': 0.33050707147390346, 'psi': 0.8589294776695853}
[S3] START round=25 head_norm_before_train=1.880854 cos_to_last_merge=0.9998 (last merge round=23)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.8743285133470998, 'auprc': 0.9585623458219406, 'loss_val': 0.2584364042766041, 'psi': 0.9080220463370361}-{'f1_val': 0.9018252054327209, 'auprc': 0.9611041949119383, 'loss_val': 0.26253874709628683, 'psi': 0.9255368012244078}
[S4] START round=25 head_norm_before_train=1.449871 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9302380361536651, 'auprc': 0.9522515845567241, 'loss_val': 0.2402487968447304, 'psi': 0.9390434555148887}-{'f1_val': 0.9312862348605015, 'auprc': 0.9756582363391579, 'loss_val': 0.23902573485894085, 'psi': 0.9490350354519641}
[S5] START round=25 head_norm_before_train=1.663672 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.848329334908144, 'loss_val': 0.3555823479918623, 'psi': 0.7596967695608622}-{'f1_val': 0.7003213174339138, 'auprc': 0.9656400205249314, 'loss_val': 0.32317684900294863, 'psi': 0.8064487986703208}
[S6] START round=25 head_norm_before_train=1.914881 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6015934343927506, 'auprc': 0.9139294529225552, 'loss_val': 1.1177176116012941, 'psi': 0.7265278418046724}-{'f1_val': 0.6332563906075269, 'auprc': 0.9568547763968644, 'loss_val': 0.5869527939332526, 'psi': 0.7626957449232619}
[S7] START round=25 head_norm_before_train=1.588736 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.075182 metrics={'f1_val': 0.5098535859797793, 'auprc': 0.7793681906570351, 'loss_val': 0.8586056179334393, 'psi': 0.6176594278506816}-{'f1_val': 0.4942249330735188, 'auprc': 0.7774351709969417, 'loss_val': 0.9093978184707296, 'psi': 0.607509028242888}
[S8] START round=25 head_norm_before_train=1.312626 cos_to_last_merge=0.9996 (last merge round=23)
[S8] round=25 local utility u=0.005548 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9947988551382543, 'loss_val': 0.05574570893811087, 'psi': 0.9940040372330301}-{'f1_val': 0.991479862271931, 'auprc': 0.9980815448750686, 'loss_val': 0.06472379496347973, 'psi': 0.9941205353131861}
[S9] START round=25 head_norm_before_train=1.876913 (no previous merge yet)
[S9] round=25 local utility u=0.020083 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988344697685898, 'loss_val': 0.023325126758525536, 'psi': 0.9977955354147217}-{'f1_val': 0.9918452858557183, 'auprc': 0.9988442587604051, 'loss_val': 0.03197559326769164, 'psi': 0.994644875017593}
[S10] START round=25 head_norm_before_train=1.951878 cos_to_last_merge=0.9997 (last merge round=23)
[S10] round=25 local utility u=0.005080 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9919050399604024, 'loss_val': 0.06073048139773727, 'psi': 0.9938747193957858}-{'f1_val': 0.9937298155689185, 'auprc': 0.9961319915820395, 'loss_val': 0.0748229885761412, 'psi': 0.9946906859741669}
[S11] START round=25 head_norm_before_train=1.941021 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.990361301613317, 'auprc': 0.9981631642428845, 'loss_val': 0.09856230699528708, 'psi': 0.9934820466651441}-{'f1_val': 0.9963256330217796, 'auprc': 0.9979319792731218, 'loss_val': 0.045204582176916336, 'psi': 0.9969681715223164}
[S13] START round=25 head_norm_before_train=1.783365 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6568182855682737, 'auprc': 0.8204767310509631, 'loss_val': 0.7954137373138238, 'psi': 0.7222816637613494}-{'f1_val': 0.6648890070352323, 'auprc': 0.8231301349091482, 'loss_val': 0.7889589029703774, 'psi': 0.7281854581847986}
[S14] START round=25 head_norm_before_train=2.022614 cos_to_last_merge=0.9994 (last merge round=22)
[S14] round=25 local utility u=0.008869 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9967810971901876, 'loss_val': 0.03796282863893918, 'psi': 0.9974487423124039}-{'f1_val': 0.9974055297193176, 'auprc': 0.9950684318465477, 'loss_val': 0.04763364572828687, 'psi': 0.9964706905702096}
[S15] START round=25 head_norm_before_train=2.073616 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7775870137937975, 'auprc': 0.9562853554097669, 'loss_val': 0.46135759247251473, 'psi': 0.8490663504401852}-{'f1_val': 0.9934706406865853, 'auprc': 0.9953989995245205, 'loss_val': 0.044110689251625874, 'psi': 0.9942419842217594}
[S16] START round=25 head_norm_before_train=1.366696 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8622944290217385, 'auprc': 0.9895209876764961, 'loss_val': 0.612209914547226, 'psi': 0.9131850524836416}-{'f1_val': 0.9385933003436591, 'auprc': 0.9940050274688457, 'loss_val': 0.24993205154846776, 'psi': 0.9607579911937336}
[S17] START round=25 head_norm_before_train=2.035654 (no previous merge yet)
[S17] round=25 local utility u=0.207083 metrics={'f1_val': 0.6157849301138741, 'auprc': 0.893374470893903, 'loss_val': 1.2695444009666117, 'psi': 0.7268207464258857}-{'f1_val': 0.5936069004049013, 'auprc': 0.7579410701082817, 'loss_val': 1.1443417052204472, 'psi': 0.6593405682862534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:38403
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:38413
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:38409
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.9906
[S13] RECEIVED delta(kind=head bytes=1800) from S14
[S13] cosine check vs S14: cos=-0.0056
[S13] DROPPED delta from S14 (cos=-0.0056 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] cosine check vs S9: cos=0.9973
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] cosine check vs S7: cos=0.5432
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.4285
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.9954
[S15] ⇄ pheromone p=0.337 → S7@127.0.0.1:38408
[S2] ⇄ pheromone p=0.077 → S5@127.0.0.1:38405
[S13] ⇄ pheromone p=0.174 → S16@127.0.0.1:38416
[S6] ⇄ pheromone p=0.105 → S7@127.0.0.1:38408
[S5] ⇄ pheromone p=0.134 → S3@127.0.0.1:38403
[S4] ⇄ pheromone p=0.045 → S8@127.0.0.1:38409
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.8743 head_norm=1.904081
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.026843e-02
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.8653 head_norm=1.896325 delta_norm=0.070268
[S3] aggregate: ROLLBACK (f1_val pre=0.874 post=0.865 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.140 → S6@127.0.0.1:38407
[S11] ⇄ pheromone p=0.046 → S10@127.0.0.1:38411
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.5099 head_norm=1.601013
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.697237e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.4496 head_norm=1.515670 delta_norm=0.969724
[S7] aggregate: ROLLBACK (f1_val pre=0.510 post=0.450 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.136 → S8@127.0.0.1:38409
[S10] ⇄ pheromone p=0.021 → S7@127.0.0.1:38408
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9935 head_norm=1.352170
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.140960e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9935 head_norm=1.298411 delta_norm=0.714096
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.029 → S16@127.0.0.1:38416
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9979 head_norm=2.042159
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.832901e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9979 head_norm=2.045092 delta_norm=0.098329
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.046 → S13@127.0.0.1:38413
[S9] ⇄ pheromone p=0.029 → S3@127.0.0.1:38403
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8623 head_norm=1.404565
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.806042e-02
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8619 head_norm=1.375125 delta_norm=0.098060
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.241 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.154 → S14@127.0.0.1:38414
[S2] START round=26 head_norm_before_train=1.709887 cos_to_last_merge=0.8151 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7755256581558374, 'auprc': 0.8321064573914166, 'loss_val': 0.5278703604872348, 'psi': 0.7981579778500691}-{'f1_val': 0.8345394577240689, 'auprc': 0.8731214223953843, 'loss_val': 0.3360504310995844, 'psi': 0.849972243592595}
[S3] START round=26 head_norm_before_train=1.896325 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.7314373215006691, 'auprc': 0.8311110212081223, 'loss_val': 0.41183234476320374, 'psi': 0.7713068013836504}-{'f1_val': 0.8743285133470998, 'auprc': 0.9585623458219406, 'loss_val': 0.2584364042766041, 'psi': 0.9080220463370361}
[S4] START round=26 head_norm_before_train=1.471283 cos_to_last_merge=0.9998 (last merge round=24)
[S4] round=26 local utility u=0.136253 metrics={'f1_val': 0.9460726614967601, 'auprc': 0.9901873867970813, 'loss_val': 0.17655732181168524, 'psi': 0.9637185516168885}-{'f1_val': 0.9302380361536651, 'auprc': 0.9522515845567241, 'loss_val': 0.2402487968447304, 'psi': 0.9390434555148887}
[S5] START round=26 head_norm_before_train=1.675079 cos_to_last_merge=0.9999 (last merge round=24)
[S5] round=26 local utility u=0.056746 metrics={'f1_val': 0.7003686869375041, 'auprc': 0.8866438864851841, 'loss_val': 0.35559572808992945, 'psi': 0.7748787667565762}-{'f1_val': 0.7006083926626743, 'auprc': 0.848329334908144, 'loss_val': 0.3555823479918623, 'psi': 0.7596967695608622}
[S6] START round=26 head_norm_before_train=1.922651 (no previous merge yet)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.943455028684889, 'auprc': 0.9778705858261406, 'loss_val': 0.1972463965814921, 'psi': 0.9572212515413896}-{'f1_val': 0.6015934343927506, 'auprc': 0.9139294529225552, 'loss_val': 1.1177176116012941, 'psi': 0.7265278418046724}
[S7] START round=26 head_norm_before_train=1.515670 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.41489813676695064, 'auprc': 0.7648430930544811, 'loss_val': 1.116521189690607, 'psi': 0.5548761192819628}-{'f1_val': 0.5098535859797793, 'auprc': 0.7793681906570351, 'loss_val': 0.8586056179334393, 'psi': 0.6176594278506816}
[S8] START round=26 head_norm_before_train=1.298411 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9911282975647199, 'auprc': 0.9980140283402159, 'loss_val': 0.10681034798497756, 'psi': 0.9938825898749184}-{'f1_val': 0.9934741586295472, 'auprc': 0.9947988551382543, 'loss_val': 0.05574570893811087, 'psi': 0.9940040372330301}
[S9] START round=26 head_norm_before_train=1.891150 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963955584607271, 'loss_val': 0.022787883051486747, 'psi': 0.9968199708915766}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988344697685898, 'loss_val': 0.023325126758525536, 'psi': 0.9977955354147217}
[S10] START round=26 head_norm_before_train=1.977877 cos_to_last_merge=0.9989 (last merge round=23)
[S10] round=26 local utility u=0.008578 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9938679321011419, 'loss_val': 0.045510894188407626, 'psi': 0.9942646369194934}-{'f1_val': 0.9951878390193748, 'auprc': 0.9919050399604024, 'loss_val': 0.06073048139773727, 'psi': 0.9938747193957858}
[S11] START round=26 head_norm_before_train=1.962211 (no previous merge yet)
[S11] round=26 local utility u=0.046808 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9982740085999219, 'loss_val': 0.04003602839994263, 'psi': 0.997002088286416}-{'f1_val': 0.990361301613317, 'auprc': 0.9981631642428845, 'loss_val': 0.09856230699528708, 'psi': 0.9934820466651441}
[S13] START round=26 head_norm_before_train=1.793372 (no previous merge yet)
[S13] round=26 local utility u=0.133728 metrics={'f1_val': 0.6886678690079546, 'auprc': 0.8160485120347228, 'loss_val': 0.7057697612194308, 'psi': 0.7396201262186619}-{'f1_val': 0.6568182855682737, 'auprc': 0.8204767310509631, 'loss_val': 0.7954137373138238, 'psi': 0.7222816637613494}
[S14] START round=26 head_norm_before_train=2.045092 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9968753493390001, 'loss_val': 0.04351101482873811, 'psi': 0.9968166043070619}-{'f1_val': 0.9978938390605482, 'auprc': 0.9967810971901876, 'loss_val': 0.03796282863893918, 'psi': 0.9974487423124039}
[S15] START round=26 head_norm_before_train=2.092537 (no previous merge yet)
[S15] round=26 local utility u=0.928565 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9937864440233236, 'loss_val': 0.029203445704938453, 'psi': 0.995314024118614}-{'f1_val': 0.7775870137937975, 'auprc': 0.9562853554097669, 'loss_val': 0.46135759247251473, 'psi': 0.8490663504401852}
[S16] START round=26 head_norm_before_train=1.375125 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.380955 metrics={'f1_val': 0.9352564326094533, 'auprc': 0.9933559402275479, 'loss_val': 0.29957587761646925, 'psi': 0.9584962356566912}-{'f1_val': 0.8622944290217385, 'auprc': 0.9895209876764961, 'loss_val': 0.612209914547226, 'psi': 0.9131850524836416}
[S17] START round=26 head_norm_before_train=2.052736 (no previous merge yet)
[S17] round=26 local utility u=0.030244 metrics={'f1_val': 0.6107128750743291, 'auprc': 0.9360097054638433, 'loss_val': 1.3065294083205592, 'psi': 0.7408316072301349}-{'f1_val': 0.6157849301138741, 'auprc': 0.893374470893903, 'loss_val': 1.2695444009666117, 'psi': 0.7268207464258857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:38411
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=-0.0593
[S7] DROPPED delta from S6 (cos=-0.0593 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S11
[S10] cosine check vs S11: cos=0.9894
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=-0.0578
[S16] DROPPED delta from S13 (cos=-0.0578 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.5239
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0985
[S3] DROPPED delta from S5 (cos=-0.0985 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S4
[S8] cosine check vs S4: cos=0.7223
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=0.9800
[S17] not sending this round → trigger blocked (psi=0.741)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.4149 head_norm=1.530306
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.215371e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4215 head_norm=1.592630 delta_norm=0.921537
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9945 head_norm=2.004983
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.453819e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9943 head_norm=1.986326 delta_norm=0.145382
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9911 head_norm=1.346928
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.343165e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9915 head_norm=1.319771 delta_norm=0.534316
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9461 head_norm=1.496784
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.509338e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9473 head_norm=1.449344 delta_norm=0.150934
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.729736 cos_to_last_merge=0.8135 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.813
[S2] round=27 local utility u=0.366837 metrics={'f1_val': 0.8283986177122109, 'auprc': 0.9225376782439295, 'loss_val': 0.38272738863674827, 'psi': 0.8660542419248983}-{'f1_val': 0.7755256581558374, 'auprc': 0.8321064573914166, 'loss_val': 0.5278703604872348, 'psi': 0.7981579778500691}
[S3] START round=27 head_norm_before_train=1.919999 cos_to_last_merge=0.9998 (last merge round=25)
[S3] round=27 local utility u=0.342734 metrics={'f1_val': 0.8124673109971792, 'auprc': 0.8602755104642413, 'loss_val': 0.3000385685026093, 'psi': 0.831590590784004}-{'f1_val': 0.7314373215006691, 'auprc': 0.8311110212081223, 'loss_val': 0.41183234476320374, 'psi': 0.7713068013836504}
[S4] START round=27 head_norm_before_train=1.449344 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9498455684772807, 'auprc': 0.9827906402506756, 'loss_val': 0.22209851821536566, 'psi': 0.9630235971866388}-{'f1_val': 0.9460726614967601, 'auprc': 0.9901873867970813, 'loss_val': 0.17655732181168524, 'psi': 0.9637185516168885}
[S5] START round=27 head_norm_before_train=1.688038 cos_to_last_merge=0.9997 (last merge round=24)
[S5] round=27 local utility u=0.201631 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9965156774607739, 'loss_val': 0.28166414399576833, 'psi': 0.8187990614446579}-{'f1_val': 0.7003686869375041, 'auprc': 0.8866438864851841, 'loss_val': 0.35559572808992945, 'psi': 0.7748787667565762}
[S6] START round=27 head_norm_before_train=1.933094 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6076884767810325, 'auprc': 0.9323265042430334, 'loss_val': 0.7597417366203228, 'psi': 0.7375436877658329}-{'f1_val': 0.943455028684889, 'auprc': 0.9778705858261406, 'loss_val': 0.1972463965814921, 'psi': 0.9572212515413896}
[S7] START round=27 head_norm_before_train=1.592630 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.782035 metrics={'f1_val': 0.598954248530986, 'auprc': 0.783864472303095, 'loss_val': 0.7138524936726174, 'psi': 0.6729183380398296}-{'f1_val': 0.41489813676695064, 'auprc': 0.7648430930544811, 'loss_val': 1.116521189690607, 'psi': 0.5548761192819628}
[S8] START round=27 head_norm_before_train=1.319771 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.026905 metrics={'f1_val': 0.991479862271931, 'auprc': 0.998117458368142, 'loss_val': 0.05541925552364832, 'psi': 0.9941349007104154}-{'f1_val': 0.9911282975647199, 'auprc': 0.9980140283402159, 'loss_val': 0.10681034798497756, 'psi': 0.9938825898749184}
[S9] START round=27 head_norm_before_train=1.905695 (no previous merge yet)
[S9] round=27 local utility u=0.002332 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9976240032076619, 'loss_val': 0.02180984228025419, 'psi': 0.9973113487903504}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963955584607271, 'loss_val': 0.022787883051486747, 'psi': 0.9968199708915766}
[S10] START round=27 head_norm_before_train=1.986326 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9966674680543681, 'loss_val': 0.0535936004189963, 'psi': 0.9945702435276771}-{'f1_val': 0.9945291067983943, 'auprc': 0.9938679321011419, 'loss_val': 0.045510894188407626, 'psi': 0.9942646369194934}
[S11] START round=27 head_norm_before_train=1.978206 (no previous merge yet)
[S11] round=27 local utility u=0.002619 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9980476096733741, 'loss_val': 0.036598026766776, 'psi': 0.9971595262530779}-{'f1_val': 0.9961541414107454, 'auprc': 0.9982740085999219, 'loss_val': 0.04003602839994263, 'psi': 0.997002088286416}
[S13] START round=27 head_norm_before_train=1.802594 (no previous merge yet)
[S13] round=27 local utility u=0.036998 metrics={'f1_val': 0.6982695088029728, 'auprc': 0.7983420437998113, 'loss_val': 0.6362650069134644, 'psi': 0.7382985228017083}-{'f1_val': 0.6886678690079546, 'auprc': 0.8160485120347228, 'loss_val': 0.7057697612194308, 'psi': 0.7396201262186619}
[S14] START round=27 head_norm_before_train=2.061131 cos_to_last_merge=0.9999 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9951603362423194, 'loss_val': 0.04080445695650197, 'psi': 0.9962626393915268}-{'f1_val': 0.9967774409524363, 'auprc': 0.9968753493390001, 'loss_val': 0.04351101482873811, 'psi': 0.9968166043070619}
[S15] START round=27 head_norm_before_train=2.104654 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.9190761593704324, 'auprc': 0.992589237184054, 'loss_val': 0.12173007061913037, 'psi': 0.9484813904958811}-{'f1_val': 0.9963324108488076, 'auprc': 0.9937864440233236, 'loss_val': 0.029203445704938453, 'psi': 0.995314024118614}
[S16] START round=27 head_norm_before_train=1.416474 cos_to_last_merge=0.9996 (last merge round=25)
[S16] round=27 local utility u=0.172335 metrics={'f1_val': 0.9686656125250013, 'auprc': 0.9921899332504847, 'loss_val': 0.15186215023164742, 'psi': 0.9780753408151946}-{'f1_val': 0.9352564326094533, 'auprc': 0.9933559402275479, 'loss_val': 0.29957587761646925, 'psi': 0.9584962356566912}
[S17] START round=27 head_norm_before_train=2.063487 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6278244352715806, 'auprc': 0.7993180624652116, 'loss_val': 1.1284321368116577, 'psi': 0.696421886149033}-{'f1_val': 0.6107128750743291, 'auprc': 0.9360097054638433, 'loss_val': 1.3065294083205592, 'psi': 0.7408316072301349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:38409
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.978)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → trigger blocked (psi=0.738)
[S5] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=0.9973
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=0.9931
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=-0.0740
[S6] DROPPED delta from S3 (cos=-0.0740 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1806) from S7
[S8] cosine check vs S7: cos=0.6238
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.9818
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.7003 head_norm=1.704092
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.033069e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.7003 head_norm=1.720470 delta_norm=0.103307
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9915 head_norm=1.376250
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.554382e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9915 head_norm=1.345341 delta_norm=0.655438
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.8125 head_norm=1.943272
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.229974e-02
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.8134 head_norm=1.930548 delta_norm=0.072300
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9687 head_norm=1.459235
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.412720e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9680 head_norm=1.411296 delta_norm=0.141272
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.742828 cos_to_last_merge=0.8121 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.8251837936461749, 'auprc': 0.7593767148959774, 'loss_val': 0.41690383606575987, 'psi': 0.7988609621460958}-{'f1_val': 0.8283986177122109, 'auprc': 0.9225376782439295, 'loss_val': 0.38272738863674827, 'psi': 0.8660542419248983}
[S3] START round=28 head_norm_before_train=1.930548 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.432729 metrics={'f1_val': 0.8834629145903695, 'auprc': 0.9771315209485469, 'loss_val': 0.21112180057672805, 'psi': 0.9209303571336405}-{'f1_val': 0.8124673109971792, 'auprc': 0.8602755104642413, 'loss_val': 0.3000385685026093, 'psi': 0.831590590784004}
[S4] START round=28 head_norm_before_train=1.476753 cos_to_last_merge=0.9997 (last merge round=26)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9416581067575003, 'auprc': 0.9667602743599414, 'loss_val': 0.20354757232996062, 'psi': 0.9516989737984767}-{'f1_val': 0.9498455684772807, 'auprc': 0.9827906402506756, 'loss_val': 0.22209851821536566, 'psi': 0.9630235971866388}
[S5] START round=28 head_norm_before_train=1.720470 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.4493807447902495, 'auprc': 0.7840519158885474, 'loss_val': 0.8618785149979564, 'psi': 0.5832492132295686}-{'f1_val': 0.7003213174339138, 'auprc': 0.9965156774607739, 'loss_val': 0.28166414399576833, 'psi': 0.8187990614446579}
[S6] START round=28 head_norm_before_train=1.937595 (no previous merge yet)
[S6] round=28 local utility u=0.810394 metrics={'f1_val': 0.8112963492449926, 'auprc': 0.961932095122043, 'loss_val': 0.4494170240488949, 'psi': 0.8715506475958128}-{'f1_val': 0.6076884767810325, 'auprc': 0.9323265042430334, 'loss_val': 0.7597417366203228, 'psi': 0.7375436877658329}
[S7] START round=28 head_norm_before_train=1.607801 cos_to_last_merge=0.9998 (last merge round=26)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.39284828454323506, 'auprc': 0.7712453431028623, 'loss_val': 1.1552222778710552, 'psi': 0.5442071079670859}-{'f1_val': 0.598954248530986, 'auprc': 0.783864472303095, 'loss_val': 0.7138524936726174, 'psi': 0.6729183380398296}
[S8] START round=28 head_norm_before_train=1.345341 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9900949094517795, 'loss_val': 0.08981500464948222, 'psi': 0.9923512331490985}-{'f1_val': 0.991479862271931, 'auprc': 0.998117458368142, 'loss_val': 0.05541925552364832, 'psi': 0.9941349007104154}
[S9] START round=28 head_norm_before_train=1.920463 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9988463709500799, 'loss_val': 0.04591354034336517, 'psi': 0.9923557530561933}-{'f1_val': 0.9971029125121428, 'auprc': 0.9976240032076619, 'loss_val': 0.02180984228025419, 'psi': 0.9973113487903504}
[S10] START round=28 head_norm_before_train=2.015063 cos_to_last_merge=0.9997 (last merge round=26)
[S10] round=28 local utility u=0.004515 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9932837682633143, 'loss_val': 0.04255419384468173, 'psi': 0.9940309713843624}-{'f1_val': 0.9931720938432163, 'auprc': 0.9966674680543681, 'loss_val': 0.0535936004189963, 'psi': 0.9945702435276771}
[S11] START round=28 head_norm_before_train=1.997771 (no previous merge yet)
[S11] round=28 local utility u=0.000833 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9976631643657901, 'loss_val': 0.0352281356881581, 'psi': 0.9971507756020633}-{'f1_val': 0.996567470639547, 'auprc': 0.9980476096733741, 'loss_val': 0.036598026766776, 'psi': 0.9971595262530779}
[S13] START round=28 head_norm_before_train=1.814691 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6257199864146616, 'auprc': 0.7032712383777459, 'loss_val': 0.99812377723284, 'psi': 0.6567404871998954}-{'f1_val': 0.6982695088029728, 'auprc': 0.7983420437998113, 'loss_val': 0.6362650069134644, 'psi': 0.7382985228017083}
[S14] START round=28 head_norm_before_train=2.076658 cos_to_last_merge=0.9997 (last merge round=25)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9965782863767634, 'loss_val': 0.04631553711952713, 'psi': 0.9964733649545063}-{'f1_val': 0.9969975081576651, 'auprc': 0.9951603362423194, 'loss_val': 0.04080445695650197, 'psi': 0.9962626393915268}
[S15] START round=28 head_norm_before_train=2.119725 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8783409192232967, 'auprc': 0.992924180512128, 'loss_val': 0.21543132188943748, 'psi': 0.9241742237388292}-{'f1_val': 0.9190761593704324, 'auprc': 0.992589237184054, 'loss_val': 0.12173007061913037, 'psi': 0.9484813904958811}
[S16] START round=28 head_norm_before_train=1.411296 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.918323523417676, 'auprc': 0.990750577155922, 'loss_val': 0.3835240014380781, 'psi': 0.9472943449129745}-{'f1_val': 0.9686656125250013, 'auprc': 0.9921899332504847, 'loss_val': 0.15186215023164742, 'psi': 0.9780753408151946}
[S17] START round=28 head_norm_before_train=2.073246 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.601212324540926, 'auprc': 0.743329823253742, 'loss_val': 1.164634922219383, 'psi': 0.6580593240260524}-{'f1_val': 0.6278244352715806, 'auprc': 0.7993180624652116, 'loss_val': 1.1284321368116577, 'psi': 0.696421886149033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.921)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.4569
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=0.9925
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=-0.0622
[S7] DROPPED delta from S6 (cos=-0.0622 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.3928 head_norm=1.623295
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.716744e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.3835 head_norm=1.568118 delta_norm=0.971674
[S7] aggregate: ROLLBACK (f1_val pre=0.393 post=0.384 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9945 head_norm=2.042352
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.249185e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9945 head_norm=2.027071 delta_norm=0.124919
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.754876 cos_to_last_merge=0.8107 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.811
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7965763460465809, 'auprc': 0.7677224416691457, 'loss_val': 0.4923701678308763, 'psi': 0.7850347842956069}-{'f1_val': 0.8251837936461749, 'auprc': 0.7593767148959774, 'loss_val': 0.41690383606575987, 'psi': 0.7988609621460958}
[S3] START round=29 head_norm_before_train=1.953546 cos_to_last_merge=0.9998 (last merge round=27)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.6390190483549487, 'auprc': 0.8148500198848886, 'loss_val': 0.6581776709064511, 'psi': 0.7093514369669247}-{'f1_val': 0.8834629145903695, 'auprc': 0.9771315209485469, 'loss_val': 0.21112180057672805, 'psi': 0.9209303571336405}
[S4] START round=29 head_norm_before_train=1.508334 cos_to_last_merge=0.9985 (last merge round=26)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9405577639666673, 'auprc': 0.9517937788744355, 'loss_val': 0.22099199596198826, 'psi': 0.9450521699297747}-{'f1_val': 0.9416581067575003, 'auprc': 0.9667602743599414, 'loss_val': 0.20354757232996062, 'psi': 0.9516989737984767}
[S5] START round=29 head_norm_before_train=1.735917 cos_to_last_merge=0.9996 (last merge round=27)
[S5] round=29 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.990991206328318, 'loss_val': 0.28638111709507474, 'psi': 0.8165892729916755}-{'f1_val': 0.4493807447902495, 'auprc': 0.7840519158885474, 'loss_val': 0.8618785149979564, 'psi': 0.5832492132295686}
[S6] START round=29 head_norm_before_train=1.949798 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.805487250786483, 'auprc': 0.9284819743553244, 'loss_val': 0.5932634119759214, 'psi': 0.8546851402140196}-{'f1_val': 0.8112963492449926, 'auprc': 0.961932095122043, 'loss_val': 0.4494170240488949, 'psi': 0.8715506475958128}
[S7] START round=29 head_norm_before_train=1.568118 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.6532888932294504, 'auprc': 0.7990185762403229, 'loss_val': 0.5741656786595993, 'psi': 0.7115807664337994}-{'f1_val': 0.39284828454323506, 'auprc': 0.7712453431028623, 'loss_val': 1.1552222778710552, 'psi': 0.5442071079670859}
[S8] START round=29 head_norm_before_train=1.403583 cos_to_last_merge=0.9987 (last merge round=27)
[S8] round=29 local utility u=0.003692 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.986781808432833, 'loss_val': 0.06908897794031041, 'psi': 0.9906857193171003}-{'f1_val': 0.9938554489473111, 'auprc': 0.9900949094517795, 'loss_val': 0.08981500464948222, 'psi': 0.9923512331490985}
[S9] START round=29 head_norm_before_train=1.934276 (no previous merge yet)
[S9] round=29 local utility u=0.035962 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963268349802974, 'loss_val': 0.020877146876194994, 'psi': 0.9967924814994047}-{'f1_val': 0.9880286744602689, 'auprc': 0.9988463709500799, 'loss_val': 0.04591354034336517, 'psi': 0.9923557530561933}
[S10] START round=29 head_norm_before_train=2.027071 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9941016915870836, 'loss_val': 0.04701690306874825, 'psi': 0.993700301527377}-{'f1_val': 0.9945291067983943, 'auprc': 0.9932837682633143, 'loss_val': 0.04255419384468173, 'psi': 0.9940309713843624}
[S11] START round=29 head_norm_before_train=2.019415 (no previous merge yet)
[S11] round=29 local utility u=0.001447 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979162090984577, 'loss_val': 0.03164303941169504, 'psi': 0.9971069660231113}-{'f1_val': 0.9968091830929121, 'auprc': 0.9976631643657901, 'loss_val': 0.0352281356881581, 'psi': 0.9971507756020633}
[S13] START round=29 head_norm_before_train=1.823305 (no previous merge yet)
[S13] round=29 local utility u=1.000000 metrics={'f1_val': 0.812100145728301, 'auprc': 0.8418198050039601, 'loss_val': 0.47410182519133465, 'psi': 0.8239880094385647}-{'f1_val': 0.6257199864146616, 'auprc': 0.7032712383777459, 'loss_val': 0.99812377723284, 'psi': 0.6567404871998954}
[S14] START round=29 head_norm_before_train=2.090781 cos_to_last_merge=0.9995 (last merge round=25)
[S14] round=29 local utility u=0.010473 metrics={'f1_val': 0.9966327432458837, 'auprc': 0.998660153088615, 'loss_val': 0.03299082137345223, 'psi': 0.9974437071829763}-{'f1_val': 0.9964034173396682, 'auprc': 0.9965782863767634, 'loss_val': 0.04631553711952713, 'psi': 0.9964733649545063}
[S15] START round=29 head_norm_before_train=2.131608 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.802646649435898, 'auprc': 0.9624170688506888, 'loss_val': 0.41627315471739423, 'psi': 0.8665548172018144}-{'f1_val': 0.8783409192232967, 'auprc': 0.992924180512128, 'loss_val': 0.21543132188943748, 'psi': 0.9241742237388292}
[S16] START round=29 head_norm_before_train=1.449413 cos_to_last_merge=0.9997 (last merge round=27)
[S16] round=29 local utility u=0.121129 metrics={'f1_val': 0.9264111695174173, 'auprc': 0.9891888349811251, 'loss_val': 0.18510667014171525, 'psi': 0.9515222357029004}-{'f1_val': 0.918323523417676, 'auprc': 0.990750577155922, 'loss_val': 0.3835240014380781, 'psi': 0.9472943449129745}
[S17] START round=29 head_norm_before_train=2.088941 (no previous merge yet)
[S17] round=29 local utility u=0.515952 metrics={'f1_val': 0.6752474666497503, 'auprc': 0.842083054374051, 'loss_val': 0.8732012340758258, 'psi': 0.7419817017394705}-{'f1_val': 0.601212324540926, 'auprc': 0.743329823253742, 'loss_val': 1.164634922219383, 'psi': 0.6580593240260524}
[S11] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:38416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:38409
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:38413
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.9799
[S13] RECEIVED delta(kind=head bytes=1799) from S14
[S13] cosine check vs S14: cos=-0.0063
[S13] DROPPED delta from S14 (cos=-0.0063 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1807) from S8
[S16] cosine check vs S8: cos=0.8622
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] cosine check vs S13: cos=-0.0583
[S16] DROPPED delta from S13 (cos=-0.0583 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.9976
[S3] RECEIVED delta(kind=head bytes=1807) from S5
[S3] cosine check vs S5: cos=-0.0953
[S3] DROPPED delta from S5 (cos=-0.0953 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1808) from S7
[S8] cosine check vs S7: cos=0.7499
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=0.9961
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9406 head_norm=1.541443
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.543030e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9406 head_norm=1.506017 delta_norm=0.154303
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.6390 head_norm=1.974820
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.880591e-02
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.6390 head_norm=1.960106 delta_norm=0.068806
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9933 head_norm=1.463411
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.405454e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9931 head_norm=1.422748 delta_norm=0.540545
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9966 head_norm=2.103400
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.263708e-02
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9966 head_norm=2.102552 delta_norm=0.092637
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9264 head_norm=1.485850
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.872438e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9335 head_norm=1.422921 delta_norm=0.387244
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.769774 cos_to_last_merge=0.8098 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=30 local utility u=0.173139 metrics={'f1_val': 0.8313449799726721, 'auprc': 0.7808556387857739, 'loss_val': 0.39410322141668663, 'psi': 0.8111492434979128}-{'f1_val': 0.7965763460465809, 'auprc': 0.7677224416691457, 'loss_val': 0.4923701678308763, 'psi': 0.7850347842956069}
[S3] START round=30 head_norm_before_train=1.960106 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=1.000000 metrics={'f1_val': 0.8426187617446292, 'auprc': 0.9446876779527658, 'loss_val': 0.2464020707332291, 'psi': 0.8834463282278838}-{'f1_val': 0.6390190483549487, 'auprc': 0.8148500198848886, 'loss_val': 0.6581776709064511, 'psi': 0.7093514369669247}
[S4] START round=30 head_norm_before_train=1.506017 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9403510789994421, 'auprc': 0.9339890316003401, 'loss_val': 0.26902322775678905, 'psi': 0.9378062600398014}-{'f1_val': 0.9405577639666673, 'auprc': 0.9517937788744355, 'loss_val': 0.22099199596198826, 'psi': 0.9450521699297747}
[S5] START round=30 head_norm_before_train=1.747740 cos_to_last_merge=0.9992 (last merge round=27)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6755459935462937, 'auprc': 0.8603779009163548, 'loss_val': 0.38234476578524523, 'psi': 0.7494787564943182}-{'f1_val': 0.7003213174339138, 'auprc': 0.990991206328318, 'loss_val': 0.28638111709507474, 'psi': 0.8165892729916755}
[S6] START round=30 head_norm_before_train=1.958289 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.5914092187723196, 'auprc': 0.8588569101597016, 'loss_val': 0.9319768830001486, 'psi': 0.6983882953272724}-{'f1_val': 0.805487250786483, 'auprc': 0.9284819743553244, 'loss_val': 0.5932634119759214, 'psi': 0.8546851402140196}
[S7] START round=30 head_norm_before_train=1.578363 cos_to_last_merge=0.9999 (last merge round=28)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5257036943446212, 'auprc': 0.7801333134085726, 'loss_val': 0.8492479287500014, 'psi': 0.6274755419702017}-{'f1_val': 0.6532888932294504, 'auprc': 0.7990185762403229, 'loss_val': 0.5741656786595993, 'psi': 0.7115807664337994}
[S8] START round=30 head_norm_before_train=1.422748 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9987415285455462, 'loss_val': 0.1004381361556399, 'psi': 0.9948207673769032}-{'f1_val': 0.9932883265732785, 'auprc': 0.986781808432833, 'loss_val': 0.06908897794031041, 'psi': 0.9906857193171003}
[S9] START round=30 head_norm_before_train=1.947714 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9992204150102197, 'loss_val': 0.023068269177577375, 'psi': 0.9968019776814518}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963268349802974, 'loss_val': 0.020877146876194994, 'psi': 0.9967924814994047}
[S10] START round=30 head_norm_before_train=2.054633 cos_to_last_merge=0.9997 (last merge round=28)
[S10] round=30 local utility u=0.005396 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9923504331480322, 'loss_val': 0.038865976853839905, 'psi': 0.9937893387908363}-{'f1_val': 0.9934327081542391, 'auprc': 0.9941016915870836, 'loss_val': 0.04701690306874825, 'psi': 0.993700301527377}
[S11] START round=30 head_norm_before_train=2.039233 (no previous merge yet)
[S11] round=30 local utility u=0.000513 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9976191626790096, 'loss_val': 0.031176906552950617, 'psi': 0.9971331749273511}-{'f1_val': 0.996567470639547, 'auprc': 0.9979162090984577, 'loss_val': 0.03164303941169504, 'psi': 0.9971069660231113}
[S13] START round=30 head_norm_before_train=1.835703 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.7728821555843954, 'auprc': 0.8035057747789422, 'loss_val': 0.5971052768397649, 'psi': 0.7851316032622142}-{'f1_val': 0.812100145728301, 'auprc': 0.8418198050039601, 'loss_val': 0.47410182519133465, 'psi': 0.8239880094385647}
[S14] START round=30 head_norm_before_train=2.102552 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9974610688245696, 'auprc': 0.9966770938776166, 'loss_val': 0.034887841685491826, 'psi': 0.9971474788457884}-{'f1_val': 0.9966327432458837, 'auprc': 0.998660153088615, 'loss_val': 0.03299082137345223, 'psi': 0.9974437071829763}
[S15] START round=30 head_norm_before_train=2.144384 (no previous merge yet)
[S15] round=30 local utility u=0.466974 metrics={'f1_val': 0.9024714276384536, 'auprc': 0.9925350145478005, 'loss_val': 0.17162827289966448, 'psi': 0.9384968624021923}-{'f1_val': 0.802646649435898, 'auprc': 0.9624170688506888, 'loss_val': 0.41627315471739423, 'psi': 0.8665548172018144}
[S16] START round=30 head_norm_before_train=1.422921 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.223754 metrics={'f1_val': 0.989302024923499, 'auprc': 0.9938061571675588, 'loss_val': 0.12879650586323077, 'psi': 0.9911036778211229}-{'f1_val': 0.9264111695174173, 'auprc': 0.9891888349811251, 'loss_val': 0.18510667014171525, 'psi': 0.9515222357029004}
[S17] START round=30 head_norm_before_train=2.105782 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6070403355624236, 'auprc': 0.9954174740939092, 'loss_val': 1.3092807606249404, 'psi': 0.7623911909750178}-{'f1_val': 0.6752474666497503, 'auprc': 0.842083054374051, 'loss_val': 0.8732012340758258, 'psi': 0.7419817017394705}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:38411
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:38404
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=0.9946
[S10] RECEIVED delta(kind=head bytes=1791) from S11
[S10] cosine check vs S11: cos=0.9941
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=-0.0738
[S6] DROPPED delta from S3 (cos=-0.0738 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.8837
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.5069
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=0.9405
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.015 → S3@127.0.0.1:38403
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9404 head_norm=1.529721
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.601713e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9404 head_norm=1.472162 delta_norm=0.260171
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.026 → S8@127.0.0.1:38409
[S14] ⇄ pheromone p=0.017 → S13@127.0.0.1:38413
[S8] ⇄ pheromone p=0.013 → S16@127.0.0.1:38416
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.5257 head_norm=1.587117
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.350684e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.5343 head_norm=1.543265 delta_norm=0.235068
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.285 → S8@127.0.0.1:38409
[S6] ⇄ pheromone p=0.220 → S7@127.0.0.1:38408
[S13] ⇄ pheromone p=0.232 → S16@127.0.0.1:38416
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.6755 head_norm=1.757251
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.305163e-02
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.6800 head_norm=1.769863 delta_norm=0.093052
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.229 → S3@127.0.0.1:38403
[S16] ⇄ pheromone p=0.192 → S4@127.0.0.1:38404
[S3] ⇄ pheromone p=0.336 → S6@127.0.0.1:38407
[S15] ⇄ pheromone p=0.280 → S7@127.0.0.1:38408
[S11] ⇄ pheromone p=0.020 → S10@127.0.0.1:38411
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9947 head_norm=2.082113
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.129072e-01
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9945 head_norm=2.066423 delta_norm=0.112907
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.009 → S7@127.0.0.1:38408
[S2] ⇄ pheromone p=0.098 → S5@127.0.0.1:38405
[S17] ⇄ pheromone p=0.136 → S14@127.0.0.1:38414
[S2] START round=31 head_norm_before_train=1.787237 cos_to_last_merge=0.8092 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=31 local utility u=0.194295 metrics={'f1_val': 0.8299766207291797, 'auprc': 0.9116941009100072, 'loss_val': 0.38981917142610484, 'psi': 0.8626636128015106}-{'f1_val': 0.8313449799726721, 'auprc': 0.7808556387857739, 'loss_val': 0.39410322141668663, 'psi': 0.8111492434979128}
[S3] START round=31 head_norm_before_train=1.975094 cos_to_last_merge=0.9999 (last merge round=29)
[S3] round=31 local utility u=0.648725 metrics={'f1_val': 0.9994909045756504, 'auprc': 0.9999021432935575, 'loss_val': 0.05582816460178323, 'psi': 0.9996554000628133}-{'f1_val': 0.8426187617446292, 'auprc': 0.9446876779527658, 'loss_val': 0.2464020707332291, 'psi': 0.8834463282278838}
[S4] START round=31 head_norm_before_train=1.472162 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.015803 metrics={'f1_val': 0.9416411594277865, 'auprc': 0.9439963356436143, 'loss_val': 0.27517993641637206, 'psi': 0.9425832299141176}-{'f1_val': 0.9403510789994421, 'auprc': 0.9339890316003401, 'loss_val': 0.26902322775678905, 'psi': 0.9378062600398014}
[S5] START round=31 head_norm_before_train=1.769863 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.087877 metrics={'f1_val': 0.6715553263991567, 'auprc': 0.9184378936306892, 'loss_val': 0.35682651418369726, 'psi': 0.7703083532917696}-{'f1_val': 0.6755459935462937, 'auprc': 0.8603779009163548, 'loss_val': 0.38234476578524523, 'psi': 0.7494787564943182}
[S6] START round=31 head_norm_before_train=1.960149 (no previous merge yet)
[S6] round=31 local utility u=0.349503 metrics={'f1_val': 0.6741453020435825, 'auprc': 0.8783096757920146, 'loss_val': 0.7877462248633267, 'psi': 0.7558110515429552}-{'f1_val': 0.5914092187723196, 'auprc': 0.8588569101597016, 'loss_val': 0.9319768830001486, 'psi': 0.6983882953272724}
[S7] START round=31 head_norm_before_train=1.543265 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=1.000000 metrics={'f1_val': 0.8951199539673376, 'auprc': 0.9124052506619017, 'loss_val': 0.3279889097971798, 'psi': 0.9020340726451632}-{'f1_val': 0.5257036943446212, 'auprc': 0.7801333134085726, 'loss_val': 0.8492479287500014, 'psi': 0.6274755419702017}
[S8] START round=31 head_norm_before_train=1.484732 cos_to_last_merge=0.9978 (last merge round=29)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9865799459506712, 'auprc': 0.9962065009022976, 'loss_val': 0.08473922385039748, 'psi': 0.9904305679313217}-{'f1_val': 0.9922069265978078, 'auprc': 0.9987415285455462, 'loss_val': 0.1004381361556399, 'psi': 0.9948207673769032}
[S9] START round=31 head_norm_before_train=1.959272 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9989063751852022, 'loss_val': 0.02716312179407708, 'psi': 0.9959261776724891}-{'f1_val': 0.99518968612894, 'auprc': 0.9992204150102197, 'loss_val': 0.023068269177577375, 'psi': 0.9968019776814518}
[S10] START round=31 head_norm_before_train=2.066423 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9952375404463065, 'loss_val': 0.0450472926688267, 'psi': 0.9941546410710661}-{'f1_val': 0.9947486092193725, 'auprc': 0.9923504331480322, 'loss_val': 0.038865976853839905, 'psi': 0.9937893387908363}
[S11] START round=31 head_norm_before_train=2.056820 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9982195907085148, 'loss_val': 0.031936081794163906, 'psi': 0.9969803211298531}-{'f1_val': 0.9968091830929121, 'auprc': 0.9976191626790096, 'loss_val': 0.031176906552950617, 'psi': 0.9971331749273511}
[S13] START round=31 head_norm_before_train=1.844605 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.7634492312066569, 'auprc': 0.7716558089526482, 'loss_val': 0.8580602270573645, 'psi': 0.7667318623050534}-{'f1_val': 0.7728821555843954, 'auprc': 0.8035057747789422, 'loss_val': 0.5971052768397649, 'psi': 0.7851316032622142}
[S14] START round=31 head_norm_before_train=2.114475 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9950582838451305, 'loss_val': 0.03170681074277808, 'psi': 0.9966139843679643}-{'f1_val': 0.9974610688245696, 'auprc': 0.9966770938776166, 'loss_val': 0.034887841685491826, 'psi': 0.9971474788457884}
[S15] START round=31 head_norm_before_train=2.153264 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7471436185764158, 'auprc': 0.8578559554848197, 'loss_val': 0.6228979038509618, 'psi': 0.7914285533397774}-{'f1_val': 0.9024714276384536, 'auprc': 0.9925350145478005, 'loss_val': 0.17162827289966448, 'psi': 0.9384968624021923}
[S16] START round=31 head_norm_before_train=1.459401 cos_to_last_merge=0.9996 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9853840420578647, 'auprc': 0.9943536045025624, 'loss_val': 0.12427499871034564, 'psi': 0.9889718670357438}-{'f1_val': 0.989302024923499, 'auprc': 0.9938061571675588, 'loss_val': 0.12879650586323077, 'psi': 0.9911036778211229}
[S17] START round=31 head_norm_before_train=2.117016 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5182194683383274, 'auprc': 0.680300669753105, 'loss_val': 1.655097276722193, 'psi': 0.5830519489042385}-{'f1_val': 0.6070403355624236, 'auprc': 0.9954174740939092, 'loss_val': 1.3092807606249404, 'psi': 0.7623911909750178}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38405
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:38409
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1808) from S7
[S8] cosine check vs S7: cos=0.9334
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.8026
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=-0.0732
[S6] DROPPED delta from S3 (cos=-0.0732 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.9984
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=-0.0616
[S7] DROPPED delta from S6 (cos=-0.0616 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.0940
[S3] DROPPED delta from S5 (cos=-0.0940 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9866 head_norm=1.545360
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.610032e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9862 head_norm=1.439819 delta_norm=0.161003
[S8] aggregate: ACCEPT kept=['S7', 'S4'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.6716 head_norm=1.776706
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.259236e-02
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.6743 head_norm=1.788458 delta_norm=0.052592
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.801669 cos_to_last_merge=0.8076 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.808
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.8324396498325545, 'auprc': 0.8534963590121445, 'loss_val': 0.38665501443196043, 'psi': 0.8408623335043905}-{'f1_val': 0.8299766207291797, 'auprc': 0.9116941009100072, 'loss_val': 0.38981917142610484, 'psi': 0.8626636128015106}
[S3] START round=32 head_norm_before_train=1.986619 cos_to_last_merge=0.9998 (last merge round=29)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9729015132078944, 'auprc': 0.9999105117740622, 'loss_val': 0.06651349162251975, 'psi': 0.9837051126343616}-{'f1_val': 0.9994909045756504, 'auprc': 0.9999021432935575, 'loss_val': 0.05582816460178323, 'psi': 0.9996554000628133}
[S4] START round=32 head_norm_before_train=1.497862 cos_to_last_merge=0.9997 (last merge round=30)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9384408606756646, 'auprc': 0.9346654373296297, 'loss_val': 0.2652269645628714, 'psi': 0.9369306913372506}-{'f1_val': 0.9416411594277865, 'auprc': 0.9439963356436143, 'loss_val': 0.27517993641637206, 'psi': 0.9425832299141176}
[S5] START round=32 head_norm_before_train=1.788458 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.6662354544971445, 'auprc': 0.8045926780496415, 'loss_val': 0.40213462141530365, 'psi': 0.7215783439181434}-{'f1_val': 0.6715553263991567, 'auprc': 0.9184378936306892, 'loss_val': 0.35682651418369726, 'psi': 0.7703083532917696}
[S6] START round=32 head_norm_before_train=1.962862 (no previous merge yet)
[S6] round=32 local utility u=0.735452 metrics={'f1_val': 0.8302273850873453, 'auprc': 0.95759527561163, 'loss_val': 0.49119053562408055, 'psi': 0.8811745412970592}-{'f1_val': 0.6741453020435825, 'auprc': 0.8783096757920146, 'loss_val': 0.7877462248633267, 'psi': 0.7558110515429552}
[S7] START round=32 head_norm_before_train=1.550394 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5388041997908596, 'auprc': 0.779051836179754, 'loss_val': 0.8439559708145598, 'psi': 0.6349032543464174}-{'f1_val': 0.8951199539673376, 'auprc': 0.9124052506619017, 'loss_val': 0.3279889097971798, 'psi': 0.9020340726451632}
[S8] START round=32 head_norm_before_train=1.439819 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.029070 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9981102519520232, 'loss_val': 0.06535657099544925, 'psi': 0.9944967498181287}-{'f1_val': 0.9865799459506712, 'auprc': 0.9962065009022976, 'loss_val': 0.08473922385039748, 'psi': 0.9904305679313217}
[S9] START round=32 head_norm_before_train=1.965949 (no previous merge yet)
[S9] round=32 local utility u=0.010543 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982022153563822, 'loss_val': 0.020292133804003184, 'psi': 0.9972771932308877}-{'f1_val': 0.9939393793306803, 'auprc': 0.9989063751852022, 'loss_val': 0.02716312179407708, 'psi': 0.9959261776724891}
[S10] START round=32 head_norm_before_train=2.090873 cos_to_last_merge=0.9998 (last merge round=30)
[S10] round=32 local utility u=0.003157 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9939328268595131, 'loss_val': 0.03876547892237495, 'psi': 0.9940273260419735}-{'f1_val': 0.9934327081542391, 'auprc': 0.9952375404463065, 'loss_val': 0.0450472926688267, 'psi': 0.9941546410710661}
[S11] START round=32 head_norm_before_train=2.070384 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998275895221094, 'loss_val': 0.03245422408417205, 'psi': 0.9970028429348848}-{'f1_val': 0.9961541414107454, 'auprc': 0.9982195907085148, 'loss_val': 0.031936081794163906, 'psi': 0.9969803211298531}
[S13] START round=32 head_norm_before_train=1.852222 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6742986120372212, 'auprc': 0.7585069503880489, 'loss_val': 0.7679639871175526, 'psi': 0.7079819473775524}-{'f1_val': 0.7634492312066569, 'auprc': 0.7716558089526482, 'loss_val': 0.8580602270573645, 'psi': 0.7667318623050534}
[S14] START round=32 head_norm_before_train=2.126162 cos_to_last_merge=0.9999 (last merge round=29)
[S14] round=32 local utility u=0.004047 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9968774391536733, 'loss_val': 0.02775013309603203, 'psi': 0.997209605965847}-{'f1_val': 0.9976511180498535, 'auprc': 0.9950582838451305, 'loss_val': 0.03170681074277808, 'psi': 0.9966139843679643}
[S15] START round=32 head_norm_before_train=2.163880 (no previous merge yet)
[S15] round=32 local utility u=1.000000 metrics={'f1_val': 0.9795646760060074, 'auprc': 0.9954336895163164, 'loss_val': 0.04829758401669571, 'psi': 0.9859122814101309}-{'f1_val': 0.7471436185764158, 'auprc': 0.8578559554848197, 'loss_val': 0.6228979038509618, 'psi': 0.7914285533397774}
[S16] START round=32 head_norm_before_train=1.502354 cos_to_last_merge=0.9983 (last merge round=29)
[S16] round=32 local utility u=0.035309 metrics={'f1_val': 0.9906533999658295, 'auprc': 0.9938626397921393, 'loss_val': 0.08380042142443452, 'psi': 0.9919370958963534}-{'f1_val': 0.9853840420578647, 'auprc': 0.9943536045025624, 'loss_val': 0.12427499871034564, 'psi': 0.9889718670357438}
[S17] START round=32 head_norm_before_train=2.124825 (no previous merge yet)
[S17] round=32 local utility u=0.666799 metrics={'f1_val': 0.6179101794590849, 'auprc': 0.7505850041465654, 'loss_val': 1.130496969797721, 'psi': 0.670980109334077}-{'f1_val': 0.5182194683383274, 'auprc': 0.680300669753105, 'loss_val': 1.655097276722193, 'psi': 0.5830519489042385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.8067
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=-0.0612
[S7] DROPPED delta from S6 (cos=-0.0612 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.9822
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.6272
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.9060
[S3] RECEIVED delta(kind=head bytes=1794) from S9
[S3] cosine check vs S9: cos=0.9981
[S13] RECEIVED delta(kind=head bytes=1801) from S14
[S13] cosine check vs S14: cos=-0.0046
[S13] DROPPED delta from S14 (cos=-0.0046 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=0.9978
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9729 head_norm=1.993853
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.177863e-02
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9804 head_norm=1.982138 delta_norm=0.061779
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9384 head_norm=1.532160
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.452074e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9385 head_norm=1.531287 delta_norm=0.145207
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.5388 head_norm=1.557433
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.208470e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5386 head_norm=1.551297 delta_norm=0.120847
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9907 head_norm=1.544130
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.299901e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9902 head_norm=1.481755 delta_norm=0.329990
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9974 head_norm=2.139016
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.045835e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9974 head_norm=2.137446 delta_norm=0.070458
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.817523 cos_to_last_merge=0.8068 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=33 local utility u=0.131833 metrics={'f1_val': 0.8312092387144469, 'auprc': 0.9476237061170666, 'loss_val': 0.3979887919866029, 'psi': 0.8777750256754948}-{'f1_val': 0.8324396498325545, 'auprc': 0.8534963590121445, 'loss_val': 0.38665501443196043, 'psi': 0.8408623335043905}
[S3] START round=33 head_norm_before_train=1.982138 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.080808 metrics={'f1_val': 0.9986372654320868, 'auprc': 0.9999977524994945, 'loss_val': 0.05957295705494368, 'psi': 0.9991814602590499}-{'f1_val': 0.9729015132078944, 'auprc': 0.9999105117740622, 'loss_val': 0.06651349162251975, 'psi': 0.9837051126343616}
[S4] START round=33 head_norm_before_train=1.531287 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.021574 metrics={'f1_val': 0.9405287040919847, 'auprc': 0.9504821086414558, 'loss_val': 0.282055314851275, 'psi': 0.9445100659117731}-{'f1_val': 0.9384408606756646, 'auprc': 0.9346654373296297, 'loss_val': 0.2652269645628714, 'psi': 0.9369306913372506}
[S5] START round=33 head_norm_before_train=1.798086 cos_to_last_merge=0.9999 (last merge round=31)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.6475212528726978, 'auprc': 0.7980781818049071, 'loss_val': 0.44931143486114433, 'psi': 0.7077440244455815}-{'f1_val': 0.6662354544971445, 'auprc': 0.8045926780496415, 'loss_val': 0.40213462141530365, 'psi': 0.7215783439181434}
[S6] START round=33 head_norm_before_train=1.958962 (no previous merge yet)
[S6] round=33 local utility u=0.144547 metrics={'f1_val': 0.8674018629449307, 'auprc': 0.9577409542264199, 'loss_val': 0.42558093470047065, 'psi': 0.9035374994575265}-{'f1_val': 0.8302273850873453, 'auprc': 0.95759527561163, 'loss_val': 0.49119053562408055, 'psi': 0.8811745412970592}
[S7] START round=33 head_norm_before_train=1.551297 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.615273 metrics={'f1_val': 0.6669070350347319, 'auprc': 0.8199785399349578, 'loss_val': 0.5048065695900161, 'psi': 0.7281356369948223}-{'f1_val': 0.5388041997908596, 'auprc': 0.779051836179754, 'loss_val': 0.8439559708145598, 'psi': 0.6349032543464174}
[S8] START round=33 head_norm_before_train=1.491525 cos_to_last_merge=0.9993 (last merge round=31)
[S8] round=33 local utility u=0.007387 metrics={'f1_val': 0.9940931887774087, 'auprc': 0.9949539482136944, 'loss_val': 0.05314622936850638, 'psi': 0.994437492551923}-{'f1_val': 0.9920877483955324, 'auprc': 0.9981102519520232, 'loss_val': 0.06535657099544925, 'psi': 0.9944967498181287}
[S9] START round=33 head_norm_before_train=1.972289 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9905410059937811, 'auprc': 0.9984665573902958, 'loss_val': 0.03176861858072993, 'psi': 0.9937112265523871}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982022153563822, 'loss_val': 0.020292133804003184, 'psi': 0.9972771932308877}
[S10] START round=33 head_norm_before_train=2.116520 cos_to_last_merge=0.9992 (last merge round=30)
[S10] round=33 local utility u=0.000908 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9922418283718177, 'loss_val': 0.0345087851716965, 'psi': 0.9936141954277637}-{'f1_val': 0.9940903254969471, 'auprc': 0.9939328268595131, 'loss_val': 0.03876547892237495, 'psi': 0.9940273260419735}
[S11] START round=33 head_norm_before_train=2.083903 (no previous merge yet)
[S11] round=33 local utility u=0.002026 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9982567787385467, 'loss_val': 0.02834490537697778, 'psi': 0.996995196341866}-{'f1_val': 0.9961541414107454, 'auprc': 0.998275895221094, 'loss_val': 0.03245422408417205, 'psi': 0.9970028429348848}
[S13] START round=33 head_norm_before_train=1.861499 (no previous merge yet)
[S13] round=33 local utility u=0.153243 metrics={'f1_val': 0.7485697604687572, 'auprc': 0.7270502986954157, 'loss_val': 0.8127359006345884, 'psi': 0.7399619757594206}-{'f1_val': 0.6742986120372212, 'auprc': 0.7585069503880489, 'loss_val': 0.7679639871175526, 'psi': 0.7079819473775524}
[S14] START round=33 head_norm_before_train=2.137446 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9949123293963197, 'auprc': 0.9985367489634871, 'loss_val': 0.03867221641685342, 'psi': 0.9963620972231867}-{'f1_val': 0.9974310505072961, 'auprc': 0.9968774391536733, 'loss_val': 0.02775013309603203, 'psi': 0.997209605965847}
[S15] START round=33 head_norm_before_train=2.175086 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8246124177348431, 'auprc': 0.9843775176264052, 'loss_val': 0.3471164349670089, 'psi': 0.888518457691468}-{'f1_val': 0.9795646760060074, 'auprc': 0.9954336895163164, 'loss_val': 0.04829758401669571, 'psi': 0.9859122814101309}
[S16] START round=33 head_norm_before_train=1.481755 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9376921667908856, 'auprc': 0.9940943373267274, 'loss_val': 0.32449126626335373, 'psi': 0.9602530350052223}-{'f1_val': 0.9906533999658295, 'auprc': 0.9938626397921393, 'loss_val': 0.08380042142443452, 'psi': 0.9919370958963534}
[S17] START round=33 head_norm_before_train=2.138198 (no previous merge yet)
[S17] round=33 local utility u=0.686567 metrics={'f1_val': 0.7071292895751763, 'auprc': 0.9129762923068103, 'loss_val': 0.7798515684428673, 'psi': 0.78946809066783}-{'f1_val': 0.6179101794590849, 'auprc': 0.7505850041465654, 'loss_val': 1.130496969797721, 'psi': 0.670980109334077}
[S6] not sending this round → trigger blocked (psi=0.904)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38405
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:38411
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[S8] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:38409
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=0.9985
[S10] RECEIVED delta(kind=head bytes=1791) from S11
[S10] cosine check vs S11: cos=0.9938
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=-0.0723
[S6] DROPPED delta from S3 (cos=-0.0723 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=-0.0358
[S16] DROPPED delta from S13 (cos=-0.0358 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=0.8823
[S8] RECEIVED delta(kind=head bytes=1805) from S7
[S8] cosine check vs S7: cos=0.8969
[S17] not sending this round → trigger blocked (psi=0.789)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9941 head_norm=1.537420
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.094781e-01
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9945 head_norm=1.466005 delta_norm=0.109478
[S8] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9945 head_norm=2.139877
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.199159e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9945 head_norm=2.116738 delta_norm=0.119916
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.6475 head_norm=1.810058
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.132156e-02
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.6512 head_norm=1.820669 delta_norm=0.051322
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.832657 cos_to_last_merge=0.8056 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.806
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.8312387694971026, 'auprc': 0.9180655184588975, 'loss_val': 0.38895401628871157, 'psi': 0.8659694690818206}-{'f1_val': 0.8312092387144469, 'auprc': 0.9476237061170666, 'loss_val': 0.3979887919866029, 'psi': 0.8777750256754948}
[S3] START round=34 head_norm_before_train=1.992146 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9928150714002154, 'auprc': 0.9998758594476983, 'loss_val': 0.06424461353732665, 'psi': 0.9956393866192086}-{'f1_val': 0.9986372654320868, 'auprc': 0.9999977524994945, 'loss_val': 0.05957295705494368, 'psi': 0.9991814602590499}
[S4] START round=34 head_norm_before_train=1.566039 cos_to_last_merge=0.9996 (last merge round=32)
[S4] round=34 local utility u=0.026200 metrics={'f1_val': 0.9419113055526063, 'auprc': 0.9654187668122445, 'loss_val': 0.28276013599186517, 'psi': 0.9513142900564615}-{'f1_val': 0.9405287040919847, 'auprc': 0.9504821086414558, 'loss_val': 0.282055314851275, 'psi': 0.9445100659117731}
[S5] START round=34 head_norm_before_train=1.820669 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.562151 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9937972676194888, 'loss_val': 0.22896622559405885, 'psi': 0.8177116975081438}-{'f1_val': 0.6475212528726978, 'auprc': 0.7980781818049071, 'loss_val': 0.44931143486114433, 'psi': 0.7077440244455815}
[S6] START round=34 head_norm_before_train=1.960058 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.598955857665746, 'auprc': 0.8584488359299558, 'loss_val': 1.0498894188753574, 'psi': 0.70275304897143}-{'f1_val': 0.8674018629449307, 'auprc': 0.9577409542264199, 'loss_val': 0.42558093470047065, 'psi': 0.9035374994575265}
[S7] START round=34 head_norm_before_train=1.559349 cos_to_last_merge=0.9999 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5495329936635567, 'auprc': 0.7782157400186354, 'loss_val': 0.8807575082025225, 'psi': 0.6410060922055882}-{'f1_val': 0.6669070350347319, 'auprc': 0.8199785399349578, 'loss_val': 0.5048065695900161, 'psi': 0.7281356369948223}
[S8] START round=34 head_norm_before_train=1.466005 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9981029563549968, 'loss_val': 0.056772414247461815, 'psi': 0.9945653385006834}-{'f1_val': 0.9940931887774087, 'auprc': 0.9949539482136944, 'loss_val': 0.05314622936850638, 'psi': 0.994437492551923}
[S9] START round=34 head_norm_before_train=1.980159 (no previous merge yet)
[S9] round=34 local utility u=0.022283 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9988962315127627, 'loss_val': 0.021369110782660312, 'psi': 0.9971709137914174}-{'f1_val': 0.9905410059937811, 'auprc': 0.9984665573902958, 'loss_val': 0.03176861858072993, 'psi': 0.9937112265523871}
[S10] START round=34 head_norm_before_train=2.116738 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9936603773980202, 'loss_val': 0.039987623158849364, 'psi': 0.9935237758517516}-{'f1_val': 0.9945291067983943, 'auprc': 0.9922418283718177, 'loss_val': 0.0345087851716965, 'psi': 0.9936141954277637}
[S11] START round=34 head_norm_before_train=2.100202 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9983207927249202, 'loss_val': 0.03373561181045094, 'psi': 0.9970208019364153}-{'f1_val': 0.9961541414107454, 'auprc': 0.9982567787385467, 'loss_val': 0.02834490537697778, 'psi': 0.996995196341866}
[S13] START round=34 head_norm_before_train=1.868948 (no previous merge yet)
[S13] round=34 local utility u=0.247189 metrics={'f1_val': 0.7528067744093505, 'auprc': 0.8270031844326055, 'loss_val': 0.6436381977063167, 'psi': 0.7824853384186525}-{'f1_val': 0.7485697604687572, 'auprc': 0.7270502986954157, 'loss_val': 0.8127359006345884, 'psi': 0.7399619757594206}
[S14] START round=34 head_norm_before_train=2.149538 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9795380760697007, 'auprc': 0.9950575064489384, 'loss_val': 0.048242361657764944, 'psi': 0.9857458482213959}-{'f1_val': 0.9949123293963197, 'auprc': 0.9985367489634871, 'loss_val': 0.03867221641685342, 'psi': 0.9963620972231867}
[S15] START round=34 head_norm_before_train=2.185764 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7007438455271788, 'auprc': 0.7993010620433666, 'loss_val': 0.8112191094996579, 'psi': 0.7401667321336539}-{'f1_val': 0.8246124177348431, 'auprc': 0.9843775176264052, 'loss_val': 0.3471164349670089, 'psi': 0.888518457691468}
[S16] START round=34 head_norm_before_train=1.519851 cos_to_last_merge=0.9995 (last merge round=32)
[S16] round=34 local utility u=0.273076 metrics={'f1_val': 0.9910493994360491, 'auprc': 0.9957917847147062, 'loss_val': 0.10357520660486767, 'psi': 0.9929463535475119}-{'f1_val': 0.9376921667908856, 'auprc': 0.9940943373267274, 'loss_val': 0.32449126626335373, 'psi': 0.9602530350052223}
[S17] START round=34 head_norm_before_train=2.152718 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6451789763995948, 'auprc': 0.9868649130571656, 'loss_val': 1.228219436487229, 'psi': 0.7818533510626231}-{'f1_val': 0.7071292895751763, 'auprc': 0.9129762923068103, 'loss_val': 0.7798515684428673, 'psi': 0.78946809066783}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.951)
[S13] not sending this round → trigger blocked (psi=0.782)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:38404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:38403
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.9638
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=-0.0925
[S3] DROPPED delta from S5 (cos=-0.0925 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S9
[S3] cosine check vs S9: cos=0.9989
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9928 head_norm=2.005206
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.723879e-02
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9949 head_norm=1.996654 delta_norm=0.047239
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9419 head_norm=1.596147
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.131166e-01
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9419 head_norm=1.564291 delta_norm=0.213117
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.847105 cos_to_last_merge=0.8040 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.804
[S2] round=35 local utility u=0.100344 metrics={'f1_val': 0.8284568586965526, 'auprc': 0.9899929563565908, 'loss_val': 0.3873575542892367, 'psi': 0.8930712977605679}-{'f1_val': 0.8312387694971026, 'auprc': 0.9180655184588975, 'loss_val': 0.38895401628871157, 'psi': 0.8659694690818206}
[S3] START round=35 head_norm_before_train=1.996654 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.883616358435416, 'auprc': 0.9693127745589094, 'loss_val': 0.2091597349640467, 'psi': 0.9178949248848134}-{'f1_val': 0.9928150714002154, 'auprc': 0.9998758594476983, 'loss_val': 0.06424461353732665, 'psi': 0.9956393866192086}
[S4] START round=35 head_norm_before_train=1.564291 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9424361811695424, 'auprc': 0.9542737296314879, 'loss_val': 0.2854118196461892, 'psi': 0.9471712005543206}-{'f1_val': 0.9419113055526063, 'auprc': 0.9654187668122445, 'loss_val': 0.28276013599186517, 'psi': 0.9513142900564615}
[S5] START round=35 head_norm_before_train=1.833164 cos_to_last_merge=0.9999 (last merge round=33)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.4391558032855634, 'auprc': 0.8223108527786582, 'loss_val': 0.738683323668007, 'psi': 0.5924178230828013}-{'f1_val': 0.7003213174339138, 'auprc': 0.9937972676194888, 'loss_val': 0.22896622559405885, 'psi': 0.8177116975081438}
[S6] START round=35 head_norm_before_train=1.962843 (no previous merge yet)
[S6] round=35 local utility u=0.502282 metrics={'f1_val': 0.678580704295178, 'auprc': 0.9311892000626818, 'loss_val': 0.7412952202595469, 'psi': 0.7796241026021795}-{'f1_val': 0.598955857665746, 'auprc': 0.8584488359299558, 'loss_val': 1.0498894188753574, 'psi': 0.70275304897143}
[S7] START round=35 head_norm_before_train=1.569636 cos_to_last_merge=0.9998 (last merge round=32)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5004119954686919, 'auprc': 0.7808484348732245, 'loss_val': 0.9147969750055602, 'psi': 0.612586571230505}-{'f1_val': 0.5495329936635567, 'auprc': 0.7782157400186354, 'loss_val': 0.8807575082025225, 'psi': 0.6410060922055882}
[S8] START round=35 head_norm_before_train=1.503282 cos_to_last_merge=0.9997 (last merge round=33)
[S8] round=35 local utility u=0.005893 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9979134591014074, 'loss_val': 0.04991340595446859, 'psi': 0.9950390314300591}-{'f1_val': 0.9922069265978078, 'auprc': 0.9981029563549968, 'loss_val': 0.056772414247461815, 'psi': 0.9945653385006834}
[S9] START round=35 head_norm_before_train=1.989187 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959635000905365, 'loss_val': 0.01924401786467707, 'psi': 0.9966471475435003}-{'f1_val': 0.9960207019771873, 'auprc': 0.9988962315127627, 'loss_val': 0.021369110782660312, 'psi': 0.9971709137914174}
[S10] START round=35 head_norm_before_train=2.137356 cos_to_last_merge=0.9999 (last merge round=33)
[S10] round=35 local utility u=0.003470 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9923768320342669, 'loss_val': 0.03577452188241475, 'psi': 0.9936681968927433}-{'f1_val': 0.9934327081542391, 'auprc': 0.9936603773980202, 'loss_val': 0.039987623158849364, 'psi': 0.9935237758517516}
[S11] START round=35 head_norm_before_train=2.113614 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.995672955508997, 'auprc': 0.9981689212011186, 'loss_val': 0.033553007727150246, 'psi': 0.9966713417858456}-{'f1_val': 0.9961541414107454, 'auprc': 0.9983207927249202, 'loss_val': 0.03373561181045094, 'psi': 0.9970208019364153}
[S13] START round=35 head_norm_before_train=1.878287 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6518226862883764, 'auprc': 0.7114610980607914, 'loss_val': 0.948515155325387, 'psi': 0.6756780509973423}-{'f1_val': 0.7528067744093505, 'auprc': 0.8270031844326055, 'loss_val': 0.6436381977063167, 'psi': 0.7824853384186525}
[S14] START round=35 head_norm_before_train=2.160681 cos_to_last_merge=0.9999 (last merge round=32)
[S14] round=35 local utility u=0.059224 metrics={'f1_val': 0.9967480671851483, 'auprc': 0.9950342603133038, 'loss_val': 0.032985543425994183, 'psi': 0.9960625444364105}-{'f1_val': 0.9795380760697007, 'auprc': 0.9950575064489384, 'loss_val': 0.048242361657764944, 'psi': 0.9857458482213959}
[S15] START round=35 head_norm_before_train=2.193473 (no previous merge yet)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.9910190653096624, 'auprc': 0.9969412928905739, 'loss_val': 0.054959879468358, 'psi': 0.9933879563420269}-{'f1_val': 0.7007438455271788, 'auprc': 0.7993010620433666, 'loss_val': 0.8112191094996579, 'psi': 0.7401667321336539}
[S16] START round=35 head_norm_before_train=1.561142 cos_to_last_merge=0.9980 (last merge round=32)
[S16] round=35 local utility u=0.011392 metrics={'f1_val': 0.9919545878295252, 'auprc': 0.9942472874029387, 'loss_val': 0.08158942519585625, 'psi': 0.9928716676588906}-{'f1_val': 0.9910493994360491, 'auprc': 0.9957917847147062, 'loss_val': 0.10357520660486767, 'psi': 0.9929463535475119}
[S17] START round=35 head_norm_before_train=2.164649 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6308972201719569, 'auprc': 0.9199670287652864, 'loss_val': 1.3692581482674158, 'psi': 0.7465251436092888}-{'f1_val': 0.6451789763995948, 'auprc': 0.9868649130571656, 'loss_val': 1.228219436487229, 'psi': 0.7818533510626231}
[S16] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:38413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:38416
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.9987
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=-0.0622
[S7] DROPPED delta from S6 (cos=-0.0622 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.6829
[S16] RECEIVED delta(kind=head bytes=1806) from S8
[S16] cosine check vs S8: cos=0.9718
[S13] RECEIVED delta(kind=head bytes=1792) from S14
[S13] cosine check vs S14: cos=-0.0063
[S13] DROPPED delta from S14 (cos=-0.0063 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.7599
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.017 → S8@127.0.0.1:38409
[S11] ⇄ pheromone p=0.007 → S10@127.0.0.1:38411
[S13] ⇄ pheromone p=0.135 → S16@127.0.0.1:38416
[S9] ⇄ pheromone p=0.010 → S3@127.0.0.1:38403
[S3] ⇄ pheromone p=0.174 → S6@127.0.0.1:38407
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.4392 head_norm=1.844868
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.711322e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.4397 head_norm=1.851474 delta_norm=0.047113
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.172 → S3@127.0.0.1:38403
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.5004 head_norm=1.582659
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.464044e-02
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.4992 head_norm=1.578332 delta_norm=0.074640
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.254 → S8@127.0.0.1:38409
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9920 head_norm=1.602876
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.894063e-01
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9920 head_norm=1.558592 delta_norm=0.189406
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.113 → S4@127.0.0.1:38404
[S2] ⇄ pheromone p=0.085 → S5@127.0.0.1:38405
[S6] ⇄ pheromone p=0.295 → S7@127.0.0.1:38408
[S8] ⇄ pheromone p=0.009 → S16@127.0.0.1:38416
[S14] ⇄ pheromone p=0.018 → S13@127.0.0.1:38413
[S15] ⇄ pheromone p=0.394 → S7@127.0.0.1:38408
[S10] ⇄ pheromone p=0.004 → S7@127.0.0.1:38408
[S17] ⇄ pheromone p=0.201 → S14@127.0.0.1:38414
[S2] START round=36 head_norm_before_train=1.859251 cos_to_last_merge=0.8028 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.803
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7456737061624918, 'auprc': 0.8662606766587206, 'loss_val': 0.6936163749273725, 'psi': 0.7939084943609833}-{'f1_val': 0.8284568586965526, 'auprc': 0.9899929563565908, 'loss_val': 0.3873575542892367, 'psi': 0.8930712977605679}
[S3] START round=36 head_norm_before_train=2.012253 cos_to_last_merge=0.9999 (last merge round=34)
[S3] round=36 local utility u=0.183862 metrics={'f1_val': 0.9228228916762393, 'auprc': 0.9889419336865787, 'loss_val': 0.13556233156871783, 'psi': 0.9492705084803751}-{'f1_val': 0.883616358435416, 'auprc': 0.9693127745589094, 'loss_val': 0.2091597349640467, 'psi': 0.9178949248848134}
[S4] START round=36 head_norm_before_train=1.598996 cos_to_last_merge=0.9996 (last merge round=34)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9402377487455741, 'auprc': 0.9370421636467557, 'loss_val': 0.2901958767057435, 'psi': 0.9389595147060468}-{'f1_val': 0.9424361811695424, 'auprc': 0.9542737296314879, 'loss_val': 0.2854118196461892, 'psi': 0.9471712005543206}
[S5] START round=36 head_norm_before_train=1.851474 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9941720907991616, 'loss_val': 0.21440866455444466, 'psi': 0.817861626780013}-{'f1_val': 0.4391558032855634, 'auprc': 0.8223108527786582, 'loss_val': 0.738683323668007, 'psi': 0.5924178230828013}
[S6] START round=36 head_norm_before_train=1.965193 (no previous merge yet)
[S6] round=36 local utility u=0.567608 metrics={'f1_val': 0.8187849932861531, 'auprc': 0.9601973685879982, 'loss_val': 0.5343293174647955, 'psi': 0.8753499434068912}-{'f1_val': 0.678580704295178, 'auprc': 0.9311892000626818, 'loss_val': 0.7412952202595469, 'psi': 0.7796241026021795}
[S7] START round=36 head_norm_before_train=1.578332 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.276322 metrics={'f1_val': 0.5719386909948938, 'auprc': 0.785049604278669, 'loss_val': 0.803917505341909, 'psi': 0.6571830563084039}-{'f1_val': 0.5004119954686919, 'auprc': 0.7808484348732245, 'loss_val': 0.9147969750055602, 'psi': 0.612586571230505}
[S8] START round=36 head_norm_before_train=1.536541 cos_to_last_merge=0.9990 (last merge round=33)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.991479862271931, 'auprc': 0.9978638114438588, 'loss_val': 0.04995877903921744, 'psi': 0.9940334419407022}-{'f1_val': 0.993122746315827, 'auprc': 0.9979134591014074, 'loss_val': 0.04991340595446859, 'psi': 0.9950390314300591}
[S9] START round=36 head_norm_before_train=1.998411 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9988557759415497, 'loss_val': 0.024554157848974086, 'psi': 0.9961563038943101}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959635000905365, 'loss_val': 0.01924401786467707, 'psi': 0.9966471475435003}
[S10] START round=36 head_norm_before_train=2.156838 cos_to_last_merge=0.9996 (last merge round=33)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9935892361752827, 'loss_val': 0.03556301660328471, 'psi': 0.9934953193626566}-{'f1_val': 0.9945291067983943, 'auprc': 0.9923768320342669, 'loss_val': 0.03577452188241475, 'psi': 0.9936681968927433}
[S11] START round=36 head_norm_before_train=2.126753 (no previous merge yet)
[S11] round=36 local utility u=0.004994 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9982435439126928, 'loss_val': 0.026675016150449603, 'psi': 0.9969899024115243}-{'f1_val': 0.995672955508997, 'auprc': 0.9981689212011186, 'loss_val': 0.033553007727150246, 'psi': 0.9966713417858456}
[S13] START round=36 head_norm_before_train=1.881009 (no previous merge yet)
[S13] round=36 local utility u=0.364051 metrics={'f1_val': 0.7451232167456459, 'auprc': 0.7412765108178299, 'loss_val': 0.8696634283974166, 'psi': 0.7435845343745194}-{'f1_val': 0.6518226862883764, 'auprc': 0.7114610980607914, 'loss_val': 0.948515155325387, 'psi': 0.6756780509973423}
[S14] START round=36 head_norm_before_train=2.172193 cos_to_last_merge=0.9997 (last merge round=32)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9967513085155002, 'auprc': 0.9951236045596392, 'loss_val': 0.033935942668343724, 'psi': 0.9961002269331558}-{'f1_val': 0.9967480671851483, 'auprc': 0.9950342603133038, 'loss_val': 0.032985543425994183, 'psi': 0.9960625444364105}
[S15] START round=36 head_norm_before_train=2.199462 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.8496008285660059, 'loss_val': 0.7165403814544098, 'psi': 0.7603911796875764}-{'f1_val': 0.9910190653096624, 'auprc': 0.9969412928905739, 'loss_val': 0.054959879468358, 'psi': 0.9933879563420269}
[S16] START round=36 head_norm_before_train=1.558592 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9912682463034266, 'auprc': 0.9957742091425672, 'loss_val': 0.10376367588440873, 'psi': 0.9930706314390828}-{'f1_val': 0.9919545878295252, 'auprc': 0.9942472874029387, 'loss_val': 0.08158942519585625, 'psi': 0.9928716676588906}
[S17] START round=36 head_norm_before_train=2.177710 (no previous merge yet)
[S17] round=36 local utility u=0.456492 metrics={'f1_val': 0.7214984465891302, 'auprc': 0.8989192867964731, 'loss_val': 0.9367381190574587, 'psi': 0.7924667826720674}-{'f1_val': 0.6308972201719569, 'auprc': 0.9199670287652864, 'loss_val': 1.3692581482674158, 'psi': 0.7465251436092888}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38405
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:38414
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:38415
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] sending update (kind=head size=1791 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.875)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S5
[S2] cosine check vs S5: cos=0.9993
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=-0.0911
[S5] DROPPED delta from S3 (cos=-0.0911 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=0.7076
[S14] RECEIVED delta(kind=head bytes=1793) from S13
[S14] cosine check vs S13: cos=-0.0066
[S14] DROPPED delta from S13 (cos=-0.0066 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.7457 head_norm=1.869691
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.407466e-02
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.7475 head_norm=1.864632 delta_norm=0.034075
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.7009 head_norm=2.207485
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.800971e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.7009 head_norm=1.758818 delta_norm=0.780097
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.864632 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.569645 metrics={'f1_val': 0.8268215338922976, 'auprc': 0.9919324210396657, 'loss_val': 0.41822805246361056, 'psi': 0.8928658887512448}-{'f1_val': 0.7456737061624918, 'auprc': 0.8662606766587206, 'loss_val': 0.6936163749273725, 'psi': 0.7939084943609833}
[S3] START round=37 head_norm_before_train=2.026101 cos_to_last_merge=0.9998 (last merge round=34)
[S3] round=37 local utility u=0.212157 metrics={'f1_val': 0.9787968658840719, 'auprc': 0.9994085283622545, 'loss_val': 0.07849128293382321, 'psi': 0.9870415308753449}-{'f1_val': 0.9228228916762393, 'auprc': 0.9889419336865787, 'loss_val': 0.13556233156871783, 'psi': 0.9492705084803751}
[S4] START round=37 head_norm_before_train=1.635241 cos_to_last_merge=0.9981 (last merge round=34)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9404566612621602, 'auprc': 0.9284939054697766, 'loss_val': 0.2910212052542428, 'psi': 0.9356715589452067}-{'f1_val': 0.9402377487455741, 'auprc': 0.9370421636467557, 'loss_val': 0.2901958767057435, 'psi': 0.9389595147060468}
[S5] START round=37 head_norm_before_train=1.860184 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.6504442819159368, 'auprc': 0.8550625996102436, 'loss_val': 0.4287410062334473, 'psi': 0.7322916089936595}-{'f1_val': 0.7003213174339138, 'auprc': 0.9941720907991616, 'loss_val': 0.21440866455444466, 'psi': 0.817861626780013}
[S6] START round=37 head_norm_before_train=1.977138 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.636161969710859, 'auprc': 0.8631416948795188, 'loss_val': 1.0058871541196712, 'psi': 0.7269538597783229}-{'f1_val': 0.8187849932861531, 'auprc': 0.9601973685879982, 'loss_val': 0.5343293174647955, 'psi': 0.8753499434068912}
[S7] START round=37 head_norm_before_train=1.590909 cos_to_last_merge=0.9999 (last merge round=35)
[S7] round=37 local utility u=0.372100 metrics={'f1_val': 0.6428311879085848, 'auprc': 0.8127820922968529, 'loss_val': 0.5682701205435604, 'psi': 0.710811549663892}-{'f1_val': 0.5719386909948938, 'auprc': 0.785049604278669, 'loss_val': 0.803917505341909, 'psi': 0.6571830563084039}
[S8] START round=37 head_norm_before_train=1.565416 cos_to_last_merge=0.9981 (last merge round=33)
[S8] round=37 local utility u=0.001283 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9929256067701953, 'loss_val': 0.044543215319332224, 'psi': 0.9932547378858064}-{'f1_val': 0.991479862271931, 'auprc': 0.9978638114438588, 'loss_val': 0.04995877903921744, 'psi': 0.9940334419407022}
[S9] START round=37 head_norm_before_train=2.005098 (no previous merge yet)
[S9] round=37 local utility u=0.010459 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9989164172064902, 'loss_val': 0.018794273663428, 'psi': 0.9976781181379504}-{'f1_val': 0.994356655862817, 'auprc': 0.9988557759415497, 'loss_val': 0.024554157848974086, 'psi': 0.9961563038943101}
[S10] START round=37 head_norm_before_train=2.176043 cos_to_last_merge=0.9991 (last merge round=33)
[S10] round=37 local utility u=0.002223 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9923826295533528, 'loss_val': 0.03275911027978268, 'psi': 0.9935388592125218}-{'f1_val': 0.9934327081542391, 'auprc': 0.9935892361752827, 'loss_val': 0.03556301660328471, 'psi': 0.9934953193626566}
[S11] START round=37 head_norm_before_train=2.139626 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9980971340565694, 'loss_val': 0.026566989037006418, 'psi': 0.996931338469075}-{'f1_val': 0.9961541414107454, 'auprc': 0.9982435439126928, 'loss_val': 0.026675016150449603, 'psi': 0.9969899024115243}
[S13] START round=37 head_norm_before_train=1.877199 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6390752941870057, 'auprc': 0.701724402536017, 'loss_val': 0.9807277096149543, 'psi': 0.6641349375266101}-{'f1_val': 0.7451232167456459, 'auprc': 0.7412765108178299, 'loss_val': 0.8696634283974166, 'psi': 0.7435845343745194}
[S14] START round=37 head_norm_before_train=2.183113 cos_to_last_merge=0.9995 (last merge round=32)
[S14] round=37 local utility u=0.011295 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9986591304855975, 'loss_val': 0.023430544622602092, 'psi': 0.997662157088838}-{'f1_val': 0.9967513085155002, 'auprc': 0.9951236045596392, 'loss_val': 0.033935942668343724, 'psi': 0.9961002269331558}
[S15] START round=37 head_norm_before_train=1.758818 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.997646443090867, 'loss_val': 0.031567462163266995, 'psi': 0.9969741446020977}-{'f1_val': 0.7009180804352899, 'auprc': 0.8496008285660059, 'loss_val': 0.7165403814544098, 'psi': 0.7603911796875764}
[S16] START round=37 head_norm_before_train=1.598297 cos_to_last_merge=0.9995 (last merge round=35)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9633071592756642, 'auprc': 0.9946151359904042, 'loss_val': 0.1548115027287546, 'psi': 0.9758303499615603}-{'f1_val': 0.9912682463034266, 'auprc': 0.9957742091425672, 'loss_val': 0.10376367588440873, 'psi': 0.9930706314390828}
[S17] START round=37 head_norm_before_train=2.190475 (no previous merge yet)
[S17] round=37 local utility u=0.726871 metrics={'f1_val': 0.8900860505572937, 'auprc': 0.9091664808470701, 'loss_val': 0.5252635093473424, 'psi': 0.8977182226732042}-{'f1_val': 0.7214984465891302, 'auprc': 0.8989192867964731, 'loss_val': 0.9367381190574587, 'psi': 0.7924667826720674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:38412
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:38415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:38417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] cosine check vs S8: cos=0.8725
[S17] RECEIVED delta(kind=head bytes=1800) from S14
[S17] cosine check vs S14: cos=0.9975
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=0.8935
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:38405
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S10
[S11] cosine check vs S10: cos=0.9939
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=-0.0908
[S5] DROPPED delta from S3 (cos=-0.0908 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9962 head_norm=2.151583
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.220292e-01
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9962 head_norm=2.169460 delta_norm=0.122029
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.9965 head_norm=1.783459
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.005080e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.9963 head_norm=1.647414 delta_norm=0.400508
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.6428 head_norm=1.602509
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.033654e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.6379 head_norm=1.545963 delta_norm=0.403365
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.8901 head_norm=2.201583
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.855413e-02
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.8907 head_norm=2.196519 delta_norm=0.078554
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.876817 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7570255993943675, 'auprc': 0.8602713847839694, 'loss_val': 0.6707595255766629, 'psi': 0.7983239135502083}-{'f1_val': 0.8268215338922976, 'auprc': 0.9919324210396657, 'loss_val': 0.41822805246361056, 'psi': 0.8928658887512448}
[S3] START round=38 head_norm_before_train=2.038358 cos_to_last_merge=0.9995 (last merge round=34)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.8360433453046362, 'auprc': 0.9882161368076264, 'loss_val': 0.28660498105725746, 'psi': 0.8969124619058323}-{'f1_val': 0.9787968658840719, 'auprc': 0.9994085283622545, 'loss_val': 0.07849128293382321, 'psi': 0.9870415308753449}
[S4] START round=38 head_norm_before_train=1.661332 cos_to_last_merge=0.9967 (last merge round=34)
[S4] round=38 local utility u=0.038734 metrics={'f1_val': 0.9425686932921494, 'auprc': 0.947575630335573, 'loss_val': 0.28346961462388454, 'psi': 0.9445714681095189}-{'f1_val': 0.9404566612621602, 'auprc': 0.9284939054697766, 'loss_val': 0.2910212052542428, 'psi': 0.9356715589452067}
[S5] START round=38 head_norm_before_train=1.867270 cos_to_last_merge=0.9999 (last merge round=35)
[S5] round=38 local utility u=0.475786 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9971634946578956, 'loss_val': 0.20273370165328083, 'psi': 0.8190581883235064}-{'f1_val': 0.6504442819159368, 'auprc': 0.8550625996102436, 'loss_val': 0.4287410062334473, 'psi': 0.7322916089936595}
[S6] START round=38 head_norm_before_train=1.989059 (no previous merge yet)
[S6] round=38 local utility u=0.687269 metrics={'f1_val': 0.76407140719016, 'auprc': 0.9527207669824884, 'loss_val': 0.6675429751188426, 'psi': 0.8395311511070913}-{'f1_val': 0.636161969710859, 'auprc': 0.8631416948795188, 'loss_val': 1.0058871541196712, 'psi': 0.7269538597783229}
[S7] START round=38 head_norm_before_train=1.545963 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.4834525906026925, 'auprc': 0.7811320604778964, 'loss_val': 0.9793680814258175, 'psi': 0.6025243785527741}-{'f1_val': 0.6428311879085848, 'auprc': 0.8127820922968529, 'loss_val': 0.5682701205435604, 'psi': 0.710811549663892}
[S8] START round=38 head_norm_before_train=1.592914 cos_to_last_merge=0.9971 (last merge round=33)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9653252946807307, 'auprc': 0.9988088276705391, 'loss_val': 0.10508592766339153, 'psi': 0.978718707876654}-{'f1_val': 0.9934741586295472, 'auprc': 0.9929256067701953, 'loss_val': 0.044543215319332224, 'psi': 0.9932547378858064}
[S9] START round=38 head_norm_before_train=2.008958 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9989692895629807, 'loss_val': 0.01934508178300766, 'psi': 0.9976992670805467}-{'f1_val': 0.9968525854255906, 'auprc': 0.9989164172064902, 'loss_val': 0.018794273663428, 'psi': 0.9976781181379504}
[S10] START round=38 head_norm_before_train=2.193989 cos_to_last_merge=0.9986 (last merge round=33)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.99388205259802, 'loss_val': 0.03394636553228452, 'psi': 0.9936124459317515}-{'f1_val': 0.9943096789853013, 'auprc': 0.9923826295533528, 'loss_val': 0.03275911027978268, 'psi': 0.9935388592125218}
[S11] START round=38 head_norm_before_train=2.169460 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9932712148512929, 'auprc': 0.996717958775303, 'loss_val': 0.043366351401355356, 'psi': 0.994649912420897}-{'f1_val': 0.9961541414107454, 'auprc': 0.9980971340565694, 'loss_val': 0.026566989037006418, 'psi': 0.996931338469075}
[S13] START round=38 head_norm_before_train=1.881840 (no previous merge yet)
[S13] round=38 local utility u=0.665952 metrics={'f1_val': 0.783805363614007, 'auprc': 0.7628562929517836, 'loss_val': 0.7005997943366359, 'psi': 0.7754257353491176}-{'f1_val': 0.6390752941870057, 'auprc': 0.701724402536017, 'loss_val': 0.9807277096149543, 'psi': 0.6641349375266101}
[S14] START round=38 head_norm_before_train=2.194257 cos_to_last_merge=0.9993 (last merge round=32)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9966361488089698, 'auprc': 0.9925367292104005, 'loss_val': 0.02847933668869627, 'psi': 0.9949963809695421}-{'f1_val': 0.9969975081576651, 'auprc': 0.9986591304855975, 'loss_val': 0.023430544622602092, 'psi': 0.997662157088838}
[S15] START round=38 head_norm_before_train=1.647414 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7195904579734009, 'auprc': 0.848521486788004, 'loss_val': 0.5123775117780849, 'psi': 0.7711628694992422}-{'f1_val': 0.9965259456095847, 'auprc': 0.997646443090867, 'loss_val': 0.031567462163266995, 'psi': 0.9969741446020977}
[S16] START round=38 head_norm_before_train=1.637034 cos_to_last_merge=0.9983 (last merge round=35)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.919913689918723, 'auprc': 0.9866331253899837, 'loss_val': 0.41742677227348224, 'psi': 0.9466014641072273}-{'f1_val': 0.9633071592756642, 'auprc': 0.9946151359904042, 'loss_val': 0.1548115027287546, 'psi': 0.9758303499615603}
[S17] START round=38 head_norm_before_train=2.196519 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6412771749392558, 'auprc': 0.9404029964014244, 'loss_val': 1.2972522011992849, 'psi': 0.7609275035241233}-{'f1_val': 0.8900860505572937, 'auprc': 0.9091664808470701, 'loss_val': 0.5252635093473424, 'psi': 0.8977182226732042}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:38402
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S5
[S2] cosine check vs S5: cos=0.9994
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:38414
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1791 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1791) from S13
[S14] cosine check vs S13: cos=-0.0059
[S14] DROPPED delta from S13 (cos=-0.0059 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S6
[S3] cosine check vs S6: cos=-0.0717
[S3] DROPPED delta from S6 (cos=-0.0717 < 0.0)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S4
[S16] cosine check vs S4: cos=0.9711
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.7570 head_norm=1.884058
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.379649e-02
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.7593 head_norm=1.879486 delta_norm=0.033796
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9199 head_norm=1.672236
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.013077e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9195 head_norm=1.662839 delta_norm=0.201308
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.879486 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.332964 metrics={'f1_val': 0.8304176617508201, 'auprc': 0.8492239528033458, 'loss_val': 0.41204221634454213, 'psi': 0.8379401781718303}-{'f1_val': 0.7570255993943675, 'auprc': 0.8602713847839694, 'loss_val': 0.6707595255766629, 'psi': 0.7983239135502083}
[S3] START round=39 head_norm_before_train=2.050540 cos_to_last_merge=0.9992 (last merge round=34)
[S3] round=39 local utility u=0.253688 metrics={'f1_val': 0.8971100888695851, 'auprc': 0.9986862841190813, 'loss_val': 0.17703968242355952, 'psi': 0.9377405669693836}-{'f1_val': 0.8360433453046362, 'auprc': 0.9882161368076264, 'loss_val': 0.28660498105725746, 'psi': 0.8969124619058323}
[S4] START round=39 head_norm_before_train=1.677719 cos_to_last_merge=0.9960 (last merge round=34)
[S4] round=39 local utility u=0.040798 metrics={'f1_val': 0.949694260699373, 'auprc': 0.9582882196990253, 'loss_val': 0.27676548731496103, 'psi': 0.953131844299234}-{'f1_val': 0.9425686932921494, 'auprc': 0.947575630335573, 'loss_val': 0.28346961462388454, 'psi': 0.9445714681095189}
[S5] START round=39 head_norm_before_train=1.875512 cos_to_last_merge=0.9998 (last merge round=35)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.6799224423720722, 'auprc': 0.9515391254616343, 'loss_val': 0.3013634262073871, 'psi': 0.7885691156078971}-{'f1_val': 0.7003213174339138, 'auprc': 0.9971634946578956, 'loss_val': 0.20273370165328083, 'psi': 0.8190581883235064}
[S6] START round=39 head_norm_before_train=1.998756 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7267989107653402, 'auprc': 0.9362214871166401, 'loss_val': 0.5664344374874694, 'psi': 0.8105679413058602}-{'f1_val': 0.76407140719016, 'auprc': 0.9527207669824884, 'loss_val': 0.6675429751188426, 'psi': 0.8395311511070913}
[S7] START round=39 head_norm_before_train=1.555822 cos_to_last_merge=0.9999 (last merge round=37)
[S7] round=39 local utility u=1.000000 metrics={'f1_val': 0.6831228069749012, 'auprc': 0.8772600320352424, 'loss_val': 0.34169348512703945, 'psi': 0.7607776969990377}-{'f1_val': 0.4834525906026925, 'auprc': 0.7811320604778964, 'loss_val': 0.9793680814258175, 'psi': 0.6025243785527741}
[S8] START round=39 head_norm_before_train=1.616158 cos_to_last_merge=0.9962 (last merge round=33)
[S8] round=39 local utility u=0.116135 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.996644015574478, 'loss_val': 0.0397052952518915, 'psi': 0.9951911884010136}-{'f1_val': 0.9653252946807307, 'auprc': 0.9988088276705391, 'loss_val': 0.10508592766339153, 'psi': 0.978718707876654}
[S9] START round=39 head_norm_before_train=2.016383 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9986091183641858, 'loss_val': 0.019098180093349768, 'psi': 0.9972897587460068}-{'f1_val': 0.9968525854255906, 'auprc': 0.9989692895629807, 'loss_val': 0.01934508178300766, 'psi': 0.9976992670805467}
[S10] START round=39 head_norm_before_train=2.210333 cos_to_last_merge=0.9980 (last merge round=33)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9934429734646854, 'loss_val': 0.03271650696198509, 'psi': 0.9934368142784177}-{'f1_val': 0.9934327081542391, 'auprc': 0.99388205259802, 'loss_val': 0.03394636553228452, 'psi': 0.9936124459317515}
[S11] START round=39 head_norm_before_train=2.178143 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=39 local utility u=0.017610 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9982361412454726, 'loss_val': 0.02999754877489425, 'psi': 0.9969869413446363}-{'f1_val': 0.9932712148512929, 'auprc': 0.996717958775303, 'loss_val': 0.043366351401355356, 'psi': 0.994649912420897}
[S13] START round=39 head_norm_before_train=1.887245 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6913733214567523, 'auprc': 0.7805330589161183, 'loss_val': 0.6903719873946355, 'psi': 0.7270372164404988}-{'f1_val': 0.783805363614007, 'auprc': 0.7628562929517836, 'loss_val': 0.7005997943366359, 'psi': 0.7754257353491176}
[S14] START round=39 head_norm_before_train=2.204736 cos_to_last_merge=0.9991 (last merge round=32)
[S14] round=39 local utility u=0.013238 metrics={'f1_val': 0.997050791983753, 'auprc': 0.9982462250770853, 'loss_val': 0.021619673549448836, 'psi': 0.9975289652210859}-{'f1_val': 0.9966361488089698, 'auprc': 0.9925367292104005, 'loss_val': 0.02847933668869627, 'psi': 0.9949963809695421}
[S15] START round=39 head_norm_before_train=1.703153 cos_to_last_merge=0.9992 (last merge round=37)
[S15] round=39 local utility u=0.889778 metrics={'f1_val': 0.8903252310937934, 'auprc': 0.9953243012634644, 'loss_val': 0.19763944299312167, 'psi': 0.9323248591616617}-{'f1_val': 0.7195904579734009, 'auprc': 0.848521486788004, 'loss_val': 0.5123775117780849, 'psi': 0.7711628694992422}
[S16] START round=39 head_norm_before_train=1.662839 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.292776 metrics={'f1_val': 0.9648007389430575, 'auprc': 0.9956327922740266, 'loss_val': 0.12819614673179927, 'psi': 0.9771335602754451}-{'f1_val': 0.919913689918723, 'auprc': 0.9866331253899837, 'loss_val': 0.41742677227348224, 'psi': 0.9466014641072273}
[S17] START round=39 head_norm_before_train=2.208583 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=39 local utility u=0.261614 metrics={'f1_val': 0.6814874633100919, 'auprc': 0.9542627453857663, 'loss_val': 1.056865535275744, 'psi': 0.7905975761403616}-{'f1_val': 0.6412771749392558, 'auprc': 0.9404029964014244, 'loss_val': 1.2972522011992849, 'psi': 0.7609275035241233}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:38417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:38415
[S3] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[S5] RECEIVED delta(kind=head bytes=1792) from S3
[S5] cosine check vs S3: cos=-0.0907
[S5] DROPPED delta from S3 (cos=-0.0907 < 0.0)
[S14] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] cosine check vs S14: cos=0.9990
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.9289
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] cosine check vs S4: cos=0.9921
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:38413
[S16] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1801) from S16
[S13] cosine check vs S16: cos=-0.0507
[S13] DROPPED delta from S16 (cos=-0.0507 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=0.9623
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6] r=40 psi=0.811 u=0.0000 p_local=0.2889 f1=0.727 auprc=0.936 bytes=28771
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.6815 head_norm=2.217039
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.989452e-02
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.6815 head_norm=2.213856 delta_norm=0.049895
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.791 u=0.2616 p_local=0.2743 f1=0.681 auprc=0.954 bytes=30634
[S14] r=40 psi=0.998 u=0.0132 p_local=0.0114 f1=0.997 auprc=0.998 bytes=34169
[S5] r=40 psi=0.789 u=0.0000 p_local=0.2491 f1=0.680 auprc=0.952 bytes=34187
[S2] r=40 psi=0.838 u=0.3330 p_local=0.1743 f1=0.830 auprc=0.849 bytes=28771
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.6831 head_norm=1.562242
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.220977e-01
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.6799 head_norm=1.582506 delta_norm=0.222098
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.761 u=1.0000 p_local=0.3799 f1=0.683 auprc=0.877 bytes=30609
[S4] r=40 psi=0.953 u=0.0408 p_local=0.0212 f1=0.950 auprc=0.958 bytes=26978
[S11] r=40 psi=0.997 u=0.0176 p_local=0.0068 f1=0.996 auprc=0.998 bytes=32329
[S13] r=40 psi=0.727 u=0.0000 p_local=0.1992 f1=0.691 auprc=0.781 bytes=26961
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0053 f1=0.996 auprc=0.999 bytes=34155
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.9648 head_norm=1.693520
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.067792e-01
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.9639 head_norm=1.692065 delta_norm=0.106779
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.977 u=0.2928 p_local=0.1046 f1=0.965 auprc=0.996 bytes=28758
[S8] r=40 psi=0.995 u=0.1161 p_local=0.0272 f1=0.994 auprc=0.997 bytes=32390
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.8903 head_norm=1.774749
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.315349e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.8867 head_norm=1.638674 delta_norm=0.331535
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.932 u=0.8898 p_local=0.4674 f1=0.890 auprc=0.995 bytes=30606
[S10] r=40 psi=0.993 u=0.0000 p_local=0.0020 f1=0.993 auprc=0.993 bytes=32358
[S3] r=40 psi=0.938 u=0.2537 p_local=0.1679 f1=0.897 auprc=0.999 bytes=28757
[S2] START round=40 head_norm_before_train=1.880901 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7285116224445047, 'auprc': 0.9007033192207075, 'loss_val': 0.4464789034151645, 'psi': 0.7973883011549858}-{'f1_val': 0.8304176617508201, 'auprc': 0.8492239528033458, 'loss_val': 0.41204221634454213, 'psi': 0.8379401781718303}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.062141 cos_to_last_merge=0.9989 (last merge round=34)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.8297909732668478, 'auprc': 0.9737949313312442, 'loss_val': 0.2846469321345963, 'psi': 0.8873925564926064}-{'f1_val': 0.8971100888695851, 'auprc': 0.9986862841190813, 'loss_val': 0.17703968242355952, 'psi': 0.9377405669693836}
[S4] START round=40 head_norm_before_train=1.697338 cos_to_last_merge=0.9950 (last merge round=34)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9414024256413442, 'auprc': 0.9479137542880087, 'loss_val': 0.2949801234669304, 'psi': 0.94400695710001}-{'f1_val': 0.949694260699373, 'auprc': 0.9582882196990253, 'loss_val': 0.27676548731496103, 'psi': 0.953131844299234}
[S5] START round=40 head_norm_before_train=1.881461 cos_to_last_merge=0.9996 (last merge round=35)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6258507257142492, 'auprc': 0.8206783241462614, 'loss_val': 0.5253668102769774, 'psi': 0.7037817650870541}-{'f1_val': 0.6799224423720722, 'auprc': 0.9515391254616343, 'loss_val': 0.3013634262073871, 'psi': 0.7885691156078971}
[S6] START round=40 head_norm_before_train=2.006567 (no previous merge yet)
[S6] round=40 local utility u=0.551699 metrics={'f1_val': 0.8665856268319392, 'auprc': 0.9627525851998671, 'loss_val': 0.38135062855178614, 'psi': 0.9050524101791104}-{'f1_val': 0.7267989107653402, 'auprc': 0.9362214871166401, 'loss_val': 0.5664344374874694, 'psi': 0.8105679413058602}
[S7] START round=40 head_norm_before_train=1.582506 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.3839044711677347, 'auprc': 0.7777293651351305, 'loss_val': 1.273151805261319, 'psi': 0.541434428754693}-{'f1_val': 0.6831228069749012, 'auprc': 0.8772600320352424, 'loss_val': 0.34169348512703945, 'psi': 0.7607776969990377}
[S8] START round=40 head_norm_before_train=1.633004 cos_to_last_merge=0.9954 (last merge round=33)
[S8] round=40 local utility u=0.002078 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9974287505674644, 'loss_val': 0.03790345772699991, 'psi': 0.9955050823982082}-{'f1_val': 0.9942226369520374, 'auprc': 0.996644015574478, 'loss_val': 0.0397052952518915, 'psi': 0.9951911884010136}
[S9] START round=40 head_norm_before_train=2.025130 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9990179297975428, 'loss_val': 0.02444081135247113, 'psi': 0.9957022812248397}-{'f1_val': 0.9964101856672208, 'auprc': 0.9986091183641858, 'loss_val': 0.019098180093349768, 'psi': 0.9972897587460068}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.222832 cos_to_last_merge=0.9976 (last merge round=33)
[S10] round=40 local utility u=0.000176 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9936414782526375, 'loss_val': 0.03296099133503478, 'psi': 0.9935162161935985}-{'f1_val': 0.9934327081542391, 'auprc': 0.9934429734646854, 'loss_val': 0.03271650696198509, 'psi': 0.9934368142784177}
[S11] START round=40 head_norm_before_train=2.188584 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=40 local utility u=0.002666 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9981610394074583, 'loss_val': 0.02444117840998322, 'psi': 0.9969569006094305}-{'f1_val': 0.9961541414107454, 'auprc': 0.9982361412454726, 'loss_val': 0.02999754877489425, 'psi': 0.9969869413446363}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=40 head_norm_before_train=1.893664 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.754813062883158, 'auprc': 0.709664114003577, 'loss_val': 0.9066103210249148, 'psi': 0.7367534833313256}-{'f1_val': 0.6913733214567523, 'auprc': 0.7805330589161183, 'loss_val': 0.6903719873946355, 'psi': 0.7270372164404988}
[S14] START round=40 head_norm_before_train=2.211795 cos_to_last_merge=0.9990 (last merge round=32)
[S14] round=40 local utility u=0.001357 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9986381696843838, 'loss_val': 0.021217963246690785, 'psi': 0.9977994818972293}-{'f1_val': 0.997050791983753, 'auprc': 0.9982462250770853, 'loss_val': 0.021619673549448836, 'psi': 0.9975289652210859}
[S15] START round=40 head_norm_before_train=1.638674 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7524456021762013, 'auprc': 0.9121537033295156, 'loss_val': 0.44459222885604444, 'psi': 0.816328842637527}-{'f1_val': 0.8903252310937934, 'auprc': 0.9953243012634644, 'loss_val': 0.19763944299312167, 'psi': 0.9323248591616617}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.692065 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.114227 metrics={'f1_val': 0.9908793938683479, 'auprc': 0.9946365474001159, 'loss_val': 0.053226161301617746, 'psi': 0.9923822552810551}-{'f1_val': 0.9648007389430575, 'auprc': 0.9956327922740266, 'loss_val': 0.12819614673179927, 'psi': 0.9771335602754451}
[S17] START round=40 head_norm_before_train=2.213856 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6601600578335046, 'auprc': 0.9789204556983845, 'loss_val': 1.0610461124411306, 'psi': 0.7876642169794565}-{'f1_val': 0.6814874633100919, 'auprc': 0.9542627453857663, 'loss_val': 1.056865535275744, 'psi': 0.7905975761403616}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:38417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:38412
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:38413
[S13] ⇄ pheromone p=0.159 → S14@127.0.0.1:38414
[S5] ⇄ pheromone p=0.199 → S2@127.0.0.1:38402
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] ⇄ pheromone p=0.017 → S16@127.0.0.1:38416
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S3] RECEIVED delta(kind=head bytes=1799) from S6
[S3] cosine check vs S6: cos=-0.0715
[S3] DROPPED delta from S6 (cos=-0.0715 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S14
[S17] cosine check vs S14: cos=0.9996
[S11] RECEIVED delta(kind=head bytes=1795) from S10
[S11] cosine check vs S10: cos=0.9969
[S6] ⇄ pheromone p=0.341 → S3@127.0.0.1:38403
[S10] ⇄ pheromone p=0.002 → S11@127.0.0.1:38412
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] ⇄ pheromone p=0.009 → S17@127.0.0.1:38417
[S13] RECEIVED delta(kind=head bytes=1800) from S16
[S13] cosine check vs S16: cos=-0.0580
[S13] DROPPED delta from S16 (cos=-0.0580 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.9898
[S3] ⇄ pheromone p=0.134 → S5@127.0.0.1:38405
[S16] ⇄ pheromone p=0.107 → S13@127.0.0.1:38413
[S8] ⇄ pheromone p=0.022 → S7@127.0.0.1:38408
[S7] RoundReady barrier timeout: have=1 need=2 — continuing
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3]  timeout peer S5
[S3]  timeout peer S9
[S8]  timeout peer S4
[S8]  timeout peer S7
[S6]  timeout peer S3
[S4]  timeout peer S16
[S13]  timeout peer S14
[S7]  timeout peer S6
[S7]  timeout peer S10
[S7]  timeout peer S15
[S14]  timeout peer S17
[S5]  timeout peer S2
[S10]  timeout peer S11
[S16]  timeout peer S8
[S16]  timeout peer S13
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.3839 head_norm=1.586601
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.202784e-01
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.3849 head_norm=1.614910 delta_norm=0.120278
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=41 head_norm_before_train=1.886451 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=41 local utility u=0.273970 metrics={'f1_val': 0.8275977784136561, 'auprc': 0.8763020219047737, 'loss_val': 0.4198525582759837, 'psi': 0.8470794758101031}-{'f1_val': 0.7285116224445047, 'auprc': 0.9007033192207075, 'loss_val': 0.4464789034151645, 'psi': 0.7973883011549858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=41 head_norm_before_train=2.074699 cos_to_last_merge=0.9985 (last merge round=34)
[S3] round=41 local utility u=0.167084 metrics={'f1_val': 0.8638407220030684, 'auprc': 0.9979613373966619, 'loss_val': 0.22727713164107294, 'psi': 0.9174889681605058}-{'f1_val': 0.8297909732668478, 'auprc': 0.9737949313312442, 'loss_val': 0.2846469321345963, 'psi': 0.8873925564926064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=41 head_norm_before_train=1.709648 cos_to_last_merge=0.9940 (last merge round=34)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.929425618592864, 'auprc': 0.9311491441401861, 'loss_val': 0.37525620642819285, 'psi': 0.9301150288117929}-{'f1_val': 0.9414024256413442, 'auprc': 0.9479137542880087, 'loss_val': 0.2949801234669304, 'psi': 0.94400695710001}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.890173 cos_to_last_merge=0.9994 (last merge round=35)
[S5] round=41 local utility u=0.548055 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9637725816832904, 'loss_val': 0.30535854784365235, 'psi': 0.8057013917681315}-{'f1_val': 0.6258507257142492, 'auprc': 0.8206783241462614, 'loss_val': 0.5253668102769774, 'psi': 0.7037817650870541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=41 head_norm_before_train=2.014381 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6194043046236942, 'auprc': 0.89112726164008, 'loss_val': 1.048718178278868, 'psi': 0.7280934874302485}-{'f1_val': 0.8665856268319392, 'auprc': 0.9627525851998671, 'loss_val': 0.38135062855178614, 'psi': 0.9050524101791104}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.614910 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=1.000000 metrics={'f1_val': 0.683546263241523, 'auprc': 0.887824445062432, 'loss_val': 0.3386961896341259, 'psi': 0.7652575359698865}-{'f1_val': 0.3839044711677347, 'auprc': 0.7777293651351305, 'loss_val': 1.273151805261319, 'psi': 0.541434428754693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=41 head_norm_before_train=1.651515 cos_to_last_merge=0.9946 (last merge round=33)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9626343450751522, 'auprc': 0.9987744084916087, 'loss_val': 0.11119154942154225, 'psi': 0.9770903704417349}-{'f1_val': 0.9942226369520374, 'auprc': 0.9974287505674644, 'loss_val': 0.03790345772699991, 'psi': 0.9955050823982082}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.034583 (no previous merge yet)
[S9] round=41 local utility u=0.007313 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9957986272294811, 'loss_val': 0.019168165007285874, 'psi': 0.9963157579801273}-{'f1_val': 0.9934918488430377, 'auprc': 0.9990179297975428, 'loss_val': 0.02444081135247113, 'psi': 0.9957022812248397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=41 head_norm_before_train=2.235576 cos_to_last_merge=0.9971 (last merge round=33)
[S10] round=41 local utility u=0.001471 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9932994359252537, 'loss_val': 0.031622109576416334, 'psi': 0.9936424020004284}-{'f1_val': 0.9934327081542391, 'auprc': 0.9936414782526375, 'loss_val': 0.03296099133503478, 'psi': 0.9935162161935985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=41 head_norm_before_train=2.199806 cos_to_last_merge=0.9999 (last merge round=37)
[S11] round=41 local utility u=0.000232 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9979756265614806, 'loss_val': 0.023421260187664758, 'psi': 0.9968827354710394}-{'f1_val': 0.9961541414107454, 'auprc': 0.9981610394074583, 'loss_val': 0.02444117840998322, 'psi': 0.9969569006094305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9962 head_norm=2.211177
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.026705e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9962 head_norm=2.221577 delta_norm=0.090267
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] START round=41 head_norm_before_train=1.901196 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.624012705693792, 'auprc': 0.6517899139260566, 'loss_val': 1.2440755234998608, 'psi': 0.6351235889866977}-{'f1_val': 0.754813062883158, 'auprc': 0.709664114003577, 'loss_val': 0.9066103210249148, 'psi': 0.7367534833313256}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.219056 cos_to_last_merge=0.9989 (last merge round=32)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9951405245908663, 'loss_val': 0.022891738005781922, 'psi': 0.9962547147309455}-{'f1_val': 0.997240356705793, 'auprc': 0.9986381696843838, 'loss_val': 0.021217963246690785, 'psi': 0.9977994818972293}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.715742 cos_to_last_merge=0.9988 (last merge round=39)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9975358697292098, 'loss_val': 0.03058583859814893, 'psi': 0.9970623489241963}-{'f1_val': 0.7524456021762013, 'auprc': 0.9121537033295156, 'loss_val': 0.44459222885604444, 'psi': 0.816328842637527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=41 head_norm_before_train=1.718560 cos_to_last_merge=0.9999 (last merge round=39)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9703431347273711, 'auprc': 0.9956044136114439, 'loss_val': 0.10787987790728111, 'psi': 0.9804476462810002}-{'f1_val': 0.9908793938683479, 'auprc': 0.9946365474001159, 'loss_val': 0.053226161301617746, 'psi': 0.9923822552810551}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=2.223943 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6156290665952175, 'auprc': 0.955680547747815, 'loss_val': 1.5483246451681687, 'psi': 0.7516496590562565}-{'f1_val': 0.6601600578335046, 'auprc': 0.9789204556983845, 'loss_val': 1.0610461124411306, 'psi': 0.7876642169794565}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.6156 head_norm=2.233752
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.352982e-02
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.6162 head_norm=2.226164 delta_norm=0.033530
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.899189 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.757850609105489, 'auprc': 0.7370943916949662, 'loss_val': 0.6855191796874656, 'psi': 0.7495481221412799}-{'f1_val': 0.8275977784136561, 'auprc': 0.8763020219047737, 'loss_val': 0.4198525582759837, 'psi': 0.8470794758101031}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.089002 cos_to_last_merge=0.9980 (last merge round=34)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.7014405296074404, 'auprc': 0.9614326865058926, 'loss_val': 0.6221905540258144, 'psi': 0.8054373923668213}-{'f1_val': 0.8638407220030684, 'auprc': 0.9979613373966619, 'loss_val': 0.22727713164107294, 'psi': 0.9174889681605058}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.724628 cos_to_last_merge=0.9931 (last merge round=34)
[S4] round=42 local utility u=0.129811 metrics={'f1_val': 0.9410722035017508, 'auprc': 0.9707359937098451, 'loss_val': 0.3042748746583263, 'psi': 0.9529377195849886}-{'f1_val': 0.929425618592864, 'auprc': 0.9311491441401861, 'loss_val': 0.37525620642819285, 'psi': 0.9301150288117929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=42 head_norm_before_train=1.899796 cos_to_last_merge=0.9992 (last merge round=35)
[S5] round=42 local utility u=0.110050 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9949767396460389, 'loss_val': 0.17887434858678625, 'psi': 0.8181834863187638}-{'f1_val': 0.700320598491359, 'auprc': 0.9637725816832904, 'loss_val': 0.30535854784365235, 'psi': 0.8057013917681315}
[S5] not sending this round → trigger blocked (psi=0.818)
[S6] START round=42 head_norm_before_train=2.019280 (no previous merge yet)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8418490692515451, 'auprc': 0.9207527546442738, 'loss_val': 0.46244948168759104, 'psi': 0.8734105434086366}-{'f1_val': 0.6194043046236942, 'auprc': 0.89112726164008, 'loss_val': 1.048718178278868, 'psi': 0.7280934874302485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=42 head_norm_before_train=1.617566 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5962546859993184, 'auprc': 0.7936730238531473, 'loss_val': 0.6678884528248612, 'psi': 0.67522202114085}-{'f1_val': 0.683546263241523, 'auprc': 0.887824445062432, 'loss_val': 0.3386961896341259, 'psi': 0.7652575359698865}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.665812 cos_to_last_merge=0.9940 (last merge round=33)
[S8] round=42 local utility u=0.112848 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.9892423573940118, 'loss_val': 0.04082293275699661, 'psi': 0.9916699389015717}-{'f1_val': 0.9626343450751522, 'auprc': 0.9987744084916087, 'loss_val': 0.11119154942154225, 'psi': 0.9770903704417349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=42 head_norm_before_train=2.041541 (no previous merge yet)
[S9] round=42 local utility u=0.005550 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.999176722412352, 'loss_val': 0.018181397227925063, 'psi': 0.9976648961445875}-{'f1_val': 0.9966605118138915, 'auprc': 0.9957986272294811, 'loss_val': 0.019168165007285874, 'psi': 0.9963157579801273}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=42 head_norm_before_train=2.245833 cos_to_last_merge=0.9968 (last merge round=33)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9936414574151126, 'loss_val': 0.032385587193271184, 'psi': 0.9935162078585885}-{'f1_val': 0.993871046050545, 'auprc': 0.9932994359252537, 'loss_val': 0.031622109576416334, 'psi': 0.9936424020004284}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.221577 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.001509 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.998153317029279, 'loss_val': 0.022386879311380437, 'psi': 0.997098839130178}-{'f1_val': 0.9961541414107454, 'auprc': 0.9979756265614806, 'loss_val': 0.023421260187664758, 'psi': 0.9968827354710394}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=42 head_norm_before_train=1.903546 (no previous merge yet)
[S13] round=42 local utility u=0.691177 metrics={'f1_val': 0.7509085504778751, 'auprc': 0.7238003765711979, 'loss_val': 0.83912800604242, 'psi': 0.7400652809152042}-{'f1_val': 0.624012705693792, 'auprc': 0.6517899139260566, 'loss_val': 1.2440755234998608, 'psi': 0.6351235889866977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=42 head_norm_before_train=2.227129 cos_to_last_merge=0.9987 (last merge round=32)
[S14] round=42 local utility u=0.001431 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9955087627935935, 'loss_val': 0.022591282126886356, 'psi': 0.9965477191409132}-{'f1_val': 0.9969975081576651, 'auprc': 0.9951405245908663, 'loss_val': 0.022891738005781922, 'psi': 0.9962547147309455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=42 head_norm_before_train=1.792075 cos_to_last_merge=0.9959 (last merge round=39)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.8183809691583623, 'auprc': 0.9741809438784482, 'loss_val': 0.36172056529289714, 'psi': 0.8807009590463967}-{'f1_val': 0.9967466683875206, 'auprc': 0.9975358697292098, 'loss_val': 0.03058583859814893, 'psi': 0.9970623489241963}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.741032 cos_to_last_merge=0.9997 (last merge round=39)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9580180711983121, 'auprc': 0.9916919540487681, 'loss_val': 0.13736397283854784, 'psi': 0.9714876243384944}-{'f1_val': 0.9703431347273711, 'auprc': 0.9956044136114439, 'loss_val': 0.10787987790728111, 'psi': 0.9804476462810002}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=2.226164 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=1.000000 metrics={'f1_val': 0.9045713739715963, 'auprc': 0.9321821730524283, 'loss_val': 0.4545623841927105, 'psi': 0.915615693603929}-{'f1_val': 0.6156290665952175, 'auprc': 0.955680547747815, 'loss_val': 1.5483246451681687, 'psi': 0.7516496590562565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=43 head_norm_before_train=1.909446 cos_to_last_merge=0.9999 (last merge round=38)
[S2] round=43 local utility u=0.577282 metrics={'f1_val': 0.7876427218129428, 'auprc': 0.9752927843646005, 'loss_val': 0.42430346780231815, 'psi': 0.8627027468336059}-{'f1_val': 0.757850609105489, 'auprc': 0.7370943916949662, 'loss_val': 0.6855191796874656, 'psi': 0.7495481221412799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=43 head_norm_before_train=2.100172 cos_to_last_merge=0.9976 (last merge round=34)
[S3] round=43 local utility u=1.000000 metrics={'f1_val': 0.966545874184132, 'auprc': 0.9986141045032191, 'loss_val': 0.08295677139901755, 'psi': 0.9793731663117669}-{'f1_val': 0.7014405296074404, 'auprc': 0.9614326865058926, 'loss_val': 0.6221905540258144, 'psi': 0.8054373923668213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=43 head_norm_before_train=1.742259 cos_to_last_merge=0.9922 (last merge round=34)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9398327426842823, 'auprc': 0.9524709703021512, 'loss_val': 0.310930199758569, 'psi': 0.9448880337314298}-{'f1_val': 0.9410722035017508, 'auprc': 0.9707359937098451, 'loss_val': 0.3042748746583263, 'psi': 0.9529377195849886}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.909787 cos_to_last_merge=0.9989 (last merge round=35)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.6341054165897321, 'auprc': 0.8401106774476214, 'loss_val': 0.4776438967468572, 'psi': 0.7165075209328877}-{'f1_val': 0.7003213174339138, 'auprc': 0.9949767396460389, 'loss_val': 0.17887434858678625, 'psi': 0.8181834863187638}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=2.026992 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6404436546726169, 'auprc': 0.9546098724031631, 'loss_val': 0.5516989390524619, 'psi': 0.7661101417648354}-{'f1_val': 0.8418490692515451, 'auprc': 0.9207527546442738, 'loss_val': 0.46244948168759104, 'psi': 0.8734105434086366}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.623359 cos_to_last_merge=0.9999 (last merge round=40)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5623167543138988, 'auprc': 0.7839088857952901, 'loss_val': 0.8128259579954733, 'psi': 0.6509536069064553}-{'f1_val': 0.5962546859993184, 'auprc': 0.7936730238531473, 'loss_val': 0.6678884528248612, 'psi': 0.67522202114085}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.681745 cos_to_last_merge=0.9934 (last merge round=33)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9850518562300145, 'auprc': 0.9987297958260102, 'loss_val': 0.05173814739831878, 'psi': 0.9905230320684127}-{'f1_val': 0.9932883265732785, 'auprc': 0.9892423573940118, 'loss_val': 0.04082293275699661, 'psi': 0.9916699389015717}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.047582 (no previous merge yet)
[S9] round=43 local utility u=0.000073 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9991730396504044, 'loss_val': 0.01804590155174656, 'psi': 0.9976655229484966}-{'f1_val': 0.9966570119660778, 'auprc': 0.999176722412352, 'loss_val': 0.018181397227925063, 'psi': 0.9976648961445875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=43 head_norm_before_train=2.256536 cos_to_last_merge=0.9963 (last merge round=33)
[S10] round=43 local utility u=0.001432 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9933027810122089, 'loss_val': 0.031136145889470116, 'psi': 0.9936437400352105}-{'f1_val': 0.9934327081542391, 'auprc': 0.9936414574151126, 'loss_val': 0.032385587193271184, 'psi': 0.9935162078585885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=43 head_norm_before_train=2.229266 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9981707928750607, 'loss_val': 0.022608320344472056, 'psi': 0.9969608019964715}-{'f1_val': 0.9963958538641108, 'auprc': 0.998153317029279, 'loss_val': 0.022386879311380437, 'psi': 0.997098839130178}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.909487 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.7410307187892597, 'auprc': 0.7366335000368623, 'loss_val': 0.8420797808027688, 'psi': 0.7392718312883008}-{'f1_val': 0.7509085504778751, 'auprc': 0.7238003765711979, 'loss_val': 0.83912800604242, 'psi': 0.7400652809152042}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.231935 cos_to_last_merge=0.9986 (last merge round=32)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9740436162189684, 'auprc': 0.9965018440463315, 'loss_val': 0.05697236604774656, 'psi': 0.9830269073499136}-{'f1_val': 0.997240356705793, 'auprc': 0.9955087627935935, 'loss_val': 0.022591282126886356, 'psi': 0.9965477191409132}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.850093 cos_to_last_merge=0.9932 (last merge round=39)
[S15] round=43 local utility u=0.731845 metrics={'f1_val': 0.9952031918771358, 'auprc': 0.9975167836201537, 'loss_val': 0.0289708381724476, 'psi': 0.9961286285743429}-{'f1_val': 0.8183809691583623, 'auprc': 0.9741809438784482, 'loss_val': 0.36172056529289714, 'psi': 0.8807009590463967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S16] START round=43 head_norm_before_train=1.758959 cos_to_last_merge=0.9995 (last merge round=39)
[S16] round=43 local utility u=0.157565 metrics={'f1_val': 0.9928076081826916, 'auprc': 0.9954214825512544, 'loss_val': 0.04215958078607649, 'psi': 0.9938531579301167}-{'f1_val': 0.9580180711983121, 'auprc': 0.9916919540487681, 'loss_val': 0.13736397283854784, 'psi': 0.9714876243384944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=43 head_norm_before_train=2.233159 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5652135853552709, 'auprc': 0.9196909747055286, 'loss_val': 1.6380240041098892, 'psi': 0.707004541095374}-{'f1_val': 0.9045713739715963, 'auprc': 0.9321821730524283, 'loss_val': 0.4545623841927105, 'psi': 0.915615693603929}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.919404 cos_to_last_merge=0.9999 (last merge round=38)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8254108097173896, 'auprc': 0.9141028855404033, 'loss_val': 0.4765023814331683, 'psi': 0.860887640046595}-{'f1_val': 0.7876427218129428, 'auprc': 0.9752927843646005, 'loss_val': 0.42430346780231815, 'psi': 0.8627027468336059}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.109884 cos_to_last_merge=0.9972 (last merge round=34)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8366734025969793, 'auprc': 0.970280218907467, 'loss_val': 0.3568538733888064, 'psi': 0.8901161291211743}-{'f1_val': 0.966545874184132, 'auprc': 0.9986141045032191, 'loss_val': 0.08295677139901755, 'psi': 0.9793731663117669}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.753820 cos_to_last_merge=0.9912 (last merge round=34)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9389812273848978, 'auprc': 0.9267494613401841, 'loss_val': 0.3107151445012485, 'psi': 0.9340885209670123}-{'f1_val': 0.9398327426842823, 'auprc': 0.9524709703021512, 'loss_val': 0.310930199758569, 'psi': 0.9448880337314298}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.917338 cos_to_last_merge=0.9987 (last merge round=35)
[S5] round=44 local utility u=0.005421 metrics={'f1_val': 0.6624011752293086, 'auprc': 0.7854878709190649, 'loss_val': 0.47270876333939854, 'psi': 0.7116358535052112}-{'f1_val': 0.6341054165897321, 'auprc': 0.8401106774476214, 'loss_val': 0.4776438967468572, 'psi': 0.7165075209328877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=44 head_norm_before_train=2.035494 (no previous merge yet)
[S6] round=44 local utility u=0.578040 metrics={'f1_val': 0.7924845665416144, 'auprc': 0.9773650846751525, 'loss_val': 0.37613087385477556, 'psi': 0.8664367737950296}-{'f1_val': 0.6404436546726169, 'auprc': 0.9546098724031631, 'loss_val': 0.5516989390524619, 'psi': 0.7661101417648354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=44 head_norm_before_train=1.632617 cos_to_last_merge=0.9997 (last merge round=40)
[S7] round=44 local utility u=0.383381 metrics={'f1_val': 0.6374197036016505, 'auprc': 0.8035970738903381, 'loss_val': 0.555746292208839, 'psi': 0.7038906517171255}-{'f1_val': 0.5623167543138988, 'auprc': 0.7839088857952901, 'loss_val': 0.8128259579954733, 'psi': 0.6509536069064553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=44 head_norm_before_train=1.695041 cos_to_last_merge=0.9928 (last merge round=33)
[S8] round=44 local utility u=0.007947 metrics={'f1_val': 0.9871098115830934, 'auprc': 0.9989338720624886, 'loss_val': 0.04880322111569506, 'psi': 0.9918394357748515}-{'f1_val': 0.9850518562300145, 'auprc': 0.9987297958260102, 'loss_val': 0.05173814739831878, 'psi': 0.9905230320684127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=44 head_norm_before_train=2.053114 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9935956507372695, 'loss_val': 0.01961675943572394, 'psi': 0.9951883171624744}-{'f1_val': 0.9966605118138915, 'auprc': 0.9991730396504044, 'loss_val': 0.01804590155174656, 'psi': 0.9976655229484966}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.267492 cos_to_last_merge=0.9959 (last merge round=33)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9938542329858318, 'loss_val': 0.032110493198802596, 'psi': 0.9936013180868762}-{'f1_val': 0.993871046050545, 'auprc': 0.9933027810122089, 'loss_val': 0.031136145889470116, 'psi': 0.9936437400352105}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.236949 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9981696410302543, 'loss_val': 0.022885014721512657, 'psi': 0.9969603412585489}-{'f1_val': 0.9961541414107454, 'auprc': 0.9981707928750607, 'loss_val': 0.022608320344472056, 'psi': 0.9969608019964715}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.916291 (no previous merge yet)
[S13] round=44 local utility u=0.522755 metrics={'f1_val': 0.7972478737860851, 'auprc': 0.830959341577891, 'loss_val': 0.41684969474540884, 'psi': 0.8107324609028075}-{'f1_val': 0.7410307187892597, 'auprc': 0.7366335000368623, 'loss_val': 0.8420797808027688, 'psi': 0.7392718312883008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=44 head_norm_before_train=2.235970 cos_to_last_merge=0.9985 (last merge round=32)
[S14] round=44 local utility u=0.089385 metrics={'f1_val': 0.997043018986542, 'auprc': 0.9986952732243628, 'loss_val': 0.022779471260268188, 'psi': 0.9977039206816704}-{'f1_val': 0.9740436162189684, 'auprc': 0.9965018440463315, 'loss_val': 0.05697236604774656, 'psi': 0.9830269073499136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=44 head_norm_before_train=1.898300 cos_to_last_merge=0.9908 (last merge round=39)
[S15] round=44 local utility u=0.004116 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9963675929939944, 'loss_val': 0.02432492415822839, 'psi': 0.9963723453837915}-{'f1_val': 0.9952031918771358, 'auprc': 0.9975167836201537, 'loss_val': 0.0289708381724476, 'psi': 0.9961286285743429}
[S15] not sending this round → trigger blocked (psi=0.996)
[S16] START round=44 head_norm_before_train=1.774227 cos_to_last_merge=0.9992 (last merge round=39)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9928076081826916, 'auprc': 0.9936512195529555, 'loss_val': 0.04588880815513359, 'psi': 0.9931450527307972}-{'f1_val': 0.9928076081826916, 'auprc': 0.9954214825512544, 'loss_val': 0.04215958078607649, 'psi': 0.9938531579301167}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.237581 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=44 local utility u=1.000000 metrics={'f1_val': 0.8431183215967188, 'auprc': 0.8009760648731075, 'loss_val': 0.6576050136707137, 'psi': 0.8262614189072743}-{'f1_val': 0.5652135853552709, 'auprc': 0.9196909747055286, 'loss_val': 1.6380240041098892, 'psi': 0.707004541095374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] sending update (kind=head size=1788 to 1 peers)
[S2] START round=45 head_norm_before_train=1.928544 cos_to_last_merge=0.9998 (last merge round=38)
[S2] round=45 local utility u=0.137923 metrics={'f1_val': 0.8280280624533745, 'auprc': 0.9750310718856623, 'loss_val': 0.39914503268460355, 'psi': 0.8868292662262895}-{'f1_val': 0.8254108097173896, 'auprc': 0.9141028855404033, 'loss_val': 0.4765023814331683, 'psi': 0.860887640046595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=45 head_norm_before_train=2.121944 cos_to_last_merge=0.9967 (last merge round=34)
[S3] round=45 local utility u=0.224195 metrics={'f1_val': 0.8716324119130927, 'auprc': 0.9995499572282195, 'loss_val': 0.20602636060265458, 'psi': 0.9227994300391434}-{'f1_val': 0.8366734025969793, 'auprc': 0.970280218907467, 'loss_val': 0.3568538733888064, 'psi': 0.8901161291211743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] START round=45 head_norm_before_train=1.764751 cos_to_last_merge=0.9902 (last merge round=34)
[S4] round=45 local utility u=0.043702 metrics={'f1_val': 0.9416220397442994, 'auprc': 0.9464433875253483, 'loss_val': 0.29823688615546934, 'psi': 0.9435505788567189}-{'f1_val': 0.9389812273848978, 'auprc': 0.9267494613401841, 'loss_val': 0.3107151445012485, 'psi': 0.9340885209670123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=45 head_norm_before_train=1.922368 cos_to_last_merge=0.9985 (last merge round=35)
[S5] round=45 local utility u=0.539849 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9910349647958693, 'loss_val': 0.23717330482416052, 'psi': 0.8166067763786959}-{'f1_val': 0.6624011752293086, 'auprc': 0.7854878709190649, 'loss_val': 0.47270876333939854, 'psi': 0.7116358535052112}
[S5] not sending this round → trigger blocked (psi=0.817)
[S6] START round=45 head_norm_before_train=2.043671 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.829267574697359, 'auprc': 0.9130013492217592, 'loss_val': 0.49188069837042575, 'psi': 0.8627610845071191}-{'f1_val': 0.7924845665416144, 'auprc': 0.9773650846751525, 'loss_val': 0.37613087385477556, 'psi': 0.8664367737950296}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.641807 cos_to_last_merge=0.9994 (last merge round=40)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5709219019244617, 'auprc': 0.7852464116991407, 'loss_val': 0.7932891214488011, 'psi': 0.6566517058343333}-{'f1_val': 0.6374197036016505, 'auprc': 0.8035970738903381, 'loss_val': 0.555746292208839, 'psi': 0.7038906517171255}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.702411 cos_to_last_merge=0.9922 (last merge round=33)
[S8] round=45 local utility u=0.018288 metrics={'f1_val': 0.9918431215757397, 'auprc': 0.9981916888790119, 'loss_val': 0.03839977578115305, 'psi': 0.9943825484970485}-{'f1_val': 0.9871098115830934, 'auprc': 0.9989338720624886, 'loss_val': 0.04880322111569506, 'psi': 0.9918394357748515}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=45 head_norm_before_train=2.060290 (no previous merge yet)
[S9] round=45 local utility u=0.007448 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.999450388261832, 'loss_val': 0.019919625756705795, 'psi': 0.9972936183535643}-{'f1_val': 0.9962500947792776, 'auprc': 0.9935956507372695, 'loss_val': 0.01961675943572394, 'psi': 0.9951883171624744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=45 head_norm_before_train=2.278132 cos_to_last_merge=0.9954 (last merge round=33)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9938594254939935, 'loss_val': 0.03217108507993933, 'psi': 0.993603395090141}-{'f1_val': 0.9934327081542391, 'auprc': 0.9938542329858318, 'loss_val': 0.032110493198802596, 'psi': 0.9936013180868762}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.245957 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=45 local utility u=0.000069 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9981573147646627, 'loss_val': 0.02270954271192989, 'psi': 0.9969554107523123}-{'f1_val': 0.9961541414107454, 'auprc': 0.9981696410302543, 'loss_val': 0.022885014721512657, 'psi': 0.9969603412585489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=45 head_norm_before_train=1.926480 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6061058115024073, 'auprc': 0.63927750226093, 'loss_val': 1.2993924041460316, 'psi': 0.6193744878058164}-{'f1_val': 0.7972478737860851, 'auprc': 0.830959341577891, 'loss_val': 0.41684969474540884, 'psi': 0.8107324609028075}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.241167 cos_to_last_merge=0.9984 (last merge round=32)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9974577071835665, 'auprc': 0.9965963423652158, 'loss_val': 0.020877140994717647, 'psi': 0.9971131612562262}-{'f1_val': 0.997043018986542, 'auprc': 0.9986952732243628, 'loss_val': 0.022779471260268188, 'psi': 0.9977039206816704}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.937173 cos_to_last_merge=0.9888 (last merge round=39)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.86790053492047, 'loss_val': 0.664598125745015, 'psi': 0.7677104002699622}-{'f1_val': 0.9963755136436562, 'auprc': 0.9963675929939944, 'loss_val': 0.02432492415822839, 'psi': 0.9963723453837915}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.787781 cos_to_last_merge=0.9990 (last merge round=39)
[S16] round=45 local utility u=0.005748 metrics={'f1_val': 0.9928076081826916, 'auprc': 0.9955334308950055, 'loss_val': 0.04004019985908101, 'psi': 0.9938979372676171}-{'f1_val': 0.9928076081826916, 'auprc': 0.9936512195529555, 'loss_val': 0.04588880815513359, 'psi': 0.9931450527307972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=45 head_norm_before_train=2.241699 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6834217374675742, 'auprc': 0.935806768626015, 'loss_val': 1.0962908790104637, 'psi': 0.7843757499309505}-{'f1_val': 0.8431183215967188, 'auprc': 0.8009760648731075, 'loss_val': 0.6576050136707137, 'psi': 0.8262614189072743}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.928604 cos_to_last_merge=0.9997 (last merge round=38)
[S2] round=46 local utility u=0.018766 metrics={'f1_val': 0.8284541135265933, 'auprc': 0.9898546189231289, 'loss_val': 0.4086395683941986, 'psi': 0.8930143156852075}-{'f1_val': 0.8280280624533745, 'auprc': 0.9750310718856623, 'loss_val': 0.39914503268460355, 'psi': 0.8868292662262895}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=46 head_norm_before_train=2.135328 cos_to_last_merge=0.9961 (last merge round=34)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.8631462501482947, 'auprc': 0.968887575962406, 'loss_val': 0.3541726628324508, 'psi': 0.9054427804739392}-{'f1_val': 0.8716324119130927, 'auprc': 0.9995499572282195, 'loss_val': 0.20602636060265458, 'psi': 0.9227994300391434}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.771874 cos_to_last_merge=0.9892 (last merge round=34)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9421229820772998, 'auprc': 0.9450040997807694, 'loss_val': 0.30321381189591734, 'psi': 0.9432754291586876}-{'f1_val': 0.9416220397442994, 'auprc': 0.9464433875253483, 'loss_val': 0.29823688615546934, 'psi': 0.9435505788567189}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.925712 cos_to_last_merge=0.9983 (last merge round=35)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9329740143325379, 'loss_val': 0.3262548637360043, 'psi': 0.7933819648278306}-{'f1_val': 0.7003213174339138, 'auprc': 0.9910349647958693, 'loss_val': 0.23717330482416052, 'psi': 0.8166067763786959}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=2.063216 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6096812678459963, 'auprc': 0.8446470285410368, 'loss_val': 1.2281255053994924, 'psi': 0.7036675721240124}-{'f1_val': 0.829267574697359, 'auprc': 0.9130013492217592, 'loss_val': 0.49188069837042575, 'psi': 0.8627610845071191}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.648926 cos_to_last_merge=0.9991 (last merge round=40)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5251876301110823, 'auprc': 0.7821494146017507, 'loss_val': 0.8788735868025009, 'psi': 0.6279723439073497}-{'f1_val': 0.5709219019244617, 'auprc': 0.7852464116991407, 'loss_val': 0.7932891214488011, 'psi': 0.6566517058343333}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.714218 cos_to_last_merge=0.9915 (last merge round=33)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9928227983692537, 'auprc': 0.9875701121906979, 'loss_val': 0.044635955543838625, 'psi': 0.9907217238978314}-{'f1_val': 0.9918431215757397, 'auprc': 0.9981916888790119, 'loss_val': 0.03839977578115305, 'psi': 0.9943825484970485}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.067694 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9994465018282204, 'loss_val': 0.02764534427439301, 'psi': 0.9945311996554327}-{'f1_val': 0.9958557717480525, 'auprc': 0.999450388261832, 'loss_val': 0.019919625756705795, 'psi': 0.9972936183535643}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.285755 cos_to_last_merge=0.9951 (last merge round=33)
[S10] round=46 local utility u=0.000113 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.993953437176666, 'loss_val': 0.03222696924063555, 'psi': 0.9936409997632099}-{'f1_val': 0.9934327081542391, 'auprc': 0.9938594254939935, 'loss_val': 0.03217108507993933, 'psi': 0.993603395090141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=46 head_norm_before_train=2.255590 cos_to_last_merge=0.9999 (last merge round=41)
[S11] round=46 local utility u=0.000099 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9981364480184686, 'loss_val': 0.022448044069225754, 'psi': 0.9969470640538347}-{'f1_val': 0.9961541414107454, 'auprc': 0.9981573147646627, 'loss_val': 0.02270954271192989, 'psi': 0.9969554107523123}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=46 head_norm_before_train=1.935561 (no previous merge yet)
[S13] round=46 local utility u=0.809520 metrics={'f1_val': 0.7498563941454544, 'auprc': 0.739512968066719, 'loss_val': 0.8435626642760654, 'psi': 0.7457190237139601}-{'f1_val': 0.6061058115024073, 'auprc': 0.63927750226093, 'loss_val': 1.2993924041460316, 'psi': 0.6193744878058164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=46 head_norm_before_train=2.246179 cos_to_last_merge=0.9981 (last merge round=32)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9966235765367457, 'auprc': 0.9965866497029179, 'loss_val': 0.028007673120264684, 'psi': 0.9966088058032146}-{'f1_val': 0.9974577071835665, 'auprc': 0.9965963423652158, 'loss_val': 0.020877140994717647, 'psi': 0.9971131612562262}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.967852 cos_to_last_merge=0.9873 (last merge round=39)
[S15] round=46 local utility u=1.000000 metrics={'f1_val': 0.9931832020571294, 'auprc': 0.9985129125867511, 'loss_val': 0.029820916066813627, 'psi': 0.9953150862689781}-{'f1_val': 0.7009169771696235, 'auprc': 0.86790053492047, 'loss_val': 0.664598125745015, 'psi': 0.7677104002699622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=46 head_norm_before_train=1.801503 cos_to_last_merge=0.9987 (last merge round=39)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9529454174774598, 'auprc': 0.9897981259945322, 'loss_val': 0.14487349233899932, 'psi': 0.9676865008842888}-{'f1_val': 0.9928076081826916, 'auprc': 0.9955334308950055, 'loss_val': 0.04004019985908101, 'psi': 0.9938979372676171}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.247718 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=46 local utility u=1.000000 metrics={'f1_val': 0.90787166754009, 'auprc': 0.9569380856039185, 'loss_val': 0.4858018507530246, 'psi': 0.9274982347656213}-{'f1_val': 0.6834217374675742, 'auprc': 0.935806768626015, 'loss_val': 1.0962908790104637, 'psi': 0.7843757499309505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=47 head_norm_before_train=1.938703 cos_to_last_merge=0.9996 (last merge round=38)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8321680465466049, 'auprc': 0.8752231766438785, 'loss_val': 0.3998931531571931, 'psi': 0.8493900985855143}-{'f1_val': 0.8284541135265933, 'auprc': 0.9898546189231289, 'loss_val': 0.4086395683941986, 'psi': 0.8930143156852075}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.145735 cos_to_last_merge=0.9957 (last merge round=34)
[S3] round=47 local utility u=0.509713 metrics={'f1_val': 0.9696400934110759, 'auprc': 0.9981836816711903, 'loss_val': 0.061598400579377405, 'psi': 0.9810575287151216}-{'f1_val': 0.8631462501482947, 'auprc': 0.968887575962406, 'loss_val': 0.3541726628324508, 'psi': 0.9054427804739392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=47 head_norm_before_train=1.782289 cos_to_last_merge=0.9883 (last merge round=34)
[S4] round=47 local utility u=0.071031 metrics={'f1_val': 0.9499425019211778, 'auprc': 0.9710966831652703, 'loss_val': 0.2863457699312005, 'psi': 0.9584041744188148}-{'f1_val': 0.9421229820772998, 'auprc': 0.9450040997807694, 'loss_val': 0.30321381189591734, 'psi': 0.9432754291586876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=47 head_norm_before_train=1.930756 cos_to_last_merge=0.9982 (last merge round=35)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.5808320063974427, 'auprc': 0.8591774823436813, 'loss_val': 0.5669801353222748, 'psi': 0.6921701967759382}-{'f1_val': 0.700320598491359, 'auprc': 0.9329740143325379, 'loss_val': 0.3262548637360043, 'psi': 0.7933819648278306}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=2.083482 (no previous merge yet)
[S6] round=47 local utility u=0.361293 metrics={'f1_val': 0.6516989988991447, 'auprc': 0.8843437354747953, 'loss_val': 0.8767367751064978, 'psi': 0.7447568935294049}-{'f1_val': 0.6096812678459963, 'auprc': 0.8446470285410368, 'loss_val': 1.2281255053994924, 'psi': 0.7036675721240124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=47 head_norm_before_train=1.655198 cos_to_last_merge=0.9988 (last merge round=40)
[S7] round=47 local utility u=0.454885 metrics={'f1_val': 0.6203788891970119, 'auprc': 0.8003015762934375, 'loss_val': 0.5947075570514797, 'psi': 0.6923479640355821}-{'f1_val': 0.5251876301110823, 'auprc': 0.7821494146017507, 'loss_val': 0.8788735868025009, 'psi': 0.6279723439073497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=47 head_norm_before_train=1.726594 cos_to_last_merge=0.9908 (last merge round=33)
[S8] round=47 local utility u=0.018661 metrics={'f1_val': 0.9923740886046254, 'auprc': 0.9981375062234139, 'loss_val': 0.03632475584943664, 'psi': 0.9946794556521408}-{'f1_val': 0.9928227983692537, 'auprc': 0.9875701121906979, 'loss_val': 0.044635955543838625, 'psi': 0.9907217238978314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=47 head_norm_before_train=2.074449 (no previous merge yet)
[S9] round=47 local utility u=0.012492 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9939233482331994, 'loss_val': 0.018721367368390772, 'psi': 0.995584834052137}-{'f1_val': 0.991254331540241, 'auprc': 0.9994465018282204, 'loss_val': 0.02764534427439301, 'psi': 0.9945311996554327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=47 head_norm_before_train=2.294489 cos_to_last_merge=0.9948 (last merge round=33)
[S10] round=47 local utility u=0.000095 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9937062390980196, 'loss_val': 0.03129552231211748, 'psi': 0.9935421205317514}-{'f1_val': 0.9934327081542391, 'auprc': 0.993953437176666, 'loss_val': 0.03222696924063555, 'psi': 0.9936409997632099}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=47 head_norm_before_train=2.264989 cos_to_last_merge=0.9999 (last merge round=41)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9904081840952621, 'auprc': 0.9984212210287389, 'loss_val': 0.04266238162177109, 'psi': 0.9936133988686529}-{'f1_val': 0.9961541414107454, 'auprc': 0.9981364480184686, 'loss_val': 0.022448044069225754, 'psi': 0.9969470640538347}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.943156 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.7443831504760499, 'auprc': 0.7024406091895185, 'loss_val': 0.9615207845530735, 'psi': 0.7276061339614373}-{'f1_val': 0.7498563941454544, 'auprc': 0.739512968066719, 'loss_val': 0.8435626642760654, 'psi': 0.7457190237139601}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.249845 cos_to_last_merge=0.9979 (last merge round=32)
[S14] round=47 local utility u=0.003391 metrics={'f1_val': 0.9968032263876003, 'auprc': 0.997485563057971, 'loss_val': 0.02500100683170464, 'psi': 0.9970761610557486}-{'f1_val': 0.9966235765367457, 'auprc': 0.9965866497029179, 'loss_val': 0.028007673120264684, 'psi': 0.9966088058032146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=47 head_norm_before_train=1.990871 cos_to_last_merge=0.9861 (last merge round=39)
[S15] round=47 local utility u=0.008013 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9959554147138349, 'loss_val': 0.022437269704941733, 'psi': 0.9959234770937248}-{'f1_val': 0.9931832020571294, 'auprc': 0.9985129125867511, 'loss_val': 0.029820916066813627, 'psi': 0.9953150862689781}
[S15] not sending this round → trigger blocked (psi=0.996)
[S16] START round=47 head_norm_before_train=1.812464 cos_to_last_merge=0.9985 (last merge round=39)
[S16] round=47 local utility u=0.179034 metrics={'f1_val': 0.9921553304731932, 'auprc': 0.9958382658973431, 'loss_val': 0.04018502176019388, 'psi': 0.9936285046428532}-{'f1_val': 0.9529454174774598, 'auprc': 0.9897981259945322, 'loss_val': 0.14487349233899932, 'psi': 0.9676865008842888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=47 head_norm_before_train=2.257072 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.8668095711959595, 'auprc': 0.9651649750005912, 'loss_val': 0.5556703218593966, 'psi': 0.9061517327178121}-{'f1_val': 0.90787166754009, 'auprc': 0.9569380856039185, 'loss_val': 0.4858018507530246, 'psi': 0.9274982347656213}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.948774 cos_to_last_merge=0.9995 (last merge round=38)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7583159228126125, 'auprc': 0.8534448745885025, 'loss_val': 0.7009383246346953, 'psi': 0.7963675035229685}-{'f1_val': 0.8321680465466049, 'auprc': 0.8752231766438785, 'loss_val': 0.3998931531571931, 'psi': 0.8493900985855143}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.152996 cos_to_last_merge=0.9953 (last merge round=34)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9407136771832918, 'auprc': 0.979999331034104, 'loss_val': 0.15267663730110356, 'psi': 0.9564279387236166}-{'f1_val': 0.9696400934110759, 'auprc': 0.9981836816711903, 'loss_val': 0.061598400579377405, 'psi': 0.9810575287151216}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.786686 cos_to_last_merge=0.9878 (last merge round=34)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9413446061588475, 'auprc': 0.9641128205845519, 'loss_val': 0.30325613507639865, 'psi': 0.9504518919291293}-{'f1_val': 0.9499425019211778, 'auprc': 0.9710966831652703, 'loss_val': 0.2863457699312005, 'psi': 0.9584041744188148}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.936659 cos_to_last_merge=0.9979 (last merge round=35)
[S5] round=48 local utility u=0.460312 metrics={'f1_val': 0.653436763854155, 'auprc': 0.9403169557870054, 'loss_val': 0.3254030248628154, 'psi': 0.7681888406272952}-{'f1_val': 0.5808320063974427, 'auprc': 0.8591774823436813, 'loss_val': 0.5669801353222748, 'psi': 0.6921701967759382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=48 head_norm_before_train=2.091598 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.5988823749063701, 'auprc': 0.8890940443522721, 'loss_val': 1.1188903512605095, 'psi': 0.7149670426847309}-{'f1_val': 0.6516989988991447, 'auprc': 0.8843437354747953, 'loss_val': 0.8767367751064978, 'psi': 0.7447568935294049}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.660835 cos_to_last_merge=0.9986 (last merge round=40)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5764857237125819, 'auprc': 0.787246501906675, 'loss_val': 0.7650177020738248, 'psi': 0.6607900349902192}-{'f1_val': 0.6203788891970119, 'auprc': 0.8003015762934375, 'loss_val': 0.5947075570514797, 'psi': 0.6923479640355821}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.738242 cos_to_last_merge=0.9902 (last merge round=33)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.993663382622812, 'auprc': 0.9916823037711788, 'loss_val': 0.03733025423133361, 'psi': 0.9928709510821587}-{'f1_val': 0.9923740886046254, 'auprc': 0.9981375062234139, 'loss_val': 0.03632475584943664, 'psi': 0.9946794556521408}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.080511 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.999838458855738, 'loss_val': 0.023335775202201266, 'psi': 0.9964492073926348}-{'f1_val': 0.9966924912647621, 'auprc': 0.9939233482331994, 'loss_val': 0.018721367368390772, 'psi': 0.995584834052137}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.303590 cos_to_last_merge=0.9944 (last merge round=33)
[S10] round=48 local utility u=0.000396 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9941764004656396, 'loss_val': 0.03191446476939178, 'psi': 0.9937301850787994}-{'f1_val': 0.9934327081542391, 'auprc': 0.9937062390980196, 'loss_val': 0.03129552231211748, 'psi': 0.9935421205317514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] START round=48 head_norm_before_train=2.270494 cos_to_last_merge=0.9998 (last merge round=41)
[S11] round=48 local utility u=0.022044 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9983734909667705, 'loss_val': 0.03290624673990271, 'psi': 0.9970418812331554}-{'f1_val': 0.9904081840952621, 'auprc': 0.9984212210287389, 'loss_val': 0.04266238162177109, 'psi': 0.9936133988686529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=48 head_norm_before_train=1.950601 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.627539100711267, 'auprc': 0.6605936901631758, 'loss_val': 1.1645062575119873, 'psi': 0.6407609364920305}-{'f1_val': 0.7443831504760499, 'auprc': 0.7024406091895185, 'loss_val': 0.9615207845530735, 'psi': 0.7276061339614373}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.255434 cos_to_last_merge=0.9978 (last merge round=32)
[S14] round=48 local utility u=0.002943 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9987001476385889, 'loss_val': 0.02159996623702247, 'psi': 0.99744606702109}-{'f1_val': 0.9968032263876003, 'auprc': 0.997485563057971, 'loss_val': 0.02500100683170464, 'psi': 0.9970761610557486}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=48 head_norm_before_train=2.007827 cos_to_last_merge=0.9851 (last merge round=39)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.879296245452694, 'auprc': 0.9956779906622603, 'loss_val': 0.28970734169156337, 'psi': 0.9258489435365206}-{'f1_val': 0.9959021853469847, 'auprc': 0.9959554147138349, 'loss_val': 0.022437269704941733, 'psi': 0.9959234770937248}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.823781 cos_to_last_merge=0.9982 (last merge round=39)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9389525438466693, 'auprc': 0.9894838053616843, 'loss_val': 0.13135038585253386, 'psi': 0.9591650484526754}-{'f1_val': 0.9921553304731932, 'auprc': 0.9958382658973431, 'loss_val': 0.04018502176019388, 'psi': 0.9936285046428532}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.267201 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=48 local utility u=0.097877 metrics={'f1_val': 0.9032193334867025, 'auprc': 0.9350459032560748, 'loss_val': 0.48801798984293115, 'psi': 0.9159499613944514}-{'f1_val': 0.8668095711959595, 'auprc': 0.9651649750005912, 'loss_val': 0.5556703218593966, 'psi': 0.9061517327178121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=49 head_norm_before_train=1.952158 cos_to_last_merge=0.9994 (last merge round=38)
[S2] round=49 local utility u=0.067812 metrics={'f1_val': 0.7670172740231969, 'auprc': 0.8697970681665065, 'loss_val': 0.6665780411498282, 'psi': 0.8081291916805207}-{'f1_val': 0.7583159228126125, 'auprc': 0.8534448745885025, 'loss_val': 0.7009383246346953, 'psi': 0.7963675035229685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=49 head_norm_before_train=2.162778 cos_to_last_merge=0.9949 (last merge round=34)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.8576745955166334, 'auprc': 0.982750746041358, 'loss_val': 0.2828439953019047, 'psi': 0.9077050557265233}-{'f1_val': 0.9407136771832918, 'auprc': 0.979999331034104, 'loss_val': 0.15267663730110356, 'psi': 0.9564279387236166}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.794053 cos_to_last_merge=0.9870 (last merge round=34)
[S4] round=49 local utility u=0.033398 metrics={'f1_val': 0.9472892954725652, 'auprc': 0.9719891762258317, 'loss_val': 0.2957572507012835, 'psi': 0.9571692477738718}-{'f1_val': 0.9413446061588475, 'auprc': 0.9641128205845519, 'loss_val': 0.30325613507639865, 'psi': 0.9504518919291293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=49 head_norm_before_train=1.940904 cos_to_last_merge=0.9977 (last merge round=35)
[S5] round=49 local utility u=0.567967 metrics={'f1_val': 0.7911097677778538, 'auprc': 0.993661656194842, 'loss_val': 0.17554030035348517, 'psi': 0.872130523144649}-{'f1_val': 0.653436763854155, 'auprc': 0.9403169557870054, 'loss_val': 0.3254030248628154, 'psi': 0.7681888406272952}
[S5] not sending this round → trigger blocked (psi=0.872)
[S6] START round=49 head_norm_before_train=2.098155 (no previous merge yet)
[S6] round=49 local utility u=0.758959 metrics={'f1_val': 0.7417564475717904, 'auprc': 0.9489297207795262, 'loss_val': 0.6377240186878201, 'psi': 0.8246257568548847}-{'f1_val': 0.5988823749063701, 'auprc': 0.8890940443522721, 'loss_val': 1.1188903512605095, 'psi': 0.7149670426847309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=49 head_norm_before_train=1.665509 cos_to_last_merge=0.9985 (last merge round=40)
[S7] round=49 local utility u=0.448225 metrics={'f1_val': 0.6564033833115125, 'auprc': 0.8206205607046089, 'loss_val': 0.4481961768038888, 'psi': 0.7220902542687511}-{'f1_val': 0.5764857237125819, 'auprc': 0.787246501906675, 'loss_val': 0.7650177020738248, 'psi': 0.6607900349902192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=49 head_norm_before_train=1.745777 cos_to_last_merge=0.9898 (last merge round=33)
[S8] round=49 local utility u=0.005013 metrics={'f1_val': 0.9917244887003366, 'auprc': 0.9990054799923187, 'loss_val': 0.03763960410243105, 'psi': 0.9946368852171295}-{'f1_val': 0.993663382622812, 'auprc': 0.9916823037711788, 'loss_val': 0.03733025423133361, 'psi': 0.9928709510821587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=49 head_norm_before_train=2.086015 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9997969603612743, 'loss_val': 0.023718145058682128, 'psi': 0.9964326079948493}-{'f1_val': 0.9941897064172326, 'auprc': 0.999838458855738, 'loss_val': 0.023335775202201266, 'psi': 0.9964492073926348}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.310044 cos_to_last_merge=0.9941 (last merge round=33)
[S10] round=49 local utility u=0.000785 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9947285951171407, 'loss_val': 0.03200081087586567, 'psi': 0.9939510629393998}-{'f1_val': 0.9934327081542391, 'auprc': 0.9941764004656396, 'loss_val': 0.03191446476939178, 'psi': 0.9937301850787994}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=49 head_norm_before_train=2.276110 cos_to_last_merge=0.9998 (last merge round=41)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9944705754924553, 'auprc': 0.9970314325771583, 'loss_val': 0.030275064807692917, 'psi': 0.9954949183263365}-{'f1_val': 0.9961541414107454, 'auprc': 0.9983734909667705, 'loss_val': 0.03290624673990271, 'psi': 0.9970418812331554}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.959616 (no previous merge yet)
[S13] round=49 local utility u=0.604077 metrics={'f1_val': 0.7624627386462174, 'auprc': 0.714607382458532, 'loss_val': 0.9279345756899829, 'psi': 0.7433205961711432}-{'f1_val': 0.627539100711267, 'auprc': 0.6605936901631758, 'loss_val': 1.1645062575119873, 'psi': 0.6407609364920305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=49 head_norm_before_train=2.260766 cos_to_last_merge=0.9976 (last merge round=32)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9965920222062667, 'loss_val': 0.02488686025821382, 'psi': 0.997214274719443}-{'f1_val': 0.9966100132760906, 'auprc': 0.9987001476385889, 'loss_val': 0.02159996623702247, 'psi': 0.99744606702109}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.024780 cos_to_last_merge=0.9842 (last merge round=39)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7625180868998767, 'auprc': 0.8981086717671568, 'loss_val': 0.6182390112849846, 'psi': 0.8167543208467887}-{'f1_val': 0.879296245452694, 'auprc': 0.9956779906622603, 'loss_val': 0.28970734169156337, 'psi': 0.9258489435365206}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.834524 cos_to_last_merge=0.9980 (last merge round=39)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8787420961181198, 'auprc': 0.9873649102094731, 'loss_val': 0.30272653966719265, 'psi': 0.9221912217546611}-{'f1_val': 0.9389525438466693, 'auprc': 0.9894838053616843, 'loss_val': 0.13135038585253386, 'psi': 0.9591650484526754}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.272281 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.830675221786606, 'auprc': 0.9561334931778459, 'loss_val': 0.6165067640823246, 'psi': 0.880858530343102}-{'f1_val': 0.9032193334867025, 'auprc': 0.9350459032560748, 'loss_val': 0.48801798984293115, 'psi': 0.9159499613944514}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=1.960857 cos_to_last_merge=0.9993 (last merge round=38)
[S2] round=50 local utility u=0.474474 metrics={'f1_val': 0.8291432160426297, 'auprc': 0.977029067720308, 'loss_val': 0.4120818995093439, 'psi': 0.888297556713701}-{'f1_val': 0.7670172740231969, 'auprc': 0.8697970681665065, 'loss_val': 0.6665780411498282, 'psi': 0.8081291916805207}
[S2] not sending this round → trigger blocked (psi=0.888)
[S3] START round=50 head_norm_before_train=2.173103 cos_to_last_merge=0.9944 (last merge round=34)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.8161245460814046, 'auprc': 0.9691818884764645, 'loss_val': 0.4500760375427267, 'psi': 0.8773474830394286}-{'f1_val': 0.8576745955166334, 'auprc': 0.982750746041358, 'loss_val': 0.2828439953019047, 'psi': 0.9077050557265233}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.805871 cos_to_last_merge=0.9861 (last merge round=34)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.949197141504079, 'auprc': 0.9567060660445965, 'loss_val': 0.29991730618846363, 'psi': 0.9522007113202859}-{'f1_val': 0.9472892954725652, 'auprc': 0.9719891762258317, 'loss_val': 0.2957572507012835, 'psi': 0.9571692477738718}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.946802 cos_to_last_merge=0.9974 (last merge round=35)
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.6059501408398635, 'auprc': 0.7446805633887424, 'loss_val': 0.6723737385118937, 'psi': 0.6614423098594151}-{'f1_val': 0.7911097677778538, 'auprc': 0.993661656194842, 'loss_val': 0.17554030035348517, 'psi': 0.872130523144649}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=50 head_norm_before_train=2.102021 (no previous merge yet)
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.6437071561116933, 'auprc': 0.9407360408020496, 'loss_val': 0.7328650381667681, 'psi': 0.7625187099878359}-{'f1_val': 0.7417564475717904, 'auprc': 0.9489297207795262, 'loss_val': 0.6377240186878201, 'psi': 0.8246257568548847}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=50 head_norm_before_train=1.669202 cos_to_last_merge=0.9983 (last merge round=40)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.5692486050743353, 'auprc': 0.7833239611770276, 'loss_val': 0.7872607155781515, 'psi': 0.6548787475154122}-{'f1_val': 0.6564033833115125, 'auprc': 0.8206205607046089, 'loss_val': 0.4481961768038888, 'psi': 0.7220902542687511}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=1.753073 cos_to_last_merge=0.9895 (last merge round=33)
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.991479862271931, 'auprc': 0.9989551976238048, 'loss_val': 0.0378895299821802, 'psi': 0.9944699964126805}-{'f1_val': 0.9917244887003366, 'auprc': 0.9990054799923187, 'loss_val': 0.03763960410243105, 'psi': 0.9946368852171295}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=50 head_norm_before_train=2.092658 (no previous merge yet)
[S9] round=50 local utility u=0.003043 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9948938199777895, 'loss_val': 0.017747329759681192, 'psi': 0.9959538350794507}-{'f1_val': 0.9941897064172326, 'auprc': 0.9997969603612743, 'loss_val': 0.023718145058682128, 'psi': 0.9964326079948493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=50 head_norm_before_train=2.315279 cos_to_last_merge=0.9939 (last merge round=33)
[S10] round=50 local utility u=0.000133 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946489409134126, 'loss_val': 0.031495464515603665, 'psi': 0.9939192012579086}-{'f1_val': 0.9934327081542391, 'auprc': 0.9947285951171407, 'loss_val': 0.03200081087586567, 'psi': 0.9939510629393998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=50 head_norm_before_train=2.280502 cos_to_last_merge=0.9997 (last merge round=41)
[S11] round=50 local utility u=0.010647 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986441210322541, 'loss_val': 0.023920761941495734, 'psi': 0.9971501332593489}-{'f1_val': 0.9944705754924553, 'auprc': 0.9970314325771583, 'loss_val': 0.030275064807692917, 'psi': 0.9954949183263365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=50 head_norm_before_train=1.965459 (no previous merge yet)
[S13] round=50 local utility u=0.405715 metrics={'f1_val': 0.7813776316820774, 'auprc': 0.8310197729808926, 'loss_val': 0.5792301639441857, 'psi': 0.8012344882016035}-{'f1_val': 0.7624627386462174, 'auprc': 0.714607382458532, 'loss_val': 0.9279345756899829, 'psi': 0.7433205961711432}
[S13] not sending this round → trigger blocked (psi=0.801)
[S14] START round=50 head_norm_before_train=2.267263 cos_to_last_merge=0.9974 (last merge round=32)
[S14] round=50 local utility u=0.001972 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9969704544404493, 'loss_val': 0.01961451804984378, 'psi': 0.9971191906746331}-{'f1_val': 0.9976291097282272, 'auprc': 0.9965920222062667, 'loss_val': 0.02488686025821382, 'psi': 0.997214274719443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=50 head_norm_before_train=2.043781 cos_to_last_merge=0.9831 (last merge round=39)
[S15] round=50 local utility u=0.051533 metrics={'f1_val': 0.7692331596455979, 'auprc': 0.912901176119468, 'loss_val': 0.5998417128589086, 'psi': 0.826700366235146}-{'f1_val': 0.7625180868998767, 'auprc': 0.8981086717671568, 'loss_val': 0.6182390112849846, 'psi': 0.8167543208467887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=50 head_norm_before_train=1.842799 cos_to_last_merge=0.9977 (last merge round=39)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.8779836052107306, 'auprc': 0.9722066124447719, 'loss_val': 0.6468253044224095, 'psi': 0.9156728081043471}-{'f1_val': 0.8787420961181198, 'auprc': 0.9873649102094731, 'loss_val': 0.30272653966719265, 'psi': 0.9221912217546611}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=2.276459 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=50 local utility u=0.187155 metrics={'f1_val': 0.8932334869429759, 'auprc': 0.9372235855469409, 'loss_val': 0.5608167225397827, 'psi': 0.9108295263845618}-{'f1_val': 0.830675221786606, 'auprc': 0.9561334931778459, 'loss_val': 0.6165067640823246, 'psi': 0.880858530343102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=51 head_norm_before_train=1.969448 cos_to_last_merge=0.9992 (last merge round=38)
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.8376600264697648, 'auprc': 0.864785467360241, 'loss_val': 0.5552509043680275, 'psi': 0.8485102028259552}-{'f1_val': 0.8291432160426297, 'auprc': 0.977029067720308, 'loss_val': 0.4120818995093439, 'psi': 0.888297556713701}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=2.181515 cos_to_last_merge=0.9940 (last merge round=34)
[S3] round=51 local utility u=0.150834 metrics={'f1_val': 0.836923713017582, 'auprc': 0.992264708384417, 'loss_val': 0.3424521576630573, 'psi': 0.8990601111643161}-{'f1_val': 0.8161245460814046, 'auprc': 0.9691818884764645, 'loss_val': 0.4500760375427267, 'psi': 0.8773474830394286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=51 head_norm_before_train=1.819433 cos_to_last_merge=0.9853 (last merge round=34)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.940114840833518, 'auprc': 0.9403220762826137, 'loss_val': 0.31834507268276396, 'psi': 0.9401977350131563}-{'f1_val': 0.949197141504079, 'auprc': 0.9567060660445965, 'loss_val': 0.29991730618846363, 'psi': 0.9522007113202859}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.952511 cos_to_last_merge=0.9970 (last merge round=35)
[S5] round=51 local utility u=0.826276 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9881980561315071, 'loss_val': 0.31763561451807104, 'psi': 0.8155755421182767}-{'f1_val': 0.6059501408398635, 'auprc': 0.7446805633887424, 'loss_val': 0.6723737385118937, 'psi': 0.6614423098594151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=51 head_norm_before_train=2.109300 (no previous merge yet)
[S6] round=51 local utility u=0.754111 metrics={'f1_val': 0.8202313152825679, 'auprc': 0.9795390018446801, 'loss_val': 0.40019622633981716, 'psi': 0.8839543899074127}-{'f1_val': 0.6437071561116933, 'auprc': 0.9407360408020496, 'loss_val': 0.7328650381667681, 'psi': 0.7625187099878359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=51 head_norm_before_train=1.672718 cos_to_last_merge=0.9982 (last merge round=40)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.5360976380581298, 'auprc': 0.7817953049656824, 'loss_val': 0.8077588442216271, 'psi': 0.6343767048211508}-{'f1_val': 0.5692486050743353, 'auprc': 0.7833239611770276, 'loss_val': 0.7872607155781515, 'psi': 0.6548787475154122}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.763072 cos_to_last_merge=0.9891 (last merge round=33)
[S8] round=51 local utility u=0.009650 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9987747223364923, 'loss_val': 0.03230078021821386, 'psi': 0.9958231583029836}-{'f1_val': 0.991479862271931, 'auprc': 0.9989551976238048, 'loss_val': 0.0378895299821802, 'psi': 0.9944699964126805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=51 head_norm_before_train=2.099253 (no previous merge yet)
[S9] round=51 local utility u=0.004231 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9997242072424044, 'loss_val': 0.01877432211220344, 'psi': 0.997385713915473}-{'f1_val': 0.9966605118138915, 'auprc': 0.9948938199777895, 'loss_val': 0.017747329759681192, 'psi': 0.9959538350794507}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=51 head_norm_before_train=2.322166 cos_to_last_merge=0.9936 (last merge round=33)
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9945405967300339, 'loss_val': 0.03147380056406292, 'psi': 0.993875863584557}-{'f1_val': 0.9934327081542391, 'auprc': 0.9946489409134126, 'loss_val': 0.031495464515603665, 'psi': 0.9939192012579086}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=2.286467 cos_to_last_merge=0.9996 (last merge round=41)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9970347939517014, 'loss_val': 0.051791522122060195, 'psi': 0.9965064024271277}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986441210322541, 'loss_val': 0.023920761941495734, 'psi': 0.9971501332593489}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=51 head_norm_before_train=1.972127 (no previous merge yet)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.6438342431956579, 'auprc': 0.6534304156912861, 'loss_val': 1.1768692814790194, 'psi': 0.6476727121939092}-{'f1_val': 0.7813776316820774, 'auprc': 0.8310197729808926, 'loss_val': 0.5792301639441857, 'psi': 0.8012344882016035}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=2.273907 cos_to_last_merge=0.9972 (last merge round=32)
[S14] round=51 local utility u=0.000475 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9969722127267773, 'loss_val': 0.018670230363098367, 'psi': 0.9971198939891641}-{'f1_val': 0.9972183481640888, 'auprc': 0.9969704544404493, 'loss_val': 0.01961451804984378, 'psi': 0.9971191906746331}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=51 head_norm_before_train=2.062397 cos_to_last_merge=0.9821 (last merge round=39)
[S15] round=51 local utility u=1.000000 metrics={'f1_val': 0.9863767701840763, 'auprc': 0.9985191840917956, 'loss_val': 0.07513813264303991, 'psi': 0.991233735747164}-{'f1_val': 0.7692331596455979, 'auprc': 0.912901176119468, 'loss_val': 0.5998417128589086, 'psi': 0.826700366235146}
[S15] not sending this round → trigger blocked (psi=0.991)
[S16] START round=51 head_norm_before_train=1.849816 cos_to_last_merge=0.9975 (last merge round=39)
[S16] round=51 local utility u=0.679182 metrics={'f1_val': 0.9923722266073849, 'auprc': 0.9933309029378912, 'loss_val': 0.03816653927402341, 'psi': 0.9927556971395873}-{'f1_val': 0.8779836052107306, 'auprc': 0.9722066124447719, 'loss_val': 0.6468253044224095, 'psi': 0.9156728081043471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=51 head_norm_before_train=2.285044 cos_to_last_merge=0.9998 (last merge round=41)
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.8328956301292763, 'auprc': 0.9447470142063621, 'loss_val': 0.6765427961490986, 'psi': 0.8776361837601105}-{'f1_val': 0.8932334869429759, 'auprc': 0.9372235855469409, 'loss_val': 0.5608167225397827, 'psi': 0.9108295263845618}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=52 head_norm_before_train=1.978287 cos_to_last_merge=0.9991 (last merge round=38)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.6697330522357523, 'auprc': 0.7322165573251421, 'loss_val': 1.4409103740289533, 'psi': 0.6947264542715081}-{'f1_val': 0.8376600264697648, 'auprc': 0.864785467360241, 'loss_val': 0.5552509043680275, 'psi': 0.8485102028259552}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=2.192229 cos_to_last_merge=0.9934 (last merge round=34)
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.7206622935406102, 'auprc': 0.9753286664625416, 'loss_val': 0.6386342460518064, 'psi': 0.8225288427093826}-{'f1_val': 0.836923713017582, 'auprc': 0.992264708384417, 'loss_val': 0.3424521576630573, 'psi': 0.8990601111643161}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=1.823204 cos_to_last_merge=0.9846 (last merge round=34)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.939823683958062, 'auprc': 0.9342759817414135, 'loss_val': 0.3461024773602386, 'psi': 0.9376046030714027}-{'f1_val': 0.940114840833518, 'auprc': 0.9403220762826137, 'loss_val': 0.31834507268276396, 'psi': 0.9401977350131563}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.957315 cos_to_last_merge=0.9968 (last merge round=35)
[S5] round=52 local utility u=0.141056 metrics={'f1_val': 0.727904170902132, 'auprc': 0.9903434487363585, 'loss_val': 0.2064206531868918, 'psi': 0.8328798820358225}-{'f1_val': 0.7004938661094564, 'auprc': 0.9881980561315071, 'loss_val': 0.31763561451807104, 'psi': 0.8155755421182767}
[S5] not sending this round → trigger blocked (psi=0.833)
[S6] START round=52 head_norm_before_train=2.124284 (no previous merge yet)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.66169692333146, 'auprc': 0.9031301704723977, 'loss_val': 0.9651104071837973, 'psi': 0.7582702221878351}-{'f1_val': 0.8202313152825679, 'auprc': 0.9795390018446801, 'loss_val': 0.40019622633981716, 'psi': 0.8839543899074127}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.678729 cos_to_last_merge=0.9978 (last merge round=40)
[S7] round=52 local utility u=0.761094 metrics={'f1_val': 0.6766609480705188, 'auprc': 0.8452463236330389, 'loss_val': 0.3193030070496777, 'psi': 0.7440950982955268}-{'f1_val': 0.5360976380581298, 'auprc': 0.7817953049656824, 'loss_val': 0.8077588442216271, 'psi': 0.6343767048211508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=52 head_norm_before_train=1.769686 cos_to_last_merge=0.9886 (last merge round=33)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9937185965290795, 'auprc': 0.9980486589911155, 'loss_val': 0.03147309594390947, 'psi': 0.9954506215138939}-{'f1_val': 0.9938554489473111, 'auprc': 0.9987747223364923, 'loss_val': 0.03230078021821386, 'psi': 0.9958231583029836}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=2.105479 (no previous merge yet)
[S9] round=52 local utility u=0.002801 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996591450669614, 'loss_val': 0.01797957163265657, 'psi': 0.9978599651151194}-{'f1_val': 0.9958267183641853, 'auprc': 0.9997242072424044, 'loss_val': 0.01877432211220344, 'psi': 0.997385713915473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=52 head_norm_before_train=2.330013 cos_to_last_merge=0.9932 (last merge round=33)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9947984997613584, 'loss_val': 0.03234414331272694, 'psi': 0.9939790247970869}-{'f1_val': 0.9934327081542391, 'auprc': 0.9945405967300339, 'loss_val': 0.03147380056406292, 'psi': 0.993875863584557}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=52 head_norm_before_train=2.291220 cos_to_last_merge=0.9996 (last merge round=41)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9970394581186898, 'loss_val': 0.05859342318046236, 'psi': 0.9966532955659424}-{'f1_val': 0.9961541414107454, 'auprc': 0.9970347939517014, 'loss_val': 0.051791522122060195, 'psi': 0.9965064024271277}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=1.980768 (no previous merge yet)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6229195165170776, 'auprc': 0.6470714298131177, 'loss_val': 1.2988166994227734, 'psi': 0.6325802818354936}-{'f1_val': 0.6438342431956579, 'auprc': 0.6534304156912861, 'loss_val': 1.1768692814790194, 'psi': 0.6476727121939092}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=2.281123 cos_to_last_merge=0.9970 (last merge round=32)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9894887476470688, 'auprc': 0.9975698009809901, 'loss_val': 0.051005085038349246, 'psi': 0.9927211689806373}-{'f1_val': 0.9972183481640888, 'auprc': 0.9969722127267773, 'loss_val': 0.018670230363098367, 'psi': 0.9971198939891641}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=2.079039 cos_to_last_merge=0.9812 (last merge round=39)
[S15] round=52 local utility u=0.000000 metrics={'f1_val': 0.9110423648777821, 'auprc': 0.9960698642404026, 'loss_val': 0.18913663318036592, 'psi': 0.9450533646228303}-{'f1_val': 0.9863767701840763, 'auprc': 0.9985191840917956, 'loss_val': 0.07513813264303991, 'psi': 0.991233735747164}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=52 head_norm_before_train=1.857274 cos_to_last_merge=0.9973 (last merge round=39)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.8376333388026371, 'auprc': 0.9834262991612418, 'loss_val': 0.5370028321932427, 'psi': 0.895950522946079}-{'f1_val': 0.9923722266073849, 'auprc': 0.9933309029378912, 'loss_val': 0.03816653927402341, 'psi': 0.9927556971395873}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=2.295436 cos_to_last_merge=0.9997 (last merge round=41)
[S17] round=52 local utility u=0.116762 metrics={'f1_val': 0.8493708190402134, 'auprc': 0.9682574422616618, 'loss_val': 0.6124007853573997, 'psi': 0.8969254683287927}-{'f1_val': 0.8328956301292763, 'auprc': 0.9447470142063621, 'loss_val': 0.6765427961490986, 'psi': 0.8776361837601105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=53 head_norm_before_train=1.979279 cos_to_last_merge=0.9990 (last merge round=38)
[S2] round=53 local utility u=1.000000 metrics={'f1_val': 0.7889163351680225, 'auprc': 0.8821386152781627, 'loss_val': 0.5720088057717265, 'psi': 0.8262052472120787}-{'f1_val': 0.6697330522357523, 'auprc': 0.7322165573251421, 'loss_val': 1.4409103740289533, 'psi': 0.6947264542715081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=53 head_norm_before_train=2.202828 cos_to_last_merge=0.9928 (last merge round=34)
[S3] round=53 local utility u=0.807098 metrics={'f1_val': 0.9186230112108115, 'auprc': 0.9757720059070717, 'loss_val': 0.21353305565494576, 'psi': 0.9414826090893156}-{'f1_val': 0.7206622935406102, 'auprc': 0.9753286664625416, 'loss_val': 0.6386342460518064, 'psi': 0.8225288427093826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=53 head_norm_before_train=1.827306 cos_to_last_merge=0.9836 (last merge round=34)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9377623754142514, 'auprc': 0.9349487728460889, 'loss_val': 0.3706142043530891, 'psi': 0.9366369343869865}-{'f1_val': 0.939823683958062, 'auprc': 0.9342759817414135, 'loss_val': 0.3461024773602386, 'psi': 0.9376046030714027}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.961613 cos_to_last_merge=0.9966 (last merge round=35)
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.6143834934670317, 'auprc': 0.8665700525977376, 'loss_val': 0.4891532183715312, 'psi': 0.7152581171193141}-{'f1_val': 0.727904170902132, 'auprc': 0.9903434487363585, 'loss_val': 0.2064206531868918, 'psi': 0.8328798820358225}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=2.139483 (no previous merge yet)
[S6] round=53 local utility u=0.021537 metrics={'f1_val': 0.6732856770573618, 'auprc': 0.8866899783031704, 'loss_val': 0.9422477291376783, 'psi': 0.7586473975556852}-{'f1_val': 0.66169692333146, 'auprc': 0.9031301704723977, 'loss_val': 0.9651104071837973, 'psi': 0.7582702221878351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=53 head_norm_before_train=1.686110 cos_to_last_merge=0.9975 (last merge round=40)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.48336619962272076, 'auprc': 0.7785931797403505, 'loss_val': 0.9885216241158005, 'psi': 0.6014569916697727}-{'f1_val': 0.6766609480705188, 'auprc': 0.8452463236330389, 'loss_val': 0.3193030070496777, 'psi': 0.7440950982955268}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=1.775259 cos_to_last_merge=0.9881 (last merge round=33)
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9917244887003366, 'auprc': 0.9991260514287319, 'loss_val': 0.03750208387401836, 'psi': 0.9946851137916948}-{'f1_val': 0.9937185965290795, 'auprc': 0.9980486589911155, 'loss_val': 0.03147309594390947, 'psi': 0.9954506215138939}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=2.108958 (no previous merge yet)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980432866835751, 'loss_val': 0.018979979319488745, 'psi': 0.9972136217617649}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996591450669614, 'loss_val': 0.01797957163265657, 'psi': 0.9978599651151194}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=2.338078 cos_to_last_merge=0.9928 (last merge round=33)
[S10] round=53 local utility u=0.000070 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946759134213358, 'loss_val': 0.031836019988671214, 'psi': 0.9939299902610779}-{'f1_val': 0.9934327081542391, 'auprc': 0.9947984997613584, 'loss_val': 0.03234414331272694, 'psi': 0.9939790247970869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=53 head_norm_before_train=2.297697 cos_to_last_merge=0.9995 (last merge round=41)
[S11] round=53 local utility u=0.019982 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986437996488406, 'loss_val': 0.021992974541537143, 'psi': 0.9971500047059835}-{'f1_val': 0.9963958538641108, 'auprc': 0.9970394581186898, 'loss_val': 0.05859342318046236, 'psi': 0.9966532955659424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=53 head_norm_before_train=1.984932 (no previous merge yet)
[S13] round=53 local utility u=1.000000 metrics={'f1_val': 0.7763802467315226, 'auprc': 0.8167606604225432, 'loss_val': 0.596337209359229, 'psi': 0.7925324122079309}-{'f1_val': 0.6229195165170776, 'auprc': 0.6470714298131177, 'loss_val': 1.2988166994227734, 'psi': 0.6325802818354936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=53 head_norm_before_train=2.287844 cos_to_last_merge=0.9968 (last merge round=32)
[S14] round=53 local utility u=0.040318 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969135455159396, 'loss_val': 0.017373688095034104, 'psi': 0.997356089036288}-{'f1_val': 0.9894887476470688, 'auprc': 0.9975698009809901, 'loss_val': 0.051005085038349246, 'psi': 0.9927211689806373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=53 head_norm_before_train=2.094022 cos_to_last_merge=0.9804 (last merge round=39)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.8318469151229039, 'auprc': 0.9926783290809762, 'loss_val': 0.38921825852890096, 'psi': 0.8961794807061327}-{'f1_val': 0.9110423648777821, 'auprc': 0.9960698642404026, 'loss_val': 0.18913663318036592, 'psi': 0.9450533646228303}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.864030 cos_to_last_merge=0.9971 (last merge round=39)
[S16] round=53 local utility u=0.365756 metrics={'f1_val': 0.9308432219802948, 'auprc': 0.9881431914030915, 'loss_val': 0.3789001911981457, 'psi': 0.9537632097494135}-{'f1_val': 0.8376333388026371, 'auprc': 0.9834262991612418, 'loss_val': 0.5370028321932427, 'psi': 0.895950522946079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=53 head_norm_before_train=2.305419 cos_to_last_merge=0.9996 (last merge round=41)
[S17] round=53 local utility u=0.195747 metrics={'f1_val': 0.9066595218889152, 'auprc': 0.9532972750305656, 'loss_val': 0.5197581038246624, 'psi': 0.9253146231455753}-{'f1_val': 0.8493708190402134, 'auprc': 0.9682574422616618, 'loss_val': 0.6124007853573997, 'psi': 0.8969254683287927}
[S17] not sending this round → trigger blocked (psi=0.925)
[S2] START round=54 head_norm_before_train=1.983658 cos_to_last_merge=0.9988 (last merge round=38)
[S2] round=54 local utility u=0.140412 metrics={'f1_val': 0.837703424359397, 'auprc': 0.862950112425898, 'loss_val': 0.5263425500644863, 'psi': 0.8478020995859975}-{'f1_val': 0.7889163351680225, 'auprc': 0.8821386152781627, 'loss_val': 0.5720088057717265, 'psi': 0.8262052472120787}
[S2] not sending this round → trigger blocked (psi=0.848)
[S3] START round=54 head_norm_before_train=2.213015 cos_to_last_merge=0.9923 (last merge round=34)
[S3] round=54 local utility u=0.350652 metrics={'f1_val': 0.9919643682469865, 'auprc': 0.9998736054534124, 'loss_val': 0.024581563313832613, 'psi': 0.9951280631295568}-{'f1_val': 0.9186230112108115, 'auprc': 0.9757720059070717, 'loss_val': 0.21353305565494576, 'psi': 0.9414826090893156}
[S3] not sending this round → trigger blocked (psi=0.995)
[S4] START round=54 head_norm_before_train=1.839348 cos_to_last_merge=0.9826 (last merge round=34)
[S4] round=54 local utility u=0.089554 metrics={'f1_val': 0.9421703179831624, 'auprc': 0.9639496968968947, 'loss_val': 0.3049563330422202, 'psi': 0.9508820695486553}-{'f1_val': 0.9377623754142514, 'auprc': 0.9349487728460889, 'loss_val': 0.3706142043530891, 'psi': 0.9366369343869865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=54 head_norm_before_train=1.964374 cos_to_last_merge=0.9964 (last merge round=35)
[S5] round=54 local utility u=0.126795 metrics={'f1_val': 0.6542060509439255, 'auprc': 0.8595026228576578, 'loss_val': 0.45329674194002645, 'psi': 0.7363246797094184}-{'f1_val': 0.6143834934670317, 'auprc': 0.8665700525977376, 'loss_val': 0.4891532183715312, 'psi': 0.7152581171193141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=54 head_norm_before_train=2.144864 (no previous merge yet)
[S6] round=54 local utility u=0.430809 metrics={'f1_val': 0.7680264826079515, 'auprc': 0.8890143694446355, 'loss_val': 0.6560471668040027, 'psi': 0.8164216373426252}-{'f1_val': 0.6732856770573618, 'auprc': 0.8866899783031704, 'loss_val': 0.9422477291376783, 'psi': 0.7586473975556852}
[S6] not sending this round → trigger blocked (psi=0.816)
[S7] START round=54 head_norm_before_train=1.693196 cos_to_last_merge=0.9971 (last merge round=40)
[S7] round=54 local utility u=0.922989 metrics={'f1_val': 0.6662721177373343, 'auprc': 0.8251283760259913, 'loss_val': 0.3795855009515833, 'psi': 0.7298146210527972}-{'f1_val': 0.48336619962272076, 'auprc': 0.7785931797403505, 'loss_val': 0.9885216241158005, 'psi': 0.6014569916697727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=54 head_norm_before_train=1.786039 cos_to_last_merge=0.9877 (last merge round=33)
[S8] round=54 local utility u=0.007633 metrics={'f1_val': 0.9936536506497753, 'auprc': 0.9990466351851911, 'loss_val': 0.03357310462582244, 'psi': 0.9958108444639416}-{'f1_val': 0.9917244887003366, 'auprc': 0.9991260514287319, 'loss_val': 0.03750208387401836, 'psi': 0.9946851137916948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=54 head_norm_before_train=2.113302 (no previous merge yet)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9991575435010285, 'loss_val': 0.02006018985028551, 'psi': 0.9971590484189227}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980432866835751, 'loss_val': 0.018979979319488745, 'psi': 0.9972136217617649}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=2.344707 cos_to_last_merge=0.9925 (last merge round=33)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.994564971697136, 'loss_val': 0.03162208263831868, 'psi': 0.9938856135713979}-{'f1_val': 0.9934327081542391, 'auprc': 0.9946759134213358, 'loss_val': 0.031836019988671214, 'psi': 0.9939299902610779}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=2.305867 cos_to_last_merge=0.9994 (last merge round=41)
[S11] round=54 local utility u=0.000277 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984282879252031, 'loss_val': 0.02079312590817623, 'psi': 0.9970638000165285}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986437996488406, 'loss_val': 0.021992974541537143, 'psi': 0.9971500047059835}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=54 head_norm_before_train=1.992719 (no previous merge yet)
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.7102760238798121, 'auprc': 0.6616136798264042, 'loss_val': 1.1666930083877713, 'psi': 0.690811086258449}-{'f1_val': 0.7763802467315226, 'auprc': 0.8167606604225432, 'loss_val': 0.596337209359229, 'psi': 0.7925324122079309}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=2.294059 cos_to_last_merge=0.9967 (last merge round=32)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9974284489365712, 'auprc': 0.9954441456901207, 'loss_val': 0.018087391279133162, 'psi': 0.9966347276379911}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969135455159396, 'loss_val': 0.017373688095034104, 'psi': 0.997356089036288}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=2.109463 cos_to_last_merge=0.9796 (last merge round=39)
[S15] round=54 local utility u=0.556553 metrics={'f1_val': 0.9627849853920603, 'auprc': 0.9967417869675103, 'loss_val': 0.07393078317737761, 'psi': 0.9763677060222402}-{'f1_val': 0.8318469151229039, 'auprc': 0.9926783290809762, 'loss_val': 0.38921825852890096, 'psi': 0.8961794807061327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=54 head_norm_before_train=1.871595 cos_to_last_merge=0.9969 (last merge round=39)
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.8475353836789253, 'auprc': 0.975287562117178, 'loss_val': 1.0056812828574344, 'psi': 0.8986362550542264}-{'f1_val': 0.9308432219802948, 'auprc': 0.9881431914030915, 'loss_val': 0.3789001911981457, 'psi': 0.9537632097494135}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=54 head_norm_before_train=2.314848 cos_to_last_merge=0.9995 (last merge round=41)
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.8575805332347672, 'auprc': 0.9804320570190094, 'loss_val': 0.6078819978559046, 'psi': 0.9067211427484642}-{'f1_val': 0.9066595218889152, 'auprc': 0.9532972750305656, 'loss_val': 0.5197581038246624, 'psi': 0.9253146231455753}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=55 head_norm_before_train=1.991452 cos_to_last_merge=0.9988 (last merge round=38)
[S2] round=55 local utility u=0.033865 metrics={'f1_val': 0.7724586018875328, 'auprc': 0.9844231484781789, 'loss_val': 0.4315632254188676, 'psi': 0.8572444205237912}-{'f1_val': 0.837703424359397, 'auprc': 0.862950112425898, 'loss_val': 0.5263425500644863, 'psi': 0.8478020995859975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=55 head_norm_before_train=2.221916 cos_to_last_merge=0.9918 (last merge round=34)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9999043605020846, 'loss_val': 0.08221984252060265, 'psi': 0.9765828948641}-{'f1_val': 0.9919643682469865, 'auprc': 0.9998736054534124, 'loss_val': 0.024581563313832613, 'psi': 0.9951280631295568}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.846463 cos_to_last_merge=0.9809 (last merge round=34)
[S4] round=55 local utility u=0.000989 metrics={'f1_val': 0.9477866134521362, 'auprc': 0.951800193374855, 'loss_val': 0.3002274084946446, 'psi': 0.9493920454212237}-{'f1_val': 0.9421703179831624, 'auprc': 0.9639496968968947, 'loss_val': 0.3049563330422202, 'psi': 0.9508820695486553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=55 head_norm_before_train=1.968589 cos_to_last_merge=0.9961 (last merge round=35)
[S5] round=55 local utility u=0.356764 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9730011710174316, 'loss_val': 0.35695689914905243, 'psi': 0.8093932588673209}-{'f1_val': 0.6542060509439255, 'auprc': 0.8595026228576578, 'loss_val': 0.45329674194002645, 'psi': 0.7363246797094184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=55 head_norm_before_train=2.145948 (no previous merge yet)
[S6] round=55 local utility u=0.017426 metrics={'f1_val': 0.7495454885398116, 'auprc': 0.941155920478025, 'loss_val': 0.6667330968934211, 'psi': 0.826189661315097}-{'f1_val': 0.7680264826079515, 'auprc': 0.8890143694446355, 'loss_val': 0.6560471668040027, 'psi': 0.8164216373426252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=55 head_norm_before_train=1.699954 cos_to_last_merge=0.9966 (last merge round=40)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.4640329125659937, 'auprc': 0.7797728094952625, 'loss_val': 1.0377032780539384, 'psi': 0.5903288713377013}-{'f1_val': 0.6662721177373343, 'auprc': 0.8251283760259913, 'loss_val': 0.3795855009515833, 'psi': 0.7298146210527972}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=55 head_norm_before_train=1.796492 cos_to_last_merge=0.9872 (last merge round=33)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.8303810082199056, 'auprc': 0.9973384716854915, 'loss_val': 0.4775001630861992, 'psi': 0.89716399360614}-{'f1_val': 0.9936536506497753, 'auprc': 0.9990466351851911, 'loss_val': 0.03357310462582244, 'psi': 0.9958108444639416}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=2.118683 (no previous merge yet)
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.999171752966519, 'loss_val': 0.02105085448639059, 'psi': 0.9964152098821744}-{'f1_val': 0.9958267183641853, 'auprc': 0.9991575435010285, 'loss_val': 0.02006018985028551, 'psi': 0.9971590484189227}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=2.350227 cos_to_last_merge=0.9922 (last merge round=33)
[S10] round=55 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9947248147882285, 'loss_val': 0.0321203916082055, 'psi': 0.9939495508078349}-{'f1_val': 0.9934327081542391, 'auprc': 0.994564971697136, 'loss_val': 0.03162208263831868, 'psi': 0.9938856135713979}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=55 head_norm_before_train=2.313749 cos_to_last_merge=0.9994 (last merge round=41)
[S11] round=55 local utility u=0.001917 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9981372423205945, 'loss_val': 0.02001624967361545, 'psi': 0.9973404067839851}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984282879252031, 'loss_val': 0.02079312590817623, 'psi': 0.9970638000165285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=55 head_norm_before_train=2.003367 (no previous merge yet)
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.6398239872072271, 'auprc': 0.668306636133702, 'loss_val': 1.113452439401951, 'psi': 0.6512170467778171}-{'f1_val': 0.7102760238798121, 'auprc': 0.6616136798264042, 'loss_val': 1.1666930083877713, 'psi': 0.690811086258449}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=2.299609 cos_to_last_merge=0.9965 (last merge round=32)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9440756827242531, 'auprc': 0.9944431579293066, 'loss_val': 0.12749161640607784, 'psi': 0.9642226728062745}-{'f1_val': 0.9974284489365712, 'auprc': 0.9954441456901207, 'loss_val': 0.018087391279133162, 'psi': 0.9966347276379911}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=2.124674 cos_to_last_merge=0.9787 (last merge round=39)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.8228193247077428, 'auprc': 0.993025717305876, 'loss_val': 0.4071962082666169, 'psi': 0.890901881746996}-{'f1_val': 0.9627849853920603, 'auprc': 0.9967417869675103, 'loss_val': 0.07393078317737761, 'psi': 0.9763677060222402}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.880361 cos_to_last_merge=0.9966 (last merge round=39)
[S16] round=55 local utility u=0.600799 metrics={'f1_val': 0.9337627486548306, 'auprc': 0.9923089209196907, 'loss_val': 0.37251189090359316, 'psi': 0.9571812175607746}-{'f1_val': 0.8475353836789253, 'auprc': 0.975287562117178, 'loss_val': 1.0056812828574344, 'psi': 0.8986362550542264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=55 head_norm_before_train=2.319408 cos_to_last_merge=0.9995 (last merge round=41)
[S17] round=55 local utility u=0.101011 metrics={'f1_val': 0.8940505483909711, 'auprc': 0.9620000363588501, 'loss_val': 0.5693849864834176, 'psi': 0.9212303435781227}-{'f1_val': 0.8575805332347672, 'auprc': 0.9804320570190094, 'loss_val': 0.6078819978559046, 'psi': 0.9067211427484642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=56 head_norm_before_train=1.999228 cos_to_last_merge=0.9986 (last merge round=38)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.8107453889842848, 'auprc': 0.9103264962139266, 'loss_val': 0.4828100691481544, 'psi': 0.8505778318761416}-{'f1_val': 0.7724586018875328, 'auprc': 0.9844231484781789, 'loss_val': 0.4315632254188676, 'psi': 0.8572444205237912}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=2.230917 cos_to_last_merge=0.9913 (last merge round=34)
[S3] round=56 local utility u=0.001804 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9999513896833665, 'loss_val': 0.07875310858880105, 'psi': 0.9766017065366128}-{'f1_val': 0.9610352511054436, 'auprc': 0.9999043605020846, 'loss_val': 0.08221984252060265, 'psi': 0.9765828948641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=56 head_norm_before_train=1.847679 cos_to_last_merge=0.9791 (last merge round=34)
[S4] round=56 local utility u=0.024747 metrics={'f1_val': 0.945796087322985, 'auprc': 0.9701579049493378, 'loss_val': 0.2938634917343101, 'psi': 0.9555408143735262}-{'f1_val': 0.9477866134521362, 'auprc': 0.951800193374855, 'loss_val': 0.3002274084946446, 'psi': 0.9493920454212237}
[S4] not sending this round → trigger blocked (psi=0.956)
[S5] START round=56 head_norm_before_train=1.971631 cos_to_last_merge=0.9959 (last merge round=35)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.8875517627597007, 'loss_val': 0.38404703927017675, 'psi': 0.7752134955642285}-{'f1_val': 0.7003213174339138, 'auprc': 0.9730011710174316, 'loss_val': 0.35695689914905243, 'psi': 0.8093932588673209}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=2.156274 (no previous merge yet)
[S6] round=56 local utility u=0.218220 metrics={'f1_val': 0.7857520510590992, 'auprc': 0.9720972295558317, 'loss_val': 0.5403558314856732, 'psi': 0.8602901224577921}-{'f1_val': 0.7495454885398116, 'auprc': 0.941155920478025, 'loss_val': 0.6667330968934211, 'psi': 0.826189661315097}
[S6] not sending this round → trigger blocked (psi=0.860)
[S7] START round=56 head_norm_before_train=1.706505 cos_to_last_merge=0.9962 (last merge round=40)
[S7] round=56 local utility u=0.864586 metrics={'f1_val': 0.6536707481830604, 'auprc': 0.8037046624180522, 'loss_val': 0.5181542650284182, 'psi': 0.713684313877057}-{'f1_val': 0.4640329125659937, 'auprc': 0.7797728094952625, 'loss_val': 1.0377032780539384, 'psi': 0.5903288713377013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=56 head_norm_before_train=1.805446 cos_to_last_merge=0.9867 (last merge round=33)
[S8] round=56 local utility u=0.713765 metrics={'f1_val': 0.9940049367381726, 'auprc': 0.9979581122159609, 'loss_val': 0.0335719344217449, 'psi': 0.9955862069292879}-{'f1_val': 0.8303810082199056, 'auprc': 0.9973384716854915, 'loss_val': 0.4775001630861992, 'psi': 0.89716399360614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=56 head_norm_before_train=2.120473 (no previous merge yet)
[S9] round=56 local utility u=0.010296 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995443843127213, 'loss_val': 0.016728707323753592, 'psi': 0.9980795012323742}-{'f1_val': 0.9945775144926113, 'auprc': 0.999171752966519, 'loss_val': 0.02105085448639059, 'psi': 0.9964152098821744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=56 head_norm_before_train=2.354880 cos_to_last_merge=0.9920 (last merge round=33)
[S10] round=56 local utility u=0.000075 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9945709725509051, 'loss_val': 0.03150959248498481, 'psi': 0.9938880139129056}-{'f1_val': 0.9934327081542391, 'auprc': 0.9947248147882285, 'loss_val': 0.0321203916082055, 'psi': 0.9939495508078349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] START round=56 head_norm_before_train=2.321304 cos_to_last_merge=0.9993 (last merge round=41)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998004973720645, 'loss_val': 0.02145077807014562, 'psi': 0.9971301921964117}-{'f1_val': 0.9968091830929121, 'auprc': 0.9981372423205945, 'loss_val': 0.02001624967361545, 'psi': 0.9973404067839851}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=2.014522 (no previous merge yet)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6238825387692453, 'auprc': 0.6457658845047237, 'loss_val': 1.3292014965778667, 'psi': 0.6326358770634366}-{'f1_val': 0.6398239872072271, 'auprc': 0.668306636133702, 'loss_val': 1.113452439401951, 'psi': 0.6512170467778171}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=2.305342 cos_to_last_merge=0.9964 (last merge round=32)
[S14] round=56 local utility u=0.217696 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969667429856921, 'loss_val': 0.01865810578478715, 'psi': 0.9971309112177527}-{'f1_val': 0.9440756827242531, 'auprc': 0.9944431579293066, 'loss_val': 0.12749161640607784, 'psi': 0.9642226728062745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=56 head_norm_before_train=2.138608 cos_to_last_merge=0.9780 (last merge round=39)
[S15] round=56 local utility u=0.712714 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9923851565648774, 'loss_val': 0.020828523823747662, 'psi': 0.9947439253985035}-{'f1_val': 0.8228193247077428, 'auprc': 0.993025717305876, 'loss_val': 0.4071962082666169, 'psi': 0.890901881746996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=56 head_norm_before_train=1.887437 cos_to_last_merge=0.9964 (last merge round=39)
[S16] round=56 local utility u=0.325695 metrics={'f1_val': 0.9892799764303702, 'auprc': 0.9937368760554854, 'loss_val': 0.05851009450977082, 'psi': 0.9910627362804163}-{'f1_val': 0.9337627486548306, 'auprc': 0.9923089209196907, 'loss_val': 0.37251189090359316, 'psi': 0.9571812175607746}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=56 head_norm_before_train=2.322250 cos_to_last_merge=0.9995 (last merge round=41)
[S17] round=56 local utility u=0.055930 metrics={'f1_val': 0.9076733837156145, 'auprc': 0.9644021528112131, 'loss_val': 0.5464689279443543, 'psi': 0.9303648913538539}-{'f1_val': 0.8940505483909711, 'auprc': 0.9620000363588501, 'loss_val': 0.5693849864834176, 'psi': 0.9212303435781227}
[S17] not sending this round → trigger blocked (psi=0.930)
[S2] START round=57 head_norm_before_train=2.005301 cos_to_last_merge=0.9985 (last merge round=38)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.6826096433458033, 'auprc': 0.7351748642514826, 'loss_val': 1.2843500553554879, 'psi': 0.703635731708075}-{'f1_val': 0.8107453889842848, 'auprc': 0.9103264962139266, 'loss_val': 0.4828100691481544, 'psi': 0.8505778318761416}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=2.240300 cos_to_last_merge=0.9908 (last merge round=34)
[S3] round=57 local utility u=0.101142 metrics={'f1_val': 0.9864135609663514, 'auprc': 0.999949339024895, 'loss_val': 0.028733368845026228, 'psi': 0.9918278721897689}-{'f1_val': 0.9610352511054436, 'auprc': 0.9999513896833665, 'loss_val': 0.07875310858880105, 'psi': 0.9766017065366128}
[S3] not sending this round → trigger blocked (psi=0.992)
[S4] START round=57 head_norm_before_train=1.854193 cos_to_last_merge=0.9782 (last merge round=34)
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9475447863604021, 'auprc': 0.9583986173882979, 'loss_val': 0.3037104757832077, 'psi': 0.9518863187715604}-{'f1_val': 0.945796087322985, 'auprc': 0.9701579049493378, 'loss_val': 0.2938634917343101, 'psi': 0.9555408143735262}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.972860 cos_to_last_merge=0.9958 (last merge round=35)
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.6658647744787611, 'auprc': 0.9256224153039312, 'loss_val': 0.3219222762950683, 'psi': 0.7697678308088292}-{'f1_val': 0.7003213174339138, 'auprc': 0.8875517627597007, 'loss_val': 0.38404703927017675, 'psi': 0.7752134955642285}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=2.168690 (no previous merge yet)
[S6] round=57 local utility u=0.045297 metrics={'f1_val': 0.7912444820136939, 'auprc': 0.9761839001038095, 'loss_val': 0.4949754309763813, 'psi': 0.8652202492497402}-{'f1_val': 0.7857520510590992, 'auprc': 0.9720972295558317, 'loss_val': 0.5403558314856732, 'psi': 0.8602901224577921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=57 head_norm_before_train=1.713457 cos_to_last_merge=0.9959 (last merge round=40)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.44410957159896974, 'auprc': 0.7744647563091972, 'loss_val': 1.2148837920557194, 'psi': 0.5762516454830607}-{'f1_val': 0.6536707481830604, 'auprc': 0.8037046624180522, 'loss_val': 0.5181542650284182, 'psi': 0.713684313877057}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=1.812642 cos_to_last_merge=0.9863 (last merge round=33)
[S8] round=57 local utility u=0.001635 metrics={'f1_val': 0.9937751589505717, 'auprc': 0.9989950619950487, 'loss_val': 0.03203367514336167, 'psi': 0.9958631201683625}-{'f1_val': 0.9940049367381726, 'auprc': 0.9979581122159609, 'loss_val': 0.0335719344217449, 'psi': 0.9955862069292879}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=57 head_norm_before_train=2.123681 (no previous merge yet)
[S9] round=57 local utility u=0.000279 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9997922707197763, 'loss_val': 0.016914716308925944, 'psi': 0.9981786557951962}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995443843127213, 'loss_val': 0.016728707323753592, 'psi': 0.9980795012323742}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=57 head_norm_before_train=2.360495 cos_to_last_merge=0.9917 (last merge round=33)
[S10] round=57 local utility u=0.000058 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946023964934434, 'loss_val': 0.031487481166019037, 'psi': 0.9939005834899208}-{'f1_val': 0.9934327081542391, 'auprc': 0.9945709725509051, 'loss_val': 0.03150959248498481, 'psi': 0.9938880139129056}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=57 head_norm_before_train=2.328503 cos_to_last_merge=0.9992 (last merge round=41)
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.995672955508997, 'auprc': 0.998567253122857, 'loss_val': 0.020766653450862035, 'psi': 0.996830674554541}-{'f1_val': 0.9965470045135896, 'auprc': 0.998004973720645, 'loss_val': 0.02145077807014562, 'psi': 0.9971301921964117}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=2.010988 (no previous merge yet)
[S13] round=57 local utility u=0.614782 metrics={'f1_val': 0.7431348320210028, 'auprc': 0.7173490724262248, 'loss_val': 1.0299006687602257, 'psi': 0.7328205281830916}-{'f1_val': 0.6238825387692453, 'auprc': 0.6457658845047237, 'loss_val': 1.3292014965778667, 'psi': 0.6326358770634366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=57 head_norm_before_train=2.309941 cos_to_last_merge=0.9962 (last merge round=32)
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9947794136091409, 'loss_val': 0.020635706696420945, 'psi': 0.996112193372203}-{'f1_val': 0.997240356705793, 'auprc': 0.9969667429856921, 'loss_val': 0.01865810578478715, 'psi': 0.9971309112177527}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=57 head_norm_before_train=2.151635 cos_to_last_merge=0.9772 (last merge round=39)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.8767851843839501, 'auprc': 0.9818796908558789, 'loss_val': 0.3781666665369087, 'psi': 0.9188229869727216}-{'f1_val': 0.9963164379542544, 'auprc': 0.9923851565648774, 'loss_val': 0.020828523823747662, 'psi': 0.9947439253985035}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.895749 cos_to_last_merge=0.9962 (last merge round=39)
[S16] round=57 local utility u=0.011685 metrics={'f1_val': 0.9910266381262515, 'auprc': 0.9933850290615472, 'loss_val': 0.044564885772827266, 'psi': 0.9919699945003698}-{'f1_val': 0.9892799764303702, 'auprc': 0.9937368760554854, 'loss_val': 0.05851009450977082, 'psi': 0.9910627362804163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=57 head_norm_before_train=2.328244 cos_to_last_merge=0.9995 (last merge round=41)
[S17] round=57 local utility u=0.014651 metrics={'f1_val': 0.9117170453086895, 'auprc': 0.9589108739639711, 'loss_val': 0.5249549901156626, 'psi': 0.9305945767708022}-{'f1_val': 0.9076733837156145, 'auprc': 0.9644021528112131, 'loss_val': 0.5464689279443543, 'psi': 0.9303648913538539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=58 head_norm_before_train=2.012469 cos_to_last_merge=0.9985 (last merge round=38)
[S2] round=58 local utility u=0.712016 metrics={'f1_val': 0.7938006088471146, 'auprc': 0.7406169564923429, 'loss_val': 0.5437896975860754, 'psi': 0.7725271479052059}-{'f1_val': 0.6826096433458033, 'auprc': 0.7351748642514826, 'loss_val': 1.2843500553554879, 'psi': 0.703635731708075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=58 head_norm_before_train=2.249007 cos_to_last_merge=0.9903 (last merge round=34)
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.959400038305751, 'auprc': 0.9988947177506553, 'loss_val': 0.07750185753296311, 'psi': 0.9751979100837127}-{'f1_val': 0.9864135609663514, 'auprc': 0.999949339024895, 'loss_val': 0.028733368845026228, 'psi': 0.9918278721897689}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.865158 cos_to_last_merge=0.9778 (last merge round=34)
[S4] round=58 local utility u=0.006065 metrics={'f1_val': 0.9425093261468293, 'auprc': 0.9719514060151255, 'loss_val': 0.3020269436443881, 'psi': 0.9542861580941477}-{'f1_val': 0.9475447863604021, 'auprc': 0.9583986173882979, 'loss_val': 0.3037104757832077, 'psi': 0.9518863187715604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=58 head_norm_before_train=1.974301 cos_to_last_merge=0.9957 (last merge round=35)
[S5] round=58 local utility u=0.351186 metrics={'f1_val': 0.7628640580558137, 'auprc': 0.9553445688133546, 'loss_val': 0.2907130550775561, 'psi': 0.83985626235883}-{'f1_val': 0.6658647744787611, 'auprc': 0.9256224153039312, 'loss_val': 0.3219222762950683, 'psi': 0.7697678308088292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=58 head_norm_before_train=2.180767 (no previous merge yet)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.6167726835463436, 'auprc': 0.7569253651240022, 'loss_val': 1.3482369410740924, 'psi': 0.672833756177407}-{'f1_val': 0.7912444820136939, 'auprc': 0.9761839001038095, 'loss_val': 0.4949754309763813, 'psi': 0.8652202492497402}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.719774 cos_to_last_merge=0.9956 (last merge round=40)
[S7] round=58 local utility u=1.000000 metrics={'f1_val': 0.681080401125262, 'auprc': 0.842153838435319, 'loss_val': 0.33312704456186565, 'psi': 0.7455097760492848}-{'f1_val': 0.44410957159896974, 'auprc': 0.7744647563091972, 'loss_val': 1.2148837920557194, 'psi': 0.5762516454830607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=58 head_norm_before_train=1.821567 cos_to_last_merge=0.9859 (last merge round=33)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9917662017661685, 'auprc': 0.9990538525318541, 'loss_val': 0.037625103471614345, 'psi': 0.9946812620724428}-{'f1_val': 0.9937751589505717, 'auprc': 0.9989950619950487, 'loss_val': 0.03203367514336167, 'psi': 0.9958631201683625}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=2.129550 (no previous merge yet)
[S9] round=58 local utility u=0.000227 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998895589219443, 'loss_val': 0.01675356164740249, 'psi': 0.9982175710760635}-{'f1_val': 0.9971029125121428, 'auprc': 0.9997922707197763, 'loss_val': 0.016914716308925944, 'psi': 0.9981786557951962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=58 head_norm_before_train=2.367221 cos_to_last_merge=0.9914 (last merge round=33)
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9949812913091982, 'loss_val': 0.03290735035159347, 'psi': 0.9940521414162228}-{'f1_val': 0.9934327081542391, 'auprc': 0.9946023964934434, 'loss_val': 0.031487481166019037, 'psi': 0.9939005834899208}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=2.332563 cos_to_last_merge=0.9992 (last merge round=41)
[S11] round=58 local utility u=0.001748 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.99871591571896, 'loss_val': 0.020604523102445444, 'psi': 0.9971788511340313}-{'f1_val': 0.995672955508997, 'auprc': 0.998567253122857, 'loss_val': 0.020766653450862035, 'psi': 0.996830674554541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=58 head_norm_before_train=2.014472 (no previous merge yet)
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.6289610042084443, 'auprc': 0.8744833790392746, 'loss_val': 1.0451525644766555, 'psi': 0.7271699541407765}-{'f1_val': 0.7431348320210028, 'auprc': 0.7173490724262248, 'loss_val': 1.0299006687602257, 'psi': 0.7328205281830916}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=2.314421 cos_to_last_merge=0.9959 (last merge round=32)
[S14] round=58 local utility u=0.005169 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9983620963967872, 'loss_val': 0.02237218323407663, 'psi': 0.9976778537680249}-{'f1_val': 0.9970007132142444, 'auprc': 0.9947794136091409, 'loss_val': 0.020635706696420945, 'psi': 0.996112193372203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=58 head_norm_before_train=2.160882 cos_to_last_merge=0.9767 (last merge round=39)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.7273957561011185, 'auprc': 0.9064819535494087, 'loss_val': 0.6819512917740058, 'psi': 0.7990302350804346}-{'f1_val': 0.8767851843839501, 'auprc': 0.9818796908558789, 'loss_val': 0.3781666665369087, 'psi': 0.9188229869727216}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.904477 cos_to_last_merge=0.9959 (last merge round=39)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.8460866739078705, 'auprc': 0.840026493747198, 'loss_val': 1.1208926571483144, 'psi': 0.8436626018436014}-{'f1_val': 0.9910266381262515, 'auprc': 0.9933850290615472, 'loss_val': 0.044564885772827266, 'psi': 0.9919699945003698}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=2.335503 cos_to_last_merge=0.9994 (last merge round=41)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.9073081574012632, 'auprc': 0.9576799992284717, 'loss_val': 0.552799476470397, 'psi': 0.9274568941321466}-{'f1_val': 0.9117170453086895, 'auprc': 0.9589108739639711, 'loss_val': 0.5249549901156626, 'psi': 0.9305945767708022}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=2.017807 cos_to_last_merge=0.9984 (last merge round=38)
[S2] round=59 local utility u=0.119281 metrics={'f1_val': 0.70856593985258, 'auprc': 0.9895334212279021, 'loss_val': 0.5405688226576515, 'psi': 0.820952932402709}-{'f1_val': 0.7938006088471146, 'auprc': 0.7406169564923429, 'loss_val': 0.5437896975860754, 'psi': 0.7725271479052059}
[S2] not sending this round → trigger blocked (psi=0.821)
[S2] r=60 psi=0.821 u=0.1193 p_local=0.2240 f1=0.709 auprc=0.990 bytes=41366
[S3] START round=59 head_norm_before_train=2.255856 cos_to_last_merge=0.9899 (last merge round=34)
[S3] round=59 local utility u=0.103168 metrics={'f1_val': 0.9863875916225989, 'auprc': 0.9998555211123513, 'loss_val': 0.035974250885094115, 'psi': 0.9917747634184999}-{'f1_val': 0.959400038305751, 'auprc': 0.9988947177506553, 'loss_val': 0.07750185753296311, 'psi': 0.9751979100837127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=60 psi=0.992 u=0.1032 p_local=0.1213 f1=0.986 auprc=1.000 bytes=43128
[S4] START round=59 head_norm_before_train=1.872763 cos_to_last_merge=0.9771 (last merge round=34)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.939360223862237, 'auprc': 0.9361952699067319, 'loss_val': 0.3175430299648257, 'psi': 0.938094242280035}-{'f1_val': 0.9425093261468293, 'auprc': 0.9719514060151255, 'loss_val': 0.3020269436443881, 'psi': 0.9542861580941477}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.938 u=0.0000 p_local=0.0124 f1=0.939 auprc=0.936 bytes=39569
[S5] START round=59 head_norm_before_train=1.978415 cos_to_last_merge=0.9955 (last merge round=35)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.662257352549239, 'auprc': 0.8646655753355392, 'loss_val': 0.4591761031098091, 'psi': 0.743220641663759}-{'f1_val': 0.7628640580558137, 'auprc': 0.9553445688133546, 'loss_val': 0.2907130550775561, 'psi': 0.83985626235883}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.743 u=0.0000 p_local=0.1576 f1=0.662 auprc=0.865 bytes=46792
[S6] START round=59 head_norm_before_train=2.186769 (no previous merge yet)
[S6] round=59 local utility u=1.000000 metrics={'f1_val': 0.881159348416634, 'auprc': 0.9717774039128695, 'loss_val': 0.24002989958779172, 'psi': 0.9174065706151282}-{'f1_val': 0.6167726835463436, 'auprc': 0.7569253651240022, 'loss_val': 1.3482369410740924, 'psi': 0.672833756177407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S6] r=60 psi=0.917 u=1.0000 p_local=0.3190 f1=0.881 auprc=0.972 bytes=46744
[S7] START round=59 head_norm_before_train=1.722925 cos_to_last_merge=0.9953 (last merge round=40)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.5603450754136057, 'auprc': 0.7812735057744666, 'loss_val': 0.7811404923906338, 'psi': 0.6487164475579501}-{'f1_val': 0.681080401125262, 'auprc': 0.842153838435319, 'loss_val': 0.33312704456186565, 'psi': 0.7455097760492848}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.649 u=0.0000 p_local=0.3675 f1=0.560 auprc=0.781 bytes=45009
[S8] START round=59 head_norm_before_train=1.830146 cos_to_last_merge=0.9855 (last merge round=33)
[S8] round=59 local utility u=0.009538 metrics={'f1_val': 0.9940049367381726, 'auprc': 0.9984145420454463, 'loss_val': 0.030062778315976094, 'psi': 0.9957687788610821}-{'f1_val': 0.9917662017661685, 'auprc': 0.9990538525318541, 'loss_val': 0.037625103471614345, 'psi': 0.9946812620724428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S8] r=60 psi=0.996 u=0.0095 p_local=0.0774 f1=0.994 auprc=0.998 bytes=48607
[S9] START round=59 head_norm_before_train=2.136744 (no previous merge yet)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9995443726967381, 'loss_val': 0.016224018657003254, 'psi': 0.9980777788022333}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998895589219443, 'loss_val': 0.01675356164740249, 'psi': 0.9982175710760635}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.998 u=0.0000 p_local=0.0018 f1=0.997 auprc=1.000 bytes=48532
[S10] START round=59 head_norm_before_train=2.371387 cos_to_last_merge=0.9912 (last merge round=33)
[S10] round=59 local utility u=0.000209 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9948481475390825, 'loss_val': 0.03208996959177411, 'psi': 0.9939988839081765}-{'f1_val': 0.9934327081542391, 'auprc': 0.9949812913091982, 'loss_val': 0.03290735035159347, 'psi': 0.9940521414162228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S10] r=60 psi=0.994 u=0.0002 p_local=0.0001 f1=0.993 auprc=0.995 bytes=48494
[S11] START round=59 head_norm_before_train=2.335405 cos_to_last_merge=0.9991 (last merge round=41)
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986492027849965, 'loss_val': 0.022324935324436374, 'psi': 0.9971521659604459}-{'f1_val': 0.9961541414107454, 'auprc': 0.99871591571896, 'loss_val': 0.020604523102445444, 'psi': 0.9971788511340313}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.997 u=0.0000 p_local=0.0023 f1=0.996 auprc=0.999 bytes=44908
[S13] START round=59 head_norm_before_train=2.017083 (no previous merge yet)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6095443875195542, 'auprc': 0.6008020246356052, 'loss_val': 1.45255557103801, 'psi': 0.6060474423659745}-{'f1_val': 0.6289610042084443, 'auprc': 0.8744833790392746, 'loss_val': 1.0451525644766555, 'psi': 0.7271699541407765}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.606 u=0.0000 p_local=0.1730 f1=0.610 auprc=0.601 bytes=37752
[S14] START round=59 head_norm_before_train=2.319468 cos_to_last_merge=0.9958 (last merge round=32)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9956005162735417, 'auprc': 0.9981015289305575, 'loss_val': 0.03586292182356505, 'psi': 0.996600921336348}-{'f1_val': 0.9972216920155168, 'auprc': 0.9983620963967872, 'loss_val': 0.02237218323407663, 'psi': 0.9976778537680249}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0262 f1=0.996 auprc=0.998 bytes=48559
[S15] START round=59 head_norm_before_train=2.170554 cos_to_last_merge=0.9762 (last merge round=39)
[S15] round=59 local utility u=0.292208 metrics={'f1_val': 0.7875522134885039, 'auprc': 0.9374589445764225, 'loss_val': 0.551404297405261, 'psi': 0.8475149059236713}-{'f1_val': 0.7273957561011185, 'auprc': 0.9064819535494087, 'loss_val': 0.6819512917740058, 'psi': 0.7990302350804346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S15] r=60 psi=0.848 u=0.2922 p_local=0.2271 f1=0.788 auprc=0.937 bytes=43197
[S16] START round=59 head_norm_before_train=1.909689 cos_to_last_merge=0.9957 (last merge round=39)
[S16] round=59 local utility u=1.000000 metrics={'f1_val': 0.992079754585487, 'auprc': 0.990527447726684, 'loss_val': 0.04015204480180999, 'psi': 0.9914588318419658}-{'f1_val': 0.8460866739078705, 'auprc': 0.840026493747198, 'loss_val': 1.1208926571483144, 'psi': 0.8436626018436014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S16] r=60 psi=0.991 u=1.0000 p_local=0.3310 f1=0.992 auprc=0.991 bytes=44954
[S17] START round=59 head_norm_before_train=2.341494 cos_to_last_merge=0.9993 (last merge round=41)
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.789301211299354, 'auprc': 0.9671146945379017, 'loss_val': 0.7972811463838486, 'psi': 0.860426604594773}-{'f1_val': 0.9073081574012632, 'auprc': 0.9576799992284717, 'loss_val': 0.552799476470397, 'psi': 0.9274568941321466}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.860 u=0.0000 p_local=0.0634 f1=0.789 auprc=0.967 bytes=44998
[S2] START round=60 head_norm_before_train=2.019492 cos_to_last_merge=0.9983 (last merge round=38)
[S2] round=60 local utility u=0.436021 metrics={'f1_val': 0.827856455095873, 'auprc': 0.9898995565018818, 'loss_val': 0.3853677302836156, 'psi': 0.8926736956582766}-{'f1_val': 0.70856593985258, 'auprc': 0.9895334212279021, 'loss_val': 0.5405688226576515, 'psi': 0.820952932402709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=60 head_norm_before_train=2.263267 cos_to_last_merge=0.9894 (last merge round=34)
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.9844250755171896, 'auprc': 0.9998927004940994, 'loss_val': 0.03589047234492273, 'psi': 0.9906121255079535}-{'f1_val': 0.9863875916225989, 'auprc': 0.9998555211123513, 'loss_val': 0.035974250885094115, 'psi': 0.9917747634184999}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=1.877398 cos_to_last_merge=0.9760 (last merge round=34)
[S4] round=60 local utility u=0.010571 metrics={'f1_val': 0.9405179569401124, 'auprc': 0.9394468791622512, 'loss_val': 0.3131012961508211, 'psi': 0.9400895258289679}-{'f1_val': 0.939360223862237, 'auprc': 0.9361952699067319, 'loss_val': 0.3175430299648257, 'psi': 0.938094242280035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=60 head_norm_before_train=1.982932 cos_to_last_merge=0.9953 (last merge round=35)
[S5] round=60 local utility u=0.344363 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9712587880659754, 'loss_val': 0.3201633142219487, 'psi': 0.8088513675363134}-{'f1_val': 0.662257352549239, 'auprc': 0.8646655753355392, 'loss_val': 0.4591761031098091, 'psi': 0.743220641663759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=60 head_norm_before_train=2.191413 (no previous merge yet)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.6404826515893434, 'auprc': 0.8992110413516453, 'loss_val': 1.0535297238770371, 'psi': 0.7439740074942641}-{'f1_val': 0.881159348416634, 'auprc': 0.9717774039128695, 'loss_val': 0.24002989958779172, 'psi': 0.9174065706151282}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.724804 cos_to_last_merge=0.9951 (last merge round=40)
[S7] round=60 local utility u=0.556327 metrics={'f1_val': 0.658166169302901, 'auprc': 0.8236945942276508, 'loss_val': 0.38267659654825736, 'psi': 0.7243775392728009}-{'f1_val': 0.5603450754136057, 'auprc': 0.7812735057744666, 'loss_val': 0.7811404923906338, 'psi': 0.6487164475579501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=60 head_norm_before_train=1.833805 cos_to_last_merge=0.9851 (last merge round=33)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.999178730293357, 'loss_val': 0.0353526374463778, 'psi': 0.9953860634871705}-{'f1_val': 0.9940049367381726, 'auprc': 0.9984145420454463, 'loss_val': 0.030062778315976094, 'psi': 0.9957687788610821}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=2.144102 (no previous merge yet)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9991714022448567, 'loss_val': 0.03453687291944161, 'psi': 0.9940116659576776}-{'f1_val': 0.9971000495392299, 'auprc': 0.9995443726967381, 'loss_val': 0.016224018657003254, 'psi': 0.9980777788022333}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=2.377262 cos_to_last_merge=0.9909 (last merge round=33)
[S10] round=60 local utility u=0.001157 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9937282080044458, 'loss_val': 0.030361156970430313, 'psi': 0.9939454784999466}-{'f1_val': 0.9934327081542391, 'auprc': 0.9948481475390825, 'loss_val': 0.03208996959177411, 'psi': 0.9939988839081765}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=60 head_norm_before_train=2.340339 cos_to_last_merge=0.9990 (last merge round=41)
[S11] round=60 local utility u=0.000000 metrics={'f1_val': 0.9965919014202035, 'auprc': 0.9967736093356996, 'loss_val': 0.07613764394420669, 'psi': 0.996664584586402}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986492027849965, 'loss_val': 0.022324935324436374, 'psi': 0.9971521659604459}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=60 head_norm_before_train=2.018830 (no previous merge yet)
[S13] round=60 local utility u=0.110961 metrics={'f1_val': 0.6216137417706835, 'auprc': 0.6388402002963444, 'loss_val': 1.4171636451908876, 'psi': 0.6285043251809479}-{'f1_val': 0.6095443875195542, 'auprc': 0.6008020246356052, 'loss_val': 1.45255557103801, 'psi': 0.6060474423659745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=60 head_norm_before_train=2.324037 cos_to_last_merge=0.9957 (last merge round=32)
[S14] round=60 local utility u=0.011445 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9965926713890343, 'loss_val': 0.018173097626260976, 'psi': 0.9969700837649238}-{'f1_val': 0.9956005162735417, 'auprc': 0.9981015289305575, 'loss_val': 0.03586292182356505, 'psi': 0.996600921336348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=60 head_norm_before_train=2.181540 cos_to_last_merge=0.9756 (last merge round=39)
[S15] round=60 local utility u=0.635194 metrics={'f1_val': 0.9110423648777821, 'auprc': 0.996863206967578, 'loss_val': 0.20016960188647742, 'psi': 0.9453707017137005}-{'f1_val': 0.7875522134885039, 'auprc': 0.9374589445764225, 'loss_val': 0.551404297405261, 'psi': 0.8475149059236713}
[S15] not sending this round → trigger blocked (psi=0.945)
[S16] START round=60 head_norm_before_train=1.915411 cos_to_last_merge=0.9955 (last merge round=39)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.9838797154331861, 'auprc': 0.9863320550070165, 'loss_val': 0.08264312312953873, 'psi': 0.9848606512627183}-{'f1_val': 0.992079754585487, 'auprc': 0.990527447726684, 'loss_val': 0.04015204480180999, 'psi': 0.9914588318419658}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=60 head_norm_before_train=2.349186 cos_to_last_merge=0.9992 (last merge round=41)
[S17] round=60 local utility u=0.441487 metrics={'f1_val': 0.9086932103827556, 'auprc': 0.9353299111590732, 'loss_val': 0.5353042905685959, 'psi': 0.9193478906932826}-{'f1_val': 0.789301211299354, 'auprc': 0.9671146945379017, 'loss_val': 0.7972811463838486, 'psi': 0.860426604594773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=61 head_norm_before_train=2.019211 cos_to_last_merge=0.9981 (last merge round=38)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.6922050273337419, 'auprc': 0.846618485342429, 'loss_val': 1.2381247176526926, 'psi': 0.7539704105372167}-{'f1_val': 0.827856455095873, 'auprc': 0.9898995565018818, 'loss_val': 0.3853677302836156, 'psi': 0.8926736956582766}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.268717 cos_to_last_merge=0.9891 (last merge round=34)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.9585412103933568, 'auprc': 0.9984389626180181, 'loss_val': 0.08331950196265668, 'psi': 0.9745003112832213}-{'f1_val': 0.9844250755171896, 'auprc': 0.9998927004940994, 'loss_val': 0.03589047234492273, 'psi': 0.9906121255079535}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.882094 cos_to_last_merge=0.9748 (last merge round=34)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9392347550094323, 'auprc': 0.9458247678246144, 'loss_val': 0.33685109042810707, 'psi': 0.9418707601355052}-{'f1_val': 0.9405179569401124, 'auprc': 0.9394468791622512, 'loss_val': 0.3131012961508211, 'psi': 0.9400895258289679}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.986472 cos_to_last_merge=0.9951 (last merge round=35)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.60059420404842, 'auprc': 0.8420010083414756, 'loss_val': 0.6323189448837849, 'psi': 0.6971569257656423}-{'f1_val': 0.7005797538498719, 'auprc': 0.9712587880659754, 'loss_val': 0.3201633142219487, 'psi': 0.8088513675363134}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=2.197280 (no previous merge yet)
[S6] round=61 local utility u=1.000000 metrics={'f1_val': 0.8754371040313442, 'auprc': 0.9780717715353382, 'loss_val': 0.2526435739379587, 'psi': 0.9164909710329417}-{'f1_val': 0.6404826515893434, 'auprc': 0.8992110413516453, 'loss_val': 1.0535297238770371, 'psi': 0.7439740074942641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=61 head_norm_before_train=1.728246 cos_to_last_merge=0.9949 (last merge round=40)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.6098056243560137, 'auprc': 0.7913336937517148, 'loss_val': 0.6711486125656638, 'psi': 0.6824168521142941}-{'f1_val': 0.658166169302901, 'auprc': 0.8236945942276508, 'loss_val': 0.38267659654825736, 'psi': 0.7243775392728009}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.838208 cos_to_last_merge=0.9848 (last merge round=33)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9917662017661685, 'auprc': 0.9990721746487693, 'loss_val': 0.037971083043698894, 'psi': 0.9946885909192088}-{'f1_val': 0.9928576189497129, 'auprc': 0.999178730293357, 'loss_val': 0.0353526374463778, 'psi': 0.9953860634871705}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=61 head_norm_before_train=2.150417 (no previous merge yet)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.9991772242801019, 'loss_val': 0.04493571309632986, 'psi': 0.9927432258039511}-{'f1_val': 0.9905718417662249, 'auprc': 0.9991714022448567, 'loss_val': 0.03453687291944161, 'psi': 0.9940116659576776}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=2.381938 cos_to_last_merge=0.9906 (last merge round=33)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946281401795195, 'loss_val': 0.031539867570995445, 'psi': 0.9939108809643513}-{'f1_val': 0.9940903254969471, 'auprc': 0.9937282080044458, 'loss_val': 0.030361156970430313, 'psi': 0.9939454784999466}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=2.344744 cos_to_last_merge=0.9990 (last merge round=41)
[S11] round=61 local utility u=0.028517 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986402762179327, 'loss_val': 0.02207750185565903, 'psi': 0.9971485953336203}-{'f1_val': 0.9965919014202035, 'auprc': 0.9967736093356996, 'loss_val': 0.07613764394420669, 'psi': 0.996664584586402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=61 head_norm_before_train=2.024917 (no previous merge yet)
[S13] round=61 local utility u=0.188684 metrics={'f1_val': 0.6335812698928931, 'auprc': 0.6764228208173408, 'loss_val': 1.224349657806522, 'psi': 0.6507178902626722}-{'f1_val': 0.6216137417706835, 'auprc': 0.6388402002963444, 'loss_val': 1.4171636451908876, 'psi': 0.6285043251809479}
[S13] not sending this round → trigger blocked (psi=0.651)
[S14] START round=61 head_norm_before_train=2.330262 cos_to_last_merge=0.9955 (last merge round=32)
[S14] round=61 local utility u=0.000949 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9978680228467748, 'loss_val': 0.018775492770797972, 'psi': 0.9973476370672566}-{'f1_val': 0.9972216920155168, 'auprc': 0.9965926713890343, 'loss_val': 0.018173097626260976, 'psi': 0.9969700837649238}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=61 head_norm_before_train=2.193031 cos_to_last_merge=0.9749 (last merge round=39)
[S15] round=61 local utility u=0.326782 metrics={'f1_val': 0.9916014398168222, 'auprc': 0.9979941618351261, 'loss_val': 0.0333534895954529, 'psi': 0.9941585286241438}-{'f1_val': 0.9110423648777821, 'auprc': 0.996863206967578, 'loss_val': 0.20016960188647742, 'psi': 0.9453707017137005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=61 head_norm_before_train=1.920651 cos_to_last_merge=0.9953 (last merge round=39)
[S16] round=61 local utility u=0.056241 metrics={'f1_val': 0.9918336602395162, 'auprc': 0.993110883484593, 'loss_val': 0.038220337029874735, 'psi': 0.9923445495375469}-{'f1_val': 0.9838797154331861, 'auprc': 0.9863320550070165, 'loss_val': 0.08264312312953873, 'psi': 0.9848606512627183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=61 head_norm_before_train=2.356636 cos_to_last_merge=0.9991 (last merge round=41)
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.8930752176594647, 'auprc': 0.899649616658662, 'loss_val': 0.5821067201699117, 'psi': 0.8957049772591437}-{'f1_val': 0.9086932103827556, 'auprc': 0.9353299111590732, 'loss_val': 0.5353042905685959, 'psi': 0.9193478906932826}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=2.021610 cos_to_last_merge=0.9979 (last merge round=38)
[S2] round=62 local utility u=0.172960 metrics={'f1_val': 0.7330140384644193, 'auprc': 0.7414368640296982, 'loss_val': 0.8215139927627448, 'psi': 0.7363831686905309}-{'f1_val': 0.6922050273337419, 'auprc': 0.846618485342429, 'loss_val': 1.2381247176526926, 'psi': 0.7539704105372167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=62 head_norm_before_train=2.274634 cos_to_last_merge=0.9887 (last merge round=34)
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.9585412103933568, 'auprc': 0.9959303550102829, 'loss_val': 0.10931531451395003, 'psi': 0.9734968682401273}-{'f1_val': 0.9585412103933568, 'auprc': 0.9984389626180181, 'loss_val': 0.08331950196265668, 'psi': 0.9745003112832213}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.893958 cos_to_last_merge=0.9738 (last merge round=34)
[S4] round=62 local utility u=0.007722 metrics={'f1_val': 0.9388244465053935, 'auprc': 0.9511489492984677, 'loss_val': 0.3349169149488343, 'psi': 0.9437542476226233}-{'f1_val': 0.9392347550094323, 'auprc': 0.9458247678246144, 'loss_val': 0.33685109042810707, 'psi': 0.9418707601355052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=62 head_norm_before_train=1.990186 cos_to_last_merge=0.9948 (last merge round=35)
[S5] round=62 local utility u=1.000000 metrics={'f1_val': 0.893015324871713, 'auprc': 0.9747471172056494, 'loss_val': 0.209764912199534, 'psi': 0.9257080418052877}-{'f1_val': 0.60059420404842, 'auprc': 0.8420010083414756, 'loss_val': 0.6323189448837849, 'psi': 0.6971569257656423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=62 head_norm_before_train=2.200606 (no previous merge yet)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.6115710641852206, 'auprc': 0.6850878118948099, 'loss_val': 1.358171772851965, 'psi': 0.6409777632690563}-{'f1_val': 0.8754371040313442, 'auprc': 0.9780717715353382, 'loss_val': 0.2526435739379587, 'psi': 0.9164909710329417}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.732270 cos_to_last_merge=0.9947 (last merge round=40)
[S7] round=62 local utility u=0.118463 metrics={'f1_val': 0.6248917112276484, 'auprc': 0.8007412634760794, 'loss_val': 0.5529615722791322, 'psi': 0.6952315321270208}-{'f1_val': 0.6098056243560137, 'auprc': 0.7913336937517148, 'loss_val': 0.6711486125656638, 'psi': 0.6824168521142941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=62 head_norm_before_train=1.847426 cos_to_last_merge=0.9843 (last merge round=33)
[S8] round=62 local utility u=0.006750 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9979537611437902, 'loss_val': 0.031363281806486454, 'psi': 0.9952659996352444}-{'f1_val': 0.9917662017661685, 'auprc': 0.9990721746487693, 'loss_val': 0.037971083043698894, 'psi': 0.9946885909192088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=62 head_norm_before_train=2.154563 (no previous merge yet)
[S9] round=62 local utility u=0.036727 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9970480594889233, 'loss_val': 0.01698850296056233, 'psi': 0.997080971302855}-{'f1_val': 0.9884538934865174, 'auprc': 0.9991772242801019, 'loss_val': 0.04493571309632986, 'psi': 0.9927432258039511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=62 head_norm_before_train=2.386878 cos_to_last_merge=0.9904 (last merge round=33)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9949417078991558, 'loss_val': 0.03291060295974873, 'psi': 0.9940363080522059}-{'f1_val': 0.9934327081542391, 'auprc': 0.9946281401795195, 'loss_val': 0.031539867570995445, 'psi': 0.9939108809643513}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=2.349156 cos_to_last_merge=0.9989 (last merge round=41)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977619863743888, 'loss_val': 0.022605900100849036, 'psi': 0.9970329972579093}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986402762179327, 'loss_val': 0.02207750185565903, 'psi': 0.9971485953336203}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=2.031000 (no previous merge yet)
[S13] round=62 local utility u=0.398160 metrics={'f1_val': 0.7360642614046201, 'auprc': 0.6990427943218137, 'loss_val': 1.110787746516368, 'psi': 0.7212556745714975}-{'f1_val': 0.6335812698928931, 'auprc': 0.6764228208173408, 'loss_val': 1.224349657806522, 'psi': 0.6507178902626722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=62 head_norm_before_train=2.336410 cos_to_last_merge=0.9953 (last merge round=32)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9965889662156899, 'loss_val': 0.020979752768415662, 'psi': 0.9968208865365418}-{'f1_val': 0.9970007132142444, 'auprc': 0.9978680228467748, 'loss_val': 0.018775492770797972, 'psi': 0.9973476370672566}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=2.203879 cos_to_last_merge=0.9743 (last merge round=39)
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.8744955707018169, 'auprc': 0.9938703390986946, 'loss_val': 0.36160117197971836, 'psi': 0.922245478060568}-{'f1_val': 0.9916014398168222, 'auprc': 0.9979941618351261, 'loss_val': 0.0333534895954529, 'psi': 0.9941585286241438}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=62 head_norm_before_train=1.926941 cos_to_last_merge=0.9951 (last merge round=39)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9921499874340187, 'auprc': 0.9887061191496371, 'loss_val': 0.03790050961409669, 'psi': 0.9907724401202661}-{'f1_val': 0.9918336602395162, 'auprc': 0.993110883484593, 'loss_val': 0.038220337029874735, 'psi': 0.9923445495375469}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=2.365662 cos_to_last_merge=0.9990 (last merge round=41)
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.8501508249842138, 'auprc': 0.9104048082367424, 'loss_val': 0.6980044144404537, 'psi': 0.8742524182852253}-{'f1_val': 0.8930752176594647, 'auprc': 0.899649616658662, 'loss_val': 0.5821067201699117, 'psi': 0.8957049772591437}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=2.025268 cos_to_last_merge=0.9978 (last merge round=38)
[S2] round=63 local utility u=0.249836 metrics={'f1_val': 0.725748525648355, 'auprc': 0.8620425343213174, 'loss_val': 0.6400652358028821, 'psi': 0.7802661291175399}-{'f1_val': 0.7330140384644193, 'auprc': 0.7414368640296982, 'loss_val': 0.8215139927627448, 'psi': 0.7363831686905309}
[S2] not sending this round → trigger blocked (psi=0.780)
[S3] START round=63 head_norm_before_train=2.280240 cos_to_last_merge=0.9883 (last merge round=34)
[S3] round=63 local utility u=0.041622 metrics={'f1_val': 0.9649867466937265, 'auprc': 0.9983262904817356, 'loss_val': 0.07193200359123836, 'psi': 0.9783225642089302}-{'f1_val': 0.9585412103933568, 'auprc': 0.9959303550102829, 'loss_val': 0.10931531451395003, 'psi': 0.9734968682401273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=63 head_norm_before_train=1.905079 cos_to_last_merge=0.9732 (last merge round=34)
[S4] round=63 local utility u=0.031492 metrics={'f1_val': 0.93940188883162, 'auprc': 0.9663528123379898, 'loss_val': 0.3210081669826546, 'psi': 0.9501822582341679}-{'f1_val': 0.9388244465053935, 'auprc': 0.9511489492984677, 'loss_val': 0.3349169149488343, 'psi': 0.9437542476226233}
[S4] not sending this round → trigger blocked (psi=0.950)
[S5] START round=63 head_norm_before_train=1.993444 cos_to_last_merge=0.9946 (last merge round=35)
[S5] round=63 local utility u=0.187425 metrics={'f1_val': 0.9341373762569368, 'auprc': 0.9907806706654676, 'loss_val': 0.129748716882231, 'psi': 0.9567946940203491}-{'f1_val': 0.893015324871713, 'auprc': 0.9747471172056494, 'loss_val': 0.209764912199534, 'psi': 0.9257080418052877}
[S5] not sending this round → trigger blocked (psi=0.957)
[S6] START round=63 head_norm_before_train=2.207303 (no previous merge yet)
[S6] round=63 local utility u=1.000000 metrics={'f1_val': 0.7662245654312676, 'auprc': 0.902331346351529, 'loss_val': 0.7943281435951223, 'psi': 0.8206672777993722}-{'f1_val': 0.6115710641852206, 'auprc': 0.6850878118948099, 'loss_val': 1.358171772851965, 'psi': 0.6409777632690563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=63 head_norm_before_train=1.739169 cos_to_last_merge=0.9943 (last merge round=40)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.4822758910544852, 'auprc': 0.77833435575773, 'loss_val': 1.0406109029870583, 'psi': 0.6006992769357831}-{'f1_val': 0.6248917112276484, 'auprc': 0.8007412634760794, 'loss_val': 0.5529615722791322, 'psi': 0.6952315321270208}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.857174 cos_to_last_merge=0.9837 (last merge round=33)
[S8] round=63 local utility u=0.000000 metrics={'f1_val': 0.9900449566491589, 'auprc': 0.9988109287911038, 'loss_val': 0.04111095497489735, 'psi': 0.9935513455059368}-{'f1_val': 0.9934741586295472, 'auprc': 0.9979537611437902, 'loss_val': 0.031363281806486454, 'psi': 0.9952659996352444}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=63 head_norm_before_train=2.160164 (no previous merge yet)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9931032914010764, 'auprc': 0.9991798102928754, 'loss_val': 0.025040326649440253, 'psi': 0.995533898957796}-{'f1_val': 0.9971029125121428, 'auprc': 0.9970480594889233, 'loss_val': 0.01698850296056233, 'psi': 0.997080971302855}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.391121 cos_to_last_merge=0.9901 (last merge round=33)
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9944604890443363, 'loss_val': 0.03175352621963716, 'psi': 0.993843820510278}-{'f1_val': 0.9934327081542391, 'auprc': 0.9949417078991558, 'loss_val': 0.03291060295974873, 'psi': 0.9940363080522059}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=2.355376 cos_to_last_merge=0.9988 (last merge round=41)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977887239723578, 'loss_val': 0.023205541201821757, 'psi': 0.9967956945369287}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977619863743888, 'loss_val': 0.022605900100849036, 'psi': 0.9970329972579093}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=2.033864 (no previous merge yet)
[S13] round=63 local utility u=0.298221 metrics={'f1_val': 0.7526665120589915, 'auprc': 0.7886633108929529, 'loss_val': 0.8828199405441435, 'psi': 0.7670652315925761}-{'f1_val': 0.7360642614046201, 'auprc': 0.6990427943218137, 'loss_val': 1.110787746516368, 'psi': 0.7212556745714975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=63 head_norm_before_train=2.340339 cos_to_last_merge=0.9952 (last merge round=32)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9584713196399335, 'auprc': 0.9959609500728612, 'loss_val': 0.07075640984153879, 'psi': 0.9734671718131045}-{'f1_val': 0.9969755000837764, 'auprc': 0.9965889662156899, 'loss_val': 0.020979752768415662, 'psi': 0.9968208865365418}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=2.208771 cos_to_last_merge=0.9739 (last merge round=39)
[S15] round=63 local utility u=0.207512 metrics={'f1_val': 0.9132496409136939, 'auprc': 0.9965434437692455, 'loss_val': 0.18712001254199845, 'psi': 0.9465671620559145}-{'f1_val': 0.8744955707018169, 'auprc': 0.9938703390986946, 'loss_val': 0.36160117197971836, 'psi': 0.922245478060568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=63 head_norm_before_train=1.934419 cos_to_last_merge=0.9949 (last merge round=39)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9916896401193674, 'auprc': 0.988146701729369, 'loss_val': 0.04350724050791106, 'psi': 0.990272464763368}-{'f1_val': 0.9921499874340187, 'auprc': 0.9887061191496371, 'loss_val': 0.03790050961409669, 'psi': 0.9907724401202661}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=2.375437 cos_to_last_merge=0.9988 (last merge round=41)
[S17] round=63 local utility u=0.082494 metrics={'f1_val': 0.8909524555571112, 'auprc': 0.8518252382718361, 'loss_val': 0.6020874797538118, 'psi': 0.8753015686430011}-{'f1_val': 0.8501508249842138, 'auprc': 0.9104048082367424, 'loss_val': 0.6980044144404537, 'psi': 0.8742524182852253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=64 head_norm_before_train=2.028588 cos_to_last_merge=0.9977 (last merge round=38)
[S2] round=64 local utility u=0.497694 metrics={'f1_val': 0.8193545148829928, 'auprc': 0.9440304955805972, 'loss_val': 0.4522767384621152, 'psi': 0.8692249071620346}-{'f1_val': 0.725748525648355, 'auprc': 0.8620425343213174, 'loss_val': 0.6400652358028821, 'psi': 0.7802661291175399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=64 head_norm_before_train=2.286859 cos_to_last_merge=0.9879 (last merge round=34)
[S3] round=64 local utility u=0.099185 metrics={'f1_val': 0.9906608525386806, 'auprc': 0.9998303684690684, 'loss_val': 0.032119376199099346, 'psi': 0.9943286589108358}-{'f1_val': 0.9649867466937265, 'auprc': 0.9983262904817356, 'loss_val': 0.07193200359123836, 'psi': 0.9783225642089302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] START round=64 head_norm_before_train=1.914637 cos_to_last_merge=0.9729 (last merge round=34)
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9374874063264701, 'auprc': 0.9496821148971031, 'loss_val': 0.32568859184050003, 'psi': 0.9423652897547232}-{'f1_val': 0.93940188883162, 'auprc': 0.9663528123379898, 'loss_val': 0.3210081669826546, 'psi': 0.9501822582341679}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.997758 cos_to_last_merge=0.9943 (last merge round=35)
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.6940368954332702, 'auprc': 0.8707969772615421, 'loss_val': 0.4122327328911976, 'psi': 0.764740928164579}-{'f1_val': 0.9341373762569368, 'auprc': 0.9907806706654676, 'loss_val': 0.129748716882231, 'psi': 0.9567946940203491}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=2.213392 (no previous merge yet)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.6224080621866893, 'auprc': 0.7920612108362797, 'loss_val': 1.1184666684972444, 'psi': 0.6902693216465254}-{'f1_val': 0.7662245654312676, 'auprc': 0.902331346351529, 'loss_val': 0.7943281435951223, 'psi': 0.8206672777993722}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.745769 cos_to_last_merge=0.9939 (last merge round=40)
[S7] round=64 local utility u=1.000000 metrics={'f1_val': 0.7264587378857564, 'auprc': 0.8580505512336117, 'loss_val': 0.2710551719704338, 'psi': 0.7790954632248985}-{'f1_val': 0.4822758910544852, 'auprc': 0.77833435575773, 'loss_val': 1.0406109029870583, 'psi': 0.6006992769357831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=64 head_norm_before_train=1.865270 cos_to_last_merge=0.9834 (last merge round=33)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.8262189789162142, 'auprc': 0.9694793846352976, 'loss_val': 0.5791369640991318, 'psi': 0.8835231412038476}-{'f1_val': 0.9900449566491589, 'auprc': 0.9988109287911038, 'loss_val': 0.04111095497489735, 'psi': 0.9935513455059368}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=2.166261 (no previous merge yet)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.9991777547993175, 'loss_val': 0.04413071743964571, 'psi': 0.9927434380116373}-{'f1_val': 0.9931032914010764, 'auprc': 0.9991798102928754, 'loss_val': 0.025040326649440253, 'psi': 0.995533898957796}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.395875 cos_to_last_merge=0.9899 (last merge round=33)
[S10] round=64 local utility u=0.000312 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9948061853668261, 'loss_val': 0.03216597710444117, 'psi': 0.9939820990392739}-{'f1_val': 0.9934327081542391, 'auprc': 0.9944604890443363, 'loss_val': 0.03175352621963716, 'psi': 0.993843820510278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=64 head_norm_before_train=2.355225 cos_to_last_merge=0.9987 (last merge round=41)
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9944515898650941, 'auprc': 0.9979683805682268, 'loss_val': 0.025731297480349604, 'psi': 0.9958583061463472}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977887239723578, 'loss_val': 0.023205541201821757, 'psi': 0.9967956945369287}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=2.043076 (no previous merge yet)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.7508083050939358, 'auprc': 0.776950828061943, 'loss_val': 0.8801068705955711, 'psi': 0.7612653142811387}-{'f1_val': 0.7526665120589915, 'auprc': 0.7886633108929529, 'loss_val': 0.8828199405441435, 'psi': 0.7670652315925761}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=2.341228 cos_to_last_merge=0.9953 (last merge round=32)
[S14] round=64 local utility u=0.139608 metrics={'f1_val': 0.9961612027526012, 'auprc': 0.9966274058682227, 'loss_val': 0.019678433162319833, 'psi': 0.9963476839988499}-{'f1_val': 0.9584713196399335, 'auprc': 0.9959609500728612, 'loss_val': 0.07075640984153879, 'psi': 0.9734671718131045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=64 head_norm_before_train=2.215731 cos_to_last_merge=0.9734 (last merge round=39)
[S15] round=64 local utility u=0.251930 metrics={'f1_val': 0.9740497817263074, 'auprc': 0.9972014916117642, 'loss_val': 0.05003573575973396, 'psi': 0.9833104656804901}-{'f1_val': 0.9132496409136939, 'auprc': 0.9965434437692455, 'loss_val': 0.18712001254199845, 'psi': 0.9465671620559145}
[S15] not sending this round → trigger blocked (psi=0.983)
[S16] START round=64 head_norm_before_train=1.939691 cos_to_last_merge=0.9947 (last merge round=39)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.9896743045333698, 'auprc': 0.987722658519492, 'loss_val': 0.05687248279230788, 'psi': 0.9888936461278187}-{'f1_val': 0.9916896401193674, 'auprc': 0.988146701729369, 'loss_val': 0.04350724050791106, 'psi': 0.990272464763368}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=2.377537 cos_to_last_merge=0.9988 (last merge round=41)
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.6486052162516283, 'auprc': 0.9405362496638949, 'loss_val': 1.5191757750417307, 'psi': 0.7653776296165349}-{'f1_val': 0.8909524555571112, 'auprc': 0.8518252382718361, 'loss_val': 0.6020874797538118, 'psi': 0.8753015686430011}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=2.037076 cos_to_last_merge=0.9976 (last merge round=38)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.8027510873965142, 'auprc': 0.9043625474929524, 'loss_val': 0.5014747839400031, 'psi': 0.8433956714350894}-{'f1_val': 0.8193545148829928, 'auprc': 0.9440304955805972, 'loss_val': 0.4522767384621152, 'psi': 0.8692249071620346}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=65 head_norm_before_train=2.293710 cos_to_last_merge=0.9875 (last merge round=34)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.9477322413998266, 'auprc': 0.9836612301626051, 'loss_val': 0.15343466529479147, 'psi': 0.9621038369049381}-{'f1_val': 0.9906608525386806, 'auprc': 0.9998303684690684, 'loss_val': 0.032119376199099346, 'psi': 0.9943286589108358}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.913741 cos_to_last_merge=0.9721 (last merge round=34)
[S4] round=65 local utility u=0.067275 metrics={'f1_val': 0.9423560463616135, 'auprc': 0.9780731563879276, 'loss_val': 0.305523608192183, 'psi': 0.9566428903721391}-{'f1_val': 0.9374874063264701, 'auprc': 0.9496821148971031, 'loss_val': 0.32568859184050003, 'psi': 0.9423652897547232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=65 head_norm_before_train=2.000346 cos_to_last_merge=0.9941 (last merge round=35)
[S5] round=65 local utility u=0.748510 metrics={'f1_val': 0.842815011561135, 'auprc': 0.9899180460064965, 'loss_val': 0.16524555193103485, 'psi': 0.9016562253392796}-{'f1_val': 0.6940368954332702, 'auprc': 0.8707969772615421, 'loss_val': 0.4122327328911976, 'psi': 0.764740928164579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=65 head_norm_before_train=2.221700 (no previous merge yet)
[S6] round=65 local utility u=1.000000 metrics={'f1_val': 0.806590441399058, 'auprc': 0.9578595061099427, 'loss_val': 0.4160760658316001, 'psi': 0.8670980672834119}-{'f1_val': 0.6224080621866893, 'auprc': 0.7920612108362797, 'loss_val': 1.1184666684972444, 'psi': 0.6902693216465254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=65 head_norm_before_train=1.750831 cos_to_last_merge=0.9936 (last merge round=40)
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.5381947695596361, 'auprc': 0.7802489270310935, 'loss_val': 0.8642273801224662, 'psi': 0.635016432548219}-{'f1_val': 0.7264587378857564, 'auprc': 0.8580505512336117, 'loss_val': 0.2710551719704338, 'psi': 0.7790954632248985}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=1.867779 cos_to_last_merge=0.9830 (last merge round=33)
[S8] round=65 local utility u=0.819170 metrics={'f1_val': 0.9932955872009759, 'auprc': 0.998845536215641, 'loss_val': 0.03135559031756385, 'psi': 0.9955155668068418}-{'f1_val': 0.8262189789162142, 'auprc': 0.9694793846352976, 'loss_val': 0.5791369640991318, 'psi': 0.8835231412038476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=65 head_norm_before_train=2.172725 (no previous merge yet)
[S9] round=65 local utility u=0.030203 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9947945722405956, 'loss_val': 0.017353089005987206, 'psi': 0.9956678857638048}-{'f1_val': 0.9884538934865174, 'auprc': 0.9991777547993175, 'loss_val': 0.04413071743964571, 'psi': 0.9927434380116373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=65 head_norm_before_train=2.401896 cos_to_last_merge=0.9896 (last merge round=33)
[S10] round=65 local utility u=0.000023 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9949414351443606, 'loss_val': 0.03252528954610235, 'psi': 0.9940361989502877}-{'f1_val': 0.9934327081542391, 'auprc': 0.9948061853668261, 'loss_val': 0.03216597710444117, 'psi': 0.9939820990392739}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=65 head_norm_before_train=2.356233 cos_to_last_merge=0.9986 (last merge round=41)
[S11] round=65 local utility u=0.006863 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978963318756318, 'loss_val': 0.021882195495389604, 'psi': 0.9968387376982383}-{'f1_val': 0.9944515898650941, 'auprc': 0.9979683805682268, 'loss_val': 0.025731297480349604, 'psi': 0.9958583061463472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=65 head_norm_before_train=2.055881 (no previous merge yet)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.6844049854498475, 'auprc': 0.7760897409280504, 'loss_val': 1.1685593295367909, 'psi': 0.7210788876411287}-{'f1_val': 0.7508083050939358, 'auprc': 0.776950828061943, 'loss_val': 0.8801068705955711, 'psi': 0.7612653142811387}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=2.342523 cos_to_last_merge=0.9952 (last merge round=32)
[S14] round=65 local utility u=0.007065 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9987253635402497, 'loss_val': 0.016864797545671863, 'psi': 0.9976890306873356}-{'f1_val': 0.9961612027526012, 'auprc': 0.9966274058682227, 'loss_val': 0.019678433162319833, 'psi': 0.9963476839988499}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=65 head_norm_before_train=2.224657 cos_to_last_merge=0.9729 (last merge round=39)
[S15] round=65 local utility u=0.003496 metrics={'f1_val': 0.9749359206565009, 'auprc': 0.9973051759167386, 'loss_val': 0.048670888072261886, 'psi': 0.983883622760596}-{'f1_val': 0.9740497817263074, 'auprc': 0.9972014916117642, 'loss_val': 0.05003573575973396, 'psi': 0.9833104656804901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=65 head_norm_before_train=1.946549 cos_to_last_merge=0.9944 (last merge round=39)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9892374588407103, 'auprc': 0.9879613050611888, 'loss_val': 0.057049868511233684, 'psi': 0.9887269973289017}-{'f1_val': 0.9896743045333698, 'auprc': 0.987722658519492, 'loss_val': 0.05687248279230788, 'psi': 0.9888936461278187}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=2.381119 cos_to_last_merge=0.9988 (last merge round=41)
[S17] round=65 local utility u=1.000000 metrics={'f1_val': 0.8993356452803036, 'auprc': 0.9034879808813996, 'loss_val': 0.5648027421320272, 'psi': 0.900996579520742}-{'f1_val': 0.6486052162516283, 'auprc': 0.9405362496638949, 'loss_val': 1.5191757750417307, 'psi': 0.7653776296165349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=66 head_norm_before_train=2.040201 cos_to_last_merge=0.9973 (last merge round=38)
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.7873208323332878, 'auprc': 0.892287466978569, 'loss_val': 0.5770196599727027, 'psi': 0.8293074861914003}-{'f1_val': 0.8027510873965142, 'auprc': 0.9043625474929524, 'loss_val': 0.5014747839400031, 'psi': 0.8433956714350894}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=66 head_norm_before_train=2.300541 cos_to_last_merge=0.9870 (last merge round=34)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.8728753935915944, 'auprc': 0.9856555180700908, 'loss_val': 0.3120084045660673, 'psi': 0.9179874433829929}-{'f1_val': 0.9477322413998266, 'auprc': 0.9836612301626051, 'loss_val': 0.15343466529479147, 'psi': 0.9621038369049381}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=1.902199 cos_to_last_merge=0.9726 (last merge round=34)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9396689136237938, 'auprc': 0.9500216085117092, 'loss_val': 0.31734553088461925, 'psi': 0.94380999157896}-{'f1_val': 0.9423560463616135, 'auprc': 0.9780731563879276, 'loss_val': 0.305523608192183, 'psi': 0.9566428903721391}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=2.002435 cos_to_last_merge=0.9939 (last merge round=35)
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.6510669242207269, 'auprc': 0.862356036189996, 'loss_val': 0.4767344048674734, 'psi': 0.7355825690084346}-{'f1_val': 0.842815011561135, 'auprc': 0.9899180460064965, 'loss_val': 0.16524555193103485, 'psi': 0.9016562253392796}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=66 head_norm_before_train=2.228551 (no previous merge yet)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.6583090050661173, 'auprc': 0.917573049684175, 'loss_val': 0.8890773586187758, 'psi': 0.7620146229133404}-{'f1_val': 0.806590441399058, 'auprc': 0.9578595061099427, 'loss_val': 0.4160760658316001, 'psi': 0.8670980672834119}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.754365 cos_to_last_merge=0.9934 (last merge round=40)
[S7] round=66 local utility u=0.565976 metrics={'f1_val': 0.6498054464477226, 'auprc': 0.8048574405441096, 'loss_val': 0.4757649720032866, 'psi': 0.7118262440862775}-{'f1_val': 0.5381947695596361, 'auprc': 0.7802489270310935, 'loss_val': 0.8642273801224662, 'psi': 0.635016432548219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=66 head_norm_before_train=1.872025 cos_to_last_merge=0.9827 (last merge round=33)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.803587225084192, 'auprc': 0.9928700235295287, 'loss_val': 0.7394967642765167, 'psi': 0.8793003444623266}-{'f1_val': 0.9932955872009759, 'auprc': 0.998845536215641, 'loss_val': 0.03135559031756385, 'psi': 0.9955155668068418}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=2.177344 (no previous merge yet)
[S9] round=66 local utility u=0.007335 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9974482818719151, 'loss_val': 0.01576014109487726, 'psi': 0.9972410602560517}-{'f1_val': 0.9962500947792776, 'auprc': 0.9947945722405956, 'loss_val': 0.017353089005987206, 'psi': 0.9956678857638048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=66 head_norm_before_train=2.408273 cos_to_last_merge=0.9893 (last merge round=33)
[S10] round=66 local utility u=0.000100 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9948546337329756, 'loss_val': 0.03206410518948074, 'psi': 0.9940014783857337}-{'f1_val': 0.9934327081542391, 'auprc': 0.9949414351443606, 'loss_val': 0.03252528954610235, 'psi': 0.9940361989502877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=66 head_norm_before_train=2.360061 cos_to_last_merge=0.9985 (last merge round=41)
[S11] round=66 local utility u=0.000664 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997808167667003, 'loss_val': 0.022770363906832347, 'psi': 0.997051469774955}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978963318756318, 'loss_val': 0.021882195495389604, 'psi': 0.9968387376982383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=66 head_norm_before_train=2.066931 (no previous merge yet)
[S13] round=66 local utility u=0.229461 metrics={'f1_val': 0.7283290850467614, 'auprc': 0.8046081353096993, 'loss_val': 1.058737677230831, 'psi': 0.7588407051519366}-{'f1_val': 0.6844049854498475, 'auprc': 0.7760897409280504, 'loss_val': 1.1685593295367909, 'psi': 0.7210788876411287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=66 head_norm_before_train=2.346361 cos_to_last_merge=0.9951 (last merge round=32)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9970090079011555, 'loss_val': 0.016829115396225985, 'psi': 0.9970024884316979}-{'f1_val': 0.9969981421187261, 'auprc': 0.9987253635402497, 'loss_val': 0.016864797545671863, 'psi': 0.9976890306873356}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=2.234223 cos_to_last_merge=0.9723 (last merge round=39)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9673215186055643, 'auprc': 0.9972339726163244, 'loss_val': 0.0633695837098918, 'psi': 0.9792865002098683}-{'f1_val': 0.9749359206565009, 'auprc': 0.9973051759167386, 'loss_val': 0.048670888072261886, 'psi': 0.983883622760596}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=1.953957 cos_to_last_merge=0.9942 (last merge round=39)
[S16] round=66 local utility u=0.016498 metrics={'f1_val': 0.9921054438842623, 'auprc': 0.9885533788121361, 'loss_val': 0.043038403196520886, 'psi': 0.9906846178554118}-{'f1_val': 0.9892374588407103, 'auprc': 0.9879613050611888, 'loss_val': 0.057049868511233684, 'psi': 0.9887269973289017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=66 head_norm_before_train=2.385386 cos_to_last_merge=0.9987 (last merge round=41)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.6757656022197545, 'auprc': 0.9272881721136771, 'loss_val': 1.4193220802504054, 'psi': 0.7763746301773236}-{'f1_val': 0.8993356452803036, 'auprc': 0.9034879808813996, 'loss_val': 0.5648027421320272, 'psi': 0.900996579520742}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=2.047268 cos_to_last_merge=0.9971 (last merge round=38)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.6845939332436108, 'auprc': 0.7414559446466591, 'loss_val': 1.3443776699880354, 'psi': 0.7073387378048301}-{'f1_val': 0.7873208323332878, 'auprc': 0.892287466978569, 'loss_val': 0.5770196599727027, 'psi': 0.8293074861914003}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.306666 cos_to_last_merge=0.9867 (last merge round=34)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.7285063629578916, 'auprc': 0.9226821000159022, 'loss_val': 0.9481796624101108, 'psi': 0.8061766577810958}-{'f1_val': 0.8728753935915944, 'auprc': 0.9856555180700908, 'loss_val': 0.3120084045660673, 'psi': 0.9179874433829929}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.902006 cos_to_last_merge=0.9726 (last merge round=34)
[S4] round=67 local utility u=0.061976 metrics={'f1_val': 0.9537011718216251, 'auprc': 0.9610877678467226, 'loss_val': 0.31078491270887304, 'psi': 0.956655810231664}-{'f1_val': 0.9396689136237938, 'auprc': 0.9500216085117092, 'loss_val': 0.31734553088461925, 'psi': 0.94380999157896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=67 head_norm_before_train=2.001637 cos_to_last_merge=0.9939 (last merge round=35)
[S5] round=67 local utility u=1.000000 metrics={'f1_val': 0.9465133068198723, 'auprc': 0.9918193593411695, 'loss_val': 0.1295798584359627, 'psi': 0.9646357278283911}-{'f1_val': 0.6510669242207269, 'auprc': 0.862356036189996, 'loss_val': 0.4767344048674734, 'psi': 0.7355825690084346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=67 head_norm_before_train=2.238318 (no previous merge yet)
[S6] round=67 local utility u=0.068081 metrics={'f1_val': 0.6976999329296293, 'auprc': 0.8964978539954402, 'loss_val': 0.9260356341835674, 'psi': 0.7772191013559537}-{'f1_val': 0.6583090050661173, 'auprc': 0.917573049684175, 'loss_val': 0.8890773586187758, 'psi': 0.7620146229133404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=67 head_norm_before_train=1.757704 cos_to_last_merge=0.9932 (last merge round=40)
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.5552277303696043, 'auprc': 0.7792287520081095, 'loss_val': 0.9314060544905255, 'psi': 0.6448281390250064}-{'f1_val': 0.6498054464477226, 'auprc': 0.8048574405441096, 'loss_val': 0.4757649720032866, 'psi': 0.7118262440862775}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=1.878111 cos_to_last_merge=0.9823 (last merge round=33)
[S8] round=67 local utility u=0.765785 metrics={'f1_val': 0.9519603702178202, 'auprc': 0.9907125259519332, 'loss_val': 0.09169223055999305, 'psi': 0.9674612325114653}-{'f1_val': 0.803587225084192, 'auprc': 0.9928700235295287, 'loss_val': 0.7394967642765167, 'psi': 0.8793003444623266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=67 head_norm_before_train=2.181262 (no previous merge yet)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9611985016676909, 'auprc': 0.9992148588162847, 'loss_val': 0.09445910693586872, 'psi': 0.9764050445271284}-{'f1_val': 0.9971029125121428, 'auprc': 0.9974482818719151, 'loss_val': 0.01576014109487726, 'psi': 0.9972410602560517}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=2.414610 cos_to_last_merge=0.9890 (last merge round=33)
[S10] round=67 local utility u=0.000460 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9938515175602383, 'loss_val': 0.030765758157648704, 'psi': 0.9938632346544223}-{'f1_val': 0.9934327081542391, 'auprc': 0.9948546337329756, 'loss_val': 0.03206410518948074, 'psi': 0.9940014783857337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=67 head_norm_before_train=2.365301 cos_to_last_merge=0.9985 (last merge round=41)
[S11] round=67 local utility u=0.000248 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978219314875559, 'loss_val': 0.022316128428417018, 'psi': 0.9970569753031762}-{'f1_val': 0.9965470045135896, 'auprc': 0.997808167667003, 'loss_val': 0.022770363906832347, 'psi': 0.997051469774955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] sending update (kind=head size=1789 to 1 peers)
[S13] START round=67 head_norm_before_train=2.078942 (no previous merge yet)
[S13] round=67 local utility u=0.020551 metrics={'f1_val': 0.7452243869380644, 'auprc': 0.7715440414605262, 'loss_val': 1.0198156587200726, 'psi': 0.7557522487470492}-{'f1_val': 0.7283290850467614, 'auprc': 0.8046081353096993, 'loss_val': 1.058737677230831, 'psi': 0.7588407051519366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=67 head_norm_before_train=2.349602 cos_to_last_merge=0.9948 (last merge round=32)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9775421089557721, 'auprc': 0.9985844511552302, 'loss_val': 0.08217170587692843, 'psi': 0.9859590458355554}-{'f1_val': 0.9969981421187261, 'auprc': 0.9970090079011555, 'loss_val': 0.016829115396225985, 'psi': 0.9970024884316979}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=2.243615 cos_to_last_merge=0.9718 (last merge round=39)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.953871728073497, 'auprc': 0.9971019742980755, 'loss_val': 0.09103929316346875, 'psi': 0.9711638265633283}-{'f1_val': 0.9673215186055643, 'auprc': 0.9972339726163244, 'loss_val': 0.0633695837098918, 'psi': 0.9792865002098683}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.961594 cos_to_last_merge=0.9940 (last merge round=39)
[S16] round=67 local utility u=0.005433 metrics={'f1_val': 0.9916929025601469, 'auprc': 0.9916612136114652, 'loss_val': 0.03901973394049011, 'psi': 0.9916802269806742}-{'f1_val': 0.9921054438842623, 'auprc': 0.9885533788121361, 'loss_val': 0.043038403196520886, 'psi': 0.9906846178554118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=67 head_norm_before_train=2.388501 cos_to_last_merge=0.9987 (last merge round=41)
[S17] round=67 local utility u=1.000000 metrics={'f1_val': 0.895861181431296, 'auprc': 0.8820629590531159, 'loss_val': 0.5847966003208622, 'psi': 0.8903418924800239}-{'f1_val': 0.6757656022197545, 'auprc': 0.9272881721136771, 'loss_val': 1.4193220802504054, 'psi': 0.7763746301773236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=68 head_norm_before_train=2.055419 cos_to_last_merge=0.9970 (last merge round=38)
[S2] round=68 local utility u=1.000000 metrics={'f1_val': 0.8234409636651544, 'auprc': 0.9400898278080623, 'loss_val': 0.4376912117066421, 'psi': 0.8701005093223175}-{'f1_val': 0.6845939332436108, 'auprc': 0.7414559446466591, 'loss_val': 1.3443776699880354, 'psi': 0.7073387378048301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=68 head_norm_before_train=2.310462 cos_to_last_merge=0.9864 (last merge round=34)
[S3] round=68 local utility u=0.480457 metrics={'f1_val': 0.8101650902931643, 'auprc': 0.9746784177566084, 'loss_val': 0.6332060772350848, 'psi': 0.875970421278542}-{'f1_val': 0.7285063629578916, 'auprc': 0.9226821000159022, 'loss_val': 0.9481796624101108, 'psi': 0.8061766577810958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=68 head_norm_before_train=1.903253 cos_to_last_merge=0.9718 (last merge round=34)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9389749545935838, 'auprc': 0.9484218091510201, 'loss_val': 0.3508697770467388, 'psi': 0.9427536964165584}-{'f1_val': 0.9537011718216251, 'auprc': 0.9610877678467226, 'loss_val': 0.31078491270887304, 'psi': 0.956655810231664}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=2.000309 cos_to_last_merge=0.9939 (last merge round=35)
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.5719775452892042, 'auprc': 0.8407816695725666, 'loss_val': 0.7510752738172859, 'psi': 0.6794991950025492}-{'f1_val': 0.9465133068198723, 'auprc': 0.9918193593411695, 'loss_val': 0.1295798584359627, 'psi': 0.9646357278283911}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=2.249943 (no previous merge yet)
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.6222777473632877, 'auprc': 0.8317823116233855, 'loss_val': 1.2454362189513335, 'psi': 0.7060795730673268}-{'f1_val': 0.6976999329296293, 'auprc': 0.8964978539954402, 'loss_val': 0.9260356341835674, 'psi': 0.7772191013559537}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.760211 cos_to_last_merge=0.9930 (last merge round=40)
[S7] round=68 local utility u=0.281451 metrics={'f1_val': 0.6082077924447487, 'auprc': 0.7886255363213082, 'loss_val': 0.7145738610991884, 'psi': 0.6803748899953725}-{'f1_val': 0.5552277303696043, 'auprc': 0.7792287520081095, 'loss_val': 0.9314060544905255, 'psi': 0.6448281390250064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=68 head_norm_before_train=1.876866 cos_to_last_merge=0.9817 (last merge round=33)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.7796836113718889, 'auprc': 0.9898194223040988, 'loss_val': 0.7570750982133749, 'psi': 0.8637379357447729}-{'f1_val': 0.9519603702178202, 'auprc': 0.9907125259519332, 'loss_val': 0.09169223055999305, 'psi': 0.9674612325114653}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=2.182571 (no previous merge yet)
[S9] round=68 local utility u=0.144712 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978684384274416, 'loss_val': 0.016421977425426403, 'psi': 0.9974091228782623}-{'f1_val': 0.9611985016676909, 'auprc': 0.9992148588162847, 'loss_val': 0.09445910693586872, 'psi': 0.9764050445271284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=68 head_norm_before_train=2.418161 cos_to_last_merge=0.9888 (last merge round=33)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9949237494762073, 'loss_val': 0.03283175031223106, 'psi': 0.9940291246830264}-{'f1_val': 0.993871046050545, 'auprc': 0.9938515175602383, 'loss_val': 0.030765758157648704, 'psi': 0.9938632346544223}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=2.371159 cos_to_last_merge=0.9984 (last merge round=41)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9834836955164087, 'auprc': 0.9976993608489523, 'loss_val': 0.06776100300945224, 'psi': 0.9891699616494262}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978219314875559, 'loss_val': 0.022316128428417018, 'psi': 0.9970569753031762}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=2.090885 (no previous merge yet)
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6695294474820803, 'auprc': 0.7688213104418491, 'loss_val': 0.9935147983935341, 'psi': 0.7092461926659879}-{'f1_val': 0.7452243869380644, 'auprc': 0.7715440414605262, 'loss_val': 1.0198156587200726, 'psi': 0.7557522487470492}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=2.352257 cos_to_last_merge=0.9947 (last merge round=32)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9551429685540037, 'auprc': 0.9981166247722049, 'loss_val': 0.11898007382373232, 'psi': 0.9723324310412842}-{'f1_val': 0.9775421089557721, 'auprc': 0.9985844511552302, 'loss_val': 0.08217170587692843, 'psi': 0.9859590458355554}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=2.252989 cos_to_last_merge=0.9713 (last merge round=39)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.9427456625438181, 'auprc': 0.9970357247710828, 'loss_val': 0.10504407746359973, 'psi': 0.9644616874347239}-{'f1_val': 0.953871728073497, 'auprc': 0.9971019742980755, 'loss_val': 0.09103929316346875, 'psi': 0.9711638265633283}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=1.966926 cos_to_last_merge=0.9938 (last merge round=39)
[S16] round=68 local utility u=0.002897 metrics={'f1_val': 0.9921553304731932, 'auprc': 0.9920615718706719, 'loss_val': 0.037202286222814546, 'psi': 0.9921178270321847}-{'f1_val': 0.9916929025601469, 'auprc': 0.9916612136114652, 'loss_val': 0.03901973394049011, 'psi': 0.9916802269806742}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=68 head_norm_before_train=2.392084 cos_to_last_merge=0.9986 (last merge round=41)
[S17] round=68 local utility u=0.063521 metrics={'f1_val': 0.902260523382739, 'auprc': 0.9056176562980556, 'loss_val': 0.5668153001911455, 'psi': 0.9036033765488656}-{'f1_val': 0.895861181431296, 'auprc': 0.8820629590531159, 'loss_val': 0.5847966003208622, 'psi': 0.8903418924800239}
[S17] not sending this round → trigger blocked (psi=0.904)
[S2] START round=69 head_norm_before_train=2.063205 cos_to_last_merge=0.9969 (last merge round=38)
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.5678314387400201, 'auprc': 0.8035905430472245, 'loss_val': 2.207484611462017, 'psi': 0.6621350804629018}-{'f1_val': 0.8234409636651544, 'auprc': 0.9400898278080623, 'loss_val': 0.4376912117066421, 'psi': 0.8701005093223175}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.314560 cos_to_last_merge=0.9861 (last merge round=34)
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.7860633222111442, 'auprc': 0.95902222916107, 'loss_val': 0.6554751456019037, 'psi': 0.8552468849911146}-{'f1_val': 0.8101650902931643, 'auprc': 0.9746784177566084, 'loss_val': 0.6332060772350848, 'psi': 0.875970421278542}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=1.908267 cos_to_last_merge=0.9714 (last merge round=34)
[S4] round=69 local utility u=0.002260 metrics={'f1_val': 0.9384499105956409, 'auprc': 0.9462836112085535, 'loss_val': 0.33678556807678856, 'psi': 0.941583390840806}-{'f1_val': 0.9389749545935838, 'auprc': 0.9484218091510201, 'loss_val': 0.3508697770467388, 'psi': 0.9427536964165584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=69 head_norm_before_train=2.000263 cos_to_last_merge=0.9938 (last merge round=35)
[S5] round=69 local utility u=1.000000 metrics={'f1_val': 0.742773376517904, 'auprc': 0.9891408655678703, 'loss_val': 0.1887565333586718, 'psi': 0.8413203721378906}-{'f1_val': 0.5719775452892042, 'auprc': 0.8407816695725666, 'loss_val': 0.7510752738172859, 'psi': 0.6794991950025492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=69 head_norm_before_train=2.255803 (no previous merge yet)
[S6] round=69 local utility u=0.585449 metrics={'f1_val': 0.7416951371325985, 'auprc': 0.8273737311169294, 'loss_val': 0.7778171549397978, 'psi': 0.7759665747263309}-{'f1_val': 0.6222777473632877, 'auprc': 0.8317823116233855, 'loss_val': 1.2454362189513335, 'psi': 0.7060795730673268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=69 head_norm_before_train=1.763680 cos_to_last_merge=0.9928 (last merge round=40)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.5519705610396053, 'auprc': 0.7825205166827265, 'loss_val': 0.8649713209719827, 'psi': 0.6441905432968538}-{'f1_val': 0.6082077924447487, 'auprc': 0.7886255363213082, 'loss_val': 0.7145738610991884, 'psi': 0.6803748899953725}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=1.879484 cos_to_last_merge=0.9814 (last merge round=33)
[S8] round=69 local utility u=1.000000 metrics={'f1_val': 0.993663382622812, 'auprc': 0.9986687278758578, 'loss_val': 0.0331474262426219, 'psi': 0.9956655207240304}-{'f1_val': 0.7796836113718889, 'auprc': 0.9898194223040988, 'loss_val': 0.7570750982133749, 'psi': 0.8637379357447729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=69 head_norm_before_train=2.184812 (no previous merge yet)
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9944971465375515, 'loss_val': 0.018102555766572395, 'psi': 0.9958143533738779}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978684384274416, 'loss_val': 0.016421977425426403, 'psi': 0.9974091228782623}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=2.422734 cos_to_last_merge=0.9885 (last merge round=33)
[S10] round=69 local utility u=0.000060 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.994730544266049, 'loss_val': 0.03213185721103761, 'psi': 0.9939518425989631}-{'f1_val': 0.9934327081542391, 'auprc': 0.9949237494762073, 'loss_val': 0.03283175031223106, 'psi': 0.9940291246830264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=69 head_norm_before_train=2.376994 cos_to_last_merge=0.9983 (last merge round=41)
[S11] round=69 local utility u=0.062223 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979354471075574, 'loss_val': 0.02240262671106756, 'psi': 0.9971023815511767}-{'f1_val': 0.9834836955164087, 'auprc': 0.9976993608489523, 'loss_val': 0.06776100300945224, 'psi': 0.9891699616494262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=69 head_norm_before_train=2.097305 (no previous merge yet)
[S13] round=69 local utility u=0.143070 metrics={'f1_val': 0.7360766028813539, 'auprc': 0.7740319829289216, 'loss_val': 1.1222892459523197, 'psi': 0.751258754900381}-{'f1_val': 0.6695294474820803, 'auprc': 0.7688213104418491, 'loss_val': 0.9935147983935341, 'psi': 0.7092461926659879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=69 head_norm_before_train=2.356671 cos_to_last_merge=0.9945 (last merge round=32)
[S14] round=69 local utility u=0.173833 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9969912875906717, 'loss_val': 0.01908551867373828, 'psi': 0.9969969429648153}-{'f1_val': 0.9551429685540037, 'auprc': 0.9981166247722049, 'loss_val': 0.11898007382373232, 'psi': 0.9723324310412842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=69 head_norm_before_train=2.261961 cos_to_last_merge=0.9708 (last merge round=39)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.9412618979763847, 'auprc': 0.9970532602998807, 'loss_val': 0.10724650839741602, 'psi': 0.9635784429057831}-{'f1_val': 0.9427456625438181, 'auprc': 0.9970357247710828, 'loss_val': 0.10504407746359973, 'psi': 0.9644616874347239}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=1.972840 cos_to_last_merge=0.9936 (last merge round=39)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.9805525551320697, 'auprc': 0.989337996227674, 'loss_val': 0.07532698100757618, 'psi': 0.9840667315703114}-{'f1_val': 0.9921553304731932, 'auprc': 0.9920615718706719, 'loss_val': 0.037202286222814546, 'psi': 0.9921178270321847}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=2.398629 cos_to_last_merge=0.9985 (last merge round=41)
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.899549662914835, 'auprc': 0.9195343247872761, 'loss_val': 0.5926220943566807, 'psi': 0.9075435276638114}-{'f1_val': 0.902260523382739, 'auprc': 0.9056176562980556, 'loss_val': 0.5668153001911455, 'psi': 0.9036033765488656}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=2.067521 cos_to_last_merge=0.9966 (last merge round=38)
[S2] round=70 local utility u=1.000000 metrics={'f1_val': 0.8263383345871176, 'auprc': 0.9877074668887484, 'loss_val': 0.4154863310046549, 'psi': 0.8908859875077699}-{'f1_val': 0.5678314387400201, 'auprc': 0.8035905430472245, 'loss_val': 2.207484611462017, 'psi': 0.6621350804629018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=70 head_norm_before_train=2.319595 cos_to_last_merge=0.9858 (last merge round=34)
[S3] round=70 local utility u=0.943669 metrics={'f1_val': 0.9781043544874457, 'auprc': 0.9998443998424514, 'loss_val': 0.04284923059360602, 'psi': 0.9868003726294481}-{'f1_val': 0.7860633222111442, 'auprc': 0.95902222916107, 'loss_val': 0.6554751456019037, 'psi': 0.8552468849911146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=70 head_norm_before_train=1.908874 cos_to_last_merge=0.9707 (last merge round=34)
[S4] round=70 local utility u=0.068270 metrics={'f1_val': 0.9454363156211281, 'auprc': 0.9698394622260563, 'loss_val': 0.31283212417817724, 'psi': 0.9551975742630994}-{'f1_val': 0.9384499105956409, 'auprc': 0.9462836112085535, 'loss_val': 0.33678556807678856, 'psi': 0.941583390840806}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=70 head_norm_before_train=2.000761 cos_to_last_merge=0.9937 (last merge round=35)
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.6198943115794873, 'auprc': 0.8312010418388741, 'loss_val': 0.6410282308419093, 'psi': 0.704417003683242}-{'f1_val': 0.742773376517904, 'auprc': 0.9891408655678703, 'loss_val': 0.1887565333586718, 'psi': 0.8413203721378906}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=2.259624 (no previous merge yet)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.6644004328396104, 'auprc': 0.9088915642142049, 'loss_val': 1.0602376402332652, 'psi': 0.7621968853894482}-{'f1_val': 0.7416951371325985, 'auprc': 0.8273737311169294, 'loss_val': 0.7778171549397978, 'psi': 0.7759665747263309}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.767445 cos_to_last_merge=0.9925 (last merge round=40)
[S7] round=70 local utility u=0.099880 metrics={'f1_val': 0.5773382095132906, 'auprc': 0.784460907469336, 'loss_val': 0.8232376557363957, 'psi': 0.6601872886957088}-{'f1_val': 0.5519705610396053, 'auprc': 0.7825205166827265, 'loss_val': 0.8649713209719827, 'psi': 0.6441905432968538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=70 head_norm_before_train=1.881833 cos_to_last_merge=0.9814 (last merge round=33)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.964999439416725, 'auprc': 0.9935701138874693, 'loss_val': 0.11479218740435769, 'psi': 0.9764277092050226}-{'f1_val': 0.993663382622812, 'auprc': 0.9986687278758578, 'loss_val': 0.0331474262426219, 'psi': 0.9956655207240304}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.177170 (no previous merge yet)
[S9] round=70 local utility u=0.009101 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992072603429347, 'loss_val': 0.01649342334347355, 'psi': 0.9979446516444596}-{'f1_val': 0.9966924912647621, 'auprc': 0.9944971465375515, 'loss_val': 0.018102555766572395, 'psi': 0.9958143533738779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[S10] START round=70 head_norm_before_train=2.427716 cos_to_last_merge=0.9883 (last merge round=33)
[S10] round=70 local utility u=0.001320 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9937467952613296, 'loss_val': 0.03048721775662313, 'psi': 0.9939529134027001}-{'f1_val': 0.9934327081542391, 'auprc': 0.994730544266049, 'loss_val': 0.03213185721103761, 'psi': 0.9939518425989631}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=70 head_norm_before_train=2.381676 cos_to_last_merge=0.9983 (last merge round=41)
[S11] round=70 local utility u=0.000098 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985467182516541, 'loss_val': 0.021560093695250252, 'psi': 0.9970988922486472}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979354471075574, 'loss_val': 0.02240262671106756, 'psi': 0.9971023815511767}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=70 head_norm_before_train=2.102700 (no previous merge yet)
[S13] round=70 local utility u=0.349697 metrics={'f1_val': 0.7620150427769998, 'auprc': 0.8276503881647477, 'loss_val': 0.7393804177321659, 'psi': 0.788269180932099}-{'f1_val': 0.7360766028813539, 'auprc': 0.7740319829289216, 'loss_val': 1.1222892459523197, 'psi': 0.751258754900381}
[S13] not sending this round → trigger blocked (psi=0.788)
[S14] START round=70 head_norm_before_train=2.361522 cos_to_last_merge=0.9942 (last merge round=32)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.996579965017272, 'loss_val': 0.030958810625548297, 'psi': 0.9970769477079442}-{'f1_val': 0.9970007132142444, 'auprc': 0.9969912875906717, 'loss_val': 0.01908551867373828, 'psi': 0.9969969429648153}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=2.270558 cos_to_last_merge=0.9703 (last merge round=39)
[S15] round=70 local utility u=0.008681 metrics={'f1_val': 0.943730532135611, 'auprc': 0.9970248982567183, 'loss_val': 0.10461121805102946, 'psi': 0.965048278584054}-{'f1_val': 0.9412618979763847, 'auprc': 0.9970532602998807, 'loss_val': 0.10724650839741602, 'psi': 0.9635784429057831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=70 head_norm_before_train=1.979092 cos_to_last_merge=0.9934 (last merge round=39)
[S16] round=70 local utility u=0.059070 metrics={'f1_val': 0.993399047037773, 'auprc': 0.9896756393952204, 'loss_val': 0.035278370190158094, 'psi': 0.991909683980752}-{'f1_val': 0.9805525551320697, 'auprc': 0.989337996227674, 'loss_val': 0.07532698100757618, 'psi': 0.9840667315703114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=70 head_norm_before_train=2.396894 cos_to_last_merge=0.9986 (last merge round=41)
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.8936147426455332, 'auprc': 0.9013876106638624, 'loss_val': 0.6076655940909806, 'psi': 0.8967238898528649}-{'f1_val': 0.899549662914835, 'auprc': 0.9195343247872761, 'loss_val': 0.5926220943566807, 'psi': 0.9075435276638114}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=71 head_norm_before_train=2.075399 cos_to_last_merge=0.9965 (last merge round=38)
[S2] round=71 local utility u=0.000405 metrics={'f1_val': 0.8275058257599165, 'auprc': 0.9896545141255283, 'loss_val': 0.4275219734540485, 'psi': 0.8923653011061612}-{'f1_val': 0.8263383345871176, 'auprc': 0.9877074668887484, 'loss_val': 0.4154863310046549, 'psi': 0.8908859875077699}
[S2] not sending this round → trigger blocked (psi=0.892)
[S3] START round=71 head_norm_before_train=2.326607 cos_to_last_merge=0.9854 (last merge round=34)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9999958414847916, 'loss_val': 0.11057289948150269, 'psi': 0.9763648970427898}-{'f1_val': 0.9781043544874457, 'auprc': 0.9998443998424514, 'loss_val': 0.04284923059360602, 'psi': 0.9868003726294481}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.913932 cos_to_last_merge=0.9698 (last merge round=34)
[S4] round=71 local utility u=0.012063 metrics={'f1_val': 0.954069515441852, 'auprc': 0.960767360313358, 'loss_val': 0.3132899209615425, 'psi': 0.9567486533904543}-{'f1_val': 0.9454363156211281, 'auprc': 0.9698394622260563, 'loss_val': 0.31283212417817724, 'psi': 0.9551975742630994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=71 head_norm_before_train=2.001259 cos_to_last_merge=0.9936 (last merge round=35)
[S5] round=71 local utility u=1.000000 metrics={'f1_val': 0.9136573165411894, 'auprc': 0.9931134678330013, 'loss_val': 0.1320876995133685, 'psi': 0.9454397770579142}-{'f1_val': 0.6198943115794873, 'auprc': 0.8312010418388741, 'loss_val': 0.6410282308419093, 'psi': 0.704417003683242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=71 head_norm_before_train=2.269278 (no previous merge yet)
[S6] round=71 local utility u=1.000000 metrics={'f1_val': 0.8676835255516472, 'auprc': 0.965848899022115, 'loss_val': 0.39816951005737855, 'psi': 0.9069496749398344}-{'f1_val': 0.6644004328396104, 'auprc': 0.9088915642142049, 'loss_val': 1.0602376402332652, 'psi': 0.7621968853894482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=71 head_norm_before_train=1.773053 cos_to_last_merge=0.9922 (last merge round=40)
[S7] round=71 local utility u=0.373195 metrics={'f1_val': 0.6504233612023326, 'auprc': 0.8013115387883463, 'loss_val': 0.5659110409639057, 'psi': 0.710778632236738}-{'f1_val': 0.5773382095132906, 'auprc': 0.784460907469336, 'loss_val': 0.8232376557363957, 'psi': 0.6601872886957088}
[S7] not sending this round → trigger blocked (psi=0.711)
[S8] START round=71 head_norm_before_train=1.884417 cos_to_last_merge=0.9813 (last merge round=33)
[S8] round=71 local utility u=0.134137 metrics={'f1_val': 0.9932225217693944, 'auprc': 0.9993464048002436, 'loss_val': 0.033185156312093705, 'psi': 0.9956720749817342}-{'f1_val': 0.964999439416725, 'auprc': 0.9935701138874693, 'loss_val': 0.11479218740435769, 'psi': 0.9764277092050226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=71 head_norm_before_train=2.174235 (no previous merge yet)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9991962813103062, 'loss_val': 0.024618164251155046, 'psi': 0.9952891976130414}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992072603429347, 'loss_val': 0.01649342334347355, 'psi': 0.9979446516444596}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.430549 cos_to_last_merge=0.9881 (last merge round=33)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946604845784823, 'loss_val': 0.03179464596832682, 'psi': 0.9939238187239364}-{'f1_val': 0.9940903254969471, 'auprc': 0.9937467952613296, 'loss_val': 0.03048721775662313, 'psi': 0.9939529134027001}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=2.383264 cos_to_last_merge=0.9982 (last merge round=41)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998591290187104, 'loss_val': 0.02255843571324319, 'psi': 0.9971167210228272}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985467182516541, 'loss_val': 0.021560093695250252, 'psi': 0.9970988922486472}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=2.106165 (no previous merge yet)
[S13] round=71 local utility u=0.000000 metrics={'f1_val': 0.7196880473543001, 'auprc': 0.8318745495790703, 'loss_val': 1.0435383881733207, 'psi': 0.7645626482442082}-{'f1_val': 0.7620150427769998, 'auprc': 0.8276503881647477, 'loss_val': 0.7393804177321659, 'psi': 0.788269180932099}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=71 head_norm_before_train=2.365674 cos_to_last_merge=0.9940 (last merge round=32)
[S14] round=71 local utility u=0.008465 metrics={'f1_val': 0.9974089034627865, 'auprc': 0.9974731732162712, 'loss_val': 0.016712253948793183, 'psi': 0.9974346113641803}-{'f1_val': 0.9974082695017256, 'auprc': 0.996579965017272, 'loss_val': 0.030958810625548297, 'psi': 0.9970769477079442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=71 head_norm_before_train=2.278991 cos_to_last_merge=0.9698 (last merge round=39)
[S15] round=71 local utility u=0.000335 metrics={'f1_val': 0.943730532135611, 'auprc': 0.9970251160778774, 'loss_val': 0.10394140953546638, 'psi': 0.9650483657125175}-{'f1_val': 0.943730532135611, 'auprc': 0.9970248982567183, 'loss_val': 0.10461121805102946, 'psi': 0.965048278584054}
[S15] not sending this round → trigger blocked (psi=0.965)
[S16] START round=71 head_norm_before_train=1.985332 cos_to_last_merge=0.9931 (last merge round=39)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9803154587831812, 'auprc': 0.9910948467486805, 'loss_val': 0.08468384481276764, 'psi': 0.984627213969381}-{'f1_val': 0.993399047037773, 'auprc': 0.9896756393952204, 'loss_val': 0.035278370190158094, 'psi': 0.991909683980752}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=2.400307 cos_to_last_merge=0.9986 (last merge round=41)
[S17] round=71 local utility u=0.036266 metrics={'f1_val': 0.8960630376561393, 'auprc': 0.9213252358894538, 'loss_val': 0.6096353687961167, 'psi': 0.9061679169494651}-{'f1_val': 0.8936147426455332, 'auprc': 0.9013876106638624, 'loss_val': 0.6076655940909806, 'psi': 0.8967238898528649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=72 head_norm_before_train=2.082541 cos_to_last_merge=0.9965 (last merge round=38)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7308453962447181, 'auprc': 0.8243883716581946, 'loss_val': 0.9980374208599392, 'psi': 0.7682625864101087}-{'f1_val': 0.8275058257599165, 'auprc': 0.9896545141255283, 'loss_val': 0.4275219734540485, 'psi': 0.8923653011061612}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.334126 cos_to_last_merge=0.9850 (last merge round=34)
[S3] round=72 local utility u=0.061227 metrics={'f1_val': 0.9710742626949586, 'auprc': 0.9999697451839391, 'loss_val': 0.05082048662320508, 'psi': 0.9826324556905508}-{'f1_val': 0.9606109340814555, 'auprc': 0.9999958414847916, 'loss_val': 0.11057289948150269, 'psi': 0.9763648970427898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=72 head_norm_before_train=1.924281 cos_to_last_merge=0.9692 (last merge round=34)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.9413516303886699, 'auprc': 0.9509271360190283, 'loss_val': 0.3213128596230997, 'psi': 0.9451818326408132}-{'f1_val': 0.954069515441852, 'auprc': 0.960767360313358, 'loss_val': 0.3132899209615425, 'psi': 0.9567486533904543}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=2.002599 cos_to_last_merge=0.9935 (last merge round=35)
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.662483458060265, 'auprc': 0.8531603675209297, 'loss_val': 0.5213450687844092, 'psi': 0.7387542218445309}-{'f1_val': 0.9136573165411894, 'auprc': 0.9931134678330013, 'loss_val': 0.1320876995133685, 'psi': 0.9454397770579142}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=2.277861 (no previous merge yet)
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.6173006891861301, 'auprc': 0.8370709737681685, 'loss_val': 1.21810311148815, 'psi': 0.7052088030189455}-{'f1_val': 0.8676835255516472, 'auprc': 0.965848899022115, 'loss_val': 0.39816951005737855, 'psi': 0.9069496749398344}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=1.779243 cos_to_last_merge=0.9918 (last merge round=40)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.5713981336781673, 'auprc': 0.7810890775145092, 'loss_val': 0.9178361607335231, 'psi': 0.6552745112127041}-{'f1_val': 0.6504233612023326, 'auprc': 0.8013115387883463, 'loss_val': 0.5659110409639057, 'psi': 0.710778632236738}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=1.890583 cos_to_last_merge=0.9811 (last merge round=33)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9785861515951488, 'auprc': 0.9932653967488155, 'loss_val': 0.06839795652982644, 'psi': 0.9844578496566155}-{'f1_val': 0.9932225217693944, 'auprc': 0.9993464048002436, 'loss_val': 0.033185156312093705, 'psi': 0.9956720749817342}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=2.176694 (no previous merge yet)
[S9] round=72 local utility u=0.008187 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9991776955049781, 'loss_val': 0.020722435109969545, 'psi': 0.9965351325985372}-{'f1_val': 0.992684475148198, 'auprc': 0.9991962813103062, 'loss_val': 0.024618164251155046, 'psi': 0.9952891976130414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=72 head_norm_before_train=2.432652 cos_to_last_merge=0.9879 (last merge round=33)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9948825881024537, 'loss_val': 0.032986612833661555, 'psi': 0.994012660133525}-{'f1_val': 0.9934327081542391, 'auprc': 0.9946604845784823, 'loss_val': 0.03179464596832682, 'psi': 0.9939238187239364}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=2.385828 cos_to_last_merge=0.9981 (last merge round=41)
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9714021663162433, 'auprc': 0.9979281996102038, 'loss_val': 0.09774535763639113, 'psi': 0.9820125796338275}-{'f1_val': 0.9961336749133093, 'auprc': 0.998591290187104, 'loss_val': 0.02255843571324319, 'psi': 0.9971167210228272}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=2.112135 (no previous merge yet)
[S13] round=72 local utility u=0.044611 metrics={'f1_val': 0.7434988817702484, 'auprc': 0.7798055945370037, 'loss_val': 0.9409748748690379, 'psi': 0.7580215668769505}-{'f1_val': 0.7196880473543001, 'auprc': 0.8318745495790703, 'loss_val': 1.0435383881733207, 'psi': 0.7645626482442082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=72 head_norm_before_train=2.369493 cos_to_last_merge=0.9939 (last merge round=32)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9438334681371863, 'auprc': 0.987501147976106, 'loss_val': 0.13744976540205386, 'psi': 0.9613005400727541}-{'f1_val': 0.9974089034627865, 'auprc': 0.9974731732162712, 'loss_val': 0.016712253948793183, 'psi': 0.9974346113641803}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=2.287086 cos_to_last_merge=0.9694 (last merge round=39)
[S15] round=72 local utility u=0.027970 metrics={'f1_val': 0.9514893693240515, 'auprc': 0.9970310233129442, 'loss_val': 0.09457278625492202, 'psi': 0.9697060309196086}-{'f1_val': 0.943730532135611, 'auprc': 0.9970251160778774, 'loss_val': 0.10394140953546638, 'psi': 0.9650483657125175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=72 head_norm_before_train=1.988166 cos_to_last_merge=0.9930 (last merge round=39)
[S16] round=72 local utility u=0.066172 metrics={'f1_val': 0.9936233538143384, 'auprc': 0.990933829607349, 'loss_val': 0.031703671871212154, 'psi': 0.9925475441315426}-{'f1_val': 0.9803154587831812, 'auprc': 0.9910948467486805, 'loss_val': 0.08468384481276764, 'psi': 0.984627213969381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=72 head_norm_before_train=2.400311 cos_to_last_merge=0.9985 (last merge round=41)
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.8929063001663665, 'auprc': 0.9018669006676034, 'loss_val': 0.5953128541102899, 'psi': 0.8964905403668613}-{'f1_val': 0.8960630376561393, 'auprc': 0.9213252358894538, 'loss_val': 0.6096353687961167, 'psi': 0.9061679169494651}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=2.085706 cos_to_last_merge=0.9963 (last merge round=38)
[S2] round=73 local utility u=0.235386 metrics={'f1_val': 0.7528541323298334, 'auprc': 0.8604763365165886, 'loss_val': 0.7675808314555432, 'psi': 0.7959030140045356}-{'f1_val': 0.7308453962447181, 'auprc': 0.8243883716581946, 'loss_val': 0.9980374208599392, 'psi': 0.7682625864101087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=73 head_norm_before_train=2.341466 cos_to_last_merge=0.9845 (last merge round=34)
[S3] round=73 local utility u=0.088992 metrics={'f1_val': 0.9948994170532618, 'auprc': 0.9999959468042392, 'loss_val': 0.01586554555996972, 'psi': 0.9969380289536527}-{'f1_val': 0.9710742626949586, 'auprc': 0.9999697451839391, 'loss_val': 0.05082048662320508, 'psi': 0.9826324556905508}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=73 head_norm_before_train=1.933173 cos_to_last_merge=0.9687 (last merge round=34)
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.7572749671291779, 'auprc': 0.9202428847759119, 'loss_val': 0.5367485970076293, 'psi': 0.8224621341878715}-{'f1_val': 0.9413516303886699, 'auprc': 0.9509271360190283, 'loss_val': 0.3213128596230997, 'psi': 0.9451818326408132}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=2.005635 cos_to_last_merge=0.9933 (last merge round=35)
[S5] round=73 local utility u=0.052478 metrics={'f1_val': 0.6603005104054438, 'auprc': 0.8715118152663776, 'loss_val': 0.4583456669216961, 'psi': 0.7447850323498173}-{'f1_val': 0.662483458060265, 'auprc': 0.8531603675209297, 'loss_val': 0.5213450687844092, 'psi': 0.7387542218445309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=73 head_norm_before_train=2.284828 (no previous merge yet)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.5678210528541398, 'auprc': 0.7983552039265103, 'loss_val': 1.1472729014292302, 'psi': 0.6600347132830879}-{'f1_val': 0.6173006891861301, 'auprc': 0.8370709737681685, 'loss_val': 1.21810311148815, 'psi': 0.7052088030189455}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.783657 cos_to_last_merge=0.9915 (last merge round=40)
[S7] round=73 local utility u=0.365243 metrics={'f1_val': 0.6283268344502091, 'auprc': 0.7998477417474488, 'loss_val': 0.5851974025491338, 'psi': 0.6969351973691049}-{'f1_val': 0.5713981336781673, 'auprc': 0.7810890775145092, 'loss_val': 0.9178361607335231, 'psi': 0.6552745112127041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=73 head_norm_before_train=1.897789 cos_to_last_merge=0.9807 (last merge round=33)
[S8] round=73 local utility u=0.073114 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9989780129031547, 'loss_val': 0.03092284696710257, 'psi': 0.9959044745296486}-{'f1_val': 0.9785861515951488, 'auprc': 0.9932653967488155, 'loss_val': 0.06839795652982644, 'psi': 0.9844578496566155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=73 head_norm_before_train=2.180467 (no previous merge yet)
[S9] round=73 local utility u=0.006911 metrics={'f1_val': 0.9964354604519897, 'auprc': 0.9991730672776504, 'loss_val': 0.01685966236533977, 'psi': 0.997530503182254}-{'f1_val': 0.9947734239942433, 'auprc': 0.9991776955049781, 'loss_val': 0.020722435109969545, 'psi': 0.9965351325985372}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=73 head_norm_before_train=2.436928 cos_to_last_merge=0.9877 (last merge round=33)
[S10] round=73 local utility u=0.000188 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9948834403117128, 'loss_val': 0.032612252634684556, 'psi': 0.9940130010172287}-{'f1_val': 0.9934327081542391, 'auprc': 0.9948825881024537, 'loss_val': 0.032986612833661555, 'psi': 0.994012660133525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=73 head_norm_before_train=2.388965 cos_to_last_merge=0.9980 (last merge round=41)
[S11] round=73 local utility u=0.071683 metrics={'f1_val': 0.9873227643845194, 'auprc': 0.9984600247696962, 'loss_val': 0.05149753170880273, 'psi': 0.9917776685385901}-{'f1_val': 0.9714021663162433, 'auprc': 0.9979281996102038, 'loss_val': 0.09774535763639113, 'psi': 0.9820125796338275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] sending update (kind=head size=1789 to 1 peers)
[S13] START round=73 head_norm_before_train=2.123076 (no previous merge yet)
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.6002773253641334, 'auprc': 0.6100431298696213, 'loss_val': 1.569453738632516, 'psi': 0.6041836471663284}-{'f1_val': 0.7434988817702484, 'auprc': 0.7798055945370037, 'loss_val': 0.9409748748690379, 'psi': 0.7580215668769505}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=2.372445 cos_to_last_merge=0.9938 (last merge round=32)
[S14] round=73 local utility u=0.233202 metrics={'f1_val': 0.9972116069810506, 'auprc': 0.9967628536248987, 'loss_val': 0.019100113261629224, 'psi': 0.9970321056385898}-{'f1_val': 0.9438334681371863, 'auprc': 0.987501147976106, 'loss_val': 0.13744976540205386, 'psi': 0.9613005400727541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=73 head_norm_before_train=2.294955 cos_to_last_merge=0.9689 (last merge round=39)
[S15] round=73 local utility u=0.011878 metrics={'f1_val': 0.954819230695445, 'auprc': 0.9970429317109889, 'loss_val': 0.09083206183247976, 'psi': 0.9717087111016627}-{'f1_val': 0.9514893693240515, 'auprc': 0.9970310233129442, 'loss_val': 0.09457278625492202, 'psi': 0.9697060309196086}
[S15] not sending this round → trigger blocked (psi=0.972)
[S16] START round=73 head_norm_before_train=1.990469 cos_to_last_merge=0.9928 (last merge round=39)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9923013488757446, 'auprc': 0.989534621727495, 'loss_val': 0.044033854313740566, 'psi': 0.9911946580164448}-{'f1_val': 0.9936233538143384, 'auprc': 0.990933829607349, 'loss_val': 0.031703671871212154, 'psi': 0.9925475441315426}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=2.405896 cos_to_last_merge=0.9985 (last merge round=41)
[S17] round=73 local utility u=0.094726 metrics={'f1_val': 0.9040429214932117, 'auprc': 0.9372872309959894, 'loss_val': 0.5789413668055036, 'psi': 0.9173406452943228}-{'f1_val': 0.8929063001663665, 'auprc': 0.9018669006676034, 'loss_val': 0.5953128541102899, 'psi': 0.8964905403668613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=74 head_norm_before_train=2.086304 cos_to_last_merge=0.9959 (last merge round=38)
[S2] round=74 local utility u=0.236831 metrics={'f1_val': 0.7146300698921834, 'auprc': 0.9903295094579446, 'loss_val': 0.4541341987768392, 'psi': 0.8249098457184878}-{'f1_val': 0.7528541323298334, 'auprc': 0.8604763365165886, 'loss_val': 0.7675808314555432, 'psi': 0.7959030140045356}
[S2] not sending this round → trigger blocked (psi=0.825)
[S3] START round=74 head_norm_before_train=2.345018 cos_to_last_merge=0.9842 (last merge round=34)
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.9917782746266572, 'auprc': 0.9999280693776837, 'loss_val': 0.025076237301480852, 'psi': 0.9950381925270678}-{'f1_val': 0.9948994170532618, 'auprc': 0.9999959468042392, 'loss_val': 0.01586554555996972, 'psi': 0.9969380289536527}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=1.940814 cos_to_last_merge=0.9678 (last merge round=34)
[S4] round=74 local utility u=0.575878 metrics={'f1_val': 0.9168125439469448, 'auprc': 0.937951309557687, 'loss_val': 0.39534413794178264, 'psi': 0.9252680501912416}-{'f1_val': 0.7572749671291779, 'auprc': 0.9202428847759119, 'loss_val': 0.5367485970076293, 'psi': 0.8224621341878715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=74 head_norm_before_train=2.007702 cos_to_last_merge=0.9932 (last merge round=35)
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.5098212589683702, 'auprc': 0.8556311548336226, 'loss_val': 0.9857356205163553, 'psi': 0.6481452173144711}-{'f1_val': 0.6603005104054438, 'auprc': 0.8715118152663776, 'loss_val': 0.4583456669216961, 'psi': 0.7447850323498173}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=2.294314 (no previous merge yet)
[S6] round=74 local utility u=0.494715 metrics={'f1_val': 0.6668565799072115, 'auprc': 0.9021346751313324, 'loss_val': 1.063394669407338, 'psi': 0.7609678179968599}-{'f1_val': 0.5678210528541398, 'auprc': 0.7983552039265103, 'loss_val': 1.1472729014292302, 'psi': 0.6600347132830879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=74 head_norm_before_train=1.786494 cos_to_last_merge=0.9912 (last merge round=40)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5984151095130477, 'auprc': 0.7881100767055423, 'loss_val': 0.7702908639723841, 'psi': 0.6742930963900455}-{'f1_val': 0.6283268344502091, 'auprc': 0.7998477417474488, 'loss_val': 0.5851974025491338, 'psi': 0.6969351973691049}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=1.902888 cos_to_last_merge=0.9804 (last merge round=33)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.9917244887003366, 'auprc': 0.9991250150617065, 'loss_val': 0.03280818394295894, 'psi': 0.9946846992448846}-{'f1_val': 0.9938554489473111, 'auprc': 0.9989780129031547, 'loss_val': 0.03092284696710257, 'psi': 0.9959044745296486}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=2.184942 (no previous merge yet)
[S9] round=74 local utility u=0.002917 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999537391011879, 'loss_val': 0.016123485213307864, 'psi': 0.9980767039120373}-{'f1_val': 0.9964354604519897, 'auprc': 0.9991730672776504, 'loss_val': 0.01685966236533977, 'psi': 0.997530503182254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=74 head_norm_before_train=2.442372 cos_to_last_merge=0.9874 (last merge round=33)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946936175811748, 'loss_val': 0.03224809168176337, 'psi': 0.9939370719250135}-{'f1_val': 0.9934327081542391, 'auprc': 0.9948834403117128, 'loss_val': 0.032612252634684556, 'psi': 0.9940130010172287}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=2.392918 cos_to_last_merge=0.9980 (last merge round=41)
[S11] round=74 local utility u=0.041138 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998558957374601, 'loss_val': 0.022384408082482488, 'psi': 0.9971037878978259}-{'f1_val': 0.9873227643845194, 'auprc': 0.9984600247696962, 'loss_val': 0.05149753170880273, 'psi': 0.9917776685385901}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=74 head_norm_before_train=2.127316 (no previous merge yet)
[S13] round=74 local utility u=0.518930 metrics={'f1_val': 0.6908754492074969, 'auprc': 0.6793063698248675, 'loss_val': 1.2829727984597235, 'psi': 0.6862478174544451}-{'f1_val': 0.6002773253641334, 'auprc': 0.6100431298696213, 'loss_val': 1.569453738632516, 'psi': 0.6041836471663284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=74 head_norm_before_train=2.374471 cos_to_last_merge=0.9937 (last merge round=32)
[S14] round=74 local utility u=0.003194 metrics={'f1_val': 0.9970013471753054, 'auprc': 0.9991200652816832, 'loss_val': 0.018522977548461172, 'psi': 0.9978488344178564}-{'f1_val': 0.9972116069810506, 'auprc': 0.9967628536248987, 'loss_val': 0.019100113261629224, 'psi': 0.9970321056385898}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=74 head_norm_before_train=2.302584 cos_to_last_merge=0.9685 (last merge round=39)
[S15] round=74 local utility u=0.004596 metrics={'f1_val': 0.9562347437343942, 'auprc': 0.9970450368334227, 'loss_val': 0.09013923748299146, 'psi': 0.9725588609740056}-{'f1_val': 0.954819230695445, 'auprc': 0.9970429317109889, 'loss_val': 0.09083206183247976, 'psi': 0.9717087111016627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=74 head_norm_before_train=1.994357 cos_to_last_merge=0.9927 (last merge round=39)
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9914275771406745, 'auprc': 0.9884021171217913, 'loss_val': 0.048467600747971344, 'psi': 0.9902173931331212}-{'f1_val': 0.9923013488757446, 'auprc': 0.989534621727495, 'loss_val': 0.044033854313740566, 'psi': 0.9911946580164448}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=2.411167 cos_to_last_merge=0.9984 (last merge round=41)
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.8843611830477454, 'auprc': 0.9627050908316499, 'loss_val': 0.6466183924211379, 'psi': 0.9156987461613071}-{'f1_val': 0.9040429214932117, 'auprc': 0.9372872309959894, 'loss_val': 0.5789413668055036, 'psi': 0.9173406452943228}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=2.091280 cos_to_last_merge=0.9959 (last merge round=38)
[S2] round=75 local utility u=0.296490 metrics={'f1_val': 0.8041163020648749, 'auprc': 0.9913850349519393, 'loss_val': 0.40123899718908945, 'psi': 0.8790237952197006}-{'f1_val': 0.7146300698921834, 'auprc': 0.9903295094579446, 'loss_val': 0.4541341987768392, 'psi': 0.8249098457184878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=75 head_norm_before_train=2.348508 cos_to_last_merge=0.9839 (last merge round=34)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.999488277121663, 'loss_val': 0.11888502219030687, 'psi': 0.9764644651893566}-{'f1_val': 0.9917782746266572, 'auprc': 0.9999280693776837, 'loss_val': 0.025076237301480852, 'psi': 0.9950381925270678}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.947068 cos_to_last_merge=0.9675 (last merge round=34)
[S4] round=75 local utility u=0.081104 metrics={'f1_val': 0.9385213816720489, 'auprc': 0.931245773968409, 'loss_val': 0.3432715739059354, 'psi': 0.935611138590593}-{'f1_val': 0.9168125439469448, 'auprc': 0.937951309557687, 'loss_val': 0.39534413794178264, 'psi': 0.9252680501912416}
[S4] not sending this round → trigger blocked (psi=0.936)
[S5] START round=75 head_norm_before_train=2.010430 cos_to_last_merge=0.9931 (last merge round=35)
[S5] round=75 local utility u=1.000000 metrics={'f1_val': 0.9202747572978125, 'auprc': 0.9948264135769871, 'loss_val': 0.14583177857156654, 'psi': 0.9500954198094823}-{'f1_val': 0.5098212589683702, 'auprc': 0.8556311548336226, 'loss_val': 0.9857356205163553, 'psi': 0.6481452173144711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=75 head_norm_before_train=2.299860 (no previous merge yet)
[S6] round=75 local utility u=0.842964 metrics={'f1_val': 0.810559155233631, 'auprc': 0.9706458994787909, 'loss_val': 0.44521641230909587, 'psi': 0.8745938529316949}-{'f1_val': 0.6668565799072115, 'auprc': 0.9021346751313324, 'loss_val': 1.063394669407338, 'psi': 0.7609678179968599}
[S6] not sending this round → trigger blocked (psi=0.875)
[S7] START round=75 head_norm_before_train=1.791766 cos_to_last_merge=0.9910 (last merge round=40)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.5715601579975369, 'auprc': 0.7840939739141223, 'loss_val': 0.8173747602475925, 'psi': 0.656573684364171}-{'f1_val': 0.5984151095130477, 'auprc': 0.7881100767055423, 'loss_val': 0.7702908639723841, 'psi': 0.6742930963900455}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=1.908557 cos_to_last_merge=0.9800 (last merge round=33)
[S8] round=75 local utility u=0.001708 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9993674743660111, 'loss_val': 0.032299519107924675, 'psi': 0.9949996387837239}-{'f1_val': 0.9917244887003366, 'auprc': 0.9991250150617065, 'loss_val': 0.03280818394295894, 'psi': 0.9946846992448846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=75 head_norm_before_train=2.190167 (no previous merge yet)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9958027117501747, 'loss_val': 0.016485608775149364, 'psi': 0.9960711415676364}-{'f1_val': 0.9971029125121428, 'auprc': 0.999537391011879, 'loss_val': 0.016123485213307864, 'psi': 0.9980767039120373}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.445075 cos_to_last_merge=0.9872 (last merge round=33)
[S10] round=75 local utility u=0.001244 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9936791747561714, 'loss_val': 0.03066316897833363, 'psi': 0.9939258652006369}-{'f1_val': 0.9934327081542391, 'auprc': 0.9946936175811748, 'loss_val': 0.03224809168176337, 'psi': 0.9939370719250135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=75 head_norm_before_train=2.397951 cos_to_last_merge=0.9980 (last merge round=41)
[S11] round=75 local utility u=0.000150 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983237157004574, 'loss_val': 0.022407224497411962, 'psi': 0.9971125867614996}-{'f1_val': 0.9961336749133093, 'auprc': 0.998558957374601, 'loss_val': 0.022384408082482488, 'psi': 0.9971037878978259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=75 head_norm_before_train=2.134607 (no previous merge yet)
[S13] round=75 local utility u=0.443153 metrics={'f1_val': 0.6782375459823028, 'auprc': 0.9094403803216327, 'loss_val': 1.0112420470193675, 'psi': 0.7707186797180348}-{'f1_val': 0.6908754492074969, 'auprc': 0.6793063698248675, 'loss_val': 1.2829727984597235, 'psi': 0.6862478174544451}
[S13] not sending this round → trigger blocked (psi=0.771)
[S14] START round=75 head_norm_before_train=2.375778 cos_to_last_merge=0.9935 (last merge round=32)
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9707282587028491, 'auprc': 0.9919109053596353, 'loss_val': 0.07837438286745597, 'psi': 0.9792013173655636}-{'f1_val': 0.9970013471753054, 'auprc': 0.9991200652816832, 'loss_val': 0.018522977548461172, 'psi': 0.9978488344178564}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=2.309965 cos_to_last_merge=0.9681 (last merge round=39)
[S15] round=75 local utility u=0.009070 metrics={'f1_val': 0.9585788553094909, 'auprc': 0.9970650109506531, 'loss_val': 0.0861241256395737, 'psi': 0.9739733175659558}-{'f1_val': 0.9562347437343942, 'auprc': 0.9970450368334227, 'loss_val': 0.09013923748299146, 'psi': 0.9725588609740056}
[S15] not sending this round → trigger blocked (psi=0.974)
[S16] START round=75 head_norm_before_train=1.997615 cos_to_last_merge=0.9925 (last merge round=39)
[S16] round=75 local utility u=0.013653 metrics={'f1_val': 0.9927435947391747, 'auprc': 0.9918647601891706, 'loss_val': 0.039445578616878245, 'psi': 0.9923920609191731}-{'f1_val': 0.9914275771406745, 'auprc': 0.9884021171217913, 'loss_val': 0.048467600747971344, 'psi': 0.9902173931331212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=75 head_norm_before_train=2.414996 cos_to_last_merge=0.9983 (last merge round=41)
[S17] round=75 local utility u=0.111944 metrics={'f1_val': 0.911142991739144, 'auprc': 0.9556953094696552, 'loss_val': 0.5623924011768429, 'psi': 0.9289639188313484}-{'f1_val': 0.8843611830477454, 'auprc': 0.9627050908316499, 'loss_val': 0.6466183924211379, 'psi': 0.9156987461613071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=76 head_norm_before_train=2.097877 cos_to_last_merge=0.9960 (last merge round=38)
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.8300834786323459, 'auprc': 0.8368649296510642, 'loss_val': 0.40947538277303897, 'psi': 0.8327960590398332}-{'f1_val': 0.8041163020648749, 'auprc': 0.9913850349519393, 'loss_val': 0.40123899718908945, 'psi': 0.8790237952197006}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=2.352907 cos_to_last_merge=0.9836 (last merge round=34)
[S3] round=76 local utility u=0.000206 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.999634841349451, 'loss_val': 0.1173839149123885, 'psi': 0.9763702312529549}-{'f1_val': 0.9611152572344858, 'auprc': 0.999488277121663, 'loss_val': 0.11888502219030687, 'psi': 0.9764644651893566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=76 head_norm_before_train=1.950585 cos_to_last_merge=0.9669 (last merge round=34)
[S4] round=76 local utility u=0.016720 metrics={'f1_val': 0.9398333720188379, 'auprc': 0.9360842118125571, 'loss_val': 0.33221919572196323, 'psi': 0.9383337079363256}-{'f1_val': 0.9385213816720489, 'auprc': 0.931245773968409, 'loss_val': 0.3432715739059354, 'psi': 0.935611138590593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=76 head_norm_before_train=2.012455 cos_to_last_merge=0.9929 (last merge round=35)
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.8254615097699274, 'loss_val': 0.48679789216742325, 'psi': 0.7504287497365321}-{'f1_val': 0.9202747572978125, 'auprc': 0.9948264135769871, 'loss_val': 0.14583177857156654, 'psi': 0.9500954198094823}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=2.301467 (no previous merge yet)
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.6318174196066729, 'auprc': 0.9463627666199876, 'loss_val': 0.920916700152109, 'psi': 0.7576355584119988}-{'f1_val': 0.810559155233631, 'auprc': 0.9706458994787909, 'loss_val': 0.44521641230909587, 'psi': 0.8745938529316949}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.796558 cos_to_last_merge=0.9906 (last merge round=40)
[S7] round=76 local utility u=0.464750 metrics={'f1_val': 0.6520686552633083, 'auprc': 0.8061652881223926, 'loss_val': 0.4371406707840289, 'psi': 0.7137073084069421}-{'f1_val': 0.5715601579975369, 'auprc': 0.7840939739141223, 'loss_val': 0.8173747602475925, 'psi': 0.656573684364171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=76 head_norm_before_train=1.912498 cos_to_last_merge=0.9797 (last merge round=33)
[S8] round=76 local utility u=0.004668 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9994193566850853, 'loss_val': 0.02932909025133851, 'psi': 0.9956413904635303}-{'f1_val': 0.9920877483955324, 'auprc': 0.9993674743660111, 'loss_val': 0.032299519107924675, 'psi': 0.9949996387837239}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=76 head_norm_before_train=2.196662 (no previous merge yet)
[S9] round=76 local utility u=0.005527 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988091632747187, 'loss_val': 0.01691285285950105, 'psi': 0.9975199723982223}-{'f1_val': 0.9962500947792776, 'auprc': 0.9958027117501747, 'loss_val': 0.016485608775149364, 'psi': 0.9960711415676364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=76 head_norm_before_train=2.449665 cos_to_last_merge=0.9870 (last merge round=33)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9937448982334649, 'loss_val': 0.03120178542907065, 'psi': 0.9938205869237129}-{'f1_val': 0.9940903254969471, 'auprc': 0.9936791747561714, 'loss_val': 0.03066316897833363, 'psi': 0.9939258652006369}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=2.403460 cos_to_last_merge=0.9979 (last merge round=41)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.990330227835785, 'auprc': 0.9983128463827586, 'loss_val': 0.0448332512535181, 'psi': 0.9935232752545744}-{'f1_val': 0.996305167468861, 'auprc': 0.9983237157004574, 'loss_val': 0.022407224497411962, 'psi': 0.9971125867614996}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=76 head_norm_before_train=2.143727 (no previous merge yet)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.623194395886816, 'auprc': 0.6627226153366977, 'loss_val': 1.4527044824689943, 'psi': 0.6390056836667687}-{'f1_val': 0.6782375459823028, 'auprc': 0.9094403803216327, 'loss_val': 1.0112420470193675, 'psi': 0.7707186797180348}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=2.377758 cos_to_last_merge=0.9934 (last merge round=32)
[S14] round=76 local utility u=0.039774 metrics={'f1_val': 0.9802787654527215, 'auprc': 0.9986246631332308, 'loss_val': 0.07627149720609462, 'psi': 0.9876171245249252}-{'f1_val': 0.9707282587028491, 'auprc': 0.9919109053596353, 'loss_val': 0.07837438286745597, 'psi': 0.9792013173655636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=76 head_norm_before_train=2.317317 cos_to_last_merge=0.9677 (last merge round=39)
[S15] round=76 local utility u=0.010278 metrics={'f1_val': 0.9613674390849617, 'auprc': 0.9970819396062766, 'loss_val': 0.08235107231634214, 'psi': 0.9756532392934877}-{'f1_val': 0.9585788553094909, 'auprc': 0.9970650109506531, 'loss_val': 0.0861241256395737, 'psi': 0.9739733175659558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=76 head_norm_before_train=2.002019 cos_to_last_merge=0.9923 (last merge round=39)
[S16] round=76 local utility u=0.005165 metrics={'f1_val': 0.9925715374817954, 'auprc': 0.9945957777499338, 'loss_val': 0.03627705038385378, 'psi': 0.9933812335890508}-{'f1_val': 0.9927435947391747, 'auprc': 0.9918647601891706, 'loss_val': 0.039445578616878245, 'psi': 0.9923920609191731}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=76 head_norm_before_train=2.421638 cos_to_last_merge=0.9982 (last merge round=41)
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.9106139140792435, 'auprc': 0.9419080620682704, 'loss_val': 0.5756311952216625, 'psi': 0.9231315732748543}-{'f1_val': 0.911142991739144, 'auprc': 0.9556953094696552, 'loss_val': 0.5623924011768429, 'psi': 0.9289639188313484}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=77 head_norm_before_train=2.104921 cos_to_last_merge=0.9959 (last merge round=38)
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.6420861151488716, 'auprc': 0.7743241018582533, 'loss_val': 1.8138691271693814, 'psi': 0.6949813098326243}-{'f1_val': 0.8300834786323459, 'auprc': 0.8368649296510642, 'loss_val': 0.40947538277303897, 'psi': 0.8327960590398332}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.358757 cos_to_last_merge=0.9832 (last merge round=34)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.8645384474571389, 'auprc': 0.9719926529528351, 'loss_val': 0.39388995190823617, 'psi': 0.9075201296554174}-{'f1_val': 0.9608604911886242, 'auprc': 0.999634841349451, 'loss_val': 0.1173839149123885, 'psi': 0.9763702312529549}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=1.957960 cos_to_last_merge=0.9665 (last merge round=34)
[S4] round=77 local utility u=0.030285 metrics={'f1_val': 0.9453943941895143, 'auprc': 0.9452096676555153, 'loss_val': 0.3323909991136137, 'psi': 0.9453205035759147}-{'f1_val': 0.9398333720188379, 'auprc': 0.9360842118125571, 'loss_val': 0.33221919572196323, 'psi': 0.9383337079363256}
[S4] not sending this round → trigger blocked (psi=0.945)
[S5] START round=77 head_norm_before_train=2.016437 cos_to_last_merge=0.9927 (last merge round=35)
[S5] round=77 local utility u=0.403472 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9910647553867796, 'loss_val': 0.1771861171315962, 'psi': 0.8167222218203857}-{'f1_val': 0.7004069097142683, 'auprc': 0.8254615097699274, 'loss_val': 0.48679789216742325, 'psi': 0.7504287497365321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=77 head_norm_before_train=2.303546 (no previous merge yet)
[S6] round=77 local utility u=0.661721 metrics={'f1_val': 0.7808054544193539, 'auprc': 0.9547965915890448, 'loss_val': 0.516704298852935, 'psi': 0.8504019092872304}-{'f1_val': 0.6318174196066729, 'auprc': 0.9463627666199876, 'loss_val': 0.920916700152109, 'psi': 0.7576355584119988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=77 head_norm_before_train=1.799738 cos_to_last_merge=0.9903 (last merge round=40)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.6380899768958354, 'auprc': 0.802569508590737, 'loss_val': 0.4823396978325338, 'psi': 0.703881789573796}-{'f1_val': 0.6520686552633083, 'auprc': 0.8061652881223926, 'loss_val': 0.4371406707840289, 'psi': 0.7137073084069421}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=1.921658 cos_to_last_merge=0.9794 (last merge round=33)
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9898564228592382, 'auprc': 0.9935946297109519, 'loss_val': 0.05222567204800421, 'psi': 0.9913517055999237}-{'f1_val': 0.993122746315827, 'auprc': 0.9994193566850853, 'loss_val': 0.02932909025133851, 'psi': 0.9956413904635303}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=77 head_norm_before_train=2.200286 (no previous merge yet)
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.999205187220385, 'loss_val': 0.02228175955509059, 'psi': 0.9961958987384936}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988091632747187, 'loss_val': 0.01691285285950105, 'psi': 0.9975199723982223}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=77 head_norm_before_train=2.453027 cos_to_last_merge=0.9867 (last merge round=33)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9947624420448522, 'loss_val': 0.03319872057906095, 'psi': 0.9939646017104844}-{'f1_val': 0.993871046050545, 'auprc': 0.9937448982334649, 'loss_val': 0.03120178542907065, 'psi': 0.9938205869237129}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=2.408118 cos_to_last_merge=0.9978 (last merge round=41)
[S11] round=77 local utility u=0.028912 metrics={'f1_val': 0.9960663761953501, 'auprc': 0.9979859684798265, 'loss_val': 0.020445037112985346, 'psi': 0.9968342131091407}-{'f1_val': 0.990330227835785, 'auprc': 0.9983128463827586, 'loss_val': 0.0448332512535181, 'psi': 0.9935232752545744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=77 head_norm_before_train=2.147656 (no previous merge yet)
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.5974177641128565, 'auprc': 0.624353686992598, 'loss_val': 1.6089440407776956, 'psi': 0.6081921332647531}-{'f1_val': 0.623194395886816, 'auprc': 0.6627226153366977, 'loss_val': 1.4527044824689943, 'psi': 0.6390056836667687}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=2.381967 cos_to_last_merge=0.9933 (last merge round=32)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.956244862577382, 'auprc': 0.9917460588230703, 'loss_val': 0.09920878857634893, 'psi': 0.9704453410756573}-{'f1_val': 0.9802787654527215, 'auprc': 0.9986246631332308, 'loss_val': 0.07627149720609462, 'psi': 0.9876171245249252}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=2.324401 cos_to_last_merge=0.9673 (last merge round=39)
[S15] round=77 local utility u=0.003536 metrics={'f1_val': 0.9622911803477983, 'auprc': 0.9970823965026806, 'loss_val': 0.08082291279310388, 'psi': 0.9762076668097512}-{'f1_val': 0.9613674390849617, 'auprc': 0.9970819396062766, 'loss_val': 0.08235107231634214, 'psi': 0.9756532392934877}
[S15] not sending this round → trigger blocked (psi=0.976)
[S16] START round=77 head_norm_before_train=2.005381 cos_to_last_merge=0.9922 (last merge round=39)
[S16] round=77 local utility u=0.000367 metrics={'f1_val': 0.9921553304731932, 'auprc': 0.9954526087238624, 'loss_val': 0.03561611495508508, 'psi': 0.9934742417734609}-{'f1_val': 0.9925715374817954, 'auprc': 0.9945957777499338, 'loss_val': 0.03627705038385378, 'psi': 0.9933812335890508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=77 head_norm_before_train=2.428129 cos_to_last_merge=0.9981 (last merge round=41)
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.9012794126868333, 'auprc': 0.9140303903620267, 'loss_val': 0.5928853294427309, 'psi': 0.9063798037569106}-{'f1_val': 0.9106139140792435, 'auprc': 0.9419080620682704, 'loss_val': 0.5756311952216625, 'psi': 0.9231315732748543}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.113905 cos_to_last_merge=0.9958 (last merge round=38)
[S2] round=78 local utility u=1.000000 metrics={'f1_val': 0.8275627046291201, 'auprc': 0.9906061079105876, 'loss_val': 0.4076474709518126, 'psi': 0.8927800659417071}-{'f1_val': 0.6420861151488716, 'auprc': 0.7743241018582533, 'loss_val': 1.8138691271693814, 'psi': 0.6949813098326243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=78 head_norm_before_train=2.363616 cos_to_last_merge=0.9829 (last merge round=34)
[S3] round=78 local utility u=0.165773 metrics={'f1_val': 0.8913708550176744, 'auprc': 0.9961942622550066, 'loss_val': 0.29594341245288197, 'psi': 0.9333002179126073}-{'f1_val': 0.8645384474571389, 'auprc': 0.9719926529528351, 'loss_val': 0.39388995190823617, 'psi': 0.9075201296554174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=78 head_norm_before_train=1.957812 cos_to_last_merge=0.9658 (last merge round=34)
[S4] round=78 local utility u=0.029695 metrics={'f1_val': 0.9468798032067102, 'auprc': 0.958919368410252, 'loss_val': 0.3230429636454559, 'psi': 0.9516956292881269}-{'f1_val': 0.9453943941895143, 'auprc': 0.9452096676555153, 'loss_val': 0.3323909991136137, 'psi': 0.9453205035759147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=78 head_norm_before_train=2.018698 cos_to_last_merge=0.9927 (last merge round=35)
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.6643718036722952, 'auprc': 0.9403994683194874, 'loss_val': 0.42244683616021406, 'psi': 0.774782869531172}-{'f1_val': 0.7004938661094564, 'auprc': 0.9910647553867796, 'loss_val': 0.1771861171315962, 'psi': 0.8167222218203857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=2.308567 (no previous merge yet)
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.6389234669725382, 'auprc': 0.8443159713095476, 'loss_val': 1.0677255461934887, 'psi': 0.721080468707342}-{'f1_val': 0.7808054544193539, 'auprc': 0.9547965915890448, 'loss_val': 0.516704298852935, 'psi': 0.8504019092872304}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=78 head_norm_before_train=1.803716 cos_to_last_merge=0.9900 (last merge round=40)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.5512555081884465, 'auprc': 0.7768900773601629, 'loss_val': 1.0052810370668792, 'psi': 0.6415093358571331}-{'f1_val': 0.6380899768958354, 'auprc': 0.802569508590737, 'loss_val': 0.4823396978325338, 'psi': 0.703881789573796}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=1.924790 cos_to_last_merge=0.9791 (last merge round=33)
[S8] round=78 local utility u=0.030862 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9988734979603227, 'loss_val': 0.030332143932989296, 'psi': 0.9958626685525158}-{'f1_val': 0.9898564228592382, 'auprc': 0.9935946297109519, 'loss_val': 0.05222567204800421, 'psi': 0.9913517055999237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=78 head_norm_before_train=2.200838 (no previous merge yet)
[S9] round=78 local utility u=0.011135 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9992087719743774, 'loss_val': 0.01600034663013237, 'psi': 0.9977950600451053}-{'f1_val': 0.9941897064172326, 'auprc': 0.999205187220385, 'loss_val': 0.02228175955509059, 'psi': 0.9961958987384936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=78 head_norm_before_train=2.456782 cos_to_last_merge=0.9865 (last merge round=33)
[S10] round=78 local utility u=0.000292 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.994780434861846, 'loss_val': 0.032669167529667094, 'psi': 0.9939717988372819}-{'f1_val': 0.9934327081542391, 'auprc': 0.9947624420448522, 'loss_val': 0.03319872057906095, 'psi': 0.9939646017104844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=78 head_norm_before_train=2.413336 cos_to_last_merge=0.9978 (last merge round=41)
[S11] round=78 local utility u=0.003492 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9984200011507487, 'loss_val': 0.019097315543184588, 'psi': 0.9974412303659181}-{'f1_val': 0.9960663761953501, 'auprc': 0.9979859684798265, 'loss_val': 0.020445037112985346, 'psi': 0.9968342131091407}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=78 head_norm_before_train=2.147131 (no previous merge yet)
[S13] round=78 local utility u=0.747426 metrics={'f1_val': 0.6430570028311133, 'auprc': 0.8619440071186288, 'loss_val': 1.1006977859721025, 'psi': 0.7306118045461196}-{'f1_val': 0.5974177641128565, 'auprc': 0.624353686992598, 'loss_val': 1.6089440407776956, 'psi': 0.6081921332647531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=78 head_norm_before_train=2.385442 cos_to_last_merge=0.9932 (last merge round=32)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.920132310510815, 'auprc': 0.985993515396611, 'loss_val': 0.20864417714898714, 'psi': 0.9464767924651334}-{'f1_val': 0.956244862577382, 'auprc': 0.9917460588230703, 'loss_val': 0.09920878857634893, 'psi': 0.9704453410756573}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=2.331433 cos_to_last_merge=0.9669 (last merge round=39)
[S15] round=78 local utility u=0.002696 metrics={'f1_val': 0.9627519808495014, 'auprc': 0.997101797138611, 'loss_val': 0.07825315040818931, 'psi': 0.9764919073651452}-{'f1_val': 0.9622911803477983, 'auprc': 0.9970823965026806, 'loss_val': 0.08082291279310388, 'psi': 0.9762076668097512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=78 head_norm_before_train=2.010292 cos_to_last_merge=0.9920 (last merge round=39)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.934481664482748, 'auprc': 0.9871568227171232, 'loss_val': 0.3770547142938452, 'psi': 0.9555517277764982}-{'f1_val': 0.9921553304731932, 'auprc': 0.9954526087238624, 'loss_val': 0.03561611495508508, 'psi': 0.9934742417734609}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=2.436324 cos_to_last_merge=0.9980 (last merge round=41)
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.861253457279757, 'auprc': 0.9260247170873426, 'loss_val': 0.691096711761454, 'psi': 0.8871619612027912}-{'f1_val': 0.9012794126868333, 'auprc': 0.9140303903620267, 'loss_val': 0.5928853294427309, 'psi': 0.9063798037569106}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=2.122938 cos_to_last_merge=0.9958 (last merge round=38)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.7295646001635744, 'auprc': 0.8637143233246912, 'loss_val': 0.9928629282840399, 'psi': 0.7832244894280211}-{'f1_val': 0.8275627046291201, 'auprc': 0.9906061079105876, 'loss_val': 0.4076474709518126, 'psi': 0.8927800659417071}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.783 u=0.0000 p_local=0.2657 f1=0.730 auprc=0.864 bytes=55756
[S3] START round=79 head_norm_before_train=2.368480 cos_to_last_merge=0.9825 (last merge round=34)
[S3] round=79 local utility u=0.409669 metrics={'f1_val': 0.9847321585434389, 'auprc': 0.9996147529432693, 'loss_val': 0.04703460267297889, 'psi': 0.9906851963033709}-{'f1_val': 0.8913708550176744, 'auprc': 0.9961942622550066, 'loss_val': 0.29594341245288197, 'psi': 0.9333002179126073}
[S3] not sending this round → trigger blocked (psi=0.991)
[S3] r=80 psi=0.991 u=0.4097 p_local=0.1516 f1=0.985 auprc=1.000 bytes=55687
[S4] START round=79 head_norm_before_train=1.957551 cos_to_last_merge=0.9643 (last merge round=34)
[S4] round=79 local utility u=0.018818 metrics={'f1_val': 0.9534917961690693, 'auprc': 0.9581210434921419, 'loss_val': 0.32268316785489054, 'psi': 0.9553434950982983}-{'f1_val': 0.9468798032067102, 'auprc': 0.958919368410252, 'loss_val': 0.3230429636454559, 'psi': 0.9516956292881269}
[S4] not sending this round → trigger blocked (psi=0.955)
[S4] r=80 psi=0.955 u=0.0188 p_local=0.0626 f1=0.953 auprc=0.958 bytes=55785
[S5] START round=79 head_norm_before_train=2.018553 cos_to_last_merge=0.9928 (last merge round=35)
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.6618048805541505, 'auprc': 0.8297315575583265, 'loss_val': 0.5669619386646602, 'psi': 0.7289755513558209}-{'f1_val': 0.6643718036722952, 'auprc': 0.9403994683194874, 'loss_val': 0.42244683616021406, 'psi': 0.774782869531172}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.729 u=0.0000 p_local=0.2200 f1=0.662 auprc=0.830 bytes=62989
[S6] START round=79 head_norm_before_train=2.317605 (no previous merge yet)
[S6] round=79 local utility u=1.000000 metrics={'f1_val': 0.8189399512354524, 'auprc': 0.9455669579060596, 'loss_val': 0.35663263703628034, 'psi': 0.8695907539036953}-{'f1_val': 0.6389234669725382, 'auprc': 0.8443159713095476, 'loss_val': 1.0677255461934887, 'psi': 0.721080468707342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S6] r=80 psi=0.870 u=1.0000 p_local=0.4549 f1=0.819 auprc=0.946 bytes=62923
[S7] START round=79 head_norm_before_train=1.809155 cos_to_last_merge=0.9896 (last merge round=40)
[S7] round=79 local utility u=0.659720 metrics={'f1_val': 0.6703103583939936, 'auprc': 0.8040604613589368, 'loss_val': 0.48168073553775537, 'psi': 0.723810399579971}-{'f1_val': 0.5512555081884465, 'auprc': 0.7768900773601629, 'loss_val': 1.0052810370668792, 'psi': 0.6415093358571331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=80 psi=0.724 u=0.6597 p_local=0.2384 f1=0.670 auprc=0.804 bytes=61210
[S8] START round=79 head_norm_before_train=1.931229 cos_to_last_merge=0.9788 (last merge round=33)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9821392478545178, 'auprc': 0.9979115700302663, 'loss_val': 0.057102110458254376, 'psi': 0.9884481767248172}-{'f1_val': 0.9938554489473111, 'auprc': 0.9988734979603227, 'loss_val': 0.030332143932989296, 'psi': 0.9958626685525158}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.988 u=0.0000 p_local=0.0540 f1=0.982 auprc=0.998 bytes=63011
[S9] START round=79 head_norm_before_train=2.201566 (no previous merge yet)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9992128059909365, 'loss_val': 0.017164131833118816, 'psi': 0.997796673651729}-{'f1_val': 0.9968525854255906, 'auprc': 0.9992087719743774, 'loss_val': 0.01600034663013237, 'psi': 0.9977950600451053}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.998 u=0.0000 p_local=0.0065 f1=0.997 auprc=0.999 bytes=64685
[S10] START round=79 head_norm_before_train=2.461894 cos_to_last_merge=0.9863 (last merge round=33)
[S10] round=79 local utility u=0.000236 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946896227833961, 'loss_val': 0.03192521576525413, 'psi': 0.993935474005902}-{'f1_val': 0.9934327081542391, 'auprc': 0.994780434861846, 'loss_val': 0.032669167529667094, 'psi': 0.9939717988372819}
[S10] not sending this round → trigger blocked (psi=0.994)
[S10] r=80 psi=0.994 u=0.0002 p_local=0.0003 f1=0.993 auprc=0.995 bytes=61037
[S11] START round=79 head_norm_before_train=2.415156 cos_to_last_merge=0.9977 (last merge round=41)
[S11] round=79 local utility u=0.000191 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9985183688396835, 'loss_val': 0.019133972942193253, 'psi': 0.9974928573916206}-{'f1_val': 0.9967887165093644, 'auprc': 0.9984200011507487, 'loss_val': 0.019097315543184588, 'psi': 0.9974412303659181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S11] r=80 psi=0.997 u=0.0002 p_local=0.0123 f1=0.997 auprc=0.999 bytes=61040
[S13] START round=79 head_norm_before_train=2.151342 (no previous merge yet)
[S13] round=79 local utility u=0.220810 metrics={'f1_val': 0.7484783353907971, 'auprc': 0.7824195830963514, 'loss_val': 1.0530326208057712, 'psi': 0.7620548344730189}-{'f1_val': 0.6430570028311133, 'auprc': 0.8619440071186288, 'loss_val': 1.1006977859721025, 'psi': 0.7306118045461196}
[S13] not sending this round → trigger blocked (psi=0.762)
[S13] r=80 psi=0.762 u=0.2208 p_local=0.2577 f1=0.748 auprc=0.782 bytes=53924
[S14] START round=79 head_norm_before_train=2.390342 cos_to_last_merge=0.9932 (last merge round=32)
[S14] round=79 local utility u=0.339733 metrics={'f1_val': 0.9959644614659175, 'auprc': 0.9991683211267098, 'loss_val': 0.02369626354435585, 'psi': 0.9972460053302344}-{'f1_val': 0.920132310510815, 'auprc': 0.985993515396611, 'loss_val': 0.20864417714898714, 'psi': 0.9464767924651334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] r=80 psi=0.997 u=0.3397 p_local=0.0899 f1=0.996 auprc=0.999 bytes=61154
[S15] START round=79 head_norm_before_train=2.338122 cos_to_last_merge=0.9665 (last merge round=39)
[S15] round=79 local utility u=0.003839 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9971134573402431, 'loss_val': 0.07337068876053114, 'psi': 0.9767726263085499}-{'f1_val': 0.9627519808495014, 'auprc': 0.997101797138611, 'loss_val': 0.07825315040818931, 'psi': 0.9764919073651452}
[S15] not sending this round → trigger blocked (psi=0.977)
[S15] r=80 psi=0.977 u=0.0038 p_local=0.0144 f1=0.963 auprc=0.997 bytes=57561
[S16] START round=79 head_norm_before_train=2.015707 cos_to_last_merge=0.9918 (last merge round=39)
[S16] round=79 local utility u=0.350786 metrics={'f1_val': 0.9929638379912187, 'auprc': 0.9896707507839497, 'loss_val': 0.03391679746491276, 'psi': 0.9916466031083111}-{'f1_val': 0.934481664482748, 'auprc': 0.9871568227171232, 'loss_val': 0.3770547142938452, 'psi': 0.9555517277764982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S16] r=80 psi=0.992 u=0.3508 p_local=0.0805 f1=0.993 auprc=0.990 bytes=59332
[S17] START round=79 head_norm_before_train=2.441306 cos_to_last_merge=0.9979 (last merge round=41)
[S17] round=79 local utility u=0.208272 metrics={'f1_val': 0.9045995785643335, 'auprc': 0.9480203637969297, 'loss_val': 0.6006164074848646, 'psi': 0.921967892657372}-{'f1_val': 0.861253457279757, 'auprc': 0.9260247170873426, 'loss_val': 0.691096711761454, 'psi': 0.8871619612027912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S17] r=80 psi=0.922 u=0.2083 p_local=0.0831 f1=0.905 auprc=0.948 bytes=59367
[S2] START round=80 head_norm_before_train=2.122132 cos_to_last_merge=0.9954 (last merge round=38)
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.7030748869008491, 'auprc': 0.8204374857420345, 'loss_val': 1.2032664922699179, 'psi': 0.7500199264373233}-{'f1_val': 0.7295646001635744, 'auprc': 0.8637143233246912, 'loss_val': 0.9928629282840399, 'psi': 0.7832244894280211}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=80 head_norm_before_train=2.374222 cos_to_last_merge=0.9822 (last merge round=34)
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.8524878302385555, 'auprc': 0.9679067703290196, 'loss_val': 0.3914518554741482, 'psi': 0.8986554062747412}-{'f1_val': 0.9847321585434389, 'auprc': 0.9996147529432693, 'loss_val': 0.04703460267297889, 'psi': 0.9906851963033709}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=1.962557 cos_to_last_merge=0.9633 (last merge round=34)
[S4] round=80 local utility u=0.003022 metrics={'f1_val': 0.9464845243379394, 'auprc': 0.9729424525525716, 'loss_val': 0.3190587948911584, 'psi': 0.9570676956237922}-{'f1_val': 0.9534917961690693, 'auprc': 0.9581210434921419, 'loss_val': 0.32268316785489054, 'psi': 0.9553434950982983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=80 head_norm_before_train=2.018349 cos_to_last_merge=0.9928 (last merge round=35)
[S5] round=80 local utility u=1.000000 metrics={'f1_val': 0.9796340520275043, 'auprc': 0.9940287756733541, 'loss_val': 0.11048564199616008, 'psi': 0.9853919414858443}-{'f1_val': 0.6618048805541505, 'auprc': 0.8297315575583265, 'loss_val': 0.5669619386646602, 'psi': 0.7289755513558209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=80 head_norm_before_train=2.324465 (no previous merge yet)
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.7839693594558391, 'auprc': 0.8803891614604489, 'loss_val': 0.9626248562296874, 'psi': 0.822537280257683}-{'f1_val': 0.8189399512354524, 'auprc': 0.9455669579060596, 'loss_val': 0.35663263703628034, 'psi': 0.8695907539036953}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=1.812076 cos_to_last_merge=0.9894 (last merge round=40)
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.5796750921596294, 'auprc': 0.7797568798376135, 'loss_val': 0.8201555144067918, 'psi': 0.6597078072308231}-{'f1_val': 0.6703103583939936, 'auprc': 0.8040604613589368, 'loss_val': 0.48168073553775537, 'psi': 0.723810399579971}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=80 head_norm_before_train=1.938721 cos_to_last_merge=0.9784 (last merge round=33)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9211294644457226, 'auprc': 0.9932508262746844, 'loss_val': 0.18989006867711128, 'psi': 0.9499780091773073}-{'f1_val': 0.9821392478545178, 'auprc': 0.9979115700302663, 'loss_val': 0.057102110458254376, 'psi': 0.9884481767248172}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.203685 (no previous merge yet)
[S9] round=80 local utility u=0.000088 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9992128059909365, 'loss_val': 0.016988151099979892, 'psi': 0.997796673651729}-{'f1_val': 0.9968525854255906, 'auprc': 0.9992128059909365, 'loss_val': 0.017164131833118816, 'psi': 0.997796673651729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=80 head_norm_before_train=2.467286 cos_to_last_merge=0.9860 (last merge round=33)
[S10] round=80 local utility u=0.001426 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9940210488887312, 'loss_val': 0.031014020357710993, 'psi': 0.9940626148536608}-{'f1_val': 0.9934327081542391, 'auprc': 0.9946896227833961, 'loss_val': 0.03192521576525413, 'psi': 0.993935474005902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=80 head_norm_before_train=2.417832 cos_to_last_merge=0.9976 (last merge round=41)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9963278709367414, 'auprc': 0.9985247478083712, 'loss_val': 0.020500814783445648, 'psi': 0.9972066216853932}-{'f1_val': 0.9968091830929121, 'auprc': 0.9985183688396835, 'loss_val': 0.019133972942193253, 'psi': 0.9974928573916206}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=2.153796 (no previous merge yet)
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.5930055769415067, 'auprc': 0.6183567219098791, 'loss_val': 1.5991857555350708, 'psi': 0.6031460349288557}-{'f1_val': 0.7484783353907971, 'auprc': 0.7824195830963514, 'loss_val': 1.0530326208057712, 'psi': 0.7620548344730189}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=2.395581 cos_to_last_merge=0.9930 (last merge round=32)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9810902640889714, 'auprc': 0.9973283966774602, 'loss_val': 0.03904395207668201, 'psi': 0.9875855171243668}-{'f1_val': 0.9959644614659175, 'auprc': 0.9991683211267098, 'loss_val': 0.02369626354435585, 'psi': 0.9972460053302344}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=2.344696 cos_to_last_merge=0.9662 (last merge round=39)
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9970947179186372, 'loss_val': 0.07473073758083248, 'psi': 0.9767651305399075}-{'f1_val': 0.9632120722874211, 'auprc': 0.9971134573402431, 'loss_val': 0.07337068876053114, 'psi': 0.9767726263085499}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=2.016532 cos_to_last_merge=0.9917 (last merge round=39)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.9919179866533614, 'auprc': 0.991321463189421, 'loss_val': 0.03950209797507566, 'psi': 0.9916793772677852}-{'f1_val': 0.9929638379912187, 'auprc': 0.9896707507839497, 'loss_val': 0.03391679746491276, 'psi': 0.9916466031083111}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=2.447266 cos_to_last_merge=0.9978 (last merge round=41)
[S17] round=80 local utility u=0.038242 metrics={'f1_val': 0.911142991739144, 'auprc': 0.9526760952330592, 'loss_val': 0.57736105789093, 'psi': 0.9277562331367101}-{'f1_val': 0.9045995785643335, 'auprc': 0.9480203637969297, 'loss_val': 0.6006164074848646, 'psi': 0.921967892657372}
[S17] not sending this round → trigger blocked (psi=0.928)
[S2] START round=81 head_norm_before_train=2.128079 cos_to_last_merge=0.9953 (last merge round=38)
[S2] round=81 local utility u=0.363591 metrics={'f1_val': 0.7478404949278599, 'auprc': 0.8672054123192394, 'loss_val': 0.8849827448804605, 'psi': 0.7955864618844117}-{'f1_val': 0.7030748869008491, 'auprc': 0.8204374857420345, 'loss_val': 1.2032664922699179, 'psi': 0.7500199264373233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=81 head_norm_before_train=2.380046 cos_to_last_merge=0.9818 (last merge round=34)
[S3] round=81 local utility u=0.078855 metrics={'f1_val': 0.8687078722132116, 'auprc': 0.9915620536804499, 'loss_val': 0.402028914522209, 'psi': 0.9178495448001069}-{'f1_val': 0.8524878302385555, 'auprc': 0.9679067703290196, 'loss_val': 0.3914518554741482, 'psi': 0.8986554062747412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=81 head_norm_before_train=1.973690 cos_to_last_merge=0.9626 (last merge round=34)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9420206861793344, 'auprc': 0.9738787997326788, 'loss_val': 0.32884166751721794, 'psi': 0.9547639316006722}-{'f1_val': 0.9464845243379394, 'auprc': 0.9729424525525716, 'loss_val': 0.3190587948911584, 'psi': 0.9570676956237922}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=2.019168 cos_to_last_merge=0.9927 (last merge round=35)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.4171830078992953, 'auprc': 0.7662101885129311, 'loss_val': 1.53483301526788, 'psi': 0.5567938801447496}-{'f1_val': 0.9796340520275043, 'auprc': 0.9940287756733541, 'loss_val': 0.11048564199616008, 'psi': 0.9853919414858443}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=2.328180 (no previous merge yet)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.5961702499812112, 'auprc': 0.6343975579343586, 'loss_val': 1.820783534925186, 'psi': 0.6114611731624702}-{'f1_val': 0.7839693594558391, 'auprc': 0.8803891614604489, 'loss_val': 0.9626248562296874, 'psi': 0.822537280257683}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.813425 cos_to_last_merge=0.9892 (last merge round=40)
[S7] round=81 local utility u=0.590523 metrics={'f1_val': 0.6737404919340355, 'auprc': 0.8262421844747939, 'loss_val': 0.3429577861262301, 'psi': 0.7347411689503389}-{'f1_val': 0.5796750921596294, 'auprc': 0.7797568798376135, 'loss_val': 0.8201555144067918, 'psi': 0.6597078072308231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=81 head_norm_before_train=1.940195 cos_to_last_merge=0.9780 (last merge round=33)
[S8] round=81 local utility u=0.254182 metrics={'f1_val': 0.9831237468361917, 'auprc': 0.9935385879679876, 'loss_val': 0.05435473219858163, 'psi': 0.9872896832889101}-{'f1_val': 0.9211294644457226, 'auprc': 0.9932508262746844, 'loss_val': 0.18989006867711128, 'psi': 0.9499780091773073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=81 head_norm_before_train=2.208542 (no previous merge yet)
[S9] round=81 local utility u=0.000192 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9992062695690969, 'loss_val': 0.016585529218877817, 'psi': 0.997794059082993}-{'f1_val': 0.9968525854255906, 'auprc': 0.9992128059909365, 'loss_val': 0.016988151099979892, 'psi': 0.997796673651729}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=81 head_norm_before_train=2.470054 cos_to_last_merge=0.9858 (last merge round=33)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9945896435778032, 'loss_val': 0.03194777970641399, 'psi': 0.9938954823236648}-{'f1_val': 0.9940903254969471, 'auprc': 0.9940210488887312, 'loss_val': 0.031014020357710993, 'psi': 0.9940626148536608}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=2.422048 cos_to_last_merge=0.9976 (last merge round=41)
[S11] round=81 local utility u=0.002215 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9985145787705605, 'loss_val': 0.018927571712260997, 'psi': 0.9974913413639714}-{'f1_val': 0.9963278709367414, 'auprc': 0.9985247478083712, 'loss_val': 0.020500814783445648, 'psi': 0.9972066216853932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=81 head_norm_before_train=2.157593 (no previous merge yet)
[S13] round=81 local utility u=0.833217 metrics={'f1_val': 0.7465500225185642, 'auprc': 0.7354837197293669, 'loss_val': 1.2053999451313924, 'psi': 0.7421235014028853}-{'f1_val': 0.5930055769415067, 'auprc': 0.6183567219098791, 'loss_val': 1.5991857555350708, 'psi': 0.6031460349288557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=81 head_norm_before_train=2.394932 cos_to_last_merge=0.9928 (last merge round=32)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9464951252171072, 'auprc': 0.9442643710804701, 'loss_val': 0.13976297619374076, 'psi': 0.9456028235624524}-{'f1_val': 0.9810902640889714, 'auprc': 0.9973283966774602, 'loss_val': 0.03904395207668201, 'psi': 0.9875855171243668}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=2.351136 cos_to_last_merge=0.9658 (last merge round=39)
[S15] round=81 local utility u=0.000634 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9970960219935322, 'loss_val': 0.07346597807615278, 'psi': 0.9767656521698656}-{'f1_val': 0.9632120722874211, 'auprc': 0.9970947179186372, 'loss_val': 0.07473073758083248, 'psi': 0.9767651305399075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=81 head_norm_before_train=2.019377 cos_to_last_merge=0.9915 (last merge round=39)
[S16] round=81 local utility u=0.012551 metrics={'f1_val': 0.9941049506397256, 'auprc': 0.9922906703963523, 'loss_val': 0.03042869029860573, 'psi': 0.9933792385423763}-{'f1_val': 0.9919179866533614, 'auprc': 0.991321463189421, 'loss_val': 0.03950209797507566, 'psi': 0.9916793772677852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=81 head_norm_before_train=2.452134 cos_to_last_merge=0.9977 (last merge round=41)
[S17] round=81 local utility u=0.008583 metrics={'f1_val': 0.9114300165375977, 'auprc': 0.9620025659196996, 'loss_val': 0.5898961984340365, 'psi': 0.9316590362904384}-{'f1_val': 0.911142991739144, 'auprc': 0.9526760952330592, 'loss_val': 0.57736105789093, 'psi': 0.9277562331367101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=82 head_norm_before_train=2.134874 cos_to_last_merge=0.9953 (last merge round=38)
[S2] round=82 local utility u=0.226912 metrics={'f1_val': 0.7098024449604876, 'auprc': 0.971737798175859, 'loss_val': 0.5165280931238193, 'psi': 0.8145765862466361}-{'f1_val': 0.7478404949278599, 'auprc': 0.8672054123192394, 'loss_val': 0.8849827448804605, 'psi': 0.7955864618844117}
[S2] not sending this round → trigger blocked (psi=0.815)
[S3] START round=82 head_norm_before_train=2.385239 cos_to_last_merge=0.9815 (last merge round=34)
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.8086148570649092, 'auprc': 0.9741578928425911, 'loss_val': 0.6985449113745089, 'psi': 0.874832071375982}-{'f1_val': 0.8687078722132116, 'auprc': 0.9915620536804499, 'loss_val': 0.402028914522209, 'psi': 0.9178495448001069}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=1.984136 cos_to_last_merge=0.9620 (last merge round=34)
[S4] round=82 local utility u=0.005866 metrics={'f1_val': 0.9422941042888188, 'auprc': 0.9771014827461943, 'loss_val': 0.3284178231548346, 'psi': 0.956217055671769}-{'f1_val': 0.9420206861793344, 'auprc': 0.9738787997326788, 'loss_val': 0.32884166751721794, 'psi': 0.9547639316006722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=82 head_norm_before_train=2.022121 cos_to_last_merge=0.9925 (last merge round=35)
[S5] round=82 local utility u=1.000000 metrics={'f1_val': 0.9347961377852636, 'auprc': 0.9921092418195561, 'loss_val': 0.11952572622251065, 'psi': 0.9577213793989805}-{'f1_val': 0.4171830078992953, 'auprc': 0.7662101885129311, 'loss_val': 1.53483301526788, 'psi': 0.5567938801447496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=82 head_norm_before_train=2.336375 (no previous merge yet)
[S6] round=82 local utility u=1.000000 metrics={'f1_val': 0.8661379661103575, 'auprc': 0.9420191336838999, 'loss_val': 0.39657278453011907, 'psi': 0.8964904331397745}-{'f1_val': 0.5961702499812112, 'auprc': 0.6343975579343586, 'loss_val': 1.820783534925186, 'psi': 0.6114611731624702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=82 head_norm_before_train=1.816610 cos_to_last_merge=0.9889 (last merge round=40)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.6252887222963066, 'auprc': 0.7880944691129356, 'loss_val': 0.6068945010591761, 'psi': 0.6904110210229581}-{'f1_val': 0.6737404919340355, 'auprc': 0.8262421844747939, 'loss_val': 0.3429577861262301, 'psi': 0.7347411689503389}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=1.944253 cos_to_last_merge=0.9777 (last merge round=33)
[S8] round=82 local utility u=0.041388 metrics={'f1_val': 0.9929126860801906, 'auprc': 0.9947220330916446, 'loss_val': 0.033863042724319455, 'psi': 0.9936364248847722}-{'f1_val': 0.9831237468361917, 'auprc': 0.9935385879679876, 'loss_val': 0.05435473219858163, 'psi': 0.9872896832889101}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=82 head_norm_before_train=2.214521 (no previous merge yet)
[S9] round=82 local utility u=0.000943 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9995782499799137, 'loss_val': 0.015815142471129428, 'psi': 0.9979428512473199}-{'f1_val': 0.9968525854255906, 'auprc': 0.9992062695690969, 'loss_val': 0.016585529218877817, 'psi': 0.997794059082993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=82 head_norm_before_train=2.473931 cos_to_last_merge=0.9856 (last merge round=33)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9944978502059457, 'loss_val': 0.031724233070584244, 'psi': 0.9938587649749218}-{'f1_val': 0.9934327081542391, 'auprc': 0.9945896435778032, 'loss_val': 0.03194777970641399, 'psi': 0.9938954823236648}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=2.426214 cos_to_last_merge=0.9975 (last merge round=41)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985633851249857, 'loss_val': 0.022376845590895436, 'psi': 0.9971178388964415}-{'f1_val': 0.9968091830929121, 'auprc': 0.9985145787705605, 'loss_val': 0.018927571712260997, 'psi': 0.9974913413639714}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=2.156441 (no previous merge yet)
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6257756864726081, 'auprc': 0.6759475815785534, 'loss_val': 1.3123832991957023, 'psi': 0.6458444445149862}-{'f1_val': 0.7465500225185642, 'auprc': 0.7354837197293669, 'loss_val': 1.2053999451313924, 'psi': 0.7421235014028853}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=2.395664 cos_to_last_merge=0.9925 (last merge round=32)
[S14] round=82 local utility u=0.238558 metrics={'f1_val': 0.9853778537115354, 'auprc': 0.9972822150219947, 'loss_val': 0.054996975542985, 'psi': 0.9901395982357191}-{'f1_val': 0.9464951252171072, 'auprc': 0.9442643710804701, 'loss_val': 0.13976297619374076, 'psi': 0.9456028235624524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=82 head_norm_before_train=2.357589 cos_to_last_merge=0.9654 (last merge round=39)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9970962981292231, 'loss_val': 0.07349026470428341, 'psi': 0.9767657626241418}-{'f1_val': 0.9632120722874211, 'auprc': 0.9970960219935322, 'loss_val': 0.07346597807615278, 'psi': 0.9767656521698656}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=2.023000 cos_to_last_merge=0.9913 (last merge round=39)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.8723444561616818, 'auprc': 0.9860769523547643, 'loss_val': 0.6950054403919174, 'psi': 0.9178374546389148}-{'f1_val': 0.9941049506397256, 'auprc': 0.9922906703963523, 'loss_val': 0.03042869029860573, 'psi': 0.9933792385423763}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=2.453890 cos_to_last_merge=0.9977 (last merge round=41)
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.8994797596362718, 'auprc': 0.9329752684213646, 'loss_val': 0.621541634219639, 'psi': 0.9128779631503089}-{'f1_val': 0.9114300165375977, 'auprc': 0.9620025659196996, 'loss_val': 0.5898961984340365, 'psi': 0.9316590362904384}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=83 head_norm_before_train=2.140545 cos_to_last_merge=0.9951 (last merge round=38)
[S2] round=83 local utility u=0.032135 metrics={'f1_val': 0.7786354460544506, 'auprc': 0.8954619073284878, 'loss_val': 0.6364278433351422, 'psi': 0.8253660305640655}-{'f1_val': 0.7098024449604876, 'auprc': 0.971737798175859, 'loss_val': 0.5165280931238193, 'psi': 0.8145765862466361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=83 head_norm_before_train=2.390788 cos_to_last_merge=0.9811 (last merge round=34)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.7591763457943668, 'auprc': 0.937440181165126, 'loss_val': 0.8933745338755058, 'psi': 0.8304818799426705}-{'f1_val': 0.8086148570649092, 'auprc': 0.9741578928425911, 'loss_val': 0.6985449113745089, 'psi': 0.874832071375982}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=1.993281 cos_to_last_merge=0.9613 (last merge round=34)
[S4] round=83 local utility u=0.015881 metrics={'f1_val': 0.9482449696040988, 'auprc': 0.9763631245692623, 'loss_val': 0.3301455469186903, 'psi': 0.9594922315901642}-{'f1_val': 0.9422941042888188, 'auprc': 0.9771014827461943, 'loss_val': 0.3284178231548346, 'psi': 0.956217055671769}
[S4] not sending this round → trigger blocked (psi=0.959)
[S5] START round=83 head_norm_before_train=2.023878 cos_to_last_merge=0.9923 (last merge round=35)
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.7981532496268045, 'auprc': 0.9915539127957762, 'loss_val': 0.1689121530385843, 'psi': 0.8755135148943931}-{'f1_val': 0.9347961377852636, 'auprc': 0.9921092418195561, 'loss_val': 0.11952572622251065, 'psi': 0.9577213793989805}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=2.344437 (no previous merge yet)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.627921410027892, 'auprc': 0.8311020600367987, 'loss_val': 1.2857166961058348, 'psi': 0.7091936700314547}-{'f1_val': 0.8661379661103575, 'auprc': 0.9420191336838999, 'loss_val': 0.39657278453011907, 'psi': 0.8964904331397745}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.819709 cos_to_last_merge=0.9886 (last merge round=40)
[S7] round=83 local utility u=0.323608 metrics={'f1_val': 0.6699767102293104, 'auprc': 0.8270840538173523, 'loss_val': 0.34477427971080976, 'psi': 0.7328196476645272}-{'f1_val': 0.6252887222963066, 'auprc': 0.7880944691129356, 'loss_val': 0.6068945010591761, 'psi': 0.6904110210229581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=83 head_norm_before_train=1.949842 cos_to_last_merge=0.9775 (last merge round=33)
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.8499844659390559, 'auprc': 0.993571599738978, 'loss_val': 0.41666535210774575, 'psi': 0.9074193194590248}-{'f1_val': 0.9929126860801906, 'auprc': 0.9947220330916446, 'loss_val': 0.033863042724319455, 'psi': 0.9936364248847722}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.217356 (no previous merge yet)
[S9] round=83 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.99919721937216, 'loss_val': 0.04093104159857983, 'psi': 0.9930060273429129}-{'f1_val': 0.9968525854255906, 'auprc': 0.9995782499799137, 'loss_val': 0.015815142471129428, 'psi': 0.9979428512473199}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=83 head_norm_before_train=2.478827 cos_to_last_merge=0.9854 (last merge round=33)
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9947433135125064, 'loss_val': 0.03251451353879943, 'psi': 0.993956950297546}-{'f1_val': 0.9934327081542391, 'auprc': 0.9944978502059457, 'loss_val': 0.031724233070584244, 'psi': 0.9938587649749218}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=2.427516 cos_to_last_merge=0.9974 (last merge round=41)
[S11] round=83 local utility u=0.000222 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985850976651306, 'loss_val': 0.02199779518858733, 'psi': 0.9971265239124995}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985633851249857, 'loss_val': 0.022376845590895436, 'psi': 0.9971178388964415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=83 head_norm_before_train=2.161427 (no previous merge yet)
[S13] round=83 local utility u=0.426028 metrics={'f1_val': 0.6983580360406039, 'auprc': 0.7443683553964971, 'loss_val': 1.1010836839498908, 'psi': 0.7167621637829612}-{'f1_val': 0.6257756864726081, 'auprc': 0.6759475815785534, 'loss_val': 1.3123832991957023, 'psi': 0.6458444445149862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=83 head_norm_before_train=2.398203 cos_to_last_merge=0.9923 (last merge round=32)
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9609004707945499, 'auprc': 0.998859513117885, 'loss_val': 0.10480439252409247, 'psi': 0.976084087723884}-{'f1_val': 0.9853778537115354, 'auprc': 0.9972822150219947, 'loss_val': 0.054996975542985, 'psi': 0.9901395982357191}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=2.363716 cos_to_last_merge=0.9651 (last merge round=39)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9971081006150051, 'loss_val': 0.07439726865532416, 'psi': 0.9767704836184546}-{'f1_val': 0.9632120722874211, 'auprc': 0.9970962981292231, 'loss_val': 0.07349026470428341, 'psi': 0.9767657626241418}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=2.026027 cos_to_last_merge=0.9912 (last merge round=39)
[S16] round=83 local utility u=0.161588 metrics={'f1_val': 0.8930885331511058, 'auprc': 0.9911368997723554, 'loss_val': 0.5114727547554995, 'psi': 0.9323078797996056}-{'f1_val': 0.8723444561616818, 'auprc': 0.9860769523547643, 'loss_val': 0.6950054403919174, 'psi': 0.9178374546389148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=83 head_norm_before_train=2.454654 cos_to_last_merge=0.9977 (last merge round=41)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.8958696439289993, 'auprc': 0.9246153387106415, 'loss_val': 0.639720703618154, 'psi': 0.9073679218416562}-{'f1_val': 0.8994797596362718, 'auprc': 0.9329752684213646, 'loss_val': 0.621541634219639, 'psi': 0.9128779631503089}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.146595 cos_to_last_merge=0.9950 (last merge round=38)
[S2] round=84 local utility u=0.404491 metrics={'f1_val': 0.8275933155325034, 'auprc': 0.9820738704849483, 'loss_val': 0.381029557510996, 'psi': 0.8893855375134814}-{'f1_val': 0.7786354460544506, 'auprc': 0.8954619073284878, 'loss_val': 0.6364278433351422, 'psi': 0.8253660305640655}
[S2] not sending this round → trigger blocked (psi=0.889)
[S3] START round=84 head_norm_before_train=2.395345 cos_to_last_merge=0.9809 (last merge round=34)
[S3] round=84 local utility u=1.000000 metrics={'f1_val': 0.9913615152681262, 'auprc': 0.9997262903550418, 'loss_val': 0.02976677270500946, 'psi': 0.9947074253028925}-{'f1_val': 0.7591763457943668, 'auprc': 0.937440181165126, 'loss_val': 0.8933745338755058, 'psi': 0.8304818799426705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=84 head_norm_before_train=1.999236 cos_to_last_merge=0.9609 (last merge round=34)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9412123861653872, 'auprc': 0.9653535623017824, 'loss_val': 0.3384244530129229, 'psi': 0.9508688566199452}-{'f1_val': 0.9482449696040988, 'auprc': 0.9763631245692623, 'loss_val': 0.3301455469186903, 'psi': 0.9594922315901642}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=2.025432 cos_to_last_merge=0.9921 (last merge round=35)
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9188672062808135, 'loss_val': 0.5041303633297708, 'psi': 0.7877910283408864}-{'f1_val': 0.7981532496268045, 'auprc': 0.9915539127957762, 'loss_val': 0.1689121530385843, 'psi': 0.8755135148943931}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=2.351389 (no previous merge yet)
[S6] round=84 local utility u=1.000000 metrics={'f1_val': 0.8380483202426764, 'auprc': 0.945901732808561, 'loss_val': 0.4000106366677507, 'psi': 0.8811896852690303}-{'f1_val': 0.627921410027892, 'auprc': 0.8311020600367987, 'loss_val': 1.2857166961058348, 'psi': 0.7091936700314547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=84 head_norm_before_train=1.822608 cos_to_last_merge=0.9883 (last merge round=40)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.5697318142622826, 'auprc': 0.7779131636739303, 'loss_val': 0.9080364279841898, 'psi': 0.6530043540269417}-{'f1_val': 0.6699767102293104, 'auprc': 0.8270840538173523, 'loss_val': 0.34477427971080976, 'psi': 0.7328196476645272}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=1.954813 cos_to_last_merge=0.9771 (last merge round=33)
[S8] round=84 local utility u=0.627583 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.998148027696511, 'loss_val': 0.03186561491506858, 'psi': 0.9949135475016799}-{'f1_val': 0.8499844659390559, 'auprc': 0.993571599738978, 'loss_val': 0.41666535210774575, 'psi': 0.9074193194590248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=84 head_norm_before_train=2.219632 (no previous merge yet)
[S9] round=84 local utility u=0.035728 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9992009302704723, 'loss_val': 0.016177810459790744, 'psi': 0.9976766791965238}-{'f1_val': 0.9888785659900814, 'auprc': 0.99919721937216, 'loss_val': 0.04093104159857983, 'psi': 0.9930060273429129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=84 head_norm_before_train=2.481543 cos_to_last_merge=0.9852 (last merge round=33)
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9947397572124066, 'loss_val': 0.03274626995656172, 'psi': 0.9939555277775062}-{'f1_val': 0.9934327081542391, 'auprc': 0.9947433135125064, 'loss_val': 0.03251451353879943, 'psi': 0.993956950297546}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.430543 cos_to_last_merge=0.9973 (last merge round=41)
[S11] round=84 local utility u=0.001683 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9985906652406025, 'loss_val': 0.02009862367425911, 'psi': 0.9972737784147074}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985850976651306, 'loss_val': 0.02199779518858733, 'psi': 0.9971265239124995}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=84 head_norm_before_train=2.170494 (no previous merge yet)
[S13] round=84 local utility u=0.242534 metrics={'f1_val': 0.6706594731817458, 'auprc': 0.9334135881802496, 'loss_val': 1.0169608216745176, 'psi': 0.7757611191811473}-{'f1_val': 0.6983580360406039, 'auprc': 0.7443683553964971, 'loss_val': 1.1010836839498908, 'psi': 0.7167621637829612}
[S13] not sending this round → trigger blocked (psi=0.776)
[S14] START round=84 head_norm_before_train=2.402539 cos_to_last_merge=0.9922 (last merge round=32)
[S14] round=84 local utility u=0.059301 metrics={'f1_val': 0.976501831142814, 'auprc': 0.9990844565093204, 'loss_val': 0.080484870053734, 'psi': 0.9855348812894166}-{'f1_val': 0.9609004707945499, 'auprc': 0.998859513117885, 'loss_val': 0.10480439252409247, 'psi': 0.976084087723884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=84 head_norm_before_train=2.369657 cos_to_last_merge=0.9647 (last merge round=39)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9971164004019184, 'loss_val': 0.07550655755718877, 'psi': 0.97677380353322}-{'f1_val': 0.9632120722874211, 'auprc': 0.9971081006150051, 'loss_val': 0.07439726865532416, 'psi': 0.9767704836184546}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=2.029568 cos_to_last_merge=0.9911 (last merge round=39)
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.8698793026106095, 'auprc': 0.9907645545754923, 'loss_val': 0.6877546095092572, 'psi': 0.9182334033965626}-{'f1_val': 0.8930885331511058, 'auprc': 0.9911368997723554, 'loss_val': 0.5114727547554995, 'psi': 0.9323078797996056}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=2.460351 cos_to_last_merge=0.9976 (last merge round=41)
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.8917969884583986, 'auprc': 0.9058061383177523, 'loss_val': 0.6476037592641964, 'psi': 0.8974006484021401}-{'f1_val': 0.8958696439289993, 'auprc': 0.9246153387106415, 'loss_val': 0.639720703618154, 'psi': 0.9073679218416562}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=2.150746 cos_to_last_merge=0.9947 (last merge round=38)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.7377762142584119, 'auprc': 0.808943026227498, 'loss_val': 0.9656240640345057, 'psi': 0.7662429390460463}-{'f1_val': 0.8275933155325034, 'auprc': 0.9820738704849483, 'loss_val': 0.381029557510996, 'psi': 0.8893855375134814}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.399433 cos_to_last_merge=0.9806 (last merge round=34)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.9148781391321615, 'auprc': 0.9580168104262574, 'loss_val': 0.2907221091464316, 'psi': 0.9321336076497999}-{'f1_val': 0.9913615152681262, 'auprc': 0.9997262903550418, 'loss_val': 0.02976677270500946, 'psi': 0.9947074253028925}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=2.006326 cos_to_last_merge=0.9605 (last merge round=34)
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9387196498086724, 'auprc': 0.948714108440494, 'loss_val': 0.34845202415929105, 'psi': 0.942717433261401}-{'f1_val': 0.9412123861653872, 'auprc': 0.9653535623017824, 'loss_val': 0.3384244530129229, 'psi': 0.9508688566199452}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=2.028280 cos_to_last_merge=0.9919 (last merge round=35)
[S5] round=85 local utility u=0.128903 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9685005025194879, 'loss_val': 0.39574204784025935, 'psi': 0.8076961778890867}-{'f1_val': 0.7004069097142683, 'auprc': 0.9188672062808135, 'loss_val': 0.5041303633297708, 'psi': 0.7877910283408864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=85 head_norm_before_train=2.355640 (no previous merge yet)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.6069500741609262, 'auprc': 0.6854226706845665, 'loss_val': 1.4838673295229399, 'psi': 0.6383391127703824}-{'f1_val': 0.8380483202426764, 'auprc': 0.945901732808561, 'loss_val': 0.4000106366677507, 'psi': 0.8811896852690303}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=85 head_norm_before_train=1.827207 cos_to_last_merge=0.9880 (last merge round=40)
[S7] round=85 local utility u=0.494729 metrics={'f1_val': 0.6665790751176096, 'auprc': 0.7964138856698785, 'loss_val': 0.5551636333844553, 'psi': 0.7185129993385171}-{'f1_val': 0.5697318142622826, 'auprc': 0.7779131636739303, 'loss_val': 0.9080364279841898, 'psi': 0.6530043540269417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=85 head_norm_before_train=1.956781 cos_to_last_merge=0.9767 (last merge round=33)
[S8] round=85 local utility u=0.000179 metrics={'f1_val': 0.9925164355995088, 'auprc': 0.9991800599367985, 'loss_val': 0.033159600072036576, 'psi': 0.9951818853344245}-{'f1_val': 0.9927572273717925, 'auprc': 0.998148027696511, 'loss_val': 0.03186561491506858, 'psi': 0.9949135475016799}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=85 head_norm_before_train=2.220992 (no previous merge yet)
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988485788878702, 'loss_val': 0.01609533970410375, 'psi': 0.9975357386434829}-{'f1_val': 0.9966605118138915, 'auprc': 0.9992009302704723, 'loss_val': 0.016177810459790744, 'psi': 0.9976766791965238}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=2.484049 cos_to_last_merge=0.9850 (last merge round=33)
[S10] round=85 local utility u=0.001732 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9940990034811324, 'loss_val': 0.031305758258752564, 'psi': 0.9940937966906213}-{'f1_val': 0.9934327081542391, 'auprc': 0.9947397572124066, 'loss_val': 0.03274626995656172, 'psi': 0.9939555277775062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=85 head_norm_before_train=2.435102 cos_to_last_merge=0.9972 (last merge round=41)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9911228970469197, 'auprc': 0.9985832402112871, 'loss_val': 0.035919706377354844, 'psi': 0.9941070343126667}-{'f1_val': 0.9963958538641108, 'auprc': 0.9985906652406025, 'loss_val': 0.02009862367425911, 'psi': 0.9972737784147074}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=2.183790 (no previous merge yet)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.6075291633455594, 'auprc': 0.6182760182173133, 'loss_val': 1.7688943930215908, 'psi': 0.611827905294261}-{'f1_val': 0.6706594731817458, 'auprc': 0.9334135881802496, 'loss_val': 1.0169608216745176, 'psi': 0.7757611191811473}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.406226 cos_to_last_merge=0.9922 (last merge round=32)
[S14] round=85 local utility u=0.015225 metrics={'f1_val': 0.9793523261193479, 'auprc': 0.9991215850574888, 'loss_val': 0.06724984569252204, 'psi': 0.9872600296946042}-{'f1_val': 0.976501831142814, 'auprc': 0.9990844565093204, 'loss_val': 0.080484870053734, 'psi': 0.9855348812894166}
[S14] not sending this round → trigger blocked (psi=0.987)
[S15] START round=85 head_norm_before_train=2.375477 cos_to_last_merge=0.9644 (last merge round=39)
[S15] round=85 local utility u=0.000372 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9971183065675547, 'loss_val': 0.07476741861641052, 'psi': 0.9767745659994745}-{'f1_val': 0.9632120722874211, 'auprc': 0.9971164004019184, 'loss_val': 0.07550655755718877, 'psi': 0.97677380353322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=85 head_norm_before_train=2.033881 cos_to_last_merge=0.9909 (last merge round=39)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.8561616769330607, 'auprc': 0.9878568762812933, 'loss_val': 1.0928351490556143, 'psi': 0.9088397566723537}-{'f1_val': 0.8698793026106095, 'auprc': 0.9907645545754923, 'loss_val': 0.6877546095092572, 'psi': 0.9182334033965626}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.464354 cos_to_last_merge=0.9975 (last merge round=41)
[S17] round=85 local utility u=0.032948 metrics={'f1_val': 0.8815886359913272, 'auprc': 0.957511475892958, 'loss_val': 0.6755728185111933, 'psi': 0.9119577719519796}-{'f1_val': 0.8917969884583986, 'auprc': 0.9058061383177523, 'loss_val': 0.6476037592641964, 'psi': 0.8974006484021401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=86 head_norm_before_train=2.154885 cos_to_last_merge=0.9944 (last merge round=38)
[S2] round=86 local utility u=0.835642 metrics={'f1_val': 0.8275933155325034, 'auprc': 0.9916624152418579, 'loss_val': 0.3814012828260922, 'psi': 0.8932209554162451}-{'f1_val': 0.7377762142584119, 'auprc': 0.808943026227498, 'loss_val': 0.9656240640345057, 'psi': 0.7662429390460463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=86 head_norm_before_train=2.402775 cos_to_last_merge=0.9804 (last merge round=34)
[S3] round=86 local utility u=0.452619 metrics={'f1_val': 0.9982526394021946, 'auprc': 0.9999698072411762, 'loss_val': 0.011590865463380463, 'psi': 0.9989395065377873}-{'f1_val': 0.9148781391321615, 'auprc': 0.9580168104262574, 'loss_val': 0.2907221091464316, 'psi': 0.9321336076497999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=86 head_norm_before_train=2.008442 cos_to_last_merge=0.9594 (last merge round=34)
[S4] round=86 local utility u=0.053323 metrics={'f1_val': 0.9403776628998084, 'auprc': 0.9743416409695804, 'loss_val': 0.32863605855256395, 'psi': 0.9539632541277172}-{'f1_val': 0.9387196498086724, 'auprc': 0.948714108440494, 'loss_val': 0.34845202415929105, 'psi': 0.942717433261401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=86 head_norm_before_train=2.031485 cos_to_last_merge=0.9916 (last merge round=35)
[S5] round=86 local utility u=0.908201 metrics={'f1_val': 0.9440540276352589, 'auprc': 0.9951190733334963, 'loss_val': 0.12055951754928719, 'psi': 0.9644800459145538}-{'f1_val': 0.7004932948021524, 'auprc': 0.9685005025194879, 'loss_val': 0.39574204784025935, 'psi': 0.8076961778890867}
[S5] not sending this round → trigger blocked (psi=0.964)
[S6] START round=86 head_norm_before_train=2.353477 (no previous merge yet)
[S6] round=86 local utility u=1.000000 metrics={'f1_val': 0.8421021874306187, 'auprc': 0.9420123167851104, 'loss_val': 0.6473719623681021, 'psi': 0.8820662391724154}-{'f1_val': 0.6069500741609262, 'auprc': 0.6854226706845665, 'loss_val': 1.4838673295229399, 'psi': 0.6383391127703824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=86 head_norm_before_train=1.833996 cos_to_last_merge=0.9875 (last merge round=40)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.5762325952147186, 'auprc': 0.7760778522761944, 'loss_val': 0.9740854093613189, 'psi': 0.6561706980393089}-{'f1_val': 0.6665790751176096, 'auprc': 0.7964138856698785, 'loss_val': 0.5551636333844553, 'psi': 0.7185129993385171}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=1.957790 cos_to_last_merge=0.9766 (last merge round=33)
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.9739509605604653, 'auprc': 0.9948251279254394, 'loss_val': 0.07802792953013081, 'psi': 0.9823006275064549}-{'f1_val': 0.9925164355995088, 'auprc': 0.9991800599367985, 'loss_val': 0.033159600072036576, 'psi': 0.9951818853344245}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=2.224102 (no previous merge yet)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9988018882845917, 'loss_val': 0.016409191023569136, 'psi': 0.9972833727520803}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988485788878702, 'loss_val': 0.01609533970410375, 'psi': 0.9975357386434829}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.486054 cos_to_last_merge=0.9848 (last merge round=33)
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9945518619576347, 'loss_val': 0.03216036492114201, 'psi': 0.9938803696755973}-{'f1_val': 0.9940903254969471, 'auprc': 0.9940990034811324, 'loss_val': 0.031305758258752564, 'psi': 0.9940937966906213}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=2.440229 cos_to_last_merge=0.9972 (last merge round=41)
[S11] round=86 local utility u=0.023098 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985536049909328, 'loss_val': 0.0198225704463207, 'psi': 0.9971139268428204}-{'f1_val': 0.9911228970469197, 'auprc': 0.9985832402112871, 'loss_val': 0.035919706377354844, 'psi': 0.9941070343126667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=86 head_norm_before_train=2.192981 (no previous merge yet)
[S13] round=86 local utility u=0.583249 metrics={'f1_val': 0.6872771059059923, 'auprc': 0.7003382847158489, 'loss_val': 1.3270716297693899, 'psi': 0.692501577429935}-{'f1_val': 0.6075291633455594, 'auprc': 0.6182760182173133, 'loss_val': 1.7688943930215908, 'psi': 0.611827905294261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=86 head_norm_before_train=2.409189 cos_to_last_merge=0.9922 (last merge round=32)
[S14] round=86 local utility u=0.014277 metrics={'f1_val': 0.9806544189294047, 'auprc': 0.9974263366863948, 'loss_val': 0.04142244831430407, 'psi': 0.9873631860322007}-{'f1_val': 0.9793523261193479, 'auprc': 0.9991215850574888, 'loss_val': 0.06724984569252204, 'psi': 0.9872600296946042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=86 head_norm_before_train=2.381232 cos_to_last_merge=0.9641 (last merge round=39)
[S15] round=86 local utility u=0.000496 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9971269993221462, 'loss_val': 0.07380199954666933, 'psi': 0.9767780431013111}-{'f1_val': 0.9632120722874211, 'auprc': 0.9971183065675547, 'loss_val': 0.07476741861641052, 'psi': 0.9767745659994745}
[S15] not sending this round → trigger blocked (psi=0.977)
[S16] START round=86 head_norm_before_train=2.036911 cos_to_last_merge=0.9907 (last merge round=39)
[S16] round=86 local utility u=0.940995 metrics={'f1_val': 0.9923962992969761, 'auprc': 0.9911551699596395, 'loss_val': 0.03814753132179725, 'psi': 0.9918998475620415}-{'f1_val': 0.8561616769330607, 'auprc': 0.9878568762812933, 'loss_val': 1.0928351490556143, 'psi': 0.9088397566723537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=86 head_norm_before_train=2.468637 cos_to_last_merge=0.9974 (last merge round=41)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.8911233526489835, 'auprc': 0.9169856846604083, 'loss_val': 0.6666410825535766, 'psi': 0.9014682854535534}-{'f1_val': 0.8815886359913272, 'auprc': 0.957511475892958, 'loss_val': 0.6755728185111933, 'psi': 0.9119577719519796}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.160906 cos_to_last_merge=0.9944 (last merge round=38)
[S2] round=87 local utility u=0.000000 metrics={'f1_val': 0.827300244083455, 'auprc': 0.9870325197509471, 'loss_val': 0.3822014595309449, 'psi': 0.8911931543504519}-{'f1_val': 0.8275933155325034, 'auprc': 0.9916624152418579, 'loss_val': 0.3814012828260922, 'psi': 0.8932209554162451}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=87 head_norm_before_train=2.404988 cos_to_last_merge=0.9803 (last merge round=34)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.978218383865847, 'auprc': 0.9991284297432013, 'loss_val': 0.051286135928602775, 'psi': 0.9865824022167887}-{'f1_val': 0.9982526394021946, 'auprc': 0.9999698072411762, 'loss_val': 0.011590865463380463, 'psi': 0.9989395065377873}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=2.012749 cos_to_last_merge=0.9591 (last merge round=34)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9395980084015407, 'auprc': 0.9726412817583646, 'loss_val': 0.3336154614109458, 'psi': 0.9528153177442703}-{'f1_val': 0.9403776628998084, 'auprc': 0.9743416409695804, 'loss_val': 0.32863605855256395, 'psi': 0.9539632541277172}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=2.036612 cos_to_last_merge=0.9912 (last merge round=35)
[S5] round=87 local utility u=0.110883 metrics={'f1_val': 0.9783290615748205, 'auprc': 0.9949843784177754, 'loss_val': 0.10403941454643242, 'psi': 0.9849911883120024}-{'f1_val': 0.9440540276352589, 'auprc': 0.9951190733334963, 'loss_val': 0.12055951754928719, 'psi': 0.9644800459145538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=87 head_norm_before_train=2.355615 (no previous merge yet)
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.735867069906102, 'auprc': 0.9113500826646224, 'loss_val': 1.0148755586437372, 'psi': 0.8060602750095102}-{'f1_val': 0.8421021874306187, 'auprc': 0.9420123167851104, 'loss_val': 0.6473719623681021, 'psi': 0.8820662391724154}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.838865 cos_to_last_merge=0.9871 (last merge round=40)
[S7] round=87 local utility u=0.535502 metrics={'f1_val': 0.6534461751032581, 'auprc': 0.8022596245772735, 'loss_val': 0.444908965928928, 'psi': 0.7129715548928642}-{'f1_val': 0.5762325952147186, 'auprc': 0.7760778522761944, 'loss_val': 0.9740854093613189, 'psi': 0.6561706980393089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=87 head_norm_before_train=1.955070 cos_to_last_merge=0.9769 (last merge round=33)
[S8] round=87 local utility u=0.087859 metrics={'f1_val': 0.9941417884415487, 'auprc': 0.9983612114820647, 'loss_val': 0.0340639407503633, 'psi': 0.995829557657755}-{'f1_val': 0.9739509605604653, 'auprc': 0.9948251279254394, 'loss_val': 0.07802792953013081, 'psi': 0.9823006275064549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=87 head_norm_before_train=2.228196 (no previous merge yet)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9988272614865918, 'loss_val': 0.022228471665520444, 'psi': 0.9957940560372134}-{'f1_val': 0.9962710290637395, 'auprc': 0.9988018882845917, 'loss_val': 0.016409191023569136, 'psi': 0.9972833727520803}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.489401 cos_to_last_merge=0.9846 (last merge round=33)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9947483841113733, 'loss_val': 0.03281265856740682, 'psi': 0.9939589785370928}-{'f1_val': 0.9934327081542391, 'auprc': 0.9945518619576347, 'loss_val': 0.03216036492114201, 'psi': 0.9938803696755973}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=2.445807 cos_to_last_merge=0.9971 (last merge round=41)
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985334225037775, 'loss_val': 0.021451863872007114, 'psi': 0.9970935739494966}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985536049909328, 'loss_val': 0.0198225704463207, 'psi': 0.9971139268428204}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=2.195946 (no previous merge yet)
[S13] round=87 local utility u=0.252750 metrics={'f1_val': 0.7376868800717007, 'auprc': 0.7304367430140036, 'loss_val': 1.2143248853169588, 'psi': 0.7347868252486218}-{'f1_val': 0.6872771059059923, 'auprc': 0.7003382847158489, 'loss_val': 1.3270716297693899, 'psi': 0.692501577429935}
[S13] not sending this round → trigger blocked (psi=0.735)
[S14] START round=87 head_norm_before_train=2.412691 cos_to_last_merge=0.9921 (last merge round=32)
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.8688548415032475, 'auprc': 0.9329064187887615, 'loss_val': 0.3159373880995882, 'psi': 0.8944754724174531}-{'f1_val': 0.9806544189294047, 'auprc': 0.9974263366863948, 'loss_val': 0.04142244831430407, 'psi': 0.9873631860322007}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=2.387002 cos_to_last_merge=0.9638 (last merge round=39)
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9971652498494309, 'loss_val': 0.07459152130187195, 'psi': 0.976793343312225}-{'f1_val': 0.9632120722874211, 'auprc': 0.9971269993221462, 'loss_val': 0.07380199954666933, 'psi': 0.9767780431013111}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=2.041220 cos_to_last_merge=0.9906 (last merge round=39)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.7040996056450072, 'auprc': 0.893512723403431, 'loss_val': 1.3775509913685802, 'psi': 0.7798648527483767}-{'f1_val': 0.9923962992969761, 'auprc': 0.9911551699596395, 'loss_val': 0.03814753132179725, 'psi': 0.9918998475620415}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.471274 cos_to_last_merge=0.9973 (last merge round=41)
[S17] round=87 local utility u=0.011654 metrics={'f1_val': 0.8861698048804765, 'auprc': 0.9383461931802561, 'loss_val': 0.6776940621134111, 'psi': 0.9070403602003884}-{'f1_val': 0.8911233526489835, 'auprc': 0.9169856846604083, 'loss_val': 0.6666410825535766, 'psi': 0.9014682854535534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=88 head_norm_before_train=2.165524 cos_to_last_merge=0.9942 (last merge round=38)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.7852028513766547, 'auprc': 0.9901634853409103, 'loss_val': 0.40910632108560335, 'psi': 0.867187104962357}-{'f1_val': 0.827300244083455, 'auprc': 0.9870325197509471, 'loss_val': 0.3822014595309449, 'psi': 0.8911931543504519}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=2.407820 cos_to_last_merge=0.9802 (last merge round=34)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.941589502695287, 'auprc': 0.9798113114066254, 'loss_val': 0.18591710610547152, 'psi': 0.9568782261798223}-{'f1_val': 0.978218383865847, 'auprc': 0.9991284297432013, 'loss_val': 0.051286135928602775, 'psi': 0.9865824022167887}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=2.016382 cos_to_last_merge=0.9577 (last merge round=34)
[S4] round=88 local utility u=0.003345 metrics={'f1_val': 0.9415074168105009, 'auprc': 0.9707941297606997, 'loss_val': 0.33284013841430504, 'psi': 0.9532221019905804}-{'f1_val': 0.9395980084015407, 'auprc': 0.9726412817583646, 'loss_val': 0.3336154614109458, 'psi': 0.9528153177442703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=88 head_norm_before_train=2.041221 cos_to_last_merge=0.9909 (last merge round=35)
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.7550773512193258, 'auprc': 0.9710896817441703, 'loss_val': 0.26514381277839133, 'psi': 0.8414822834292637}-{'f1_val': 0.9783290615748205, 'auprc': 0.9949843784177754, 'loss_val': 0.10403941454643242, 'psi': 0.9849911883120024}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=2.360960 (no previous merge yet)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.5961893475316045, 'auprc': 0.8390868719098135, 'loss_val': 1.034357549143689, 'psi': 0.693348357282888}-{'f1_val': 0.735867069906102, 'auprc': 0.9113500826646224, 'loss_val': 1.0148755586437372, 'psi': 0.8060602750095102}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.841711 cos_to_last_merge=0.9868 (last merge round=40)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.6196627558380631, 'auprc': 0.7963672589309252, 'loss_val': 0.5197700220633688, 'psi': 0.6903445570752079}-{'f1_val': 0.6534461751032581, 'auprc': 0.8022596245772735, 'loss_val': 0.444908965928928, 'psi': 0.7129715548928642}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=1.960209 cos_to_last_merge=0.9768 (last merge round=33)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.8254844858481225, 'auprc': 0.9938535032057202, 'loss_val': 0.5545858758425916, 'psi': 0.8928320927911616}-{'f1_val': 0.9941417884415487, 'auprc': 0.9983612114820647, 'loss_val': 0.0340639407503633, 'psi': 0.995829557657755}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=2.231364 (no previous merge yet)
[S9] round=88 local utility u=0.011947 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9989136747407543, 'loss_val': 0.01592468670084051, 'psi': 0.9975617769846366}-{'f1_val': 0.9937719190709611, 'auprc': 0.9988272614865918, 'loss_val': 0.022228471665520444, 'psi': 0.9957940560372134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=88 head_norm_before_train=2.491863 cos_to_last_merge=0.9844 (last merge round=33)
[S10] round=88 local utility u=0.001417 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9943761636582213, 'loss_val': 0.031492873589657126, 'psi': 0.9940730930936155}-{'f1_val': 0.9934327081542391, 'auprc': 0.9947483841113733, 'loss_val': 0.03281265856740682, 'psi': 0.9939589785370928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=88 head_norm_before_train=2.451242 cos_to_last_merge=0.9971 (last merge round=41)
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985808353869061, 'loss_val': 0.023518539778127553, 'psi': 0.9971248190012096}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985334225037775, 'loss_val': 0.021451863872007114, 'psi': 0.9970935739494966}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=2.195537 (no previous merge yet)
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6322258146755776, 'auprc': 0.7063789651624615, 'loss_val': 1.358532260061504, 'psi': 0.6618870748703312}-{'f1_val': 0.7376868800717007, 'auprc': 0.7304367430140036, 'loss_val': 1.2143248853169588, 'psi': 0.7347868252486218}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=2.414243 cos_to_last_merge=0.9920 (last merge round=32)
[S14] round=88 local utility u=0.241759 metrics={'f1_val': 0.898533064681879, 'auprc': 0.9990808634907554, 'loss_val': 0.209011973257064, 'psi': 0.9387521842054296}-{'f1_val': 0.8688548415032475, 'auprc': 0.9329064187887615, 'loss_val': 0.3159373880995882, 'psi': 0.8944754724174531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=88 head_norm_before_train=2.392582 cos_to_last_merge=0.9634 (last merge round=39)
[S15] round=88 local utility u=0.000882 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.997146430644465, 'loss_val': 0.07277139737070433, 'psi': 0.9767858156302386}-{'f1_val': 0.9632120722874211, 'auprc': 0.9971652498494309, 'loss_val': 0.07459152130187195, 'psi': 0.976793343312225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=88 head_norm_before_train=2.046295 cos_to_last_merge=0.9904 (last merge round=39)
[S16] round=88 local utility u=1.000000 metrics={'f1_val': 0.9927118241417867, 'auprc': 0.9906065570788773, 'loss_val': 0.032807065154722564, 'psi': 0.991869717316623}-{'f1_val': 0.7040996056450072, 'auprc': 0.893512723403431, 'loss_val': 1.3775509913685802, 'psi': 0.7798648527483767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=88 head_norm_before_train=2.472261 cos_to_last_merge=0.9973 (last merge round=41)
[S17] round=88 local utility u=0.111957 metrics={'f1_val': 0.9048685048053204, 'auprc': 0.9555447927619266, 'loss_val': 0.6175675479905803, 'psi': 0.925139019987963}-{'f1_val': 0.8861698048804765, 'auprc': 0.9383461931802561, 'loss_val': 0.6776940621134111, 'psi': 0.9070403602003884}
[S17] not sending this round → trigger blocked (psi=0.925)
[S2] START round=89 head_norm_before_train=2.173091 cos_to_last_merge=0.9940 (last merge round=38)
[S2] round=89 local utility u=0.115413 metrics={'f1_val': 0.8255782202424351, 'auprc': 0.9787636765812927, 'loss_val': 0.38633305962669867, 'psi': 0.8868524027779782}-{'f1_val': 0.7852028513766547, 'auprc': 0.9901634853409103, 'loss_val': 0.40910632108560335, 'psi': 0.867187104962357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=89 head_norm_before_train=2.411365 cos_to_last_merge=0.9800 (last merge round=34)
[S3] round=89 local utility u=0.058112 metrics={'f1_val': 0.9447095545766785, 'auprc': 0.9970426180471208, 'loss_val': 0.14010637633640724, 'psi': 0.9656427799648555}-{'f1_val': 0.941589502695287, 'auprc': 0.9798113114066254, 'loss_val': 0.18591710610547152, 'psi': 0.9568782261798223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=89 head_norm_before_train=2.022026 cos_to_last_merge=0.9568 (last merge round=34)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9415875734994066, 'auprc': 0.9692391083254809, 'loss_val': 0.339672996845598, 'psi': 0.9526481874298363}-{'f1_val': 0.9415074168105009, 'auprc': 0.9707941297606997, 'loss_val': 0.33284013841430504, 'psi': 0.9532221019905804}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=2.049033 cos_to_last_merge=0.9900 (last merge round=35)
[S5] round=89 local utility u=0.539494 metrics={'f1_val': 0.9016748057109387, 'auprc': 0.9904245058930291, 'loss_val': 0.12374530435987328, 'psi': 0.9371746857837748}-{'f1_val': 0.7550773512193258, 'auprc': 0.9710896817441703, 'loss_val': 0.26514381277839133, 'psi': 0.8414822834292637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=89 head_norm_before_train=2.361228 (no previous merge yet)
[S6] round=89 local utility u=0.798410 metrics={'f1_val': 0.7626525971718463, 'auprc': 0.9052920647938991, 'loss_val': 0.6349320476744607, 'psi': 0.8197083842206674}-{'f1_val': 0.5961893475316045, 'auprc': 0.8390868719098135, 'loss_val': 1.034357549143689, 'psi': 0.693348357282888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=89 head_norm_before_train=1.844650 cos_to_last_merge=0.9865 (last merge round=40)
[S7] round=89 local utility u=0.024697 metrics={'f1_val': 0.6254669237974537, 'auprc': 0.8004316160809278, 'loss_val': 0.5173939275892785, 'psi': 0.6954528007108434}-{'f1_val': 0.6196627558380631, 'auprc': 0.7963672589309252, 'loss_val': 0.5197700220633688, 'psi': 0.6903445570752079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=89 head_norm_before_train=1.965306 cos_to_last_merge=0.9765 (last merge round=33)
[S8] round=89 local utility u=0.599430 metrics={'f1_val': 0.9492571405625677, 'auprc': 0.9912265009050303, 'loss_val': 0.09048112100802548, 'psi': 0.9660448846995527}-{'f1_val': 0.8254844858481225, 'auprc': 0.9938535032057202, 'loss_val': 0.5545858758425916, 'psi': 0.8928320927911616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=89 head_norm_before_train=2.234016 (no previous merge yet)
[S9] round=89 local utility u=0.001438 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992103671183612, 'loss_val': 0.016593844140481227, 'psi': 0.9979458943546302}-{'f1_val': 0.9966605118138915, 'auprc': 0.9989136747407543, 'loss_val': 0.01592468670084051, 'psi': 0.9975617769846366}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=89 head_norm_before_train=2.496326 cos_to_last_merge=0.9842 (last merge round=33)
[S10] round=89 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9944306864391815, 'loss_val': 0.03167383155048966, 'psi': 0.9940949022059996}-{'f1_val': 0.993871046050545, 'auprc': 0.9943761636582213, 'loss_val': 0.031492873589657126, 'psi': 0.9940730930936155}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=89 head_norm_before_train=2.452559 cos_to_last_merge=0.9969 (last merge round=41)
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9877962298983122, 'auprc': 0.9968805212935088, 'loss_val': 0.06418076711723214, 'psi': 0.9914299464563908}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985808353869061, 'loss_val': 0.023518539778127553, 'psi': 0.9971248190012096}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=2.198893 (no previous merge yet)
[S13] round=89 local utility u=0.366588 metrics={'f1_val': 0.7370317112580373, 'auprc': 0.7185638463240804, 'loss_val': 1.2907465153425233, 'psi': 0.7296445652844545}-{'f1_val': 0.6322258146755776, 'auprc': 0.7063789651624615, 'loss_val': 1.358532260061504, 'psi': 0.6618870748703312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=89 head_norm_before_train=2.414550 cos_to_last_merge=0.9919 (last merge round=32)
[S14] round=89 local utility u=0.338925 metrics={'f1_val': 0.9847702260371014, 'auprc': 0.999097309208718, 'loss_val': 0.04863403518280473, 'psi': 0.990501059305748}-{'f1_val': 0.898533064681879, 'auprc': 0.9990808634907554, 'loss_val': 0.209011973257064, 'psi': 0.9387521842054296}
[S14] not sending this round → trigger blocked (psi=0.991)
[S15] START round=89 head_norm_before_train=2.398144 cos_to_last_merge=0.9631 (last merge round=39)
[S15] round=89 local utility u=0.001539 metrics={'f1_val': 0.963671457910184, 'auprc': 0.9971672581042761, 'loss_val': 0.07251189620349864, 'psi': 0.9770697779878209}-{'f1_val': 0.9632120722874211, 'auprc': 0.997146430644465, 'loss_val': 0.07277139737070433, 'psi': 0.9767858156302386}
[S15] not sending this round → trigger blocked (psi=0.977)
[S16] START round=89 head_norm_before_train=2.050923 cos_to_last_merge=0.9903 (last merge round=39)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9447301815028526, 'auprc': 0.9755899123382752, 'loss_val': 0.29236108487249746, 'psi': 0.9570740738370216}-{'f1_val': 0.9927118241417867, 'auprc': 0.9906065570788773, 'loss_val': 0.032807065154722564, 'psi': 0.991869717316623}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=2.475713 cos_to_last_merge=0.9973 (last merge round=41)
[S17] round=89 local utility u=0.015538 metrics={'f1_val': 0.9091022301710097, 'auprc': 0.9523715896507836, 'loss_val': 0.6023745332777672, 'psi': 0.9264099739629192}-{'f1_val': 0.9048685048053204, 'auprc': 0.9555447927619266, 'loss_val': 0.6175675479905803, 'psi': 0.925139019987963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=90 head_norm_before_train=2.176317 cos_to_last_merge=0.9935 (last merge round=38)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.8078470770029058, 'auprc': 0.9282602763552166, 'loss_val': 0.43307763472275573, 'psi': 0.8560123567438301}-{'f1_val': 0.8255782202424351, 'auprc': 0.9787636765812927, 'loss_val': 0.38633305962669867, 'psi': 0.8868524027779782}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.415807 cos_to_last_merge=0.9797 (last merge round=34)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.9140948883992921, 'auprc': 0.9961008072980833, 'loss_val': 0.2180759654083813, 'psi': 0.9468972559588085}-{'f1_val': 0.9447095545766785, 'auprc': 0.9970426180471208, 'loss_val': 0.14010637633640724, 'psi': 0.9656427799648555}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=2.030894 cos_to_last_merge=0.9565 (last merge round=34)
[S4] round=90 local utility u=0.005691 metrics={'f1_val': 0.9417257466902322, 'auprc': 0.9722685025362674, 'loss_val': 0.3382088158165829, 'psi': 0.9539428490286463}-{'f1_val': 0.9415875734994066, 'auprc': 0.9692391083254809, 'loss_val': 0.339672996845598, 'psi': 0.9526481874298363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=90 head_norm_before_train=2.056256 cos_to_last_merge=0.9892 (last merge round=35)
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.7056098528398739, 'auprc': 0.9792512005897973, 'loss_val': 0.2936765792404675, 'psi': 0.8150663919398433}-{'f1_val': 0.9016748057109387, 'auprc': 0.9904245058930291, 'loss_val': 0.12374530435987328, 'psi': 0.9371746857837748}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=2.365783 (no previous merge yet)
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.7196422492413044, 'auprc': 0.9278713693406317, 'loss_val': 1.0382502341336504, 'psi': 0.8029338972810354}-{'f1_val': 0.7626525971718463, 'auprc': 0.9052920647938991, 'loss_val': 0.6349320476744607, 'psi': 0.8197083842206674}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=1.850204 cos_to_last_merge=0.9860 (last merge round=40)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.594355638432885, 'auprc': 0.7852538142007621, 'loss_val': 0.8105045440968481, 'psi': 0.6707149087400358}-{'f1_val': 0.6254669237974537, 'auprc': 0.8004316160809278, 'loss_val': 0.5173939275892785, 'psi': 0.6954528007108434}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=1.971088 cos_to_last_merge=0.9761 (last merge round=33)
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.6533212181335225, 'auprc': 0.9938407374679861, 'loss_val': 1.2152376292104359, 'psi': 0.789529025867308}-{'f1_val': 0.9492571405625677, 'auprc': 0.9912265009050303, 'loss_val': 0.09048112100802548, 'psi': 0.9660448846995527}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=90 head_norm_before_train=2.238999 (no previous merge yet)
[S9] round=90 local utility u=0.000023 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992131627952215, 'loss_val': 0.016555563847834895, 'psi': 0.9979470126253743}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992103671183612, 'loss_val': 0.016593844140481227, 'psi': 0.9979458943546302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=90 head_norm_before_train=2.500916 cos_to_last_merge=0.9840 (last merge round=33)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946896474868019, 'loss_val': 0.032309952667393046, 'psi': 0.9939354838872643}-{'f1_val': 0.993871046050545, 'auprc': 0.9944306864391815, 'loss_val': 0.03167383155048966, 'psi': 0.9940949022059996}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=2.453644 cos_to_last_merge=0.9968 (last merge round=41)
[S11] round=90 local utility u=0.045821 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985681031381731, 'loss_val': 0.02774980159585049, 'psi': 0.9971197261017165}-{'f1_val': 0.9877962298983122, 'auprc': 0.9968805212935088, 'loss_val': 0.06418076711723214, 'psi': 0.9914299464563908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=90 head_norm_before_train=2.206115 (no previous merge yet)
[S13] round=90 local utility u=0.160827 metrics={'f1_val': 0.7375363614550468, 'auprc': 0.7629609994601251, 'loss_val': 1.1053127709338497, 'psi': 0.747706216657078}-{'f1_val': 0.7370317112580373, 'auprc': 0.7185638463240804, 'loss_val': 1.2907465153425233, 'psi': 0.7296445652844545}
[S13] not sending this round → trigger blocked (psi=0.748)
[S14] START round=90 head_norm_before_train=2.418048 cos_to_last_merge=0.9917 (last merge round=32)
[S14] round=90 local utility u=0.054985 metrics={'f1_val': 0.997844401637113, 'auprc': 0.9991709919207485, 'loss_val': 0.017330907947092397, 'psi': 0.9983750377505672}-{'f1_val': 0.9847702260371014, 'auprc': 0.999097309208718, 'loss_val': 0.04863403518280473, 'psi': 0.990501059305748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=90 head_norm_before_train=2.403553 cos_to_last_merge=0.9628 (last merge round=39)
[S15] round=90 local utility u=0.000210 metrics={'f1_val': 0.963671457910184, 'auprc': 0.997159151781981, 'loss_val': 0.07206799790061236, 'psi': 0.9770665354589029}-{'f1_val': 0.963671457910184, 'auprc': 0.9971672581042761, 'loss_val': 0.07251189620349864, 'psi': 0.9770697779878209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=90 head_norm_before_train=2.054675 cos_to_last_merge=0.9901 (last merge round=39)
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9144218597479468, 'auprc': 0.9776410671298698, 'loss_val': 0.4924668099086578, 'psi': 0.939709542700716}-{'f1_val': 0.9447301815028526, 'auprc': 0.9755899123382752, 'loss_val': 0.29236108487249746, 'psi': 0.9570740738370216}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=2.482654 cos_to_last_merge=0.9972 (last merge round=41)
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.9091022301710097, 'auprc': 0.9480869885998562, 'loss_val': 0.604861912324405, 'psi': 0.9246961335425483}-{'f1_val': 0.9091022301710097, 'auprc': 0.9523715896507836, 'loss_val': 0.6023745332777672, 'psi': 0.9264099739629192}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.179987 cos_to_last_merge=0.9932 (last merge round=38)
[S2] round=91 local utility u=0.146869 metrics={'f1_val': 0.8157360883326754, 'auprc': 0.9879562091463214, 'loss_val': 0.36576167514544045, 'psi': 0.8846241366581338}-{'f1_val': 0.8078470770029058, 'auprc': 0.9282602763552166, 'loss_val': 0.43307763472275573, 'psi': 0.8560123567438301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=91 head_norm_before_train=2.420649 cos_to_last_merge=0.9793 (last merge round=34)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.8244004679876649, 'auprc': 0.9656446179556142, 'loss_val': 0.5918024744137974, 'psi': 0.8808981279748447}-{'f1_val': 0.9140948883992921, 'auprc': 0.9961008072980833, 'loss_val': 0.2180759654083813, 'psi': 0.9468972559588085}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=2.037289 cos_to_last_merge=0.9559 (last merge round=34)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9391132347130705, 'auprc': 0.9549600071388887, 'loss_val': 0.3403344940843621, 'psi': 0.9454519436833977}-{'f1_val': 0.9417257466902322, 'auprc': 0.9722685025362674, 'loss_val': 0.3382088158165829, 'psi': 0.9539428490286463}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=2.064099 cos_to_last_merge=0.9882 (last merge round=35)
[S5] round=91 local utility u=0.563681 metrics={'f1_val': 0.903998061851589, 'auprc': 0.9672285269457536, 'loss_val': 0.3205759163417302, 'psi': 0.9292902478892549}-{'f1_val': 0.7056098528398739, 'auprc': 0.9792512005897973, 'loss_val': 0.2936765792404675, 'psi': 0.8150663919398433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=91 head_norm_before_train=2.379039 (no previous merge yet)
[S6] round=91 local utility u=0.473426 metrics={'f1_val': 0.7940855803694797, 'auprc': 0.9346469789838093, 'loss_val': 0.5583841088725885, 'psi': 0.8503101398152115}-{'f1_val': 0.7196422492413044, 'auprc': 0.9278713693406317, 'loss_val': 1.0382502341336504, 'psi': 0.8029338972810354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=91 head_norm_before_train=1.853853 cos_to_last_merge=0.9858 (last merge round=40)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.5760632690375744, 'auprc': 0.7808670736316928, 'loss_val': 0.9359231444029451, 'psi': 0.6579847908752219}-{'f1_val': 0.594355638432885, 'auprc': 0.7852538142007621, 'loss_val': 0.8105045440968481, 'psi': 0.6707149087400358}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=1.976916 cos_to_last_merge=0.9760 (last merge round=33)
[S8] round=91 local utility u=1.000000 metrics={'f1_val': 0.9950246274718425, 'auprc': 0.9988346776055652, 'loss_val': 0.02519179796062013, 'psi': 0.9965486475253316}-{'f1_val': 0.6533212181335225, 'auprc': 0.9938407374679861, 'loss_val': 1.2152376292104359, 'psi': 0.789529025867308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=91 head_norm_before_train=2.242901 (no previous merge yet)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9874269136456545, 'auprc': 0.9992157555265833, 'loss_val': 0.04941509538653633, 'psi': 0.9921424503980261}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992131627952215, 'loss_val': 0.016555563847834895, 'psi': 0.9979470126253743}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.503181 cos_to_last_merge=0.9838 (last merge round=33)
[S10] round=91 local utility u=0.000007 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9946927762967303, 'loss_val': 0.032305668379147036, 'psi': 0.9939367354112356}-{'f1_val': 0.9934327081542391, 'auprc': 0.9946896474868019, 'loss_val': 0.032309952667393046, 'psi': 0.9939354838872643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] START round=91 head_norm_before_train=2.456352 cos_to_last_merge=0.9968 (last merge round=41)
[S11] round=91 local utility u=0.002551 metrics={'f1_val': 0.9959145417079399, 'auprc': 0.9985688721548109, 'loss_val': 0.021213381174202534, 'psi': 0.9969762738866883}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985681031381731, 'loss_val': 0.02774980159585049, 'psi': 0.9971197261017165}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=91 head_norm_before_train=2.205871 (no previous merge yet)
[S13] round=91 local utility u=0.168909 metrics={'f1_val': 0.744425430065764, 'auprc': 0.8459506062400739, 'loss_val': 1.0577970688901523, 'psi': 0.785035500535488}-{'f1_val': 0.7375363614550468, 'auprc': 0.7629609994601251, 'loss_val': 1.1053127709338497, 'psi': 0.747706216657078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=91 head_norm_before_train=2.420881 cos_to_last_merge=0.9914 (last merge round=32)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9034266796929296, 'auprc': 0.9970464273738291, 'loss_val': 0.20489593118068414, 'psi': 0.9408745787652893}-{'f1_val': 0.997844401637113, 'auprc': 0.9991709919207485, 'loss_val': 0.017330907947092397, 'psi': 0.9983750377505672}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=2.408830 cos_to_last_merge=0.9625 (last merge round=39)
[S15] round=91 local utility u=0.002432 metrics={'f1_val': 0.9641301409518149, 'auprc': 0.9971572551569153, 'loss_val': 0.06995108217101714, 'psi': 0.9773409866338552}-{'f1_val': 0.963671457910184, 'auprc': 0.997159151781981, 'loss_val': 0.07206799790061236, 'psi': 0.9770665354589029}
[S15] not sending this round → trigger blocked (psi=0.977)
[S16] START round=91 head_norm_before_train=2.058682 cos_to_last_merge=0.9900 (last merge round=39)
[S16] round=91 local utility u=0.239363 metrics={'f1_val': 0.946187546895029, 'auprc': 0.9862302660729663, 'loss_val': 0.230103299102454, 'psi': 0.962204634566204}-{'f1_val': 0.9144218597479468, 'auprc': 0.9776410671298698, 'loss_val': 0.4924668099086578, 'psi': 0.939709542700716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=91 head_norm_before_train=2.487488 cos_to_last_merge=0.9971 (last merge round=41)
[S17] round=91 local utility u=0.033447 metrics={'f1_val': 0.9093828661444293, 'auprc': 0.9807626696586087, 'loss_val': 0.6376781462749507, 'psi': 0.937934787550101}-{'f1_val': 0.9091022301710097, 'auprc': 0.9480869885998562, 'loss_val': 0.604861912324405, 'psi': 0.9246961335425483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=92 head_norm_before_train=2.183969 cos_to_last_merge=0.9928 (last merge round=38)
[S2] round=92 local utility u=0.050463 metrics={'f1_val': 0.8286104729384642, 'auprc': 0.9928751861405137, 'loss_val': 0.35683899770515387, 'psi': 0.8943163582192841}-{'f1_val': 0.8157360883326754, 'auprc': 0.9879562091463214, 'loss_val': 0.36576167514544045, 'psi': 0.8846241366581338}
[S2] not sending this round → trigger blocked (psi=0.894)
[S3] START round=92 head_norm_before_train=2.425503 cos_to_last_merge=0.9790 (last merge round=34)
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.7533252523054835, 'auprc': 0.9654043989800621, 'loss_val': 0.8563786115571745, 'psi': 0.838156910975315}-{'f1_val': 0.8244004679876649, 'auprc': 0.9656446179556142, 'loss_val': 0.5918024744137974, 'psi': 0.8808981279748447}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=2.041534 cos_to_last_merge=0.9551 (last merge round=34)
[S4] round=92 local utility u=0.039402 metrics={'f1_val': 0.9402814811773272, 'auprc': 0.9767500783499314, 'loss_val': 0.33390932351055774, 'psi': 0.9548689200463689}-{'f1_val': 0.9391132347130705, 'auprc': 0.9549600071388887, 'loss_val': 0.3403344940843621, 'psi': 0.9454519436833977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=92 head_norm_before_train=2.073715 cos_to_last_merge=0.9872 (last merge round=35)
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.7007816778637295, 'auprc': 0.9823160690613785, 'loss_val': 0.41452706585701943, 'psi': 0.8133954343427892}-{'f1_val': 0.903998061851589, 'auprc': 0.9672285269457536, 'loss_val': 0.3205759163417302, 'psi': 0.9292902478892549}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=2.384316 (no previous merge yet)
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.6646465557960222, 'auprc': 0.8453737058247687, 'loss_val': 1.0372472607256438, 'psi': 0.7369374158075208}-{'f1_val': 0.7940855803694797, 'auprc': 0.9346469789838093, 'loss_val': 0.5583841088725885, 'psi': 0.8503101398152115}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.857423 cos_to_last_merge=0.9855 (last merge round=40)
[S7] round=92 local utility u=0.172045 metrics={'f1_val': 0.5950541811518825, 'auprc': 0.7905903187981407, 'loss_val': 0.7349484794565226, 'psi': 0.6732686362103857}-{'f1_val': 0.5760632690375744, 'auprc': 0.7808670736316928, 'loss_val': 0.9359231444029451, 'psi': 0.6579847908752219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=92 head_norm_before_train=1.980614 cos_to_last_merge=0.9758 (last merge round=33)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.98271077898977, 'auprc': 0.9932827371944537, 'loss_val': 0.047799497744445175, 'psi': 0.9869395622716435}-{'f1_val': 0.9950246274718425, 'auprc': 0.9988346776055652, 'loss_val': 0.02519179796062013, 'psi': 0.9965486475253316}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=2.246162 (no previous merge yet)
[S9] round=92 local utility u=0.046097 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9992107492974422, 'loss_val': 0.01524502367215919, 'psi': 0.9979443294425149}-{'f1_val': 0.9874269136456545, 'auprc': 0.9992157555265833, 'loss_val': 0.04941509538653633, 'psi': 0.9921424503980261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=92 head_norm_before_train=2.507457 cos_to_last_merge=0.9836 (last merge round=33)
[S10] round=92 local utility u=0.001258 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9945274453595562, 'loss_val': 0.03192287734935835, 'psi': 0.9941336057741494}-{'f1_val': 0.9934327081542391, 'auprc': 0.9946927762967303, 'loss_val': 0.032305668379147036, 'psi': 0.9939367354112356}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=92 head_norm_before_train=2.460053 cos_to_last_merge=0.9968 (last merge round=41)
[S11] round=92 local utility u=0.001383 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985566085046488, 'loss_val': 0.01984779368965394, 'psi': 0.9971151282483067}-{'f1_val': 0.9959145417079399, 'auprc': 0.9985688721548109, 'loss_val': 0.021213381174202534, 'psi': 0.9969762738866883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] START round=92 head_norm_before_train=2.207899 (no previous merge yet)
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.671274817546262, 'auprc': 0.6923906981959216, 'loss_val': 1.3340322987016846, 'psi': 0.6797211698061258}-{'f1_val': 0.744425430065764, 'auprc': 0.8459506062400739, 'loss_val': 1.0577970688901523, 'psi': 0.785035500535488}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=2.420495 cos_to_last_merge=0.9911 (last merge round=32)
[S14] round=92 local utility u=0.296860 metrics={'f1_val': 0.9800839040582336, 'auprc': 0.9972992615329429, 'loss_val': 0.07187742410021579, 'psi': 0.9869700470481173}-{'f1_val': 0.9034266796929296, 'auprc': 0.9970464273738291, 'loss_val': 0.20489593118068414, 'psi': 0.9408745787652893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=92 head_norm_before_train=2.414059 cos_to_last_merge=0.9622 (last merge round=39)
[S15] round=92 local utility u=0.011134 metrics={'f1_val': 0.9673215186055643, 'auprc': 0.9971830824529329, 'loss_val': 0.06690854865516062, 'psi': 0.9792661441445117}-{'f1_val': 0.9641301409518149, 'auprc': 0.9971572551569153, 'loss_val': 0.06995108217101714, 'psi': 0.9773409866338552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=92 head_norm_before_train=2.063858 cos_to_last_merge=0.9898 (last merge round=39)
[S16] round=92 local utility u=0.209578 metrics={'f1_val': 0.9866454217405469, 'auprc': 0.9904934202430362, 'loss_val': 0.0664841310805687, 'psi': 0.9881846211415426}-{'f1_val': 0.946187546895029, 'auprc': 0.9862302660729663, 'loss_val': 0.230103299102454, 'psi': 0.962204634566204}
[S16] not sending this round → trigger blocked (psi=0.988)
[S17] START round=92 head_norm_before_train=2.491571 cos_to_last_merge=0.9971 (last merge round=41)
[S17] round=92 local utility u=0.000000 metrics={'f1_val': 0.9025186073224938, 'auprc': 0.9347057085943298, 'loss_val': 0.6285120514952117, 'psi': 0.9153934478312282}-{'f1_val': 0.9093828661444293, 'auprc': 0.9807626696586087, 'loss_val': 0.6376781462749507, 'psi': 0.937934787550101}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=93 head_norm_before_train=2.189412 cos_to_last_merge=0.9927 (last merge round=38)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.82706087427822, 'auprc': 0.9921104809084955, 'loss_val': 0.36862699225719825, 'psi': 0.8930807169303302}-{'f1_val': 0.8286104729384642, 'auprc': 0.9928751861405137, 'loss_val': 0.35683899770515387, 'psi': 0.8943163582192841}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.431096 cos_to_last_merge=0.9787 (last merge round=34)
[S3] round=93 local utility u=0.132295 metrics={'f1_val': 0.7817340505389723, 'auprc': 0.9734670372154152, 'loss_val': 0.7864291473046234, 'psi': 0.8584272452095494}-{'f1_val': 0.7533252523054835, 'auprc': 0.9654043989800621, 'loss_val': 0.8563786115571745, 'psi': 0.838156910975315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=93 head_norm_before_train=2.051111 cos_to_last_merge=0.9550 (last merge round=34)
[S4] round=93 local utility u=0.016081 metrics={'f1_val': 0.9446021520916562, 'auprc': 0.9775957604144812, 'loss_val': 0.3302086799850217, 'psi': 0.9577995954207863}-{'f1_val': 0.9402814811773272, 'auprc': 0.9767500783499314, 'loss_val': 0.33390932351055774, 'psi': 0.9548689200463689}
[S4] not sending this round → trigger blocked (psi=0.958)
[S5] START round=93 head_norm_before_train=2.080440 cos_to_last_merge=0.9865 (last merge round=35)
[S5] round=93 local utility u=1.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9982642347373265, 'loss_val': 0.045804214956978895, 'psi': 0.9973268749820052}-{'f1_val': 0.7007816778637295, 'auprc': 0.9823160690613785, 'loss_val': 0.41452706585701943, 'psi': 0.8133954343427892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=93 head_norm_before_train=2.390216 (no previous merge yet)
[S6] round=93 local utility u=0.798513 metrics={'f1_val': 0.7942703108923439, 'auprc': 0.9239241267892151, 'loss_val': 0.4536145648378874, 'psi': 0.8461318372510924}-{'f1_val': 0.6646465557960222, 'auprc': 0.8453737058247687, 'loss_val': 1.0372472607256438, 'psi': 0.7369374158075208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=93 head_norm_before_train=1.860272 cos_to_last_merge=0.9852 (last merge round=40)
[S7] round=93 local utility u=0.004113 metrics={'f1_val': 0.588168263151954, 'auprc': 0.7921566227554908, 'loss_val': 0.690106540289396, 'psi': 0.6697636069933688}-{'f1_val': 0.5950541811518825, 'auprc': 0.7905903187981407, 'loss_val': 0.7349484794565226, 'psi': 0.6732686362103857}
[S7] not sending this round → trigger blocked (psi=0.670)
[S8] START round=93 head_norm_before_train=1.981439 cos_to_last_merge=0.9755 (last merge round=33)
[S8] round=93 local utility u=0.055236 metrics={'f1_val': 0.9943205514018633, 'auprc': 0.9991783052802209, 'loss_val': 0.024673571972341612, 'psi': 0.9962636529532063}-{'f1_val': 0.98271077898977, 'auprc': 0.9932827371944537, 'loss_val': 0.047799497744445175, 'psi': 0.9869395622716435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=93 head_norm_before_train=2.251248 (no previous merge yet)
[S9] round=93 local utility u=0.000748 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998457255092067, 'loss_val': 0.015670765446525115, 'psi': 0.9982000377109683}-{'f1_val': 0.9971000495392299, 'auprc': 0.9992107492974422, 'loss_val': 0.01524502367215919, 'psi': 0.9979443294425149}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=93 head_norm_before_train=2.512393 cos_to_last_merge=0.9834 (last merge round=33)
[S10] round=93 local utility u=0.000091 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9945820967319271, 'loss_val': 0.03190436063940866, 'psi': 0.9941554663230978}-{'f1_val': 0.993871046050545, 'auprc': 0.9945274453595562, 'loss_val': 0.03192287734935835, 'psi': 0.9941336057741494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=93 head_norm_before_train=2.464790 cos_to_last_merge=0.9967 (last merge round=41)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985614696641725, 'loss_val': 0.021887884552471554, 'psi': 0.9971170727121162}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985566085046488, 'loss_val': 0.01984779368965394, 'psi': 0.9971151282483067}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=2.215722 (no previous merge yet)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.5936684808320493, 'auprc': 0.5900898645805002, 'loss_val': 1.8363530464280475, 'psi': 0.5922370343314296}-{'f1_val': 0.671274817546262, 'auprc': 0.6923906981959216, 'loss_val': 1.3340322987016846, 'psi': 0.6797211698061258}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.424082 cos_to_last_merge=0.9910 (last merge round=32)
[S14] round=93 local utility u=0.081847 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9991608760472531, 'loss_val': 0.017866376179969178, 'psi': 0.9981245324812571}-{'f1_val': 0.9800839040582336, 'auprc': 0.9972992615329429, 'loss_val': 0.07187742410021579, 'psi': 0.9869700470481173}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=93 head_norm_before_train=2.419277 cos_to_last_merge=0.9619 (last merge round=39)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.9668676642864944, 'auprc': 0.9971387904858992, 'loss_val': 0.0678543907106272, 'psi': 0.9789761147662562}-{'f1_val': 0.9673215186055643, 'auprc': 0.9971830824529329, 'loss_val': 0.06690854865516062, 'psi': 0.9792661441445117}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=2.067292 cos_to_last_merge=0.9896 (last merge round=39)
[S16] round=93 local utility u=0.027541 metrics={'f1_val': 0.9910543450369288, 'auprc': 0.9918800597044235, 'loss_val': 0.04201533036764323, 'psi': 0.9913846309039267}-{'f1_val': 0.9866454217405469, 'auprc': 0.9904934202430362, 'loss_val': 0.0664841310805687, 'psi': 0.9881846211415426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=93 head_norm_before_train=2.492080 cos_to_last_merge=0.9970 (last merge round=41)
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.8933486277425882, 'auprc': 0.9127306002265005, 'loss_val': 0.669491480211555, 'psi': 0.9011014167361532}-{'f1_val': 0.9025186073224938, 'auprc': 0.9347057085943298, 'loss_val': 0.6285120514952117, 'psi': 0.9153934478312282}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=94 head_norm_before_train=2.197149 cos_to_last_merge=0.9927 (last merge round=38)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.7121704057670304, 'auprc': 0.9907379485179354, 'loss_val': 0.4676157736859935, 'psi': 0.8235974228673923}-{'f1_val': 0.82706087427822, 'auprc': 0.9921104809084955, 'loss_val': 0.36862699225719825, 'psi': 0.8930807169303302}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.436440 cos_to_last_merge=0.9783 (last merge round=34)
[S3] round=94 local utility u=0.230037 metrics={'f1_val': 0.8248250469118364, 'auprc': 0.9716097587647751, 'loss_val': 0.5793295532588469, 'psi': 0.8835389316530119}-{'f1_val': 0.7817340505389723, 'auprc': 0.9734670372154152, 'loss_val': 0.7864291473046234, 'psi': 0.8584272452095494}
[S3] not sending this round → trigger blocked (psi=0.884)
[S4] START round=94 head_norm_before_train=2.054406 cos_to_last_merge=0.9541 (last merge round=34)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9438610079740981, 'auprc': 0.9781311089506303, 'loss_val': 0.3304420062058816, 'psi': 0.957569048364711}-{'f1_val': 0.9446021520916562, 'auprc': 0.9775957604144812, 'loss_val': 0.3302086799850217, 'psi': 0.9577995954207863}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=2.083302 cos_to_last_merge=0.9861 (last merge round=35)
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9339505327353211, 'auprc': 0.9881743631174027, 'loss_val': 0.12731859894840405, 'psi': 0.9556400648881538}-{'f1_val': 0.9967019684784577, 'auprc': 0.9982642347373265, 'loss_val': 0.045804214956978895, 'psi': 0.9973268749820052}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=2.397408 (no previous merge yet)
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.6286103441153857, 'auprc': 0.8531778353747677, 'loss_val': 1.1781530688348794, 'psi': 0.7184373406191384}-{'f1_val': 0.7942703108923439, 'auprc': 0.9239241267892151, 'loss_val': 0.4536145648378874, 'psi': 0.8461318372510924}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.861972 cos_to_last_merge=0.9851 (last merge round=40)
[S7] round=94 local utility u=0.374918 metrics={'f1_val': 0.679253940676001, 'auprc': 0.8014117471769443, 'loss_val': 0.5145508071416395, 'psi': 0.7281170632763783}-{'f1_val': 0.588168263151954, 'auprc': 0.7921566227554908, 'loss_val': 0.690106540289396, 'psi': 0.6697636069933688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=94 head_norm_before_train=1.987824 cos_to_last_merge=0.9753 (last merge round=33)
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.8803466964913309, 'auprc': 0.9939951210487058, 'loss_val': 0.284817591258883, 'psi': 0.9258060663142809}-{'f1_val': 0.9943205514018633, 'auprc': 0.9991783052802209, 'loss_val': 0.024673571972341612, 'psi': 0.9962636529532063}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=94 head_norm_before_train=2.257285 (no previous merge yet)
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9992009162646994, 'loss_val': 0.04052653077036324, 'psi': 0.99315770235186}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998457255092067, 'loss_val': 0.015670765446525115, 'psi': 0.9982000377109683}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.514888 cos_to_last_merge=0.9832 (last merge round=33)
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9947800122264512, 'loss_val': 0.03260489822151099, 'psi': 0.993971629783124}-{'f1_val': 0.993871046050545, 'auprc': 0.9945820967319271, 'loss_val': 0.03190436063940866, 'psi': 0.9941554663230978}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.468696 cos_to_last_merge=0.9967 (last merge round=41)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9968650385170293, 'loss_val': 0.039437999779679676, 'psi': 0.996438500253259}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985614696641725, 'loss_val': 0.021887884552471554, 'psi': 0.9971170727121162}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=2.222240 (no previous merge yet)
[S13] round=94 local utility u=1.000000 metrics={'f1_val': 0.7395103906282716, 'auprc': 0.8175808162895601, 'loss_val': 1.0252151426755363, 'psi': 0.770738560892787}-{'f1_val': 0.5936684808320493, 'auprc': 0.5900898645805002, 'loss_val': 1.8363530464280475, 'psi': 0.5922370343314296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=94 head_norm_before_train=2.429354 cos_to_last_merge=0.9910 (last merge round=32)
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9989408623314888, 'loss_val': 0.018324504679827467, 'psi': 0.9977903585391424}-{'f1_val': 0.9974336367705932, 'auprc': 0.9991608760472531, 'loss_val': 0.017866376179969178, 'psi': 0.9981245324812571}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=2.424341 cos_to_last_merge=0.9616 (last merge round=39)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9664131296232913, 'auprc': 0.9971534914744299, 'loss_val': 0.0683169188509884, 'psi': 0.9787092743637467}-{'f1_val': 0.9668676642864944, 'auprc': 0.9971387904858992, 'loss_val': 0.0678543907106272, 'psi': 0.9789761147662562}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.067887 cos_to_last_merge=0.9895 (last merge round=39)
[S16] round=94 local utility u=0.007487 metrics={'f1_val': 0.9916416708466298, 'auprc': 0.9950408986558634, 'loss_val': 0.04004688120982711, 'psi': 0.9930013619703232}-{'f1_val': 0.9910543450369288, 'auprc': 0.9918800597044235, 'loss_val': 0.04201533036764323, 'psi': 0.9913846309039267}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=94 head_norm_before_train=2.494913 cos_to_last_merge=0.9969 (last merge round=41)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.8918178672488031, 'auprc': 0.901434804682425, 'loss_val': 0.6810717033942113, 'psi': 0.8956646422222518}-{'f1_val': 0.8933486277425882, 'auprc': 0.9127306002265005, 'loss_val': 0.669491480211555, 'psi': 0.9011014167361532}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.206374 cos_to_last_merge=0.9927 (last merge round=38)
[S2] round=95 local utility u=0.397758 metrics={'f1_val': 0.8270324769014605, 'auprc': 0.9928469068126868, 'loss_val': 0.3676000151600392, 'psi': 0.893358248865951}-{'f1_val': 0.7121704057670304, 'auprc': 0.9907379485179354, 'loss_val': 0.4676157736859935, 'psi': 0.8235974228673923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=95 head_norm_before_train=2.441800 cos_to_last_merge=0.9779 (last merge round=34)
[S3] round=95 local utility u=0.558365 metrics={'f1_val': 0.9325419571142808, 'auprc': 0.992221849440973, 'loss_val': 0.17073778546224927, 'psi': 0.9564139140449577}-{'f1_val': 0.8248250469118364, 'auprc': 0.9716097587647751, 'loss_val': 0.5793295532588469, 'psi': 0.8835389316530119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=95 head_norm_before_train=2.059308 cos_to_last_merge=0.9539 (last merge round=34)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9423192423522234, 'auprc': 0.9583313054644069, 'loss_val': 0.34477668417842744, 'psi': 0.9487240675970969}-{'f1_val': 0.9438610079740981, 'auprc': 0.9781311089506303, 'loss_val': 0.3304420062058816, 'psi': 0.957569048364711}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=2.085065 cos_to_last_merge=0.9860 (last merge round=35)
[S5] round=95 local utility u=0.239528 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9956808466152192, 'loss_val': 0.04729120371850491, 'psi': 0.9962935197331623}-{'f1_val': 0.9339505327353211, 'auprc': 0.9881743631174027, 'loss_val': 0.12731859894840405, 'psi': 0.9556400648881538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=95 head_norm_before_train=2.401582 (no previous merge yet)
[S6] round=95 local utility u=1.000000 metrics={'f1_val': 0.9603002069338815, 'auprc': 0.9694808775617093, 'loss_val': 0.182168804620693, 'psi': 0.9639724751850127}-{'f1_val': 0.6286103441153857, 'auprc': 0.8531778353747677, 'loss_val': 1.1781530688348794, 'psi': 0.7184373406191384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=95 head_norm_before_train=1.864882 cos_to_last_merge=0.9846 (last merge round=40)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.6233991466411376, 'auprc': 0.8016088249603679, 'loss_val': 0.5262603929729243, 'psi': 0.6946830179688297}-{'f1_val': 0.679253940676001, 'auprc': 0.8014117471769443, 'loss_val': 0.5145508071416395, 'psi': 0.7281170632763783}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=1.992865 cos_to_last_merge=0.9752 (last merge round=33)
[S8] round=95 local utility u=0.109147 metrics={'f1_val': 0.904672824585885, 'auprc': 0.9947581112789071, 'loss_val': 0.21476916192315415, 'psi': 0.9407069392630939}-{'f1_val': 0.8803466964913309, 'auprc': 0.9939951210487058, 'loss_val': 0.284817591258883, 'psi': 0.9258060663142809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=95 head_norm_before_train=2.261995 (no previous merge yet)
[S9] round=95 local utility u=0.033515 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9995637352051014, 'loss_val': 0.017438232318125576, 'psi': 0.9975881115202843}-{'f1_val': 0.9891288930766337, 'auprc': 0.9992009162646994, 'loss_val': 0.04052653077036324, 'psi': 0.99315770235186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=95 head_norm_before_train=2.518115 cos_to_last_merge=0.9830 (last merge round=33)
[S10] round=95 local utility u=0.001374 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9945633172232607, 'loss_val': 0.03183653997505475, 'psi': 0.9941479545196312}-{'f1_val': 0.9934327081542391, 'auprc': 0.9947800122264512, 'loss_val': 0.03260489822151099, 'psi': 0.993971629783124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=95 head_norm_before_train=2.471785 cos_to_last_merge=0.9966 (last merge round=41)
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9933665814030509, 'auprc': 0.9973348566554391, 'loss_val': 0.03181020730144448, 'psi': 0.9949538915040061}-{'f1_val': 0.9961541414107454, 'auprc': 0.9968650385170293, 'loss_val': 0.039437999779679676, 'psi': 0.996438500253259}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=2.223081 (no previous merge yet)
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6534615846244596, 'auprc': 0.9366301957449071, 'loss_val': 1.211195446756909, 'psi': 0.7667290290726386}-{'f1_val': 0.7395103906282716, 'auprc': 0.8175808162895601, 'loss_val': 1.0252151426755363, 'psi': 0.770738560892787}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.433699 cos_to_last_merge=0.9908 (last merge round=32)
[S14] round=95 local utility u=0.001885 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9990599101323843, 'loss_val': 0.018562735035777194, 'psi': 0.9982031480268795}-{'f1_val': 0.9970233560109115, 'auprc': 0.9989408623314888, 'loss_val': 0.018324504679827467, 'psi': 0.9977903585391424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=95 head_norm_before_train=2.429262 cos_to_last_merge=0.9614 (last merge round=39)
[S15] round=95 local utility u=0.001588 metrics={'f1_val': 0.9668676642864944, 'auprc': 0.9971734955549304, 'loss_val': 0.06792761166628643, 'psi': 0.9789899967938688}-{'f1_val': 0.9664131296232913, 'auprc': 0.9971534914744299, 'loss_val': 0.0683169188509884, 'psi': 0.9787092743637467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=95 head_norm_before_train=2.071037 cos_to_last_merge=0.9893 (last merge round=39)
[S16] round=95 local utility u=0.003189 metrics={'f1_val': 0.9920314002956026, 'auprc': 0.9956608048031684, 'loss_val': 0.03786667450338867, 'psi': 0.9934831620986289}-{'f1_val': 0.9916416708466298, 'auprc': 0.9950408986558634, 'loss_val': 0.04004688120982711, 'psi': 0.9930013619703232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=95 head_norm_before_train=2.501040 cos_to_last_merge=0.9968 (last merge round=41)
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.8473354916064226, 'auprc': 0.9070136808115787, 'loss_val': 0.7682989138249912, 'psi': 0.8712067672884851}-{'f1_val': 0.8918178672488031, 'auprc': 0.901434804682425, 'loss_val': 0.6810717033942113, 'psi': 0.8956646422222518}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=96 head_norm_before_train=2.204765 cos_to_last_merge=0.9923 (last merge round=38)
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.8265298802358486, 'auprc': 0.9910136769315644, 'loss_val': 0.3677656440371195, 'psi': 0.8923233989141349}-{'f1_val': 0.8270324769014605, 'auprc': 0.9928469068126868, 'loss_val': 0.3676000151600392, 'psi': 0.893358248865951}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.447105 cos_to_last_merge=0.9776 (last merge round=34)
[S3] round=96 local utility u=0.152622 metrics={'f1_val': 0.9661543360143561, 'auprc': 0.9975794285381321, 'loss_val': 0.08324146267567477, 'psi': 0.9787243730238664}-{'f1_val': 0.9325419571142808, 'auprc': 0.992221849440973, 'loss_val': 0.17073778546224927, 'psi': 0.9564139140449577}
[S3] not sending this round → trigger blocked (psi=0.979)
[S4] START round=96 head_norm_before_train=2.065292 cos_to_last_merge=0.9537 (last merge round=34)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9403959388302916, 'auprc': 0.9427339729928108, 'loss_val': 0.3439961646438537, 'psi': 0.9413311524952993}-{'f1_val': 0.9423192423522234, 'auprc': 0.9583313054644069, 'loss_val': 0.34477668417842744, 'psi': 0.9487240675970969}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=2.088106 cos_to_last_merge=0.9855 (last merge round=35)
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9920468875601121, 'loss_val': 0.05587504779306559, 'psi': 0.9946190422021789}-{'f1_val': 0.9967019684784577, 'auprc': 0.9956808466152192, 'loss_val': 0.04729120371850491, 'psi': 0.9962935197331623}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=2.408438 (no previous merge yet)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.7807824499760353, 'auprc': 0.9255415789923551, 'loss_val': 0.6821073720227481, 'psi': 0.8386861015825633}-{'f1_val': 0.9603002069338815, 'auprc': 0.9694808775617093, 'loss_val': 0.182168804620693, 'psi': 0.9639724751850127}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=1.869581 cos_to_last_merge=0.9843 (last merge round=40)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.5709643587022128, 'auprc': 0.7776384736124027, 'loss_val': 1.0153049487729424, 'psi': 0.6536340046662887}-{'f1_val': 0.6233991466411376, 'auprc': 0.8016088249603679, 'loss_val': 0.5262603929729243, 'psi': 0.6946830179688297}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=1.995824 cos_to_last_merge=0.9750 (last merge round=33)
[S8] round=96 local utility u=0.364237 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9993678276452258, 'loss_val': 0.029233135931880535, 'psi': 0.9954617024279181}-{'f1_val': 0.904672824585885, 'auprc': 0.9947581112789071, 'loss_val': 0.21476916192315415, 'psi': 0.9407069392630939}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=96 head_norm_before_train=2.264912 (no previous merge yet)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9951144931179015, 'loss_val': 0.017777220470003047, 'psi': 0.9957958541147272}-{'f1_val': 0.9962710290637395, 'auprc': 0.9995637352051014, 'loss_val': 0.017438232318125576, 'psi': 0.9975881115202843}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.520095 cos_to_last_merge=0.9828 (last merge round=33)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9945908503960976, 'loss_val': 0.03195252574862016, 'psi': 0.994158967788766}-{'f1_val': 0.993871046050545, 'auprc': 0.9945633172232607, 'loss_val': 0.03183653997505475, 'psi': 0.9941479545196312}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.476007 cos_to_last_merge=0.9965 (last merge round=41)
[S11] round=96 local utility u=0.014681 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9985501022320287, 'loss_val': 0.022819615239566104, 'psi': 0.9971125257392587}-{'f1_val': 0.9933665814030509, 'auprc': 0.9973348566554391, 'loss_val': 0.03181020730144448, 'psi': 0.9949538915040061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] START round=96 head_norm_before_train=2.226619 (no previous merge yet)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6547316969460106, 'auprc': 0.6731922770772458, 'loss_val': 1.4337500996273727, 'psi': 0.6621159289985047}-{'f1_val': 0.6534615846244596, 'auprc': 0.9366301957449071, 'loss_val': 1.211195446756909, 'psi': 0.7667290290726386}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.438145 cos_to_last_merge=0.9905 (last merge round=32)
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9279497987837334, 'auprc': 0.9985830233102955, 'loss_val': 0.1572642450011333, 'psi': 0.9562030885943582}-{'f1_val': 0.9976319732898762, 'auprc': 0.9990599101323843, 'loss_val': 0.018562735035777194, 'psi': 0.9982031480268795}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.434145 cos_to_last_merge=0.9611 (last merge round=39)
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.9655020067130645, 'auprc': 0.9972209464755313, 'loss_val': 0.06926451987312576, 'psi': 0.9781895826180512}-{'f1_val': 0.9668676642864944, 'auprc': 0.9971734955549304, 'loss_val': 0.06792761166628643, 'psi': 0.9789899967938688}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=2.074178 cos_to_last_merge=0.9892 (last merge round=39)
[S16] round=96 local utility u=0.004251 metrics={'f1_val': 0.9931014609791449, 'auprc': 0.9956816079623495, 'loss_val': 0.03584677834860601, 'psi': 0.9941335197724267}-{'f1_val': 0.9920314002956026, 'auprc': 0.9956608048031684, 'loss_val': 0.03786667450338867, 'psi': 0.9934831620986289}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=96 head_norm_before_train=2.505892 cos_to_last_merge=0.9968 (last merge round=41)
[S17] round=96 local utility u=0.135265 metrics={'f1_val': 0.8905296546312389, 'auprc': 0.884285228830402, 'loss_val': 0.6887489443084668, 'psi': 0.8880318843109042}-{'f1_val': 0.8473354916064226, 'auprc': 0.9070136808115787, 'loss_val': 0.7682989138249912, 'psi': 0.8712067672884851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=97 head_norm_before_train=2.207470 cos_to_last_merge=0.9920 (last merge round=38)
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.7876967699695532, 'auprc': 0.9886071912515404, 'loss_val': 0.39089801802978136, 'psi': 0.8680609384823481}-{'f1_val': 0.8265298802358486, 'auprc': 0.9910136769315644, 'loss_val': 0.3677656440371195, 'psi': 0.8923233989141349}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=2.452219 cos_to_last_merge=0.9772 (last merge round=34)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.8079130987920605, 'auprc': 0.9605313703704851, 'loss_val': 0.6864541588921075, 'psi': 0.8689604074234303}-{'f1_val': 0.9661543360143561, 'auprc': 0.9975794285381321, 'loss_val': 0.08324146267567477, 'psi': 0.9787243730238664}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=2.063572 cos_to_last_merge=0.9532 (last merge round=34)
[S4] round=97 local utility u=0.004227 metrics={'f1_val': 0.9395897235037131, 'auprc': 0.9438776173899466, 'loss_val': 0.3341364145018879, 'psi': 0.9413048810582064}-{'f1_val': 0.9403959388302916, 'auprc': 0.9427339729928108, 'loss_val': 0.3439961646438537, 'psi': 0.9413311524952993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=97 head_norm_before_train=2.090192 cos_to_last_merge=0.9845 (last merge round=35)
[S5] round=97 local utility u=0.000640 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9921975652855486, 'loss_val': 0.05504746515309168, 'psi': 0.9946793132923535}-{'f1_val': 0.9963338119635569, 'auprc': 0.9920468875601121, 'loss_val': 0.05587504779306559, 'psi': 0.9946190422021789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=97 head_norm_before_train=2.414111 (no previous merge yet)
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.6437279259632869, 'auprc': 0.8495707648961, 'loss_val': 1.139578305366588, 'psi': 0.7260650615364121}-{'f1_val': 0.7807824499760353, 'auprc': 0.9255415789923551, 'loss_val': 0.6821073720227481, 'psi': 0.8386861015825633}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=1.874390 cos_to_last_merge=0.9841 (last merge round=40)
[S7] round=97 local utility u=0.536139 metrics={'f1_val': 0.6455534445457644, 'auprc': 0.7996408367824288, 'loss_val': 0.45656792605734514, 'psi': 0.7071884014404302}-{'f1_val': 0.5709643587022128, 'auprc': 0.7776384736124027, 'loss_val': 1.0153049487729424, 'psi': 0.6536340046662887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=97 head_norm_before_train=1.998783 cos_to_last_merge=0.9745 (last merge round=33)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.830625856589793, 'auprc': 0.9935963554416715, 'loss_val': 0.5168110962474318, 'psi': 0.8958140561305444}-{'f1_val': 0.9928576189497129, 'auprc': 0.9993678276452258, 'loss_val': 0.029233135931880535, 'psi': 0.9954617024279181}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=2.265152 (no previous merge yet)
[S9] round=97 local utility u=0.008390 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9988355939631557, 'loss_val': 0.017089261058314677, 'psi': 0.9977770855068824}-{'f1_val': 0.9962500947792776, 'auprc': 0.9951144931179015, 'loss_val': 0.017777220470003047, 'psi': 0.9957958541147272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=97 head_norm_before_train=2.523172 cos_to_last_merge=0.9826 (last merge round=33)
[S10] round=97 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9948445852737218, 'loss_val': 0.033018979025208534, 'psi': 0.9939974590020322}-{'f1_val': 0.993871046050545, 'auprc': 0.9945908503960976, 'loss_val': 0.03195252574862016, 'psi': 0.994158967788766}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=97 head_norm_before_train=2.480576 cos_to_last_merge=0.9964 (last merge round=41)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.8918561684315585, 'auprc': 0.9979104171436964, 'loss_val': 0.12579128047675384, 'psi': 0.9342778679164137}-{'f1_val': 0.9961541414107454, 'auprc': 0.9985501022320287, 'loss_val': 0.022819615239566104, 'psi': 0.9971125257392587}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.227985 (no previous merge yet)
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.5788353656527376, 'auprc': 0.5696405801539575, 'loss_val': 1.7918772984395133, 'psi': 0.5751574514532256}-{'f1_val': 0.6547316969460106, 'auprc': 0.6731922770772458, 'loss_val': 1.4337500996273727, 'psi': 0.6621159289985047}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=2.441674 cos_to_last_merge=0.9904 (last merge round=32)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.885370323391099, 'auprc': 0.9965963446449203, 'loss_val': 0.30005091984849136, 'psi': 0.9298607318926275}-{'f1_val': 0.9279497987837334, 'auprc': 0.9985830233102955, 'loss_val': 0.1572642450011333, 'psi': 0.9562030885943582}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.438942 cos_to_last_merge=0.9608 (last merge round=39)
[S15] round=97 local utility u=0.002851 metrics={'f1_val': 0.9664131296232913, 'auprc': 0.9971904577443003, 'loss_val': 0.06893682493809658, 'psi': 0.9787240608716948}-{'f1_val': 0.9655020067130645, 'auprc': 0.9972209464755313, 'loss_val': 0.06926451987312576, 'psi': 0.9781895826180512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=97 head_norm_before_train=2.075579 cos_to_last_merge=0.9890 (last merge round=39)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9829333577137445, 'auprc': 0.990293276459306, 'loss_val': 0.07618316953453495, 'psi': 0.985877325211969}-{'f1_val': 0.9931014609791449, 'auprc': 0.9956816079623495, 'loss_val': 0.03584677834860601, 'psi': 0.9941335197724267}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.510529 cos_to_last_merge=0.9967 (last merge round=41)
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.8002082301201092, 'auprc': 0.9392912651814638, 'loss_val': 0.9006762820571246, 'psi': 0.8558414441446511}-{'f1_val': 0.8905296546312389, 'auprc': 0.884285228830402, 'loss_val': 0.6887489443084668, 'psi': 0.8880318843109042}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=98 head_norm_before_train=2.214031 cos_to_last_merge=0.9919 (last merge round=38)
[S2] round=98 local utility u=0.140571 metrics={'f1_val': 0.8270706613748429, 'auprc': 0.9931758018638425, 'loss_val': 0.3597057117082509, 'psi': 0.8935127175704427}-{'f1_val': 0.7876967699695532, 'auprc': 0.9886071912515404, 'loss_val': 0.39089801802978136, 'psi': 0.8680609384823481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=98 head_norm_before_train=2.456786 cos_to_last_merge=0.9769 (last merge round=34)
[S3] round=98 local utility u=0.798368 metrics={'f1_val': 0.9580522942783897, 'auprc': 0.9958865675715085, 'loss_val': 0.09661831406599818, 'psi': 0.9731860035956372}-{'f1_val': 0.8079130987920605, 'auprc': 0.9605313703704851, 'loss_val': 0.6864541588921075, 'psi': 0.8689604074234303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=98 head_norm_before_train=2.065138 cos_to_last_merge=0.9524 (last merge round=34)
[S4] round=98 local utility u=0.001754 metrics={'f1_val': 0.9395800706875127, 'auprc': 0.9455982728656249, 'loss_val': 0.3357332218345582, 'psi': 0.9419873515587576}-{'f1_val': 0.9395897235037131, 'auprc': 0.9438776173899466, 'loss_val': 0.3341364145018879, 'psi': 0.9413048810582064}
[S4] not sending this round → trigger blocked (psi=0.942)
[S5] START round=98 head_norm_before_train=2.097255 cos_to_last_merge=0.9832 (last merge round=35)
[S5] round=98 local utility u=0.013388 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9965343880293627, 'loss_val': 0.043490963304429135, 'psi': 0.9966349362988196}-{'f1_val': 0.9963338119635569, 'auprc': 0.9921975652855486, 'loss_val': 0.05504746515309168, 'psi': 0.9946793132923535}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=98 head_norm_before_train=2.425307 (no previous merge yet)
[S6] round=98 local utility u=0.433884 metrics={'f1_val': 0.7457713688438443, 'auprc': 0.8989039279028417, 'loss_val': 1.0320708029824883, 'psi': 0.8070243924674433}-{'f1_val': 0.6437279259632869, 'auprc': 0.8495707648961, 'loss_val': 1.139578305366588, 'psi': 0.7260650615364121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=98 head_norm_before_train=1.877540 cos_to_last_merge=0.9838 (last merge round=40)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.5795484405524939, 'auprc': 0.7768031020656634, 'loss_val': 0.9571497322057523, 'psi': 0.6584503051577617}-{'f1_val': 0.6455534445457644, 'auprc': 0.7996408367824288, 'loss_val': 0.45656792605734514, 'psi': 0.7071884014404302}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.004896 cos_to_last_merge=0.9741 (last merge round=33)
[S8] round=98 local utility u=0.741323 metrics={'f1_val': 0.9940439378812725, 'auprc': 0.9986613548367097, 'loss_val': 0.029868534420768228, 'psi': 0.9958909046634474}-{'f1_val': 0.830625856589793, 'auprc': 0.9935963554416715, 'loss_val': 0.5168110962474318, 'psi': 0.8958140561305444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=98 head_norm_before_train=2.264650 (no previous merge yet)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9943271883459407, 'auprc': 0.9988390849583599, 'loss_val': 0.02206090577030427, 'psi': 0.9961319469909085}-{'f1_val': 0.9970714132027002, 'auprc': 0.9988355939631557, 'loss_val': 0.017089261058314677, 'psi': 0.9977770855068824}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.527536 cos_to_last_merge=0.9824 (last merge round=33)
[S10] round=98 local utility u=0.000677 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9945929445158643, 'loss_val': 0.03222465961431166, 'psi': 0.9940282820245454}-{'f1_val': 0.9934327081542391, 'auprc': 0.9948445852737218, 'loss_val': 0.033018979025208534, 'psi': 0.9939974590020322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=98 head_norm_before_train=2.484620 cos_to_last_merge=0.9964 (last merge round=41)
[S11] round=98 local utility u=0.314366 metrics={'f1_val': 0.9859747377866427, 'auprc': 0.9985094069286542, 'loss_val': 0.06356739649711302, 'psi': 0.9909886054434474}-{'f1_val': 0.8918561684315585, 'auprc': 0.9979104171436964, 'loss_val': 0.12579128047675384, 'psi': 0.9342778679164137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=98 head_norm_before_train=2.231484 (no previous merge yet)
[S13] round=98 local utility u=1.000000 metrics={'f1_val': 0.743677071873347, 'auprc': 0.7805751570337611, 'loss_val': 1.1964287113485808, 'psi': 0.7584363059375127}-{'f1_val': 0.5788353656527376, 'auprc': 0.5696405801539575, 'loss_val': 1.7918772984395133, 'psi': 0.5751574514532256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=98 head_norm_before_train=2.445176 cos_to_last_merge=0.9904 (last merge round=32)
[S14] round=98 local utility u=0.480324 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9991055221396375, 'loss_val': 0.020499774506554738, 'psi': 0.9982213928297807}-{'f1_val': 0.885370323391099, 'auprc': 0.9965963446449203, 'loss_val': 0.30005091984849136, 'psi': 0.9298607318926275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=98 head_norm_before_train=2.443638 cos_to_last_merge=0.9605 (last merge round=39)
[S15] round=98 local utility u=0.003376 metrics={'f1_val': 0.9673215186055643, 'auprc': 0.9971455864532754, 'loss_val': 0.06750026655424972, 'psi': 0.9792511457446488}-{'f1_val': 0.9664131296232913, 'auprc': 0.9971904577443003, 'loss_val': 0.06893682493809658, 'psi': 0.9787240608716948}
[S15] not sending this round → trigger blocked (psi=0.979)
[S16] START round=98 head_norm_before_train=2.076613 cos_to_last_merge=0.9888 (last merge round=39)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9259190597260881, 'auprc': 0.9859963181711711, 'loss_val': 0.407443919851121, 'psi': 0.9499499631041213}-{'f1_val': 0.9829333577137445, 'auprc': 0.990293276459306, 'loss_val': 0.07618316953453495, 'psi': 0.985877325211969}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.514061 cos_to_last_merge=0.9966 (last merge round=41)
[S17] round=98 local utility u=0.456232 metrics={'f1_val': 0.9086932103827556, 'auprc': 0.9353229182330473, 'loss_val': 0.6272170524437222, 'psi': 0.9193450935228722}-{'f1_val': 0.8002082301201092, 'auprc': 0.9392912651814638, 'loss_val': 0.9006762820571246, 'psi': 0.8558414441446511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=99 head_norm_before_train=2.217985 cos_to_last_merge=0.9914 (last merge round=38)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.8321831686649437, 'auprc': 0.7542514795693012, 'loss_val': 0.43493721494491466, 'psi': 0.8010104930266866}-{'f1_val': 0.8270706613748429, 'auprc': 0.9931758018638425, 'loss_val': 0.3597057117082509, 'psi': 0.8935127175704427}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.801 u=0.0000 p_local=0.0822 f1=0.832 auprc=0.754 bytes=68351
[S3] START round=99 head_norm_before_train=2.460465 cos_to_last_merge=0.9767 (last merge round=34)
[S3] round=99 local utility u=0.069390 metrics={'f1_val': 0.9741722184439898, 'auprc': 0.9986662153523068, 'loss_val': 0.06289746400035826, 'psi': 0.9839698172073166}-{'f1_val': 0.9580522942783897, 'auprc': 0.9958865675715085, 'loss_val': 0.09661831406599818, 'psi': 0.9731860035956372}
[S3] not sending this round → trigger blocked (psi=0.984)
[S3] r=100 psi=0.984 u=0.0694 p_local=0.2403 f1=0.974 auprc=0.999 bytes=68245
[S4] START round=99 head_norm_before_train=2.069323 cos_to_last_merge=0.9522 (last merge round=34)
[S4] round=99 local utility u=0.018220 metrics={'f1_val': 0.9396314315324964, 'auprc': 0.9553861608813874, 'loss_val': 0.3289650997777694, 'psi': 0.9459333232720528}-{'f1_val': 0.9395800706875127, 'auprc': 0.9455982728656249, 'loss_val': 0.3357332218345582, 'psi': 0.9419873515587576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=100 psi=0.946 u=0.0182 p_local=0.0086 f1=0.940 auprc=0.955 bytes=70170
[S5] START round=99 head_norm_before_train=2.103626 cos_to_last_merge=0.9822 (last merge round=35)
[S5] round=99 local utility u=0.001622 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9966272769042839, 'loss_val': 0.04052577351444238, 'psi': 0.9966720918487881}-{'f1_val': 0.9967019684784577, 'auprc': 0.9965343880293627, 'loss_val': 0.043490963304429135, 'psi': 0.9966349362988196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] r=100 psi=0.997 u=0.0016 p_local=0.1277 f1=0.997 auprc=0.997 bytes=80983
[S6] START round=99 head_norm_before_train=2.435556 (no previous merge yet)
[S6] round=99 local utility u=0.563392 metrics={'f1_val': 0.8281635397106535, 'auprc': 0.9488746383659127, 'loss_val': 0.5495522229976874, 'psi': 0.8764479791727572}-{'f1_val': 0.7457713688438443, 'auprc': 0.8989039279028417, 'loss_val': 1.0320708029824883, 'psi': 0.8070243924674433}
[S6] not sending this round → trigger blocked (psi=0.876)
[S6] r=100 psi=0.876 u=0.5634 p_local=0.3667 f1=0.828 auprc=0.949 bytes=77291
[S7] START round=99 head_norm_before_train=1.881030 cos_to_last_merge=0.9836 (last merge round=40)
[S7] round=99 local utility u=0.490817 metrics={'f1_val': 0.6602774007005652, 'auprc': 0.80050201399562, 'loss_val': 0.5309858006960174, 'psi': 0.7163672460185871}-{'f1_val': 0.5795484405524939, 'auprc': 0.7768031020656634, 'loss_val': 0.9571497322057523, 'psi': 0.6584503051577617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=100 psi=0.716 u=0.4908 p_local=0.2177 f1=0.660 auprc=0.801 bytes=77403
[S8] START round=99 head_norm_before_train=2.012331 cos_to_last_merge=0.9737 (last merge round=33)
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.7949077691759228, 'auprc': 0.9976828599307856, 'loss_val': 0.80196922295817, 'psi': 0.876017805477868}-{'f1_val': 0.9940439378812725, 'auprc': 0.9986613548367097, 'loss_val': 0.029868534420768228, 'psi': 0.9958909046634474}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.876 u=0.0000 p_local=0.2215 f1=0.795 auprc=0.998 bytes=77409
[S9] START round=99 head_norm_before_train=2.267735 (no previous merge yet)
[S9] round=99 local utility u=0.010321 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9992102003228447, 'loss_val': 0.016532058884226614, 'psi': 0.9976803872174728}-{'f1_val': 0.9943271883459407, 'auprc': 0.9988390849583599, 'loss_val': 0.02206090577030427, 'psi': 0.9961319469909085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] r=100 psi=0.998 u=0.0103 p_local=0.0084 f1=0.997 auprc=0.999 bytes=80839
[S10] START round=99 head_norm_before_train=2.531289 cos_to_last_merge=0.9823 (last merge round=33)
[S10] round=99 local utility u=0.001245 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9943971253528014, 'loss_val': 0.03177820628255609, 'psi': 0.9942130454392888}-{'f1_val': 0.9936518403636662, 'auprc': 0.9945929445158643, 'loss_val': 0.03222465961431166, 'psi': 0.9940282820245454}
[S10] not sending this round → trigger blocked (psi=0.994)
[S10] r=100 psi=0.994 u=0.0012 p_local=0.0006 f1=0.994 auprc=0.994 bytes=73587
[S11] START round=99 head_norm_before_train=2.483776 cos_to_last_merge=0.9963 (last merge round=41)
[S11] round=99 local utility u=0.050787 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998506612726051, 'loss_val': 0.02293937522732713, 'psi': 0.997082850038406}-{'f1_val': 0.9859747377866427, 'auprc': 0.9985094069286542, 'loss_val': 0.06356739649711302, 'psi': 0.9909886054434474}
[S11] not sending this round → trigger blocked (psi=0.997)
[S11] r=100 psi=0.997 u=0.0508 p_local=0.0637 f1=0.996 auprc=0.999 bytes=73593
[S13] START round=99 head_norm_before_train=2.234785 (no previous merge yet)
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.706951617586846, 'auprc': 0.6932653749955893, 'loss_val': 1.419187116788175, 'psi': 0.7014771205503433}-{'f1_val': 0.743677071873347, 'auprc': 0.7805751570337611, 'loss_val': 1.1964287113485808, 'psi': 0.7584363059375127}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.701 u=0.0000 p_local=0.2634 f1=0.707 auprc=0.693 bytes=66497
[S14] START round=99 head_norm_before_train=2.448226 cos_to_last_merge=0.9905 (last merge round=32)
[S14] round=99 local utility u=0.000228 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9990630353997917, 'loss_val': 0.017269609353948768, 'psi': 0.997939687120009}-{'f1_val': 0.9976319732898762, 'auprc': 0.9991055221396375, 'loss_val': 0.020499774506554738, 'psi': 0.9982213928297807}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=100 psi=0.998 u=0.0002 p_local=0.1095 f1=0.997 auprc=0.999 bytes=75532
[S15] START round=99 head_norm_before_train=2.448321 cos_to_last_merge=0.9603 (last merge round=39)
[S15] round=99 local utility u=0.003452 metrics={'f1_val': 0.9682271986794423, 'auprc': 0.9971643893865605, 'loss_val': 0.06608585905362391, 'psi': 0.9798020749622895}-{'f1_val': 0.9673215186055643, 'auprc': 0.9971455864532754, 'loss_val': 0.06750026655424972, 'psi': 0.9792511457446488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] r=100 psi=0.980 u=0.0035 p_local=0.0025 f1=0.968 auprc=0.997 bytes=71916
[S16] START round=99 head_norm_before_train=2.079868 cos_to_last_merge=0.9887 (last merge round=39)
[S16] round=99 local utility u=0.392465 metrics={'f1_val': 0.9925207403478591, 'auprc': 0.9918529096693526, 'loss_val': 0.03969447032796862, 'psi': 0.9922536080764565}-{'f1_val': 0.9259190597260881, 'auprc': 0.9859963181711711, 'loss_val': 0.407443919851121, 'psi': 0.9499499631041213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=100 psi=0.992 u=0.3925 p_local=0.1274 f1=0.993 auprc=0.992 bytes=73718
[S17] START round=99 head_norm_before_train=2.517561 cos_to_last_merge=0.9964 (last merge round=41)
[S17] round=99 local utility u=0.022754 metrics={'f1_val': 0.9102054344244679, 'auprc': 0.9490834547832839, 'loss_val': 0.6320635129541632, 'psi': 0.9257566425679944}-{'f1_val': 0.9086932103827556, 'auprc': 0.9353229182330473, 'loss_val': 0.6272170524437222, 'psi': 0.9193450935228722}
[S17] not sending this round → trigger blocked (psi=0.926)
[S17] r=100 psi=0.926 u=0.0228 p_local=0.0963 f1=0.910 auprc=0.949 bytes=71955
[runner] rounds complete.
[runner] all agents stopped.
