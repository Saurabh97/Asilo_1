[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:38403
[S3] → join 127.0.0.1:38402
[S4] → join 127.0.0.1:38402
[S5] → join 127.0.0.1:38402
[S6] → join 127.0.0.1:38402
[S7] → join 127.0.0.1:38402
[S8] → join 127.0.0.1:38402
[S9] → join 127.0.0.1:38402
[S10] → join 127.0.0.1:38402
[S11] → join 127.0.0.1:38402
[S13] → join 127.0.0.1:38402
[S14] → join 127.0.0.1:38402
[S15] → join 127.0.0.1:38402
[S16] → join 127.0.0.1:38402
[S17] → join 127.0.0.1:38402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.212500 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.152745 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.099068 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.195426 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.152099 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.149913 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.209880 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.185239 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.177160 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.119704 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.166128 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.229578 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.174560 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.128776 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.175473 (no previous merge yet)
[S5]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3] + discovered S4
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S10
[S3] + discovered S7
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S11
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S5
[S3] + discovered S9
[S3] + discovered S17
[S4] + discovered S7
[S4] + discovered S10
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S2
[S4] + discovered S17
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S8
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S14
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S16
[S6] + discovered S5
[S5] + discovered S11
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S9
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S15
[S6] + discovered S4
[S5] + discovered S16
[S5] + discovered S10
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S3
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S7
[S6] + discovered S14
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S10
[S8] + discovered S5
[S7] + discovered S16
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S6
[S7] + discovered S14
[S7] + discovered S15
[S7] + discovered S8
[S7] + discovered S11
[S8] + discovered S2
[S8] + discovered S4
[S7] + discovered S9
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S11
[S9] + discovered S5
[S8] + discovered S16
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S2
[S9] + discovered S11
[S9] + discovered S16
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S13
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S6
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S9
[S10] + discovered S7
[S11] + discovered S2
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S3
[S11] + discovered S8
[S11] + discovered S4
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S11
[S10] + discovered S13
[S11] + discovered S6
[S10] + discovered S17
[S11] + discovered S10
[S10] + discovered S14
[S11] + discovered S7
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S17
[S11] + discovered S14
[S13] + discovered S11
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S10
[S13] + discovered S5
[S14] + discovered S10
[S14] + discovered S8
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S7
[S14] + discovered S3
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S6
[S13] + discovered S14
[S14] + discovered S11
[S13] + discovered S15
[S14] + discovered S9
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S17
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S8
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S11
[S15] + discovered S6
[S15] + discovered S13
[S15] + discovered S2
[S15] + discovered S14
[S15] + discovered S7
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S4
[S16] + discovered S14
[S16] + discovered S15
[S16] + discovered S6
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S7
[S16] + discovered S2
[S16] + discovered S10
[S16] + discovered S8
[S16] + discovered S9
[S15] + discovered S16
[S16] + discovered S4
[S15] + discovered S17
[S17] + discovered S16
[S17] + discovered S8
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S5
[S17] + discovered S11
[S17] + discovered S3
[S17] + discovered S6
[S17] + discovered S14
[S17] + discovered S15
[S17] + discovered S13
[S16] + discovered S17
[S17] + discovered S10
[S17] + discovered S7
[S17] + discovered S9
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:38407
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:38403
[S11] ⇄ pheromone p=1.000 → S10@127.0.0.1:38411
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:38404
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S15] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:38408
[S14] ⇄ pheromone p=1.000 → S13@127.0.0.1:38413
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:38409
[S8] ⇄ pheromone p=1.000 → S16@127.0.0.1:38416
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:38403
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:38416
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:38405
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:38409
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:38414
[S2] START round=1 head_norm_before_train=1.225672 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.735292566100959, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4531384116018657, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.161829 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.553650139310223, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4816128353677933, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.105944 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4598058314286244, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4065780204665352, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.200204 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.456119858839082, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4157805941986354, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.185895 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3129117556476855, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6731821494381933, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.152552 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4477349366848853, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3976448783868884, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.217652 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5775177632932724, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4575358842301622, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.176652 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4483516412036974, 'psi': 0.0}-{'f1_val': 0.2938042620363062, 'auprc': 0.2938042620363062, 'loss_val': 1.3796507033080228, 'psi': 0.2938042620363062}
[S10] START round=1 head_norm_before_train=1.207179 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.592294421015312, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.417984587200616, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.132110 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4594173448963372, 'psi': 0.0}-{'f1_val': 0.3720243266724587, 'auprc': 0.3720243266724587, 'loss_val': 1.3691163260535644, 'psi': 0.3720243266724587}
[S13] START round=1 head_norm_before_train=1.176250 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5753878725152022, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4447878700638859, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.226304 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4989760514918167, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4323431431597984, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.183525 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6941166683306381, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.484559885651471, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.135944 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5185379358012607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4575179401801763, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.188549 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6400680608204736, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.494318668365721, 'psi': 0.0}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.270161 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.513632238442292, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.735292566100959, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.185083 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6830082501973733, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.553650139310223, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.143211 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6663773747828208, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4598058314286244, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.214746 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5189591465264054, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.456119858839082, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.240096 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.969626968385034, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3129117556476855, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.164693 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5475541944445408, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4477349366848853, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.257732 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.84473123405796, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5775177632932724, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.182339 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5677451240437983, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4483516412036974, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.259192 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0110429628395248, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.592294421015312, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.154429 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6660152360279106, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4594173448963372, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.205926 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9211463103719844, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5753878725152022, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.236040 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6221712472681633, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4989760514918167, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.225883 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9851244162804367, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6941166683306381, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.156231 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.625646211482019, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5185379358012607, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.232868 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.001363980361878, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6400680608204736, 'psi': 0.0}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.320000 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.537650347575624, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.513632238442292, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.217153 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0188994349885463, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6830082501973733, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.203014 (no previous merge yet)
[S4] round=3 local utility u=0.097547 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.471282687966745, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6663773747828208, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.237140 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.670923311345748, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5189591465264054, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.284949 (no previous merge yet)
[S6] round=3 local utility u=0.076764 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.816097996050886, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.969626968385034, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.184898 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.752821483841624, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5475541944445408, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.310542 (no previous merge yet)
[S8] round=3 local utility u=0.118206 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6083189829154692, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.84473123405796, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.200014 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.842860858625546, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5677451240437983, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.306506 (no previous merge yet)
[S10] round=3 local utility u=0.035991 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9390614582316021, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0110429628395248, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.186630 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2907856019165584, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6660152360279106, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.239327 (no previous merge yet)
[S13] round=3 local utility u=0.102238 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.716670871605289, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9211463103719844, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.257978 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.928282245823769, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6221712472681633, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.265750 (no previous merge yet)
[S15] round=3 local utility u=0.108234 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7686570820256033, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9851244162804367, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.188575 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8666755001933208, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.625646211482019, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.290385 (no previous merge yet)
[S17] round=3 local utility u=0.172645 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6560741795958518, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.001363980361878, 'psi': 0.0}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=4 head_norm_before_train=1.356249 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.861269280078607, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.537650347575624, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.254449 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7244135710437725, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0188994349885463, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.234986 (no previous merge yet)
[S4] round=4 local utility u=0.061807 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3476684125479692, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.471282687966745, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.266886 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8457353598292332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.670923311345748, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.324174 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0777125573048956, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.816097996050886, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.209884 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9896932123832076, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.752821483841624, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.339269 (no previous merge yet)
[S8] round=4 local utility u=1.000000 metrics={'f1_val': 0.24821189970918808, 'auprc': 0.24821189970918808, 'loss_val': 1.4157224308742837, 'psi': 0.24821189970918808}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6083189829154692, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.228299 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3198016748903143, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.842860858625546, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.341638 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.53479536945621, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9390614582316021, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.225857 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7347321448322424, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2907856019165584, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.239790 (no previous merge yet)
[S13] round=4 local utility u=0.027911 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6608485665586263, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.716670871605289, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.290190 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7317830395890432, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.928282245823769, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.292007 (no previous merge yet)
[S15] round=4 local utility u=0.088708 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5912420679327866, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7686570820256033, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.229149 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3710492535677363, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8666755001933208, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.319552 (no previous merge yet)
[S17] round=4 local utility u=0.084258 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.48755915598975, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6560741795958518, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=-0.0163
[S16] DROPPED delta from S8 (cos=-0.0163 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=5 head_norm_before_train=1.410598 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.573982945821945, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.861269280078607, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.290677 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.738396156257061, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7244135710437725, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.289054 (no previous merge yet)
[S4] round=5 local utility u=0.024464 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2987405681850297, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3476684125479692, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.292221 (no previous merge yet)
[S5] round=5 local utility u=0.778965 metrics={'f1_val': 0.16026871401151632, 'auprc': 0.16026871401151632, 'loss_val': 1.7302247811204965, 'psi': 0.16026871401151632}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8457353598292332, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.383881 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.600542594588411, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0777125573048956, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.228476 (no previous merge yet)
[S7] round=5 local utility u=0.055899 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8778954959248326, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9896932123832076, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.383983 (no previous merge yet)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.22651555673047033, 'auprc': 0.22651555673047033, 'loss_val': 1.24974165797009, 'psi': 0.22651555673047036}-{'f1_val': 0.24821189970918808, 'auprc': 0.24821189970918808, 'loss_val': 1.4157224308742837, 'psi': 0.24821189970918808}
[S9] START round=5 head_norm_before_train=1.260372 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.434852804618083, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3198016748903143, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.398281 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.250916002869392, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.53479536945621, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.253433 (no previous merge yet)
[S11] round=5 local utility u=0.113437 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5078584977044525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7347321448322424, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.258427 (no previous merge yet)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6761234737814326, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6608485665586263, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.327884 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.124822930556062, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7317830395890432, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.336115 (no previous merge yet)
[S15] round=5 local utility u=0.231680 metrics={'f1_val': 0.02802623732856291, 'auprc': 0.02802623732856291, 'loss_val': 1.3801191692616477, 'psi': 0.02802623732856291}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5912420679327866, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.270797 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.591257670741956, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3710492535677363, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.366010 (no previous merge yet)
[S17] round=5 local utility u=0.040625 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4063090151473938, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.48755915598975, 'psi': 0.0}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.160)
[S15] not sending this round → trigger blocked (psi=0.028)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S7] ⇄ pheromone p=0.339 → S8@127.0.0.1:38409
[S10] ⇄ pheromone p=0.332 → S7@127.0.0.1:38408
[S4] ⇄ pheromone p=0.355 → S8@127.0.0.1:38409
[S11] ⇄ pheromone p=0.350 → S10@127.0.0.1:38411
[S14] ⇄ pheromone p=0.328 → S13@127.0.0.1:38413
[S13] ⇄ pheromone p=0.345 → S16@127.0.0.1:38416
[S3] ⇄ pheromone p=0.328 → S6@127.0.0.1:38407
[S8] ⇄ pheromone p=0.503 → S16@127.0.0.1:38416
[S9] ⇄ pheromone p=0.328 → S3@127.0.0.1:38403
[S6] ⇄ pheromone p=0.338 → S7@127.0.0.1:38408
[S16] ⇄ pheromone p=0.328 → S4@127.0.0.1:38404
[S5] ⇄ pheromone p=0.483 → S3@127.0.0.1:38403
[S15] ⇄ pheromone p=0.402 → S7@127.0.0.1:38408
[S2] ⇄ pheromone p=0.328 → S5@127.0.0.1:38405
[S17] ⇄ pheromone p=0.371 → S14@127.0.0.1:38414
[S2] START round=6 head_norm_before_train=1.466552 (no previous merge yet)
[S2] round=6 local utility u=0.751139 metrics={'f1_val': 0.14102564102564102, 'auprc': 0.14102564102564102, 'loss_val': 3.3409353134587243, 'psi': 0.14102564102564102}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.573982945821945, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.310971 (no previous merge yet)
[S3] round=6 local utility u=0.112268 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5138594042936093, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.738396156257061, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.347845 (no previous merge yet)
[S4] round=6 local utility u=0.003893 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2909549237568838, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2987405681850297, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.300282 (no previous merge yet)
[S5] round=6 local utility u=0.661681 metrics={'f1_val': 0.29415225320625954, 'auprc': 0.29415225320625954, 'loss_val': 1.6118147968994145, 'psi': 0.29415225320625954}-{'f1_val': 0.16026871401151632, 'auprc': 0.16026871401151632, 'loss_val': 1.7302247811204965, 'psi': 0.16026871401151632}
[S6] START round=6 head_norm_before_train=1.447276 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.53639368690957, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.600542594588411, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.230558 (no previous merge yet)
[S7] round=6 local utility u=0.086752 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7043914806875076, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8778954959248326, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.440091 (no previous merge yet)
[S8] round=6 local utility u=0.534182 metrics={'f1_val': 0.3320885181603009, 'auprc': 0.3320885181603009, 'loss_val': 1.131533405128839, 'psi': 0.3320885181603009}-{'f1_val': 0.22651555673047033, 'auprc': 0.22651555673047033, 'loss_val': 1.24974165797009, 'psi': 0.22651555673047036}
[S9] START round=6 head_norm_before_train=1.287711 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4638747196609176, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.434852804618083, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.459812 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7699775941609643, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.250916002869392, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.271101 (no previous merge yet)
[S11] round=6 local utility u=0.139328 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2292024356506173, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5078584977044525, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.291573 (no previous merge yet)
[S13] round=6 local utility u=0.120613 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4348971097231804, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6761234737814326, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.353696 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.238623746216576, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.124822930556062, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.388427 (no previous merge yet)
[S15] round=6 local utility u=0.477429 metrics={'f1_val': 0.130420054200542, 'auprc': 0.130420054200542, 'loss_val': 1.3468055908838958, 'psi': 0.130420054200542}-{'f1_val': 0.02802623732856291, 'auprc': 0.02802623732856291, 'loss_val': 1.3801191692616477, 'psi': 0.02802623732856291}
[S16] START round=6 head_norm_before_train=1.304209 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.981864113760963, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.591257670741956, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.418204 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4225246824916293, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4063090151473938, 'psi': 0.0}
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S11] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.141)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:38403
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.130)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=-0.0229
[S16] DROPPED delta from S8 (cos=-0.0229 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.0860
[S3] DROPPED delta from S5 (cos=-0.0860 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=7 head_norm_before_train=1.511685 (no previous merge yet)
[S2] round=7 local utility u=0.533790 metrics={'f1_val': 0.1937095137750722, 'auprc': 0.1937095137750722, 'loss_val': 2.747509886546346, 'psi': 0.1937095137750722}-{'f1_val': 0.14102564102564102, 'auprc': 0.14102564102564102, 'loss_val': 3.3409353134587243, 'psi': 0.14102564102564102}
[S3] START round=7 head_norm_before_train=1.330826 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6001025910053888, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5138594042936093, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.401332 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3239736971167444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2909549237568838, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.307041 (no previous merge yet)
[S5] round=7 local utility u=0.192432 metrics={'f1_val': 0.33322801474460245, 'auprc': 0.33322801474460245, 'loss_val': 1.5786330841599296, 'psi': 0.33322801474460245}-{'f1_val': 0.29415225320625954, 'auprc': 0.29415225320625954, 'loss_val': 1.6118147968994145, 'psi': 0.29415225320625954}
[S6] START round=7 head_norm_before_train=1.496689 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0009555661729574773, 'auprc': 0.0009555661729574773, 'loss_val': 4.796056871396991, 'psi': 0.0009555661729574773}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.53639368690957, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.229479 (no previous merge yet)
[S7] round=7 local utility u=0.025965 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6524621617262893, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7043914806875076, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.488935 (no previous merge yet)
[S8] round=7 local utility u=0.235288 metrics={'f1_val': 0.37632376186803257, 'auprc': 0.37632376186803257, 'loss_val': 1.0590750072592032, 'psi': 0.37632376186803257}-{'f1_val': 0.3320885181603009, 'auprc': 0.3320885181603009, 'loss_val': 1.131533405128839, 'psi': 0.3320885181603009}
[S9] START round=7 head_norm_before_train=1.317412 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5513713695707354, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4638747196609176, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.511412 (no previous merge yet)
[S10] round=7 local utility u=1.000000 metrics={'f1_val': 0.24772203865024534, 'auprc': 0.24772203865024534, 'loss_val': 3.4537929006775268, 'psi': 0.24772203865024534}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7699775941609643, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.292150 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3839015268239256, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2292024356506173, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.311321 (no previous merge yet)
[S13] round=7 local utility u=1.000000 metrics={'f1_val': 0.21780867262495862, 'auprc': 0.21780867262495862, 'loss_val': 1.2235833294191096, 'psi': 0.21780867262495862}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4348971097231804, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.378468 (no previous merge yet)
[S14] round=7 local utility u=0.059556 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.119511520154864, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.238623746216576, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.433234 (no previous merge yet)
[S15] round=7 local utility u=0.663181 metrics={'f1_val': 0.2706691682301438, 'auprc': 0.2706691682301438, 'loss_val': 1.2826865762590491, 'psi': 0.2706691682301438}-{'f1_val': 0.130420054200542, 'auprc': 0.130420054200542, 'loss_val': 1.3468055908838958, 'psi': 0.130420054200542}
[S16] START round=7 head_norm_before_train=1.344748 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.069575409965168, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.981864113760963, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.465295 (no previous merge yet)
[S17] round=7 local utility u=0.009497 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4035315732643205, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4225246824916293, 'psi': 0.0}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.194)
[S5] not sending this round → trigger blocked (psi=0.333)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:38416
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.376)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=-0.0970
[S7] DROPPED delta from S10 (cos=-0.0970 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.0786
[S16] RECEIVED delta(kind=head bytes=1805) from S13
[S16] cosine check vs S13: cos=-0.0719
[S16] DROPPED delta from S13 (cos=-0.0719 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.0000 head_norm=1.237005
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.225976e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.0000 head_norm=0.997076 delta_norm=0.922598
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.559788 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.19935245143385752, 'auprc': 0.19935245143385752, 'loss_val': 2.8632533188499196, 'psi': 0.19935245143385752}-{'f1_val': 0.1937095137750722, 'auprc': 0.1937095137750722, 'loss_val': 2.747509886546346, 'psi': 0.1937095137750722}
[S3] START round=8 head_norm_before_train=1.355561 (no previous merge yet)
[S3] round=8 local utility u=0.108010 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3840829919189885, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6001025910053888, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.448186 (no previous merge yet)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3757313135162164, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3239736971167444, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.324659 (no previous merge yet)
[S5] round=8 local utility u=0.039382 metrics={'f1_val': 0.33238845144356954, 'auprc': 0.33238845144356954, 'loss_val': 1.4923122667620015, 'psi': 0.33238845144356954}-{'f1_val': 0.33322801474460245, 'auprc': 0.33322801474460245, 'loss_val': 1.5786330841599296, 'psi': 0.33322801474460245}
[S6] START round=8 head_norm_before_train=1.538440 (no previous merge yet)
[S6] round=8 local utility u=0.236835 metrics={'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 5.229913062585416, 'psi': 0.10179184140297369}-{'f1_val': 0.0009555661729574773, 'auprc': 0.0009555661729574773, 'loss_val': 4.796056871396991, 'psi': 0.0009555661729574773}
[S7] START round=8 head_norm_before_train=0.997076 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6557585602124933, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6524621617262893, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.519990 (no previous merge yet)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.9803323603792085, 'auprc': 0.9803323603792085, 'loss_val': 0.9614339336871678, 'psi': 0.9803323603792085}-{'f1_val': 0.37632376186803257, 'auprc': 0.37632376186803257, 'loss_val': 1.0590750072592032, 'psi': 0.37632376186803257}
[S9] START round=8 head_norm_before_train=1.350767 (no previous merge yet)
[S9] round=8 local utility u=0.036043 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.479284785398992, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5513713695707354, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.545121 (no previous merge yet)
[S10] round=8 local utility u=0.550252 metrics={'f1_val': 0.332454668903267, 'auprc': 0.332454668903267, 'loss_val': 3.115882593226092, 'psi': 0.332454668903267}-{'f1_val': 0.24772203865024534, 'auprc': 0.24772203865024534, 'loss_val': 3.4537929006775268, 'psi': 0.24772203865024534}
[S11] START round=8 head_norm_before_train=1.320663 (no previous merge yet)
[S11] round=8 local utility u=0.015227 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3534468624502365, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3839015268239256, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.351945 (no previous merge yet)
[S13] round=8 local utility u=0.109852 metrics={'f1_val': 0.23849318590897403, 'auprc': 0.23849318590897403, 'loss_val': 1.1900396360250562, 'psi': 0.23849318590897406}-{'f1_val': 0.21780867262495862, 'auprc': 0.21780867262495862, 'loss_val': 1.2235833294191096, 'psi': 0.21780867262495862}
[S14] START round=8 head_norm_before_train=1.400927 (no previous merge yet)
[S14] round=8 local utility u=0.061303 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.996904719364088, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.119511520154864, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.469868 (no previous merge yet)
[S15] round=8 local utility u=0.073432 metrics={'f1_val': 0.2810863475825113, 'auprc': 0.2810863475825113, 'loss_val': 1.2295765233295022, 'psi': 0.2810863475825113}-{'f1_val': 0.2706691682301438, 'auprc': 0.2706691682301438, 'loss_val': 1.2826865762590491, 'psi': 0.2706691682301438}
[S16] START round=8 head_norm_before_train=1.382886 (no previous merge yet)
[S16] round=8 local utility u=0.062215 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.945145350312433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.069575409965168, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.494029 (no previous merge yet)
[S17] round=8 local utility u=0.057438 metrics={'f1_val': 0.008448060075093867, 'auprc': 0.008448060075093867, 'loss_val': 1.3646881344043373, 'psi': 0.008448060075093867}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4035315732643205, 'psi': 0.0}
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:38403
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.102)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38416
[S9] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S15] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=-0.0890
[S3] DROPPED delta from S5 (cos=-0.0890 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=-0.1247
[S7] DROPPED delta from S10 (cos=-0.1247 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=0.7725
[S17] not sending this round → trigger blocked (psi=0.008)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=-0.0147
[S16] DROPPED delta from S8 (cos=-0.0147 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] cosine check vs S13: cos=-0.0696
[S16] DROPPED delta from S13 (cos=-0.0696 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.0000 head_norm=1.015140
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.849578e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.190997 delta_norm=0.484958
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.616236 (no previous merge yet)
[S2] round=9 local utility u=0.293342 metrics={'f1_val': 0.24597490052035506, 'auprc': 0.24597490052035506, 'loss_val': 2.6961722373219352, 'psi': 0.24597490052035506}-{'f1_val': 0.19935245143385752, 'auprc': 0.19935245143385752, 'loss_val': 2.8632533188499196, 'psi': 0.19935245143385752}
[S3] START round=9 head_norm_before_train=1.383110 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.432844321681498, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3840829919189885, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.498163 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3866509356474992, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3757313135162164, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.342046 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3746307947898393, 'psi': 0.3051272166538165}-{'f1_val': 0.33238845144356954, 'auprc': 0.33238845144356954, 'loss_val': 1.4923122667620015, 'psi': 0.33238845144356954}
[S6] START round=9 head_norm_before_train=1.580344 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.10148798168637925, 'auprc': 0.10148798168637925, 'loss_val': 5.483466190251944, 'psi': 0.10148798168637925}-{'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 5.229913062585416, 'psi': 0.10179184140297369}
[S7] START round=9 head_norm_before_train=1.190997 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.758416321314077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6557585602124933, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.554482 (no previous merge yet)
[S8] round=9 local utility u=0.126217 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.8758453675355876, 'psi': 0.9988708350860451}-{'f1_val': 0.9803323603792085, 'auprc': 0.9803323603792085, 'loss_val': 0.9614339336871678, 'psi': 0.9803323603792085}
[S9] START round=9 head_norm_before_train=1.388538 (no previous merge yet)
[S9] round=9 local utility u=0.020753 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.437777796255696, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.479284785398992, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.579027 (no previous merge yet)
[S10] round=9 local utility u=0.079714 metrics={'f1_val': 0.3326950694112015, 'auprc': 0.3326950694112015, 'loss_val': 2.9586177394878406, 'psi': 0.3326950694112015}-{'f1_val': 0.332454668903267, 'auprc': 0.332454668903267, 'loss_val': 3.115882593226092, 'psi': 0.332454668903267}
[S11] START round=9 head_norm_before_train=1.352315 (no previous merge yet)
[S11] round=9 local utility u=0.188032 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.977383225950628, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3534468624502365, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.388406 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.661778554297226, 'auprc': 0.661778554297226, 'loss_val': 0.9207429121416273, 'psi': 0.661778554297226}-{'f1_val': 0.23849318590897403, 'auprc': 0.23849318590897403, 'loss_val': 1.1900396360250562, 'psi': 0.23849318590897406}
[S14] START round=9 head_norm_before_train=1.424210 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.296459034945386, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.996904719364088, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.508909 (no previous merge yet)
[S15] round=9 local utility u=0.126292 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.9996657197426685, 'psi': 0.2836055656382335}-{'f1_val': 0.2810863475825113, 'auprc': 0.2810863475825113, 'loss_val': 1.2295765233295022, 'psi': 0.2810863475825113}
[S16] START round=9 head_norm_before_train=1.417173 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.993586412224419, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.945145350312433, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.508905 (no previous merge yet)
[S17] round=9 local utility u=0.101865 metrics={'f1_val': 0.029497098646034815, 'auprc': 0.029497098646034815, 'loss_val': 1.3503997765395312, 'psi': 0.029497098646034815}-{'f1_val': 0.008448060075093867, 'auprc': 0.008448060075093867, 'loss_val': 1.3646881344043373, 'psi': 0.008448060075093867}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38405
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.0044
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38416
[S8] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] cosine check vs S8: cos=-0.0134
[S16] DROPPED delta from S8 (cos=-0.0134 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:38416
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S15
[S7] cosine check vs S15: cos=0.9492
[S16] RECEIVED delta(kind=head bytes=1804) from S13
[S16] cosine check vs S13: cos=-0.0671
[S16] DROPPED delta from S13 (cos=-0.0671 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=-0.1060
[S7] DROPPED delta from S10 (cos=-0.1060 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.029)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.3051 head_norm=1.355425
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.074657e+00
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4257 head_norm=1.079241 delta_norm=1.074657
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.0000 head_norm=1.206419
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.767028e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.359806 delta_norm=0.276703
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.673953 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.20267891312667433, 'auprc': 0.20267891312667433, 'loss_val': 3.11382630059422, 'psi': 0.20267891312667433}-{'f1_val': 0.24597490052035506, 'auprc': 0.24597490052035506, 'loss_val': 2.6961722373219352, 'psi': 0.24597490052035506}
[S3] START round=10 head_norm_before_train=1.417353 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6624481052421674, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.432844321681498, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.546188 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3901901782041657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3866509356474992, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.079241 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.259661 metrics={'f1_val': 0.3544054441260745, 'auprc': 0.3544054441260745, 'loss_val': 1.2988132131388943, 'psi': 0.3544054441260745}-{'f1_val': 0.3051272166538165, 'auprc': 0.3051272166538165, 'loss_val': 1.3746307947898393, 'psi': 0.3051272166538165}
[S6] START round=10 head_norm_before_train=1.623899 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.10163996948893975, 'auprc': 0.10163996948893975, 'loss_val': 5.669219045960363, 'psi': 0.10163996948893975}-{'f1_val': 0.10148798168637925, 'auprc': 0.10148798168637925, 'loss_val': 5.483466190251944, 'psi': 0.10148798168637925}
[S7] START round=10 head_norm_before_train=1.359806 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.802934121831089, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.758416321314077, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.607691 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.743938695114466, 'auprc': 0.743938695114466, 'loss_val': 0.7720736337668752, 'psi': 0.743938695114466}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.8758453675355876, 'psi': 0.9988708350860451}
[S9] START round=10 head_norm_before_train=1.423364 (no previous merge yet)
[S9] round=10 local utility u=0.592123 metrics={'f1_val': 0.09988518943742825, 'auprc': 0.09988518943742825, 'loss_val': 2.1524987056317633, 'psi': 0.09988518943742825}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.437777796255696, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.614119 (no previous merge yet)
[S10] round=10 local utility u=0.078810 metrics={'f1_val': 0.332695374800638, 'auprc': 0.332695374800638, 'loss_val': 2.801001372758968, 'psi': 0.332695374800638}-{'f1_val': 0.3326950694112015, 'auprc': 0.3326950694112015, 'loss_val': 2.9586177394878406, 'psi': 0.3326950694112015}
[S11] START round=10 head_norm_before_train=1.384573 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2262757184986337, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.977383225950628, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.428959 (no previous merge yet)
[S13] round=10 local utility u=0.118608 metrics={'f1_val': 0.6653164753536164, 'auprc': 0.6653164753536164, 'loss_val': 0.7153680473529782, 'psi': 0.6653164753536164}-{'f1_val': 0.661778554297226, 'auprc': 0.661778554297226, 'loss_val': 0.9207429121416273, 'psi': 0.661778554297226}
[S14] START round=10 head_norm_before_train=1.451090 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.023730553424937, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.296459034945386, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.547845 (no previous merge yet)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.2711144427786107, 'auprc': 0.2711144427786107, 'loss_val': 1.0127356166358157, 'psi': 0.2711144427786107}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.9996657197426685, 'psi': 0.2836055656382335}
[S16] START round=10 head_norm_before_train=1.442704 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.089533579500347, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.993586412224419, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.524854 (no previous merge yet)
[S17] round=10 local utility u=0.676362 metrics={'f1_val': 0.16980315812243132, 'auprc': 0.16980315812243132, 'loss_val': 1.2604300535283754, 'psi': 0.16980315812243132}-{'f1_val': 0.029497098646034815, 'auprc': 0.029497098646034815, 'loss_val': 1.3503997765395312, 'psi': 0.029497098646034815}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0288
[S3] DROPPED delta from S5 (cos=-0.0288 < 0.0)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:38408
[S9] not sending this round → trigger blocked (psi=0.100)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.170)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=-0.0674
[S16] DROPPED delta from S13 (cos=-0.0674 < 0.0)
[S10] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S10
[S7] cosine check vs S10: cos=-0.0936
[S7] DROPPED delta from S10 (cos=-0.0936 < 0.0)
[S9] ⇄ pheromone p=0.234 → S3@127.0.0.1:38403
[S4] ⇄ pheromone p=0.117 → S8@127.0.0.1:38409
[S8] ⇄ pheromone p=0.381 → S16@127.0.0.1:38416
[S11] ⇄ pheromone p=0.158 → S10@127.0.0.1:38411
[S3] ⇄ pheromone p=0.130 → S6@127.0.0.1:38407
[S7] ⇄ pheromone p=0.121 → S8@127.0.0.1:38409
[S6] ⇄ pheromone p=0.141 → S7@127.0.0.1:38408
[S5] ⇄ pheromone p=0.289 → S3@127.0.0.1:38403
[S2] ⇄ pheromone p=0.271 → S5@127.0.0.1:38405
[S13] ⇄ pheromone p=0.423 → S16@127.0.0.1:38416
[S14] ⇄ pheromone p=0.121 → S13@127.0.0.1:38413
[S10] ⇄ pheromone p=0.310 → S7@127.0.0.1:38408
[S16] ⇄ pheromone p=0.115 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.282 → S14@127.0.0.1:38414
[S15] ⇄ pheromone p=0.268 → S7@127.0.0.1:38408
[S2] START round=11 head_norm_before_train=1.722667 (no previous merge yet)
[S2] round=11 local utility u=0.858728 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8795579250632377, 'psi': 0.3674775928297055}-{'f1_val': 0.20267891312667433, 'auprc': 0.20267891312667433, 'loss_val': 3.11382630059422, 'psi': 0.20267891312667433}
[S3] START round=11 head_norm_before_train=1.450787 (no previous merge yet)
[S3] round=11 local utility u=0.119994 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4224610781708815, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6624481052421674, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.605774 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4011311702228726, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3901901782041657, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.101028 cos_to_last_merge=0.9987 (last merge round=9)
[S5] round=11 local utility u=0.039821 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2635715439453632, 'psi': 0.35933890172383154}-{'f1_val': 0.3544054441260745, 'auprc': 0.3544054441260745, 'loss_val': 1.2988132131388943, 'psi': 0.3544054441260745}
[S6] START round=11 head_norm_before_train=1.661627 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 6.102874047179986, 'psi': 0.027589326096788783}-{'f1_val': 0.10163996948893975, 'auprc': 0.10163996948893975, 'loss_val': 5.669219045960363, 'psi': 0.10163996948893975}
[S7] START round=11 head_norm_before_train=1.368343 cos_to_last_merge=0.9986 (last merge round=9)
[S7] round=11 local utility u=0.077666 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6476018434713993, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.802934121831089, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.676929 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7014688722864935, 'psi': 0.35939447907390915}-{'f1_val': 0.743938695114466, 'auprc': 0.743938695114466, 'loss_val': 0.7720736337668752, 'psi': 0.743938695114466}
[S9] START round=11 head_norm_before_train=1.456262 (no previous merge yet)
[S9] round=11 local utility u=0.514529 metrics={'f1_val': 0.18735770724521228, 'auprc': 0.18735770724521228, 'loss_val': 1.9106939563917749, 'psi': 0.18735770724521228}-{'f1_val': 0.09988518943742825, 'auprc': 0.09988518943742825, 'loss_val': 2.1524987056317633, 'psi': 0.09988518943742825}
[S10] START round=11 head_norm_before_train=1.646191 (no previous merge yet)
[S10] round=11 local utility u=0.150482 metrics={'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.500758915278071, 'psi': 0.33277551996175}-{'f1_val': 0.332695374800638, 'auprc': 0.332695374800638, 'loss_val': 2.801001372758968, 'psi': 0.332695374800638}
[S11] START round=11 head_norm_before_train=1.420507 (no previous merge yet)
[S11] round=11 local utility u=0.034069 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1581371432845744, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2262757184986337, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.464793 (no previous merge yet)
[S13] round=11 local utility u=0.056295 metrics={'f1_val': 0.6653164753536164, 'auprc': 0.6653164753536164, 'loss_val': 0.6027785045002505, 'psi': 0.6653164753536164}-{'f1_val': 0.6653164753536164, 'auprc': 0.6653164753536164, 'loss_val': 0.7153680473529782, 'psi': 0.6653164753536164}
[S14] START round=11 head_norm_before_train=1.483955 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.39695883041448, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.023730553424937, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.581943 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.26092528514673846, 'auprc': 0.26092528514673846, 'loss_val': 1.0008965055878674, 'psi': 0.26092528514673846}-{'f1_val': 0.2711144427786107, 'auprc': 0.2711144427786107, 'loss_val': 1.0127356166358157, 'psi': 0.2711144427786107}
[S16] START round=11 head_norm_before_train=1.464069 (no previous merge yet)
[S16] round=11 local utility u=0.073937 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9416592182539203, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.089533579500347, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.549102 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.1575727181544634, 'auprc': 0.1575727181544634, 'loss_val': 1.163170243801288, 'psi': 0.1575727181544634}-{'f1_val': 0.16980315812243132, 'auprc': 0.16980315812243132, 'loss_val': 1.2604300535283754, 'psi': 0.16980315812243132}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.187)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38416
[S16] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S10
[S7] cosine check vs S10: cos=-0.0912
[S7] DROPPED delta from S10 (cos=-0.0912 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0360
[S3] DROPPED delta from S5 (cos=-0.0360 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.7448
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=-0.0667
[S16] DROPPED delta from S13 (cos=-0.0667 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.3593 head_norm=1.127964
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.941140e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.3593 head_norm=1.353159 delta_norm=0.594114
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.759465 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.26479133650290543, 'auprc': 0.26479133650290543, 'loss_val': 2.9525861777083624, 'psi': 0.26479133650290543}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.8795579250632377, 'psi': 0.3674775928297055}
[S3] START round=12 head_norm_before_train=1.482783 (no previous merge yet)
[S3] round=12 local utility u=0.069228 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.28400472604304, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4224610781708815, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.659790 (no previous merge yet)
[S4] round=12 local utility u=0.014197 metrics={'f1_val': 0.0006754474839581223, 'auprc': 0.0006754474839581223, 'loss_val': 1.3788167707686456, 'psi': 0.0006754474839581223}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4011311702228726, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.353159 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.017168 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2292353643162615, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2635715439453632, 'psi': 0.35933890172383154}
[S6] START round=12 head_norm_before_train=1.692901 (no previous merge yet)
[S6] round=12 local utility u=0.339860 metrics={'f1_val': 0.10133587786259542, 'auprc': 0.10133587786259542, 'loss_val': 6.086873888584009, 'psi': 0.10133587786259542}-{'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 6.102874047179986, 'psi': 0.027589326096788783}
[S7] START round=12 head_norm_before_train=1.371112 cos_to_last_merge=0.9965 (last merge round=9)
[S7] round=12 local utility u=0.040085 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5674325396816926, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6476018434713993, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.746389 (no previous merge yet)
[S8] round=12 local utility u=0.033952 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6335641386860826, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7014688722864935, 'psi': 0.35939447907390915}
[S9] START round=12 head_norm_before_train=1.488325 (no previous merge yet)
[S9] round=12 local utility u=0.861364 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8197927540985874, 'psi': 0.36867172340800847}-{'f1_val': 0.18735770724521228, 'auprc': 0.18735770724521228, 'loss_val': 1.9106939563917749, 'psi': 0.18735770724521228}
[S10] START round=12 head_norm_before_train=1.691050 (no previous merge yet)
[S10] round=12 local utility u=0.150465 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.1991139091830405, 'psi': 0.3326959847036329}-{'f1_val': 0.33277551996175, 'auprc': 0.33277551996175, 'loss_val': 2.500758915278071, 'psi': 0.33277551996175}
[S11] START round=12 head_norm_before_train=1.453880 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.574421675814008, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1581371432845744, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.502207 (no previous merge yet)
[S13] round=12 local utility u=0.047994 metrics={'f1_val': 0.6657408243150852, 'auprc': 0.6657408243150852, 'loss_val': 0.5106106145682259, 'psi': 0.6657408243150852}-{'f1_val': 0.6653164753536164, 'auprc': 0.6653164753536164, 'loss_val': 0.6027785045002505, 'psi': 0.6653164753536164}
[S14] START round=12 head_norm_before_train=1.515931 (no previous merge yet)
[S14] round=12 local utility u=0.258248 metrics={'f1_val': 0.07653910149750416, 'auprc': 0.07653910149750416, 'loss_val': 4.5693145501283, 'psi': 0.07653910149750416}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.39695883041448, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.615114 (no previous merge yet)
[S15] round=12 local utility u=0.126414 metrics={'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 0.9257100250079692, 'psi': 0.28066325286515487}-{'f1_val': 0.26092528514673846, 'auprc': 0.26092528514673846, 'loss_val': 1.0008965055878674, 'psi': 0.26092528514673846}
[S16] START round=12 head_norm_before_train=1.485532 (no previous merge yet)
[S16] round=12 local utility u=0.050319 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.841020490711986, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9416592182539203, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.575936 (no previous merge yet)
[S17] round=12 local utility u=0.031599 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0524072792327814, 'psi': 0.152287708414114}-{'f1_val': 0.1575727181544634, 'auprc': 0.1575727181544634, 'loss_val': 1.163170243801288, 'psi': 0.1575727181544634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[S3] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.001)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S16] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.077)
[S6] not sending this round → trigger blocked (psi=0.101)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:38416
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S13] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=-0.0875
[S7] DROPPED delta from S10 (cos=-0.0875 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.9676
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.0041
[S16] RECEIVED delta(kind=head bytes=1807) from S13
[S16] cosine check vs S13: cos=-0.0668
[S16] DROPPED delta from S13 (cos=-0.0668 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=-0.0107
[S16] DROPPED delta from S8 (cos=-0.0107 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=-0.1425
[S3] DROPPED delta from S9 (cos=-0.1425 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.152)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.0000 head_norm=1.380957
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.310077e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.498131 delta_norm=0.231008
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.0000 head_norm=1.514715
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.019258e+00
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.023376 delta_norm=1.019258
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.790496 (no previous merge yet)
[S2] round=13 local utility u=0.446668 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.983426536659834, 'psi': 0.3674775928297055}-{'f1_val': 0.26479133650290543, 'auprc': 0.26479133650290543, 'loss_val': 2.9525861777083624, 'psi': 0.26479133650290543}
[S3] START round=13 head_norm_before_train=1.023376 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.167562 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.948881509886976, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.28400472604304, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.704939 (no previous merge yet)
[S4] round=13 local utility u=1.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3262960072063408, 'psi': 0.3567939207526687}-{'f1_val': 0.0006754474839581223, 'auprc': 0.0006754474839581223, 'loss_val': 1.3788167707686456, 'psi': 0.0006754474839581223}
[S5] START round=13 head_norm_before_train=1.370404 cos_to_last_merge=0.9984 (last merge round=11)
[S5] round=13 local utility u=0.014013 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2012087144848005, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2292353643162615, 'psi': 0.35933890172383154}
[S6] START round=13 head_norm_before_train=1.719176 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.03328865058087578, 'auprc': 0.03328865058087578, 'loss_val': 6.341384132183767, 'psi': 0.03328865058087578}-{'f1_val': 0.10133587786259542, 'auprc': 0.10133587786259542, 'loss_val': 6.086873888584009, 'psi': 0.10133587786259542}
[S7] START round=13 head_norm_before_train=1.498131 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000956 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5655208290522367, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5674325396816926, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.798261 (no previous merge yet)
[S8] round=13 local utility u=0.011405 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6107546054190339, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6335641386860826, 'psi': 0.35939447907390915}
[S9] START round=13 head_norm_before_train=1.521983 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.16105107014197922, 'auprc': 0.16105107014197922, 'loss_val': 2.240971175910065, 'psi': 0.16105107014197922}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8197927540985874, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.745731 (no previous merge yet)
[S10] round=13 local utility u=0.009040 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.1810340153609835, 'psi': 0.3326959847036329}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.1991139091830405, 'psi': 0.3326959847036329}
[S11] START round=13 head_norm_before_train=1.481095 (no previous merge yet)
[S11] round=13 local utility u=0.218599 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1372245586117855, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.574421675814008, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.536381 (no previous merge yet)
[S13] round=13 local utility u=0.026384 metrics={'f1_val': 0.6659761124178801, 'auprc': 0.6659761124178801, 'loss_val': 0.45996116280089666, 'psi': 0.6659761124178801}-{'f1_val': 0.6657408243150852, 'auprc': 0.6657408243150852, 'loss_val': 0.5106106145682259, 'psi': 0.6657408243150852}
[S14] START round=13 head_norm_before_train=1.544355 (no previous merge yet)
[S14] round=13 local utility u=0.014191 metrics={'f1_val': 0.09207506412852706, 'auprc': 0.09207506412852706, 'loss_val': 4.6807567185962675, 'psi': 0.09207506412852706}-{'f1_val': 0.07653910149750416, 'auprc': 0.07653910149750416, 'loss_val': 4.5693145501283, 'psi': 0.07653910149750416}
[S15] START round=13 head_norm_before_train=1.639658 (no previous merge yet)
[S15] round=13 local utility u=0.021410 metrics={'f1_val': 0.2815085158150851, 'auprc': 0.2815085158150851, 'loss_val': 0.8904970100455247, 'psi': 0.2815085158150851}-{'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 0.9257100250079692, 'psi': 0.28066325286515487}
[S16] START round=13 head_norm_before_train=1.512253 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.012917594654788419, 'auprc': 0.012917594654788419, 'loss_val': 3.030142374703574, 'psi': 0.012917594654788419}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.841020490711986, 'psi': 0.0}
[S17] START round=13 head_norm_before_train=1.611131 (no previous merge yet)
[S17] round=13 local utility u=0.045015 metrics={'f1_val': 0.15214022854929304, 'auprc': 0.15214022854929304, 'loss_val': 0.9610503354041543, 'psi': 0.15214022854929304}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0524072792327814, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38405
[S3] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.092)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.6382
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.9879
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=-0.0798
[S7] DROPPED delta from S10 (cos=-0.0798 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.0049
[S5] RECEIVED delta(kind=head bytes=1794) from S2
[S5] cosine check vs S2: cos=0.9352
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=-0.0100
[S16] DROPPED delta from S8 (cos=-0.0100 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=-0.0666
[S16] DROPPED delta from S13 (cos=-0.0666 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.152)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.0000 head_norm=1.512737
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.448794e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.583430 delta_norm=0.144879
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.0000 head_norm=1.051830
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.437012e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.110531 delta_norm=0.543701
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.3594 head_norm=1.848160
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.267666e+00
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.3594 head_norm=1.273852 delta_norm=1.267666
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.3593 head_norm=1.396937
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.552011e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.3593 head_norm=1.580794 delta_norm=0.355201
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.816237 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.033538932096375, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.983426536659834, 'psi': 0.3674775928297055}
[S3] START round=14 head_norm_before_train=1.110531 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.613684 metrics={'f1_val': 0.10031783869686134, 'auprc': 0.10031783869686134, 'loss_val': 1.6243734662690437, 'psi': 0.10031783869686134}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.948881509886976, 'psi': 0.0}
[S4] START round=14 head_norm_before_train=1.744608 (no previous merge yet)
[S4] round=14 local utility u=0.018038 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2902197263881958, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3262960072063408, 'psi': 0.3567939207526687}
[S5] START round=14 head_norm_before_train=1.580794 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.006892 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1874256192549497, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2012087144848005, 'psi': 0.35933890172383154}
[S6] START round=14 head_norm_before_train=1.741916 (no previous merge yet)
[S6] round=14 local utility u=0.187805 metrics={'f1_val': 0.07695423248278656, 'auprc': 0.07695423248278656, 'loss_val': 6.358764718642763, 'psi': 0.07695423248278656}-{'f1_val': 0.03328865058087578, 'auprc': 0.03328865058087578, 'loss_val': 6.341384132183767, 'psi': 0.03328865058087578}
[S7] START round=14 head_norm_before_train=1.583430 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.022253 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5210146623663936, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5655208290522367, 'psi': 0.0}
[S8] START round=14 head_norm_before_train=1.273852 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7923365308423718, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6107546054190339, 'psi': 0.35939447907390915}
[S9] START round=14 head_norm_before_train=1.553763 (no previous merge yet)
[S9] round=14 local utility u=0.467453 metrics={'f1_val': 0.24127889701075653, 'auprc': 0.24127889701075653, 'loss_val': 2.0281156257945088, 'psi': 0.24127889701075653}-{'f1_val': 0.16105107014197922, 'auprc': 0.16105107014197922, 'loss_val': 2.240971175910065, 'psi': 0.16105107014197922}
[S10] START round=14 head_norm_before_train=1.809388 (no previous merge yet)
[S10] round=14 local utility u=0.038425 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.105620566984745, 'psi': 0.3328555502468546}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.1810340153609835, 'psi': 0.3326959847036329}
[S11] START round=14 head_norm_before_train=1.502776 (no previous merge yet)
[S11] round=14 local utility u=1.000000 metrics={'f1_val': 0.31467324290998766, 'auprc': 0.31467324290998766, 'loss_val': 1.9925487686522991, 'psi': 0.31467324290998766}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1372245586117855, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.565149 (no previous merge yet)
[S13] round=14 local utility u=0.023487 metrics={'f1_val': 0.6659521951026816, 'auprc': 0.6659521951026816, 'loss_val': 0.41277173219590135, 'psi': 0.6659521951026816}-{'f1_val': 0.6659761124178801, 'auprc': 0.6659761124178801, 'loss_val': 0.45996116280089666, 'psi': 0.6659761124178801}
[S14] START round=14 head_norm_before_train=1.575180 (no previous merge yet)
[S14] round=14 local utility u=0.176974 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.717901608530473, 'psi': 0.1355297641332834}-{'f1_val': 0.09207506412852706, 'auprc': 0.09207506412852706, 'loss_val': 4.6807567185962675, 'psi': 0.09207506412852706}
[S15] START round=14 head_norm_before_train=1.663763 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.27953044754218637, 'auprc': 0.27953044754218637, 'loss_val': 0.8793006532303118, 'psi': 0.27953044754218637}-{'f1_val': 0.2815085158150851, 'auprc': 0.2815085158150851, 'loss_val': 0.8904970100455247, 'psi': 0.2815085158150851}
[S16] START round=14 head_norm_before_train=1.542406 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.00016561775422325274, 'auprc': 0.00016561775422325274, 'loss_val': 3.415056943008161, 'psi': 0.00016561775422325274}-{'f1_val': 0.012917594654788419, 'auprc': 0.012917594654788419, 'loss_val': 3.030142374703574, 'psi': 0.012917594654788419}
[S17] START round=14 head_norm_before_train=1.651830 (no previous merge yet)
[S17] round=14 local utility u=0.025885 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 0.9114050656483291, 'psi': 0.15237633365664405}-{'f1_val': 0.15214022854929304, 'auprc': 0.15214022854929304, 'loss_val': 0.9610503354041543, 'psi': 0.15214022854929304}
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:38403
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:38409
[S14] not sending this round → trigger blocked (psi=0.136)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.077)
[S3] not sending this round → trigger blocked (psi=0.100)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=-0.0759
[S7] DROPPED delta from S10 (cos=-0.0759 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.6439
[S10] RECEIVED delta(kind=head bytes=1800) from S11
[S10] cosine check vs S11: cos=0.0872
[S16] RECEIVED delta(kind=head bytes=1805) from S13
[S16] cosine check vs S13: cos=-0.0664
[S16] DROPPED delta from S13 (cos=-0.0664 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.0738
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.8997
[S17] not sending this round → trigger blocked (psi=0.152)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.3594 head_norm=1.354236
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.873658e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.2395 head_norm=1.421549 delta_norm=0.687366
[S8] aggregate: ROLLBACK (f1_val pre=0.359 post=0.240 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.1003 head_norm=1.127182
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.972614e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.061235 delta_norm=0.497261
[S3] aggregate: ROLLBACK (f1_val pre=0.100 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.3329 head_norm=1.865417
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.151951e+00
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.3329 head_norm=1.254966 delta_norm=1.151951
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.837576 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.2547701500645074, 'auprc': 0.2547701500645074, 'loss_val': 3.241947473145482, 'psi': 0.2547701500645074}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.033538932096375, 'psi': 0.3674775928297055}
[S3] START round=15 head_norm_before_train=1.061235 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.084745 metrics={'f1_val': 0.09952229299363058, 'auprc': 0.09952229299363058, 'loss_val': 1.4477234653794615, 'psi': 0.09952229299363058}-{'f1_val': 0.10031783869686134, 'auprc': 0.10031783869686134, 'loss_val': 1.6243734662690437, 'psi': 0.10031783869686134}
[S4] START round=15 head_norm_before_train=1.775554 (no previous merge yet)
[S4] round=15 local utility u=0.013170 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2638788942401822, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2902197263881958, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.603581 cos_to_last_merge=0.9985 (last merge round=13)
[S5] round=15 local utility u=0.064288 metrics={'f1_val': 0.3703698254645653, 'auprc': 0.3703698254645653, 'loss_val': 1.1581286734157565, 'psi': 0.3703698254645653}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1874256192549497, 'psi': 0.35933890172383154}
[S6] START round=15 head_norm_before_train=1.762427 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.06533499791926758, 'auprc': 0.06533499791926758, 'loss_val': 6.459336692264097, 'psi': 0.06533499791926758}-{'f1_val': 0.07695423248278656, 'auprc': 0.07695423248278656, 'loss_val': 6.358764718642763, 'psi': 0.07695423248278656}
[S7] START round=15 head_norm_before_train=1.597579 cos_to_last_merge=0.9993 (last merge round=13)
[S7] round=15 local utility u=0.030290 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4604354377468345, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5210146623663936, 'psi': 0.0}
[S8] START round=15 head_norm_before_train=1.421549 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9449512923223395, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7923365308423718, 'psi': 0.35939447907390915}
[S9] START round=15 head_norm_before_train=1.582970 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.2418091168091168, 'auprc': 0.2418091168091168, 'loss_val': 2.0473998194316128, 'psi': 0.2418091168091168}-{'f1_val': 0.24127889701075653, 'auprc': 0.24127889701075653, 'loss_val': 2.0281156257945088, 'psi': 0.24127889701075653}
[S10] START round=15 head_norm_before_train=1.254966 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.286641 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.5323388025846332, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 2.105620566984745, 'psi': 0.3328555502468546}
[S11] START round=15 head_norm_before_train=1.524494 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.33271057138408844, 'auprc': 0.33271057138408844, 'loss_val': 2.226755990238699, 'psi': 0.33271057138408844}-{'f1_val': 0.31467324290998766, 'auprc': 0.31467324290998766, 'loss_val': 1.9925487686522991, 'psi': 0.31467324290998766}
[S13] START round=15 head_norm_before_train=1.584310 (no previous merge yet)
[S13] round=15 local utility u=0.029193 metrics={'f1_val': 0.6659521951026816, 'auprc': 0.6659521951026816, 'loss_val': 0.35438514786956765, 'psi': 0.6659521951026816}-{'f1_val': 0.6659521951026816, 'auprc': 0.6659521951026816, 'loss_val': 0.41277173219590135, 'psi': 0.6659521951026816}
[S14] START round=15 head_norm_before_train=1.607809 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.12353241449719245, 'auprc': 0.12353241449719245, 'loss_val': 4.80712917785641, 'psi': 0.12353241449719245}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.717901608530473, 'psi': 0.1355297641332834}
[S15] START round=15 head_norm_before_train=1.694804 (no previous merge yet)
[S15] round=15 local utility u=1.000000 metrics={'f1_val': 0.6134093232882086, 'auprc': 0.6134093232882086, 'loss_val': 0.8487523742982058, 'psi': 0.6134093232882086}-{'f1_val': 0.27953044754218637, 'auprc': 0.27953044754218637, 'loss_val': 0.8793006532303118, 'psi': 0.27953044754218637}
[S16] START round=15 head_norm_before_train=1.568301 (no previous merge yet)
[S16] round=15 local utility u=0.710069 metrics={'f1_val': 0.10148335745296672, 'auprc': 0.10148335745296672, 'loss_val': 2.906778684556353, 'psi': 0.10148335745296672}-{'f1_val': 0.00016561775422325274, 'auprc': 0.00016561775422325274, 'loss_val': 3.415056943008161, 'psi': 0.00016561775422325274}
[S17] START round=15 head_norm_before_train=1.698729 (no previous merge yet)
[S17] round=15 local utility u=0.669520 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9352644452797545, 'psi': 0.30380970798684975}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 0.9114050656483291, 'psi': 0.15237633365664405}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.101)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S3] not sending this round → trigger blocked (psi=0.100)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.9894
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=-0.0783
[S7] DROPPED delta from S10 (cos=-0.0783 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=0.8814
[S3] RECEIVED delta(kind=head bytes=1806) from S5
[S3] cosine check vs S5: cos=0.8946
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=-0.0655
[S16] DROPPED delta from S13 (cos=-0.0655 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S17
[S14] cosine check vs S17: cos=0.0441
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.0995 head_norm=1.069765
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.126374e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.2830 head_norm=1.315216 delta_norm=0.412637
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.196 → S6@127.0.0.1:38407
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.3594 head_norm=1.505305
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.279999e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.3328 head_norm=1.604927 delta_norm=0.428000
[S8] aggregate: ROLLBACK (f1_val pre=0.359 post=0.333 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.130 → S16@127.0.0.1:38416
[S9] ⇄ pheromone p=0.282 → S3@127.0.0.1:38403
[S2] ⇄ pheromone p=0.216 → S5@127.0.0.1:38405
[S11] ⇄ pheromone p=0.243 → S10@127.0.0.1:38411
[S6] ⇄ pheromone p=0.111 → S7@127.0.0.1:38408
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.1235 head_norm=1.639220
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.168576e+00
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.1299 head_norm=1.221237 delta_norm=1.168576
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.096 → S13@127.0.0.1:38413
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.0000 head_norm=1.611039
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.361869e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.667321 delta_norm=0.136187
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.060 → S8@127.0.0.1:38409
[S16] ⇄ pheromone p=0.191 → S4@127.0.0.1:38404
[S10] ⇄ pheromone p=0.194 → S7@127.0.0.1:38408
[S15] ⇄ pheromone p=0.304 → S7@127.0.0.1:38408
[S4] ⇄ pheromone p=0.173 → S8@127.0.0.1:38409
[S5] ⇄ pheromone p=0.116 → S3@127.0.0.1:38403
[S13] ⇄ pheromone p=0.161 → S16@127.0.0.1:38416
[S17] ⇄ pheromone p=0.239 → S14@127.0.0.1:38414
[S2] START round=16 head_norm_before_train=1.855667 (no previous merge yet)
[S2] round=16 local utility u=0.050120 metrics={'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 3.057277108985308, 'psi': 0.24538903139123003}-{'f1_val': 0.2547701500645074, 'auprc': 0.2547701500645074, 'loss_val': 3.241947473145482, 'psi': 0.2547701500645074}
[S3] START round=16 head_norm_before_train=1.315216 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.128141 metrics={'f1_val': 0.13194444444444445, 'auprc': 0.13194444444444445, 'loss_val': 1.4832409872260484, 'psi': 0.13194444444444445}-{'f1_val': 0.09952229299363058, 'auprc': 0.09952229299363058, 'loss_val': 1.4477234653794615, 'psi': 0.09952229299363058}
[S4] START round=16 head_norm_before_train=1.803332 (no previous merge yet)
[S4] round=16 local utility u=0.014439 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2350018918282446, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2638788942401822, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.629640 cos_to_last_merge=0.9950 (last merge round=13)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.2448133229553102, 'auprc': 0.2448133229553102, 'loss_val': 1.1309520543230673, 'psi': 0.24481332295531022}-{'f1_val': 0.3703698254645653, 'auprc': 0.3703698254645653, 'loss_val': 1.1581286734157565, 'psi': 0.3703698254645653}
[S6] START round=16 head_norm_before_train=1.780687 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.04108084358523726, 'auprc': 0.04108084358523726, 'loss_val': 6.574777526359803, 'psi': 0.04108084358523726}-{'f1_val': 0.06533499791926758, 'auprc': 0.06533499791926758, 'loss_val': 6.459336692264097, 'psi': 0.06533499791926758}
[S7] START round=16 head_norm_before_train=1.667321 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4619636767644995, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4604354377468345, 'psi': 0.0}
[S8] START round=16 head_norm_before_train=1.604927 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.34069651204900037, 'auprc': 0.34069651204900037, 'loss_val': 0.911789490983846, 'psi': 0.34069651204900037}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9449512923223395, 'psi': 0.35939447907390915}
[S9] START round=16 head_norm_before_train=1.609346 (no previous merge yet)
[S9] round=16 local utility u=0.575381 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.038401357899539, 'psi': 0.36867172340800847}-{'f1_val': 0.2418091168091168, 'auprc': 0.2418091168091168, 'loss_val': 2.0473998194316128, 'psi': 0.2418091168091168}
[S10] START round=16 head_norm_before_train=1.346446 cos_to_last_merge=0.9960 (last merge round=14)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.8183015445853379, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.5323388025846332, 'psi': 0.3328555502468546}
[S11] START round=16 head_norm_before_train=1.545797 (no previous merge yet)
[S11] round=16 local utility u=0.007952 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.1312875755781273, 'psi': 0.32387008857597094}-{'f1_val': 0.33271057138408844, 'auprc': 0.33271057138408844, 'loss_val': 2.226755990238699, 'psi': 0.33271057138408844}
[S13] START round=16 head_norm_before_train=1.607540 (no previous merge yet)
[S13] round=16 local utility u=0.018822 metrics={'f1_val': 0.6661632986705718, 'auprc': 0.6661632986705718, 'loss_val': 0.3186414511984926, 'psi': 0.6661632986705718}-{'f1_val': 0.6659521951026816, 'auprc': 0.6659521951026816, 'loss_val': 0.35438514786956765, 'psi': 0.6659521951026816}
[S14] START round=16 head_norm_before_train=1.221237 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.977053 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.9627885695646192, 'psi': 0.13572854291417166}-{'f1_val': 0.12353241449719245, 'auprc': 0.12353241449719245, 'loss_val': 4.80712917785641, 'psi': 0.12353241449719245}
[S15] START round=16 head_norm_before_train=1.732503 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6086012607673786, 'auprc': 0.6086012607673786, 'loss_val': 0.828719021377084, 'psi': 0.6086012607673786}-{'f1_val': 0.6134093232882086, 'auprc': 0.6134093232882086, 'loss_val': 0.8487523742982058, 'psi': 0.6134093232882086}
[S16] START round=16 head_norm_before_train=1.591367 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.04699599465954606, 'auprc': 0.04699599465954606, 'loss_val': 3.295744893824801, 'psi': 0.04699599465954606}-{'f1_val': 0.10148335745296672, 'auprc': 0.10148335745296672, 'loss_val': 2.906778684556353, 'psi': 0.10148335745296672}
[S17] START round=16 head_norm_before_train=1.739811 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.15388009980559456, 'auprc': 0.15388009980559456, 'loss_val': 0.8463341478781091, 'psi': 0.15388009980559456}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9352644452797545, 'psi': 0.30380970798684975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:38403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38416
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.132)
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=-0.0659
[S16] DROPPED delta from S13 (cos=-0.0659 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.9429
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.2625
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.9628
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] cosine check vs S11: cos=0.5705
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.3329 head_norm=1.468632
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.053487e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.3329 head_norm=1.346253 delta_norm=0.705349
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.2448 head_norm=1.652460
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.637448e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.2456 head_norm=1.745810 delta_norm=0.263745
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.1319 head_norm=1.323550
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.062114e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.1141 head_norm=1.178421 delta_norm=0.906211
[S3] aggregate: ROLLBACK (f1_val pre=0.132 post=0.114 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.3407 head_norm=1.675512
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.056816e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.3327 head_norm=1.727077 delta_norm=0.305682
[S8] aggregate: ROLLBACK (f1_val pre=0.341 post=0.333 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.871951 (no previous merge yet)
[S2] round=17 local utility u=0.033231 metrics={'f1_val': 0.2618428942634419, 'auprc': 0.2618428942634419, 'loss_val': 3.138900388368996, 'psi': 0.2618428942634419}-{'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 3.057277108985308, 'psi': 0.24538903139123003}
[S3] START round=17 head_norm_before_train=1.178421 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4949307510965095, 'psi': 0.0}-{'f1_val': 0.13194444444444445, 'auprc': 0.13194444444444445, 'loss_val': 1.4832409872260484, 'psi': 0.13194444444444445}
[S4] START round=17 head_norm_before_train=1.828971 (no previous merge yet)
[S4] round=17 local utility u=0.008711 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2175804937416455, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2350018918282446, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.745810 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=1.000000 metrics={'f1_val': 0.6637911369527897, 'auprc': 0.6637911369527897, 'loss_val': 1.1101053324040278, 'psi': 0.6637911369527897}-{'f1_val': 0.2448133229553102, 'auprc': 0.2448133229553102, 'loss_val': 1.1309520543230673, 'psi': 0.24481332295531022}
[S6] START round=17 head_norm_before_train=1.796920 (no previous merge yet)
[S6] round=17 local utility u=0.164177 metrics={'f1_val': 0.0784907183212268, 'auprc': 0.0784907183212268, 'loss_val': 6.583113359832768, 'psi': 0.0784907183212268}-{'f1_val': 0.04108084358523726, 'auprc': 0.04108084358523726, 'loss_val': 6.574777526359803, 'psi': 0.04108084358523726}
[S7] START round=17 head_norm_before_train=1.683100 cos_to_last_merge=0.9995 (last merge round=15)
[S7] round=17 local utility u=0.002349 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4572653984507753, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4619636767644995, 'psi': 0.0}
[S8] START round=17 head_norm_before_train=1.727077 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=1.000000 metrics={'f1_val': 0.665748628360317, 'auprc': 0.665748628360317, 'loss_val': 0.772850420721137, 'psi': 0.665748628360317}-{'f1_val': 0.34069651204900037, 'auprc': 0.34069651204900037, 'loss_val': 0.911789490983846, 'psi': 0.34069651204900037}
[S9] START round=17 head_norm_before_train=1.633403 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.092871029980743, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.038401357899539, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.346253 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.119117 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.5800682408366258, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.8183015445853379, 'psi': 0.3328555502468546}
[S11] START round=17 head_norm_before_train=1.569378 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.288722413444017, 'auprc': 0.288722413444017, 'loss_val': 2.1781141581146333, 'psi': 0.288722413444017}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.1312875755781273, 'psi': 0.32387008857597094}
[S13] START round=17 head_norm_before_train=1.626917 (no previous merge yet)
[S13] round=17 local utility u=0.018109 metrics={'f1_val': 0.6661632986705718, 'auprc': 0.6661632986705718, 'loss_val': 0.28242363031875295, 'psi': 0.6661632986705718}-{'f1_val': 0.6661632986705718, 'auprc': 0.6661632986705718, 'loss_val': 0.3186414511984926, 'psi': 0.6661632986705718}
[S14] START round=17 head_norm_before_train=1.261981 cos_to_last_merge=0.9986 (last merge round=15)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.41766065093221, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 2.9627885695646192, 'psi': 0.13572854291417166}
[S15] START round=17 head_norm_before_train=1.774199 (no previous merge yet)
[S15] round=17 local utility u=0.014972 metrics={'f1_val': 0.6061862353143433, 'auprc': 0.6061862353143433, 'loss_val': 0.7770394483753503, 'psi': 0.6061862353143433}-{'f1_val': 0.6086012607673786, 'auprc': 0.6086012607673786, 'loss_val': 0.828719021377084, 'psi': 0.6086012607673786}
[S16] START round=17 head_norm_before_train=1.613624 (no previous merge yet)
[S16] round=17 local utility u=0.094923 metrics={'f1_val': 0.07038529337698313, 'auprc': 0.07038529337698313, 'loss_val': 3.3164026896593923, 'psi': 0.07038529337698313}-{'f1_val': 0.04699599465954606, 'auprc': 0.04699599465954606, 'loss_val': 3.295744893824801, 'psi': 0.04699599465954606}
[S17] START round=17 head_norm_before_train=1.767687 (no previous merge yet)
[S17] round=17 local utility u=0.685264 metrics={'f1_val': 0.30436108279101676, 'auprc': 0.30436108279101676, 'loss_val': 0.8301358872053904, 'psi': 0.30436108279101676}-{'f1_val': 0.15388009980559456, 'auprc': 0.15388009980559456, 'loss_val': 0.8463341478781091, 'psi': 0.15388009980559456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38416
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:38403
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:38409
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:38405
[S16] not sending this round → trigger blocked (psi=0.070)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[S6] not sending this round → trigger blocked (psi=0.078)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=-0.0664
[S16] DROPPED delta from S13 (cos=-0.0664 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=0.9880
[S7] RECEIVED delta(kind=head bytes=1795) from S15
[S7] cosine check vs S15: cos=0.9901
[S7] RECEIVED delta(kind=head bytes=1805) from S10
[S7] cosine check vs S10: cos=-0.0674
[S7] DROPPED delta from S10 (cos=-0.0674 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S4
[S8] cosine check vs S4: cos=0.9627
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] cosine check vs S8: cos=-0.0345
[S16] DROPPED delta from S8 (cos=-0.0345 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.6518
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.6863
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.1359 head_norm=1.318607
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.499326e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.1359 head_norm=1.426591 delta_norm=0.649933
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.0000 head_norm=1.698175
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.376618e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.0000 head_norm=1.753730 delta_norm=0.137662
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.0000 head_norm=1.180106
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.690009e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.1338 head_norm=1.343288 delta_norm=0.669001
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.6657 head_norm=1.803346
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.507909e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.6445 head_norm=1.811311 delta_norm=0.250791
[S8] aggregate: ROLLBACK (f1_val pre=0.666 post=0.645 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.6638 head_norm=1.763893
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.540890e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.6639 head_norm=1.819470 delta_norm=0.154089
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.886031 (no previous merge yet)
[S2] round=18 local utility u=0.463946 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.161719698380568, 'psi': 0.3674775928297055}-{'f1_val': 0.2618428942634419, 'auprc': 0.2618428942634419, 'loss_val': 3.138900388368996, 'psi': 0.2618428942634419}
[S3] START round=18 head_norm_before_train=1.343288 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=1.000000 metrics={'f1_val': 0.2771492118750604, 'auprc': 0.2771492118750604, 'loss_val': 1.4839282906729876, 'psi': 0.2771492118750604}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4949307510965095, 'psi': 0.0}
[S4] START round=18 head_norm_before_train=1.853490 (no previous merge yet)
[S4] round=18 local utility u=0.007323 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.202935014321277, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2175804937416455, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.819470 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.022228 metrics={'f1_val': 0.6637664871695811, 'auprc': 0.6637664871695811, 'loss_val': 1.065426847296439, 'psi': 0.6637664871695811}-{'f1_val': 0.6637911369527897, 'auprc': 0.6637911369527897, 'loss_val': 1.1101053324040278, 'psi': 0.6637911369527897}
[S6] START round=18 head_norm_before_train=1.812114 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.0822, 'auprc': 0.0822, 'loss_val': 6.637913418492155, 'psi': 0.0822}-{'f1_val': 0.0784907183212268, 'auprc': 0.0784907183212268, 'loss_val': 6.583113359832768, 'psi': 0.0784907183212268}
[S7] START round=18 head_norm_before_train=1.753730 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.007654 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.441957543872407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4572653984507753, 'psi': 0.0}
[S8] START round=18 head_norm_before_train=1.811311 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=1.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.6878545547473542, 'psi': 0.9988708350860451}-{'f1_val': 0.665748628360317, 'auprc': 0.665748628360317, 'loss_val': 0.772850420721137, 'psi': 0.665748628360317}
[S9] START round=18 head_norm_before_train=1.655185 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1591483455573055, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.092871029980743, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.458128 cos_to_last_merge=0.9892 (last merge round=16)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.016990635474362, 'psi': 0.3326959847036329}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.5800682408366258, 'psi': 0.3328555502468546}
[S11] START round=18 head_norm_before_train=1.593089 (no previous merge yet)
[S11] round=18 local utility u=0.014872 metrics={'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.0736413139086447, 'psi': 0.28041912246234446}-{'f1_val': 0.288722413444017, 'auprc': 0.288722413444017, 'loss_val': 2.1781141581146333, 'psi': 0.288722413444017}
[S13] START round=18 head_norm_before_train=1.645528 (no previous merge yet)
[S13] round=18 local utility u=0.013721 metrics={'f1_val': 0.6663741355251734, 'auprc': 0.6663741355251734, 'loss_val': 0.256878810269286, 'psi': 0.6663741355251734}-{'f1_val': 0.6661632986705718, 'auprc': 0.6661632986705718, 'loss_val': 0.28242363031875295, 'psi': 0.6661632986705718}
[S14] START round=18 head_norm_before_train=1.426591 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.291662 metrics={'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 2.7910597994498794, 'psi': 0.13111866112998616}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.41766065093221, 'psi': 0.13592717296421}
[S15] START round=18 head_norm_before_train=1.818033 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.5933073623801149, 'auprc': 0.5933073623801149, 'loss_val': 0.80032894416631, 'psi': 0.5933073623801149}-{'f1_val': 0.6061862353143433, 'auprc': 0.6061862353143433, 'loss_val': 0.7770394483753503, 'psi': 0.6061862353143433}
[S16] START round=18 head_norm_before_train=1.637041 (no previous merge yet)
[S16] round=18 local utility u=0.010675 metrics={'f1_val': 0.06986845371059816, 'auprc': 0.06986845371059816, 'loss_val': 3.2904003421047108, 'psi': 0.06986845371059816}-{'f1_val': 0.07038529337698313, 'auprc': 0.07038529337698313, 'loss_val': 3.3164026896593923, 'psi': 0.07038529337698313}
[S17] START round=18 head_norm_before_train=1.782253 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 0.9050688555073297, 'psi': 0.3065619657460797}-{'f1_val': 0.30436108279101676, 'auprc': 0.30436108279101676, 'loss_val': 0.8301358872053904, 'psi': 0.30436108279101676}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S14] not sending this round → trigger blocked (psi=0.131)
[S16] not sending this round → trigger blocked (psi=0.070)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38416
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:38409
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:38405
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:38403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:38411
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S4
[S8] cosine check vs S4: cos=0.9724
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=0.0028
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] cosine check vs S5: cos=0.9332
[S5] RECEIVED delta(kind=head bytes=1794) from S2
[S5] cosine check vs S2: cos=0.9947
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=-0.0671
[S16] DROPPED delta from S13 (cos=-0.0671 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=-0.0305
[S16] DROPPED delta from S8 (cos=-0.0305 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=0.7688
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.0822 head_norm=1.826485
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.135045e+00
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.0550 head_norm=1.138036 delta_norm=1.135045
[S6] aggregate: ROLLBACK (f1_val pre=0.082 post=0.055 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.3327 head_norm=1.578191
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.437935e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.3327 head_norm=1.503235 delta_norm=0.543793
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.2771 head_norm=1.353093
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.766928e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.2875 head_norm=1.569345 delta_norm=0.376693
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.6638 head_norm=1.838104
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.011292e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.6638 head_norm=1.866354 delta_norm=0.101129
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9989 head_norm=1.887196
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.208606e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9989 head_norm=1.867919 delta_norm=0.220861
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.899575 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2545058046308768, 'auprc': 0.2545058046308768, 'loss_val': 3.108622265672171, 'psi': 0.2545058046308768}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.161719698380568, 'psi': 0.3674775928297055}
[S3] START round=19 head_norm_before_train=1.569345 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.22052643220526433, 'auprc': 0.22052643220526433, 'loss_val': 1.482175539683717, 'psi': 0.22052643220526433}-{'f1_val': 0.2771492118750604, 'auprc': 0.2771492118750604, 'loss_val': 1.4839282906729876, 'psi': 0.2771492118750604}
[S4] START round=19 head_norm_before_train=1.874644 (no previous merge yet)
[S4] round=19 local utility u=0.002869 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1971970091067705, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.202935014321277, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.866354 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.5887197886556259, 'auprc': 0.5887197886556259, 'loss_val': 1.028954714803583, 'psi': 0.5887197886556259}-{'f1_val': 0.6637664871695811, 'auprc': 0.6637664871695811, 'loss_val': 1.065426847296439, 'psi': 0.6637664871695811}
[S6] START round=19 head_norm_before_train=1.138036 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.03701241134751773, 'auprc': 0.03701241134751773, 'loss_val': 4.116249680600099, 'psi': 0.03701241134751773}-{'f1_val': 0.0822, 'auprc': 0.0822, 'loss_val': 6.637913418492155, 'psi': 0.0822}
[S7] START round=19 head_norm_before_train=1.766242 cos_to_last_merge=0.9998 (last merge round=17)
[S7] round=19 local utility u=0.005023 metrics={'f1_val': 0.0007689350249903883, 'auprc': 0.0007689350249903883, 'loss_val': 1.4388321858282564, 'psi': 0.0007689350249903883}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.441957543872407, 'psi': 0.0}
[S8] START round=19 head_norm_before_train=1.867919 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.025201 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.6374531525094548, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.6878545547473542, 'psi': 0.9988708350860451}
[S9] START round=19 head_norm_before_train=1.674145 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.207725539685983, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1591483455573055, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.503235 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.178797 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.6608324598046922, 'psi': 0.3328555502468546}-{'f1_val': 0.3326959847036329, 'auprc': 0.3326959847036329, 'loss_val': 2.016990635474362, 'psi': 0.3326959847036329}
[S11] START round=19 head_norm_before_train=1.618693 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 2.274282506954062, 'psi': 0.28050858565998166}-{'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.0736413139086447, 'psi': 0.28041912246234446}
[S13] START round=19 head_norm_before_train=1.670272 (no previous merge yet)
[S13] round=19 local utility u=1.000000 metrics={'f1_val': 0.9994384014766454, 'auprc': 0.9994384014766454, 'loss_val': 0.23896206806101195, 'psi': 0.9994384014766454}-{'f1_val': 0.6663741355251734, 'auprc': 0.6663741355251734, 'loss_val': 0.256878810269286, 'psi': 0.6663741355251734}
[S14] START round=19 head_norm_before_train=1.465415 cos_to_last_merge=0.9973 (last merge round=17)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.380068518676907, 'psi': 0.13587634006482174}-{'f1_val': 0.13111866112998616, 'auprc': 0.13111866112998616, 'loss_val': 2.7910597994498794, 'psi': 0.13111866112998616}
[S15] START round=19 head_norm_before_train=1.863789 (no previous merge yet)
[S15] round=19 local utility u=0.140717 metrics={'f1_val': 0.6102517882741235, 'auprc': 0.6102517882741235, 'loss_val': 0.6713944280691057, 'psi': 0.6102517882741235}-{'f1_val': 0.5933073623801149, 'auprc': 0.5933073623801149, 'loss_val': 0.80032894416631, 'psi': 0.5933073623801149}
[S16] START round=19 head_norm_before_train=1.662808 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.06714801444043321, 'auprc': 0.06714801444043321, 'loss_val': 3.6653148906923896, 'psi': 0.06714801444043321}-{'f1_val': 0.06986845371059816, 'auprc': 0.06986845371059816, 'loss_val': 3.2904003421047108, 'psi': 0.06986845371059816}
[S17] START round=19 head_norm_before_train=1.806688 (no previous merge yet)
[S17] round=19 local utility u=0.376310 metrics={'f1_val': 0.3890285167370714, 'auprc': 0.3890285167370714, 'loss_val': 0.8946486648107644, 'psi': 0.3890285167370714}-{'f1_val': 0.3065619657460797, 'auprc': 0.3065619657460797, 'loss_val': 0.9050688555073297, 'psi': 0.3065619657460797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[S7] not sending this round → trigger blocked (psi=0.001)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:38416
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38416
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.037)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:38409
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:38408
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=-0.0230
[S16] DROPPED delta from S8 (cos=-0.0230 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=-0.0676
[S16] DROPPED delta from S13 (cos=-0.0676 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=-0.0651
[S7] DROPPED delta from S10 (cos=-0.0651 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=0.9920
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=0.9795
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.8916
[S6] r=20 psi=0.037 u=1.0000 p_local=0.2665 f1=0.037 auprc=0.037 bytes=0
[S3] r=20 psi=0.221 u=0.0000 p_local=0.2535 f1=0.221 auprc=0.221 bytes=1798
[S2] r=20 psi=0.255 u=0.0000 p_local=0.1722 f1=0.255 auprc=0.255 bytes=10794
[S5] r=20 psi=0.589 u=0.0000 p_local=0.1789 f1=0.589 auprc=0.589 bytes=17999
[S11] r=20 psi=0.281 u=0.0000 p_local=0.1026 f1=0.281 auprc=0.281 bytes=5393
[S9] r=20 psi=0.369 u=0.0000 p_local=0.1743 f1=0.369 auprc=0.369 bytes=5403
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.1359 head_norm=1.517740
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.192630e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.1359 head_norm=1.629924 delta_norm=0.419263
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.136 u=0.0000 p_local=0.1862 f1=0.136 auprc=0.136 bytes=0
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.0008 head_norm=1.781887
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.327873e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.0870 head_norm=1.841069 delta_norm=0.132787
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.001 u=0.0050 p_local=0.0270 f1=0.001 auprc=0.001 bytes=0
[S16] r=20 psi=0.067 u=0.0000 p_local=0.0921 f1=0.067 auprc=0.067 bytes=0
[S10] r=20 psi=0.333 u=0.1788 p_local=0.1305 f1=0.333 auprc=0.333 bytes=19824
[S13] r=20 psi=0.999 u=1.0000 p_local=0.2725 f1=0.999 auprc=0.999 bytes=23431
[S4] r=20 psi=0.357 u=0.0029 p_local=0.0753 f1=0.357 auprc=0.357 bytes=12603
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9989 head_norm=1.940077
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.954874e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.6647 head_norm=1.908223 delta_norm=0.195487
[S8] aggregate: ROLLBACK (f1_val pre=0.999 post=0.665 tol_abs=0.005 tol_rel=0.0)
[S8] r=20 psi=0.999 u=0.0252 p_local=0.3462 f1=0.999 auprc=0.999 bytes=16201
[S15] r=20 psi=0.610 u=0.1407 p_local=0.1544 f1=0.610 auprc=0.610 bytes=14398
[S17] r=20 psi=0.389 u=0.3763 p_local=0.2610 f1=0.389 auprc=0.389 bytes=5407
[S2] START round=20 head_norm_before_train=1.911405 (no previous merge yet)
[S2] round=20 local utility u=0.444900 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.2355674117827227, 'psi': 0.3674775928297055}-{'f1_val': 0.2545058046308768, 'auprc': 0.2545058046308768, 'loss_val': 3.108622265672171, 'psi': 0.2545058046308768}
[S3] START round=20 head_norm_before_train=1.581752 cos_to_last_merge=0.9973 (last merge round=18)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.1988928430209569, 'auprc': 0.1988928430209569, 'loss_val': 1.5246380465351133, 'psi': 0.1988928430209569}-{'f1_val': 0.22052643220526433, 'auprc': 0.22052643220526433, 'loss_val': 1.482175539683717, 'psi': 0.22052643220526433}
[S4] START round=20 head_norm_before_train=1.896092 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2089028270866138, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1971970091067705, 'psi': 0.3567939207526687}
[S5] START round=20 head_norm_before_train=1.885093 cos_to_last_merge=0.9996 (last merge round=18)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.0240348944439481, 'psi': 0.33400978131092857}-{'f1_val': 0.5887197886556259, 'auprc': 0.5887197886556259, 'loss_val': 1.028954714803583, 'psi': 0.5887197886556259}
[S6] START round=20 head_norm_before_train=1.203848 cos_to_last_merge=0.9966 (last merge round=18)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.033497096918267084, 'auprc': 0.033497096918267084, 'loss_val': 4.642703296009821, 'psi': 0.033497096918267084}-{'f1_val': 0.03701241134751773, 'auprc': 0.03701241134751773, 'loss_val': 4.116249680600099, 'psi': 0.03701241134751773}
[S7] START round=20 head_norm_before_train=1.841069 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.877934 metrics={'f1_val': 0.1937999867803556, 'auprc': 0.1937999867803556, 'loss_val': 1.4202444276515929, 'psi': 0.1937999867803556}-{'f1_val': 0.0007689350249903883, 'auprc': 0.0007689350249903883, 'loss_val': 1.4388321858282564, 'psi': 0.0007689350249903883}
[S8] START round=20 head_norm_before_train=1.908223 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.023879 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.5896947143310948, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.6374531525094548, 'psi': 0.9988708350860451}
[S9] START round=20 head_norm_before_train=1.691470 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2503302941323984, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.207725539685983, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.598140 cos_to_last_merge=0.9928 (last merge round=18)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.9083800971756066, 'psi': 0.3328555502468546}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.6608324598046922, 'psi': 0.3328555502468546}
[S11] START round=20 head_norm_before_train=1.640553 (no previous merge yet)
[S11] round=20 local utility u=0.075029 metrics={'f1_val': 0.280253943320898, 'auprc': 0.280253943320898, 'loss_val': 2.1219329474684923, 'psi': 0.280253943320898}-{'f1_val': 0.28050858565998166, 'auprc': 0.28050858565998166, 'loss_val': 2.274282506954062, 'psi': 0.28050858565998166}
[S13] START round=20 head_norm_before_train=1.697253 (no previous merge yet)
[S13] round=20 local utility u=0.000137 metrics={'f1_val': 0.9988769591892497, 'auprc': 0.9988769591892497, 'loss_val': 0.2336357335151331, 'psi': 0.9988769591892497}-{'f1_val': 0.9994384014766454, 'auprc': 0.9994384014766454, 'loss_val': 0.23896206806101195, 'psi': 0.9994384014766454}
[S14] START round=20 head_norm_before_train=1.629924 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.158454 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.0627024253546336, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.380068518676907, 'psi': 0.13587634006482174}
[S15] START round=20 head_norm_before_train=1.907673 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6039731450602449, 'auprc': 0.6039731450602449, 'loss_val': 0.6438300381432562, 'psi': 0.6039731450602449}-{'f1_val': 0.6102517882741235, 'auprc': 0.6102517882741235, 'loss_val': 0.6713944280691057, 'psi': 0.6102517882741235}
[S16] START round=20 head_norm_before_train=1.687585 (no previous merge yet)
[S16] round=20 local utility u=0.038370 metrics={'f1_val': 0.09006410256410256, 'auprc': 0.09006410256410256, 'loss_val': 3.794820528870792, 'psi': 0.09006410256410256}-{'f1_val': 0.06714801444043321, 'auprc': 0.06714801444043321, 'loss_val': 3.6653148906923896, 'psi': 0.06714801444043321}
[S17] START round=20 head_norm_before_train=1.833394 (no previous merge yet)
[S17] round=20 local utility u=0.034432 metrics={'f1_val': 0.396555733332463, 'auprc': 0.396555733332463, 'loss_val': 0.8935290354017662, 'psi': 0.396555733332463}-{'f1_val': 0.3890285167370714, 'auprc': 0.3890285167370714, 'loss_val': 0.8946486648107644, 'psi': 0.3890285167370714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:38411
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.194)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:38416
[S14] not sending this round → trigger blocked (psi=0.136)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=-0.0156
[S16] DROPPED delta from S8 (cos=-0.0156 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S2
[S5] cosine check vs S2: cos=0.9948
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] cosine check vs S13: cos=-0.0679
[S16] DROPPED delta from S13 (cos=-0.0679 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=0.8590
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.9611
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.1358 head_norm=1.668574
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.628970e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.1358 head_norm=1.745187 delta_norm=0.262897
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.181 → S13@127.0.0.1:38413
[S9] ⇄ pheromone p=0.139 → S3@127.0.0.1:38403
[S3] ⇄ pheromone p=0.203 → S6@127.0.0.1:38407
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.3329 head_norm=1.696108
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.456986e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.3329 head_norm=1.616817 delta_norm=0.445699
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.104 → S7@127.0.0.1:38408
[S7] ⇄ pheromone p=0.197 → S8@127.0.0.1:38409
[S15] ⇄ pheromone p=0.124 → S7@127.0.0.1:38408
[S6] ⇄ pheromone p=0.213 → S7@127.0.0.1:38408
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.3340 head_norm=1.904723
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.816273e-02
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.4966 head_norm=1.911541 delta_norm=0.098163
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.143 → S3@127.0.0.1:38403
[S4] ⇄ pheromone p=0.060 → S8@127.0.0.1:38409
[S2] ⇄ pheromone p=0.227 → S5@127.0.0.1:38405
[S8] ⇄ pheromone p=0.282 → S16@127.0.0.1:38416
[S13] ⇄ pheromone p=0.218 → S16@127.0.0.1:38416
[S11] ⇄ pheromone p=0.097 → S10@127.0.0.1:38411
[S16] ⇄ pheromone p=0.081 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.216 → S14@127.0.0.1:38414
[S2] START round=21 head_norm_before_train=1.923351 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.264679792701597, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.2355674117827227, 'psi': 0.3674775928297055}
[S3] START round=21 head_norm_before_train=1.602225 cos_to_last_merge=0.9906 (last merge round=18)
[S3] round=21 local utility u=0.014977 metrics={'f1_val': 0.21166032953105196, 'auprc': 0.21166032953105196, 'loss_val': 1.6095908159856267, 'psi': 0.21166032953105196}-{'f1_val': 0.1988928430209569, 'auprc': 0.1988928430209569, 'loss_val': 1.5246380465351133, 'psi': 0.1988928430209569}
[S4] START round=21 head_norm_before_train=1.913843 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.226714786350285, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2089028270866138, 'psi': 0.3567939207526687}
[S5] START round=21 head_norm_before_train=1.911541 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.2351533302941282, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.0240348944439481, 'psi': 0.33400978131092857}
[S6] START round=21 head_norm_before_train=1.296980 cos_to_last_merge=0.9869 (last merge round=18)
[S6] round=21 local utility u=0.067464 metrics={'f1_val': 0.08699090549624358, 'auprc': 0.08699090549624358, 'loss_val': 4.989220062461664, 'psi': 0.08699090549624358}-{'f1_val': 0.033497096918267084, 'auprc': 0.033497096918267084, 'loss_val': 4.642703296009821, 'psi': 0.033497096918267084}
[S7] START round=21 head_norm_before_train=1.856620 cos_to_last_merge=0.9998 (last merge round=19)
[S7] round=21 local utility u=0.175308 metrics={'f1_val': 0.23119065010956905, 'auprc': 0.23119065010956905, 'loss_val': 1.4061449033356292, 'psi': 0.23119065010956907}-{'f1_val': 0.1937999867803556, 'auprc': 0.1937999867803556, 'loss_val': 1.4202444276515929, 'psi': 0.1937999867803556}
[S8] START round=21 head_norm_before_train=1.969686 cos_to_last_merge=0.9980 (last merge round=19)
[S8] round=21 local utility u=0.048139 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.49341724352718086, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.5896947143310948, 'psi': 0.9988708350860451}
[S9] START round=21 head_norm_before_train=1.707096 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.287746800758635, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2503302941323984, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.616817 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.172183 metrics={'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 1.5632958743539382, 'psi': 0.3327757865392274}-{'f1_val': 0.3328555502468546, 'auprc': 0.3328555502468546, 'loss_val': 1.9083800971756066, 'psi': 0.3328555502468546}
[S11] START round=21 head_norm_before_train=1.657922 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.2894256139638725, 'auprc': 0.2894256139638725, 'loss_val': 2.4830747958364707, 'psi': 0.2894256139638725}-{'f1_val': 0.280253943320898, 'auprc': 0.280253943320898, 'loss_val': 2.1219329474684923, 'psi': 0.280253943320898}
[S13] START round=21 head_norm_before_train=1.716132 (no previous merge yet)
[S13] round=21 local utility u=0.014090 metrics={'f1_val': 0.9994384014766454, 'auprc': 0.9994384014766454, 'loss_val': 0.21050896407380956, 'psi': 0.9994384014766454}-{'f1_val': 0.9988769591892497, 'auprc': 0.9988769591892497, 'loss_val': 0.2336357335151331, 'psi': 0.9988769591892497}
[S14] START round=21 head_norm_before_train=1.745187 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.002179 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.0588013766636646, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.0627024253546336, 'psi': 0.13582554517133957}
[S15] START round=21 head_norm_before_train=1.945700 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.5717201815468641, 'auprc': 0.5717201815468641, 'loss_val': 0.7639814394861189, 'psi': 0.5717201815468641}-{'f1_val': 0.6039731450602449, 'auprc': 0.6039731450602449, 'loss_val': 0.6438300381432562, 'psi': 0.6039731450602449}
[S16] START round=21 head_norm_before_train=1.708806 (no previous merge yet)
[S16] round=21 local utility u=0.281226 metrics={'f1_val': 0.12574086578137894, 'auprc': 0.12574086578137894, 'loss_val': 3.553458913323338, 'psi': 0.12574086578137894}-{'f1_val': 0.09006410256410256, 'auprc': 0.09006410256410256, 'loss_val': 3.794820528870792, 'psi': 0.09006410256410256}
[S17] START round=21 head_norm_before_train=1.856190 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3060124359905949, 'auprc': 0.3060124359905949, 'loss_val': 1.0528509108473871, 'psi': 0.3060124359905949}-{'f1_val': 0.396555733332463, 'auprc': 0.396555733332463, 'loss_val': 0.8935290354017662, 'psi': 0.396555733332463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:38407
[S6] not sending this round → trigger blocked (psi=0.087)
[S16] not sending this round → trigger blocked (psi=0.126)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:38409
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=-0.0616
[S7] DROPPED delta from S10 (cos=-0.0616 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=-0.0152
[S16] DROPPED delta from S8 (cos=-0.0152 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] cosine check vs S7: cos=-0.0198
[S8] DROPPED delta from S7 (cos=-0.0198 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] cosine check vs S3: cos=0.4573
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=-0.0676
[S16] DROPPED delta from S13 (cos=-0.0676 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.0870 head_norm=1.375612
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.902300e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.0787 head_norm=1.284380 delta_norm=0.790230
[S6] aggregate: ROLLBACK (f1_val pre=0.087 post=0.079 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.934640 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.290846753453958, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.264679792701597, 'psi': 0.3674775928297055}
[S3] START round=22 head_norm_before_train=1.629689 cos_to_last_merge=0.9821 (last merge round=18)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.19877494566291246, 'auprc': 0.19877494566291246, 'loss_val': 1.6042584296539217, 'psi': 0.19877494566291246}-{'f1_val': 0.21166032953105196, 'auprc': 0.21166032953105196, 'loss_val': 1.6095908159856267, 'psi': 0.21166032953105196}
[S4] START round=22 head_norm_before_train=1.932235 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.238154490680283, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.226714786350285, 'psi': 0.3567939207526687}
[S5] START round=22 head_norm_before_train=1.933673 cos_to_last_merge=0.9997 (last merge round=20)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.488087560466325, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.2351533302941282, 'psi': 0.33400978131092857}
[S6] START round=22 head_norm_before_train=1.284380 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.282436 metrics={'f1_val': 0.026088929219600727, 'auprc': 0.026088929219600727, 'loss_val': 3.8762308735193827, 'psi': 0.026088929219600723}-{'f1_val': 0.08699090549624358, 'auprc': 0.08699090549624358, 'loss_val': 4.989220062461664, 'psi': 0.08699090549624358}
[S7] START round=22 head_norm_before_train=1.872227 cos_to_last_merge=0.9992 (last merge round=19)
[S7] round=22 local utility u=0.586317 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3906678411767308, 'psi': 0.35976373724718097}-{'f1_val': 0.23119065010956905, 'auprc': 0.23119065010956905, 'loss_val': 1.4061449033356292, 'psi': 0.23119065010956907}
[S8] START round=22 head_norm_before_train=2.015382 cos_to_last_merge=0.9952 (last merge round=19)
[S8] round=22 local utility u=0.023315 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.446787989834763, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.49341724352718086, 'psi': 0.9988708350860451}
[S9] START round=22 head_norm_before_train=1.720940 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3230040113213257, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.287746800758635, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.698949 cos_to_last_merge=0.9957 (last merge round=20)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.33269628921802835, 'auprc': 0.33269628921802835, 'loss_val': 1.7430803106034254, 'psi': 0.33269628921802835}-{'f1_val': 0.3327757865392274, 'auprc': 0.3327757865392274, 'loss_val': 1.5632958743539382, 'psi': 0.3327757865392274}
[S11] START round=22 head_norm_before_train=1.674405 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.28045344341786255, 'auprc': 0.28045344341786255, 'loss_val': 2.409262561780313, 'psi': 0.28045344341786255}-{'f1_val': 0.2894256139638725, 'auprc': 0.2894256139638725, 'loss_val': 2.4830747958364707, 'psi': 0.2894256139638725}
[S13] START round=22 head_norm_before_train=1.728354 (no previous merge yet)
[S13] round=22 local utility u=0.009987 metrics={'f1_val': 0.9997191811393451, 'auprc': 0.9997191811393451, 'loss_val': 0.19306209655581758, 'psi': 0.9997191811393451}-{'f1_val': 0.9994384014766454, 'auprc': 0.9994384014766454, 'loss_val': 0.21050896407380956, 'psi': 0.9994384014766454}
[S14] START round=22 head_norm_before_train=1.780997 cos_to_last_merge=0.9975 (last merge round=20)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.6290604737678076, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.0588013766636646, 'psi': 0.13587634006482174}
[S15] START round=22 head_norm_before_train=1.981101 (no previous merge yet)
[S15] round=22 local utility u=0.119089 metrics={'f1_val': 0.5884055561029516, 'auprc': 0.5884055561029516, 'loss_val': 0.6759720252032348, 'psi': 0.5884055561029516}-{'f1_val': 0.5717201815468641, 'auprc': 0.5717201815468641, 'loss_val': 0.7639814394861189, 'psi': 0.5717201815468641}
[S16] START round=22 head_norm_before_train=1.728702 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.11945962355798422, 'auprc': 0.11945962355798422, 'loss_val': 3.626537333148326, 'psi': 0.11945962355798422}-{'f1_val': 0.12574086578137894, 'auprc': 0.12574086578137894, 'loss_val': 3.553458913323338, 'psi': 0.12574086578137894}
[S17] START round=22 head_norm_before_train=1.879418 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.30436108279101676, 'auprc': 0.30436108279101676, 'loss_val': 1.1335751059502759, 'psi': 0.30436108279101676}-{'f1_val': 0.3060124359905949, 'auprc': 0.3060124359905949, 'loss_val': 1.0528509108473871, 'psi': 0.3060124359905949}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.026)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38416
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:38416
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.9913
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] cosine check vs S7: cos=-0.0208
[S8] DROPPED delta from S7 (cos=-0.0208 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=-0.0673
[S16] DROPPED delta from S13 (cos=-0.0673 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=-0.0129
[S16] DROPPED delta from S8 (cos=-0.0129 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.3598 head_norm=1.886387
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.429124e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.3598 head_norm=1.944364 delta_norm=0.142912
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.945414 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.282141870123871, 'psi': 0.2450298816928894}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.290846753453958, 'psi': 0.3674775928297055}
[S3] START round=23 head_norm_before_train=1.655531 cos_to_last_merge=0.9750 (last merge round=18)
[S3] round=23 local utility u=0.252197 metrics={'f1_val': 0.2616725191832488, 'auprc': 0.2616725191832488, 'loss_val': 1.6659418718623489, 'psi': 0.2616725191832488}-{'f1_val': 0.19877494566291246, 'auprc': 0.19877494566291246, 'loss_val': 1.6042584296539217, 'psi': 0.19877494566291246}
[S4] START round=23 head_norm_before_train=1.951058 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.251639342603545, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.238154490680283, 'psi': 0.3567939207526687}
[S5] START round=23 head_norm_before_train=1.958291 cos_to_last_merge=0.9987 (last merge round=20)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.9584316775230974, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.488087560466325, 'psi': 0.33400978131092857}
[S6] START round=23 head_norm_before_train=1.368977 cos_to_last_merge=0.9928 (last merge round=21)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.03598400710795202, 'auprc': 0.03598400710795202, 'loss_val': 4.5584677688599395, 'psi': 0.03598400710795202}-{'f1_val': 0.026088929219600727, 'auprc': 0.026088929219600727, 'loss_val': 3.8762308735193827, 'psi': 0.026088929219600723}
[S7] START round=23 head_norm_before_train=1.944364 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3936010909674579, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3906678411767308, 'psi': 0.35976373724718097}
[S8] START round=23 head_norm_before_train=2.050984 cos_to_last_merge=0.9927 (last merge round=19)
[S8] round=23 local utility u=0.014544 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.41769941310283865, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.446787989834763, 'psi': 0.9988708350860451}
[S9] START round=23 head_norm_before_train=1.733701 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.355507718263098, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3230040113213257, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.780895 cos_to_last_merge=0.9872 (last merge round=20)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.33158813263525305, 'auprc': 0.33158813263525305, 'loss_val': 1.7386083850112997, 'psi': 0.33158813263525305}-{'f1_val': 0.33269628921802835, 'auprc': 0.33269628921802835, 'loss_val': 1.7430803106034254, 'psi': 0.33269628921802835}
[S11] START round=23 head_norm_before_train=1.688670 (no previous merge yet)
[S11] round=23 local utility u=0.031264 metrics={'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.3464248561184338, 'psi': 0.28041912246234446}-{'f1_val': 0.28045344341786255, 'auprc': 0.28045344341786255, 'loss_val': 2.409262561780313, 'psi': 0.28045344341786255}
[S13] START round=23 head_norm_before_train=1.742580 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6663741355251734, 'auprc': 0.6663741355251734, 'loss_val': 0.1707460912275532, 'psi': 0.6663741355251734}-{'f1_val': 0.9997191811393451, 'auprc': 0.9997191811393451, 'loss_val': 0.19306209655581758, 'psi': 0.9997191811393451}
[S14] START round=23 head_norm_before_train=1.823748 cos_to_last_merge=0.9914 (last merge round=20)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.030292951653273, 'psi': 0.13582554517133957}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.6290604737678076, 'psi': 0.13582554517133957}
[S15] START round=23 head_norm_before_train=2.010844 (no previous merge yet)
[S15] round=23 local utility u=0.142516 metrics={'f1_val': 0.6105389725618956, 'auprc': 0.6105389725618956, 'loss_val': 0.5901415445713138, 'psi': 0.6105389725618956}-{'f1_val': 0.5884055561029516, 'auprc': 0.5884055561029516, 'loss_val': 0.6759720252032348, 'psi': 0.5884055561029516}
[S16] START round=23 head_norm_before_train=1.747101 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.03480094911679409, 'auprc': 0.03480094911679409, 'loss_val': 4.487324486357995, 'psi': 0.03480094911679409}-{'f1_val': 0.11945962355798422, 'auprc': 0.11945962355798422, 'loss_val': 3.626537333148326, 'psi': 0.11945962355798422}
[S17] START round=23 head_norm_before_train=1.898378 (no previous merge yet)
[S17] round=23 local utility u=0.138496 metrics={'f1_val': 0.32870526006464884, 'auprc': 0.32870526006464884, 'loss_val': 1.075680388325601, 'psi': 0.32870526006464884}-{'f1_val': 0.30436108279101676, 'auprc': 0.30436108279101676, 'loss_val': 1.1335751059502759, 'psi': 0.30436108279101676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38416
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:38411
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:38408
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S11
[S10] cosine check vs S11: cos=0.8948
[S7] RECEIVED delta(kind=head bytes=1798) from S15
[S7] cosine check vs S15: cos=0.9968
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=0.7650
[S16] RECEIVED delta(kind=head bytes=1796) from S8
[S16] cosine check vs S8: cos=-0.0102
[S16] DROPPED delta from S8 (cos=-0.0102 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=0.9525
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.3598 head_norm=1.957958
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.962833e-02
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.3598 head_norm=1.996930 delta_norm=0.089628
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.0360 head_norm=1.470958
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.488037e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.0386 head_norm=1.480342 delta_norm=0.548804
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.1358 head_norm=1.863209
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.930698e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.1358 head_norm=1.870257 delta_norm=0.293070
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.3316 head_norm=1.842318
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.121294e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.3297 head_norm=1.723724 delta_norm=0.412129
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.954604 (no previous merge yet)
[S2] round=24 local utility u=0.526018 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.332134917260668, 'psi': 0.3674775928297055}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 3.282141870123871, 'psi': 0.2450298816928894}
[S3] START round=24 head_norm_before_train=1.679725 cos_to_last_merge=0.9695 (last merge round=18)
[S3] round=24 local utility u=0.021062 metrics={'f1_val': 0.27760513776672885, 'auprc': 0.27760513776672885, 'loss_val': 1.7672106023618845, 'psi': 0.27760513776672885}-{'f1_val': 0.2616725191832488, 'auprc': 0.2616725191832488, 'loss_val': 1.6659418718623489, 'psi': 0.2616725191832488}
[S4] START round=24 head_norm_before_train=1.967823 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2714815767599392, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.251639342603545, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=1.983253 cos_to_last_merge=0.9974 (last merge round=20)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.052668732033883, 'psi': 0.3335071121394324}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.9584316775230974, 'psi': 0.33400978131092857}
[S6] START round=24 head_norm_before_train=1.480342 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.222334 metrics={'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 4.0208710172256685, 'psi': 0.025658492279745686}-{'f1_val': 0.03598400710795202, 'auprc': 0.03598400710795202, 'loss_val': 4.5584677688599395, 'psi': 0.03598400710795202}
[S7] START round=24 head_norm_before_train=1.996930 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000253 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.39309528276575, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3936010909674579, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=2.077184 cos_to_last_merge=0.9905 (last merge round=19)
[S8] round=24 local utility u=0.007370 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4029598328218232, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.41769941310283865, 'psi': 0.9988708350860451}
[S9] START round=24 head_norm_before_train=1.745083 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.387690635709808, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.355507718263098, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.723724 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.119574 metrics={'f1_val': 0.3173952641165756, 'auprc': 0.3173952641165756, 'loss_val': 1.3717246238596275, 'psi': 0.3173952641165756}-{'f1_val': 0.33158813263525305, 'auprc': 0.33158813263525305, 'loss_val': 1.7386083850112997, 'psi': 0.33158813263525305}
[S11] START round=24 head_norm_before_train=1.699416 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.405327717565675, 'psi': 0.2803432239470754}-{'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.3464248561184338, 'psi': 0.28041912246234446}
[S13] START round=24 head_norm_before_train=1.759360 (no previous merge yet)
[S13] round=24 local utility u=1.000000 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.15497665995143828, 'psi': 1.0}-{'f1_val': 0.6663741355251734, 'auprc': 0.6663741355251734, 'loss_val': 0.1707460912275532, 'psi': 0.6663741355251734}
[S14] START round=24 head_norm_before_train=1.870257 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.291212 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.44832632309352, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.030292951653273, 'psi': 0.13582554517133957}
[S15] START round=24 head_norm_before_train=2.039100 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.5882376850921561, 'auprc': 0.5882376850921561, 'loss_val': 0.694475146081128, 'psi': 0.5882376850921561}-{'f1_val': 0.6105389725618956, 'auprc': 0.6105389725618956, 'loss_val': 0.5901415445713138, 'psi': 0.6105389725618956}
[S16] START round=24 head_norm_before_train=1.764200 (no previous merge yet)
[S16] round=24 local utility u=0.586636 metrics={'f1_val': 0.08878148053930297, 'auprc': 0.08878148053930297, 'loss_val': 3.7998773485565613, 'psi': 0.08878148053930297}-{'f1_val': 0.03480094911679409, 'auprc': 0.03480094911679409, 'loss_val': 4.487324486357995, 'psi': 0.03480094911679409}
[S17] START round=24 head_norm_before_train=1.922487 (no previous merge yet)
[S17] round=24 local utility u=0.098395 metrics={'f1_val': 0.35524324661055884, 'auprc': 0.35524324661055884, 'loss_val': 1.1177315832604533, 'psi': 0.35524324661055884}-{'f1_val': 0.32870526006464884, 'auprc': 0.32870526006464884, 'loss_val': 1.075680388325601, 'psi': 0.32870526006464884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:38409
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:38407
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.026)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38405
[S16] not sending this round → trigger blocked (psi=0.089)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:38416
[S2] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=-0.0601
[S7] DROPPED delta from S10 (cos=-0.0601 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=-0.0216
[S8] DROPPED delta from S7 (cos=-0.0216 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1806) from S3
[S6] cosine check vs S3: cos=0.9050
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=0.9913
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] cosine check vs S13: cos=-0.0665
[S16] DROPPED delta from S13 (cos=-0.0665 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=-0.0090
[S16] DROPPED delta from S8 (cos=-0.0090 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] cosine check vs S17: cos=0.9812
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.0257 head_norm=1.562087
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.621627e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.0257 head_norm=1.592699 delta_norm=0.362163
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.3335 head_norm=2.001397
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.321450e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.3335 head_norm=1.977939 delta_norm=0.132145
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.1359 head_norm=1.899315
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.879909e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.1359 head_norm=1.913933 delta_norm=0.187991
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.963116 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 3.31334066297358, 'psi': 0.24507471790179935}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.332134917260668, 'psi': 0.3674775928297055}
[S3] START round=25 head_norm_before_train=1.701643 cos_to_last_merge=0.9655 (last merge round=18)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.28017301520859494, 'auprc': 0.28017301520859494, 'loss_val': 1.8577167985755192, 'psi': 0.28017301520859494}-{'f1_val': 0.27760513776672885, 'auprc': 0.27760513776672885, 'loss_val': 1.7672106023618845, 'psi': 0.27760513776672885}
[S4] START round=25 head_norm_before_train=1.984970 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2946544765054322, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2714815767599392, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=1.977939 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.074413 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9038435779235836, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.052668732033883, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.592699 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.026088929219600727, 'auprc': 0.026088929219600727, 'loss_val': 4.029967326601891, 'psi': 0.026088929219600723}-{'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 4.0208710172256685, 'psi': 0.025658492279745686}
[S7] START round=25 head_norm_before_train=2.008430 cos_to_last_merge=0.9999 (last merge round=23)
[S7] round=25 local utility u=0.007362 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3783718048009879, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.39309528276575, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=2.099379 cos_to_last_merge=0.9891 (last merge round=19)
[S8] round=25 local utility u=0.008091 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3867772224217385, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4029598328218232, 'psi': 0.9988708350860451}
[S9] START round=25 head_norm_before_train=1.756085 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.421657932086764, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.387690635709808, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.780628 cos_to_last_merge=0.9986 (last merge round=23)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.30929664965609055, 'auprc': 0.30929664965609055, 'loss_val': 1.4065010005037846, 'psi': 0.30929664965609055}-{'f1_val': 0.3173952641165756, 'auprc': 0.3173952641165756, 'loss_val': 1.3717246238596275, 'psi': 0.3173952641165756}
[S11] START round=25 head_norm_before_train=1.710766 (no previous merge yet)
[S11] round=25 local utility u=0.024253 metrics={'f1_val': 0.28030898140874577, 'auprc': 0.28030898140874577, 'loss_val': 2.3565131097698244, 'psi': 0.28030898140874577}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.405327717565675, 'psi': 0.2803432239470754}
[S13] START round=25 head_norm_before_train=1.770043 (no previous merge yet)
[S13] round=25 local utility u=0.001570 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.15183670451587755, 'psi': 1.0}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.15497665995143828, 'psi': 1.0}
[S14] START round=25 head_norm_before_train=1.913933 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.11141552511415526, 'auprc': 0.11141552511415526, 'loss_val': 3.3763362469393607, 'psi': 0.11141552511415526}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.44832632309352, 'psi': 0.13587634006482174}
[S15] START round=25 head_norm_before_train=2.067260 (no previous merge yet)
[S15] round=25 local utility u=0.117741 metrics={'f1_val': 0.6053039764641669, 'auprc': 0.6053039764641669, 'loss_val': 0.6125892515675823, 'psi': 0.6053039764641669}-{'f1_val': 0.5882376850921561, 'auprc': 0.5882376850921561, 'loss_val': 0.694475146081128, 'psi': 0.5882376850921561}
[S16] START round=25 head_norm_before_train=1.780280 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.08816964285714286, 'auprc': 0.08816964285714286, 'loss_val': 3.8705488257599185, 'psi': 0.08816964285714286}-{'f1_val': 0.08878148053930297, 'auprc': 0.08878148053930297, 'loss_val': 3.7998773485565613, 'psi': 0.08878148053930297}
[S17] START round=25 head_norm_before_train=1.946679 (no previous merge yet)
[S17] round=25 local utility u=1.000000 metrics={'f1_val': 0.5810721251505584, 'auprc': 0.5810721251505584, 'loss_val': 0.9510285113556362, 'psi': 0.5810721251505584}-{'f1_val': 0.35524324661055884, 'auprc': 0.35524324661055884, 'loss_val': 1.1177315832604533, 'psi': 0.35524324661055884}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:38411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:38403
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38416
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] cosine check vs S15: cos=0.9975
[S8] RECEIVED delta(kind=head bytes=1795) from S7
[S8] cosine check vs S7: cos=-0.0219
[S8] DROPPED delta from S7 (cos=-0.0219 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] cosine check vs S5: cos=0.9318
[S16] RECEIVED delta(kind=head bytes=1796) from S8
[S16] cosine check vs S8: cos=-0.0076
[S16] DROPPED delta from S8 (cos=-0.0076 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] cosine check vs S13: cos=-0.0660
[S16] DROPPED delta from S13 (cos=-0.0660 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S11
[S10] cosine check vs S11: cos=0.9435
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=0.9901
[S9] ⇄ pheromone p=0.046 → S3@127.0.0.1:38403
[S6] ⇄ pheromone p=0.140 → S7@127.0.0.1:38408
[S4] ⇄ pheromone p=0.020 → S8@127.0.0.1:38409
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.1114 head_norm=1.941458
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.379706e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.1166 head_norm=1.950016 delta_norm=0.137971
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.106 → S13@127.0.0.1:38413
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.2802 head_norm=1.722804
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.681373e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.2732 head_norm=1.826752 delta_norm=0.368137
[S3] aggregate: ROLLBACK (f1_val pre=0.280 post=0.273 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.103 → S6@127.0.0.1:38407
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.3093 head_norm=1.841547
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.052352e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.3087 head_norm=1.757064 delta_norm=0.305235
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.067 → S7@127.0.0.1:38408
[S2] ⇄ pheromone p=0.158 → S5@127.0.0.1:38405
[S15] ⇄ pheromone p=0.094 → S7@127.0.0.1:38408
[S5] ⇄ pheromone p=0.062 → S3@127.0.0.1:38403
[S13] ⇄ pheromone p=0.234 → S16@127.0.0.1:38416
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.3598 head_norm=2.021230
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.133677e-02
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.3598 head_norm=2.056108 delta_norm=0.081337
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.141 → S8@127.0.0.1:38409
[S8] ⇄ pheromone p=0.103 → S16@127.0.0.1:38416
[S11] ⇄ pheromone p=0.041 → S10@127.0.0.1:38411
[S16] ⇄ pheromone p=0.144 → S4@127.0.0.1:38404
[S17] ⇄ pheromone p=0.304 → S14@127.0.0.1:38414
[S2] START round=26 head_norm_before_train=1.971785 (no previous merge yet)
[S2] round=26 local utility u=0.521024 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.372919402332806, 'psi': 0.3674775928297055}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 3.31334066297358, 'psi': 0.24507471790179935}
[S3] START round=26 head_norm_before_train=1.826752 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.020931 metrics={'f1_val': 0.28111437771244574, 'auprc': 0.28111437771244574, 'loss_val': 1.8243276744076864, 'psi': 0.28111437771244574}-{'f1_val': 0.28017301520859494, 'auprc': 0.28017301520859494, 'loss_val': 1.8577167985755192, 'psi': 0.28017301520859494}
[S4] START round=26 head_norm_before_train=1.994489 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.325107806939327, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2946544765054322, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=1.994252 cos_to_last_merge=0.9999 (last merge round=24)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9847233158274191, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9038435779235836, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.675111 cos_to_last_merge=0.9918 (last merge round=24)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.04108084358523726, 'auprc': 0.04108084358523726, 'loss_val': 4.7475331624608845, 'psi': 0.04108084358523726}-{'f1_val': 0.026088929219600727, 'auprc': 0.026088929219600727, 'loss_val': 4.029967326601891, 'psi': 0.026088929219600723}
[S7] START round=26 head_norm_before_train=2.056108 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.012395 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3535812874654813, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3783718048009879, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=2.116084 cos_to_last_merge=0.9879 (last merge round=19)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4142722565196297, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3867772224217385, 'psi': 0.9988708350860451}
[S9] START round=26 head_norm_before_train=1.766571 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4534542870003047, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.421657932086764, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.757064 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.069823 metrics={'f1_val': 0.31012235817575085, 'auprc': 0.31012235817575085, 'loss_val': 1.2742864195628723, 'psi': 0.31012235817575085}-{'f1_val': 0.30929664965609055, 'auprc': 0.30929664965609055, 'loss_val': 1.4065010005037846, 'psi': 0.30929664965609055}
[S11] START round=26 head_norm_before_train=1.723249 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.28045344341786255, 'auprc': 0.28045344341786255, 'loss_val': 2.5252014814923696, 'psi': 0.28045344341786255}-{'f1_val': 0.28030898140874577, 'auprc': 0.28030898140874577, 'loss_val': 2.3565131097698244, 'psi': 0.28030898140874577}
[S13] START round=26 head_norm_before_train=1.780481 (no previous merge yet)
[S13] round=26 local utility u=0.003158 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.14551973181226788, 'psi': 1.0}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.15183670451587755, 'psi': 1.0}
[S14] START round=26 head_norm_before_train=1.950016 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.105014 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.385126390132696, 'psi': 0.13572854291417166}-{'f1_val': 0.11141552511415526, 'auprc': 0.11141552511415526, 'loss_val': 3.3763362469393607, 'psi': 0.11141552511415526}
[S15] START round=26 head_norm_before_train=2.093566 (no previous merge yet)
[S15] round=26 local utility u=0.024544 metrics={'f1_val': 0.6085197413020601, 'auprc': 0.6085197413020601, 'loss_val': 0.5924422464906837, 'psi': 0.6085197413020601}-{'f1_val': 0.6053039764641669, 'auprc': 0.6053039764641669, 'loss_val': 0.6125892515675823, 'psi': 0.6053039764641669}
[S16] START round=26 head_norm_before_train=1.795265 (no previous merge yet)
[S16] round=26 local utility u=0.107499 metrics={'f1_val': 0.11184755592377796, 'auprc': 0.11184755592377796, 'loss_val': 3.8686521709077772, 'psi': 0.11184755592377796}-{'f1_val': 0.08816964285714286, 'auprc': 0.08816964285714286, 'loss_val': 3.8705488257599185, 'psi': 0.08816964285714286}
[S17] START round=26 head_norm_before_train=1.968231 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.4243701020312128, 'auprc': 0.4243701020312128, 'loss_val': 1.1534128894949207, 'psi': 0.4243701020312128}-{'f1_val': 0.5810721251505584, 'auprc': 0.5810721251505584, 'loss_val': 0.9510285113556362, 'psi': 0.5810721251505584}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.112)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:38416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38405
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:38409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:38407
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] cosine check vs S13: cos=-0.0659
[S16] DROPPED delta from S13 (cos=-0.0659 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] cosine check vs S15: cos=0.9988
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=-0.0564
[S7] DROPPED delta from S10 (cos=-0.0564 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.9957
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=-0.0222
[S8] DROPPED delta from S7 (cos=-0.0222 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=0.9104
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.0411 head_norm=1.754506
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.826504e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.0700 head_norm=1.756545 delta_norm=0.382650
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.3335 head_norm=2.011376
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.413403e-02
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.3335 head_norm=1.993798 delta_norm=0.094134
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.3598 head_norm=2.070440
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.663914e-02
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.3598 head_norm=2.092508 delta_norm=0.056639
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.980542 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 3.3492558149091867, 'psi': 0.245119570522206}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.372919402332806, 'psi': 0.3674775928297055}
[S3] START round=27 head_norm_before_train=1.839960 cos_to_last_merge=0.9999 (last merge round=25)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.28007807054231143, 'auprc': 0.28007807054231143, 'loss_val': 1.8520235119144601, 'psi': 0.28007807054231143}-{'f1_val': 0.28111437771244574, 'auprc': 0.28111437771244574, 'loss_val': 1.8243276744076864, 'psi': 0.28111437771244574}
[S4] START round=27 head_norm_before_train=2.004879 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3321606365124286, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.325107806939327, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=1.993798 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.052384 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8799558080250636, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9847233158274191, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.756545 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.178343 metrics={'f1_val': 0.025873808443032227, 'auprc': 0.025873808443032227, 'loss_val': 4.25398349403654, 'psi': 0.025873808443032227}-{'f1_val': 0.04108084358523726, 'auprc': 0.04108084358523726, 'loss_val': 4.7475331624608845, 'psi': 0.04108084358523726}
[S7] START round=27 head_norm_before_train=2.092508 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.005741 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3420997665008012, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3535812874654813, 'psi': 0.35976373724718097}
[S8] START round=27 head_norm_before_train=2.132542 cos_to_last_merge=0.9865 (last merge round=19)
[S8] round=27 local utility u=0.003275 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.40772178666582687, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.4142722565196297, 'psi': 0.9988708350860451}
[S9] START round=27 head_norm_before_train=1.776138 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4782460956181773, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4534542870003047, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.817647 cos_to_last_merge=0.9983 (last merge round=25)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.3143093465674111, 'auprc': 0.3143093465674111, 'loss_val': 1.4421022967379358, 'psi': 0.3143093465674111}-{'f1_val': 0.31012235817575085, 'auprc': 0.31012235817575085, 'loss_val': 1.2742864195628723, 'psi': 0.31012235817575085}
[S11] START round=27 head_norm_before_train=1.736737 (no previous merge yet)
[S11] round=27 local utility u=0.063029 metrics={'f1_val': 0.2801989268420364, 'auprc': 0.2801989268420364, 'loss_val': 2.3968536724640983, 'psi': 0.2801989268420364}-{'f1_val': 0.28045344341786255, 'auprc': 0.28045344341786255, 'loss_val': 2.5252014814923696, 'psi': 0.28045344341786255}
[S13] START round=27 head_norm_before_train=1.788103 (no previous merge yet)
[S13] round=27 local utility u=0.001156 metrics={'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.1406808173688407, 'psi': 0.9997191418023301}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.14551973181226788, 'psi': 1.0}
[S14] START round=27 head_norm_before_train=1.978005 cos_to_last_merge=0.9988 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.8056052546215366, 'psi': 0.13587634006482174}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 3.385126390132696, 'psi': 0.13572854291417166}
[S15] START round=27 head_norm_before_train=2.115864 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6053039764641669, 'auprc': 0.6053039764641669, 'loss_val': 0.6044917603709132, 'psi': 0.6053039764641669}-{'f1_val': 0.6085197413020601, 'auprc': 0.6085197413020601, 'loss_val': 0.5924422464906837, 'psi': 0.6085197413020601}
[S16] START round=27 head_norm_before_train=1.808360 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.009147457006952067, 'auprc': 0.009147457006952067, 'loss_val': 5.181589941242283, 'psi': 0.009147457006952067}-{'f1_val': 0.11184755592377796, 'auprc': 0.11184755592377796, 'loss_val': 3.8686521709077772, 'psi': 0.11184755592377796}
[S17] START round=27 head_norm_before_train=1.984464 (no previous merge yet)
[S17] round=27 local utility u=0.737680 metrics={'f1_val': 0.5803436048663427, 'auprc': 0.5803436048663427, 'loss_val': 1.0818137838473347, 'psi': 0.5803436048663427}-{'f1_val': 0.4243701020312128, 'auprc': 0.4243701020312128, 'loss_val': 1.1534128894949207, 'psi': 0.4243701020312128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:38402
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.026)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S8
[S7] cosine check vs S8: cos=-0.0242
[S7] DROPPED delta from S8 (cos=-0.0242 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S7
[S6] cosine check vs S7: cos=0.0032
[S2] RECEIVED delta(kind=head bytes=1795) from S5
[S2] cosine check vs S5: cos=0.9982
[S14] RECEIVED delta(kind=head bytes=1801) from S13
[S14] cosine check vs S13: cos=-0.0352
[S14] DROPPED delta from S13 (cos=-0.0352 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.0259 head_norm=1.814389
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.386801e+00
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.0259 head_norm=1.391162 delta_norm=1.386801
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.2451 head_norm=1.988372
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.102411e-02
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.2451 head_norm=1.998555 delta_norm=0.061024
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.998555 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.035513 metrics={'f1_val': 0.2430735131141485, 'auprc': 0.2430735131141485, 'loss_val': 3.2598150320499704, 'psi': 0.2430735131141485}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 3.3492558149091867, 'psi': 0.245119570522206}
[S3] START round=28 head_norm_before_train=1.852844 cos_to_last_merge=0.9996 (last merge round=25)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.26280041797283177, 'auprc': 0.26280041797283177, 'loss_val': 1.955435824585507, 'psi': 0.26280041797283177}-{'f1_val': 0.28007807054231143, 'auprc': 0.28007807054231143, 'loss_val': 1.8520235119144601, 'psi': 0.28007807054231143}
[S4] START round=28 head_norm_before_train=2.011934 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.350549003697184, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3321606365124286, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=2.010540 cos_to_last_merge=0.9999 (last merge round=26)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9336529106345886, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8799558080250636, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.391162 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.195064 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 3.858036919879844, 'psi': 0.025227272727272727}-{'f1_val': 0.025873808443032227, 'auprc': 0.025873808443032227, 'loss_val': 4.25398349403654, 'psi': 0.025873808443032227}
[S7] START round=28 head_norm_before_train=2.103590 cos_to_last_merge=0.9999 (last merge round=26)
[S7] round=28 local utility u=0.005616 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3308684224739282, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3420997665008012, 'psi': 0.35976373724718097}
[S8] START round=28 head_norm_before_train=2.151176 cos_to_last_merge=0.9851 (last merge round=19)
[S8] round=28 local utility u=0.005779 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.39616408681964144, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.40772178666582687, 'psi': 0.9988708350860451}
[S9] START round=28 head_norm_before_train=1.785085 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.500246221999346, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4782460956181773, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.880610 cos_to_last_merge=0.9943 (last merge round=25)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.3008200258955546, 'auprc': 0.3008200258955546, 'loss_val': 1.3684775619067842, 'psi': 0.3008200258955546}-{'f1_val': 0.3143093465674111, 'auprc': 0.3143093465674111, 'loss_val': 1.4421022967379358, 'psi': 0.3143093465674111}
[S11] START round=28 head_norm_before_train=1.749374 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.573013095239874, 'psi': 0.280398322851153}-{'f1_val': 0.2801989268420364, 'auprc': 0.2801989268420364, 'loss_val': 2.3968536724640983, 'psi': 0.2801989268420364}
[S13] START round=28 head_norm_before_train=1.797713 (no previous merge yet)
[S13] round=28 local utility u=0.002831 metrics={'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.13754695696197514, 'psi': 1.0}-{'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.1406808173688407, 'psi': 0.9997191418023301}
[S14] START round=28 head_norm_before_train=2.008086 cos_to_last_merge=0.9959 (last merge round=25)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.129774947077258, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.8056052546215366, 'psi': 0.13587634006482174}
[S15] START round=28 head_norm_before_train=2.137283 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.604417752405675, 'auprc': 0.604417752405675, 'loss_val': 0.612616133447985, 'psi': 0.604417752405675}-{'f1_val': 0.6053039764641669, 'auprc': 0.6053039764641669, 'loss_val': 0.6044917603709132, 'psi': 0.6053039764641669}
[S16] START round=28 head_norm_before_train=1.815340 (no previous merge yet)
[S16] round=28 local utility u=1.000000 metrics={'f1_val': 0.15459965928449745, 'auprc': 0.15459965928449745, 'loss_val': 3.652965526544328, 'psi': 0.15459965928449745}-{'f1_val': 0.009147457006952067, 'auprc': 0.009147457006952067, 'loss_val': 5.181589941242283, 'psi': 0.009147457006952067}
[S17] START round=28 head_norm_before_train=2.008449 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5110804896965511, 'auprc': 0.5110804896965511, 'loss_val': 1.2443010313173661, 'psi': 0.5110804896965511}-{'f1_val': 0.5803436048663427, 'auprc': 0.5803436048663427, 'loss_val': 1.0818137838473347, 'psi': 0.5803436048663427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:38414
[S6] not sending this round → trigger blocked (psi=0.025)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:38408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:38407
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.155)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S13
[S14] cosine check vs S13: cos=-0.0357
[S14] DROPPED delta from S13 (cos=-0.0357 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S8
[S7] cosine check vs S8: cos=-0.0255
[S7] DROPPED delta from S8 (cos=-0.0255 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] cosine check vs S7: cos=0.7193
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.0252 head_norm=1.474756
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.346022e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.0252 head_norm=1.668021 delta_norm=0.734602
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=2.005623 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=29 local utility u=0.496504 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.386443270606674, 'psi': 0.3674775928297055}-{'f1_val': 0.2430735131141485, 'auprc': 0.2430735131141485, 'loss_val': 3.2598150320499704, 'psi': 0.2430735131141485}
[S3] START round=29 head_norm_before_train=1.867442 cos_to_last_merge=0.9991 (last merge round=25)
[S3] round=29 local utility u=0.019869 metrics={'f1_val': 0.2658211124322896, 'auprc': 0.2658211124322896, 'loss_val': 1.9428831155171862, 'psi': 0.2658211124322896}-{'f1_val': 0.26280041797283177, 'auprc': 0.26280041797283177, 'loss_val': 1.955435824585507, 'psi': 0.26280041797283177}
[S4] START round=29 head_norm_before_train=2.030930 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3762541597018316, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.350549003697184, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=2.029042 cos_to_last_merge=0.9996 (last merge round=26)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9525904422229845, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9336529106345886, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.668021 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.026303854875283448, 'auprc': 0.026303854875283448, 'loss_val': 3.889361523837794, 'psi': 0.026303854875283448}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 3.858036919879844, 'psi': 0.025227272727272727}
[S7] START round=29 head_norm_before_train=2.113992 cos_to_last_merge=0.9998 (last merge round=26)
[S7] round=29 local utility u=0.004607 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3216541820966328, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3308684224739282, 'psi': 0.35976373724718097}
[S8] START round=29 head_norm_before_train=2.165184 cos_to_last_merge=0.9839 (last merge round=19)
[S8] round=29 local utility u=0.010692 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3747793628255189, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.39616408681964144, 'psi': 0.9988708350860451}
[S9] START round=29 head_norm_before_train=1.793453 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5177820232466925, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.500246221999346, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.930500 cos_to_last_merge=0.9905 (last merge round=25)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.2969116080937167, 'auprc': 0.2969116080937167, 'loss_val': 1.3799854267213978, 'psi': 0.2969116080937167}-{'f1_val': 0.3008200258955546, 'auprc': 0.3008200258955546, 'loss_val': 1.3684775619067842, 'psi': 0.3008200258955546}
[S11] START round=29 head_norm_before_train=1.761608 (no previous merge yet)
[S11] round=29 local utility u=0.019460 metrics={'f1_val': 0.2802881466928618, 'auprc': 0.2802881466928618, 'loss_val': 2.5331008272452045, 'psi': 0.2802881466928618}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.573013095239874, 'psi': 0.280398322851153}
[S13] START round=29 head_norm_before_train=1.810220 (no previous merge yet)
[S13] round=29 local utility u=0.002330 metrics={'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.13035888709605636, 'psi': 0.9997191418023301}-{'f1_val': 1.0, 'auprc': 1.0, 'loss_val': 0.13754695696197514, 'psi': 1.0}
[S14] START round=29 head_norm_before_train=2.035402 cos_to_last_merge=0.9926 (last merge round=25)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.374669891693903, 'psi': 0.13572854291417166}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.129774947077258, 'psi': 0.13587634006482174}
[S15] START round=29 head_norm_before_train=2.157260 (no previous merge yet)
[S15] round=29 local utility u=0.051984 metrics={'f1_val': 0.6135290307062625, 'auprc': 0.6135290307062625, 'loss_val': 0.5906490115712103, 'psi': 0.6135290307062625}-{'f1_val': 0.604417752405675, 'auprc': 0.604417752405675, 'loss_val': 0.612616133447985, 'psi': 0.604417752405675}
[S16] START round=29 head_norm_before_train=1.822764 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.11162432640492687, 'auprc': 0.11162432640492687, 'loss_val': 4.367266909471521, 'psi': 0.11162432640492687}-{'f1_val': 0.15459965928449745, 'auprc': 0.15459965928449745, 'loss_val': 3.652965526544328, 'psi': 0.15459965928449745}
[S17] START round=29 head_norm_before_train=2.027067 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.3822142622171863, 'auprc': 0.3822142622171863, 'loss_val': 1.4973759152851411, 'psi': 0.3822142622171863}-{'f1_val': 0.5110804896965511, 'auprc': 0.5110804896965511, 'loss_val': 1.2443010313173661, 'psi': 0.5110804896965511}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:38405
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:38408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=-0.0259
[S7] DROPPED delta from S8 (cos=-0.0259 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.9150
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=-0.0366
[S14] DROPPED delta from S13 (cos=-0.0366 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S3
[S5] cosine check vs S3: cos=0.9759
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.0263 head_norm=1.750633
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.391760e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.0312 head_norm=1.895997 delta_norm=0.439176
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.3335 head_norm=2.045225
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.301416e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.3335 head_norm=1.951869 delta_norm=0.230142
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.012640 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 3.346022168121706, 'psi': 0.24516443956312162}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.386443270606674, 'psi': 0.3674775928297055}
[S3] START round=30 head_norm_before_train=1.882172 cos_to_last_merge=0.9985 (last merge round=25)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2636268343815514, 'auprc': 0.2636268343815514, 'loss_val': 2.0070118744390792, 'psi': 0.2636268343815514}-{'f1_val': 0.2658211124322896, 'auprc': 0.2658211124322896, 'loss_val': 1.9428831155171862, 'psi': 0.2658211124322896}
[S4] START round=30 head_norm_before_train=2.049086 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3906212301430714, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3762541597018316, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.951869 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.069048 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8144949459546593, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9525904422229845, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.895997 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.254836 metrics={'f1_val': 0.10133587786259542, 'auprc': 0.10133587786259542, 'loss_val': 4.054977022201785, 'psi': 0.10133587786259542}-{'f1_val': 0.026303854875283448, 'auprc': 0.026303854875283448, 'loss_val': 3.889361523837794, 'psi': 0.026303854875283448}
[S7] START round=30 head_norm_before_train=2.123827 cos_to_last_merge=0.9995 (last merge round=26)
[S7] round=30 local utility u=0.006141 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3093722366949163, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3216541820966328, 'psi': 0.35976373724718097}
[S8] START round=30 head_norm_before_train=2.176569 cos_to_last_merge=0.9830 (last merge round=19)
[S8] round=30 local utility u=0.004834 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3651120977821492, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3747793628255189, 'psi': 0.9988708350860451}
[S9] START round=30 head_norm_before_train=1.801371 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5353930197244816, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5177820232466925, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.968076 cos_to_last_merge=0.9875 (last merge round=25)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.2969116080937167, 'auprc': 0.2969116080937167, 'loss_val': 1.4164778982300856, 'psi': 0.2969116080937167}-{'f1_val': 0.2969116080937167, 'auprc': 0.2969116080937167, 'loss_val': 1.3799854267213978, 'psi': 0.2969116080937167}
[S11] START round=30 head_norm_before_train=1.772009 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.5587964301005686, 'psi': 0.28036404111831337}-{'f1_val': 0.2802881466928618, 'auprc': 0.2802881466928618, 'loss_val': 2.5331008272452045, 'psi': 0.2802881466928618}
[S13] START round=30 head_norm_before_train=1.824585 (no previous merge yet)
[S13] round=30 local utility u=0.003949 metrics={'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.12246018608620464, 'psi': 0.9997191418023301}-{'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.13035888709605636, 'psi': 0.9997191418023301}
[S14] START round=30 head_norm_before_train=2.058254 cos_to_last_merge=0.9897 (last merge round=25)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 4.555213534349696, 'psi': 0.13393415946927026}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.374669891693903, 'psi': 0.13572854291417166}
[S15] START round=30 head_norm_before_train=2.176802 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6080843194751313, 'auprc': 0.6080843194751313, 'loss_val': 0.5979161068792707, 'psi': 0.6080843194751313}-{'f1_val': 0.6135290307062625, 'auprc': 0.6135290307062625, 'loss_val': 0.5906490115712103, 'psi': 0.6135290307062625}
[S16] START round=30 head_norm_before_train=1.831693 (no previous merge yet)
[S16] round=30 local utility u=0.417019 metrics={'f1_val': 0.14357189471394388, 'auprc': 0.14357189471394388, 'loss_val': 3.820757769882556, 'psi': 0.14357189471394388}-{'f1_val': 0.11162432640492687, 'auprc': 0.11162432640492687, 'loss_val': 4.367266909471521, 'psi': 0.11162432640492687}
[S17] START round=30 head_norm_before_train=2.039171 (no previous merge yet)
[S17] round=30 local utility u=0.769000 metrics={'f1_val': 0.5238415625754098, 'auprc': 0.5238415625754098, 'loss_val': 1.2340224626403615, 'psi': 0.5238415625754098}-{'f1_val': 0.3822142622171863, 'auprc': 0.3822142622171863, 'loss_val': 1.4973759152851411, 'psi': 0.3822142622171863}
[S3]  timeout peer S2
[S2]  timeout peer S3
[S6] not sending this round → trigger blocked (psi=0.101)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:38408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.144)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:38407
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:38402
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:38414
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=-0.0374
[S14] DROPPED delta from S13 (cos=-0.0374 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=-0.0267
[S7] DROPPED delta from S8 (cos=-0.0267 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.9580
[S2] RECEIVED delta(kind=head bytes=1798) from S5
[S2] cosine check vs S5: cos=0.9931
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.2452 head_norm=2.019458
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.201665e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.2452 head_norm=1.989611 delta_norm=0.120167
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.039 → S5@127.0.0.1:38405
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.1013 head_norm=1.969251
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.084251e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.1016 head_norm=2.030117 delta_norm=0.308425
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.140 → S3@127.0.0.1:38403
[S10] ⇄ pheromone p=0.028 → S11@127.0.0.1:38412
[S4] ⇄ pheromone p=0.006 → S16@127.0.0.1:38416
[S14] ⇄ pheromone p=0.043 → S17@127.0.0.1:38417
[S8] ⇄ pheromone p=0.038 → S7@127.0.0.1:38408
[S7] ⇄ pheromone p=0.050 → S6@127.0.0.1:38407
[S13] ⇄ pheromone p=0.079 → S14@127.0.0.1:38414
[S5] ⇄ pheromone p=0.039 → S2@127.0.0.1:38402
[S17] ⇄ pheromone p=0.329 → S14@127.0.0.1:38414
[S16] ⇄ pheromone p=0.267 → S13@127.0.0.1:38413
[S2] START round=31 head_norm_before_train=1.989611 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.036354 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 3.27331355738784, 'psi': 0.24516443956312162}-{'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 3.346022168121706, 'psi': 0.24516443956312162}
[S3] START round=31 head_norm_before_train=1.895857 cos_to_last_merge=0.9977 (last merge round=25)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2621327600807765, 'auprc': 0.2621327600807765, 'loss_val': 2.043125380287548, 'psi': 0.2621327600807765}-{'f1_val': 0.2636268343815514, 'auprc': 0.2636268343815514, 'loss_val': 2.0070118744390792, 'psi': 0.2636268343815514}
[S4] START round=31 head_norm_before_train=2.066534 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3976718991064236, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3906212301430714, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=1.966665 cos_to_last_merge=0.9999 (last merge round=29)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9976437056381857, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8144949459546593, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=2.030117 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.09326323987538941, 'auprc': 0.09326323987538941, 'loss_val': 4.44193987499266, 'psi': 0.09326323987538941}-{'f1_val': 0.10133587786259542, 'auprc': 0.10133587786259542, 'loss_val': 4.054977022201785, 'psi': 0.10133587786259542}
[S7] START round=31 head_norm_before_train=2.134258 cos_to_last_merge=0.9993 (last merge round=26)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.3155233160549773, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3093722366949163, 'psi': 0.35976373724718097}
[S8] START round=31 head_norm_before_train=2.188672 cos_to_last_merge=0.9822 (last merge round=19)
[S8] round=31 local utility u=0.004159 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3567939022086758, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3651120977821492, 'psi': 0.9988708350860451}
[S9] START round=31 head_norm_before_train=1.809217 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.552745816852284, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5353930197244816, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.997326 cos_to_last_merge=0.9851 (last merge round=25)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.29065888240200166, 'auprc': 0.29065888240200166, 'loss_val': 1.377980966581827, 'psi': 0.29065888240200166}-{'f1_val': 0.2969116080937167, 'auprc': 0.2969116080937167, 'loss_val': 1.4164778982300856, 'psi': 0.2969116080937167}
[S11] START round=31 head_norm_before_train=1.782947 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.640295946012885, 'psi': 0.2803432239470754}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.5587964301005686, 'psi': 0.28036404111831337}
[S13] START round=31 head_norm_before_train=1.836794 (no previous merge yet)
[S13] round=31 local utility u=0.001599 metrics={'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.11926155916522546, 'psi': 0.9997191418023301}-{'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.12246018608620464, 'psi': 0.9997191418023301}
[S14] START round=31 head_norm_before_train=2.077055 cos_to_last_merge=0.9874 (last merge round=25)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 4.6857367717242075, 'psi': 0.1347331583552056}-{'f1_val': 0.13393415946927026, 'auprc': 0.13393415946927026, 'loss_val': 4.555213534349696, 'psi': 0.13393415946927026}
[S15] START round=31 head_norm_before_train=2.193610 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6045657329111364, 'auprc': 0.6045657329111364, 'loss_val': 0.6600832123447989, 'psi': 0.6045657329111364}-{'f1_val': 0.6080843194751313, 'auprc': 0.6080843194751313, 'loss_val': 0.5979161068792707, 'psi': 0.6080843194751313}
[S16] START round=31 head_norm_before_train=1.840463 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.13551333038739136, 'auprc': 0.13551333038739136, 'loss_val': 4.004936896904665, 'psi': 0.13551333038739136}-{'f1_val': 0.14357189471394388, 'auprc': 0.14357189471394388, 'loss_val': 3.820757769882556, 'psi': 0.14357189471394388}
[S17] START round=31 head_norm_before_train=2.049510 (no previous merge yet)
[S17] round=31 local utility u=0.034765 metrics={'f1_val': 0.5305250305250305, 'auprc': 0.5305250305250305, 'loss_val': 1.2246440618418484, 'psi': 0.5305250305250305}-{'f1_val': 0.5238415625754098, 'auprc': 0.5238415625754098, 'loss_val': 1.2340224626403615, 'psi': 0.5238415625754098}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:38405
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1796 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:38408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:38416
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=0.9979
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=-0.0654
[S16] DROPPED delta from S13 (cos=-0.0654 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=-0.0275
[S7] DROPPED delta from S8 (cos=-0.0275 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:38414
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=0.9688
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.1347 head_norm=2.092456
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.602127e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.1355 head_norm=2.064929 delta_norm=0.260213
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.3335 head_norm=1.979008
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.546669e-02
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.3335 head_norm=1.986888 delta_norm=0.065467
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.996884 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=32 local utility u=0.520570 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.3329925711721544, 'psi': 0.3674775928297055}-{'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 3.27331355738784, 'psi': 0.24516443956312162}
[S3] START round=32 head_norm_before_train=1.906813 cos_to_last_merge=0.9971 (last merge round=25)
[S3] round=32 local utility u=0.009330 metrics={'f1_val': 0.2645627876397107, 'auprc': 0.2645627876397107, 'loss_val': 2.046334725651997, 'psi': 0.2645627876397107}-{'f1_val': 0.2621327600807765, 'auprc': 0.2621327600807765, 'loss_val': 2.043125380287548, 'psi': 0.2621327600807765}
[S4] START round=32 head_norm_before_train=2.080262 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.409973477577141, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3976718991064236, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=1.986888 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.057454 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.882736595437077, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9976437056381857, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=2.088527 cos_to_last_merge=0.9963 (last merge round=30)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.026733121884911646, 'auprc': 0.026733121884911646, 'loss_val': 5.214903929805657, 'psi': 0.026733121884911643}-{'f1_val': 0.09326323987538941, 'auprc': 0.09326323987538941, 'loss_val': 4.44193987499266, 'psi': 0.09326323987538941}
[S7] START round=32 head_norm_before_train=2.145017 cos_to_last_merge=0.9990 (last merge round=26)
[S7] round=32 local utility u=0.543406 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3093784977809162, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.3155233160549773, 'psi': 0.23968964488212474}
[S8] START round=32 head_norm_before_train=2.200318 cos_to_last_merge=0.9814 (last merge round=19)
[S8] round=32 local utility u=0.006500 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3437944307630366, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3567939022086758, 'psi': 0.9988708350860451}
[S9] START round=32 head_norm_before_train=1.816705 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5717271557159718, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.552745816852284, 'psi': 0.36867172340800847}
[S10] START round=32 head_norm_before_train=2.022436 cos_to_last_merge=0.9832 (last merge round=25)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.2887323943661972, 'auprc': 0.2887323943661972, 'loss_val': 1.3895810303647742, 'psi': 0.2887323943661972}-{'f1_val': 0.29065888240200166, 'auprc': 0.29065888240200166, 'loss_val': 1.377980966581827, 'psi': 0.29065888240200166}
[S11] START round=32 head_norm_before_train=1.795675 (no previous merge yet)
[S11] round=32 local utility u=0.008530 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.6234223303366417, 'psi': 0.28036404111831337}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.640295946012885, 'psi': 0.2803432239470754}
[S13] START round=32 head_norm_before_train=1.849915 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.12007865325367051, 'psi': 0.9997191418023301}-{'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.11926155916522546, 'psi': 0.9997191418023301}
[S14] START round=32 head_norm_before_train=2.064929 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.366104 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.9642744885099206, 'psi': 0.13592717296421}-{'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 4.6857367717242075, 'psi': 0.1347331583552056}
[S15] START round=32 head_norm_before_train=2.209138 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.5954688329256111, 'auprc': 0.5954688329256111, 'loss_val': 0.6363928866582413, 'psi': 0.5954688329256111}-{'f1_val': 0.6045657329111364, 'auprc': 0.6045657329111364, 'loss_val': 0.6600832123447989, 'psi': 0.6045657329111364}
[S16] START round=32 head_norm_before_train=1.849728 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.10019973368841545, 'auprc': 0.10019973368841545, 'loss_val': 4.059228555693875, 'psi': 0.10019973368841545}-{'f1_val': 0.13551333038739136, 'auprc': 0.13551333038739136, 'loss_val': 4.004936896904665, 'psi': 0.13551333038739136}
[S17] START round=32 head_norm_before_train=2.070002 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5218633435033864, 'auprc': 0.5218633435033864, 'loss_val': 1.3148828144921654, 'psi': 0.5218633435033864}-{'f1_val': 0.5305250305250305, 'auprc': 0.5305250305250305, 'loss_val': 1.2246440618418484, 'psi': 0.5305250305250305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:38405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:38407
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:38411
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:38407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:38402
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=0.1299
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=0.9992
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=-0.0286
[S7] DROPPED delta from S8 (cos=-0.0286 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.9651
[S2] RECEIVED delta(kind=head bytes=1796) from S5
[S2] cosine check vs S5: cos=0.9992
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] cosine check vs S11: cos=0.9351
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.3675 head_norm=2.004615
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.033966e-02
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.3675 head_norm=1.999949 delta_norm=0.040340
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.0267 head_norm=2.137444
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.461754e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.0299 head_norm=1.705080 delta_norm=0.646175
[S6] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.2887 head_norm=2.044256
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.660192e-01
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.2869 head_norm=1.894802 delta_norm=0.366019
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.3335 head_norm=1.996088
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.033967e-02
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.3335 head_norm=1.999949 delta_norm=0.040340
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.999949 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.009640 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.313712745580997, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.3329925711721544, 'psi': 0.3674775928297055}
[S3] START round=33 head_norm_before_train=1.917190 cos_to_last_merge=0.9964 (last merge round=25)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.26157046281851276, 'auprc': 0.26157046281851276, 'loss_val': 2.124258188860578, 'psi': 0.26157046281851276}-{'f1_val': 0.2645627876397107, 'auprc': 0.2645627876397107, 'loss_val': 2.046334725651997, 'psi': 0.2645627876397107}
[S4] START round=33 head_norm_before_train=2.093128 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4218758891686158, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.409973477577141, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=1.999949 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.035209 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8123179040573154, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.882736595437077, 'psi': 0.3335071121394324}
[S6] START round=33 head_norm_before_train=1.705080 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.913262 metrics={'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 4.063907949758411, 'psi': 0.10179184140297369}-{'f1_val': 0.026733121884911646, 'auprc': 0.026733121884911646, 'loss_val': 5.214903929805657, 'psi': 0.026733121884911643}
[S7] START round=33 head_norm_before_train=2.155807 cos_to_last_merge=0.9985 (last merge round=26)
[S7] round=33 local utility u=0.014862 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.279654262502523, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3093784977809162, 'psi': 0.35976373724718097}
[S8] START round=33 head_norm_before_train=2.210683 cos_to_last_merge=0.9804 (last merge round=19)
[S8] round=33 local utility u=0.005504 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3327868314115759, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3437944307630366, 'psi': 0.9988708350860451}
[S9] START round=33 head_norm_before_train=1.823645 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5910712823918076, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5717271557159718, 'psi': 0.36867172340800847}
[S10] START round=33 head_norm_before_train=1.894802 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.091399 metrics={'f1_val': 0.2848967913345596, 'auprc': 0.2848967913345596, 'loss_val': 1.172262049227435, 'psi': 0.2848967913345596}-{'f1_val': 0.2887323943661972, 'auprc': 0.2887323943661972, 'loss_val': 1.3895810303647742, 'psi': 0.2887323943661972}
[S11] START round=33 head_norm_before_train=1.808177 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.7013920146697163, 'psi': 0.2803432239470754}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.6234223303366417, 'psi': 0.28036404111831337}
[S13] START round=33 head_norm_before_train=1.862426 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.12316156226236517, 'psi': 0.9997191418023301}-{'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.12007865325367051, 'psi': 0.9997191418023301}
[S14] START round=33 head_norm_before_train=2.078691 cos_to_last_merge=0.9999 (last merge round=31)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.137892845105998, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.9642744885099206, 'psi': 0.13592717296421}
[S15] START round=33 head_norm_before_train=2.222954 (no previous merge yet)
[S15] round=33 local utility u=0.098867 metrics={'f1_val': 0.6125374633685855, 'auprc': 0.6125374633685855, 'loss_val': 0.5922769883190564, 'psi': 0.6125374633685855}-{'f1_val': 0.5954688329256111, 'auprc': 0.5954688329256111, 'loss_val': 0.6363928866582413, 'psi': 0.5954688329256111}
[S16] START round=33 head_norm_before_train=1.857915 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.09866036249014971, 'auprc': 0.09866036249014971, 'loss_val': 4.335740517031711, 'psi': 0.09866036249014971}-{'f1_val': 0.10019973368841545, 'auprc': 0.10019973368841545, 'loss_val': 4.059228555693875, 'psi': 0.10019973368841545}
[S17] START round=33 head_norm_before_train=2.091787 (no previous merge yet)
[S17] round=33 local utility u=0.322585 metrics={'f1_val': 0.5850659142669792, 'auprc': 0.5850659142669792, 'loss_val': 1.2385356790044044, 'psi': 0.5850659142669792}-{'f1_val': 0.5218633435033864, 'auprc': 0.5218633435033864, 'loss_val': 1.3148828144921654, 'psi': 0.5218633435033864}
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S3]  timeout peer S4
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S15
[S13]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:38405
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.102)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:38414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:38412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:38402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:38407
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:38408
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=1.0000
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=-0.0291
[S7] DROPPED delta from S8 (cos=-0.0291 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.9871
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.9116
[S2] RECEIVED delta(kind=head bytes=1800) from S5
[S2] cosine check vs S5: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1794) from S10
[S11] cosine check vs S10: cos=0.9775
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.1018 head_norm=1.751285
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.585383e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.1018 head_norm=1.914481 delta_norm=0.458538
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.1359 head_norm=2.094257
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.692205e-01
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.1359 head_norm=2.096684 delta_norm=0.169221
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.3335 head_norm=2.011278
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.115195e-03
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.3335 head_norm=2.009386 delta_norm=0.009115
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=34 head_norm_before_train=2.007534 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.336492536327396, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.313712745580997, 'psi': 0.3674775928297055}
[S3] START round=34 head_norm_before_train=1.926149 cos_to_last_merge=0.9959 (last merge round=25)
[S3] round=34 local utility u=0.042470 metrics={'f1_val': 0.2649285667259201, 'auprc': 0.2649285667259201, 'loss_val': 2.0695401762929295, 'psi': 0.2649285667259201}-{'f1_val': 0.26157046281851276, 'auprc': 0.26157046281851276, 'loss_val': 2.124258188860578, 'psi': 0.26157046281851276}
[S4] START round=34 head_norm_before_train=2.107590 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4427527808344296, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4218758891686158, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=2.009386 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9246230916602425, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.8123179040573154, 'psi': 0.3335071121394324}
[S6] START round=34 head_norm_before_train=1.914481 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.03721754541426672, 'auprc': 0.03721754541426672, 'loss_val': 4.2944368078864725, 'psi': 0.03721754541426672}-{'f1_val': 0.10179184140297369, 'auprc': 0.10179184140297369, 'loss_val': 4.063907949758411, 'psi': 0.10179184140297369}
[S7] START round=34 head_norm_before_train=2.164252 cos_to_last_merge=0.9981 (last merge round=26)
[S7] round=34 local utility u=0.000063 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2795284474442092, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.279654262502523, 'psi': 0.35976373724718097}
[S8] START round=34 head_norm_before_train=2.220144 cos_to_last_merge=0.9795 (last merge round=19)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3388210129210748, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3327868314115759, 'psi': 0.9988708350860451}
[S9] START round=34 head_norm_before_train=1.830318 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.610953106171511, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5910712823918076, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.924026 cos_to_last_merge=0.9998 (last merge round=32)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.2826439578264396, 'auprc': 0.2826439578264396, 'loss_val': 1.2006018905829579, 'psi': 0.2826439578264396}-{'f1_val': 0.2848967913345596, 'auprc': 0.2848967913345596, 'loss_val': 1.172262049227435, 'psi': 0.2848967913345596}
[S11] START round=34 head_norm_before_train=1.820421 (no previous merge yet)
[S11] round=34 local utility u=0.008046 metrics={'f1_val': 0.2802881466928618, 'auprc': 0.2802881466928618, 'loss_val': 2.684803697922235, 'psi': 0.2802881466928618}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.7013920146697163, 'psi': 0.2803432239470754}
[S13] START round=34 head_norm_before_train=1.873950 (no previous merge yet)
[S13] round=34 local utility u=0.005008 metrics={'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.11314470614672119, 'psi': 0.9997191418023301}-{'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.12316156226236517, 'psi': 0.9997191418023301}
[S14] START round=34 head_norm_before_train=2.096684 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.137398 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.8630977874443397, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.137892845105998, 'psi': 0.13587634006482174}
[S15] START round=34 head_norm_before_train=2.234286 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6092432965021914, 'auprc': 0.6092432965021914, 'loss_val': 0.6442433789651824, 'psi': 0.6092432965021914}-{'f1_val': 0.6125374633685855, 'auprc': 0.6125374633685855, 'loss_val': 0.5922769883190564, 'psi': 0.6125374633685855}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.867012 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.09018100272304981, 'auprc': 0.09018100272304981, 'loss_val': 4.675761306418087, 'psi': 0.09018100272304981}-{'f1_val': 0.09866036249014971, 'auprc': 0.09866036249014971, 'loss_val': 4.335740517031711, 'psi': 0.09866036249014971}
[S17] START round=34 head_norm_before_train=2.112705 (no previous merge yet)
[S17] round=34 local utility u=0.204987 metrics={'f1_val': 0.6197213394324745, 'auprc': 0.6197213394324745, 'loss_val': 1.1404599425182251, 'psi': 0.6197213394324745}-{'f1_val': 0.5850659142669792, 'auprc': 0.5850659142669792, 'loss_val': 1.2385356790044044, 'psi': 0.5850659142669792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:38414
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:38411
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=34 metric=0.3675 head_norm=2.014881
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.097623e-02
[S2] stored merged vector for next round verification (round=34)
[S2] DEBUG after merge:  round=34 metric=0.3675 head_norm=2.013051 delta_norm=0.010976
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:38416
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.136)
[S10] RECEIVED delta(kind=head bytes=1800) from S11
[S10] cosine check vs S11: cos=0.9721
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=0.9949
[S13] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.2803 head_norm=1.832209
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.052658e-01
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.2803 head_norm=1.867431 delta_norm=0.205266
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:38407
[S16] RECEIVED delta(kind=head bytes=1796) from S13
[S16] cosine check vs S13: cos=-0.0646
[S16] DROPPED delta from S13 (cos=-0.0646 < 0.0)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.1359 head_norm=2.112216
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.071101e-01
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.1359 head_norm=2.118546 delta_norm=0.107110
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=0.1788
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.0372 head_norm=1.957302
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.247005e+00
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.0563 head_norm=1.493969 delta_norm=1.247005
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13]  timeout peer S14
[S10]  timeout peer S11
[S7]  timeout peer S6
[S7]  timeout peer S10
[S7]  timeout peer S15
[S5]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S7
[S4]  timeout peer S16
[S16]  timeout peer S8
[S16]  timeout peer S13
[S3]  timeout peer S5
[S3]  timeout peer S9
[S6]  timeout peer S3
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:38409
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] cosine check vs S7: cos=-0.0297
[S8] DROPPED delta from S7 (cos=-0.0297 < 0.0)
[S2] START round=35 head_norm_before_train=2.013051 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.339536540696148, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.336492536327396, 'psi': 0.3674775928297055}
[S3] START round=35 head_norm_before_train=1.934657 cos_to_last_merge=0.9953 (last merge round=25)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.26050365766815564, 'auprc': 0.26050365766815564, 'loss_val': 2.173981492089892, 'psi': 0.26050365766815564}-{'f1_val': 0.2649285667259201, 'auprc': 0.2649285667259201, 'loss_val': 2.0695401762929295, 'psi': 0.2649285667259201}
[S4] START round=35 head_norm_before_train=2.126437 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4742908091423728, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4427527808344296, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=2.020984 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=35 local utility u=0.073849 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.7723957675786517, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9246230916602425, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.493969 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.287233 metrics={'f1_val': 0.05286815068493151, 'auprc': 0.05286815068493151, 'loss_val': 3.8608254215652678, 'psi': 0.05286815068493152}-{'f1_val': 0.03721754541426672, 'auprc': 0.03721754541426672, 'loss_val': 4.2944368078864725, 'psi': 0.03721754541426672}
[S7] START round=35 head_norm_before_train=2.170122 cos_to_last_merge=0.9977 (last merge round=26)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2805564367544164, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2795284474442092, 'psi': 0.35976373724718097}
[S8] START round=35 head_norm_before_train=2.228477 cos_to_last_merge=0.9787 (last merge round=19)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.34227759293350984, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3388210129210748, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.836699 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6358054526756116, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.610953106171511, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.960154 cos_to_last_merge=0.9990 (last merge round=32)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.2805393439323807, 'auprc': 0.2805393439323807, 'loss_val': 1.2321800783715084, 'psi': 0.2805393439323807}-{'f1_val': 0.2826439578264396, 'auprc': 0.2826439578264396, 'loss_val': 1.2006018905829579, 'psi': 0.2826439578264396}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.2805 head_norm=1.994222
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.573585e-01
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.2780 head_norm=1.897557 delta_norm=0.257358
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] START round=35 head_norm_before_train=1.867431 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.7600797711275855, 'psi': 0.2803432239470754}-{'f1_val': 0.2802881466928618, 'auprc': 0.2802881466928618, 'loss_val': 2.684803697922235, 'psi': 0.2802881466928618}
[S13] START round=35 head_norm_before_train=1.883986 (no previous merge yet)
[S13] round=35 local utility u=0.002098 metrics={'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.10894947495339545, 'psi': 0.9997191418023301}-{'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.11314470614672119, 'psi': 0.9997191418023301}
[S14] START round=35 head_norm_before_train=2.118546 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.001358 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.8608390880794903, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 3.8630977874443397, 'psi': 0.13587634006482174}
[S15] START round=35 head_norm_before_train=2.246528 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6024838694206783, 'auprc': 0.6024838694206783, 'loss_val': 0.6897340007798936, 'psi': 0.6024838694206783}-{'f1_val': 0.6092432965021914, 'auprc': 0.6092432965021914, 'loss_val': 0.6442433789651824, 'psi': 0.6092432965021914}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.876172 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.09018100272304981, 'auprc': 0.09018100272304981, 'loss_val': 4.715561430639308, 'psi': 0.09018100272304981}-{'f1_val': 0.09018100272304981, 'auprc': 0.09018100272304981, 'loss_val': 4.675761306418087, 'psi': 0.09018100272304981}
[S17] START round=35 head_norm_before_train=2.130249 (no previous merge yet)
[S17] round=35 local utility u=0.176712 metrics={'f1_val': 0.6538657774845904, 'auprc': 0.6538657774845904, 'loss_val': 1.0943368124310213, 'psi': 0.6538657774845904}-{'f1_val': 0.6197213394324745, 'auprc': 0.6197213394324745, 'loss_val': 1.1404599425182251, 'psi': 0.6197213394324745}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.053)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:38416
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.136)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=-0.0641
[S16] DROPPED delta from S13 (cos=-0.0641 < 0.0)
[S13] ⇄ pheromone p=0.027 → S16@127.0.0.1:38416
[S2] START round=36 head_norm_before_train=2.020192 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.3652257244536083, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.339536540696148, 'psi': 0.3674775928297055}
[S3] START round=36 head_norm_before_train=1.943232 cos_to_last_merge=0.9947 (last merge round=25)
[S3] round=36 local utility u=0.003810 metrics={'f1_val': 0.2614175274475411, 'auprc': 0.2614175274475411, 'loss_val': 2.1745871901632725, 'psi': 0.2614175274475411}-{'f1_val': 0.26050365766815564, 'auprc': 0.26050365766815564, 'loss_val': 2.173981492089892, 'psi': 0.26050365766815564}
[S4] START round=36 head_norm_before_train=2.135658 (no previous merge yet)
[S4] round=36 local utility u=0.013670 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4469506806431525, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4742908091423728, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=36 head_norm_before_train=2.035066 cos_to_last_merge=0.9998 (last merge round=33)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.8698178533094825, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.7723957675786517, 'psi': 0.33300395256917}
[S6] START round=36 head_norm_before_train=1.555065 cos_to_last_merge=0.9970 (last merge round=34)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.1007262996941896, 'auprc': 0.1007262996941896, 'loss_val': 4.349781520503408, 'psi': 0.1007262996941896}-{'f1_val': 0.05286815068493151, 'auprc': 0.05286815068493151, 'loss_val': 3.8608254215652678, 'psi': 0.05286815068493152}
[S7] START round=36 head_norm_before_train=2.177933 cos_to_last_merge=0.9974 (last merge round=26)
[S7] round=36 local utility u=0.006269 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2680179024859681, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2805564367544164, 'psi': 0.35976373724718097}
[S8] START round=36 head_norm_before_train=2.234364 cos_to_last_merge=0.9780 (last merge round=19)
[S8] round=36 local utility u=0.002280 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3377179042460487, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.34227759293350984, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=36 head_norm_before_train=1.843306 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.658043387963911, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6358054526756116, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.897557 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.012610 metrics={'f1_val': 0.27131179447255743, 'auprc': 0.27131179447255743, 'loss_val': 1.1239111625575526, 'psi': 0.27131179447255743}-{'f1_val': 0.2805393439323807, 'auprc': 0.2805393439323807, 'loss_val': 1.2321800783715084, 'psi': 0.2805393439323807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=36 head_norm_before_train=1.878202 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8277171377973067, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.7600797711275855, 'psi': 0.2803432239470754}
[S13] START round=36 head_norm_before_train=1.893093 (no previous merge yet)
[S13] round=36 local utility u=0.001575 metrics={'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.10580011148314927, 'psi': 0.9997191418023301}-{'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.10894947495339545, 'psi': 0.9997191418023301}
[S14] START round=36 head_norm_before_train=2.135888 cos_to_last_merge=0.9996 (last merge round=34)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.175324244940834, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.8608390880794903, 'psi': 0.13592717296421}
[S15] START round=36 head_norm_before_train=2.259651 (no previous merge yet)
[S15] round=36 local utility u=0.045435 metrics={'f1_val': 0.6080843194751313, 'auprc': 0.6080843194751313, 'loss_val': 0.649268062787548, 'psi': 0.6080843194751313}-{'f1_val': 0.6024838694206783, 'auprc': 0.6024838694206783, 'loss_val': 0.6897340007798936, 'psi': 0.6024838694206783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=36 head_norm_before_train=1.885362 (no previous merge yet)
[S16] round=36 local utility u=0.038780 metrics={'f1_val': 0.09050931478372111, 'auprc': 0.09050931478372111, 'loss_val': 4.640956753465173, 'psi': 0.09050931478372111}-{'f1_val': 0.09018100272304981, 'auprc': 0.09018100272304981, 'loss_val': 4.715561430639308, 'psi': 0.09018100272304981}
[S17] START round=36 head_norm_before_train=2.145231 (no previous merge yet)
[S17] round=36 local utility u=0.123432 metrics={'f1_val': 0.6776788275100114, 'auprc': 0.6776788275100114, 'loss_val': 1.0617897635257796, 'psi': 0.6776788275100114}-{'f1_val': 0.6538657774845904, 'auprc': 0.6538657774845904, 'loss_val': 1.0943368124310213, 'psi': 0.6538657774845904}
[S16] not sending this round → trigger blocked (psi=0.091)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=2.027648 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.389903775982735, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.3652257244536083, 'psi': 0.3674775928297055}
[S3] START round=37 head_norm_before_train=1.950803 cos_to_last_merge=0.9941 (last merge round=25)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.26121389159363845, 'auprc': 0.26121389159363845, 'loss_val': 2.1977146519923365, 'psi': 0.26121389159363845}-{'f1_val': 0.2614175274475411, 'auprc': 0.2614175274475411, 'loss_val': 2.1745871901632725, 'psi': 0.2614175274475411}
[S4] START round=37 head_norm_before_train=2.143993 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4470348917020504, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4469506806431525, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=2.045380 cos_to_last_merge=0.9997 (last merge round=33)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0379650491972154, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.8698178533094825, 'psi': 0.33300395256917}
[S6] START round=37 head_norm_before_train=1.616530 cos_to_last_merge=0.9909 (last merge round=34)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.696496224748369, 'psi': 0.1017530487804878}-{'f1_val': 0.1007262996941896, 'auprc': 0.1007262996941896, 'loss_val': 4.349781520503408, 'psi': 0.1007262996941896}
[S7] START round=37 head_norm_before_train=2.187954 cos_to_last_merge=0.9969 (last merge round=26)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.270977542231856, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2680179024859681, 'psi': 0.35976373724718097}
[S8] START round=37 head_norm_before_train=2.242944 cos_to_last_merge=0.9770 (last merge round=19)
[S8] round=37 local utility u=0.003117 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.33148358578055476, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3377179042460487, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=37 head_norm_before_train=1.849644 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.676765010845868, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.658043387963911, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.935072 cos_to_last_merge=0.9996 (last merge round=35)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.27110073901205756, 'auprc': 0.27110073901205756, 'loss_val': 1.1616115728250194, 'psi': 0.27110073901205756}-{'f1_val': 0.27131179447255743, 'auprc': 0.27131179447255743, 'loss_val': 1.1239111625575526, 'psi': 0.27131179447255743}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.888484 cos_to_last_merge=0.9999 (last merge round=34)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8415966030608653, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8277171377973067, 'psi': 0.2803432239470754}
[S13] START round=37 head_norm_before_train=1.899639 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.10435160908055092, 'psi': 0.9994382441285097}-{'f1_val': 0.9997191418023301, 'auprc': 0.9997191418023301, 'loss_val': 0.10580011148314927, 'psi': 0.9997191418023301}
[S14] START round=37 head_norm_before_train=2.154951 cos_to_last_merge=0.9985 (last merge round=34)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.432111863341992, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.175324244940834, 'psi': 0.13592717296421}
[S15] START round=37 head_norm_before_train=2.272522 (no previous merge yet)
[S15] round=37 local utility u=0.039423 metrics={'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6092211793708908, 'psi': 0.612395395031292}-{'f1_val': 0.6080843194751313, 'auprc': 0.6080843194751313, 'loss_val': 0.649268062787548, 'psi': 0.6080843194751313}
[S15] not sending this round → trigger blocked (psi=0.612)
[S16] START round=37 head_norm_before_train=1.894111 (no previous merge yet)
[S16] round=37 local utility u=0.453662 metrics={'f1_val': 0.12461340206185567, 'auprc': 0.12461340206185567, 'loss_val': 4.0405701241944545, 'psi': 0.12461340206185567}-{'f1_val': 0.09050931478372111, 'auprc': 0.09050931478372111, 'loss_val': 4.640956753465173, 'psi': 0.09050931478372111}
[S17] START round=37 head_norm_before_train=2.156203 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5297421147829604, 'auprc': 0.5297421147829604, 'loss_val': 1.388057509559024, 'psi': 0.5297421147829604}-{'f1_val': 0.6776788275100114, 'auprc': 0.6776788275100114, 'loss_val': 1.0617897635257796, 'psi': 0.6776788275100114}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.125)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=2.034882 cos_to_last_merge=0.9999 (last merge round=34)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.4111187997878565, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.389903775982735, 'psi': 0.3674775928297055}
[S3] START round=38 head_norm_before_train=1.957503 cos_to_last_merge=0.9936 (last merge round=25)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.25854536108969417, 'auprc': 0.25854536108969417, 'loss_val': 2.2265591201151174, 'psi': 0.25854536108969417}-{'f1_val': 0.26121389159363845, 'auprc': 0.26121389159363845, 'loss_val': 2.1977146519923365, 'psi': 0.26121389159363845}
[S4] START round=38 head_norm_before_train=2.149129 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4529534284763002, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4470348917020504, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=2.053380 cos_to_last_merge=0.9996 (last merge round=33)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.165003402420987, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0379650491972154, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=1.663865 cos_to_last_merge=0.9858 (last merge round=34)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.938615868897134, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.696496224748369, 'psi': 0.1017530487804878}
[S7] START round=38 head_norm_before_train=2.195925 cos_to_last_merge=0.9965 (last merge round=26)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2780523590904584, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.270977542231856, 'psi': 0.35976373724718097}
[S8] START round=38 head_norm_before_train=2.250653 cos_to_last_merge=0.9762 (last merge round=19)
[S8] round=38 local utility u=0.003125 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3252343663136069, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.33148358578055476, 'psi': 0.9988708350860451}
[S8] not sending this round → trigger blocked (psi=0.999)
[S9] START round=38 head_norm_before_train=1.855679 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.692560790939801, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.676765010845868, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.977051 cos_to_last_merge=0.9982 (last merge round=35)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.2699457784663052, 'auprc': 0.2699457784663052, 'loss_val': 1.1943089448874022, 'psi': 0.2699457784663052}-{'f1_val': 0.27110073901205756, 'auprc': 0.27110073901205756, 'loss_val': 1.1616115728250194, 'psi': 0.27110073901205756}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.898126 cos_to_last_merge=0.9999 (last merge round=34)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.846554124106129, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8415966030608653, 'psi': 0.2803432239470754}
[S13] START round=38 head_norm_before_train=1.903480 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.10560253005462175, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.10435160908055092, 'psi': 0.9994382441285097}
[S14] START round=38 head_norm_before_train=2.173048 cos_to_last_merge=0.9971 (last merge round=34)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.62371964814959, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.432111863341992, 'psi': 0.13572854291417166}
[S15] START round=38 head_norm_before_train=2.284828 (no previous merge yet)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6346335194289526, 'psi': 0.6136702686915539}-{'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6092211793708908, 'psi': 0.612395395031292}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.902209 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.09186602870813397, 'auprc': 0.09186602870813397, 'loss_val': 4.580313308290841, 'psi': 0.09186602870813397}-{'f1_val': 0.12461340206185567, 'auprc': 0.12461340206185567, 'loss_val': 4.0405701241944545, 'psi': 0.12461340206185567}
[S17] START round=38 head_norm_before_train=2.160490 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5238415625754098, 'auprc': 0.5238415625754098, 'loss_val': 1.431922053548775, 'psi': 0.5238415625754098}-{'f1_val': 0.5297421147829604, 'auprc': 0.5297421147829604, 'loss_val': 1.388057509559024, 'psi': 0.5297421147829604}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=2.041682 cos_to_last_merge=0.9999 (last merge round=34)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.4325886510716384, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.4111187997878565, 'psi': 0.3674775928297055}
[S3] START round=39 head_norm_before_train=1.964456 cos_to_last_merge=0.9931 (last merge round=25)
[S3] round=39 local utility u=0.014227 metrics={'f1_val': 0.2613156698486915, 'auprc': 0.2613156698486915, 'loss_val': 2.223037710928267, 'psi': 0.2613156698486915}-{'f1_val': 0.25854536108969417, 'auprc': 0.25854536108969417, 'loss_val': 2.2265591201151174, 'psi': 0.25854536108969417}
[S4] START round=39 head_norm_before_train=2.154229 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4658251808477132, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4529534284763002, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0023 f1=0.357 auprc=0.357 bytes=14405
[S5] START round=39 head_norm_before_train=2.062284 cos_to_last_merge=0.9994 (last merge round=33)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.206118414187801, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.165003402420987, 'psi': 0.3335071121394324}
[S6] START round=39 head_norm_before_train=1.699048 cos_to_last_merge=0.9820 (last merge round=34)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.111448718142077, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 4.938615868897134, 'psi': 0.1017530487804878}
[S7] START round=39 head_norm_before_train=2.205647 cos_to_last_merge=0.9960 (last merge round=26)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.288482260365105, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2780523590904584, 'psi': 0.35976373724718097}
[S8] START round=39 head_norm_before_train=2.257493 cos_to_last_merge=0.9756 (last merge round=19)
[S8] round=39 local utility u=0.003765 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3177033795377846, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3252343663136069, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] r=40 psi=0.999 u=0.0038 p_local=0.0076 f1=0.999 auprc=0.999 bytes=44956
[S9] START round=39 head_norm_before_train=1.861616 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.705973992794756, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.692560790939801, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0020 f1=0.369 auprc=0.369 bytes=5403
[S10] START round=39 head_norm_before_train=2.014024 cos_to_last_merge=0.9965 (last merge round=35)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.26900810497877264, 'auprc': 0.26900810497877264, 'loss_val': 1.2245596452748146, 'psi': 0.26900810497877264}-{'f1_val': 0.2699457784663052, 'auprc': 0.2699457784663052, 'loss_val': 1.1943089448874022, 'psi': 0.2699457784663052}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.269 u=0.0000 p_local=0.0098 f1=0.269 auprc=0.269 bytes=28818
[S11] START round=39 head_norm_before_train=1.907214 cos_to_last_merge=0.9998 (last merge round=34)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.854932057326982, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.846554124106129, 'psi': 0.2803432239470754}
[S13] START round=39 head_norm_before_train=1.912176 (no previous merge yet)
[S13] round=39 local utility u=0.001602 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.10239904396938451, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.10560253005462175, 'psi': 0.9994382441285097}
[S14] START round=39 head_norm_before_train=2.189119 cos_to_last_merge=0.9957 (last merge round=34)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.7680285302368555, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.62371964814959, 'psi': 0.13592717296421}
[S15] START round=39 head_norm_before_train=2.295876 (no previous merge yet)
[S15] round=39 local utility u=0.002265 metrics={'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6186304962348935, 'psi': 0.612395395031292}-{'f1_val': 0.6136702686915539, 'auprc': 0.6136702686915539, 'loss_val': 0.6346335194289526, 'psi': 0.6136702686915539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S15] r=40 psi=0.612 u=0.0023 p_local=0.0209 f1=0.612 auprc=0.612 bytes=28764
[S16] START round=39 head_norm_before_train=1.908963 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.08769812535199935, 'auprc': 0.08769812535199935, 'loss_val': 5.040120760542344, 'psi': 0.08769812535199935}-{'f1_val': 0.09186602870813397, 'auprc': 0.09186602870813397, 'loss_val': 4.580313308290841, 'psi': 0.09186602870813397}
[S17] START round=39 head_norm_before_train=2.169351 (no previous merge yet)
[S17] round=39 local utility u=1.000000 metrics={'f1_val': 0.7792788530965695, 'auprc': 0.7792788530965695, 'loss_val': 0.7639617151499639, 'psi': 0.7792788530965695}-{'f1_val': 0.5238415625754098, 'auprc': 0.5238415625754098, 'loss_val': 1.431922053548775, 'psi': 0.5238415625754098}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S3] r=40 psi=0.261 u=0.0142 p_local=0.0116 f1=0.261 auprc=0.261 bytes=18019
[S17] r=40 psi=0.779 u=1.0000 p_local=0.3028 f1=0.779 auprc=0.779 bytes=27009
[S13] r=40 psi=0.999 u=0.0016 p_local=0.0116 f1=0.999 auprc=0.999 bytes=50435
[S6] r=40 psi=0.102 u=0.0000 p_local=0.0902 f1=0.102 auprc=0.102 bytes=0
[S2] r=40 psi=0.367 u=0.0000 p_local=0.0475 f1=0.367 auprc=0.367 bytes=25190
[S11] r=40 psi=0.280 u=0.0000 p_local=0.0040 f1=0.280 auprc=0.280 bytes=17975
[S7] r=40 psi=0.360 u=0.0000 p_local=0.0310 f1=0.360 auprc=0.360 bytes=23380
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0156 f1=0.334 auprc=0.334 bytes=28778
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.088 u=0.0000 p_local=0.0979 f1=0.088 auprc=0.088 bytes=0
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0303 f1=0.136 auprc=0.136 bytes=0
[S2] START round=40 head_norm_before_train=2.048335 cos_to_last_merge=0.9998 (last merge round=34)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.4521574433449214, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.4325886510716384, 'psi': 0.3674775928297055}
[S3] START round=40 head_norm_before_train=1.970770 cos_to_last_merge=0.9926 (last merge round=25)
[S3] round=40 local utility u=0.000030 metrics={'f1_val': 0.2618257531394365, 'auprc': 0.2618257531394365, 'loss_val': 2.2275688257517774, 'psi': 0.2618257531394365}-{'f1_val': 0.2613156698486915, 'auprc': 0.2613156698486915, 'loss_val': 2.223037710928267, 'psi': 0.2613156698486915}
[S4] START round=40 head_norm_before_train=2.157864 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.480825090270737, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4658251808477132, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=2.070949 cos_to_last_merge=0.9992 (last merge round=33)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2403783968462476, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.206118414187801, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.727325 cos_to_last_merge=0.9790 (last merge round=34)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.248836469360169, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.111448718142077, 'psi': 0.1017530487804878}
[S7] START round=40 head_norm_before_train=2.214550 cos_to_last_merge=0.9957 (last merge round=26)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2970631932612489, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.288482260365105, 'psi': 0.35976373724718097}
[S8] START round=40 head_norm_before_train=2.265790 cos_to_last_merge=0.9752 (last merge round=19)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.31800921804799726, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3177033795377846, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.867301 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7180049653020224, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.705973992794756, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.045273 cos_to_last_merge=0.9950 (last merge round=35)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.26895620297125217, 'auprc': 0.26895620297125217, 'loss_val': 1.2518350503633136, 'psi': 0.26895620297125217}-{'f1_val': 0.26900810497877264, 'auprc': 0.26900810497877264, 'loss_val': 1.2245596452748146, 'psi': 0.26900810497877264}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.915916 cos_to_last_merge=0.9997 (last merge round=34)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8745993798183536, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.854932057326982, 'psi': 0.2803432239470754}
[S13] START round=40 head_norm_before_train=1.921629 (no previous merge yet)
[S13] round=40 local utility u=0.005107 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.09218406587566741, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.10239904396938451, 'psi': 0.9994382441285097}
[S14] START round=40 head_norm_before_train=2.202972 cos_to_last_merge=0.9944 (last merge round=34)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.8775891034786385, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.7680285302368555, 'psi': 0.13572854291417166}
[S15] START round=40 head_norm_before_train=2.305681 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.599264564499716, 'auprc': 0.599264564499716, 'loss_val': 0.685874959419646, 'psi': 0.599264564499716}-{'f1_val': 0.612395395031292, 'auprc': 0.612395395031292, 'loss_val': 0.6186304962348935, 'psi': 0.612395395031292}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.916327 (no previous merge yet)
[S16] round=40 local utility u=0.060340 metrics={'f1_val': 0.09027611044417767, 'auprc': 0.09027611044417767, 'loss_val': 4.9426429616983825, 'psi': 0.09027611044417767}-{'f1_val': 0.08769812535199935, 'auprc': 0.08769812535199935, 'loss_val': 5.040120760542344, 'psi': 0.08769812535199935}
[S17] START round=40 head_norm_before_train=2.180180 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.5588871878087347, 'auprc': 0.5588871878087347, 'loss_val': 1.346531311108641, 'psi': 0.5588871878087347}-{'f1_val': 0.7792788530965695, 'auprc': 0.7792788530965695, 'loss_val': 0.7639617151499639, 'psi': 0.7792788530965695}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.999)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S3] not sending this round → trigger blocked (psi=0.262)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=2.054710 cos_to_last_merge=0.9998 (last merge round=34)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.468262477327237, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.4521574433449214, 'psi': 0.3674775928297055}
[S3] START round=41 head_norm_before_train=1.978159 cos_to_last_merge=0.9920 (last merge round=25)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.25894465894465896, 'auprc': 0.25894465894465896, 'loss_val': 2.27831344150671, 'psi': 0.25894465894465896}-{'f1_val': 0.2618257531394365, 'auprc': 0.2618257531394365, 'loss_val': 2.2275688257517774, 'psi': 0.2618257531394365}
[S4] START round=41 head_norm_before_train=2.168842 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4964571844916683, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.480825090270737, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=2.078928 cos_to_last_merge=0.9989 (last merge round=33)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2456513424919975, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2403783968462476, 'psi': 0.3335071121394324}
[S6] START round=41 head_norm_before_train=1.750540 cos_to_last_merge=0.9766 (last merge round=34)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.36098376973347, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.248836469360169, 'psi': 0.1017530487804878}
[S7] START round=41 head_norm_before_train=2.222338 cos_to_last_merge=0.9952 (last merge round=26)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3127218221017687, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2970631932612489, 'psi': 0.35976373724718097}
[S8] START round=41 head_norm_before_train=2.272547 cos_to_last_merge=0.9747 (last merge round=19)
[S8] round=41 local utility u=0.002916 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3121775124348493, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.31800921804799726, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=41 head_norm_before_train=1.872680 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7311635557591525, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7180049653020224, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.071594 cos_to_last_merge=0.9935 (last merge round=35)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.2676651305683564, 'auprc': 0.2676651305683564, 'loss_val': 1.275432359484185, 'psi': 0.2676651305683564}-{'f1_val': 0.26895620297125217, 'auprc': 0.26895620297125217, 'loss_val': 1.2518350503633136, 'psi': 0.26895620297125217}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.924111 cos_to_last_merge=0.9996 (last merge round=34)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8970281448754283, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8745993798183536, 'psi': 0.2803432239470754}
[S13] START round=41 head_norm_before_train=1.928224 (no previous merge yet)
[S13] round=41 local utility u=0.000968 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.09024715168450397, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.09218406587566741, 'psi': 0.9994382441285097}
[S14] START round=41 head_norm_before_train=2.214918 cos_to_last_merge=0.9933 (last merge round=34)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.963952931299127, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.8775891034786385, 'psi': 0.13592717296421}
[S15] START round=41 head_norm_before_train=2.317104 (no previous merge yet)
[S15] round=41 local utility u=0.085742 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6567033908970037, 'psi': 0.6150769866718802}-{'f1_val': 0.599264564499716, 'auprc': 0.599264564499716, 'loss_val': 0.685874959419646, 'psi': 0.599264564499716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=41 head_norm_before_train=1.923896 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.08978675645342311, 'auprc': 0.08978675645342311, 'loss_val': 5.180880058513037, 'psi': 0.08978675645342311}-{'f1_val': 0.09027611044417767, 'auprc': 0.09027611044417767, 'loss_val': 4.9426429616983825, 'psi': 0.09027611044417767}
[S17] START round=41 head_norm_before_train=2.194009 (no previous merge yet)
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.7778212049067053, 'auprc': 0.7778212049067053, 'loss_val': 0.8214962348720246, 'psi': 0.7778212049067053}-{'f1_val': 0.5588871878087347, 'auprc': 0.5588871878087347, 'loss_val': 1.346531311108641, 'psi': 0.5588871878087347}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=2.060688 cos_to_last_merge=0.9997 (last merge round=34)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.484883298822691, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.468262477327237, 'psi': 0.3674775928297055}
[S3] START round=42 head_norm_before_train=1.985683 cos_to_last_merge=0.9914 (last merge round=25)
[S3] round=42 local utility u=0.009563 metrics={'f1_val': 0.261366588724344, 'auprc': 0.261366588724344, 'loss_val': 2.280985060523865, 'psi': 0.261366588724344}-{'f1_val': 0.25894465894465896, 'auprc': 0.25894465894465896, 'loss_val': 2.27831344150671, 'psi': 0.25894465894465896}
[S4] START round=42 head_norm_before_train=2.182838 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.508740412809371, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4964571844916683, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=2.087124 cos_to_last_merge=0.9986 (last merge round=33)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.266264169412736, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2456513424919975, 'psi': 0.3335071121394324}
[S6] START round=42 head_norm_before_train=1.770841 cos_to_last_merge=0.9745 (last merge round=34)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.4593099308389, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.36098376973347, 'psi': 0.1017530487804878}
[S7] START round=42 head_norm_before_train=2.229538 cos_to_last_merge=0.9946 (last merge round=26)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3354015352591537, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3127218221017687, 'psi': 0.35976373724718097}
[S8] START round=42 head_norm_before_train=2.280225 cos_to_last_merge=0.9744 (last merge round=19)
[S8] round=42 local utility u=0.015711 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2807548706251568, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3121775124348493, 'psi': 0.9988708350860451}
[S8] not sending this round → trigger blocked (psi=0.999)
[S9] START round=42 head_norm_before_train=1.877936 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.748343512646675, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7311635557591525, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.094489 cos_to_last_merge=0.9923 (last merge round=35)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.2666921752439258, 'auprc': 0.2666921752439258, 'loss_val': 1.2978588926078183, 'psi': 0.2666921752439258}-{'f1_val': 0.2676651305683564, 'auprc': 0.2676651305683564, 'loss_val': 1.275432359484185, 'psi': 0.2676651305683564}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.931661 cos_to_last_merge=0.9995 (last merge round=34)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.912070958498801, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.8970281448754283, 'psi': 0.2803432239470754}
[S13] START round=42 head_norm_before_train=1.935174 (no previous merge yet)
[S13] round=42 local utility u=0.000052 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.09014224161791902, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.09024715168450397, 'psi': 0.9994382441285097}
[S14] START round=42 head_norm_before_train=2.225367 cos_to_last_merge=0.9924 (last merge round=34)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.0397850156338935, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.963952931299127, 'psi': 0.13592717296421}
[S15] START round=42 head_norm_before_train=2.329093 (no previous merge yet)
[S15] round=42 local utility u=0.004187 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6583913420505302, 'psi': 0.6161950003225232}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6567033908970037, 'psi': 0.6150769866718802}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=42 head_norm_before_train=1.930358 (no previous merge yet)
[S16] round=42 local utility u=0.696261 metrics={'f1_val': 0.14048140043763677, 'auprc': 0.14048140043763677, 'loss_val': 4.244610792476265, 'psi': 0.14048140043763677}-{'f1_val': 0.08978675645342311, 'auprc': 0.08978675645342311, 'loss_val': 5.180880058513037, 'psi': 0.08978675645342311}
[S17] START round=42 head_norm_before_train=2.209112 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.704919691985576, 'auprc': 0.704919691985576, 'loss_val': 1.1302709507116566, 'psi': 0.704919691985576}-{'f1_val': 0.7778212049067053, 'auprc': 0.7778212049067053, 'loss_val': 0.8214962348720246, 'psi': 0.7778212049067053}
[S16] not sending this round → trigger blocked (psi=0.140)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.999)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.066587 cos_to_last_merge=0.9997 (last merge round=34)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5017232559582787, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.484883298822691, 'psi': 0.3674775928297055}
[S3] START round=43 head_norm_before_train=1.993678 cos_to_last_merge=0.9908 (last merge round=25)
[S3] round=43 local utility u=0.002460 metrics={'f1_val': 0.26197916666666665, 'auprc': 0.26197916666666665, 'loss_val': 2.2815786014461232, 'psi': 0.26197916666666665}-{'f1_val': 0.261366588724344, 'auprc': 0.261366588724344, 'loss_val': 2.280985060523865, 'psi': 0.261366588724344}
[S4] START round=43 head_norm_before_train=2.197493 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5152458344804522, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.508740412809371, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=2.093504 cos_to_last_merge=0.9984 (last merge round=33)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2978061939118084, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.266264169412736, 'psi': 0.3335071121394324}
[S6] START round=43 head_norm_before_train=1.788744 cos_to_last_merge=0.9726 (last merge round=34)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.549692591148997, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.4593099308389, 'psi': 0.1017530487804878}
[S7] START round=43 head_norm_before_train=2.237438 cos_to_last_merge=0.9943 (last merge round=26)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.356214372973721, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3354015352591537, 'psi': 0.35976373724718097}
[S8] START round=43 head_norm_before_train=2.284538 cos_to_last_merge=0.9737 (last merge round=19)
[S8] round=43 local utility u=0.006192 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.26837002225670853, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2807548706251568, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=43 head_norm_before_train=1.883175 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.764433302103218, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.748343512646675, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.114539 cos_to_last_merge=0.9911 (last merge round=35)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.2676651305683564, 'auprc': 0.2676651305683564, 'loss_val': 1.3178846466252774, 'psi': 0.2676651305683564}-{'f1_val': 0.2666921752439258, 'auprc': 0.2666921752439258, 'loss_val': 1.2978588926078183, 'psi': 0.2666921752439258}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.939272 cos_to_last_merge=0.9994 (last merge round=34)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9247594077025423, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.912070958498801, 'psi': 0.2803432239470754}
[S13] START round=43 head_norm_before_train=1.941615 (no previous merge yet)
[S13] round=43 local utility u=0.001469 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.08720489349612497, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.09014224161791902, 'psi': 0.9994382441285097}
[S14] START round=43 head_norm_before_train=2.234525 cos_to_last_merge=0.9915 (last merge round=34)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.105656830110338, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.0397850156338935, 'psi': 0.13592717296421}
[S15] START round=43 head_norm_before_train=2.340451 (no previous merge yet)
[S15] round=43 local utility u=0.010823 metrics={'f1_val': 0.6140933634089104, 'auprc': 0.6140933634089104, 'loss_val': 0.6178310224593301, 'psi': 0.6140933634089104}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6583913420505302, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=43 head_norm_before_train=1.936668 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.10928013876843018, 'auprc': 0.10928013876843018, 'loss_val': 4.132207632619628, 'psi': 0.10928013876843018}-{'f1_val': 0.14048140043763677, 'auprc': 0.14048140043763677, 'loss_val': 4.244610792476265, 'psi': 0.14048140043763677}
[S17] START round=43 head_norm_before_train=2.217845 (no previous merge yet)
[S17] round=43 local utility u=0.176332 metrics={'f1_val': 0.730784525315856, 'auprc': 0.730784525315856, 'loss_val': 1.0103897587067172, 'psi': 0.730784525315856}-{'f1_val': 0.704919691985576, 'auprc': 0.704919691985576, 'loss_val': 1.1302709507116566, 'psi': 0.704919691985576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.262)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.072383 cos_to_last_merge=0.9996 (last merge round=34)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5178734485764456, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5017232559582787, 'psi': 0.3674775928297055}
[S3] START round=44 head_norm_before_train=2.001265 cos_to_last_merge=0.9901 (last merge round=25)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 2.3400325748589923, 'psi': 0.2586450700604191}-{'f1_val': 0.26197916666666665, 'auprc': 0.26197916666666665, 'loss_val': 2.2815786014461232, 'psi': 0.26197916666666665}
[S4] START round=44 head_norm_before_train=2.209066 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5153322817700623, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5152458344804522, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=2.104532 cos_to_last_merge=0.9979 (last merge round=33)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.313897878961681, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2978061939118084, 'psi': 0.3335071121394324}
[S6] START round=44 head_norm_before_train=1.804548 cos_to_last_merge=0.9710 (last merge round=34)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.632677838869988, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.549692591148997, 'psi': 0.1017530487804878}
[S7] START round=44 head_norm_before_train=2.245888 cos_to_last_merge=0.9941 (last merge round=26)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3806092559356076, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.356214372973721, 'psi': 0.35976373724718097}
[S8] START round=44 head_norm_before_train=2.292607 cos_to_last_merge=0.9730 (last merge round=19)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2787730890132961, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.26837002225670853, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.888277 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7786424082169363, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.764433302103218, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.132702 cos_to_last_merge=0.9901 (last merge round=35)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.2658783139423994, 'auprc': 0.2658783139423994, 'loss_val': 1.3413921027722278, 'psi': 0.2658783139423994}-{'f1_val': 0.2676651305683564, 'auprc': 0.2676651305683564, 'loss_val': 1.3178846466252774, 'psi': 0.2676651305683564}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.946677 cos_to_last_merge=0.9993 (last merge round=34)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.939343819317706, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9247594077025423, 'psi': 0.2803432239470754}
[S13] START round=44 head_norm_before_train=1.950146 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.09085427226788319, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.08720489349612497, 'psi': 0.9994382441285097}
[S14] START round=44 head_norm_before_train=2.242803 cos_to_last_merge=0.9908 (last merge round=34)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.167040123546098, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.105656830110338, 'psi': 0.13592717296421}
[S15] START round=44 head_norm_before_train=2.350416 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6306614436074476, 'psi': 0.6153571007984797}-{'f1_val': 0.6140933634089104, 'auprc': 0.6140933634089104, 'loss_val': 0.6178310224593301, 'psi': 0.6140933634089104}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.943489 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.1033003300330033, 'auprc': 0.1033003300330033, 'loss_val': 4.324700224794818, 'psi': 0.1033003300330033}-{'f1_val': 0.10928013876843018, 'auprc': 0.10928013876843018, 'loss_val': 4.132207632619628, 'psi': 0.10928013876843018}
[S17] START round=44 head_norm_before_train=2.229974 (no previous merge yet)
[S17] round=44 local utility u=0.191647 metrics={'f1_val': 0.7625621742498601, 'auprc': 0.7625621742498601, 'loss_val': 0.913094710704722, 'psi': 0.7625621742498601}-{'f1_val': 0.730784525315856, 'auprc': 0.730784525315856, 'loss_val': 1.0103897587067172, 'psi': 0.730784525315856}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.763)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=2.077980 cos_to_last_merge=0.9995 (last merge round=34)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5323923763242453, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5178734485764456, 'psi': 0.3674775928297055}
[S3] START round=45 head_norm_before_train=2.008379 cos_to_last_merge=0.9896 (last merge round=25)
[S3] round=45 local utility u=0.007953 metrics={'f1_val': 0.26111219258970864, 'auprc': 0.26111219258970864, 'loss_val': 2.3463299017074686, 'psi': 0.26111219258970864}-{'f1_val': 0.2586450700604191, 'auprc': 0.2586450700604191, 'loss_val': 2.3400325748589923, 'psi': 0.2586450700604191}
[S4] START round=45 head_norm_before_train=2.217163 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5170741024228502, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5153322817700623, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=2.113902 cos_to_last_merge=0.9974 (last merge round=33)
[S5] round=45 local utility u=0.009622 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2946538975478474, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.313897878961681, 'psi': 0.3335071121394324}
[S6] START round=45 head_norm_before_train=1.818900 cos_to_last_merge=0.9695 (last merge round=34)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.705900721384181, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.632677838869988, 'psi': 0.1017530487804878}
[S7] START round=45 head_norm_before_train=2.253525 cos_to_last_merge=0.9937 (last merge round=26)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3949071513952036, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3806092559356076, 'psi': 0.35976373724718097}
[S8] START round=45 head_norm_before_train=2.301688 cos_to_last_merge=0.9724 (last merge round=19)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2997249247427103, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2787730890132961, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.893173 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7916788392678034, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7786424082169363, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.149250 cos_to_last_merge=0.9891 (last merge round=35)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.2645161290322581, 'auprc': 0.2645161290322581, 'loss_val': 1.3694760156352812, 'psi': 0.2645161290322581}-{'f1_val': 0.2658783139423994, 'auprc': 0.2658783139423994, 'loss_val': 1.3413921027722278, 'psi': 0.2658783139423994}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.953708 cos_to_last_merge=0.9992 (last merge round=34)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.95605474825483, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.939343819317706, 'psi': 0.2803432239470754}
[S13] START round=45 head_norm_before_train=1.956816 (no previous merge yet)
[S13] round=45 local utility u=0.003751 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.08335218228799256, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.09085427226788319, 'psi': 0.9994382441285097}
[S14] START round=45 head_norm_before_train=2.250333 cos_to_last_merge=0.9902 (last merge round=34)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.223072548791397, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.167040123546098, 'psi': 0.13592717296421}
[S15] START round=45 head_norm_before_train=2.359637 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6569071132675008, 'psi': 0.61591610673549}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6306614436074476, 'psi': 0.6153571007984797}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.950132 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.09145319607373713, 'auprc': 0.09145319607373713, 'loss_val': 4.862976040280299, 'psi': 0.09145319607373713}-{'f1_val': 0.1033003300330033, 'auprc': 0.1033003300330033, 'loss_val': 4.324700224794818, 'psi': 0.1033003300330033}
[S17] START round=45 head_norm_before_train=2.239610 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6914023982951112, 'auprc': 0.6914023982951112, 'loss_val': 1.2116982843798474, 'psi': 0.6914023982951112}-{'f1_val': 0.7625621742498601, 'auprc': 0.7625621742498601, 'loss_val': 0.913094710704722, 'psi': 0.7625621742498601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=2.083338 cos_to_last_merge=0.9994 (last merge round=34)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5479717623449667, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5323923763242453, 'psi': 0.3674775928297055}
[S3] START round=46 head_norm_before_train=2.014627 cos_to_last_merge=0.9890 (last merge round=25)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.261366588724344, 'auprc': 0.261366588724344, 'loss_val': 2.352302681510269, 'psi': 0.261366588724344}-{'f1_val': 0.26111219258970864, 'auprc': 0.26111219258970864, 'loss_val': 2.3463299017074686, 'psi': 0.26111219258970864}
[S4] START round=46 head_norm_before_train=2.223905 (no previous merge yet)
[S4] round=46 local utility u=0.005027 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5070200649353174, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5170741024228502, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=46 head_norm_before_train=2.123676 cos_to_last_merge=0.9969 (last merge round=33)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3201991533653654, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.2946538975478474, 'psi': 0.3335071121394324}
[S6] START round=46 head_norm_before_train=1.832513 cos_to_last_merge=0.9680 (last merge round=34)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.770793712612628, 'psi': 0.1017530487804878}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.705900721384181, 'psi': 0.1017530487804878}
[S7] START round=46 head_norm_before_train=2.261664 cos_to_last_merge=0.9933 (last merge round=26)
[S7] round=46 local utility u=0.007882 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3791429014705825, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3949071513952036, 'psi': 0.35976373724718097}
[S8] START round=46 head_norm_before_train=2.306303 cos_to_last_merge=0.9719 (last merge round=19)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3132746018136978, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.2997249247427103, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.898082 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.804606267964694, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7916788392678034, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.164470 cos_to_last_merge=0.9881 (last merge round=35)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.26517024919155413, 'auprc': 0.26517024919155413, 'loss_val': 1.380701647341671, 'psi': 0.26517024919155413}-{'f1_val': 0.2645161290322581, 'auprc': 0.2645161290322581, 'loss_val': 1.3694760156352812, 'psi': 0.2645161290322581}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.960400 cos_to_last_merge=0.9990 (last merge round=34)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9704883301974383, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.95605474825483, 'psi': 0.2803432239470754}
[S13] START round=46 head_norm_before_train=1.963767 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.08621036913428864, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.08335218228799256, 'psi': 0.9994382441285097}
[S14] START round=46 head_norm_before_train=2.257287 cos_to_last_merge=0.9896 (last merge round=34)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.273922979382872, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.223072548791397, 'psi': 0.13592717296421}
[S15] START round=46 head_norm_before_train=2.369707 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6613201998239372, 'psi': 0.6153571007984797}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.6569071132675008, 'psi': 0.61591610673549}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.956300 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.03942089656375371, 'auprc': 0.03942089656375371, 'loss_val': 5.835809075053388, 'psi': 0.03942089656375371}-{'f1_val': 0.09145319607373713, 'auprc': 0.09145319607373713, 'loss_val': 4.862976040280299, 'psi': 0.09145319607373713}
[S17] START round=46 head_norm_before_train=2.248189 (no previous merge yet)
[S17] round=46 local utility u=0.797327 metrics={'f1_val': 0.8163946342098032, 'auprc': 0.8163946342098032, 'loss_val': 0.7419738314068678, 'psi': 0.8163946342098032}-{'f1_val': 0.6914023982951112, 'auprc': 0.6914023982951112, 'loss_val': 1.2116982843798474, 'psi': 0.6914023982951112}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.088728 cos_to_last_merge=0.9994 (last merge round=34)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5646302913433314, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5479717623449667, 'psi': 0.3674775928297055}
[S3] START round=47 head_norm_before_train=2.020751 cos_to_last_merge=0.9885 (last merge round=25)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.25824669490437685, 'auprc': 0.25824669490437685, 'loss_val': 2.381940839046458, 'psi': 0.25824669490437685}-{'f1_val': 0.261366588724344, 'auprc': 0.261366588724344, 'loss_val': 2.352302681510269, 'psi': 0.261366588724344}
[S4] START round=47 head_norm_before_train=2.234817 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5275281542991601, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5070200649353174, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=2.132323 cos_to_last_merge=0.9964 (last merge round=33)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.35807709115496, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3201991533653654, 'psi': 0.3335071121394324}
[S6] START round=47 head_norm_before_train=1.845618 cos_to_last_merge=0.9666 (last merge round=34)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.832481825669449, 'psi': 0.10171428571428572}-{'f1_val': 0.1017530487804878, 'auprc': 0.1017530487804878, 'loss_val': 5.770793712612628, 'psi': 0.1017530487804878}
[S7] START round=47 head_norm_before_train=2.269393 cos_to_last_merge=0.9929 (last merge round=26)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.390498322880596, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3791429014705825, 'psi': 0.35976373724718097}
[S8] START round=47 head_norm_before_train=2.310497 cos_to_last_merge=0.9711 (last merge round=19)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.31473733193486675, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3132746018136978, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.902845 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8192827578335624, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.804606267964694, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.178680 cos_to_last_merge=0.9873 (last merge round=35)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 1.3956923316439906, 'psi': 0.26537216828478966}-{'f1_val': 0.26517024919155413, 'auprc': 0.26517024919155413, 'loss_val': 1.380701647341671, 'psi': 0.26517024919155413}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.966933 cos_to_last_merge=0.9989 (last merge round=34)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9857471493325676, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9704883301974383, 'psi': 0.2803432239470754}
[S13] START round=47 head_norm_before_train=1.974704 (no previous merge yet)
[S13] round=47 local utility u=0.004537 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.07713709811526048, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.08621036913428864, 'psi': 0.9994382441285097}
[S14] START round=47 head_norm_before_train=2.263806 cos_to_last_merge=0.9891 (last merge round=34)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.322396044828153, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.273922979382872, 'psi': 0.13592717296421}
[S15] START round=47 head_norm_before_train=2.379491 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6721907743499413, 'psi': 0.6161950003225232}-{'f1_val': 0.6153571007984797, 'auprc': 0.6153571007984797, 'loss_val': 0.6613201998239372, 'psi': 0.6153571007984797}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.961620 (no previous merge yet)
[S16] round=47 local utility u=1.000000 metrics={'f1_val': 0.1364204336640941, 'auprc': 0.1364204336640941, 'loss_val': 4.6301271679841935, 'psi': 0.1364204336640941}-{'f1_val': 0.03942089656375371, 'auprc': 0.03942089656375371, 'loss_val': 5.835809075053388, 'psi': 0.03942089656375371}
[S17] START round=47 head_norm_before_train=2.258322 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.7102100202429149, 'auprc': 0.7102100202429149, 'loss_val': 1.2012405229601206, 'psi': 0.7102100202429149}-{'f1_val': 0.8163946342098032, 'auprc': 0.8163946342098032, 'loss_val': 0.7419738314068678, 'psi': 0.8163946342098032}
[S13]  timeout peer S16
[S14]  timeout peer S13
[S14]  timeout peer S17
[S5]  timeout peer S3
[S3]  timeout peer S6
[S7]  timeout peer S8
[S16]  timeout peer S4
[S2]  timeout peer S5
[S11]  timeout peer S10
[S17]  timeout peer S14
[S6]  timeout peer S7
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.136)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.094116 cos_to_last_merge=0.9993 (last merge round=34)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.581515324482396, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.5646302913433314, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.026968 cos_to_last_merge=0.9880 (last merge round=25)
[S3] round=48 local utility u=0.007954 metrics={'f1_val': 0.2609090319652467, 'auprc': 0.2609090319652467, 'loss_val': 2.3899946494335684, 'psi': 0.2609090319652467}-{'f1_val': 0.25824669490437685, 'auprc': 0.25824669490437685, 'loss_val': 2.381940839046458, 'psi': 0.25824669490437685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=48 head_norm_before_train=2.241315 (no previous merge yet)
[S4] round=48 local utility u=0.000335 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5268577754081363, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5275281542991601, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=48 head_norm_before_train=2.140151 cos_to_last_merge=0.9960 (last merge round=33)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3915772992291187, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.35807709115496, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.857877 cos_to_last_merge=0.9653 (last merge round=34)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.892336351118343, 'psi': 0.10171428571428572}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.832481825669449, 'psi': 0.10171428571428572}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=2.275314 cos_to_last_merge=0.9926 (last merge round=26)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.4200768358137628, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.390498322880596, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.315741 cos_to_last_merge=0.9707 (last merge round=19)
[S8] round=48 local utility u=0.002515 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3097081149654713, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.31473733193486675, 'psi': 0.9988708350860451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=48 head_norm_before_train=1.907550 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8323170544022735, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8192827578335624, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.191799 cos_to_last_merge=0.9864 (last merge round=35)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.26396515811399357, 'auprc': 0.26396515811399357, 'loss_val': 1.422998670504528, 'psi': 0.26396515811399357}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 1.3956923316439906, 'psi': 0.26537216828478966}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.973299 cos_to_last_merge=0.9988 (last merge round=34)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9999671284659364, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9857471493325676, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.986093 (no previous merge yet)
[S13] round=48 local utility u=0.002088 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.07296049449820248, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.07713709811526048, 'psi': 0.9994382441285097}
[S13] not sending this round → trigger blocked (psi=0.999)
[S14] START round=48 head_norm_before_train=2.269947 cos_to_last_merge=0.9886 (last merge round=34)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.368355124841945, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.322396044828153, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.388533 (no previous merge yet)
[S15] round=48 local utility u=0.003966 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.654196520504439, 'psi': 0.6150769866718802}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6721907743499413, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=48 head_norm_before_train=1.968102 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.10373626373626374, 'auprc': 0.10373626373626374, 'loss_val': 4.404608230093971, 'psi': 0.10373626373626374}-{'f1_val': 0.1364204336640941, 'auprc': 0.1364204336640941, 'loss_val': 4.6301271679841935, 'psi': 0.1364204336640941}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.270427 (no previous merge yet)
[S17] round=48 local utility u=0.379792 metrics={'f1_val': 0.7690144249041556, 'auprc': 0.7690144249041556, 'loss_val': 0.9708954514655399, 'psi': 0.7690144249041556}-{'f1_val': 0.7102100202429149, 'auprc': 0.7102100202429149, 'loss_val': 1.2012405229601206, 'psi': 0.7102100202429149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=49 head_norm_before_train=2.099444 cos_to_last_merge=0.9992 (last merge round=34)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.593906397735396, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.581515324482396, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.033193 cos_to_last_merge=0.9874 (last merge round=25)
[S3] round=49 local utility u=0.002341 metrics={'f1_val': 0.26121389159363845, 'auprc': 0.26121389159363845, 'loss_val': 2.3880570124810148, 'psi': 0.26121389159363845}-{'f1_val': 0.2609090319652467, 'auprc': 0.2609090319652467, 'loss_val': 2.3899946494335684, 'psi': 0.2609090319652467}
[S3] not sending this round → trigger blocked (psi=0.261)
[S4] START round=49 head_norm_before_train=2.252334 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.535087836938982, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5268577754081363, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=2.149362 cos_to_last_merge=0.9954 (last merge round=33)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.4184416564279587, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.3915772992291187, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.869309 cos_to_last_merge=0.9641 (last merge round=34)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.9478906284398, 'psi': 0.10171428571428572}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.892336351118343, 'psi': 0.10171428571428572}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=2.282540 cos_to_last_merge=0.9924 (last merge round=26)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.4403241937009654, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.4200768358137628, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.325171 cos_to_last_merge=0.9704 (last merge round=19)
[S8] round=49 local utility u=0.000456 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.30879651655283313, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.3097081149654713, 'psi': 0.9988708350860451}
[S8] not sending this round → trigger blocked (psi=0.999)
[S9] START round=49 head_norm_before_train=1.912110 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8450290826617417, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8323170544022735, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.204572 cos_to_last_merge=0.9856 (last merge round=35)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.2621286197818729, 'auprc': 0.2621286197818729, 'loss_val': 1.44525111364037, 'psi': 0.2621286197818729}-{'f1_val': 0.26396515811399357, 'auprc': 0.26396515811399357, 'loss_val': 1.422998670504528, 'psi': 0.26396515811399357}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.979479 cos_to_last_merge=0.9986 (last merge round=34)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 3.01098197795577, 'psi': 0.2803432239470754}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.9999671284659364, 'psi': 0.2803432239470754}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.998797 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.07296637631301693, 'psi': 0.9994382441285097}-{'f1_val': 0.9994382441285097, 'auprc': 0.9994382441285097, 'loss_val': 0.07296049449820248, 'psi': 0.9994382441285097}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.275754 cos_to_last_merge=0.9881 (last merge round=34)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.411385142928075, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.368355124841945, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.397791 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6962713930390727, 'psi': 0.6163342951580373}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.654196520504439, 'psi': 0.6150769866718802}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.973997 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.01769591910436981, 'auprc': 0.01769591910436981, 'loss_val': 5.821549475971261, 'psi': 0.01769591910436981}-{'f1_val': 0.10373626373626374, 'auprc': 0.10373626373626374, 'loss_val': 4.404608230093971, 'psi': 0.10373626373626374}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.283365 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.7080352266180723, 'auprc': 0.7080352266180723, 'loss_val': 1.2465198178618275, 'psi': 0.7080352266180723}-{'f1_val': 0.7690144249041556, 'auprc': 0.7690144249041556, 'loss_val': 0.9708954514655399, 'psi': 0.7690144249041556}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
