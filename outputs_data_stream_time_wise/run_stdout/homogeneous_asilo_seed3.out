[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:63503
[S3] → join 127.0.0.1:63502
[S4] → join 127.0.0.1:63502
[S5] → join 127.0.0.1:63502
[S6] → join 127.0.0.1:63502
[S7] → join 127.0.0.1:63502
[S8] → join 127.0.0.1:63502
[S9] → join 127.0.0.1:63502
[S10] → join 127.0.0.1:63502
[S11] → join 127.0.0.1:63502
[S13] → join 127.0.0.1:63502
[S14] → join 127.0.0.1:63502
[S15] → join 127.0.0.1:63502
[S16] → join 127.0.0.1:63502
[S17] → join 127.0.0.1:63502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.156365 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.128209 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.155413 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.189804 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.180737 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.140124 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.148803 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.168779 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.187959 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.128919 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.189915 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.177204 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.197860 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.162072 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.137570 (no previous merge yet)
[S3]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S6
[S4] + discovered S2
[S3] + discovered S15
[S3] + discovered S8
[S3] + discovered S10
[S3] + discovered S4
[S3] + discovered S16
[S3] + discovered S13
[S3] + discovered S14
[S3] + discovered S7
[S3] + discovered S5
[S3] + discovered S9
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S6
[S4] + discovered S9
[S4] + discovered S15
[S4] + discovered S13
[S4] + discovered S17
[S4] + discovered S16
[S4] + discovered S5
[S4] + discovered S8
[S5] + discovered S3
[S5] + discovered S11
[S5] + discovered S7
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S10
[S5] + discovered S8
[S5] + discovered S13
[S6] + discovered S2
[S6] + discovered S5
[S5] + discovered S9
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S14
[S6] + discovered S9
[S7] + discovered S4
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S16
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S13
[S6] + discovered S10
[S7] + discovered S2
[S6] + discovered S7
[S7] + discovered S8
[S7] + discovered S9
[S7] + discovered S15
[S8] + discovered S7
[S8] + discovered S2
[S7] + discovered S13
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S4
[S7] + discovered S10
[S7] + discovered S17
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S11
[S9] + discovered S8
[S8] + discovered S9
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S7
[S8] + discovered S17
[S8] + discovered S10
[S9] + discovered S4
[S9] + discovered S3
[S8] + discovered S11
[S8] + discovered S15
[S8] + discovered S14
[S8] + discovered S13
[S9] + discovered S6
[S8] + discovered S16
[S9] + discovered S13
[S9] + discovered S14
[S10] + discovered S5
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S15
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S8
[S9] + discovered S10
[S9] + discovered S17
[S11] + discovered S8
[S10] + discovered S13
[S10] + discovered S14
[S11] + discovered S10
[S10] + discovered S16
[S10] + discovered S15
[S11] + discovered S5
[S10] + discovered S11
[S11] + discovered S6
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S9
[S10] + discovered S17
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S15
[S13] + discovered S6
[S13] + discovered S9
[S13] + discovered S7
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S10
[S13] + discovered S2
[S11] + discovered S17
[S13] + discovered S5
[S11] + discovered S16
[S13] + discovered S8
[S13] + discovered S3
[S13] + discovered S16
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S4
[S14] + discovered S9
[S13] + discovered S14
[S13] + discovered S17
[S14] + discovered S2
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S11
[S14] + discovered S8
[S13] + discovered S15
[S14] + discovered S10
[S14] + discovered S13
[S15] + discovered S8
[S14] + discovered S17
[S14] + discovered S15
[S15] + discovered S6
[S15] + discovered S4
[S15] + discovered S10
[S15] + discovered S5
[S15] + discovered S7
[S14] + discovered S16
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S3
[S16] + discovered S7
[S16] + discovered S15
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S9
[S16] + discovered S8
[S16] + discovered S2
[S16] + discovered S13
[S16] + discovered S14
[S15] + discovered S16
[S16] + discovered S5
[S16] + discovered S6
[S16] + discovered S3
[S15] + discovered S17
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S3
[S17] + discovered S2
[S17] + discovered S9
[S17] + discovered S14
[S17] + discovered S4
[S17] + discovered S11
[S16] + discovered S17
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S8
[S17] + discovered S15
[S17] + discovered S6
[S17] + discovered S7
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S10] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S4] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S5] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:63516
[S15] ⇄ pheromone p=1.000 → S4@127.0.0.1:63504
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:63507
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:63517
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:63515
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:63508
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:63505
[S2] ⇄ pheromone p=1.000 → S14@127.0.0.1:63514
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:63509
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:63513
[S2] START round=1 head_norm_before_train=1.164832 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.532539700242585, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4434513815728276, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.136542 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.574075217688658, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.498274716153033, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.160307 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.475835883032367, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4485160027002888, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.195120 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4917517450753648, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4324098046741771, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.187490 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6058423116604525, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5037634883817068, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.145175 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.27275012569130214, 'auprc': 0.27275012569130214, 'loss_val': 1.397090821894121, 'psi': 0.27275012569130214}-{'f1_val': 0.3329084342468664, 'auprc': 0.3329084342468664, 'loss_val': 1.3477694423559845, 'psi': 0.3329084342468664}
[S8] START round=1 head_norm_before_train=1.155513 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4282285459110902, 'psi': 0.0}-{'f1_val': 0.1387828881301466, 'auprc': 0.1387828881301466, 'loss_val': 1.3881155689060698, 'psi': 0.1387828881301466}
[S9] START round=1 head_norm_before_train=1.162113 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4632600556479154, 'psi': 0.0}-{'f1_val': 0.18841451192623773, 'auprc': 0.18841451192623773, 'loss_val': 1.3817938574827278, 'psi': 0.18841451192623773}
[S10] START round=1 head_norm_before_train=1.194526 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.561152481975398, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.487609393955009, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.129937 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5116658833745014, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.442730896236077, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.188395 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4929279242949494, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4460238169277293, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.185094 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.563401633347802, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.46351929440523, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.206147 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.452648435887896, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3830584302346207, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.174770 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6372094017597194, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.506812427423878, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.143815 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4370098403496114, 'psi': 0.0}-{'f1_val': 0.3604547877065198, 'auprc': 0.3604547877065198, 'loss_val': 1.3898131541539447, 'psi': 0.3604547877065198}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.182714 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.739791812647556, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.532539700242585, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.157314 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7120707965097457, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.574075217688658, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.175405 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5182757780028087, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.475835883032367, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.209376 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6061085332071983, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4917517450753648, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.206732 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8071151819282252, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6058423116604525, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.161967 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4934607758865412, 'psi': 0.0}-{'f1_val': 0.27275012569130214, 'auprc': 0.27275012569130214, 'loss_val': 1.397090821894121, 'psi': 0.27275012569130214}
[S8] START round=2 head_norm_before_train=1.170586 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5104120095652713, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4282285459110902, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.169141 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6090668231733418, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4632600556479154, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.210962 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6920422786471898, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.561152481975398, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.144384 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.636238685267469, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5116658833745014, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.201249 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5736494365341236, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4929279242949494, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.204749 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.779028931127046, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.563401633347802, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.222968 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5684704953061814, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.452648435887896, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.199404 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9512262076709492, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6372094017597194, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.159802 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5483207177661846, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4370098403496114, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.208972 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.234146085634169, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.739791812647556, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.189394 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0770705491291603, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7120707965097457, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.200250 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5971852523374737, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5182757780028087, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.232640 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8419116807053035, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6061085332071983, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.238349 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3425651992701875, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8071151819282252, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.189683 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7478483506494538, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4934607758865412, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.193972 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7254991704012081, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5104120095652713, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.190228 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9871545215787758, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6090668231733418, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.234877 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9291649956602153, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6920422786471898, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.169607 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9476039243058763, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.636238685267469, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.224936 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7657021604927878, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5736494365341236, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.234863 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.424451324557587, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.779028931127046, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.246402 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8435481164913345, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5684704953061814, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.235539 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.638176838573272, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9512262076709492, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.187214 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8599240301539997, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5483207177661846, 'psi': 0.0}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.241115 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.912209155795412, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.234146085634169, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.231140 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.754078605361843, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0770705491291603, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.236301 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7566631209397674, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5971852523374737, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.262360 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.904646016905232, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8419116807053035, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.278668 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8510785840611343, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3425651992701875, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.221410 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8971287187900563, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7478483506494538, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.222569 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.825258658595242, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7254991704012081, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.222401 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7336027028423, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9871545215787758, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.262222 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0790742241295477, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9291649956602153, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.203618 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.593511041564812, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9476039243058763, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.253591 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7966523706574902, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7657021604927878, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.273851 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0683195379713952, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.424451324557587, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.277271 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.015384626940858, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8435481164913345, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.268016 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3147736764447138, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.638176838573272, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.221776 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8672628666586841, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8599240301539997, 'psi': 0.0}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.272737 (no previous merge yet)
[S2] round=5 local utility u=0.098666 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7148762971130136, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.912209155795412, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.269442 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.817072819316582, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.754078605361843, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.275065 (no previous merge yet)
[S4] round=5 local utility u=1.000000 metrics={'f1_val': 0.2369557992688601, 'auprc': 0.2369557992688601, 'loss_val': 1.6415433399419934, 'psi': 0.23695579926886007}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7566631209397674, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.277384 (no previous merge yet)
[S5] round=5 local utility u=0.094530 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7155851221506446, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.904646016905232, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.311705 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0255620680584348, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8510785840611343, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.237131 (no previous merge yet)
[S7] round=5 local utility u=0.025002 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8471240732659566, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8971287187900563, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.238189 (no previous merge yet)
[S8] round=5 local utility u=0.087557 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6501437784687603, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.825258658595242, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.259090 (no previous merge yet)
[S9] round=5 local utility u=0.072904 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.587794154825623, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7336027028423, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.282671 (no previous merge yet)
[S10] round=5 local utility u=0.094166 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8907415326349644, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0790742241295477, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.239334 (no previous merge yet)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6168914507953747, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.593511041564812, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.265697 (no previous merge yet)
[S13] round=5 local utility u=0.075364 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6459236691734853, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7966523706574902, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.304183 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.281819248654068, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0683195379713952, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.296967 (no previous merge yet)
[S15] round=5 local utility u=0.094187 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8270102424282175, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.015384626940858, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.291860 (no previous merge yet)
[S16] round=5 local utility u=0.134190 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.046392882871599, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3147736764447138, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.238910 (no previous merge yet)
[S17] round=5 local utility u=0.111138 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.644986517905752, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8672628666586841, 'psi': 0.0}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:63516
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S4] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S4
[S16] cosine check vs S4: cos=0.0748
[S17] not sending this round → trigger blocked (psi=0.000)
[S13] ⇄ pheromone p=0.343 → S8@127.0.0.1:63509
[S5] ⇄ pheromone p=0.347 → S15@127.0.0.1:63515
[S8] ⇄ pheromone p=0.345 → S15@127.0.0.1:63515
[S10] ⇄ pheromone p=0.347 → S17@127.0.0.1:63517
[S3] ⇄ pheromone p=0.328 → S6@127.0.0.1:63507
[S7] ⇄ pheromone p=0.333 → S17@127.0.0.1:63517
[S14] ⇄ pheromone p=0.328 → S8@127.0.0.1:63509
[S11] ⇄ pheromone p=0.328 → S5@127.0.0.1:63505
[S9] ⇄ pheromone p=0.342 → S16@127.0.0.1:63516
[S2] ⇄ pheromone p=0.347 → S14@127.0.0.1:63514
[S6] ⇄ pheromone p=0.328 → S15@127.0.0.1:63515
[S15] ⇄ pheromone p=0.347 → S4@127.0.0.1:63504
[S4] ⇄ pheromone p=0.528 → S16@127.0.0.1:63516
[S17] ⇄ pheromone p=0.350 → S13@127.0.0.1:63513
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.0000 head_norm=1.302892
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.839449e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.0000 head_norm=0.952778 delta_norm=0.883945
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.355 → S7@127.0.0.1:63508
[S2] START round=6 head_norm_before_train=1.288762 (no previous merge yet)
[S2] round=6 local utility u=0.005084 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7047091481832606, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7148762971130136, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.293439 (no previous merge yet)
[S3] round=6 local utility u=0.105725 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6056234440481285, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.817072819316582, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.296443 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.11540330417881438, 'auprc': 0.11540330417881438, 'loss_val': 1.4682180944964136, 'psi': 0.11540330417881438}-{'f1_val': 0.2369557992688601, 'auprc': 0.2369557992688601, 'loss_val': 1.6415433399419934, 'psi': 0.23695579926886007}
[S5] START round=6 head_norm_before_train=1.276568 (no previous merge yet)
[S5] round=6 local utility u=0.033421 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6487425315075808, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7155851221506446, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.341128 (no previous merge yet)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5044676693768895, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0255620680584348, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.243929 (no previous merge yet)
[S7] round=6 local utility u=1.000000 metrics={'f1_val': 0.27555222763010107, 'auprc': 0.27555222763010107, 'loss_val': 1.8988868257590004, 'psi': 0.27555222763010107}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8471240732659566, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.243718 (no previous merge yet)
[S8] round=6 local utility u=0.050628 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.548887104153632, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6501437784687603, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.278277 (no previous merge yet)
[S9] round=6 local utility u=0.061042 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.465709894656394, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.587794154825623, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.294989 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8962318619170468, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8907415326349644, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.264102 (no previous merge yet)
[S11] round=6 local utility u=0.054032 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.508827661655433, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6168914507953747, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.267347 (no previous merge yet)
[S13] round=6 local utility u=0.053194 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.539536511355886, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6459236691734853, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.329681 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5293627965166876, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.281819248654068, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.304066 (no previous merge yet)
[S15] round=6 local utility u=0.070729 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6855522602979762, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8270102424282175, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=0.952778 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.402727 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2409397155259962, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.046392882871599, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.249461 (no previous merge yet)
[S17] round=6 local utility u=0.029264 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5864588609498584, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.644986517905752, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:63517
[S5] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S7] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] cosine check vs S7: cos=0.0363
[S17] not sending this round → trigger blocked (psi=0.000)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.0000 head_norm=1.273235
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.786883e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.0000 head_norm=0.911212 delta_norm=0.878688
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.313567 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.140131262100146, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7047091481832606, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.316860 (no previous merge yet)
[S3] round=7 local utility u=0.037114 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.531396290860454, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6056234440481285, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.308125 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.000281135788585887, 'auprc': 0.000281135788585887, 'loss_val': 1.3971930186220705, 'psi': 0.000281135788585887}-{'f1_val': 0.11540330417881438, 'auprc': 0.11540330417881438, 'loss_val': 1.4682180944964136, 'psi': 0.11540330417881438}
[S5] START round=7 head_norm_before_train=1.285792 (no previous merge yet)
[S5] round=7 local utility u=0.003257 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6422284288012543, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6487425315075808, 'psi': 0.0}
[S6] START round=7 head_norm_before_train=1.373811 (no previous merge yet)
[S6] round=7 local utility u=0.178825 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1468177043836127, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5044676693768895, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.258441 (no previous merge yet)
[S7] round=7 local utility u=0.329866 metrics={'f1_val': 0.33312074829931976, 'auprc': 0.33312074829931976, 'loss_val': 1.7572707745079383, 'psi': 0.33312074829931976}-{'f1_val': 0.27555222763010107, 'auprc': 0.27555222763010107, 'loss_val': 1.8988868257590004, 'psi': 0.27555222763010107}
[S8] START round=7 head_norm_before_train=1.256683 (no previous merge yet)
[S8] round=7 local utility u=1.000000 metrics={'f1_val': 0.218091697645601, 'auprc': 0.218091697645601, 'loss_val': 1.4996054219881345, 'psi': 0.218091697645601}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.548887104153632, 'psi': 0.0}
[S9] START round=7 head_norm_before_train=1.303437 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.953061429092657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.465709894656394, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.317193 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2621413183240815, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8962318619170468, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.290289 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.526389476966751, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.508827661655433, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.274115 (no previous merge yet)
[S13] round=7 local utility u=0.009294 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5209482839161768, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.539536511355886, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.354510 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7551274120661016, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5293627965166876, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.313624 (no previous merge yet)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7095292722325819, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6855522602979762, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=0.969147 cos_to_last_merge=0.9980 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.586451276907606, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2409397155259962, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=0.911212 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.060774 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.464911444340213, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5864588609498584, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:63517
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63515
[S5] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=0.1036
[S17] RECEIVED delta(kind=head bytes=1796) from S7
[S17] cosine check vs S7: cos=0.6939
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.0000 head_norm=1.334962
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.761557e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.0000 head_norm=0.972077 delta_norm=0.876156
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.0000 head_norm=0.942448
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.573257e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.0211 head_norm=1.018749 delta_norm=0.457326
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.344886 (no previous merge yet)
[S2] round=8 local utility u=0.007061 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1260098743739704, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.140131262100146, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.346781 (no previous merge yet)
[S3] round=8 local utility u=0.001435 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5285257116534754, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.531396290860454, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.337893 (no previous merge yet)
[S4] round=8 local utility u=0.028649 metrics={'f1_val': 0.0005621135469364812, 'auprc': 0.0005621135469364812, 'loss_val': 1.3424244368133285, 'psi': 0.0005621135469364812}-{'f1_val': 0.000281135788585887, 'auprc': 0.000281135788585887, 'loss_val': 1.3971930186220705, 'psi': 0.000281135788585887}
[S5] START round=8 head_norm_before_train=1.305773 (no previous merge yet)
[S5] round=8 local utility u=0.062161 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5179065359295378, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6422284288012543, 'psi': 0.0}
[S6] START round=8 head_norm_before_train=1.401535 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.579082617178583, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1468177043836127, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.267195 (no previous merge yet)
[S7] round=8 local utility u=0.036227 metrics={'f1_val': 0.3330145574327914, 'auprc': 0.3330145574327914, 'loss_val': 1.6838603353293493, 'psi': 0.3330145574327914}-{'f1_val': 0.33312074829931976, 'auprc': 0.33312074829931976, 'loss_val': 1.7572707745079383, 'psi': 0.33312074829931976}
[S8] START round=8 head_norm_before_train=1.281813 (no previous merge yet)
[S8] round=8 local utility u=0.051798 metrics={'f1_val': 0.2127888956269793, 'auprc': 0.2127888956269793, 'loss_val': 1.3482840889450496, 'psi': 0.2127888956269793}-{'f1_val': 0.218091697645601, 'auprc': 0.218091697645601, 'loss_val': 1.4996054219881345, 'psi': 0.218091697645601}
[S9] START round=8 head_norm_before_train=1.335152 (no previous merge yet)
[S9] round=8 local utility u=0.081558 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.789946377316967, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.953061429092657, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.348383 (no previous merge yet)
[S10] round=8 local utility u=0.695846 metrics={'f1_val': 0.1715773281268489, 'auprc': 0.1715773281268489, 'loss_val': 2.414645914965787, 'psi': 0.1715773281268489}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2621413183240815, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.322693 (no previous merge yet)
[S11] round=8 local utility u=0.060618 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4051526063264776, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.526389476966751, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.289471 (no previous merge yet)
[S13] round=8 local utility u=0.024182 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4725846725599148, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5209482839161768, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.377039 (no previous merge yet)
[S14] round=8 local utility u=0.031184 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6927594857729242, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7551274120661016, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=0.972077 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7553748504895652, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7095292722325819, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=0.998136 cos_to_last_merge=0.9931 (last merge round=5)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8982370075001636, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.586451276907606, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.018749 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=1.000000 metrics={'f1_val': 0.24037028320389112, 'auprc': 0.24037028320389112, 'loss_val': 1.3853159940556226, 'psi': 0.24037028320389112}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.464911444340213, 'psi': 0.0}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.172)
[S11] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:63517
[S4] not sending this round → trigger blocked (psi=0.001)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63515
[S5] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.7147
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=0.9202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S17
[S13] cosine check vs S17: cos=-0.0413
[S13] DROPPED delta from S17 (cos=-0.0413 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.0000 head_norm=1.002753
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.579653e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.0000 head_norm=1.070287 delta_norm=0.457965
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.2404 head_norm=1.045161
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.588436e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.2173 head_norm=1.138919 delta_norm=0.258844
[S17] aggregate: ROLLBACK (f1_val pre=0.240 post=0.217 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.377675 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.410990927574451, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1260098743739704, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.380659 (no previous merge yet)
[S3] round=9 local utility u=0.138025 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.252474974670195, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5285257116534754, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.375141 (no previous merge yet)
[S4] round=9 local utility u=0.015672 metrics={'f1_val': 0.0001887504718761797, 'auprc': 0.0001887504718761797, 'loss_val': 1.3077205568058934, 'psi': 0.0001887504718761797}-{'f1_val': 0.0005621135469364812, 'auprc': 0.0005621135469364812, 'loss_val': 1.3424244368133285, 'psi': 0.0005621135469364812}
[S5] START round=9 head_norm_before_train=1.321045 (no previous merge yet)
[S5] round=9 local utility u=0.708030 metrics={'f1_val': 0.14302017276562257, 'auprc': 0.14302017276562257, 'loss_val': 1.389027942339821, 'psi': 0.14302017276562257}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5179065359295378, 'psi': 0.0}
[S6] START round=9 head_norm_before_train=1.432393 (no previous merge yet)
[S6] round=9 local utility u=0.181940 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2152023707292336, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.579082617178583, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.279027 (no previous merge yet)
[S7] round=9 local utility u=0.000557 metrics={'f1_val': 0.3330145574327914, 'auprc': 0.3330145574327914, 'loss_val': 1.682746661460279, 'psi': 0.3330145574327914}-{'f1_val': 0.3330145574327914, 'auprc': 0.3330145574327914, 'loss_val': 1.6838603353293493, 'psi': 0.3330145574327914}
[S8] START round=9 head_norm_before_train=1.305748 (no previous merge yet)
[S8] round=9 local utility u=0.353236 metrics={'f1_val': 0.28262733209821306, 'auprc': 0.28262733209821306, 'loss_val': 1.2703588937350194, 'psi': 0.28262733209821306}-{'f1_val': 0.2127888956269793, 'auprc': 0.2127888956269793, 'loss_val': 1.3482840889450496, 'psi': 0.2127888956269793}
[S9] START round=9 head_norm_before_train=1.364877 (no previous merge yet)
[S9] round=9 local utility u=0.173124 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4436981781760228, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.789946377316967, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.377553 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.17565891472868217, 'auprc': 0.17565891472868217, 'loss_val': 2.844932615657353, 'psi': 0.17565891472868217}-{'f1_val': 0.1715773281268489, 'auprc': 0.1715773281268489, 'loss_val': 2.414645914965787, 'psi': 0.1715773281268489}
[S11] START round=9 head_norm_before_train=1.361402 (no previous merge yet)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6600694221877315, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4051526063264776, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.306224 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.23009229448379478, 'auprc': 0.23009229448379478, 'loss_val': 1.348425853091479, 'psi': 0.23009229448379478}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4725846725599148, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.402182 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.493264255804332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.6927594857729242, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.070287 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.093227 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5689215359318838, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7553748504895652, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.032122 cos_to_last_merge=0.9857 (last merge round=5)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.031841833006692, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8982370075001636, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.138919 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.20892346565596118, 'auprc': 0.20892346565596118, 'loss_val': 1.3295712287230719, 'psi': 0.20892346565596118}-{'f1_val': 0.24037028320389112, 'auprc': 0.24037028320389112, 'loss_val': 1.3853159940556226, 'psi': 0.24037028320389112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:63517
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:63509
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63515
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.143)
[S3] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.9284
[S8] RECEIVED delta(kind=head bytes=1793) from S13
[S8] cosine check vs S13: cos=-0.0233
[S8] DROPPED delta from S13 (cos=-0.0233 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] cosine check vs S7: cos=0.9652
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.0000 head_norm=1.094391
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.592212e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.194252 delta_norm=0.259221
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.2089 head_norm=1.163992
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.751004e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.2032 head_norm=1.219730 delta_norm=0.175100
[S17] aggregate: ROLLBACK (f1_val pre=0.209 post=0.203 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.412717 (no previous merge yet)
[S2] round=10 local utility u=0.044874 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.321242684654328, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.410990927574451, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.415555 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.574354183607796, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.252474974670195, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.411182 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3097013452246686, 'psi': 0.0}-{'f1_val': 0.0001887504718761797, 'auprc': 0.0001887504718761797, 'loss_val': 1.3077205568058934, 'psi': 0.0001887504718761797}
[S5] START round=10 head_norm_before_train=1.331820 (no previous merge yet)
[S5] round=10 local utility u=0.568017 metrics={'f1_val': 0.26143052897331726, 'auprc': 0.26143052897331726, 'loss_val': 1.3186865358354682, 'psi': 0.26143052897331726}-{'f1_val': 0.14302017276562257, 'auprc': 0.14302017276562257, 'loss_val': 1.389027942339821, 'psi': 0.14302017276562257}
[S6] START round=10 head_norm_before_train=1.460643 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.023711810305517556, 'auprc': 0.023711810305517556, 'loss_val': 3.474369670910484, 'psi': 0.023711810305517556}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2152023707292336, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.296891 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.24976076555023924, 'auprc': 0.24976076555023924, 'loss_val': 1.5390108263962423, 'psi': 0.24976076555023924}-{'f1_val': 0.3330145574327914, 'auprc': 0.3330145574327914, 'loss_val': 1.682746661460279, 'psi': 0.3330145574327914}
[S8] START round=10 head_norm_before_train=1.337600 (no previous merge yet)
[S8] round=10 local utility u=0.825317 metrics={'f1_val': 0.4598495703047948, 'auprc': 0.4598495703047948, 'loss_val': 1.2147247525508371, 'psi': 0.4598495703047948}-{'f1_val': 0.28262733209821306, 'auprc': 0.28262733209821306, 'loss_val': 1.2703588937350194, 'psi': 0.28262733209821306}
[S9] START round=10 head_norm_before_train=1.396743 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.587923192686734, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4436981781760228, 'psi': 0.0}
[S10] START round=10 head_norm_before_train=1.412301 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.1350314026517795, 'auprc': 0.1350314026517795, 'loss_val': 3.1121308337064586, 'psi': 0.1350314026517795}-{'f1_val': 0.17565891472868217, 'auprc': 0.17565891472868217, 'loss_val': 2.844932615657353, 'psi': 0.17565891472868217}
[S11] START round=10 head_norm_before_train=1.402055 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7252005508624637, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6600694221877315, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.319195 (no previous merge yet)
[S13] round=10 local utility u=0.372296 metrics={'f1_val': 0.30322523005449836, 'auprc': 0.30322523005449836, 'loss_val': 1.262031165436556, 'psi': 0.30322523005449836}-{'f1_val': 0.23009229448379478, 'auprc': 0.23009229448379478, 'loss_val': 1.348425853091479, 'psi': 0.23009229448379478}
[S14] START round=10 head_norm_before_train=1.431103 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.021512477762516, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.493264255804332, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.194252 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.461594 metrics={'f1_val': 0.083299305839118, 'auprc': 0.083299305839118, 'loss_val': 1.3954273900160423, 'psi': 0.083299305839118}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5689215359318838, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.067066 cos_to_last_merge=0.9761 (last merge round=5)
[S16] round=10 local utility u=0.012404 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0070342178711247, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.031841833006692, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.219730 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.2031684448755254, 'auprc': 0.2031684448755254, 'loss_val': 1.307792821159203, 'psi': 0.2031684448755254}-{'f1_val': 0.20892346565596118, 'auprc': 0.20892346565596118, 'loss_val': 1.3295712287230719, 'psi': 0.20892346565596118}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.083)
[S2] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:63509
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:63515
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S5
[S15] cosine check vs S5: cos=-0.1053
[S15] DROPPED delta from S5 (cos=-0.1053 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.9707
[S8] RECEIVED delta(kind=head bytes=1799) from S13
[S8] cosine check vs S13: cos=-0.0239
[S8] DROPPED delta from S13 (cos=-0.0239 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.142 → S6@127.0.0.1:63507
[S10] ⇄ pheromone p=0.203 → S17@127.0.0.1:63517
[S14] ⇄ pheromone p=0.111 → S8@127.0.0.1:63509
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.0833 head_norm=1.220420
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.734152e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.0878 head_norm=1.285421 delta_norm=0.173415
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.227 → S4@127.0.0.1:63504
[S6] ⇄ pheromone p=0.155 → S15@127.0.0.1:63515
[S9] ⇄ pheromone p=0.155 → S16@127.0.0.1:63516
[S4] ⇄ pheromone p=0.179 → S16@127.0.0.1:63516
[S7] ⇄ pheromone p=0.229 → S17@127.0.0.1:63517
[S11] ⇄ pheromone p=0.120 → S5@127.0.0.1:63505
[S2] ⇄ pheromone p=0.124 → S14@127.0.0.1:63514
[S5] ⇄ pheromone p=0.351 → S15@127.0.0.1:63515
[S8] ⇄ pheromone p=0.448 → S15@127.0.0.1:63515
[S13] ⇄ pheromone p=0.355 → S8@127.0.0.1:63509
[S17] ⇄ pheromone p=0.251 → S13@127.0.0.1:63513
[S16] ⇄ pheromone p=0.152 → S7@127.0.0.1:63508
[S2] START round=11 head_norm_before_train=1.448071 (no previous merge yet)
[S2] round=11 local utility u=1.000000 metrics={'f1_val': 0.21479982006297796, 'auprc': 0.21479982006297796, 'loss_val': 3.0516987048460873, 'psi': 0.21479982006297796}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.321242684654328, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.449158 (no previous merge yet)
[S3] round=11 local utility u=0.085908 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4025379724546547, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.574354183607796, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.449658 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3161494011814028, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3097013452246686, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.352256 (no previous merge yet)
[S5] round=11 local utility u=0.473857 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2521470869021414, 'psi': 0.35933890172383154}-{'f1_val': 0.26143052897331726, 'auprc': 0.26143052897331726, 'loss_val': 1.3186865358354682, 'psi': 0.26143052897331726}
[S6] START round=11 head_norm_before_train=1.493967 (no previous merge yet)
[S6] round=11 local utility u=0.231584 metrics={'f1_val': 0.06659751037344398, 'auprc': 0.06659751037344398, 'loss_val': 3.3971719838633843, 'psi': 0.06659751037344398}-{'f1_val': 0.023711810305517556, 'auprc': 0.023711810305517556, 'loss_val': 3.474369670910484, 'psi': 0.023711810305517556}
[S7] START round=11 head_norm_before_train=1.310403 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4950171016425775, 'psi': 0.0}-{'f1_val': 0.24976076555023924, 'auprc': 0.24976076555023924, 'loss_val': 1.5390108263962423, 'psi': 0.24976076555023924}
[S8] START round=11 head_norm_before_train=1.369429 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1902859536621186, 'psi': 0.30506182380216385}-{'f1_val': 0.4598495703047948, 'auprc': 0.4598495703047948, 'loss_val': 1.2147247525508371, 'psi': 0.4598495703047948}
[S9] START round=11 head_norm_before_train=1.427524 (no previous merge yet)
[S9] round=11 local utility u=0.183826 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.220270550640155, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.587923192686734, 'psi': 0.0}
[S10] START round=11 head_norm_before_train=1.448014 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.12815499466761465, 'auprc': 0.12815499466761465, 'loss_val': 3.206384273893429, 'psi': 0.12815499466761465}-{'f1_val': 0.1350314026517795, 'auprc': 0.1350314026517795, 'loss_val': 3.1121308337064586, 'psi': 0.1350314026517795}
[S11] START round=11 head_norm_before_train=1.435602 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.167285100257694, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7252005508624637, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.336463 (no previous merge yet)
[S13] round=11 local utility u=0.149074 metrics={'f1_val': 0.33044053227539466, 'auprc': 0.33044053227539466, 'loss_val': 1.2088210642577062, 'psi': 0.33044053227539466}-{'f1_val': 0.30322523005449836, 'auprc': 0.30322523005449836, 'loss_val': 1.262031165436556, 'psi': 0.30322523005449836}
[S14] START round=11 head_norm_before_train=1.464664 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.551340183924269, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.021512477762516, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.285421 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=1.000000 metrics={'f1_val': 0.3537545495795561, 'auprc': 0.3537545495795561, 'loss_val': 1.3192357315153005, 'psi': 0.3537545495795561}-{'f1_val': 0.083299305839118, 'auprc': 0.083299305839118, 'loss_val': 1.3954273900160423, 'psi': 0.083299305839118}
[S16] START round=11 head_norm_before_train=1.103746 cos_to_last_merge=0.9641 (last merge round=5)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0294372867311115, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0070342178711247, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.246809 cos_to_last_merge=0.9952 (last merge round=9)
[S17] round=11 local utility u=0.006755 metrics={'f1_val': 0.20320786444185746, 'auprc': 0.20320786444185746, 'loss_val': 1.294636597996239, 'psi': 0.20320786444185746}-{'f1_val': 0.2031684448755254, 'auprc': 0.2031684448755254, 'loss_val': 1.307792821159203, 'psi': 0.2031684448755254}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:63514
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63509
[S6] not sending this round → trigger blocked (psi=0.067)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:63504
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=-0.1042
[S15] DROPPED delta from S5 (cos=-0.1042 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S2
[S14] cosine check vs S2: cos=0.0490
[S8] RECEIVED delta(kind=head bytes=1798) from S13
[S8] cosine check vs S13: cos=-0.0235
[S8] DROPPED delta from S13 (cos=-0.0235 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S15
[S4] cosine check vs S15: cos=0.0244
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=-0.0336
[S13] DROPPED delta from S17 (cos=-0.0336 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.0000 head_norm=1.492493
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.025417e+00
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.076934 delta_norm=1.025417
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.0000 head_norm=1.487076
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.800660e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.1930 head_norm=1.004056 delta_norm=0.980066
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.481552 (no previous merge yet)
[S2] round=12 local utility u=0.016522 metrics={'f1_val': 0.2014036747890545, 'auprc': 0.2014036747890545, 'loss_val': 2.8980894707365716, 'psi': 0.2014036747890545}-{'f1_val': 0.21479982006297796, 'auprc': 0.21479982006297796, 'loss_val': 3.0516987048460873, 'psi': 0.21479982006297796}
[S3] START round=12 head_norm_before_train=1.478976 (no previous merge yet)
[S3] round=12 local utility u=0.115924 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.170690045642517, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4025379724546547, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.004056 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.009047 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2980556831545513, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3161494011814028, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.374182 (no previous merge yet)
[S5] round=12 local utility u=0.020319 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.211508187451949, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2521470869021414, 'psi': 0.35933890172383154}
[S6] START round=12 head_norm_before_train=1.528052 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.04007045354469397, 'auprc': 0.04007045354469397, 'loss_val': 4.1779447979161874, 'psi': 0.04007045354469397}-{'f1_val': 0.06659751037344398, 'auprc': 0.06659751037344398, 'loss_val': 3.3971719838633843, 'psi': 0.06659751037344398}
[S7] START round=12 head_norm_before_train=1.328610 (no previous merge yet)
[S7] round=12 local utility u=0.027578 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4398605615640434, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4950171016425775, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.404316 (no previous merge yet)
[S8] round=12 local utility u=0.009228 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1718292200837874, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1902859536621186, 'psi': 0.30506182380216385}
[S9] START round=12 head_norm_before_train=1.458886 (no previous merge yet)
[S9] round=12 local utility u=0.405707 metrics={'f1_val': 0.0702020202020202, 'auprc': 0.0702020202020202, 'loss_val': 2.0406749267171613, 'psi': 0.0702020202020202}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.220270550640155, 'psi': 0.0}
[S10] START round=12 head_norm_before_train=1.481238 (no previous merge yet)
[S10] round=12 local utility u=0.379566 metrics={'f1_val': 0.20798436627582356, 'auprc': 0.20798436627582356, 'loss_val': 3.165716250674864, 'psi': 0.20798436627582356}-{'f1_val': 0.12815499466761465, 'auprc': 0.12815499466761465, 'loss_val': 3.206384273893429, 'psi': 0.12815499466761465}
[S11] START round=12 head_norm_before_train=1.466522 (no previous merge yet)
[S11] round=12 local utility u=0.115543 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9361988557139482, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.167285100257694, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.359426 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.2515769944341373, 'auprc': 0.2515769944341373, 'loss_val': 1.153545400940662, 'psi': 0.2515769944341373}-{'f1_val': 0.33044053227539466, 'auprc': 0.33044053227539466, 'loss_val': 1.2088210642577062, 'psi': 0.33044053227539466}
[S14] START round=12 head_norm_before_train=1.076934 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=1.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.24372367593642, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.551340183924269, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.313744 cos_to_last_merge=0.9966 (last merge round=10)
[S15] round=12 local utility u=1.000000 metrics={'f1_val': 0.5873258037334717, 'auprc': 0.5873258037334717, 'loss_val': 1.2339374289993015, 'psi': 0.5873258037334717}-{'f1_val': 0.3537545495795561, 'auprc': 0.3537545495795561, 'loss_val': 1.3192357315153005, 'psi': 0.3537545495795561}
[S16] START round=12 head_norm_before_train=1.143950 cos_to_last_merge=0.9515 (last merge round=5)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2363912239830235, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0294372867311115, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.284278 cos_to_last_merge=0.9841 (last merge round=9)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2693089137072788, 'psi': 0.15234678044996122}-{'f1_val': 0.20320786444185746, 'auprc': 0.20320786444185746, 'loss_val': 1.294636597996239, 'psi': 0.20320786444185746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:63514
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63515
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63515
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:63504
[S9] not sending this round → trigger blocked (psi=0.070)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:63517
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S8
[S15] cosine check vs S8: cos=0.9625
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=-0.1113
[S15] DROPPED delta from S5 (cos=-0.1113 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S2
[S14] cosine check vs S2: cos=0.7024
[S17] RECEIVED delta(kind=head bytes=1803) from S10
[S17] cosine check vs S10: cos=0.0083
[S4] RECEIVED delta(kind=head bytes=1800) from S15
[S4] cosine check vs S15: cos=0.6486
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.0000 head_norm=1.107661
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.401415e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.213116 delta_norm=0.540141
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.0000 head_norm=1.048549
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.213727e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.3568 head_norm=1.091166 delta_norm=0.521373
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.5873 head_norm=1.351108
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.952365e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.5820 head_norm=1.379884 delta_norm=0.195237
[S15] aggregate: ROLLBACK (f1_val pre=0.587 post=0.582 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.1523 head_norm=1.321576
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.985245e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.1522 head_norm=1.006783 delta_norm=0.998525
[S17] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.516541 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.20412595005428882, 'auprc': 0.20412595005428882, 'loss_val': 2.9322791291631187, 'psi': 0.20412595005428882}-{'f1_val': 0.2014036747890545, 'auprc': 0.2014036747890545, 'loss_val': 2.8980894707365716, 'psi': 0.2014036747890545}
[S3] START round=13 head_norm_before_train=1.507174 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.250806443330324, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.170690045642517, 'psi': 0.0}
[S4] START round=13 head_norm_before_train=1.091166 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=1.000000 metrics={'f1_val': 0.22947795609666113, 'auprc': 0.22947795609666113, 'loss_val': 1.2950387772995968, 'psi': 0.22947795609666113}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.2980556831545513, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.400095 (no previous merge yet)
[S5] round=13 local utility u=0.015913 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.179682421713041, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.211508187451949, 'psi': 0.35933890172383154}
[S6] START round=13 head_norm_before_train=1.559966 (no previous merge yet)
[S6] round=13 local utility u=0.086803 metrics={'f1_val': 0.0635185959047221, 'auprc': 0.0635185959047221, 'loss_val': 4.2153717505978126, 'psi': 0.0635185959047221}-{'f1_val': 0.04007045354469397, 'auprc': 0.04007045354469397, 'loss_val': 4.1779447979161874, 'psi': 0.04007045354469397}
[S7] START round=13 head_norm_before_train=1.348036 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.455830049649901, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4398605615640434, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.434887 (no previous merge yet)
[S8] round=13 local utility u=0.016631 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.138567382921062, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.1718292200837874, 'psi': 0.30506182380216385}
[S9] START round=13 head_norm_before_train=1.490245 (no previous merge yet)
[S9] round=13 local utility u=0.867239 metrics={'f1_val': 0.2400619822397044, 'auprc': 0.2400619822397044, 'loss_val': 1.8349373495518846, 'psi': 0.24006198223970443}-{'f1_val': 0.0702020202020202, 'auprc': 0.0702020202020202, 'loss_val': 2.0406749267171613, 'psi': 0.0702020202020202}
[S10] START round=13 head_norm_before_train=1.508232 (no previous merge yet)
[S10] round=13 local utility u=0.173426 metrics={'f1_val': 0.24217402021197929, 'auprc': 0.24217402021197929, 'loss_val': 3.1265711545543473, 'psi': 0.24217402021197929}-{'f1_val': 0.20798436627582356, 'auprc': 0.20798436627582356, 'loss_val': 3.165716250674864, 'psi': 0.20798436627582356}
[S11] START round=13 head_norm_before_train=1.492660 (no previous merge yet)
[S11] round=13 local utility u=1.000000 metrics={'f1_val': 0.2597871531736982, 'auprc': 0.2597871531736982, 'loss_val': 3.071232832273117, 'psi': 0.2597871531736982}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9361988557139482, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.383509 (no previous merge yet)
[S13] round=13 local utility u=0.252317 metrics={'f1_val': 0.3016204128206696, 'auprc': 0.3016204128206696, 'loss_val': 1.0993026377083843, 'psi': 0.3016204128206696}-{'f1_val': 0.2515769944341373, 'auprc': 0.2515769944341373, 'loss_val': 1.153545400940662, 'psi': 0.2515769944341373}
[S14] START round=13 head_norm_before_train=1.213116 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.416495 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.410734056655186, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.24372367593642, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.379884 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.391056 metrics={'f1_val': 0.6662345506923149, 'auprc': 0.6662345506923149, 'loss_val': 1.1620035353044071, 'psi': 0.6662345506923149}-{'f1_val': 0.5873258037334717, 'auprc': 0.5873258037334717, 'loss_val': 1.2339374289993015, 'psi': 0.5873258037334717}
[S16] START round=13 head_norm_before_train=1.181341 cos_to_last_merge=0.9400 (last merge round=5)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3230252662107875, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2363912239830235, 'psi': 0.0}
[S17] START round=13 head_norm_before_train=1.006783 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.221589 metrics={'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.2814010307043227, 'psi': 0.20293224827229864}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2693089137072788, 'psi': 0.15234678044996122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63515
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:63504
[S6] not sending this round → trigger blocked (psi=0.064)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:63516
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:63516
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:63509
[S13] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] cosine check vs S4: cos=0.2551
[S15] RECEIVED delta(kind=head bytes=1795) from S5
[S15] cosine check vs S5: cos=-0.1016
[S15] DROPPED delta from S5 (cos=-0.1016 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=-0.0219
[S16] DROPPED delta from S9 (cos=-0.0219 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S13
[S8] cosine check vs S13: cos=-0.0247
[S8] DROPPED delta from S13 (cos=-0.0247 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] cosine check vs S11: cos=0.0061
[S4] RECEIVED delta(kind=head bytes=1804) from S15
[S4] cosine check vs S15: cos=0.9016
[S17] RECEIVED delta(kind=head bytes=1804) from S10
[S17] cosine check vs S10: cos=0.7311
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.9803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S17
[S13] cosine check vs S17: cos=0.0162
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.3016 head_norm=1.414433
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.701348e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.3320 head_norm=0.883647 delta_norm=0.870135
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6662 head_norm=1.411126
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.451149e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6662 head_norm=1.430605 delta_norm=0.145115
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.2295 head_norm=1.134076
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.128768e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.3568 head_norm=1.241294 delta_norm=0.312877
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.3593 head_norm=1.427193
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.038334e+00
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.2720 head_norm=1.044666 delta_norm=1.038334
[S5] aggregate: ROLLBACK (f1_val pre=0.359 post=0.272 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.0000 head_norm=1.216017
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.178280e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.0000 head_norm=0.931201 delta_norm=0.717828
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.2029 head_norm=1.036972
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.254828e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.1521 head_norm=1.200056 delta_norm=0.525483
[S17] aggregate: ROLLBACK (f1_val pre=0.203 post=0.152 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.551567 (no previous merge yet)
[S2] round=14 local utility u=0.245664 metrics={'f1_val': 0.2572199730094467, 'auprc': 0.2572199730094467, 'loss_val': 2.918797247157677, 'psi': 0.2572199730094467}-{'f1_val': 0.20412595005428882, 'auprc': 0.20412595005428882, 'loss_val': 2.9322791291631187, 'psi': 0.20412595005428882}
[S3] START round=14 head_norm_before_train=1.533641 (no previous merge yet)
[S3] round=14 local utility u=0.466368 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 2.5180699455456677, 'psi': 0.13333333333333333}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.250806443330324, 'psi': 0.0}
[S4] START round=14 head_norm_before_train=1.241294 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.576511 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2878612783853336, 'psi': 0.3567939207526687}-{'f1_val': 0.22947795609666113, 'auprc': 0.22947795609666113, 'loss_val': 1.2950387772995968, 'psi': 0.22947795609666113}
[S5] START round=14 head_norm_before_train=1.044666 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.3062244434348024, 'auprc': 0.3062244434348024, 'loss_val': 1.2904844481190616, 'psi': 0.3062244434348024}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.179682421713041, 'psi': 0.35933890172383154}
[S6] START round=14 head_norm_before_train=1.586361 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.05928270042194093, 'auprc': 0.05928270042194093, 'loss_val': 4.419652639660829, 'psi': 0.05928270042194093}-{'f1_val': 0.0635185959047221, 'auprc': 0.0635185959047221, 'loss_val': 4.2153717505978126, 'psi': 0.0635185959047221}
[S7] START round=14 head_norm_before_train=1.368386 (no previous merge yet)
[S7] round=14 local utility u=0.031613 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3926038272925199, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.455830049649901, 'psi': 0.0}
[S8] START round=14 head_norm_before_train=1.464274 (no previous merge yet)
[S8] round=14 local utility u=0.032193 metrics={'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0741816897020455, 'psi': 0.30506182380216385}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.138567382921062, 'psi': 0.30506182380216385}
[S9] START round=14 head_norm_before_train=1.524030 (no previous merge yet)
[S9] round=14 local utility u=0.570299 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8518261429732124, 'psi': 0.36867172340800847}-{'f1_val': 0.2400619822397044, 'auprc': 0.2400619822397044, 'loss_val': 1.8349373495518846, 'psi': 0.24006198223970443}
[S10] START round=14 head_norm_before_train=1.535325 (no previous merge yet)
[S10] round=14 local utility u=0.447130 metrics={'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 3.0477175059273467, 'psi': 0.33277471869762987}-{'f1_val': 0.24217402021197929, 'auprc': 0.24217402021197929, 'loss_val': 3.1265711545543473, 'psi': 0.24217402021197929}
[S11] START round=14 head_norm_before_train=1.517250 (no previous merge yet)
[S11] round=14 local utility u=0.358274 metrics={'f1_val': 0.33232252546458285, 'auprc': 0.33232252546458285, 'loss_val': 3.007503004679574, 'psi': 0.33232252546458285}-{'f1_val': 0.2597871531736982, 'auprc': 0.2597871531736982, 'loss_val': 3.071232832273117, 'psi': 0.2597871531736982}
[S13] START round=14 head_norm_before_train=0.883647 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=1.000000 metrics={'f1_val': 0.6650605522031866, 'auprc': 0.6650605522031866, 'loss_val': 1.2105239259145377, 'psi': 0.6650605522031866}-{'f1_val': 0.3016204128206696, 'auprc': 0.3016204128206696, 'loss_val': 1.0993026377083843, 'psi': 0.3016204128206696}
[S14] START round=14 head_norm_before_train=1.236279 cos_to_last_merge=0.9975 (last merge round=12)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.105020979532615, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.410734056655186, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.430605 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=1.000000 metrics={'f1_val': 0.9994390863918396, 'auprc': 0.9994390863918396, 'loss_val': 1.1105350353607635, 'psi': 0.9994390863918396}-{'f1_val': 0.6662345506923149, 'auprc': 0.6662345506923149, 'loss_val': 1.1620035353044071, 'psi': 0.6662345506923149}
[S16] START round=14 head_norm_before_train=0.931201 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.662620 metrics={'f1_val': 0.030799475753604193, 'auprc': 0.030799475753604193, 'loss_val': 2.274980938635311, 'psi': 0.030799475753604193}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3230252662107875, 'psi': 0.0}
[S17] START round=14 head_norm_before_train=1.200056 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 1.2860575264036298, 'psi': 0.20301091942882987}-{'f1_val': 0.20293224827229864, 'auprc': 0.20293224827229864, 'loss_val': 1.2814010307043227, 'psi': 0.20293224827229864}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:63517
[S3] not sending this round → trigger blocked (psi=0.133)
[S16] not sending this round → trigger blocked (psi=0.031)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:63516
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:63516
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:63514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:63504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63505
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63515
[S11] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S11
[S5] cosine check vs S11: cos=0.7114
[S8] RECEIVED delta(kind=head bytes=1795) from S13
[S8] cosine check vs S13: cos=0.0290
[S14] RECEIVED delta(kind=head bytes=1796) from S2
[S14] cosine check vs S2: cos=0.9011
[S4] RECEIVED delta(kind=head bytes=1798) from S15
[S4] cosine check vs S15: cos=0.9565
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.9879
[S17] RECEIVED delta(kind=head bytes=1804) from S10
[S17] cosine check vs S10: cos=0.9377
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.0095
[S16] RECEIVED delta(kind=head bytes=1805) from S4
[S16] cosine check vs S4: cos=0.6715
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.3062 head_norm=1.072711
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.414860e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.3289 head_norm=1.211940 delta_norm=0.541486
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.0000 head_norm=1.272118
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.520635e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.0181 head_norm=1.392700 delta_norm=0.352064
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.9994 head_norm=1.462299
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.156365e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.9992 head_norm=1.472798 delta_norm=0.115637
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.3051 head_norm=1.492210
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.658826e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.6822 head_norm=0.888654 delta_norm=0.865883
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.3568 head_norm=1.276657
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.218681e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.3568 head_norm=1.354571 delta_norm=0.221868
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.0308 head_norm=0.966388
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.348809e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.0000 head_norm=0.841094 delta_norm=0.534881
[S16] aggregate: ROLLBACK (f1_val pre=0.031 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.2030 head_norm=1.217738
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.980822e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.1521 head_norm=1.368376 delta_norm=0.298082
[S17] aggregate: ROLLBACK (f1_val pre=0.203 post=0.152 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.583932 (no previous merge yet)
[S2] round=15 local utility u=0.016637 metrics={'f1_val': 0.2612413977416984, 'auprc': 0.2612413977416984, 'loss_val': 2.9217165070201943, 'psi': 0.2612413977416984}-{'f1_val': 0.2572199730094467, 'auprc': 0.2572199730094467, 'loss_val': 2.918797247157677, 'psi': 0.2572199730094467}
[S3] START round=15 head_norm_before_train=1.562627 (no previous merge yet)
[S3] round=15 local utility u=0.875806 metrics={'f1_val': 0.2802618749129405, 'auprc': 0.2802618749129405, 'loss_val': 2.0888153909707836, 'psi': 0.2802618749129405}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 2.5180699455456677, 'psi': 0.13333333333333333}
[S4] START round=15 head_norm_before_train=1.354571 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.005029 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2778026311316835, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2878612783853336, 'psi': 0.3567939207526687}
[S5] START round=15 head_norm_before_train=1.211940 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.093851 metrics={'f1_val': 0.3332508863055487, 'auprc': 0.3332508863055487, 'loss_val': 1.3460210454495798, 'psi': 0.3332508863055487}-{'f1_val': 0.3062244434348024, 'auprc': 0.3062244434348024, 'loss_val': 1.2904844481190616, 'psi': 0.3062244434348024}
[S6] START round=15 head_norm_before_train=1.610357 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.03328865058087578, 'auprc': 0.03328865058087578, 'loss_val': 4.806078564020467, 'psi': 0.03328865058087578}-{'f1_val': 0.05928270042194093, 'auprc': 0.05928270042194093, 'loss_val': 4.419652639660829, 'psi': 0.05928270042194093}
[S7] START round=15 head_norm_before_train=1.378783 (no previous merge yet)
[S7] round=15 local utility u=0.890055 metrics={'f1_val': 0.19190680564071122, 'auprc': 0.19190680564071122, 'loss_val': 1.3396544527039072, 'psi': 0.19190680564071122}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3926038272925199, 'psi': 0.0}
[S8] START round=15 head_norm_before_train=0.888654 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.9828520517915443, 'auprc': 0.9828520517915443, 'loss_val': 1.1260201518830453, 'psi': 0.9828520517915444}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.0741816897020455, 'psi': 0.30506182380216385}
[S9] START round=15 head_norm_before_train=1.558169 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.879812473809168, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.8518261429732124, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.561962 (no previous merge yet)
[S10] round=15 local utility u=0.046248 metrics={'f1_val': 0.33317391997449386, 'auprc': 0.33317391997449386, 'loss_val': 2.9588137019250476, 'psi': 0.33317391997449386}-{'f1_val': 0.33277471869762987, 'auprc': 0.33277471869762987, 'loss_val': 3.0477175059273467, 'psi': 0.33277471869762987}
[S11] START round=15 head_norm_before_train=1.540552 (no previous merge yet)
[S11] round=15 local utility u=0.012269 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.9801826507726115, 'psi': 0.3320133550741517}-{'f1_val': 0.33232252546458285, 'auprc': 0.33232252546458285, 'loss_val': 3.007503004679574, 'psi': 0.33232252546458285}
[S13] START round=15 head_norm_before_train=0.923161 cos_to_last_merge=0.9975 (last merge round=13)
[S13] round=15 local utility u=0.018343 metrics={'f1_val': 0.663975633927427, 'auprc': 0.663975633927427, 'loss_val': 1.1640738478634505, 'psi': 0.663975633927427}-{'f1_val': 0.6650605522031866, 'auprc': 0.6650605522031866, 'loss_val': 1.2105239259145377, 'psi': 0.6650605522031866}
[S14] START round=15 head_norm_before_train=1.392700 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.243090 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6188413273618782, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.105020979532615, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.472798 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6632013201320132, 'auprc': 0.6632013201320132, 'loss_val': 0.9737587709616211, 'psi': 0.6632013201320132}-{'f1_val': 0.9994390863918396, 'auprc': 0.9994390863918396, 'loss_val': 1.1105350353607635, 'psi': 0.9994390863918396}
[S16] START round=15 head_norm_before_train=0.841094 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.015584438281095, 'psi': 0.0}-{'f1_val': 0.030799475753604193, 'auprc': 0.030799475753604193, 'loss_val': 2.274980938635311, 'psi': 0.030799475753604193}
[S17] START round=15 head_norm_before_train=1.368376 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.002888 metrics={'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.2809898078689546, 'psi': 0.20308965160623102}-{'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 1.2860575264036298, 'psi': 0.20301091942882987}
[S7] not sending this round → trigger blocked (psi=0.192)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63515
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:63516
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:63507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:63505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:63509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:63514
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S13
[S8] cosine check vs S13: cos=0.5142
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.8611
[S15] RECEIVED delta(kind=head bytes=1794) from S5
[S15] cosine check vs S5: cos=-0.1165
[S15] DROPPED delta from S5 (cos=-0.1165 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S2
[S14] cosine check vs S2: cos=0.9645
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=0.9305
[S6] RECEIVED delta(kind=head bytes=1796) from S3
[S6] cosine check vs S3: cos=0.1536
[S17] RECEIVED delta(kind=head bytes=1805) from S10
[S17] cosine check vs S10: cos=0.9748
[S16] RECEIVED delta(kind=head bytes=1804) from S4
[S16] cosine check vs S4: cos=0.7275
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:63513
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.4874
[S7] ⇄ pheromone p=0.261 → S17@127.0.0.1:63517
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.0333 head_norm=1.632939
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.048766e+00
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.0401 head_norm=1.224351 delta_norm=1.048766
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.081 → S15@127.0.0.1:63515
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.0000 head_norm=1.417168
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.237678e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.0177 head_norm=1.501176 delta_norm=0.223768
[S14] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.241 → S8@127.0.0.1:63509
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6632 head_norm=1.508342
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.244228e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6657 head_norm=1.180882 delta_norm=0.424423
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.469 → S4@127.0.0.1:63504
[S9] ⇄ pheromone p=0.310 → S16@127.0.0.1:63516
[S2] ⇄ pheromone p=0.167 → S14@127.0.0.1:63514
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.3333 head_norm=1.237129
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.060353e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.375752 delta_norm=0.306035
[S5] aggregate: ROLLBACK (f1_val pre=0.333 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.177 → S15@127.0.0.1:63515
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9829 head_norm=0.934953
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.708526e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.3594 head_norm=0.830781 delta_norm=0.470853
[S8] aggregate: ROLLBACK (f1_val pre=0.983 post=0.359 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.355 → S15@127.0.0.1:63515
[S4] ⇄ pheromone p=0.281 → S16@127.0.0.1:63516
[S11] ⇄ pheromone p=0.239 → S5@127.0.0.1:63505
[S10] ⇄ pheromone p=0.208 → S17@127.0.0.1:63517
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6640 head_norm=0.974505
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.215621e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.3292 head_norm=1.020949 delta_norm=0.621562
[S13] aggregate: ROLLBACK (f1_val pre=0.664 post=0.329 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.325 → S8@127.0.0.1:63509
[S3] ⇄ pheromone p=0.315 → S6@127.0.0.1:63507
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.0000 head_norm=0.874207
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.809982e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.0000 head_norm=1.055579 delta_norm=0.480998
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.156 → S7@127.0.0.1:63508
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.2031 head_norm=1.381193
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.969536e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.1523 head_norm=1.477021 delta_norm=0.196954
[S17] aggregate: ROLLBACK (f1_val pre=0.203 post=0.152 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.112 → S13@127.0.0.1:63513
[S2] START round=16 head_norm_before_train=1.612092 (no previous merge yet)
[S2] round=16 local utility u=0.052051 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.855264930279974, 'psi': 0.26542475888492534}-{'f1_val': 0.2612413977416984, 'auprc': 0.2612413977416984, 'loss_val': 2.9217165070201943, 'psi': 0.2612413977416984}
[S3] START round=16 head_norm_before_train=1.591038 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.2618768710139268, 'auprc': 0.2618768710139268, 'loss_val': 1.9623623851347851, 'psi': 0.2618768710139268}-{'f1_val': 0.2802618749129405, 'auprc': 0.2802618749129405, 'loss_val': 2.0888153909707836, 'psi': 0.2802618749129405}
[S4] START round=16 head_norm_before_train=1.388155 cos_to_last_merge=0.9958 (last merge round=14)
[S4] round=16 local utility u=0.001062 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2756789963515476, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2778026311316835, 'psi': 0.3567939207526687}
[S5] START round=16 head_norm_before_train=1.375752 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.19235280319024162, 'auprc': 0.19235280319024162, 'loss_val': 1.3619147194725643, 'psi': 0.19235280319024162}-{'f1_val': 0.3332508863055487, 'auprc': 0.3332508863055487, 'loss_val': 1.3460210454495798, 'psi': 0.3332508863055487}
[S6] START round=16 head_norm_before_train=1.224351 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.747425 metrics={'f1_val': 0.04208680403331872, 'auprc': 0.04208680403331872, 'loss_val': 3.390412548108133, 'psi': 0.04208680403331872}-{'f1_val': 0.03328865058087578, 'auprc': 0.03328865058087578, 'loss_val': 4.806078564020467, 'psi': 0.03328865058087578}
[S7] START round=16 head_norm_before_train=1.386997 (no previous merge yet)
[S7] round=16 local utility u=0.229338 metrics={'f1_val': 0.23889321901792673, 'auprc': 0.23889321901792673, 'loss_val': 1.3038562837150263, 'psi': 0.23889321901792673}-{'f1_val': 0.19190680564071122, 'auprc': 0.19190680564071122, 'loss_val': 1.3396544527039072, 'psi': 0.19190680564071122}
[S8] START round=16 head_norm_before_train=0.830781 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.16881270104419, 'psi': 0.35939447907390915}-{'f1_val': 0.9828520517915443, 'auprc': 0.9828520517915443, 'loss_val': 1.1260201518830453, 'psi': 0.9828520517915444}
[S9] START round=16 head_norm_before_train=1.590286 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0070700608934744, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.879812473809168, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.591563 (no previous merge yet)
[S10] round=16 local utility u=0.030785 metrics={'f1_val': 0.3330941561030057, 'auprc': 0.3330941561030057, 'loss_val': 2.8965257594415608, 'psi': 0.3330941561030057}-{'f1_val': 0.33317391997449386, 'auprc': 0.33317391997449386, 'loss_val': 2.9588137019250476, 'psi': 0.33317391997449386}
[S11] START round=16 head_norm_before_train=1.562759 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 3.0372351321614723, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.9801826507726115, 'psi': 0.3320133550741517}
[S13] START round=16 head_norm_before_train=1.020949 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6521198796928197, 'auprc': 0.6521198796928197, 'loss_val': 1.2697805613548843, 'psi': 0.6521198796928197}-{'f1_val': 0.663975633927427, 'auprc': 0.663975633927427, 'loss_val': 1.1640738478634505, 'psi': 0.663975633927427}
[S14] START round=16 head_norm_before_train=1.501176 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.364989 metrics={'f1_val': 0.05385169186465083, 'auprc': 0.05385169186465083, 'loss_val': 2.3735286411889933, 'psi': 0.05385169186465083}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6188413273618782, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.180882 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.008761 metrics={'f1_val': 0.6638825940401506, 'auprc': 0.6638825940401506, 'loss_val': 0.9623689615841653, 'psi': 0.6638825940401506}-{'f1_val': 0.6632013201320132, 'auprc': 0.6632013201320132, 'loss_val': 0.9737587709616211, 'psi': 0.6632013201320132}
[S16] START round=16 head_norm_before_train=1.055579 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.013306 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9889721354516787, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.015584438281095, 'psi': 0.0}
[S17] START round=16 head_norm_before_train=1.477021 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.1524058983313931, 'auprc': 0.1524058983313931, 'loss_val': 1.2779173778366757, 'psi': 0.1524058983313931}-{'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.2809898078689546, 'psi': 0.20308965160623102}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:63515
[S6] not sending this round → trigger blocked (psi=0.042)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.054)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:63516
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:63504
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.0587
[S4] RECEIVED delta(kind=head bytes=1802) from S15
[S4] cosine check vs S15: cos=0.9345
[S15] RECEIVED delta(kind=head bytes=1804) from S4
[S15] cosine check vs S4: cos=0.9345
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.3568 head_norm=1.435162
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.621703e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.3568 head_norm=1.307648 delta_norm=0.262170
[S4] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6639 head_norm=1.223791
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.621703e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6640 head_norm=1.307648 delta_norm=0.262170
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.0000 head_norm=1.079272
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.583572e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.0000 head_norm=0.908570 delta_norm=0.858357
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.637276 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.257168458781362, 'auprc': 0.257168458781362, 'loss_val': 2.7925131918831485, 'psi': 0.257168458781362}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.855264930279974, 'psi': 0.26542475888492534}
[S3] START round=17 head_norm_before_train=1.616533 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.2618257531394365, 'auprc': 0.2618257531394365, 'loss_val': 2.09443183622777, 'psi': 0.2618257531394365}-{'f1_val': 0.2618768710139268, 'auprc': 0.2618768710139268, 'loss_val': 1.9623623851347851, 'psi': 0.2618768710139268}
[S4] START round=17 head_norm_before_train=1.307648 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.011109 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2534610675615339, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2756789963515476, 'psi': 0.3567939207526687}
[S5] START round=17 head_norm_before_train=1.396240 cos_to_last_merge=0.9963 (last merge round=15)
[S5] round=17 local utility u=0.284941 metrics={'f1_val': 0.25, 'auprc': 0.25, 'loss_val': 1.3108575798349658, 'psi': 0.25}-{'f1_val': 0.19235280319024162, 'auprc': 0.19235280319024162, 'loss_val': 1.3619147194725643, 'psi': 0.19235280319024162}
[S6] START round=17 head_norm_before_train=1.253997 cos_to_last_merge=0.9994 (last merge round=15)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.047051170858629664, 'auprc': 0.047051170858629664, 'loss_val': 3.550570516681599, 'psi': 0.047051170858629664}-{'f1_val': 0.04208680403331872, 'auprc': 0.04208680403331872, 'loss_val': 3.390412548108133, 'psi': 0.04208680403331872}
[S7] START round=17 head_norm_before_train=1.399901 (no previous merge yet)
[S7] round=17 local utility u=0.071751 metrics={'f1_val': 0.24912674650698602, 'auprc': 0.24912674650698602, 'loss_val': 1.2524564193458494, 'psi': 0.24912674650698602}-{'f1_val': 0.23889321901792673, 'auprc': 0.23889321901792673, 'loss_val': 1.3038562837150263, 'psi': 0.23889321901792673}
[S8] START round=17 head_norm_before_train=0.878618 cos_to_last_merge=0.9933 (last merge round=15)
[S8] round=17 local utility u=0.020924 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1269644430692765, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.16881270104419, 'psi': 0.35939447907390915}
[S9] START round=17 head_norm_before_train=1.619196 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.103088841007001, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0070700608934744, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.619989 (no previous merge yet)
[S10] round=17 local utility u=0.036119 metrics={'f1_val': 0.3332536837913182, 'auprc': 0.3332536837913182, 'loss_val': 2.82572329102394, 'psi': 0.3332536837913182}-{'f1_val': 0.3330941561030057, 'auprc': 0.3330941561030057, 'loss_val': 2.8965257594415608, 'psi': 0.3330941561030057}
[S11] START round=17 head_norm_before_train=1.585005 (no previous merge yet)
[S11] round=17 local utility u=0.015820 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.004207634114272, 'psi': 0.3320133550741517}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 3.0372351321614723, 'psi': 0.33216756042589574}
[S13] START round=17 head_norm_before_train=1.054001 cos_to_last_merge=0.9966 (last merge round=15)
[S13] round=17 local utility u=0.050647 metrics={'f1_val': 0.6607329176964187, 'auprc': 0.6607329176964187, 'loss_val': 1.2460042329245482, 'psi': 0.6607329176964187}-{'f1_val': 0.6521198796928197, 'auprc': 0.6521198796928197, 'loss_val': 1.2697805613548843, 'psi': 0.6521198796928197}
[S14] START round=17 head_norm_before_train=1.520296 cos_to_last_merge=0.9978 (last merge round=15)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.07481574189959672, 'auprc': 0.07481574189959672, 'loss_val': 2.8977489883297163, 'psi': 0.07481574189959672}-{'f1_val': 0.05385169186465083, 'auprc': 0.05385169186465083, 'loss_val': 2.3735286411889933, 'psi': 0.05385169186465083}
[S15] START round=17 head_norm_before_train=1.307648 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6148191278779821, 'auprc': 0.6148191278779821, 'loss_val': 0.9013178794624256, 'psi': 0.6148191278779821}-{'f1_val': 0.6638825940401506, 'auprc': 0.6638825940401506, 'loss_val': 0.9623689615841653, 'psi': 0.6638825940401506}
[S16] START round=17 head_norm_before_train=0.908570 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.070051 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.848870102228764, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9889721354516787, 'psi': 0.0}
[S17] START round=17 head_norm_before_train=1.489438 cos_to_last_merge=0.9970 (last merge round=15)
[S17] round=17 local utility u=0.019472 metrics={'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2384405645542655, 'psi': 0.15234678044996122}-{'f1_val': 0.1524058983313931, 'auprc': 0.1524058983313931, 'loss_val': 1.2779173778366757, 'psi': 0.1524058983313931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:63517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:63512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:63516
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:63515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:63508
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1806) from S4
[S15] cosine check vs S4: cos=0.9958
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.7801
[S13] RECEIVED delta(kind=head bytes=1801) from S8
[S13] cosine check vs S8: cos=0.6949
[S17] RECEIVED delta(kind=head bytes=1799) from S13
[S17] cosine check vs S13: cos=0.8564
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] cosine check vs S5: cos=0.9494
[S17] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S17
[S7] cosine check vs S17: cos=0.1219
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.6148 head_norm=1.354089
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.183935e-02
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.6152 head_norm=1.351031 delta_norm=0.061839
[S15] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.3320 head_norm=1.608983
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.573791e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.3320 head_norm=1.499714 delta_norm=0.257379
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6607 head_norm=1.088600
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.027185e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.3337 head_norm=0.936907 delta_norm=0.402719
[S13] aggregate: ROLLBACK (f1_val pre=0.661 post=0.334 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.2491 head_norm=1.416719
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.710554e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.1701 head_norm=1.097331 delta_norm=0.971055
[S7] aggregate: ROLLBACK (f1_val pre=0.249 post=0.170 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.0000 head_norm=0.929483
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.518233e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.0000 head_norm=1.109672 delta_norm=0.451823
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.1523 head_norm=1.512308
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.038185e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.1523 head_norm=1.254191 delta_norm=0.403818
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.660406 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.2076936650785248, 'auprc': 0.2076936650785248, 'loss_val': 3.4758931018050645, 'psi': 0.2076936650785248}-{'f1_val': 0.257168458781362, 'auprc': 0.257168458781362, 'loss_val': 2.7925131918831485, 'psi': 0.257168458781362}
[S3] START round=18 head_norm_before_train=1.640945 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.2645106159205942, 'auprc': 0.2645106159205942, 'loss_val': 2.3017021708096155, 'psi': 0.2645106159205942}-{'f1_val': 0.2618257531394365, 'auprc': 0.2618257531394365, 'loss_val': 2.09443183622777, 'psi': 0.2618257531394365}
[S4] START round=18 head_norm_before_train=1.350800 cos_to_last_merge=0.9970 (last merge round=16)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2616060147138675, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2534610675615339, 'psi': 0.3567939207526687}
[S5] START round=18 head_norm_before_train=1.428966 cos_to_last_merge=0.9856 (last merge round=15)
[S5] round=18 local utility u=0.043904 metrics={'f1_val': 0.25307692725513425, 'auprc': 0.25307692725513425, 'loss_val': 1.2507418826650958, 'psi': 0.25307692725513425}-{'f1_val': 0.25, 'auprc': 0.25, 'loss_val': 1.3108575798349658, 'psi': 0.25}
[S6] START round=18 head_norm_before_train=1.293623 cos_to_last_merge=0.9973 (last merge round=15)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.04881209503239741, 'auprc': 0.04881209503239741, 'loss_val': 3.960119994658289, 'psi': 0.04881209503239741}-{'f1_val': 0.047051170858629664, 'auprc': 0.047051170858629664, 'loss_val': 3.550570516681599, 'psi': 0.047051170858629664}
[S7] START round=18 head_norm_before_train=1.097331 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.16289398280802292, 'auprc': 0.16289398280802292, 'loss_val': 1.3057362775385561, 'psi': 0.16289398280802292}-{'f1_val': 0.24912674650698602, 'auprc': 0.24912674650698602, 'loss_val': 1.2524564193458494, 'psi': 0.24912674650698602}
[S8] START round=18 head_norm_before_train=0.945993 cos_to_last_merge=0.9750 (last merge round=15)
[S8] round=18 local utility u=0.020150 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.08666392304372, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1269644430692765, 'psi': 0.35939447907390915}
[S9] START round=18 head_norm_before_train=1.644224 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1809401681355007, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.103088841007001, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.646979 (no previous merge yet)
[S10] round=18 local utility u=0.030858 metrics={'f1_val': 0.3330145066156544, 'auprc': 0.3330145066156544, 'loss_val': 2.7618550496810212, 'psi': 0.3330145066156544}-{'f1_val': 0.3332536837913182, 'auprc': 0.3332536837913182, 'loss_val': 2.82572329102394, 'psi': 0.3332536837913182}
[S11] START round=18 head_norm_before_train=1.499714 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.015101 metrics={'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.975394007506404, 'psi': 0.33216756042589574}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.004207634114272, 'psi': 0.3320133550741517}
[S13] START round=18 head_norm_before_train=0.936907 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.23847792923133695, 'auprc': 0.23847792923133695, 'loss_val': 1.2101571492381202, 'psi': 0.23847792923133698}-{'f1_val': 0.6607329176964187, 'auprc': 0.6607329176964187, 'loss_val': 1.2460042329245482, 'psi': 0.6607329176964187}
[S14] START round=18 head_norm_before_train=1.548062 cos_to_last_merge=0.9921 (last merge round=15)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.09254013220018886, 'auprc': 0.09254013220018886, 'loss_val': 3.3695535711036406, 'psi': 0.09254013220018886}-{'f1_val': 0.07481574189959672, 'auprc': 0.07481574189959672, 'loss_val': 2.8977489883297163, 'psi': 0.07481574189959672}
[S15] START round=18 head_norm_before_train=1.351031 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.098709 metrics={'f1_val': 0.6182990414125727, 'auprc': 0.6182990414125727, 'loss_val': 0.7352186135388126, 'psi': 0.6182990414125727}-{'f1_val': 0.6148191278779821, 'auprc': 0.6148191278779821, 'loss_val': 0.9013178794624256, 'psi': 0.6148191278779821}
[S16] START round=18 head_norm_before_train=1.109672 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.019756107753963, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.848870102228764, 'psi': 0.0}
[S17] START round=18 head_norm_before_train=1.254191 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.016209 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.206288641193342, 'psi': 0.15237633365664405}-{'f1_val': 0.15234678044996122, 'auprc': 0.15234678044996122, 'loss_val': 1.2384405645542655, 'psi': 0.15234678044996122}
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:63513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:63509
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:63512
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S8
[S13] cosine check vs S8: cos=0.8830
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] cosine check vs S15: cos=0.6675
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.9723
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:63508
[S17] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S17
[S7] cosine check vs S17: cos=0.7784
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.1629 head_norm=1.121296
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.083605e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.0529 head_norm=1.135845 delta_norm=0.408361
[S7] aggregate: ROLLBACK (f1_val pre=0.163 post=0.053 tol_abs=0.005 tol_rel=0.0)
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S7
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.3594 head_norm=1.019441
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.214952e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.8987 head_norm=1.105280 delta_norm=0.521495
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.2385 head_norm=0.978904
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.424450e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.2380 head_norm=0.969524 delta_norm=0.242445
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.3322 head_norm=1.520571
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.779278e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.3322 head_norm=1.482875 delta_norm=0.177928
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.680745 (no previous merge yet)
[S2] round=19 local utility u=0.538993 metrics={'f1_val': 0.25010893246187366, 'auprc': 0.25010893246187366, 'loss_val': 2.779645382331216, 'psi': 0.25010893246187366}-{'f1_val': 0.2076936650785248, 'auprc': 0.2076936650785248, 'loss_val': 3.4758931018050645, 'psi': 0.2076936650785248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S2] r=20 psi=0.250 u=0.5390 p_local=0.1815 f1=0.250 auprc=0.250 bytes=10803
[S3] START round=19 head_norm_before_train=1.664607 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.2698316904714008, 'auprc': 0.2698316904714008, 'loss_val': 2.4691212848183737, 'psi': 0.2698316904714008}-{'f1_val': 0.2645106159205942, 'auprc': 0.2645106159205942, 'loss_val': 2.3017021708096155, 'psi': 0.2645106159205942}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.270 u=0.0000 p_local=0.1291 f1=0.270 auprc=0.270 bytes=1796
[S4] START round=19 head_norm_before_train=1.400628 cos_to_last_merge=0.9899 (last merge round=16)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2738763767324939, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2616060147138675, 'psi': 0.3567939207526687}
[S5] START round=19 head_norm_before_train=1.465954 cos_to_last_merge=0.9728 (last merge round=15)
[S5] round=19 local utility u=0.338703 metrics={'f1_val': 0.3216373295019772, 'auprc': 0.3216373295019772, 'loss_val': 1.1903800979647834, 'psi': 0.3216373295019772}-{'f1_val': 0.25307692725513425, 'auprc': 0.25307692725513425, 'loss_val': 1.2507418826650958, 'psi': 0.25307692725513425}
[S6] START round=19 head_norm_before_train=1.335609 cos_to_last_merge=0.9941 (last merge round=15)
[S6] round=19 local utility u=0.050460 metrics={'f1_val': 0.06605733277939344, 'auprc': 0.06605733277939344, 'loss_val': 4.014406830937232, 'psi': 0.06605733277939344}-{'f1_val': 0.04881209503239741, 'auprc': 0.04881209503239741, 'loss_val': 3.960119994658289, 'psi': 0.04881209503239741}
[S7] START round=19 head_norm_before_train=1.135845 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.05693430656934306, 'auprc': 0.05693430656934306, 'loss_val': 1.3242480852542247, 'psi': 0.05693430656934306}-{'f1_val': 0.16289398280802292, 'auprc': 0.16289398280802292, 'loss_val': 1.3057362775385561, 'psi': 0.16289398280802292}
[S8] START round=19 head_norm_before_train=1.105280 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.022556 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0415509251214332, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.08666392304372, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.666142 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.247795512851709, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1809401681355007, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=20 psi=0.369 u=0.0000 p_local=0.1269 f1=0.369 auprc=0.369 bytes=3600
[S10] START round=19 head_norm_before_train=1.675987 (no previous merge yet)
[S10] round=19 local utility u=0.041414 metrics={'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.680462626739478, 'psi': 0.3331740723045071}-{'f1_val': 0.3330145066156544, 'auprc': 0.3330145066156544, 'loss_val': 2.7618550496810212, 'psi': 0.3330145066156544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] r=20 psi=0.333 u=0.0414 p_local=0.1063 f1=0.333 auprc=0.333 bytes=14435
[S11] START round=19 head_norm_before_train=1.482875 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.013746 metrics={'f1_val': 0.33232252546458285, 'auprc': 0.33232252546458285, 'loss_val': 2.949296174704981, 'psi': 0.33232252546458285}-{'f1_val': 0.33216756042589574, 'auprc': 0.33216756042589574, 'loss_val': 2.975394007506404, 'psi': 0.33216756042589574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=20 psi=0.332 u=0.0137 p_local=0.1050 f1=0.332 auprc=0.332 bytes=10807
[S13] START round=19 head_norm_before_train=0.969524 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.006336 metrics={'f1_val': 0.23788337189298214, 'auprc': 0.23788337189298214, 'loss_val': 1.1921351164570837, 'psi': 0.23788337189298214}-{'f1_val': 0.23847792923133695, 'auprc': 0.23847792923133695, 'loss_val': 1.2101571492381202, 'psi': 0.23847792923133698}
[S14] START round=19 head_norm_before_train=1.582974 cos_to_last_merge=0.9843 (last merge round=15)
[S14] round=19 local utility u=0.052767 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.6509270341803113, 'psi': 0.1355297641332834}-{'f1_val': 0.09254013220018886, 'auprc': 0.09254013220018886, 'loss_val': 3.3695535711036406, 'psi': 0.09254013220018886}
[S15] START round=19 head_norm_before_train=1.395687 cos_to_last_merge=0.9989 (last merge round=17)
[S15] round=19 local utility u=0.000021 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7182269286356541, 'psi': 0.6164158146233559}-{'f1_val': 0.6182990414125727, 'auprc': 0.6182990414125727, 'loss_val': 0.7352186135388126, 'psi': 0.6182990414125727}
[S16] START round=19 head_norm_before_train=1.123992 cos_to_last_merge=0.9953 (last merge round=17)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1430474321446162, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.019756107753963, 'psi': 0.0}
[S17] START round=19 head_norm_before_train=1.287051 cos_to_last_merge=0.9972 (last merge round=17)
[S17] round=19 local utility u=0.024571 metrics={'f1_val': 0.15650527993624228, 'auprc': 0.15650527993624228, 'loss_val': 1.1943073549287406, 'psi': 0.15650527993624228}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.206288641193342, 'psi': 0.15237633365664405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:63517
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.066)
[S14] not sending this round → trigger blocked (psi=0.136)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:63508
[S4] r=20 psi=0.357 u=0.0000 p_local=0.1166 f1=0.357 auprc=0.357 bytes=10810
[S6] r=20 psi=0.066 u=0.0505 p_local=0.1197 f1=0.066 auprc=0.066 bytes=0
[S7] r=20 psi=0.057 u=0.0000 p_local=0.1396 f1=0.057 auprc=0.057 bytes=10776
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] r=20 psi=0.136 u=0.0528 p_local=0.1466 f1=0.136 auprc=0.136 bytes=0
[S17] RECEIVED delta(kind=head bytes=1803) from S13
[S17] cosine check vs S13: cos=0.6867
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] r=20 psi=0.238 u=0.0063 p_local=0.1407 f1=0.238 auprc=0.238 bytes=14383
[S7] RECEIVED delta(kind=head bytes=1802) from S17
[S7] cosine check vs S17: cos=0.9385
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:63513
[S16] r=20 psi=0.000 u=0.0000 p_local=0.0741 f1=0.000 auprc=0.000 bytes=0
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:63512
[S8] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S8
[S13] cosine check vs S8: cos=0.7760
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.1565 head_norm=1.323138
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.835145e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.1563 head_norm=1.072251 delta_norm=0.483514
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.157 u=0.0246 p_local=0.0558 f1=0.157 auprc=0.157 bytes=12592
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.9857
[S5] r=20 psi=0.322 u=0.3387 p_local=0.1837 f1=0.322 auprc=0.322 bytes=14383
[S15] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:63509
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.9319
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.3594 head_norm=1.172244
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.734247e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.3594 head_norm=1.281989 delta_norm=0.273425
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.359 u=0.0226 p_local=0.1558 f1=0.359 auprc=0.359 bytes=19786
[S6]  timeout peer S3
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S14]  timeout peer S2
[S17]  timeout peer S7
[S17]  timeout peer S10
[S7]  timeout peer S16
[S5]  timeout peer S11
[S4]  timeout peer S15
[S13]  timeout peer S17
[S16]  timeout peer S4
[S16]  timeout peer S9
[S8]  timeout peer S13
[S8]  timeout peer S14
[S15] r=20 psi=0.616 u=0.0000 p_local=0.2086 f1=0.616 auprc=0.616 bytes=12600
[S2] START round=20 head_norm_before_train=1.698136 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.25048313696153607, 'auprc': 0.25048313696153607, 'loss_val': 2.7989803812452814, 'psi': 0.25048313696153607}-{'f1_val': 0.25010893246187366, 'auprc': 0.25010893246187366, 'loss_val': 2.779645382331216, 'psi': 0.25010893246187366}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.689356 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.2821378340365682, 'auprc': 0.2821378340365682, 'loss_val': 2.684935892702527, 'psi': 0.2821378340365682}-{'f1_val': 0.2698316904714008, 'auprc': 0.2698316904714008, 'loss_val': 2.4691212848183737, 'psi': 0.2698316904714008}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=1.449069 cos_to_last_merge=0.9821 (last merge round=16)
[S4] round=20 local utility u=0.006126 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.26162442984953, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2738763767324939, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=20 head_norm_before_train=1.499755 cos_to_last_merge=0.9622 (last merge round=15)
[S5] round=20 local utility u=0.031185 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.2438813286209618, 'psi': 0.33451196111837667}-{'f1_val': 0.3216373295019772, 'auprc': 0.3216373295019772, 'loss_val': 1.1903800979647834, 'psi': 0.3216373295019772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=20 head_norm_before_train=1.377846 cos_to_last_merge=0.9902 (last merge round=15)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.010084427767354597, 'auprc': 0.010084427767354597, 'loss_val': 4.715657567127831, 'psi': 0.010084427767354597}-{'f1_val': 0.06605733277939344, 'auprc': 0.06605733277939344, 'loss_val': 4.014406830937232, 'psi': 0.06605733277939344}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.161219 cos_to_last_merge=0.9978 (last merge round=18)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.04559819413092551, 'auprc': 0.04559819413092551, 'loss_val': 1.3083771073183095, 'psi': 0.04559819413092551}-{'f1_val': 0.05693430656934306, 'auprc': 0.05693430656934306, 'loss_val': 1.3242480852542247, 'psi': 0.05693430656934306}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.0456 head_norm=1.196522
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.610802e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.0011 head_norm=1.234106 delta_norm=0.261080
[S7] aggregate: ROLLBACK (f1_val pre=0.046 post=0.001 tol_abs=0.005 tol_rel=0.0)
[S8] START round=20 head_norm_before_train=1.281989 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.008506 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.024538653510741, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0415509251214332, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=20 head_norm_before_train=1.685300 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.305331678275835, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.247795512851709, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=1.698277 (no previous merge yet)
[S10] round=20 local utility u=0.024846 metrics={'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.630770858932302, 'psi': 0.3331740723045071}-{'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.680462626739478, 'psi': 0.3331740723045071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=20 head_norm_before_train=1.499738 cos_to_last_merge=0.9998 (last merge round=18)
[S11] round=20 local utility u=0.028634 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.8892465061144517, 'psi': 0.3320133550741517}-{'f1_val': 0.33232252546458285, 'auprc': 0.33232252546458285, 'loss_val': 2.949296174704981, 'psi': 0.33232252546458285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.3320 head_norm=1.518330
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.348485e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.3321 head_norm=1.503034 delta_norm=0.134849
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] START round=20 head_norm_before_train=1.008128 cos_to_last_merge=0.9980 (last merge round=18)
[S13] round=20 local utility u=0.004808 metrics={'f1_val': 0.23788337189298214, 'auprc': 0.23788337189298214, 'loss_val': 1.1825192606970514, 'psi': 0.23788337189298214}-{'f1_val': 0.23788337189298214, 'auprc': 0.23788337189298214, 'loss_val': 1.1921351164570837, 'psi': 0.23788337189298214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.2379 head_norm=1.044462
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.861064e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.2383 head_norm=1.040889 delta_norm=0.386106
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] START round=20 head_norm_before_train=1.617961 cos_to_last_merge=0.9772 (last merge round=15)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.8444372805836804, 'psi': 0.13582554517133957}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 3.6509270341803113, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=20 head_norm_before_train=1.436092 cos_to_last_merge=0.9965 (last merge round=17)
[S15] round=20 local utility u=0.044435 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6298754326741877, 'psi': 0.6164734888353558}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7182269286356541, 'psi': 0.6164158146233559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=20 head_norm_before_train=1.151298 cos_to_last_merge=0.9816 (last merge round=17)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.457205704514532, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1430474321446162, 'psi': 0.0}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=1.072251 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.014655 metrics={'f1_val': 0.1576043338683788, 'auprc': 0.1576043338683788, 'loss_val': 1.1748893191267686, 'psi': 0.1576043338683788}-{'f1_val': 0.15650527993624228, 'auprc': 0.15650527993624228, 'loss_val': 1.1943073549287406, 'psi': 0.15650527993624228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=21 head_norm_before_train=1.715963 (no previous merge yet)
[S2] round=21 local utility u=0.017217 metrics={'f1_val': 0.26526704958077507, 'auprc': 0.26526704958077507, 'loss_val': 2.897601251530415, 'psi': 0.26526704958077507}-{'f1_val': 0.25048313696153607, 'auprc': 0.25048313696153607, 'loss_val': 2.7989803812452814, 'psi': 0.25048313696153607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=21 head_norm_before_train=1.711861 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.2816466792902728, 'auprc': 0.2816466792902728, 'loss_val': 2.716758085885839, 'psi': 0.2816466792902728}-{'f1_val': 0.2821378340365682, 'auprc': 0.2821378340365682, 'loss_val': 2.684935892702527, 'psi': 0.2821378340365682}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=1.493321 cos_to_last_merge=0.9754 (last merge round=16)
[S4] round=21 local utility u=0.008205 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.245215082663227, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.26162442984953, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=21 head_norm_before_train=1.526683 cos_to_last_merge=0.9541 (last merge round=15)
[S5] round=21 local utility u=0.007558 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.2287647608851997, 'psi': 0.33451196111837667}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.2438813286209618, 'psi': 0.33451196111837667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=21 head_norm_before_train=1.407592 cos_to_last_merge=0.9870 (last merge round=15)
[S6] round=21 local utility u=0.258619 metrics={'f1_val': 0.05133161512027491, 'auprc': 0.05133161512027491, 'loss_val': 4.569643594138038, 'psi': 0.05133161512027491}-{'f1_val': 0.010084427767354597, 'auprc': 0.010084427767354597, 'loss_val': 4.715657567127831, 'psi': 0.010084427767354597}
[S6] not sending this round → trigger blocked (psi=0.051)
[S7] START round=21 head_norm_before_train=1.234106 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.003942828979793002, 'auprc': 0.003942828979793002, 'loss_val': 1.3244803090192487, 'psi': 0.003942828979793002}-{'f1_val': 0.04559819413092551, 'auprc': 0.04559819413092551, 'loss_val': 1.3083771073183095, 'psi': 0.04559819413092551}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=1.333194 cos_to_last_merge=0.9991 (last merge round=19)
[S8] round=21 local utility u=0.008105 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.008329099112525, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.024538653510741, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=21 head_norm_before_train=1.701937 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.360806393730595, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.305331678275835, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=1.718015 (no previous merge yet)
[S10] round=21 local utility u=0.035957 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.558139707952555, 'psi': 0.3330944988456333}-{'f1_val': 0.3331740723045071, 'auprc': 0.3331740723045071, 'loss_val': 2.630770858932302, 'psi': 0.3331740723045071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=21 head_norm_before_train=1.503034 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.005847 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.877553430543893, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.8892465061144517, 'psi': 0.3320133550741517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=21 head_norm_before_train=1.040889 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.2379851851851852, 'auprc': 0.2379851851851852, 'loss_val': 1.2030944397645003, 'psi': 0.2379851851851852}-{'f1_val': 0.23788337189298214, 'auprc': 0.23788337189298214, 'loss_val': 1.1825192606970514, 'psi': 0.23788337189298214}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.651456 cos_to_last_merge=0.9713 (last merge round=15)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.041086937456247, 'psi': 0.13572854291417166}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 3.8444372805836804, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=21 head_norm_before_train=1.472811 cos_to_last_merge=0.9934 (last merge round=17)
[S15] round=21 local utility u=0.042618 metrics={'f1_val': 0.616751573155862, 'auprc': 0.616751573155862, 'loss_val': 0.5471421660434036, 'psi': 0.616751573155862}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6298754326741877, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=21 head_norm_before_train=1.186404 cos_to_last_merge=0.9632 (last merge round=17)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.0002295684113865932, 'auprc': 0.0002295684113865932, 'loss_val': 2.710021120229054, 'psi': 0.0002295684113865932}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.457205704514532, 'psi': 0.0}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.107929 cos_to_last_merge=0.9983 (last merge round=19)
[S17] round=21 local utility u=0.007222 metrics={'f1_val': 0.15817559403946838, 'auprc': 0.15817559403946838, 'loss_val': 1.165586783519923, 'psi': 0.15817559403946838}-{'f1_val': 0.1576043338683788, 'auprc': 0.1576043338683788, 'loss_val': 1.1748893191267686, 'psi': 0.1576043338683788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=22 head_norm_before_train=1.733817 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.26521452145214525, 'auprc': 0.26521452145214525, 'loss_val': 2.9213166628913823, 'psi': 0.26521452145214525}-{'f1_val': 0.26526704958077507, 'auprc': 0.26526704958077507, 'loss_val': 2.897601251530415, 'psi': 0.26526704958077507}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=1.733772 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.28520575252740993, 'auprc': 0.28520575252740993, 'loss_val': 2.824174195688871, 'psi': 0.28520575252740993}-{'f1_val': 0.2816466792902728, 'auprc': 0.2816466792902728, 'loss_val': 2.716758085885839, 'psi': 0.2816466792902728}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.528265 cos_to_last_merge=0.9695 (last merge round=16)
[S4] round=22 local utility u=0.002372 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2404714396927896, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.245215082663227, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[S5] START round=22 head_norm_before_train=1.546833 cos_to_last_merge=0.9486 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 1.9500199154249613, 'psi': 0.33409214683912186}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.2287647608851997, 'psi': 0.33451196111837667}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.433697 cos_to_last_merge=0.9840 (last merge round=15)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.008239171374764594, 'auprc': 0.008239171374764594, 'loss_val': 5.0368389703558725, 'psi': 0.008239171374764594}-{'f1_val': 0.05133161512027491, 'auprc': 0.05133161512027491, 'loss_val': 4.569643594138038, 'psi': 0.05133161512027491}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=1.263113 cos_to_last_merge=0.9978 (last merge round=20)
[S7] round=22 local utility u=0.060232 metrics={'f1_val': 0.012590799031476998, 'auprc': 0.012590799031476998, 'loss_val': 1.281847639947378, 'psi': 0.012590799031476998}-{'f1_val': 0.003942828979793002, 'auprc': 0.003942828979793002, 'loss_val': 1.3244803090192487, 'psi': 0.003942828979793002}
[S7] not sending this round → trigger blocked (psi=0.013)
[S8] START round=22 head_norm_before_train=1.375804 cos_to_last_merge=0.9969 (last merge round=19)
[S8] round=22 local utility u=0.006659 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9950117079742528, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.008329099112525, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=22 head_norm_before_train=1.716826 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4143282784290805, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.360806393730595, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.736215 (no previous merge yet)
[S10] round=22 local utility u=0.019502 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.5191358391761987, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.558139707952555, 'psi': 0.3330944988456333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=22 head_norm_before_train=1.525527 cos_to_last_merge=0.9998 (last merge round=20)
[S11] round=22 local utility u=0.003129 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.8712948804061638, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.877553430543893, 'psi': 0.3320133550741517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=22 head_norm_before_train=1.067343 cos_to_last_merge=0.9989 (last merge round=20)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.23734853884533144, 'auprc': 0.23734853884533144, 'loss_val': 1.1986668726242846, 'psi': 0.2373485388453314}-{'f1_val': 0.2379851851851852, 'auprc': 0.2379851851851852, 'loss_val': 1.2030944397645003, 'psi': 0.2379851851851852}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.680994 cos_to_last_merge=0.9660 (last merge round=15)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.154577943524552, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.041086937456247, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=1.504665 cos_to_last_merge=0.9902 (last merge round=17)
[S15] round=22 local utility u=0.019561 metrics={'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.5087532578288608, 'psi': 0.6168330926211807}-{'f1_val': 0.616751573155862, 'auprc': 0.616751573155862, 'loss_val': 0.5471421660434036, 'psi': 0.616751573155862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=22 head_norm_before_train=1.227939 cos_to_last_merge=0.9427 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=22 local utility u=0.136011 metrics={'f1_val': 0.032998058937709546, 'auprc': 0.032998058937709546, 'loss_val': 2.732914821527493, 'psi': 0.032998058937709546}-{'f1_val': 0.0002295684113865932, 'auprc': 0.0002295684113865932, 'loss_val': 2.710021120229054, 'psi': 0.0002295684113865932}
[S16] not sending this round → trigger blocked (psi=0.033)
[S17] START round=22 head_norm_before_train=1.147722 cos_to_last_merge=0.9943 (last merge round=19)
[S17] round=22 local utility u=0.017779 metrics={'f1_val': 0.1538386212299256, 'auprc': 0.1538386212299256, 'loss_val': 1.090996838534245, 'psi': 0.1538386212299256}-{'f1_val': 0.15817559403946838, 'auprc': 0.15817559403946838, 'loss_val': 1.165586783519923, 'psi': 0.15817559403946838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=23 head_norm_before_train=1.750220 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.25109361329833774, 'auprc': 0.25109361329833774, 'loss_val': 2.8674102734922147, 'psi': 0.25109361329833774}-{'f1_val': 0.26521452145214525, 'auprc': 0.26521452145214525, 'loss_val': 2.9213166628913823, 'psi': 0.26521452145214525}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.754015 (no previous merge yet)
[S3] round=23 local utility u=0.007830 metrics={'f1_val': 0.2810992238305014, 'auprc': 0.2810992238305014, 'loss_val': 2.771555466688981, 'psi': 0.2810992238305014}-{'f1_val': 0.28520575252740993, 'auprc': 0.28520575252740993, 'loss_val': 2.824174195688871, 'psi': 0.28520575252740993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=23 head_norm_before_train=1.560434 cos_to_last_merge=0.9645 (last merge round=16)
[S4] round=23 local utility u=0.001503 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2374647188217343, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2404714396927896, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=23 head_norm_before_train=1.564622 cos_to_last_merge=0.9441 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.070347681013822, 'psi': 0.33400978131092857}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 1.9500199154249613, 'psi': 0.33409214683912186}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=1.457429 cos_to_last_merge=0.9813 (last merge round=15)
[S6] round=23 local utility u=0.038799 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.084767949736563, 'psi': 0.022186642268984445}-{'f1_val': 0.008239171374764594, 'auprc': 0.008239171374764594, 'loss_val': 5.0368389703558725, 'psi': 0.008239171374764594}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=23 head_norm_before_train=1.288822 cos_to_last_merge=0.9931 (last merge round=20)
[S7] round=23 local utility u=0.536904 metrics={'f1_val': 0.12827611664820968, 'auprc': 0.12827611664820968, 'loss_val': 1.2492079463657364, 'psi': 0.12827611664820968}-{'f1_val': 0.012590799031476998, 'auprc': 0.012590799031476998, 'loss_val': 1.281847639947378, 'psi': 0.012590799031476998}
[S7] not sending this round → trigger blocked (psi=0.128)
[S8] START round=23 head_norm_before_train=1.412585 cos_to_last_merge=0.9936 (last merge round=19)
[S8] round=23 local utility u=0.006109 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9827934540736157, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9950117079742528, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=23 head_norm_before_train=1.730390 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4645157311359505, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4143282784290805, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=1.754670 (no previous merge yet)
[S10] round=23 local utility u=0.050387 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.417645984703967, 'psi': 0.33301496338745623}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.5191358391761987, 'psi': 0.3330944988456333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=23 head_norm_before_train=1.552575 cos_to_last_merge=0.9990 (last merge round=20)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.9114543580452423, 'psi': 0.3320907114010562}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.8712948804061638, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=1.091504 cos_to_last_merge=0.9962 (last merge round=20)
[S13] round=23 local utility u=0.025620 metrics={'f1_val': 0.2396552741868839, 'auprc': 0.2396552741868839, 'loss_val': 1.1681868560574238, 'psi': 0.2396552741868839}-{'f1_val': 0.23734853884533144, 'auprc': 0.23734853884533144, 'loss_val': 1.1986668726242846, 'psi': 0.2373485388453314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=23 head_norm_before_train=1.707194 cos_to_last_merge=0.9618 (last merge round=15)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.238790852913041, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.154577943524552, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=1.534564 cos_to_last_merge=0.9870 (last merge round=17)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5167496413280492, 'psi': 0.6166125814646326}-{'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.5087532578288608, 'psi': 0.6168330926211807}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.270797 cos_to_last_merge=0.9235 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=23 local utility u=0.214077 metrics={'f1_val': 0.07953617507757635, 'auprc': 0.07953617507757635, 'loss_val': 2.7236041334233287, 'psi': 0.07953617507757635}-{'f1_val': 0.032998058937709546, 'auprc': 0.032998058937709546, 'loss_val': 2.732914821527493, 'psi': 0.032998058937709546}
[S16] not sending this round → trigger blocked (psi=0.080)
[S17] START round=23 head_norm_before_train=1.183141 cos_to_last_merge=0.9899 (last merge round=19)
[S17] round=23 local utility u=0.033918 metrics={'f1_val': 0.15641178813221823, 'auprc': 0.15641178813221823, 'loss_val': 1.0463188389810247, 'psi': 0.15641178813221823}-{'f1_val': 0.1538386212299256, 'auprc': 0.1538386212299256, 'loss_val': 1.090996838534245, 'psi': 0.1538386212299256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=24 head_norm_before_train=1.765958 (no previous merge yet)
[S2] round=24 local utility u=0.016168 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.964054792984474, 'psi': 0.26542475888492534}-{'f1_val': 0.25109361329833774, 'auprc': 0.25109361329833774, 'loss_val': 2.8674102734922147, 'psi': 0.25109361329833774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=24 head_norm_before_train=1.771976 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.2806282722513089, 'auprc': 0.2806282722513089, 'loss_val': 2.803928097024604, 'psi': 0.2806282722513089}-{'f1_val': 0.2810992238305014, 'auprc': 0.2810992238305014, 'loss_val': 2.771555466688981, 'psi': 0.2810992238305014}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=1.588459 cos_to_last_merge=0.9603 (last merge round=16)
[S4] round=24 local utility u=0.002201 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2330626590229647, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2374647188217343, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=24 head_norm_before_train=1.582188 cos_to_last_merge=0.9405 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.222860748906117, 'psi': 0.33358943696313936}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 2.070347681013822, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.479158 cos_to_last_merge=0.9788 (last merge round=15)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 5.161412006491174, 'psi': 0.02327704244637152}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.084767949736563, 'psi': 0.022186642268984445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.309912 cos_to_last_merge=0.9877 (last merge round=20)
[S7] round=24 local utility u=0.335871 metrics={'f1_val': 0.19838178004195386, 'auprc': 0.19838178004195386, 'loss_val': 1.2084173161022989, 'psi': 0.19838178004195386}-{'f1_val': 0.12827611664820968, 'auprc': 0.12827611664820968, 'loss_val': 1.2492079463657364, 'psi': 0.12827611664820968}
[S7] not sending this round → trigger blocked (psi=0.198)
[S8] START round=24 head_norm_before_train=1.446667 cos_to_last_merge=0.9903 (last merge round=19)
[S8] round=24 local utility u=0.004563 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9736681252326345, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9827934540736157, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=24 head_norm_before_train=1.742819 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5099297628406068, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4645157311359505, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.773046 (no previous merge yet)
[S10] round=24 local utility u=0.045740 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3261668108689397, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.417645984703967, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S10] sending update (kind=head size=1809 to 1 peers)
[S11] START round=24 head_norm_before_train=1.577895 cos_to_last_merge=0.9980 (last merge round=20)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.916988784918952, 'psi': 0.3320133550741517}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.9114543580452423, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=1.113336 cos_to_last_merge=0.9928 (last merge round=20)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.2390494768575989, 'auprc': 0.2390494768575989, 'loss_val': 1.1645119603642053, 'psi': 0.2390494768575989}-{'f1_val': 0.2396552741868839, 'auprc': 0.2396552741868839, 'loss_val': 1.1681868560574238, 'psi': 0.2396552741868839}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.730152 cos_to_last_merge=0.9583 (last merge round=15)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.316819566907143, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.238790852913041, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=1.562459 cos_to_last_merge=0.9839 (last merge round=17)
[S15] round=24 local utility u=0.042961 metrics={'f1_val': 0.616751573155862, 'auprc': 0.616751573155862, 'loss_val': 0.4320778571366473, 'psi': 0.616751573155862}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5167496413280492, 'psi': 0.6166125814646326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=24 head_norm_before_train=1.311208 cos_to_last_merge=0.9074 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.907
[S16] round=24 local utility u=0.011894 metrics={'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 2.784761933706922, 'psi': 0.0889745442865173}-{'f1_val': 0.07953617507757635, 'auprc': 0.07953617507757635, 'loss_val': 2.7236041334233287, 'psi': 0.07953617507757635}
[S16] not sending this round → trigger blocked (psi=0.089)
[S17] START round=24 head_norm_before_train=1.216682 cos_to_last_merge=0.9852 (last merge round=19)
[S17] round=24 local utility u=0.010863 metrics={'f1_val': 0.1553599683544304, 'auprc': 0.1553599683544304, 'loss_val': 1.015126856167337, 'psi': 0.1553599683544304}-{'f1_val': 0.15641178813221823, 'auprc': 0.15641178813221823, 'loss_val': 1.0463188389810247, 'psi': 0.15641178813221823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=25 head_norm_before_train=1.780427 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.2650570618114651, 'auprc': 0.2650570618114651, 'loss_val': 2.9662345177883247, 'psi': 0.2650570618114651}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.964054792984474, 'psi': 0.26542475888492534}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=1.789098 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.30163834022354924, 'auprc': 0.30163834022354924, 'loss_val': 3.0562245270274206, 'psi': 0.30163834022354924}-{'f1_val': 0.2806282722513089, 'auprc': 0.2806282722513089, 'loss_val': 2.803928097024604, 'psi': 0.2806282722513089}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.614418 cos_to_last_merge=0.9569 (last merge round=16)
[S4] round=25 local utility u=0.004594 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2238752251264216, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2330626590229647, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[S5] START round=25 head_norm_before_train=1.601807 cos_to_last_merge=0.9366 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.4056066359009516, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.222860748906117, 'psi': 0.33358943696313936}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.500801 cos_to_last_merge=0.9762 (last merge round=15)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.571482974312692, 'psi': 0.0}-{'f1_val': 0.02327704244637152, 'auprc': 0.02327704244637152, 'loss_val': 5.161412006491174, 'psi': 0.02327704244637152}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.328286 cos_to_last_merge=0.9831 (last merge round=20)
[S7] round=25 local utility u=0.154614 metrics={'f1_val': 0.22819335673778018, 'auprc': 0.22819335673778018, 'loss_val': 1.1674939367159385, 'psi': 0.22819335673778018}-{'f1_val': 0.19838178004195386, 'auprc': 0.19838178004195386, 'loss_val': 1.2084173161022989, 'psi': 0.19838178004195386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=25 head_norm_before_train=1.476569 cos_to_last_merge=0.9868 (last merge round=19)
[S8] round=25 local utility u=0.003804 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9660595553073635, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9736681252326345, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=25 head_norm_before_train=1.754275 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5509501899922076, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5099297628406068, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.792290 (no previous merge yet)
[S10] round=25 local utility u=0.012942 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.300283470677846, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.3261668108689397, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=25 head_norm_before_train=1.603042 cos_to_last_merge=0.9967 (last merge round=20)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.9669829475424687, 'psi': 0.3320907114010562}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.916988784918952, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.135044 cos_to_last_merge=0.9892 (last merge round=20)
[S13] round=25 local utility u=0.556198 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1400973490825923, 'psi': 0.3599362944611573}-{'f1_val': 0.2390494768575989, 'auprc': 0.2390494768575989, 'loss_val': 1.1645119603642053, 'psi': 0.2390494768575989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=25 head_norm_before_train=1.750281 cos_to_last_merge=0.9553 (last merge round=15)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.397613831418696, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.316819566907143, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=1.590590 cos_to_last_merge=0.9808 (last merge round=17)
[S15] round=25 local utility u=0.030534 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.37849618034164195, 'psi': 0.6175834097438502}-{'f1_val': 0.616751573155862, 'auprc': 0.616751573155862, 'loss_val': 0.4320778571366473, 'psi': 0.616751573155862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=25 head_norm_before_train=1.349083 cos_to_last_merge=0.8939 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.894
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.08857808857808858, 'auprc': 0.08857808857808858, 'loss_val': 2.9809137453944907, 'psi': 0.08857808857808858}-{'f1_val': 0.0889745442865173, 'auprc': 0.0889745442865173, 'loss_val': 2.784761933706922, 'psi': 0.0889745442865173}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.249753 cos_to_last_merge=0.9803 (last merge round=19)
[S17] round=25 local utility u=0.228958 metrics={'f1_val': 0.2045871550270835, 'auprc': 0.2045871550270835, 'loss_val': 1.0002558840670601, 'psi': 0.2045871550270835}-{'f1_val': 0.1553599683544304, 'auprc': 0.1553599683544304, 'loss_val': 1.015126856167337, 'psi': 0.1553599683544304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=26 head_norm_before_train=1.794500 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 2.919080586108653, 'psi': 0.2493174484983867}-{'f1_val': 0.2650570618114651, 'auprc': 0.2650570618114651, 'loss_val': 2.9662345177883247, 'psi': 0.2650570618114651}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.803795 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.28158743514233625, 'auprc': 0.28158743514233625, 'loss_val': 2.909326908152693, 'psi': 0.28158743514233625}-{'f1_val': 0.30163834022354924, 'auprc': 0.30163834022354924, 'loss_val': 3.0562245270274206, 'psi': 0.30163834022354924}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.637349 cos_to_last_merge=0.9540 (last merge round=16)
[S4] round=26 local utility u=0.000699 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2224762912410834, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2238752251264216, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=26 head_norm_before_train=1.622663 cos_to_last_merge=0.9328 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=26 local utility u=0.037265 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.326548305878827, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.4056066359009516, 'psi': 0.33358943696313936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=26 head_norm_before_train=1.519257 cos_to_last_merge=0.9741 (last merge round=15)
[S6] round=26 local utility u=0.248036 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.275090327097594, 'psi': 0.022186642268984445}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.571482974312692, 'psi': 0.0}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=26 head_norm_before_train=1.346481 cos_to_last_merge=0.9787 (last merge round=20)
[S7] round=26 local utility u=0.494535 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.1224457031222803, 'psi': 0.33308476261496395}-{'f1_val': 0.22819335673778018, 'auprc': 0.22819335673778018, 'loss_val': 1.1674939367159385, 'psi': 0.22819335673778018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=26 head_norm_before_train=1.501814 cos_to_last_merge=0.9831 (last merge round=19)
[S8] round=26 local utility u=0.002776 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9605080992721695, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9660595553073635, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=26 head_norm_before_train=1.764940 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5848424858151224, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5509501899922076, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=1.814325 (no previous merge yet)
[S10] round=26 local utility u=0.071448 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1573872426844525, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.300283470677846, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=26 head_norm_before_train=1.629535 cos_to_last_merge=0.9951 (last merge round=20)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.990346994346767, 'psi': 0.3320133550741517}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 2.9669829475424687, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.148797 cos_to_last_merge=0.9868 (last merge round=20)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.23988200589970501, 'auprc': 0.23988200589970501, 'loss_val': 1.1371344717619327, 'psi': 0.23988200589970501}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1400973490825923, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.767831 cos_to_last_merge=0.9526 (last merge round=15)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.480360745632499, 'psi': 0.13587634006482174}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.397613831418696, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.616808 cos_to_last_merge=0.9780 (last merge round=17)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3878673856349628, 'psi': 0.6166125814646326}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.37849618034164195, 'psi': 0.6175834097438502}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.383773 cos_to_last_merge=0.8831 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.883
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.06512640214297673, 'auprc': 0.06512640214297673, 'loss_val': 3.247067782509739, 'psi': 0.06512640214297673}-{'f1_val': 0.08857808857808858, 'auprc': 0.08857808857808858, 'loss_val': 2.9809137453944907, 'psi': 0.08857808857808858}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.279469 cos_to_last_merge=0.9758 (last merge round=19)
[S17] round=26 local utility u=0.079454 metrics={'f1_val': 0.220237401861786, 'auprc': 0.220237401861786, 'loss_val': 0.9821992212874999, 'psi': 0.220237401861786}-{'f1_val': 0.2045871550270835, 'auprc': 0.2045871550270835, 'loss_val': 1.0002558840670601, 'psi': 0.2045871550270835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=27 head_norm_before_train=1.807869 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.2486232287605965, 'auprc': 0.2486232287605965, 'loss_val': 2.941612255573358, 'psi': 0.2486232287605965}-{'f1_val': 0.2493174484983867, 'auprc': 0.2493174484983867, 'loss_val': 2.919080586108653, 'psi': 0.2493174484983867}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.815889 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.28677839851024206, 'auprc': 0.28677839851024206, 'loss_val': 3.0040476361305304, 'psi': 0.28677839851024206}-{'f1_val': 0.28158743514233625, 'auprc': 0.28158743514233625, 'loss_val': 2.909326908152693, 'psi': 0.28158743514233625}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.658820 cos_to_last_merge=0.9511 (last merge round=16)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2276110095213972, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2224762912410834, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.640061 cos_to_last_merge=0.9300 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=27 local utility u=0.029062 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.2684249361487336, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.326548305878827, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=27 head_norm_before_train=1.534265 cos_to_last_merge=0.9724 (last merge round=15)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.467830442444018, 'psi': 0.021310724106324473}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 5.275090327097594, 'psi': 0.022186642268984445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.364034 cos_to_last_merge=0.9748 (last merge round=20)
[S7] round=27 local utility u=0.013254 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0959376507687455, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.1224457031222803, 'psi': 0.33308476261496395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=27 head_norm_before_train=1.527412 cos_to_last_merge=0.9801 (last merge round=19)
[S8] round=27 local utility u=0.000293 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9599215107227858, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9605080992721695, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=27 head_norm_before_train=1.774688 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.613454290157965, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5848424858151224, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.838553 (no previous merge yet)
[S10] round=27 local utility u=0.032689 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0920093004281726, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.1573872426844525, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=27 head_norm_before_train=1.655047 cos_to_last_merge=0.9934 (last merge round=20)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.0512141323052493, 'psi': 0.3320907114010562}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 2.990346994346767, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.166438 cos_to_last_merge=0.9838 (last merge round=20)
[S13] round=27 local utility u=0.547062 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1234990728358045, 'psi': 0.3599362944611573}-{'f1_val': 0.23988200589970501, 'auprc': 0.23988200589970501, 'loss_val': 1.1371344717619327, 'psi': 0.23988200589970501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=27 head_norm_before_train=1.783223 cos_to_last_merge=0.9502 (last merge round=15)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.55576395884079, 'psi': 0.13572854291417166}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.480360745632499, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.640286 cos_to_last_merge=0.9754 (last merge round=17)
[S15] round=27 local utility u=0.053881 metrics={'f1_val': 0.6184116401038557, 'auprc': 0.6184116401038557, 'loss_val': 0.29629668962341893, 'psi': 0.6184116401038557}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3878673856349628, 'psi': 0.6166125814646326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=27 head_norm_before_train=1.415299 cos_to_last_merge=0.8742 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.874
[S16] round=27 local utility u=0.302666 metrics={'f1_val': 0.09919697685403873, 'auprc': 0.09919697685403873, 'loss_val': 2.9483704656446448, 'psi': 0.09919697685403873}-{'f1_val': 0.06512640214297673, 'auprc': 0.06512640214297673, 'loss_val': 3.247067782509739, 'psi': 0.06512640214297673}
[S16] not sending this round → trigger blocked (psi=0.099)
[S17] START round=27 head_norm_before_train=1.305224 cos_to_last_merge=0.9720 (last merge round=19)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.2041921164103614, 'auprc': 0.2041921164103614, 'loss_val': 0.9979346352429309, 'psi': 0.2041921164103614}-{'f1_val': 0.220237401861786, 'auprc': 0.220237401861786, 'loss_val': 0.9821992212874999, 'psi': 0.220237401861786}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=28 head_norm_before_train=1.820060 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.2511406962935184, 'auprc': 0.2511406962935184, 'loss_val': 2.9654817281101877, 'psi': 0.2511406962935184}-{'f1_val': 0.2486232287605965, 'auprc': 0.2486232287605965, 'loss_val': 2.941612255573358, 'psi': 0.2486232287605965}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=1.827416 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.2891748675246026, 'auprc': 0.2891748675246026, 'loss_val': 3.2616520889180216, 'psi': 0.2891748675246026}-{'f1_val': 0.28677839851024206, 'auprc': 0.28677839851024206, 'loss_val': 3.0040476361305304, 'psi': 0.28677839851024206}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.675611 cos_to_last_merge=0.9488 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.23454172703482, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2276110095213972, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.657062 cos_to_last_merge=0.9271 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.3422676340805504, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.2684249361487336, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.551317 cos_to_last_merge=0.9705 (last merge round=15)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.4873602563533215, 'psi': 0.021967963386727688}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.467830442444018, 'psi': 0.021310724106324473}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.376529 cos_to_last_merge=0.9707 (last merge round=20)
[S7] round=28 local utility u=0.016837 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0622632479376974, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0959376507687455, 'psi': 0.33308476261496395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=28 head_norm_before_train=1.552201 cos_to_last_merge=0.9775 (last merge round=19)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9659086185539059, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9599215107227858, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.783677 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6419882695809584, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.613454290157965, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.868282 (no previous merge yet)
[S10] round=28 local utility u=0.035329 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0213510176159186, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0920093004281726, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=28 head_norm_before_train=1.679023 cos_to_last_merge=0.9916 (last merge round=20)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.077056546777329, 'psi': 0.3320133550741517}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.0512141323052493, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=1.185893 cos_to_last_merge=0.9804 (last merge round=20)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1252565749048478, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1234990728358045, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.797403 cos_to_last_merge=0.9481 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.622134539908292, 'psi': 0.1355297641332834}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.55576395884079, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.662594 cos_to_last_merge=0.9730 (last merge round=17)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.2927732142493172, 'psi': 0.6175834097438502}-{'f1_val': 0.6184116401038557, 'auprc': 0.6184116401038557, 'loss_val': 0.29629668962341893, 'psi': 0.6184116401038557}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.442671 cos_to_last_merge=0.8669 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.867
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 3.2874869658063757, 'psi': 0.08994708994708994}-{'f1_val': 0.09919697685403873, 'auprc': 0.09919697685403873, 'loss_val': 2.9483704656446448, 'psi': 0.09919697685403873}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.330780 cos_to_last_merge=0.9682 (last merge round=19)
[S17] round=28 local utility u=0.005535 metrics={'f1_val': 0.20366741048413925, 'auprc': 0.20366741048413925, 'loss_val': 0.9821419313286301, 'psi': 0.20366741048413925}-{'f1_val': 0.2041921164103614, 'auprc': 0.2041921164103614, 'loss_val': 0.9979346352429309, 'psi': 0.2041921164103614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=29 head_norm_before_train=1.831909 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.20564301467792226, 'auprc': 0.20564301467792226, 'loss_val': 3.4549393421688004, 'psi': 0.20564301467792226}-{'f1_val': 0.2511406962935184, 'auprc': 0.2511406962935184, 'loss_val': 2.9654817281101877, 'psi': 0.2511406962935184}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.838634 (no previous merge yet)
[S3] round=29 local utility u=0.102157 metrics={'f1_val': 0.2891827444179493, 'auprc': 0.2891827444179493, 'loss_val': 3.057408738190123, 'psi': 0.2891827444179493}-{'f1_val': 0.2891748675246026, 'auprc': 0.2891748675246026, 'loss_val': 3.2616520889180216, 'psi': 0.2891748675246026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=29 head_norm_before_train=1.690569 cos_to_last_merge=0.9471 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2471661368514548, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.23454172703482, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.675420 cos_to_last_merge=0.9241 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.924
[S5] round=29 local utility u=0.002770 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.336727646118788, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.3422676340805504, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=29 head_norm_before_train=1.568771 cos_to_last_merge=0.9685 (last merge round=15)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.779830768972846, 'psi': 0.017551963048498844}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.4873602563533215, 'psi': 0.021967963386727688}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.390486 cos_to_last_merge=0.9667 (last merge round=20)
[S7] round=29 local utility u=0.017225 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0278125250313714, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0622632479376974, 'psi': 0.33308476261496395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=29 head_norm_before_train=1.575146 cos_to_last_merge=0.9752 (last merge round=19)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9757659014773653, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9659086185539059, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.792212 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.671334625905163, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6419882695809584, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.901372 (no previous merge yet)
[S10] round=29 local utility u=0.006109 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0091334641527405, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0213510176159186, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=29 head_norm_before_train=1.699715 cos_to_last_merge=0.9901 (last merge round=20)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.118271730467226, 'psi': 0.3320907114010562}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.077056546777329, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=1.204154 cos_to_last_merge=0.9769 (last merge round=20)
[S13] round=29 local utility u=0.010865 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.103525859678104, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1252565749048478, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=29 head_norm_before_train=1.810472 cos_to_last_merge=0.9461 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.687484425345377, 'psi': 0.13572854291417166}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.622134539908292, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.686204 cos_to_last_merge=0.9704 (last merge round=17)
[S15] round=29 local utility u=0.007517 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.2777391905103077, 'psi': 0.6175834097438502}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.2927732142493172, 'psi': 0.6175834097438502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=29 head_norm_before_train=1.467054 cos_to_last_merge=0.8609 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.861
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 3.318640746841385, 'psi': 0.09022435897435897}-{'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 3.2874869658063757, 'psi': 0.08994708994708994}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.352649 cos_to_last_merge=0.9650 (last merge round=19)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.17489955477283328, 'auprc': 0.17489955477283328, 'loss_val': 0.9294585995729779, 'psi': 0.17489955477283328}-{'f1_val': 0.20366741048413925, 'auprc': 0.20366741048413925, 'loss_val': 0.9821419313286301, 'psi': 0.20366741048413925}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.841855 (no previous merge yet)
[S2] round=30 local utility u=0.447230 metrics={'f1_val': 0.25915892672858615, 'auprc': 0.25915892672858615, 'loss_val': 3.0421224294103872, 'psi': 0.25915892672858615}-{'f1_val': 0.20564301467792226, 'auprc': 0.20564301467792226, 'loss_val': 3.4549393421688004, 'psi': 0.20564301467792226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=30 head_norm_before_train=1.848466 (no previous merge yet)
[S3] round=30 local utility u=0.002068 metrics={'f1_val': 0.29581754698759377, 'auprc': 0.29581754698759377, 'loss_val': 3.1129860589897334, 'psi': 0.29581754698759377}-{'f1_val': 0.2891827444179493, 'auprc': 0.2891827444179493, 'loss_val': 3.057408738190123, 'psi': 0.2891827444179493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=30 head_norm_before_train=1.706488 cos_to_last_merge=0.9453 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2637802305297623, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2471661368514548, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.693644 cos_to_last_merge=0.9210 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.921
[S5] round=30 local utility u=0.162659 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0151965434410894, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.336727646118788, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=30 head_norm_before_train=1.583789 cos_to_last_merge=0.9667 (last merge round=15)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 5.859366533261869, 'psi': 0.01799723119520074}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 5.779830768972846, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.408253 cos_to_last_merge=0.9627 (last merge round=20)
[S7] round=30 local utility u=0.030393 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9670269049528166, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0278125250313714, 'psi': 0.33308476261496395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=30 head_norm_before_train=1.596001 cos_to_last_merge=0.9730 (last merge round=19)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9984374316648836, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9757659014773653, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.800500 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6998073103460407, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.671334625905163, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.933558 (no previous merge yet)
[S10] round=30 local utility u=0.031866 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.94540153338423, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0091334641527405, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=30 head_norm_before_train=1.719594 cos_to_last_merge=0.9886 (last merge round=20)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.1676729603590674, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.118271730467226, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.219241 cos_to_last_merge=0.9740 (last merge round=20)
[S13] round=30 local utility u=0.002157 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0992110445467866, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.103525859678104, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=30 head_norm_before_train=1.822303 cos_to_last_merge=0.9443 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.751675814700862, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.687484425345377, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.708810 cos_to_last_merge=0.9680 (last merge round=17)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.28981635486551466, 'psi': 0.6173065327346117}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.2777391905103077, 'psi': 0.6175834097438502}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.488564 cos_to_last_merge=0.8557 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.058250783168233004, 'auprc': 0.058250783168233004, 'loss_val': 3.7974290605844963, 'psi': 0.058250783168233004}-{'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 3.318640746841385, 'psi': 0.09022435897435897}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.371227 cos_to_last_merge=0.9625 (last merge round=19)
[S17] round=30 local utility u=0.261501 metrics={'f1_val': 0.23184159652859312, 'auprc': 0.23184159652859312, 'loss_val': 0.9189347342678523, 'psi': 0.23184159652859315}-{'f1_val': 0.17489955477283328, 'auprc': 0.17489955477283328, 'loss_val': 0.9294585995729779, 'psi': 0.17489955477283328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=31 head_norm_before_train=1.851231 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.24602008327210387, 'auprc': 0.24602008327210387, 'loss_val': 3.031308937222349, 'psi': 0.2460200832721039}-{'f1_val': 0.25915892672858615, 'auprc': 0.25915892672858615, 'loss_val': 3.0421224294103872, 'psi': 0.25915892672858615}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.858243 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.29997720537953043, 'auprc': 0.29997720537953043, 'loss_val': 3.162686892744166, 'psi': 0.29997720537953043}-{'f1_val': 0.29581754698759377, 'auprc': 0.29581754698759377, 'loss_val': 3.1129860589897334, 'psi': 0.29581754698759377}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.724020 cos_to_last_merge=0.9431 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.943
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2807506324752462, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2637802305297623, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.708210 cos_to_last_merge=0.9185 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=31 local utility u=0.203967 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.6027346779130782, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.0151965434410894, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=31 head_norm_before_train=1.597378 cos_to_last_merge=0.9651 (last merge round=15)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.002066843647352, 'psi': 0.01732902033271719}-{'f1_val': 0.01799723119520074, 'auprc': 0.01799723119520074, 'loss_val': 5.859366533261869, 'psi': 0.01799723119520074}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.429704 cos_to_last_merge=0.9590 (last merge round=20)
[S7] round=31 local utility u=0.019406 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9282150227484541, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9670269049528166, 'psi': 0.33308476261496395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=31 head_norm_before_train=1.618524 cos_to_last_merge=0.9707 (last merge round=19)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0291845223040381, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9984374316648836, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.808353 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.73372210707628, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6998073103460407, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.963422 (no previous merge yet)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9515137987404285, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.94540153338423, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=1.737768 cos_to_last_merge=0.9872 (last merge round=20)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.203564717094419, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.1676729603590674, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.230956 cos_to_last_merge=0.9717 (last merge round=20)
[S13] round=31 local utility u=0.013973 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0712659049728783, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0992110445467866, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=31 head_norm_before_train=1.833165 cos_to_last_merge=0.9426 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.812489825133188, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 4.751675814700862, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=1.731208 cos_to_last_merge=0.9657 (last merge round=17)
[S15] round=31 local utility u=0.166314 metrics={'f1_val': 0.6431421509615342, 'auprc': 0.6431421509615342, 'loss_val': 0.18970963624712375, 'psi': 0.6431421509615342}-{'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.28981635486551466, 'psi': 0.6173065327346117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=31 head_norm_before_train=1.507957 cos_to_last_merge=0.8513 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.851
[S16] round=31 local utility u=0.085563 metrics={'f1_val': 0.07575384109769123, 'auprc': 0.07575384109769123, 'loss_val': 3.7838304946828565, 'psi': 0.07575384109769123}-{'f1_val': 0.058250783168233004, 'auprc': 0.058250783168233004, 'loss_val': 3.7974290605844963, 'psi': 0.058250783168233004}
[S16] not sending this round → trigger blocked (psi=0.076)
[S17] START round=31 head_norm_before_train=1.384612 cos_to_last_merge=0.9606 (last merge round=19)
[S17] round=31 local utility u=0.072254 metrics={'f1_val': 0.2498497135028436, 'auprc': 0.2498497135028436, 'loss_val': 0.9364996924759541, 'psi': 0.24984971350284363}-{'f1_val': 0.23184159652859312, 'auprc': 0.23184159652859312, 'loss_val': 0.9189347342678523, 'psi': 0.23184159652859315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=32 head_norm_before_train=1.860754 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.26007105033849454, 'auprc': 0.26007105033849454, 'loss_val': 3.2587293014512175, 'psi': 0.26007105033849454}-{'f1_val': 0.24602008327210387, 'auprc': 0.24602008327210387, 'loss_val': 3.031308937222349, 'psi': 0.2460200832721039}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.867673 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.2816842105263158, 'auprc': 0.2816842105263158, 'loss_val': 3.0346538568996944, 'psi': 0.2816842105263158}-{'f1_val': 0.29997720537953043, 'auprc': 0.29997720537953043, 'loss_val': 3.162686892744166, 'psi': 0.29997720537953043}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.736243 cos_to_last_merge=0.9417 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.294747495988692, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2807506324752462, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.724270 cos_to_last_merge=0.9160 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.916
[S5] round=32 local utility u=0.073913 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.4549093750960425, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.6027346779130782, 'psi': 0.33300395256917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=32 head_norm_before_train=1.609637 cos_to_last_merge=0.9637 (last merge round=15)
[S6] round=32 local utility u=0.055041 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.929794222553977, 'psi': 0.02153000458085204}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.002066843647352, 'psi': 0.01732902033271719}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=32 head_norm_before_train=1.443214 cos_to_last_merge=0.9557 (last merge round=20)
[S7] round=32 local utility u=0.012596 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9030237904594408, 'psi': 0.33308476261496395}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9282150227484541, 'psi': 0.33308476261496395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=32 head_norm_before_train=1.636904 cos_to_last_merge=0.9694 (last merge round=19)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0663352443340202, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0291845223040381, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.816244 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.76158485239413, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.73372210707628, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.991329 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9568642289665414, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9515137987404285, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.754318 cos_to_last_merge=0.9859 (last merge round=20)
[S11] round=32 local utility u=0.002305 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.198258549177577, 'psi': 0.3320133550741517}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.203564717094419, 'psi': 0.3320907114010562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=32 head_norm_before_train=1.239090 cos_to_last_merge=0.9701 (last merge round=20)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.08096586279314, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0712659049728783, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.843477 cos_to_last_merge=0.9411 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.877928950165985, 'psi': 0.1355297641332834}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 4.812489825133188, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.751160 cos_to_last_merge=0.9636 (last merge round=17)
[S15] round=32 local utility u=0.032326 metrics={'f1_val': 0.6480131249011519, 'auprc': 0.6480131249011519, 'loss_val': 0.16889679510710368, 'psi': 0.6480131249011519}-{'f1_val': 0.6431421509615342, 'auprc': 0.6431421509615342, 'loss_val': 0.18970963624712375, 'psi': 0.6431421509615342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=32 head_norm_before_train=1.524109 cos_to_last_merge=0.8478 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.848
[S16] round=32 local utility u=0.460242 metrics={'f1_val': 0.11945962355798422, 'auprc': 0.11945962355798422, 'loss_val': 3.256697675164857, 'psi': 0.11945962355798422}-{'f1_val': 0.07575384109769123, 'auprc': 0.07575384109769123, 'loss_val': 3.7838304946828565, 'psi': 0.07575384109769123}
[S16] not sending this round → trigger blocked (psi=0.119)
[S17] START round=32 head_norm_before_train=1.397191 cos_to_last_merge=0.9590 (last merge round=19)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.1811662645693543, 'auprc': 0.1811662645693543, 'loss_val': 0.952578901713548, 'psi': 0.1811662645693543}-{'f1_val': 0.2498497135028436, 'auprc': 0.2498497135028436, 'loss_val': 0.9364996924759541, 'psi': 0.24984971350284363}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.868846 (no previous merge yet)
[S2] round=33 local utility u=0.000252 metrics={'f1_val': 0.2607240848557853, 'auprc': 0.2607240848557853, 'loss_val': 3.2641032368612395, 'psi': 0.2607240848557853}-{'f1_val': 0.26007105033849454, 'auprc': 0.26007105033849454, 'loss_val': 3.2587293014512175, 'psi': 0.26007105033849454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=33 head_norm_before_train=1.875362 (no previous merge yet)
[S3] round=33 local utility u=0.001346 metrics={'f1_val': 0.30200355844356774, 'auprc': 0.30200355844356774, 'loss_val': 3.214835732790005, 'psi': 0.30200355844356774}-{'f1_val': 0.2816842105263158, 'auprc': 0.2816842105263158, 'loss_val': 3.0346538568996944, 'psi': 0.2816842105263158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=33 head_norm_before_train=1.748198 cos_to_last_merge=0.9404 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.307452433782591, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.294747495988692, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.743502 cos_to_last_merge=0.9133 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=33 local utility u=0.090407 metrics={'f1_val': 0.33384517233783456, 'auprc': 0.33384517233783456, 'loss_val': 1.2816670806046158, 'psi': 0.33384517233783456}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 1.4549093750960425, 'psi': 0.33300395256917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=33 head_norm_before_train=1.620576 cos_to_last_merge=0.9624 (last merge round=15)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.1456651173878125, 'psi': 0.017774699907663897}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.929794222553977, 'psi': 0.02153000458085204}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.453970 cos_to_last_merge=0.9519 (last merge round=20)
[S7] round=33 local utility u=0.017880 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8665179258267445, 'psi': 0.3330019880715706}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 0.9030237904594408, 'psi': 0.33308476261496395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=33 head_norm_before_train=1.654220 cos_to_last_merge=0.9680 (last merge round=19)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1097766101241568, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0663352443340202, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.823571 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.787834631760261, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.76158485239413, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=2.016883 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9703848288896557, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9568642289665414, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.769056 cos_to_last_merge=0.9848 (last merge round=20)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.235739731517296, 'psi': 0.3320133550741517}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.198258549177577, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.247207 cos_to_last_merge=0.9683 (last merge round=20)
[S13] round=33 local utility u=0.003507 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0739525462913602, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.08096586279314, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=33 head_norm_before_train=1.852944 cos_to_last_merge=0.9396 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.9321860690666055, 'psi': 0.13587634006482174}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 4.877928950165985, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.769661 cos_to_last_merge=0.9618 (last merge round=17)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6238427233287732, 'auprc': 0.6238427233287732, 'loss_val': 0.18068892985794865, 'psi': 0.6238427233287732}-{'f1_val': 0.6480131249011519, 'auprc': 0.6480131249011519, 'loss_val': 0.16889679510710368, 'psi': 0.6480131249011519}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.539251 cos_to_last_merge=0.8447 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.845
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.08911368015414257, 'auprc': 0.08911368015414257, 'loss_val': 3.8675375677032844, 'psi': 0.08911368015414257}-{'f1_val': 0.11945962355798422, 'auprc': 0.11945962355798422, 'loss_val': 3.256697675164857, 'psi': 0.11945962355798422}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.413459 cos_to_last_merge=0.9571 (last merge round=19)
[S17] round=33 local utility u=0.217770 metrics={'f1_val': 0.2352724953214894, 'auprc': 0.2352724953214894, 'loss_val': 1.0039948091826747, 'psi': 0.23527249532148936}-{'f1_val': 0.1811662645693543, 'auprc': 0.1811662645693543, 'loss_val': 0.952578901713548, 'psi': 0.1811662645693543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=34 head_norm_before_train=1.875864 (no previous merge yet)
[S2] round=34 local utility u=0.043244 metrics={'f1_val': 0.248116586390021, 'auprc': 0.248116586390021, 'loss_val': 3.0641485659974412, 'psi': 0.248116586390021}-{'f1_val': 0.2607240848557853, 'auprc': 0.2607240848557853, 'loss_val': 3.2641032368612395, 'psi': 0.2607240848557853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=34 head_norm_before_train=1.883192 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.30163575174141033, 'auprc': 0.30163575174141033, 'loss_val': 3.2509586564739936, 'psi': 0.30163575174141033}-{'f1_val': 0.30200355844356774, 'auprc': 0.30200355844356774, 'loss_val': 3.214835732790005, 'psi': 0.30200355844356774}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.758328 cos_to_last_merge=0.9390 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3255035577909424, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.307452433782591, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.763513 cos_to_last_merge=0.9103 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.910
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3346842718298295, 'auprc': 0.3346842718298295, 'loss_val': 1.4087647394903857, 'psi': 0.3346842718298295}-{'f1_val': 0.33384517233783456, 'auprc': 0.33384517233783456, 'loss_val': 1.2816670806046158, 'psi': 0.33384517233783456}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.632384 cos_to_last_merge=0.9611 (last merge round=15)
[S6] round=34 local utility u=0.375305 metrics={'f1_val': 0.05113880532874946, 'auprc': 0.05113880532874946, 'loss_val': 5.695331343623331, 'psi': 0.05113880532874946}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.1456651173878125, 'psi': 0.017774699907663897}
[S6] not sending this round → trigger blocked (psi=0.051)
[S7] START round=34 head_norm_before_train=1.464892 cos_to_last_merge=0.9484 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=34 local utility u=0.015008 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8365013758239171, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8665179258267445, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=34 head_norm_before_train=1.670778 cos_to_last_merge=0.9660 (last merge round=19)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1595317873105597, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1097766101241568, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.830606 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8145185440441964, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.787834631760261, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=2.039461 (no previous merge yet)
[S10] round=34 local utility u=0.000982 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.968420043786281, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9703848288896557, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=34 head_norm_before_train=1.783213 cos_to_last_merge=0.9837 (last merge round=20)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.2827534040644535, 'psi': 0.3320907114010562}-{'f1_val': 0.3320133550741517, 'auprc': 0.3320133550741517, 'loss_val': 3.235739731517296, 'psi': 0.3320133550741517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.255496 cos_to_last_merge=0.9664 (last merge round=20)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.083565829234526, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0739525462913602, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.861956 cos_to_last_merge=0.9383 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.980399367472245, 'psi': 0.13582554517133957}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 4.9321860690666055, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.787902 cos_to_last_merge=0.9599 (last merge round=17)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.617721697935218, 'auprc': 0.617721697935218, 'loss_val': 0.21586402339367747, 'psi': 0.617721697935218}-{'f1_val': 0.6238427233287732, 'auprc': 0.6238427233287732, 'loss_val': 0.18068892985794865, 'psi': 0.6238427233287732}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.553707 cos_to_last_merge=0.8418 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.842
[S16] round=34 local utility u=0.158285 metrics={'f1_val': 0.09059623849539816, 'auprc': 0.09059623849539816, 'loss_val': 3.5643103667385474, 'psi': 0.09059623849539816}-{'f1_val': 0.08911368015414257, 'auprc': 0.08911368015414257, 'loss_val': 3.8675375677032844, 'psi': 0.08911368015414257}
[S16] not sending this round → trigger blocked (psi=0.091)
[S17] START round=34 head_norm_before_train=1.427577 cos_to_last_merge=0.9555 (last merge round=19)
[S17] round=34 local utility u=0.130922 metrics={'f1_val': 0.26312629445788716, 'auprc': 0.26312629445788716, 'loss_val': 0.9928341735949102, 'psi': 0.26312629445788716}-{'f1_val': 0.2352724953214894, 'auprc': 0.2352724953214894, 'loss_val': 1.0039948091826747, 'psi': 0.23527249532148936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=35 head_norm_before_train=1.882813 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.24830058089234952, 'auprc': 0.24830058089234952, 'loss_val': 3.0774064941994084, 'psi': 0.24830058089234952}-{'f1_val': 0.248116586390021, 'auprc': 0.248116586390021, 'loss_val': 3.0641485659974412, 'psi': 0.248116586390021}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.891439 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.28305084745762715, 'auprc': 0.28305084745762715, 'loss_val': 3.0968354858436102, 'psi': 0.28305084745762715}-{'f1_val': 0.30163575174141033, 'auprc': 0.30163575174141033, 'loss_val': 3.2509586564739936, 'psi': 0.30163575174141033}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.768423 cos_to_last_merge=0.9377 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3421621043721472, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3255035577909424, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.779462 cos_to_last_merge=0.9082 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.908
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3359389630513503, 'auprc': 0.3359389630513503, 'loss_val': 1.5672193148121918, 'psi': 0.3359389630513503}-{'f1_val': 0.3346842718298295, 'auprc': 0.3346842718298295, 'loss_val': 1.4087647394903857, 'psi': 0.3346842718298295}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.644701 cos_to_last_merge=0.9597 (last merge round=15)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.006146572104018913, 'auprc': 0.006146572104018913, 'loss_val': 6.372866605993367, 'psi': 0.006146572104018913}-{'f1_val': 0.05113880532874946, 'auprc': 0.05113880532874946, 'loss_val': 5.695331343623331, 'psi': 0.05113880532874946}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.478381 cos_to_last_merge=0.9452 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=35 local utility u=0.003513 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8294755968107312, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8365013758239171, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=35 head_norm_before_train=1.684688 cos_to_last_merge=0.9640 (last merge round=19)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2057203428269603, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1595317873105597, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.837521 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.839824469336254, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8145185440441964, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=2.059987 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.3329354659027612, 'auprc': 0.3329354659027612, 'loss_val': 1.9740364287696721, 'psi': 0.3329354659027612}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.968420043786281, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.796587 cos_to_last_merge=0.9826 (last merge round=20)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.3058149602800446, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.2827534040644535, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.263661 cos_to_last_merge=0.9648 (last merge round=20)
[S13] round=35 local utility u=0.018052 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.04746222382278, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.083565829234526, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=35 head_norm_before_train=1.870658 cos_to_last_merge=0.9370 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.024611815268493, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 4.980399367472245, 'psi': 0.13582554517133957}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.803720 cos_to_last_merge=0.9583 (last merge round=17)
[S15] round=35 local utility u=0.250380 metrics={'f1_val': 0.6641145939928008, 'auprc': 0.6641145939928008, 'loss_val': 0.13263986286395818, 'psi': 0.6641145939928008}-{'f1_val': 0.617721697935218, 'auprc': 0.617721697935218, 'loss_val': 0.21586402339367747, 'psi': 0.617721697935218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=35 head_norm_before_train=1.566188 cos_to_last_merge=0.8393 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.839
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 3.8717248429453903, 'psi': 0.08994708994708994}-{'f1_val': 0.09059623849539816, 'auprc': 0.09059623849539816, 'loss_val': 3.5643103667385474, 'psi': 0.09059623849539816}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.442891 cos_to_last_merge=0.9537 (last merge round=19)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.26082299375410406, 'auprc': 0.26082299375410406, 'loss_val': 1.034031714410089, 'psi': 0.26082299375410406}-{'f1_val': 0.26312629445788716, 'auprc': 0.26312629445788716, 'loss_val': 0.9928341735949102, 'psi': 0.26312629445788716}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.889862 (no previous merge yet)
[S2] round=36 local utility u=0.032441 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 3.166641613404147, 'psi': 0.26542475888492534}-{'f1_val': 0.24830058089234952, 'auprc': 0.24830058089234952, 'loss_val': 3.0774064941994084, 'psi': 0.24830058089234952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=36 head_norm_before_train=1.899156 (no previous merge yet)
[S3] round=36 local utility u=0.010101 metrics={'f1_val': 0.2928937728937729, 'auprc': 0.2928937728937729, 'loss_val': 3.165219859417539, 'psi': 0.2928937728937729}-{'f1_val': 0.28305084745762715, 'auprc': 0.28305084745762715, 'loss_val': 3.0968354858436102, 'psi': 0.28305084745762715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=36 head_norm_before_train=1.779878 cos_to_last_merge=0.9365 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.937
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3585123988230663, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3421621043721472, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.794812 cos_to_last_merge=0.9065 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.33635614196787095, 'auprc': 0.33635614196787095, 'loss_val': 1.7651046723709118, 'psi': 0.33635614196787095}-{'f1_val': 0.3359389630513503, 'auprc': 0.3359389630513503, 'loss_val': 1.5672193148121918, 'psi': 0.3359389630513503}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.655822 cos_to_last_merge=0.9584 (last merge round=15)
[S6] round=36 local utility u=0.285357 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.973878876860814, 'psi': 0.025227272727272727}-{'f1_val': 0.006146572104018913, 'auprc': 0.006146572104018913, 'loss_val': 6.372866605993367, 'psi': 0.006146572104018913}
[S6] not sending this round → trigger blocked (psi=0.025)
[S7] START round=36 head_norm_before_train=1.494109 cos_to_last_merge=0.9419 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.942
[S7] round=36 local utility u=0.016804 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7958668730386242, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8294755968107312, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=36 head_norm_before_train=1.698578 cos_to_last_merge=0.9626 (last merge round=19)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2546485138481585, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2057203428269603, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.844198 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.86523473492006, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.839824469336254, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.078242 (no previous merge yet)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 1.993736978083722, 'psi': 0.3327765847450887}-{'f1_val': 0.3329354659027612, 'auprc': 0.3329354659027612, 'loss_val': 1.9740364287696721, 'psi': 0.3329354659027612}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.808632 cos_to_last_merge=0.9817 (last merge round=20)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.327222342342015, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.3058149602800446, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.270911 cos_to_last_merge=0.9635 (last merge round=20)
[S13] round=36 local utility u=0.011031 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0253993652249938, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.04746222382278, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=36 head_norm_before_train=1.879091 cos_to_last_merge=0.9358 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.064483340841857, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.024611815268493, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.820060 cos_to_last_merge=0.9566 (last merge round=17)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6538894972593393, 'auprc': 0.6538894972593393, 'loss_val': 0.14602844403522494, 'psi': 0.6538894972593393}-{'f1_val': 0.6641145939928008, 'auprc': 0.6641145939928008, 'loss_val': 0.13263986286395818, 'psi': 0.6641145939928008}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.577517 cos_to_last_merge=0.8372 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.837
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.07821960399279987, 'auprc': 0.07821960399279987, 'loss_val': 4.122319154780728, 'psi': 0.07821960399279987}-{'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 3.8717248429453903, 'psi': 0.08994708994708994}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.456709 cos_to_last_merge=0.9521 (last merge round=19)
[S17] round=36 local utility u=0.057804 metrics={'f1_val': 0.2721544325370249, 'auprc': 0.2721544325370249, 'loss_val': 1.02040600429702, 'psi': 0.2721544325370249}-{'f1_val': 0.26082299375410406, 'auprc': 0.26082299375410406, 'loss_val': 1.034031714410089, 'psi': 0.26082299375410406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=37 head_norm_before_train=1.896517 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 3.1856616212288595, 'psi': 0.26542475888492534}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 3.166641613404147, 'psi': 0.26542475888492534}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.906598 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.3020351526364477, 'auprc': 0.3020351526364477, 'loss_val': 3.253702514338188, 'psi': 0.3020351526364477}-{'f1_val': 0.2928937728937729, 'auprc': 0.2928937728937729, 'loss_val': 3.165219859417539, 'psi': 0.2928937728937729}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.789450 cos_to_last_merge=0.9354 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3764151041205719, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3585123988230663, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.807801 cos_to_last_merge=0.9054 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.905
[S5] round=37 local utility u=0.050397 metrics={'f1_val': 0.3371889285055583, 'auprc': 0.3371889285055583, 'loss_val': 1.671806147396759, 'psi': 0.3371889285055583}-{'f1_val': 0.33635614196787095, 'auprc': 0.33635614196787095, 'loss_val': 1.7651046723709118, 'psi': 0.33635614196787095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=37 head_norm_before_train=1.665074 cos_to_last_merge=0.9574 (last merge round=15)
[S6] round=37 local utility u=0.056826 metrics={'f1_val': 0.029927992799279927, 'auprc': 0.029927992799279927, 'loss_val': 5.9025326354793535, 'psi': 0.029927992799279927}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.973878876860814, 'psi': 0.025227272727272727}
[S6] not sending this round → trigger blocked (psi=0.030)
[S7] START round=37 head_norm_before_train=1.508007 cos_to_last_merge=0.9391 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.7538863825065715, 'psi': 0.2496892866020383}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7958668730386242, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.714205 cos_to_last_merge=0.9614 (last merge round=19)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3019836887254015, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2546485138481585, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.850752 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8881101823829916, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.86523473492006, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.094744 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 2.027519745190227, 'psi': 0.3327765847450887}-{'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 1.993736978083722, 'psi': 0.3327765847450887}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.819802 cos_to_last_merge=0.9808 (last merge round=20)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.3454352680043615, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.327222342342015, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.281561 cos_to_last_merge=0.9617 (last merge round=20)
[S13] round=37 local utility u=0.019681 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9860375112833674, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0253993652249938, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=37 head_norm_before_train=1.887365 cos_to_last_merge=0.9346 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.935
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.107496572561814, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.064483340841857, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.835771 cos_to_last_merge=0.9550 (last merge round=17)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.620874926809888, 'auprc': 0.620874926809888, 'loss_val': 0.1690482783209506, 'psi': 0.620874926809888}-{'f1_val': 0.6538894972593393, 'auprc': 0.6538894972593393, 'loss_val': 0.14602844403522494, 'psi': 0.6538894972593393}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.588544 cos_to_last_merge=0.8351 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.835
[S16] round=37 local utility u=0.025691 metrics={'f1_val': 0.08715965845013694, 'auprc': 0.08715965845013694, 'loss_val': 4.15139847642636, 'psi': 0.08715965845013694}-{'f1_val': 0.07821960399279987, 'auprc': 0.07821960399279987, 'loss_val': 4.122319154780728, 'psi': 0.07821960399279987}
[S16] not sending this round → trigger blocked (psi=0.087)
[S17] START round=37 head_norm_before_train=1.469875 cos_to_last_merge=0.9506 (last merge round=19)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.24016385725737568, 'auprc': 0.24016385725737568, 'loss_val': 1.1145390318141377, 'psi': 0.24016385725737568}-{'f1_val': 0.2721544325370249, 'auprc': 0.2721544325370249, 'loss_val': 1.02040600429702, 'psi': 0.2721544325370249}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.903608 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.2589584944573344, 'auprc': 0.2589584944573344, 'loss_val': 3.144815332025343, 'psi': 0.2589584944573344}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 3.1856616212288595, 'psi': 0.26542475888492534}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.912292 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.27765127992824123, 'auprc': 0.27765127992824123, 'loss_val': 3.036229574379356, 'psi': 0.27765127992824123}-{'f1_val': 0.3020351526364477, 'auprc': 0.3020351526364477, 'loss_val': 3.253702514338188, 'psi': 0.3020351526364477}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.802678 cos_to_last_merge=0.9340 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.396231870006513, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3764151041205719, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.818357 cos_to_last_merge=0.9048 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.905
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.33510302897555116, 'auprc': 0.33510302897555116, 'loss_val': 1.9127316985817193, 'psi': 0.33510302897555116}-{'f1_val': 0.3371889285055583, 'auprc': 0.3371889285055583, 'loss_val': 1.671806147396759, 'psi': 0.3371889285055583}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.673234 cos_to_last_merge=0.9565 (last merge round=15)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.383576890640904, 'psi': 0.017551963048498844}-{'f1_val': 0.029927992799279927, 'auprc': 0.029927992799279927, 'loss_val': 5.9025326354793535, 'psi': 0.029927992799279927}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.518113 cos_to_last_merge=0.9375 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.938
[S7] round=38 local utility u=0.386905 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7298909981592269, 'psi': 0.3330019880715706}-{'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.7538863825065715, 'psi': 0.2496892866020383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=38 head_norm_before_train=1.730437 cos_to_last_merge=0.9605 (last merge round=19)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.344187336032377, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3019836887254015, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.856992 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9091284323794593, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8881101823829916, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.110185 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 2.051936620024631, 'psi': 0.3327765847450887}-{'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 2.027519745190227, 'psi': 0.3327765847450887}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.830844 cos_to_last_merge=0.9800 (last merge round=20)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.3648611793301284, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.3454352680043615, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.290921 cos_to_last_merge=0.9599 (last merge round=20)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0128120343910922, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9860375112833674, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.895172 cos_to_last_merge=0.9335 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.934
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.151793785773956, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.107496572561814, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.849948 cos_to_last_merge=0.9536 (last merge round=17)
[S15] round=38 local utility u=1.000000 metrics={'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.09634483420192014, 'psi': 0.9988780126706549}-{'f1_val': 0.620874926809888, 'auprc': 0.620874926809888, 'loss_val': 0.1690482783209506, 'psi': 0.620874926809888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S16] START round=38 head_norm_before_train=1.599627 cos_to_last_merge=0.8330 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.833
[S16] round=38 local utility u=0.164823 metrics={'f1_val': 0.09047962206741933, 'auprc': 0.09047962206741933, 'loss_val': 3.851632734504195, 'psi': 0.09047962206741933}-{'f1_val': 0.08715965845013694, 'auprc': 0.08715965845013694, 'loss_val': 4.15139847642636, 'psi': 0.08715965845013694}
[S16] not sending this round → trigger blocked (psi=0.090)
[S17] START round=38 head_norm_before_train=1.484152 cos_to_last_merge=0.9489 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.949
[S17] round=38 local utility u=0.112124 metrics={'f1_val': 0.2655986550902513, 'auprc': 0.2655986550902513, 'loss_val': 1.1192044539051877, 'psi': 0.2655986550902513}-{'f1_val': 0.24016385725737568, 'auprc': 0.24016385725737568, 'loss_val': 1.1145390318141377, 'psi': 0.24016385725737568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=39 head_norm_before_train=1.910764 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.2607240848557853, 'auprc': 0.2607240848557853, 'loss_val': 3.3322779442600265, 'psi': 0.2607240848557853}-{'f1_val': 0.2589584944573344, 'auprc': 0.2589584944573344, 'loss_val': 3.144815332025343, 'psi': 0.2589584944573344}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.261 u=0.0000 p_local=0.0204 f1=0.261 auprc=0.261 bytes=21612
[S3] START round=39 head_norm_before_train=1.915893 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.28140985214771214, 'auprc': 0.28140985214771214, 'loss_val': 3.0946530975931155, 'psi': 0.28140985214771214}-{'f1_val': 0.27765127992824123, 'auprc': 0.27765127992824123, 'loss_val': 3.036229574379356, 'psi': 0.27765127992824123}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.281 u=0.0000 p_local=0.0049 f1=0.281 auprc=0.281 bytes=10777
[S4] START round=39 head_norm_before_train=1.814674 cos_to_last_merge=0.9329 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4148174512034652, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.396231870006513, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0015 f1=0.357 auprc=0.357 bytes=23444
[S5] START round=39 head_norm_before_train=1.827561 cos_to_last_merge=0.9047 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.905
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.33510302897555116, 'auprc': 0.33510302897555116, 'loss_val': 1.9343268962950233, 'psi': 0.33510302897555116}-{'f1_val': 0.33510302897555116, 'auprc': 0.33510302897555116, 'loss_val': 1.9127316985817193, 'psi': 0.33510302897555116}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.335 u=0.0000 p_local=0.0286 f1=0.335 auprc=0.335 bytes=32384
[S6] START round=39 head_norm_before_train=1.681362 cos_to_last_merge=0.9555 (last merge round=15)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.4740682642364105, 'psi': 0.017551963048498844}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.383576890640904, 'psi': 0.017551963048498844}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.018 u=0.0000 p_local=0.0687 f1=0.018 auprc=0.018 bytes=0
[S7] START round=39 head_norm_before_train=1.530657 cos_to_last_merge=0.9344 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=39 local utility u=0.009095 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7117019735912143, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7298909981592269, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S7] r=40 psi=0.333 u=0.0091 p_local=0.0846 f1=0.333 auprc=0.333 bytes=36008
[S8] START round=39 head_norm_before_train=1.743449 cos_to_last_merge=0.9589 (last merge round=19)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3857871528711405, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.344187336032377, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0020 f1=0.359 auprc=0.359 bytes=34187
[S9] START round=39 head_norm_before_train=1.862990 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9283651266662614, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9091284323794593, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0015 f1=0.369 auprc=0.369 bytes=3600
[S10] START round=39 head_norm_before_train=2.124796 (no previous merge yet)
[S10] round=39 local utility u=0.003372 metrics={'f1_val': 0.33261785515541775, 'auprc': 0.33261785515541775, 'loss_val': 2.0437633868477025, 'psi': 0.33261785515541775}-{'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 2.051936620024631, 'psi': 0.3327765847450887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=40 psi=0.333 u=0.0034 p_local=0.0058 f1=0.333 auprc=0.333 bytes=37872
[S11] START round=39 head_norm_before_train=1.841456 cos_to_last_merge=0.9791 (last merge round=20)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.3921400748381534, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.3648611793301284, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0014 f1=0.332 auprc=0.332 bytes=18012
[S13] START round=39 head_norm_before_train=1.302600 cos_to_last_merge=0.9574 (last merge round=20)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0302831454977863, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0128120343910922, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0203 f1=0.360 auprc=0.360 bytes=34201
[S14] START round=39 head_norm_before_train=1.902389 cos_to_last_merge=0.9325 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.196320461707695, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.151793785773956, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0017 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=1.863956 cos_to_last_merge=0.9522 (last merge round=17)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6178598860627714, 'auprc': 0.6178598860627714, 'loss_val': 0.17184549892346, 'psi': 0.6178598860627714}-{'f1_val': 0.9988780126706549, 'auprc': 0.9988780126706549, 'loss_val': 0.09634483420192014, 'psi': 0.9988780126706549}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.618 u=0.0000 p_local=0.1917 f1=0.618 auprc=0.618 bytes=32418
[S16] START round=39 head_norm_before_train=1.610402 cos_to_last_merge=0.8310 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.831
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.09047962206741933, 'auprc': 0.09047962206741933, 'loss_val': 3.9220542320300904, 'psi': 0.09047962206741933}-{'f1_val': 0.09047962206741933, 'auprc': 0.09047962206741933, 'loss_val': 3.851632734504195, 'psi': 0.09047962206741933}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.090 u=0.0000 p_local=0.0691 f1=0.090 auprc=0.090 bytes=0
[S17] START round=39 head_norm_before_train=1.499260 cos_to_last_merge=0.9474 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.264430476837624, 'auprc': 0.264430476837624, 'loss_val': 1.163072217030142, 'psi': 0.264430476837624}-{'f1_val': 0.2655986550902513, 'auprc': 0.2655986550902513, 'loss_val': 1.1192044539051877, 'psi': 0.2655986550902513}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.264 u=0.0000 p_local=0.0573 f1=0.264 auprc=0.264 bytes=37734
[S2] START round=40 head_norm_before_train=1.917894 (no previous merge yet)
[S2] round=40 local utility u=0.054269 metrics={'f1_val': 0.25048313696153607, 'auprc': 0.25048313696153607, 'loss_val': 3.1315720089557995, 'psi': 0.25048313696153607}-{'f1_val': 0.2607240848557853, 'auprc': 0.2607240848557853, 'loss_val': 3.3322779442600265, 'psi': 0.2607240848557853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=40 head_norm_before_train=1.920189 (no previous merge yet)
[S3] round=40 local utility u=0.005470 metrics={'f1_val': 0.280569514237856, 'auprc': 0.280569514237856, 'loss_val': 3.076150230769526, 'psi': 0.280569514237856}-{'f1_val': 0.28140985214771214, 'auprc': 0.28140985214771214, 'loss_val': 3.0946530975931155, 'psi': 0.28140985214771214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=40 head_norm_before_train=1.824879 cos_to_last_merge=0.9319 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.932
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4267688156613485, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4148174512034652, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.836744 cos_to_last_merge=0.9043 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.904
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.33384517233783456, 'auprc': 0.33384517233783456, 'loss_val': 2.0646040754585817, 'psi': 0.33384517233783456}-{'f1_val': 0.33510302897555116, 'auprc': 0.33510302897555116, 'loss_val': 1.9343268962950233, 'psi': 0.33510302897555116}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.689790 cos_to_last_merge=0.9545 (last merge round=15)
[S6] round=40 local utility u=0.106989 metrics={'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 6.305734042133499, 'psi': 0.02262340036563071}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.4740682642364105, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.023)
[S7] START round=40 head_norm_before_train=1.543146 cos_to_last_merge=0.9319 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.6648037515689496, 'psi': 0.2496892866020383}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7117019735912143, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.753430 cos_to_last_merge=0.9574 (last merge round=19)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.424060374941789, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3857871528711405, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.868703 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9479689297280025, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9283651266662614, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.138605 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.33238004448681285, 'auprc': 0.33238004448681285, 'loss_val': 2.043538312835455, 'psi': 0.33238004448681285}-{'f1_val': 0.33261785515541775, 'auprc': 0.33261785515541775, 'loss_val': 2.0437633868477025, 'psi': 0.33261785515541775}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.851510 cos_to_last_merge=0.9783 (last merge round=20)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.4135059704681363, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.3921400748381534, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.316733 cos_to_last_merge=0.9546 (last merge round=20)
[S13] round=40 local utility u=0.013523 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.003238067460394, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0302831454977863, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=40 head_norm_before_train=1.909306 cos_to_last_merge=0.9314 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.931
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.236811709784902, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.196320461707695, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.875964 cos_to_last_merge=0.9510 (last merge round=17)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.28120778015029574, 'psi': 0.6166125814646326}-{'f1_val': 0.6178598860627714, 'auprc': 0.6178598860627714, 'loss_val': 0.17184549892346, 'psi': 0.6178598860627714}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.619688 cos_to_last_merge=0.8293 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.829
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 4.168679004374542, 'psi': 0.08994708994708994}-{'f1_val': 0.09047962206741933, 'auprc': 0.09047962206741933, 'loss_val': 3.9220542320300904, 'psi': 0.09047962206741933}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.514437 cos_to_last_merge=0.9457 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.2573789976643179, 'auprc': 0.2573789976643179, 'loss_val': 1.2538925324572843, 'psi': 0.2573789976643179}-{'f1_val': 0.264430476837624, 'auprc': 0.264430476837624, 'loss_val': 1.163072217030142, 'psi': 0.264430476837624}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.924961 (no previous merge yet)
[S2] round=41 local utility u=0.495710 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1931030758751557, 'psi': 0.3674775928297055}-{'f1_val': 0.25048313696153607, 'auprc': 0.25048313696153607, 'loss_val': 3.1315720089557995, 'psi': 0.25048313696153607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=41 head_norm_before_train=1.925539 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.2695605573419078, 'auprc': 0.2695605573419078, 'loss_val': 3.051516254577686, 'psi': 0.2695605573419078}-{'f1_val': 0.280569514237856, 'auprc': 0.280569514237856, 'loss_val': 3.076150230769526, 'psi': 0.280569514237856}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.834050 cos_to_last_merge=0.9309 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.931
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.438453564629121, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4267688156613485, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.842376 cos_to_last_merge=0.9041 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.904
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.33342482799004536, 'auprc': 0.33342482799004536, 'loss_val': 2.1119850965471296, 'psi': 0.33342482799004536}-{'f1_val': 0.33384517233783456, 'auprc': 0.33384517233783456, 'loss_val': 2.0646040754585817, 'psi': 0.33384517233783456}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.699073 cos_to_last_merge=0.9535 (last merge round=15)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.557042028021169, 'psi': 0.017551963048498844}-{'f1_val': 0.02262340036563071, 'auprc': 0.02262340036563071, 'loss_val': 6.305734042133499, 'psi': 0.02262340036563071}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.554278 cos_to_last_merge=0.9305 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.930
[S7] round=41 local utility u=0.383461 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6476955999436592, 'psi': 0.3330019880715706}-{'f1_val': 0.2496892866020383, 'auprc': 0.2496892866020383, 'loss_val': 0.6648037515689496, 'psi': 0.2496892866020383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=41 head_norm_before_train=1.763202 cos_to_last_merge=0.9559 (last merge round=19)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4593702536371953, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.424060374941789, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.874377 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.967932068318124, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9479689297280025, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.152136 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.3323008498133588, 'auprc': 0.3323008498133588, 'loss_val': 2.055869635734848, 'psi': 0.3323008498133588}-{'f1_val': 0.33238004448681285, 'auprc': 0.33238004448681285, 'loss_val': 2.043538312835455, 'psi': 0.33238004448681285}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.860973 cos_to_last_merge=0.9775 (last merge round=20)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.425488463353405, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.4135059704681363, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.329121 cos_to_last_merge=0.9522 (last merge round=20)
[S13] round=41 local utility u=0.041794 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9196496844510811, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.003238067460394, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=41 head_norm_before_train=1.916101 cos_to_last_merge=0.9305 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.276846749656751, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.236811709784902, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.885924 cos_to_last_merge=0.9501 (last merge round=17)
[S15] round=41 local utility u=0.074341 metrics={'f1_val': 0.6186869195568443, 'auprc': 0.6186869195568443, 'loss_val': 0.15119408277603089, 'psi': 0.6186869195568443}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.28120778015029574, 'psi': 0.6166125814646326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=41 head_norm_before_train=1.628992 cos_to_last_merge=0.8276 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.828
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 4.279535723379221, 'psi': 0.08994708994708994}-{'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 4.168679004374542, 'psi': 0.08994708994708994}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.531568 cos_to_last_merge=0.9440 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.944
[S17] round=41 local utility u=0.044030 metrics={'f1_val': 0.26744231668854784, 'auprc': 0.26744231668854784, 'loss_val': 1.256402115861891, 'psi': 0.26744231668854784}-{'f1_val': 0.2573789976643179, 'auprc': 0.2573789976643179, 'loss_val': 1.2538925324572843, 'psi': 0.2573789976643179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=42 head_norm_before_train=1.931797 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.2213568850874212, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.1931030758751557, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.931726 (no previous merge yet)
[S3] round=42 local utility u=0.022189 metrics={'f1_val': 0.2813507075802158, 'auprc': 0.2813507075802158, 'loss_val': 3.11324898516313, 'psi': 0.2813507075802158}-{'f1_val': 0.2695605573419078, 'auprc': 0.2695605573419078, 'loss_val': 3.051516254577686, 'psi': 0.2695605573419078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=42 head_norm_before_train=1.843060 cos_to_last_merge=0.9299 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4480074774131375, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.438453564629121, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.847929 cos_to_last_merge=0.9039 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.904
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.266883286929667, 'psi': 0.33300395256917}-{'f1_val': 0.33342482799004536, 'auprc': 0.33342482799004536, 'loss_val': 2.1119850965471296, 'psi': 0.33342482799004536}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.707918 cos_to_last_merge=0.9525 (last merge round=15)
[S6] round=42 local utility u=0.245316 metrics={'f1_val': 0.028016267510167194, 'auprc': 0.028016267510167194, 'loss_val': 6.160589253002353, 'psi': 0.02801626751016719}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.557042028021169, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.028)
[S7] START round=42 head_norm_before_train=1.564509 cos_to_last_merge=0.9288 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.929
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6709800673759995, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6476955999436592, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.773114 cos_to_last_merge=0.9548 (last merge round=19)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4902410567505189, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4593702536371953, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.879982 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.985138576788194, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.967932068318124, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.164571 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.33238004448681285, 'auprc': 0.33238004448681285, 'loss_val': 2.0933515215519827, 'psi': 0.33238004448681285}-{'f1_val': 0.3323008498133588, 'auprc': 0.3323008498133588, 'loss_val': 2.055869635734848, 'psi': 0.3323008498133588}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.869858 cos_to_last_merge=0.9768 (last merge round=20)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.447261821264973, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.425488463353405, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.342343 cos_to_last_merge=0.9496 (last merge round=20)
[S13] ⚠️ Model drifted since last merge! cos=0.950
[S13] round=42 local utility u=0.278066 metrics={'f1_val': 0.40550741722324185, 'auprc': 0.40550741722324185, 'loss_val': 0.7736576262149126, 'psi': 0.40550741722324185}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9196496844510811, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=42 head_norm_before_train=1.922607 cos_to_last_merge=0.9295 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.316137419956253, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.276846749656751, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.895867 cos_to_last_merge=0.9492 (last merge round=17)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=42 local utility u=0.018668 metrics={'f1_val': 0.6215535343979983, 'auprc': 0.6215535343979983, 'loss_val': 0.13965795310610177, 'psi': 0.6215535343979983}-{'f1_val': 0.6186869195568443, 'auprc': 0.6186869195568443, 'loss_val': 0.15119408277603089, 'psi': 0.6186869195568443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=42 head_norm_before_train=1.638321 cos_to_last_merge=0.8259 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.826
[S16] round=42 local utility u=0.059457 metrics={'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 4.163116180777181, 'psi': 0.09022435897435897}-{'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 4.279535723379221, 'psi': 0.08994708994708994}
[S16] not sending this round → trigger blocked (psi=0.090)
[S17] START round=42 head_norm_before_train=1.547744 cos_to_last_merge=0.9423 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=42 local utility u=0.021162 metrics={'f1_val': 0.2731945267310471, 'auprc': 0.2731945267310471, 'loss_val': 1.2658474511558837, 'psi': 0.2731945267310471}-{'f1_val': 0.26744231668854784, 'auprc': 0.26744231668854784, 'loss_val': 1.256402115861891, 'psi': 0.26744231668854784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=43 head_norm_before_train=1.938354 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.234276814212849, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.2213568850874212, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.937941 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.2814690215867676, 'auprc': 0.2814690215867676, 'loss_val': 3.1290695299462863, 'psi': 0.2814690215867676}-{'f1_val': 0.2813507075802158, 'auprc': 0.2813507075802158, 'loss_val': 3.11324898516313, 'psi': 0.2813507075802158}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.850219 cos_to_last_merge=0.9293 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.929
[S4] round=43 local utility u=0.001076 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4458561045307303, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4480074774131375, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=43 head_norm_before_train=1.854024 cos_to_last_merge=0.9038 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.904
[S5] round=43 local utility u=0.004401 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.258082251506708, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.266883286929667, 'psi': 0.33300395256917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=43 head_norm_before_train=1.717351 cos_to_last_merge=0.9515 (last merge round=15)
[S6] round=43 local utility u=0.147373 metrics={'f1_val': 0.04842196281884998, 'auprc': 0.04842196281884998, 'loss_val': 6.049494170606786, 'psi': 0.04842196281884998}-{'f1_val': 0.028016267510167194, 'auprc': 0.028016267510167194, 'loss_val': 6.160589253002353, 'psi': 0.02801626751016719}
[S6] not sending this round → trigger blocked (psi=0.048)
[S7] START round=43 head_norm_before_train=1.571660 cos_to_last_merge=0.9274 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.927
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7053410734396863, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6709800673759995, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.783184 cos_to_last_merge=0.9535 (last merge round=19)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.522100462817715, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4902410567505189, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.885249 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0015077414099394, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.985138576788194, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.176453 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.33238004448681285, 'auprc': 0.33238004448681285, 'loss_val': 2.124836066304865, 'psi': 0.33238004448681285}-{'f1_val': 0.33238004448681285, 'auprc': 0.33238004448681285, 'loss_val': 2.0933515215519827, 'psi': 0.33238004448681285}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.878744 cos_to_last_merge=0.9760 (last merge round=20)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.4666002286064774, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.447261821264973, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.358632 cos_to_last_merge=0.9467 (last merge round=20)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=43 local utility u=0.052870 metrics={'f1_val': 0.41512165210911955, 'auprc': 0.41512165210911955, 'loss_val': 0.754445223150466, 'psi': 0.41512165210911955}-{'f1_val': 0.40550741722324185, 'auprc': 0.40550741722324185, 'loss_val': 0.7736576262149126, 'psi': 0.40550741722324185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=43 head_norm_before_train=1.929010 cos_to_last_merge=0.9286 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.929
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.353996380630592, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.316137419956253, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.906752 cos_to_last_merge=0.9482 (last merge round=17)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.17710516398503606, 'psi': 0.6179979742350791}-{'f1_val': 0.6215535343979983, 'auprc': 0.6215535343979983, 'loss_val': 0.13965795310610177, 'psi': 0.6215535343979983}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.646968 cos_to_last_merge=0.8244 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.824
[S16] round=43 local utility u=0.231209 metrics={'f1_val': 0.11280159827877671, 'auprc': 0.11280159827877671, 'loss_val': 3.903892434678167, 'psi': 0.11280159827877673}-{'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 4.163116180777181, 'psi': 0.09022435897435897}
[S16] not sending this round → trigger blocked (psi=0.113)
[S17] START round=43 head_norm_before_train=1.563650 cos_to_last_merge=0.9406 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=43 local utility u=0.372387 metrics={'f1_val': 0.369367280628248, 'auprc': 0.369367280628248, 'loss_val': 1.3866285459471657, 'psi': 0.369367280628248}-{'f1_val': 0.2731945267310471, 'auprc': 0.2731945267310471, 'loss_val': 1.2658474511558837, 'psi': 0.2731945267310471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=44 head_norm_before_train=1.944784 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.26469038208168644, 'auprc': 0.26469038208168644, 'loss_val': 3.2486720744621507, 'psi': 0.26469038208168644}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 3.234276814212849, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.944210 (no previous merge yet)
[S3] round=44 local utility u=0.007376 metrics={'f1_val': 0.2797494780793319, 'auprc': 0.2797494780793319, 'loss_val': 3.0988409372504573, 'psi': 0.2797494780793319}-{'f1_val': 0.2814690215867676, 'auprc': 0.2814690215867676, 'loss_val': 3.1290695299462863, 'psi': 0.2814690215867676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=44 head_norm_before_train=1.854693 cos_to_last_merge=0.9288 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.929
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4570069394705683, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4458561045307303, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.858802 cos_to_last_merge=0.9036 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.904
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.2980130888493666, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.258082251506708, 'psi': 0.33300395256917}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.726424 cos_to_last_merge=0.9504 (last merge round=15)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.828491019657347, 'psi': 0.0}-{'f1_val': 0.04842196281884998, 'auprc': 0.04842196281884998, 'loss_val': 6.049494170606786, 'psi': 0.04842196281884998}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.579117 cos_to_last_merge=0.9259 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7202076820813212, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7053410734396863, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.791363 cos_to_last_merge=0.9524 (last merge round=19)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5505426822511854, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.522100462817715, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.890412 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0174341368355346, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0015077414099394, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.187973 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.33238004448681285, 'auprc': 0.33238004448681285, 'loss_val': 2.1251693860938774, 'psi': 0.33238004448681285}-{'f1_val': 0.33238004448681285, 'auprc': 0.33238004448681285, 'loss_val': 2.124836066304865, 'psi': 0.33238004448681285}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.887069 cos_to_last_merge=0.9754 (last merge round=20)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.4856287180577947, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.4666002286064774, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.370409 cos_to_last_merge=0.9445 (last merge round=20)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=44 local utility u=0.482797 metrics={'f1_val': 0.5194409368476687, 'auprc': 0.5194409368476687, 'loss_val': 0.7277249449110147, 'psi': 0.5194409368476687}-{'f1_val': 0.41512165210911955, 'auprc': 0.41512165210911955, 'loss_val': 0.754445223150466, 'psi': 0.41512165210911955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=44 head_norm_before_train=1.935201 cos_to_last_merge=0.9277 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.928
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.389620035695257, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.353996380630592, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.917465 cos_to_last_merge=0.9472 (last merge round=17)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.21051905141549604, 'psi': 0.6174450213799425}-{'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.17710516398503606, 'psi': 0.6179979742350791}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.654311 cos_to_last_merge=0.8231 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.823
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.10571384088432197, 'auprc': 0.10571384088432197, 'loss_val': 4.019583812527479, 'psi': 0.10571384088432195}-{'f1_val': 0.11280159827877671, 'auprc': 0.11280159827877671, 'loss_val': 3.903892434678167, 'psi': 0.11280159827877673}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.577911 cos_to_last_merge=0.9390 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.939
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.2792271556266465, 'auprc': 0.2792271556266465, 'loss_val': 1.3330710250162285, 'psi': 0.2792271556266465}-{'f1_val': 0.369367280628248, 'auprc': 0.369367280628248, 'loss_val': 1.3866285459471657, 'psi': 0.369367280628248}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.950570 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.2619428876434481, 'auprc': 0.2619428876434481, 'loss_val': 3.3809104295020966, 'psi': 0.2619428876434481}-{'f1_val': 0.26469038208168644, 'auprc': 0.26469038208168644, 'loss_val': 3.2486720744621507, 'psi': 0.26469038208168644}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.950331 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.2958156187066458, 'auprc': 0.2958156187066458, 'loss_val': 3.2612527249299257, 'psi': 0.2958156187066458}-{'f1_val': 0.2797494780793319, 'auprc': 0.2797494780793319, 'loss_val': 3.0988409372504573, 'psi': 0.2797494780793319}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.861915 cos_to_last_merge=0.9281 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4687485124366648, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4570069394705683, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.865486 cos_to_last_merge=0.9032 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.903
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.3678578843700735, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.2980130888493666, 'psi': 0.33300395256917}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.733550 cos_to_last_merge=0.9496 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.950
[S6] round=45 local utility u=0.222822 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.580558611287686, 'psi': 0.021967963386727688}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.828491019657347, 'psi': 0.0}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=45 head_norm_before_train=1.585889 cos_to_last_merge=0.9245 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.924
[S7] round=45 local utility u=0.020178 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6798517517220835, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.7202076820813212, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=45 head_norm_before_train=1.800716 cos_to_last_merge=0.9518 (last merge round=19)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5820211479400854, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5505426822511854, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.895506 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.032102236895633, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0174341368355346, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.198614 (no previous merge yet)
[S10] round=45 local utility u=0.002712 metrics={'f1_val': 0.33206349206349206, 'auprc': 0.33206349206349206, 'loss_val': 2.1168967738282065, 'psi': 0.33206349206349206}-{'f1_val': 0.33238004448681285, 'auprc': 0.33238004448681285, 'loss_val': 2.1251693860938774, 'psi': 0.33238004448681285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=45 head_norm_before_train=1.895230 cos_to_last_merge=0.9747 (last merge round=20)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.501758106036244, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.4856287180577947, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.379502 cos_to_last_merge=0.9430 (last merge round=20)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.40356634478011955, 'auprc': 0.40356634478011955, 'loss_val': 0.7367461886403738, 'psi': 0.40356634478011955}-{'f1_val': 0.5194409368476687, 'auprc': 0.5194409368476687, 'loss_val': 0.7277249449110147, 'psi': 0.5194409368476687}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.941175 cos_to_last_merge=0.9269 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.927
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.42464504503396, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.389620035695257, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.927624 cos_to_last_merge=0.9463 (last merge round=17)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=45 local utility u=0.018651 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.1744635134767799, 'psi': 0.6175834097438502}-{'f1_val': 0.6174450213799425, 'auprc': 0.6174450213799425, 'loss_val': 0.21051905141549604, 'psi': 0.6174450213799425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=45 head_norm_before_train=1.662507 cos_to_last_merge=0.8216 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.822
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.09059623849539816, 'auprc': 0.09059623849539816, 'loss_val': 4.242810268070697, 'psi': 0.09059623849539816}-{'f1_val': 0.10571384088432197, 'auprc': 0.10571384088432197, 'loss_val': 4.019583812527479, 'psi': 0.10571384088432195}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.591473 cos_to_last_merge=0.9378 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.938
[S17] round=45 local utility u=0.479956 metrics={'f1_val': 0.39720845833697094, 'auprc': 0.39720845833697094, 'loss_val': 1.4349901923144077, 'psi': 0.39720845833697094}-{'f1_val': 0.2792271556266465, 'auprc': 0.2792271556266465, 'loss_val': 1.3330710250162285, 'psi': 0.2792271556266465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=46 head_norm_before_train=1.956316 (no previous merge yet)
[S2] round=46 local utility u=0.054091 metrics={'f1_val': 0.25736612861901104, 'auprc': 0.25736612861901104, 'loss_val': 3.2315371853719714, 'psi': 0.25736612861901104}-{'f1_val': 0.2619428876434481, 'auprc': 0.2619428876434481, 'loss_val': 3.3809104295020966, 'psi': 0.2619428876434481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=46 head_norm_before_train=1.956449 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.27811182528163664, 'auprc': 0.27811182528163664, 'loss_val': 3.108437844398668, 'psi': 0.27811182528163664}-{'f1_val': 0.2958156187066458, 'auprc': 0.2958156187066458, 'loss_val': 3.2612527249299257, 'psi': 0.2958156187066458}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.868680 cos_to_last_merge=0.9274 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.475645624995179, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4687485124366648, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.877024 cos_to_last_merge=0.9027 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.903
[S5] round=46 local utility u=0.033551 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.300756206734079, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.3678578843700735, 'psi': 0.33300395256917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=46 head_norm_before_train=1.740280 cos_to_last_merge=0.9488 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.774250555592493, 'psi': 0.017551963048498844}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.580558611287686, 'psi': 0.021967963386727688}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.596164 cos_to_last_merge=0.9234 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6348167311381225, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.6798517517220835, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.807997 cos_to_last_merge=0.9513 (last merge round=19)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6086368576321761, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5820211479400854, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.900374 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0472200894968853, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.032102236895633, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.209001 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.33214257362864175, 'auprc': 0.33214257362864175, 'loss_val': 2.141175901372472, 'psi': 0.33214257362864175}-{'f1_val': 0.33206349206349206, 'auprc': 0.33206349206349206, 'loss_val': 2.1168967738282065, 'psi': 0.33206349206349206}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.903352 cos_to_last_merge=0.9740 (last merge round=20)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.517571803631475, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.501758106036244, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.387739 cos_to_last_merge=0.9416 (last merge round=20)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.7600574281540262, 'psi': 0.3599362944611573}-{'f1_val': 0.40356634478011955, 'auprc': 0.40356634478011955, 'loss_val': 0.7367461886403738, 'psi': 0.40356634478011955}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.947041 cos_to_last_merge=0.9260 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.926
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.457830523167118, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.42464504503396, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.938485 cos_to_last_merge=0.9453 (last merge round=17)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=46 local utility u=0.011424 metrics={'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.1553462879176454, 'psi': 0.6179979742350791}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.1744635134767799, 'psi': 0.6175834097438502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=46 head_norm_before_train=1.670517 cos_to_last_merge=0.8201 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 4.442664221468772, 'psi': 0.09022435897435897}-{'f1_val': 0.09059623849539816, 'auprc': 0.09059623849539816, 'loss_val': 4.242810268070697, 'psi': 0.09059623849539816}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.602468 cos_to_last_merge=0.9367 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.937
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.27288158443686045, 'auprc': 0.27288158443686045, 'loss_val': 1.396077095977574, 'psi': 0.27288158443686045}-{'f1_val': 0.39720845833697094, 'auprc': 0.39720845833697094, 'loss_val': 1.4349901923144077, 'psi': 0.39720845833697094}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.962172 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.2568725226953075, 'auprc': 0.2568725226953075, 'loss_val': 3.23339328748526, 'psi': 0.2568725226953075}-{'f1_val': 0.25736612861901104, 'auprc': 0.25736612861901104, 'loss_val': 3.2315371853719714, 'psi': 0.25736612861901104}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.961977 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.27684898520811835, 'auprc': 0.27684898520811835, 'loss_val': 3.112362042285814, 'psi': 0.27684898520811835}-{'f1_val': 0.27811182528163664, 'auprc': 0.27811182528163664, 'loss_val': 3.108437844398668, 'psi': 0.27811182528163664}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.872566 cos_to_last_merge=0.9268 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4893515603212633, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.475645624995179, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.889920 cos_to_last_merge=0.9019 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.902
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.4352963973576225, 'psi': 0.33300395256917}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.300756206734079, 'psi': 0.33300395256917}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.746976 cos_to_last_merge=0.9480 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=47 local utility u=0.060756 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.688541391048907, 'psi': 0.02153000458085204}-{'f1_val': 0.017551963048498844, 'auprc': 0.017551963048498844, 'loss_val': 6.774250555592493, 'psi': 0.017551963048498844}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=47 head_norm_before_train=1.605050 cos_to_last_merge=0.9223 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=47 local utility u=0.339521 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.706149380273875, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.6348167311381225, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=47 head_norm_before_train=1.816175 cos_to_last_merge=0.9510 (last merge round=19)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6352245860102148, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6086368576321761, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.905225 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0626558669590422, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0472200894968853, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.218736 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.33206349206349206, 'auprc': 0.33206349206349206, 'loss_val': 2.159382765312134, 'psi': 0.33206349206349206}-{'f1_val': 0.33214257362864175, 'auprc': 0.33214257362864175, 'loss_val': 2.141175901372472, 'psi': 0.33214257362864175}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.911085 cos_to_last_merge=0.9733 (last merge round=20)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.526282302980132, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.517571803631475, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.395175 cos_to_last_merge=0.9403 (last merge round=20)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8016084166189688, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.7600574281540262, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.952744 cos_to_last_merge=0.9252 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.925
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.492306353816716, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.457830523167118, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.949768 cos_to_last_merge=0.9442 (last merge round=17)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.16647878928450124, 'psi': 0.6179979742350791}-{'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.1553462879176454, 'psi': 0.6179979742350791}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.677059 cos_to_last_merge=0.8189 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=47 local utility u=0.008432 metrics={'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 4.42580060667996, 'psi': 0.09022435897435897}-{'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 4.442664221468772, 'psi': 0.09022435897435897}
[S16] not sending this round → trigger blocked (psi=0.090)
[S17] START round=47 head_norm_before_train=1.612044 cos_to_last_merge=0.9357 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=47 local utility u=0.550802 metrics={'f1_val': 0.40054710935924787, 'auprc': 0.40054710935924787, 'loss_val': 1.443461988501009, 'psi': 0.40054710935924787}-{'f1_val': 0.27288158443686045, 'auprc': 0.27288158443686045, 'loss_val': 1.396077095977574, 'psi': 0.27288158443686045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=48 head_norm_before_train=1.967808 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.2175812782344664, 'auprc': 0.2175812782344664, 'loss_val': 3.8455752365930347, 'psi': 0.21758127823446644}-{'f1_val': 0.2568725226953075, 'auprc': 0.2568725226953075, 'loss_val': 3.23339328748526, 'psi': 0.2568725226953075}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.967242 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.28667815101923627, 'auprc': 0.28667815101923627, 'loss_val': 3.2413961913029854, 'psi': 0.28667815101923627}-{'f1_val': 0.27684898520811835, 'auprc': 0.27684898520811835, 'loss_val': 3.112362042285814, 'psi': 0.27684898520811835}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.878227 cos_to_last_merge=0.9261 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5011405491310095, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4893515603212633, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.903266 cos_to_last_merge=0.9009 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.901
[S5] round=48 local utility u=0.044026 metrics={'f1_val': 0.33342482799004536, 'auprc': 0.33342482799004536, 'loss_val': 2.3510315302301183, 'psi': 0.33342482799004536}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.4352963973576225, 'psi': 0.33300395256917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=48 head_norm_before_train=1.754121 cos_to_last_merge=0.9472 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=48 local utility u=0.162482 metrics={'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 6.3987933128039725, 'psi': 0.025442980463425715}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 6.688541391048907, 'psi': 0.02153000458085204}
[S6] not sending this round → trigger blocked (psi=0.025)
[S7] START round=48 head_norm_before_train=1.613668 cos_to_last_merge=0.9214 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.24865466691408425, 'auprc': 0.24865466691408425, 'loss_val': 0.7807496093947962, 'psi': 0.24865466691408425}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.706149380273875, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.823469 cos_to_last_merge=0.9498 (last merge round=19)
[S8] ⚠️ Model drifted since last merge! cos=0.950
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6591532457478677, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6352245860102148, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.910061 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.077082241522653, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0626558669590422, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.227872 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.3319844481472665, 'auprc': 0.3319844481472665, 'loss_val': 2.172961165488972, 'psi': 0.3319844481472665}-{'f1_val': 0.33206349206349206, 'auprc': 0.33206349206349206, 'loss_val': 2.159382765312134, 'psi': 0.33206349206349206}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.918497 cos_to_last_merge=0.9727 (last merge round=20)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.5398283671919457, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.526282302980132, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.401335 cos_to_last_merge=0.9392 (last merge round=20)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=48 local utility u=0.253030 metrics={'f1_val': 0.4061530793808879, 'auprc': 0.4061530793808879, 'loss_val': 0.7115004386850372, 'psi': 0.4061530793808879}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8016084166189688, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=48 head_norm_before_train=1.958170 cos_to_last_merge=0.9245 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.924
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.524284142898489, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.492306353816716, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.960899 cos_to_last_merge=0.9432 (last merge round=17)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.19433262156610526, 'psi': 0.6175834097438502}-{'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.16647878928450124, 'psi': 0.6179979742350791}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.684199 cos_to_last_merge=0.8176 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.818
[S16] round=48 local utility u=0.002173 metrics={'f1_val': 0.09020267563886886, 'auprc': 0.09020267563886886, 'loss_val': 4.421260251821816, 'psi': 0.09020267563886886}-{'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 4.42580060667996, 'psi': 0.09022435897435897}
[S16] not sending this round → trigger blocked (psi=0.090)
[S17] START round=48 head_norm_before_train=1.620075 cos_to_last_merge=0.9348 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.935
[S17] round=48 local utility u=0.016069 metrics={'f1_val': 0.40321833888543845, 'auprc': 0.40321833888543845, 'loss_val': 1.4353644776248211, 'psi': 0.40321833888543845}-{'f1_val': 0.40054710935924787, 'auprc': 0.40054710935924787, 'loss_val': 1.443461988501009, 'psi': 0.40054710935924787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=49 head_norm_before_train=1.973468 (no previous merge yet)
[S2] round=49 local utility u=0.449711 metrics={'f1_val': 0.26235184445332266, 'auprc': 0.26235184445332266, 'loss_val': 3.3490882886033972, 'psi': 0.26235184445332266}-{'f1_val': 0.2175812782344664, 'auprc': 0.2175812782344664, 'loss_val': 3.8455752365930347, 'psi': 0.21758127823446644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=49 head_norm_before_train=1.972737 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.27318397827562796, 'auprc': 0.27318397827562796, 'loss_val': 3.1245393123905036, 'psi': 0.27318397827562796}-{'f1_val': 0.28667815101923627, 'auprc': 0.28667815101923627, 'loss_val': 3.2413961913029854, 'psi': 0.28667815101923627}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.882817 cos_to_last_merge=0.9254 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5135861612088524, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5011405491310095, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.914989 cos_to_last_merge=0.8998 (last merge round=15)
[S5] ⚠️ Model drifted since last merge! cos=0.900
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.6174187948085756, 'psi': 0.33300395256917}-{'f1_val': 0.33342482799004536, 'auprc': 0.33342482799004536, 'loss_val': 2.3510315302301183, 'psi': 0.33342482799004536}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.761612 cos_to_last_merge=0.9464 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.811781168420934, 'psi': 0.017774699907663897}-{'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 6.3987933128039725, 'psi': 0.025442980463425715}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.621773 cos_to_last_merge=0.9205 (last merge round=20)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=49 local utility u=0.030796 metrics={'f1_val': 0.25572519083969464, 'auprc': 0.25572519083969464, 'loss_val': 0.7827917610623716, 'psi': 0.25572519083969464}-{'f1_val': 0.24865466691408425, 'auprc': 0.24865466691408425, 'loss_val': 0.7807496093947962, 'psi': 0.24865466691408425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=49 head_norm_before_train=1.832051 cos_to_last_merge=0.9492 (last merge round=19)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6796863228564787, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6591532457478677, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.914745 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0902172192338226, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.077082241522653, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.236653 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.33182647315409625, 'auprc': 0.33182647315409625, 'loss_val': 2.176822813997844, 'psi': 0.33182647315409625}-{'f1_val': 0.3319844481472665, 'auprc': 0.3319844481472665, 'loss_val': 2.172961165488972, 'psi': 0.3319844481472665}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.925623 cos_to_last_merge=0.9721 (last merge round=20)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.5564299544739923, 'psi': 0.3320907114010562}-{'f1_val': 0.3320907114010562, 'auprc': 0.3320907114010562, 'loss_val': 3.5398283671919457, 'psi': 0.3320907114010562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.409998 cos_to_last_merge=0.9379 (last merge round=20)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=49 local utility u=1.000000 metrics={'f1_val': 0.9850568332359864, 'auprc': 0.9850568332359864, 'loss_val': 0.6147637330114695, 'psi': 0.9850568332359864}-{'f1_val': 0.4061530793808879, 'auprc': 0.4061530793808879, 'loss_val': 0.7115004386850372, 'psi': 0.4061530793808879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=49 head_norm_before_train=1.963612 cos_to_last_merge=0.9237 (last merge round=15)
[S14] ⚠️ Model drifted since last merge! cos=0.924
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.553531327879825, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.524284142898489, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.971363 cos_to_last_merge=0.9423 (last merge round=17)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=49 local utility u=1.000000 metrics={'f1_val': 0.8815266316866779, 'auprc': 0.8815266316866779, 'loss_val': 0.25982188322051664, 'psi': 0.8815266316866779}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.19433262156610526, 'psi': 0.6175834097438502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=49 head_norm_before_train=1.691524 cos_to_last_merge=0.8163 (last merge round=17)
[S16] ⚠️ Model drifted since last merge! cos=0.816
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.09020267563886886, 'auprc': 0.09020267563886886, 'loss_val': 4.450148850899798, 'psi': 0.09020267563886886}-{'f1_val': 0.09020267563886886, 'auprc': 0.09020267563886886, 'loss_val': 4.421260251821816, 'psi': 0.09020267563886886}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.627623 cos_to_last_merge=0.9339 (last merge round=19)
[S17] ⚠️ Model drifted since last merge! cos=0.934
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.28344427229094066, 'auprc': 0.28344427229094066, 'loss_val': 1.4026945704813716, 'psi': 0.28344427229094066}-{'f1_val': 0.40321833888543845, 'auprc': 0.40321833888543845, 'loss_val': 1.4353644776248211, 'psi': 0.40321833888543845}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
