[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:54503
[S3] → join 127.0.0.1:54502
[S4] → join 127.0.0.1:54502
[S5] → join 127.0.0.1:54502
[S6] → join 127.0.0.1:54502
[S7] → join 127.0.0.1:54502
[S8] → join 127.0.0.1:54502
[S9] → join 127.0.0.1:54502
[S10] → join 127.0.0.1:54502
[S11] → join 127.0.0.1:54502
[S13] → join 127.0.0.1:54502
[S14] → join 127.0.0.1:54502
[S15] → join 127.0.0.1:54502
[S16] → join 127.0.0.1:54502
[S17] → join 127.0.0.1:54502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.184138 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.123441 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.151706 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.135902 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.185901 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.151320 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.105285 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.126670 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.217429 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.165759 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.133602 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.184217 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.083176 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.184129 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.056235 (no previous merge yet)
[S11]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3] + discovered S16
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S14
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S15
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S5
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S11
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S3
[S4] + discovered S16
[S4] + discovered S11
[S4] + discovered S14
[S4] + discovered S6
[S4] + discovered S10
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S17
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S5
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S2
[S5] + discovered S15
[S5] + discovered S9
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S14
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S13
[S5] + discovered S10
[S5] + discovered S16
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S10
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S9
[S6] + discovered S15
[S7] + discovered S3
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S5
[S7] + discovered S15
[S7] + discovered S17
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S16
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S13
[S7] + discovered S10
[S8] + discovered S5
[S8] + discovered S2
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S6
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S8
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S5
[S8] + discovered S13
[S8] + discovered S11
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S10
[S8] + discovered S16
[S8] + discovered S14
[S8] + discovered S15
[S10] + discovered S3
[S10] + discovered S8
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S9
[S9] + discovered S16
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S13
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S15
[S10] + discovered S17
[S10] + discovered S14
[S10] + discovered S16
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S10
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S7
[S11] + discovered S6
[S11] + discovered S8
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S3
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S9
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S14
[S13] + discovered S6
[S11] + discovered S16
[S14] + discovered S9
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S8
[S14] + discovered S13
[S14] + discovered S4
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S7
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S14
[S15] + discovered S9
[S15] + discovered S6
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S13
[S15] + discovered S2
[S14] + discovered S15
[S15] + discovered S3
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S11
[S15] + discovered S7
[S15] + discovered S5
[S15] + discovered S4
[S15] + discovered S14
[S16] + discovered S7
[S16] + discovered S11
[S16] + discovered S3
[S16] + discovered S5
[S16] + discovered S13
[S16] + discovered S10
[S16] + discovered S6
[S16] + discovered S9
[S16] + discovered S14
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S2
[S16] + discovered S8
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S13
[S17] + discovered S6
[S17] + discovered S8
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S16
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S14
[S17] + discovered S7
[S17] + discovered S2
[S17] + discovered S9
[S17] + discovered S3
[S17] + discovered S11
[S16] + discovered S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S9] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S7] ⇄ pheromone p=1.000 → S13@127.0.0.1:54513
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:54511
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:54505
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:54502
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:54503
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:54505
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:54507
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:54509
[S2] START round=1 head_norm_before_train=1.191024 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5635362104688602, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4845573842048063, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.142484 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7722014609566297, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4965286686380035, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.165083 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5077239197063828, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4787663568310851, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.137601 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5720887085727548, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.470052325152081, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.197032 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6328729670081459, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5292615792877886, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.152203 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4943264886047105, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3718974479687571, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.111353 (no previous merge yet)
[S8] round=1 local utility u=0.105775 metrics={'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.404178634603847, 'psi': 0.3329116592873709}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.365079907176968, 'psi': 0.30506182380216385}
[S9] START round=1 head_norm_before_train=1.136207 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.718649111711728, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.500169260377184, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.225858 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4514619488796197, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3911865400467271, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.168184 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.440952442066077, 'psi': 0.0}-{'f1_val': 0.28956162767839594, 'auprc': 0.28956162767839594, 'loss_val': 1.3672873773686502, 'psi': 0.28956162767839594}
[S13] START round=1 head_norm_before_train=1.132417 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4631869840415845, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.410073751259371, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.187284 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5509293414832912, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4967744296720222, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.086664 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.462443923157414, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3868076728336942, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.181381 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5326284994356378, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4699802192003464, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.065342 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5432159333585538, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4512628487743746, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:54512
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1790 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1790) from S8
[S11] cosine check vs S8: cos=0.0172
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.0000 head_norm=1.183667
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.115514e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.2896 head_norm=0.825596 delta_norm=0.811551
[S11] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.211409 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7222975408086292, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5635362104688602, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.195268 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.845261048653622, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7722014609566297, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.187883 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5660352169733587, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5077239197063828, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.166273 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8483471277021175, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5720887085727548, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.222147 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8542966737530882, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6328729670081459, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.182640 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8733664065543532, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4943264886047105, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.131097 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4940836339856822, 'psi': 0.0}-{'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.404178634603847, 'psi': 0.3329116592873709}
[S9] START round=2 head_norm_before_train=1.178395 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2921798908382796, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.718649111711728, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.244691 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.576302353646364, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4514619488796197, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=0.825596 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4848479779297026, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.440952442066077, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.144544 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5549754803895401, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4631869840415845, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.203048 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6460652851837174, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5509293414832912, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.101885 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6043447699128728, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.462443923157414, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.191110 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6253030627343874, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5326284994356378, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.086323 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7466483660628187, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5432159333585538, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.244109 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.169093739870185, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7222975408086292, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.262427 (no previous merge yet)
[S3] round=3 local utility u=0.146678 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5519050440828224, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.845261048653622, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.221561 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6775924177620212, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5660352169733587, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.202490 (no previous merge yet)
[S5] round=3 local utility u=0.049152 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7500425135364275, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8483471277021175, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.259697 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4106155493329107, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8542966737530882, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.224644 (no previous merge yet)
[S7] round=3 local utility u=0.036898 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7995704943585502, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8733664065543532, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.159654 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7105504524200261, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4940836339856822, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.241008 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6212792252430708, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2921798908382796, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.272590 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8239184897556562, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.576302353646364, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=0.846394 cos_to_last_merge=0.9953 (last merge round=1)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7174508156050086, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4848479779297026, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.168619 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7321215505213072, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5549754803895401, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.229079 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8575982388951449, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6460652851837174, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.128883 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8911379115980858, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6043447699128728, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.212181 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8229938107372492, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6253030627343874, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.117753 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0683352892896867, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7466483660628187, 'psi': 0.0}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.285953 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.016622441176834, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.169093739870185, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.294523 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5836880164220575, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5519050440828224, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.261772 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8292977063834894, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6775924177620212, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.216434 (no previous merge yet)
[S5] round=4 local utility u=0.064434 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6211748797886547, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7500425135364275, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.305501 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.019192294815619, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4106155493329107, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.234304 (no previous merge yet)
[S7] round=4 local utility u=0.063239 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6730924286875728, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7995704943585502, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.191432 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8396345774519924, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7105504524200261, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.308584 (no previous merge yet)
[S9] round=4 local utility u=0.115501 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3902764363285476, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6212792252430708, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.302211 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8759315715917546, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8239184897556562, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=0.880067 cos_to_last_merge=0.9826 (last merge round=1)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.297731568479058, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7174508156050086, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.197542 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9195301288061197, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7321215505213072, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.264950 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.495633820406919, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8575982388951449, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.159848 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2328471246694592, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8911379115980858, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.245644 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.31588761799289, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8229938107372492, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.148632 (no previous merge yet)
[S17] round=4 local utility u=0.026248 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.015839376356063, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0683352892896867, 'psi': 0.0}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] START round=5 head_norm_before_train=1.324386 (no previous merge yet)
[S2] round=5 local utility u=0.076526 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.863569667298397, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.016622441176834, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.337949 (no previous merge yet)
[S3] round=5 local utility u=0.075010 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.433668675496571, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5836880164220575, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.299958 (no previous merge yet)
[S4] round=5 local utility u=0.071017 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6872641193108975, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8292977063834894, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.238844 (no previous merge yet)
[S5] round=5 local utility u=0.129225 metrics={'f1_val': 0.006431459022418228, 'auprc': 0.006431459022418228, 'loss_val': 1.4206073319954333, 'psi': 0.006431459022418228}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6211748797886547, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.343663 (no previous merge yet)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1485787068866657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.019192294815619, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.245268 (no previous merge yet)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7325940034674001, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6730924286875728, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.214363 (no previous merge yet)
[S8] round=5 local utility u=0.120430 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.598775202837137, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8396345774519924, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.381578 (no previous merge yet)
[S9] round=5 local utility u=0.008102 metrics={'f1_val': 0.00023775558725630053, 'auprc': 0.00023775558725630053, 'loss_val': 2.376211244437138, 'psi': 0.00023775558725630053}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3902764363285476, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.318280 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9140448812059054, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8759315715917546, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=0.917554 cos_to_last_merge=0.9660 (last merge round=1)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5626060048778747, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.297731568479058, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.219836 (no previous merge yet)
[S13] round=5 local utility u=0.024942 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.869645683967004, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9195301288061197, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.309127 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1349007864677776, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.495633820406919, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.183692 (no previous merge yet)
[S15] round=5 local utility u=0.095089 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0426686370270004, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2328471246694592, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.285512 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9445584818505885, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.31588761799289, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.165309 (no previous merge yet)
[S17] round=5 local utility u=0.169442 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6769546868045475, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.015839376356063, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.006)
[S9] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S9] ⇄ pheromone p=0.348 → S7@127.0.0.1:54508
[S6] ⇄ pheromone p=0.328 → S7@127.0.0.1:54508
[S2] ⇄ pheromone p=0.343 → S6@127.0.0.1:54507
[S8] ⇄ pheromone p=0.360 → S5@127.0.0.1:54505
[S5] ⇄ pheromone p=0.370 → S3@127.0.0.1:54503
[S11] ⇄ pheromone p=0.328 → S2@127.0.0.1:54502
[S7] ⇄ pheromone p=0.343 → S13@127.0.0.1:54513
[S15] ⇄ pheromone p=0.347 → S14@127.0.0.1:54514
[S4] ⇄ pheromone p=0.342 → S14@127.0.0.1:54514
[S3] ⇄ pheromone p=0.361 → S14@127.0.0.1:54514
[S10] ⇄ pheromone p=0.328 → S5@127.0.0.1:54505
[S13] ⇄ pheromone p=0.333 → S10@127.0.0.1:54511
[S16] ⇄ pheromone p=0.328 → S14@127.0.0.1:54514
[S14] ⇄ pheromone p=0.328 → S7@127.0.0.1:54508
[S17] ⇄ pheromone p=0.366 → S8@127.0.0.1:54509
[S2] START round=6 head_norm_before_train=1.346107 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.899028335435214, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.863569667298397, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.392271 (no previous merge yet)
[S3] round=6 local utility u=0.058650 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.316369613600842, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.433668675496571, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.322143 (no previous merge yet)
[S4] round=6 local utility u=0.080561 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.526142621575879, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6872641193108975, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.264844 (no previous merge yet)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.23857024106400668, 'auprc': 0.23857024106400668, 'loss_val': 1.3323532217138225, 'psi': 0.23857024106400668}-{'f1_val': 0.006431459022418228, 'auprc': 0.006431459022418228, 'loss_val': 1.4206073319954333, 'psi': 0.006431459022418228}
[S6] START round=6 head_norm_before_train=1.372047 (no previous merge yet)
[S6] round=6 local utility u=0.054760 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0390593124099032, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1485787068866657, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.275994 (no previous merge yet)
[S7] round=6 local utility u=0.135634 metrics={'f1_val': 0.0007446709485246206, 'auprc': 0.0007446709485246206, 'loss_val': 1.4680284225480724, 'psi': 0.0007446709485246206}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7325940034674001, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.221569 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.271866391184573, 'auprc': 0.271866391184573, 'loss_val': 1.4894085097445182, 'psi': 0.271866391184573}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.598775202837137, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.456016 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.2196827775696266, 'auprc': 0.2196827775696266, 'loss_val': 1.9844385898218109, 'psi': 0.2196827775696266}-{'f1_val': 0.00023775558725630053, 'auprc': 0.00023775558725630053, 'loss_val': 2.376211244437138, 'psi': 0.00023775558725630053}
[S10] START round=6 head_norm_before_train=1.337300 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3314460547222335, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9140448812059054, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=0.941581 cos_to_last_merge=0.9512 (last merge round=1)
[S11] round=6 local utility u=0.212194 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1382183407178887, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5626060048778747, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.229156 (no previous merge yet)
[S13] round=6 local utility u=0.080305 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7090355465553921, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.869645683967004, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.347012 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4019964006257823, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1349007864677776, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.188205 (no previous merge yet)
[S15] round=6 local utility u=0.130358 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7819533136707602, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0426686370270004, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.320175 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9608056634326143, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9445584818505885, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.172064 (no previous merge yet)
[S17] round=6 local utility u=0.067568 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5418182687869844, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6769546868045475, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:54503
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S3] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.001)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:54505
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S9
[S7] cosine check vs S9: cos=-0.0029
[S7] DROPPED delta from S9 (cos=-0.0029 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.1809
[S5] RECEIVED delta(kind=head bytes=1793) from S8
[S5] cosine check vs S8: cos=-0.0108
[S5] DROPPED delta from S8 (cos=-0.0108 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.0000 head_norm=1.450233
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.827749e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.0000 head_norm=1.058784 delta_norm=0.882775
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.373580 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.188510571869407, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.899028335435214, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.058784 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.210559 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.895251619137295, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.316369613600842, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.343719 (no previous merge yet)
[S4] round=7 local utility u=0.038534 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4490746878511558, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.526142621575879, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.302864 (no previous merge yet)
[S5] round=7 local utility u=0.572322 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2746278460998763, 'psi': 0.35933890172383154}-{'f1_val': 0.23857024106400668, 'auprc': 0.23857024106400668, 'loss_val': 1.3323532217138225, 'psi': 0.23857024106400668}
[S6] START round=7 head_norm_before_train=1.398991 (no previous merge yet)
[S6] round=7 local utility u=0.090180 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8586983688381924, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0390593124099032, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.296311 (no previous merge yet)
[S7] round=7 local utility u=0.781483 metrics={'f1_val': 0.1636785488293609, 'auprc': 0.1636785488293609, 'loss_val': 1.3714682080394305, 'psi': 0.1636785488293609}-{'f1_val': 0.0007446709485246206, 'auprc': 0.0007446709485246206, 'loss_val': 1.4680284225480724, 'psi': 0.0007446709485246206}
[S8] START round=7 head_norm_before_train=1.237053 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.24243820052203288, 'auprc': 0.24243820052203288, 'loss_val': 1.4875398482627191, 'psi': 0.24243820052203288}-{'f1_val': 0.271866391184573, 'auprc': 0.271866391184573, 'loss_val': 1.4894085097445182, 'psi': 0.271866391184573}
[S9] START round=7 head_norm_before_train=1.524431 (no previous merge yet)
[S9] round=7 local utility u=0.596788 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1317624647532507, 'psi': 0.36867172340800847}-{'f1_val': 0.2196827775696266, 'auprc': 0.2196827775696266, 'loss_val': 1.9844385898218109, 'psi': 0.2196827775696266}
[S10] START round=7 head_norm_before_train=1.368813 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9427964437188114, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3314460547222335, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=0.954790 cos_to_last_merge=0.9375 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=7 local utility u=0.013361 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1114969824945, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1382183407178887, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.233680 (no previous merge yet)
[S13] round=7 local utility u=0.069483 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.570069617545659, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7090355465553921, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.377490 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5271954623373394, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4019964006257823, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.192235 (no previous merge yet)
[S15] round=7 local utility u=0.029855 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.722243121335684, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7819533136707602, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.343475 (no previous merge yet)
[S16] round=7 local utility u=0.042119 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8765685775737198, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9608056634326143, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.188202 (no previous merge yet)
[S17] round=7 local utility u=0.040600 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4606183721721342, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5418182687869844, 'psi': 0.0}
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:54508
[S15] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:54503
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.164)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S9
[S7] cosine check vs S9: cos=-0.0081
[S7] DROPPED delta from S9 (cos=-0.0081 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.7099
[S17] not sending this round → trigger blocked (psi=0.000)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.0000 head_norm=1.122401
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.788314e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.137928 delta_norm=0.478831
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.405327 (no previous merge yet)
[S2] round=8 local utility u=0.158833 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8708441729693317, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.188510571869407, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.137928 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=1.000000 metrics={'f1_val': 0.1793628808864266, 'auprc': 0.1793628808864266, 'loss_val': 1.4715291445933127, 'psi': 0.1793628808864266}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.895251619137295, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.377464 (no previous merge yet)
[S4] round=8 local utility u=0.033653 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3817692140476245, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4490746878511558, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.337361 (no previous merge yet)
[S5] round=8 local utility u=0.013990 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2466477476327968, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2746278460998763, 'psi': 0.35933890172383154}
[S6] START round=8 head_norm_before_train=1.428411 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9663730665500965, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8586983688381924, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.327721 (no previous merge yet)
[S7] round=8 local utility u=0.903833 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3285692055340887, 'psi': 0.35976373724718097}-{'f1_val': 0.1636785488293609, 'auprc': 0.1636785488293609, 'loss_val': 1.3714682080394305, 'psi': 0.1636785488293609}
[S8] START round=8 head_norm_before_train=1.267011 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.23105062920690664, 'auprc': 0.23105062920690664, 'loss_val': 1.4336145409330892, 'psi': 0.23105062920690664}-{'f1_val': 0.24243820052203288, 'auprc': 0.24243820052203288, 'loss_val': 1.4875398482627191, 'psi': 0.24243820052203288}
[S9] START round=8 head_norm_before_train=1.587024 (no previous merge yet)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.270816752878642, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1317624647532507, 'psi': 0.36867172340800847}
[S10] START round=8 head_norm_before_train=1.404257 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1560619596319395, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9427964437188114, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=0.981223 cos_to_last_merge=0.9224 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.922
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1942342498250267, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1114969824945, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.238007 (no previous merge yet)
[S13] round=8 local utility u=0.013503 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5430626180444567, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.570069617545659, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.408739 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7990872503692437, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5271954623373394, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.207758 (no previous merge yet)
[S15] round=8 local utility u=0.005132 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7119799977331225, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.722243121335684, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.368703 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.907114029155043, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8765685775737198, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.213970 (no previous merge yet)
[S17] round=8 local utility u=1.000000 metrics={'f1_val': 0.21553884711779447, 'auprc': 0.21553884711779447, 'loss_val': 1.3471567585408168, 'psi': 0.21553884711779447}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4606183721721342, 'psi': 0.0}
[S2] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.179)
[S15] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:54513
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:54503
[S13] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S7
[S13] cosine check vs S7: cos=0.0412
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.8996
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=-0.0007
[S8] DROPPED delta from S17 (cos=-0.0007 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.0000 head_norm=1.254805
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.051067e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.0000 head_norm=0.943071 delta_norm=0.905107
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.1794 head_norm=1.208028
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.021259e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.2644 head_norm=1.261848 delta_norm=0.302126
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.438523 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2600965963013966, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8708441729693317, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.261848 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.432966 metrics={'f1_val': 0.2580686557587424, 'auprc': 0.2580686557587424, 'loss_val': 1.313948566296243, 'psi': 0.2580686557587424}-{'f1_val': 0.1793628808864266, 'auprc': 0.1793628808864266, 'loss_val': 1.4715291445933127, 'psi': 0.1793628808864266}
[S4] START round=9 head_norm_before_train=1.413350 (no previous merge yet)
[S4] round=9 local utility u=0.010995 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3597783446048555, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3817692140476245, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.381213 (no previous merge yet)
[S5] round=9 local utility u=1.000000 metrics={'f1_val': 0.7266094834846174, 'auprc': 0.7266094834846174, 'loss_val': 1.21641451808006, 'psi': 0.7266094834846174}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2466477476327968, 'psi': 0.35933890172383154}
[S6] START round=9 head_norm_before_train=1.462745 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.166504790778342, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9663730665500965, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.357449 (no previous merge yet)
[S7] round=9 local utility u=0.005423 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3177231812279226, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3285692055340887, 'psi': 0.35976373724718097}
[S8] START round=9 head_norm_before_train=1.301273 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.21948846260772867, 'auprc': 0.21948846260772867, 'loss_val': 1.3568677340905666, 'psi': 0.21948846260772867}-{'f1_val': 0.23105062920690664, 'auprc': 0.23105062920690664, 'loss_val': 1.4336145409330892, 'psi': 0.23105062920690664}
[S9] START round=9 head_norm_before_train=1.636989 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4534572742073237, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.270816752878642, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.437347 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.453342320617231, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1560619596319395, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.013579 cos_to_last_merge=0.9086 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.909
[S11] round=9 local utility u=0.203160 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7879141556349794, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1942342498250267, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=0.943071 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.050612 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4418376450313726, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5430626180444567, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.441641 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.260319950293412, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7990872503692437, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.231432 (no previous merge yet)
[S15] round=9 local utility u=0.127761 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4564582608060477, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7119799977331225, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.400551 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.019114964410184, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.907114029155043, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.239051 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.17931587386424372, 'auprc': 0.17931587386424372, 'loss_val': 1.2814998775302213, 'psi': 0.17931587386424372}-{'f1_val': 0.21553884711779447, 'auprc': 0.21553884711779447, 'loss_val': 1.3471567585408168, 'psi': 0.21553884711779447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:54513
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:54503
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] cosine check vs S3: cos=0.0581
[S13] RECEIVED delta(kind=head bytes=1797) from S7
[S13] cosine check vs S7: cos=0.7298
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=0.9492
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.0000 head_norm=1.478613
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.643058e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.021673 delta_norm=0.964306
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.0000 head_norm=0.964174
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.747034e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.096042 delta_norm=0.474703
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.2581 head_norm=1.327066
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.243248e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.2581 head_norm=1.357943 delta_norm=0.224325
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.471887 (no previous merge yet)
[S2] round=10 local utility u=0.285839 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6884190292229957, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2600965963013966, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.357943 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.25710357470210815, 'auprc': 0.25710357470210815, 'loss_val': 1.4062805569684422, 'psi': 0.25710357470210815}-{'f1_val': 0.2580686557587424, 'auprc': 0.2580686557587424, 'loss_val': 1.313948566296243, 'psi': 0.2580686557587424}
[S4] START round=10 head_norm_before_train=1.452574 (no previous merge yet)
[S4] round=10 local utility u=0.014944 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3298895312887415, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3597783446048555, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.423923 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.6641449773408996, 'auprc': 0.6641449773408996, 'loss_val': 1.1677728207591223, 'psi': 0.6641449773408996}-{'f1_val': 0.7266094834846174, 'auprc': 0.7266094834846174, 'loss_val': 1.21641451808006, 'psi': 0.7266094834846174}
[S6] START round=10 head_norm_before_train=1.497313 (no previous merge yet)
[S6] round=10 local utility u=0.030431 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1056431643035136, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.166504790778342, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.386966 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.23699699699699697, 'auprc': 0.23699699699699697, 'loss_val': 1.3258124861557699, 'psi': 0.23699699699699697}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3177231812279226, 'psi': 0.35976373724718097}
[S8] START round=10 head_norm_before_train=1.336856 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.21326310102647217, 'auprc': 0.21326310102647217, 'loss_val': 1.3312535618069006, 'psi': 0.21326310102647217}-{'f1_val': 0.21948846260772867, 'auprc': 0.21948846260772867, 'loss_val': 1.3568677340905666, 'psi': 0.21948846260772867}
[S9] START round=10 head_norm_before_train=1.675216 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5065881850752336, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4534572742073237, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.469746 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7862525766572555, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.453342320617231, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.047146 cos_to_last_merge=0.8954 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.895
[S11] round=10 local utility u=0.056325 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6752646106469895, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7879141556349794, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.096042 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.008060 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.42571749608444, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4418376450313726, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.021673 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.747725 metrics={'f1_val': 0.008090614886731391, 'auprc': 0.008090614886731391, 'loss_val': 2.8376854288577142, 'psi': 0.008090614886731391}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.260319950293412, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.255369 (no previous merge yet)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.22618728199624363, 'auprc': 0.22618728199624363, 'loss_val': 1.3001626045665757, 'psi': 0.22618728199624363}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4564582608060477, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.438503 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.199062940042768, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.019114964410184, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.266442 (no previous merge yet)
[S17] round=10 local utility u=0.016570 metrics={'f1_val': 0.17908718131574256, 'auprc': 0.17908718131574256, 'loss_val': 1.24630143716383, 'psi': 0.17908718131574256}-{'f1_val': 0.17931587386424372, 'auprc': 0.17931587386424372, 'loss_val': 1.2814998775302213, 'psi': 0.17931587386424372}
[S6] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.008)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.0719
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.0012
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.2133 head_norm=1.372249
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.423695e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.2137 head_norm=0.943516 delta_norm=0.942370
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.200 → S5@127.0.0.1:54505
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.0081 head_norm=1.060617
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.038381e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.0000 head_norm=0.862728 delta_norm=0.803838
[S14] aggregate: ROLLBACK (f1_val pre=0.008 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.257 → S7@127.0.0.1:54508
[S13] ⇄ pheromone p=0.134 → S10@127.0.0.1:54511
[S9] ⇄ pheromone p=0.257 → S7@127.0.0.1:54508
[S6] ⇄ pheromone p=0.127 → S7@127.0.0.1:54508
[S4] ⇄ pheromone p=0.132 → S14@127.0.0.1:54514
[S7] ⇄ pheromone p=0.320 → S13@127.0.0.1:54513
[S5] ⇄ pheromone p=0.424 → S3@127.0.0.1:54503
[S3] ⇄ pheromone p=0.342 → S14@127.0.0.1:54514
[S11] ⇄ pheromone p=0.170 → S2@127.0.0.1:54502
[S10] ⇄ pheromone p=0.107 → S5@127.0.0.1:54505
[S2] ⇄ pheromone p=0.190 → S6@127.0.0.1:54507
[S15] ⇄ pheromone p=0.348 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.261 → S8@127.0.0.1:54509
[S16] ⇄ pheromone p=0.112 → S14@127.0.0.1:54514
[S2] START round=11 head_norm_before_train=1.500267 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0963754397224883, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6884190292229957, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.410992 cos_to_last_merge=0.9955 (last merge round=9)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.27840759293435274, 'auprc': 0.27840759293435274, 'loss_val': 1.6939604503299985, 'psi': 0.27840759293435274}-{'f1_val': 0.25710357470210815, 'auprc': 0.25710357470210815, 'loss_val': 1.4062805569684422, 'psi': 0.25710357470210815}
[S4] START round=11 head_norm_before_train=1.493045 (no previous merge yet)
[S4] round=11 local utility u=0.014897 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3000952976729958, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3298895312887415, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.471203 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.33501365259399285, 'auprc': 0.33501365259399285, 'loss_val': 1.2096021856820087, 'psi': 0.33501365259399285}-{'f1_val': 0.6641449773408996, 'auprc': 0.6641449773408996, 'loss_val': 1.1677728207591223, 'psi': 0.6641449773408996}
[S6] START round=11 head_norm_before_train=1.528777 (no previous merge yet)
[S6] round=11 local utility u=0.164884 metrics={'f1_val': 0.03515798842901647, 'auprc': 0.03515798842901647, 'loss_val': 3.0922962211067184, 'psi': 0.03515798842901647}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1056431643035136, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.424374 (no previous merge yet)
[S7] round=11 local utility u=0.570802 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.289108594895049, 'psi': 0.35976373724718097}-{'f1_val': 0.23699699699699697, 'auprc': 0.23699699699699697, 'loss_val': 1.3258124861557699, 'psi': 0.23699699699699697}
[S8] START round=11 head_norm_before_train=0.943516 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.2084901300587575, 'auprc': 0.2084901300587575, 'loss_val': 1.2904504755764938, 'psi': 0.2084901300587575}-{'f1_val': 0.21326310102647217, 'auprc': 0.21326310102647217, 'loss_val': 1.3312535618069006, 'psi': 0.21326310102647217}
[S9] START round=11 head_norm_before_train=1.704200 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.572002323393923, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5065881850752336, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.495280 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.367086207784297, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.7862525766572555, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.086501 cos_to_last_merge=0.8830 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=11 local utility u=0.065641 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5439834336404457, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6752646106469895, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.112479 cos_to_last_merge=0.9967 (last merge round=9)
[S13] round=11 local utility u=0.004365 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4169883855374927, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.42571749608444, 'psi': 0.0}
[S14] START round=11 head_norm_before_train=0.862728 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.179770 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4053306269923267, 'psi': 0.0}-{'f1_val': 0.008090614886731391, 'auprc': 0.008090614886731391, 'loss_val': 2.8376854288577142, 'psi': 0.008090614886731391}
[S15] START round=11 head_norm_before_train=1.286857 (no previous merge yet)
[S15] round=11 local utility u=0.972466 metrics={'f1_val': 0.4289123252707409, 'auprc': 0.4289123252707409, 'loss_val': 1.1797569490033268, 'psi': 0.4289123252707409}-{'f1_val': 0.22618728199624363, 'auprc': 0.22618728199624363, 'loss_val': 1.3001626045665757, 'psi': 0.22618728199624363}
[S16] START round=11 head_norm_before_train=1.470307 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3667599459935853, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.199062940042768, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.293638 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.16431118126422262, 'auprc': 0.16431118126422262, 'loss_val': 1.2413206261610863, 'psi': 0.16431118126422262}-{'f1_val': 0.17908718131574256, 'auprc': 0.17908718131574256, 'loss_val': 1.24630143716383, 'psi': 0.17908718131574256}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.035)
[S13] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[S4] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S14] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.7536
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] cosine check vs S7: cos=0.9136
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.0000 head_norm=1.136405
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.147371e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.273038 delta_norm=0.314737
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.0000 head_norm=0.901581
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.371873e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.043864 delta_norm=0.437187
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.527608 (no previous merge yet)
[S2] round=12 local utility u=1.000000 metrics={'f1_val': 0.19072615923009625, 'auprc': 0.19072615923009625, 'loss_val': 2.6307851870424317, 'psi': 0.19072615923009625}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0963754397224883, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.482102 cos_to_last_merge=0.9842 (last merge round=9)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.26136882625432245, 'auprc': 0.26136882625432245, 'loss_val': 1.5474286743956467, 'psi': 0.26136882625432245}-{'f1_val': 0.27840759293435274, 'auprc': 0.27840759293435274, 'loss_val': 1.6939604503299985, 'psi': 0.27840759293435274}
[S4] START round=12 head_norm_before_train=1.531214 (no previous merge yet)
[S4] round=12 local utility u=0.634120 metrics={'f1_val': 0.13783856261732366, 'auprc': 0.13783856261732366, 'loss_val': 1.2724031752250216, 'psi': 0.13783856261732366}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3000952976729958, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.522025 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.33459436738125264, 'auprc': 0.33459436738125264, 'loss_val': 2.167311066234339, 'psi': 0.33459436738125264}-{'f1_val': 0.33501365259399285, 'auprc': 0.33501365259399285, 'loss_val': 1.2096021856820087, 'psi': 0.33501365259399285}
[S6] START round=12 head_norm_before_train=1.555462 (no previous merge yet)
[S6] round=12 local utility u=0.246323 metrics={'f1_val': 0.09578173374613003, 'auprc': 0.09578173374613003, 'loss_val': 3.145263300267874, 'psi': 0.09578173374613003}-{'f1_val': 0.03515798842901647, 'auprc': 0.03515798842901647, 'loss_val': 3.0922962211067184, 'psi': 0.03515798842901647}
[S7] START round=12 head_norm_before_train=1.465589 (no previous merge yet)
[S7] round=12 local utility u=0.014147 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2608147587379441, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.289108594895049, 'psi': 0.35976373724718097}
[S8] START round=12 head_norm_before_train=0.981001 cos_to_last_merge=0.9973 (last merge round=10)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.15465230166503427, 'auprc': 0.15465230166503427, 'loss_val': 1.2740382688796728, 'psi': 0.15465230166503427}-{'f1_val': 0.2084901300587575, 'auprc': 0.2084901300587575, 'loss_val': 1.2904504755764938, 'psi': 0.2084901300587575}
[S9] START round=12 head_norm_before_train=1.727829 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6386574731357837, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.572002323393923, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.511538 (no previous merge yet)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.703874149113886, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.367086207784297, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.128971 cos_to_last_merge=0.8719 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.872
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7992122115027145, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5439834336404457, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.273038 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=1.000000 metrics={'f1_val': 0.23877143157673295, 'auprc': 0.23877143157673295, 'loss_val': 1.3269069717966928, 'psi': 0.23877143157673295}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4169883855374927, 'psi': 0.0}
[S14] START round=12 head_norm_before_train=1.043864 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.022964 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3594031474294646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4053306269923267, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.322392 (no previous merge yet)
[S15] round=12 local utility u=0.852514 metrics={'f1_val': 0.6105843841692898, 'auprc': 0.6105843841692898, 'loss_val': 1.1097765589900133, 'psi': 0.6105843841692898}-{'f1_val': 0.4289123252707409, 'auprc': 0.4289123252707409, 'loss_val': 1.1797569490033268, 'psi': 0.4289123252707409}
[S16] START round=12 head_norm_before_train=1.498952 (no previous merge yet)
[S16] round=12 local utility u=0.590420 metrics={'f1_val': 0.05890746025275173, 'auprc': 0.05890746025275173, 'loss_val': 2.716087827823869, 'psi': 0.05890746025275173}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3667599459935853, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.320047 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.15653646871263452, 'auprc': 0.15653646871263452, 'loss_val': 1.1949744054389462, 'psi': 0.15653646871263452}-{'f1_val': 0.16431118126422262, 'auprc': 0.16431118126422262, 'loss_val': 1.2413206261610863, 'psi': 0.16431118126422262}
[S14] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.096)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.059)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.191)
[S4] not sending this round → trigger blocked (psi=0.138)
[S7] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=-0.1193
[S10] DROPPED delta from S13 (cos=-0.1193 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.9324
[S13] RECEIVED delta(kind=head bytes=1802) from S7
[S13] cosine check vs S7: cos=0.9738
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.0000 head_norm=1.071560
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.640686e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.0000 head_norm=1.194402 delta_norm=0.264069
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.2388 head_norm=1.289393
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.912527e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.2008 head_norm=1.386203 delta_norm=0.191253
[S13] aggregate: ROLLBACK (f1_val pre=0.239 post=0.201 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.554141 (no previous merge yet)
[S2] round=13 local utility u=0.397620 metrics={'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.507359478393765, 'psi': 0.26537216828478966}-{'f1_val': 0.19072615923009625, 'auprc': 0.19072615923009625, 'loss_val': 2.6307851870424317, 'psi': 0.19072615923009625}
[S3] START round=13 head_norm_before_train=1.544206 cos_to_last_merge=0.9736 (last merge round=9)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.28197699938547977, 'auprc': 0.28197699938547977, 'loss_val': 1.9994526272090514, 'psi': 0.28197699938547977}-{'f1_val': 0.26136882625432245, 'auprc': 0.26136882625432245, 'loss_val': 1.5474286743956467, 'psi': 0.26136882625432245}
[S4] START round=13 head_norm_before_train=1.562855 (no previous merge yet)
[S4] round=13 local utility u=0.883840 metrics={'f1_val': 0.33103565653986894, 'auprc': 0.33103565653986894, 'loss_val': 1.2434974855980891, 'psi': 0.33103565653986894}-{'f1_val': 0.13783856261732366, 'auprc': 0.13783856261732366, 'loss_val': 1.2724031752250216, 'psi': 0.13783856261732366}
[S5] START round=13 head_norm_before_train=1.571561 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.33367180249133277, 'auprc': 0.33367180249133277, 'loss_val': 2.5888976510734945, 'psi': 0.33367180249133277}-{'f1_val': 0.33459436738125264, 'auprc': 0.33459436738125264, 'loss_val': 2.167311066234339, 'psi': 0.33459436738125264}
[S6] START round=13 head_norm_before_train=1.581147 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.10087886893389378, 'auprc': 0.10087886893389378, 'loss_val': 3.6857125698823805, 'psi': 0.10087886893389378}-{'f1_val': 0.09578173374613003, 'auprc': 0.09578173374613003, 'loss_val': 3.145263300267874, 'psi': 0.09578173374613003}
[S7] START round=13 head_norm_before_train=1.501246 (no previous merge yet)
[S7] round=13 local utility u=0.030807 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.199200694574355, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2608147587379441, 'psi': 0.35976373724718097}
[S8] START round=13 head_norm_before_train=1.030310 cos_to_last_merge=0.9891 (last merge round=10)
[S8] round=13 local utility u=0.003838 metrics={'f1_val': 0.15306320279177976, 'auprc': 0.15306320279177976, 'loss_val': 1.2520600525667402, 'psi': 0.15306320279177976}-{'f1_val': 0.15465230166503427, 'auprc': 0.15465230166503427, 'loss_val': 1.2740382688796728, 'psi': 0.15465230166503427}
[S9] START round=13 head_norm_before_train=1.747342 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6822848154825727, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6386574731357837, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.525115 (no previous merge yet)
[S10] round=13 local utility u=0.159183 metrics={'f1_val': 0.019789734075448363, 'auprc': 0.019789734075448363, 'loss_val': 4.56361646153665, 'psi': 0.019789734075448363}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.703874149113886, 'psi': 0.0}
[S11] START round=13 head_norm_before_train=1.172031 cos_to_last_merge=0.8627 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.863
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.008932759263505, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7992122115027145, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.386203 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.010857 metrics={'f1_val': 0.23342070773263435, 'auprc': 0.23342070773263435, 'loss_val': 1.2570368251921176, 'psi': 0.23342070773263435}-{'f1_val': 0.23877143157673295, 'auprc': 0.23877143157673295, 'loss_val': 1.3269069717966928, 'psi': 0.23877143157673295}
[S14] START round=13 head_norm_before_train=1.194402 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.443314390145242, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3594031474294646, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.358092 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.0490916572769604, 'psi': 0.3329116592873709}-{'f1_val': 0.6105843841692898, 'auprc': 0.6105843841692898, 'loss_val': 1.1097765589900133, 'psi': 0.6105843841692898}
[S16] START round=13 head_norm_before_train=1.525335 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.00018621973929236498, 'auprc': 0.00018621973929236498, 'loss_val': 3.0358910445193197, 'psi': 0.00018621973929236498}-{'f1_val': 0.05890746025275173, 'auprc': 0.05890746025275173, 'loss_val': 2.716087827823869, 'psi': 0.05890746025275173}
[S17] START round=13 head_norm_before_train=1.347681 (no previous merge yet)
[S17] round=13 local utility u=0.013200 metrics={'f1_val': 0.15754111512234256, 'auprc': 0.15754111512234256, 'loss_val': 1.1776156809263936, 'psi': 0.15754111512234256}-{'f1_val': 0.15653646871263452, 'auprc': 0.15653646871263452, 'loss_val': 1.1949744054389462, 'psi': 0.15653646871263452}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.020)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S7] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=-0.1150
[S10] DROPPED delta from S13 (cos=-0.1150 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=-0.1118
[S14] DROPPED delta from S4 (cos=-0.1118 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1805) from S7
[S13] cosine check vs S7: cos=0.9880
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=-0.0557
[S6] DROPPED delta from S2 (cos=-0.0557 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=0.0514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S17
[S8] cosine check vs S17: cos=0.6043
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.3337 head_norm=1.618855
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.492120e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.3337 head_norm=0.995341 delta_norm=0.949212
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.1531 head_norm=1.078296
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.607970e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.1533 head_norm=1.099473 delta_norm=0.560797
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.2334 head_norm=1.403831
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.293575e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.2398 head_norm=1.461200 delta_norm=0.129357
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.583915 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.1964419475655431, 'auprc': 0.1964419475655431, 'loss_val': 3.2074676708103516, 'psi': 0.1964419475655431}-{'f1_val': 0.26537216828478966, 'auprc': 0.26537216828478966, 'loss_val': 2.507359478393765, 'psi': 0.26537216828478966}
[S3] START round=14 head_norm_before_train=1.583423 cos_to_last_merge=0.9667 (last merge round=9)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.2610245679299388, 'auprc': 0.2610245679299388, 'loss_val': 1.9265846191464613, 'psi': 0.2610245679299388}-{'f1_val': 0.28197699938547977, 'auprc': 0.28197699938547977, 'loss_val': 1.9994526272090514, 'psi': 0.28197699938547977}
[S4] START round=14 head_norm_before_train=1.589241 (no previous merge yet)
[S4] round=14 local utility u=0.009390 metrics={'f1_val': 0.33240105093652006, 'auprc': 0.33240105093652006, 'loss_val': 1.2370051395267403, 'psi': 0.33240105093652006}-{'f1_val': 0.33103565653986894, 'auprc': 0.33103565653986894, 'loss_val': 1.2434974855980891, 'psi': 0.33103565653986894}
[S5] START round=14 head_norm_before_train=0.995341 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.320002 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.944364767420879, 'psi': 0.333168561542264}-{'f1_val': 0.33367180249133277, 'auprc': 0.33367180249133277, 'loss_val': 2.5888976510734945, 'psi': 0.33367180249133277}
[S6] START round=14 head_norm_before_train=1.607432 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.06242144951822371, 'auprc': 0.06242144951822371, 'loss_val': 4.460172249327179, 'psi': 0.06242144951822372}-{'f1_val': 0.10087886893389378, 'auprc': 0.10087886893389378, 'loss_val': 3.6857125698823805, 'psi': 0.10087886893389378}
[S7] START round=14 head_norm_before_train=1.527395 (no previous merge yet)
[S7] round=14 local utility u=0.013081 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1730383927408206, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.199200694574355, 'psi': 0.35976373724718097}
[S8] START round=14 head_norm_before_train=1.099473 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.020744 metrics={'f1_val': 0.15363797181102434, 'auprc': 0.15363797181102434, 'loss_val': 1.2157451676835096, 'psi': 0.15363797181102434}-{'f1_val': 0.15306320279177976, 'auprc': 0.15306320279177976, 'loss_val': 1.2520600525667402, 'psi': 0.15306320279177976}
[S9] START round=14 head_norm_before_train=1.765139 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.717934195115965, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6822848154825727, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.536454 (no previous merge yet)
[S10] round=14 local utility u=0.603915 metrics={'f1_val': 0.15373299006987864, 'auprc': 0.15373299006987864, 'loss_val': 4.5612765777934765, 'psi': 0.15373299006987864}-{'f1_val': 0.019789734075448363, 'auprc': 0.019789734075448363, 'loss_val': 4.56361646153665, 'psi': 0.019789734075448363}
[S11] START round=14 head_norm_before_train=1.214310 cos_to_last_merge=0.8538 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.854
[S11] round=14 local utility u=0.178470 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6519928947288505, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.008932759263505, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.461200 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.465945 metrics={'f1_val': 0.3331695331695332, 'auprc': 0.3331695331695332, 'loss_val': 1.222886408908425, 'psi': 0.3331695331695332}-{'f1_val': 0.23342070773263435, 'auprc': 0.23342070773263435, 'loss_val': 1.2570368251921176, 'psi': 0.23342070773263435}
[S14] START round=14 head_norm_before_train=1.218662 cos_to_last_merge=0.9951 (last merge round=12)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0444622844179308, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.443314390145242, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.394770 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.31963170009865177, 'auprc': 0.31963170009865177, 'loss_val': 1.0349117401797177, 'psi': 0.31963170009865177}-{'f1_val': 0.3329116592873709, 'auprc': 0.3329116592873709, 'loss_val': 1.0490916572769604, 'psi': 0.3329116592873709}
[S16] START round=14 head_norm_before_train=1.551757 (no previous merge yet)
[S16] round=14 local utility u=0.342221 metrics={'f1_val': 0.05974683544303797, 'auprc': 0.05974683544303797, 'loss_val': 2.8874944532588125, 'psi': 0.05974683544303797}-{'f1_val': 0.00018621973929236498, 'auprc': 0.00018621973929236498, 'loss_val': 3.0358910445193197, 'psi': 0.00018621973929236498}
[S17] START round=14 head_norm_before_train=1.372569 (no previous merge yet)
[S17] round=14 local utility u=0.243924 metrics={'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.0997051339729844, 'psi': 0.20308965160623102}-{'f1_val': 0.15754111512234256, 'auprc': 0.15754111512234256, 'loss_val': 1.1776156809263936, 'psi': 0.15754111512234256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:54511
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.060)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.154)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] cosine check vs S8: cos=0.5071
[S14] RECEIVED delta(kind=head bytes=1806) from S4
[S14] cosine check vs S4: cos=-0.1066
[S14] DROPPED delta from S4 (cos=-0.1066 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=-0.1127
[S10] DROPPED delta from S13 (cos=-0.1127 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S7
[S13] cosine check vs S7: cos=0.9923
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.7461
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.8949
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.2610 head_norm=1.618499
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.432072e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.2664 head_norm=1.259528 delta_norm=0.543207
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.3332 head_norm=1.069314
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.477034e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.3332 head_norm=0.956620 delta_norm=0.547703
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.3332 head_norm=1.481276
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.980225e-02
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.3332 head_norm=1.511473 delta_norm=0.099802
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.1536 head_norm=1.134359
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.173826e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.1649 head_norm=1.232901 delta_norm=0.317383
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.613888 (no previous merge yet)
[S2] round=15 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.525256406759287, 'psi': 0.3674775928297055}-{'f1_val': 0.1964419475655431, 'auprc': 0.1964419475655431, 'loss_val': 3.2074676708103516, 'psi': 0.1964419475655431}
[S3] START round=15 head_norm_before_train=1.259528 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.219952 metrics={'f1_val': 0.27683171775390797, 'auprc': 0.27683171775390797, 'loss_val': 1.6289459226370036, 'psi': 0.27683171775390797}-{'f1_val': 0.2610245679299388, 'auprc': 0.2610245679299388, 'loss_val': 1.9265846191464613, 'psi': 0.2610245679299388}
[S4] START round=15 head_norm_before_train=1.616512 (no previous merge yet)
[S4] round=15 local utility u=0.005019 metrics={'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.233074746974485, 'psi': 0.3330795906284361}-{'f1_val': 0.33240105093652006, 'auprc': 0.33240105093652006, 'loss_val': 1.2370051395267403, 'psi': 0.33240105093652006}
[S5] START round=15 head_norm_before_train=0.956620 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.060262 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.82384110592099, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.944364767420879, 'psi': 0.333168561542264}
[S6] START round=15 head_norm_before_train=1.630804 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.04900690846286701, 'auprc': 0.04900690846286701, 'loss_val': 4.7154801816659075, 'psi': 0.04900690846286701}-{'f1_val': 0.06242144951822371, 'auprc': 0.06242144951822371, 'loss_val': 4.460172249327179, 'psi': 0.06242144951822372}
[S7] START round=15 head_norm_before_train=1.547529 (no previous merge yet)
[S7] round=15 local utility u=0.008543 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1559527498607638, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1730383927408206, 'psi': 0.35976373724718097}
[S8] START round=15 head_norm_before_train=1.232901 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.014930 metrics={'f1_val': 0.15335080942750615, 'auprc': 0.15335080942750615, 'loss_val': 1.1833010014150322, 'psi': 0.15335080942750615}-{'f1_val': 0.15363797181102434, 'auprc': 0.15363797181102434, 'loss_val': 1.2157451676835096, 'psi': 0.15363797181102434}
[S9] START round=15 head_norm_before_train=1.781018 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7565715169184997, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.717934195115965, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.549791 (no previous merge yet)
[S10] round=15 local utility u=0.307811 metrics={'f1_val': 0.19629005059021923, 'auprc': 0.19629005059021923, 'loss_val': 4.328668934752573, 'psi': 0.19629005059021923}-{'f1_val': 0.15373299006987864, 'auprc': 0.15373299006987864, 'loss_val': 4.5612765777934765, 'psi': 0.15373299006987864}
[S11] START round=15 head_norm_before_train=1.249147 cos_to_last_merge=0.8458 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.846
[S11] round=15 local utility u=1.000000 metrics={'f1_val': 0.31627071597681444, 'auprc': 0.31627071597681444, 'loss_val': 1.601170897975098, 'psi': 0.31627071597681444}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6519928947288505, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.511473 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.039503 metrics={'f1_val': 0.3330876934414149, 'auprc': 0.3330876934414149, 'loss_val': 1.1431431026444836, 'psi': 0.3330876934414149}-{'f1_val': 0.3331695331695332, 'auprc': 0.3331695331695332, 'loss_val': 1.222886408908425, 'psi': 0.3331695331695332}
[S14] START round=15 head_norm_before_train=1.258156 cos_to_last_merge=0.9820 (last merge round=12)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.015304560759106212, 'auprc': 0.015304560759106212, 'loss_val': 3.5669220543355364, 'psi': 0.01530456075910621}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0444622844179308, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.431964 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.27924620655898186, 'auprc': 0.27924620655898186, 'loss_val': 1.0049252814293341, 'psi': 0.27924620655898186}-{'f1_val': 0.31963170009865177, 'auprc': 0.31963170009865177, 'loss_val': 1.0349117401797177, 'psi': 0.31963170009865177}
[S16] START round=15 head_norm_before_train=1.578257 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.08507197153485363, 'auprc': 0.08507197153485363, 'loss_val': 3.127584726439076, 'psi': 0.08507197153485363}-{'f1_val': 0.05974683544303797, 'auprc': 0.05974683544303797, 'loss_val': 2.8874944532588125, 'psi': 0.05974683544303797}
[S17] START round=15 head_norm_before_train=1.398136 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.0530841290628328, 'psi': 0.15237633365664405}-{'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.0997051339729844, 'psi': 0.20308965160623102}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:54502
[S10] not sending this round → trigger blocked (psi=0.196)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:54503
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.1129
[S10] DROPPED delta from S13 (cos=-0.1129 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] cosine check vs S3: cos=0.2148
[S14] RECEIVED delta(kind=head bytes=1805) from S4
[S14] cosine check vs S4: cos=-0.1029
[S14] DROPPED delta from S4 (cos=-0.1029 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.9939
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.6759
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=-0.0590
[S6] DROPPED delta from S2 (cos=-0.0590 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S8
[S5] cosine check vs S8: cos=0.7921
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] cosine check vs S11: cos=0.0742
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.084 → S7@127.0.0.1:54508
[S6] ⇄ pheromone p=0.080 → S7@127.0.0.1:54508
[S15] ⇄ pheromone p=0.281 → S14@127.0.0.1:54514
[S10] ⇄ pheromone p=0.214 → S5@127.0.0.1:54505
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.0153 head_norm=1.305268
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.188716e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.0458 head_norm=1.018487 delta_norm=0.818872
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.101 → S7@127.0.0.1:54508
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.3332 head_norm=1.033423
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.849896e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.3332 head_norm=1.086197 delta_norm=0.384990
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.202 → S3@127.0.0.1:54503
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.2768 head_norm=1.308437
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.879085e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.2772 head_norm=1.073280 delta_norm=0.487908
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.156 → S14@127.0.0.1:54514
[S11] ⇄ pheromone p=0.290 → S2@127.0.0.1:54502
[S8] ⇄ pheromone p=0.072 → S5@127.0.0.1:54505
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.3331 head_norm=1.533616
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.758736e-02
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.3329 head_norm=1.548333 delta_norm=0.087587
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.231 → S10@127.0.0.1:54511
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.3675 head_norm=1.637705
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.000051e+00
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.3675 head_norm=1.074799 delta_norm=1.000051
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.416 → S6@127.0.0.1:54507
[S7] ⇄ pheromone p=0.161 → S13@127.0.0.1:54513
[S4] ⇄ pheromone p=0.225 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.126 → S8@127.0.0.1:54509
[S16] ⇄ pheromone p=0.152 → S14@127.0.0.1:54514
[S2] START round=16 head_norm_before_train=1.074799 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 1.851078961092189, 'psi': 0.2450298816928894}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.525256406759287, 'psi': 0.3674775928297055}
[S3] START round=16 head_norm_before_train=1.073280 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.054044 metrics={'f1_val': 0.27832783278327833, 'auprc': 0.27832783278327833, 'loss_val': 1.5343234267518089, 'psi': 0.27832783278327833}-{'f1_val': 0.27683171775390797, 'auprc': 0.27683171775390797, 'loss_val': 1.6289459226370036, 'psi': 0.27683171775390797}
[S4] START round=16 head_norm_before_train=1.649678 (no previous merge yet)
[S4] round=16 local utility u=0.001308 metrics={'f1_val': 0.33316421444275324, 'auprc': 0.33316421444275324, 'loss_val': 1.231219520827952, 'psi': 0.33316421444275324}-{'f1_val': 0.3330795906284361, 'auprc': 0.3330795906284361, 'loss_val': 1.233074746974485, 'psi': 0.3330795906284361}
[S5] START round=16 head_norm_before_train=1.086197 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.013740 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.7963620209159004, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.82384110592099, 'psi': 0.333168561542264}
[S6] START round=16 head_norm_before_train=1.651533 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.03370535714285714, 'auprc': 0.03370535714285714, 'loss_val': 4.991517785716628, 'psi': 0.03370535714285714}-{'f1_val': 0.04900690846286701, 'auprc': 0.04900690846286701, 'loss_val': 4.7154801816659075, 'psi': 0.04900690846286701}
[S7] START round=16 head_norm_before_train=1.567813 (no previous merge yet)
[S7] round=16 local utility u=0.005605 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1447431051778225, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1559527498607638, 'psi': 0.35976373724718097}
[S8] START round=16 head_norm_before_train=1.260205 cos_to_last_merge=0.9962 (last merge round=14)
[S8] round=16 local utility u=0.253827 metrics={'f1_val': 0.20413787636363867, 'auprc': 0.20413787636363867, 'loss_val': 1.132730615532824, 'psi': 0.20413787636363867}-{'f1_val': 0.15335080942750615, 'auprc': 0.15335080942750615, 'loss_val': 1.1833010014150322, 'psi': 0.15335080942750615}
[S9] START round=16 head_norm_before_train=1.795580 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7963709082743793, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7565715169184997, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.561558 (no previous merge yet)
[S10] round=16 local utility u=0.217438 metrics={'f1_val': 0.2099978170705086, 'auprc': 0.2099978170705086, 'loss_val': 4.017162613586996, 'psi': 0.20999781707050857}-{'f1_val': 0.19629005059021923, 'auprc': 0.19629005059021923, 'loss_val': 4.328668934752573, 'psi': 0.19629005059021923}
[S11] START round=16 head_norm_before_train=1.276133 cos_to_last_merge=0.8395 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.840
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.33162631905648665, 'auprc': 0.33162631905648665, 'loss_val': 1.7652598946176994, 'psi': 0.33162631905648665}-{'f1_val': 0.31627071597681444, 'auprc': 0.31627071597681444, 'loss_val': 1.601170897975098, 'psi': 0.31627071597681444}
[S13] START round=16 head_norm_before_train=1.548333 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.24632152588555858, 'auprc': 0.24632152588555858, 'loss_val': 1.1162270414678634, 'psi': 0.24632152588555858}-{'f1_val': 0.3330876934414149, 'auprc': 0.3330876934414149, 'loss_val': 1.1431431026444836, 'psi': 0.3330876934414149}
[S14] START round=16 head_norm_before_train=1.018487 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.895677 metrics={'f1_val': 0.11658265477575287, 'auprc': 0.11658265477575287, 'loss_val': 2.6870709501476675, 'psi': 0.11658265477575286}-{'f1_val': 0.015304560759106212, 'auprc': 0.015304560759106212, 'loss_val': 3.5669220543355364, 'psi': 0.01530456075910621}
[S15] START round=16 head_norm_before_train=1.465204 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.26585643752373717, 'auprc': 0.26585643752373717, 'loss_val': 0.9780311752570093, 'psi': 0.26585643752373717}-{'f1_val': 0.27924620655898186, 'auprc': 0.27924620655898186, 'loss_val': 1.0049252814293341, 'psi': 0.27924620655898186}
[S16] START round=16 head_norm_before_train=1.607872 (no previous merge yet)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 3.343021035197095, 'psi': 0.08899598393574297}-{'f1_val': 0.08507197153485363, 'auprc': 0.08507197153485363, 'loss_val': 3.127584726439076, 'psi': 0.08507197153485363}
[S17] START round=16 head_norm_before_train=1.430303 (no previous merge yet)
[S17] round=16 local utility u=0.256969 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9937963400286072, 'psi': 0.20289293555469456}-{'f1_val': 0.15237633365664405, 'auprc': 0.15237633365664405, 'loss_val': 1.0530841290628328, 'psi': 0.15237633365664405}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.117)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:54503
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:54505
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=-0.0123
[S5] DROPPED delta from S10 (cos=-0.0123 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=0.9190
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] cosine check vs S3: cos=0.7115
[S13] RECEIVED delta(kind=head bytes=1803) from S7
[S13] cosine check vs S7: cos=0.9950
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=-0.0961
[S14] DROPPED delta from S4 (cos=-0.0961 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.7385
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S17
[S8] cosine check vs S17: cos=0.9309
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.2463 head_norm=1.570961
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.079837e-02
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.2523 head_norm=1.582987 delta_norm=0.080798
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.1166 head_norm=1.065291
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.220755e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.1202 head_norm=1.023979 delta_norm=0.422075
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.3332 head_norm=1.162024
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.574149e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.3331 head_norm=1.207230 delta_norm=0.257415
[S5] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.2041 head_norm=1.302703
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.675784e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.2160 head_norm=1.356045 delta_norm=0.267578
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.2783 head_norm=1.148267
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.177357e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.2816 head_norm=1.076989 delta_norm=0.417736
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.108487 cos_to_last_merge=0.9989 (last merge round=15)
[S2] round=17 local utility u=0.030847 metrics={'f1_val': 0.26510952757983636, 'auprc': 0.26510952757983636, 'loss_val': 1.9701013818492958, 'psi': 0.26510952757983636}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 1.851078961092189, 'psi': 0.2450298816928894}
[S3] START round=17 head_norm_before_train=1.076989 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.27813579900999347, 'auprc': 0.27813579900999347, 'loss_val': 1.6032409711431415, 'psi': 0.27813579900999347}-{'f1_val': 0.27832783278327833, 'auprc': 0.27832783278327833, 'loss_val': 1.5343234267518089, 'psi': 0.27832783278327833}
[S4] START round=17 head_norm_before_train=1.683924 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.3327421670467021, 'auprc': 0.3327421670467021, 'loss_val': 1.227772741342123, 'psi': 0.3327421670467021}-{'f1_val': 0.33316421444275324, 'auprc': 0.33316421444275324, 'loss_val': 1.231219520827952, 'psi': 0.33316421444275324}
[S5] START round=17 head_norm_before_train=1.207230 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.8719323805015824, 'psi': 0.333168561542264}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.7963620209159004, 'psi': 0.333168561542264}
[S6] START round=17 head_norm_before_train=1.668773 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.029080252479711452, 'auprc': 0.029080252479711452, 'loss_val': 5.176698348935898, 'psi': 0.029080252479711452}-{'f1_val': 0.03370535714285714, 'auprc': 0.03370535714285714, 'loss_val': 4.991517785716628, 'psi': 0.03370535714285714}
[S7] START round=17 head_norm_before_train=1.599010 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1521737519327038, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1447431051778225, 'psi': 0.35976373724718097}
[S8] START round=17 head_norm_before_train=1.356045 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.020702 metrics={'f1_val': 0.20525829173403345, 'auprc': 0.20525829173403345, 'loss_val': 1.1014094122077907, 'psi': 0.20525829173403345}-{'f1_val': 0.20413787636363867, 'auprc': 0.20413787636363867, 'loss_val': 1.132730615532824, 'psi': 0.20413787636363867}
[S9] START round=17 head_norm_before_train=1.809106 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.827455480140247, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7963709082743793, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.574293 (no previous merge yet)
[S10] round=17 local utility u=0.119748 metrics={'f1_val': 0.22065877838183565, 'auprc': 0.22065877838183565, 'loss_val': 3.873615957980976, 'psi': 0.22065877838183562}-{'f1_val': 0.2099978170705086, 'auprc': 0.2099978170705086, 'loss_val': 4.017162613586996, 'psi': 0.20999781707050857}
[S11] START round=17 head_norm_before_train=1.303173 cos_to_last_merge=0.8337 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.834
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.3124360660529008, 'auprc': 0.3124360660529008, 'loss_val': 1.6970637520919793, 'psi': 0.3124360660529008}-{'f1_val': 0.33162631905648665, 'auprc': 0.33162631905648665, 'loss_val': 1.7652598946176994, 'psi': 0.33162631905648665}
[S13] START round=17 head_norm_before_train=1.582987 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.516089 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1065827603920204, 'psi': 0.3599362944611573}-{'f1_val': 0.24632152588555858, 'auprc': 0.24632152588555858, 'loss_val': 1.1162270414678634, 'psi': 0.24632152588555858}
[S14] START round=17 head_norm_before_train=1.023979 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.101542 metrics={'f1_val': 0.10213556174558959, 'auprc': 0.10213556174558959, 'loss_val': 2.353962677982786, 'psi': 0.10213556174558959}-{'f1_val': 0.11658265477575287, 'auprc': 0.11658265477575287, 'loss_val': 2.6870709501476675, 'psi': 0.11658265477575286}
[S15] START round=17 head_norm_before_train=1.500284 (no previous merge yet)
[S15] round=17 local utility u=0.173257 metrics={'f1_val': 0.2842995169082126, 'auprc': 0.2842995169082126, 'loss_val': 0.7975042135760995, 'psi': 0.2842995169082126}-{'f1_val': 0.26585643752373717, 'auprc': 0.26585643752373717, 'loss_val': 0.9780311752570093, 'psi': 0.26585643752373717}
[S16] START round=17 head_norm_before_train=1.635818 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.08937023666265544, 'auprc': 0.08937023666265544, 'loss_val': 3.3912650469645094, 'psi': 0.08937023666265544}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 3.343021035197095, 'psi': 0.08899598393574297}
[S17] START round=17 head_norm_before_train=1.457352 (no previous merge yet)
[S17] round=17 local utility u=0.010437 metrics={'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 0.9743382889981738, 'psi': 0.20305027788548533}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9937963400286072, 'psi': 0.20289293555469456}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:54507
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.102)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:54505
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:54514
[S15] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.1182
[S10] DROPPED delta from S13 (cos=-0.1182 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S15
[S14] cosine check vs S15: cos=0.4081
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=-0.1036
[S6] DROPPED delta from S2 (cos=-0.1036 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1806) from S8
[S5] cosine check vs S8: cos=0.9398
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.0106
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.9660
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.3332 head_norm=1.277367
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.210854e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.3336 head_norm=1.057231 delta_norm=0.521085
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.1021 head_norm=1.062834
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.329003e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.1035 head_norm=1.096275 delta_norm=0.732900
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.2053 head_norm=1.391999
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.922656e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.3171 head_norm=1.423914 delta_norm=0.192266
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.165164 cos_to_last_merge=0.9943 (last merge round=15)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.25418196654426767, 'auprc': 0.25418196654426767, 'loss_val': 2.1306992505236386, 'psi': 0.25418196654426767}-{'f1_val': 0.26510952757983636, 'auprc': 0.26510952757983636, 'loss_val': 1.9701013818492958, 'psi': 0.26510952757983636}
[S3] START round=18 head_norm_before_train=1.169922 cos_to_last_merge=0.9833 (last merge round=16)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.26387419787038996, 'auprc': 0.26387419787038996, 'loss_val': 1.4811015644544423, 'psi': 0.26387419787038996}-{'f1_val': 0.27813579900999347, 'auprc': 0.27813579900999347, 'loss_val': 1.6032409711431415, 'psi': 0.27813579900999347}
[S4] START round=18 head_norm_before_train=1.718289 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.3242042931162102, 'auprc': 0.3242042931162102, 'loss_val': 1.2122084707139984, 'psi': 0.3242042931162102}-{'f1_val': 0.3327421670467021, 'auprc': 0.3327421670467021, 'loss_val': 1.227772741342123, 'psi': 0.3327421670467021}
[S5] START round=18 head_norm_before_train=1.057231 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.879354296007302, 'psi': 0.33308623671855697}-{'f1_val': 0.333168561542264, 'auprc': 0.333168561542264, 'loss_val': 1.8719323805015824, 'psi': 0.333168561542264}
[S6] START round=18 head_norm_before_train=1.683027 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 5.476478878424341, 'psi': 0.02109124254928932}-{'f1_val': 0.029080252479711452, 'auprc': 0.029080252479711452, 'loss_val': 5.176698348935898, 'psi': 0.029080252479711452}
[S7] START round=18 head_norm_before_train=1.616450 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1842738092890837, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1521737519327038, 'psi': 0.35976373724718097}
[S8] START round=18 head_norm_before_train=1.423914 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.15356837794715686, 'auprc': 0.15356837794715686, 'loss_val': 1.0620511263142642, 'psi': 0.15356837794715686}-{'f1_val': 0.20525829173403345, 'auprc': 0.20525829173403345, 'loss_val': 1.1014094122077907, 'psi': 0.20525829173403345}
[S9] START round=18 head_norm_before_train=1.821748 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8574527626834025, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.827455480140247, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.587810 (no previous merge yet)
[S10] round=18 local utility u=0.505942 metrics={'f1_val': 0.271016548463357, 'auprc': 0.271016548463357, 'loss_val': 3.3149522634461364, 'psi': 0.271016548463357}-{'f1_val': 0.22065877838183565, 'auprc': 0.22065877838183565, 'loss_val': 3.873615957980976, 'psi': 0.22065877838183562}
[S11] START round=18 head_norm_before_train=1.325835 cos_to_last_merge=0.8288 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.829
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.291300497309081, 'auprc': 0.291300497309081, 'loss_val': 1.733611287469778, 'psi': 0.291300497309081}-{'f1_val': 0.3124360660529008, 'auprc': 0.3124360660529008, 'loss_val': 1.6970637520919793, 'psi': 0.3124360660529008}
[S13] START round=18 head_norm_before_train=1.603824 cos_to_last_merge=0.9994 (last merge round=16)
[S13] round=18 local utility u=0.034821 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0369407850443901, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1065827603920204, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.096275 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.0593607305936073, 'auprc': 0.0593607305936073, 'loss_val': 2.5562684810018275, 'psi': 0.0593607305936073}-{'f1_val': 0.10213556174558959, 'auprc': 0.10213556174558959, 'loss_val': 2.353962677982786, 'psi': 0.10213556174558959}
[S15] START round=18 head_norm_before_train=1.532418 (no previous merge yet)
[S15] round=18 local utility u=0.211537 metrics={'f1_val': 0.33745918809266123, 'auprc': 0.33745918809266123, 'loss_val': 0.8528671477890976, 'psi': 0.33745918809266123}-{'f1_val': 0.2842995169082126, 'auprc': 0.2842995169082126, 'loss_val': 0.7975042135760995, 'psi': 0.2842995169082126}
[S16] START round=18 head_norm_before_train=1.662132 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.08871745419479267, 'auprc': 0.08871745419479267, 'loss_val': 3.8629957252969116, 'psi': 0.08871745419479267}-{'f1_val': 0.08937023666265544, 'auprc': 0.08937023666265544, 'loss_val': 3.3912650469645094, 'psi': 0.08937023666265544}
[S17] START round=18 head_norm_before_train=1.480316 (no previous merge yet)
[S17] round=18 local utility u=0.012623 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9483836995942363, 'psi': 0.20297157622739018}-{'f1_val': 0.20305027788548533, 'auprc': 0.20305027788548533, 'loss_val': 0.9743382889981738, 'psi': 0.20305027788548533}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:54511
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1806) from S13
[S10] cosine check vs S13: cos=-0.1195
[S10] DROPPED delta from S13 (cos=-0.1195 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.8823
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.3684
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1808 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1808) from S17
[S8] cosine check vs S17: cos=0.9780
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.3331 head_norm=1.119404
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.916440e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.0006 head_norm=1.135259 delta_norm=0.791644
[S5] aggregate: ROLLBACK (f1_val pre=0.333 post=0.001 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.1536 head_norm=1.456457
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.566303e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.2087 head_norm=1.470584 delta_norm=0.156630
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.0594 head_norm=1.139154
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.855932e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.0763 head_norm=1.309963 delta_norm=0.385593
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.225520 cos_to_last_merge=0.9874 (last merge round=15)
[S2] round=19 local utility u=0.016253 metrics={'f1_val': 0.2500622354991287, 'auprc': 0.2500622354991287, 'loss_val': 2.0611147075064884, 'psi': 0.2500622354991287}-{'f1_val': 0.25418196654426767, 'auprc': 0.25418196654426767, 'loss_val': 2.1306992505236386, 'psi': 0.25418196654426767}
[S3] START round=19 head_norm_before_train=1.277158 cos_to_last_merge=0.9538 (last merge round=16)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.25489770837851516, 'auprc': 0.25489770837851516, 'loss_val': 1.6421486886833776, 'psi': 0.25489770837851516}-{'f1_val': 0.26387419787038996, 'auprc': 0.26387419787038996, 'loss_val': 1.4811015644544423, 'psi': 0.26387419787038996}
[S4] START round=19 head_norm_before_train=1.752792 (no previous merge yet)
[S4] round=19 local utility u=0.002232 metrics={'f1_val': 0.3238892994990556, 'auprc': 0.3238892994990556, 'loss_val': 1.2049093059020086, 'psi': 0.3238892994990556}-{'f1_val': 0.3242042931162102, 'auprc': 0.3242042931162102, 'loss_val': 1.2122084707139984, 'psi': 0.3242042931162102}
[S5] START round=19 head_norm_before_train=1.135259 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.001213392698598515, 'auprc': 0.001213392698598515, 'loss_val': 1.8987293916931078, 'psi': 0.001213392698598515}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.879354296007302, 'psi': 0.33308623671855697}
[S6] START round=19 head_norm_before_train=1.696904 (no previous merge yet)
[S6] round=19 local utility u=0.092507 metrics={'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.328689389239807, 'psi': 0.025227272727272727}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 5.476478878424341, 'psi': 0.02109124254928932}
[S7] START round=19 head_norm_before_train=1.631770 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1886421100056292, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1842738092890837, 'psi': 0.35976373724718097}
[S8] START round=19 head_norm_before_train=1.470584 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.256554 metrics={'f1_val': 0.20672826762566496, 'auprc': 0.20672826762566496, 'loss_val': 1.0273819095021743, 'psi': 0.20672826762566496}-{'f1_val': 0.15356837794715686, 'auprc': 0.15356837794715686, 'loss_val': 1.0620511263142642, 'psi': 0.15356837794715686}
[S9] START round=19 head_norm_before_train=1.833839 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8835080985079986, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8574527626834025, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.605602 (no previous merge yet)
[S10] round=19 local utility u=0.247073 metrics={'f1_val': 0.2985836192487024, 'auprc': 0.2985836192487024, 'loss_val': 3.0689098012156806, 'psi': 0.2985836192487024}-{'f1_val': 0.271016548463357, 'auprc': 0.271016548463357, 'loss_val': 3.3149522634461364, 'psi': 0.271016548463357}
[S11] START round=19 head_norm_before_train=1.346310 cos_to_last_merge=0.8243 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.824
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.29177755032412145, 'auprc': 0.29177755032412145, 'loss_val': 1.8140619463608754, 'psi': 0.29177755032412145}-{'f1_val': 0.291300497309081, 'auprc': 0.291300497309081, 'loss_val': 1.733611287469778, 'psi': 0.291300497309081}
[S13] START round=19 head_norm_before_train=1.627093 cos_to_last_merge=0.9980 (last merge round=16)
[S13] round=19 local utility u=0.022546 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9918481562245375, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0369407850443901, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.309963 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.0018744142455482662, 'auprc': 0.0018744142455482662, 'loss_val': 2.755234263441354, 'psi': 0.0018744142455482662}-{'f1_val': 0.0593607305936073, 'auprc': 0.0593607305936073, 'loss_val': 2.5562684810018275, 'psi': 0.0593607305936073}
[S15] START round=19 head_norm_before_train=1.559391 (no previous merge yet)
[S15] round=19 local utility u=0.628155 metrics={'f1_val': 0.47833499092168497, 'auprc': 0.47833499092168497, 'loss_val': 0.8644401983139687, 'psi': 0.47833499092168497}-{'f1_val': 0.33745918809266123, 'auprc': 0.33745918809266123, 'loss_val': 0.8528671477890976, 'psi': 0.33745918809266123}
[S16] START round=19 head_norm_before_train=1.685261 (no previous merge yet)
[S16] round=19 local utility u=0.127633 metrics={'f1_val': 0.08992546285164703, 'auprc': 0.08992546285164703, 'loss_val': 3.6186017174513725, 'psi': 0.08992546285164703}-{'f1_val': 0.08871745419479267, 'auprc': 0.08871745419479267, 'loss_val': 3.8629957252969116, 'psi': 0.08871745419479267}
[S17] START round=19 head_norm_before_train=1.501011 (no previous merge yet)
[S17] round=19 local utility u=0.009528 metrics={'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 0.9296824976866517, 'psi': 0.20301091942882987}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9483836995942363, 'psi': 0.20297157622739018}
[S6] not sending this round → trigger blocked (psi=0.025)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:54507
[S8] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=-0.1000
[S6] DROPPED delta from S2 (cos=-0.1000 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=-0.1167
[S14] DROPPED delta from S4 (cos=-0.1167 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=0.4511
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[S13] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=-0.1202
[S10] DROPPED delta from S13 (cos=-0.1202 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.9680
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[S10] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.8518
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9823
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.0012 head_norm=1.184370
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.284193e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.0006 head_norm=1.128890 delta_norm=0.228419
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] r=20 psi=0.001 u=0.0000 p_local=0.0842 f1=0.001 auprc=0.001 bytes=12600
[S3] r=20 psi=0.255 u=0.0000 p_local=0.0695 f1=0.255 auprc=0.255 bytes=5400
[S4] r=20 psi=0.324 u=0.0022 p_local=0.0927 f1=0.324 auprc=0.324 bytes=9011
[S2] r=20 psi=0.250 u=0.0163 p_local=0.1774 f1=0.250 auprc=0.250 bytes=7200
[S7] r=20 psi=0.360 u=0.0000 p_local=0.0664 f1=0.360 auprc=0.360 bytes=14401
[S6] r=20 psi=0.025 u=0.0925 p_local=0.0514 f1=0.025 auprc=0.025 bytes=0
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.2067 head_norm=1.503048
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.426510e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.3215 head_norm=1.506039 delta_norm=0.142651
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.207 u=0.2566 p_local=0.1096 f1=0.207 auprc=0.207 bytes=14394
[S10] r=20 psi=0.299 u=0.2471 p_local=0.2555 f1=0.299 auprc=0.299 bytes=7191
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0345 f1=0.369 auprc=0.369 bytes=3604
[S11] r=20 psi=0.292 u=0.0000 p_local=0.1186 f1=0.292 auprc=0.292 bytes=1795
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.0019 head_norm=1.347157
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.203453e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.0105 head_norm=1.455093 delta_norm=0.220345
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.002 u=0.0000 p_local=0.1462 f1=0.002 auprc=0.002 bytes=0
[S16] r=20 psi=0.090 u=0.1276 p_local=0.0877 f1=0.090 auprc=0.090 bytes=0
[S13] r=20 psi=0.360 u=0.0225 p_local=0.1706 f1=0.360 auprc=0.360 bytes=12615
[S15] r=20 psi=0.478 u=0.6282 p_local=0.2968 f1=0.478 auprc=0.478 bytes=10812
[S17] r=20 psi=0.203 u=0.0095 p_local=0.0833 f1=0.203 auprc=0.203 bytes=14430
[S2] START round=20 head_norm_before_train=1.278993 cos_to_last_merge=0.9805 (last merge round=15)
[S2] round=20 local utility u=0.515496 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0868611663344483, 'psi': 0.3674775928297055}-{'f1_val': 0.2500622354991287, 'auprc': 0.2500622354991287, 'loss_val': 2.0611147075064884, 'psi': 0.2500622354991287}
[S3] START round=20 head_norm_before_train=1.355315 cos_to_last_merge=0.9337 (last merge round=16)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.2629762659342207, 'auprc': 0.2629762659342207, 'loss_val': 1.7203313938235945, 'psi': 0.2629762659342207}-{'f1_val': 0.25489770837851516, 'auprc': 0.25489770837851516, 'loss_val': 1.6421486886833776, 'psi': 0.25489770837851516}
[S4] START round=20 head_norm_before_train=1.776557 (no previous merge yet)
[S4] round=20 local utility u=0.003797 metrics={'f1_val': 0.32333169372028203, 'auprc': 0.32333169372028203, 'loss_val': 1.1922961193504078, 'psi': 0.32333169372028203}-{'f1_val': 0.3238892994990556, 'auprc': 0.3238892994990556, 'loss_val': 1.2049093059020086, 'psi': 0.3238892994990556}
[S5] START round=20 head_norm_before_train=1.128890 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=1.000000 metrics={'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 1.9048036886453072, 'psi': 0.33409214683912186}-{'f1_val': 0.001213392698598515, 'auprc': 0.001213392698598515, 'loss_val': 1.8987293916931078, 'psi': 0.001213392698598515}
[S6] START round=20 head_norm_before_train=1.708994 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.917998891128635, 'psi': 0.0}-{'f1_val': 0.025227272727272727, 'auprc': 0.025227272727272727, 'loss_val': 5.328689389239807, 'psi': 0.025227272727272727}
[S7] START round=20 head_norm_before_train=1.652985 (no previous merge yet)
[S7] round=20 local utility u=0.009801 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1690410165543923, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1886421100056292, 'psi': 0.35976373724718097}
[S8] START round=20 head_norm_before_train=1.506039 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.021966 metrics={'f1_val': 0.20819331868373925, 'auprc': 0.20819331868373925, 'loss_val': 0.9966349814181087, 'psi': 0.20819331868373925}-{'f1_val': 0.20672826762566496, 'auprc': 0.20672826762566496, 'loss_val': 1.0273819095021743, 'psi': 0.20672826762566496}
[S9] START round=20 head_norm_before_train=1.845123 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9096735075167, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8835080985079986, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.626898 (no previous merge yet)
[S10] round=20 local utility u=0.181123 metrics={'f1_val': 0.32766164316966456, 'auprc': 0.32766164316966456, 'loss_val': 2.968366962762441, 'psi': 0.32766164316966456}-{'f1_val': 0.2985836192487024, 'auprc': 0.2985836192487024, 'loss_val': 3.0689098012156806, 'psi': 0.2985836192487024}
[S11] START round=20 head_norm_before_train=1.366620 cos_to_last_merge=0.8199 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.820
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.28054298642533937, 'auprc': 0.28054298642533937, 'loss_val': 1.7648361474162506, 'psi': 0.28054298642533937}-{'f1_val': 0.29177755032412145, 'auprc': 0.29177755032412145, 'loss_val': 1.8140619463608754, 'psi': 0.29177755032412145}
[S13] START round=20 head_norm_before_train=1.649683 cos_to_last_merge=0.9962 (last merge round=16)
[S13] round=20 local utility u=0.031426 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.928996477010797, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9918481562245375, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.455093 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.422647 metrics={'f1_val': 0.09416195856873823, 'auprc': 0.09416195856873823, 'loss_val': 2.7405275433462313, 'psi': 0.09416195856873823}-{'f1_val': 0.0018744142455482662, 'auprc': 0.0018744142455482662, 'loss_val': 2.755234263441354, 'psi': 0.0018744142455482662}
[S15] START round=20 head_norm_before_train=1.586463 (no previous merge yet)
[S15] round=20 local utility u=0.375595 metrics={'f1_val': 0.5556584553214972, 'auprc': 0.5556584553214972, 'loss_val': 0.8091623237409196, 'psi': 0.5556584553214972}-{'f1_val': 0.47833499092168497, 'auprc': 0.47833499092168497, 'loss_val': 0.8644401983139687, 'psi': 0.47833499092168497}
[S16] START round=20 head_norm_before_train=1.706291 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.08774048136520969, 'auprc': 0.08774048136520969, 'loss_val': 4.250250360476547, 'psi': 0.08774048136520969}-{'f1_val': 0.08992546285164703, 'auprc': 0.08992546285164703, 'loss_val': 3.6186017174513725, 'psi': 0.08992546285164703}
[S17] START round=20 head_norm_before_train=1.522450 (no previous merge yet)
[S17] round=20 local utility u=0.009552 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9095170589459968, 'psi': 0.20289293555469456}-{'f1_val': 0.20301091942882987, 'auprc': 0.20301091942882987, 'loss_val': 0.9296824976866517, 'psi': 0.20301091942882987}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1812 reason=None
[S8] → sending delta(kind=head bytes=1812) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:54503
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:54513
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[S14] not sending this round → trigger blocked (psi=0.094)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:54507
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1812 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=-0.1202
[S10] DROPPED delta from S13 (cos=-0.1202 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S7
[S13] cosine check vs S7: cos=0.9839
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=-0.1201
[S14] DROPPED delta from S4 (cos=-0.1201 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.9850
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=0.3863
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.7761
[S5] RECEIVED delta(kind=head bytes=1812) from S8
[S5] cosine check vs S8: cos=0.5750
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] cosine check vs S2: cos=-0.0991
[S6] DROPPED delta from S2 (cos=-0.0991 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=0.9841
[S6] ⇄ pheromone p=0.041 → S7@127.0.0.1:54508
[S9] ⇄ pheromone p=0.028 → S7@127.0.0.1:54508
[S11] ⇄ pheromone p=0.095 → S2@127.0.0.1:54502
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.0942 head_norm=1.490747
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.466776e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.1012 head_norm=1.544493 delta_norm=0.146678
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.201 → S7@127.0.0.1:54508
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.2630 head_norm=1.404183
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.234603e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.2634 head_norm=1.080538 delta_norm=0.723460
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.056 → S14@127.0.0.1:54514
[S15] ⇄ pheromone p=0.313 → S14@127.0.0.1:54514
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.3341 head_norm=1.187512
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.824815e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.0009 head_norm=1.148018 delta_norm=0.182482
[S5] aggregate: ROLLBACK (f1_val pre=0.334 post=0.001 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.267 → S3@127.0.0.1:54503
[S7] ⇄ pheromone p=0.055 → S13@127.0.0.1:54513
[S2] ⇄ pheromone p=0.245 → S6@127.0.0.1:54507
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.2082 head_norm=1.538925
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.374119e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.2579 head_norm=1.534542 delta_norm=0.137412
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.092 → S5@127.0.0.1:54505
[S10] ⇄ pheromone p=0.241 → S5@127.0.0.1:54505
[S4] ⇄ pheromone p=0.075 → S14@127.0.0.1:54514
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.3599 head_norm=1.668766
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.497449e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.3599 head_norm=1.662277 delta_norm=0.149745
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.143 → S10@127.0.0.1:54511
[S16] ⇄ pheromone p=0.070 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.069 → S8@127.0.0.1:54509
[S2] START round=21 head_norm_before_train=1.325566 cos_to_last_merge=0.9744 (last merge round=15)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1416135969906267, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0868611663344483, 'psi': 0.3674775928297055}
[S3] START round=21 head_norm_before_train=1.080538 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.114412 metrics={'f1_val': 0.26533499791926757, 'auprc': 0.26533499791926757, 'loss_val': 1.5127350903649976, 'psi': 0.26533499791926757}-{'f1_val': 0.2629762659342207, 'auprc': 0.2629762659342207, 'loss_val': 1.7203313938235945, 'psi': 0.2629762659342207}
[S4] START round=21 head_norm_before_train=1.798487 (no previous merge yet)
[S4] round=21 local utility u=0.007457 metrics={'f1_val': 0.3224593246668302, 'auprc': 0.3224593246668302, 'loss_val': 1.1695317932352491, 'psi': 0.3224593246668302}-{'f1_val': 0.32333169372028203, 'auprc': 0.32333169372028203, 'loss_val': 1.1922961193504078, 'psi': 0.32333169372028203}
[S5] START round=21 head_norm_before_train=1.148018 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9504879528299761, 'psi': 0.33358943696313936}-{'f1_val': 0.33409214683912186, 'auprc': 0.33409214683912186, 'loss_val': 1.9048036886453072, 'psi': 0.33409214683912186}
[S6] START round=21 head_norm_before_train=1.720586 (no previous merge yet)
[S6] round=21 local utility u=0.905388 metrics={'f1_val': 0.10629476064832265, 'auprc': 0.10629476064832265, 'loss_val': 5.063876543903179, 'psi': 0.10629476064832263}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.917998891128635, 'psi': 0.0}
[S7] START round=21 head_norm_before_train=1.669251 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1721126767014172, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1690410165543923, 'psi': 0.35976373724718097}
[S8] START round=21 head_norm_before_train=1.534542 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=1.000000 metrics={'f1_val': 0.5153864384408599, 'auprc': 0.5153864384408599, 'loss_val': 0.9814253872350401, 'psi': 0.5153864384408599}-{'f1_val': 0.20819331868373925, 'auprc': 0.20819331868373925, 'loss_val': 0.9966349814181087, 'psi': 0.20819331868373925}
[S9] START round=21 head_norm_before_train=1.855723 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9329979119100136, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9096735075167, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.647572 (no previous merge yet)
[S10] round=21 local utility u=0.062234 metrics={'f1_val': 0.3325347388596071, 'auprc': 0.3325347388596071, 'loss_val': 2.8877573660836697, 'psi': 0.3325347388596071}-{'f1_val': 0.32766164316966456, 'auprc': 0.32766164316966456, 'loss_val': 2.968366962762441, 'psi': 0.32766164316966456}
[S11] START round=21 head_norm_before_train=1.382497 cos_to_last_merge=0.8164 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.816
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.28274813198439464, 'auprc': 0.28274813198439464, 'loss_val': 1.8854199423604554, 'psi': 0.28274813198439464}-{'f1_val': 0.28054298642533937, 'auprc': 0.28054298642533937, 'loss_val': 1.7648361474162506, 'psi': 0.28054298642533937}
[S13] START round=21 head_norm_before_train=1.662277 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.018471 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8920547346021429, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.928996477010797, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.544493 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.1041501453872588, 'auprc': 0.1041501453872588, 'loss_val': 2.957766796538967, 'psi': 0.1041501453872588}-{'f1_val': 0.09416195856873823, 'auprc': 0.09416195856873823, 'loss_val': 2.7405275433462313, 'psi': 0.09416195856873823}
[S15] START round=21 head_norm_before_train=1.609850 (no previous merge yet)
[S15] round=21 local utility u=0.270591 metrics={'f1_val': 0.613669628539505, 'auprc': 0.613669628539505, 'loss_val': 0.7900813143050839, 'psi': 0.613669628539505}-{'f1_val': 0.5556584553214972, 'auprc': 0.5556584553214972, 'loss_val': 0.8091623237409196, 'psi': 0.5556584553214972}
[S16] START round=21 head_norm_before_train=1.722648 (no previous merge yet)
[S16] round=21 local utility u=0.561024 metrics={'f1_val': 0.1302664880154831, 'auprc': 0.1302664880154831, 'loss_val': 3.510935869761534, 'psi': 0.1302664880154831}-{'f1_val': 0.08774048136520969, 'auprc': 0.08774048136520969, 'loss_val': 4.250250360476547, 'psi': 0.08774048136520969}
[S17] START round=21 head_norm_before_train=1.542437 (no previous merge yet)
[S17] round=21 local utility u=0.004796 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9006325541898921, 'psi': 0.20297157622739018}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9095170589459968, 'psi': 0.20289293555469456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S5@127.0.0.1:54505
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.106)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.130)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=-0.1217
[S10] DROPPED delta from S13 (cos=-0.1217 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.9899
[S14] RECEIVED delta(kind=head bytes=1803) from S4
[S14] cosine check vs S4: cos=-0.1215
[S14] DROPPED delta from S4 (cos=-0.1215 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1805) from S3
[S14] cosine check vs S3: cos=0.1276
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.7323
[S5] RECEIVED delta(kind=head bytes=1808) from S8
[S5] cosine check vs S8: cos=0.6315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9861
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.3336 head_norm=1.209885
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.702575e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.3334 head_norm=1.169312 delta_norm=0.170258
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.1042 head_norm=1.580063
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.412588e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.1053 head_norm=1.259783 delta_norm=0.441259
[S14] aggregate: ACCEPT kept=['S15', 'S3'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.5154 head_norm=1.566372
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.304223e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.6052 head_norm=1.557721 delta_norm=0.130422
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.365331 cos_to_last_merge=0.9691 (last merge round=15)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1919758957979085, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1416135969906267, 'psi': 0.3674775928297055}
[S3] START round=22 head_norm_before_train=1.138500 cos_to_last_merge=0.9966 (last merge round=20)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2662031288800596, 'auprc': 0.2662031288800596, 'loss_val': 1.6508658603039454, 'psi': 0.2662031288800596}-{'f1_val': 0.26533499791926757, 'auprc': 0.26533499791926757, 'loss_val': 1.5127350903649976, 'psi': 0.26533499791926757}
[S4] START round=22 head_norm_before_train=1.815285 (no previous merge yet)
[S4] round=22 local utility u=0.005338 metrics={'f1_val': 0.32159165035877363, 'auprc': 0.32159165035877363, 'loss_val': 1.1510468772118534, 'psi': 0.32159165035877363}-{'f1_val': 0.3224593246668302, 'auprc': 0.3224593246668302, 'loss_val': 1.1695317932352491, 'psi': 0.3224593246668302}
[S5] START round=22 head_norm_before_train=1.169312 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9578988527696304, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9504879528299761, 'psi': 0.33358943696313936}
[S6] START round=22 head_norm_before_train=1.728816 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.032662192393736016, 'auprc': 0.032662192393736016, 'loss_val': 5.533537928602659, 'psi': 0.032662192393736016}-{'f1_val': 0.10629476064832265, 'auprc': 0.10629476064832265, 'loss_val': 5.063876543903179, 'psi': 0.10629476064832263}
[S7] START round=22 head_norm_before_train=1.679328 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.180074591691788, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1721126767014172, 'psi': 0.35976373724718097}
[S8] START round=22 head_norm_before_train=1.557721 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.682330 metrics={'f1_val': 0.6658315302871228, 'auprc': 0.6658315302871228, 'loss_val': 0.9707715460322519, 'psi': 0.6658315302871228}-{'f1_val': 0.5153864384408599, 'auprc': 0.5153864384408599, 'loss_val': 0.9814253872350401, 'psi': 0.5153864384408599}
[S9] START round=22 head_norm_before_train=1.865708 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9553697424360816, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9329979119100136, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.670178 (no previous merge yet)
[S10] round=22 local utility u=0.036560 metrics={'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 2.8175167770287426, 'psi': 0.3328546353917345}-{'f1_val': 0.3325347388596071, 'auprc': 0.3325347388596071, 'loss_val': 2.8877573660836697, 'psi': 0.3325347388596071}
[S11] START round=22 head_norm_before_train=1.400460 cos_to_last_merge=0.8121 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.812
[S11] round=22 local utility u=0.022539 metrics={'f1_val': 0.28043264503441495, 'auprc': 0.28043264503441495, 'loss_val': 1.8195020263938186, 'psi': 0.28043264503441495}-{'f1_val': 0.28274813198439464, 'auprc': 0.28274813198439464, 'loss_val': 1.8854199423604554, 'psi': 0.28274813198439464}
[S13] START round=22 head_norm_before_train=1.677521 cos_to_last_merge=0.9999 (last merge round=20)
[S13] round=22 local utility u=0.013590 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8648746469440343, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8920547346021429, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.259783 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.022403875264910684, 'auprc': 0.022403875264910684, 'loss_val': 2.972569075922799, 'psi': 0.022403875264910684}-{'f1_val': 0.1041501453872588, 'auprc': 0.1041501453872588, 'loss_val': 2.957766796538967, 'psi': 0.1041501453872588}
[S15] START round=22 head_norm_before_train=1.633541 (no previous merge yet)
[S15] round=22 local utility u=0.018395 metrics={'f1_val': 0.6143972677974848, 'auprc': 0.6143972677974848, 'loss_val': 0.7598408206512355, 'psi': 0.6143972677974848}-{'f1_val': 0.613669628539505, 'auprc': 0.613669628539505, 'loss_val': 0.7900813143050839, 'psi': 0.613669628539505}
[S16] START round=22 head_norm_before_train=1.736221 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.08980835538449201, 'auprc': 0.08980835538449201, 'loss_val': 4.171110055716381, 'psi': 0.08980835538449201}-{'f1_val': 0.1302664880154831, 'auprc': 0.1302664880154831, 'loss_val': 3.510935869761534, 'psi': 0.1302664880154831}
[S17] START round=22 head_norm_before_train=1.559964 (no previous merge yet)
[S17] round=22 local utility u=0.005949 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8880259567824471, 'psi': 0.20289293555469456}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.9006325541898921, 'psi': 0.20297157622739018}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:54511
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=-0.1217
[S10] DROPPED delta from S13 (cos=-0.1217 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S11
[S2] cosine check vs S11: cos=0.5339
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=-0.1122
[S14] DROPPED delta from S4 (cos=-0.1122 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=0.6568
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] cosine check vs S15: cos=0.9543
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.7111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.9879
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.3675 head_norm=1.399154
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.804773e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.3675 head_norm=1.234295 delta_norm=0.680477
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.0224 head_norm=1.299934
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.840967e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.0339 head_norm=1.460858 delta_norm=0.284097
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.3336 head_norm=1.232749
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.667534e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.3336 head_norm=1.188137 delta_norm=0.166753
[S5] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.6658 head_norm=1.590784
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.232155e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.6660 head_norm=1.577411 delta_norm=0.123216
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.234295 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.24656357388316152, 'auprc': 0.24656357388316152, 'loss_val': 1.6623542609111714, 'psi': 0.24656357388316152}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.1919758957979085, 'psi': 0.3674775928297055}
[S3] START round=23 head_norm_before_train=1.219650 cos_to_last_merge=0.9857 (last merge round=20)
[S3] round=23 local utility u=0.055155 metrics={'f1_val': 0.2671365395245992, 'auprc': 0.2671365395245992, 'loss_val': 1.5489574062805795, 'psi': 0.2671365395245992}-{'f1_val': 0.2662031288800596, 'auprc': 0.2662031288800596, 'loss_val': 1.6508658603039454, 'psi': 0.2662031288800596}
[S4] START round=23 head_norm_before_train=1.834318 (no previous merge yet)
[S4] round=23 local utility u=0.004816 metrics={'f1_val': 0.32119879469012136, 'auprc': 0.32119879469012136, 'loss_val': 1.1378785088250027, 'psi': 0.32119879469012136}-{'f1_val': 0.32159165035877363, 'auprc': 0.32159165035877363, 'loss_val': 1.1510468772118534, 'psi': 0.32159165035877363}
[S5] START round=23 head_norm_before_train=1.188137 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.034397 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.8891040580191214, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9578988527696304, 'psi': 0.33358943696313936}
[S6] START round=23 head_norm_before_train=1.733606 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.0012740882306099697, 'auprc': 0.0012740882306099697, 'loss_val': 6.151453434070858, 'psi': 0.0012740882306099697}-{'f1_val': 0.032662192393736016, 'auprc': 0.032662192393736016, 'loss_val': 5.533537928602659, 'psi': 0.032662192393736016}
[S7] START round=23 head_norm_before_train=1.697488 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.21324510913903, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.180074591691788, 'psi': 0.35976373724718097}
[S8] START round=23 head_norm_before_train=1.577411 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=1.000000 metrics={'f1_val': 0.9988711476383229, 'auprc': 0.9988711476383229, 'loss_val': 0.9587053847310576, 'psi': 0.9988711476383227}-{'f1_val': 0.6658315302871228, 'auprc': 0.6658315302871228, 'loss_val': 0.9707715460322519, 'psi': 0.6658315302871228}
[S9] START round=23 head_norm_before_train=1.875348 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.977303365924359, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9553697424360816, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.687980 (no previous merge yet)
[S10] round=23 local utility u=0.027496 metrics={'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.761808530618621, 'psi': 0.33277498604131767}-{'f1_val': 0.3328546353917345, 'auprc': 0.3328546353917345, 'loss_val': 2.8175167770287426, 'psi': 0.3328546353917345}
[S11] START round=23 head_norm_before_train=1.419660 cos_to_last_merge=0.8075 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.807
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.28054298642533937, 'auprc': 0.28054298642533937, 'loss_val': 1.9062018891800177, 'psi': 0.28054298642533937}-{'f1_val': 0.28043264503441495, 'auprc': 0.28043264503441495, 'loss_val': 1.8195020263938186, 'psi': 0.28043264503441495}
[S13] START round=23 head_norm_before_train=1.691887 cos_to_last_merge=0.9995 (last merge round=20)
[S13] round=23 local utility u=0.017982 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8289106372443386, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8648746469440343, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.460858 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.500053 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 2.9708273217388292, 'psi': 0.13333333333333333}-{'f1_val': 0.022403875264910684, 'auprc': 0.022403875264910684, 'loss_val': 2.972569075922799, 'psi': 0.022403875264910684}
[S15] START round=23 head_norm_before_train=1.655235 (no previous merge yet)
[S15] round=23 local utility u=0.031634 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.7159924939006728, 'psi': 0.6165550083006743}-{'f1_val': 0.6143972677974848, 'auprc': 0.6143972677974848, 'loss_val': 0.7598408206512355, 'psi': 0.6143972677974848}
[S16] START round=23 head_norm_before_train=1.749094 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.09006410256410256, 'auprc': 0.09006410256410256, 'loss_val': 4.1819045944875715, 'psi': 0.09006410256410256}-{'f1_val': 0.08980835538449201, 'auprc': 0.08980835538449201, 'loss_val': 4.171110055716381, 'psi': 0.08980835538449201}
[S17] START round=23 head_norm_before_train=1.573601 (no previous merge yet)
[S17] round=23 local utility u=0.003873 metrics={'f1_val': 0.20277508873830266, 'auprc': 0.20277508873830266, 'loss_val': 0.8792187799752136, 'psi': 0.20277508873830266}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8880259567824471, 'psi': 0.20289293555469456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.133)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:54511
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:54505
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.7076
[S10] RECEIVED delta(kind=head bytes=1804) from S13
[S10] cosine check vs S13: cos=-0.1218
[S10] DROPPED delta from S13 (cos=-0.1218 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.9851
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=-0.1203
[S14] DROPPED delta from S4 (cos=-0.1203 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] cosine check vs S3: cos=0.2069
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] cosine check vs S5: cos=0.6855
[S5] RECEIVED delta(kind=head bytes=1806) from S8
[S5] cosine check vs S8: cos=0.6707
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.9898
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9989 head_norm=1.611605
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.146662e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.4366 head_norm=1.597041 delta_norm=0.114666
[S8] aggregate: ROLLBACK (f1_val pre=0.999 post=0.437 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.2671 head_norm=1.292103
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.019942e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.2678 head_norm=1.160692 delta_norm=0.501994
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.3336 head_norm=1.236478
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.469643e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.3336 head_norm=1.197824 delta_norm=0.146964
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.1333 head_norm=1.499008
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.820885e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.1333 head_norm=1.258496 delta_norm=0.382088
[S14] aggregate: ACCEPT kept=['S15', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.271669 cos_to_last_merge=0.9990 (last merge round=22)
[S2] round=24 local utility u=0.533047 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6844864224247516, 'psi': 0.3674775928297055}-{'f1_val': 0.24656357388316152, 'auprc': 0.24656357388316152, 'loss_val': 1.6623542609111714, 'psi': 0.24656357388316152}
[S3] START round=24 head_norm_before_train=1.160692 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.26583700630887563, 'auprc': 0.26583700630887563, 'loss_val': 1.5715417247975423, 'psi': 0.26583700630887563}-{'f1_val': 0.2671365395245992, 'auprc': 0.2671365395245992, 'loss_val': 1.5489574062805795, 'psi': 0.2671365395245992}
[S4] START round=24 head_norm_before_train=1.850603 (no previous merge yet)
[S4] round=24 local utility u=0.010016 metrics={'f1_val': 0.3214343928280359, 'auprc': 0.3214343928280359, 'loss_val': 1.1199660693334565, 'psi': 0.3214343928280359}-{'f1_val': 0.32119879469012136, 'auprc': 0.32119879469012136, 'loss_val': 1.1378785088250027, 'psi': 0.32119879469012136}
[S5] START round=24 head_norm_before_train=1.197824 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000375 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.8883539117761714, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.8891040580191214, 'psi': 0.33358943696313936}
[S6] START round=24 head_norm_before_train=1.736813 (no previous merge yet)
[S6] round=24 local utility u=0.841630 metrics={'f1_val': 0.09919416730621643, 'auprc': 0.09919416730621643, 'loss_val': 5.349475134207411, 'psi': 0.09919416730621643}-{'f1_val': 0.0012740882306099697, 'auprc': 0.0012740882306099697, 'loss_val': 6.151453434070858, 'psi': 0.0012740882306099697}
[S7] START round=24 head_norm_before_train=1.720237 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.248652145119371, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.21324510913903, 'psi': 0.35976373724718097}
[S8] START round=24 head_norm_before_train=1.597041 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.23952024700154376, 'auprc': 0.23952024700154376, 'loss_val': 0.9464675378365343, 'psi': 0.23952024700154378}-{'f1_val': 0.9988711476383229, 'auprc': 0.9988711476383229, 'loss_val': 0.9587053847310576, 'psi': 0.9988711476383227}
[S9] START round=24 head_norm_before_train=1.884563 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.996586909410456, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.977303365924359, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.702669 (no previous merge yet)
[S10] round=24 local utility u=0.034058 metrics={'f1_val': 0.33277525312923545, 'auprc': 0.33277525312923545, 'loss_val': 2.6936940817501096, 'psi': 0.33277525312923545}-{'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.761808530618621, 'psi': 0.33277498604131767}
[S11] START round=24 head_norm_before_train=1.444348 cos_to_last_merge=0.8013 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.801
[S11] round=24 local utility u=0.013016 metrics={'f1_val': 0.30319790115578243, 'auprc': 0.30319790115578243, 'loss_val': 2.084063625180844, 'psi': 0.30319790115578243}-{'f1_val': 0.28054298642533937, 'auprc': 0.28054298642533937, 'loss_val': 1.9062018891800177, 'psi': 0.28054298642533937}
[S13] START round=24 head_norm_before_train=1.709153 cos_to_last_merge=0.9988 (last merge round=20)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8341546449869871, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8289106372443386, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.258496 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.05674978503869304, 'auprc': 0.05674978503869304, 'loss_val': 2.9697516724648803, 'psi': 0.05674978503869304}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 2.9708273217388292, 'psi': 0.13333333333333333}
[S15] START round=24 head_norm_before_train=1.676025 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6103333077394422, 'auprc': 0.6103333077394422, 'loss_val': 0.7407377348451049, 'psi': 0.6103333077394422}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.7159924939006728, 'psi': 0.6165550083006743}
[S16] START round=24 head_norm_before_train=1.760432 (no previous merge yet)
[S16] round=24 local utility u=0.586269 metrics={'f1_val': 0.14169215086646278, 'auprc': 0.14169215086646278, 'loss_val': 3.4740183004952785, 'psi': 0.14169215086646278}-{'f1_val': 0.09006410256410256, 'auprc': 0.09006410256410256, 'loss_val': 4.1819045944875715, 'psi': 0.09006410256410256}
[S17] START round=24 head_norm_before_train=1.590631 (no previous merge yet)
[S17] round=24 local utility u=0.004527 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8712252508561353, 'psi': 0.20289293555469456}-{'f1_val': 0.20277508873830266, 'auprc': 0.20277508873830266, 'loss_val': 0.8792187799752136, 'psi': 0.20277508873830266}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.099)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:54507
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:54503
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.142)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=-0.1137
[S14] DROPPED delta from S4 (cos=-0.1137 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.8634
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=-0.1143
[S6] DROPPED delta from S2 (cos=-0.1143 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.8370
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.7059
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.9918
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.2658 head_norm=1.235314
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.238096e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.2598 head_norm=1.195891 delta_norm=0.323810
[S3] aggregate: ROLLBACK (f1_val pre=0.266 post=0.260 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.3675 head_norm=1.322549
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.057230e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.3675 head_norm=1.340308 delta_norm=0.405723
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.2395 head_norm=1.631455
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.046448e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.2395 head_norm=1.614469 delta_norm=0.104645
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.3336 head_norm=1.242583
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.086326e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.0020 head_norm=1.370201 delta_norm=0.608633
[S5] aggregate: ROLLBACK (f1_val pre=0.334 post=0.002 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.340308 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.120697 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.4430919096693973, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6844864224247516, 'psi': 0.3674775928297055}
[S3] START round=25 head_norm_before_train=1.195891 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.26520611127125976, 'auprc': 0.26520611127125976, 'loss_val': 1.7550232650264639, 'psi': 0.26520611127125976}-{'f1_val': 0.26583700630887563, 'auprc': 0.26583700630887563, 'loss_val': 1.5715417247975423, 'psi': 0.26583700630887563}
[S4] START round=25 head_norm_before_train=1.868494 (no previous merge yet)
[S4] round=25 local utility u=0.009111 metrics={'f1_val': 0.32119879469012136, 'auprc': 0.32119879469012136, 'loss_val': 1.099623923292461, 'psi': 0.32119879469012136}-{'f1_val': 0.3214343928280359, 'auprc': 0.3214343928280359, 'loss_val': 1.1199660693334565, 'psi': 0.3214343928280359}
[S5] START round=25 head_norm_before_train=1.370201 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0033881728677834, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.8883539117761714, 'psi': 0.33358943696313936}
[S6] START round=25 head_norm_before_train=1.741096 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.0009555661729574773, 'auprc': 0.0009555661729574773, 'loss_val': 6.2081330360822236, 'psi': 0.0009555661729574773}-{'f1_val': 0.09919416730621643, 'auprc': 0.09919416730621643, 'loss_val': 5.349475134207411, 'psi': 0.09919416730621643}
[S7] START round=25 head_norm_before_train=1.735742 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2715999892035386, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.248652145119371, 'psi': 0.35976373724718097}
[S8] START round=25 head_norm_before_train=1.614469 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.546321 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9326933867346658, 'psi': 0.35939447907390915}-{'f1_val': 0.23952024700154376, 'auprc': 0.23952024700154376, 'loss_val': 0.9464675378365343, 'psi': 0.23952024700154378}
[S9] START round=25 head_norm_before_train=1.893080 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0154715923147655, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.996586909410456, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.718067 (no previous merge yet)
[S10] round=25 local utility u=0.046067 metrics={'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.6022815723551966, 'psi': 0.332855321861058}-{'f1_val': 0.33277525312923545, 'auprc': 0.33277525312923545, 'loss_val': 2.6936940817501096, 'psi': 0.33277525312923545}
[S11] START round=25 head_norm_before_train=1.474089 cos_to_last_merge=0.7933 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.793
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.2975643702157272, 'auprc': 0.2975643702157272, 'loss_val': 2.1379491537997772, 'psi': 0.2975643702157272}-{'f1_val': 0.30319790115578243, 'auprc': 0.30319790115578243, 'loss_val': 2.084063625180844, 'psi': 0.30319790115578243}
[S13] START round=25 head_norm_before_train=1.727654 cos_to_last_merge=0.9979 (last merge round=20)
[S13] round=25 local utility u=0.012795 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8085654825899136, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8341546449869871, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.301361 cos_to_last_merge=0.9982 (last merge round=23)
[S14] round=25 local utility u=0.284267 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 3.106654527989516, 'psi': 0.1351317597102535}-{'f1_val': 0.05674978503869304, 'auprc': 0.05674978503869304, 'loss_val': 2.9697516724648803, 'psi': 0.05674978503869304}
[S15] START round=25 head_norm_before_train=1.694139 (no previous merge yet)
[S15] round=25 local utility u=0.052384 metrics={'f1_val': 0.6166365676873765, 'auprc': 0.6166365676873765, 'loss_val': 0.6926988497818883, 'psi': 0.6166365676873765}-{'f1_val': 0.6103333077394422, 'auprc': 0.6103333077394422, 'loss_val': 0.7407377348451049, 'psi': 0.6103333077394422}
[S16] START round=25 head_norm_before_train=1.771305 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.040741708017759205, 'auprc': 0.040741708017759205, 'loss_val': 4.847689799432935, 'psi': 0.040741708017759205}-{'f1_val': 0.14169215086646278, 'auprc': 0.14169215086646278, 'loss_val': 3.4740183004952785, 'psi': 0.14169215086646278}
[S17] START round=25 head_norm_before_train=1.604143 (no previous merge yet)
[S17] round=25 local utility u=0.007608 metrics={'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.8633333442943578, 'psi': 0.20370676894079467}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8712252508561353, 'psi': 0.20289293555469456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:54505
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:54507
[S2] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=-0.1135
[S6] DROPPED delta from S2 (cos=-0.1135 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S10
[S5] cosine check vs S10: cos=0.9306
[S5] RECEIVED delta(kind=head bytes=1805) from S8
[S5] cosine check vs S8: cos=0.3163
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=-0.1118
[S14] DROPPED delta from S4 (cos=-0.1118 < 0.0)
[S14] not sending this round → trigger blocked (psi=0.135)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:54514
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.9265
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] cosine check vs S13: cos=-0.1203
[S10] DROPPED delta from S13 (cos=-0.1203 < 0.0)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9936
[S3] ⇄ pheromone p=0.035 → S14@127.0.0.1:54514
[S6] ⇄ pheromone p=0.222 → S7@127.0.0.1:54508
[S4] ⇄ pheromone p=0.030 → S14@127.0.0.1:54514
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.3594 head_norm=1.647326
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.345897e-02
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.3594 head_norm=1.631325 delta_norm=0.093459
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.419 → S5@127.0.0.1:54505
[S2] ⇄ pheromone p=0.190 → S6@127.0.0.1:54507
[S9] ⇄ pheromone p=0.009 → S7@127.0.0.1:54508
[S10] ⇄ pheromone p=0.106 → S5@127.0.0.1:54505
[S11] ⇄ pheromone p=0.035 → S2@127.0.0.1:54502
[S16] ⇄ pheromone p=0.163 → S14@127.0.0.1:54514
[S7] ⇄ pheromone p=0.018 → S13@127.0.0.1:54513
[S15] ⇄ pheromone p=0.141 → S14@127.0.0.1:54514
[S13] ⇄ pheromone p=0.055 → S10@127.0.0.1:54511
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.3336 head_norm=1.405702
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.179777e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.3336 head_norm=1.265929 delta_norm=0.317978
[S5] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.092 → S3@127.0.0.1:54503
[S17] ⇄ pheromone p=0.026 → S8@127.0.0.1:54509
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.1351 head_norm=1.345340
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.456249e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.1357 head_norm=1.503128 delta_norm=0.345625
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.187 → S7@127.0.0.1:54508
[S2] START round=26 head_norm_before_train=1.385922 cos_to_last_merge=0.9978 (last merge round=24)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 1.5382191958395275, 'psi': 0.24520932503356518}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.4430919096693973, 'psi': 0.3674775928297055}
[S3] START round=26 head_norm_before_train=1.275842 cos_to_last_merge=0.9884 (last merge round=24)
[S3] round=26 local utility u=0.640909 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.3638163770715372, 'psi': 0.3641628959276018}-{'f1_val': 0.26520611127125976, 'auprc': 0.26520611127125976, 'loss_val': 1.7550232650264639, 'psi': 0.26520611127125976}
[S4] START round=26 head_norm_before_train=1.886405 (no previous merge yet)
[S4] round=26 local utility u=0.004459 metrics={'f1_val': 0.32080689767366194, 'auprc': 0.32080689767366194, 'loss_val': 1.0871792150743569, 'psi': 0.32080689767366194}-{'f1_val': 0.32119879469012136, 'auprc': 0.32119879469012136, 'loss_val': 1.099623923292461, 'psi': 0.32119879469012136}
[S5] START round=26 head_norm_before_train=1.265929 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.047299 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9087902008464226, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0033881728677834, 'psi': 0.33358943696313936}
[S6] START round=26 head_norm_before_train=1.746082 (no previous merge yet)
[S6] round=26 local utility u=0.660097 metrics={'f1_val': 0.07227682227682228, 'auprc': 0.07227682227682228, 'loss_val': 5.529830789216807, 'psi': 0.07227682227682228}-{'f1_val': 0.0009555661729574773, 'auprc': 0.0009555661729574773, 'loss_val': 6.2081330360822236, 'psi': 0.0009555661729574773}
[S7] START round=26 head_norm_before_train=1.752816 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2790559302675508, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2715999892035386, 'psi': 0.35976373724718097}
[S8] START round=26 head_norm_before_train=1.631325 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.017073 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8985472893415474, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9326933867346658, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.901373 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.03431960954859, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0154715923147655, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.735808 (no previous merge yet)
[S10] round=26 local utility u=0.063900 metrics={'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.4752006607225203, 'psi': 0.33293527585383326}-{'f1_val': 0.332855321861058, 'auprc': 0.332855321861058, 'loss_val': 2.6022815723551966, 'psi': 0.332855321861058}
[S11] START round=26 head_norm_before_train=1.504326 cos_to_last_merge=0.7852 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.785
[S11] round=26 local utility u=0.051967 metrics={'f1_val': 0.3216004813477738, 'auprc': 0.3216004813477738, 'loss_val': 2.250340406477309, 'psi': 0.3216004813477738}-{'f1_val': 0.2975643702157272, 'auprc': 0.2975643702157272, 'loss_val': 2.1379491537997772, 'psi': 0.2975643702157272}
[S13] START round=26 head_norm_before_train=1.745115 cos_to_last_merge=0.9968 (last merge round=20)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8104890064241825, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8085654825899136, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.503128 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 3.1811510947831927, 'psi': 0.1331327566754419}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 3.106654527989516, 'psi': 0.1351317597102535}
[S15] START round=26 head_norm_before_train=1.716905 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6152400655239009, 'auprc': 0.6152400655239009, 'loss_val': 0.7116609708943704, 'psi': 0.6152400655239009}-{'f1_val': 0.6166365676873765, 'auprc': 0.6166365676873765, 'loss_val': 0.6926988497818883, 'psi': 0.6166365676873765}
[S16] START round=26 head_norm_before_train=1.781749 (no previous merge yet)
[S16] round=26 local utility u=0.412637 metrics={'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 4.46151624042527, 'psi': 0.08953068592057761}-{'f1_val': 0.040741708017759205, 'auprc': 0.040741708017759205, 'loss_val': 4.847689799432935, 'psi': 0.040741708017759205}
[S17] START round=26 head_norm_before_train=1.620565 (no previous merge yet)
[S17] round=26 local utility u=0.009201 metrics={'f1_val': 0.2042832666684461, 'auprc': 0.2042832666684461, 'loss_val': 0.8501200552703961, 'psi': 0.2042832666684461}-{'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.8633333442943578, 'psi': 0.20370676894079467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S5
[S8] cosine check vs S5: cos=0.5017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=0.8207
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.072)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:54517
[S8] sending update (kind=head size=1806 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] cosine check vs S8: cos=0.9947
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.090)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=-0.1185
[S13] DROPPED delta from S10 (cos=-0.1185 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.3336 head_norm=1.299274
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.008853e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.3336 head_norm=1.272969 delta_norm=0.400885
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.3594 head_norm=1.663375
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.560433e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.2395 head_norm=1.286803 delta_norm=0.756043
[S8] aggregate: ROLLBACK (f1_val pre=0.359 post=0.240 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.2043 head_norm=1.638863
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.604027e-02
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.2032 head_norm=1.648922 delta_norm=0.086040
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.440800 cos_to_last_merge=0.9916 (last merge round=24)
[S2] round=27 local utility u=0.515593 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6074469568998586, 'psi': 0.3674775928297055}-{'f1_val': 0.2452093250335652, 'auprc': 0.2452093250335652, 'loss_val': 1.5382191958395275, 'psi': 0.24520932503356518}
[S3] START round=27 head_norm_before_train=1.369016 cos_to_last_merge=0.9661 (last merge round=24)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 1.5070563620460404, 'psi': 0.24281921313058172}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 1.3638163770715372, 'psi': 0.3641628959276018}
[S4] START round=27 head_norm_before_train=1.908106 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.27735583684950776, 'auprc': 0.27735583684950776, 'loss_val': 1.0760266245858108, 'psi': 0.27735583684950776}-{'f1_val': 0.32080689767366194, 'auprc': 0.32080689767366194, 'loss_val': 1.0871792150743569, 'psi': 0.32080689767366194}
[S5] START round=27 head_norm_before_train=1.272969 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2796016578526146, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 1.9087902008464226, 'psi': 0.33358943696313936}
[S6] START round=27 head_norm_before_train=1.752212 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 6.0834559668205, 'psi': 0.018219557195571955}-{'f1_val': 0.07227682227682228, 'auprc': 0.07227682227682228, 'loss_val': 5.529830789216807, 'psi': 0.07227682227682228}
[S7] START round=27 head_norm_before_train=1.765087 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3010683633930078, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2790559302675508, 'psi': 0.35976373724718097}
[S8] START round=27 head_norm_before_train=1.286803 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.9712746477165871, 'psi': 0.23913947821952816}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8985472893415474, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.909592 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.050428118100326, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.03431960954859, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.760036 (no previous merge yet)
[S10] round=27 local utility u=0.072728 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.330461488847514, 'psi': 0.33301496338745623}-{'f1_val': 0.33293527585383326, 'auprc': 0.33293527585383326, 'loss_val': 2.4752006607225203, 'psi': 0.33293527585383326}
[S11] START round=27 head_norm_before_train=1.532187 cos_to_last_merge=0.7780 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.778
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.2884706199824597, 'auprc': 0.2884706199824597, 'loss_val': 2.2483751272654158, 'psi': 0.2884706199824597}-{'f1_val': 0.3216004813477738, 'auprc': 0.3216004813477738, 'loss_val': 2.250340406477309, 'psi': 0.3216004813477738}
[S13] START round=27 head_norm_before_train=1.761679 cos_to_last_merge=0.9956 (last merge round=20)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8124682620444309, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8104890064241825, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.537954 cos_to_last_merge=0.9993 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.08213157533305865, 'auprc': 0.08213157533305865, 'loss_val': 3.6311082887872153, 'psi': 0.08213157533305865}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 3.1811510947831927, 'psi': 0.1331327566754419}
[S15] START round=27 head_norm_before_train=1.737305 (no previous merge yet)
[S15] round=27 local utility u=0.016682 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6888779217809864, 'psi': 0.6164158146233559}-{'f1_val': 0.6152400655239009, 'auprc': 0.6152400655239009, 'loss_val': 0.7116609708943704, 'psi': 0.6152400655239009}
[S16] START round=27 head_norm_before_train=1.791919 (no previous merge yet)
[S16] round=27 local utility u=0.752763 metrics={'f1_val': 0.14386193894568922, 'auprc': 0.14386193894568922, 'loss_val': 3.44497182874474, 'psi': 0.14386193894568922}-{'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 4.46151624042527, 'psi': 0.08953068592057761}
[S17] START round=27 head_norm_before_train=1.648922 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.8698395432733713, 'psi': 0.20370676894079467}-{'f1_val': 0.2042832666684461, 'auprc': 0.2042832666684461, 'loss_val': 0.8501200552703961, 'psi': 0.2042832666684461}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:54512
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S2
[S11] cosine check vs S2: cos=0.9027
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S15] sending update (kind=head size=1811 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.144)
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] cosine check vs S10: cos=-0.1165
[S13] DROPPED delta from S10 (cos=-0.1165 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.2885 head_norm=1.558647
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.380977e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.3067 head_norm=1.487861 delta_norm=0.338098
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.492213 cos_to_last_merge=0.9842 (last merge round=24)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6952289204590507, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6074469568998586, 'psi': 0.3674775928297055}
[S3] START round=28 head_norm_before_train=1.438955 cos_to_last_merge=0.9490 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.24286317822439496, 'auprc': 0.24286317822439496, 'loss_val': 1.6327033352013323, 'psi': 0.24286317822439496}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 1.5070563620460404, 'psi': 0.24281921313058172}
[S4] START round=28 head_norm_before_train=1.926090 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.2552255225522552, 'auprc': 0.2552255225522552, 'loss_val': 1.0738166513661302, 'psi': 0.2552255225522552}-{'f1_val': 0.27735583684950776, 'auprc': 0.27735583684950776, 'loss_val': 1.0760266245858108, 'psi': 0.27735583684950776}
[S5] START round=28 head_norm_before_train=1.302305 cos_to_last_merge=0.9993 (last merge round=26)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.306762940109621, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2796016578526146, 'psi': 0.33358943696313936}
[S6] START round=28 head_norm_before_train=1.759583 (no previous merge yet)
[S6] round=28 local utility u=0.061469 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.994254088746358, 'psi': 0.021967963386727688}-{'f1_val': 0.018219557195571955, 'auprc': 0.018219557195571955, 'loss_val': 6.0834559668205, 'psi': 0.018219557195571955}
[S7] START round=28 head_norm_before_train=1.780285 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3243464690370732, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3010683633930078, 'psi': 0.35976373724718097}
[S8] START round=28 head_norm_before_train=1.323474 cos_to_last_merge=0.9988 (last merge round=26)
[S8] round=28 local utility u=0.559038 metrics={'f1_val': 0.35916622127204706, 'auprc': 0.35916622127204706, 'loss_val': 0.933439139758892, 'psi': 0.35916622127204706}-{'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.9712746477165871, 'psi': 0.23913947821952816}
[S9] START round=28 head_norm_before_train=1.917326 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.06855256498586, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.050428118100326, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.789633 (no previous merge yet)
[S10] round=28 local utility u=0.062140 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2061816194243318, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.330461488847514, 'psi': 0.33301496338745623}
[S11] START round=28 head_norm_before_train=1.487861 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.145371 metrics={'f1_val': 0.3232048374905518, 'auprc': 0.3232048374905518, 'loss_val': 2.270240354040447, 'psi': 0.3232048374905518}-{'f1_val': 0.2884706199824597, 'auprc': 0.2884706199824597, 'loss_val': 2.2483751272654158, 'psi': 0.2884706199824597}
[S13] START round=28 head_norm_before_train=1.775718 cos_to_last_merge=0.9945 (last merge round=20)
[S13] round=28 local utility u=0.015338 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.7817923125407142, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8124682620444309, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.569542 cos_to_last_merge=0.9976 (last merge round=25)
[S14] round=28 local utility u=0.174975 metrics={'f1_val': 0.12601626016260162, 'auprc': 0.12601626016260162, 'loss_val': 3.6761196052487564, 'psi': 0.12601626016260162}-{'f1_val': 0.08213157533305865, 'auprc': 0.08213157533305865, 'loss_val': 3.6311082887872153, 'psi': 0.08213157533305865}
[S15] START round=28 head_norm_before_train=1.756638 (no previous merge yet)
[S15] round=28 local utility u=0.003448 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6812478558163292, 'psi': 0.6163342951580373}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6888779217809864, 'psi': 0.6164158146233559}
[S16] START round=28 head_norm_before_train=1.802040 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 4.665945815093176, 'psi': 0.0894132755437836}-{'f1_val': 0.14386193894568922, 'auprc': 0.14386193894568922, 'loss_val': 3.44497182874474, 'psi': 0.14386193894568922}
[S17] START round=28 head_norm_before_train=1.668536 cos_to_last_merge=0.9999 (last merge round=26)
[S17] round=28 local utility u=0.475041 metrics={'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 0.8651951251342532, 'psi': 0.30875549754205167}-{'f1_val': 0.20370676894079467, 'auprc': 0.20370676894079467, 'loss_val': 0.8698395432733713, 'psi': 0.20370676894079467}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:54517
[S6] not sending this round → trigger blocked (psi=0.022)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.126)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:54508
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.8933
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] cosine check vs S10: cos=-0.1147
[S13] DROPPED delta from S10 (cos=-0.1147 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1806) from S13
[S7] cosine check vs S13: cos=0.9737
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.3598 head_norm=1.793597
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.052690e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.3598 head_norm=1.777178 delta_norm=0.205269
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.3088 head_norm=1.684160
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.849190e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.3038 head_norm=1.483832 delta_norm=0.384919
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.535481 cos_to_last_merge=0.9776 (last merge round=24)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.24139140192159336, 'auprc': 0.24139140192159336, 'loss_val': 1.9959424262772867, 'psi': 0.24139140192159336}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.6952289204590507, 'psi': 0.3674775928297055}
[S3] START round=29 head_norm_before_train=1.488573 cos_to_last_merge=0.9375 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.2438787878787879, 'auprc': 0.2438787878787879, 'loss_val': 1.7209707014099966, 'psi': 0.2438787878787879}-{'f1_val': 0.24286317822439496, 'auprc': 0.24286317822439496, 'loss_val': 1.6327033352013323, 'psi': 0.24286317822439496}
[S4] START round=29 head_norm_before_train=1.936918 (no previous merge yet)
[S4] round=29 local utility u=0.455510 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0769117006044922, 'psi': 0.3567939207526687}-{'f1_val': 0.2552255225522552, 'auprc': 0.2552255225522552, 'loss_val': 1.0738166513661302, 'psi': 0.2552255225522552}
[S5] START round=29 head_norm_before_train=1.321587 cos_to_last_merge=0.9984 (last merge round=26)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.318646311619951, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.306762940109621, 'psi': 0.33358943696313936}
[S6] START round=29 head_norm_before_train=1.770496 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.207957333477347, 'psi': 0.01732902033271719}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 5.994254088746358, 'psi': 0.021967963386727688}
[S7] START round=29 head_norm_before_train=1.777178 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.015263 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2938206236654317, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3243464690370732, 'psi': 0.35976373724718097}
[S8] START round=29 head_norm_before_train=1.365081 cos_to_last_merge=0.9954 (last merge round=26)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.9118064938726962, 'psi': 0.23913947821952816}-{'f1_val': 0.35916622127204706, 'auprc': 0.35916622127204706, 'loss_val': 0.933439139758892, 'psi': 0.35916622127204706}
[S9] START round=29 head_norm_before_train=1.925111 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0867937269904755, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.06855256498586, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.822533 (no previous merge yet)
[S10] round=29 local utility u=0.069570 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0670417213025587, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.2061816194243318, 'psi': 0.33301496338745623}
[S11] START round=29 head_norm_before_train=1.511375 cos_to_last_merge=0.9998 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3239393939393939, 'auprc': 0.3239393939393939, 'loss_val': 2.3446784375835303, 'psi': 0.3239393939393939}-{'f1_val': 0.3232048374905518, 'auprc': 0.3232048374905518, 'loss_val': 2.270240354040447, 'psi': 0.3232048374905518}
[S13] START round=29 head_norm_before_train=1.784378 cos_to_last_merge=0.9938 (last merge round=20)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8492294739665333, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.7817923125407142, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.596856 cos_to_last_merge=0.9956 (last merge round=25)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.818378014141363, 'psi': 0.13592717296421}-{'f1_val': 0.12601626016260162, 'auprc': 0.12601626016260162, 'loss_val': 3.6761196052487564, 'psi': 0.12601626016260162}
[S15] START round=29 head_norm_before_train=1.778456 (no previous merge yet)
[S15] round=29 local utility u=0.010867 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6595144943851043, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6812478558163292, 'psi': 0.6163342951580373}
[S16] START round=29 head_norm_before_train=1.812002 (no previous merge yet)
[S16] round=29 local utility u=0.024424 metrics={'f1_val': 0.08966955405838949, 'auprc': 0.08966955405838949, 'loss_val': 4.619404760929806, 'psi': 0.08966955405838949}-{'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 4.665945815093176, 'psi': 0.0894132755437836}
[S17] START round=29 head_norm_before_train=1.483832 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.305462446064211, 'auprc': 0.305462446064211, 'loss_val': 0.897882567814836, 'psi': 0.305462446064211}-{'f1_val': 0.30875549754205167, 'auprc': 0.30875549754205167, 'loss_val': 0.8651951251342532, 'psi': 0.30875549754205167}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:54513
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:54507
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.1134
[S13] DROPPED delta from S10 (cos=-0.1134 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.0063
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.0173 head_norm=1.781124
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.259487e+00
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.0173 head_norm=1.267486 delta_norm=1.259487
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.569194 cos_to_last_merge=0.9724 (last merge round=24)
[S2] round=30 local utility u=0.100703 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 1.8272835648609784, 'psi': 0.2450298816928894}-{'f1_val': 0.24139140192159336, 'auprc': 0.24139140192159336, 'loss_val': 1.9959424262772867, 'psi': 0.24139140192159336}
[S3] START round=30 head_norm_before_train=1.524191 cos_to_last_merge=0.9296 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.24286317822439496, 'auprc': 0.24286317822439496, 'loss_val': 1.7973240144746632, 'psi': 0.24286317822439496}-{'f1_val': 0.2438787878787879, 'auprc': 0.2438787878787879, 'loss_val': 1.7209707014099966, 'psi': 0.2438787878787879}
[S4] START round=30 head_norm_before_train=1.946868 (no previous merge yet)
[S4] round=30 local utility u=0.000148 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0766160030364218, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0769117006044922, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=1.345964 cos_to_last_merge=0.9966 (last merge round=26)
[S5] round=30 local utility u=0.023390 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2718669093743187, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.318646311619951, 'psi': 0.33358943696313936}
[S6] START round=30 head_norm_before_train=1.267486 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 3.153835836440942, 'psi': 0.021749084249084248}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 6.207957333477347, 'psi': 0.01732902033271719}
[S7] START round=30 head_norm_before_train=1.792554 cos_to_last_merge=0.9999 (last merge round=28)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3254609720674275, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2938206236654317, 'psi': 0.35976373724718097}
[S8] START round=30 head_norm_before_train=1.401597 cos_to_last_merge=0.9912 (last merge round=26)
[S8] round=30 local utility u=0.547159 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8997840037462461, 'psi': 0.35939447907390915}-{'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 0.9118064938726962, 'psi': 0.23913947821952816}
[S9] START round=30 head_norm_before_train=1.932689 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1037290240345548, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0867937269904755, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.854878 (no previous merge yet)
[S10] round=30 local utility u=0.047868 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9713066181008125, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.0670417213025587, 'psi': 0.33301496338745623}
[S11] START round=30 head_norm_before_train=1.534009 cos_to_last_merge=0.9992 (last merge round=27)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3187951986878402, 'auprc': 0.3187951986878402, 'loss_val': 2.338530487093845, 'psi': 0.3187951986878402}-{'f1_val': 0.3239393939393939, 'auprc': 0.3239393939393939, 'loss_val': 2.3446784375835303, 'psi': 0.3239393939393939}
[S13] START round=30 head_norm_before_train=1.791265 cos_to_last_merge=0.9932 (last merge round=20)
[S13] round=30 local utility u=0.033683 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.781864208527175, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8492294739665333, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.619957 cos_to_last_merge=0.9937 (last merge round=25)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.958316613168706, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.818378014141363, 'psi': 0.13592717296421}
[S15] START round=30 head_norm_before_train=1.803985 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6613452748667219, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6595144943851043, 'psi': 0.6163342951580373}
[S16] START round=30 head_norm_before_train=1.821455 (no previous merge yet)
[S16] round=30 local utility u=0.966149 metrics={'f1_val': 0.16233221476510068, 'auprc': 0.16233221476510068, 'loss_val': 3.341071688928691, 'psi': 0.16233221476510068}-{'f1_val': 0.08966955405838949, 'auprc': 0.08966955405838949, 'loss_val': 4.619404760929806, 'psi': 0.08966955405838949}
[S17] START round=30 head_norm_before_train=1.499431 cos_to_last_merge=0.9999 (last merge round=28)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.24367715542429502, 'auprc': 0.24367715542429502, 'loss_val': 0.8786638807845957, 'psi': 0.24367715542429502}-{'f1_val': 0.305462446064211, 'auprc': 0.305462446064211, 'loss_val': 0.897882567814836, 'psi': 0.305462446064211}
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[S6] not sending this round → trigger blocked (psi=0.022)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:54517
[S16] not sending this round → trigger blocked (psi=0.162)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:54509
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S3] ⇄ pheromone p=0.064 → S5@127.0.0.1:54505
[S6] ⇄ pheromone p=0.335 → S2@127.0.0.1:54502
[S2] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=0.9614
[S8] RECEIVED delta(kind=head bytes=1803) from S5
[S8] cosine check vs S5: cos=0.8345
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=-0.1125
[S13] DROPPED delta from S10 (cos=-0.1125 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=0.9510
[S7] RECEIVED delta(kind=head bytes=1801) from S13
[S7] cosine check vs S13: cos=0.9905
[S2] ⇄ pheromone p=0.135 → S11@127.0.0.1:54512
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.3594 head_norm=1.431869
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.053516e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.3594 head_norm=1.347277 delta_norm=0.405352
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.320 → S17@127.0.0.1:54517
[S13] ⇄ pheromone p=0.027 → S7@127.0.0.1:54508
[S10] ⇄ pheromone p=0.076 → S13@127.0.0.1:54513
[S5] ⇄ pheromone p=0.039 → S8@127.0.0.1:54509
[S14] CommDone barrier timeout: have=1 need=3 — continuing
[S14] ⇄ pheromone p=0.084 → S16@127.0.0.1:54516
[S7] CommDone barrier timeout: have=1 need=2 — continuing
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.3598 head_norm=1.812371
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.246992e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.3598 head_norm=1.799957 delta_norm=0.124699
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.008 → S6@127.0.0.1:54507
[S2] START round=31 head_norm_before_train=1.596595 cos_to_last_merge=0.9682 (last merge round=24)
[S2] round=31 local utility u=0.522116 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.8850816646819104, 'psi': 0.3674775928297055}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 1.8272835648609784, 'psi': 0.2450298816928894}
[S3] START round=31 head_norm_before_train=1.552083 cos_to_last_merge=0.9237 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.2429071592418206, 'auprc': 0.2429071592418206, 'loss_val': 1.8524332675670374, 'psi': 0.2429071592418206}-{'f1_val': 0.24286317822439496, 'auprc': 0.24286317822439496, 'loss_val': 1.7973240144746632, 'psi': 0.24286317822439496}
[S4] START round=31 head_norm_before_train=1.956725 (no previous merge yet)
[S4] round=31 local utility u=0.000615 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0753868527960564, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0766160030364218, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=31 head_norm_before_train=1.381550 cos_to_last_merge=0.9927 (last merge round=26)
[S5] round=31 local utility u=0.015431 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2410054727941366, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2718669093743187, 'psi': 0.33358943696313936}
[S6] START round=31 head_norm_before_train=1.293667 cos_to_last_merge=0.9991 (last merge round=29)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 3.7534912861705454, 'psi': 0.022186642268984445}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 3.153835836440942, 'psi': 0.021749084249084248}
[S7] START round=31 head_norm_before_train=1.799957 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.014541 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2963788594897812, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.3254609720674275, 'psi': 0.35976373724718097}
[S8] START round=31 head_norm_before_train=1.347277 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9475229425935818, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8997840037462461, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.939898 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1195528850553056, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1037290240345548, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.886839 (no previous merge yet)
[S10] round=31 local utility u=0.024920 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9214665692084845, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9713066181008125, 'psi': 0.33301496338745623}
[S11] START round=31 head_norm_before_train=1.554384 cos_to_last_merge=0.9985 (last merge round=27)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.3239393939393939, 'auprc': 0.3239393939393939, 'loss_val': 2.416735784083694, 'psi': 0.3239393939393939}-{'f1_val': 0.3187951986878402, 'auprc': 0.3187951986878402, 'loss_val': 2.338530487093845, 'psi': 0.3187951986878402}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.3239 head_norm=1.573028
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.523094e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.3250 head_norm=1.564642 delta_norm=0.252309
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] START round=31 head_norm_before_train=1.796135 cos_to_last_merge=0.9928 (last merge round=20)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8630522287762697, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.781864208527175, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.639939 cos_to_last_merge=0.9920 (last merge round=25)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 4.0842059435446165, 'psi': 0.1351317597102535}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 3.958316613168706, 'psi': 0.13592717296421}
[S15] START round=31 head_norm_before_train=1.833320 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6151585061371988, 'auprc': 0.6151585061371988, 'loss_val': 0.6632788162218521, 'psi': 0.6151585061371988}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6613452748667219, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.829271 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.16349305991490548, 'auprc': 0.16349305991490548, 'loss_val': 3.357350603556647, 'psi': 0.16349305991490548}-{'f1_val': 0.16233221476510068, 'auprc': 0.16233221476510068, 'loss_val': 3.341071688928691, 'psi': 0.16233221476510068}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.518393 cos_to_last_merge=0.9995 (last merge round=28)
[S17] round=31 local utility u=0.268112 metrics={'f1_val': 0.30436108279101676, 'auprc': 0.30436108279101676, 'loss_val': 0.888596205823371, 'psi': 0.30436108279101676}-{'f1_val': 0.24367715542429502, 'auprc': 0.24367715542429502, 'loss_val': 0.8786638807845957, 'psi': 0.24367715542429502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.3044 head_norm=1.532419
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.161896e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.3038 head_norm=1.467154 delta_norm=0.216190
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=-0.1121
[S13] DROPPED delta from S10 (cos=-0.1121 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1805) from S2
[S11] cosine check vs S2: cos=0.9856
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S5
[S8] cosine check vs S5: cos=0.9494
[S13]  timeout peer S7
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S15
[S14]  timeout peer S16
[S8]  timeout peer S17
[S2]  timeout peer S11
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S14
[S3]  timeout peer S5
[S10]  timeout peer S13
[S5]  timeout peer S8
[S5]  timeout peer S10
[S6]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.619167 cos_to_last_merge=0.9648 (last merge round=24)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.2561098767925672, 'auprc': 0.2561098767925672, 'loss_val': 2.0466211912128394, 'psi': 0.2561098767925672}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.8850816646819104, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.574895 cos_to_last_merge=0.9191 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.24348036546257637, 'auprc': 0.24348036546257637, 'loss_val': 1.8877438473935029, 'psi': 0.24348036546257637}-{'f1_val': 0.2429071592418206, 'auprc': 0.2429071592418206, 'loss_val': 1.8524332675670374, 'psi': 0.2429071592418206}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.967546 (no previous merge yet)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.07957077944252, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.0753868527960564, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.408613 cos_to_last_merge=0.9893 (last merge round=26)
[S5] round=32 local utility u=0.007250 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.226505100498083, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.2410054727941366, 'psi': 0.33358943696313936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=32 head_norm_before_train=1.343768 cos_to_last_merge=0.9941 (last merge round=29)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 4.303302219537887, 'psi': 0.02284148012791229}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 3.7534912861705454, 'psi': 0.022186642268984445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.814474 cos_to_last_merge=0.9998 (last merge round=30)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.3109125590758255, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2963788594897812, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.374622 cos_to_last_merge=0.9994 (last merge round=30)
[S8] round=32 local utility u=0.009217 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9290887638535565, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9475229425935818, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.3594 head_norm=1.405426
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.379834e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.3594 head_norm=1.386748 delta_norm=0.237983
[S8] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] START round=32 head_norm_before_train=1.946880 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1385984935195097, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1195528850553056, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.917004 (no previous merge yet)
[S10] round=32 local utility u=0.019866 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8817351143240328, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9214665692084845, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=32 head_norm_before_train=1.564642 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.023700 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.3680110987499647, 'psi': 0.3237922156595487}-{'f1_val': 0.3239393939393939, 'auprc': 0.3239393939393939, 'loss_val': 2.416735784083694, 'psi': 0.3239393939393939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.3238 head_norm=1.581407
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.425335e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.3241 head_norm=1.594039 delta_norm=0.142533
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] START round=32 head_norm_before_train=1.800211 cos_to_last_merge=0.9924 (last merge round=20)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8635398682549064, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8630522287762697, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.657071 cos_to_last_merge=0.9905 (last merge round=25)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.202160647141991, 'psi': 0.13172448466566114}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 4.0842059435446165, 'psi': 0.1351317597102535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.863229 (no previous merge yet)
[S15] round=32 local utility u=0.016717 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6404263703492797, 'psi': 0.6163342951580373}-{'f1_val': 0.6151585061371988, 'auprc': 0.6151585061371988, 'loss_val': 0.6632788162218521, 'psi': 0.6151585061371988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=32 head_norm_before_train=1.835390 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.14420289855072463, 'auprc': 0.14420289855072463, 'loss_val': 3.698640753316501, 'psi': 0.14420289855072463}-{'f1_val': 0.16349305991490548, 'auprc': 0.16349305991490548, 'loss_val': 3.357350603556647, 'psi': 0.16349305991490548}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.467154 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.2039558281958941, 'auprc': 0.2039558281958941, 'loss_val': 0.9232177307293934, 'psi': 0.2039558281958941}-{'f1_val': 0.30436108279101676, 'auprc': 0.30436108279101676, 'loss_val': 0.888596205823371, 'psi': 0.30436108279101676}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.638105 cos_to_last_merge=0.9620 (last merge round=24)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 1.9702711093530623, 'psi': 0.24538903139123003}-{'f1_val': 0.2561098767925672, 'auprc': 0.2561098767925672, 'loss_val': 2.0466211912128394, 'psi': 0.2561098767925672}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.594066 cos_to_last_merge=0.9153 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.24427851636010442, 'auprc': 0.24427851636010442, 'loss_val': 1.923389405177247, 'psi': 0.2442785163601044}-{'f1_val': 0.24348036546257637, 'auprc': 0.24348036546257637, 'loss_val': 1.8877438473935029, 'psi': 0.24348036546257637}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.978512 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.091737270677665, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.07957077944252, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.429363 cos_to_last_merge=0.9862 (last merge round=26)
[S5] round=33 local utility u=0.006033 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.214438646971173, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.226505100498083, 'psi': 0.33358943696313936}
[S5] not sending this round → trigger blocked (psi=0.334)
[S6] START round=33 head_norm_before_train=1.399231 cos_to_last_merge=0.9864 (last merge round=29)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 4.80849860536505, 'psi': 0.021967963386727688}-{'f1_val': 0.02284148012791229, 'auprc': 0.02284148012791229, 'loss_val': 4.303302219537887, 'psi': 0.02284148012791229}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.832859 cos_to_last_merge=0.9995 (last merge round=30)
[S7] round=33 local utility u=0.529144 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.333292281867507, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.3109125590758255, 'psi': 0.23968964488212474}
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] START round=33 head_norm_before_train=1.386748 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9447434133847855, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9290887638535565, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.954008 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1552842295916297, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1385984935195097, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.942980 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.979819074415697, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.8817351143240328, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.594039 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.006209 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.3555925848062356, 'psi': 0.3237922156595487}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.3680110987499647, 'psi': 0.3237922156595487}
[S11] not sending this round → trigger blocked (psi=0.324)
[S13] START round=33 head_norm_before_train=1.805689 cos_to_last_merge=0.9920 (last merge round=20)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.871946444656505, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8635398682549064, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.672198 cos_to_last_merge=0.9891 (last merge round=25)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.12847749114820436, 'auprc': 0.12847749114820436, 'loss_val': 4.2965254330526115, 'psi': 0.12847749114820436}-{'f1_val': 0.13172448466566114, 'auprc': 0.13172448466566114, 'loss_val': 4.202160647141991, 'psi': 0.13172448466566114}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.888276 (no previous merge yet)
[S15] round=33 local utility u=0.002977 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6332196122586567, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6404263703492797, 'psi': 0.6163342951580373}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=33 head_norm_before_train=1.842487 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.14111815730009478, 'auprc': 0.14111815730009478, 'loss_val': 3.762919377761888, 'psi': 0.14111815730009478}-{'f1_val': 0.14420289855072463, 'auprc': 0.14420289855072463, 'loss_val': 3.698640753316501, 'psi': 0.14420289855072463}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.483186 cos_to_last_merge=0.9999 (last merge round=31)
[S17] round=33 local utility u=0.466605 metrics={'f1_val': 0.30436108279101676, 'auprc': 0.30436108279101676, 'loss_val': 0.8936542477643744, 'psi': 0.30436108279101676}-{'f1_val': 0.2039558281958941, 'auprc': 0.2039558281958941, 'loss_val': 0.9232177307293934, 'psi': 0.2039558281958941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=34 head_norm_before_train=1.654826 cos_to_last_merge=0.9596 (last merge round=24)
[S2] round=34 local utility u=0.518247 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.032574739224436, 'psi': 0.3674775928297055}-{'f1_val': 0.24538903139123, 'auprc': 0.24538903139123, 'loss_val': 1.9702711093530623, 'psi': 0.24538903139123003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=34 head_norm_before_train=1.611618 cos_to_last_merge=0.9119 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.24343617664851783, 'auprc': 0.24343617664851783, 'loss_val': 1.9620974293067712, 'psi': 0.24343617664851783}-{'f1_val': 0.24427851636010442, 'auprc': 0.24427851636010442, 'loss_val': 1.923389405177247, 'psi': 0.2442785163601044}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.991937 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.100386271955137, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.091737270677665, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.446608 cos_to_last_merge=0.9837 (last merge round=26)
[S5] round=34 local utility u=0.012935 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.1885683889555345, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.214438646971173, 'psi': 0.33358943696313936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=34 head_norm_before_train=1.449077 cos_to_last_merge=0.9791 (last merge round=29)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.029504504504504505, 'auprc': 0.029504504504504505, 'loss_val': 4.9322156878889425, 'psi': 0.029504504504504505}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 4.80849860536505, 'psi': 0.021967963386727688}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.851584 cos_to_last_merge=0.9988 (last merge round=30)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.3415462472185418, 'psi': 0.23968964488212474}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.333292281867507, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.416285 cos_to_last_merge=0.9994 (last merge round=32)
[S8] round=34 local utility u=0.004424 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9358948072946897, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9447434133847855, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=34 head_norm_before_train=1.960750 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.170203237073683, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1552842295916297, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.967298 (no previous merge yet)
[S10] round=34 local utility u=0.061052 metrics={'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 1.8555700449268984, 'psi': 0.3327765847450887}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.979819074415697, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=34 head_norm_before_train=1.611567 cos_to_last_merge=0.9999 (last merge round=32)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.3243817326657563, 'auprc': 0.3243817326657563, 'loss_val': 2.438555640104375, 'psi': 0.3243817326657563}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.3555925848062356, 'psi': 0.3237922156595487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.813301 cos_to_last_merge=0.9915 (last merge round=20)
[S13] round=34 local utility u=0.019820 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8323065182563966, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.871946444656505, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=34 head_norm_before_train=1.685845 cos_to_last_merge=0.9879 (last merge round=25)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 4.35123262819819, 'psi': 0.13232893910860014}-{'f1_val': 0.12847749114820436, 'auprc': 0.12847749114820436, 'loss_val': 4.2965254330526115, 'psi': 0.12847749114820436}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.911377 (no previous merge yet)
[S15] round=34 local utility u=0.003986 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.626501739005524, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6332196122586567, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=34 head_norm_before_train=1.850333 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 5.023769925444362, 'psi': 0.08953068592057761}-{'f1_val': 0.14111815730009478, 'auprc': 0.14111815730009478, 'loss_val': 3.762919377761888, 'psi': 0.14111815730009478}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.500741 cos_to_last_merge=0.9993 (last merge round=31)
[S17] round=34 local utility u=0.039388 metrics={'f1_val': 0.30984952120383036, 'auprc': 0.30984952120383036, 'loss_val': 0.8642743525731709, 'psi': 0.30984952120383036}-{'f1_val': 0.30436108279101676, 'auprc': 0.30436108279101676, 'loss_val': 0.8936542477643744, 'psi': 0.30436108279101676}
[S17] not sending this round → trigger blocked (psi=0.310)
[S2] START round=35 head_norm_before_train=1.670024 cos_to_last_merge=0.9573 (last merge round=24)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0804069812342965, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.032574739224436, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.627784 cos_to_last_merge=0.9087 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.24286317822439496, 'auprc': 0.24286317822439496, 'loss_val': 2.0034122082439167, 'psi': 0.24286317822439496}-{'f1_val': 0.24343617664851783, 'auprc': 0.24343617664851783, 'loss_val': 1.9620974293067712, 'psi': 0.24343617664851783}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=2.002906 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1148473065935005, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.100386271955137, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.465836 cos_to_last_merge=0.9807 (last merge round=26)
[S5] round=35 local utility u=0.011656 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1607284116764913, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.1885683889555345, 'psi': 0.33358943696313936}
[S5] not sending this round → trigger blocked (psi=0.333)
[S6] START round=35 head_norm_before_train=1.492309 cos_to_last_merge=0.9729 (last merge round=29)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.3873399719596, 'psi': 0.021310724106324473}-{'f1_val': 0.029504504504504505, 'auprc': 0.029504504504504505, 'loss_val': 4.9322156878889425, 'psi': 0.029504504504504505}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.866147 cos_to_last_merge=0.9981 (last merge round=30)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.3474070435285215, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.3415462472185418, 'psi': 0.23968964488212474}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.448742 cos_to_last_merge=0.9976 (last merge round=32)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9514835591851383, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9358948072946897, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.967217 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1857621697908938, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.170203237073683, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.987997 (no previous merge yet)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.004501658941771, 'psi': 0.33301496338745623}-{'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 1.8555700449268984, 'psi': 0.3327765847450887}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.628970 cos_to_last_merge=0.9996 (last merge round=32)
[S11] round=35 local utility u=0.000699 metrics={'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 2.4325140243966477, 'psi': 0.323865788078467}-{'f1_val': 0.3243817326657563, 'auprc': 0.3243817326657563, 'loss_val': 2.438555640104375, 'psi': 0.3243817326657563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=35 head_norm_before_train=1.819931 cos_to_last_merge=0.9909 (last merge round=20)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8397010365153971, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8323065182563966, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.698272 cos_to_last_merge=0.9867 (last merge round=25)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.409430145642665, 'psi': 0.13413413413413414}-{'f1_val': 0.13232893910860014, 'auprc': 0.13232893910860014, 'loss_val': 4.35123262819819, 'psi': 0.13232893910860014}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.936202 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6157765077628609, 'auprc': 0.6157765077628609, 'loss_val': 0.627210623565283, 'psi': 0.6157765077628609}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.626501739005524, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.857758 (no previous merge yet)
[S16] round=35 local utility u=0.750372 metrics={'f1_val': 0.13624659751342602, 'auprc': 0.13624659751342602, 'loss_val': 3.943468724860205, 'psi': 0.13624659751342602}-{'f1_val': 0.08953068592057761, 'auprc': 0.08953068592057761, 'loss_val': 5.023769925444362, 'psi': 0.08953068592057761}
[S16] not sending this round → trigger blocked (psi=0.136)
[S17] START round=35 head_norm_before_train=1.519046 cos_to_last_merge=0.9986 (last merge round=31)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.2385660445749476, 'auprc': 0.2385660445749476, 'loss_val': 0.8498940356321372, 'psi': 0.2385660445749476}-{'f1_val': 0.30984952120383036, 'auprc': 0.30984952120383036, 'loss_val': 0.8642743525731709, 'psi': 0.30984952120383036}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.684090 cos_to_last_merge=0.9553 (last merge round=24)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.250160194796873, 'auprc': 0.250160194796873, 'loss_val': 2.134244902178015, 'psi': 0.250160194796873}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.0804069812342965, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.642824 cos_to_last_merge=0.9059 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.906
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.037825736731664, 'psi': 0.24281921313058172}-{'f1_val': 0.24286317822439496, 'auprc': 0.24286317822439496, 'loss_val': 2.0034122082439167, 'psi': 0.24286317822439496}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=2.012833 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1193645109297183, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1148473065935005, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.484158 cos_to_last_merge=0.9781 (last merge round=26)
[S5] round=36 local utility u=0.023992 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1127451833331015, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1607284116764913, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=36 head_norm_before_train=1.528562 cos_to_last_merge=0.9681 (last merge round=29)
[S6] round=36 local utility u=0.041132 metrics={'f1_val': 0.02501136880400182, 'auprc': 0.02501136880400182, 'loss_val': 5.33838228916026, 'psi': 0.02501136880400182}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 5.3873399719596, 'psi': 0.021310724106324473}
[S6] not sending this round → trigger blocked (psi=0.025)
[S7] START round=36 head_norm_before_train=1.876551 cos_to_last_merge=0.9975 (last merge round=30)
[S7] round=36 local utility u=0.531027 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.366019430458445, 'psi': 0.35976373724718097}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 1.3474070435285215, 'psi': 0.23968964488212474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=36 head_norm_before_train=1.478835 cos_to_last_merge=0.9950 (last merge round=32)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9811723915614329, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9514835591851383, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.973615 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2009278094720006, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1857621697908938, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=2.008017 (no previous merge yet)
[S10] round=36 local utility u=0.077779 metrics={'f1_val': 0.32187091314716515, 'auprc': 0.32187091314716515, 'loss_val': 1.74864637614109, 'psi': 0.32187091314716515}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.004501658941771, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=36 head_norm_before_train=1.645930 cos_to_last_merge=0.9991 (last merge round=32)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.4568205964107985, 'psi': 0.3237922156595487}-{'f1_val': 0.323865788078467, 'auprc': 0.323865788078467, 'loss_val': 2.4325140243966477, 'psi': 0.323865788078467}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.827196 cos_to_last_merge=0.9903 (last merge round=20)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8545929087633874, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8397010365153971, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.709628 cos_to_last_merge=0.9856 (last merge round=25)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 4.469969647371047, 'psi': 0.1347331583552056}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.409430145642665, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.958644 (no previous merge yet)
[S15] round=36 local utility u=0.006031 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6189142375637628, 'psi': 0.6161950003225232}-{'f1_val': 0.6157765077628609, 'auprc': 0.6157765077628609, 'loss_val': 0.627210623565283, 'psi': 0.6157765077628609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] sending update (kind=head size=1808 to 1 peers)
[S16] START round=36 head_norm_before_train=1.863891 (no previous merge yet)
[S16] round=36 local utility u=0.181989 metrics={'f1_val': 0.14572501444251876, 'auprc': 0.14572501444251876, 'loss_val': 3.6647959572845665, 'psi': 0.14572501444251876}-{'f1_val': 0.13624659751342602, 'auprc': 0.13624659751342602, 'loss_val': 3.943468724860205, 'psi': 0.13624659751342602}
[S16] not sending this round → trigger blocked (psi=0.146)
[S17] START round=36 head_norm_before_train=1.540326 cos_to_last_merge=0.9977 (last merge round=31)
[S17] round=36 local utility u=0.352501 metrics={'f1_val': 0.3174570316949552, 'auprc': 0.3174570316949552, 'loss_val': 0.8549116622752516, 'psi': 0.3174570316949552}-{'f1_val': 0.2385660445749476, 'auprc': 0.2385660445749476, 'loss_val': 0.8498940356321372, 'psi': 0.2385660445749476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=37 head_norm_before_train=1.696539 cos_to_last_merge=0.9535 (last merge round=24)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.22183150183150183, 'auprc': 0.22183150183150183, 'loss_val': 2.5677949491758283, 'psi': 0.22183150183150185}-{'f1_val': 0.250160194796873, 'auprc': 0.250160194796873, 'loss_val': 2.134244902178015, 'psi': 0.250160194796873}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.656589 cos_to_last_merge=0.9033 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.064167512483284, 'psi': 0.24281921313058172}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.037825736731664, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=2.019818 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1236205887625095, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1193645109297183, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.508782 cos_to_last_merge=0.9748 (last merge round=26)
[S5] round=37 local utility u=0.009951 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.092842888523134, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.1127451833331015, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S6] START round=37 head_norm_before_train=1.556470 cos_to_last_merge=0.9644 (last merge round=29)
[S6] round=37 local utility u=0.324977 metrics={'f1_val': 0.07815024232633279, 'auprc': 0.07815024232633279, 'loss_val': 5.166677152910665, 'psi': 0.07815024232633279}-{'f1_val': 0.02501136880400182, 'auprc': 0.02501136880400182, 'loss_val': 5.33838228916026, 'psi': 0.02501136880400182}
[S6] not sending this round → trigger blocked (psi=0.078)
[S7] START round=37 head_norm_before_train=1.888353 cos_to_last_merge=0.9970 (last merge round=30)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.3472270966030533, 'psi': 0.2396131805157593}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.366019430458445, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.506369 cos_to_last_merge=0.9921 (last merge round=32)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.007814587620352, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9811723915614329, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.979825 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.214067732392594, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2009278094720006, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.027338 (no previous merge yet)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 1.9308370106762585, 'psi': 0.3327765847450887}-{'f1_val': 0.32187091314716515, 'auprc': 0.32187091314716515, 'loss_val': 1.74864637614109, 'psi': 0.32187091314716515}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.661632 cos_to_last_merge=0.9985 (last merge round=32)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.503316837124854, 'psi': 0.3240867060785205}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.4568205964107985, 'psi': 0.3237922156595487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.837248 cos_to_last_merge=0.9892 (last merge round=20)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8814095803922191, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8545929087633874, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.720152 cos_to_last_merge=0.9846 (last merge round=25)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.529730481676661, 'psi': 0.13413413413413414}-{'f1_val': 0.1347331583552056, 'auprc': 0.1347331583552056, 'loss_val': 4.469969647371047, 'psi': 0.1347331583552056}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.981394 (no previous merge yet)
[S15] round=37 local utility u=0.002056 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6160561476923417, 'psi': 0.6163342951580373}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6189142375637628, 'psi': 0.6161950003225232}
[S15] not sending this round → trigger blocked (psi=0.616)
[S16] START round=37 head_norm_before_train=1.870564 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.09034118212397886, 'auprc': 0.09034118212397886, 'loss_val': 4.832718668915277, 'psi': 0.09034118212397886}-{'f1_val': 0.14572501444251876, 'auprc': 0.14572501444251876, 'loss_val': 3.6647959572845665, 'psi': 0.14572501444251876}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.561489 cos_to_last_merge=0.9967 (last merge round=31)
[S17] round=37 local utility u=0.295983 metrics={'f1_val': 0.38074476151092207, 'auprc': 0.38074476151092207, 'loss_val': 0.8325354070775001, 'psi': 0.38074476151092207}-{'f1_val': 0.3174570316949552, 'auprc': 0.3174570316949552, 'loss_val': 0.8549116622752516, 'psi': 0.3174570316949552}
[S17] not sending this round → trigger blocked (psi=0.381)
[S2] START round=38 head_norm_before_train=1.707923 cos_to_last_merge=0.9518 (last merge round=24)
[S2] round=38 local utility u=0.849343 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.17992426747951, 'psi': 0.3674775928297055}-{'f1_val': 0.22183150183150183, 'auprc': 0.22183150183150183, 'loss_val': 2.5677949491758283, 'psi': 0.22183150183150185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=38 head_norm_before_train=1.669489 cos_to_last_merge=0.9009 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.0834495009517915, 'psi': 0.24281921313058172}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.064167512483284, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=2.026098 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1251916173507344, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1236205887625095, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.540811 cos_to_last_merge=0.9702 (last merge round=26)
[S5] round=38 local utility u=0.014961 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.062921860501589, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.092842888523134, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=38 head_norm_before_train=1.579773 cos_to_last_merge=0.9613 (last merge round=29)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.03946208112874779, 'auprc': 0.03946208112874779, 'loss_val': 5.4389852365663485, 'psi': 0.03946208112874779}-{'f1_val': 0.07815024232633279, 'auprc': 0.07815024232633279, 'loss_val': 5.166677152910665, 'psi': 0.07815024232633279}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.896622 cos_to_last_merge=0.9965 (last merge round=30)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.348365221156434, 'psi': 0.2396131805157593}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.3472270966030533, 'psi': 0.2396131805157593}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.532268 cos_to_last_merge=0.9894 (last merge round=32)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0352988756582164, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.007814587620352, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.985742 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.227472330634827, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.214067732392594, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=2.044991 (no previous merge yet)
[S10] round=38 local utility u=0.018945 metrics={'f1_val': 0.32090811474152475, 'auprc': 0.32090811474152475, 'loss_val': 1.7861304340608932, 'psi': 0.32090811474152475}-{'f1_val': 0.3327765847450887, 'auprc': 0.3327765847450887, 'loss_val': 1.9308370106762585, 'psi': 0.3327765847450887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=38 head_norm_before_train=1.676368 cos_to_last_merge=0.9979 (last merge round=32)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.5100905317929816, 'psi': 0.3237922156595487}-{'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.503316837124854, 'psi': 0.3240867060785205}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.847400 cos_to_last_merge=0.9882 (last merge round=20)
[S13] round=38 local utility u=0.039005 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8033995465693677, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8814095803922191, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=38 head_norm_before_train=1.730010 cos_to_last_merge=0.9837 (last merge round=25)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.5873713448424756, 'psi': 0.13333333333333333}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 4.529730481676661, 'psi': 0.13413413413413414}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=2.003103 (no previous merge yet)
[S15] round=38 local utility u=0.003152 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6097518628240621, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6160561476923417, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S15] sending update (kind=head size=1810 to 1 peers)
[S16] START round=38 head_norm_before_train=1.877341 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.08883534136546184, 'auprc': 0.08883534136546184, 'loss_val': 5.199728223326049, 'psi': 0.08883534136546184}-{'f1_val': 0.09034118212397886, 'auprc': 0.09034118212397886, 'loss_val': 4.832718668915277, 'psi': 0.09034118212397886}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.579675 cos_to_last_merge=0.9950 (last merge round=31)
[S17] round=38 local utility u=0.077084 metrics={'f1_val': 0.396555733332463, 'auprc': 0.396555733332463, 'loss_val': 0.820665946393638, 'psi': 0.396555733332463}-{'f1_val': 0.38074476151092207, 'auprc': 0.38074476151092207, 'loss_val': 0.8325354070775001, 'psi': 0.38074476151092207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=39 head_norm_before_train=1.718496 cos_to_last_merge=0.9503 (last merge round=24)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2012256386191096, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.17992426747951, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.367 u=0.0000 p_local=0.2055 f1=0.367 auprc=0.367 bytes=21605
[S3] START round=39 head_norm_before_train=1.681570 cos_to_last_merge=0.8987 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.899
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.24286317822439496, 'auprc': 0.24286317822439496, 'loss_val': 2.1042146829282493, 'psi': 0.24286317822439496}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.0834495009517915, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.243 u=0.0000 p_local=0.0086 f1=0.243 auprc=0.243 bytes=10807
[S4] START round=39 head_norm_before_train=2.034556 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1263507851105596, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1251916173507344, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0112 f1=0.357 auprc=0.357 bytes=27024
[S5] START round=39 head_norm_before_train=1.576210 cos_to_last_merge=0.9651 (last merge round=26)
[S5] round=39 local utility u=0.023972 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.0149778166043637, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.062921860501589, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S5] r=40 psi=0.333 u=0.0240 p_local=0.0191 f1=0.333 auprc=0.333 bytes=30600
[S6] START round=39 head_norm_before_train=1.600365 cos_to_last_merge=0.9587 (last merge round=29)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 5.883185855861634, 'psi': 0.020871559633027524}-{'f1_val': 0.03946208112874779, 'auprc': 0.03946208112874779, 'loss_val': 5.4389852365663485, 'psi': 0.03946208112874779}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.021 u=0.0000 p_local=0.0907 f1=0.021 auprc=0.021 bytes=0
[S7] START round=39 head_norm_before_train=1.903313 cos_to_last_merge=0.9961 (last merge round=30)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.3825710505623245, 'psi': 0.2396131805157593}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.348365221156434, 'psi': 0.2396131805157593}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.240 u=0.0000 p_local=0.0837 f1=0.240 auprc=0.240 bytes=21601
[S8] START round=39 head_norm_before_train=1.553662 cos_to_last_merge=0.9871 (last merge round=32)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 1.0813120968953427, 'psi': 0.23913947821952816}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0352988756582164, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.239 u=0.0000 p_local=0.0436 f1=0.239 auprc=0.239 bytes=32416
[S9] START round=39 head_norm_before_train=1.991602 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.239583779873388, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.227472330634827, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0004 f1=0.369 auprc=0.369 bytes=3604
[S10] START round=39 head_norm_before_train=2.060952 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.3126354330120302, 'auprc': 0.3126354330120302, 'loss_val': 1.7459650832140996, 'psi': 0.3126354330120302}-{'f1_val': 0.32090811474152475, 'auprc': 0.32090811474152475, 'loss_val': 1.7861304340608932, 'psi': 0.32090811474152475}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.313 u=0.0000 p_local=0.0269 f1=0.313 auprc=0.313 bytes=35996
[S11] START round=39 head_norm_before_train=1.690353 cos_to_last_merge=0.9973 (last merge round=32)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.526915888720763, 'psi': 0.3237922156595487}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.5100905317929816, 'psi': 0.3237922156595487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.324 u=0.0000 p_local=0.0060 f1=0.324 auprc=0.324 bytes=12585
[S13] START round=39 head_norm_before_train=1.854251 cos_to_last_merge=0.9874 (last merge round=20)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8772399017417414, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8033995465693677, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0111 f1=0.360 auprc=0.360 bytes=28842
[S14] START round=39 head_norm_before_train=1.739320 cos_to_last_merge=0.9828 (last merge round=25)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 4.643480986962663, 'psi': 0.13253012048192772}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.5873713448424756, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.133 u=0.0000 p_local=0.0112 f1=0.133 auprc=0.133 bytes=0
[S15] START round=39 head_norm_before_train=2.023949 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6151249791758984, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6097518628240621, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0092 f1=0.616 auprc=0.616 bytes=32474
[S16] START round=39 head_norm_before_train=1.884200 (no previous merge yet)
[S16] round=39 local utility u=1.000000 metrics={'f1_val': 0.1713697219361483, 'auprc': 0.1713697219361483, 'loss_val': 3.3151076129147885, 'psi': 0.1713697219361483}-{'f1_val': 0.08883534136546184, 'auprc': 0.08883534136546184, 'loss_val': 5.199728223326049, 'psi': 0.08883534136546184}
[S16] not sending this round → trigger blocked (psi=0.171)
[S16] r=40 psi=0.171 u=1.0000 p_local=0.3286 f1=0.171 auprc=0.171 bytes=0
[S17] START round=39 head_norm_before_train=1.599414 cos_to_last_merge=0.9936 (last merge round=31)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.3608284792706886, 'auprc': 0.3608284792706886, 'loss_val': 0.8406539686225705, 'psi': 0.3608284792706886}-{'f1_val': 0.396555733332463, 'auprc': 0.396555733332463, 'loss_val': 0.820665946393638, 'psi': 0.396555733332463}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.361 u=0.0000 p_local=0.1318 f1=0.361 auprc=0.361 bytes=36057
[S2] START round=40 head_norm_before_train=1.728641 cos_to_last_merge=0.9488 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2271273748691014, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2012256386191096, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.693056 cos_to_last_merge=0.8966 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.897
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.1282979315339805, 'psi': 0.24281921313058172}-{'f1_val': 0.24286317822439496, 'auprc': 0.24286317822439496, 'loss_val': 2.1042146829282493, 'psi': 0.24286317822439496}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.045890 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1471696636442217, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1263507851105596, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.610117 cos_to_last_merge=0.9603 (last merge round=26)
[S5] round=40 local utility u=0.015240 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9844985132287543, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.0149778166043637, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=40 head_norm_before_train=1.618116 cos_to_last_merge=0.9565 (last merge round=29)
[S6] round=40 local utility u=0.025794 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 5.845399931650951, 'psi': 0.02240512117055327}-{'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 5.883185855861634, 'psi': 0.020871559633027524}
[S6] not sending this round → trigger blocked (psi=0.022)
[S7] START round=40 head_norm_before_train=1.915466 cos_to_last_merge=0.9951 (last merge round=30)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.23861664572488483, 'auprc': 0.23861664572488483, 'loss_val': 1.389122551894506, 'psi': 0.23861664572488483}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.3825710505623245, 'psi': 0.2396131805157593}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.572149 cos_to_last_merge=0.9849 (last merge round=32)
[S8] round=40 local utility u=0.508801 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.146004138054302, 'psi': 0.35939447907390915}-{'f1_val': 0.23913947821952816, 'auprc': 0.23913947821952816, 'loss_val': 1.0813120968953427, 'psi': 0.23913947821952816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=40 head_norm_before_train=1.997183 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.253669365455008, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.239583779873388, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.075678 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.31567828580051305, 'auprc': 0.31567828580051305, 'loss_val': 1.7981607080586446, 'psi': 0.31567828580051305}-{'f1_val': 0.3126354330120302, 'auprc': 0.3126354330120302, 'loss_val': 1.7459650832140996, 'psi': 0.3126354330120302}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.702667 cos_to_last_merge=0.9967 (last merge round=32)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.5857711345229144, 'psi': 0.3240867060785205}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.526915888720763, 'psi': 0.3237922156595487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.858971 cos_to_last_merge=0.9870 (last merge round=20)
[S13] round=40 local utility u=0.008925 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8593897014611394, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8772399017417414, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=40 head_norm_before_train=1.748285 cos_to_last_merge=0.9819 (last merge round=25)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.6923186475762275, 'psi': 0.1331327566754419}-{'f1_val': 0.13253012048192772, 'auprc': 0.13253012048192772, 'loss_val': 4.643480986962663, 'psi': 0.13253012048192772}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.043321 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6256678224813255, 'psi': 0.6152170947577895}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6151249791758984, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.890497 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.13612950699043413, 'auprc': 0.13612950699043413, 'loss_val': 3.933708554115502, 'psi': 0.13612950699043413}-{'f1_val': 0.1713697219361483, 'auprc': 0.1713697219361483, 'loss_val': 3.3151076129147885, 'psi': 0.1713697219361483}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.618046 cos_to_last_merge=0.9920 (last merge round=31)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.3082078012321158, 'auprc': 0.3082078012321158, 'loss_val': 0.8961013029098603, 'psi': 0.3082078012321158}-{'f1_val': 0.3608284792706886, 'auprc': 0.3608284792706886, 'loss_val': 0.8406539686225705, 'psi': 0.3608284792706886}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.738329 cos_to_last_merge=0.9474 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.259660476406236, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.2271273748691014, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.703994 cos_to_last_merge=0.8947 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.895
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.1519214411985383, 'psi': 0.24281921313058172}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.1282979315339805, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=2.052356 (no previous merge yet)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1524547950090722, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1471696636442217, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.643497 cos_to_last_merge=0.9559 (last merge round=26)
[S5] round=41 local utility u=0.012589 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9593214407013972, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9844985132287543, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S6] START round=41 head_norm_before_train=1.633491 cos_to_last_merge=0.9547 (last merge round=29)
[S6] round=41 local utility u=0.284066 metrics={'f1_val': 0.05572096980008507, 'auprc': 0.05572096980008507, 'loss_val': 5.577111425193935, 'psi': 0.05572096980008507}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 5.845399931650951, 'psi': 0.02240512117055327}
[S6] not sending this round → trigger blocked (psi=0.056)
[S7] START round=41 head_norm_before_train=1.934099 cos_to_last_merge=0.9938 (last merge round=30)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.4008170173605237, 'psi': 0.23976608187134504}-{'f1_val': 0.23861664572488483, 'auprc': 0.23861664572488483, 'loss_val': 1.389122551894506, 'psi': 0.23861664572488483}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.590837 cos_to_last_merge=0.9829 (last merge round=32)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2135843967672206, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.146004138054302, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.002853 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.266270427350818, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.253669365455008, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=2.089291 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.3181991025933531, 'auprc': 0.3181991025933531, 'loss_val': 1.8401519916539923, 'psi': 0.3181991025933531}-{'f1_val': 0.31567828580051305, 'auprc': 0.31567828580051305, 'loss_val': 1.7981607080586446, 'psi': 0.31567828580051305}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.714455 cos_to_last_merge=0.9961 (last merge round=32)
[S11] round=41 local utility u=0.012383 metrics={'f1_val': 0.32181831865733423, 'auprc': 0.32181831865733423, 'loss_val': 2.540589030751876, 'psi': 0.32181831865733423}-{'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.5857711345229144, 'psi': 0.3240867060785205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=41 head_norm_before_train=1.862159 cos_to_last_merge=0.9867 (last merge round=20)
[S13] round=41 local utility u=0.005005 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8493797417776358, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8593897014611394, 'psi': 0.3599362944611573}
[S13] not sending this round → trigger blocked (psi=0.360)
[S14] START round=41 head_norm_before_train=1.756798 cos_to_last_merge=0.9811 (last merge round=25)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.736439490133039, 'psi': 0.1331327566754419}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.6923186475762275, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.061653 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6268476738789759, 'psi': 0.6150769866718802}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.6256678224813255, 'psi': 0.6152170947577895}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.896292 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.04172099087353325, 'auprc': 0.04172099087353325, 'loss_val': 5.291548899434875, 'psi': 0.04172099087353325}-{'f1_val': 0.13612950699043413, 'auprc': 0.13612950699043413, 'loss_val': 3.933708554115502, 'psi': 0.13612950699043413}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.635049 cos_to_last_merge=0.9913 (last merge round=31)
[S17] round=41 local utility u=0.388667 metrics={'f1_val': 0.3946395819575589, 'auprc': 0.3946395819575589, 'loss_val': 0.8966537718127295, 'psi': 0.3946395819575589}-{'f1_val': 0.3082078012321158, 'auprc': 0.3082078012321158, 'loss_val': 0.8961013029098603, 'psi': 0.3082078012321158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=42 head_norm_before_train=1.747530 cos_to_last_merge=0.9460 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.946
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.292882596029976, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.259660476406236, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.714609 cos_to_last_merge=0.8928 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.893
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.1740956479738913, 'psi': 0.24281921313058172}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.1519214411985383, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.056897 (no previous merge yet)
[S4] round=42 local utility u=0.001624 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1492061225420978, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1524547950090722, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=42 head_norm_before_train=1.674177 cos_to_last_merge=0.9518 (last merge round=26)
[S5] round=42 local utility u=0.015916 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9274888851313734, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9593214407013972, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=42 head_norm_before_train=1.648309 cos_to_last_merge=0.9528 (last merge round=29)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.036395916555703504, 'auprc': 0.036395916555703504, 'loss_val': 5.755637820927317, 'psi': 0.036395916555703504}-{'f1_val': 0.05572096980008507, 'auprc': 0.05572096980008507, 'loss_val': 5.577111425193935, 'psi': 0.05572096980008507}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.946716 cos_to_last_merge=0.9929 (last merge round=30)
[S7] round=42 local utility u=0.533726 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.4133444377394262, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.4008170173605237, 'psi': 0.23976608187134504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=42 head_norm_before_train=1.606089 cos_to_last_merge=0.9807 (last merge round=32)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.266525070929626, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2135843967672206, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=2.008320 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.279227877646453, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.266270427350818, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=2.102391 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.31137902805685796, 'auprc': 0.31137902805685796, 'loss_val': 1.8086171322567928, 'psi': 0.31137902805685796}-{'f1_val': 0.3181991025933531, 'auprc': 0.3181991025933531, 'loss_val': 1.8401519916539923, 'psi': 0.3181991025933531}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.725826 cos_to_last_merge=0.9954 (last merge round=32)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.3199401421623644, 'auprc': 0.3199401421623644, 'loss_val': 2.554723807013294, 'psi': 0.3199401421623644}-{'f1_val': 0.32181831865733423, 'auprc': 0.32181831865733423, 'loss_val': 2.540589030751876, 'psi': 0.32181831865733423}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.866121 cos_to_last_merge=0.9863 (last merge round=20)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8730367405996775, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8493797417776358, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.764987 cos_to_last_merge=0.9804 (last merge round=25)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.780292987352496, 'psi': 0.1331327566754419}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.736439490133039, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.078374 (no previous merge yet)
[S15] round=42 local utility u=0.010972 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.616218521313971, 'psi': 0.6163342951580373}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6268476738789759, 'psi': 0.6150769866718802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=42 head_norm_before_train=1.902166 (no previous merge yet)
[S16] round=42 local utility u=0.333071 metrics={'f1_val': 0.08107448107448108, 'auprc': 0.08107448107448108, 'loss_val': 4.979587895396114, 'psi': 0.08107448107448108}-{'f1_val': 0.04172099087353325, 'auprc': 0.04172099087353325, 'loss_val': 5.291548899434875, 'psi': 0.04172099087353325}
[S16] not sending this round → trigger blocked (psi=0.081)
[S17] START round=42 head_norm_before_train=1.650635 cos_to_last_merge=0.9904 (last merge round=31)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.36284768272451395, 'auprc': 0.36284768272451395, 'loss_val': 0.9308701830982146, 'psi': 0.36284768272451395}-{'f1_val': 0.3946395819575589, 'auprc': 0.3946395819575589, 'loss_val': 0.8966537718127295, 'psi': 0.3946395819575589}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.756373 cos_to_last_merge=0.9447 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.945
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.322172326161538, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.292882596029976, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.724467 cos_to_last_merge=0.8910 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.891
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.191182832693603, 'psi': 0.24281921313058172}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.1740956479738913, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.063516 (no previous merge yet)
[S4] round=43 local utility u=0.003228 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1427501715796224, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1492061225420978, 'psi': 0.3567939207526687}
[S4] not sending this round → trigger blocked (psi=0.357)
[S5] START round=43 head_norm_before_train=1.701527 cos_to_last_merge=0.9481 (last merge round=26)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=43 local utility u=0.012827 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9018345253283346, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9274888851313734, 'psi': 0.33308623671855697}
[S5] not sending this round → trigger blocked (psi=0.333)
[S6] START round=43 head_norm_before_train=1.662083 cos_to_last_merge=0.9511 (last merge round=29)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 6.0779997507916566, 'psi': 0.02240512117055327}-{'f1_val': 0.036395916555703504, 'auprc': 0.036395916555703504, 'loss_val': 5.755637820927317, 'psi': 0.036395916555703504}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.953663 cos_to_last_merge=0.9923 (last merge round=30)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 1.4007623557662252, 'psi': 0.23930704898446833}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.4133444377394262, 'psi': 0.35976373724718097}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.618890 cos_to_last_merge=0.9790 (last merge round=32)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3072942924090891, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.266525070929626, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.013774 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.292132832846609, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.279227877646453, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.114508 (no previous merge yet)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.3119361813166331, 'auprc': 0.3119361813166331, 'loss_val': 1.84097990930848, 'psi': 0.3119361813166331}-{'f1_val': 0.31137902805685796, 'auprc': 0.31137902805685796, 'loss_val': 1.8086171322567928, 'psi': 0.31137902805685796}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.736046 cos_to_last_merge=0.9948 (last merge round=32)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.3239393939393939, 'auprc': 0.3239393939393939, 'loss_val': 2.6315625407200693, 'psi': 0.3239393939393939}-{'f1_val': 0.3199401421623644, 'auprc': 0.3199401421623644, 'loss_val': 2.554723807013294, 'psi': 0.3199401421623644}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.869623 cos_to_last_merge=0.9859 (last merge round=20)
[S13] round=43 local utility u=0.011008 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8510217012476959, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8730367405996775, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=43 head_norm_before_train=1.772887 cos_to_last_merge=0.9796 (last merge round=25)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.82302970003891, 'psi': 0.1331327566754419}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.780292987352496, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.093824 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6152422836728958, 'psi': 0.615636807189815}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.616218521313971, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.908088 (no previous merge yet)
[S16] round=43 local utility u=0.098478 metrics={'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 4.862484741933906, 'psi': 0.08994708994708994}-{'f1_val': 0.08107448107448108, 'auprc': 0.08107448107448108, 'loss_val': 4.979587895396114, 'psi': 0.08107448107448108}
[S16] not sending this round → trigger blocked (psi=0.090)
[S17] START round=43 head_norm_before_train=1.666152 cos_to_last_merge=0.9892 (last merge round=31)
[S17] round=43 local utility u=0.165840 metrics={'f1_val': 0.3989430437327245, 'auprc': 0.3989430437327245, 'loss_val': 0.9240490642713091, 'psi': 0.3989430437327245}-{'f1_val': 0.36284768272451395, 'auprc': 0.36284768272451395, 'loss_val': 0.9308701830982146, 'psi': 0.36284768272451395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=44 head_norm_before_train=1.764876 cos_to_last_merge=0.9435 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.23792510255392352, 'auprc': 0.23792510255392352, 'loss_val': 2.4121060905593708, 'psi': 0.23792510255392352}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.322172326161538, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.734051 cos_to_last_merge=0.8894 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.889
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.209463920196265, 'psi': 0.24281921313058172}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.191182832693603, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=2.067549 (no previous merge yet)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.14915231436556, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1427501715796224, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.727756 cos_to_last_merge=0.9444 (last merge round=26)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9042451366066153, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9018345253283346, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.674465 cos_to_last_merge=0.9496 (last merge round=29)
[S6] ⚠️ Model drifted since last merge! cos=0.950
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.258695510593759, 'psi': 0.02109124254928932}-{'f1_val': 0.02240512117055327, 'auprc': 0.02240512117055327, 'loss_val': 6.0779997507916566, 'psi': 0.02240512117055327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.962714 cos_to_last_merge=0.9915 (last merge round=30)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.23877026137926907, 'auprc': 0.23877026137926907, 'loss_val': 1.407313048435585, 'psi': 0.23877026137926907}-{'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 1.4007623557662252, 'psi': 0.23930704898446833}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.632640 cos_to_last_merge=0.9777 (last merge round=32)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.343387312720153, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3072942924090891, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.019115 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.304987789007073, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.292132832846609, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.126060 (no previous merge yet)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.3107546048722519, 'auprc': 0.3107546048722519, 'loss_val': 1.8537055911955915, 'psi': 0.3107546048722519}-{'f1_val': 0.3119361813166331, 'auprc': 0.3119361813166331, 'loss_val': 1.84097990930848, 'psi': 0.3119361813166331}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.745587 cos_to_last_merge=0.9943 (last merge round=32)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.6613364592984072, 'psi': 0.3240867060785205}-{'f1_val': 0.3239393939393939, 'auprc': 0.3239393939393939, 'loss_val': 2.6315625407200693, 'psi': 0.3239393939393939}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.872504 cos_to_last_merge=0.9856 (last merge round=20)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8620751616349643, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8510217012476959, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.780375 cos_to_last_merge=0.9789 (last merge round=25)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.863524728582726, 'psi': 0.13333333333333333}-{'f1_val': 0.1331327566754419, 'auprc': 0.1331327566754419, 'loss_val': 4.82302970003891, 'psi': 0.1331327566754419}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.108424 (no previous merge yet)
[S15] round=44 local utility u=0.003515 metrics={'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.604435403632075, 'psi': 0.6152170947577895}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6152422836728958, 'psi': 0.615636807189815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S16] START round=44 head_norm_before_train=1.912575 (no previous merge yet)
[S16] round=44 local utility u=0.252485 metrics={'f1_val': 0.0926191614857325, 'auprc': 0.0926191614857325, 'loss_val': 4.381563431853285, 'psi': 0.0926191614857325}-{'f1_val': 0.08994708994708994, 'auprc': 0.08994708994708994, 'loss_val': 4.862484741933906, 'psi': 0.08994708994708994}
[S16] not sending this round → trigger blocked (psi=0.093)
[S17] START round=44 head_norm_before_train=1.681213 cos_to_last_merge=0.9882 (last merge round=31)
[S17] round=44 local utility u=0.059538 metrics={'f1_val': 0.4124395012925684, 'auprc': 0.4124395012925684, 'loss_val': 0.9264409784245395, 'psi': 0.4124395012925684}-{'f1_val': 0.3989430437327245, 'auprc': 0.3989430437327245, 'loss_val': 0.9240490642713091, 'psi': 0.3989430437327245}
[S17] not sending this round → trigger blocked (psi=0.412)
[S2] START round=45 head_norm_before_train=1.772489 cos_to_last_merge=0.9424 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.942
[S2] round=45 local utility u=0.607706 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3626664475494876, 'psi': 0.3674775928297055}-{'f1_val': 0.23792510255392352, 'auprc': 0.23792510255392352, 'loss_val': 2.4121060905593708, 'psi': 0.23792510255392352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=45 head_norm_before_train=1.743488 cos_to_last_merge=0.8877 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.888
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.2273631316909004, 'psi': 0.24281921313058172}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.209463920196265, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.068153 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1584923947738948, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.14915231436556, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.746878 cos_to_last_merge=0.9418 (last merge round=26)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=45 local utility u=0.013960 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8763252879362438, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9042451366066153, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=45 head_norm_before_train=1.685834 cos_to_last_merge=0.9483 (last merge round=29)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=45 local utility u=0.175411 metrics={'f1_val': 0.029716343989194056, 'auprc': 0.029716343989194056, 'loss_val': 5.985499308388372, 'psi': 0.029716343989194052}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.258695510593759, 'psi': 0.02109124254928932}
[S6] not sending this round → trigger blocked (psi=0.030)
[S7] START round=45 head_norm_before_train=1.973181 cos_to_last_merge=0.9905 (last merge round=30)
[S7] round=45 local utility u=0.005218 metrics={'f1_val': 0.2389237668161435, 'auprc': 0.2389237668161435, 'loss_val': 1.3982587186298006, 'psi': 0.23892376681614352}-{'f1_val': 0.23877026137926907, 'auprc': 0.23877026137926907, 'loss_val': 1.407313048435585, 'psi': 0.23877026137926907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=45 head_norm_before_train=1.646453 cos_to_last_merge=0.9769 (last merge round=32)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.374762072183894, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.343387312720153, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.024379 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.31647507586573, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.304987789007073, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.137159 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.3119361813166331, 'auprc': 0.3119361813166331, 'loss_val': 1.891036839890546, 'psi': 0.3119361813166331}-{'f1_val': 0.3107546048722519, 'auprc': 0.3107546048722519, 'loss_val': 1.8537055911955915, 'psi': 0.3107546048722519}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.754734 cos_to_last_merge=0.9938 (last merge round=32)
[S11] round=45 local utility u=0.017100 metrics={'f1_val': 0.32327814319195586, 'auprc': 0.32327814319195586, 'loss_val': 2.6198592611138456, 'psi': 0.32327814319195586}-{'f1_val': 0.3240867060785205, 'auprc': 0.3240867060785205, 'loss_val': 2.6613364592984072, 'psi': 0.3240867060785205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=45 head_norm_before_train=1.876152 cos_to_last_merge=0.9852 (last merge round=20)
[S13] round=45 local utility u=0.007200 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.847674587779263, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8620751616349643, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=45 head_norm_before_train=1.787658 cos_to_last_merge=0.9782 (last merge round=25)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.902591924382947, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.863524728582726, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.122179 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6223820576053981, 'psi': 0.6163342951580373}-{'f1_val': 0.6152170947577895, 'auprc': 0.6152170947577895, 'loss_val': 0.604435403632075, 'psi': 0.6152170947577895}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.917611 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.09073451752280365, 'auprc': 0.09073451752280365, 'loss_val': 4.629648561315377, 'psi': 0.09073451752280365}-{'f1_val': 0.0926191614857325, 'auprc': 0.0926191614857325, 'loss_val': 4.381563431853285, 'psi': 0.0926191614857325}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.692081 cos_to_last_merge=0.9872 (last merge round=31)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.3174570316949552, 'auprc': 0.3174570316949552, 'loss_val': 1.0148817865975808, 'psi': 0.3174570316949552}-{'f1_val': 0.4124395012925684, 'auprc': 0.4124395012925684, 'loss_val': 0.9264409784245395, 'psi': 0.4124395012925684}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.780184 cos_to_last_merge=0.9413 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3639514335236376, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3626664475494876, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.752565 cos_to_last_merge=0.8862 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.886
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.2455812112236986, 'psi': 0.24281921313058172}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.2273631316909004, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.070634 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1679281789939835, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1584923947738948, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.758880 cos_to_last_merge=0.9401 (last merge round=26)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8775449665130874, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8763252879362438, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.696997 cos_to_last_merge=0.9471 (last merge round=29)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.012371615312791783, 'auprc': 0.012371615312791783, 'loss_val': 6.432524701313943, 'psi': 0.012371615312791783}-{'f1_val': 0.029716343989194056, 'auprc': 0.029716343989194056, 'loss_val': 5.985499308388372, 'psi': 0.029716343989194052}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.982997 cos_to_last_merge=0.9894 (last merge round=30)
[S7] round=46 local utility u=0.004289 metrics={'f1_val': 0.23884702786748, 'auprc': 0.23884702786748, 'loss_val': 1.3889907842407139, 'psi': 0.23884702786748}-{'f1_val': 0.2389237668161435, 'auprc': 0.2389237668161435, 'loss_val': 1.3982587186298006, 'psi': 0.23892376681614352}
[S7] not sending this round → trigger blocked (psi=0.239)
[S8] START round=46 head_norm_before_train=1.659900 cos_to_last_merge=0.9760 (last merge round=32)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4100819857322544, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.374762072183894, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.029417 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3282404604586153, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.31647507586573, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.147924 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.3120059656972409, 'auprc': 0.3120059656972409, 'loss_val': 1.9143798886464538, 'psi': 0.3120059656972409}-{'f1_val': 0.3119361813166331, 'auprc': 0.3119361813166331, 'loss_val': 1.891036839890546, 'psi': 0.3119361813166331}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.763460 cos_to_last_merge=0.9933 (last merge round=32)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.32102102102102104, 'auprc': 0.32102102102102104, 'loss_val': 2.621168645446135, 'psi': 0.32102102102102104}-{'f1_val': 0.32327814319195586, 'auprc': 0.32327814319195586, 'loss_val': 2.6198592611138456, 'psi': 0.32327814319195586}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.881339 cos_to_last_merge=0.9847 (last merge round=20)
[S13] round=46 local utility u=0.002832 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8420107924264421, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.847674587779263, 'psi': 0.3599362944611573}
[S13] not sending this round → trigger blocked (psi=0.360)
[S14] START round=46 head_norm_before_train=1.794687 cos_to_last_merge=0.9775 (last merge round=25)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.94057175372388, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.902591924382947, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.135301 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6457137557596085, 'psi': 0.6150769866718802}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6223820576053981, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.923212 (no previous merge yet)
[S16] round=46 local utility u=0.301529 metrics={'f1_val': 0.1140754369825207, 'auprc': 0.1140754369825207, 'loss_val': 4.2366580833926575, 'psi': 0.1140754369825207}-{'f1_val': 0.09073451752280365, 'auprc': 0.09073451752280365, 'loss_val': 4.629648561315377, 'psi': 0.09073451752280365}
[S16] not sending this round → trigger blocked (psi=0.114)
[S17] START round=46 head_norm_before_train=1.700272 cos_to_last_merge=0.9867 (last merge round=31)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.26553683279811674, 'auprc': 0.26553683279811674, 'loss_val': 0.9855309141670048, 'psi': 0.26553683279811674}-{'f1_val': 0.3174570316949552, 'auprc': 0.3174570316949552, 'loss_val': 1.0148817865975808, 'psi': 0.3174570316949552}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.787739 cos_to_last_merge=0.9402 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3872607023111847, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3639514335236376, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.761080 cos_to_last_merge=0.8847 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.885
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.2644840414545677, 'psi': 0.24281921313058172}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.2455812112236986, 'psi': 0.24281921313058172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.076954 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1807225770687353, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1679281789939835, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.769485 cos_to_last_merge=0.9387 (last merge round=26)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8809720299000912, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8775449665130874, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.706713 cos_to_last_merge=0.9460 (last merge round=29)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=47 local utility u=0.591345 metrics={'f1_val': 0.07488807488807489, 'auprc': 0.07488807488807489, 'loss_val': 5.812483679007736, 'psi': 0.07488807488807489}-{'f1_val': 0.012371615312791783, 'auprc': 0.012371615312791783, 'loss_val': 6.432524701313943, 'psi': 0.012371615312791783}
[S6] not sending this round → trigger blocked (psi=0.075)
[S7] START round=47 head_norm_before_train=1.996781 cos_to_last_merge=0.9883 (last merge round=30)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 1.4163429763390656, 'psi': 0.23930704898446833}-{'f1_val': 0.23884702786748, 'auprc': 0.23884702786748, 'loss_val': 1.3889907842407139, 'psi': 0.23884702786748}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.670601 cos_to_last_merge=0.9747 (last merge round=32)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4451008114237465, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4100819857322544, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.034376 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3404247127501034, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3282404604586153, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.157961 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.3119361813166331, 'auprc': 0.3119361813166331, 'loss_val': 1.9360515296849288, 'psi': 0.3119361813166331}-{'f1_val': 0.3120059656972409, 'auprc': 0.3120059656972409, 'loss_val': 1.9143798886464538, 'psi': 0.3120059656972409}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.771578 cos_to_last_merge=0.9928 (last merge round=32)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.6652687793225205, 'psi': 0.3237922156595487}-{'f1_val': 0.32102102102102104, 'auprc': 0.32102102102102104, 'loss_val': 2.621168645446135, 'psi': 0.32102102102102104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.886801 cos_to_last_merge=0.9841 (last merge round=20)
[S13] round=47 local utility u=0.004471 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8330682447680768, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8420107924264421, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=47 head_norm_before_train=1.801516 cos_to_last_merge=0.9768 (last merge round=25)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.977613904417077, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.94057175372388, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.146374 (no previous merge yet)
[S15] round=47 local utility u=0.005305 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6401416666677043, 'psi': 0.615636807189815}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6457137557596085, 'psi': 0.6150769866718802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=47 head_norm_before_train=1.928955 (no previous merge yet)
[S16] round=47 local utility u=0.123389 metrics={'f1_val': 0.12768184196755625, 'auprc': 0.12768184196755625, 'loss_val': 4.112337601406, 'psi': 0.12768184196755625}-{'f1_val': 0.1140754369825207, 'auprc': 0.1140754369825207, 'loss_val': 4.2366580833926575, 'psi': 0.1140754369825207}
[S16] not sending this round → trigger blocked (psi=0.128)
[S17] START round=47 head_norm_before_train=1.710661 cos_to_last_merge=0.9856 (last merge round=31)
[S17] round=47 local utility u=0.378781 metrics={'f1_val': 0.3562623040250469, 'auprc': 0.3562623040250469, 'loss_val': 1.0444991287920442, 'psi': 0.3562623040250469}-{'f1_val': 0.26553683279811674, 'auprc': 0.26553683279811674, 'loss_val': 0.9855309141670048, 'psi': 0.26553683279811674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=48 head_norm_before_train=1.794864 cos_to_last_merge=0.9392 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.939
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.423019902138925, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.3872607023111847, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.769125 cos_to_last_merge=0.8834 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.883
[S3] round=48 local utility u=0.536102 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.284372540361093, 'psi': 0.3641628959276018}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.2644840414545677, 'psi': 0.24281921313058172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=48 head_norm_before_train=2.085320 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1883442769768175, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1807225770687353, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.781490 cos_to_last_merge=0.9372 (last merge round=26)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9023072458916894, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.8809720299000912, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.715305 cos_to_last_merge=0.9450 (last merge round=29)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=48 local utility u=0.084869 metrics={'f1_val': 0.09087348217783, 'auprc': 0.09087348217783, 'loss_val': 5.786613638633583, 'psi': 0.09087348217783}-{'f1_val': 0.07488807488807489, 'auprc': 0.07488807488807489, 'loss_val': 5.812483679007736, 'psi': 0.07488807488807489}
[S6] not sending this round → trigger blocked (psi=0.091)
[S7] START round=48 head_norm_before_train=2.006804 cos_to_last_merge=0.9874 (last merge round=30)
[S7] round=48 local utility u=0.000885 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.4187050411379583, 'psi': 0.23976608187134504}-{'f1_val': 0.23930704898446833, 'auprc': 0.23930704898446833, 'loss_val': 1.4163429763390656, 'psi': 0.23930704898446833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=48 head_norm_before_train=1.680717 cos_to_last_merge=0.9735 (last merge round=32)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4742473815992436, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4451008114237465, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.039362 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.350750087240177, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3404247127501034, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.167307 (no previous merge yet)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.31165735567970204, 'auprc': 0.31165735567970204, 'loss_val': 1.9537307255252203, 'psi': 0.31165735567970204}-{'f1_val': 0.3119361813166331, 'auprc': 0.3119361813166331, 'loss_val': 1.9360515296849288, 'psi': 0.3119361813166331}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.779415 cos_to_last_merge=0.9923 (last merge round=32)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.6878208383060223, 'psi': 0.3237922156595487}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.6652687793225205, 'psi': 0.3237922156595487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.891838 cos_to_last_merge=0.9837 (last merge round=20)
[S13] round=48 local utility u=0.000841 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8313856390226794, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8330682447680768, 'psi': 0.3599362944611573}
[S13] not sending this round → trigger blocked (psi=0.360)
[S14] START round=48 head_norm_before_train=1.808159 cos_to_last_merge=0.9762 (last merge round=25)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.014692316917986, 'psi': 0.13333333333333333}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 4.977613904417077, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.156574 (no previous merge yet)
[S15] round=48 local utility u=0.024775 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5855528320384198, 'psi': 0.6150769866718802}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6401416666677043, 'psi': 0.615636807189815}
[S15] not sending this round → trigger blocked (psi=0.615)
[S16] START round=48 head_norm_before_train=1.934549 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.049764049764049766, 'auprc': 0.049764049764049766, 'loss_val': 5.409499006381013, 'psi': 0.049764049764049766}-{'f1_val': 0.12768184196755625, 'auprc': 0.12768184196755625, 'loss_val': 4.112337601406, 'psi': 0.12768184196755625}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.718136 cos_to_last_merge=0.9845 (last merge round=31)
[S17] round=48 local utility u=0.377222 metrics={'f1_val': 0.4303865939794894, 'auprc': 0.4303865939794894, 'loss_val': 0.9571740187976016, 'psi': 0.4303865939794894}-{'f1_val': 0.3562623040250469, 'auprc': 0.3562623040250469, 'loss_val': 1.0444991287920442, 'psi': 0.3562623040250469}
[S17] not sending this round → trigger blocked (psi=0.430)
[S2] START round=49 head_norm_before_train=1.801628 cos_to_last_merge=0.9382 (last merge round=24)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4390867011490993, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.423019902138925, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.777274 cos_to_last_merge=0.8820 (last merge round=24)
[S3] ⚠️ Model drifted since last merge! cos=0.882
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.2980185779925626, 'psi': 0.3641628959276018}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.284372540361093, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.091996 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1902210207802097, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1883442769768175, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.796639 cos_to_last_merge=0.9353 (last merge round=26)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=49 local utility u=0.002939 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 1.9002178832632928, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 1.9023072458916894, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=49 head_norm_before_train=1.724360 cos_to_last_merge=0.9440 (last merge round=29)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 6.496944300684578, 'psi': 0.02109124254928932}-{'f1_val': 0.09087348217783, 'auprc': 0.09087348217783, 'loss_val': 5.786613638633583, 'psi': 0.09087348217783}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=2.017530 cos_to_last_merge=0.9863 (last merge round=30)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.4342322628977002, 'psi': 0.23976608187134504}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.4187050411379583, 'psi': 0.23976608187134504}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.690230 cos_to_last_merge=0.9726 (last merge round=32)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.498043193738746, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.4742473815992436, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.044045 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.361805604336046, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.350750087240177, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.176261 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.3097882422626981, 'auprc': 0.3097882422626981, 'loss_val': 1.9521030244156774, 'psi': 0.3097882422626981}-{'f1_val': 0.31165735567970204, 'auprc': 0.31165735567970204, 'loss_val': 1.9537307255252203, 'psi': 0.31165735567970204}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.787070 cos_to_last_merge=0.9918 (last merge round=32)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.690225665594302, 'psi': 0.3237922156595487}-{'f1_val': 0.3237922156595487, 'auprc': 0.3237922156595487, 'loss_val': 2.6878208383060223, 'psi': 0.3237922156595487}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.896741 cos_to_last_merge=0.9832 (last merge round=20)
[S13] round=49 local utility u=0.007617 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8161509720475301, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.8313856390226794, 'psi': 0.3599362944611573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=49 head_norm_before_train=1.814540 cos_to_last_merge=0.9755 (last merge round=25)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13373403456048086, 'auprc': 0.13373403456048086, 'loss_val': 5.047563439972877, 'psi': 0.13373403456048086}-{'f1_val': 0.13333333333333333, 'auprc': 0.13333333333333333, 'loss_val': 5.014692316917986, 'psi': 0.13333333333333333}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.166633 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6199725362365625, 'psi': 0.6163342951580373}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.5855528320384198, 'psi': 0.6150769866718802}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.938888 (no previous merge yet)
[S16] round=49 local utility u=0.346253 metrics={'f1_val': 0.09020267563886886, 'auprc': 0.09020267563886886, 'loss_val': 5.080940965176297, 'psi': 0.09020267563886886}-{'f1_val': 0.049764049764049766, 'auprc': 0.049764049764049766, 'loss_val': 5.409499006381013, 'psi': 0.049764049764049766}
[S16] not sending this round → trigger blocked (psi=0.090)
[S17] START round=49 head_norm_before_train=1.724219 cos_to_last_merge=0.9836 (last merge round=31)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.39798916641392645, 'auprc': 0.39798916641392645, 'loss_val': 0.9978598480415886, 'psi': 0.39798916641392645}-{'f1_val': 0.4303865939794894, 'auprc': 0.4303865939794894, 'loss_val': 0.9571740187976016, 'psi': 0.4303865939794894}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
