[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:33903
[S3] → join 127.0.0.1:33902
[S4] → join 127.0.0.1:33902
[S5] → join 127.0.0.1:33902
[S6] → join 127.0.0.1:33902
[S7] → join 127.0.0.1:33902
[S8] → join 127.0.0.1:33902
[S9] → join 127.0.0.1:33902
[S10] → join 127.0.0.1:33902
[S11] → join 127.0.0.1:33902
[S13] → join 127.0.0.1:33902
[S14] → join 127.0.0.1:33902
[S15] → join 127.0.0.1:33902
[S16] → join 127.0.0.1:33902
[S17] → join 127.0.0.1:33902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.227991 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.168820 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.187055 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.140551 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.190170 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.218460 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.142004 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.167772 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.195790 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.120928 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.148275 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.234457 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.180702 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.074707 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.119943 (no previous merge yet)
[S11]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3] + discovered S8
[S3] + discovered S7
[S3] + discovered S17
[S3] + discovered S11
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S4
[S3] + discovered S5
[S3] + discovered S9
[S3] + discovered S14
[S3] + discovered S10
[S4] + discovered S2
[S3] + discovered S6
[S3] + discovered S13
[S4] + discovered S3
[S5] + discovered S3
[S4] + discovered S15
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S16
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S6
[S4] + discovered S17
[S4] + discovered S9
[S4] + discovered S13
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S5
[S6] + discovered S5
[S5] + discovered S13
[S5] + discovered S14
[S6] + discovered S3
[S5] + discovered S16
[S5] + discovered S10
[S5] + discovered S8
[S5] + discovered S17
[S6] + discovered S2
[S5] + discovered S7
[S5] + discovered S6
[S5] + discovered S11
[S5] + discovered S15
[S6] + discovered S4
[S5] + discovered S9
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S7
[S6] + discovered S13
[S6] + discovered S9
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S11
[S7] + discovered S17
[S8] + discovered S7
[S8] + discovered S4
[S7] + discovered S9
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S5
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S10
[S7] + discovered S16
[S8] + discovered S14
[S8] + discovered S15
[S9] + discovered S4
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S17
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S6
[S9] + discovered S2
[S8] + discovered S13
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S16
[S9] + discovered S10
[S10] + discovered S4
[S10] + discovered S9
[S10] + discovered S8
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S15
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S7
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S17
[S11] + discovered S7
[S11] + discovered S6
[S11] + discovered S4
[S11] + discovered S8
[S11] + discovered S2
[S10] + discovered S14
[S10] + discovered S11
[S11] + discovered S10
[S11] + discovered S5
[S11] + discovered S3
[S11] + discovered S9
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S13
[S13] + discovered S5
[S13] + discovered S8
[S13] + discovered S3
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S9
[S11] + discovered S17
[S13] + discovered S6
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S13
[S13] + discovered S10
[S13] + discovered S7
[S13] + discovered S4
[S14] + discovered S7
[S14] + discovered S3
[S14] + discovered S11
[S14] + discovered S5
[S14] + discovered S8
[S14] + discovered S13
[S14] + discovered S4
[S13] + discovered S17
[S14] + discovered S10
[S13] + discovered S15
[S14] + discovered S2
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S9
[S14] + discovered S6
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S3
[S15] + discovered S14
[S15] + discovered S11
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S9
[S15] + discovered S7
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S5
[S15] + discovered S4
[S15] + discovered S13
[S14] + discovered S16
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S8
[S16] + discovered S7
[S16] + discovered S3
[S16] + discovered S11
[S16] + discovered S13
[S16] + discovered S2
[S16] + discovered S4
[S15] + discovered S17
[S16] + discovered S5
[S16] + discovered S9
[S16] + discovered S15
[S15] + discovered S16
[S16] + discovered S6
[S17] + discovered S16
[S17] + discovered S5
[S16] + discovered S17
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S2
[S17] + discovered S4
[S17] + discovered S9
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S14
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=1.000 → S5@127.0.0.1:33905
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S7] ⇄ pheromone p=1.000 → S2@127.0.0.1:33902
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:33908
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:33903
[S9] ⇄ pheromone p=1.000 → S10@127.0.0.1:33911
[S11] ⇄ pheromone p=1.000 → S4@127.0.0.1:33904
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:33904
[S13] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:33907
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S2] ⇄ pheromone p=1.000 → S3@127.0.0.1:33903
[S8] ⇄ pheromone p=1.000 → S2@127.0.0.1:33902
[S15] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:33909
[S2] START round=1 head_norm_before_train=1.238588 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6104851746556033, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5318174797591362, 'psi': 0.0}
[S3] START round=1 head_norm_before_train=1.163242 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5870508011055076, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5145073079012543, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.190507 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.2394158188382015, 'auprc': 0.2394158188382015, 'loss_val': 1.3771711228877965, 'psi': 0.2394158188382015}-{'f1_val': 0.6654635633395123, 'auprc': 0.6654635633395123, 'loss_val': 1.3423140268376208, 'psi': 0.6654635633395123}
[S5] START round=1 head_norm_before_train=1.149159 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4597806668798088, 'psi': 0.0}-{'f1_val': 0.20801576872536137, 'auprc': 0.20801576872536137, 'loss_val': 1.422555524291306, 'psi': 0.20801576872536137}
[S6] START round=1 head_norm_before_train=1.197541 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5586373144737413, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4703168180301724, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.217451 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4568164545554996, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4081337399356415, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.149144 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.473922005554436, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4363034151846108, 'psi': 0.0}
[S9] START round=1 head_norm_before_train=1.179437 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5415866573543662, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.447836218413568, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.196472 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4945237239531668, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4428186488332215, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.122511 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4902407420420336, 'psi': 0.0}-{'f1_val': 0.2759562841530055, 'auprc': 0.2759562841530055, 'loss_val': 1.407052711933525, 'psi': 0.2759562841530055}
[S13] START round=1 head_norm_before_train=1.147235 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.437755209602934, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.395296401398185, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.244230 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.661844177035948, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5593908522848756, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.185294 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4684929497325145, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4063840525110785, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.080046 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.488629614602388, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4169756007133614, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.123863 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.514001142406368, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.457734303218258, 'psi': 0.0}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.256357 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7633646502926947, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6104851746556033, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.171587 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.698073615792045, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5870508011055076, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.207367 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.000315059861373661, 'auprc': 0.000315059861373661, 'loss_val': 1.4267208689482451, 'psi': 0.000315059861373661}-{'f1_val': 0.2394158188382015, 'auprc': 0.2394158188382015, 'loss_val': 1.3771711228877965, 'psi': 0.2394158188382015}
[S5] START round=2 head_norm_before_train=1.165924 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5405417869631166, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4597806668798088, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.217100 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7238665275343963, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5586373144737413, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.226425 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5532774110576721, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4568164545554996, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.166277 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5444501817375031, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.473922005554436, 'psi': 0.0}
[S9] START round=2 head_norm_before_train=1.201832 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7183577790012974, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5415866573543662, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.206416 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5710319724767792, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4945237239531668, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.137595 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6558505126692467, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4902407420420336, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.152250 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5047468882668396, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.437755209602934, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.265700 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8536188525074802, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.661844177035948, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.201159 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6040500532038346, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4684929497325145, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.101981 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.634006289735792, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.488629614602388, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.138475 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6108624872703785, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.514001142406368, 'psi': 0.0}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.282892 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.13270015169851, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7633646502926947, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.190939 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9323090090446964, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.698073615792045, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.235030 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5179200557589232, 'psi': 0.0}-{'f1_val': 0.000315059861373661, 'auprc': 0.000315059861373661, 'loss_val': 1.4267208689482451, 'psi': 0.000315059861373661}
[S5] START round=3 head_norm_before_train=1.194490 (no previous merge yet)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7446648784231402, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5405417869631166, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.248364 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.164116680727478, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7238665275343963, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.244672 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7899710442702066, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5532774110576721, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.194804 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.71464607821199, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5444501817375031, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.232995 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.135057015968555, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7183577790012974, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.225640 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7204340771656002, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5710319724767792, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.166103 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1137052792581654, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6558505126692467, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.166744 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6481650127248808, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5047468882668396, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.298782 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3336013830270965, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8536188525074802, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.226785 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9378870798492935, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6040500532038346, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.136820 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.043485588574356, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.634006289735792, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.164032 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8123731135749184, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6108624872703785, 'psi': 0.0}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.316917 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6659301665959596, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.13270015169851, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.219726 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.488943264534347, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9323090090446964, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.269564 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6365541399700705, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5179200557589232, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.228144 (no previous merge yet)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7667405433392755, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7446648784231402, 'psi': 0.0}
[S6] START round=4 head_norm_before_train=1.289205 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.885060956990016, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.164116680727478, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.268953 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8318298530540478, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7899710442702066, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.228639 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7263748603685913, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.71464607821199, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.271873 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5036236899605, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.135057015968555, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.250829 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9909458355499543, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7204340771656002, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.205675 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.848139817425043, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1137052792581654, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.189761 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7608224226534526, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6481650127248808, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.341099 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.906031734784661, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3336013830270965, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.257032 (no previous merge yet)
[S15] round=4 local utility u=0.007278 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9233315974348182, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9378870798492935, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.179917 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.868719953102723, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.043485588574356, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.196427 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.923917017268812, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8123731135749184, 'psi': 0.0}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.348487 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7769625114844843, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6659301665959596, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.251319 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0210019992938872, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.488943264534347, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.303697 (no previous merge yet)
[S4] round=5 local utility u=0.071151 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.494252299311769, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6365541399700705, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.240242 (no previous merge yet)
[S5] round=5 local utility u=0.063671 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6393991614074332, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7667405433392755, 'psi': 0.0}
[S6] START round=5 head_norm_before_train=1.324008 (no previous merge yet)
[S6] round=5 local utility u=0.009110 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.866841446176993, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.885060956990016, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.275874 (no previous merge yet)
[S7] round=5 local utility u=0.023436 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7849579648366856, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8318298530540478, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.253302 (no previous merge yet)
[S8] round=5 local utility u=0.109108 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.508159491315692, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7263748603685913, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.306620 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.569363888619629, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5036236899605, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.277571 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1659146515677765, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9909458355499543, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.242424 (no previous merge yet)
[S11] round=5 local utility u=0.040634 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7668709275839736, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.848139817425043, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.206544 (no previous merge yet)
[S13] round=5 local utility u=0.028022 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7047784626029012, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7608224226534526, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.375332 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0681011896020807, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.906031734784661, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.266617 (no previous merge yet)
[S15] round=5 local utility u=0.037144 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8490437372393116, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9233315974348182, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.222540 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0388228893354716, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.868719953102723, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.223306 (no previous merge yet)
[S17] round=5 local utility u=0.133945 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6560262336547464, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.923917017268812, 'psi': 0.0}
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S10] ⇄ pheromone p=0.328 → S6@127.0.0.1:33907
[S2] ⇄ pheromone p=0.328 → S3@127.0.0.1:33903
[S16] ⇄ pheromone p=0.328 → S6@127.0.0.1:33907
[S13] ⇄ pheromone p=0.333 → S6@127.0.0.1:33907
[S14] ⇄ pheromone p=0.328 → S7@127.0.0.1:33908
[S7] ⇄ pheromone p=0.332 → S2@127.0.0.1:33902
[S3] ⇄ pheromone p=0.328 → S4@127.0.0.1:33904
[S5] ⇄ pheromone p=0.340 → S3@127.0.0.1:33903
[S8] ⇄ pheromone p=0.350 → S2@127.0.0.1:33902
[S6] ⇄ pheromone p=0.330 → S5@127.0.0.1:33905
[S9] ⇄ pheromone p=0.328 → S10@127.0.0.1:33911
[S15] ⇄ pheromone p=0.336 → S8@127.0.0.1:33909
[S4] ⇄ pheromone p=0.342 → S8@127.0.0.1:33909
[S11] ⇄ pheromone p=0.336 → S4@127.0.0.1:33904
[S17] ⇄ pheromone p=0.354 → S8@127.0.0.1:33909
[S2] START round=6 head_norm_before_train=1.372227 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.784340803803778, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7769625114844843, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.277715 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0231567924251164, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0210019992938872, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.320951 (no previous merge yet)
[S4] round=6 local utility u=0.039760 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4147316410932937, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.494252299311769, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.244859 (no previous merge yet)
[S5] round=6 local utility u=0.497213 metrics={'f1_val': 0.10382222222222222, 'auprc': 0.10382222222222222, 'loss_val': 1.579373788248613, 'psi': 0.10382222222222222}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6393991614074332, 'psi': 0.0}
[S6] START round=6 head_norm_before_train=1.342305 (no previous merge yet)
[S6] round=6 local utility u=0.058943 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.748956122403011, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.866841446176993, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.280370 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8506818266078722, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7849579648366856, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.267240 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.23192881829546289, 'auprc': 0.23192881829546289, 'loss_val': 1.4409261469327037, 'psi': 0.23192881829546289}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.508159491315692, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.340201 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7822366916705032, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.569363888619629, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.297458 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.319309147016427, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1659146515677765, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.261516 (no previous merge yet)
[S11] round=6 local utility u=0.140636 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4855991886289406, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7668709275839736, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.214157 (no previous merge yet)
[S13] round=6 local utility u=0.030174 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6444309813569769, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7047784626029012, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.397115 (no previous merge yet)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1706763127441935, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0681011896020807, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.277068 (no previous merge yet)
[S15] round=6 local utility u=0.027442 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7941605563787852, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8490437372393116, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.250728 (no previous merge yet)
[S16] round=6 local utility u=0.156993 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.724837712778692, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0388228893354716, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.236421 (no previous merge yet)
[S17] round=6 local utility u=0.058235 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5395561603771966, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6560262336547464, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:33902
[S5] not sending this round → trigger blocked (psi=0.104)
[S15] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=0.0695
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.0000 head_norm=1.397762
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.192464e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.0000 head_norm=0.985278 delta_norm=0.919246
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.985278 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.292535 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.19927063166969, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.784340803803778, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.295944 (no previous merge yet)
[S3] round=7 local utility u=0.186035 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6510860627487984, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0231567924251164, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.346808 (no previous merge yet)
[S4] round=7 local utility u=0.027772 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3591869173215472, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4147316410932937, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.258096 (no previous merge yet)
[S5] round=7 local utility u=0.705630 metrics={'f1_val': 0.25345862699034194, 'auprc': 0.25345862699034194, 'loss_val': 1.514841872661137, 'psi': 0.25345862699034194}-{'f1_val': 0.10382222222222222, 'auprc': 0.10382222222222222, 'loss_val': 1.579373788248613, 'psi': 0.10382222222222222}
[S6] START round=7 head_norm_before_train=1.364309 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.161022196949499, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.748956122403011, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.294869 (no previous merge yet)
[S7] round=7 local utility u=0.013171 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8243392757443826, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8506818266078722, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.295313 (no previous merge yet)
[S8] round=7 local utility u=0.021895 metrics={'f1_val': 0.2273087166198805, 'auprc': 0.2273087166198805, 'loss_val': 1.3555552846634504, 'psi': 0.2273087166198805}-{'f1_val': 0.23192881829546289, 'auprc': 0.23192881829546289, 'loss_val': 1.4409261469327037, 'psi': 0.23192881829546289}
[S9] START round=7 head_norm_before_train=1.377459 (no previous merge yet)
[S9] round=7 local utility u=0.143664 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.494908920322642, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7822366916705032, 'psi': 0.0}
[S10] START round=7 head_norm_before_train=1.319542 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.691603180725964, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.319309147016427, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.278790 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.568613915064934, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4855991886289406, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.225317 (no previous merge yet)
[S13] round=7 local utility u=0.002927 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6385761592985608, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6444309813569769, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.418701 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.302356447183911, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1706763127441935, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.292984 (no previous merge yet)
[S15] round=7 local utility u=0.038900 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7163598340660844, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7941605563787852, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=1.275835 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.828403339915426, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.724837712778692, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.261204 (no previous merge yet)
[S17] round=7 local utility u=0.055579 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4283980836627683, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5395561603771966, 'psi': 0.0}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:33902
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:33903
[S15] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.000)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] cosine check vs S5: cos=-0.0039
[S3] DROPPED delta from S5 (cos=-0.0039 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=0.6859
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.0000 head_norm=1.011474
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.863853e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.0000 head_norm=1.076695 delta_norm=0.486385
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.076695 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.071547 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0561762037144646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.19927063166969, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.309235 (no previous merge yet)
[S3] round=8 local utility u=0.031986 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5871136034672926, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6510860627487984, 'psi': 0.0}
[S4] START round=8 head_norm_before_train=1.379217 (no previous merge yet)
[S4] round=8 local utility u=0.011709 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3357682332230167, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3591869173215472, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.275032 (no previous merge yet)
[S5] round=8 local utility u=0.000000 metrics={'f1_val': 0.21674539604299306, 'auprc': 0.21674539604299306, 'loss_val': 1.40432897612597, 'psi': 0.2167453960429931}-{'f1_val': 0.25345862699034194, 'auprc': 0.25345862699034194, 'loss_val': 1.514841872661137, 'psi': 0.25345862699034194}
[S6] START round=8 head_norm_before_train=1.396244 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4075274226372674, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.161022196949499, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.307957 (no previous merge yet)
[S7] round=8 local utility u=0.074634 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6750708444380438, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8243392757443826, 'psi': 0.0}
[S8] START round=8 head_norm_before_train=1.329890 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.20507825183453474, 'auprc': 0.20507825183453474, 'loss_val': 1.266796770738853, 'psi': 0.20507825183453474}-{'f1_val': 0.2273087166198805, 'auprc': 0.2273087166198805, 'loss_val': 1.3555552846634504, 'psi': 0.2273087166198805}
[S9] START round=8 head_norm_before_train=1.416884 (no previous merge yet)
[S9] round=8 local utility u=0.092297 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3103150623026885, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.494908920322642, 'psi': 0.0}
[S10] START round=8 head_norm_before_train=1.346179 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.413559843283739, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.691603180725964, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.304133 (no previous merge yet)
[S11] round=8 local utility u=0.147294 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2740250129034023, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.568613915064934, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.242817 (no previous merge yet)
[S13] round=8 local utility u=0.064143 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5102905867545704, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6385761592985608, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.444868 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.765543960232798, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.302356447183911, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.312839 (no previous merge yet)
[S15] round=8 local utility u=0.063950 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5884588745942505, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7163598340660844, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.306426 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9868501870801545, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.828403339915426, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.290843 (no previous merge yet)
[S17] round=8 local utility u=0.036551 metrics={'f1_val': 0.0005743825387708214, 'auprc': 0.0005743825387708214, 'loss_val': 1.3604654404097043, 'psi': 0.0005743825387708214}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4283980836627683, 'psi': 0.0}
[S9] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.001)
[S2] START round=9 head_norm_before_train=1.096294 cos_to_last_merge=0.9964 (last merge round=7)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3807439104441097, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.0561762037144646, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.331676 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7177486707258707, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5871136034672926, 'psi': 0.0}
[S4] START round=9 head_norm_before_train=1.410656 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3453251864033977, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3357682332230167, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.288514 (no previous merge yet)
[S5] round=9 local utility u=1.000000 metrics={'f1_val': 0.5141360369698917, 'auprc': 0.5141360369698917, 'loss_val': 1.3162253453211301, 'psi': 0.5141360369698917}-{'f1_val': 0.21674539604299306, 'auprc': 0.21674539604299306, 'loss_val': 1.40432897612597, 'psi': 0.2167453960429931}
[S6] START round=9 head_norm_before_train=1.429155 (no previous merge yet)
[S6] round=9 local utility u=0.016227 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3750743830206194, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4075274226372674, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.318953 (no previous merge yet)
[S7] round=9 local utility u=0.037152 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.600767132394959, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6750708444380438, 'psi': 0.0}
[S8] START round=9 head_norm_before_train=1.358116 (no previous merge yet)
[S8] round=9 local utility u=0.022538 metrics={'f1_val': 0.20555881012823016, 'auprc': 0.20555881012823016, 'loss_val': 1.2260467100392505, 'psi': 0.20555881012823016}-{'f1_val': 0.20507825183453474, 'auprc': 0.20507825183453474, 'loss_val': 1.266796770738853, 'psi': 0.20507825183453474}
[S9] START round=9 head_norm_before_train=1.455964 (no previous merge yet)
[S9] round=9 local utility u=0.858215 metrics={'f1_val': 0.16474543707973102, 'auprc': 0.16474543707973102, 'loss_val': 2.076594293345818, 'psi': 0.16474543707973102}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3103150623026885, 'psi': 0.0}
[S10] START round=9 head_norm_before_train=1.380997 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.638892165910147, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.413559843283739, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.330972 (no previous merge yet)
[S11] round=9 local utility u=0.196863 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8802998516023888, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2740250129034023, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.257081 (no previous merge yet)
[S13] round=9 local utility u=0.059736 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3908194826693807, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5102905867545704, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.478687 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.282088081609943, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.765543960232798, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.336671 (no previous merge yet)
[S15] round=9 local utility u=0.103563 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3813325084613204, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5884588745942505, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.344644 (no previous merge yet)
[S16] round=9 local utility u=0.080063 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8267247929810133, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9868501870801545, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.321649 (no previous merge yet)
[S17] round=9 local utility u=0.817140 metrics={'f1_val': 0.1766453382084095, 'auprc': 0.1766453382084095, 'loss_val': 1.310824414417284, 'psi': 0.1766453382084095}-{'f1_val': 0.0005743825387708214, 'auprc': 0.0005743825387708214, 'loss_val': 1.3604654404097043, 'psi': 0.0005743825387708214}
[S9] not sending this round → trigger blocked (psi=0.165)
[S6] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:33902
[S16] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S8
[S2] cosine check vs S8: cos=0.8933
[S3] RECEIVED delta(kind=head bytes=1789) from S5
[S3] cosine check vs S5: cos=-0.0116
[S3] DROPPED delta from S5 (cos=-0.0116 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.177)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.0000 head_norm=1.127877
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.169962e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.0000 head_norm=1.224361 delta_norm=0.316996
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.224361 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.110582 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1595791738890044, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3807439104441097, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.359939 (no previous merge yet)
[S3] round=10 local utility u=0.116615 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.484519152366948, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7177486707258707, 'psi': 0.0}
[S4] START round=10 head_norm_before_train=1.444517 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.366272163377402, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3453251864033977, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.303861 (no previous merge yet)
[S5] round=10 local utility u=0.834260 metrics={'f1_val': 0.692975265559362, 'auprc': 0.692975265559362, 'loss_val': 1.2572584024270377, 'psi': 0.692975265559362}-{'f1_val': 0.5141360369698917, 'auprc': 0.5141360369698917, 'loss_val': 1.3162253453211301, 'psi': 0.5141360369698917}
[S6] START round=10 head_norm_before_train=1.463749 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.432494304092235, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3750743830206194, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.336789 (no previous merge yet)
[S7] round=10 local utility u=0.062274 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4762182879512848, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.600767132394959, 'psi': 0.0}
[S8] START round=10 head_norm_before_train=1.388161 (no previous merge yet)
[S8] round=10 local utility u=0.010437 metrics={'f1_val': 0.20380767989674087, 'auprc': 0.20380767989674087, 'loss_val': 1.189412022528409, 'psi': 0.20380767989674087}-{'f1_val': 0.20555881012823016, 'auprc': 0.20555881012823016, 'loss_val': 1.2260467100392505, 'psi': 0.20555881012823016}
[S9] START round=10 head_norm_before_train=1.495659 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.16424510423247, 'auprc': 0.16424510423247, 'loss_val': 2.1310588365319814, 'psi': 0.16424510423247}-{'f1_val': 0.16474543707973102, 'auprc': 0.16474543707973102, 'loss_val': 2.076594293345818, 'psi': 0.16474543707973102}
[S10] START round=10 head_norm_before_train=1.414427 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.867463679363223, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.638892165910147, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.361565 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8844899243804345, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8802998516023888, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.272134 (no previous merge yet)
[S13] round=10 local utility u=1.000000 metrics={'f1_val': 0.24370971095861926, 'auprc': 0.24370971095861926, 'loss_val': 1.2953500380833207, 'psi': 0.24370971095861926}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3908194826693807, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.512337 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.909544230686304, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.282088081609943, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.365361 (no previous merge yet)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.3331228956228956, 'auprc': 0.3331228956228956, 'loss_val': 1.2523908313975025, 'psi': 0.3331228956228956}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3813325084613204, 'psi': 0.0}
[S16] START round=10 head_norm_before_train=1.380585 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9826522180653052, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8267247929810133, 'psi': 0.0}
[S17] START round=10 head_norm_before_train=1.350684 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.15821378056172963, 'auprc': 0.15821378056172963, 'loss_val': 1.2886104611114504, 'psi': 0.15821378056172963}-{'f1_val': 0.1766453382084095, 'auprc': 0.1766453382084095, 'loss_val': 1.310824414417284, 'psi': 0.1766453382084095}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:33909
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33903
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.0162
[S3] DROPPED delta from S5 (cos=-0.0162 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S13
[S6] cosine check vs S13: cos=0.0369
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=0.9612
[S8] RECEIVED delta(kind=head bytes=1804) from S15
[S8] cosine check vs S15: cos=-0.0581
[S8] DROPPED delta from S15 (cos=-0.0581 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.0000 head_norm=1.250619
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.036675e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.321866 delta_norm=0.203668
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.169 → S3@127.0.0.1:33903
[S7] ⇄ pheromone p=0.138 → S2@127.0.0.1:33902
[S3] ⇄ pheromone p=0.154 → S4@127.0.0.1:33904
[S10] ⇄ pheromone p=0.107 → S6@127.0.0.1:33907
[S11] ⇄ pheromone p=0.172 → S4@127.0.0.1:33904
[S9] ⇄ pheromone p=0.271 → S10@127.0.0.1:33911
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.0000 head_norm=1.501965
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.714199e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.0000 head_norm=1.007553 delta_norm=0.971420
[S6] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.115 → S5@127.0.0.1:33905
[S4] ⇄ pheromone p=0.120 → S8@127.0.0.1:33909
[S14] ⇄ pheromone p=0.107 → S7@127.0.0.1:33908
[S15] ⇄ pheromone p=0.341 → S8@127.0.0.1:33909
[S8] ⇄ pheromone p=0.204 → S2@127.0.0.1:33902
[S5] ⇄ pheromone p=0.551 → S3@127.0.0.1:33903
[S13] ⇄ pheromone p=0.330 → S6@127.0.0.1:33907
[S17] ⇄ pheromone p=0.262 → S8@127.0.0.1:33909
[S16] ⇄ pheromone p=0.133 → S6@127.0.0.1:33907
[S2] START round=11 head_norm_before_train=1.321866 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.066644 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.026290432669741, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1595791738890044, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.390041 (no previous merge yet)
[S3] round=11 local utility u=0.013415 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4576895676407218, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.484519152366948, 'psi': 0.0}
[S4] START round=11 head_norm_before_train=1.478208 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3976656817175235, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.366272163377402, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.320231 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.36625610018729576, 'auprc': 0.36625610018729576, 'loss_val': 1.2136945882153956, 'psi': 0.36625610018729576}-{'f1_val': 0.692975265559362, 'auprc': 0.692975265559362, 'loss_val': 1.2572584024270377, 'psi': 0.692975265559362}
[S6] START round=11 head_norm_before_train=1.007553 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.747130 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.938233581887534, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.432494304092235, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.350168 (no previous merge yet)
[S7] round=11 local utility u=0.013363 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.44949276180317, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4762182879512848, 'psi': 0.0}
[S8] START round=11 head_norm_before_train=1.419004 (no previous merge yet)
[S8] round=11 local utility u=0.003329 metrics={'f1_val': 0.20380767989674087, 'auprc': 0.20380767989674087, 'loss_val': 1.1827548464868638, 'psi': 0.20380767989674087}-{'f1_val': 0.20380767989674087, 'auprc': 0.20380767989674087, 'loss_val': 1.189412022528409, 'psi': 0.20380767989674087}
[S9] START round=11 head_norm_before_train=1.535446 (no previous merge yet)
[S9] round=11 local utility u=0.939841 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.091216767252933, 'psi': 0.36867172340800847}-{'f1_val': 0.16424510423247, 'auprc': 0.16424510423247, 'loss_val': 2.1310588365319814, 'psi': 0.16424510423247}
[S10] START round=11 head_norm_before_train=1.448409 (no previous merge yet)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.295399410751077, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.867463679363223, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.399031 (no previous merge yet)
[S11] round=11 local utility u=0.498843 metrics={'f1_val': 0.08715658411151712, 'auprc': 0.08715658411151712, 'loss_val': 1.6712130391129, 'psi': 0.08715658411151712}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8844899243804345, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.289085 (no previous merge yet)
[S13] round=11 local utility u=0.409225 metrics={'f1_val': 0.32493279569892475, 'auprc': 0.32493279569892475, 'loss_val': 1.2079075606996597, 'psi': 0.32493279569892475}-{'f1_val': 0.24370971095861926, 'auprc': 0.24370971095861926, 'loss_val': 1.2953500380833207, 'psi': 0.24370971095861926}
[S14] START round=11 head_norm_before_train=1.545289 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.172991525056526, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.909544230686304, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.394694 (no previous merge yet)
[S15] round=11 local utility u=0.050709 metrics={'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.150027299541431, 'psi': 0.33301777637530244}-{'f1_val': 0.3331228956228956, 'auprc': 0.3331228956228956, 'loss_val': 1.2523908313975025, 'psi': 0.3331228956228956}
[S16] START round=11 head_norm_before_train=1.410532 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.186858879680051, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9826522180653052, 'psi': 0.0}
[S17] START round=11 head_norm_before_train=1.375172 (no previous merge yet)
[S17] round=11 local utility u=0.054095 metrics={'f1_val': 0.17261904761904762, 'auprc': 0.17261904761904762, 'loss_val': 1.3100686004602171, 'psi': 0.17261904761904762}-{'f1_val': 0.15821378056172963, 'auprc': 0.15821378056172963, 'loss_val': 1.2886104611114504, 'psi': 0.15821378056172963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:33902
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.087)
[S3] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:33907
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=-0.0560
[S8] DROPPED delta from S15 (cos=-0.0560 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S9
[S10] cosine check vs S9: cos=0.0001
[S6] RECEIVED delta(kind=head bytes=1796) from S13
[S6] cosine check vs S13: cos=0.6393
[S2] RECEIVED delta(kind=head bytes=1803) from S8
[S2] cosine check vs S8: cos=0.9782
[S17] not sending this round → trigger blocked (psi=0.173)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.0000 head_norm=1.478101
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.079222e+00
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.079345 delta_norm=1.079222
[S10] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.0000 head_norm=1.348058
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.539575e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.389892 delta_norm=0.153957
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.0000 head_norm=1.051324
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.151767e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.0000 head_norm=1.070786 delta_norm=0.515177
[S6] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.389892 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.019918 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9864536932821977, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.026290432669741, 'psi': 0.0}
[S3] START round=12 head_norm_before_train=1.424001 (no previous merge yet)
[S3] round=12 local utility u=0.518889 metrics={'f1_val': 0.10015898251192369, 'auprc': 0.10015898251192369, 'loss_val': 2.321341665517606, 'psi': 0.10015898251192369}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4576895676407218, 'psi': 0.0}
[S4] START round=12 head_norm_before_train=1.512434 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4503220068235403, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3976656817175235, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.343785 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1718841586384026, 'psi': 0.35933890172383154}-{'f1_val': 0.36625610018729576, 'auprc': 0.36625610018729576, 'loss_val': 1.2136945882153956, 'psi': 0.36625610018729576}
[S6] START round=12 head_norm_before_train=1.070786 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.197691 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5428513580781185, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.938233581887534, 'psi': 0.0}
[S7] START round=12 head_norm_before_train=1.365151 (no previous merge yet)
[S7] round=12 local utility u=0.000469 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4485550000466936, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.44949276180317, 'psi': 0.0}
[S8] START round=12 head_norm_before_train=1.446979 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.15276702786377708, 'auprc': 0.15276702786377708, 'loss_val': 1.1710066525057896, 'psi': 0.15276702786377708}-{'f1_val': 0.20380767989674087, 'auprc': 0.20380767989674087, 'loss_val': 1.1827548464868638, 'psi': 0.20380767989674087}
[S9] START round=12 head_norm_before_train=1.573094 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1971207866275257, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.091216767252933, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.079345 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.614176 metrics={'f1_val': 0.005904581955597544, 'auprc': 0.005904581955597544, 'loss_val': 3.120188012338099, 'psi': 0.005904581955597544}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 4.295399410751077, 'psi': 0.0}
[S11] START round=12 head_norm_before_train=1.433502 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9029151649602654, 'psi': 0.0}-{'f1_val': 0.08715658411151712, 'auprc': 0.08715658411151712, 'loss_val': 1.6712130391129, 'psi': 0.08715658411151712}
[S13] START round=12 head_norm_before_train=1.310991 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.30213684759139303, 'auprc': 0.30213684759139303, 'loss_val': 1.152226494763719, 'psi': 0.30213684759139303}-{'f1_val': 0.32493279569892475, 'auprc': 0.32493279569892475, 'loss_val': 1.2079075606996597, 'psi': 0.32493279569892475}
[S14] START round=12 head_norm_before_train=1.576851 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.011393379522709775, 'auprc': 0.011393379522709775, 'loss_val': 5.316832239925268, 'psi': 0.011393379522709775}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.172991525056526, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.429393 (no previous merge yet)
[S15] round=12 local utility u=0.044257 metrics={'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.063406233074261, 'psi': 0.3332280812546048}-{'f1_val': 0.33301777637530244, 'auprc': 0.33301777637530244, 'loss_val': 1.150027299541431, 'psi': 0.33301777637530244}
[S16] START round=12 head_norm_before_train=1.433722 (no previous merge yet)
[S16] round=12 local utility u=0.012060 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1627383490982464, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.186858879680051, 'psi': 0.0}
[S17] START round=12 head_norm_before_train=1.398924 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3432987728363237, 'psi': 0.0}-{'f1_val': 0.17261904761904762, 'auprc': 0.17261904761904762, 'loss_val': 1.3100686004602171, 'psi': 0.17261904761904762}
[S16] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.100)
[S6] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.006)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:33909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S15] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S15
[S8] cosine check vs S15: cos=-0.0542
[S8] DROPPED delta from S15 (cos=-0.0542 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=13 head_norm_before_train=1.418428 cos_to_last_merge=0.9973 (last merge round=11)
[S2] round=13 local utility u=0.046592 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8932696802702347, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9864536932821977, 'psi': 0.0}
[S3] START round=13 head_norm_before_train=1.461706 (no previous merge yet)
[S3] round=13 local utility u=0.198564 metrics={'f1_val': 0.1443448076366792, 'auprc': 0.1443448076366792, 'loss_val': 2.3218855644250405, 'psi': 0.1443448076366792}-{'f1_val': 0.10015898251192369, 'auprc': 0.10015898251192369, 'loss_val': 2.321341665517606, 'psi': 0.10015898251192369}
[S4] START round=13 head_norm_before_train=1.548313 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.490865276268244, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4503220068235403, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.367655 (no previous merge yet)
[S5] round=13 local utility u=0.066017 metrics={'f1_val': 0.371052807486631, 'auprc': 0.371052807486631, 'loss_val': 1.1452745457341846, 'psi': 0.371052807486631}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1718841586384026, 'psi': 0.35933890172383154}
[S6] START round=13 head_norm_before_train=1.106715 cos_to_last_merge=0.9958 (last merge round=11)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.124344431604734, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5428513580781185, 'psi': 0.0}
[S7] START round=13 head_norm_before_train=1.378941 (no previous merge yet)
[S7] round=13 local utility u=0.012174 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4242069467429035, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4485550000466936, 'psi': 0.0}
[S8] START round=13 head_norm_before_train=1.470659 (no previous merge yet)
[S8] round=13 local utility u=0.021295 metrics={'f1_val': 0.1528853601859024, 'auprc': 0.1528853601859024, 'loss_val': 1.1294816044830551, 'psi': 0.1528853601859024}-{'f1_val': 0.15276702786377708, 'auprc': 0.15276702786377708, 'loss_val': 1.1710066525057896, 'psi': 0.15276702786377708}
[S9] START round=13 head_norm_before_train=1.608010 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.36383409226787, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.1971207866275257, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.113834 cos_to_last_merge=0.9981 (last merge round=11)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.004117181314330958, 'auprc': 0.004117181314330958, 'loss_val': 3.6589579780655805, 'psi': 0.004117181314330958}-{'f1_val': 0.005904581955597544, 'auprc': 0.005904581955597544, 'loss_val': 3.120188012338099, 'psi': 0.005904581955597544}
[S11] START round=13 head_norm_before_train=1.467978 (no previous merge yet)
[S11] round=13 local utility u=0.020724 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8614677003048774, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9029151649602654, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.334995 (no previous merge yet)
[S13] round=13 local utility u=0.277264 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1178933010640026, 'psi': 0.3599362944611573}-{'f1_val': 0.30213684759139303, 'auprc': 0.30213684759139303, 'loss_val': 1.152226494763719, 'psi': 0.30213684759139303}
[S14] START round=13 head_norm_before_train=1.606625 (no previous merge yet)
[S14] round=13 local utility u=0.034997 metrics={'f1_val': 0.022111161593215203, 'auprc': 0.022111161593215203, 'loss_val': 5.343297828520354, 'psi': 0.022111161593215203}-{'f1_val': 0.011393379522709775, 'auprc': 0.011393379522709775, 'loss_val': 5.316832239925268, 'psi': 0.011393379522709775}
[S15] START round=13 head_norm_before_train=1.463818 (no previous merge yet)
[S15] round=13 local utility u=0.072532 metrics={'f1_val': 0.3331226295828066, 'auprc': 0.3331226295828066, 'loss_val': 0.9173921846268871, 'psi': 0.3331226295828066}-{'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.063406233074261, 'psi': 0.3332280812546048}
[S16] START round=13 head_norm_before_train=1.457559 (no previous merge yet)
[S16] round=13 local utility u=0.241540 metrics={'f1_val': 0.016554809843400447, 'auprc': 0.016554809843400447, 'loss_val': 2.828651964639314, 'psi': 0.016554809843400447}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.1627383490982464, 'psi': 0.0}
[S17] START round=13 head_norm_before_train=1.417514 (no previous merge yet)
[S17] round=13 local utility u=0.709533 metrics={'f1_val': 0.1564531104921077, 'auprc': 0.1564531104921077, 'loss_val': 1.3323108162896724, 'psi': 0.1564531104921077}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3432987728363237, 'psi': 0.0}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[S3] not sending this round → trigger blocked (psi=0.144)
[S2] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → trigger blocked (psi=0.017)
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:33902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33907
[S14] not sending this round → trigger blocked (psi=0.022)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=-0.0521
[S8] DROPPED delta from S15 (cos=-0.0521 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S13
[S6] cosine check vs S13: cos=0.8597
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0282
[S3] DROPPED delta from S5 (cos=-0.0282 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=0.9676
[S17] not sending this round → trigger blocked (psi=0.156)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.0000 head_norm=1.156410
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.470004e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.0000 head_norm=1.212769 delta_norm=0.347000
[S6] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.0000 head_norm=1.453612
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.886579e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.0357 head_norm=1.461957 delta_norm=0.188658
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.461957 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.637067 metrics={'f1_val': 0.12022303821569429, 'auprc': 0.12022303821569429, 'loss_val': 1.7011421650815843, 'psi': 0.12022303821569429}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8932696802702347, 'psi': 0.0}
[S3] START round=14 head_norm_before_train=1.501420 (no previous merge yet)
[S3] round=14 local utility u=0.523830 metrics={'f1_val': 0.26767884010395293, 'auprc': 0.26767884010395293, 'loss_val': 2.384231679954148, 'psi': 0.26767884010395293}-{'f1_val': 0.1443448076366792, 'auprc': 0.1443448076366792, 'loss_val': 2.3218855644250405, 'psi': 0.1443448076366792}
[S4] START round=14 head_norm_before_train=1.586781 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.491209669248068, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.490865276268244, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.394563 (no previous merge yet)
[S5] round=14 local utility u=0.026583 metrics={'f1_val': 0.37377724970484955, 'auprc': 0.37377724970484955, 'loss_val': 1.1166287033893625, 'psi': 0.37377724970484955}-{'f1_val': 0.371052807486631, 'auprc': 0.371052807486631, 'loss_val': 1.1452745457341846, 'psi': 0.371052807486631}
[S6] START round=14 head_norm_before_train=1.212769 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.258568 metrics={'f1_val': 0.0023820867079561697, 'auprc': 0.0023820867079561697, 'loss_val': 2.6286468762080935, 'psi': 0.0023820867079561697}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.124344431604734, 'psi': 0.0}
[S7] START round=14 head_norm_before_train=1.389381 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4465024373697497, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4242069467429035, 'psi': 0.0}
[S8] START round=14 head_norm_before_train=1.494266 (no previous merge yet)
[S8] round=14 local utility u=0.027537 metrics={'f1_val': 0.15331085014195311, 'auprc': 0.15331085014195311, 'loss_val': 1.0782372745182323, 'psi': 0.15331085014195311}-{'f1_val': 0.1528853601859024, 'auprc': 0.1528853601859024, 'loss_val': 1.1294816044830551, 'psi': 0.1528853601859024}
[S9] START round=14 head_norm_before_train=1.637949 (no previous merge yet)
[S9] round=14 local utility u=0.016727 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3303806430224148, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.36383409226787, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.160817 cos_to_last_merge=0.9922 (last merge round=11)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.01918910554008047, 'auprc': 0.01918910554008047, 'loss_val': 3.8037176924077514, 'psi': 0.01918910554008047}-{'f1_val': 0.004117181314330958, 'auprc': 0.004117181314330958, 'loss_val': 3.6589579780655805, 'psi': 0.004117181314330958}
[S11] START round=14 head_norm_before_train=1.501387 (no previous merge yet)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2579876221602784, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8614677003048774, 'psi': 0.0}
[S13] START round=14 head_norm_before_train=1.358364 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.24050586125656948, 'auprc': 0.24050586125656948, 'loss_val': 1.0862870900465258, 'psi': 0.24050586125656948}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1178933010640026, 'psi': 0.3599362944611573}
[S14] START round=14 head_norm_before_train=1.635005 (no previous merge yet)
[S14] round=14 local utility u=0.553662 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.258530778937855, 'psi': 0.13572854291417166}-{'f1_val': 0.022111161593215203, 'auprc': 0.022111161593215203, 'loss_val': 5.343297828520354, 'psi': 0.022111161593215203}
[S15] START round=14 head_norm_before_train=1.497378 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.28304858839209984, 'auprc': 0.28304858839209984, 'loss_val': 0.9797448732549376, 'psi': 0.28304858839209984}-{'f1_val': 0.3331226295828066, 'auprc': 0.3331226295828066, 'loss_val': 0.9173921846268871, 'psi': 0.3331226295828066}
[S16] START round=14 head_norm_before_train=1.481159 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.008385744234800839, 'auprc': 0.008385744234800839, 'loss_val': 2.9428904778867415, 'psi': 0.008385744234800839}-{'f1_val': 0.016554809843400447, 'auprc': 0.016554809843400447, 'loss_val': 2.828651964639314, 'psi': 0.016554809843400447}
[S17] START round=14 head_norm_before_train=1.432947 (no previous merge yet)
[S17] round=14 local utility u=0.044727 metrics={'f1_val': 0.16182659932659932, 'auprc': 0.16182659932659932, 'loss_val': 1.291218109018167, 'psi': 0.16182659932659932}-{'f1_val': 0.1564531104921077, 'auprc': 0.1564531104921077, 'loss_val': 1.3323108162896724, 'psi': 0.1564531104921077}
[S14] not sending this round → trigger blocked (psi=0.136)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.120)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33903
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33911
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:33904
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.002)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:33902
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S9
[S10] cosine check vs S9: cos=0.6590
[S4] RECEIVED delta(kind=head bytes=1803) from S3
[S4] cosine check vs S3: cos=0.0395
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0301
[S3] DROPPED delta from S5 (cos=-0.0301 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=0.9834
[S17] not sending this round → trigger blocked (psi=0.162)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.0192 head_norm=1.206414
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.280187e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.0246 head_norm=1.310324 delta_norm=0.628019
[S10] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.0000 head_norm=1.623996
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.096291e+00
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.0000 head_norm=1.140387 delta_norm=1.096291
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.1202 head_norm=1.484737
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.379054e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.1810 head_norm=1.495590 delta_norm=0.137905
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.495590 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.343443 metrics={'f1_val': 0.18117443868739205, 'auprc': 0.18117443868739205, 'loss_val': 1.562817891786525, 'psi': 0.18117443868739205}-{'f1_val': 0.12022303821569429, 'auprc': 0.12022303821569429, 'loss_val': 1.7011421650815843, 'psi': 0.12022303821569429}
[S3] START round=15 head_norm_before_train=1.538606 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.19640765326044513, 'auprc': 0.19640765326044513, 'loss_val': 2.2769711444504317, 'psi': 0.19640765326044513}-{'f1_val': 0.26767884010395293, 'auprc': 0.26767884010395293, 'loss_val': 2.384231679954148, 'psi': 0.26767884010395293}
[S4] START round=15 head_norm_before_train=1.140387 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.207369 metrics={'f1_val': 0.023483365949119372, 'auprc': 0.023483365949119372, 'loss_val': 1.2878217224381534, 'psi': 0.023483365949119372}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.491209669248068, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.421953 (no previous merge yet)
[S5] round=15 local utility u=1.000000 metrics={'f1_val': 0.6527525134511016, 'auprc': 0.6527525134511016, 'loss_val': 1.1010589490463347, 'psi': 0.6527525134511016}-{'f1_val': 0.37377724970484955, 'auprc': 0.37377724970484955, 'loss_val': 1.1166287033893625, 'psi': 0.37377724970484955}
[S6] START round=15 head_norm_before_train=1.247714 cos_to_last_merge=0.9964 (last merge round=13)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.34678139371124, 'psi': 0.0}-{'f1_val': 0.0023820867079561697, 'auprc': 0.0023820867079561697, 'loss_val': 2.6286468762080935, 'psi': 0.0023820867079561697}
[S7] START round=15 head_norm_before_train=1.406298 (no previous merge yet)
[S7] round=15 local utility u=0.005603 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.43529582996852, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4465024373697497, 'psi': 0.0}
[S8] START round=15 head_norm_before_train=1.518937 (no previous merge yet)
[S8] round=15 local utility u=0.089372 metrics={'f1_val': 0.1638872805796517, 'auprc': 0.1638872805796517, 'loss_val': 0.9946807492110765, 'psi': 0.1638872805796517}-{'f1_val': 0.15331085014195311, 'auprc': 0.15331085014195311, 'loss_val': 1.0782372745182323, 'psi': 0.15331085014195311}
[S9] START round=15 head_norm_before_train=1.663514 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3837003787394915, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3303806430224148, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.310324 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.940647 metrics={'f1_val': 0.10723358737799171, 'auprc': 0.10723358737799171, 'loss_val': 2.7148249287846493, 'psi': 0.10723358737799171}-{'f1_val': 0.01918910554008047, 'auprc': 0.01918910554008047, 'loss_val': 3.8037176924077514, 'psi': 0.01918910554008047}
[S11] START round=15 head_norm_before_train=1.533172 (no previous merge yet)
[S11] round=15 local utility u=0.036732 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.184523790754336, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.2579876221602784, 'psi': 0.0}
[S13] START round=15 head_norm_before_train=1.383190 (no previous merge yet)
[S13] round=15 local utility u=0.537524 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0861125559049378, 'psi': 0.3599362944611573}-{'f1_val': 0.24050586125656948, 'auprc': 0.24050586125656948, 'loss_val': 1.0862870900465258, 'psi': 0.24050586125656948}
[S14] START round=15 head_norm_before_train=1.665172 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.332970035889303, 'psi': 0.13413413413413414}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.258530778937855, 'psi': 0.13572854291417166}
[S15] START round=15 head_norm_before_train=1.528075 (no previous merge yet)
[S15] round=15 local utility u=0.086332 metrics={'f1_val': 0.28540462427745666, 'auprc': 0.28540462427745666, 'loss_val': 0.8282850958952909, 'psi': 0.28540462427745666}-{'f1_val': 0.28304858839209984, 'auprc': 0.28304858839209984, 'loss_val': 0.9797448732549376, 'psi': 0.28304858839209984}
[S16] START round=15 head_norm_before_train=1.504689 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4428683920449865, 'psi': 0.0}-{'f1_val': 0.008385744234800839, 'auprc': 0.008385744234800839, 'loss_val': 2.9428904778867415, 'psi': 0.008385744234800839}
[S17] START round=15 head_norm_before_train=1.448109 (no previous merge yet)
[S17] round=15 local utility u=0.027133 metrics={'f1_val': 0.15502269587527137, 'auprc': 0.15502269587527137, 'loss_val': 1.1757163780512014, 'psi': 0.15502269587527137}-{'f1_val': 0.16182659932659932, 'auprc': 0.16182659932659932, 'loss_val': 1.291218109018167, 'psi': 0.16182659932659932}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.181)
[S4] not sending this round → trigger blocked (psi=0.023)
[S7] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:33909
[S10] not sending this round → trigger blocked (psi=0.107)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:33907
[S11] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33902
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=-0.0309
[S3] DROPPED delta from S5 (cos=-0.0309 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S15
[S8] cosine check vs S15: cos=-0.0487
[S8] DROPPED delta from S15 (cos=-0.0487 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] cosine check vs S8: cos=0.9888
[S6] RECEIVED delta(kind=head bytes=1801) from S13
[S6] cosine check vs S13: cos=0.9211
[S17] not sending this round → trigger blocked (psi=0.155)
[S10] ⇄ pheromone p=0.286 → S6@127.0.0.1:33907
[S7] ⇄ pheromone p=0.049 → S2@127.0.0.1:33902
[S4] ⇄ pheromone p=0.081 → S8@127.0.0.1:33909
[S9] ⇄ pheromone p=0.169 → S10@127.0.0.1:33911
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.0000 head_norm=1.292586
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.732248e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.0071 head_norm=1.321313 delta_norm=0.273225
[S6] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.161 → S5@127.0.0.1:33905
[S11] ⇄ pheromone p=0.107 → S4@127.0.0.1:33904
[S14] ⇄ pheromone p=0.128 → S7@127.0.0.1:33908
[S3] ⇄ pheromone p=0.214 → S4@127.0.0.1:33904
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.1812 head_norm=1.519625
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.151533e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.1783 head_norm=1.526513 delta_norm=0.115153
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.239 → S3@127.0.0.1:33903
[S5] ⇄ pheromone p=0.393 → S3@127.0.0.1:33903
[S8] ⇄ pheromone p=0.092 → S2@127.0.0.1:33902
[S13] ⇄ pheromone p=0.285 → S6@127.0.0.1:33907
[S15] ⇄ pheromone p=0.147 → S8@127.0.0.1:33909
[S16] ⇄ pheromone p=0.076 → S6@127.0.0.1:33907
[S17] ⇄ pheromone p=0.194 → S8@127.0.0.1:33909
[S2] START round=16 head_norm_before_train=1.526513 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.053828 metrics={'f1_val': 0.18347305389221558, 'auprc': 0.18347305389221558, 'loss_val': 1.4758501665977264, 'psi': 0.18347305389221558}-{'f1_val': 0.18117443868739205, 'auprc': 0.18117443868739205, 'loss_val': 1.562817891786525, 'psi': 0.18117443868739205}
[S3] START round=16 head_norm_before_train=1.574178 (no previous merge yet)
[S3] round=16 local utility u=0.285601 metrics={'f1_val': 0.26040251083931926, 'auprc': 0.26040251083931926, 'loss_val': 2.281722508780555, 'psi': 0.26040251083931926}-{'f1_val': 0.19640765326044513, 'auprc': 0.19640765326044513, 'loss_val': 2.2769711444504317, 'psi': 0.19640765326044513}
[S4] START round=16 head_norm_before_train=1.175061 cos_to_last_merge=0.9986 (last merge round=14)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3133218218086309, 'psi': 0.0}-{'f1_val': 0.023483365949119372, 'auprc': 0.023483365949119372, 'loss_val': 1.2878217224381534, 'psi': 0.023483365949119372}
[S5] START round=16 head_norm_before_train=1.447840 (no previous merge yet)
[S5] round=16 local utility u=0.060282 metrics={'f1_val': 0.6642761397086656, 'auprc': 0.6642761397086656, 'loss_val': 1.0842076822599376, 'psi': 0.6642761397086656}-{'f1_val': 0.6527525134511016, 'auprc': 0.6527525134511016, 'loss_val': 1.1010589490463347, 'psi': 0.6527525134511016}
[S6] START round=16 head_norm_before_train=1.321313 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.378716 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 2.7811453082403474, 'psi': 0.021310724106324473}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.34678139371124, 'psi': 0.0}
[S7] START round=16 head_norm_before_train=1.423376 (no previous merge yet)
[S7] round=16 local utility u=0.009320 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4166554593050573, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.43529582996852, 'psi': 0.0}
[S8] START round=16 head_norm_before_train=1.541994 (no previous merge yet)
[S8] round=16 local utility u=0.233321 metrics={'f1_val': 0.20676117466122512, 'auprc': 0.20676117466122512, 'loss_val': 0.9139047746871015, 'psi': 0.20676117466122512}-{'f1_val': 0.1638872805796517, 'auprc': 0.1638872805796517, 'loss_val': 0.9946807492110765, 'psi': 0.1638872805796517}
[S9] START round=16 head_norm_before_train=1.685992 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.456780895516806, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3837003787394915, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.345954 cos_to_last_merge=0.9977 (last merge round=14)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.10790598290598291, 'auprc': 0.10790598290598291, 'loss_val': 3.025822745519126, 'psi': 0.10790598290598291}-{'f1_val': 0.10723358737799171, 'auprc': 0.10723358737799171, 'loss_val': 2.7148249287846493, 'psi': 0.10723358737799171}
[S11] START round=16 head_norm_before_train=1.564376 (no previous merge yet)
[S11] round=16 local utility u=1.000000 metrics={'f1_val': 0.3240215004920887, 'auprc': 0.3240215004920887, 'loss_val': 1.9165920255897804, 'psi': 0.3240215004920887}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.184523790754336, 'psi': 0.0}
[S13] START round=16 head_norm_before_train=1.403659 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0911753551996846, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0861125559049378, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.695849 (no previous merge yet)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.387091134223001, 'psi': 0.13587634006482174}-{'f1_val': 0.13413413413413414, 'auprc': 0.13413413413413414, 'loss_val': 5.332970035889303, 'psi': 0.13413413413413414}
[S15] START round=16 head_norm_before_train=1.556563 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 0.903980288734858, 'psi': 0.28066325286515487}-{'f1_val': 0.28540462427745666, 'auprc': 0.28540462427745666, 'loss_val': 0.8282850958952909, 'psi': 0.28540462427745666}
[S16] START round=16 head_norm_before_train=1.529920 (no previous merge yet)
[S16] round=16 local utility u=0.817185 metrics={'f1_val': 0.11828202204484987, 'auprc': 0.11828202204484987, 'loss_val': 2.8730369380238203, 'psi': 0.11828202204484987}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.4428683920449865, 'psi': 0.0}
[S17] START round=16 head_norm_before_train=1.462610 (no previous merge yet)
[S17] round=16 local utility u=0.031979 metrics={'f1_val': 0.15520648093262202, 'auprc': 0.15520648093262202, 'loss_val': 1.1134122243241866, 'psi': 0.15520648093262202}-{'f1_val': 0.15502269587527137, 'auprc': 0.15502269587527137, 'loss_val': 1.1757163780512014, 'psi': 0.15502269587527137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:33902
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.118)
[S2] not sending this round → trigger blocked (psi=0.183)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33904
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.021)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33903
[S7] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33904
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=0.6521
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0315
[S3] DROPPED delta from S5 (cos=-0.0315 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=0.9911
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.0040
[S17] not sending this round → trigger blocked (psi=0.155)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.1835 head_norm=1.552845
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.041540e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.1861 head_norm=1.556650 delta_norm=0.104154
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.0000 head_norm=1.223801
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.222318e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.3568 head_norm=1.015897 delta_norm=0.622232
[S4] aggregate: ACCEPT kept=['S3', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.556650 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.349135 metrics={'f1_val': 0.24824162184526274, 'auprc': 0.24824162184526274, 'loss_val': 1.3604974467492734, 'psi': 0.24824162184526277}-{'f1_val': 0.18347305389221558, 'auprc': 0.18347305389221558, 'loss_val': 1.4758501665977264, 'psi': 0.18347305389221558}
[S3] START round=17 head_norm_before_train=1.606272 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.26151946448300517, 'auprc': 0.26151946448300517, 'loss_val': 2.5169501538777044, 'psi': 0.26151946448300517}-{'f1_val': 0.26040251083931926, 'auprc': 0.26040251083931926, 'loss_val': 2.281722508780555, 'psi': 0.26040251083931926}
[S4] START round=17 head_norm_before_train=1.015897 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=1.000000 metrics={'f1_val': 0.33299526707234617, 'auprc': 0.33299526707234617, 'loss_val': 1.294544380438382, 'psi': 0.33299526707234617}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3133218218086309, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.466774 (no previous merge yet)
[S5] round=17 local utility u=0.001986 metrics={'f1_val': 0.6640381114540771, 'auprc': 0.6640381114540771, 'loss_val': 1.078093089999447, 'psi': 0.6640381114540771}-{'f1_val': 0.6642761397086656, 'auprc': 0.6642761397086656, 'loss_val': 1.0842076822599376, 'psi': 0.6642761397086656}
[S6] START round=17 head_norm_before_train=1.357762 cos_to_last_merge=0.9968 (last merge round=15)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 3.18944264470299, 'psi': 0.022186642268984445}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 2.7811453082403474, 'psi': 0.021310724106324473}
[S7] START round=17 head_norm_before_train=1.441374 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.43051655622097, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4166554593050573, 'psi': 0.0}
[S8] START round=17 head_norm_before_train=1.567383 (no previous merge yet)
[S8] round=17 local utility u=0.687840 metrics={'f1_val': 0.3509170927167144, 'auprc': 0.3509170927167144, 'loss_val': 0.8356275706313341, 'psi': 0.3509170927167144}-{'f1_val': 0.20676117466122512, 'auprc': 0.20676117466122512, 'loss_val': 0.9139047746871015, 'psi': 0.20676117466122512}
[S9] START round=17 head_norm_before_train=1.705655 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5006946831254813, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.456780895516806, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.391451 cos_to_last_merge=0.9909 (last merge round=14)
[S10] round=17 local utility u=0.084077 metrics={'f1_val': 0.14235588972431076, 'auprc': 0.14235588972431076, 'loss_val': 3.167717702614473, 'psi': 0.14235588972431076}-{'f1_val': 0.10790598290598291, 'auprc': 0.10790598290598291, 'loss_val': 3.025822745519126, 'psi': 0.10790598290598291}
[S11] START round=17 head_norm_before_train=1.593101 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.3240215004920887, 'auprc': 0.3240215004920887, 'loss_val': 2.0451883080746467, 'psi': 0.3240215004920887}-{'f1_val': 0.3240215004920887, 'auprc': 0.3240215004920887, 'loss_val': 1.9165920255897804, 'psi': 0.3240215004920887}
[S13] START round=17 head_norm_before_train=1.422996 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0923406103179567, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0911753551996846, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.726217 (no previous merge yet)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.511603272188532, 'psi': 0.13572854291417166}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.387091134223001, 'psi': 0.13587634006482174}
[S15] START round=17 head_norm_before_train=1.578382 (no previous merge yet)
[S15] round=17 local utility u=0.071198 metrics={'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.7880655966134422, 'psi': 0.2836055656382335}-{'f1_val': 0.28066325286515487, 'auprc': 0.28066325286515487, 'loss_val': 0.903980288734858, 'psi': 0.28066325286515487}
[S16] START round=17 head_norm_before_train=1.554351 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.001851851851851852, 'auprc': 0.001851851851851852, 'loss_val': 3.7856159981692787, 'psi': 0.001851851851851852}-{'f1_val': 0.11828202204484987, 'auprc': 0.11828202204484987, 'loss_val': 2.8730369380238203, 'psi': 0.11828202204484987}
[S17] START round=17 head_norm_before_train=1.473848 (no previous merge yet)
[S17] round=17 local utility u=0.016625 metrics={'f1_val': 0.15291025890597626, 'auprc': 0.15291025890597626, 'loss_val': 1.059495247901165, 'psi': 0.15291025890597626}-{'f1_val': 0.15520648093262202, 'auprc': 0.15520648093262202, 'loss_val': 1.1134122243241866, 'psi': 0.15520648093262202}
[S10] not sending this round → trigger blocked (psi=0.142)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33903
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:33909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33917
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S4
[S3] cosine check vs S4: cos=0.7731
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.0347
[S6] RECEIVED delta(kind=head bytes=1800) from S5
[S6] cosine check vs S5: cos=0.0513
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.9925
[S17] not sending this round → trigger blocked (psi=0.153)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.0222 head_norm=1.401193
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.950857e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.0215 head_norm=1.047368 delta_norm=0.995086
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.2615 head_norm=1.636080
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.286894e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.2617 head_norm=1.273728 delta_norm=0.528689
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.3509 head_norm=1.596278
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.761807e-02
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.3509 head_norm=1.586798 delta_norm=0.097618
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.1529 head_norm=1.483572
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.070596e+00
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.1532 head_norm=1.108318 delta_norm=1.070596
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.583291 cos_to_last_merge=0.9987 (last merge round=16)
[S2] round=18 local utility u=0.022248 metrics={'f1_val': 0.2621902478017586, 'auprc': 0.2621902478017586, 'loss_val': 1.4415384842661034, 'psi': 0.2621902478017586}-{'f1_val': 0.24824162184526274, 'auprc': 0.24824162184526274, 'loss_val': 1.3604974467492734, 'psi': 0.24824162184526277}
[S3] START round=18 head_norm_before_train=1.273728 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.22561268620855357, 'auprc': 0.22561268620855357, 'loss_val': 2.415753450150706, 'psi': 0.22561268620855357}-{'f1_val': 0.26151946448300517, 'auprc': 0.26151946448300517, 'loss_val': 2.5169501538777044, 'psi': 0.26151946448300517}
[S4] START round=18 head_norm_before_train=1.061618 cos_to_last_merge=0.9953 (last merge round=16)
[S4] round=18 local utility u=0.001801 metrics={'f1_val': 0.33316421444275324, 'auprc': 0.33316421444275324, 'loss_val': 1.2924634858787665, 'psi': 0.33316421444275324}-{'f1_val': 0.33299526707234617, 'auprc': 0.33299526707234617, 'loss_val': 1.294544380438382, 'psi': 0.33299526707234617}
[S5] START round=18 head_norm_before_train=1.486947 (no previous merge yet)
[S5] round=18 local utility u=0.002336 metrics={'f1_val': 0.6638241754781006, 'auprc': 0.6638241754781006, 'loss_val': 1.071496497187667, 'psi': 0.6638241754781006}-{'f1_val': 0.6640381114540771, 'auprc': 0.6640381114540771, 'loss_val': 1.078093089999447, 'psi': 0.6640381114540771}
[S6] START round=18 head_norm_before_train=1.047368 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.323495 metrics={'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 2.5325945099872547, 'psi': 0.02109124254928932}-{'f1_val': 0.022186642268984445, 'auprc': 0.022186642268984445, 'loss_val': 3.18944264470299, 'psi': 0.022186642268984445}
[S7] START round=18 head_norm_before_train=1.460593 (no previous merge yet)
[S7] round=18 local utility u=0.003220 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4240763830711867, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.43051655622097, 'psi': 0.0}
[S8] START round=18 head_norm_before_train=1.586798 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.152398 metrics={'f1_val': 0.37847176039563263, 'auprc': 0.37847176039563263, 'loss_val': 0.7788229168550216, 'psi': 0.37847176039563263}-{'f1_val': 0.3509170927167144, 'auprc': 0.3509170927167144, 'loss_val': 0.8356275706313341, 'psi': 0.3509170927167144}
[S9] START round=18 head_norm_before_train=1.723143 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.530456682276915, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5006946831254813, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.433558 cos_to_last_merge=0.9828 (last merge round=14)
[S10] round=18 local utility u=0.180144 metrics={'f1_val': 0.1827434651862133, 'auprc': 0.1827434651862133, 'loss_val': 3.170917742714049, 'psi': 0.1827434651862133}-{'f1_val': 0.14235588972431076, 'auprc': 0.14235588972431076, 'loss_val': 3.167717702614473, 'psi': 0.14235588972431076}
[S11] START round=18 head_norm_before_train=1.618922 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.29093626851474386, 'auprc': 0.29093626851474386, 'loss_val': 1.9915085108982042, 'psi': 0.29093626851474386}-{'f1_val': 0.3240215004920887, 'auprc': 0.3240215004920887, 'loss_val': 2.0451883080746467, 'psi': 0.3240215004920887}
[S13] START round=18 head_norm_before_train=1.444467 (no previous merge yet)
[S13] round=18 local utility u=0.000380 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0915805368218185, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0923406103179567, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.753886 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.619081268625549, 'psi': 0.1351317597102535}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.511603272188532, 'psi': 0.13572854291417166}
[S15] START round=18 head_norm_before_train=1.600443 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.28122717311906503, 'auprc': 0.28122717311906503, 'loss_val': 0.8313435404882608, 'psi': 0.28122717311906503}-{'f1_val': 0.2836055656382335, 'auprc': 0.2836055656382335, 'loss_val': 0.7880655966134422, 'psi': 0.2836055656382335}
[S16] START round=18 head_norm_before_train=1.578291 (no previous merge yet)
[S16] round=18 local utility u=0.920946 metrics={'f1_val': 0.13583517292126565, 'auprc': 0.13583517292126565, 'loss_val': 3.1495742682979384, 'psi': 0.13583517292126565}-{'f1_val': 0.001851851851851852, 'auprc': 0.001851851851851852, 'loss_val': 3.7856159981692787, 'psi': 0.001851851851851852}
[S17] START round=18 head_norm_before_train=1.108318 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.15725725725725725, 'auprc': 0.15725725725725725, 'loss_val': 1.1608683225407221, 'psi': 0.15725725725725725}-{'f1_val': 0.15291025890597626, 'auprc': 0.15291025890597626, 'loss_val': 1.059495247901165, 'psi': 0.15291025890597626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:33909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33917
[S10] not sending this round → trigger blocked (psi=0.183)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33903
[S16] not sending this round → trigger blocked (psi=0.136)
[S7] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.021)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S5
[S6] cosine check vs S5: cos=0.7168
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.7245
[S3] RECEIVED delta(kind=head bytes=1803) from S4
[S3] cosine check vs S4: cos=0.8836
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] cosine check vs S2: cos=0.9940
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.2256 head_norm=1.308019
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.066645e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.2173 head_norm=1.179836 delta_norm=0.306664
[S3] aggregate: ROLLBACK (f1_val pre=0.226 post=0.217 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.0211 head_norm=1.083140
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.249974e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.0019 head_norm=1.201932 delta_norm=0.524997
[S6] aggregate: ROLLBACK (f1_val pre=0.021 post=0.002 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.3785 head_norm=1.617911
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.819782e-02
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.3747 head_norm=1.611850 delta_norm=0.088198
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.1573 head_norm=1.142132
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.577841e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.1572 head_norm=1.284495 delta_norm=0.557784
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.610604 cos_to_last_merge=0.9957 (last merge round=16)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 1.490990525505551, 'psi': 0.2654773703336637}-{'f1_val': 0.2621902478017586, 'auprc': 0.2621902478017586, 'loss_val': 1.4415384842661034, 'psi': 0.2621902478017586}
[S3] START round=19 head_norm_before_train=1.179836 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.414370 metrics={'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 1.913851554147183, 'psi': 0.26192800885243767}-{'f1_val': 0.22561268620855357, 'auprc': 0.22561268620855357, 'loss_val': 2.415753450150706, 'psi': 0.22561268620855357}
[S4] START round=19 head_norm_before_train=1.123031 cos_to_last_merge=0.9821 (last merge round=16)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.33274276554458787, 'auprc': 0.33274276554458787, 'loss_val': 1.2949858447283276, 'psi': 0.33274276554458787}-{'f1_val': 0.33316421444275324, 'auprc': 0.33316421444275324, 'loss_val': 1.2924634858787665, 'psi': 0.33316421444275324}
[S5] START round=19 head_norm_before_train=1.505766 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.2508839708387825, 'auprc': 0.2508839708387825, 'loss_val': 1.093415448549126, 'psi': 0.2508839708387825}-{'f1_val': 0.6638241754781006, 'auprc': 0.6638241754781006, 'loss_val': 1.071496497187667, 'psi': 0.6638241754781006}
[S6] START round=19 head_norm_before_train=1.201932 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.008239171374764594, 'auprc': 0.008239171374764594, 'loss_val': 2.4191617496734144, 'psi': 0.008239171374764594}-{'f1_val': 0.02109124254928932, 'auprc': 0.02109124254928932, 'loss_val': 2.5325945099872547, 'psi': 0.02109124254928932}
[S7] START round=19 head_norm_before_train=1.479085 (no previous merge yet)
[S7] round=19 local utility u=0.010620 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4028365499125905, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4240763830711867, 'psi': 0.0}
[S8] START round=19 head_norm_before_train=1.611850 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.186821 metrics={'f1_val': 0.4146309634783664, 'auprc': 0.4146309634783664, 'loss_val': 0.730613714776037, 'psi': 0.4146309634783664}-{'f1_val': 0.37847176039563263, 'auprc': 0.37847176039563263, 'loss_val': 0.7788229168550216, 'psi': 0.37847176039563263}
[S9] START round=19 head_norm_before_train=1.738313 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.556597583793107, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.530456682276915, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.470124 cos_to_last_merge=0.9754 (last merge round=14)
[S10] round=19 local utility u=0.259246 metrics={'f1_val': 0.21370574861968172, 'auprc': 0.21370574861968172, 'loss_val': 2.931086744055352, 'psi': 0.21370574861968172}-{'f1_val': 0.1827434651862133, 'auprc': 0.1827434651862133, 'loss_val': 3.170917742714049, 'psi': 0.1827434651862133}
[S11] START round=19 head_norm_before_train=1.641134 (no previous merge yet)
[S11] round=19 local utility u=0.022711 metrics={'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.242491614415058, 'psi': 0.32387008857597094}-{'f1_val': 0.29093626851474386, 'auprc': 0.29093626851474386, 'loss_val': 1.9915085108982042, 'psi': 0.29093626851474386}
[S13] START round=19 head_norm_before_train=1.468530 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1040931635314375, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0915805368218185, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.779487 (no previous merge yet)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.7102600857169135, 'psi': 0.13572854291417166}-{'f1_val': 0.1351317597102535, 'auprc': 0.1351317597102535, 'loss_val': 5.619081268625549, 'psi': 0.1351317597102535}
[S15] START round=19 head_norm_before_train=1.619837 (no previous merge yet)
[S15] round=19 local utility u=0.365568 metrics={'f1_val': 0.3572500605180344, 'auprc': 0.3572500605180344, 'loss_val': 0.7844133577137442, 'psi': 0.3572500605180344}-{'f1_val': 0.28122717311906503, 'auprc': 0.28122717311906503, 'loss_val': 0.8313435404882608, 'psi': 0.28122717311906503}
[S16] START round=19 head_norm_before_train=1.602067 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.06559839759639459, 'auprc': 0.06559839759639459, 'loss_val': 3.8966334797074085, 'psi': 0.06559839759639459}-{'f1_val': 0.13583517292126565, 'auprc': 0.13583517292126565, 'loss_val': 3.1495742682979384, 'psi': 0.13583517292126565}
[S17] START round=19 head_norm_before_train=1.284495 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.15320850399843963, 'auprc': 0.15320850399843963, 'loss_val': 1.1772385918205592, 'psi': 0.15320850399843963}-{'f1_val': 0.15725725725725725, 'auprc': 0.15725725725725725, 'loss_val': 1.1608683225407221, 'psi': 0.15725725725725725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:33910
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:33905
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=-0.0280
[S5] DROPPED delta from S3 (cos=-0.0280 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=0.8481
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.9273
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.008 u=0.0000 p_local=0.1563 f1=0.008 auprc=0.008 bytes=0
[S7] r=20 psi=0.000 u=0.0106 p_local=0.0237 f1=0.000 auprc=0.000 bytes=0
[S4] r=20 psi=0.333 u=0.0000 p_local=0.1613 f1=0.333 auprc=0.333 bytes=3606
[S14] r=20 psi=0.136 u=0.0000 p_local=0.0525 f1=0.136 auprc=0.136 bytes=0
[S15] r=20 psi=0.357 u=0.3656 p_local=0.1425 f1=0.357 auprc=0.357 bytes=12619
[S11] r=20 psi=0.324 u=0.0227 p_local=0.1508 f1=0.324 auprc=0.324 bytes=3595
[S5] r=20 psi=0.251 u=0.0000 p_local=0.1679 f1=0.251 auprc=0.251 bytes=16180
[S13] r=20 psi=0.360 u=0.0000 p_local=0.1166 f1=0.360 auprc=0.360 bytes=8988
[S2] r=20 psi=0.265 u=0.0000 p_local=0.1518 f1=0.265 auprc=0.265 bytes=3596
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.3687 head_norm=1.751993
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.642521e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.3687 head_norm=1.563555 delta_norm=0.464252
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0690 f1=0.369 auprc=0.369 bytes=3600
[S3] r=20 psi=0.262 u=0.4144 p_local=0.1997 f1=0.262 auprc=0.262 bytes=5404
[S8] r=20 psi=0.415 u=0.1868 p_local=0.2115 f1=0.415 auprc=0.415 bytes=21591
[S10] r=20 psi=0.214 u=0.2592 p_local=0.2087 f1=0.214 auprc=0.214 bytes=1797
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.1532 head_norm=1.320482
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.249892e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.1527 head_norm=1.456558 delta_norm=0.324989
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.153 u=0.0000 p_local=0.0847 f1=0.153 auprc=0.153 bytes=0
[S16] r=20 psi=0.066 u=0.0000 p_local=0.2621 f1=0.066 auprc=0.066 bytes=0
[S2] START round=20 head_norm_before_train=1.636614 cos_to_last_merge=0.9923 (last merge round=16)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.2633372656966837, 'auprc': 0.2633372656966837, 'loss_val': 1.5536961299713172, 'psi': 0.2633372656966837}-{'f1_val': 0.2654773703336637, 'auprc': 0.2654773703336637, 'loss_val': 1.490990525505551, 'psi': 0.2654773703336637}
[S3] START round=20 head_norm_before_train=1.216236 cos_to_last_merge=0.9991 (last merge round=18)
[S3] round=20 local utility u=0.003623 metrics={'f1_val': 0.2614175274475411, 'auprc': 0.2614175274475411, 'loss_val': 1.9020110915818433, 'psi': 0.2614175274475411}-{'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 1.913851554147183, 'psi': 0.26192800885243767}
[S4] START round=20 head_norm_before_train=1.189098 cos_to_last_merge=0.9659 (last merge round=16)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.33324883819180395, 'auprc': 0.33324883819180395, 'loss_val': 1.3115139213154066, 'psi': 0.33324883819180395}-{'f1_val': 0.33274276554458787, 'auprc': 0.33274276554458787, 'loss_val': 1.2949858447283276, 'psi': 0.33274276554458787}
[S5] START round=20 head_norm_before_train=1.524856 (no previous merge yet)
[S5] round=20 local utility u=0.346886 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.147775050629843, 'psi': 0.33400978131092857}-{'f1_val': 0.2508839708387825, 'auprc': 0.2508839708387825, 'loss_val': 1.093415448549126, 'psi': 0.2508839708387825}
[S6] START round=20 head_norm_before_train=1.224113 cos_to_last_merge=0.9961 (last merge round=18)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 2.9802532250115252, 'psi': 0.021310724106324473}-{'f1_val': 0.008239171374764594, 'auprc': 0.008239171374764594, 'loss_val': 2.4191617496734144, 'psi': 0.008239171374764594}
[S7] START round=20 head_norm_before_train=1.495546 (no previous merge yet)
[S7] round=20 local utility u=0.464642 metrics={'f1_val': 0.10007047216349542, 'auprc': 0.10007047216349542, 'loss_val': 1.3741862189016534, 'psi': 0.10007047216349542}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4028365499125905, 'psi': 0.0}
[S8] START round=20 head_norm_before_train=1.646417 cos_to_last_merge=0.9996 (last merge round=18)
[S8] round=20 local utility u=0.451968 metrics={'f1_val': 0.5083621761782681, 'auprc': 0.5083621761782681, 'loss_val': 0.670259597969331, 'psi': 0.5083621761782681}-{'f1_val': 0.4146309634783664, 'auprc': 0.4146309634783664, 'loss_val': 0.730613714776037, 'psi': 0.4146309634783664}
[S9] START round=20 head_norm_before_train=1.563555 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.160064 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.236470292369929, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.556597583793107, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.500330 cos_to_last_merge=0.9692 (last merge round=14)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.19802867383512546, 'auprc': 0.19802867383512546, 'loss_val': 3.256268554689731, 'psi': 0.19802867383512546}-{'f1_val': 0.21370574861968172, 'auprc': 0.21370574861968172, 'loss_val': 2.931086744055352, 'psi': 0.21370574861968172}
[S11] START round=20 head_norm_before_train=1.661794 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.3226244343891403, 'auprc': 0.3226244343891403, 'loss_val': 2.258991237040974, 'psi': 0.3226244343891403}-{'f1_val': 0.32387008857597094, 'auprc': 0.32387008857597094, 'loss_val': 2.242491614415058, 'psi': 0.32387008857597094}
[S13] START round=20 head_norm_before_train=1.490964 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1375685437617895, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1040931635314375, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.801891 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.79825274864779, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.7102600857169135, 'psi': 0.13572854291417166}
[S15] START round=20 head_norm_before_train=1.639063 (no previous merge yet)
[S15] round=20 local utility u=1.000000 metrics={'f1_val': 0.6159312895161951, 'auprc': 0.6159312895161951, 'loss_val': 0.7197180360599703, 'psi': 0.6159312895161951}-{'f1_val': 0.3572500605180344, 'auprc': 0.3572500605180344, 'loss_val': 0.7844133577137442, 'psi': 0.3572500605180344}
[S16] START round=20 head_norm_before_train=1.625902 (no previous merge yet)
[S16] round=20 local utility u=0.220986 metrics={'f1_val': 0.09616449189402926, 'auprc': 0.09616449189402926, 'loss_val': 3.7297565194766324, 'psi': 0.09616449189402926}-{'f1_val': 0.06559839759639459, 'auprc': 0.06559839759639459, 'loss_val': 3.8966334797074085, 'psi': 0.06559839759639459}
[S17] START round=20 head_norm_before_train=1.456558 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.010800 metrics={'f1_val': 0.15517581983405768, 'auprc': 0.15517581983405768, 'loss_val': 1.1733450865644581, 'psi': 0.15517581983405768}-{'f1_val': 0.15320850399843963, 'auprc': 0.15320850399843963, 'loss_val': 1.1772385918205592, 'psi': 0.15320850399843963}
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.155)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.096)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:33907
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.100)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:33917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:33905
[S10] ⇄ pheromone p=0.167 → S9@127.0.0.1:33910
[S7] ⇄ pheromone p=0.112 → S14@127.0.0.1:33914
[S8] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S5
[S6] cosine check vs S5: cos=0.9021
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9662
[S5] RECEIVED delta(kind=head bytes=1796) from S3
[S5] cosine check vs S3: cos=-0.0281
[S5] DROPPED delta from S3 (cos=-0.0281 < 0.0)
[S5] ⇄ pheromone p=0.204 → S6@127.0.0.1:33907
[S3] ⇄ pheromone p=0.161 → S5@127.0.0.1:33905
[S2] ⇄ pheromone p=0.121 → S8@127.0.0.1:33909
[S4] ⇄ pheromone p=0.129 → S3@127.0.0.1:33903
[S6] CommDone barrier timeout: have=1 need=2 — continuing
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.0213 head_norm=1.258343
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.411669e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.0000 head_norm=1.368962 delta_norm=0.341167
[S6] aggregate: ROLLBACK (f1_val pre=0.021 post=0.000 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.125 → S10@127.0.0.1:33911
[S8] CommDone barrier timeout: have=1 need=2 — continuing
[S8] ⇄ pheromone p=0.260 → S17@127.0.0.1:33917
[S2] START round=21 head_norm_before_train=1.664036 cos_to_last_merge=0.9888 (last merge round=16)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 1.6664747152265038, 'psi': 0.26542475888492534}-{'f1_val': 0.2633372656966837, 'auprc': 0.2633372656966837, 'loss_val': 1.5536961299713172, 'psi': 0.2633372656966837}
[S3] START round=21 head_norm_before_train=1.248076 cos_to_last_merge=0.9973 (last merge round=18)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.26419801720175956, 'auprc': 0.26419801720175956, 'loss_val': 2.0147704213411486, 'psi': 0.26419801720175956}-{'f1_val': 0.2614175274475411, 'auprc': 0.2614175274475411, 'loss_val': 1.9020110915818433, 'psi': 0.2614175274475411}
[S4] START round=21 head_norm_before_train=1.249073 cos_to_last_merge=0.9516 (last merge round=16)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.3329112855575251, 'auprc': 0.3329112855575251, 'loss_val': 1.3264160504562683, 'psi': 0.3329112855575251}-{'f1_val': 0.33324883819180395, 'auprc': 0.33324883819180395, 'loss_val': 1.3115139213154066, 'psi': 0.33324883819180395}
[S5] START round=21 head_norm_before_train=1.548379 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5116604929948467, 'psi': 0.33400978131092857}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.147775050629843, 'psi': 0.33400978131092857}
[S6] START round=21 head_norm_before_train=1.368962 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.259824 metrics={'f1_val': 0.04547432550043516, 'auprc': 0.04547432550043516, 'loss_val': 2.6780771537811505, 'psi': 0.04547432550043516}-{'f1_val': 0.021310724106324473, 'auprc': 0.021310724106324473, 'loss_val': 2.9802532250115252, 'psi': 0.021310724106324473}
[S7] START round=21 head_norm_before_train=1.511605 (no previous merge yet)
[S7] round=21 local utility u=0.419633 metrics={'f1_val': 0.19162319729978522, 'auprc': 0.19162319729978522, 'loss_val': 1.3588948187056116, 'psi': 0.19162319729978522}-{'f1_val': 0.10007047216349542, 'auprc': 0.10007047216349542, 'loss_val': 1.3741862189016534, 'psi': 0.10007047216349542}
[S8] START round=21 head_norm_before_train=1.680076 cos_to_last_merge=0.9982 (last merge round=18)
[S8] round=21 local utility u=0.728167 metrics={'f1_val': 0.6660046342270771, 'auprc': 0.6660046342270771, 'loss_val': 0.6327072811677303, 'psi': 0.6660046342270771}-{'f1_val': 0.5083621761782681, 'auprc': 0.5083621761782681, 'loss_val': 0.670259597969331, 'psi': 0.5083621761782681}
[S9] START round=21 head_norm_before_train=1.578780 cos_to_last_merge=0.9999 (last merge round=19)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.283954589047035, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.236470292369929, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=1.525781 cos_to_last_merge=0.9640 (last merge round=14)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.17419962335216574, 'auprc': 0.17419962335216574, 'loss_val': 3.438018144840349, 'psi': 0.17419962335216574}-{'f1_val': 0.19802867383512546, 'auprc': 0.19802867383512546, 'loss_val': 3.256268554689731, 'psi': 0.19802867383512546}
[S11] START round=21 head_norm_before_train=1.682754 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.32204155374887083, 'auprc': 0.32204155374887083, 'loss_val': 2.344364015981181, 'psi': 0.32204155374887083}-{'f1_val': 0.3226244343891403, 'auprc': 0.3226244343891403, 'loss_val': 2.258991237040974, 'psi': 0.3226244343891403}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=21 head_norm_before_train=1.510600 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1555205278547427, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1375685437617895, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.821252 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.882486155431311, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.79825274864779, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=21 head_norm_before_train=1.663151 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6135507681776878, 'auprc': 0.6135507681776878, 'loss_val': 0.8153761603035145, 'psi': 0.6135507681776878}-{'f1_val': 0.6159312895161951, 'auprc': 0.6159312895161951, 'loss_val': 0.7197180360599703, 'psi': 0.6159312895161951}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.649422 (no previous merge yet)
[S16] round=21 local utility u=0.231050 metrics={'f1_val': 0.13513115237253168, 'auprc': 0.13513115237253168, 'loss_val': 3.6183572038689937, 'psi': 0.13513115237253168}-{'f1_val': 0.09616449189402926, 'auprc': 0.09616449189402926, 'loss_val': 3.7297565194766324, 'psi': 0.09616449189402926}
[S16] not sending this round → trigger blocked (psi=0.135)
[S17] START round=21 head_norm_before_train=1.490992 cos_to_last_merge=0.9949 (last merge round=19)
[S17] round=21 local utility u=0.257369 metrics={'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 1.0901858154710053, 'psi': 0.2031290405999483}-{'f1_val': 0.15517581983405768, 'auprc': 0.15517581983405768, 'loss_val': 1.1733450865644581, 'psi': 0.15517581983405768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.2031 head_norm=1.535467
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.795199e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.2031 head_norm=1.584938 delta_norm=0.279520
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.192)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5]  timeout peer S6
[S8]  timeout peer S4
[S8]  timeout peer S15
[S8]  timeout peer S17
[S2]  timeout peer S7
[S2]  timeout peer S8
[S10]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S16
[S3]  timeout peer S2
[S3]  timeout peer S5
[S4]  timeout peer S3
[S4]  timeout peer S11
[S7]  timeout peer S14
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.045)
[S2] START round=22 head_norm_before_train=1.691991 cos_to_last_merge=0.9851 (last merge round=16)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.2650046168051708, 'auprc': 0.2650046168051708, 'loss_val': 1.7403098069003282, 'psi': 0.2650046168051708}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 1.6664747152265038, 'psi': 0.26542475888492534}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=1.284444 cos_to_last_merge=0.9945 (last merge round=18)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.2616725191832488, 'auprc': 0.2616725191832488, 'loss_val': 2.0482072912396063, 'psi': 0.2616725191832488}-{'f1_val': 0.26419801720175956, 'auprc': 0.26419801720175956, 'loss_val': 2.0147704213411486, 'psi': 0.26419801720175956}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.297909 cos_to_last_merge=0.9406 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=22 local utility u=0.111069 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3192214428576445, 'psi': 0.3567939207526687}-{'f1_val': 0.3329112855575251, 'auprc': 0.3329112855575251, 'loss_val': 1.3264160504562683, 'psi': 0.3329112855575251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=22 head_norm_before_train=1.575049 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0664274715182915, 'psi': 0.33358943696313936}-{'f1_val': 0.33400978131092857, 'auprc': 0.33400978131092857, 'loss_val': 1.5116604929948467, 'psi': 0.33400978131092857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.393297 cos_to_last_merge=0.9970 (last merge round=20)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.03453654188948307, 'auprc': 0.03453654188948307, 'loss_val': 3.1833389366853577, 'psi': 0.03453654188948307}-{'f1_val': 0.04547432550043516, 'auprc': 0.04547432550043516, 'loss_val': 2.6780771537811505, 'psi': 0.04547432550043516}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=1.527301 (no previous merge yet)
[S7] round=22 local utility u=0.294883 metrics={'f1_val': 0.24843554443053817, 'auprc': 0.24843554443053817, 'loss_val': 1.2804401952404108, 'psi': 0.24843554443053817}-{'f1_val': 0.19162319729978522, 'auprc': 0.19162319729978522, 'loss_val': 1.3588948187056116, 'psi': 0.19162319729978522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=22 head_norm_before_train=1.710224 cos_to_last_merge=0.9965 (last merge round=18)
[S8] round=22 local utility u=0.017619 metrics={'f1_val': 0.6662077201182681, 'auprc': 0.6662077201182681, 'loss_val': 0.5992963211953841, 'psi': 0.6662077201182681}-{'f1_val': 0.6660046342270771, 'auprc': 0.6660046342270771, 'loss_val': 0.6327072811677303, 'psi': 0.6660046342270771}
[S8] not sending this round → trigger blocked (psi=0.666)
[S9] START round=22 head_norm_before_train=1.597141 cos_to_last_merge=0.9997 (last merge round=19)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.328830521518942, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.283954589047035, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.548105 cos_to_last_merge=0.9595 (last merge round=14)
[S10] round=22 local utility u=0.725763 metrics={'f1_val': 0.2700037921880925, 'auprc': 0.2700037921880925, 'loss_val': 2.8487304555804003, 'psi': 0.2700037921880925}-{'f1_val': 0.17419962335216574, 'auprc': 0.17419962335216574, 'loss_val': 3.438018144840349, 'psi': 0.17419962335216574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=22 head_norm_before_train=1.707813 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.471244696358706, 'psi': 0.3237230419977299}-{'f1_val': 0.32204155374887083, 'auprc': 0.32204155374887083, 'loss_val': 2.344364015981181, 'psi': 0.32204155374887083}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=22 head_norm_before_train=1.526834 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1849605663245897, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1555205278547427, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.837858 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.962482066921846, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.882486155431311, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=1.682936 (no previous merge yet)
[S15] round=22 local utility u=0.032785 metrics={'f1_val': 0.616497374010058, 'auprc': 0.616497374010058, 'loss_val': 0.776325183027298, 'psi': 0.616497374010058}-{'f1_val': 0.6135507681776878, 'auprc': 0.6135507681776878, 'loss_val': 0.8153761603035145, 'psi': 0.6135507681776878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=22 head_norm_before_train=1.670478 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.09319338422391858, 'auprc': 0.09319338422391858, 'loss_val': 3.942704831171807, 'psi': 0.09319338422391858}-{'f1_val': 0.13513115237253168, 'auprc': 0.13513115237253168, 'loss_val': 3.6183572038689937, 'psi': 0.13513115237253168}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.584938 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.15638064901453314, 'auprc': 0.15638064901453314, 'loss_val': 1.0873041513641288, 'psi': 0.15638064901453314}-{'f1_val': 0.2031290405999483, 'auprc': 0.2031290405999483, 'loss_val': 1.0901858154710053, 'psi': 0.2031290405999483}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.717265 cos_to_last_merge=0.9818 (last merge round=16)
[S2] round=23 local utility u=0.400492 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.861581627355461, 'psi': 0.3674775928297055}-{'f1_val': 0.2650046168051708, 'auprc': 0.2650046168051708, 'loss_val': 1.7403098069003282, 'psi': 0.2650046168051708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=23 head_norm_before_train=1.325022 cos_to_last_merge=0.9907 (last merge round=18)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.2618257531394365, 'auprc': 0.2618257531394365, 'loss_val': 2.129141569770039, 'psi': 0.2618257531394365}-{'f1_val': 0.2616725191832488, 'auprc': 0.2616725191832488, 'loss_val': 2.0482072912396063, 'psi': 0.2616725191832488}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.340027 cos_to_last_merge=0.9317 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.932
[S4] round=23 local utility u=0.008584 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.302054273738462, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3192214428576445, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=23 head_norm_before_train=1.603215 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.478453106754457, 'psi': 0.33358943696313936}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.0664274715182915, 'psi': 0.33358943696313936}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=1.429941 cos_to_last_merge=0.9888 (last merge round=20)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.024362477231329692, 'auprc': 0.024362477231329692, 'loss_val': 3.674891429818137, 'psi': 0.024362477231329692}-{'f1_val': 0.03453654188948307, 'auprc': 0.03453654188948307, 'loss_val': 3.1833389366853577, 'psi': 0.03453654188948307}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.540682 (no previous merge yet)
[S7] round=23 local utility u=0.409895 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 1.2232389265070054, 'psi': 0.33316757831924415}-{'f1_val': 0.24843554443053817, 'auprc': 0.24843554443053817, 'loss_val': 1.2804401952404108, 'psi': 0.24843554443053817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=23 head_norm_before_train=1.742262 cos_to_last_merge=0.9947 (last merge round=18)
[S8] round=23 local utility u=1.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.5682586335264288, 'psi': 0.9988708350860451}-{'f1_val': 0.6662077201182681, 'auprc': 0.6662077201182681, 'loss_val': 0.5992963211953841, 'psi': 0.6662077201182681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=23 head_norm_before_train=1.614531 cos_to_last_merge=0.9994 (last merge round=19)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3760280970944807, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.328830521518942, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=1.567675 cos_to_last_merge=0.9555 (last merge round=14)
[S10] round=23 local utility u=0.056986 metrics={'f1_val': 0.2715769593956563, 'auprc': 0.2715769593956563, 'loss_val': 2.7489161939968536, 'psi': 0.2715769593956563}-{'f1_val': 0.2700037921880925, 'auprc': 0.2700037921880925, 'loss_val': 2.8487304555804003, 'psi': 0.2700037921880925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=23 head_norm_before_train=1.733983 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.610382086119438, 'psi': 0.3240172688025449}-{'f1_val': 0.3237230419977299, 'auprc': 0.3237230419977299, 'loss_val': 2.471244696358706, 'psi': 0.3237230419977299}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=1.544610 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2355369232421711, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1849605663245897, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.852180 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 6.03442663153236, 'psi': 0.1355297641332834}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.962482066921846, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=1.705161 (no previous merge yet)
[S15] round=23 local utility u=0.023901 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.7290428899536455, 'psi': 0.6165550083006743}-{'f1_val': 0.616497374010058, 'auprc': 0.616497374010058, 'loss_val': 0.776325183027298, 'psi': 0.616497374010058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=23 head_norm_before_train=1.689863 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.08530882115787776, 'auprc': 0.08530882115787776, 'loss_val': 4.360572559750175, 'psi': 0.08530882115787776}-{'f1_val': 0.09319338422391858, 'auprc': 0.09319338422391858, 'loss_val': 3.942704831171807, 'psi': 0.09319338422391858}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=1.617815 cos_to_last_merge=0.9973 (last merge round=21)
[S17] round=23 local utility u=0.237948 metrics={'f1_val': 0.2036151567073606, 'auprc': 0.2036151567073606, 'loss_val': 1.0365184336524005, 'psi': 0.2036151567073606}-{'f1_val': 0.15638064901453314, 'auprc': 0.15638064901453314, 'loss_val': 1.0873041513641288, 'psi': 0.15638064901453314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=24 head_norm_before_train=1.740747 cos_to_last_merge=0.9789 (last merge round=16)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.24592973436161095, 'auprc': 0.24592973436161095, 'loss_val': 1.891385140350081, 'psi': 0.24592973436161095}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 1.861581627355461, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=1.365234 cos_to_last_merge=0.9864 (last merge round=18)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 2.2104749257887555, 'psi': 0.26192800885243767}-{'f1_val': 0.2618257531394365, 'auprc': 0.2618257531394365, 'loss_val': 2.129141569770039, 'psi': 0.2618257531394365}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=1.374702 cos_to_last_merge=0.9250 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=24 local utility u=0.008525 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2850049510259804, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.302054273738462, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=24 head_norm_before_train=1.631049 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.621344737564273, 'psi': 0.33308623671855697}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.478453106754457, 'psi': 0.33358943696313936}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.470501 cos_to_last_merge=0.9784 (last merge round=20)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 4.080602121646869, 'psi': 0.021967963386727688}-{'f1_val': 0.024362477231329692, 'auprc': 0.024362477231329692, 'loss_val': 3.674891429818137, 'psi': 0.024362477231329692}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.556149 (no previous merge yet)
[S7] round=24 local utility u=0.019319 metrics={'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 1.1846013660265426, 'psi': 0.33316757831924415}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 1.2232389265070054, 'psi': 0.33316757831924415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=24 head_norm_before_train=1.774124 cos_to_last_merge=0.9927 (last merge round=18)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.5687341262068137, 'psi': 0.9988708350860451}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.5682586335264288, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=1.631362 cos_to_last_merge=0.9989 (last merge round=19)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4260175188763955, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3760280970944807, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.586964 cos_to_last_merge=0.9519 (last merge round=14)
[S10] round=24 local utility u=0.161943 metrics={'f1_val': 0.29084703134824397, 'auprc': 0.29084703134824397, 'loss_val': 2.598461110357433, 'psi': 0.29084703134824397}-{'f1_val': 0.2715769593956563, 'auprc': 0.2715769593956563, 'loss_val': 2.7489161939968536, 'psi': 0.2715769593956563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=24 head_norm_before_train=1.758879 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.676997308891859, 'psi': 0.3240172688025449}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.610382086119438, 'psi': 0.3240172688025449}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=1.560302 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.282272734240592, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2355369232421711, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.865252 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 6.097699040952606, 'psi': 0.13493253373313344}-{'f1_val': 0.1355297641332834, 'auprc': 0.1355297641332834, 'loss_val': 6.03442663153236, 'psi': 0.1355297641332834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=1.730879 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7444991304758775, 'psi': 0.6164158146233559}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.7290428899536455, 'psi': 0.6165550083006743}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=1.706156 (no previous merge yet)
[S16] round=24 local utility u=0.522451 metrics={'f1_val': 0.14013575651412305, 'auprc': 0.14013575651412305, 'loss_val': 3.8091132809372588, 'psi': 0.14013575651412305}-{'f1_val': 0.08530882115787776, 'auprc': 0.08530882115787776, 'loss_val': 4.360572559750175, 'psi': 0.08530882115787776}
[S16] not sending this round → trigger blocked (psi=0.140)
[S17] START round=24 head_norm_before_train=1.655675 cos_to_last_merge=0.9911 (last merge round=21)
[S17] round=24 local utility u=0.028193 metrics={'f1_val': 0.20492555643094312, 'auprc': 0.20492555643094312, 'loss_val': 0.9919262861375673, 'psi': 0.20492555643094312}-{'f1_val': 0.2036151567073606, 'auprc': 0.2036151567073606, 'loss_val': 1.0365184336524005, 'psi': 0.2036151567073606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=25 head_norm_before_train=1.762126 cos_to_last_merge=0.9764 (last merge round=16)
[S2] round=25 local utility u=0.054743 metrics={'f1_val': 0.2641683103221565, 'auprc': 0.2641683103221565, 'loss_val': 1.9460468733733294, 'psi': 0.2641683103221565}-{'f1_val': 0.24592973436161095, 'auprc': 0.24592973436161095, 'loss_val': 1.891385140350081, 'psi': 0.24592973436161095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=25 head_norm_before_train=1.401683 cos_to_last_merge=0.9821 (last merge round=18)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.27094628786235814, 'auprc': 0.27094628786235814, 'loss_val': 2.43715746595428, 'psi': 0.27094628786235814}-{'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 2.2104749257887555, 'psi': 0.26192800885243767}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.402318 cos_to_last_merge=0.9200 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=25 local utility u=0.006209 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2725875847289225, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2850049510259804, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=25 head_norm_before_train=1.658416 (no previous merge yet)
[S5] round=25 local utility u=0.123765 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.3738150192740535, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.621344737564273, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=25 head_norm_before_train=1.508535 cos_to_last_merge=0.9682 (last merge round=20)
[S6] round=25 local utility u=0.123396 metrics={'f1_val': 0.061686949223667645, 'auprc': 0.061686949223667645, 'loss_val': 4.191281320410587, 'psi': 0.061686949223667645}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 4.080602121646869, 'psi': 0.021967963386727688}
[S6] not sending this round → trigger blocked (psi=0.062)
[S7] START round=25 head_norm_before_train=1.573203 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.24881516587677724, 'auprc': 0.24881516587677724, 'loss_val': 1.1482712674850803, 'psi': 0.24881516587677724}-{'f1_val': 0.33316757831924415, 'auprc': 0.33316757831924415, 'loss_val': 1.1846013660265426, 'psi': 0.33316757831924415}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=1.803391 cos_to_last_merge=0.9909 (last merge round=18)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5997411527266906, 'psi': 0.35939447907390915}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.5687341262068137, 'psi': 0.9988708350860451}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=1.647832 cos_to_last_merge=0.9984 (last merge round=19)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4734306250200566, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4260175188763955, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.605198 cos_to_last_merge=0.9485 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=25 local utility u=0.295493 metrics={'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 2.383384513636274, 'psi': 0.33261477045908183}-{'f1_val': 0.29084703134824397, 'auprc': 0.29084703134824397, 'loss_val': 2.598461110357433, 'psi': 0.29084703134824397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=25 head_norm_before_train=1.781166 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.3243817326657563, 'auprc': 0.3243817326657563, 'loss_val': 2.782733683019344, 'psi': 0.3243817326657563}-{'f1_val': 0.3240172688025449, 'auprc': 0.3240172688025449, 'loss_val': 2.676997308891859, 'psi': 0.3240172688025449}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.577903 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.325192318613667, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.282272734240592, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.877237 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.150801210850784, 'psi': 0.13572854291417166}-{'f1_val': 0.13493253373313344, 'auprc': 0.13493253373313344, 'loss_val': 6.097699040952606, 'psi': 0.13493253373313344}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=1.755309 (no previous merge yet)
[S15] round=25 local utility u=0.017804 metrics={'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.710144516654749, 'psi': 0.6165550083006743}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7444991304758775, 'psi': 0.6164158146233559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=25 head_norm_before_train=1.721668 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.14208842350203607, 'auprc': 0.14208842350203607, 'loss_val': 3.8688323882709255, 'psi': 0.14208842350203607}-{'f1_val': 0.14013575651412305, 'auprc': 0.14013575651412305, 'loss_val': 3.8091132809372588, 'psi': 0.14013575651412305}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.690858 cos_to_last_merge=0.9848 (last merge round=21)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.17887590659625288, 'auprc': 0.17887590659625288, 'loss_val': 0.9656767406808305, 'psi': 0.17887590659625288}-{'f1_val': 0.20492555643094312, 'auprc': 0.20492555643094312, 'loss_val': 0.9919262861375673, 'psi': 0.20492555643094312}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=1.781492 cos_to_last_merge=0.9743 (last merge round=16)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.2620238809952638, 'auprc': 0.2620238809952638, 'loss_val': 2.111747825135588, 'psi': 0.2620238809952638}-{'f1_val': 0.2641683103221565, 'auprc': 0.2641683103221565, 'loss_val': 1.9460468733733294, 'psi': 0.2641683103221565}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.432208 cos_to_last_merge=0.9783 (last merge round=18)
[S3] round=26 local utility u=0.033870 metrics={'f1_val': 0.2613156698486915, 'auprc': 0.2613156698486915, 'loss_val': 2.2827409071969416, 'psi': 0.2613156698486915}-{'f1_val': 0.27094628786235814, 'auprc': 0.27094628786235814, 'loss_val': 2.43715746595428, 'psi': 0.27094628786235814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=26 head_norm_before_train=1.421978 cos_to_last_merge=0.9165 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=26 local utility u=0.002879 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2668295064166146, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2725875847289225, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=26 head_norm_before_train=1.682233 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.4816857558039223, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.3738150192740535, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.541012 cos_to_last_merge=0.9594 (last merge round=20)
[S6] round=26 local utility u=0.106732 metrics={'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 4.313996802673613, 'psi': 0.09904030710172745}-{'f1_val': 0.061686949223667645, 'auprc': 0.061686949223667645, 'loss_val': 4.191281320410587, 'psi': 0.061686949223667645}
[S6] not sending this round → trigger blocked (psi=0.099)
[S7] START round=26 head_norm_before_train=1.586689 (no previous merge yet)
[S7] round=26 local utility u=0.409329 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 1.0872951675915774, 'psi': 0.3330019880715706}-{'f1_val': 0.24881516587677724, 'auprc': 0.24881516587677724, 'loss_val': 1.1482712674850803, 'psi': 0.24881516587677724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=26 head_norm_before_train=1.830511 cos_to_last_merge=0.9892 (last merge round=18)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6294221480252234, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.5997411527266906, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=1.663469 cos_to_last_merge=0.9978 (last merge round=19)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.514401164257393, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.4734306250200566, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=1.622687 cos_to_last_merge=0.9454 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=26 local utility u=0.044922 metrics={'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.294983208578154, 'psi': 0.33277498604131767}-{'f1_val': 0.33261477045908183, 'auprc': 0.33261477045908183, 'loss_val': 2.383384513636274, 'psi': 0.33261477045908183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=26 head_norm_before_train=1.801260 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.8776240588839754, 'psi': 0.33178150217256364}-{'f1_val': 0.3243817326657563, 'auprc': 0.3243817326657563, 'loss_val': 2.782733683019344, 'psi': 0.3243817326657563}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.596439 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.375274431058863, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.325192318613667, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.888506 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.200934253745137, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.150801210850784, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.780673 (no previous merge yet)
[S15] round=26 local utility u=0.005635 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6968884036414194, 'psi': 0.6163342951580373}-{'f1_val': 0.6165550083006743, 'auprc': 0.6165550083006743, 'loss_val': 0.710144516654749, 'psi': 0.6165550083006743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=26 head_norm_before_train=1.736374 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.11677719338364205, 'auprc': 0.11677719338364205, 'loss_val': 4.28685513884503, 'psi': 0.11677719338364206}-{'f1_val': 0.14208842350203607, 'auprc': 0.14208842350203607, 'loss_val': 3.8688323882709255, 'psi': 0.14208842350203607}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.719963 cos_to_last_merge=0.9798 (last merge round=21)
[S17] round=26 local utility u=0.092779 metrics={'f1_val': 0.20415269684402934, 'auprc': 0.20415269684402934, 'loss_val': 1.0076105024172852, 'psi': 0.20415269684402934}-{'f1_val': 0.17887590659625288, 'auprc': 0.17887590659625288, 'loss_val': 0.9656767406808305, 'psi': 0.17887590659625288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=27 head_norm_before_train=1.798358 cos_to_last_merge=0.9726 (last merge round=16)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 2.0083989132365265, 'psi': 0.24922466195261136}-{'f1_val': 0.2620238809952638, 'auprc': 0.2620238809952638, 'loss_val': 2.111747825135588, 'psi': 0.2620238809952638}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.455070 cos_to_last_merge=0.9754 (last merge round=18)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 2.3530177534221157, 'psi': 0.26192800885243767}-{'f1_val': 0.2613156698486915, 'auprc': 0.2613156698486915, 'loss_val': 2.2827409071969416, 'psi': 0.2613156698486915}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.433624 cos_to_last_merge=0.9144 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=27 local utility u=0.000479 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2658722405442093, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2668295064166146, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=27 head_norm_before_train=1.700962 (no previous merge yet)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.580652656059936, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.4816857558039223, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.568426 cos_to_last_merge=0.9521 (last merge round=20)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.029927992799279927, 'auprc': 0.029927992799279927, 'loss_val': 4.620039345854864, 'psi': 0.029927992799279927}-{'f1_val': 0.09904030710172745, 'auprc': 0.09904030710172745, 'loss_val': 4.313996802673613, 'psi': 0.09904030710172745}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.604598 (no previous merge yet)
[S7] round=27 local utility u=0.022592 metrics={'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0428570652255897, 'psi': 0.33308476261496395}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 1.0872951675915774, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=27 head_norm_before_train=1.851490 cos_to_last_merge=0.9868 (last merge round=18)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6970690062575842, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6294221480252234, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=1.677767 cos_to_last_merge=0.9973 (last merge round=19)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.548527353158505, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.514401164257393, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.639432 cos_to_last_merge=0.9424 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=27 local utility u=0.053114 metrics={'f1_val': 0.3330146590184831, 'auprc': 0.3330146590184831, 'loss_val': 2.190912192845837, 'psi': 0.3330146590184831}-{'f1_val': 0.33277498604131767, 'auprc': 0.33277498604131767, 'loss_val': 2.294983208578154, 'psi': 0.33277498604131767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=27 head_norm_before_train=1.818780 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.32519583238269073, 'auprc': 0.32519583238269073, 'loss_val': 2.8702124639532354, 'psi': 0.32519583238269073}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 2.8776240588839754, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.610688 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4255462555413088, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.375274431058863, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.898922 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.250926184562456, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 6.200934253745137, 'psi': 0.13572854291417166}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.804668 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7085834579941559, 'psi': 0.6164158146233559}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6968884036414194, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.750192 (no previous merge yet)
[S16] round=27 local utility u=0.168819 metrics={'f1_val': 0.13583517292126565, 'auprc': 0.13583517292126565, 'loss_val': 4.120738546802633, 'psi': 0.13583517292126565}-{'f1_val': 0.11677719338364205, 'auprc': 0.11677719338364205, 'loss_val': 4.28685513884503, 'psi': 0.11677719338364206}
[S16] not sending this round → trigger blocked (psi=0.136)
[S17] START round=27 head_norm_before_train=1.745430 cos_to_last_merge=0.9760 (last merge round=21)
[S17] round=27 local utility u=0.039423 metrics={'f1_val': 0.21251369363799744, 'auprc': 0.21251369363799744, 'loss_val': 1.004012600784818, 'psi': 0.21251369363799744}-{'f1_val': 0.20415269684402934, 'auprc': 0.20415269684402934, 'loss_val': 1.0076105024172852, 'psi': 0.20415269684402934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=28 head_norm_before_train=1.813063 cos_to_last_merge=0.9711 (last merge round=16)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.24529914529914532, 'auprc': 0.24529914529914532, 'loss_val': 2.0775926882387608, 'psi': 0.24529914529914532}-{'f1_val': 0.24922466195261136, 'auprc': 0.24922466195261136, 'loss_val': 2.0083989132365265, 'psi': 0.24922466195261136}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=1.474950 cos_to_last_merge=0.9728 (last merge round=18)
[S3] round=28 local utility u=0.025492 metrics={'f1_val': 0.25814729278932513, 'auprc': 0.25814729278932513, 'loss_val': 2.2680074552181555, 'psi': 0.25814729278932513}-{'f1_val': 0.26192800885243767, 'auprc': 0.26192800885243767, 'loss_val': 2.3530177534221157, 'psi': 0.26192800885243767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=28 head_norm_before_train=1.443528 cos_to_last_merge=0.9128 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=28 local utility u=0.001967 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2619390752772242, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2658722405442093, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=28 head_norm_before_train=1.721313 (no previous merge yet)
[S5] round=28 local utility u=0.033021 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.518399436273894, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.580652656059936, 'psi': 0.33308623671855697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=28 head_norm_before_train=1.591564 cos_to_last_merge=0.9461 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.032243618450515, 'auprc': 0.032243618450515, 'loss_val': 4.7609140875361575, 'psi': 0.032243618450515}-{'f1_val': 0.029927992799279927, 'auprc': 0.029927992799279927, 'loss_val': 4.620039345854864, 'psi': 0.029927992799279927}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.622343 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 1.0213230979281824, 'psi': 0.24944015924359295}-{'f1_val': 0.33308476261496395, 'auprc': 0.33308476261496395, 'loss_val': 1.0428570652255897, 'psi': 0.33308476261496395}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.873029 cos_to_last_merge=0.9842 (last merge round=18)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7357535249937248, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.6970690062575842, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.690781 cos_to_last_merge=0.9967 (last merge round=19)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.58230537079292, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.548527353158505, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.654929 cos_to_last_merge=0.9399 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=28 local utility u=0.033538 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.124554649394578, 'psi': 0.3330944988456333}-{'f1_val': 0.3330146590184831, 'auprc': 0.3330146590184831, 'loss_val': 2.190912192845837, 'psi': 0.3330146590184831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=28 head_norm_before_train=1.834389 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.33016755462898617, 'auprc': 0.33016755462898617, 'loss_val': 2.92271180333959, 'psi': 0.33016755462898617}-{'f1_val': 0.32519583238269073, 'auprc': 0.32519583238269073, 'loss_val': 2.8702124639532354, 'psi': 0.32519583238269073}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=1.625590 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4675709144809457, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4255462555413088, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.908527 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.2966854939164065, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.250926184562456, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.830606 (no previous merge yet)
[S15] round=28 local utility u=0.005166 metrics={'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6912405925500099, 'psi': 0.615636807189815}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.7085834579941559, 'psi': 0.6164158146233559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=28 head_norm_before_train=1.763263 (no previous merge yet)
[S16] round=28 local utility u=0.005927 metrics={'f1_val': 0.13571796570250974, 'auprc': 0.13571796570250974, 'loss_val': 4.107829101838053, 'psi': 0.13571796570250974}-{'f1_val': 0.13583517292126565, 'auprc': 0.13583517292126565, 'loss_val': 4.120738546802633, 'psi': 0.13583517292126565}
[S16] not sending this round → trigger blocked (psi=0.136)
[S17] START round=28 head_norm_before_train=1.763745 cos_to_last_merge=0.9732 (last merge round=21)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.19444681228765356, 'auprc': 0.19444681228765356, 'loss_val': 0.9839398543127921, 'psi': 0.19444681228765356}-{'f1_val': 0.21251369363799744, 'auprc': 0.21251369363799744, 'loss_val': 1.004012600784818, 'psi': 0.21251369363799744}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.826596 cos_to_last_merge=0.9697 (last merge round=16)
[S2] round=29 local utility u=0.056897 metrics={'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.1449285335201167, 'psi': 0.26542475888492534}-{'f1_val': 0.24529914529914532, 'auprc': 0.24529914529914532, 'loss_val': 2.0775926882387608, 'psi': 0.24529914529914532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=29 head_norm_before_train=1.492002 cos_to_last_merge=0.9705 (last merge round=18)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 2.362947612036109, 'psi': 0.26080757016008815}-{'f1_val': 0.25814729278932513, 'auprc': 0.25814729278932513, 'loss_val': 2.2680074552181555, 'psi': 0.25814729278932513}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.457929 cos_to_last_merge=0.9108 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=29 local utility u=0.003202 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2555349062638934, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2619390752772242, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=29 head_norm_before_train=1.739855 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6261585777599095, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.518399436273894, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.610914 cos_to_last_merge=0.9414 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.032452999104744855, 'auprc': 0.032452999104744855, 'loss_val': 4.879815106920175, 'psi': 0.032452999104744855}-{'f1_val': 0.032243618450515, 'auprc': 0.032243618450515, 'loss_val': 4.7609140875361575, 'psi': 0.032243618450515}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.636080 (no previous merge yet)
[S7] round=29 local utility u=0.009179 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 1.0046464812716775, 'psi': 0.24962705121829937}-{'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 1.0213230979281824, 'psi': 0.24944015924359295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=29 head_norm_before_train=1.891848 cos_to_last_merge=0.9817 (last merge round=18)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7437296189344755, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7357535249937248, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.703054 cos_to_last_merge=0.9962 (last merge round=19)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.614505190804856, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.58230537079292, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.669945 cos_to_last_merge=0.9376 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=29 local utility u=0.029978 metrics={'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.064598962444373, 'psi': 0.3330944988456333}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.124554649394578, 'psi': 0.3330944988456333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=29 head_norm_before_train=1.848506 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.9588467766285085, 'psi': 0.3317042898145993}-{'f1_val': 0.33016755462898617, 'auprc': 0.33016755462898617, 'loss_val': 2.92271180333959, 'psi': 0.33016755462898617}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=1.640553 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.50289378299389, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4675709144809457, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.917689 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.337350679555791, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.2966854939164065, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.855074 (no previous merge yet)
[S15] round=29 local utility u=0.025125 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6472675661093223, 'psi': 0.6163342951580373}-{'f1_val': 0.615636807189815, 'auprc': 0.615636807189815, 'loss_val': 0.6912405925500099, 'psi': 0.615636807189815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=29 head_norm_before_train=1.775320 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.06651662915728933, 'auprc': 0.06651662915728933, 'loss_val': 4.898045997133539, 'psi': 0.06651662915728933}-{'f1_val': 0.13571796570250974, 'auprc': 0.13571796570250974, 'loss_val': 4.107829101838053, 'psi': 0.13571796570250974}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.779084 cos_to_last_merge=0.9711 (last merge round=21)
[S17] round=29 local utility u=0.292622 metrics={'f1_val': 0.26075029608663475, 'auprc': 0.26075029608663475, 'loss_val': 0.9954265962634213, 'psi': 0.26075029608663475}-{'f1_val': 0.19444681228765356, 'auprc': 0.19444681228765356, 'loss_val': 0.9839398543127921, 'psi': 0.19444681228765356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=30 head_norm_before_train=1.839545 cos_to_last_merge=0.9684 (last merge round=16)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.2527044025157233, 'auprc': 0.2527044025157233, 'loss_val': 2.126053612091691, 'psi': 0.2527044025157233}-{'f1_val': 0.26542475888492534, 'auprc': 0.26542475888492534, 'loss_val': 2.1449285335201167, 'psi': 0.26542475888492534}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.508829 cos_to_last_merge=0.9682 (last merge round=18)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 2.3692701822555318, 'psi': 0.2587947777992154}-{'f1_val': 0.26080757016008815, 'auprc': 0.26080757016008815, 'loss_val': 2.362947612036109, 'psi': 0.26080757016008815}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.472265 cos_to_last_merge=0.9085 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.909
[S4] round=30 local utility u=0.001212 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2531117059009445, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2555349062638934, 'psi': 0.3567939207526687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=30 head_norm_before_train=1.756282 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.66932635890003, 'psi': 0.33308623671855697}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6261585777599095, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.627611 cos_to_last_merge=0.9374 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.937
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.03182429403854774, 'auprc': 0.03182429403854774, 'loss_val': 4.985991185204916, 'psi': 0.03182429403854774}-{'f1_val': 0.032452999104744855, 'auprc': 0.032452999104744855, 'loss_val': 4.879815106920175, 'psi': 0.032452999104744855}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.645599 (no previous merge yet)
[S7] round=30 local utility u=0.007460 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.9897272355275286, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 1.0046464812716775, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=30 head_norm_before_train=1.912180 cos_to_last_merge=0.9803 (last merge round=18)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7620433402275882, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7437296189344755, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.714695 cos_to_last_merge=0.9956 (last merge round=19)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6430416019783456, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.614505190804856, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.685658 cos_to_last_merge=0.9353 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=30 local utility u=0.028250 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.007384015036626, 'psi': 0.33301496338745623}-{'f1_val': 0.3330944988456333, 'auprc': 0.3330944988456333, 'loss_val': 2.064598962444373, 'psi': 0.3330944988456333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=30 head_norm_before_train=1.861471 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.3284178187403994, 'auprc': 0.3284178187403994, 'loss_val': 2.9688444936464076, 'psi': 0.3284178187403994}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 2.9588467766285085, 'psi': 0.3317042898145993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.653635 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5250451951116932, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.50289378299389, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.926489 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.378867542733468, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.337350679555791, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.878969 (no previous merge yet)
[S15] round=30 local utility u=0.008205 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6321109339475398, 'psi': 0.6164734888353558}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6472675661093223, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=30 head_norm_before_train=1.786981 (no previous merge yet)
[S16] round=30 local utility u=0.226917 metrics={'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 4.6609977475804145, 'psi': 0.09060402684563758}-{'f1_val': 0.06651662915728933, 'auprc': 0.06651662915728933, 'loss_val': 4.898045997133539, 'psi': 0.06651662915728933}
[S16] not sending this round → trigger blocked (psi=0.091)
[S17] START round=30 head_norm_before_train=1.793654 cos_to_last_merge=0.9693 (last merge round=21)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.2450308498354101, 'auprc': 0.2450308498354101, 'loss_val': 1.0461967772951097, 'psi': 0.24503084983541007}-{'f1_val': 0.26075029608663475, 'auprc': 0.26075029608663475, 'loss_val': 0.9954265962634213, 'psi': 0.26075029608663475}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.852148 cos_to_last_merge=0.9670 (last merge round=16)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.26205241048209643, 'auprc': 0.26205241048209643, 'loss_val': 2.276308391031766, 'psi': 0.26205241048209643}-{'f1_val': 0.2527044025157233, 'auprc': 0.2527044025157233, 'loss_val': 2.126053612091691, 'psi': 0.2527044025157233}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.524503 cos_to_last_merge=0.9661 (last merge round=18)
[S3] round=31 local utility u=0.490766 metrics={'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.336051943904147, 'psi': 0.3641628959276018}-{'f1_val': 0.2587947777992154, 'auprc': 0.2587947777992154, 'loss_val': 2.3692701822555318, 'psi': 0.2587947777992154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=31 head_norm_before_train=1.488876 cos_to_last_merge=0.9059 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.906
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2596114781479963, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2531117059009445, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.769039 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.71782995414186, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.66932635890003, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.642241 cos_to_last_merge=0.9340 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 5.083550896181014, 'psi': 0.027589326096788783}-{'f1_val': 0.03182429403854774, 'auprc': 0.03182429403854774, 'loss_val': 4.985991185204916, 'psi': 0.03182429403854774}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.653450 (no previous merge yet)
[S7] round=31 local utility u=0.391751 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.9565990434101203, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.9897272355275286, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=31 head_norm_before_train=1.930248 cos_to_last_merge=0.9794 (last merge round=18)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8090104487153897, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.7620433402275882, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.725452 cos_to_last_merge=0.9951 (last merge round=19)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.669920866419639, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6430416019783456, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.700768 cos_to_last_merge=0.9332 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=31 local utility u=0.008852 metrics={'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9896795571847252, 'psi': 0.33301496338745623}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 2.007384015036626, 'psi': 0.33301496338745623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=31 head_norm_before_train=1.873622 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.0096507849234317, 'psi': 0.33178150217256364}-{'f1_val': 0.3284178187403994, 'auprc': 0.3284178187403994, 'loss_val': 2.9688444936464076, 'psi': 0.3284178187403994}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.663003 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5679559663849, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5250451951116932, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.934739 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.418356236658376, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.378867542733468, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=1.903378 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6417485622767783, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6321109339475398, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.796274 (no previous merge yet)
[S16] round=31 local utility u=0.404690 metrics={'f1_val': 0.13618648430031619, 'auprc': 0.13618648430031619, 'loss_val': 4.261860723229314, 'psi': 0.13618648430031619}-{'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 4.6609977475804145, 'psi': 0.09060402684563758}
[S16] not sending this round → trigger blocked (psi=0.136)
[S17] START round=31 head_norm_before_train=1.808267 cos_to_last_merge=0.9677 (last merge round=21)
[S17] round=31 local utility u=0.013988 metrics={'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 1.0690113451736467, 'psi': 0.2506743525795499}-{'f1_val': 0.2450308498354101, 'auprc': 0.2450308498354101, 'loss_val': 1.0461967772951097, 'psi': 0.24503084983541007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=32 head_norm_before_train=1.862795 cos_to_last_merge=0.9658 (last merge round=16)
[S2] round=32 local utility u=0.046921 metrics={'f1_val': 0.2650570618114651, 'auprc': 0.2650570618114651, 'loss_val': 2.2095079052803097, 'psi': 0.2650570618114651}-{'f1_val': 0.26205241048209643, 'auprc': 0.26205241048209643, 'loss_val': 2.276308391031766, 'psi': 0.26205241048209643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=32 head_norm_before_train=1.538669 cos_to_last_merge=0.9641 (last merge round=18)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.2597469661760909, 'auprc': 0.2597469661760909, 'loss_val': 2.4261870314388743, 'psi': 0.2597469661760909}-{'f1_val': 0.3641628959276018, 'auprc': 0.3641628959276018, 'loss_val': 2.336051943904147, 'psi': 0.3641628959276018}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.508933 cos_to_last_merge=0.9031 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2680746690419087, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2596114781479963, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.782817 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.7295641822550856, 'psi': 0.33308623671855697}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.71782995414186, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.655485 cos_to_last_merge=0.9311 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.167795584563903, 'psi': 0.025658492279745686}-{'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 5.083550896181014, 'psi': 0.027589326096788783}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.661729 (no previous merge yet)
[S7] round=32 local utility u=0.015729 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.9251415300340862, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.9565990434101203, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=32 head_norm_before_train=1.937974 cos_to_last_merge=0.9780 (last merge round=18)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8138095987880929, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8090104487153897, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.735705 cos_to_last_merge=0.9946 (last merge round=19)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6947989035200766, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.669920866419639, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.718523 cos_to_last_merge=0.9310 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.3238139462889869, 'auprc': 0.3238139462889869, 'loss_val': 1.9728770411480527, 'psi': 0.3238139462889869}-{'f1_val': 0.33301496338745623, 'auprc': 0.33301496338745623, 'loss_val': 1.9896795571847252, 'psi': 0.33301496338745623}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.885254 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.0387730868968745, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.0096507849234317, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.671570 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5904591177306302, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5679559663849, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.942760 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.4564875176246055, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.418356236658376, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.927268 (no previous merge yet)
[S15] round=32 local utility u=0.003160 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6341755564374908, 'psi': 0.6161950003225232}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6417485622767783, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=32 head_norm_before_train=1.805300 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.1370044052863436, 'auprc': 0.1370044052863436, 'loss_val': 4.29145887043114, 'psi': 0.1370044052863436}-{'f1_val': 0.13618648430031619, 'auprc': 0.13618648430031619, 'loss_val': 4.261860723229314, 'psi': 0.13618648430031619}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.822421 cos_to_last_merge=0.9662 (last merge round=21)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.20982738724560893, 'auprc': 0.20982738724560893, 'loss_val': 1.1109426645129856, 'psi': 0.20982738724560895}-{'f1_val': 0.2506743525795499, 'auprc': 0.2506743525795499, 'loss_val': 1.0690113451736467, 'psi': 0.2506743525795499}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.872876 cos_to_last_merge=0.9648 (last merge round=16)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.2766344361572175, 'psi': 0.24516443956312162}-{'f1_val': 0.2650570618114651, 'auprc': 0.2650570618114651, 'loss_val': 2.2095079052803097, 'psi': 0.2650570618114651}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.550037 cos_to_last_merge=0.9625 (last merge round=18)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.25332074283915645, 'auprc': 0.25332074283915645, 'loss_val': 2.4018598321198996, 'psi': 0.25332074283915645}-{'f1_val': 0.2597469661760909, 'auprc': 0.2597469661760909, 'loss_val': 2.4261870314388743, 'psi': 0.2597469661760909}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.528063 cos_to_last_merge=0.9004 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.900
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2779356865651468, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2680746690419087, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.794114 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.736771295138027, 'psi': 0.3335071121394324}-{'f1_val': 0.33308623671855697, 'auprc': 0.33308623671855697, 'loss_val': 2.7295641822550856, 'psi': 0.33308623671855697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.667403 cos_to_last_merge=0.9285 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.027802893309222424, 'auprc': 0.027802893309222424, 'loss_val': 5.217771475241711, 'psi': 0.027802893309222424}-{'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.167795584563903, 'psi': 0.025658492279745686}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.671169 (no previous merge yet)
[S7] round=33 local utility u=0.010712 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.9037171425766428, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.9251415300340862, 'psi': 0.3330019880715706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=33 head_norm_before_train=1.944585 cos_to_last_merge=0.9763 (last merge round=18)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.846901562336565, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8138095987880929, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.745380 cos_to_last_merge=0.9941 (last merge round=19)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7197107090370465, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6947989035200766, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.740609 cos_to_last_merge=0.9281 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.3078054881188847, 'auprc': 0.3078054881188847, 'loss_val': 1.978600543635575, 'psi': 0.3078054881188847}-{'f1_val': 0.3238139462889869, 'auprc': 0.3238139462889869, 'loss_val': 1.9728770411480527, 'psi': 0.3238139462889869}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.896077 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.327888965570125, 'auprc': 0.327888965570125, 'loss_val': 3.0318192853492016, 'psi': 0.327888965570125}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.0387730868968745, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.683506 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6266788718169929, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5904591177306302, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.950312 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.492791057723293, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.4564875176246055, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.949960 (no previous merge yet)
[S15] round=33 local utility u=0.003702 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.626770840569502, 'psi': 0.6161950003225232}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6341755564374908, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S15] sending update (kind=head size=1809 to 1 peers)
[S16] START round=33 head_norm_before_train=1.814445 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 4.914841718117172, 'psi': 0.09060402684563758}-{'f1_val': 0.1370044052863436, 'auprc': 0.1370044052863436, 'loss_val': 4.29145887043114, 'psi': 0.1370044052863436}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.835983 cos_to_last_merge=0.9648 (last merge round=21)
[S17] round=33 local utility u=0.258706 metrics={'f1_val': 0.2628311653582412, 'auprc': 0.2628311653582412, 'loss_val': 1.0705642383515204, 'psi': 0.2628311653582412}-{'f1_val': 0.20982738724560893, 'auprc': 0.20982738724560893, 'loss_val': 1.1109426645129856, 'psi': 0.20982738724560895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=34 head_norm_before_train=1.882763 cos_to_last_merge=0.9638 (last merge round=16)
[S2] round=34 local utility u=0.521424 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.334603968669995, 'psi': 0.3674775928297055}-{'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.2766344361572175, 'psi': 0.24516443956312162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=34 head_norm_before_train=1.561811 cos_to_last_merge=0.9608 (last merge round=18)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.25607738322514956, 'auprc': 0.25607738322514956, 'loss_val': 2.4296500436365736, 'psi': 0.25607738322514956}-{'f1_val': 0.25332074283915645, 'auprc': 0.25332074283915645, 'loss_val': 2.4018598321198996, 'psi': 0.25332074283915645}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.543516 cos_to_last_merge=0.8983 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2890812097795001, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2779356865651468, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.805661 (no previous merge yet)
[S5] round=34 local utility u=0.047330 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.64211088830959, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.736771295138027, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=34 head_norm_before_train=1.678136 cos_to_last_merge=0.9262 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.926
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.03140421713772992, 'auprc': 0.03140421713772992, 'loss_val': 5.253917082096556, 'psi': 0.03140421713772992}-{'f1_val': 0.027802893309222424, 'auprc': 0.027802893309222424, 'loss_val': 5.217771475241711, 'psi': 0.027802893309222424}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.684136 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.8875188907617538, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.9037171425766428, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.954553 cos_to_last_merge=0.9749 (last merge round=18)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9286120810425088, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.846901562336565, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.754556 cos_to_last_merge=0.9936 (last merge round=19)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7430772123051796, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7197107090370465, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.764313 cos_to_last_merge=0.9248 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.28398832552772685, 'auprc': 0.28398832552772685, 'loss_val': 1.9931700480460512, 'psi': 0.28398832552772685}-{'f1_val': 0.3078054881188847, 'auprc': 0.3078054881188847, 'loss_val': 1.978600543635575, 'psi': 0.3078054881188847}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.906097 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.32706134312375706, 'auprc': 0.32706134312375706, 'loss_val': 3.0474381005135793, 'psi': 0.32706134312375706}-{'f1_val': 0.327888965570125, 'auprc': 0.327888965570125, 'loss_val': 3.0318192853492016, 'psi': 0.327888965570125}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.695544 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6476853112012453, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6266788718169929, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.957683 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.528087978206984, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.492791057723293, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.970965 (no previous merge yet)
[S15] round=34 local utility u=0.010568 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6081417992949636, 'psi': 0.6164734888353558}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.626770840569502, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S16] START round=34 head_norm_before_train=1.821389 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.0900511836212412, 'auprc': 0.0900511836212412, 'loss_val': 5.1340158884234155, 'psi': 0.0900511836212412}-{'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 4.914841718117172, 'psi': 0.09060402684563758}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.846354 cos_to_last_merge=0.9638 (last merge round=21)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.2528522615747535, 'auprc': 0.2528522615747535, 'loss_val': 1.1333217040933237, 'psi': 0.2528522615747535}-{'f1_val': 0.2628311653582412, 'auprc': 0.2628311653582412, 'loss_val': 1.0705642383515204, 'psi': 0.2628311653582412}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.892363 cos_to_last_merge=0.9628 (last merge round=16)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.2452542269425624, 'auprc': 0.2452542269425624, 'loss_val': 2.3137600664321796, 'psi': 0.2452542269425624}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.334603968669995, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.573921 cos_to_last_merge=0.9590 (last merge round=18)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.2578495450467769, 'auprc': 0.2578495450467769, 'loss_val': 2.457298218199636, 'psi': 0.2578495450467769}-{'f1_val': 0.25607738322514956, 'auprc': 0.25607738322514956, 'loss_val': 2.4296500436365736, 'psi': 0.25607738322514956}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.557343 cos_to_last_merge=0.8965 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.897
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3013688149865688, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2890812097795001, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.814303 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6921520245036454, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.64211088830959, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.688399 cos_to_last_merge=0.9241 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.03013945119208277, 'auprc': 0.03013945119208277, 'loss_val': 5.3172778205876625, 'psi': 0.03013945119208277}-{'f1_val': 0.03140421713772992, 'auprc': 0.03140421713772992, 'loss_val': 5.253917082096556, 'psi': 0.03140421713772992}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.695867 (no previous merge yet)
[S7] round=35 local utility u=0.381926 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8740404027513363, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.8875188907617538, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=35 head_norm_before_train=1.965586 cos_to_last_merge=0.9740 (last merge round=18)
[S8] round=35 local utility u=0.023839 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.880934551426823, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9286120810425088, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=35 head_norm_before_train=1.763284 cos_to_last_merge=0.9931 (last merge round=19)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.76699332092112, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7430772123051796, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.787687 cos_to_last_merge=0.9214 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.2780435938330675, 'auprc': 0.2780435938330675, 'loss_val': 2.0243214235270366, 'psi': 0.2780435938330675}-{'f1_val': 0.28398832552772685, 'auprc': 0.28398832552772685, 'loss_val': 1.9931700480460512, 'psi': 0.28398832552772685}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.915675 (no previous merge yet)
[S11] round=35 local utility u=0.001718 metrics={'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.084398775993282, 'psi': 0.33154997286190585}-{'f1_val': 0.32706134312375706, 'auprc': 0.32706134312375706, 'loss_val': 3.0474381005135793, 'psi': 0.32706134312375706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=35 head_norm_before_train=1.706849 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6758055645346641, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6476853112012453, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.964953 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.561755014546405, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.528087978206984, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.989545 (no previous merge yet)
[S15] round=35 local utility u=0.001912 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6018122173941465, 'psi': 0.6161950003225232}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.6081417992949636, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=35 head_norm_before_train=1.828910 (no previous merge yet)
[S16] round=35 local utility u=0.278139 metrics={'f1_val': 0.1155433287482806, 'auprc': 0.1155433287482806, 'loss_val': 4.807166951963584, 'psi': 0.1155433287482806}-{'f1_val': 0.0900511836212412, 'auprc': 0.0900511836212412, 'loss_val': 5.1340158884234155, 'psi': 0.0900511836212412}
[S16] not sending this round → trigger blocked (psi=0.116)
[S17] START round=35 head_norm_before_train=1.859231 cos_to_last_merge=0.9627 (last merge round=21)
[S17] round=35 local utility u=0.044248 metrics={'f1_val': 0.2635558998650996, 'auprc': 0.2635558998650996, 'loss_val': 1.141158569143833, 'psi': 0.2635558998650996}-{'f1_val': 0.2528522615747535, 'auprc': 0.2528522615747535, 'loss_val': 1.1333217040933237, 'psi': 0.2528522615747535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=36 head_norm_before_train=1.901440 cos_to_last_merge=0.9619 (last merge round=16)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.1965712512605694, 'auprc': 0.1965712512605694, 'loss_val': 3.053349766376193, 'psi': 0.1965712512605694}-{'f1_val': 0.2452542269425624, 'auprc': 0.2452542269425624, 'loss_val': 2.3137600664321796, 'psi': 0.2452542269425624}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.586857 cos_to_last_merge=0.9571 (last merge round=18)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2563710499490316, 'auprc': 0.2563710499490316, 'loss_val': 2.4777793848789256, 'psi': 0.2563710499490316}-{'f1_val': 0.2578495450467769, 'auprc': 0.2578495450467769, 'loss_val': 2.457298218199636, 'psi': 0.2578495450467769}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.572502 cos_to_last_merge=0.8942 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.314136568697965, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3013688149865688, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.822413 (no previous merge yet)
[S5] round=36 local utility u=0.047885 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5963822450494423, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6921520245036454, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=36 head_norm_before_train=1.697911 cos_to_last_merge=0.9222 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.922
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.029080252479711452, 'auprc': 0.029080252479711452, 'loss_val': 5.377345912516386, 'psi': 0.029080252479711452}-{'f1_val': 0.03013945119208277, 'auprc': 0.03013945119208277, 'loss_val': 5.3172778205876625, 'psi': 0.03013945119208277}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.711235 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.836553546056824, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8740404027513363, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.977094 cos_to_last_merge=0.9733 (last merge round=18)
[S8] round=36 local utility u=0.001392 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8781511315324981, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.880934551426823, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=36 head_norm_before_train=1.771727 cos_to_last_merge=0.9926 (last merge round=19)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7922466636881267, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.76699332092112, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.810012 cos_to_last_merge=0.9181 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.27239583333333334, 'auprc': 0.27239583333333334, 'loss_val': 2.053642618560472, 'psi': 0.27239583333333334}-{'f1_val': 0.2780435938330675, 'auprc': 0.2780435938330675, 'loss_val': 2.0243214235270366, 'psi': 0.2780435938330675}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.924905 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.12615610670561, 'psi': 0.33185875048506014}-{'f1_val': 0.33154997286190585, 'auprc': 0.33154997286190585, 'loss_val': 3.084398775993282, 'psi': 0.33154997286190585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.718390 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.696803992628751, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6758055645346641, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.971996 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.594180697488851, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.561755014546405, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=2.008074 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.607910219744517, 'psi': 0.61591610673549}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6018122173941465, 'psi': 0.6161950003225232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.837041 (no previous merge yet)
[S16] round=36 local utility u=0.380181 metrics={'f1_val': 0.14808424987420027, 'auprc': 0.14808424987420027, 'loss_val': 4.339672482696248, 'psi': 0.14808424987420027}-{'f1_val': 0.1155433287482806, 'auprc': 0.1155433287482806, 'loss_val': 4.807166951963584, 'psi': 0.1155433287482806}
[S16] not sending this round → trigger blocked (psi=0.148)
[S17] START round=36 head_norm_before_train=1.870747 cos_to_last_merge=0.9616 (last merge round=21)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.26230513669582617, 'auprc': 0.26230513669582617, 'loss_val': 1.1666292715609115, 'psi': 0.26230513669582617}-{'f1_val': 0.2635558998650996, 'auprc': 0.2635558998650996, 'loss_val': 1.141158569143833, 'psi': 0.2635558998650996}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.909608 cos_to_last_merge=0.9611 (last merge round=16)
[S2] round=37 local utility u=1.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.408628171678403, 'psi': 0.3674775928297055}-{'f1_val': 0.1965712512605694, 'auprc': 0.1965712512605694, 'loss_val': 3.053349766376193, 'psi': 0.1965712512605694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=37 head_norm_before_train=1.600509 cos_to_last_merge=0.9551 (last merge round=18)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.25740420904496897, 'auprc': 0.25740420904496897, 'loss_val': 2.5054244271554187, 'psi': 0.25740420904496897}-{'f1_val': 0.2563710499490316, 'auprc': 0.2563710499490316, 'loss_val': 2.4777793848789256, 'psi': 0.2563710499490316}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.583887 cos_to_last_merge=0.8925 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.892
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3266404625583534, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.314136568697965, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.830683 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6589495726522716, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.5963822450494423, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.706478 cos_to_last_merge=0.9206 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.921
[S6] round=37 local utility u=0.018368 metrics={'f1_val': 0.03370535714285714, 'auprc': 0.03370535714285714, 'loss_val': 5.382234913164944, 'psi': 0.03370535714285714}-{'f1_val': 0.029080252479711452, 'auprc': 0.029080252479711452, 'loss_val': 5.377345912516386, 'psi': 0.029080252479711452}
[S6] not sending this round → trigger blocked (psi=0.034)
[S7] START round=37 head_norm_before_train=1.725946 (no previous merge yet)
[S7] round=37 local utility u=0.387172 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8125836528537573, 'psi': 0.3330019880715706}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.836553546056824, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=37 head_norm_before_train=1.987791 cos_to_last_merge=0.9725 (last merge round=18)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9294973796800343, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8781511315324981, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.780022 cos_to_last_merge=0.9922 (last merge round=19)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.814887309441324, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.7922466636881267, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.831190 cos_to_last_merge=0.9150 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.265448547138688, 'auprc': 0.265448547138688, 'loss_val': 2.083772776501807, 'psi': 0.265448547138688}-{'f1_val': 0.27239583333333334, 'auprc': 0.27239583333333334, 'loss_val': 2.053642618560472, 'psi': 0.27239583333333334}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.933511 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.1435644933333786, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.12615610670561, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.727033 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7230384133722083, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.696803992628751, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.978596 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.62630989866074, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.594180697488851, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=2.025965 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6239548880997955, 'psi': 0.6161950003225232}-{'f1_val': 0.61591610673549, 'auprc': 0.61591610673549, 'loss_val': 0.607910219744517, 'psi': 0.61591610673549}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.845266 (no previous merge yet)
[S16] round=37 local utility u=0.169886 metrics={'f1_val': 0.1554705215419501, 'auprc': 0.1554705215419501, 'loss_val': 4.06637645876521, 'psi': 0.1554705215419501}-{'f1_val': 0.14808424987420027, 'auprc': 0.14808424987420027, 'loss_val': 4.339672482696248, 'psi': 0.14808424987420027}
[S16] not sending this round → trigger blocked (psi=0.155)
[S17] START round=37 head_norm_before_train=1.879009 cos_to_last_merge=0.9608 (last merge round=21)
[S17] round=37 local utility u=0.056061 metrics={'f1_val': 0.26942432211927864, 'auprc': 0.26942432211927864, 'loss_val': 1.118580716948953, 'psi': 0.26942432211927864}-{'f1_val': 0.26230513669582617, 'auprc': 0.26230513669582617, 'loss_val': 1.1666292715609115, 'psi': 0.26230513669582617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=38 head_norm_before_train=1.916880 cos_to_last_merge=0.9604 (last merge round=16)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.436638931577539, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.408628171678403, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.614030 cos_to_last_merge=0.9532 (last merge round=18)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.2581969842797562, 'auprc': 0.2581969842797562, 'loss_val': 2.5366078347403027, 'psi': 0.2581969842797562}-{'f1_val': 0.25740420904496897, 'auprc': 0.25740420904496897, 'loss_val': 2.5054244271554187, 'psi': 0.25740420904496897}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.592768 cos_to_last_merge=0.8911 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.891
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3399581672854395, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3266404625583534, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.840862 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.698297567274382, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.6589495726522716, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.714941 cos_to_last_merge=0.9189 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.919
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.036395916555703504, 'auprc': 0.036395916555703504, 'loss_val': 5.418992125472596, 'psi': 0.036395916555703504}-{'f1_val': 0.03370535714285714, 'auprc': 0.03370535714285714, 'loss_val': 5.382234913164944, 'psi': 0.03370535714285714}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.738443 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.820416462149672, 'psi': 0.3330019880715706}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.8125836528537573, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.992253 cos_to_last_merge=0.9714 (last merge round=18)
[S8] round=38 local utility u=0.030626 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8682447663881332, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9294973796800343, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=38 head_norm_before_train=1.787852 cos_to_last_merge=0.9918 (last merge round=19)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8360175472265516, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.814887309441324, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.850309 cos_to_last_merge=0.9124 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.2558082660797261, 'auprc': 0.2558082660797261, 'loss_val': 2.1138441845599525, 'psi': 0.2558082660797261}-{'f1_val': 0.265448547138688, 'auprc': 0.265448547138688, 'loss_val': 2.083772776501807, 'psi': 0.265448547138688}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.941855 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.151984941975316, 'psi': 0.33185875048506014}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.1435644933333786, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.734022 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7474101718819006, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7230384133722083, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.984933 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.655812521665339, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.62630989866074, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=2.043066 (no previous merge yet)
[S15] round=38 local utility u=0.014442 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5975767483863661, 'psi': 0.6164734888353558}-{'f1_val': 0.6161950003225232, 'auprc': 0.6161950003225232, 'loss_val': 0.6239548880997955, 'psi': 0.6161950003225232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=38 head_norm_before_train=1.853195 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.0003711952487008166, 'auprc': 0.0003711952487008166, 'loss_val': 6.1459969384434965, 'psi': 0.0003711952487008166}-{'f1_val': 0.1554705215419501, 'auprc': 0.1554705215419501, 'loss_val': 4.06637645876521, 'psi': 0.1554705215419501}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.885851 cos_to_last_merge=0.9602 (last merge round=21)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.26390742476816914, 'auprc': 0.26390742476816914, 'loss_val': 1.1737194523321246, 'psi': 0.26390742476816914}-{'f1_val': 0.26942432211927864, 'auprc': 0.26942432211927864, 'loss_val': 1.118580716948953, 'psi': 0.26942432211927864}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.924463 cos_to_last_merge=0.9596 (last merge round=16)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4747061446229046, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.436638931577539, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.367 u=0.0000 p_local=0.1698 f1=0.367 auprc=0.367 bytes=14392
[S3] START round=39 head_norm_before_train=1.626951 cos_to_last_merge=0.9513 (last merge round=18)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.2559796437659033, 'auprc': 0.2559796437659033, 'loss_val': 2.551188788770743, 'psi': 0.2559796437659033}-{'f1_val': 0.2581969842797562, 'auprc': 0.2581969842797562, 'loss_val': 2.5366078347403027, 'psi': 0.2581969842797562}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.256 u=0.0000 p_local=0.0196 f1=0.256 auprc=0.256 bytes=12596
[S4] START round=39 head_norm_before_train=1.601217 cos_to_last_merge=0.8899 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.890
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.35392524772573, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3399581672854395, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0027 f1=0.357 auprc=0.357 bytes=19834
[S5] START round=39 head_norm_before_train=1.847989 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7216982664408116, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.698297567274382, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.334 u=0.0000 p_local=0.0126 f1=0.334 auprc=0.334 bytes=25200
[S6] START round=39 head_norm_before_train=1.723233 cos_to_last_merge=0.9173 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.917
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.565693700372194, 'psi': 0.025658492279745686}-{'f1_val': 0.036395916555703504, 'auprc': 0.036395916555703504, 'loss_val': 5.418992125472596, 'psi': 0.036395916555703504}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.026 u=0.0000 p_local=0.0073 f1=0.026 auprc=0.026 bytes=0
[S7] START round=39 head_norm_before_train=1.750828 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.8175625504957287, 'psi': 0.24962705121829937}-{'f1_val': 0.3330019880715706, 'auprc': 0.3330019880715706, 'loss_val': 0.820416462149672, 'psi': 0.3330019880715706}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.250 u=0.0000 p_local=0.1073 f1=0.250 auprc=0.250 bytes=21610
[S8] START round=39 head_norm_before_train=1.999837 cos_to_last_merge=0.9707 (last merge round=18)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8824764930462192, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8682447663881332, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0191 f1=0.359 auprc=0.359 bytes=32400
[S9] START round=39 head_norm_before_train=1.795300 cos_to_last_merge=0.9913 (last merge round=19)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8555391710776092, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8360175472265516, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0013 f1=0.369 auprc=0.369 bytes=5399
[S10] START round=39 head_norm_before_train=1.867663 cos_to_last_merge=0.9100 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.910
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.25220012055455093, 'auprc': 0.25220012055455093, 'loss_val': 2.142215069400455, 'psi': 0.25220012055455093}-{'f1_val': 0.2558082660797261, 'auprc': 0.2558082660797261, 'loss_val': 2.1138441845599525, 'psi': 0.2558082660797261}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.252 u=0.0000 p_local=0.0132 f1=0.252 auprc=0.252 bytes=19813
[S11] START round=39 head_norm_before_train=1.950108 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.1540337389921493, 'psi': 0.33178150217256364}-{'f1_val': 0.33185875048506014, 'auprc': 0.33185875048506014, 'loss_val': 3.151984941975316, 'psi': 0.33185875048506014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.332 u=0.0000 p_local=0.0019 f1=0.332 auprc=0.332 bytes=5391
[S13] START round=39 head_norm_before_train=1.741650 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7577591643509716, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7474101718819006, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0013 f1=0.360 auprc=0.360 bytes=8988
[S14] START round=39 head_norm_before_train=1.991140 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.683068533311612, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.655812521665339, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0006 f1=0.136 auprc=0.136 bytes=0
[S15] START round=39 head_norm_before_train=2.058139 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6254352011000865, 'psi': 0.6163342951580373}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.5975767483863661, 'psi': 0.6164734888353558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.616 u=0.0000 p_local=0.0094 f1=0.616 auprc=0.616 bytes=36057
[S16] START round=39 head_norm_before_train=1.859300 (no previous merge yet)
[S16] round=39 local utility u=1.000000 metrics={'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 3.5849906949457626, 'psi': 0.17651854871585815}-{'f1_val': 0.0003711952487008166, 'auprc': 0.0003711952487008166, 'loss_val': 6.1459969384434965, 'psi': 0.0003711952487008166}
[S16] not sending this round → trigger blocked (psi=0.177)
[S16] r=40 psi=0.177 u=1.0000 p_local=0.3137 f1=0.177 auprc=0.177 bytes=0
[S17] START round=39 head_norm_before_train=1.890747 cos_to_last_merge=0.9597 (last merge round=21)
[S17] round=39 local utility u=0.620688 metrics={'f1_val': 0.4008466297622924, 'auprc': 0.4008466297622924, 'loss_val': 1.1647965239747546, 'psi': 0.4008466297622924}-{'f1_val': 0.26390742476816914, 'auprc': 0.26390742476816914, 'loss_val': 1.1737194523321246, 'psi': 0.26390742476816914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S17] r=40 psi=0.401 u=0.6207 p_local=0.1603 f1=0.401 auprc=0.401 bytes=19810
[S2] START round=40 head_norm_before_train=1.932122 cos_to_last_merge=0.9588 (last merge round=16)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.2535595067783909, 'auprc': 0.2535595067783909, 'loss_val': 2.5576828565683445, 'psi': 0.2535595067783909}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4747061446229046, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.639119 cos_to_last_merge=0.9495 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.25789912196372494, 'auprc': 0.25789912196372494, 'loss_val': 2.57948629577534, 'psi': 0.25789912196372494}-{'f1_val': 0.2559796437659033, 'auprc': 0.2559796437659033, 'loss_val': 2.551188788770743, 'psi': 0.2559796437659033}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.609786 cos_to_last_merge=0.8889 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.889
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3668654431539449, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.35392524772573, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.856642 (no previous merge yet)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7818121932167084, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7216982664408116, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.731045 cos_to_last_merge=0.9158 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.916
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.616661472501807, 'psi': 0.025658492279745686}-{'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.565693700372194, 'psi': 0.025658492279745686}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.760817 (no previous merge yet)
[S7] round=40 local utility u=0.024911 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7677396329683385, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.8175625504957287, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=40 head_norm_before_train=2.008050 cos_to_last_merge=0.9702 (last merge round=18)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.925226965913898, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8824764930462192, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.802383 cos_to_last_merge=0.9909 (last merge round=19)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.874768004363175, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8555391710776092, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.883754 cos_to_last_merge=0.9079 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.908
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.24446392053754018, 'auprc': 0.24446392053754018, 'loss_val': 2.169572639896671, 'psi': 0.24446392053754018}-{'f1_val': 0.25220012055455093, 'auprc': 0.25220012055455093, 'loss_val': 2.142215069400455, 'psi': 0.25220012055455093}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.957833 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 3.165815195830095, 'psi': 0.3317042898145993}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.1540337389921493, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.749663 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7835601544266866, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7577591643509716, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.997467 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.7117401023403405, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.683068533311612, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.071456 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6153054491055514, 'psi': 0.6150769866718802}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6254352011000865, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.864289 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.1712676830105755, 'auprc': 0.1712676830105755, 'loss_val': 3.8192419202785826, 'psi': 0.1712676830105755}-{'f1_val': 0.17651854871585815, 'auprc': 0.17651854871585815, 'loss_val': 3.5849906949457626, 'psi': 0.17651854871585815}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.895468 cos_to_last_merge=0.9592 (last merge round=21)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.2782571791739479, 'auprc': 0.2782571791739479, 'loss_val': 1.1253914349184027, 'psi': 0.2782571791739479}-{'f1_val': 0.4008466297622924, 'auprc': 0.4008466297622924, 'loss_val': 1.1647965239747546, 'psi': 0.4008466297622924}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.938689 cos_to_last_merge=0.9581 (last merge round=16)
[S2] round=41 local utility u=0.013989 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.4529385066939016, 'psi': 0.2450298816928894}-{'f1_val': 0.2535595067783909, 'auprc': 0.2535595067783909, 'loss_val': 2.5576828565683445, 'psi': 0.2535595067783909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=41 head_norm_before_train=1.651147 cos_to_last_merge=0.9478 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.25829642467424097, 'auprc': 0.25829642467424097, 'loss_val': 2.6027382390546254, 'psi': 0.25829642467424097}-{'f1_val': 0.25789912196372494, 'auprc': 0.25789912196372494, 'loss_val': 2.57948629577534, 'psi': 0.25789912196372494}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.619951 cos_to_last_merge=0.8872 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.887
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.378726146335119, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3668654431539449, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.872558 (no previous merge yet)
[S5] round=41 local utility u=0.013110 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.755592831959759, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7818121932167084, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=41 head_norm_before_train=1.738639 cos_to_last_merge=0.9144 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=41 local utility u=0.006531 metrics={'f1_val': 0.028655234657039712, 'auprc': 0.028655234657039712, 'loss_val': 5.630569522164303, 'psi': 0.028655234657039716}-{'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.616661472501807, 'psi': 0.025658492279745686}
[S6] not sending this round → trigger blocked (psi=0.029)
[S7] START round=41 head_norm_before_train=1.767968 (no previous merge yet)
[S7] round=41 local utility u=0.000401 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7669378343238327, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7677396329683385, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=41 head_norm_before_train=2.016589 cos_to_last_merge=0.9692 (last merge round=18)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9913354456572169, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.925226965913898, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.809267 cos_to_last_merge=0.9905 (last merge round=19)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.892445519582843, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.874768004363175, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.898653 cos_to_last_merge=0.9060 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=41 local utility u=0.017031 metrics={'f1_val': 0.2501195600191296, 'auprc': 0.2501195600191296, 'loss_val': 2.186411879744527, 'psi': 0.2501195600191296}-{'f1_val': 0.24446392053754018, 'auprc': 0.24446392053754018, 'loss_val': 2.169572639896671, 'psi': 0.24446392053754018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=41 head_norm_before_train=1.965046 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.187396276367388, 'psi': 0.33178150217256364}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 3.165815195830095, 'psi': 0.3317042898145993}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.757117 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.792245128649636, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.7835601544266866, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.003514 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.741158278660546, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.7117401023403405, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.085058 (no previous merge yet)
[S15] round=41 local utility u=0.006350 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6139212963305924, 'psi': 0.6163342951580373}-{'f1_val': 0.6150769866718802, 'auprc': 0.6150769866718802, 'loss_val': 0.6153054491055514, 'psi': 0.6150769866718802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=41 head_norm_before_train=1.869691 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.07507803515689174, 'auprc': 0.07507803515689174, 'loss_val': 5.525736811730315, 'psi': 0.07507803515689174}-{'f1_val': 0.1712676830105755, 'auprc': 0.1712676830105755, 'loss_val': 3.8192419202785826, 'psi': 0.1712676830105755}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.900542 cos_to_last_merge=0.9587 (last merge round=21)
[S17] round=41 local utility u=0.140157 metrics={'f1_val': 0.3255111440340413, 'auprc': 0.3255111440340413, 'loss_val': 1.2703626622619717, 'psi': 0.3255111440340413}-{'f1_val': 0.2782571791739479, 'auprc': 0.2782571791739479, 'loss_val': 1.1253914349184027, 'psi': 0.2782571791739479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=42 head_norm_before_train=1.945670 cos_to_last_merge=0.9574 (last merge round=16)
[S2] round=42 local utility u=0.537059 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4808501331117863, 'psi': 0.3674775928297055}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.4529385066939016, 'psi': 0.2450298816928894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=42 head_norm_before_train=1.662320 cos_to_last_merge=0.9461 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.24913323427439327, 'auprc': 0.24913323427439327, 'loss_val': 2.6174341641557515, 'psi': 0.24913323427439327}-{'f1_val': 0.25829642467424097, 'auprc': 0.25829642467424097, 'loss_val': 2.6027382390546254, 'psi': 0.25829642467424097}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.627788 cos_to_last_merge=0.8855 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.885
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.399974852273031, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.378726146335119, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.890907 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7600328378502885, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.755592831959759, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.745864 cos_to_last_merge=0.9131 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.913
[S6] round=42 local utility u=0.008925 metrics={'f1_val': 0.032034050179211467, 'auprc': 0.032034050179211467, 'loss_val': 5.643128756052269, 'psi': 0.032034050179211467}-{'f1_val': 0.028655234657039712, 'auprc': 0.028655234657039712, 'loss_val': 5.630569522164303, 'psi': 0.028655234657039716}
[S6] not sending this round → trigger blocked (psi=0.032)
[S7] START round=42 head_norm_before_train=1.775416 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7859854993358505, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7669378343238327, 'psi': 0.24962705121829937}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=2.022263 cos_to_last_merge=0.9680 (last merge round=18)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.004283575026036, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9913354456572169, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.815866 cos_to_last_merge=0.9901 (last merge round=19)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.908374690610828, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.892445519582843, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.912246 cos_to_last_merge=0.9044 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.2430579760659928, 'auprc': 0.2430579760659928, 'loss_val': 2.211706971706719, 'psi': 0.2430579760659928}-{'f1_val': 0.2501195600191296, 'auprc': 0.2501195600191296, 'loss_val': 2.186411879744527, 'psi': 0.2501195600191296}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.971827 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.2061695288107503, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.187396276367388, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.763452 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8239045762741024, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.792245128649636, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.009225 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.768394908822576, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.741158278660546, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.097717 (no previous merge yet)
[S15] round=42 local utility u=0.005775 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6023709217811333, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6139212963305924, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=42 head_norm_before_train=1.873991 (no previous merge yet)
[S16] round=42 local utility u=0.152632 metrics={'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 5.360206422918861, 'psi': 0.09060402684563758}-{'f1_val': 0.07507803515689174, 'auprc': 0.07507803515689174, 'loss_val': 5.525736811730315, 'psi': 0.07507803515689174}
[S16] not sending this round → trigger blocked (psi=0.091)
[S17] START round=42 head_norm_before_train=1.906342 cos_to_last_merge=0.9581 (last merge round=21)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.2935837943504502, 'auprc': 0.2935837943504502, 'loss_val': 1.0936997977071052, 'psi': 0.2935837943504502}-{'f1_val': 0.3255111440340413, 'auprc': 0.3255111440340413, 'loss_val': 1.2703626622619717, 'psi': 0.3255111440340413}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.952826 cos_to_last_merge=0.9567 (last merge round=16)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.4770533502722234, 'psi': 0.24516443956312162}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.4808501331117863, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.673218 cos_to_last_merge=0.9445 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.2429511561915112, 'auprc': 0.2429511561915112, 'loss_val': 2.636609114590818, 'psi': 0.2429511561915112}-{'f1_val': 0.24913323427439327, 'auprc': 0.24913323427439327, 'loss_val': 2.6174341641557515, 'psi': 0.24913323427439327}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.635321 cos_to_last_merge=0.8845 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.884
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4205306562208886, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.399974852273031, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.909355 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7984447305360134, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7600328378502885, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.752682 cos_to_last_merge=0.9118 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.03077268643306379, 'auprc': 0.03077268643306379, 'loss_val': 5.7017858952300555, 'psi': 0.030772686433063794}-{'f1_val': 0.032034050179211467, 'auprc': 0.032034050179211467, 'loss_val': 5.643128756052269, 'psi': 0.032034050179211467}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.784446 (no previous merge yet)
[S7] round=43 local utility u=0.004267 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7774520890397247, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7859854993358505, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=43 head_norm_before_train=2.031614 cos_to_last_merge=0.9673 (last merge round=18)
[S8] round=43 local utility u=0.016919 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9704447672882969, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.004283575026036, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=43 head_norm_before_train=1.822219 cos_to_last_merge=0.9897 (last merge round=19)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9243722277363937, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.908374690610828, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.925280 cos_to_last_merge=0.9028 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.903
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.24187767371950517, 'auprc': 0.24187767371950517, 'loss_val': 2.235208928526403, 'psi': 0.24187767371950517}-{'f1_val': 0.2430579760659928, 'auprc': 0.2430579760659928, 'loss_val': 2.211706971706719, 'psi': 0.2430579760659928}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.978560 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.2188873262819295, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.2061695288107503, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.772216 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8405578655265475, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8239045762741024, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.015000 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.793562986075448, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.768394908822576, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.109967 (no previous merge yet)
[S15] round=43 local utility u=0.006404 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5895630801201267, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6023709217811333, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=43 head_norm_before_train=1.879845 (no previous merge yet)
[S16] round=43 local utility u=0.652400 metrics={'f1_val': 0.14830782496227635, 'auprc': 0.14830782496227635, 'loss_val': 4.57474069075139, 'psi': 0.14830782496227635}-{'f1_val': 0.09060402684563758, 'auprc': 0.09060402684563758, 'loss_val': 5.360206422918861, 'psi': 0.09060402684563758}
[S16] not sending this round → trigger blocked (psi=0.148)
[S17] START round=43 head_norm_before_train=1.911935 cos_to_last_merge=0.9576 (last merge round=21)
[S17] round=43 local utility u=0.377142 metrics={'f1_val': 0.3938526501782188, 'auprc': 0.3938526501782188, 'loss_val': 1.2418357785421812, 'psi': 0.3938526501782188}-{'f1_val': 0.2935837943504502, 'auprc': 0.2935837943504502, 'loss_val': 1.0936997977071052, 'psi': 0.2935837943504502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=44 head_norm_before_train=1.959479 cos_to_last_merge=0.9560 (last merge round=16)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.19561157796451914, 'auprc': 0.19561157796451914, 'loss_val': 3.3263381909173337, 'psi': 0.19561157796451914}-{'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.4770533502722234, 'psi': 0.24516443956312162}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.683170 cos_to_last_merge=0.9431 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=44 local utility u=0.061852 metrics={'f1_val': 0.25779998718687935, 'auprc': 0.25779998718687935, 'loss_val': 2.646545179844773, 'psi': 0.25779998718687935}-{'f1_val': 0.2429511561915112, 'auprc': 0.2429511561915112, 'loss_val': 2.636609114590818, 'psi': 0.2429511561915112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] sending update (kind=head size=1787 to 1 peers)
[S4] START round=44 head_norm_before_train=1.647773 cos_to_last_merge=0.8830 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.883
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4375006875778413, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4205306562208886, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.929224 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8117583426170474, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7984447305360134, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.759428 cos_to_last_merge=0.9106 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.911
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 5.801383470840333, 'psi': 0.025442980463425715}-{'f1_val': 0.03077268643306379, 'auprc': 0.03077268643306379, 'loss_val': 5.7017858952300555, 'psi': 0.030772686433063794}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.796569 (no previous merge yet)
[S7] round=44 local utility u=0.010776 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7558994641163901, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7774520890397247, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=44 head_norm_before_train=2.041362 cos_to_last_merge=0.9666 (last merge round=18)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0065053668202406, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.9704447672882969, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.828493 cos_to_last_merge=0.9894 (last merge round=19)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.940994939950658, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9243722277363937, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.937213 cos_to_last_merge=0.9014 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.901
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.24187767371950517, 'auprc': 0.24187767371950517, 'loss_val': 2.2531732345538753, 'psi': 0.24187767371950517}-{'f1_val': 0.24187767371950517, 'auprc': 0.24187767371950517, 'loss_val': 2.235208928526403, 'psi': 0.24187767371950517}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.985098 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.23175653094571, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.2188873262819295, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.780634 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8473337435489012, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8405578655265475, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.020650 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.818507474584317, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.793562986075448, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.123295 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6028321637241999, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.5895630801201267, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.886566 (no previous merge yet)
[S16] round=44 local utility u=0.564576 metrics={'f1_val': 0.17831031681559706, 'auprc': 0.17831031681559706, 'loss_val': 3.7156110260261204, 'psi': 0.17831031681559706}-{'f1_val': 0.14830782496227635, 'auprc': 0.14830782496227635, 'loss_val': 4.57474069075139, 'psi': 0.14830782496227635}
[S16] not sending this round → trigger blocked (psi=0.178)
[S17] START round=44 head_norm_before_train=1.917813 cos_to_last_merge=0.9570 (last merge round=21)
[S17] round=44 local utility u=0.029037 metrics={'f1_val': 0.39959494932520523, 'auprc': 0.39959494932520523, 'loss_val': 1.2354417349517093, 'psi': 0.39959494932520523}-{'f1_val': 0.3938526501782188, 'auprc': 0.3938526501782188, 'loss_val': 1.2418357785421812, 'psi': 0.3938526501782188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=45 head_norm_before_train=1.965276 cos_to_last_merge=0.9554 (last merge round=16)
[S2] round=45 local utility u=0.626940 metrics={'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.517223209107243, 'psi': 0.2450298816928894}-{'f1_val': 0.19561157796451914, 'auprc': 0.19561157796451914, 'loss_val': 3.3263381909173337, 'psi': 0.19561157796451914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=45 head_norm_before_train=1.691738 cos_to_last_merge=0.9418 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.2558331743912518, 'auprc': 0.2558331743912518, 'loss_val': 2.6544308968688215, 'psi': 0.2558331743912518}-{'f1_val': 0.25779998718687935, 'auprc': 0.25779998718687935, 'loss_val': 2.646545179844773, 'psi': 0.25779998718687935}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.657840 cos_to_last_merge=0.8815 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.881
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4569304019266913, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4375006875778413, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.947428 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8560624621435204, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8117583426170474, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.766167 cos_to_last_merge=0.9094 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.829126833673242, 'psi': 0.025658492279745686}-{'f1_val': 0.025442980463425715, 'auprc': 0.025442980463425715, 'loss_val': 5.801383470840333, 'psi': 0.025442980463425715}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.806402 (no previous merge yet)
[S7] round=45 local utility u=0.011041 metrics={'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.733817038321571, 'psi': 0.24962705121829937}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.7558994641163901, 'psi': 0.24962705121829937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=45 head_norm_before_train=2.050228 cos_to_last_merge=0.9660 (last merge round=18)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.055193948602543, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0065053668202406, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.834537 cos_to_last_merge=0.9890 (last merge round=19)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9601180244621172, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.940994939950658, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.948266 cos_to_last_merge=0.9002 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.900
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 2.2720309120157713, 'psi': 0.2418357320386105}-{'f1_val': 0.24187767371950517, 'auprc': 0.24187767371950517, 'loss_val': 2.2531732345538753, 'psi': 0.24187767371950517}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.991606 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.241193199273827, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.23175653094571, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.787549 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8488681569089112, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8473337435489012, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.026101 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.841863929152834, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.818507474584317, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.135404 (no previous merge yet)
[S15] round=45 local utility u=0.013740 metrics={'f1_val': 0.6161135207492845, 'auprc': 0.6161135207492845, 'loss_val': 0.5733661517779546, 'psi': 0.6161135207492845}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6028321637241999, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=45 head_norm_before_train=1.892966 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.1433442147261516, 'auprc': 0.1433442147261516, 'loss_val': 4.436230677897994, 'psi': 0.1433442147261516}-{'f1_val': 0.17831031681559706, 'auprc': 0.17831031681559706, 'loss_val': 3.7156110260261204, 'psi': 0.17831031681559706}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.925784 cos_to_last_merge=0.9563 (last merge round=21)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.26748461368485493, 'auprc': 0.26748461368485493, 'loss_val': 1.2425819957828568, 'psi': 0.26748461368485493}-{'f1_val': 0.39959494932520523, 'auprc': 0.39959494932520523, 'loss_val': 1.2354417349517093, 'psi': 0.39959494932520523}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.971534 cos_to_last_merge=0.9547 (last merge round=16)
[S2] round=46 local utility u=0.520383 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.578486260823852, 'psi': 0.3674775928297055}-{'f1_val': 0.2450298816928894, 'auprc': 0.2450298816928894, 'loss_val': 2.517223209107243, 'psi': 0.2450298816928894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=46 head_norm_before_train=1.699021 cos_to_last_merge=0.9407 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.25154228855721394, 'auprc': 0.25154228855721394, 'loss_val': 2.735657805815278, 'psi': 0.25154228855721394}-{'f1_val': 0.2558331743912518, 'auprc': 0.2558331743912518, 'loss_val': 2.6544308968688215, 'psi': 0.2558331743912518}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.667566 cos_to_last_merge=0.8798 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.880
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4780345214374104, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4569304019266913, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.965187 (no previous merge yet)
[S5] round=46 local utility u=0.014794 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8264737249330825, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8560624621435204, 'psi': 0.3335071121394324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=46 head_norm_before_train=1.772774 cos_to_last_merge=0.9081 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=46 local utility u=0.006942 metrics={'f1_val': 0.028016267510167194, 'auprc': 0.028016267510167194, 'loss_val': 5.836462898693638, 'psi': 0.02801626751016719}-{'f1_val': 0.025658492279745686, 'auprc': 0.025658492279745686, 'loss_val': 5.829126833673242, 'psi': 0.025658492279745686}
[S6] not sending this round → trigger blocked (psi=0.028)
[S7] START round=46 head_norm_before_train=1.815602 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.7375727956639242, 'psi': 0.24944015924359295}-{'f1_val': 0.24962705121829937, 'auprc': 0.24962705121829937, 'loss_val': 0.733817038321571, 'psi': 0.24962705121829937}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.058006 cos_to_last_merge=0.9651 (last merge round=18)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.116998389040497, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.055193948602543, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.840744 cos_to_last_merge=0.9886 (last merge round=19)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9771683972646894, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9601180244621172, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.958575 cos_to_last_merge=0.8990 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.899
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 2.292820937967131, 'psi': 0.2418357320386105}-{'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 2.2720309120157713, 'psi': 0.2418357320386105}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.998357 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.2525640410637435, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.241193199273827, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.790653 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8642413938041713, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8488681569089112, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.031547 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.865003106323236, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 6.841863929152834, 'psi': 0.13592717296421}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.146733 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.584672572340471, 'psi': 0.6163342951580373}-{'f1_val': 0.6161135207492845, 'auprc': 0.6161135207492845, 'loss_val': 0.5733661517779546, 'psi': 0.6161135207492845}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.899302 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.050214224507283634, 'auprc': 0.050214224507283634, 'loss_val': 5.759795484783015, 'psi': 0.050214224507283634}-{'f1_val': 0.1433442147261516, 'auprc': 0.1433442147261516, 'loss_val': 4.436230677897994, 'psi': 0.1433442147261516}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.936433 cos_to_last_merge=0.9553 (last merge round=21)
[S17] round=46 local utility u=0.660124 metrics={'f1_val': 0.41215315093679994, 'auprc': 0.41215315093679994, 'loss_val': 1.2243508754259134, 'psi': 0.41215315093679994}-{'f1_val': 0.26748461368485493, 'auprc': 0.26748461368485493, 'loss_val': 1.2425819957828568, 'psi': 0.26748461368485493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=47 head_norm_before_train=1.977723 cos_to_last_merge=0.9541 (last merge round=16)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5924827982017744, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.578486260823852, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.706191 cos_to_last_merge=0.9397 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=47 local utility u=0.044405 metrics={'f1_val': 0.2555894308943089, 'auprc': 0.2555894308943089, 'loss_val': 2.6832725606344154, 'psi': 0.2555894308943089}-{'f1_val': 0.25154228855721394, 'auprc': 0.25154228855721394, 'loss_val': 2.735657805815278, 'psi': 0.25154228855721394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=47 head_norm_before_train=1.677143 cos_to_last_merge=0.8783 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.499494086608893, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4780345214374104, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.982181 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.831792469389126, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8264737249330825, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.779017 cos_to_last_merge=0.9070 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.907
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.028655234657039712, 'auprc': 0.028655234657039712, 'loss_val': 5.869123352826791, 'psi': 0.028655234657039716}-{'f1_val': 0.028016267510167194, 'auprc': 0.028016267510167194, 'loss_val': 5.836462898693638, 'psi': 0.02801626751016719}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.823078 (no previous merge yet)
[S7] round=47 local utility u=0.016878 metrics={'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.703816096250024, 'psi': 0.24944015924359295}-{'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.7375727956639242, 'psi': 0.24944015924359295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=47 head_norm_before_train=2.064130 cos_to_last_merge=0.9640 (last merge round=18)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.142232664200742, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.116998389040497, 'psi': 0.35939447907390915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.846625 cos_to_last_merge=0.9883 (last merge round=19)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9927146950709242, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9771683972646894, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.968450 cos_to_last_merge=0.8979 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.898
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 2.3107412933157616, 'psi': 0.2418357320386105}-{'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 2.292820937967131, 'psi': 0.2418357320386105}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.004886 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.265704446699225, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.2525640410637435, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.796709 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8968431278085012, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8642413938041713, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.036861 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.887950449863123, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.865003106323236, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.157461 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6291300937799431, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.584672572340471, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.904038 (no previous merge yet)
[S16] round=47 local utility u=0.423367 metrics={'f1_val': 0.09129359189210758, 'auprc': 0.09129359189210758, 'loss_val': 5.282776483664706, 'psi': 0.09129359189210758}-{'f1_val': 0.050214224507283634, 'auprc': 0.050214224507283634, 'loss_val': 5.759795484783015, 'psi': 0.050214224507283634}
[S16] not sending this round → trigger blocked (psi=0.091)
[S17] START round=47 head_norm_before_train=1.945450 cos_to_last_merge=0.9544 (last merge round=21)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.4085849267016768, 'auprc': 0.4085849267016768, 'loss_val': 1.2665202447463497, 'psi': 0.4085849267016768}-{'f1_val': 0.41215315093679994, 'auprc': 0.41215315093679994, 'loss_val': 1.2243508754259134, 'psi': 0.41215315093679994}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.983878 cos_to_last_merge=0.9535 (last merge round=16)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6220421005038475, 'psi': 0.3674775928297055}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.5924827982017744, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.712677 cos_to_last_merge=0.9387 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.706534937055935, 'psi': 0.24281921313058172}-{'f1_val': 0.2555894308943089, 'auprc': 0.2555894308943089, 'loss_val': 2.6832725606344154, 'psi': 0.2555894308943089}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.688408 cos_to_last_merge=0.8772 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5270903778040217, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.499494086608893, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.999289 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8748446774404033, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.831792469389126, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.785012 cos_to_last_merge=0.9060 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=48 local utility u=0.001848 metrics={'f1_val': 0.03077268643306379, 'auprc': 0.03077268643306379, 'loss_val': 5.884484318763735, 'psi': 0.030772686433063794}-{'f1_val': 0.028655234657039712, 'auprc': 0.028655234657039712, 'loss_val': 5.869123352826791, 'psi': 0.028655234657039716}
[S6] not sending this round → trigger blocked (psi=0.031)
[S7] START round=48 head_norm_before_train=1.833506 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.7337598217630069, 'psi': 0.24944015924359295}-{'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.703816096250024, 'psi': 0.24944015924359295}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.069323 cos_to_last_merge=0.9630 (last merge round=18)
[S8] round=48 local utility u=0.018909 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1044150876000085, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.142232664200742, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=48 head_norm_before_train=1.852291 cos_to_last_merge=0.9879 (last merge round=19)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.006569530031799, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9927146950709242, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.978057 cos_to_last_merge=0.8969 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.897
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 2.32893926781184, 'psi': 0.2418357320386105}-{'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 2.3107412933157616, 'psi': 0.2418357320386105}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.011029 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.2742749854630215, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.265704446699225, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.801186 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.916646609102268, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.8968431278085012, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.042070 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.9126936730049335, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.887950449863123, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.167820 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6515000467049522, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6291300937799431, 'psi': 0.6163342951580373}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.909000 (no previous merge yet)
[S16] round=48 local utility u=1.000000 metrics={'f1_val': 0.217196261682243, 'auprc': 0.217196261682243, 'loss_val': 3.042247004915249, 'psi': 0.217196261682243}-{'f1_val': 0.09129359189210758, 'auprc': 0.09129359189210758, 'loss_val': 5.282776483664706, 'psi': 0.09129359189210758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=48 head_norm_before_train=1.952364 cos_to_last_merge=0.9537 (last merge round=21)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.3976864547246121, 'auprc': 0.3976864547246121, 'loss_val': 1.331103013466118, 'psi': 0.3976864547246121}-{'f1_val': 0.4085849267016768, 'auprc': 0.4085849267016768, 'loss_val': 1.2665202447463497, 'psi': 0.4085849267016768}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.990088 cos_to_last_merge=0.9529 (last merge round=16)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.24516443956312162, 'auprc': 0.24516443956312162, 'loss_val': 2.5534804839334386, 'psi': 0.24516443956312162}-{'f1_val': 0.3674775928297055, 'auprc': 0.3674775928297055, 'loss_val': 2.6220421005038475, 'psi': 0.3674775928297055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.719672 cos_to_last_merge=0.9377 (last merge round=18)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=49 local utility u=0.037609 metrics={'f1_val': 0.251988227190181, 'auprc': 0.251988227190181, 'loss_val': 2.713838871099645, 'psi': 0.251988227190181}-{'f1_val': 0.24281921313058172, 'auprc': 0.24281921313058172, 'loss_val': 2.706534937055935, 'psi': 0.24281921313058172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=49 head_norm_before_train=1.701297 cos_to_last_merge=0.8763 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5478837160718735, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.5270903778040217, 'psi': 0.3567939207526687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=2.015058 (no previous merge yet)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.930186989081389, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8748446774404033, 'psi': 0.3335071121394324}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.790825 cos_to_last_merge=0.9050 (last merge round=20)
[S6] ⚠️ Model drifted since last merge! cos=0.905
[S6] round=49 local utility u=0.004723 metrics={'f1_val': 0.032452999104744855, 'auprc': 0.032452999104744855, 'loss_val': 5.8901605758739874, 'psi': 0.032452999104744855}-{'f1_val': 0.03077268643306379, 'auprc': 0.03077268643306379, 'loss_val': 5.884484318763735, 'psi': 0.030772686433063794}
[S6] not sending this round → trigger blocked (psi=0.032)
[S7] START round=49 head_norm_before_train=1.841631 (no previous merge yet)
[S7] round=49 local utility u=0.019002 metrics={'f1_val': 0.2491280518186348, 'auprc': 0.2491280518186348, 'loss_val': 0.6929461734570537, 'psi': 0.2491280518186348}-{'f1_val': 0.24944015924359295, 'auprc': 0.24944015924359295, 'loss_val': 0.7337598217630069, 'psi': 0.24944015924359295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=49 head_norm_before_train=2.074028 cos_to_last_merge=0.9621 (last merge round=18)
[S8] round=49 local utility u=0.001026 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1023633453870167, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1044150876000085, 'psi': 0.35939447907390915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=49 head_norm_before_train=1.857653 cos_to_last_merge=0.9876 (last merge round=19)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0210018841492734, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.006569530031799, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.987088 cos_to_last_merge=0.8959 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 2.3357803968489383, 'psi': 0.2418357320386105}-{'f1_val': 0.2418357320386105, 'auprc': 0.2418357320386105, 'loss_val': 2.32893926781184, 'psi': 0.2418357320386105}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.016756 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.2871236030322497, 'psi': 0.33178150217256364}-{'f1_val': 0.33178150217256364, 'auprc': 0.33178150217256364, 'loss_val': 3.2742749854630215, 'psi': 0.33178150217256364}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.805377 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.9352184441335274, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.916646609102268, 'psi': 0.3599362944611573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.046900 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.936081559006708, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.9126936730049335, 'psi': 0.13587634006482174}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.178228 (no previous merge yet)
[S15] round=49 local utility u=0.005058 metrics={'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6413835926848095, 'psi': 0.6163342951580373}-{'f1_val': 0.6163342951580373, 'auprc': 0.6163342951580373, 'loss_val': 0.6515000467049522, 'psi': 0.6163342951580373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=49 head_norm_before_train=1.914662 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.15687937248251008, 'auprc': 0.15687937248251008, 'loss_val': 4.349379869034458, 'psi': 0.15687937248251008}-{'f1_val': 0.217196261682243, 'auprc': 0.217196261682243, 'loss_val': 3.042247004915249, 'psi': 0.217196261682243}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.958095 cos_to_last_merge=0.9531 (last merge round=21)
[S17] round=49 local utility u=0.097617 metrics={'f1_val': 0.41355281704093244, 'auprc': 0.41355281704093244, 'loss_val': 1.2786670186387528, 'psi': 0.41355281704093244}-{'f1_val': 0.3976864547246121, 'auprc': 0.3976864547246121, 'loss_val': 1.331103013466118, 'psi': 0.3976864547246121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
