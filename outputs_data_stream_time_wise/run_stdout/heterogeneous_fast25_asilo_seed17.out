[S2] train labels: [(0, 458), (1, 246), (3, 104)]
[S2]   val labels: [(2, 1449), (3, 2009)]
✅ Loaded subject S2: train=808, val=3458
[S3] train labels: [(0, 456), (1, 256), (3, 109)]
[S3]   val labels: [(2, 1501), (3, 2012)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 463), (1, 56), (2, 149), (3, 163)]
[S4]   val labels: [(1, 1972), (3, 1583)]
✅ Loaded subject S4: train=831, val=3555
[S5] train labels: [(0, 479), (1, 55), (2, 150), (3, 159)]
[S5]   val labels: [(1, 2022), (3, 1583)]
✅ Loaded subject S5: train=843, val=3605
[S6] train labels: [(0, 472), (1, 260), (3, 104)]
[S6]   val labels: [(2, 1489), (3, 2089)]
✅ Loaded subject S6: train=836, val=3578
[S7] train labels: [(0, 474), (1, 54), (2, 149), (3, 159)]
[S7]   val labels: [(1, 2010), (3, 1567)]
✅ Loaded subject S7: train=836, val=3577
[S8] train labels: [(0, 468), (1, 65), (2, 148), (3, 160)]
[S8]   val labels: [(1, 2018), (3, 1579)]
✅ Loaded subject S8: train=841, val=3597
[S9] train labels: [(0, 472), (1, 258), (3, 107)]
[S9]   val labels: [(2, 1489), (3, 2090)]
✅ Loaded subject S9: train=837, val=3579
[S10] train labels: [(0, 472), (1, 80), (2, 149), (3, 159)]
[S10]   val labels: [(1, 2092), (3, 1587)]
✅ Loaded subject S10: train=860, val=3679
[S11] train labels: [(0, 472), (1, 272), (3, 101)]
[S11]   val labels: [(2, 1473), (3, 2141)]
✅ Loaded subject S11: train=845, val=3614
[S13] train labels: [(0, 472), (1, 61), (2, 153), (3, 159)]
[S13]   val labels: [(1, 2034), (3, 1583)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 472), (1, 270), (3, 103)]
[S14]   val labels: [(2, 1489), (3, 2128)]
✅ Loaded subject S14: train=845, val=3617
[S15] train labels: [(0, 470), (1, 69), (2, 149), (3, 159)]
[S15]   val labels: [(1, 2041), (3, 1583)]
✅ Loaded subject S15: train=847, val=3624
[S16] train labels: [(0, 472), (1, 269), (3, 102)]
[S16]   val labels: [(2, 1473), (3, 2134)]
✅ Loaded subject S16: train=843, val=3607
[S17] train labels: [(0, 472), (1, 85), (2, 149), (3, 135)]
[S17]   val labels: [(1, 2029), (3, 1571)]
✅ Loaded subject S17: train=841, val=3600
[S2] → join 127.0.0.1:50303
[S3] → join 127.0.0.1:50302
[S4] → join 127.0.0.1:50302
[S5] → join 127.0.0.1:50302
[S6] → join 127.0.0.1:50302
[S7] → join 127.0.0.1:50302
[S8] → join 127.0.0.1:50302
[S9] → join 127.0.0.1:50302
[S10] → join 127.0.0.1:50302
[S11] → join 127.0.0.1:50302
[S13] → join 127.0.0.1:50302
[S14] → join 127.0.0.1:50302
[S15] → join 127.0.0.1:50302
[S16] → join 127.0.0.1:50302
[S17] → join 127.0.0.1:50302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.165216 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.162799 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.181197 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.182558 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.185845 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.139974 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.189899 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.173086 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.241557 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.154569 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.188098 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.168891 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.139991 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.208200 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.106778 (no previous merge yet)
[S10]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3] + discovered S17
[S3] + discovered S11
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S10
[S3] + discovered S15
[S3] + discovered S16
[S3] + discovered S6
[S3] + discovered S9
[S3] + discovered S13
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S4
[S4] + discovered S5
[S4] + discovered S10
[S4] + discovered S15
[S4] + discovered S8
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S7
[S4] + discovered S9
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S11
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S6] + discovered S2
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S3
[S5] + discovered S13
[S5] + discovered S14
[S5] + discovered S9
[S5] + discovered S6
[S5] + discovered S15
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S7
[S5] + discovered S16
[S5] + discovered S8
[S5] + discovered S10
[S6] + discovered S16
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S15
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S17
[S6] + discovered S14
[S6] + discovered S13
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S2
[S7] + discovered S6
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S5
[S7] + discovered S15
[S7] + discovered S9
[S8] + discovered S7
[S7] + discovered S8
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S11
[S9] + discovered S7
[S9] + discovered S3
[S9] + discovered S4
[S9] + discovered S8
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S2
[S8] + discovered S17
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S15
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S7
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S10
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S17
[S9] + discovered S13
[S11] + discovered S7
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S3
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S2
[S11] + discovered S4
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S15
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S16
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S11
[S13] + discovered S7
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S10
[S14] + discovered S6
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S14
[S14] + discovered S7
[S14] + discovered S11
[S14] + discovered S5
[S14] + discovered S4
[S13] + discovered S15
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S3
[S14] + discovered S13
[S15] + discovered S10
[S15] + discovered S3
[S15] + discovered S13
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S11
[S15] + discovered S2
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S8
[S14] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S15] + discovered S17
[S16] + discovered S9
[S16] + discovered S8
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S6
[S16] + discovered S2
[S16] + discovered S10
[S16] + discovered S15
[S16] + discovered S7
[S16] + discovered S5
[S16] + discovered S4
[S16] + discovered S14
[S16] + discovered S11
[S15] + discovered S16
[S17] + discovered S2
[S16] + discovered S17
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S14
[S17] + discovered S13
[S17] + discovered S7
[S17] + discovered S15
[S17] + discovered S16
[S17] + discovered S8
[S17] + discovered S4
[S17] + discovered S10
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=1.000 → S8@127.0.0.1:50309
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:50304
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:50309
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:50303
[S3] ⇄ pheromone p=1.000 → S6@127.0.0.1:50307
[S11] ⇄ pheromone p=1.000 → S10@127.0.0.1:50311
[S15] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:50308
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:50305
[S14] ⇄ pheromone p=1.000 → S13@127.0.0.1:50313
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:50316
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:50303
[S8] ⇄ pheromone p=1.000 → S16@127.0.0.1:50316
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:50314
[S2] START round=1 head_norm_before_train=1.159593 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4437339384442542, 'psi': 0.0}-{'f1_val': 0.29529243937232524, 'auprc': 0.29529243937232524, 'loss_val': 1.3838328777882845, 'psi': 0.29529243937232524}
[S3] START round=1 head_norm_before_train=1.170460 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6366245339139276, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3965299900654682, 'psi': 0.0}
[S4] START round=1 head_norm_before_train=1.194867 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4354353368860773, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4115559952321224, 'psi': 0.0}
[S5] START round=1 head_norm_before_train=1.204946 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.581726077584103, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4404522539356552, 'psi': 0.0}
[S6] START round=1 head_norm_before_train=1.203122 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6001766728037996, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4599850240005352, 'psi': 0.0}
[S7] START round=1 head_norm_before_train=1.159346 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5969603955505878, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4426688097184692, 'psi': 0.0}
[S8] START round=1 head_norm_before_train=1.197607 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.2574386565582457, 'auprc': 0.2574386565582457, 'loss_val': 1.4553916404656422, 'psi': 0.2574386565582457}-{'f1_val': 0.30506182380216385, 'auprc': 0.30506182380216385, 'loss_val': 1.4108485755749343, 'psi': 0.30506182380216385}
[S9] START round=1 head_norm_before_train=1.179893 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6101005738278071, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4431765300498078, 'psi': 0.0}
[S10] START round=1 head_norm_before_train=1.254534 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5443848646340594, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4836249419714491, 'psi': 0.0}
[S11] START round=1 head_norm_before_train=1.159812 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.598303771482711, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4970904406981962, 'psi': 0.0}
[S13] START round=1 head_norm_before_train=1.192086 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4955490839987426, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4429918890859013, 'psi': 0.0}
[S14] START round=1 head_norm_before_train=1.177520 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5840137461025974, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4680173639716267, 'psi': 0.0}
[S15] START round=1 head_norm_before_train=1.142609 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4284696875271952, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3743371781930227, 'psi': 0.0}
[S16] START round=1 head_norm_before_train=1.216274 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6037797213213376, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5139909592104601, 'psi': 0.0}
[S17] START round=1 head_norm_before_train=1.105266 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.002583979328165375, 'auprc': 0.002583979328165375, 'loss_val': 1.3795381305301744, 'psi': 0.002583979328165375}-{'f1_val': 0.3604547877065198, 'auprc': 0.3604547877065198, 'loss_val': 1.3355460552217386, 'psi': 0.3604547877065198}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=2 head_norm_before_train=1.166062 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.551870671325485, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4437339384442542, 'psi': 0.0}
[S3] START round=2 head_norm_before_train=1.223023 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.801311752700612, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6366245339139276, 'psi': 0.0}
[S4] START round=2 head_norm_before_train=1.219709 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4758686986358236, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4354353368860773, 'psi': 0.0}
[S5] START round=2 head_norm_before_train=1.255276 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8227803010332484, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.581726077584103, 'psi': 0.0}
[S6] START round=2 head_norm_before_train=1.231794 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9376747794262181, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6001766728037996, 'psi': 0.0}
[S7] START round=2 head_norm_before_train=1.206784 (no previous merge yet)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9727103436355287, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5969603955505878, 'psi': 0.0}
[S8] START round=2 head_norm_before_train=1.213285 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5578587930485703, 'psi': 0.0}-{'f1_val': 0.2574386565582457, 'auprc': 0.2574386565582457, 'loss_val': 1.4553916404656422, 'psi': 0.2574386565582457}
[S9] START round=2 head_norm_before_train=1.227045 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.37929125110965, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6101005738278071, 'psi': 0.0}
[S10] START round=2 head_norm_before_train=1.274747 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6410753681939305, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5443848646340594, 'psi': 0.0}
[S11] START round=2 head_norm_before_train=1.177127 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7742307228337826, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.598303771482711, 'psi': 0.0}
[S13] START round=2 head_norm_before_train=1.207196 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5954986166876142, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4955490839987426, 'psi': 0.0}
[S14] START round=2 head_norm_before_train=1.197225 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.819337410618383, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5840137461025974, 'psi': 0.0}
[S15] START round=2 head_norm_before_train=1.155721 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.544162004597909, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4284696875271952, 'psi': 0.0}
[S16] START round=2 head_norm_before_train=1.235651 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7767378695372602, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6037797213213376, 'psi': 0.0}
[S17] START round=2 head_norm_before_train=1.118149 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4466142683515375, 'psi': 0.0}-{'f1_val': 0.002583979328165375, 'auprc': 0.002583979328165375, 'loss_val': 1.3795381305301744, 'psi': 0.002583979328165375}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.185169 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.821547114570181, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.551870671325485, 'psi': 0.0}
[S3] START round=3 head_norm_before_train=1.293599 (no previous merge yet)
[S3] round=3 local utility u=0.147315 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.506681093215491, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.801311752700612, 'psi': 0.0}
[S4] START round=3 head_norm_before_train=1.255690 (no previous merge yet)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5844625123993652, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4758686986358236, 'psi': 0.0}
[S5] START round=3 head_norm_before_train=1.295815 (no previous merge yet)
[S5] round=3 local utility u=0.543745 metrics={'f1_val': 0.10322121373909948, 'auprc': 0.10322121373909948, 'loss_val': 1.664281784429984, 'psi': 0.10322121373909948}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8227803010332484, 'psi': 0.0}
[S6] START round=3 head_norm_before_train=1.271696 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8814884147069044, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9376747794262181, 'psi': 0.0}
[S7] START round=3 head_norm_before_train=1.253721 (no previous merge yet)
[S7] round=3 local utility u=0.175580 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6215500145863346, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9727103436355287, 'psi': 0.0}
[S8] START round=3 head_norm_before_train=1.239326 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7707952262111448, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5578587930485703, 'psi': 0.0}
[S9] START round=3 head_norm_before_train=1.304681 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8237386346521305, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.37929125110965, 'psi': 0.0}
[S10] START round=3 head_norm_before_train=1.303490 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8271608098627765, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6410753681939305, 'psi': 0.0}
[S11] START round=3 head_norm_before_train=1.205330 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1862394830364584, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7742307228337826, 'psi': 0.0}
[S13] START round=3 head_norm_before_train=1.230098 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7752556614119221, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5954986166876142, 'psi': 0.0}
[S14] START round=3 head_norm_before_train=1.224835 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4431036659212872, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.819337410618383, 'psi': 0.0}
[S15] START round=3 head_norm_before_train=1.177364 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8369345404637816, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.544162004597909, 'psi': 0.0}
[S16] START round=3 head_norm_before_train=1.268243 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1860837517604814, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7767378695372602, 'psi': 0.0}
[S17] START round=3 head_norm_before_train=1.144301 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6043828549661299, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4466142683515375, 'psi': 0.0}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → trigger blocked (psi=0.103)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=4 head_norm_before_train=1.215156 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3380386647329194, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.821547114570181, 'psi': 0.0}
[S3] START round=4 head_norm_before_train=1.323856 (no previous merge yet)
[S3] round=4 local utility u=0.173654 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1593735931347284, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.506681093215491, 'psi': 0.0}
[S4] START round=4 head_norm_before_train=1.296953 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6169060454170125, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5844625123993652, 'psi': 0.0}
[S5] START round=4 head_norm_before_train=1.307974 (no previous merge yet)
[S5] round=4 local utility u=1.000000 metrics={'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.5514930654609063, 'psi': 0.3332280812546048}-{'f1_val': 0.10322121373909948, 'auprc': 0.10322121373909948, 'loss_val': 1.664281784429984, 'psi': 0.10322121373909948}
[S6] START round=4 head_norm_before_train=1.317270 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2885291222394115, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8814884147069044, 'psi': 0.0}
[S7] START round=4 head_norm_before_train=1.258985 (no previous merge yet)
[S7] round=4 local utility u=0.004699 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6121515868395766, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6215500145863346, 'psi': 0.0}
[S8] START round=4 head_norm_before_train=1.271940 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8701588305281573, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7707952262111448, 'psi': 0.0}
[S9] START round=4 head_norm_before_train=1.370645 (no previous merge yet)
[S9] round=4 local utility u=0.208599 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.40654139771262, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8237386346521305, 'psi': 0.0}
[S10] START round=4 head_norm_before_train=1.335248 (no previous merge yet)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.942873950433684, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8271608098627765, 'psi': 0.0}
[S11] START round=4 head_norm_before_train=1.241897 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8578445077993235, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1862394830364584, 'psi': 0.0}
[S13] START round=4 head_norm_before_train=1.254711 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.91347783058569, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7752556614119221, 'psi': 0.0}
[S14] START round=4 head_norm_before_train=1.260059 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0742040902057357, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.4431036659212872, 'psi': 0.0}
[S15] START round=4 head_norm_before_train=1.204760 (no previous merge yet)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.111222007389892, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8369345404637816, 'psi': 0.0}
[S16] START round=4 head_norm_before_train=1.310665 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7074157579062383, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1860837517604814, 'psi': 0.0}
[S17] START round=4 head_norm_before_train=1.180673 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9501162974900195, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6043828549661299, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:50303
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=-0.0161
[S3] DROPPED delta from S5 (cos=-0.0161 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=1.248990 (no previous merge yet)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6367193288564703, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3380386647329194, 'psi': 0.0}
[S3] START round=5 head_norm_before_train=1.361004 (no previous merge yet)
[S3] round=5 local utility u=0.025815 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.107744440635413, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1593735931347284, 'psi': 0.0}
[S4] START round=5 head_norm_before_train=1.328902 (no previous merge yet)
[S4] round=5 local utility u=0.062363 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4921803175885784, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6169060454170125, 'psi': 0.0}
[S5] START round=5 head_norm_before_train=1.334286 (no previous merge yet)
[S5] round=5 local utility u=0.000000 metrics={'f1_val': 0.14825999424791486, 'auprc': 0.14825999424791486, 'loss_val': 1.3251095092246286, 'psi': 0.14825999424791486}-{'f1_val': 0.3332280812546048, 'auprc': 0.3332280812546048, 'loss_val': 1.5514930654609063, 'psi': 0.3332280812546048}
[S6] START round=5 head_norm_before_train=1.341809 (no previous merge yet)
[S6] round=5 local utility u=0.235910 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8167100474661186, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2885291222394115, 'psi': 0.0}
[S7] START round=5 head_norm_before_train=1.290642 (no previous merge yet)
[S7] round=5 local utility u=0.043387 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5253772115964646, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6121515868395766, 'psi': 0.0}
[S8] START round=5 head_norm_before_train=1.295428 (no previous merge yet)
[S8] round=5 local utility u=0.129643 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.610873257328771, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.8701588305281573, 'psi': 0.0}
[S9] START round=5 head_norm_before_train=1.434151 (no previous merge yet)
[S9] round=5 local utility u=0.237190 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.932160442043085, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.40654139771262, 'psi': 0.0}
[S10] START round=5 head_norm_before_train=1.360931 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.961926382014868, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.942873950433684, 'psi': 0.0}
[S11] START round=5 head_norm_before_train=1.273422 (no previous merge yet)
[S11] round=5 local utility u=0.025064 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8077163303893777, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8578445077993235, 'psi': 0.0}
[S13] START round=5 head_norm_before_train=1.270682 (no previous merge yet)
[S13] round=5 local utility u=0.075733 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7620124758714515, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.91347783058569, 'psi': 0.0}
[S14] START round=5 head_norm_before_train=1.284453 (no previous merge yet)
[S14] round=5 local utility u=0.019897 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0344099523052983, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0742040902057357, 'psi': 0.0}
[S15] START round=5 head_norm_before_train=1.226976 (no previous merge yet)
[S15] round=5 local utility u=0.102665 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9058915081074619, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.111222007389892, 'psi': 0.0}
[S16] START round=5 head_norm_before_train=1.350518 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8072008544370974, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7074157579062383, 'psi': 0.0}
[S17] START round=5 head_norm_before_train=1.218404 (no previous merge yet)
[S17] round=5 local utility u=0.126826 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6964652284270556, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9501162974900195, 'psi': 0.0}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.000)
[S8] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.000)
[S6] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → trigger blocked (psi=0.000)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S4] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → trigger blocked (psi=0.000)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S17] not sending this round → trigger blocked (psi=0.000)
[S2] ⇄ pheromone p=0.328 → S5@127.0.0.1:50305
[S8] ⇄ pheromone p=0.354 → S16@127.0.0.1:50316
[S10] ⇄ pheromone p=0.328 → S7@127.0.0.1:50308
[S5] ⇄ pheromone p=0.557 → S3@127.0.0.1:50303
[S3] ⇄ pheromone p=0.379 → S6@127.0.0.1:50307
[S6] ⇄ pheromone p=0.375 → S7@127.0.0.1:50308
[S7] ⇄ pheromone p=0.360 → S8@127.0.0.1:50309
[S11] ⇄ pheromone p=0.333 → S10@127.0.0.1:50311
[S14] ⇄ pheromone p=0.332 → S13@127.0.0.1:50313
[S4] ⇄ pheromone p=0.340 → S8@127.0.0.1:50309
[S13] ⇄ pheromone p=0.343 → S16@127.0.0.1:50316
[S17] ⇄ pheromone p=0.353 → S14@127.0.0.1:50314
[S9] ⇄ pheromone p=0.408 → S3@127.0.0.1:50303
[S15] ⇄ pheromone p=0.348 → S7@127.0.0.1:50308
[S16] ⇄ pheromone p=0.328 → S4@127.0.0.1:50304
[S2] START round=6 head_norm_before_train=1.276008 (no previous merge yet)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.676937519113807, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.6367193288564703, 'psi': 0.0}
[S3] START round=6 head_norm_before_train=1.413530 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1973707444171415, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.107744440635413, 'psi': 0.0}
[S4] START round=6 head_norm_before_train=1.354991 (no previous merge yet)
[S4] round=6 local utility u=0.037823 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4165339658198637, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4921803175885784, 'psi': 0.0}
[S5] START round=6 head_norm_before_train=1.360636 (no previous merge yet)
[S5] round=6 local utility u=1.000000 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2230198374158887, 'psi': 0.35933890172383154}-{'f1_val': 0.14825999424791486, 'auprc': 0.14825999424791486, 'loss_val': 1.3251095092246286, 'psi': 0.14825999424791486}
[S6] START round=6 head_norm_before_train=1.352964 (no previous merge yet)
[S6] round=6 local utility u=0.038703 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7393047652130926, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8167100474661186, 'psi': 0.0}
[S7] START round=6 head_norm_before_train=1.325139 (no previous merge yet)
[S7] round=6 local utility u=0.024588 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.476200619380122, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.5253772115964646, 'psi': 0.0}
[S8] START round=6 head_norm_before_train=1.296664 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.26264138389886893, 'auprc': 0.26264138389886893, 'loss_val': 1.4688441515516395, 'psi': 0.26264138389886893}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.610873257328771, 'psi': 0.0}
[S9] START round=6 head_norm_before_train=1.488996 (no previous merge yet)
[S9] round=6 local utility u=0.579848 metrics={'f1_val': 0.11680401289860265, 'auprc': 0.11680401289860265, 'loss_val': 1.8237007488853294, 'psi': 0.11680401289860265}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.932160442043085, 'psi': 0.0}
[S10] START round=6 head_norm_before_train=1.388743 (no previous merge yet)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.121739058937194, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.961926382014868, 'psi': 0.0}
[S11] START round=6 head_norm_before_train=1.287369 (no previous merge yet)
[S11] round=6 local utility u=0.193274 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.421167906704258, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8077163303893777, 'psi': 0.0}
[S13] START round=6 head_norm_before_train=1.268567 (no previous merge yet)
[S13] round=6 local utility u=0.052112 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6577881900779263, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7620124758714515, 'psi': 0.0}
[S14] START round=6 head_norm_before_train=1.296308 (no previous merge yet)
[S14] round=6 local utility u=0.011344 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.011722816405416, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0344099523052983, 'psi': 0.0}
[S15] START round=6 head_norm_before_train=1.236672 (no previous merge yet)
[S15] round=6 local utility u=0.092316 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7212591253129126, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9058915081074619, 'psi': 0.0}
[S16] START round=6 head_norm_before_train=1.387689 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0755977259239584, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.8072008544370974, 'psi': 0.0}
[S17] START round=6 head_norm_before_train=1.231961 (no previous merge yet)
[S17] round=6 local utility u=0.101833 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.492799111182784, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6964652284270556, 'psi': 0.0}
[S13] not sending this round → trigger blocked (psi=0.000)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:50316
[S6] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → trigger blocked (psi=0.117)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[S14] not sending this round → trigger blocked (psi=0.000)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S8
[S16] cosine check vs S8: cos=0.0166
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0094
[S3] DROPPED delta from S5 (cos=-0.0094 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.000)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.0000 head_norm=1.426941
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.588953e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.0000 head_norm=0.974904 delta_norm=0.958895
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.302664 (no previous merge yet)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.911596535230579, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.676937519113807, 'psi': 0.0}
[S3] START round=7 head_norm_before_train=1.473433 (no previous merge yet)
[S3] round=7 local utility u=0.753925 metrics={'f1_val': 0.13365091967712053, 'auprc': 0.13365091967712053, 'loss_val': 1.8923791465221271, 'psi': 0.13365091967712053}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.1973707444171415, 'psi': 0.0}
[S4] START round=7 head_norm_before_train=1.392070 (no previous merge yet)
[S4] round=7 local utility u=0.020037 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3764605631761824, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4165339658198637, 'psi': 0.0}
[S5] START round=7 head_norm_before_train=1.400666 (no previous merge yet)
[S5] round=7 local utility u=0.029875 metrics={'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1632698538362718, 'psi': 0.35933890172383154}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.2230198374158887, 'psi': 0.35933890172383154}
[S6] START round=7 head_norm_before_train=1.372040 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.095969779663258, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.7393047652130926, 'psi': 0.0}
[S7] START round=7 head_norm_before_train=1.360816 (no previous merge yet)
[S7] round=7 local utility u=1.000000 metrics={'f1_val': 0.24935118862244368, 'auprc': 0.24935118862244368, 'loss_val': 1.3758786639837615, 'psi': 0.24935118862244365}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.476200619380122, 'psi': 0.0}
[S8] START round=7 head_norm_before_train=1.305249 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.23206937095825986, 'auprc': 0.23206937095825986, 'loss_val': 1.4109380334799444, 'psi': 0.23206937095825986}-{'f1_val': 0.26264138389886893, 'auprc': 0.26264138389886893, 'loss_val': 1.4688441515516395, 'psi': 0.26264138389886893}
[S9] START round=7 head_norm_before_train=1.546152 (no previous merge yet)
[S9] round=7 local utility u=0.324425 metrics={'f1_val': 0.18503566141838246, 'auprc': 0.18503566141838246, 'loss_val': 1.7889353100264482, 'psi': 0.18503566141838246}-{'f1_val': 0.11680401289860265, 'auprc': 0.11680401289860265, 'loss_val': 1.8237007488853294, 'psi': 0.11680401289860265}
[S10] START round=7 head_norm_before_train=1.418377 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.550939119876462, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.121739058937194, 'psi': 0.0}
[S11] START round=7 head_norm_before_train=1.297728 (no previous merge yet)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5534221735356275, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.421167906704258, 'psi': 0.0}
[S13] START round=7 head_norm_before_train=1.269318 (no previous merge yet)
[S13] round=7 local utility u=0.022804 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6121799284512923, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6577881900779263, 'psi': 0.0}
[S14] START round=7 head_norm_before_train=1.311055 (no previous merge yet)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.042088467011273, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.011722816405416, 'psi': 0.0}
[S15] START round=7 head_norm_before_train=1.247500 (no previous merge yet)
[S15] round=7 local utility u=0.013380 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.69449836006133, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.7212591253129126, 'psi': 0.0}
[S16] START round=7 head_norm_before_train=0.974904 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.464777 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.146044324739957, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.0755977259239584, 'psi': 0.0}
[S17] START round=7 head_norm_before_train=1.244488 (no previous merge yet)
[S17] round=7 local utility u=0.113500 metrics={'f1_val': 0.0198226395409494, 'auprc': 0.0198226395409494, 'loss_val': 1.4442033618795822, 'psi': 0.0198226395409494}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.492799111182784, 'psi': 0.0}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[S16] not sending this round → trigger blocked (psi=0.000)
[S15] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → trigger blocked (psi=0.134)
[S9] not sending this round → trigger blocked (psi=0.185)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:50309
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0069
[S3] DROPPED delta from S5 (cos=-0.0069 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] cosine check vs S7: cos=-0.1300
[S8] DROPPED delta from S7 (cos=-0.1300 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.020)
[S2] START round=8 head_norm_before_train=1.335579 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.170360290576311, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.911596535230579, 'psi': 0.0}
[S3] START round=8 head_norm_before_train=1.524148 (no previous merge yet)
[S3] round=8 local utility u=0.649075 metrics={'f1_val': 0.2596464059878694, 'auprc': 0.2596464059878694, 'loss_val': 1.7281880217369683, 'psi': 0.2596464059878694}-{'f1_val': 0.13365091967712053, 'auprc': 0.13365091967712053, 'loss_val': 1.8923791465221271, 'psi': 0.13365091967712053}
[S4] START round=8 head_norm_before_train=1.433802 (no previous merge yet)
[S4] round=8 local utility u=0.008330 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3598010818473694, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3764605631761824, 'psi': 0.0}
[S5] START round=8 head_norm_before_train=1.445373 (no previous merge yet)
[S5] round=8 local utility u=0.072291 metrics={'f1_val': 0.37173503946376896, 'auprc': 0.37173503946376896, 'loss_val': 1.1302540020138627, 'psi': 0.37173503946376896}-{'f1_val': 0.35933890172383154, 'auprc': 0.35933890172383154, 'loss_val': 1.1632698538362718, 'psi': 0.35933890172383154}
[S6] START round=8 head_norm_before_train=1.398498 (no previous merge yet)
[S6] round=8 local utility u=0.053344 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9892817957837856, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.095969779663258, 'psi': 0.0}
[S7] START round=8 head_norm_before_train=1.385644 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.24315212810788034, 'auprc': 0.24315212810788034, 'loss_val': 1.3879136559707457, 'psi': 0.24315212810788034}-{'f1_val': 0.24935118862244368, 'auprc': 0.24935118862244368, 'loss_val': 1.3758786639837615, 'psi': 0.24935118862244365}
[S8] START round=8 head_norm_before_train=1.330258 (no previous merge yet)
[S8] round=8 local utility u=0.014628 metrics={'f1_val': 0.22750522296664508, 'auprc': 0.22750522296664508, 'loss_val': 1.3406055399806875, 'psi': 0.22750522296664508}-{'f1_val': 0.23206937095825986, 'auprc': 0.23206937095825986, 'loss_val': 1.4109380334799444, 'psi': 0.23206937095825986}
[S9] START round=8 head_norm_before_train=1.602669 (no previous merge yet)
[S9] round=8 local utility u=0.773424 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.894811408323221, 'psi': 0.36867172340800847}-{'f1_val': 0.18503566141838246, 'auprc': 0.18503566141838246, 'loss_val': 1.7889353100264482, 'psi': 0.18503566141838246}
[S10] START round=8 head_norm_before_train=1.452596 (no previous merge yet)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.94580076564943, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.550939119876462, 'psi': 0.0}
[S11] START round=8 head_norm_before_train=1.320196 (no previous merge yet)
[S11] round=8 local utility u=0.162527 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.228368732729957, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.5534221735356275, 'psi': 0.0}
[S13] START round=8 head_norm_before_train=1.278598 (no previous merge yet)
[S13] round=8 local utility u=0.022106 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.567968159811756, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.6121799284512923, 'psi': 0.0}
[S14] START round=8 head_norm_before_train=1.328940 (no previous merge yet)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.14307572853284, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.042088467011273, 'psi': 0.0}
[S15] START round=8 head_norm_before_train=1.269240 (no previous merge yet)
[S15] round=8 local utility u=0.112138 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4702220344341397, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.69449836006133, 'psi': 0.0}
[S16] START round=8 head_norm_before_train=1.020373 cos_to_last_merge=0.9976 (last merge round=6)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.186691974609722, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.146044324739957, 'psi': 0.0}
[S17] START round=8 head_norm_before_train=1.274862 (no previous merge yet)
[S17] round=8 local utility u=0.914969 metrics={'f1_val': 0.21145854622249471, 'auprc': 0.21145854622249471, 'loss_val': 1.3389875507023377, 'psi': 0.21145854622249471}-{'f1_val': 0.0198226395409494, 'auprc': 0.0198226395409494, 'loss_val': 1.4442033618795822, 'psi': 0.0198226395409494}
[S4] not sending this round → trigger blocked (psi=0.000)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.000)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:50303
[S6] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:50316
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] cosine check vs S8: cos=0.6247
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=-0.0035
[S3] DROPPED delta from S5 (cos=-0.0035 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] cosine check vs S3: cos=-0.1057
[S6] DROPPED delta from S3 (cos=-0.1057 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=0.0353
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1807 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1807) from S17
[S14] cosine check vs S17: cos=-0.0249
[S14] DROPPED delta from S17 (cos=-0.0249 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.2596 head_norm=1.570781
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.120028e+00
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.2606 head_norm=1.160266 delta_norm=1.120028
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.0000 head_norm=1.075275
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.437796e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.1024 head_norm=1.100569 delta_norm=0.543780
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.370716 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3055649600392436, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.170360290576311, 'psi': 0.0}
[S3] START round=9 head_norm_before_train=1.160266 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.20845624385447395, 'auprc': 0.20845624385447395, 'loss_val': 1.9516876307089286, 'psi': 0.20845624385447395}-{'f1_val': 0.2596464059878694, 'auprc': 0.2596464059878694, 'loss_val': 1.7281880217369683, 'psi': 0.2596464059878694}
[S4] START round=9 head_norm_before_train=1.474956 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3630636598051735, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3598010818473694, 'psi': 0.0}
[S5] START round=9 head_norm_before_train=1.488338 (no previous merge yet)
[S5] round=9 local utility u=1.000000 metrics={'f1_val': 0.6643828018474133, 'auprc': 0.6643828018474133, 'loss_val': 1.1029363646817705, 'psi': 0.6643828018474133}-{'f1_val': 0.37173503946376896, 'auprc': 0.37173503946376896, 'loss_val': 1.1302540020138627, 'psi': 0.37173503946376896}
[S6] START round=9 head_norm_before_train=1.424555 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.562322789256681, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9892817957837856, 'psi': 0.0}
[S7] START round=9 head_norm_before_train=1.420678 (no previous merge yet)
[S7] round=9 local utility u=0.277278 metrics={'f1_val': 0.2997444322745528, 'auprc': 0.2997444322745528, 'loss_val': 1.3426876698723451, 'psi': 0.2997444322745528}-{'f1_val': 0.24315212810788034, 'auprc': 0.24315212810788034, 'loss_val': 1.3879136559707457, 'psi': 0.24315212810788034}
[S8] START round=9 head_norm_before_train=1.362967 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.2039656397339017, 'auprc': 0.2039656397339017, 'loss_val': 1.2410301479519439, 'psi': 0.2039656397339017}-{'f1_val': 0.22750522296664508, 'auprc': 0.22750522296664508, 'loss_val': 1.3406055399806875, 'psi': 0.22750522296664508}
[S9] START round=9 head_norm_before_train=1.653482 (no previous merge yet)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0739373744318272, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 1.894811408323221, 'psi': 0.36867172340800847}
[S10] START round=9 head_norm_before_train=1.486765 (no previous merge yet)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3365077465226594, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.94580076564943, 'psi': 0.0}
[S11] START round=9 head_norm_before_train=1.343895 (no previous merge yet)
[S11] round=9 local utility u=0.176930 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.874509280611383, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.228368732729957, 'psi': 0.0}
[S13] START round=9 head_norm_before_train=1.292440 (no previous merge yet)
[S13] round=9 local utility u=0.042839 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.482289484461671, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.567968159811756, 'psi': 0.0}
[S14] START round=9 head_norm_before_train=1.350396 (no previous merge yet)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2031943365774413, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.14307572853284, 'psi': 0.0}
[S15] START round=9 head_norm_before_train=1.292332 (no previous merge yet)
[S15] round=9 local utility u=0.458354 metrics={'f1_val': 0.08633968382650993, 'auprc': 0.08633968382650993, 'loss_val': 1.3305704538800147, 'psi': 0.08633968382650993}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4702220344341397, 'psi': 0.0}
[S16] START round=9 head_norm_before_train=1.100569 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.172368 metrics={'f1_val': 0.00041407867494824016, 'auprc': 0.00041407867494824016, 'loss_val': 1.8456836367678346, 'psi': 0.0004140786749482402}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.186691974609722, 'psi': 0.0}
[S17] START round=9 head_norm_before_train=1.304191 (no previous merge yet)
[S17] round=9 local utility u=0.003132 metrics={'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.2574037588128137, 'psi': 0.20308965160623102}-{'f1_val': 0.21145854622249471, 'auprc': 0.21145854622249471, 'loss_val': 1.3389875507023377, 'psi': 0.21145854622249471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S16] not sending this round → trigger blocked (psi=0.000)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.086)
[S13] not sending this round → trigger blocked (psi=0.000)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:50309
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0471
[S3] DROPPED delta from S5 (cos=-0.0471 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=-0.1330
[S8] DROPPED delta from S7 (cos=-0.1330 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=-0.0230
[S14] DROPPED delta from S17 (cos=-0.0230 < 0.0)
[S2] START round=10 head_norm_before_train=1.408579 (no previous merge yet)
[S2] round=10 local utility u=0.205352 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.894860910110369, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3055649600392436, 'psi': 0.0}
[S3] START round=10 head_norm_before_train=1.223108 cos_to_last_merge=0.9969 (last merge round=8)
[S3] round=10 local utility u=0.322842 metrics={'f1_val': 0.27687004481213373, 'auprc': 0.27687004481213373, 'loss_val': 1.9217276557122127, 'psi': 0.27687004481213373}-{'f1_val': 0.20845624385447395, 'auprc': 0.20845624385447395, 'loss_val': 1.9516876307089286, 'psi': 0.20845624385447395}
[S4] START round=10 head_norm_before_train=1.516919 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3821150735720078, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3630636598051735, 'psi': 0.0}
[S5] START round=10 head_norm_before_train=1.530041 (no previous merge yet)
[S5] round=10 local utility u=0.008137 metrics={'f1_val': 0.6636099667985219, 'auprc': 0.6636099667985219, 'loss_val': 1.0797059684460926, 'psi': 0.6636099667985219}-{'f1_val': 0.6643828018474133, 'auprc': 0.6643828018474133, 'loss_val': 1.1029363646817705, 'psi': 0.6643828018474133}
[S6] START round=10 head_norm_before_train=1.453398 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5945572192390998, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.562322789256681, 'psi': 0.0}
[S7] START round=10 head_norm_before_train=1.449246 (no previous merge yet)
[S7] round=10 local utility u=0.154279 metrics={'f1_val': 0.33099532398129594, 'auprc': 0.33099532398129594, 'loss_val': 1.3153880893313092, 'psi': 0.33099532398129594}-{'f1_val': 0.2997444322745528, 'auprc': 0.2997444322745528, 'loss_val': 1.3426876698723451, 'psi': 0.2997444322745528}
[S8] START round=10 head_norm_before_train=1.393790 (no previous merge yet)
[S8] round=10 local utility u=0.025079 metrics={'f1_val': 0.2036499645321468, 'auprc': 0.2036499645321468, 'loss_val': 1.1880313437095769, 'psi': 0.2036499645321468}-{'f1_val': 0.2039656397339017, 'auprc': 0.2039656397339017, 'loss_val': 1.2410301479519439, 'psi': 0.2039656397339017}
[S9] START round=10 head_norm_before_train=1.698887 (no previous merge yet)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2750537158670157, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.0739373744318272, 'psi': 0.36867172340800847}
[S10] START round=10 head_norm_before_train=1.519892 (no previous merge yet)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.57515870668731, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.3365077465226594, 'psi': 0.0}
[S11] START round=10 head_norm_before_train=1.372845 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9305502398957657, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.874509280611383, 'psi': 0.0}
[S13] START round=10 head_norm_before_train=1.305017 (no previous merge yet)
[S13] round=10 local utility u=0.677826 metrics={'f1_val': 0.13801169590643275, 'auprc': 0.13801169590643275, 'loss_val': 1.368742882597892, 'psi': 0.13801169590643275}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.482289484461671, 'psi': 0.0}
[S14] START round=10 head_norm_before_train=1.374182 (no previous merge yet)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5938362716606655, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2031943365774413, 'psi': 0.0}
[S15] START round=10 head_norm_before_train=1.320805 (no previous merge yet)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.6637781397043482, 'auprc': 0.6637781397043482, 'loss_val': 1.2028777607377572, 'psi': 0.6637781397043482}-{'f1_val': 0.08633968382650993, 'auprc': 0.08633968382650993, 'loss_val': 1.3305704538800147, 'psi': 0.08633968382650993}
[S16] START round=10 head_norm_before_train=1.135159 cos_to_last_merge=0.9970 (last merge round=8)
[S16] round=10 local utility u=0.315788 metrics={'f1_val': 0.0856269113149847, 'auprc': 0.0856269113149847, 'loss_val': 1.9810236280959332, 'psi': 0.0856269113149847}-{'f1_val': 0.00041407867494824016, 'auprc': 0.00041407867494824016, 'loss_val': 1.8456836367678346, 'psi': 0.0004140786749482402}
[S17] START round=10 head_norm_before_train=1.332551 (no previous merge yet)
[S17] round=10 local utility u=0.022762 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.21081674206506, 'psi': 0.20297157622739018}-{'f1_val': 0.20308965160623102, 'auprc': 0.20308965160623102, 'loss_val': 1.2574037588128137, 'psi': 0.20308965160623102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:50308
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:50316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S16] not sending this round → trigger blocked (psi=0.086)
[S13] not sending this round → trigger blocked (psi=0.138)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:50307
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.8639
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=-0.1351
[S8] DROPPED delta from S7 (cos=-0.1351 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.0284
[S6] RECEIVED delta(kind=head bytes=1799) from S3
[S6] cosine check vs S3: cos=-0.0753
[S6] DROPPED delta from S3 (cos=-0.0753 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0424
[S3] DROPPED delta from S5 (cos=-0.0424 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1807 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1807) from S17
[S14] cosine check vs S17: cos=-0.0215
[S14] DROPPED delta from S17 (cos=-0.0215 < 0.0)
[S13] ⇄ pheromone p=0.264 → S16@127.0.0.1:50316
[S4] ⇄ pheromone p=0.118 → S8@127.0.0.1:50309
[S2] ⇄ pheromone p=0.148 → S5@127.0.0.1:50305
[S9] ⇄ pheromone p=0.314 → S3@127.0.0.1:50303
[S11] ⇄ pheromone p=0.174 → S10@127.0.0.1:50311
[S6] ⇄ pheromone p=0.133 → S7@127.0.0.1:50308
[S10] ⇄ pheromone p=0.107 → S7@127.0.0.1:50308
[S14] ⇄ pheromone p=0.110 → S13@127.0.0.1:50313
[S5] ⇄ pheromone p=0.438 → S3@127.0.0.1:50303
[S8] ⇄ pheromone p=0.205 → S16@127.0.0.1:50316
[S3] ⇄ pheromone p=0.349 → S6@127.0.0.1:50307
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.3310 head_norm=1.473884
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.862444e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.3598 head_norm=1.014537 delta_norm=0.986244
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.297 → S8@127.0.0.1:50309
[S15] ⇄ pheromone p=0.411 → S7@127.0.0.1:50308
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.0856 head_norm=1.176574
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.614720e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.1080 head_norm=1.258745 delta_norm=0.361472
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.246 → S4@127.0.0.1:50304
[S17] ⇄ pheromone p=0.258 → S14@127.0.0.1:50314
[S2] START round=11 head_norm_before_train=1.446468 (no previous merge yet)
[S2] round=11 local utility u=0.870926 metrics={'f1_val': 0.20387007601935037, 'auprc': 0.20387007601935037, 'loss_val': 2.987838699649914, 'psi': 0.20387007601935037}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.894860910110369, 'psi': 0.0}
[S3] START round=11 head_norm_before_train=1.307336 cos_to_last_merge=0.9883 (last merge round=8)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.2829868476877387, 'auprc': 0.2829868476877387, 'loss_val': 2.195400904098249, 'psi': 0.2829868476877387}-{'f1_val': 0.27687004481213373, 'auprc': 0.27687004481213373, 'loss_val': 1.9217276557122127, 'psi': 0.27687004481213373}
[S4] START round=11 head_norm_before_train=1.560940 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3891219776318684, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3821150735720078, 'psi': 0.0}
[S5] START round=11 head_norm_before_train=1.569074 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.4093589963791298, 'psi': 0.33451196111837667}-{'f1_val': 0.6636099667985219, 'auprc': 0.6636099667985219, 'loss_val': 1.0797059684460926, 'psi': 0.6636099667985219}
[S6] START round=11 head_norm_before_train=1.477918 (no previous merge yet)
[S6] round=11 local utility u=0.334122 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9263133487117625, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5945572192390998, 'psi': 0.0}
[S7] START round=11 head_norm_before_train=1.014537 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.157294 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.259715484811457, 'psi': 0.35976373724718097}-{'f1_val': 0.33099532398129594, 'auprc': 0.33099532398129594, 'loss_val': 1.3153880893313092, 'psi': 0.33099532398129594}
[S8] START round=11 head_norm_before_train=1.430340 (no previous merge yet)
[S8] round=11 local utility u=0.020367 metrics={'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.146942208728101, 'psi': 0.20361057382333977}-{'f1_val': 0.2036499645321468, 'auprc': 0.2036499645321468, 'loss_val': 1.1880313437095769, 'psi': 0.2036499645321468}
[S9] START round=11 head_norm_before_train=1.735293 (no previous merge yet)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3942922025353686, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.2750537158670157, 'psi': 0.36867172340800847}
[S10] START round=11 head_norm_before_train=1.546705 (no previous merge yet)
[S10] round=11 local utility u=0.254556 metrics={'f1_val': 0.06972439325380501, 'auprc': 0.06972439325380501, 'loss_val': 3.693566313350975, 'psi': 0.06972439325380501}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.57515870668731, 'psi': 0.0}
[S11] START round=11 head_norm_before_train=1.410120 (no previous merge yet)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.137138882014559, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.9305502398957657, 'psi': 0.0}
[S13] START round=11 head_norm_before_train=1.315687 (no previous merge yet)
[S13] round=11 local utility u=0.708787 metrics={'f1_val': 0.28598165824443195, 'auprc': 0.28598165824443195, 'loss_val': 1.2828982520247072, 'psi': 0.28598165824443195}-{'f1_val': 0.13801169590643275, 'auprc': 0.13801169590643275, 'loss_val': 1.368742882597892, 'psi': 0.13801169590643275}
[S14] START round=11 head_norm_before_train=1.403665 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.865004675317679, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.5938362716606655, 'psi': 0.0}
[S15] START round=11 head_norm_before_train=1.353364 (no previous merge yet)
[S15] round=11 local utility u=0.016780 metrics={'f1_val': 0.6568235178607397, 'auprc': 0.6568235178607397, 'loss_val': 1.1067266933276216, 'psi': 0.6568235178607397}-{'f1_val': 0.6637781397043482, 'auprc': 0.6637781397043482, 'loss_val': 1.2028777607377572, 'psi': 0.6637781397043482}
[S16] START round=11 head_norm_before_train=1.258745 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.04591748662178491, 'auprc': 0.04591748662178491, 'loss_val': 1.8904529091079132, 'psi': 0.04591748662178491}-{'f1_val': 0.0856269113149847, 'auprc': 0.0856269113149847, 'loss_val': 1.9810236280959332, 'psi': 0.0856269113149847}
[S17] START round=11 head_norm_before_train=1.359007 (no previous merge yet)
[S17] round=11 local utility u=0.013516 metrics={'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 1.1827242203298745, 'psi': 0.20285363806572407}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.21081674206506, 'psi': 0.20297157622739018}
[S6] not sending this round → trigger blocked (psi=0.000)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[S10] not sending this round → trigger blocked (psi=0.070)
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] cosine check vs S8: cos=0.9506
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=-0.1206
[S8] DROPPED delta from S7 (cos=-0.1206 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=-0.1476
[S5] DROPPED delta from S2 (cos=-0.1476 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:50308
[S15] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=0.6537
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=-0.0195
[S14] DROPPED delta from S17 (cos=-0.0195 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:50316
[S13] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S13
[S16] cosine check vs S13: cos=0.0245
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.3598 head_norm=1.060202
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.316241e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.3598 head_norm=1.116443 delta_norm=0.531624
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.0459 head_norm=1.287840
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.517751e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.0887 head_norm=1.059002 delta_norm=0.451775
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.483682 (no previous merge yet)
[S2] round=12 local utility u=0.352142 metrics={'f1_val': 0.24049476421392932, 'auprc': 0.24049476421392932, 'loss_val': 2.6131775503387384, 'psi': 0.24049476421392932}-{'f1_val': 0.20387007601935037, 'auprc': 0.20387007601935037, 'loss_val': 2.987838699649914, 'psi': 0.20387007601935037}
[S3] START round=12 head_norm_before_train=1.390474 cos_to_last_merge=0.9783 (last merge round=8)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.27026045920682457, 'auprc': 0.27026045920682457, 'loss_val': 2.554431319752896, 'psi': 0.27026045920682457}-{'f1_val': 0.2829868476877387, 'auprc': 0.2829868476877387, 'loss_val': 2.195400904098249, 'psi': 0.2829868476877387}
[S4] START round=12 head_norm_before_train=1.603357 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3943483308128843, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3891219776318684, 'psi': 0.0}
[S5] START round=12 head_norm_before_train=1.612072 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.607365636289945, 'psi': 0.2501920777223545}-{'f1_val': 0.33451196111837667, 'auprc': 0.33451196111837667, 'loss_val': 1.4093589963791298, 'psi': 0.33451196111837667}
[S6] START round=12 head_norm_before_train=1.498762 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.039712088236742, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9263133487117625, 'psi': 0.0}
[S7] START round=12 head_norm_before_train=1.116443 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.007457 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2448012721509887, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.259715484811457, 'psi': 0.35976373724718097}
[S8] START round=12 head_norm_before_train=1.464545 (no previous merge yet)
[S8] round=12 local utility u=0.018018 metrics={'f1_val': 0.20353183810260378, 'auprc': 0.20353183810260378, 'loss_val': 1.1101971884335324, 'psi': 0.20353183810260378}-{'f1_val': 0.20361057382333977, 'auprc': 0.20361057382333977, 'loss_val': 1.146942208728101, 'psi': 0.20361057382333977}
[S9] START round=12 head_norm_before_train=1.763903 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5001131474863287, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.3942922025353686, 'psi': 0.36867172340800847}
[S10] START round=12 head_norm_before_train=1.568101 (no previous merge yet)
[S10] round=12 local utility u=0.627109 metrics={'f1_val': 0.19834340720841728, 'auprc': 0.19834340720841728, 'loss_val': 3.5969185413877542, 'psi': 0.19834340720841728}-{'f1_val': 0.06972439325380501, 'auprc': 0.06972439325380501, 'loss_val': 3.693566313350975, 'psi': 0.06972439325380501}
[S11] START round=12 head_norm_before_train=1.447441 (no previous merge yet)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3151794800205634, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.137138882014559, 'psi': 0.0}
[S13] START round=12 head_norm_before_train=1.327982 (no previous merge yet)
[S13] round=12 local utility u=0.964935 metrics={'f1_val': 0.492449650558661, 'auprc': 0.492449650558661, 'loss_val': 1.2112408491235322, 'psi': 0.492449650558661}-{'f1_val': 0.28598165824443195, 'auprc': 0.28598165824443195, 'loss_val': 1.2828982520247072, 'psi': 0.28598165824443195}
[S14] START round=12 head_norm_before_train=1.437242 (no previous merge yet)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.145758311215434, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.865004675317679, 'psi': 0.0}
[S15] START round=12 head_norm_before_train=1.390723 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6108114317053968, 'auprc': 0.6108114317053968, 'loss_val': 1.0349152050914803, 'psi': 0.6108114317053968}-{'f1_val': 0.6568235178607397, 'auprc': 0.6568235178607397, 'loss_val': 1.1067266933276216, 'psi': 0.6568235178607397}
[S16] START round=12 head_norm_before_train=1.059002 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.293344 metrics={'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 1.7012792712596725, 'psi': 0.09008575779434158}-{'f1_val': 0.04591748662178491, 'auprc': 0.04591748662178491, 'loss_val': 1.8904529091079132, 'psi': 0.04591748662178491}
[S17] START round=12 head_norm_before_train=1.380046 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.188236306785775, 'psi': 0.20297157622739018}-{'f1_val': 0.20285363806572407, 'auprc': 0.20285363806572407, 'loss_val': 1.1827242203298745, 'psi': 0.20285363806572407}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.198)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.090)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S8
[S16] cosine check vs S8: cos=0.9061
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.3258
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=-0.1495
[S5] DROPPED delta from S2 (cos=-0.1495 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=-0.0828
[S8] DROPPED delta from S7 (cos=-0.0828 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.0901 head_norm=1.091919
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.550999e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.1233 head_norm=1.022583 delta_norm=0.255100
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.519063 (no previous merge yet)
[S2] round=13 local utility u=0.183834 metrics={'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.2867288386458258, 'psi': 0.24507471790179935}-{'f1_val': 0.24049476421392932, 'auprc': 0.24049476421392932, 'loss_val': 2.6131775503387384, 'psi': 0.24049476421392932}
[S3] START round=13 head_norm_before_train=1.457478 cos_to_last_merge=0.9698 (last merge round=8)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.2551613549809581, 'auprc': 0.2551613549809581, 'loss_val': 2.743322838547002, 'psi': 0.2551613549809581}-{'f1_val': 0.27026045920682457, 'auprc': 0.27026045920682457, 'loss_val': 2.554431319752896, 'psi': 0.27026045920682457}
[S4] START round=13 head_norm_before_train=1.639373 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4076344198727375, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.3943483308128843, 'psi': 0.0}
[S5] START round=13 head_norm_before_train=1.654621 (no previous merge yet)
[S5] round=13 local utility u=0.241415 metrics={'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.8751110245446982, 'psi': 0.33358943696313936}-{'f1_val': 0.2501920777223545, 'auprc': 0.2501920777223545, 'loss_val': 2.607365636289945, 'psi': 0.2501920777223545}
[S6] START round=13 head_norm_before_train=1.523574 (no previous merge yet)
[S6] round=13 local utility u=0.045369 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9489742503907173, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.039712088236742, 'psi': 0.0}
[S7] START round=13 head_norm_before_train=1.171371 cos_to_last_merge=0.9881 (last merge round=11)
[S7] round=13 local utility u=0.022990 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1988213631171505, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.2448012721509887, 'psi': 0.35976373724718097}
[S8] START round=13 head_norm_before_train=1.500145 (no previous merge yet)
[S8] round=13 local utility u=0.061289 metrics={'f1_val': 0.20896355066135774, 'auprc': 0.20896355066135774, 'loss_val': 1.0365048252761149, 'psi': 0.20896355066135774}-{'f1_val': 0.20353183810260378, 'auprc': 0.20353183810260378, 'loss_val': 1.1101971884335324, 'psi': 0.20353183810260378}
[S9] START round=13 head_norm_before_train=1.787658 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5730627424036765, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5001131474863287, 'psi': 0.36867172340800847}
[S10] START round=13 head_norm_before_train=1.585171 (no previous merge yet)
[S10] round=13 local utility u=0.023602 metrics={'f1_val': 0.19897160742231165, 'auprc': 0.19897160742231165, 'loss_val': 3.5553691586037623, 'psi': 0.19897160742231165}-{'f1_val': 0.19834340720841728, 'auprc': 0.19834340720841728, 'loss_val': 3.5969185413877542, 'psi': 0.19834340720841728}
[S11] START round=13 head_norm_before_train=1.481701 (no previous merge yet)
[S11] round=13 local utility u=1.000000 metrics={'f1_val': 0.30939871570344424, 'auprc': 0.30939871570344424, 'loss_val': 1.9008462468210348, 'psi': 0.30939871570344424}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.3151794800205634, 'psi': 0.0}
[S13] START round=13 head_norm_before_train=1.340921 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.28921475399140306, 'auprc': 0.28921475399140306, 'loss_val': 1.1516247121816223, 'psi': 0.28921475399140306}-{'f1_val': 0.492449650558661, 'auprc': 0.492449650558661, 'loss_val': 1.2112408491235322, 'psi': 0.492449650558661}
[S14] START round=13 head_norm_before_train=1.473912 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.442098829454114, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.145758311215434, 'psi': 0.0}
[S15] START round=13 head_norm_before_train=1.426935 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.40735185410357816, 'auprc': 0.40735185410357816, 'loss_val': 0.9981403808668823, 'psi': 0.40735185410357816}-{'f1_val': 0.6108114317053968, 'auprc': 0.6108114317053968, 'loss_val': 1.0349152050914803, 'psi': 0.6108114317053968}
[S16] START round=13 head_norm_before_train=1.022583 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 1.8383493327025175, 'psi': 0.08899598393574297}-{'f1_val': 0.09008575779434158, 'auprc': 0.09008575779434158, 'loss_val': 1.7012792712596725, 'psi': 0.09008575779434158}
[S17] START round=13 head_norm_before_train=1.397892 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.15219918620422399, 'auprc': 0.15219918620422399, 'loss_val': 1.2000644712119486, 'psi': 0.15219918620422399}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.188236306785775, 'psi': 0.20297157622739018}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.199)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:50316
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:50305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] cosine check vs S7: cos=-0.0912
[S8] DROPPED delta from S7 (cos=-0.0912 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=-0.0246
[S3] DROPPED delta from S5 (cos=-0.0246 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S8
[S16] cosine check vs S8: cos=0.8380
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=-0.1511
[S5] DROPPED delta from S2 (cos=-0.1511 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S11
[S10] cosine check vs S11: cos=0.0818
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.1990 head_norm=1.604675
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.054438e+00
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.2176 head_norm=1.144353 delta_norm=1.054438
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.0890 head_norm=1.057716
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.353151e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.0905 head_norm=1.246155 delta_norm=0.435315
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.555068 (no previous merge yet)
[S2] round=14 local utility u=0.047417 metrics={'f1_val': 0.26463808206546796, 'auprc': 0.26463808206546796, 'loss_val': 2.367964761260661, 'psi': 0.26463808206546796}-{'f1_val': 0.24507471790179933, 'auprc': 0.24507471790179933, 'loss_val': 2.2867288386458258, 'psi': 0.24507471790179935}
[S3] START round=14 head_norm_before_train=1.511195 cos_to_last_merge=0.9630 (last merge round=8)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.17523392878843116, 'auprc': 0.17523392878843116, 'loss_val': 3.129409947453379, 'psi': 0.17523392878843116}-{'f1_val': 0.2551613549809581, 'auprc': 0.2551613549809581, 'loss_val': 2.743322838547002, 'psi': 0.2551613549809581}
[S4] START round=14 head_norm_before_train=1.671047 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4172999707644247, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4076344198727375, 'psi': 0.0}
[S5] START round=14 head_norm_before_train=1.695415 (no previous merge yet)
[S5] round=14 local utility u=0.039945 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.794481096245069, 'psi': 0.3335071121394324}-{'f1_val': 0.33358943696313936, 'auprc': 0.33358943696313936, 'loss_val': 2.8751110245446982, 'psi': 0.33358943696313936}
[S6] START round=14 head_norm_before_train=1.550320 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2080171829781228, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 2.9489742503907173, 'psi': 0.0}
[S7] START round=14 head_norm_before_train=1.240128 cos_to_last_merge=0.9680 (last merge round=11)
[S7] round=14 local utility u=0.027711 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.143398697784919, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1988213631171505, 'psi': 0.35976373724718097}
[S8] START round=14 head_norm_before_train=1.538193 (no previous merge yet)
[S8] round=14 local utility u=1.000000 metrics={'f1_val': 0.4766986332317519, 'auprc': 0.4766986332317519, 'loss_val': 0.9563305910254983, 'psi': 0.4766986332317519}-{'f1_val': 0.20896355066135774, 'auprc': 0.20896355066135774, 'loss_val': 1.0365048252761149, 'psi': 0.20896355066135774}
[S9] START round=14 head_norm_before_train=1.807914 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6338157243713303, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.5730627424036765, 'psi': 0.36867172340800847}
[S10] START round=14 head_norm_before_train=1.144353 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.876493 metrics={'f1_val': 0.24275582573454912, 'auprc': 0.24275582573454912, 'loss_val': 2.1964409505175757, 'psi': 0.24275582573454912}-{'f1_val': 0.19897160742231165, 'auprc': 0.19897160742231165, 'loss_val': 3.5553691586037623, 'psi': 0.19897160742231165}
[S11] START round=14 head_norm_before_train=1.505918 (no previous merge yet)
[S11] round=14 local utility u=0.061769 metrics={'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 1.978058803644596, 'psi': 0.3317042898145993}-{'f1_val': 0.30939871570344424, 'auprc': 0.30939871570344424, 'loss_val': 1.9008462468210348, 'psi': 0.30939871570344424}
[S13] START round=14 head_norm_before_train=1.359354 (no previous merge yet)
[S13] round=14 local utility u=0.345798 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0965229602280706, 'psi': 0.3599362944611573}-{'f1_val': 0.28921475399140306, 'auprc': 0.28921475399140306, 'loss_val': 1.1516247121816223, 'psi': 0.28921475399140306}
[S14] START round=14 head_norm_before_train=1.502673 (no previous merge yet)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.650627326740253, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.442098829454114, 'psi': 0.0}
[S15] START round=14 head_norm_before_train=1.462564 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.3040606493611784, 'auprc': 0.3040606493611784, 'loss_val': 0.918122763349133, 'psi': 0.3040606493611784}-{'f1_val': 0.40735185410357816, 'auprc': 0.40735185410357816, 'loss_val': 0.9981403808668823, 'psi': 0.40735185410357816}
[S16] START round=14 head_norm_before_train=1.246155 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.028040 metrics={'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 1.786025043646677, 'psi': 0.0894132755437836}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 1.8383493327025175, 'psi': 0.08899598393574297}
[S17] START round=14 head_norm_before_train=1.416557 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.2354492149652634, 'psi': 0.15222868217054264}-{'f1_val': 0.15219918620422399, 'auprc': 0.15219918620422399, 'loss_val': 1.2000644712119486, 'psi': 0.15219918620422399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:50305
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[S16] not sending this round → trigger blocked (psi=0.089)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:50316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] cosine check vs S2: cos=-0.1514
[S5] DROPPED delta from S2 (cos=-0.1514 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S13
[S16] cosine check vs S13: cos=0.2147
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.9575
[S10] RECEIVED delta(kind=head bytes=1801) from S11
[S10] cosine check vs S11: cos=0.6974
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=-0.0919
[S8] DROPPED delta from S7 (cos=-0.0919 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.1052
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0186
[S3] DROPPED delta from S5 (cos=-0.0186 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.2428 head_norm=1.184652
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.505197e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.2812 head_norm=1.250904 delta_norm=0.550520
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.3598 head_norm=1.293404
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.297586e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.3598 head_norm=0.921763 delta_norm=0.829759
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.0894 head_norm=1.281389
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.330574e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.0901 head_norm=1.125659 delta_norm=0.333057
[S16] aggregate: ACCEPT kept=['S13', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.588717 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.24647282542019386, 'auprc': 0.24647282542019386, 'loss_val': 2.29086736611497, 'psi': 0.24647282542019386}-{'f1_val': 0.26463808206546796, 'auprc': 0.26463808206546796, 'loss_val': 2.367964761260661, 'psi': 0.26463808206546796}
[S3] START round=15 head_norm_before_train=1.552641 cos_to_last_merge=0.9579 (last merge round=8)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.17487534962908913, 'auprc': 0.17487534962908913, 'loss_val': 3.2423323193446736, 'psi': 0.17487534962908913}-{'f1_val': 0.17523392878843116, 'auprc': 0.17523392878843116, 'loss_val': 3.129409947453379, 'psi': 0.17523392878843116}
[S4] START round=15 head_norm_before_train=1.696070 (no previous merge yet)
[S4] round=15 local utility u=0.004816 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.407667032140578, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.4172999707644247, 'psi': 0.0}
[S5] START round=15 head_norm_before_train=1.727284 (no previous merge yet)
[S5] round=15 local utility u=0.120301 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.553879940690957, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.794481096245069, 'psi': 0.3335071121394324}
[S6] START round=15 head_norm_before_train=1.578762 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.9491146574314135, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.2080171829781228, 'psi': 0.0}
[S7] START round=15 head_norm_before_train=0.921763 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.223636299067438, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.143398697784919, 'psi': 0.35976373724718097}
[S8] START round=15 head_norm_before_train=1.573882 (no previous merge yet)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.7138176287785327, 'auprc': 0.7138176287785327, 'loss_val': 0.8961820265154211, 'psi': 0.7138176287785327}-{'f1_val': 0.4766986332317519, 'auprc': 0.4766986332317519, 'loss_val': 0.9563305910254983, 'psi': 0.4766986332317519}
[S9] START round=15 head_norm_before_train=1.825578 (no previous merge yet)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6900760303745277, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6338157243713303, 'psi': 0.36867172340800847}
[S10] START round=15 head_norm_before_train=1.250904 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.214224 metrics={'f1_val': 0.2520808561236623, 'auprc': 0.2520808561236623, 'loss_val': 1.8519178884101282, 'psi': 0.2520808561236623}-{'f1_val': 0.24275582573454912, 'auprc': 0.24275582573454912, 'loss_val': 2.1964409505175757, 'psi': 0.24275582573454912}
[S11] START round=15 head_norm_before_train=1.527175 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.280805298708112, 'auprc': 0.280805298708112, 'loss_val': 1.8654252616156644, 'psi': 0.280805298708112}-{'f1_val': 0.3317042898145993, 'auprc': 0.3317042898145993, 'loss_val': 1.978058803644596, 'psi': 0.3317042898145993}
[S13] START round=15 head_norm_before_train=1.385798 (no previous merge yet)
[S13] round=15 local utility u=0.026514 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0434958558068073, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0965229602280706, 'psi': 0.3599362944611573}
[S14] START round=15 head_norm_before_train=1.524977 (no previous merge yet)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.069242277404754, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 5.650627326740253, 'psi': 0.0}
[S15] START round=15 head_norm_before_train=1.498110 (no previous merge yet)
[S15] round=15 local utility u=1.000000 metrics={'f1_val': 0.6015910291057062, 'auprc': 0.6015910291057062, 'loss_val': 0.7329260344128589, 'psi': 0.6015910291057062}-{'f1_val': 0.3040606493611784, 'auprc': 0.3040606493611784, 'loss_val': 0.918122763349133, 'psi': 0.3040606493611784}
[S16] START round=15 head_norm_before_train=1.125659 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.0583756345177665, 'auprc': 0.0583756345177665, 'loss_val': 2.0317251612486884, 'psi': 0.058375634517766506}-{'f1_val': 0.0894132755437836, 'auprc': 0.0894132755437836, 'loss_val': 1.786025043646677, 'psi': 0.0894132755437836}
[S17] START round=15 head_norm_before_train=1.436488 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.294127165702535, 'psi': 0.152287708414114}-{'f1_val': 0.15222868217054264, 'auprc': 0.15222868217054264, 'loss_val': 1.2354492149652634, 'psi': 0.15222868217054264}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:50316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.000)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:50303
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:50316
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1806) from S8
[S16] cosine check vs S8: cos=0.8835
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=0.4229
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0141
[S3] DROPPED delta from S5 (cos=-0.0141 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.6102
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.6155
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.040 → S8@127.0.0.1:50309
[S6] ⇄ pheromone p=0.077 → S7@127.0.0.1:50308
[S2] ⇄ pheromone p=0.187 → S5@127.0.0.1:50305
[S9] ⇄ pheromone p=0.103 → S3@127.0.0.1:50303
[S14] ⇄ pheromone p=0.036 → S13@127.0.0.1:50313
[S11] ⇄ pheromone p=0.195 → S10@127.0.0.1:50311
[S3] ⇄ pheromone p=0.114 → S6@127.0.0.1:50307
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.3598 head_norm=0.981149
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.137262e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.3598 head_norm=0.973457 delta_norm=0.313726
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.118 → S8@127.0.0.1:50309
[S15] ⇄ pheromone p=0.336 → S7@127.0.0.1:50308
[S10] ⇄ pheromone p=0.306 → S7@127.0.0.1:50308
[S5] ⇄ pheromone p=0.205 → S3@127.0.0.1:50303
[S8] ⇄ pheromone p=0.438 → S16@127.0.0.1:50316
[S13] ⇄ pheromone p=0.304 → S16@127.0.0.1:50316
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.0584 head_norm=1.165331
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.020797e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.0774 head_norm=1.104867 delta_norm=0.202080
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.115 → S4@127.0.0.1:50304
[S17] ⇄ pheromone p=0.086 → S14@127.0.0.1:50314
[S2] START round=16 head_norm_before_train=1.618563 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.2881979815019045, 'psi': 0.245119570522206}-{'f1_val': 0.24647282542019386, 'auprc': 0.24647282542019386, 'loss_val': 2.29086736611497, 'psi': 0.24647282542019386}
[S3] START round=16 head_norm_before_train=1.586092 cos_to_last_merge=0.9538 (last merge round=8)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.17349926793557832, 'auprc': 0.17349926793557832, 'loss_val': 3.369285278604987, 'psi': 0.17349926793557832}-{'f1_val': 0.17487534962908913, 'auprc': 0.17487534962908913, 'loss_val': 3.2423323193446736, 'psi': 0.17487534962908913}
[S4] START round=16 head_norm_before_train=1.718303 (no previous merge yet)
[S4] round=16 local utility u=0.001444 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.404779214050352, 'psi': 0.0}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.407667032140578, 'psi': 0.0}
[S5] START round=16 head_norm_before_train=1.750604 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.586504056981945, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.553879940690957, 'psi': 0.3335071121394324}
[S6] START round=16 head_norm_before_train=1.608141 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 4.175339282109793, 'psi': 0.01910681399631676}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 3.9491146574314135, 'psi': 0.0}
[S7] START round=16 head_norm_before_train=0.973457 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.014719 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1941974139167257, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.223636299067438, 'psi': 0.35976373724718097}
[S8] START round=16 head_norm_before_train=1.613669 (no previous merge yet)
[S8] round=16 local utility u=1.000000 metrics={'f1_val': 0.9997178063266456, 'auprc': 0.9997178063266456, 'loss_val': 0.8513862387833979, 'psi': 0.9997178063266456}-{'f1_val': 0.7138176287785327, 'auprc': 0.7138176287785327, 'loss_val': 0.8961820265154211, 'psi': 0.7138176287785327}
[S9] START round=16 head_norm_before_train=1.841408 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.736765490166385, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.6900760303745277, 'psi': 0.36867172340800847}
[S10] START round=16 head_norm_before_train=1.292114 cos_to_last_merge=0.9971 (last merge round=14)
[S10] round=16 local utility u=0.061904 metrics={'f1_val': 0.29594187488924334, 'auprc': 0.29594187488924334, 'loss_val': 2.122858795530702, 'psi': 0.29594187488924334}-{'f1_val': 0.2520808561236623, 'auprc': 0.2520808561236623, 'loss_val': 1.8519178884101282, 'psi': 0.2520808561236623}
[S11] START round=16 head_norm_before_train=1.552516 (no previous merge yet)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 2.3488532537968116, 'psi': 0.3316279069767442}-{'f1_val': 0.280805298708112, 'auprc': 0.280805298708112, 'loss_val': 1.8654252616156644, 'psi': 0.280805298708112}
[S13] START round=16 head_norm_before_train=1.417245 (no previous merge yet)
[S13] round=16 local utility u=0.019751 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.003994205327074, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0434958558068073, 'psi': 0.3599362944611573}
[S14] START round=16 head_norm_before_train=1.544430 (no previous merge yet)
[S14] round=16 local utility u=0.439571 metrics={'f1_val': 0.06087494841106067, 'auprc': 0.06087494841106067, 'loss_val': 5.737974229783887, 'psi': 0.06087494841106067}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.069242277404754, 'psi': 0.0}
[S15] START round=16 head_norm_before_train=1.533439 (no previous merge yet)
[S15] round=16 local utility u=0.067036 metrics={'f1_val': 0.616439678511962, 'auprc': 0.616439678511962, 'loss_val': 0.7324922958260501, 'psi': 0.616439678511962}-{'f1_val': 0.6015910291057062, 'auprc': 0.6015910291057062, 'loss_val': 0.7329260344128589, 'psi': 0.6015910291057062}
[S16] START round=16 head_norm_before_train=1.104867 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.073000 metrics={'f1_val': 0.0677427243824896, 'auprc': 0.0677427243824896, 'loss_val': 1.9700282859470706, 'psi': 0.0677427243824896}-{'f1_val': 0.0583756345177665, 'auprc': 0.0583756345177665, 'loss_val': 2.0317251612486884, 'psi': 0.058375634517766506}
[S17] START round=16 head_norm_before_train=1.460982 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.3328155368297303, 'psi': 0.15231723870467326}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.294127165702535, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.068)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.061)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[S4] not sending this round → trigger blocked (psi=0.000)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:50308
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S8
[S16] cosine check vs S8: cos=0.8235
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=0.5304
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=0.6497
[S7] RECEIVED delta(kind=head bytes=1795) from S15
[S7] cosine check vs S15: cos=0.7158
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=-0.1027
[S8] DROPPED delta from S7 (cos=-0.1027 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.3598 head_norm=1.033403
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.239934e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.3598 head_norm=1.038686 delta_norm=0.223993
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.0677 head_norm=1.148664
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.495128e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.0894 head_norm=1.115863 delta_norm=0.149513
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.644655 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.24647282542019386, 'auprc': 0.24647282542019386, 'loss_val': 2.3752948464434365, 'psi': 0.24647282542019386}-{'f1_val': 0.24511957052220598, 'auprc': 0.24511957052220598, 'loss_val': 2.2881979815019045, 'psi': 0.245119570522206}
[S3] START round=17 head_norm_before_train=1.612726 cos_to_last_merge=0.9508 (last merge round=8)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.1428201140487299, 'auprc': 0.1428201140487299, 'loss_val': 3.7722779116257166, 'psi': 0.1428201140487299}-{'f1_val': 0.17349926793557832, 'auprc': 0.17349926793557832, 'loss_val': 3.369285278604987, 'psi': 0.17349926793557832}
[S4] START round=17 head_norm_before_train=1.743417 (no previous merge yet)
[S4] round=17 local utility u=0.880935 metrics={'f1_val': 0.19119951778179625, 'auprc': 0.19119951778179625, 'loss_val': 1.363704411045796, 'psi': 0.19119951778179625}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 1.404779214050352, 'psi': 0.0}
[S5] START round=17 head_norm_before_train=1.773055 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.757117146204194, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.586504056981945, 'psi': 0.3335071121394324}
[S6] START round=17 head_norm_before_train=1.633371 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 4.675859533660708, 'psi': 0.01732902033271719}-{'f1_val': 0.01910681399631676, 'auprc': 0.01910681399631676, 'loss_val': 4.175339282109793, 'psi': 0.01910681399631676}
[S7] START round=17 head_norm_before_train=1.038686 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.1688856396733354, 'psi': 0.2396131805157593}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 1.1941974139167257, 'psi': 0.35976373724718097}
[S8] START round=17 head_norm_before_train=1.652718 (no previous merge yet)
[S8] round=17 local utility u=0.011262 metrics={'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.8212399995309023, 'psi': 0.9988708350860451}-{'f1_val': 0.9997178063266456, 'auprc': 0.9997178063266456, 'loss_val': 0.8513862387833979, 'psi': 0.9997178063266456}
[S9] START round=17 head_norm_before_train=1.855767 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.774360746932346, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.736765490166385, 'psi': 0.36867172340800847}
[S10] START round=17 head_norm_before_train=1.341921 cos_to_last_merge=0.9897 (last merge round=14)
[S10] round=17 local utility u=0.084699 metrics={'f1_val': 0.3316518536311955, 'auprc': 0.3316518536311955, 'loss_val': 2.274849900055607, 'psi': 0.3316518536311955}-{'f1_val': 0.29594187488924334, 'auprc': 0.29594187488924334, 'loss_val': 2.122858795530702, 'psi': 0.29594187488924334}
[S11] START round=17 head_norm_before_train=1.575153 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.28047422545359274, 'auprc': 0.28047422545359274, 'loss_val': 2.0567974404706146, 'psi': 0.28047422545359274}-{'f1_val': 0.3316279069767442, 'auprc': 0.3316279069767442, 'loss_val': 2.3488532537968116, 'psi': 0.3316279069767442}
[S13] START round=17 head_norm_before_train=1.448120 (no previous merge yet)
[S13] round=17 local utility u=0.009255 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9854846058419661, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.003994205327074, 'psi': 0.3599362944611573}
[S14] START round=17 head_norm_before_train=1.560930 (no previous merge yet)
[S14] round=17 local utility u=0.137513 metrics={'f1_val': 0.09029649595687332, 'auprc': 0.09029649595687332, 'loss_val': 5.727742524914865, 'psi': 0.09029649595687332}-{'f1_val': 0.06087494841106067, 'auprc': 0.06087494841106067, 'loss_val': 5.737974229783887, 'psi': 0.06087494841106067}
[S15] START round=17 head_norm_before_train=1.563377 (no previous merge yet)
[S15] round=17 local utility u=0.051553 metrics={'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.6329265081125622, 'psi': 0.6168330926211807}-{'f1_val': 0.616439678511962, 'auprc': 0.616439678511962, 'loss_val': 0.7324922958260501, 'psi': 0.616439678511962}
[S16] START round=17 head_norm_before_train=1.115863 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.05823599119688505, 'auprc': 0.05823599119688505, 'loss_val': 2.1788661114254966, 'psi': 0.05823599119688505}-{'f1_val': 0.0677427243824896, 'auprc': 0.0677427243824896, 'loss_val': 1.9700282859470706, 'psi': 0.0677427243824896}
[S17] START round=17 head_norm_before_train=1.482119 (no previous merge yet)
[S17] round=17 local utility u=0.030467 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.2716163822560993, 'psi': 0.152287708414114}-{'f1_val': 0.15231723870467326, 'auprc': 0.15231723870467326, 'loss_val': 1.3328155368297303, 'psi': 0.15231723870467326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:50316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.191)
[S14] not sending this round → trigger blocked (psi=0.090)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S8
[S16] cosine check vs S8: cos=0.7892
[S16] RECEIVED delta(kind=head bytes=1807) from S13
[S16] cosine check vs S13: cos=0.5795
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.7487
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=0.6536
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=-0.0041
[S14] DROPPED delta from S17 (cos=-0.0041 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.2396 head_norm=1.100525
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.945022e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.2396 head_norm=1.093457 delta_norm=0.194502
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.0582 head_norm=1.161795
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.293130e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.0743 head_norm=1.135100 delta_norm=0.129313
[S16] aggregate: ACCEPT kept=['S8', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.667145 (no previous merge yet)
[S2] round=18 local utility u=0.010439 metrics={'f1_val': 0.26427255985267034, 'auprc': 0.26427255985267034, 'loss_val': 2.5146152942351288, 'psi': 0.26427255985267034}-{'f1_val': 0.24647282542019386, 'auprc': 0.24647282542019386, 'loss_val': 2.3752948464434365, 'psi': 0.24647282542019386}
[S3] START round=18 head_norm_before_train=1.636693 cos_to_last_merge=0.9480 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=18 local utility u=0.237539 metrics={'f1_val': 0.1691285081240768, 'auprc': 0.1691285081240768, 'loss_val': 3.5339758311172447, 'psi': 0.1691285081240768}-{'f1_val': 0.1428201140487299, 'auprc': 0.1428201140487299, 'loss_val': 3.7722779116257166, 'psi': 0.1428201140487299}
[S4] START round=18 head_norm_before_train=1.763713 (no previous merge yet)
[S4] round=18 local utility u=0.657182 metrics={'f1_val': 0.33299492385786805, 'auprc': 0.33299492385786805, 'loss_val': 1.3254983274062273, 'psi': 0.33299492385786805}-{'f1_val': 0.19119951778179625, 'auprc': 0.19119951778179625, 'loss_val': 1.363704411045796, 'psi': 0.19119951778179625}
[S5] START round=18 head_norm_before_train=1.813840 (no previous merge yet)
[S5] round=18 local utility u=0.028183 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7007512822517405, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.757117146204194, 'psi': 0.3335071121394324}
[S6] START round=18 head_norm_before_train=1.656082 (no previous merge yet)
[S6] round=18 local utility u=0.088942 metrics={'f1_val': 0.05439419795221843, 'auprc': 0.05439419795221843, 'loss_val': 4.831562500949938, 'psi': 0.054394197952218434}-{'f1_val': 0.01732902033271719, 'auprc': 0.01732902033271719, 'loss_val': 4.675859533660708, 'psi': 0.01732902033271719}
[S7] START round=18 head_norm_before_train=1.093457 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.017212 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.135837069665759, 'psi': 0.23976608187134504}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.1688856396733354, 'psi': 0.2396131805157593}
[S8] START round=18 head_norm_before_train=1.690728 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8054317552430652, 'psi': 0.35939447907390915}-{'f1_val': 0.9988708350860451, 'auprc': 0.9988708350860451, 'loss_val': 0.8212399995309023, 'psi': 0.9988708350860451}
[S9] START round=18 head_norm_before_train=1.868741 (no previous merge yet)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8183738792366073, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.774360746932346, 'psi': 0.36867172340800847}
[S10] START round=18 head_norm_before_train=1.390195 cos_to_last_merge=0.9817 (last merge round=14)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.33237456056248, 'auprc': 0.33237456056248, 'loss_val': 2.3556625604586365, 'psi': 0.33237456056248}-{'f1_val': 0.3316518536311955, 'auprc': 0.3316518536311955, 'loss_val': 2.274849900055607, 'psi': 0.3316518536311955}
[S11] START round=18 head_norm_before_train=1.596483 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.2801439319594374, 'auprc': 0.2801439319594374, 'loss_val': 2.08406693224397, 'psi': 0.2801439319594374}-{'f1_val': 0.28047422545359274, 'auprc': 0.28047422545359274, 'loss_val': 2.0567974404706146, 'psi': 0.28047422545359274}
[S13] START round=18 head_norm_before_train=1.475395 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0051423099110588, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 0.9854846058419661, 'psi': 0.3599362944611573}
[S14] START round=18 head_norm_before_train=1.579250 (no previous merge yet)
[S14] round=18 local utility u=0.001486 metrics={'f1_val': 0.0950846091861402, 'auprc': 0.0950846091861402, 'loss_val': 5.767863869875678, 'psi': 0.0950846091861402}-{'f1_val': 0.09029649595687332, 'auprc': 0.09029649595687332, 'loss_val': 5.727742524914865, 'psi': 0.09029649595687332}
[S15] START round=18 head_norm_before_train=1.596676 (no previous merge yet)
[S15] round=18 local utility u=0.008743 metrics={'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.6141892530292239, 'psi': 0.6166941009299512}-{'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.6329265081125622, 'psi': 0.6168330926211807}
[S16] START round=18 head_norm_before_train=1.135100 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.608755 metrics={'f1_val': 0.14286752416248819, 'auprc': 0.14286752416248819, 'loss_val': 1.7230393958545556, 'psi': 0.14286752416248819}-{'f1_val': 0.05823599119688505, 'auprc': 0.05823599119688505, 'loss_val': 2.1788661114254966, 'psi': 0.05823599119688505}
[S17] START round=18 head_norm_before_train=1.491321 (no previous merge yet)
[S17] round=18 local utility u=0.039984 metrics={'f1_val': 0.15814374874169518, 'auprc': 0.15814374874169518, 'loss_val': 1.2443532801894808, 'psi': 0.15814374874169518}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.2716163822560993, 'psi': 0.152287708414114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:50308
[S14] not sending this round → trigger blocked (psi=0.095)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:50305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.054)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.143)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:50309
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=-0.0043
[S3] DROPPED delta from S5 (cos=-0.0043 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=-0.0811
[S6] DROPPED delta from S3 (cos=-0.0811 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=-0.1393
[S5] DROPPED delta from S2 (cos=-0.1393 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=-0.0757
[S8] DROPPED delta from S7 (cos=-0.0757 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S4
[S8] cosine check vs S4: cos=0.0523
[S7] RECEIVED delta(kind=head bytes=1800) from S15
[S7] cosine check vs S15: cos=0.7579
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=-0.0015
[S14] DROPPED delta from S17 (cos=-0.0015 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.3594 head_norm=1.725691
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.206909e+00
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.3594 head_norm=1.271738 delta_norm=1.206909
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.2398 head_norm=1.161070
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.332891e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.3598 head_norm=1.311276 delta_norm=0.533289
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.686517 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.26375213338584746, 'auprc': 0.26375213338584746, 'loss_val': 2.544221271576095, 'psi': 0.26375213338584746}-{'f1_val': 0.26427255985267034, 'auprc': 0.26427255985267034, 'loss_val': 2.5146152942351288, 'psi': 0.26427255985267034}
[S3] START round=19 head_norm_before_train=1.658487 cos_to_last_merge=0.9455 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=19 local utility u=0.133362 metrics={'f1_val': 0.180835734870317, 'auprc': 0.180835734870317, 'loss_val': 3.372615877529627, 'psi': 0.180835734870317}-{'f1_val': 0.1691285081240768, 'auprc': 0.1691285081240768, 'loss_val': 3.5339758311172447, 'psi': 0.1691285081240768}
[S4] START round=19 head_norm_before_train=1.780417 (no previous merge yet)
[S4] round=19 local utility u=0.008067 metrics={'f1_val': 0.33198517020559487, 'auprc': 0.33198517020559487, 'loss_val': 1.3002773252528843, 'psi': 0.33198517020559487}-{'f1_val': 0.33299492385786805, 'auprc': 0.33299492385786805, 'loss_val': 1.3254983274062273, 'psi': 0.33299492385786805}
[S5] START round=19 head_norm_before_train=1.847393 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7989287731019066, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7007512822517405, 'psi': 0.3335071121394324}
[S6] START round=19 head_norm_before_train=1.678372 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.015088207985143919, 'auprc': 0.015088207985143919, 'loss_val': 5.560074491962852, 'psi': 0.015088207985143919}-{'f1_val': 0.05439419795221843, 'auprc': 0.05439419795221843, 'loss_val': 4.831562500949938, 'psi': 0.054394197952218434}
[S7] START round=19 head_norm_before_train=1.311276 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.053983 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.026494643814636, 'psi': 0.2396131805157593}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 1.135837069665759, 'psi': 0.23976608187134504}
[S8] START round=19 head_norm_before_train=1.271738 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.025214767857613, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 0.8054317552430652, 'psi': 0.35939447907390915}
[S9] START round=19 head_norm_before_train=1.881254 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8509924726996987, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8183738792366073, 'psi': 0.36867172340800847}
[S10] START round=19 head_norm_before_train=1.435013 cos_to_last_merge=0.9744 (last merge round=14)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.33245508982035926, 'auprc': 0.33245508982035926, 'loss_val': 2.3610438965862217, 'psi': 0.33245508982035926}-{'f1_val': 0.33237456056248, 'auprc': 0.33237456056248, 'loss_val': 2.3556625604586365, 'psi': 0.33237456056248}
[S11] START round=19 head_norm_before_train=1.619057 (no previous merge yet)
[S11] round=19 local utility u=0.513597 metrics={'f1_val': 0.3720243266724587, 'auprc': 0.3720243266724587, 'loss_val': 1.8837964028829768, 'psi': 0.3720243266724587}-{'f1_val': 0.2801439319594374, 'auprc': 0.2801439319594374, 'loss_val': 2.08406693224397, 'psi': 0.2801439319594374}
[S13] START round=19 head_norm_before_train=1.495880 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.042904719991629, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0051423099110588, 'psi': 0.3599362944611573}
[S14] START round=19 head_norm_before_train=1.599431 (no previous merge yet)
[S14] round=19 local utility u=0.010882 metrics={'f1_val': 0.09137604758042715, 'auprc': 0.09137604758042715, 'loss_val': 5.712722336661647, 'psi': 0.09137604758042715}-{'f1_val': 0.0950846091861402, 'auprc': 0.0950846091861402, 'loss_val': 5.767863869875678, 'psi': 0.0950846091861402}
[S15] START round=19 head_norm_before_train=1.630828 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6599080813905638, 'psi': 0.6164158146233559}-{'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.6141892530292239, 'psi': 0.6166941009299512}
[S16] START round=19 head_norm_before_train=1.181549 cos_to_last_merge=0.9959 (last merge round=17)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.4679529949424333, 'psi': 0.08899598393574297}-{'f1_val': 0.14286752416248819, 'auprc': 0.14286752416248819, 'loss_val': 1.7230393958545556, 'psi': 0.14286752416248819}
[S17] START round=19 head_norm_before_train=1.504264 (no previous merge yet)
[S17] round=19 local utility u=0.274417 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.0989694666853072, 'psi': 0.20297157622739018}-{'f1_val': 0.15814374874169518, 'auprc': 0.15814374874169518, 'loss_val': 1.2443532801894808, 'psi': 0.15814374874169518}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.091)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:50311
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:50309
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S11
[S10] cosine check vs S11: cos=0.8460
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=-0.0408
[S8] DROPPED delta from S7 (cos=-0.0408 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S4
[S8] cosine check vs S4: cos=0.7103
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] cosine check vs S3: cos=-0.0824
[S6] DROPPED delta from S3 (cos=-0.0824 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] cosine check vs S17: cos=-0.0008
[S14] DROPPED delta from S17 (cos=-0.0008 < 0.0)
[S6] r=20 psi=0.015 u=0.0000 p_local=0.0456 f1=0.015 auprc=0.015 bytes=0
[S5] r=20 psi=0.334 u=0.0000 p_local=0.0885 f1=0.334 auprc=0.334 bytes=17990
[S13] r=20 psi=0.360 u=0.0000 p_local=0.1278 f1=0.360 auprc=0.360 bytes=10819
[S15] r=20 psi=0.616 u=0.0000 p_local=0.1525 f1=0.616 auprc=0.616 bytes=10798
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.3325 head_norm=1.479795
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.394019e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.3325 head_norm=1.498276 delta_norm=0.439402
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.332 u=0.0000 p_local=0.1427 f1=0.332 auprc=0.332 bytes=7192
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.3594 head_norm=1.318347
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.327356e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.3594 head_norm=1.443157 delta_norm=0.632736
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.359 u=0.0000 p_local=0.2834 f1=0.359 auprc=0.359 bytes=18015
[S9] r=20 psi=0.369 u=0.0000 p_local=0.0421 f1=0.369 auprc=0.369 bytes=1802
[S2] r=20 psi=0.264 u=0.0000 p_local=0.0783 f1=0.264 auprc=0.264 bytes=9002
[S14] r=20 psi=0.091 u=0.0109 p_local=0.0797 f1=0.091 auprc=0.091 bytes=0
[S16] r=20 psi=0.089 u=0.0000 p_local=0.1520 f1=0.089 auprc=0.089 bytes=0
[S11] r=20 psi=0.372 u=0.5136 p_local=0.1825 f1=0.372 auprc=0.372 bytes=5407
[S3] r=20 psi=0.181 u=0.1334 p_local=0.1115 f1=0.181 auprc=0.181 bytes=7198
[S7] r=20 psi=0.240 u=0.0540 p_local=0.0636 f1=0.240 auprc=0.240 bytes=17989
[S4] r=20 psi=0.332 u=0.0081 p_local=0.2359 f1=0.332 auprc=0.332 bytes=3597
[S17] r=20 psi=0.203 u=0.2744 p_local=0.1002 f1=0.203 auprc=0.203 bytes=12613
[S2] START round=20 head_norm_before_train=1.703419 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.25356556859775337, 'auprc': 0.25356556859775337, 'loss_val': 2.544705850438551, 'psi': 0.25356556859775337}-{'f1_val': 0.26375213338584746, 'auprc': 0.26375213338584746, 'loss_val': 2.544221271576095, 'psi': 0.26375213338584746}
[S3] START round=20 head_norm_before_train=1.677723 cos_to_last_merge=0.9434 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.1356512577373897, 'auprc': 0.1356512577373897, 'loss_val': 4.063334302968251, 'psi': 0.1356512577373897}-{'f1_val': 0.180835734870317, 'auprc': 0.180835734870317, 'loss_val': 3.372615877529627, 'psi': 0.180835734870317}
[S4] START round=20 head_norm_before_train=1.796684 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.3222958057395144, 'auprc': 0.3222958057395144, 'loss_val': 1.2864913101831061, 'psi': 0.3222958057395144}-{'f1_val': 0.33198517020559487, 'auprc': 0.33198517020559487, 'loss_val': 1.3002773252528843, 'psi': 0.33198517020559487}
[S5] START round=20 head_norm_before_train=1.876461 (no previous merge yet)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.948562178401336, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.7989287731019066, 'psi': 0.3335071121394324}
[S6] START round=20 head_norm_before_train=1.697432 (no previous merge yet)
[S6] round=20 local utility u=0.016109 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.587803727279384, 'psi': 0.021749084249084248}-{'f1_val': 0.015088207985143919, 'auprc': 0.015088207985143919, 'loss_val': 5.560074491962852, 'psi': 0.015088207985143919}
[S7] START round=20 head_norm_before_train=1.373353 cos_to_last_merge=0.9921 (last merge round=18)
[S7] round=20 local utility u=0.030706 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.966459223890072, 'psi': 0.23976608187134504}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 1.026494643814636, 'psi': 0.2396131805157593}
[S8] START round=20 head_norm_before_train=1.443157 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.155207554222267, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.025214767857613, 'psi': 0.35939447907390915}
[S9] START round=20 head_norm_before_train=1.892441 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.883168782421835, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.8509924726996987, 'psi': 0.36867172340800847}
[S10] START round=20 head_norm_before_train=1.498276 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.307352 metrics={'f1_val': 0.33237547892720304, 'auprc': 0.33237547892720304, 'loss_val': 1.7456234095862382, 'psi': 0.33237547892720304}-{'f1_val': 0.33245508982035926, 'auprc': 0.33245508982035926, 'loss_val': 2.3610438965862217, 'psi': 0.33245508982035926}
[S11] START round=20 head_norm_before_train=1.638908 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.2720803151607574, 'auprc': 0.2720803151607574, 'loss_val': 2.14796923214407, 'psi': 0.2720803151607574}-{'f1_val': 0.3720243266724587, 'auprc': 0.3720243266724587, 'loss_val': 1.8837964028829768, 'psi': 0.3720243266724587}
[S13] START round=20 head_norm_before_train=1.514569 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0577529492554223, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.042904719991629, 'psi': 0.3599362944611573}
[S14] START round=20 head_norm_before_train=1.621551 (no previous merge yet)
[S14] round=20 local utility u=0.163481 metrics={'f1_val': 0.11206671879072193, 'auprc': 0.11206671879072193, 'loss_val': 5.571976206862922, 'psi': 0.11206671879072191}-{'f1_val': 0.09137604758042715, 'auprc': 0.09137604758042715, 'loss_val': 5.712722336661647, 'psi': 0.09137604758042715}
[S15] START round=20 head_norm_before_train=1.659799 (no previous merge yet)
[S15] round=20 local utility u=0.053079 metrics={'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.5575051628971488, 'psi': 0.6168330926211807}-{'f1_val': 0.6164158146233559, 'auprc': 0.6164158146233559, 'loss_val': 0.6599080813905638, 'psi': 0.6164158146233559}
[S16] START round=20 head_norm_before_train=1.238683 cos_to_last_merge=0.9863 (last merge round=17)
[S16] round=20 local utility u=0.302611 metrics={'f1_val': 0.13902331720193575, 'auprc': 0.13902331720193575, 'loss_val': 2.312977931328621, 'psi': 0.13902331720193575}-{'f1_val': 0.08899598393574297, 'auprc': 0.08899598393574297, 'loss_val': 2.4679529949424333, 'psi': 0.08899598393574297}
[S17] START round=20 head_norm_before_train=1.520503 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0196276841710492, 'psi': 0.152287708414114}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 1.0989694666853072, 'psi': 0.20297157622739018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:50309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:50308
[S6] not sending this round → trigger blocked (psi=0.022)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.112)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.139)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] cosine check vs S7: cos=-0.0273
[S8] DROPPED delta from S7 (cos=-0.0273 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.3535
[S7] RECEIVED delta(kind=head bytes=1806) from S15
[S7] cosine check vs S15: cos=0.9086
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.034 → S3@127.0.0.1:50303
[S11] ⇄ pheromone p=0.146 → S10@127.0.0.1:50311
[S2] ⇄ pheromone p=0.063 → S5@127.0.0.1:50305
[S13] ⇄ pheromone p=0.102 → S16@127.0.0.1:50316
[S5] ⇄ pheromone p=0.071 → S3@127.0.0.1:50303
[S14] ⇄ pheromone p=0.096 → S13@127.0.0.1:50313
[S8] ⇄ pheromone p=0.227 → S16@127.0.0.1:50316
[S3] ⇄ pheromone p=0.089 → S6@127.0.0.1:50307
[S6] ⇄ pheromone p=0.040 → S7@127.0.0.1:50308
[S4] ⇄ pheromone p=0.189 → S8@127.0.0.1:50309
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.2398 head_norm=1.432039
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.682389e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.2398 head_norm=1.273371 delta_norm=0.368239
[S7] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.057 → S8@127.0.0.1:50309
[S10] ⇄ pheromone p=0.176 → S7@127.0.0.1:50308
[S15] ⇄ pheromone p=0.133 → S7@127.0.0.1:50308
[S16] ⇄ pheromone p=0.182 → S4@127.0.0.1:50304
[S17] ⇄ pheromone p=0.080 → S14@127.0.0.1:50314
[S2] START round=21 head_norm_before_train=1.718637 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.2491782945736434, 'auprc': 0.2491782945736434, 'loss_val': 2.5539258176638864, 'psi': 0.2491782945736434}-{'f1_val': 0.25356556859775337, 'auprc': 0.25356556859775337, 'loss_val': 2.544705850438551, 'psi': 0.25356556859775337}
[S3] START round=21 head_norm_before_train=1.694110 cos_to_last_merge=0.9416 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=21 local utility u=1.000000 metrics={'f1_val': 0.2794798324884285, 'auprc': 0.2794798324884285, 'loss_val': 2.7236267160579737, 'psi': 0.2794798324884285}-{'f1_val': 0.1356512577373897, 'auprc': 0.1356512577373897, 'loss_val': 4.063334302968251, 'psi': 0.1356512577373897}
[S4] START round=21 head_norm_before_train=1.811256 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.24314160655939832, 'auprc': 0.24314160655939832, 'loss_val': 1.2745441708870602, 'psi': 0.24314160655939832}-{'f1_val': 0.3222958057395144, 'auprc': 0.3222958057395144, 'loss_val': 1.2864913101831061, 'psi': 0.3222958057395144}
[S5] START round=21 head_norm_before_train=1.912929 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0435580831730995, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.948562178401336, 'psi': 0.3335071121394324}
[S6] START round=21 head_norm_before_train=1.712930 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 5.77272087962518, 'psi': 0.020871559633027524}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 5.587803727279384, 'psi': 0.021749084249084248}
[S7] START round=21 head_norm_before_train=1.273371 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.994084111888367, 'psi': 0.23976608187134504}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.966459223890072, 'psi': 0.23976608187134504}
[S8] START round=21 head_norm_before_train=1.475480 cos_to_last_merge=0.9964 (last merge round=19)
[S8] round=21 local utility u=0.028762 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0976830141359488, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.155207554222267, 'psi': 0.35939447907390915}
[S9] START round=21 head_norm_before_train=1.903512 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9177202351115525, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.883168782421835, 'psi': 0.36867172340800847}
[S10] START round=21 head_norm_before_train=1.534199 cos_to_last_merge=0.9994 (last merge round=19)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.33237547892720304, 'auprc': 0.33237547892720304, 'loss_val': 1.8672165055477794, 'psi': 0.33237547892720304}-{'f1_val': 0.33237547892720304, 'auprc': 0.33237547892720304, 'loss_val': 1.7456234095862382, 'psi': 0.33237547892720304}
[S11] START round=21 head_norm_before_train=1.658546 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.255840353707355, 'auprc': 0.255840353707355, 'loss_val': 2.1072676431079826, 'psi': 0.255840353707355}-{'f1_val': 0.2720803151607574, 'auprc': 0.2720803151607574, 'loss_val': 2.14796923214407, 'psi': 0.2720803151607574}
[S13] START round=21 head_norm_before_train=1.531850 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0778356140594256, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0577529492554223, 'psi': 0.3599362944611573}
[S14] START round=21 head_norm_before_train=1.644619 (no previous merge yet)
[S14] round=21 local utility u=0.170555 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.445152820665251, 'psi': 0.13587634006482174}-{'f1_val': 0.11206671879072193, 'auprc': 0.11206671879072193, 'loss_val': 5.571976206862922, 'psi': 0.11206671879072191}
[S15] START round=21 head_norm_before_train=1.687028 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5796119089811766, 'psi': 0.6166125814646326}-{'f1_val': 0.6168330926211807, 'auprc': 0.6168330926211807, 'loss_val': 0.5575051628971488, 'psi': 0.6168330926211807}
[S16] START round=21 head_norm_before_train=1.294342 cos_to_last_merge=0.9757 (last merge round=17)
[S16] round=21 local utility u=0.284848 metrics={'f1_val': 0.17374068758116326, 'auprc': 0.17374068758116326, 'loss_val': 2.055739121283709, 'psi': 0.17374068758116326}-{'f1_val': 0.13902331720193575, 'auprc': 0.13902331720193575, 'loss_val': 2.312977931328621, 'psi': 0.13902331720193575}
[S17] START round=21 head_norm_before_train=1.538479 (no previous merge yet)
[S17] round=21 local utility u=0.029589 metrics={'f1_val': 0.15249466123082897, 'auprc': 0.15249466123082897, 'loss_val': 0.9623130561334026, 'psi': 0.15249466123082897}-{'f1_val': 0.152287708414114, 'auprc': 0.152287708414114, 'loss_val': 1.0196276841710492, 'psi': 0.152287708414114}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S16] not sending this round → trigger blocked (psi=0.174)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:50316
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:50307
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.3858
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=-0.0845
[S6] DROPPED delta from S3 (cos=-0.0845 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=-0.0036
[S14] DROPPED delta from S17 (cos=-0.0036 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.1737 head_norm=1.342037
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.971510e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.1759 head_norm=1.193181 delta_norm=0.797151
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.732010 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.24927104659097957, 'auprc': 0.24927104659097957, 'loss_val': 2.5776606090411507, 'psi': 0.2492710465909796}-{'f1_val': 0.2491782945736434, 'auprc': 0.2491782945736434, 'loss_val': 2.5539258176638864, 'psi': 0.2491782945736434}
[S3] START round=22 head_norm_before_train=1.708432 cos_to_last_merge=0.9400 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.18413834227787718, 'auprc': 0.18413834227787718, 'loss_val': 3.4081495719092696, 'psi': 0.18413834227787718}-{'f1_val': 0.2794798324884285, 'auprc': 0.2794798324884285, 'loss_val': 2.7236267160579737, 'psi': 0.2794798324884285}
[S4] START round=22 head_norm_before_train=1.828576 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.2380348844227171, 'auprc': 0.2380348844227171, 'loss_val': 1.2628435186472373, 'psi': 0.23803488442271714}-{'f1_val': 0.24314160655939832, 'auprc': 0.24314160655939832, 'loss_val': 1.2745441708870602, 'psi': 0.24314160655939832}
[S5] START round=22 head_norm_before_train=1.952567 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.102816580189806, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0435580831730995, 'psi': 0.3335071121394324}
[S6] START round=22 head_norm_before_train=1.727214 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.806931089176169, 'psi': 0.02153000458085204}-{'f1_val': 0.020871559633027524, 'auprc': 0.020871559633027524, 'loss_val': 5.77272087962518, 'psi': 0.020871559633027524}
[S7] START round=22 head_norm_before_train=1.323779 cos_to_last_merge=0.9972 (last merge round=20)
[S7] round=22 local utility u=0.026374 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9406489184676078, 'psi': 0.23968964488212474}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.994084111888367, 'psi': 0.23976608187134504}
[S8] START round=22 head_norm_before_train=1.522235 cos_to_last_merge=0.9859 (last merge round=19)
[S8] round=22 local utility u=0.027155 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0433730285356553, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0976830141359488, 'psi': 0.35939447907390915}
[S9] START round=22 head_norm_before_train=1.914282 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9517538350281165, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9177202351115525, 'psi': 0.36867172340800847}
[S10] START round=22 head_norm_before_train=1.579116 cos_to_last_merge=0.9972 (last merge round=19)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.33229540918163675, 'auprc': 0.33229540918163675, 'loss_val': 1.992206298630235, 'psi': 0.33229540918163675}-{'f1_val': 0.33237547892720304, 'auprc': 0.33237547892720304, 'loss_val': 1.8672165055477794, 'psi': 0.33237547892720304}
[S11] START round=22 head_norm_before_train=1.678185 (no previous merge yet)
[S11] round=22 local utility u=0.017985 metrics={'f1_val': 0.27699074972507925, 'auprc': 0.27699074972507925, 'loss_val': 2.261651215459999, 'psi': 0.27699074972507925}-{'f1_val': 0.255840353707355, 'auprc': 0.255840353707355, 'loss_val': 2.1072676431079826, 'psi': 0.255840353707355}
[S13] START round=22 head_norm_before_train=1.544703 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.095013431761004, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.0778356140594256, 'psi': 0.3599362944611573}
[S14] START round=22 head_norm_before_train=1.667044 (no previous merge yet)
[S14] round=22 local utility u=0.000712 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.443729616593769, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.445152820665251, 'psi': 0.13587634006482174}
[S15] START round=22 head_norm_before_train=1.718704 (no previous merge yet)
[S15] round=22 local utility u=0.049600 metrics={'f1_val': 0.6170292541633583, 'auprc': 0.6170292541633583, 'loss_val': 0.48416284211763655, 'psi': 0.6170292541633583}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.5796119089811766, 'psi': 0.6166125814646326}
[S16] START round=22 head_norm_before_train=1.193181 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.04850361197110423, 'auprc': 0.04850361197110423, 'loss_val': 2.7554020180321777, 'psi': 0.04850361197110423}-{'f1_val': 0.17374068758116326, 'auprc': 0.17374068758116326, 'loss_val': 2.055739121283709, 'psi': 0.17374068758116326}
[S17] START round=22 head_norm_before_train=1.556559 (no previous merge yet)
[S17] round=22 local utility u=0.250810 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9142770685048345, 'psi': 0.20289293555469456}-{'f1_val': 0.15249466123082897, 'auprc': 0.15249466123082897, 'loss_val': 0.9623130561334026, 'psi': 0.15249466123082897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:50309
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.136)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:50316
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:50311
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S11
[S10] cosine check vs S11: cos=0.9338
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.8582
[S8] RECEIVED delta(kind=head bytes=1806) from S7
[S8] cosine check vs S7: cos=-0.0278
[S8] DROPPED delta from S7 (cos=-0.0278 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.8569
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=-0.0050
[S14] DROPPED delta from S17 (cos=-0.0050 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.3323 head_norm=1.625495
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.046152e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.3323 head_norm=1.634584 delta_norm=0.304615
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.2397 head_norm=1.363416
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.538348e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.2397 head_norm=1.500370 delta_norm=0.453835
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.0485 head_norm=1.232860
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.099935e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.0578 head_norm=1.353379 delta_norm=0.409994
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.743909 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 2.598947233718583, 'psi': 0.2488542053759445}-{'f1_val': 0.24927104659097957, 'auprc': 0.24927104659097957, 'loss_val': 2.5776606090411507, 'psi': 0.2492710465909796}
[S3] START round=23 head_norm_before_train=1.719434 cos_to_last_merge=0.9388 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.17451624680540342, 'auprc': 0.17451624680540342, 'loss_val': 3.59081959819871, 'psi': 0.17451624680540342}-{'f1_val': 0.18413834227787718, 'auprc': 0.18413834227787718, 'loss_val': 3.4081495719092696, 'psi': 0.18413834227787718}
[S4] START round=23 head_norm_before_train=1.847450 (no previous merge yet)
[S4] round=23 local utility u=0.542108 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2474580051691933, 'psi': 0.3567939207526687}-{'f1_val': 0.2380348844227171, 'auprc': 0.2380348844227171, 'loss_val': 1.2628435186472373, 'psi': 0.23803488442271714}
[S5] START round=23 head_norm_before_train=1.988627 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1479731431013045, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.102816580189806, 'psi': 0.3335071121394324}
[S6] START round=23 head_norm_before_train=1.741066 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 6.009262555866535, 'psi': 0.01954921803127875}-{'f1_val': 0.02153000458085204, 'auprc': 0.02153000458085204, 'loss_val': 5.806931089176169, 'psi': 0.02153000458085204}
[S7] START round=23 head_norm_before_train=1.500370 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.019124 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9024013603176267, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9406489184676078, 'psi': 0.23968964488212474}
[S8] START round=23 head_norm_before_train=1.574647 cos_to_last_merge=0.9738 (last merge round=19)
[S8] round=23 local utility u=0.018544 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0062851200010663, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0433730285356553, 'psi': 0.35939447907390915}
[S9] START round=23 head_norm_before_train=1.924528 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.98313237162353, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.9517538350281165, 'psi': 0.36867172340800847}
[S10] START round=23 head_norm_before_train=1.634584 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.142546 metrics={'f1_val': 0.33229540918163675, 'auprc': 0.33229540918163675, 'loss_val': 1.7071147700534661, 'psi': 0.33229540918163675}-{'f1_val': 0.33229540918163675, 'auprc': 0.33229540918163675, 'loss_val': 1.992206298630235, 'psi': 0.33229540918163675}
[S11] START round=23 head_norm_before_train=1.699140 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.27779940314000257, 'auprc': 0.27779940314000257, 'loss_val': 2.3134235934178586, 'psi': 0.27779940314000257}-{'f1_val': 0.27699074972507925, 'auprc': 0.27699074972507925, 'loss_val': 2.261651215459999, 'psi': 0.27699074972507925}
[S13] START round=23 head_norm_before_train=1.557043 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.113635899845009, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.095013431761004, 'psi': 0.3599362944611573}
[S14] START round=23 head_norm_before_train=1.688417 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.498357201730036, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.443729616593769, 'psi': 0.13587634006482174}
[S15] START round=23 head_norm_before_train=1.747928 (no previous merge yet)
[S15] round=23 local utility u=0.036580 metrics={'f1_val': 0.6176649292091688, 'auprc': 0.6176649292091688, 'loss_val': 0.41672392928081015, 'psi': 0.6176649292091688}-{'f1_val': 0.6170292541633583, 'auprc': 0.6170292541633583, 'loss_val': 0.48416284211763655, 'psi': 0.6170292541633583}
[S16] START round=23 head_norm_before_train=1.353379 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=1.000000 metrics={'f1_val': 0.1413065126468831, 'auprc': 0.1413065126468831, 'loss_val': 1.5296051579901249, 'psi': 0.1413065126468831}-{'f1_val': 0.04850361197110423, 'auprc': 0.04850361197110423, 'loss_val': 2.7554020180321777, 'psi': 0.04850361197110423}
[S17] START round=23 head_norm_before_train=1.573451 (no previous merge yet)
[S17] round=23 local utility u=0.019608 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8757691428959185, 'psi': 0.20297157622739018}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.9142770685048345, 'psi': 0.20289293555469456}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.141)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:50316
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:50309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:50308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:50308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S8
[S16] cosine check vs S8: cos=0.9662
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=-0.0173
[S8] DROPPED delta from S7 (cos=-0.0173 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S4
[S8] cosine check vs S4: cos=0.8473
[S7] RECEIVED delta(kind=head bytes=1799) from S15
[S7] cosine check vs S15: cos=0.9669
[S7] RECEIVED delta(kind=head bytes=1791) from S10
[S7] cosine check vs S10: cos=0.3039
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=-0.0062
[S14] DROPPED delta from S17 (cos=-0.0062 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.3594 head_norm=1.623813
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.943440e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.3594 head_norm=1.674011 delta_norm=0.494344
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.2397 head_norm=1.522487
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.887603e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.2398 head_norm=1.358884 delta_norm=0.388760
[S7] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.1413 head_norm=1.388768
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.278740e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.1917 head_norm=1.493585 delta_norm=0.227874
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.755278 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.2480706303636476, 'auprc': 0.2480706303636476, 'loss_val': 2.617345290153502, 'psi': 0.2480706303636476}-{'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 2.598947233718583, 'psi': 0.2488542053759445}
[S3] START round=24 head_norm_before_train=1.730872 cos_to_last_merge=0.9376 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=24 local utility u=0.564817 metrics={'f1_val': 0.24320704171450439, 'auprc': 0.24320704171450439, 'loss_val': 3.079402891753454, 'psi': 0.24320704171450436}-{'f1_val': 0.17451624680540342, 'auprc': 0.17451624680540342, 'loss_val': 3.59081959819871, 'psi': 0.17451624680540342}
[S4] START round=24 head_norm_before_train=1.859196 (no previous merge yet)
[S4] round=24 local utility u=0.007430 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2325977665030257, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2474580051691933, 'psi': 0.3567939207526687}
[S5] START round=24 head_norm_before_train=2.024544 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1905438243660726, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1479731431013045, 'psi': 0.3335071121394324}
[S6] START round=24 head_norm_before_train=1.754372 (no previous merge yet)
[S6] round=24 local utility u=0.102140 metrics={'f1_val': 0.028442437923250564, 'auprc': 0.028442437923250564, 'loss_val': 5.885021939808368, 'psi': 0.02844243792325056}-{'f1_val': 0.01954921803127875, 'auprc': 0.01954921803127875, 'loss_val': 6.009262555866535, 'psi': 0.01954921803127875}
[S7] START round=24 head_norm_before_train=1.358884 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9295356152526343, 'psi': 0.23968964488212474}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9024013603176267, 'psi': 0.23968964488212474}
[S8] START round=24 head_norm_before_train=1.674011 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1079093400591862, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0062851200010663, 'psi': 0.35939447907390915}
[S9] START round=24 head_norm_before_train=1.934204 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.009268854426011, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 2.98313237162353, 'psi': 0.36867172340800847}
[S10] START round=24 head_norm_before_train=1.675223 cos_to_last_merge=0.9992 (last merge round=22)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.3321351545650611, 'auprc': 0.3321351545650611, 'loss_val': 1.8932912822113113, 'psi': 0.3321351545650611}-{'f1_val': 0.33229540918163675, 'auprc': 0.33229540918163675, 'loss_val': 1.7071147700534661, 'psi': 0.33229540918163675}
[S11] START round=24 head_norm_before_train=1.719908 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.2762402425649958, 'auprc': 0.2762402425649958, 'loss_val': 2.3437424628598835, 'psi': 0.2762402425649958}-{'f1_val': 0.27779940314000257, 'auprc': 0.27779940314000257, 'loss_val': 2.3134235934178586, 'psi': 0.27779940314000257}
[S13] START round=24 head_norm_before_train=1.566946 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1343249747396746, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.113635899845009, 'psi': 0.3599362944611573}
[S14] START round=24 head_norm_before_train=1.708176 (no previous merge yet)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.546411226014762, 'psi': 0.13582554517133957}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.498357201730036, 'psi': 0.13592717296421}
[S15] START round=24 head_norm_before_train=1.776904 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.5221988887671769, 'psi': 0.6166941009299512}-{'f1_val': 0.6176649292091688, 'auprc': 0.6176649292091688, 'loss_val': 0.41672392928081015, 'psi': 0.6176649292091688}
[S16] START round=24 head_norm_before_train=1.493585 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 2.1975260314918144, 'psi': 0.09036289353520788}-{'f1_val': 0.1413065126468831, 'auprc': 0.1413065126468831, 'loss_val': 1.5296051579901249, 'psi': 0.1413065126468831}
[S17] START round=24 head_norm_before_train=1.590460 (no previous merge yet)
[S17] round=24 local utility u=0.005628 metrics={'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8638048494486432, 'psi': 0.20289293555469456}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8757691428959185, 'psi': 0.20297157622739018}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[S6] not sending this round → trigger blocked (psi=0.028)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:50307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S4
[S8] cosine check vs S4: cos=0.9517
[S6] RECEIVED delta(kind=head bytes=1802) from S3
[S6] cosine check vs S3: cos=-0.0874
[S6] DROPPED delta from S3 (cos=-0.0874 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1807 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1807) from S17
[S14] cosine check vs S17: cos=-0.0073
[S14] DROPPED delta from S17 (cos=-0.0073 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.3594 head_norm=1.710025
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.897028e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.3594 head_norm=1.769587 delta_norm=0.289703
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.765947 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.24756623536660505, 'auprc': 0.24756623536660505, 'loss_val': 2.634988276162274, 'psi': 0.24756623536660505}-{'f1_val': 0.2480706303636476, 'auprc': 0.2480706303636476, 'loss_val': 2.617345290153502, 'psi': 0.2480706303636476}
[S3] START round=25 head_norm_before_train=1.742812 cos_to_last_merge=0.9363 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.1646795827123696, 'auprc': 0.1646795827123696, 'loss_val': 3.787444379333265, 'psi': 0.1646795827123696}-{'f1_val': 0.24320704171450439, 'auprc': 0.24320704171450439, 'loss_val': 3.079402891753454, 'psi': 0.24320704171450436}
[S4] START round=25 head_norm_before_train=1.872576 (no previous merge yet)
[S4] round=25 local utility u=0.004817 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2229628351282258, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2325977665030257, 'psi': 0.3567939207526687}
[S5] START round=25 head_norm_before_train=2.048816 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2153885397731075, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1905438243660726, 'psi': 0.3335071121394324}
[S6] START round=25 head_norm_before_train=1.767113 (no previous merge yet)
[S6] round=25 local utility u=0.284060 metrics={'f1_val': 0.08551587301587302, 'auprc': 0.08551587301587302, 'loss_val': 5.830563537961348, 'psi': 0.08551587301587302}-{'f1_val': 0.028442437923250564, 'auprc': 0.028442437923250564, 'loss_val': 5.885021939808368, 'psi': 0.02844243792325056}
[S7] START round=25 head_norm_before_train=1.387428 cos_to_last_merge=0.9989 (last merge round=23)
[S7] round=25 local utility u=0.018263 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8936976265998383, 'psi': 0.23976608187134504}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.9295356152526343, 'psi': 0.23968964488212474}
[S8] START round=25 head_norm_before_train=1.769587 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1545684431465573, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1079093400591862, 'psi': 0.35939447907390915}
[S9] START round=25 head_norm_before_train=1.943153 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0353248291054222, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.009268854426011, 'psi': 0.36867172340800847}
[S10] START round=25 head_norm_before_train=1.720928 cos_to_last_merge=0.9971 (last merge round=22)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.33181418405692814, 'auprc': 0.33181418405692814, 'loss_val': 2.029044939318525, 'psi': 0.33181418405692814}-{'f1_val': 0.3321351545650611, 'auprc': 0.3321351545650611, 'loss_val': 1.8932912822113113, 'psi': 0.3321351545650611}
[S11] START round=25 head_norm_before_train=1.739418 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.2762402425649958, 'auprc': 0.2762402425649958, 'loss_val': 2.380821745531187, 'psi': 0.2762402425649958}-{'f1_val': 0.2762402425649958, 'auprc': 0.2762402425649958, 'loss_val': 2.3437424628598835, 'psi': 0.2762402425649958}
[S13] START round=25 head_norm_before_train=1.578290 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1556592448485203, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1343249747396746, 'psi': 0.3599362944611573}
[S14] START round=25 head_norm_before_train=1.726385 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.614268291375959, 'psi': 0.13587634006482174}-{'f1_val': 0.13582554517133957, 'auprc': 0.13582554517133957, 'loss_val': 5.546411226014762, 'psi': 0.13582554517133957}
[S15] START round=25 head_norm_before_train=1.802345 (no previous merge yet)
[S15] round=25 local utility u=0.020260 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.48094471661662525, 'psi': 0.6166125814646326}-{'f1_val': 0.6166941009299512, 'auprc': 0.6166941009299512, 'loss_val': 0.5221988887671769, 'psi': 0.6166941009299512}
[S16] START round=25 head_norm_before_train=1.526507 cos_to_last_merge=0.9983 (last merge round=23)
[S16] round=25 local utility u=0.666915 metrics={'f1_val': 0.18601021566401815, 'auprc': 0.18601021566401815, 'loss_val': 1.7245220721536472, 'psi': 0.18601021566401815}-{'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 2.1975260314918144, 'psi': 0.09036289353520788}
[S17] START round=25 head_norm_before_train=1.611309 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8647950001606776, 'psi': 0.20297157622739018}-{'f1_val': 0.20289293555469456, 'auprc': 0.20289293555469456, 'loss_val': 0.8638048494486432, 'psi': 0.20289293555469456}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.086)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:50316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.186)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S4
[S16] cosine check vs S4: cos=0.7846
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.5059
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.202 → S5@127.0.0.1:50305
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.3318 head_norm=1.763063
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.059732e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.3322 head_norm=1.386384 delta_norm=0.805973
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.076 → S11@127.0.0.1:50312
[S14] ⇄ pheromone p=0.046 → S17@127.0.0.1:50317
[S5] ⇄ pheromone p=0.023 → S2@127.0.0.1:50302
[S13] ⇄ pheromone p=0.033 → S14@127.0.0.1:50314
[S8] ⇄ pheromone p=0.082 → S4@127.0.0.1:50304
[S6] ⇄ pheromone p=0.086 → S3@127.0.0.1:50303
[S4] ⇄ pheromone p=0.133 → S16@127.0.0.1:50316
[S7] ⇄ pheromone p=0.027 → S10@127.0.0.1:50311
[S17] ⇄ pheromone p=0.058 → S14@127.0.0.1:50314
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.1860 head_norm=1.564440
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.868705e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.1787 head_norm=1.631614 delta_norm=0.586870
[S16] aggregate: ROLLBACK (f1_val pre=0.186 post=0.179 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.344 → S8@127.0.0.1:50309
[S2] START round=26 head_norm_before_train=1.776095 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.24770359410640527, 'auprc': 0.24770359410640527, 'loss_val': 2.655131840006346, 'psi': 0.24770359410640527}-{'f1_val': 0.24756623536660505, 'auprc': 0.24756623536660505, 'loss_val': 2.634988276162274, 'psi': 0.24756623536660505}
[S3] START round=26 head_norm_before_train=1.754484 cos_to_last_merge=0.9350 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=26 local utility u=0.849067 metrics={'f1_val': 0.26762692273495153, 'auprc': 0.26762692273495153, 'loss_val': 3.0158364315612936, 'psi': 0.26762692273495153}-{'f1_val': 0.1646795827123696, 'auprc': 0.1646795827123696, 'loss_val': 3.787444379333265, 'psi': 0.1646795827123696}
[S4] START round=26 head_norm_before_train=1.888303 (no previous merge yet)
[S4] round=26 local utility u=0.004347 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.214267857062999, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2229628351282258, 'psi': 0.3567939207526687}
[S5] START round=26 head_norm_before_train=2.071507 (no previous merge yet)
[S5] round=26 local utility u=0.000395 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.214599110196127, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.2153885397731075, 'psi': 0.3335071121394324}
[S6] START round=26 head_norm_before_train=1.779597 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.7717919401947695, 'psi': 0.0}-{'f1_val': 0.08551587301587302, 'auprc': 0.08551587301587302, 'loss_val': 5.830563537961348, 'psi': 0.08551587301587302}
[S7] START round=26 head_norm_before_train=1.426504 cos_to_last_merge=0.9949 (last merge round=23)
[S7] round=26 local utility u=0.014210 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.863901206189499, 'psi': 0.2396131805157593}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8936976265998383, 'psi': 0.23976608187134504}
[S8] START round=26 head_norm_before_train=1.799560 cos_to_last_merge=0.9979 (last merge round=24)
[S8] round=26 local utility u=0.020045 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.114478771810962, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1545684431465573, 'psi': 0.35939447907390915}
[S9] START round=26 head_norm_before_train=1.951811 (no previous merge yet)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0586575674983374, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0353248291054222, 'psi': 0.36867172340800847}
[S10] START round=26 head_norm_before_train=1.386384 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.169109 metrics={'f1_val': 0.3320549696388623, 'auprc': 0.3320549696388623, 'loss_val': 1.6929945839756397, 'psi': 0.3320549696388623}-{'f1_val': 0.33181418405692814, 'auprc': 0.33181418405692814, 'loss_val': 2.029044939318525, 'psi': 0.33181418405692814}
[S11] START round=26 head_norm_before_train=1.756374 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.5437835650920175, 'psi': 0.28036404111831337}-{'f1_val': 0.2762402425649958, 'auprc': 0.2762402425649958, 'loss_val': 2.380821745531187, 'psi': 0.2762402425649958}
[S13] START round=26 head_norm_before_train=1.589087 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1648852285446263, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1556592448485203, 'psi': 0.3599362944611573}
[S14] START round=26 head_norm_before_train=1.743246 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.6901265444964695, 'psi': 0.13592717296421}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 5.614268291375959, 'psi': 0.13587634006482174}
[S15] START round=26 head_norm_before_train=1.823135 (no previous merge yet)
[S15] round=26 local utility u=0.057414 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.37485331339900924, 'psi': 0.6175834097438502}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.48094471661662525, 'psi': 0.6166125814646326}
[S16] START round=26 head_norm_before_train=1.631614 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.12337496813663013, 'auprc': 0.12337496813663013, 'loss_val': 1.7225113164830401, 'psi': 0.12337496813663013}-{'f1_val': 0.18601021566401815, 'auprc': 0.18601021566401815, 'loss_val': 1.7245220721536472, 'psi': 0.18601021566401815}
[S17] START round=26 head_norm_before_train=1.628972 (no previous merge yet)
[S17] round=26 local utility u=0.014583 metrics={'f1_val': 0.20755887392774128, 'auprc': 0.20755887392774128, 'loss_val': 0.876915626109947, 'psi': 0.20755887392774128}-{'f1_val': 0.20297157622739018, 'auprc': 0.20297157622739018, 'loss_val': 0.8647950001606776, 'psi': 0.20297157622739018}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S16@127.0.0.1:50316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:50307
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1808) from S8
[S16] cosine check vs S8: cos=0.9854
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] cosine check vs S4: cos=0.9432
[S11] RECEIVED delta(kind=head bytes=1797) from S10
[S11] cosine check vs S10: cos=0.8555
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=-0.0889
[S6] DROPPED delta from S3 (cos=-0.0889 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S7
[S10] cosine check vs S7: cos=0.8208
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=-0.0021
[S3] DROPPED delta from S5 (cos=-0.0021 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=-0.0087
[S14] DROPPED delta from S17 (cos=-0.0087 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.2804 head_norm=1.772633
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.608159e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.2804 head_norm=1.544080 delta_norm=0.460816
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.3321 head_norm=1.432075
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.340027e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.3323 head_norm=1.382405 delta_norm=0.434003
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.1234 head_norm=1.657988
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.258001e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.1108 head_norm=1.742917 delta_norm=0.225800
[S16] aggregate: ROLLBACK (f1_val pre=0.123 post=0.111 tol_abs=0.005 tol_rel=0.0)
[S2] START round=27 head_norm_before_train=1.785618 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.2469727702993423, 'auprc': 0.2469727702993423, 'loss_val': 2.670040001061342, 'psi': 0.2469727702993423}-{'f1_val': 0.24770359410640527, 'auprc': 0.24770359410640527, 'loss_val': 2.655131840006346, 'psi': 0.24770359410640527}
[S3] START round=27 head_norm_before_train=1.766482 cos_to_last_merge=0.9337 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.14648613797549967, 'auprc': 0.14648613797549967, 'loss_val': 4.0037081941507235, 'psi': 0.14648613797549967}-{'f1_val': 0.26762692273495153, 'auprc': 0.26762692273495153, 'loss_val': 3.0158364315612936, 'psi': 0.26762692273495153}
[S4] START round=27 head_norm_before_train=1.898659 (no previous merge yet)
[S4] round=27 local utility u=0.002385 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2094971158552115, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.214267857062999, 'psi': 0.3567939207526687}
[S5] START round=27 head_norm_before_train=2.093457 (no previous merge yet)
[S5] round=27 local utility u=0.051399 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1118008251311955, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.214599110196127, 'psi': 0.3335071121394324}
[S6] START round=27 head_norm_before_train=1.790876 (no previous merge yet)
[S6] round=27 local utility u=0.883853 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.898216959290603, 'psi': 0.09934790947449175}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.7717919401947695, 'psi': 0.0}
[S7] START round=27 head_norm_before_train=1.465593 cos_to_last_merge=0.9895 (last merge round=23)
[S7] round=27 local utility u=0.013315 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8386466989919262, 'psi': 0.23976608187134504}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.863901206189499, 'psi': 0.2396131805157593}
[S8] START round=27 head_norm_before_train=1.838739 cos_to_last_merge=0.9920 (last merge round=24)
[S8] round=27 local utility u=0.008559 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0973608316869414, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.114478771810962, 'psi': 0.35939447907390915}
[S9] START round=27 head_norm_before_train=1.960155 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.084837272749575, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.0586575674983374, 'psi': 0.36867172340800847}
[S10] START round=27 head_norm_before_train=1.382405 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.039259 metrics={'f1_val': 0.33221583652618136, 'auprc': 0.33221583652618136, 'loss_val': 1.6159239739053926, 'psi': 0.33221583652618136}-{'f1_val': 0.3320549696388623, 'auprc': 0.3320549696388623, 'loss_val': 1.6929945839756397, 'psi': 0.3320549696388623}
[S11] START round=27 head_norm_before_train=1.544080 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.158781 metrics={'f1_val': 0.2797047488405513, 'auprc': 0.2797047488405513, 'loss_val': 2.2202870034330933, 'psi': 0.2797047488405513}-{'f1_val': 0.28036404111831337, 'auprc': 0.28036404111831337, 'loss_val': 2.5437835650920175, 'psi': 0.28036404111831337}
[S13] START round=27 head_norm_before_train=1.597921 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1792848395918247, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1648852285446263, 'psi': 0.3599362944611573}
[S14] START round=27 head_norm_before_train=1.758322 (no previous merge yet)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.76120943562243, 'psi': 0.13572854291417166}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.6901265444964695, 'psi': 0.13592717296421}
[S15] START round=27 head_norm_before_train=1.845714 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.49241558017958587, 'psi': 0.6164734888353558}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.37485331339900924, 'psi': 0.6175834097438502}
[S16] START round=27 head_norm_before_train=1.742917 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.275515 metrics={'f1_val': 0.1552191595119747, 'auprc': 0.1552191595119747, 'loss_val': 1.4580795251134313, 'psi': 0.1552191595119747}-{'f1_val': 0.12337496813663013, 'auprc': 0.12337496813663013, 'loss_val': 1.7225113164830401, 'psi': 0.12337496813663013}
[S17] START round=27 head_norm_before_train=1.645925 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.2026573787409701, 'auprc': 0.2026573787409701, 'loss_val': 0.8507484391113458, 'psi': 0.2026573787409701}-{'f1_val': 0.20755887392774128, 'auprc': 0.20755887392774128, 'loss_val': 0.876915626109947, 'psi': 0.20755887392774128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:50311
[S6] not sending this round → trigger blocked (psi=0.099)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.155)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:50303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:50312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=-0.0029
[S3] DROPPED delta from S5 (cos=-0.0029 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] cosine check vs S4: cos=0.9653
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=0.9877
[S11] RECEIVED delta(kind=head bytes=1799) from S10
[S11] cosine check vs S10: cos=0.8459
[S10] RECEIVED delta(kind=head bytes=1799) from S11
[S10] cosine check vs S11: cos=0.8459
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=0.9392
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.2797 head_norm=1.560699
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.198602e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.2794 head_norm=1.437156 delta_norm=0.419860
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.3322 head_norm=1.430950
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.278843e-01
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.3322 head_norm=1.403843 delta_norm=0.127884
[S10] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.1552 head_norm=1.768862
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.445477e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.1488 head_norm=1.814774 delta_norm=0.144548
[S16] aggregate: ROLLBACK (f1_val pre=0.155 post=0.149 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.794734 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.24692723697148478, 'auprc': 0.24692723697148478, 'loss_val': 2.686328464974696, 'psi': 0.24692723697148478}-{'f1_val': 0.2469727702993423, 'auprc': 0.2469727702993423, 'loss_val': 2.670040001061342, 'psi': 0.2469727702993423}
[S3] START round=28 head_norm_before_train=1.777769 cos_to_last_merge=0.9325 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=28 local utility u=0.527229 metrics={'f1_val': 0.19302832244008716, 'auprc': 0.19302832244008716, 'loss_val': 3.3681308198668605, 'psi': 0.19302832244008716}-{'f1_val': 0.14648613797549967, 'auprc': 0.14648613797549967, 'loss_val': 4.0037081941507235, 'psi': 0.14648613797549967}
[S4] START round=28 head_norm_before_train=1.910048 (no previous merge yet)
[S4] round=28 local utility u=0.000758 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.207980539176784, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2094971158552115, 'psi': 0.3567939207526687}
[S5] START round=28 head_norm_before_train=2.100681 (no previous merge yet)
[S5] round=28 local utility u=0.016640 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.078520813584679, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1118008251311955, 'psi': 0.3335071121394324}
[S6] START round=28 head_norm_before_train=1.798214 (no previous merge yet)
[S6] round=28 local utility u=0.078104 metrics={'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.763305959313797, 'psi': 0.10171428571428572}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 5.898216959290603, 'psi': 0.09934790947449175}
[S7] START round=28 head_norm_before_train=1.502876 cos_to_last_merge=0.9840 (last merge round=23)
[S7] round=28 local utility u=0.532847 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8529324872932759, 'psi': 0.35976373724718097}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8386466989919262, 'psi': 0.23976608187134504}
[S8] START round=28 head_norm_before_train=1.879384 cos_to_last_merge=0.9846 (last merge round=24)
[S8] round=28 local utility u=0.005042 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.08727588073293, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0973608316869414, 'psi': 0.35939447907390915}
[S9] START round=28 head_norm_before_train=1.968478 (no previous merge yet)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.108701610900852, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.084837272749575, 'psi': 0.36867172340800847}
[S10] START round=28 head_norm_before_train=1.403843 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.33221583652618136, 'auprc': 0.33221583652618136, 'loss_val': 1.7034956513051698, 'psi': 0.33221583652618136}-{'f1_val': 0.33221583652618136, 'auprc': 0.33221583652618136, 'loss_val': 1.6159239739053926, 'psi': 0.33221583652618136}
[S11] START round=28 head_norm_before_train=1.437156 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.118109 metrics={'f1_val': 0.2740129263454278, 'auprc': 0.2740129263454278, 'loss_val': 1.9328427151734846, 'psi': 0.2740129263454278}-{'f1_val': 0.2797047488405513, 'auprc': 0.2797047488405513, 'loss_val': 2.2202870034330933, 'psi': 0.2797047488405513}
[S13] START round=28 head_norm_before_train=1.609216 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1974448210955102, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1792848395918247, 'psi': 0.3599362944611573}
[S14] START round=28 head_norm_before_train=1.772208 (no previous merge yet)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.824697782829929, 'psi': 0.13572854291417166}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.76120943562243, 'psi': 0.13572854291417166}
[S15] START round=28 head_norm_before_train=1.869047 (no previous merge yet)
[S15] round=28 local utility u=0.105658 metrics={'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.2948204914980836, 'psi': 0.6179979742350791}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.49241558017958587, 'psi': 0.6164734888353558}
[S16] START round=28 head_norm_before_train=1.814774 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.090979 metrics={'f1_val': 0.17449004669451953, 'auprc': 0.17449004669451953, 'loss_val': 1.4495603578196876, 'psi': 0.17449004669451953}-{'f1_val': 0.1552191595119747, 'auprc': 0.1552191595119747, 'loss_val': 1.4580795251134313, 'psi': 0.1552191595119747}
[S17] START round=28 head_norm_before_train=1.658290 (no previous merge yet)
[S17] round=28 local utility u=0.008324 metrics={'f1_val': 0.20326065549725758, 'auprc': 0.20326065549725758, 'loss_val': 0.8395301512719519, 'psi': 0.20326065549725758}-{'f1_val': 0.2026573787409701, 'auprc': 0.2026573787409701, 'loss_val': 0.8507484391113458, 'psi': 0.2026573787409701}
[S3]  timeout peer S2
[S2]  timeout peer S3
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.174)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:50303
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:50311
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.102)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:50316
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] cosine check vs S5: cos=-0.0035
[S3] DROPPED delta from S5 (cos=-0.0035 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.9843
[S16] RECEIVED delta(kind=head bytes=1802) from S4
[S16] cosine check vs S4: cos=0.9706
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] cosine check vs S11: cos=0.9737
[S10] RECEIVED delta(kind=head bytes=1806) from S7
[S10] cosine check vs S7: cos=0.9084
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] cosine check vs S3: cos=-0.0898
[S6] DROPPED delta from S3 (cos=-0.0898 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=-0.0102
[S14] DROPPED delta from S17 (cos=-0.0102 < 0.0)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.3322 head_norm=1.458929
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.041921e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.3323 head_norm=1.437072 delta_norm=0.104192
[S10] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.1745 head_norm=1.841407
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.150763e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.1693 head_norm=1.861696 delta_norm=0.115076
[S16] aggregate: ROLLBACK (f1_val pre=0.174 post=0.169 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.803274 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.24752048296679605, 'auprc': 0.24752048296679605, 'loss_val': 2.707563786000013, 'psi': 0.24752048296679607}-{'f1_val': 0.24692723697148478, 'auprc': 0.24692723697148478, 'loss_val': 2.686328464974696, 'psi': 0.24692723697148478}
[S3] START round=29 head_norm_before_train=1.787718 cos_to_last_merge=0.9315 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.17879858657243816, 'auprc': 0.17879858657243816, 'loss_val': 3.6214360257847718, 'psi': 0.17879858657243816}-{'f1_val': 0.19302832244008716, 'auprc': 0.19302832244008716, 'loss_val': 3.3681308198668605, 'psi': 0.19302832244008716}
[S4] START round=29 head_norm_before_train=1.920863 (no previous merge yet)
[S4] round=29 local utility u=0.001316 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2053479393019886, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.207980539176784, 'psi': 0.3567939207526687}
[S5] START round=29 head_norm_before_train=2.117771 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.107416748872586, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.078520813584679, 'psi': 0.3335071121394324}
[S6] START round=29 head_norm_before_train=1.804730 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.776441834616063, 'psi': 0.0}-{'f1_val': 0.10171428571428572, 'auprc': 0.10171428571428572, 'loss_val': 5.763305959313797, 'psi': 0.10171428571428572}
[S7] START round=29 head_norm_before_train=1.530886 cos_to_last_merge=0.9797 (last merge round=23)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.8272105129788635, 'psi': 0.23953668875753775}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8529324872932759, 'psi': 0.35976373724718097}
[S8] START round=29 head_norm_before_train=1.915812 cos_to_last_merge=0.9783 (last merge round=24)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0999891328821778, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.08727588073293, 'psi': 0.35939447907390915}
[S9] START round=29 head_norm_before_train=1.976467 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1290831251907902, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.108701610900852, 'psi': 0.36867172340800847}
[S10] START round=29 head_norm_before_train=1.437072 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.33237593745013566, 'auprc': 0.33237593745013566, 'loss_val': 1.7536516754839764, 'psi': 0.33237593745013566}-{'f1_val': 0.33221583652618136, 'auprc': 0.33221583652618136, 'loss_val': 1.7034956513051698, 'psi': 0.33221583652618136}
[S11] START round=29 head_norm_before_train=1.463996 cos_to_last_merge=0.9996 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.27992416813754334, 'auprc': 0.27992416813754334, 'loss_val': 2.0328161883352767, 'psi': 0.27992416813754334}-{'f1_val': 0.2740129263454278, 'auprc': 0.2740129263454278, 'loss_val': 1.9328427151734846, 'psi': 0.2740129263454278}
[S13] START round=29 head_norm_before_train=1.618411 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2163866909059577, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.1974448210955102, 'psi': 0.3599362944611573}
[S14] START round=29 head_norm_before_train=1.784678 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.887387696272827, 'psi': 0.13592717296421}-{'f1_val': 0.13572854291417166, 'auprc': 0.13572854291417166, 'loss_val': 5.824697782829929, 'psi': 0.13572854291417166}
[S15] START round=29 head_norm_before_train=1.891176 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3979423027215746, 'psi': 0.6166125814646326}-{'f1_val': 0.6179979742350791, 'auprc': 0.6179979742350791, 'loss_val': 0.2948204914980836, 'psi': 0.6179979742350791}
[S16] START round=29 head_norm_before_train=1.861696 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.10056657223796034, 'auprc': 0.10056657223796034, 'loss_val': 2.0663499316739706, 'psi': 0.10056657223796034}-{'f1_val': 0.17449004669451953, 'auprc': 0.17449004669451953, 'loss_val': 1.4495603578196876, 'psi': 0.17449004669451953}
[S17] START round=29 head_norm_before_train=1.670364 (no previous merge yet)
[S17] round=29 local utility u=0.007762 metrics={'f1_val': 0.20362806728269955, 'auprc': 0.20362806728269955, 'loss_val': 0.8273132286743857, 'psi': 0.20362806728269955}-{'f1_val': 0.20326065549725758, 'auprc': 0.20326065549725758, 'loss_val': 0.8395301512719519, 'psi': 0.20326065549725758}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] cosine check vs S4: cos=0.9715
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=-0.0109
[S14] DROPPED delta from S17 (cos=-0.0109 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.1006 head_norm=1.888112
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.292358e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.0919 head_norm=1.897193 delta_norm=0.229236
[S16] aggregate: ROLLBACK (f1_val pre=0.101 post=0.092 tol_abs=0.005 tol_rel=0.0)
[S2] START round=30 head_norm_before_train=1.811625 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.24834662216453426, 'auprc': 0.24834662216453426, 'loss_val': 2.7299989961380726, 'psi': 0.2483466221645343}-{'f1_val': 0.24752048296679605, 'auprc': 0.24752048296679605, 'loss_val': 2.707563786000013, 'psi': 0.24752048296679607}
[S3] START round=30 head_norm_before_train=1.798060 cos_to_last_merge=0.9304 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=30 local utility u=0.006768 metrics={'f1_val': 0.17888527747682678, 'auprc': 0.17888527747682678, 'loss_val': 3.6086806563470963, 'psi': 0.17888527747682678}-{'f1_val': 0.17879858657243816, 'auprc': 0.17879858657243816, 'loss_val': 3.6214360257847718, 'psi': 0.17879858657243816}
[S4] START round=30 head_norm_before_train=1.933601 (no previous merge yet)
[S4] round=30 local utility u=0.001504 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2023395560904473, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2053479393019886, 'psi': 0.3567939207526687}
[S5] START round=30 head_norm_before_train=2.136569 (no previous merge yet)
[S5] round=30 local utility u=0.006773 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0938708540804245, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.107416748872586, 'psi': 0.3335071121394324}
[S6] START round=30 head_norm_before_train=1.809414 (no previous merge yet)
[S6] round=30 local utility u=0.816171 metrics={'f1_val': 0.09562524196670538, 'auprc': 0.09562524196670538, 'loss_val': 6.004727944259062, 'psi': 0.09562524196670538}-{'f1_val': 0.0, 'auprc': 0.0, 'loss_val': 6.776441834616063, 'psi': 0.0}
[S7] START round=30 head_norm_before_train=1.552618 cos_to_last_merge=0.9763 (last merge round=23)
[S7] round=30 local utility u=0.529285 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.850684224744058, 'psi': 0.35976373724718097}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.8272105129788635, 'psi': 0.23953668875753775}
[S8] START round=30 head_norm_before_train=1.944779 cos_to_last_merge=0.9736 (last merge round=24)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1248864375138985, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.0999891328821778, 'psi': 0.35939447907390915}
[S9] START round=30 head_norm_before_train=1.983772 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.149614821690463, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1290831251907902, 'psi': 0.36867172340800847}
[S10] START round=30 head_norm_before_train=1.493536 cos_to_last_merge=0.9981 (last merge round=28)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.33237593745013566, 'auprc': 0.33237593745013566, 'loss_val': 1.9117539253728988, 'psi': 0.33237593745013566}-{'f1_val': 0.33237593745013566, 'auprc': 0.33237593745013566, 'loss_val': 1.7536516754839764, 'psi': 0.33237593745013566}
[S11] START round=30 head_norm_before_train=1.498291 cos_to_last_merge=0.9980 (last merge round=27)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.2801989268420364, 'auprc': 0.2801989268420364, 'loss_val': 2.0964460030323036, 'psi': 0.2801989268420364}-{'f1_val': 0.27992416813754334, 'auprc': 0.27992416813754334, 'loss_val': 2.0328161883352767, 'psi': 0.27992416813754334}
[S13] START round=30 head_norm_before_train=1.631036 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2366290838195777, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2163866909059577, 'psi': 0.3599362944611573}
[S14] START round=30 head_norm_before_train=1.795784 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.9459878308578205, 'psi': 0.13592717296421}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.887387696272827, 'psi': 0.13592717296421}
[S15] START round=30 head_norm_before_train=1.910025 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4013907774470346, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3979423027215746, 'psi': 0.6166125814646326}
[S16] START round=30 head_norm_before_train=1.897193 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 2.096668546824934, 'psi': 0.09036289353520788}-{'f1_val': 0.10056657223796034, 'auprc': 0.10056657223796034, 'loss_val': 2.0663499316739706, 'psi': 0.10056657223796034}
[S17] START round=30 head_norm_before_train=1.685967 (no previous merge yet)
[S17] round=30 local utility u=0.186625 metrics={'f1_val': 0.24436207676661825, 'auprc': 0.24436207676661825, 'loss_val': 0.8206702517518849, 'psi': 0.24436207676661825}-{'f1_val': 0.20362806728269955, 'auprc': 0.20362806728269955, 'loss_val': 0.8273132286743857, 'psi': 0.20362806728269955}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:50307
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:50311
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.096)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:50303
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] cosine check vs S3: cos=-0.0907
[S6] DROPPED delta from S3 (cos=-0.0907 < 0.0)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=-0.0042
[S3] DROPPED delta from S5 (cos=-0.0042 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] cosine check vs S4: cos=0.9873
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.9000
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=-0.0114
[S14] DROPPED delta from S17 (cos=-0.0114 < 0.0)
[S2] ⇄ pheromone p=0.007 → S5@127.0.0.1:50305
[S3] ⇄ pheromone p=0.204 → S6@127.0.0.1:50307
[S13] ⇄ pheromone p=0.011 → S14@127.0.0.1:50314
[S6] ⇄ pheromone p=0.292 → S3@127.0.0.1:50303
[S8] ⇄ pheromone p=0.030 → S16@127.0.0.1:50316
[S14] ⇄ pheromone p=0.015 → S17@127.0.0.1:50317
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.3324 head_norm=1.549831
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.495933e-01
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.3323 head_norm=1.522846 delta_norm=0.349593
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.043 → S11@127.0.0.1:50312
[S11] ⇄ pheromone p=0.048 → S10@127.0.0.1:50311
[S5] ⇄ pheromone p=0.016 → S3@127.0.0.1:50303
[S7] ⇄ pheromone p=0.186 → S10@127.0.0.1:50311
[S4] ⇄ pheromone p=0.045 → S16@127.0.0.1:50316
[S17] ⇄ pheromone p=0.060 → S14@127.0.0.1:50314
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.0904 head_norm=1.920797
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.547274e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.0904 head_norm=1.927190 delta_norm=0.154727
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.153 → S13@127.0.0.1:50313
[S2] START round=31 head_norm_before_train=1.819636 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.2500622354991287, 'auprc': 0.2500622354991287, 'loss_val': 2.7556671555571786, 'psi': 0.2500622354991287}-{'f1_val': 0.24834662216453426, 'auprc': 0.24834662216453426, 'loss_val': 2.7299989961380726, 'psi': 0.2483466221645343}
[S3] START round=31 head_norm_before_train=1.808747 cos_to_last_merge=0.9293 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=31 local utility u=0.834903 metrics={'f1_val': 0.2762126668078797, 'auprc': 0.2762126668078797, 'loss_val': 2.81482123510923, 'psi': 0.2762126668078797}-{'f1_val': 0.17888527747682678, 'auprc': 0.17888527747682678, 'loss_val': 3.6086806563470963, 'psi': 0.17888527747682678}
[S4] START round=31 head_norm_before_train=1.945903 (no previous merge yet)
[S4] round=31 local utility u=0.001520 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1993002359363485, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2023395560904473, 'psi': 0.3567939207526687}
[S5] START round=31 head_norm_before_train=2.145418 (no previous merge yet)
[S5] round=31 local utility u=0.008106 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0776596582988436, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0938708540804245, 'psi': 0.3335071121394324}
[S6] START round=31 head_norm_before_train=1.813660 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.09826923076923078, 'auprc': 0.09826923076923078, 'loss_val': 6.039569824656942, 'psi': 0.09826923076923078}-{'f1_val': 0.09562524196670538, 'auprc': 0.09562524196670538, 'loss_val': 6.004727944259062, 'psi': 0.09562524196670538}
[S7] START round=31 head_norm_before_train=1.574985 cos_to_last_merge=0.9729 (last merge round=23)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8788910488523751, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.850684224744058, 'psi': 0.35976373724718097}
[S8] START round=31 head_norm_before_train=1.968057 cos_to_last_merge=0.9704 (last merge round=24)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1620802750507961, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1248864375138985, 'psi': 0.35939447907390915}
[S9] START round=31 head_norm_before_train=1.991022 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.169494784000094, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.149614821690463, 'psi': 0.36867172340800847}
[S10] START round=31 head_norm_before_train=1.522846 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.158466 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.5948254984094203, 'psi': 0.33237639553429027}-{'f1_val': 0.33237593745013566, 'auprc': 0.33237593745013566, 'loss_val': 1.9117539253728988, 'psi': 0.33237593745013566}
[S11] START round=31 head_norm_before_train=1.535490 cos_to_last_merge=0.9954 (last merge round=27)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.207370060407268, 'psi': 0.280398322851153}-{'f1_val': 0.2801989268420364, 'auprc': 0.2801989268420364, 'loss_val': 2.0964460030323036, 'psi': 0.2801989268420364}
[S13] START round=31 head_norm_before_train=1.644755 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2700122738055133, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2366290838195777, 'psi': 0.3599362944611573}
[S14] START round=31 head_norm_before_train=1.806071 (no previous merge yet)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.000529483443306, 'psi': 0.13587634006482174}-{'f1_val': 0.13592717296421, 'auprc': 0.13592717296421, 'loss_val': 5.9459878308578205, 'psi': 0.13592717296421}
[S15] START round=31 head_norm_before_train=1.927073 (no previous merge yet)
[S15] round=31 local utility u=0.078092 metrics={'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.2601696413754896, 'psi': 0.6181359625605519}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.4013907774470346, 'psi': 0.6164734888353558}
[S16] START round=31 head_norm_before_train=1.927190 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 2.2374547538143243, 'psi': 0.09022435897435897}-{'f1_val': 0.09036289353520788, 'auprc': 0.09036289353520788, 'loss_val': 2.096668546824934, 'psi': 0.09036289353520788}
[S17] START round=31 head_norm_before_train=1.702005 (no previous merge yet)
[S17] round=31 local utility u=0.037759 metrics={'f1_val': 0.2560542897647499, 'auprc': 0.2560542897647499, 'loss_val': 0.8503821335971726, 'psi': 0.2560542897647499}-{'f1_val': 0.24436207676661825, 'auprc': 0.24436207676661825, 'loss_val': 0.8206702517518849, 'psi': 0.24436207676661825}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[S3] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=-0.0912
[S6] DROPPED delta from S3 (cos=-0.0912 < 0.0)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.0043
[S3] DROPPED delta from S5 (cos=-0.0043 < 0.0)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:50308
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:50316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.9648
[S4] sending update (kind=head size=1806 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1806) from S4
[S16] cosine check vs S4: cos=0.9924
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=-0.0121
[S14] DROPPED delta from S17 (cos=-0.0121 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.3598 head_norm=1.590660
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.101120e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.3598 head_norm=1.567283 delta_norm=0.210112
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6]  timeout peer S2
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S15
[S13]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.0902 head_norm=1.950866
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.201071e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.0902 head_norm=1.948040 delta_norm=0.120107
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.827239 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.24996889386587037, 'auprc': 0.24996889386587037, 'loss_val': 2.770604027915094, 'psi': 0.24996889386587035}-{'f1_val': 0.2500622354991287, 'auprc': 0.2500622354991287, 'loss_val': 2.7556671555571786, 'psi': 0.2500622354991287}
[S3] START round=32 head_norm_before_train=1.818340 cos_to_last_merge=0.9283 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.16900369003690038, 'auprc': 0.16900369003690038, 'loss_val': 3.7956611822621245, 'psi': 0.16900369003690038}-{'f1_val': 0.2762126668078797, 'auprc': 0.2762126668078797, 'loss_val': 2.81482123510923, 'psi': 0.2762126668078797}
[S4] START round=32 head_norm_before_train=1.952612 (no previous merge yet)
[S4] round=32 local utility u=0.002595 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.194110525358007, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1993002359363485, 'psi': 0.3567939207526687}
[S5] START round=32 head_norm_before_train=2.153616 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.081463276653537, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0776596582988436, 'psi': 0.3335071121394324}
[S6] START round=32 head_norm_before_train=1.821017 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.68070857306504, 'psi': 0.017774699907663897}-{'f1_val': 0.09826923076923078, 'auprc': 0.09826923076923078, 'loss_val': 6.039569824656942, 'psi': 0.09826923076923078}
[S7] START round=32 head_norm_before_train=1.567283 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.003151 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8725888692741471, 'psi': 0.35976373724718097}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8788910488523751, 'psi': 0.35976373724718097}
[S8] START round=32 head_norm_before_train=1.983803 cos_to_last_merge=0.9684 (last merge round=24)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1884004096997862, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1620802750507961, 'psi': 0.35939447907390915}
[S9] START round=32 head_norm_before_train=1.998013 (no previous merge yet)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1880015791202414, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.169494784000094, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.571892 cos_to_last_merge=0.9988 (last merge round=30)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6625786075308566, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.5948254984094203, 'psi': 0.33237639553429027}
[S11] START round=32 head_norm_before_train=1.571062 cos_to_last_merge=0.9925 (last merge round=27)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.2560238526305607, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.207370060407268, 'psi': 0.280398322851153}
[S13] START round=32 head_norm_before_train=1.657861 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2899273358764949, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2700122738055133, 'psi': 0.3599362944611573}
[S14] START round=32 head_norm_before_train=1.815897 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.05363175106167, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.000529483443306, 'psi': 0.13587634006482174}
[S15] START round=32 head_norm_before_train=1.942624 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.35338490908808895, 'psi': 0.6166125814646326}-{'f1_val': 0.6181359625605519, 'auprc': 0.6181359625605519, 'loss_val': 0.2601696413754896, 'psi': 0.6181359625605519}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.948040 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.06131042614114873, 'auprc': 0.06131042614114873, 'loss_val': 2.595868901790451, 'psi': 0.06131042614114873}-{'f1_val': 0.09022435897435897, 'auprc': 0.09022435897435897, 'loss_val': 2.2374547538143243, 'psi': 0.09022435897435897}
[S17] START round=32 head_norm_before_train=1.715178 (no previous merge yet)
[S17] round=32 local utility u=0.192785 metrics={'f1_val': 0.305462446064211, 'auprc': 0.305462446064211, 'loss_val': 0.9094849126043726, 'psi': 0.305462446064211}-{'f1_val': 0.2560542897647499, 'auprc': 0.2560542897647499, 'loss_val': 0.8503821335971726, 'psi': 0.2560542897647499}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:50314
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:50316
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=-0.0128
[S14] DROPPED delta from S17 (cos=-0.0128 < 0.0)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:50311
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1803) from S4
[S16] cosine check vs S4: cos=0.9945
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=0.9848
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.0613 head_norm=1.970487
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.032314e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.0627 head_norm=1.959877 delta_norm=0.103231
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.834645 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 2.778684098015719, 'psi': 0.2488542053759445}-{'f1_val': 0.24996889386587037, 'auprc': 0.24996889386587037, 'loss_val': 2.770604027915094, 'psi': 0.24996889386587035}
[S3] START round=33 head_norm_before_train=1.827696 cos_to_last_merge=0.9274 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=33 local utility u=0.208727 metrics={'f1_val': 0.18450271674935034, 'auprc': 0.18450271674935034, 'loss_val': 3.5176988246045444, 'psi': 0.18450271674935034}-{'f1_val': 0.16900369003690038, 'auprc': 0.16900369003690038, 'loss_val': 3.7956611822621245, 'psi': 0.16900369003690038}
[S4] START round=33 head_norm_before_train=1.954669 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1946018334128887, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.194110525358007, 'psi': 0.3567939207526687}
[S5] START round=33 head_norm_before_train=2.167425 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.118865056421665, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.081463276653537, 'psi': 0.3335071121394324}
[S6] START round=33 head_norm_before_train=1.828394 (no previous merge yet)
[S6] round=33 local utility u=0.669448 metrics={'f1_val': 0.10026789131266743, 'auprc': 0.10026789131266743, 'loss_val': 6.084251666739279, 'psi': 0.10026789131266743}-{'f1_val': 0.017774699907663897, 'auprc': 0.017774699907663897, 'loss_val': 6.68070857306504, 'psi': 0.017774699907663897}
[S7] START round=33 head_norm_before_train=1.577308 cos_to_last_merge=0.9999 (last merge round=31)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.821064847325611, 'psi': 0.2396131805157593}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8725888692741471, 'psi': 0.35976373724718097}
[S8] START round=33 head_norm_before_train=1.996738 cos_to_last_merge=0.9669 (last merge round=24)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.216997244185078, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.1884004096997862, 'psi': 0.35939447907390915}
[S9] START round=33 head_norm_before_train=2.004784 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2068716941658564, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.1880015791202414, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.623255 cos_to_last_merge=0.9959 (last merge round=30)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6957635650090033, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6625786075308566, 'psi': 0.33237639553429027}
[S11] START round=33 head_norm_before_train=1.603174 cos_to_last_merge=0.9898 (last merge round=27)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.2889314058836256, 'psi': 0.28041912246234446}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.2560238526305607, 'psi': 0.280398322851153}
[S13] START round=33 head_norm_before_train=1.669601 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3259509353897456, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.2899273358764949, 'psi': 0.3599362944611573}
[S14] START round=33 head_norm_before_train=1.825165 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.105149598721435, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.05363175106167, 'psi': 0.13587634006482174}
[S15] START round=33 head_norm_before_train=1.957332 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.3843465057810087, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.35338490908808895, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.959877 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.576427 metrics={'f1_val': 0.1417104495037945, 'auprc': 0.1417104495037945, 'loss_val': 2.166615729215896, 'psi': 0.1417104495037945}-{'f1_val': 0.06131042614114873, 'auprc': 0.06131042614114873, 'loss_val': 2.595868901790451, 'psi': 0.06131042614114873}
[S17] START round=33 head_norm_before_train=1.725937 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.21115447982937594, 'auprc': 0.21115447982937594, 'loss_val': 0.8999122105613133, 'psi': 0.21115447982937594}-{'f1_val': 0.305462446064211, 'auprc': 0.305462446064211, 'loss_val': 0.9094849126043726, 'psi': 0.305462446064211}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.100)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:50307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1805 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.3324 head_norm=1.670071
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.721277e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.3324 head_norm=1.615206 delta_norm=0.172128
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1805) from S3
[S6] cosine check vs S3: cos=-0.0921
[S6] DROPPED delta from S3 (cos=-0.0921 < 0.0)
[S16] not sending this round → trigger blocked (psi=0.142)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.841715 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.2468817204301075, 'auprc': 0.2468817204301075, 'loss_val': 2.7857319564889957, 'psi': 0.24688172043010753}-{'f1_val': 0.2488542053759445, 'auprc': 0.2488542053759445, 'loss_val': 2.778684098015719, 'psi': 0.2488542053759445}
[S3] START round=34 head_norm_before_train=1.836398 cos_to_last_merge=0.9265 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=34 local utility u=0.738394 metrics={'f1_val': 0.27895355673133454, 'auprc': 0.27895355673133454, 'loss_val': 2.890967552876412, 'psi': 0.27895355673133454}-{'f1_val': 0.18450271674935034, 'auprc': 0.18450271674935034, 'loss_val': 3.5176988246045444, 'psi': 0.18450271674935034}
[S4] START round=34 head_norm_before_train=1.959832 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2001380804413284, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.1946018334128887, 'psi': 0.3567939207526687}
[S5] START round=34 head_norm_before_train=2.178127 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.12969976622658, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.118865056421665, 'psi': 0.3335071121394324}
[S6] START round=34 head_norm_before_train=1.836111 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.047051170858629664, 'auprc': 0.047051170858629664, 'loss_val': 6.365380098092408, 'psi': 0.047051170858629664}-{'f1_val': 0.10026789131266743, 'auprc': 0.10026789131266743, 'loss_val': 6.084251666739279, 'psi': 0.10026789131266743}
[S7] START round=34 head_norm_before_train=1.591839 cos_to_last_merge=0.9997 (last merge round=31)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.18133962606643675, 'auprc': 0.18133962606643675, 'loss_val': 0.7987514797063515, 'psi': 0.18133962606643675}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.821064847325611, 'psi': 0.2396131805157593}
[S8] START round=34 head_norm_before_train=2.011179 cos_to_last_merge=0.9653 (last merge round=24)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2404291798932685, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.216997244185078, 'psi': 0.35939447907390915}
[S9] START round=34 head_norm_before_train=2.011508 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.225228139183586, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2068716941658564, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.615206 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.055080 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.5856033720645224, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6957635650090033, 'psi': 0.33237639553429027}
[S11] START round=34 head_norm_before_train=1.631363 cos_to_last_merge=0.9874 (last merge round=27)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.335795926026108, 'psi': 0.2803432239470754}-{'f1_val': 0.28041912246234446, 'auprc': 0.28041912246234446, 'loss_val': 2.2889314058836256, 'psi': 0.28041912246234446}
[S13] START round=34 head_norm_before_train=1.681862 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.354039569531061, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3259509353897456, 'psi': 0.3599362944611573}
[S14] START round=34 head_norm_before_train=1.833837 (no previous merge yet)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.155597840527682, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.105149598721435, 'psi': 0.13587634006482174}
[S15] START round=34 head_norm_before_train=1.972277 (no previous merge yet)
[S15] round=34 local utility u=0.013958 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3576814093585896, 'psi': 0.6166125814646326}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.3843465057810087, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=34 head_norm_before_train=1.982579 cos_to_last_merge=0.9992 (last merge round=32)
[S16] round=34 local utility u=0.273205 metrics={'f1_val': 0.17992846055206857, 'auprc': 0.17992846055206857, 'loss_val': 1.9641669288249637, 'psi': 0.17992846055206857}-{'f1_val': 0.1417104495037945, 'auprc': 0.1417104495037945, 'loss_val': 2.166615729215896, 'psi': 0.1417104495037945}
[S17] START round=34 head_norm_before_train=1.735325 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.2109961571747595, 'auprc': 0.2109961571747595, 'loss_val': 0.923841508091039, 'psi': 0.2109961571747595}-{'f1_val': 0.21115447982937594, 'auprc': 0.21115447982937594, 'loss_val': 0.8999122105613133, 'psi': 0.21115447982937594}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:50308
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1804) from S10
[S7] cosine check vs S10: cos=0.9894
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.180)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.279)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.1813 head_norm=1.604041
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.215154e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.1802 head_norm=1.625491 delta_norm=0.121515
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.848823 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.24611049859120424, 'auprc': 0.24611049859120424, 'loss_val': 2.8040633268920625, 'psi': 0.24611049859120424}-{'f1_val': 0.2468817204301075, 'auprc': 0.2468817204301075, 'loss_val': 2.7857319564889957, 'psi': 0.24688172043010753}
[S3] START round=35 head_norm_before_train=1.844868 cos_to_last_merge=0.9256 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.2813073203268301, 'auprc': 0.2813073203268301, 'loss_val': 3.0109300484778654, 'psi': 0.2813073203268301}-{'f1_val': 0.27895355673133454, 'auprc': 0.27895355673133454, 'loss_val': 2.890967552876412, 'psi': 0.27895355673133454}
[S4] START round=35 head_norm_before_train=1.966975 (no previous merge yet)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2062226284055613, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2001380804413284, 'psi': 0.3567939207526687}
[S5] START round=35 head_norm_before_train=2.188629 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.133653804196476, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.12969976622658, 'psi': 0.3335071121394324}
[S6] START round=35 head_norm_before_train=1.844071 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.743879764292274, 'psi': 0.021749084249084248}-{'f1_val': 0.047051170858629664, 'auprc': 0.047051170858629664, 'loss_val': 6.365380098092408, 'psi': 0.047051170858629664}
[S7] START round=35 head_norm_before_train=1.625491 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.254374 metrics={'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.8137770833056116, 'psi': 0.23953668875753775}-{'f1_val': 0.18133962606643675, 'auprc': 0.18133962606643675, 'loss_val': 0.7987514797063515, 'psi': 0.18133962606643675}
[S8] START round=35 head_norm_before_train=2.025344 cos_to_last_merge=0.9635 (last merge round=24)
[S8] round=35 local utility u=0.000191 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2400467029856999, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2404291798932685, 'psi': 0.35939447907390915}
[S9] START round=35 head_norm_before_train=2.018067 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2419190817319814, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.225228139183586, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.655605 cos_to_last_merge=0.9995 (last merge round=33)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6149576028552555, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.5856033720645224, 'psi': 0.33237639553429027}
[S11] START round=35 head_norm_before_train=1.655642 cos_to_last_merge=0.9853 (last merge round=27)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.391799356331212, 'psi': 0.280398322851153}-{'f1_val': 0.2803432239470754, 'auprc': 0.2803432239470754, 'loss_val': 2.335795926026108, 'psi': 0.2803432239470754}
[S13] START round=35 head_norm_before_train=1.694299 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3696426182672246, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.354039569531061, 'psi': 0.3599362944611573}
[S14] START round=35 head_norm_before_train=1.841939 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.201360188276878, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.155597840527682, 'psi': 0.13587634006482174}
[S15] START round=35 head_norm_before_train=1.986454 (no previous merge yet)
[S15] round=35 local utility u=0.023745 metrics={'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.31643693476160434, 'psi': 0.6173065327346117}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3576814093585896, 'psi': 0.6166125814646326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=35 head_norm_before_train=2.005582 cos_to_last_merge=0.9975 (last merge round=32)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.04930000858885167, 'auprc': 0.04930000858885167, 'loss_val': 3.27942662395386, 'psi': 0.04930000858885167}-{'f1_val': 0.17992846055206857, 'auprc': 0.17992846055206857, 'loss_val': 1.9641669288249637, 'psi': 0.17992846055206857}
[S17] START round=35 head_norm_before_train=1.747631 (no previous merge yet)
[S17] round=35 local utility u=0.116926 metrics={'f1_val': 0.23763041209257116, 'auprc': 0.23763041209257116, 'loss_val': 0.9296968085723881, 'psi': 0.23763041209257116}-{'f1_val': 0.2109961571747595, 'auprc': 0.2109961571747595, 'loss_val': 0.923841508091039, 'psi': 0.2109961571747595}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:50314
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.002 → S5@127.0.0.1:50305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.181 → S3@127.0.0.1:50303
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.016 → S10@127.0.0.1:50311
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] cosine check vs S17: cos=-0.0148
[S14] DROPPED delta from S17 (cos=-0.0148 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:50311
[S17] ⇄ pheromone p=0.066 → S14@127.0.0.1:50314
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.006 → S3@127.0.0.1:50303
[S10] ⇄ pheromone p=0.036 → S7@127.0.0.1:50308
[S14] ⇄ pheromone p=0.005 → S17@127.0.0.1:50317
[S13] ⇄ pheromone p=0.004 → S16@127.0.0.1:50316
[S7] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=0.9950
[S3] ⇄ pheromone p=0.280 → S6@127.0.0.1:50307
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:50316
[S4] ⇄ pheromone p=0.015 → S16@127.0.0.1:50316
[S8] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S8
[S16] cosine check vs S8: cos=0.9259
[S8] ⇄ pheromone p=0.010 → S16@127.0.0.1:50316
[S7] ⇄ pheromone p=0.112 → S15@127.0.0.1:50315
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.0493 head_norm=2.025845
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.911396e-01
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.0556 head_norm=1.994254 delta_norm=0.391140
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.168 → S4@127.0.0.1:50304
[S2] START round=36 head_norm_before_train=1.856018 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.24611049859120424, 'auprc': 0.24611049859120424, 'loss_val': 2.8192786532358567, 'psi': 0.24611049859120424}-{'f1_val': 0.24611049859120424, 'auprc': 0.24611049859120424, 'loss_val': 2.8040633268920625, 'psi': 0.24611049859120424}
[S3] START round=36 head_norm_before_train=1.853009 cos_to_last_merge=0.9248 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.2826362484157161, 'auprc': 0.2826362484157161, 'loss_val': 3.1015683679902173, 'psi': 0.2826362484157161}-{'f1_val': 0.2813073203268301, 'auprc': 0.2813073203268301, 'loss_val': 3.0109300484778654, 'psi': 0.2813073203268301}
[S4] START round=36 head_norm_before_train=1.975058 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2131029524027162, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2062226284055613, 'psi': 0.3567939207526687}
[S5] START round=36 head_norm_before_train=2.200446 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1534791493243755, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.133653804196476, 'psi': 0.3335071121394324}
[S6] START round=36 head_norm_before_train=1.852538 (no previous merge yet)
[S6] round=36 local utility u=0.572747 metrics={'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 6.296774941138137, 'psi': 0.09934790947449175}-{'f1_val': 0.021749084249084248, 'auprc': 0.021749084249084248, 'loss_val': 6.743879764292274, 'psi': 0.021749084249084248}
[S7] START round=36 head_norm_before_train=1.638059 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.852894299765877, 'psi': 0.23976608187134504}-{'f1_val': 0.23953668875753775, 'auprc': 0.23953668875753775, 'loss_val': 0.8137770833056116, 'psi': 0.23953668875753775}
[S8] START round=36 head_norm_before_train=2.038635 cos_to_last_merge=0.9619 (last merge round=24)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2725387853239936, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2400467029856999, 'psi': 0.35939447907390915}
[S9] START round=36 head_norm_before_train=2.024294 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2590784509320083, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2419190817319814, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.692378 cos_to_last_merge=0.9983 (last merge round=33)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6808928182979201, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6149576028552555, 'psi': 0.33237639553429027}
[S11] START round=36 head_norm_before_train=1.677362 cos_to_last_merge=0.9835 (last merge round=27)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.4411354029844166, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.391799356331212, 'psi': 0.280398322851153}
[S13] START round=36 head_norm_before_train=1.704771 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3928827037346987, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3696426182672246, 'psi': 0.3599362944611573}
[S14] START round=36 head_norm_before_train=1.849602 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.244464621632231, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.201360188276878, 'psi': 0.13587634006482174}
[S15] START round=36 head_norm_before_train=2.000551 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3440352673868104, 'psi': 0.6166125814646326}-{'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.31643693476160434, 'psi': 0.6173065327346117}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.994254 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.678277 metrics={'f1_val': 0.12984105663756437, 'auprc': 0.12984105663756437, 'loss_val': 2.647742300139945, 'psi': 0.12984105663756437}-{'f1_val': 0.04930000858885167, 'auprc': 0.04930000858885167, 'loss_val': 3.27942662395386, 'psi': 0.04930000858885167}
[S17] START round=36 head_norm_before_train=1.760346 (no previous merge yet)
[S17] round=36 local utility u=0.160152 metrics={'f1_val': 0.2684381613598653, 'auprc': 0.2684381613598653, 'loss_val': 0.8866631053609698, 'psi': 0.2684381613598653}-{'f1_val': 0.23763041209257116, 'auprc': 0.23763041209257116, 'loss_val': 0.9296968085723881, 'psi': 0.23763041209257116}
[S6] not sending this round → trigger blocked (psi=0.099)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.130)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=36 metric=0.3324 head_norm=1.726988
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.107810e-01
[S10] stored merged vector for next round verification (round=36)
[S10] DEBUG after merge:  round=36 metric=0.3324 head_norm=1.679461 delta_norm=0.110781
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → trigger blocked (psi=0.268)
[S2] START round=37 head_norm_before_train=1.862604 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.2462915287483143, 'auprc': 0.2462915287483143, 'loss_val': 2.8351161858895337, 'psi': 0.2462915287483143}-{'f1_val': 0.24611049859120424, 'auprc': 0.24611049859120424, 'loss_val': 2.8192786532358567, 'psi': 0.24611049859120424}
[S3] START round=37 head_norm_before_train=1.859377 cos_to_last_merge=0.9242 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=37 local utility u=0.124023 metrics={'f1_val': 0.27589997251992304, 'auprc': 0.27589997251992304, 'loss_val': 2.792895704017549, 'psi': 0.27589997251992304}-{'f1_val': 0.2826362484157161, 'auprc': 0.2826362484157161, 'loss_val': 3.1015683679902173, 'psi': 0.2826362484157161}
[S4] START round=37 head_norm_before_train=1.982408 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2167390980212216, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2131029524027162, 'psi': 0.3567939207526687}
[S5] START round=37 head_norm_before_train=2.210318 (no previous merge yet)
[S5] round=37 local utility u=0.004297 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1448854962101183, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1534791493243755, 'psi': 0.3335071121394324}
[S6] START round=37 head_norm_before_train=1.861775 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.03536476868327402, 'auprc': 0.03536476868327402, 'loss_val': 6.602260150276298, 'psi': 0.03536476868327402}-{'f1_val': 0.09934790947449175, 'auprc': 0.09934790947449175, 'loss_val': 6.296774941138137, 'psi': 0.09934790947449175}
[S7] START round=37 head_norm_before_train=1.649594 cos_to_last_merge=0.9998 (last merge round=34)
[S7] round=37 local utility u=0.006820 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8392547636080192, 'psi': 0.23976608187134504}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.852894299765877, 'psi': 0.23976608187134504}
[S8] START round=37 head_norm_before_train=2.051146 cos_to_last_merge=0.9603 (last merge round=24)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2908110398745551, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2725387853239936, 'psi': 0.35939447907390915}
[S9] START round=37 head_norm_before_train=2.030475 (no previous merge yet)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2765448700844355, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2590784509320083, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.679461 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=37 local utility u=0.061458 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.5579762750172927, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6808928182979201, 'psi': 0.33237639553429027}
[S11] START round=37 head_norm_before_train=1.697236 cos_to_last_merge=0.9819 (last merge round=27)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.4659785690445752, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.4411354029844166, 'psi': 0.280398322851153}
[S13] START round=37 head_norm_before_train=1.716872 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4045017031510068, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.3928827037346987, 'psi': 0.3599362944611573}
[S14] START round=37 head_norm_before_train=1.857106 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.285885358020218, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.244464621632231, 'psi': 0.13587634006482174}
[S15] START round=37 head_norm_before_train=2.013972 (no previous merge yet)
[S15] round=37 local utility u=0.009697 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.32464159124947417, 'psi': 0.6166125814646326}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3440352673868104, 'psi': 0.6166125814646326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=37 head_norm_before_train=2.011483 cos_to_last_merge=0.9998 (last merge round=35)
[S16] round=37 local utility u=0.993136 metrics={'f1_val': 0.22921593596507187, 'auprc': 0.22921593596507187, 'loss_val': 1.5558439096328807, 'psi': 0.22921593596507187}-{'f1_val': 0.12984105663756437, 'auprc': 0.12984105663756437, 'loss_val': 2.647742300139945, 'psi': 0.12984105663756437}
[S17] START round=37 head_norm_before_train=1.771641 (no previous merge yet)
[S17] round=37 local utility u=0.517402 metrics={'f1_val': 0.3831920941622076, 'auprc': 0.3831920941622076, 'loss_val': 0.8846436347823629, 'psi': 0.3831920941622076}-{'f1_val': 0.2684381613598653, 'auprc': 0.2684381613598653, 'loss_val': 0.8866631053609698, 'psi': 0.2684381613598653}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:50308
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:50315
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:50304
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.0046
[S3] DROPPED delta from S5 (cos=-0.0046 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.9955
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.9648
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=0.8009
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] cosine check vs S3: cos=-0.0938
[S6] DROPPED delta from S3 (cos=-0.0938 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.2398 head_norm=1.664040
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.334696e-02
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.2398 head_norm=1.684971 delta_norm=0.083347
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:50314
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.3568 head_norm=1.988487
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.669610e-01
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.3568 head_norm=1.990049 delta_norm=0.266961
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=-0.0157
[S14] DROPPED delta from S17 (cos=-0.0157 < 0.0)
[S2] START round=38 head_norm_before_train=1.869076 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.2467907376696763, 'auprc': 0.2467907376696763, 'loss_val': 2.8478334262061393, 'psi': 0.2467907376696763}-{'f1_val': 0.2462915287483143, 'auprc': 0.2462915287483143, 'loss_val': 2.8351161858895337, 'psi': 0.2462915287483143}
[S3] START round=38 head_norm_before_train=1.858721 cos_to_last_merge=0.9237 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.27554417413572346, 'auprc': 0.27554417413572346, 'loss_val': 3.0314505793168776, 'psi': 0.27554417413572346}-{'f1_val': 0.27589997251992304, 'auprc': 0.27589997251992304, 'loss_val': 2.792895704017549, 'psi': 0.27589997251992304}
[S4] START round=38 head_norm_before_train=1.990049 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2575764678484944, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2167390980212216, 'psi': 0.3567939207526687}
[S5] START round=38 head_norm_before_train=2.215133 (no previous merge yet)
[S5] round=38 local utility u=0.036369 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0721475091240995, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.1448854962101183, 'psi': 0.3335071121394324}
[S6] START round=38 head_norm_before_train=1.871050 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.856141375276215, 'psi': 0.021967963386727688}-{'f1_val': 0.03536476868327402, 'auprc': 0.03536476868327402, 'loss_val': 6.602260150276298, 'psi': 0.03536476868327402}
[S7] START round=38 head_norm_before_train=1.684971 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.003813 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.8302533767129773, 'psi': 0.2396131805157593}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.8392547636080192, 'psi': 0.23976608187134504}
[S8] START round=38 head_norm_before_train=2.061864 cos_to_last_merge=0.9590 (last merge round=24)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.295929514901252, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.2908110398745551, 'psi': 0.35939447907390915}
[S9] START round=38 head_norm_before_train=2.036542 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2927727522310657, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2765448700844355, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.709714 cos_to_last_merge=0.9998 (last merge round=36)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.60544306015386, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.5579762750172927, 'psi': 0.33237639553429027}
[S11] START round=38 head_norm_before_train=1.714904 cos_to_last_merge=0.9805 (last merge round=27)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.5002968526095954, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.4659785690445752, 'psi': 0.280398322851153}
[S13] START round=38 head_norm_before_train=1.727809 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4199915149180051, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4045017031510068, 'psi': 0.3599362944611573}
[S14] START round=38 head_norm_before_train=1.864308 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.32659617702971, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.285885358020218, 'psi': 0.13587634006482174}
[S15] START round=38 head_norm_before_train=2.026996 (no previous merge yet)
[S15] round=38 local utility u=0.027128 metrics={'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.2791222953179722, 'psi': 0.6175834097438502}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.32464159124947417, 'psi': 0.6166125814646326}
[S15] not sending this round → trigger blocked (psi=0.618)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.6176 head_norm=2.040318
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.115088e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.6174 head_norm=1.758414 delta_norm=0.611509
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] START round=38 head_norm_before_train=2.027078 cos_to_last_merge=0.9994 (last merge round=35)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.18625099920063948, 'auprc': 0.18625099920063948, 'loss_val': 2.3630132770904533, 'psi': 0.18625099920063948}-{'f1_val': 0.22921593596507187, 'auprc': 0.22921593596507187, 'loss_val': 1.5558439096328807, 'psi': 0.22921593596507187}
[S17] START round=38 head_norm_before_train=1.782217 (no previous merge yet)
[S17] round=38 local utility u=0.057320 metrics={'f1_val': 0.3957723662207358, 'auprc': 0.3957723662207358, 'loss_val': 0.8832268776047418, 'psi': 0.3957723662207358}-{'f1_val': 0.3831920941622076, 'auprc': 0.3831920941622076, 'loss_val': 0.8846436347823629, 'psi': 0.3831920941622076}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.396)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.334)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.240)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.875129 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.24706388735165716, 'auprc': 0.24706388735165716, 'loss_val': 2.860293297062246, 'psi': 0.24706388735165716}-{'f1_val': 0.2467907376696763, 'auprc': 0.2467907376696763, 'loss_val': 2.8478334262061393, 'psi': 0.2467907376696763}
[S3] START round=39 head_norm_before_train=1.861518 cos_to_last_merge=0.9232 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.27340241796200343, 'auprc': 0.27340241796200343, 'loss_val': 3.0787564264191127, 'psi': 0.27340241796200343}-{'f1_val': 0.27554417413572346, 'auprc': 0.27554417413572346, 'loss_val': 3.0314505793168776, 'psi': 0.27554417413572346}
[S4] START round=39 head_norm_before_train=1.996596 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2650758884407727, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2575764678484944, 'psi': 0.3567939207526687}
[S5] START round=39 head_norm_before_train=2.219169 (no previous merge yet)
[S5] round=39 local utility u=0.033785 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.004578184580612, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0721475091240995, 'psi': 0.3335071121394324}
[S6] START round=39 head_norm_before_train=1.879760 (no previous merge yet)
[S6] round=39 local utility u=0.142929 metrics={'f1_val': 0.036395916555703504, 'auprc': 0.036395916555703504, 'loss_val': 6.7001346283146015, 'psi': 0.036395916555703504}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 6.856141375276215, 'psi': 0.021967963386727688}
[S7] START round=39 head_norm_before_train=1.699435 cos_to_last_merge=0.9999 (last merge round=37)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.8318181212568071, 'psi': 0.23968964488212474}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.8302533767129773, 'psi': 0.2396131805157593}
[S8] START round=39 head_norm_before_train=2.072313 cos_to_last_merge=0.9578 (last merge round=24)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3388797207726608, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.295929514901252, 'psi': 0.35939447907390915}
[S9] START round=39 head_norm_before_train=2.042383 (no previous merge yet)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3092172435015392, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.2927727522310657, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.369 u=0.0000 p_local=0.0005 f1=0.369 auprc=0.369 bytes=1802
[S10] START round=39 head_norm_before_train=1.738846 cos_to_last_merge=0.9993 (last merge round=36)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6659421756585129, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.60544306015386, 'psi': 0.33237639553429027}
[S11] START round=39 head_norm_before_train=1.730289 cos_to_last_merge=0.9791 (last merge round=27)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.539197367389837, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.5002968526095954, 'psi': 0.280398322851153}
[S13] START round=39 head_norm_before_train=1.737357 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4486118736471887, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4199915149180051, 'psi': 0.3599362944611573}
[S14] START round=39 head_norm_before_train=1.871353 (no previous merge yet)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.365458152777474, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.32659617702971, 'psi': 0.13587634006482174}
[S15] START round=39 head_norm_before_train=1.758414 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.3142086412028564, 'psi': 0.6168904640188789}-{'f1_val': 0.6175834097438502, 'auprc': 0.6175834097438502, 'loss_val': 0.2791222953179722, 'psi': 0.6175834097438502}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.617 u=0.0000 p_local=0.0160 f1=0.617 auprc=0.617 bytes=28784
[S16] START round=39 head_norm_before_train=2.041385 cos_to_last_merge=0.9989 (last merge round=35)
[S16] round=39 local utility u=0.357089 metrics={'f1_val': 0.20600255427841632, 'auprc': 0.20600255427841632, 'loss_val': 1.8265988764802474, 'psi': 0.20600255427841632}-{'f1_val': 0.18625099920063948, 'auprc': 0.18625099920063948, 'loss_val': 2.3630132770904533, 'psi': 0.18625099920063948}
[S17] START round=39 head_norm_before_train=1.796074 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9930120127152887, 'psi': 0.30380970798684975}-{'f1_val': 0.3957723662207358, 'auprc': 0.3957723662207358, 'loss_val': 0.8832268776047418, 'psi': 0.3957723662207358}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.036)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.036 u=0.1429 p_local=0.1615 f1=0.036 auprc=0.036 bytes=0
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:50303
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.247 u=0.0000 p_local=0.0009 f1=0.247 auprc=0.247 bytes=9002
[S17] r=40 psi=0.304 u=0.0000 p_local=0.1188 f1=0.304 auprc=0.304 bytes=34221
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:50304
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0054
[S3] DROPPED delta from S5 (cos=-0.0054 < 0.0)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] r=40 psi=0.136 u=0.0000 p_local=0.0020 f1=0.136 auprc=0.136 bytes=0
[S13] r=40 psi=0.360 u=0.0000 p_local=0.0015 f1=0.360 auprc=0.360 bytes=10819
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.9893
[S5] r=40 psi=0.334 u=0.0338 p_local=0.0156 f1=0.334 auprc=0.334 bytes=30578
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.273 u=0.0000 p_local=0.1307 f1=0.273 auprc=0.273 bytes=21609
[S10] r=40 psi=0.332 u=0.0000 p_local=0.0225 f1=0.332 auprc=0.332 bytes=19780
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.3568 head_norm=2.003462
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.503861e-01
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.3568 head_norm=2.023074 delta_norm=0.150386
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.357 u=0.0000 p_local=0.0062 f1=0.357 auprc=0.357 bytes=21612
[S8] r=40 psi=0.359 u=0.0000 p_local=0.0040 f1=0.359 auprc=0.359 bytes=30621
[S7] r=40 psi=0.240 u=0.0000 p_local=0.0474 f1=0.240 auprc=0.240 bytes=37795
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.280 u=0.0000 p_local=0.0064 f1=0.280 auprc=0.280 bytes=10805
[S16] r=40 psi=0.206 u=0.3571 p_local=0.3366 f1=0.206 auprc=0.206 bytes=3593
[S2] START round=40 head_norm_before_train=1.880985 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.24774941423110122, 'auprc': 0.24774941423110122, 'loss_val': 2.8730618519444238, 'psi': 0.24774941423110122}-{'f1_val': 0.24706388735165716, 'auprc': 0.24706388735165716, 'loss_val': 2.860293297062246, 'psi': 0.24706388735165716}
[S3] START round=40 head_norm_before_train=1.867921 cos_to_last_merge=0.9225 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=40 local utility u=0.072989 metrics={'f1_val': 0.2850161582722472, 'auprc': 0.2850161582722472, 'loss_val': 3.0373018296430745, 'psi': 0.2850161582722472}-{'f1_val': 0.27340241796200343, 'auprc': 0.27340241796200343, 'loss_val': 3.0787564264191127, 'psi': 0.27340241796200343}
[S4] START round=40 head_norm_before_train=2.023074 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2913364278127826, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2650758884407727, 'psi': 0.3567939207526687}
[S5] START round=40 head_norm_before_train=2.221234 (no previous merge yet)
[S5] round=40 local utility u=0.000297 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0039844986230024, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.004578184580612, 'psi': 0.3335071121394324}
[S6] START round=40 head_norm_before_train=1.887830 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 6.824391962495206, 'psi': 0.027589326096788783}-{'f1_val': 0.036395916555703504, 'auprc': 0.036395916555703504, 'loss_val': 6.7001346283146015, 'psi': 0.036395916555703504}
[S7] START round=40 head_norm_before_train=1.712659 cos_to_last_merge=0.9998 (last merge round=37)
[S7] round=40 local utility u=0.004844 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.8214428096389925, 'psi': 0.2396131805157593}-{'f1_val': 0.23968964488212474, 'auprc': 0.23968964488212474, 'loss_val': 0.8318181212568071, 'psi': 0.23968964488212474}
[S8] START round=40 head_norm_before_train=2.083072 cos_to_last_merge=0.9565 (last merge round=24)
[S8] round=40 local utility u=0.002237 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3344064576546517, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3388797207726608, 'psi': 0.35939447907390915}
[S9] START round=40 head_norm_before_train=2.048064 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3243707830203952, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3092172435015392, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.765324 cos_to_last_merge=0.9986 (last merge round=36)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7039729215610615, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.6659421756585129, 'psi': 0.33237639553429027}
[S11] START round=40 head_norm_before_train=1.744440 cos_to_last_merge=0.9779 (last merge round=27)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.5699020124660166, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.539197367389837, 'psi': 0.280398322851153}
[S13] START round=40 head_norm_before_train=1.747219 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.464512804287069, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4486118736471887, 'psi': 0.3599362944611573}
[S14] START round=40 head_norm_before_train=1.877979 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.403217264695114, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.365458152777474, 'psi': 0.13587634006482174}
[S15] START round=40 head_norm_before_train=1.777369 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.32804892928879303, 'psi': 0.6166125814646326}-{'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.3142086412028564, 'psi': 0.6168904640188789}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=2.053540 cos_to_last_merge=0.9983 (last merge round=35)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.20021528525296017, 'auprc': 0.20021528525296017, 'loss_val': 2.0449566393829928, 'psi': 0.20021528525296017}-{'f1_val': 0.20600255427841632, 'auprc': 0.20600255427841632, 'loss_val': 1.8265988764802474, 'psi': 0.20600255427841632}
[S17] START round=40 head_norm_before_train=1.812297 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.2715850298998858, 'auprc': 0.2715850298998858, 'loss_val': 0.9350692454076044, 'psi': 0.2715850298998858}-{'f1_val': 0.30380970798684975, 'auprc': 0.30380970798684975, 'loss_val': 0.9930120127152887, 'psi': 0.30380970798684975}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.005 → S10@127.0.0.1:50311
[S5] not sending this round → trigger blocked (psi=0.334)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.129 → S3@127.0.0.1:50303
[S2] ⇄ pheromone p=0.001 → S5@127.0.0.1:50305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.095 → S14@127.0.0.1:50314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:50315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:50316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:50307
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] ⇄ pheromone p=0.002 → S17@127.0.0.1:50317
[S13] ⇄ pheromone p=0.001 → S16@127.0.0.1:50316
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] ⇄ pheromone p=0.013 → S3@127.0.0.1:50303
[S10] ⇄ pheromone p=0.018 → S7@127.0.0.1:50308
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.9242
[S6] RECEIVED delta(kind=head bytes=1797) from S3
[S6] cosine check vs S3: cos=-0.0948
[S6] DROPPED delta from S3 (cos=-0.0948 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.9725
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.2002 head_norm=2.064614
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.443314e-01
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.1993 head_norm=2.064487 delta_norm=0.244331
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.269 → S4@127.0.0.1:50304
[S3] ⇄ pheromone p=0.119 → S6@127.0.0.1:50307
[S8] ⇄ pheromone p=0.004 → S16@127.0.0.1:50316
[S7] ⇄ pheromone p=0.039 → S15@127.0.0.1:50315
[S4] ⇄ pheromone p=0.005 → S16@127.0.0.1:50316
[S2] START round=41 head_norm_before_train=1.886671 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.24880797572605115, 'auprc': 0.24880797572605115, 'loss_val': 2.8865727308982927, 'psi': 0.24880797572605112}-{'f1_val': 0.24774941423110122, 'auprc': 0.24774941423110122, 'loss_val': 2.8730618519444238, 'psi': 0.24774941423110122}
[S3] START round=41 head_norm_before_train=1.875047 cos_to_last_merge=0.9218 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.21146138013216334, 'auprc': 0.21146138013216334, 'loss_val': 3.3860811224353666, 'psi': 0.21146138013216337}-{'f1_val': 0.2850161582722472, 'auprc': 0.2850161582722472, 'loss_val': 3.0373018296430745, 'psi': 0.2850161582722472}
[S4] START round=41 head_norm_before_train=2.037451 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.307102979505216, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.2913364278127826, 'psi': 0.3567939207526687}
[S5] START round=41 head_norm_before_train=2.227327 (no previous merge yet)
[S5] round=41 local utility u=0.003854 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9962755976238657, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.0039844986230024, 'psi': 0.3335071121394324}
[S6] START round=41 head_norm_before_train=1.895149 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.028016267510167194, 'auprc': 0.028016267510167194, 'loss_val': 6.871344041438673, 'psi': 0.02801626751016719}-{'f1_val': 0.027589326096788783, 'auprc': 0.027589326096788783, 'loss_val': 6.824391962495206, 'psi': 0.027589326096788783}
[S7] START round=41 head_norm_before_train=1.722286 cos_to_last_merge=0.9996 (last merge round=37)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 0.8203745436575642, 'psi': 0.23946016959273855}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.8214428096389925, 'psi': 0.2396131805157593}
[S8] START round=41 head_norm_before_train=2.093078 cos_to_last_merge=0.9552 (last merge round=24)
[S8] round=41 local utility u=0.009743 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3149198826820685, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3344064576546517, 'psi': 0.35939447907390915}
[S9] START round=41 head_norm_before_train=2.053658 (no previous merge yet)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3386266011685213, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3243707830203952, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.789667 cos_to_last_merge=0.9978 (last merge round=36)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7299767469422882, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7039729215610615, 'psi': 0.33237639553429027}
[S11] START round=41 head_norm_before_train=1.757306 cos_to_last_merge=0.9768 (last merge round=27)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.5901428984525903, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.5699020124660166, 'psi': 0.280398322851153}
[S13] START round=41 head_norm_before_train=1.756317 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4847320615478723, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.464512804287069, 'psi': 0.3599362944611573}
[S14] START round=41 head_norm_before_train=1.884192 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.438966819021308, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.403217264695114, 'psi': 0.13587634006482174}
[S15] START round=41 head_norm_before_train=1.800844 cos_to_last_merge=0.9998 (last merge round=38)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.32824493205295735, 'psi': 0.6166125814646326}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.32804892928879303, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.6166 head_norm=1.825296
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.545007e-01
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.6166 head_norm=1.738768 delta_norm=0.354501
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] START round=41 head_norm_before_train=2.064487 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.010949904188338353, 'auprc': 0.010949904188338353, 'loss_val': 3.5404453953524415, 'psi': 0.010949904188338353}-{'f1_val': 0.20021528525296017, 'auprc': 0.20021528525296017, 'loss_val': 2.0449566393829928, 'psi': 0.20021528525296017}
[S17] START round=41 head_norm_before_train=1.824638 (no previous merge yet)
[S17] round=41 local utility u=0.333764 metrics={'f1_val': 0.35320034789981286, 'auprc': 0.35320034789981286, 'loss_val': 1.0020785122010594, 'psi': 0.35320034789981286}-{'f1_val': 0.2715850298998858, 'auprc': 0.2715850298998858, 'loss_val': 0.9350692454076044, 'psi': 0.2715850298998858}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:50314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] cosine check vs S17: cos=-0.0181
[S14] DROPPED delta from S17 (cos=-0.0181 < 0.0)
[S8] not sending this round → trigger blocked (psi=0.359)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.0060
[S3] DROPPED delta from S5 (cos=-0.0060 < 0.0)
[S2] START round=42 head_norm_before_train=1.892166 (no previous merge yet)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.24774941423110122, 'auprc': 0.24774941423110122, 'loss_val': 2.8951052432934365, 'psi': 0.24774941423110122}-{'f1_val': 0.24880797572605115, 'auprc': 0.24880797572605115, 'loss_val': 2.8865727308982927, 'psi': 0.24880797572605112}
[S3] START round=42 head_norm_before_train=1.882600 cos_to_last_merge=0.9211 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=42 local utility u=0.393410 metrics={'f1_val': 0.2768621093398181, 'auprc': 0.2768621093398181, 'loss_val': 3.1878682066813355, 'psi': 0.2768621093398181}-{'f1_val': 0.21146138013216334, 'auprc': 0.21146138013216334, 'loss_val': 3.3860811224353666, 'psi': 0.21146138013216337}
[S4] START round=42 head_norm_before_train=2.048915 cos_to_last_merge=0.9998 (last merge round=39)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3278674451890988, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.307102979505216, 'psi': 0.3567939207526687}
[S5] START round=42 head_norm_before_train=2.239538 (no previous merge yet)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.022321984365475, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.9962755976238657, 'psi': 0.3335071121394324}
[S6] START round=42 head_norm_before_train=1.902079 (no previous merge yet)
[S6] round=42 local utility u=0.087292 metrics={'f1_val': 0.04208680403331872, 'auprc': 0.04208680403331872, 'loss_val': 6.823394386234907, 'psi': 0.04208680403331872}-{'f1_val': 0.028016267510167194, 'auprc': 0.028016267510167194, 'loss_val': 6.871344041438673, 'psi': 0.02801626751016719}
[S7] START round=42 head_norm_before_train=1.732250 cos_to_last_merge=0.9994 (last merge round=37)
[S7] round=42 local utility u=0.532170 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8387664976036379, 'psi': 0.35976373724718097}-{'f1_val': 0.23946016959273855, 'auprc': 0.23946016959273855, 'loss_val': 0.8203745436575642, 'psi': 0.23946016959273855}
[S8] START round=42 head_norm_before_train=2.102460 cos_to_last_merge=0.9541 (last merge round=24)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.414666713579011, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.3149198826820685, 'psi': 0.35939447907390915}
[S9] START round=42 head_norm_before_train=2.059086 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.353154565018277, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3386266011685213, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.811796 cos_to_last_merge=0.9970 (last merge round=36)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7396651517675554, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7299767469422882, 'psi': 0.33237639553429027}
[S11] START round=42 head_norm_before_train=1.769225 cos_to_last_merge=0.9757 (last merge round=27)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.609185943282816, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.5901428984525903, 'psi': 0.280398322851153}
[S13] START round=42 head_norm_before_train=1.764239 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4980680134427562, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4847320615478723, 'psi': 0.3599362944611573}
[S14] START round=42 head_norm_before_train=1.890144 (no previous merge yet)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.474010002671605, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.438966819021308, 'psi': 0.13587634006482174}
[S15] START round=42 head_norm_before_train=1.738768 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.005255 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3177343964709421, 'psi': 0.6166125814646326}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.32824493205295735, 'psi': 0.6166125814646326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=42 head_norm_before_train=2.074417 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=42 local utility u=1.000000 metrics={'f1_val': 0.16045006165228112, 'auprc': 0.16045006165228112, 'loss_val': 2.4148640574486016, 'psi': 0.16045006165228112}-{'f1_val': 0.010949904188338353, 'auprc': 0.010949904188338353, 'loss_val': 3.5404453953524415, 'psi': 0.010949904188338353}
[S17] START round=42 head_norm_before_train=1.833844 (no previous merge yet)
[S17] round=42 local utility u=0.258086 metrics={'f1_val': 0.4065243363981092, 'auprc': 0.4065243363981092, 'loss_val': 0.9658222498561784, 'psi': 0.4065243363981092}-{'f1_val': 0.35320034789981286, 'auprc': 0.35320034789981286, 'loss_val': 1.0020785122010594, 'psi': 0.35320034789981286}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.407)
[S6] not sending this round → trigger blocked (psi=0.042)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:50307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:50315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:50304
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.9766
[S6] RECEIVED delta(kind=head bytes=1801) from S3
[S6] cosine check vs S3: cos=-0.0956
[S6] DROPPED delta from S3 (cos=-0.0956 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.9856
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=42 metric=0.3568 head_norm=2.059747
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.760424e-01
[S4] stored merged vector for next round verification (round=42)
[S4] DEBUG after merge:  round=42 metric=0.3568 head_norm=2.064625 delta_norm=0.176042
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.897804 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.24715507166143816, 'auprc': 0.24715507166143816, 'loss_val': 2.9041940946686378, 'psi': 0.24715507166143816}-{'f1_val': 0.24774941423110122, 'auprc': 0.24774941423110122, 'loss_val': 2.8951052432934365, 'psi': 0.24774941423110122}
[S3] START round=43 head_norm_before_train=1.889350 cos_to_last_merge=0.9206 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=43 local utility u=0.155324 metrics={'f1_val': 0.2783375314861461, 'auprc': 0.2783375314861461, 'loss_val': 2.8904996209224194, 'psi': 0.2783375314861461}-{'f1_val': 0.2768621093398181, 'auprc': 0.2768621093398181, 'loss_val': 3.1878682066813355, 'psi': 0.2768621093398181}
[S4] START round=43 head_norm_before_train=2.064625 cos_to_last_merge=1.0000 (last merge round=42)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3575855970251671, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3278674451890988, 'psi': 0.3567939207526687}
[S5] START round=43 head_norm_before_train=2.241982 (no previous merge yet)
[S5] round=43 local utility u=0.102347 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8176289082130612, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 3.022321984365475, 'psi': 0.3335071121394324}
[S6] START round=43 head_norm_before_train=1.908845 (no previous merge yet)
[S6] round=43 local utility u=0.075400 metrics={'f1_val': 0.05703986429177269, 'auprc': 0.05703986429177269, 'loss_val': 6.807171375159672, 'psi': 0.05703986429177269}-{'f1_val': 0.04208680403331872, 'auprc': 0.04208680403331872, 'loss_val': 6.823394386234907, 'psi': 0.04208680403331872}
[S7] START round=43 head_norm_before_train=1.743877 cos_to_last_merge=0.9990 (last merge round=37)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.18602709222490257, 'auprc': 0.18602709222490257, 'loss_val': 0.7531191878011649, 'psi': 0.18602709222490257}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8387664976036379, 'psi': 0.35976373724718097}
[S8] START round=43 head_norm_before_train=2.111185 cos_to_last_merge=0.9530 (last merge round=24)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.462674973132918, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.414666713579011, 'psi': 0.35939447907390915}
[S9] START round=43 head_norm_before_train=2.064378 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3653679392169686, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.353154565018277, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.829910 cos_to_last_merge=0.9962 (last merge round=36)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7459530661418154, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7396651517675554, 'psi': 0.33237639553429027}
[S11] START round=43 head_norm_before_train=1.780406 cos_to_last_merge=0.9747 (last merge round=27)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.632759044576765, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.609185943282816, 'psi': 0.280398322851153}
[S13] START round=43 head_norm_before_train=1.770550 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5101139105411079, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.4980680134427562, 'psi': 0.3599362944611573}
[S14] START round=43 head_norm_before_train=1.895959 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.508180045928328, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.474010002671605, 'psi': 0.13587634006482174}
[S15] START round=43 head_norm_before_train=1.764091 cos_to_last_merge=0.9998 (last merge round=41)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.34330875137618905, 'psi': 0.6164734888353558}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.3177343964709421, 'psi': 0.6166125814646326}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.6165 head_norm=1.793494
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.057631e-01
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.6165 head_norm=1.756851 delta_norm=0.205763
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] START round=43 head_norm_before_train=2.084412 cos_to_last_merge=0.9998 (last merge round=40)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.13717886572952012, 'auprc': 0.13717886572952012, 'loss_val': 2.2679717961737866, 'psi': 0.13717886572952012}-{'f1_val': 0.16045006165228112, 'auprc': 0.16045006165228112, 'loss_val': 2.4148640574486016, 'psi': 0.16045006165228112}
[S17] START round=43 head_norm_before_train=1.843817 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.39989553013029056, 'auprc': 0.39989553013029056, 'loss_val': 0.9887245334884064, 'psi': 0.39989553013029056}-{'f1_val': 0.4065243363981092, 'auprc': 0.4065243363981092, 'loss_val': 0.9658222498561784, 'psi': 0.4065243363981092}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.057)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:50303
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.278)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.0066
[S3] DROPPED delta from S5 (cos=-0.0066 < 0.0)
[S2] START round=44 head_norm_before_train=1.903136 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.24692723697148478, 'auprc': 0.24692723697148478, 'loss_val': 2.9153995257156997, 'psi': 0.24692723697148478}-{'f1_val': 0.24715507166143816, 'auprc': 0.24715507166143816, 'loss_val': 2.9041940946686378, 'psi': 0.24715507166143816}
[S3] START round=44 head_norm_before_train=1.895468 cos_to_last_merge=0.9199 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.26982316029663433, 'auprc': 0.26982316029663433, 'loss_val': 3.280604085299855, 'psi': 0.26982316029663433}-{'f1_val': 0.2783375314861461, 'auprc': 0.2783375314861461, 'loss_val': 2.8904996209224194, 'psi': 0.2783375314861461}
[S4] START round=44 head_norm_before_train=2.075860 cos_to_last_merge=1.0000 (last merge round=42)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3690745787192218, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3575855970251671, 'psi': 0.3567939207526687}
[S5] START round=44 head_norm_before_train=2.238719 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.841355891661668, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8176289082130612, 'psi': 0.3335071121394324}
[S6] START round=44 head_norm_before_train=1.915389 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.044284467713787086, 'auprc': 0.044284467713787086, 'loss_val': 6.899623086760165, 'psi': 0.044284467713787086}-{'f1_val': 0.05703986429177269, 'auprc': 0.05703986429177269, 'loss_val': 6.807171375159672, 'psi': 0.05703986429177269}
[S7] START round=44 head_norm_before_train=1.752884 cos_to_last_merge=0.9988 (last merge round=37)
[S7] round=44 local utility u=0.203368 metrics={'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.8286582006006228, 'psi': 0.2396131805157593}-{'f1_val': 0.18602709222490257, 'auprc': 0.18602709222490257, 'loss_val': 0.7531191878011649, 'psi': 0.18602709222490257}
[S8] START round=44 head_norm_before_train=2.119664 cos_to_last_merge=0.9520 (last merge round=24)
[S8] round=44 local utility u=0.001350 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.459975574435878, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.462674973132918, 'psi': 0.35939447907390915}
[S9] START round=44 head_norm_before_train=2.069506 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3789392744472457, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3653679392169686, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.846567 cos_to_last_merge=0.9955 (last merge round=36)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.757162868848607, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7459530661418154, 'psi': 0.33237639553429027}
[S11] START round=44 head_norm_before_train=1.791023 cos_to_last_merge=0.9738 (last merge round=27)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.655277790568949, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.632759044576765, 'psi': 0.280398322851153}
[S13] START round=44 head_norm_before_train=1.780200 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5299165379032313, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5101139105411079, 'psi': 0.3599362944611573}
[S14] START round=44 head_norm_before_train=1.901630 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.541510592546037, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.508180045928328, 'psi': 0.13587634006482174}
[S15] START round=44 head_norm_before_train=1.756851 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=0.004071 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.3351669909051772, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.34330875137618905, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=44 head_norm_before_train=2.094712 cos_to_last_merge=0.9996 (last merge round=40)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.14358304297328686, 'auprc': 0.14358304297328686, 'loss_val': 2.8156097549339085, 'psi': 0.14358304297328686}-{'f1_val': 0.13717886572952012, 'auprc': 0.13717886572952012, 'loss_val': 2.2679717961737866, 'psi': 0.13717886572952012}
[S17] START round=44 head_norm_before_train=1.849545 (no previous merge yet)
[S17] round=44 local utility u=0.015564 metrics={'f1_val': 0.40179634677007275, 'auprc': 0.40179634677007275, 'loss_val': 0.9747039035769259, 'psi': 0.40179634677007275}-{'f1_val': 0.39989553013029056, 'auprc': 0.39989553013029056, 'loss_val': 0.9887245334884064, 'psi': 0.39989553013029056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:50314
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S17
[S14] cosine check vs S17: cos=-0.0192
[S14] DROPPED delta from S17 (cos=-0.0192 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:50316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:50315
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=0.9889
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.9903
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.1436 head_norm=2.103745
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.581122e-01
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.1448 head_norm=2.109019 delta_norm=0.158112
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.908522 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.24665438919582564, 'auprc': 0.24665438919582564, 'loss_val': 2.9275000653088363, 'psi': 0.2466543891958256}-{'f1_val': 0.24692723697148478, 'auprc': 0.24692723697148478, 'loss_val': 2.9153995257156997, 'psi': 0.24692723697148478}
[S3] START round=45 head_norm_before_train=1.901579 cos_to_last_merge=0.9193 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=45 local utility u=0.230450 metrics={'f1_val': 0.27314153574100525, 'auprc': 0.27314153574100525, 'loss_val': 2.8495690707253623, 'psi': 0.27314153574100525}-{'f1_val': 0.26982316029663433, 'auprc': 0.26982316029663433, 'loss_val': 3.280604085299855, 'psi': 0.26982316029663433}
[S4] START round=45 head_norm_before_train=2.085869 cos_to_last_merge=0.9999 (last merge round=42)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3825510156100622, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3690745787192218, 'psi': 0.3567939207526687}
[S5] START round=45 head_norm_before_train=2.238794 (no previous merge yet)
[S5] round=45 local utility u=0.012623 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.816110207023952, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.841355891661668, 'psi': 0.3335071121394324}
[S6] START round=45 head_norm_before_train=1.922017 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 7.212867562899789, 'psi': 0.021967963386727688}-{'f1_val': 0.044284467713787086, 'auprc': 0.044284467713787086, 'loss_val': 6.899623086760165, 'psi': 0.044284467713787086}
[S7] START round=45 head_norm_before_train=1.763904 cos_to_last_merge=0.9984 (last merge round=37)
[S7] round=45 local utility u=0.509450 metrics={'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8911125309735332, 'psi': 0.35976373724718097}-{'f1_val': 0.2396131805157593, 'auprc': 0.2396131805157593, 'loss_val': 0.8286582006006228, 'psi': 0.2396131805157593}
[S8] START round=45 head_norm_before_train=2.126071 cos_to_last_merge=0.9513 (last merge round=24)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.526475148534746, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.459975574435878, 'psi': 0.35939447907390915}
[S9] START round=45 head_norm_before_train=2.074604 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.393113627149394, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.3789392744472457, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.861930 cos_to_last_merge=0.9948 (last merge round=36)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7779687065361836, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.757162868848607, 'psi': 0.33237639553429027}
[S11] START round=45 head_norm_before_train=1.801047 cos_to_last_merge=0.9729 (last merge round=27)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.6769511079157398, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.655277790568949, 'psi': 0.280398322851153}
[S13] START round=45 head_norm_before_train=1.790071 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5493674972377134, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5299165379032313, 'psi': 0.3599362944611573}
[S14] START round=45 head_norm_before_train=1.907284 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.57412635859975, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.541510592546037, 'psi': 0.13587634006482174}
[S15] START round=45 head_norm_before_train=1.787380 cos_to_last_merge=0.9997 (last merge round=43)
[S15] round=45 local utility u=0.017458 metrics={'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.30150286904051976, 'psi': 0.6166125814646326}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.3351669909051772, 'psi': 0.6164734888353558}
[S15] not sending this round → trigger blocked (psi=0.617)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=45 metric=0.6166 head_norm=1.820220
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.451262e-01
[S15] stored merged vector for next round verification (round=45)
[S15] DEBUG after merge:  round=45 metric=0.6166 head_norm=1.786398 delta_norm=0.145126
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] START round=45 head_norm_before_train=2.109019 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.13913935928450993, 'auprc': 0.13913935928450993, 'loss_val': 2.8860859419920013, 'psi': 0.13913935928450993}-{'f1_val': 0.14358304297328686, 'auprc': 0.14358304297328686, 'loss_val': 2.8156097549339085, 'psi': 0.14358304297328686}
[S17] START round=45 head_norm_before_train=1.856082 (no previous merge yet)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.39625141461058155, 'auprc': 0.39625141461058155, 'loss_val': 0.9932385557386272, 'psi': 0.39625141461058155}-{'f1_val': 0.40179634677007275, 'auprc': 0.40179634677007275, 'loss_val': 0.9747039035769259, 'psi': 0.40179634677007275}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.087 → S14@127.0.0.1:50314
[S2] ⇄ pheromone p=0.000 → S5@127.0.0.1:50305
[S6] ⇄ pheromone p=0.061 → S3@127.0.0.1:50303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.002 → S10@127.0.0.1:50311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:50303
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.360)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:50307
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=-0.0072
[S3] DROPPED delta from S5 (cos=-0.0072 < 0.0)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] ⇄ pheromone p=0.006 → S7@127.0.0.1:50308
[S13] ⇄ pheromone p=0.000 → S16@127.0.0.1:50316
[S14] ⇄ pheromone p=0.001 → S17@127.0.0.1:50317
[S6] RECEIVED delta(kind=head bytes=1798) from S3
[S6] cosine check vs S3: cos=-0.0964
[S6] DROPPED delta from S3 (cos=-0.0964 < 0.0)
[S5] ⇄ pheromone p=0.020 → S3@127.0.0.1:50303
[S7] ⇄ pheromone p=0.202 → S15@127.0.0.1:50315
[S8] ⇄ pheromone p=0.002 → S16@127.0.0.1:50316
[S16] ⇄ pheromone p=0.191 → S4@127.0.0.1:50304
[S3] ⇄ pheromone p=0.145 → S6@127.0.0.1:50307
[S4] ⇄ pheromone p=0.002 → S16@127.0.0.1:50316
[S2] START round=46 head_norm_before_train=1.913809 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.24669982194388163, 'auprc': 0.24669982194388163, 'loss_val': 2.9383345000731658, 'psi': 0.24669982194388163}-{'f1_val': 0.24665438919582564, 'auprc': 0.24665438919582564, 'loss_val': 2.9275000653088363, 'psi': 0.2466543891958256}
[S3] START round=46 head_norm_before_train=1.906825 cos_to_last_merge=0.9188 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.28021725121973673, 'auprc': 0.28021725121973673, 'loss_val': 3.2454049808582544, 'psi': 0.28021725121973673}-{'f1_val': 0.27314153574100525, 'auprc': 0.27314153574100525, 'loss_val': 2.8495690707253623, 'psi': 0.27314153574100525}
[S4] START round=46 head_norm_before_train=2.098925 cos_to_last_merge=0.9997 (last merge round=42)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3934598654186388, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3825510156100622, 'psi': 0.3567939207526687}
[S5] START round=46 head_norm_before_train=2.242685 (no previous merge yet)
[S5] round=46 local utility u=0.004342 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8074253935849933, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.816110207023952, 'psi': 0.3335071121394324}
[S6] START round=46 head_norm_before_train=1.928785 (no previous merge yet)
[S6] round=46 local utility u=0.027303 metrics={'f1_val': 0.023711810305517556, 'auprc': 0.023711810305517556, 'loss_val': 7.173957009697398, 'psi': 0.023711810305517556}-{'f1_val': 0.021967963386727688, 'auprc': 0.021967963386727688, 'loss_val': 7.212867562899789, 'psi': 0.021967963386727688}
[S7] START round=46 head_norm_before_train=1.775611 cos_to_last_merge=0.9979 (last merge round=37)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9412694278467955, 'psi': 0.23976608187134504}-{'f1_val': 0.35976373724718097, 'auprc': 0.35976373724718097, 'loss_val': 0.8911125309735332, 'psi': 0.35976373724718097}
[S8] START round=46 head_norm_before_train=2.133190 cos_to_last_merge=0.9503 (last merge round=24)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5381894173505806, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.526475148534746, 'psi': 0.35939447907390915}
[S9] START round=46 head_norm_before_train=2.079720 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.4069465904470135, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.393113627149394, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.877114 cos_to_last_merge=0.9941 (last merge round=36)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7931747445203434, 'psi': 0.33237639553429027}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7779687065361836, 'psi': 0.33237639553429027}
[S11] START round=46 head_norm_before_train=1.810873 cos_to_last_merge=0.9720 (last merge round=27)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.695594814846929, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.6769511079157398, 'psi': 0.280398322851153}
[S13] START round=46 head_norm_before_train=1.800097 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5678538355819147, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5493674972377134, 'psi': 0.3599362944611573}
[S14] START round=46 head_norm_before_train=1.912902 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.606904507414851, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.57412635859975, 'psi': 0.13587634006482174}
[S15] START round=46 head_norm_before_train=1.786398 cos_to_last_merge=1.0000 (last merge round=45)
[S15] round=46 local utility u=0.013291 metrics={'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.28116614948943147, 'psi': 0.6173065327346117}-{'f1_val': 0.6166125814646326, 'auprc': 0.6166125814646326, 'loss_val': 0.30150286904051976, 'psi': 0.6166125814646326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=46 head_norm_before_train=2.117688 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.13905390539053905, 'auprc': 0.13905390539053905, 'loss_val': 3.025068910428896, 'psi': 0.13905390539053905}-{'f1_val': 0.13913935928450993, 'auprc': 0.13913935928450993, 'loss_val': 2.8860859419920013, 'psi': 0.13913935928450993}
[S17] START round=46 head_norm_before_train=1.866176 (no previous merge yet)
[S17] round=46 local utility u=0.060080 metrics={'f1_val': 0.4069952596226001, 'auprc': 0.4069952596226001, 'loss_val': 0.9697722767758243, 'psi': 0.4069952596226001}-{'f1_val': 0.39625141461058155, 'auprc': 0.39625141461058155, 'loss_val': 0.9932385557386272, 'psi': 0.39625141461058155}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S6] not sending this round → trigger blocked (psi=0.024)
[S5] not sending this round → trigger blocked (psi=0.334)
[S17] sending update (kind=head size=1797 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=-0.0203
[S14] DROPPED delta from S17 (cos=-0.0203 < 0.0)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.918875 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.24692723697148478, 'auprc': 0.24692723697148478, 'loss_val': 2.9474363316410264, 'psi': 0.24692723697148478}-{'f1_val': 0.24669982194388163, 'auprc': 0.24669982194388163, 'loss_val': 2.9383345000731658, 'psi': 0.24669982194388163}
[S3] START round=47 head_norm_before_train=1.912002 cos_to_last_merge=0.9183 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=47 local utility u=0.160284 metrics={'f1_val': 0.27211160774752813, 'auprc': 0.27211160774752813, 'loss_val': 2.851887089927314, 'psi': 0.27211160774752813}-{'f1_val': 0.28021725121973673, 'auprc': 0.28021725121973673, 'loss_val': 3.2454049808582544, 'psi': 0.28021725121973673}
[S4] START round=47 head_norm_before_train=2.108475 cos_to_last_merge=0.9995 (last merge round=42)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4062197804302645, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.3934598654186388, 'psi': 0.3567939207526687}
[S5] START round=47 head_norm_before_train=2.248592 (no previous merge yet)
[S5] round=47 local utility u=0.020550 metrics={'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.7617971321063477, 'psi': 0.33300395256917}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.8074253935849933, 'psi': 0.3335071121394324}
[S6] START round=47 head_norm_before_train=1.935383 (no previous merge yet)
[S6] round=47 local utility u=0.115414 metrics={'f1_val': 0.03536476868327402, 'auprc': 0.03536476868327402, 'loss_val': 7.0480049238597395, 'psi': 0.03536476868327402}-{'f1_val': 0.023711810305517556, 'auprc': 0.023711810305517556, 'loss_val': 7.173957009697398, 'psi': 0.023711810305517556}
[S7] START round=47 head_norm_before_train=1.786189 cos_to_last_merge=0.9973 (last merge round=37)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 0.9814665843774821, 'psi': 0.23938362300662963}-{'f1_val': 0.23976608187134504, 'auprc': 0.23976608187134504, 'loss_val': 0.9412694278467955, 'psi': 0.23976608187134504}
[S8] START round=47 head_norm_before_train=2.139254 cos_to_last_merge=0.9496 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.950
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.541052216192387, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.5381894173505806, 'psi': 0.35939447907390915}
[S9] START round=47 head_norm_before_train=2.084764 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.420506541272924, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.4069465904470135, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.892093 cos_to_last_merge=0.9933 (last merge round=36)
[S10] round=47 local utility u=0.020909 metrics={'f1_val': 0.3322968986685801, 'auprc': 0.3322968986685801, 'loss_val': 1.750641693036876, 'psi': 0.3322968986685801}-{'f1_val': 0.33237639553429027, 'auprc': 0.33237639553429027, 'loss_val': 1.7931747445203434, 'psi': 0.33237639553429027}
[S11] START round=47 head_norm_before_train=1.820461 cos_to_last_merge=0.9712 (last merge round=27)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.7108934774886766, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.695594814846929, 'psi': 0.280398322851153}
[S13] START round=47 head_norm_before_train=1.809575 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5819679249435261, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5678538355819147, 'psi': 0.3599362944611573}
[S14] START round=47 head_norm_before_train=1.918169 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.637525209050671, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.606904507414851, 'psi': 0.13587634006482174}
[S15] START round=47 head_norm_before_train=1.820474 cos_to_last_merge=0.9997 (last merge round=45)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.32614711552044867, 'psi': 0.6164734888353558}-{'f1_val': 0.6173065327346117, 'auprc': 0.6173065327346117, 'loss_val': 0.28116614948943147, 'psi': 0.6173065327346117}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=2.126985 cos_to_last_merge=0.9998 (last merge round=44)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.11311172668513388, 'auprc': 0.11311172668513388, 'loss_val': 3.3812608010979104, 'psi': 0.11311172668513388}-{'f1_val': 0.13905390539053905, 'auprc': 0.13905390539053905, 'loss_val': 3.025068910428896, 'psi': 0.13905390539053905}
[S17] START round=47 head_norm_before_train=1.874481 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.3866030137990619, 'auprc': 0.3866030137990619, 'loss_val': 1.0324018004581315, 'psi': 0.3866030137990619}-{'f1_val': 0.4069952596226001, 'auprc': 0.4069952596226001, 'loss_val': 0.9697722767758243, 'psi': 0.4069952596226001}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.035)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:50303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:50308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:50307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1791) from S5
[S3] cosine check vs S5: cos=-0.0072
[S3] DROPPED delta from S5 (cos=-0.0072 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1806) from S10
[S7] cosine check vs S10: cos=0.9829
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S3
[S6] cosine check vs S3: cos=-0.0969
[S6] DROPPED delta from S3 (cos=-0.0969 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.2394 head_norm=1.792197
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.797661e-01
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.2394 head_norm=1.840414 delta_norm=0.179766
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.923726 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.24733764235149278, 'auprc': 0.24733764235149278, 'loss_val': 2.95688703719444, 'psi': 0.24733764235149278}-{'f1_val': 0.24692723697148478, 'auprc': 0.24692723697148478, 'loss_val': 2.9474363316410264, 'psi': 0.24692723697148478}
[S3] START round=48 head_norm_before_train=1.916687 cos_to_last_merge=0.9179 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.2712738525012893, 'auprc': 0.2712738525012893, 'loss_val': 3.0951022073575274, 'psi': 0.2712738525012893}-{'f1_val': 0.27211160774752813, 'auprc': 0.27211160774752813, 'loss_val': 2.851887089927314, 'psi': 0.27211160774752813}
[S4] START round=48 head_norm_before_train=2.116490 cos_to_last_merge=0.9994 (last merge round=42)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.417868223027038, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4062197804302645, 'psi': 0.3567939207526687}
[S5] START round=48 head_norm_before_train=2.254125 (no previous merge yet)
[S5] round=48 local utility u=0.039808 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.686709388117517, 'psi': 0.3335071121394324}-{'f1_val': 0.33300395256917, 'auprc': 0.33300395256917, 'loss_val': 2.7617971321063477, 'psi': 0.33300395256917}
[S6] START round=48 head_norm_before_train=1.941278 (no previous merge yet)
[S6] round=48 local utility u=0.028645 metrics={'f1_val': 0.04208680403331872, 'auprc': 0.04208680403331872, 'loss_val': 7.051213723516662, 'psi': 0.04208680403331872}-{'f1_val': 0.03536476868327402, 'auprc': 0.03536476868327402, 'loss_val': 7.0480049238597395, 'psi': 0.03536476868327402}
[S7] START round=48 head_norm_before_train=1.840414 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.23923044751150147, 'auprc': 0.23923044751150147, 'loss_val': 0.9967456050054275, 'psi': 0.23923044751150147}-{'f1_val': 0.23938362300662963, 'auprc': 0.23938362300662963, 'loss_val': 0.9814665843774821, 'psi': 0.23938362300662963}
[S8] START round=48 head_norm_before_train=2.146558 cos_to_last_merge=0.9487 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6164712088994917, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.541052216192387, 'psi': 0.35939447907390915}
[S9] START round=48 head_norm_before_train=2.089683 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.4334521670982805, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.420506541272924, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.904445 cos_to_last_merge=0.9927 (last merge round=36)
[S10] round=48 local utility u=0.030393 metrics={'f1_val': 0.33197929111907604, 'auprc': 0.33197929111907604, 'loss_val': 1.6869974439834385, 'psi': 0.33197929111907604}-{'f1_val': 0.3322968986685801, 'auprc': 0.3322968986685801, 'loss_val': 1.750641693036876, 'psi': 0.3322968986685801}
[S11] START round=48 head_norm_before_train=1.829201 cos_to_last_merge=0.9704 (last merge round=27)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.72654840054506, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.7108934774886766, 'psi': 0.280398322851153}
[S13] START round=48 head_norm_before_train=1.818655 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.593783589819756, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.5819679249435261, 'psi': 0.3599362944611573}
[S14] START round=48 head_norm_before_train=1.923343 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.66621487235888, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.637525209050671, 'psi': 0.13587634006482174}
[S15] START round=48 head_norm_before_train=1.855448 cos_to_last_merge=0.9988 (last merge round=45)
[S15] round=48 local utility u=0.008546 metrics={'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.3090556567705796, 'psi': 0.6164734888353558}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.32614711552044867, 'psi': 0.6164734888353558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=48 head_norm_before_train=2.135813 cos_to_last_merge=0.9996 (last merge round=44)
[S16] round=48 local utility u=0.167214 metrics={'f1_val': 0.13800705467372135, 'auprc': 0.13800705467372135, 'loss_val': 3.2708910631931296, 'psi': 0.13800705467372135}-{'f1_val': 0.11311172668513388, 'auprc': 0.11311172668513388, 'loss_val': 3.3812608010979104, 'psi': 0.11311172668513388}
[S17] START round=48 head_norm_before_train=1.881956 (no previous merge yet)
[S17] round=48 local utility u=0.057393 metrics={'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 1.0087605026232476, 'psi': 0.39673011180732504}-{'f1_val': 0.3866030137990619, 'auprc': 0.3866030137990619, 'loss_val': 1.0324018004581315, 'psi': 0.3866030137990619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:50314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.042)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.332)
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.334)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=-0.0208
[S14] DROPPED delta from S17 (cos=-0.0208 < 0.0)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:50309
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S16
[S8] cosine check vs S16: cos=0.9939
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.3594 head_norm=2.154403
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.184444e-01
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.3594 head_norm=2.146100 delta_norm=0.118444
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.928490 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.2474747474747475, 'auprc': 0.2474747474747475, 'loss_val': 2.965881271934929, 'psi': 0.24747474747474751}-{'f1_val': 0.24733764235149278, 'auprc': 0.24733764235149278, 'loss_val': 2.95688703719444, 'psi': 0.24733764235149278}
[S3] START round=49 head_norm_before_train=1.922631 cos_to_last_merge=0.9174 (last merge round=8)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=49 local utility u=0.110154 metrics={'f1_val': 0.2741880341880342, 'auprc': 0.2741880341880342, 'loss_val': 2.9010221881487777, 'psi': 0.2741880341880342}-{'f1_val': 0.2712738525012893, 'auprc': 0.2712738525012893, 'loss_val': 3.0951022073575274, 'psi': 0.2712738525012893}
[S4] START round=49 head_norm_before_train=2.122253 cos_to_last_merge=0.9992 (last merge round=42)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.4181603239753127, 'psi': 0.3567939207526687}-{'f1_val': 0.3567939207526687, 'auprc': 0.3567939207526687, 'loss_val': 1.417868223027038, 'psi': 0.3567939207526687}
[S5] START round=49 head_norm_before_train=2.251889 (no previous merge yet)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.726892033890519, 'psi': 0.3335071121394324}-{'f1_val': 0.3335071121394324, 'auprc': 0.3335071121394324, 'loss_val': 2.686709388117517, 'psi': 0.3335071121394324}
[S6] START round=49 head_norm_before_train=1.946932 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.037422497785651015, 'auprc': 0.037422497785651015, 'loss_val': 7.103520569419684, 'psi': 0.037422497785651015}-{'f1_val': 0.04208680403331872, 'auprc': 0.04208680403331872, 'loss_val': 7.051213723516662, 'psi': 0.04208680403331872}
[S7] START round=49 head_norm_before_train=1.848849 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.23877026137926907, 'auprc': 0.23877026137926907, 'loss_val': 1.0381198141243504, 'psi': 0.23877026137926907}-{'f1_val': 0.23923044751150147, 'auprc': 0.23923044751150147, 'loss_val': 0.9967456050054275, 'psi': 0.23923044751150147}
[S8] START round=49 head_norm_before_train=2.146100 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6181955765126594, 'psi': 0.35939447907390915}-{'f1_val': 0.35939447907390915, 'auprc': 0.35939447907390915, 'loss_val': 1.6164712088994917, 'psi': 0.35939447907390915}
[S9] START round=49 head_norm_before_train=2.094485 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.4459300346396606, 'psi': 0.36867172340800847}-{'f1_val': 0.36867172340800847, 'auprc': 0.36867172340800847, 'loss_val': 3.4334521670982805, 'psi': 0.36867172340800847}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.914075 cos_to_last_merge=0.9922 (last merge round=36)
[S10] round=49 local utility u=0.002038 metrics={'f1_val': 0.3315040165433866, 'auprc': 0.3315040165433866, 'loss_val': 1.6786432602848766, 'psi': 0.3315040165433866}-{'f1_val': 0.33197929111907604, 'auprc': 0.33197929111907604, 'loss_val': 1.6869974439834385, 'psi': 0.33197929111907604}
[S11] START round=49 head_norm_before_train=1.837397 cos_to_last_merge=0.9697 (last merge round=27)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.7425044654138104, 'psi': 0.280398322851153}-{'f1_val': 0.280398322851153, 'auprc': 0.280398322851153, 'loss_val': 2.72654840054506, 'psi': 0.280398322851153}
[S13] START round=49 head_norm_before_train=1.827417 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.6093175789398237, 'psi': 0.3599362944611573}-{'f1_val': 0.3599362944611573, 'auprc': 0.3599362944611573, 'loss_val': 1.593783589819756, 'psi': 0.3599362944611573}
[S14] START round=49 head_norm_before_train=1.928475 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.693733689800872, 'psi': 0.13587634006482174}-{'f1_val': 0.13587634006482174, 'auprc': 0.13587634006482174, 'loss_val': 6.66621487235888, 'psi': 0.13587634006482174}
[S15] START round=49 head_norm_before_train=1.888067 cos_to_last_merge=0.9976 (last merge round=45)
[S15] round=49 local utility u=0.005511 metrics={'f1_val': 0.6168904640188789, 'auprc': 0.6168904640188789, 'loss_val': 0.3017872671632092, 'psi': 0.6168904640188789}-{'f1_val': 0.6164734888353558, 'auprc': 0.6164734888353558, 'loss_val': 0.3090556567705796, 'psi': 0.6164734888353558}
[S15] not sending this round → trigger blocked (psi=0.617)
[S16] START round=49 head_norm_before_train=2.144317 cos_to_last_merge=0.9993 (last merge round=44)
[S16] round=49 local utility u=1.000000 metrics={'f1_val': 0.24256319811875368, 'auprc': 0.24256319811875368, 'loss_val': 1.5753248956674, 'psi': 0.24256319811875368}-{'f1_val': 0.13800705467372135, 'auprc': 0.13800705467372135, 'loss_val': 3.2708910631931296, 'psi': 0.13800705467372135}
[S17] START round=49 head_norm_before_train=1.888763 (no previous merge yet)
[S17] round=49 local utility u=0.073888 metrics={'f1_val': 0.4102822580645161, 'auprc': 0.4102822580645161, 'loss_val': 0.9829534250473041, 'psi': 0.4102822580645161}-{'f1_val': 0.39673011180732504, 'auprc': 0.39673011180732504, 'loss_val': 1.0087605026232476, 'psi': 0.39673011180732504}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.410)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:50308
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.243)
[S10] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:50307
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1805) from S10
[S7] cosine check vs S10: cos=0.9946
[S3] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S3
[S6] cosine check vs S3: cos=-0.0974
[S6] DROPPED delta from S3 (cos=-0.0974 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=49 metric=0.2388 head_norm=1.860178
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.035923e-01
[S7] stored merged vector for next round verification (round=49)
[S7] DEBUG after merge:  round=49 metric=0.2388 head_norm=1.889371 delta_norm=0.103592
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
